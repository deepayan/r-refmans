<!DOCTYPE html><html><head><title>Help for package samplingVarEst</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samplingVarEst}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Est.Corr.Hajek'><p>Estimator of a correlation coefficient using the Hajek point estimator</p></a></li>
<li><a href='#Est.Corr.NHT'><p>Estimator of a correlation coefficient using the Narain-Horvitz-Thompson point estimator</p></a></li>
<li><a href='#Est.EmpDistFunc.Hajek'><p>The Hajek estimator for the empirical cumulative distribution function</p></a></li>
<li><a href='#Est.EmpDistFunc.NHT'><p>The Narain-Horvitz-Thompson estimator for the empirical cumulative distribution function</p></a></li>
<li><a href='#Est.Mean.Hajek'><p>The Hajek estimator for a mean</p></a></li>
<li><a href='#Est.Mean.NHT'><p>The Narain-Horvitz-Thompson estimator for a mean</p></a></li>
<li><a href='#Est.Ratio'><p>Estimator of a ratio</p></a></li>
<li><a href='#Est.RegCo.Hajek'><p>Estimator of the regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#Est.RegCoI.Hajek'><p>Estimator of the intercept regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#Est.Total.Hajek'><p>The Hajek estimator for a total</p></a></li>
<li><a href='#Est.Total.NHT'><p>The Narain-Horvitz-Thompson estimator for a total</p></a></li>
<li><a href='#oaxaca'><p>Municipalities of the state of Oaxaca in Mexico</p></a></li>
<li><a href='#Pk.PropNorm.U'><p>Inclusion probabilities proportional to a specified variable.</p></a></li>
<li><a href='#Pkl.Hajek.s'><p>The Hajek approximation for the 2nd order (joint) inclusion probabilities (sample based)</p></a></li>
<li><a href='#Pkl.Hajek.U'><p>The Hajek approximation for the 2nd order (joint) inclusion probabilities (population based)</p></a></li>
<li><a href='#samplingVarEst-package'><p>Sampling Variance Estimation package</p></a></li>
<li><a href='#VE.EB.HT.Mean.Hajek'><p>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a mean (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.EB.HT.Ratio'><p>The Escobar-Berger unequal probability replicate variance estimator for the estimator of a ratio (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.EB.HT.Total.Hajek'><p>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a total (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.EB.SYG.Mean.Hajek'><p>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a mean (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.EB.SYG.Ratio'><p>The Escobar-Berger unequal probability replicate variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.EB.SYG.Total.Hajek'><p>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a total (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Hajek.Mean.NHT'><p>The Hajek variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</p></a></li>
<li><a href='#VE.Hajek.Total.NHT'><p>The Hajek variance estimator for the Narain-Horvitz-Thompson point estimator for a total</p></a></li>
<li><a href='#VE.HT.Mean.NHT'><p>The Horvitz-Thompson variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</p></a></li>
<li><a href='#VE.HT.Total.NHT'><p>The Horvitz-Thompson variance estimator for the Narain-Horvitz-Thompson point estimator for a total</p></a></li>
<li><a href='#VE.Jk.B.Corr.Hajek'><p>The Berger (2007) unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.B.Mean.Hajek'><p>The Berger (2007) unequal probability jackknife variance estimator for the Hajek estimator of a mean</p></a></li>
<li><a href='#VE.Jk.B.Ratio'><p>The Berger (2007) unequal probability jackknife variance estimator for the estimator of a ratio</p></a></li>
<li><a href='#VE.Jk.B.RegCo.Hajek'><p>The Berger (2007) unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.B.RegCoI.Hajek'><p>The Berger (2007) unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.B.Total.Hajek'><p>The Berger (2007) unequal probability jackknife variance estimator for the Hajek estimator of a total</p></a></li>
<li><a href='#VE.Jk.CBS.HT.Corr.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.HT.Mean.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a mean (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.HT.Ratio'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a ratio (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.HT.RegCo.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.HT.RegCoI.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.HT.Total.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a total (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.Corr.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.Mean.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a mean (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.Ratio'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.RegCo.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.RegCoI.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.CBS.SYG.Total.Hajek'><p>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a total (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.Jk.EB.SW2.Corr.Hajek'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.EB.SW2.Mean.Hajek'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek (1971) estimator of a mean</p></a></li>
<li><a href='#VE.Jk.EB.SW2.Ratio'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a ratio</p></a></li>
<li><a href='#VE.Jk.EB.SW2.RegCo.Hajek'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.EB.SW2.RegCoI.Hajek'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.EB.SW2.Total.Hajek'><p>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek (1971) estimator of a total</p></a></li>
<li><a href='#VE.Jk.Tukey.Corr.Hajek'><p>The Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.Tukey.Corr.NHT'><p>The Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient using the Narain-Horvitz-Thompson point estimator</p></a></li>
<li><a href='#VE.Jk.Tukey.Mean.Hajek'><p>The Tukey (1958) jackknife variance estimator for the Hajek estimator of a mean</p></a></li>
<li><a href='#VE.Jk.Tukey.Ratio'><p>The Tukey (1958) jackknife variance estimator for the estimator of a ratio</p></a></li>
<li><a href='#VE.Jk.Tukey.RegCo.Hajek'><p>The Tukey (1958) jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.Tukey.RegCoI.Hajek'><p>The Tukey (1958) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</p></a></li>
<li><a href='#VE.Jk.Tukey.Total.Hajek'><p>The Tukey (1958) jackknife variance estimator for the Hajek estimator of a total</p></a></li>
<li><a href='#VE.Lin.HT.Ratio'><p>The unequal probability linearisation variance estimator for the estimator of a ratio (Horvitz-Thompson form)</p></a></li>
<li><a href='#VE.Lin.SYG.Ratio'><p>The unequal probability linearisation variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</p></a></li>
<li><a href='#VE.SYG.Mean.NHT'><p>The Sen-Yates-Grundy variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</p></a></li>
<li><a href='#VE.SYG.Total.NHT'><p>The Sen-Yates-Grundy variance estimator for the Narain-Horvitz-Thompson point estimator for a total</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-13</td>
</tr>
<tr>
<td>Title:</td>
<td>Sampling Variance Estimation</td>
</tr>
<tr>
<td>Author:</td>
<td>Emilio Lopez Escobar [aut, cre, cph] &lt;emilio@quantos.mx&gt;,
        Ernesto Barrios Zamudio [ctb] &lt;ebarrios@itam.mx&gt;,
        Juan Francisco Munoz Rosas [ctb] &lt;jfmunoz@go.ugr.es&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emilio Lopez Escobar &lt;emilio@quantos.mx&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate some point estimators and estimate their variance under unequal probability sampling without replacement. Single and two-stage sampling designs are considered. Some approximations for the second-order inclusion probabilities (joint inclusion probabilities) are available (sample and population based). A variety of Jackknife variance estimators are implemented. Almost every function is written in C (compiled) code for faster results. The functions incorporate some performance improvements for faster results with large datasets.</td>
</tr>
<tr>
<td>Classification/MSC:</td>
<td>62D05, 62F40, 62G09, 62H12</td>
</tr>
<tr>
<td>Classification/JEL:</td>
<td>C13, C15, C42, C83</td>
</tr>
<tr>
<td>Classification/ACM:</td>
<td>G.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.quantos.mx/">https://www.quantos.mx/</a>, <a href="https://www.itam.mx/">https://www.itam.mx/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-14 04:02:31 UTC; E</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-14 09:30:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='Est.Corr.Hajek'>Estimator of a correlation coefficient using the Hajek point estimator</h2><span id='topic+Est.Corr.Hajek'></span>

<h3>Description</h3>

<p>Estimates a population correlation coefficient of two variables using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Corr.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9) (implemented by the current function), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the correlation coefficient point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Corr.NHT">Est.Corr.NHT</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the correlation coefficient estimator for y1 and x
Est.Corr.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the correlation coefficient estimator for y2 and x
Est.Corr.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='Est.Corr.NHT'>Estimator of a correlation coefficient using the Narain-Horvitz-Thompson point estimator</h2><span id='topic+Est.Corr.NHT'></span>

<h3>Description</h3>

<p>Estimates a population correlation coefficient of two variables using the Narain (1951); Horvitz-Thompson (1952) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Corr.NHT(VecY.s, VecX.s, VecPk.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Corr.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Corr.NHT_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Corr.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Corr.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{NHT})(x_k - \hat{\bar{x}}_{NHT})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{NHT})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{NHT})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{NHT}</code> is the Narain (1951); Horvitz-Thompson (1952) estimator for the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N}\sum_{k\in s} w_k y_k</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the correlation coefficient point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Corr.Hajek">Est.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Corr.NHT">VE.Jk.Tukey.Corr.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the correlation coefficient estimator for y1 and x
Est.Corr.NHT(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the correlation coefficient estimator for y2 and x
Est.Corr.NHT(y2[s==1], x[s==1], pik.U[s==1], N)
</code></pre>

<hr>
<h2 id='Est.EmpDistFunc.Hajek'>The Hajek estimator for the empirical cumulative distribution function</h2><span id='topic+Est.EmpDistFunc.Hajek'></span>

<h3>Description</h3>

<p>Computes the Hajek (1971) estimator for the empirical cumulative distribution function (ECDF).  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.EmpDistFunc.Hajek(VecY.s, VecPk.s, t)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.EmpDistFunc.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.EmpDistFunc.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.EmpDistFunc.Hajek_+3A_t">t</code></td>
<td>
<p>value to be evaluated for the empirical cumulative distribution function. It must be an integer or a double-precision scalar. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population empirical cumulative distribution function (ECDF) of the variable <code class="reqn">y</code> at the value <code class="reqn">t</code>:
</p>
<p style="text-align: center;"><code class="reqn">Fn(t) = \frac{\#(k\in U:y_k \leq t)}{N} = \frac{1}{N} \sum_{k\in U} I(y_k \leq t)</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">Fn(t)</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}n_{Hajek}(t) = \frac{\sum_{k\in s} w_k I(y_k \leq t)}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">I(y_k \leq t)</code> denotes the indicator function that takes the value <code class="reqn">1</code> if <code class="reqn">y_k \leq t</code> and the value <code class="reqn">0</code> otherwise, and where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the empirical cumulative distribution function evaluated at <code class="reqn">t</code>.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar [aut, cre], Juan Francisco Munoz Rosas [ctb].</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.EmpDistFunc.NHT">Est.EmpDistFunc.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                      #Loads Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00)       #Reconstructs the inclusion probs.
s     &lt;- oaxaca$sHOMES00                          #Defines the sample to be used
y1    &lt;- oaxaca$POP10                             #Defines the variable of interest y1
Est.EmpDistFunc.Hajek(y1[s==1], pik.U[s==1], 950) #Hajek est. of ECDF for y1 at t=950
</code></pre>

<hr>
<h2 id='Est.EmpDistFunc.NHT'>The Narain-Horvitz-Thompson estimator for the empirical cumulative distribution function</h2><span id='topic+Est.EmpDistFunc.NHT'></span>

<h3>Description</h3>

<p>Computes the Narain (1951); Horvitz-Thompson (1952) estimator for the empirical cumulative distribution function (ECDF).  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.EmpDistFunc.NHT(VecY.s, VecPk.s, N, t)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.EmpDistFunc.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.EmpDistFunc.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.EmpDistFunc.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. </p>
</td></tr>
<tr><td><code id="Est.EmpDistFunc.NHT_+3A_t">t</code></td>
<td>
<p>value to be evaluated for the empirical cumulative distribution function. It must be an integer or a double-precision scalar. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population empirical cumulative distribution function (ECDF) of the variable <code class="reqn">y</code> at the value <code class="reqn">t</code>:
</p>
<p style="text-align: center;"><code class="reqn">Fn(t) = \frac{\#(k\in U:y_k \leq t)}{N} = \frac{1}{N} \sum_{k\in U} I(y_k \leq t)</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">Fn(t)</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{F}n_{NHT}(t) = \frac{1}{N} \sum_{k\in s} \frac{I(y_k \leq t)}{\pi_k}</code>
</p>

<p>where <code class="reqn">I(y_k \leq t)</code> denotes the indicator function that takes the value <code class="reqn">1</code> if <code class="reqn">y_k \leq t</code> and the value <code class="reqn">0</code> otherwise, and where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the empirical cumulative distribution function evaluated at <code class="reqn">t</code>.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar [aut, cre], Juan Francisco Munoz Rosas [ctb].</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.EmpDistFunc.Hajek">Est.EmpDistFunc.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                       #Loads Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00)        #Reconstructs the inclusion probs.
s     &lt;- oaxaca$sHOMES00                           #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                            #Defines the population size
y1    &lt;- oaxaca$POP10                              #Defines the variable of interest y1
Est.EmpDistFunc.NHT(y1[s==1], pik.U[s==1], N, 950) #NHT est. of ECDF for y1 at t=950
</code></pre>

<hr>
<h2 id='Est.Mean.Hajek'>The Hajek estimator for a mean</h2><span id='topic+Est.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Hajek (1971) estimator for a population mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Mean.Hajek(VecY.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the mean point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Mean.NHT">Est.Mean.NHT</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
Est.Mean.Hajek(y1[s==1], pik.U[s==1])       #Computes the Hajek est. for y1
Est.Mean.Hajek(y2[s==1], pik.U[s==1])       #Computes the Hajek est. for y2
</code></pre>

<hr>
<h2 id='Est.Mean.NHT'>The Narain-Horvitz-Thompson estimator for a mean</h2><span id='topic+Est.Mean.NHT'></span>

<h3>Description</h3>

<p>Computes the Narain (1951); Horvitz-Thompson (1952) estimator for a population mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Mean.NHT(VecY.s, VecPk.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Mean.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Mean.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Mean.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>: 
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">\bar{y}</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N} \sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the mean point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Mean.Hajek">Est.Mean.Hajek</a></code><br /><code><a href="#topic+VE.HT.Mean.NHT">VE.HT.Mean.NHT</a></code><br /><code><a href="#topic+VE.SYG.Mean.NHT">VE.SYG.Mean.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Mean.NHT">VE.Hajek.Mean.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
Est.Mean.NHT(y1[s==1], pik.U[s==1], N)      #The NHT estimator for y1
Est.Mean.NHT(y2[s==1], pik.U[s==1], N)      #The NHT estimator for y2
</code></pre>

<hr>
<h2 id='Est.Ratio'>Estimator of a ratio</h2><span id='topic+Est.Ratio'></span>

<h3>Description</h3>

<p>Estimates a population ratio of two totals/means.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Ratio(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="Est.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>: 
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the ratio point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x     &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
Est.Ratio(y1[s==1], x[s==1], pik.U[s==1])   #Ratio estimator for y1 and x
Est.Ratio(y2[s==1], x[s==1], pik.U[s==1])   #Ratio estimator for y2 and x
</code></pre>

<hr>
<h2 id='Est.RegCo.Hajek'>Estimator of the regression coefficient using the Hajek point estimator</h2><span id='topic+Est.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Estimates the population regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.RegCo.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the regression coefficient point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.RegCoI.Hajek">Est.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the regression coefficient estimator for y1 and x
Est.RegCo.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the regression coefficient estimator for y2 and x
Est.RegCo.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='Est.RegCoI.Hajek'>Estimator of the intercept regression coefficient using the Hajek point estimator</h2><span id='topic+Est.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Estimates the population intercept regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the intercept regression coefficient point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.RegCo.Hajek">Est.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the intercept regression coefficient estimator for y1 and x
Est.RegCoI.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the intercept regression coefficient estimator for y2 and x
Est.RegCoI.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='Est.Total.Hajek'>The Hajek estimator for a total</h2><span id='topic+Est.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Hajek (1971) estimator for a population total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Total.Hajek(VecY.s, VecPk.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the total point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Total.NHT">Est.Total.NHT</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable y1
y2    &lt;- oaxaca$HOMES10                     #Defines the variable y2
Est.Total.Hajek(y1[s==1], pik.U[s==1], N)   #The Hajek estimator for y1
Est.Total.Hajek(y2[s==1], pik.U[s==1], N)   #The Hajek estimator for y2
</code></pre>

<hr>
<h2 id='Est.Total.NHT'>The Narain-Horvitz-Thompson estimator for a total</h2><span id='topic+Est.Total.NHT'></span>

<h3>Description</h3>

<p>Computes the Narain (1951); Horvitz-Thompson (1952) estimator for a population total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Est.Total.NHT(VecY.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Est.Total.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="Est.Total.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">t</code> (implemented by the current function) is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{NHT} = \sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the total point estimator.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Total.Hajek">Est.Total.Hajek</a></code><br /><code><a href="#topic+VE.HT.Total.NHT">VE.HT.Total.NHT</a></code><br /><code><a href="#topic+VE.SYG.Total.NHT">VE.SYG.Total.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Total.NHT">VE.Hajek.Total.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
Est.Total.NHT(y1[s==1], pik.U[s==1])        #Computes the NHT estimator for y1
Est.Total.NHT(y2[s==1], pik.U[s==1])        #Computes the NHT estimator for y2
</code></pre>

<hr>
<h2 id='oaxaca'>Municipalities of the state of Oaxaca in Mexico</h2><span id='topic+oaxaca'></span>

<h3>Description</h3>

<p>Dataset with information about the free and sovereign state of Oaxaca, which is
located in the southern part of Mexico. The dataset contains information on population, surface,
indigenous language, agriculture, and income from years ranging from 2000 to 2010. The information
was originally collected and processed by Mexico's National Institute of Statistics and Geography (INEGI by its name in
Spanish, &lsquo;Instituto Nacional de Estadistica y Geografia&rsquo;, http://www.inegi.org.mx/).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(oaxaca)</code></pre>


<h3>Format</h3>

<p>A data frame with 570 observations on the following 41 variables:
</p>

<dl>
<dt>IDREGION</dt><dd><p>region INEGI code.</p>
</dd>
<dt>LBREGION</dt><dd><p>region name (without accents and Spanish language characters).</p>
</dd>
<dt>IDDISTRI</dt><dd><p>district INEGI code.</p>
</dd>
<dt>LBDISTRI</dt><dd><p>district name (without accents and Spanish language characters).</p>
</dd>
<dt>IDMUNICI</dt><dd><p>municipality INEGI code.</p>
</dd>
<dt>LBMUNICI</dt><dd><p>municipality name (without accents and Spanish language characters).</p>
</dd>
<dt>SURFAC05</dt><dd><p>surface in squared kilometres 2005.</p>
</dd>
<dt>POP00</dt><dd><p>population 2000.</p>
</dd>
<dt>POP10</dt><dd><p>population 2010.</p>
</dd>
<dt>HOMES00</dt><dd><p>number of homes 2000.</p>
</dd>
<dt>HOMES10</dt><dd><p>number of homes 2010.</p>
</dd>
<dt>POPMAL00</dt><dd><p>male population 2000.</p>
</dd>
<dt>POPMAL10</dt><dd><p>male population 2010.</p>
</dd>
<dt>POPFEM00</dt><dd><p>female population 2000.</p>
</dd>
<dt>POPFEM10</dt><dd><p>female population 2010.</p>
</dd>
<dt>INLANG00</dt><dd><p>5 or more years old population which speaks indigenous language 2000.</p>
</dd>
<dt>INLANG10</dt><dd><p>5 or more years old population which speaks indigenous language 2010.</p>
</dd>
<dt>INCOME00</dt><dd><p>gross income in thousands of Mexican pesos 2000.</p>
</dd>
<dt>INCOME01</dt><dd><p>gross income in thousands of Mexican pesos 2001.</p>
</dd>
<dt>INCOME02</dt><dd><p>gross income in thousands of Mexican pesos 2002.</p>
</dd>
<dt>INCOME03</dt><dd><p>gross income in thousands of Mexican pesos 2003.</p>
</dd>
<dt>PTREES00</dt><dd><p>planted trees 2000.</p>
</dd>
<dt>PTREES01</dt><dd><p>planted trees 2001.</p>
</dd>
<dt>PTREES02</dt><dd><p>planted trees 2002.</p>
</dd>
<dt>PTREES03</dt><dd><p>planted trees 2003.</p>
</dd>
<dt>MARRIA07</dt><dd><p>marriages 2007.</p>
</dd>
<dt>MARRIA08</dt><dd><p>marriages 2008.</p>
</dd>
<dt>MARRIA09</dt><dd><p>marriages 2009.</p>
</dd>
<dt>HARVBE07</dt><dd><p>harvested bean surface in hectares 2007.</p>
</dd>
<dt>HARVBE08</dt><dd><p>harvested bean surface in hectares 2008.</p>
</dd>
<dt>HARVBE09</dt><dd><p>harvested bean surface in hectares 2009.</p>
</dd>
<dt>VALUBE07</dt><dd><p>value of bean production in thousands of Mexican pesos 2007.</p>
</dd>
<dt>VALUBE08</dt><dd><p>value of bean production in thousands of Mexican pesos 2008.</p>
</dd>
<dt>VALUBE09</dt><dd><p>value of bean production in thousands of Mexican pesos 2009.</p>
</dd>
<dt>VOLUBE07</dt><dd><p>volume of bean production in tons 2007.</p>
</dd>
<dt>VOLUBE08</dt><dd><p>volume of bean production in tons 2008.</p>
</dd>
<dt>VOLUBE09</dt><dd><p>volume of bean production in tons 2009.</p>
</dd>
<dt>sHOMES00</dt><dd><p>a sample (column vector of ones and zeros; 1 = selected, 0 = otherwise) of 373 municipalities drawn using the Hajek (1964) maximum-entropy sampling design with inclusion probabilities proportional to the variable HOMES00.</p>
</dd>
<dt>sSURFAC</dt><dd><p>a sample (column vector of ones and zeros; 1 = selected, 0 = otherwise) of 373 municipalities drawn using the Hajek (1964) maximum-entropy sampling design with inclusion probabilities proportional to the variable SURFAC05.</p>
</dd>
<dt>SIZEDIST</dt><dd><p>the size of the district, i.e., the number of municipalities in each district.</p>
</dd>
<dt>sSW_10_3</dt><dd><p>a sample (column vector of ones and zeros; 1 = selected, 0 = otherwise) of 30 municipalities drawn using a self-weighted two-stage sampling design. The first stage draws 10 districts using the Hajek (1964) maximum-entropy sampling design with clusters' inclusion probabilities proportional to the size of the clusters (variable SIZEDIST). The second stage draws 3 municipalities within the selected districts at the first stage, using equal-probability without-replacement sampling.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Mexico's National Institute of Statistics and Geography (INEGI), &lsquo;Instituto Nacional de Estadistica y Geografia&rsquo; http://www.inegi.org.mx/
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                         #Loads the Oaxaca municipalities dataset
mean(oaxaca$INCOME00, na.rm= TRUE)   #Computes INCOME00 mean (note it has NA's)
median(oaxaca$INCOME00, na.rm= TRUE) #Computes INCOME00 median (note it has NA's)
</code></pre>

<hr>
<h2 id='Pk.PropNorm.U'>Inclusion probabilities proportional to a specified variable.</h2><span id='topic+Pk.PropNorm.U'></span>

<h3>Description</h3>

<p>Creates and normalises the 1st order inclusion probabilities proportional to a specified variable. In the current context, normalisation means that the inclusion probabilities are less than or equal to 1. Ideally, they should sum up to <code class="reqn">n</code>, the sample size.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Pk.PropNorm.U(n, VecMOS.U)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pk.PropNorm.U_+3A_n">n</code></td>
<td>
<p>the sample size. It must be an integer or a double-precision scalar with zero-valued fractional part. </p>
</td></tr>
<tr><td><code id="Pk.PropNorm.U_+3A_vecmos.u">VecMOS.U</code></td>
<td>
<p>vector of the variable called measure of size (MOS) to which the first-order inclusion probabilities are to be proportional; its length is equal to the population size. Values in VecMOS.U should be greater than zero (a warning message appears if this does not hold). There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although the normalisation procedure is well-known in the survey sampling literature, we follow the procedure described in Chao (1982, p. 654). Hence, we obtain a unique set of inclusion probabilities that are proportional to the MOS variable.
</p>


<h3>Value</h3>

<p>The function returns a vector of length <code class="reqn">n</code> with the inclusion probabilities.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Chao, M. T. (1982) A general purpose unequal probability sampling plan. <em>Biometrika</em> <b>69</b>, 653&ndash;656.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pkl.Hajek.s">Pkl.Hajek.s</a></code><br /><code><a href="#topic+Pkl.Hajek.U">Pkl.Hajek.U</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca) #Loads the Oaxaca municipalities dataset
             #Creates the normalised 1st order incl. probs. proportional
             #to the variable oaxaca$HOMES00 and with sample size 373
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00)
sum(pik.U)   #Shows the sum is equal to the sample size 373
any(pik.U&gt;1) #Shows there isn't any probability greater than 1
any(pik.U&lt;0) #Shows there isn't any probability less than 0
</code></pre>

<hr>
<h2 id='Pkl.Hajek.s'>The Hajek approximation for the 2nd order (joint) inclusion probabilities (sample based)</h2><span id='topic+Pkl.Hajek.s'></span>

<h3>Description</h3>

<p>Computes the Hajek (1964) approximation for the 2nd order (joint) inclusion probabilities utilising only sample-based quantities.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Pkl.Hajek.s(VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pkl.Hajek.s_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\pi_k</code> denote the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>, and let <code class="reqn">\pi_{kl}</code> denote the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. If the joint-inclusion probabilities <code class="reqn">\pi_{kl}</code> are not available, the Hajek (1964) approximation can be used. Note that this approximation is designed for large-entropy sampling designs, large samples, and large populations, i.e. care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>
<p>The sample-based version of the Hajek (1964) approximation for the joint-inclusion probabilities <code class="reqn">\pi_{kl}</code> (implemented by the current function) is:
</p>
<p style="text-align: center;"><code class="reqn">\pi_{kl}  \doteq  \pi_k \pi_l \{1 - \hat{d}^{-1}(1-\pi_k)(1-\pi_l)\}</code>
</p>

<p>where <code class="reqn">\hat{d} =\sum_{k\in s}(1-\pi_k)</code>.
</p>
<p>The approximation was originally developed for <code class="reqn">d\rightarrow\infty</code>, under the maximum-entropy sampling design (see Hajek 1981, Theorem 3.3, Ch. 3 and 6), the Rejective Sampling design. It requires that the utilised sampling design is of large entropy. An overview can be found in Berger and Tille (2009). An account of different sampling designs, <code class="reqn">\pi_{kl}</code> approximations, and approximate variances under large-entropy designs can be found in Tille (2006), Brewer and Donadio (2003), and Haziza, Mecatti, and Rao (2008). Recently, Berger (2011) gave sufficient conditions under which Hajek's results still hold for large-entropy sampling designs that are not the maximum-entropy one.
</p>


<h3>Value</h3>

<p>The function returns a (<code class="reqn">n</code> by <code class="reqn">n</code>) square matrix with the estimated joint inclusion probabilities, where <code class="reqn">n</code> is the sample size.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2011) Asymptotic consistency under large entropy sampling designs with unequal probabilities. <em>Pakistan Journal of Statististics</em>, <b>27</b>, 407&ndash;426.
</p>
<p>Berger, Y. G. and Tille, Y. (2009) Sampling with unequal probabilities. In <em>Sample Surveys: Design, Methods and Applications</em> (eds. D. Pfeffermann and C. R. Rao), 39&ndash;54. Elsevier, Amsterdam.
</p>
<p>Brewer, K. R. W. and Donadio, M. E. (2003) The large entropy variance of the Horvitz-Thompson estimator. <em>Survey Methodology</em> <b>29</b>, 189&ndash;196.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1981) <em>Sampling From a Finite Population.</em> Dekker, New York.
</p>
<p>Haziza, D., Mecatti, F. and Rao, J. N. K. (2008) Evaluation of some approximate variance estimators under the Rao-Sampford unequal probability sampling design. <em>Metron</em>, <b>LXVI</b>, 91&ndash;108.
</p>
<p>Tille, Y. (2006) <em>Sampling Algorithms.</em> Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pkl.Hajek.U">Pkl.Hajek.U</a></code><br /><code><a href="#topic+Pk.PropNorm.U">Pk.PropNorm.U</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#First 5 rows/cols of (sample-based) 2nd order incl. probs. matrix
pikl.s[1:5,1:5]
</code></pre>

<hr>
<h2 id='Pkl.Hajek.U'>The Hajek approximation for the 2nd order (joint) inclusion probabilities (population based)</h2><span id='topic+Pkl.Hajek.U'></span>

<h3>Description</h3>

<p>Computes the Hajek (1964) approximation for the 2nd order (joint) inclusion probabilities utilising population-based quantities.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>Pkl.Hajek.U(VecPk.U)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Pkl.Hajek.U_+3A_vecpk.u">VecPk.U</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to the population size. Values in <code>VecPk.U</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\pi_k</code> denote the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>, and let <code class="reqn">\pi_{kl}</code> denote the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. If the joint-inclusion probabilities <code class="reqn">\pi_{kl}</code> are not available, the Hajek (1964) approximation can be used. Note that this approximation is designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>
<p>The population-based version of the Hajek (1964) approximation for the joint-inclusion probabilities <code class="reqn">\pi_{kl}</code> (implemented by the current function) is:
</p>
<p style="text-align: center;"><code class="reqn">\pi_{kl}  \doteq  \pi_k \pi_l \{1 - d^{-1}(1-\pi_k)(1-\pi_l)\}</code>
</p>

<p>where <code class="reqn">d =\sum_{k\in U}\pi_k(1-\pi_k)</code>.
</p>
<p>The approximation was originally developed for <code class="reqn">d\rightarrow\infty</code>, under the maximum-entropy sampling design (see Hajek 1981, Theorem 3.3, Ch. 3 and 6), the Rejective Sampling design. It requires that the utilised sampling design is of large entropy. An overview can be found in Berger and Tille (2009). An account of different sampling designs, <code class="reqn">\pi_{kl}</code> approximations, and approximate variances under large-entropy designs can be found in Tille (2006), Brewer and Donadio (2003), and Haziza, Mecatti, and Rao (2008). Recently, Berger (2011) gave sufficient conditions under which Hajek's results still hold for large-entropy sampling designs that are not the maximum-entropy one.
</p>


<h3>Value</h3>

<p>The function returns a (<code class="reqn">N</code> by <code class="reqn">N</code>) square matrix with the estimated joint inclusion probabilities, where <code class="reqn">N</code> is the population size.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2011) Asymptotic consistency under large entropy sampling designs with unequal probabilities. <em>Pakistan Journal of Statististics</em>, <b>27</b>, 407&ndash;426.
</p>
<p>Berger, Y. G. and Tille, Y. (2009) Sampling with unequal probabilities. In <em>Sample Surveys: Design, Methods and Applications</em> (eds. D. Pfeffermann and C. R. Rao), 39&ndash;54. Elsevier, Amsterdam.
</p>
<p>Brewer, K. R. W. and Donadio, M. E. (2003) The large entropy variance of the Horvitz-Thompson estimator. <em>Survey Methodology</em> <b>29</b>, 189&ndash;196.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1981) <em>Sampling From a Finite Population.</em> Dekker, New York.
</p>
<p>Haziza, D., Mecatti, F. and Rao, J. N. K. (2008) Evaluation of some approximate variance estimators under the Rao-Sampford unequal probability sampling design. <em>Metron</em>, <b>LXVI</b>, 91&ndash;108.
</p>
<p>Tille, Y. (2006) <em>Sampling Algorithms.</em> Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Pkl.Hajek.s">Pkl.Hajek.s</a></code><br /><code><a href="#topic+Pk.PropNorm.U">Pk.PropNorm.U</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
#(This approximation is only suitable for large-entropy sampling designs)
pikl.U &lt;- Pkl.Hajek.U(pik.U)                 #Approximates 2nd order incl. probs. from U
#First 5 rows/cols of (population-based) 2nd order incl. probs. matrix
pikl.U[1:5,1:5]
</code></pre>

<hr>
<h2 id='samplingVarEst-package'>Sampling Variance Estimation package</h2><span id='topic+samplingVarEst-package'></span><span id='topic+samplingVarEst'></span>

<h3>Description</h3>

<p>The package contains functions to calculate some point estimators and estimate their variance under unequal probability sampling without replacement. Uni-stage and two-stage sampling designs are considered. The package further contains some approximations for the joint-inclusion probabilities (population and sample based formulae).<br />
</p>
<p>Emphasis has been put on the speed of routines as the package mostly uses C compiled code. Below there is a list of available functions. These are grouped in <em>purpose lists</em>, aiming to clarify their usage.<br />
</p>
<p>The user should pick a suitable combination of a population parameter of interest, a choice of point estimator, and a choice of variance estimator.
</p>

<table>
<tr>
 <td style="text-align: left;">         <b>For these population parameters:</b>       </td><td style="text-align: left;"><b>The available point estimators are:</b></td>
</tr>
<tr>
 <td style="text-align: left;">
                      total:                                       </td><td style="text-align: left;"><code><a href="#topic+Est.Total.NHT">Est.Total.NHT</a></code>                         </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Est.Total.Hajek">Est.Total.Hajek</a></code>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
                      mean:                                        </td><td style="text-align: left;"><code><a href="#topic+Est.Mean.NHT">Est.Mean.NHT</a></code>                          </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Est.Mean.Hajek">Est.Mean.Hajek</a></code>                        </td>
</tr>
<tr>
 <td style="text-align: left;">
                      empirical cumulative distribution function:  </td><td style="text-align: left;"><code><a href="#topic+Est.EmpDistFunc.NHT">Est.EmpDistFunc.NHT</a></code>                   </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Est.EmpDistFunc.Hajek">Est.EmpDistFunc.Hajek</a></code>                 </td>
</tr>
<tr>
 <td style="text-align: left;">
                      ratio:                                       </td><td style="text-align: left;"><code><a href="#topic+Est.Ratio">Est.Ratio</a></code>                             </td>
</tr>
<tr>
 <td style="text-align: left;">
                      correlation coefficient:                     </td><td style="text-align: left;"><code><a href="#topic+Est.Corr.NHT">Est.Corr.NHT</a></code>                          </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Est.Corr.Hajek">Est.Corr.Hajek</a></code>                        </td>
</tr>
<tr>
 <td style="text-align: left;">
                      regression coefficients:                     </td><td style="text-align: left;"><code><a href="#topic+Est.RegCoI.Hajek">Est.RegCoI.Hajek</a></code>                      </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Est.RegCo.Hajek">Est.RegCo.Hajek</a></code>
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;"><b>For these point estimators:</b>         </td><td style="text-align: left;"><b>The available variance estimators</b> for <em>uni-stage samples</em> are:</td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Total.NHT</code>:                     </td><td style="text-align: left;"><code><a href="#topic+VE.HT.Total.NHT">VE.HT.Total.NHT</a></code>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.SYG.Total.NHT">VE.SYG.Total.NHT</a></code>                      </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Hajek.Total.NHT">VE.Hajek.Total.NHT</a></code>                    </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Total.Hajek</code>:                   </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code>                   </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.HT.Total.Hajek">VE.EB.HT.Total.Hajek</a></code>                  </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.SYG.Total.Hajek">VE.EB.SYG.Total.Hajek</a></code>                 </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Mean.NHT</code>:                      </td><td style="text-align: left;"><code><a href="#topic+VE.HT.Mean.NHT">VE.HT.Mean.NHT</a></code>                        </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.SYG.Mean.NHT">VE.SYG.Mean.NHT</a></code>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Hajek.Mean.NHT">VE.Hajek.Mean.NHT</a></code>                     </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Mean.Hajek</code>:                    </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code>                </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code>                    </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.HT.Mean.Hajek">VE.EB.HT.Mean.Hajek</a></code>                   </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.SYG.Mean.Hajek">VE.EB.SYG.Mean.Hajek</a></code>                  </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Ratio</code>:                         </td><td style="text-align: left;"><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code>                      </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code>                     </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code>                    </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code>                   </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code>                         </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code>                        </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>                       </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Corr.NHT</code>:                      </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.Corr.NHT">VE.Jk.Tukey.Corr.NHT</a></code>                  </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Corr.Hajek</code>:                    </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code>                </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code>                    </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.RegCoI.Hajek</code>:                  </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code>            </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code>                  </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.RegCo.Hajek</code>:                   </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                       </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code>
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;"><b>For these point estimators:</b></td><td style="text-align: left;"><b>The available variance estimators</b> for <em>self-weighted two-stage samples</em> are:</td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Total.Hajek</code>:          </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>              </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Mean.Hajek</code>:           </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Ratio</code>:                </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code>                    </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.Corr.Hajek</code>:           </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>               </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.RegCoI.Hajek</code>:         </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>             </td>
</tr>
<tr>
 <td style="text-align: left;">
             <code>Est.RegCo.Hajek</code>:          </td><td style="text-align: left;"><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;"> <b>For the inclusion probabilities:</b>              </td><td style="text-align: left;"><b>The available functions</b> are:  </td>
</tr>
<tr>
 <td style="text-align: left;">
              1st order inclusion probabilities:                   </td><td style="text-align: left;"><code><a href="#topic+Pk.PropNorm.U">Pk.PropNorm.U</a></code>          </td>
</tr>
<tr>
 <td style="text-align: left;">
              2nd order (joint) inclusion probabilities:           </td><td style="text-align: left;"><code><a href="#topic+Pkl.Hajek.s">Pkl.Hajek.s</a></code>            </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   </td><td style="text-align: left;"><code><a href="#topic+Pkl.Hajek.U">Pkl.Hajek.U</a></code>
</td>
</tr>

</table>


<table>
<tr>
 <td style="text-align: left;">                                                       <b>datasets</b>                          </td>
</tr>
<tr>
 <td style="text-align: left;">
                                                                   <code><a href="#topic+oaxaca">oaxaca</a></code>
</td>
</tr>

</table>



<h3>Details</h3>

<p>To return to this description type:<br />
<code>help(samplingVarEst)</code><br />
or type:<br />
<code>?samplingVarEst</code><br />
To cite, use:<br />
<code>citation("samplingVarEst")</code><br />
</p>

<hr>
<h2 id='VE.EB.HT.Mean.Hajek'>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a mean (Horvitz-Thompson form)</h2><span id='topic+VE.EB.HT.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the Hajek estimator of a mean. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.HT.Mean.Hajek(VecY.s, VecPk.s, MatPkl.s,
                    VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.HT.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Mean.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Mean.Hajek_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \breve{\nu}_k \breve{\nu}_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek,k}^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek,k}^{*} = \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l - w_k^{1-\alpha_k}} </code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code><br /><code><a href="#topic+VE.EB.SYG.Mean.Hajek">VE.EB.SYG.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1      &lt;- oaxaca$POP10                       #Defines the variable y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the variable y2
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek mean point estimator using y1
VE.EB.HT.Mean.Hajek(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.EB.HT.Mean.Hajek(y2[s==1], pik.U[s==1], pikl.s, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.EB.HT.Ratio'>The Escobar-Berger unequal probability replicate variance estimator for the estimator of a ratio (Horvitz-Thompson form)</h2><span id='topic+VE.EB.HT.Ratio'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the estimator of a ratio of two totals/means. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.HT.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s,
               VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.HT.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Ratio_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \breve{\nu}_k \breve{\nu}_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{R}-\hat{R}_k^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_k^{*} = \frac{\left(\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k\right)/\left(\sum_{l\in s} w_l - w_k^{1-\alpha_k} \right)}{\left(\sum_{l\in s} w_l x_l - w_k^{1-\alpha_k} x_k\right)/\left(\sum_{l\in s} w_l - w_k^{1-\alpha_k} \right)} = \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l x_l - w_k^{1-\alpha_k} x_k}</code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{R})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{R})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1      &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x       &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.EB.HT.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s) #Using default VecAlpha.s
#Computes the var. est. of the ratio point estimator using y2
VE.EB.HT.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.EB.HT.Total.Hajek'>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a total (Horvitz-Thompson form)</h2><span id='topic+VE.EB.HT.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the Hajek estimator of a total. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.HT.Total.Hajek(VecY.s, VecPk.s, MatPkl.s, N,
                     VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.HT.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Total.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
<tr><td><code id="VE.EB.HT.Total.Hajek_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \breve{\nu}_k \breve{\nu}_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{t}_{Hajek}-\hat{t}_{Hajek,k}^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek,k}^{*} = N \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l - w_k^{1-\alpha_k}} </code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{t}_{Hajek})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{t}_{Hajek})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code><br /><code><a href="#topic+VE.EB.SYG.Total.Hajek">VE.EB.SYG.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N       &lt;- dim(oaxaca)[1]                     #Defines the population size
y1      &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek total point estimator using y1
VE.EB.HT.Total.Hajek(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.EB.HT.Total.Hajek(y2[s==1], pik.U[s==1], pikl.s, N, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.EB.SYG.Mean.Hajek'>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a mean (Sen-Yates-Grundy form)</h2><span id='topic+VE.EB.SYG.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the Hajek estimator of a mean. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.SYG.Mean.Hajek(VecY.s, VecPk.s, MatPkl.s,
                     VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.SYG.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Mean.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Mean.Hajek_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\breve{\nu}_k - \breve{\nu}_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek,k}^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek,k}^{*} = \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l - w_k^{1-\alpha_k}} </code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code><br /><code><a href="#topic+VE.EB.HT.Mean.Hajek">VE.EB.HT.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1      &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek mean point estimator using y1
VE.EB.SYG.Mean.Hajek(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.EB.SYG.Mean.Hajek(y2[s==1], pik.U[s==1], pikl.s, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.EB.SYG.Ratio'>The Escobar-Berger unequal probability replicate variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</h2><span id='topic+VE.EB.SYG.Ratio'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the estimator of a ratio of two totals/means. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.SYG.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s,
                VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.SYG.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Ratio_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\breve{\nu}_k - \breve{\nu}_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{R}-\hat{R}_k^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_k^{*} = \frac{\left(\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k\right)/\left(\sum_{l\in s} w_l - w_k^{1-\alpha_k} \right)}{\left(\sum_{l\in s} w_l x_l - w_k^{1-\alpha_k} x_k\right)/\left(\sum_{l\in s} w_l - w_k^{1-\alpha_k} \right)} = \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l x_l - w_k^{1-\alpha_k} x_k}</code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{R})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{R})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1      &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x       &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.EB.SYG.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s) #Using default VecAlpha.s
#Computes the var. est. of the ratio point estimator using y2
VE.EB.SYG.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.EB.SYG.Total.Hajek'>The Escobar-Berger unequal probability replicate variance estimator for the Hajek (1971) estimator of a total (Sen-Yates-Grundy form)</h2><span id='topic+VE.EB.SYG.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Escobar-Berger (2013) unequal probability replicate variance estimator for the Hajek estimator of a total. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.EB.SYG.Total.Hajek(VecY.s, VecPk.s, MatPkl.s, N,
                      VecAlpha.s = rep.int(1, length(VecPk.s)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.EB.SYG.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Total.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
<tr><td><code id="VE.EB.SYG.Total.Hajek_+3A_vecalpha.s">VecAlpha.s</code></td>
<td>
<p>vector of the <code class="reqn">\alpha_k</code> values; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecAlpha.s</code> can be different for each unit, and must be greater or equal to zero. Escobar-Berger (2013) showed that this replicate variance estimator is valid for <code class="reqn">\alpha_k\geq 0</code>. In particular, they suggest using <code class="reqn">\alpha_k=1</code> for all units in the sample (the default for <code>VecAlpha.s</code> if omitted in the function call). Using <code class="reqn">\alpha_k&gt;1</code> approximates the Demnati-Rao (2004) linearisation variance estimators. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) unequal probability replicate variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\breve{\nu}_k - \breve{\nu}_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\breve{\nu}_k = w_k^{\alpha_k} \left(\hat{t}_{Hajek}-\hat{t}_{Hajek,k}^{*}\right)</code>
</p>

<p>for some <code class="reqn">\alpha_k\geq0</code> (suggested to be 1, see below comments) and with
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek,k}^{*} = N \frac{\sum_{l\in s} w_l y_l - w_k^{1-\alpha_k} y_k}{\sum_{l\in s} w_l - w_k^{1-\alpha_k}} </code>
</p>

<p>Regarding the value of <code class="reqn">\alpha_k</code>, Escobar-Berger (2013) show that <code class="reqn">\hat{V}(\hat{t}_{Hajek})</code> is valid for
<code class="reqn">\alpha_k\geq0</code> but conclude that <code class="reqn">\alpha_k&gt;0</code> should be used as <code class="reqn">\alpha_k=0</code> corresponds to a naive biased and unstable jackknife. They recommend <code class="reqn">\alpha_k=1</code> or <code class="reqn">\alpha_k&gt;1</code>.  If <code class="reqn">\alpha_k=1</code>, <code class="reqn">\hat{V}(\hat{t}_{Hajek})</code> reduces to the Escobar-Berger (2011) jackknife. Using <code class="reqn">\alpha_k&gt;1</code> approximates the empirical influence function, i.e. the Gateaux (1919) derivative, or Demnati-Rao (2004) linearisation variance estimators. The larger the <code class="reqn">\alpha_k</code>, the closer the approximation. Further, Escobar-Berger (2013) give an intuitive explanation of the replication method from a jackknife and bootstrap perspective.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2011) Jackknife variance estimation for functions of Horvitz-Thompson estimators under unequal probability sampling without replacement. In Proceeding of the <em>58th World Statistics Congress</em>. Dublin, Ireland: International Statistical Institute.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A new replicate variance estimator for unequal probability sampling without replacement. <em>Canadian Journal of Statistics</em> <b>41</b>, 3, 508&ndash;524.
</p>
<p>Gateaux, R. (1919) Fonctions d'une infinite de variables indeependantes. <em>Bulletin de la Societe Mathematique de France</em>, <b>47</b>, 70&ndash;96.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code><br /><code><a href="#topic+VE.EB.SYG.Total.Hajek">VE.EB.SYG.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U   &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s       &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N       &lt;- dim(oaxaca)[1]                     #Defines the population size
y1      &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2      &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
Alpha.s &lt;- rep(2, times=373)                  #Defines the vector with Alpha values
#This approximation is only suitable for large-entropy sampling designs
pikl.s  &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek total point estimator using y1
VE.EB.SYG.Total.Hajek(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.EB.SYG.Total.Hajek(y2[s==1], pik.U[s==1], pikl.s, N, Alpha.s)
</code></pre>

<hr>
<h2 id='VE.Hajek.Mean.NHT'>The Hajek variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</h2><span id='topic+VE.Hajek.Mean.NHT'></span>

<h3>Description</h3>

<p>Computes the Hajek (1964) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Hajek.Mean.NHT(VecY.s, VecPk.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Hajek.Mean.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Hajek.Mean.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Hajek.Mean.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N}\sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N}\sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. For large-entropy sampling designs, the variance of <code class="reqn">\hat{\bar{y}}_{NHT}</code> is approximated by the Hajek (1964) variance:
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{\bar{y}}_{NHT}) = \frac{1}{N(N-1)}\left[\sum_{k\in U}\frac{y_k^2}{\pi_k}(1-\pi_k)-dG^2\right]</code>
</p>

<p>with <code class="reqn">d=\sum_{k\in U}\pi_k(1-\pi_k)</code> and <code class="reqn">G=d^{-1}\sum_{k\in U}(1-\pi_k)y_k</code>.
</p>
<p>The variance <code class="reqn">V(\hat{t}_{NHT})</code> can be estimated by the variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{NHT}) = \frac{n}{N^2(n-1)}\left[\sum_{k\in s}\left(\frac{y_k}{\pi_k}\right)^2(1-\pi_k)-\hat{d}\hat{G}^2\right]</code>
</p>

<p>where <code class="reqn">\hat{d}=\sum_{k\in s}(1-\pi_k)</code> and <code class="reqn">\hat{G}=\hat{d}^{-1}\sum_{k\in s}(1-\pi)y_k/\pi_k</code>.
</p>
<p>Note that the Hajek (1964) variance approximation is designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.HT.Mean.NHT">VE.HT.Mean.NHT</a></code><br /><code><a href="#topic+VE.SYG.Mean.NHT">VE.SYG.Mean.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
#Computes the (approximate) var. est. of the NHT point est. for y1
VE.Hajek.Mean.NHT(y1[s==1], pik.U[s==1], N)
#Computes the (approximate) var. est. of the NHT point est. for y2
VE.Hajek.Mean.NHT(y2[s==1], pik.U[s==1], N)
</code></pre>

<hr>
<h2 id='VE.Hajek.Total.NHT'>The Hajek variance estimator for the Narain-Horvitz-Thompson point estimator for a total</h2><span id='topic+VE.Hajek.Total.NHT'></span>

<h3>Description</h3>

<p>Computes the Hajek (1964) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Hajek.Total.NHT(VecY.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Hajek.Total.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Hajek.Total.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{NHT} = \sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. For large-entropy sampling designs, the variance of <code class="reqn">\hat{t}_{NHT}</code> is approximated by the Hajek (1964) variance:
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{t}_{NHT}) = \frac{N}{N-1}\left[\sum_{k\in U}\frac{y_k^2}{\pi_k}(1-\pi_k)-dG^2\right]</code>
</p>

<p>with <code class="reqn">d=\sum_{k\in U}\pi_k(1-\pi_k)</code> and <code class="reqn">G=d^{-1}\sum_{k\in U}(1-\pi_k)y_k</code>.
</p>
<p>The variance <code class="reqn">V(\hat{t}_{NHT})</code> can be estimated by the variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{NHT}) = \frac{n}{n-1}\left[\sum_{k\in s}\left(\frac{y_k}{\pi_k}\right)^2(1-\pi_k)-\hat{d}\hat{G}^2\right]</code>
</p>

<p>where <code class="reqn">\hat{d}=\sum_{k\in s}(1-\pi_k)</code> and <code class="reqn">\hat{G}=\hat{d}^{-1}\sum_{k\in s}(1-\pi)y_k/\pi_k</code>.
</p>
<p>Note that the Hajek (1964) variance approximation is designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.HT.Total.NHT">VE.HT.Total.NHT</a></code><br /><code><a href="#topic+VE.SYG.Total.NHT">VE.SYG.Total.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$SURFAC05) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sSURFAC                      #Defines the sample to be used
y1    &lt;- oaxaca$POP10                        #Defines the variable of interest y1
y2    &lt;- oaxaca$HOMES10                      #Defines the variable of interest y2
#Computes the (approximate) var. est. of the NHT point est. from y1
VE.Hajek.Total.NHT(y1[s==1], pik.U[s==1])
#Computes the (approximate) var. est. of the NHT point est. from y2
VE.Hajek.Total.NHT(y2[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.HT.Mean.NHT'>The Horvitz-Thompson variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</h2><span id='topic+VE.HT.Mean.NHT'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson (1952) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.HT.Mean.NHT(VecY.s, VecPk.s, MatPkl.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.HT.Mean.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.HT.Mean.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.HT.Mean.NHT_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.HT.Mean.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N}\sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N}\sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. Let <code class="reqn">\pi_{kl}</code> denotes the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{NHT}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{\bar{y}}_{NHT}) = \frac{1}{N^2}\sum_{k\in U}\sum_{l\in U} (\pi_{kl}-\pi_k\pi_l)\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>

<p>which can therefore be estimated by the Horvitz-Thompson variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{NHT}) = \frac{1}{N^2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.SYG.Mean.NHT">VE.SYG.Mean.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Mean.NHT">VE.Hajek.Mean.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                  #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$SURFAC05) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sSURFAC                      #Defines the sample to be used
N      &lt;- dim(oaxaca)[1]                      #Defines the population size
y1     &lt;- oaxaca$POP10                        #Defines the variable of interest y1
y2     &lt;- oaxaca$HOMES10                      #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])            #Approx. 2nd order incl. probs. from s
#Computes the variance estimation of the NHT point estimator for y1
VE.HT.Mean.NHT(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the variance estimation of the NHT point estimator for y2
VE.HT.Mean.NHT(y2[s==1], pik.U[s==1], pikl.s, N)
</code></pre>

<hr>
<h2 id='VE.HT.Total.NHT'>The Horvitz-Thompson variance estimator for the Narain-Horvitz-Thompson point estimator for a total</h2><span id='topic+VE.HT.Total.NHT'></span>

<h3>Description</h3>

<p>Computes the Horvitz-Thompson (1952) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.HT.Total.NHT(VecY.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.HT.Total.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.HT.Total.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.HT.Total.NHT_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{NHT} = \sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. Let <code class="reqn">\pi_{kl}</code> denotes the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{NHT}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{t}_{NHT}) = \sum_{k\in U}\sum_{l\in U} (\pi_{kl}-\pi_k\pi_l)\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>

<p>which can therefore be estimated by the Horvitz-Thompson variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{NHT}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.SYG.Total.NHT">VE.SYG.Total.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Total.NHT">VE.Hajek.Total.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the NHT point estimator for y1
VE.HT.Total.NHT(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the NHT point estimator for y2
VE.HT.Total.NHT(y2[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.B.Corr.Hajek'>The Berger (2007) unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.B.Corr.Hajek'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.Corr.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{C}_{Hajek}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}_{Hajek}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{C}_{Hajek}-\hat{C}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{C}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{C}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.B.Corr.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.B.Corr.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.Jk.B.Mean.Hajek'>The Berger (2007) unequal probability jackknife variance estimator for the Hajek estimator of a mean</h2><span id='topic+VE.Jk.B.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the Hajek (1971) estimator of a mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.Mean.Hajek(VecY.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#Computes the var. est. of the Hajek mean point estimator using y1
VE.Jk.B.Mean.Hajek(y1[s==1], pik.U[s==1])
#Computes the var. est. of the Hajek mean point estimator using y2
VE.Jk.B.Mean.Hajek(y2[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.Jk.B.Ratio'>The Berger (2007) unequal probability jackknife variance estimator for the estimator of a ratio</h2><span id='topic+VE.Jk.B.Ratio'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the estimator of a ratio of two totals/means.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.Ratio(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{R}-\hat{R}_{(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_{(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l/\sum_{l\in s, l\neq k} w_l}{\sum_{l\in s, l\neq k} w_l x_l/\sum_{l\in s, l\neq k} w_l} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l x_l}</code>
</p>

<p>Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x      &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#Computes the var. est. of the ratio point estimator using y1
VE.Jk.B.Ratio(y1[s==1], x[s==1], pik.U[s==1])
#Computes the var. est. of the ratio point estimator using y2
VE.Jk.B.Ratio(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.Jk.B.RegCo.Hajek'>The Berger (2007) unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.B.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.RegCo.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\beta}_{Hajek}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\beta}_{Hajek}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\beta}_{Hajek}-\hat{\beta}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\beta}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\beta}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the regression coeff. point estimator using y1
VE.Jk.B.RegCo.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the var. est. of the regression coeff. point estimator using y2
VE.Jk.B.RegCo.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.Jk.B.RegCoI.Hajek'>The Berger (2007) unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.B.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\alpha}_{Hajek}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\alpha}_{Hajek}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\alpha}_{Hajek}-\hat{\alpha}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\alpha}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\alpha}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the intercept reg. coeff. point estimator using y1
VE.Jk.B.RegCoI.Hajek(y1[s==1], x[s==1], pik.U[s==1])
#Computes the var. est. of the intercept reg. coeff. point estimator using y2
VE.Jk.B.RegCoI.Hajek(y2[s==1], x[s==1], pik.U[s==1])
</code></pre>

<hr>
<h2 id='VE.Jk.B.Total.Hajek'>The Berger (2007) unequal probability jackknife variance estimator for the Hajek estimator of a total</h2><span id='topic+VE.Jk.B.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Berger (2007) unequal probability jackknife variance estimator for the Hajek (1971) estimator of a total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.B.Total.Hajek(VecY.s, VecPk.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.B.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.B.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Berger (2007) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \sum_{k\in s} \frac{n}{n-1}(1-\pi_k) \left(\varepsilon_k - \hat{B}\right)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{B} = \frac{\sum_{k\in s}(1-\pi_k) \varepsilon_k}{\sum_{k\in s}(1-\pi_k)}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{t}_{Hajek}-\hat{t}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek(k)} = N \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Berger, Y. G. (2007) A jackknife variance estimator for unistage stratified samples with unequal probabilities. <em>Biometrika</em> <b>94</b>, 953&ndash;964.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N      &lt;- dim(oaxaca)[1]                     #Defines the population size
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#Computes the var. est. of the Hajek total point estimator using y1
VE.Jk.B.Total.Hajek(y1[s==1], pik.U[s==1], N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.Jk.B.Total.Hajek(y2[s==1], pik.U[s==1], N)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.Corr.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.Corr.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Hajek (1971) point estimator. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.Corr.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Corr.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{C}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{C}_{Hajek}-\hat{C}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{C}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{C}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.CBS.HT.Corr.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.CBS.HT.Corr.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.Mean.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a mean (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the Hajek estimator of a mean. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.Mean.Hajek(VecY.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Mean.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek mean point estimator using y1
VE.Jk.CBS.HT.Mean.Hajek(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.Jk.CBS.HT.Mean.Hajek(y2[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.Ratio'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a ratio (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.Ratio'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of a ratio of two totals/means. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{R}-\hat{R}_{(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_{(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l/\sum_{l\in s, l\neq k} w_l}{\sum_{l\in s, l\neq k} w_l x_l/\sum_{l\in s, l\neq k} w_l} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l x_l}</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x      &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.Jk.CBS.HT.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the ratio point estimator using y2
VE.Jk.CBS.HT.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.RegCo.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek (1971) point estimator. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.RegCo.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCo.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\beta}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\beta}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\beta}_{Hajek}-\hat{\beta}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\beta}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\beta}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the regression coeff. point estimator using y1
VE.Jk.CBS.HT.RegCo.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the regression coeff. point estimator using y2
VE.Jk.CBS.HT.RegCo.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.RegCoI.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek (1971) point estimator. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.RegCoI.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\alpha}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\alpha}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\alpha}_{Hajek}-\hat{\alpha}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\alpha}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\alpha}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the intercept reg.  coeff. point estimator using y1
VE.Jk.CBS.HT.RegCoI.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the intercept reg. coeff. point estimator using y2
VE.Jk.CBS.HT.RegCoI.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.HT.Total.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a total (Horvitz-Thompson form)</h2><span id='topic+VE.Jk.CBS.HT.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the Hajek estimator of a total. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.HT.Total.Hajek(VecY.s, VecPk.s, MatPkl.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.HT.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Total.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.HT.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} \varepsilon_k \varepsilon_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{t}_{Hajek}-\hat{t}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek(k)} = N \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N      &lt;- dim(oaxaca)[1]                     #Defines the population size
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek total point estimator using y1
VE.Jk.CBS.HT.Total.Hajek(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.Jk.CBS.HT.Total.Hajek(y2[s==1], pik.U[s==1], pikl.s, N)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.Corr.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.Corr.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Hajek (1971) point estimator. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.Corr.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Corr.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{C}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{C}_{Hajek}-\hat{C}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{C}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{C}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.CBS.SYG.Corr.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.CBS.SYG.Corr.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.Mean.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a mean (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the Hajek estimator of a mean. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.Mean.Hajek(VecY.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Mean.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek mean point estimator using y1
VE.Jk.CBS.SYG.Mean.Hajek(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.Jk.CBS.SYG.Mean.Hajek(y2[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.Ratio'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.Ratio'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of a ratio of two totals/means. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{R}-\hat{R}_{(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_{(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l/\sum_{l\in s, l\neq k} w_l}{\sum_{l\in s, l\neq k} w_l x_l/\sum_{l\in s, l\neq k} w_l} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l x_l}</code>
</p>

<p>The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used for
y1     &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x      &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.Jk.CBS.SYG.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the ratio point estimator using y2
VE.Jk.CBS.SYG.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.RegCo.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of the regression coefficient using the Hajek (1971) point estimator. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.RegCo.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCo.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\beta}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\beta}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\beta}_{Hajek}-\hat{\beta}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\beta}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\beta}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the regression coeff. point estimator using y1
VE.Jk.CBS.SYG.RegCo.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the regression coeff. point estimator using y2
VE.Jk.CBS.SYG.RegCo.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.RegCoI.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek (1971) point estimator. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.RegCoI.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\alpha}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\alpha}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{\alpha}_{Hajek}-\hat{\alpha}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and where <code class="reqn">\hat{\alpha}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\alpha}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x      &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the intercept reg. coeff. point estimator using y1
VE.Jk.CBS.SYG.RegCoI.Hajek(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the intercept reg. coeff. point estimator using y2
VE.Jk.CBS.SYG.RegCoI.Hajek(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Jk.CBS.SYG.Total.Hajek'>The Campbell-Berger-Skinner unequal probability jackknife variance estimator for the Hajek (1971) estimator of a total (Sen-Yates-Grundy form)</h2><span id='topic+VE.Jk.CBS.SYG.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator for the Hajek estimator of a total. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.CBS.SYG.Total.Hajek(VecY.s, VecPk.s, MatPkl.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.CBS.SYG.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Total.Hajek_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.CBS.SYG.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (\varepsilon_k - \varepsilon_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon_k = \left(1-\tilde{w}_k\right) \left(\hat{t}_{Hajek}-\hat{t}_{Hajek(k)}\right)</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\tilde{w}_k = \frac{w_k}{\sum_{l\in s} w_l}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek(k)} = N \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>The Sen-Yates-Grundy form for the Campbell(1980); Berger-Skinner(2005) unequal probability jackknife variance estimator is proposed in Escobar-Berger (2013) under less-restrictive regularity conditions.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Campbell, C. (1980) A different view of finite population estimation. <em>Proceedings of the Survey Research Methods Section of the American Statistical Association</em>, 319&ndash;324.
</p>
<p>Berger, Y. G. and Skinner, C. J. (2005) A jackknife variance estimator for unequal probability sampling. <em>Journal of the Royal Statistical Society B</em>, <b>67</b>, 79&ndash;89.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N      &lt;- dim(oaxaca)[1]                     #Defines the population size
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the Hajek total point estimator using y1
VE.Jk.CBS.SYG.Total.Hajek(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.Jk.CBS.SYG.Total.Hajek(y2[s==1], pik.U[s==1], pikl.s, N)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.Corr.Hajek'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.EB.SW2.Corr.Hajek'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.Corr.Hajek(VecY.s, VecX.s, VecPk.s, nII, VecPi.s,
                         VecCluLab.s, VecCluSize.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e., the fixed number of ultimate sampling units selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Corr.Hajek_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{C}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}_{Hajek}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{C}_{Hajek}-\hat{C}_{Hajek(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{C}_{Hajek}-\hat{C}_{Hajek(k)})</code>
</p>

<p>where  <code class="reqn">\hat{C}_{Hajek(Ii)}</code> and <code class="reqn">\hat{C}_{Hajek(k)}</code> have the same functional form as <code class="reqn">\hat{C}_{Hajek}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Corr.Hajek">VE.Jk.Tukey.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the variable y1
y2.s      &lt;- SampData$POPMAL10        #Defines the variable y2
x.s       &lt;- SampData$HOMES10         #Defines the variable x
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.EB.SW2.Corr.Hajek(y1.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.EB.SW2.Corr.Hajek(y2.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.Mean.Hajek'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek (1971) estimator of a mean</h2><span id='topic+VE.Jk.EB.SW2.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek estimator of a mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.Mean.Hajek(VecY.s, VecPk.s, nII, VecPi.s,
                         VecCluLab.s, VecCluSize.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e., the fixed number of ultimate sampling units selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Mean.Hajek_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{\bar{y}}_{Hajek}-\hat{\bar{y}}_{Hajek(k)})</code>
</p>

<p>where  <code class="reqn">\hat{\bar{y}}_{Hajek(Ii)}</code> and <code class="reqn">\hat{\bar{y}}_{Hajek(k)}</code> have the same functional form as <code class="reqn">\hat{\bar{y}}_{Hajek}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Mean.Hajek">VE.Jk.Tukey.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the variable of interest y1
y2.s      &lt;- SampData$POPMAL10        #Defines the variable of interest y2
#Computes the var. est. of the Hajek mean point estimator using y1
VE.Jk.EB.SW2.Mean.Hajek(y1.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.Jk.EB.SW2.Mean.Hajek(y2.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.Ratio'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a ratio</h2><span id='topic+VE.Jk.EB.SW2.Ratio'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of a ratio of two totals/means.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.Ratio(VecY.s, VecX.s, VecPk.s, nII, VecPi.s,
                   VecCluLab.s, VecCluSize.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e., the fixed number of ultimate sampling units selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Ratio_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{R}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{R}-\hat{R}_{(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{R}-\hat{R}_{(k)})</code>
</p>

<p>where  <code class="reqn">\hat{R}_{(Ii)}</code> and <code class="reqn">\hat{R}_{(k)}</code> have the same functional form as <code class="reqn">\hat{R}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the numerator variable y1
y2.s      &lt;- SampData$POPMAL10        #Defines the numerator variable y2
x.s       &lt;- SampData$HOMES10         #Defines the denominator variable x
#Computes the var. est. of the ratio point estimator using y1
VE.Jk.EB.SW2.Ratio(y1.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
#Computes the var. est. of the ratio point estimator using y2
VE.Jk.EB.SW2.Ratio(y2.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.RegCo.Hajek'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.EB.SW2.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.RegCo.Hajek(VecY.s, VecX.s, VecPk.s, nII, VecPi.s,
                         VecCluLab.s, VecCluSize.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e. the fixed number of ultimate sampling units that were selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCo.Hajek_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{\beta}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\beta}_{Hajek}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{\beta}_{Hajek}-\hat{\beta}_{Hajek(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{\beta}_{Hajek}-\hat{\beta}_{Hajek(k)})</code>
</p>

<p>where  <code class="reqn">\hat{\beta}_{Hajek(Ii)}</code> and <code class="reqn">\hat{\beta}_{Hajek(k)}</code> have the same functional form as <code class="reqn">\hat{\beta}_{Hajek}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the variable y1
y2.s      &lt;- SampData$POPMAL10        #Defines the variable y2
x.s       &lt;- SampData$HOMES10         #Defines the variable x
#Computes the var. est. of the regression coeff. point estimator using y1
VE.Jk.EB.SW2.RegCo.Hajek(y1.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
#Computes the var. est. of the regression coeff. point estimator using y2
VE.Jk.EB.SW2.RegCo.Hajek(y2.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.RegCoI.Hajek'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.EB.SW2.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s, nII, VecPi.s,
                         VecCluLab.s, VecCluSize.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e. the fixed number of ultimate sampling units that were selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.RegCoI.Hajek_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{\alpha}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\alpha}_{Hajek}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{\alpha}_{Hajek}-\hat{\alpha}_{Hajek(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{\alpha}_{Hajek}-\hat{\alpha}_{Hajek(k)})</code>
</p>

<p>where  <code class="reqn">\hat{\alpha}_{Hajek(Ii)}</code> and <code class="reqn">\hat{\alpha}_{Hajek(k)}</code> have the same functional form as <code class="reqn">\hat{\alpha}_{Hajek}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the variable y1
y2.s      &lt;- SampData$POPMAL10        #Defines the variable y2
x.s       &lt;- SampData$HOMES10         #Defines the variable x
#Computes the var. est. of the intercept reg. coeff. point estimator using y1
VE.Jk.EB.SW2.RegCoI.Hajek(y1.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
#Computes the var. est. of the intercept reg. coeff. point estimator using y2
VE.Jk.EB.SW2.RegCoI.Hajek(y2.s, x.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s)
</code></pre>

<hr>
<h2 id='VE.Jk.EB.SW2.Total.Hajek'>The self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek (1971) estimator of a total</h2><span id='topic+VE.Jk.EB.SW2.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the self-weighted two-stage sampling Escobar-Berger (2013) jackknife variance estimator for the Hajek estimator of a total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.EB.SW2.Total.Hajek(VecY.s, VecPk.s, nII, VecPi.s,
                         VecCluLab.s, VecCluSize.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the total sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the elements' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_nii">nII</code></td>
<td>
<p>the second stage sample size, i.e. the fixed number of ultimate sampling units that were selected within each cluster. Its size must be less than or equal to the minimum cluster size in the sample.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_vecpi.s">VecPi.s</code></td>
<td>
<p>vector of the clusters' first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. Values in <code>VecPi.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_vecclulab.s">VecCluLab.s</code></td>
<td>
<p>vector of the clusters' labels for the elements; its length is equal to <code class="reqn">n</code>, the total sample size. The labels must be integer numbers.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_vecclusize.s">VecCluSize.s</code></td>
<td>
<p>vector of the clusters' sizes; its length is equal to <code class="reqn">n</code>, the total sample size. Hence values are expected to be repeated in the utilised sample dataset. None of the sizes must be smaller than <code>nII</code>.</p>
</td></tr>
<tr><td><code id="VE.Jk.EB.SW2.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. If <code class="reqn">s</code> is a self-weighted two-stage sample, the variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Escobar-Berger (2013) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = v_{clu} + v_{obs}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{clu} = \sum_{i\in s} (1-\pi_{Ii}^{*}) \varsigma_{(Ii)}^{2} - \frac{1}{\hat{d}}\left(\sum_{i\in s} (1-\pi_{Ii}) \varsigma_{(Ii)}\right)^{2}</code>
</p>

<p style="text-align: center;"><code class="reqn">v_{obs} = \sum_{k\in s} \phi_k \varepsilon_{(k)}^{2}</code>
</p>

<p>where <code class="reqn">\hat{d}={\sum}_{i\in s}{(1-\pi_{Ii})}</code>, <code class="reqn">\phi_k = I\{k\in s_{i}\}\pi_{Ii}^{*}(M_{i}-n_{II})/(M_{i}-1)</code>, <code class="reqn">\pi_{Ii}^{*} = \pi_{Ii}n_{II}(M_{i}-1)/(n_{II}-1)M_{i}</code>, with <code class="reqn">s_{i}</code> denoting the sample elements from the <code class="reqn">i</code>-th cluster, <code class="reqn">I\{k\in s_{i}\}</code> is an indicator that takes the value <code class="reqn">1</code> if the <code class="reqn">k</code>-th observation is within the <code class="reqn">i</code>-th cluster and <code class="reqn">0</code> otherwise, <code class="reqn">\pi_{Ii}</code> is the inclusion probability of the <code class="reqn">i</code>-th cluster in the sample <code class="reqn">s</code>, <code class="reqn">M_{i}</code> is the size of the <code class="reqn">i</code>-th cluster, <code class="reqn">n_{II}</code> is the sample size within each cluster, <code class="reqn">n_{I}</code> is the number of sampled clusters, and where
</p>
<p style="text-align: center;"><code class="reqn">\varsigma_{(Ii)}=\frac{n_{I}-1}{n_{I}} (\hat{t}_{Hajek}-\hat{t}_{Hajek(Ii)})</code>
</p>

<p style="text-align: center;"><code class="reqn">\varepsilon_{(k)}=\frac{n-1}{n} (\hat{t}_{Hajek}-\hat{t}_{Hajek(k)})</code>
</p>

<p>where  <code class="reqn">\hat{t}_{Hajek(Ii)}</code> and <code class="reqn">\hat{t}_{Hajek(k)}</code> have the same functional form as <code class="reqn">\hat{t}_{Hajek}</code> but omitting the <code class="reqn">i</code>-th cluster and the <code class="reqn">k</code>-th element, respectively, from the sample <code class="reqn">s</code>.
Note that this variance estimator implicitly utilises the Hajek (1964) approximations that are designed for large-entropy sampling designs, large samples, and large populations, i.e., care should be taken with highly-stratified samples, e.g. Berger (2005).
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Berger, Y. G. (2005) Variance estimation with highly stratified sampling designs with unequal probabilities. <em>Australian &amp; New Zealand Journal of Statistics</em>, <b>47</b>, 365&ndash;373.
</p>
<p>Escobar, E. L. and Berger, Y. G. (2013) A jackknife variance estimator for self-weighted two-stage samples. <em>Statistica Sinica</em>, <b>23</b>, 595&ndash;613.
</p>
<p>Hajek, J. (1964) Asymptotic theory of rejective sampling with varying probabilities from a finite population. <em>The Annals of Mathematical Statistics</em>, <b>35</b>, 4, 1491&ndash;1523.
</p>
<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.Total.Hajek">VE.Jk.Tukey.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                          #Loads the Oaxaca municipalities dataset
s         &lt;- oaxaca$sSW_10_3          #Defines the sample to be used
N         &lt;- dim(oaxaca)[1]           #Defines the population size
SampData  &lt;- oaxaca[s==1, ]           #Defines the sample dataset
nII       &lt;- 3                        #Defines the 2nd stage fixed sample size
CluLab.s  &lt;- SampData$IDDISTRI        #Defines the clusters' labels
CluSize.s &lt;- SampData$SIZEDIST        #Defines the clusters' sizes
piIi.s    &lt;- (10 * CluSize.s / 570)   #Reconstructs clusters' 1st order incl. probs.
pik.s     &lt;- piIi.s * (nII/CluSize.s) #Reconstructs elements' 1st order incl. probs.
y1.s      &lt;- SampData$POP10           #Defines the variable of interest y1
y2.s      &lt;- SampData$POPMAL10        #Defines the variable of interest y2
#Computes the var. est. of the Hajek total point estimator using y1
VE.Jk.EB.SW2.Total.Hajek(y1.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s, N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.Jk.EB.SW2.Total.Hajek(y2.s, pik.s, nII, piIi.s, CluLab.s, CluSize.s, N)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.Corr.Hajek'>The Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.Tukey.Corr.Hajek'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.Corr.Hajek(VecY.s, VecX.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.Corr.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is utilised for the finite population correction only, see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.Hajek_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code>, assuming that <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.9), is:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> is the Hajek (1971) point estimator of the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>, 
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{C}_{Hajek}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}_{Hajek}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{C}_{Hajek(k)}-\hat{C}_{Hajek} \right)^2</code>
</p>

<p>where <code class="reqn">\hat{C}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{C}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
Note that we are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code> then the term <code class="reqn">1-n/N</code> is ommited from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.HT.Corr.Hajek">VE.Jk.CBS.HT.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Corr.Hajek">VE.Jk.CBS.SYG.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Corr.Hajek">VE.Jk.B.Corr.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Corr.Hajek">VE.Jk.EB.SW2.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.Tukey.Corr.Hajek(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.Tukey.Corr.Hajek(y2[s==1], x[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.Corr.NHT'>The Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient using the Narain-Horvitz-Thompson point estimator</h2><span id='topic+VE.Jk.Tukey.Corr.NHT'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the estimator of a correlation coefficient of two variables using the Narain (1951); Horvitz-Thompson (1952) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.Corr.NHT(VecY.s, VecX.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.Corr.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.NHT_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is also utilised for the finite population correction; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Corr.NHT_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population correlation coefficient of two variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">C = \frac{\sum_{k\in U} (y_k - \bar{y})(x_k - \bar{x})}{\sqrt{\sum_{k\in U} (y_k - \bar{y})^2}\sqrt{\sum_{k\in U} (x_k - \bar{x})^2}}</code>
</p>

<p>the point estimator of <code class="reqn">C</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{C} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{NHT})(x_k - \hat{\bar{x}}_{NHT})}{\sqrt{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{NHT})^2}\sqrt{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{NHT})^2}}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{NHT}</code> is the Narain (1951); Horvitz-Thompson (1952) estimator for the population mean <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code>,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N}\sum_{k\in s} w_k y_k</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{C}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{C}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{C}_{(k)}-\hat{C} \right)^2</code>
</p>

<p>where <code class="reqn">\hat{C}_{(k)}</code> has the same functional form as <code class="reqn">\hat{C}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Est.Corr.Hajek">Est.Corr.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the corr. coeff. point estimator using y1
VE.Jk.Tukey.Corr.NHT(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the var. est. of the corr. coeff. point estimator using y2
VE.Jk.Tukey.Corr.NHT(y2[s==1], x[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.Mean.Hajek'>The Tukey (1958) jackknife variance estimator for the Hajek estimator of a mean</h2><span id='topic+VE.Jk.Tukey.Mean.Hajek'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the Hajek (1971) estimator of a mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.Mean.Hajek(VecY.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.Mean.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Mean.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Mean.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is also utilised for the finite population correction; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Mean.Hajek_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N} \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{Hajek}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{Hajek}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{\bar{y}}_{Hajek(k)}-\hat{\bar{y}}_{Hajek} \right)^2</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.HT.Mean.Hajek">VE.Jk.CBS.HT.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Mean.Hajek">VE.Jk.CBS.SYG.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Mean.Hajek">VE.Jk.B.Mean.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Mean.Hajek">VE.Jk.EB.SW2.Mean.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#Computes the var. est. of the Hajek mean point estimator using y1
VE.Jk.Tukey.Mean.Hajek(y1[s==1], pik.U[s==1], N)
#Computes the var. est. of the Hajek mean point estimator using y2
VE.Jk.Tukey.Mean.Hajek(y2[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.Ratio'>The Tukey (1958) jackknife variance estimator for the estimator of a ratio</h2><span id='topic+VE.Jk.Tukey.Ratio'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the estimator of a ratio of two totals/means.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.Ratio(VecY.s, VecX.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Ratio_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is also utilised for the finite population correction; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Ratio_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{R}_{(k)}-\hat{R} \right)^2</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{R}_{(k)} = \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l x_l}</code>
</p>

<p>We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><br /><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x     &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#Computes the var. est. of the ratio point estimator using y1
VE.Jk.Tukey.Ratio(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the var. est. of the ratio point estimator using y2
VE.Jk.Tukey.Ratio(y2[s==1], x[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.RegCo.Hajek'>The Tukey (1958) jackknife variance estimator for the estimator of the regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.Tukey.RegCo.Hajek'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the estimator of the regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.RegCo.Hajek(VecY.s, VecX.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.RegCo.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCo.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCo.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCo.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is utilised for the finite population correction only; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCo.Hajek_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population regression coefficient <code class="reqn">\beta</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\beta}_{Hajek} = \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\beta}_{Hajek}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\beta}_{Hajek}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{\beta}_{Hajek(k)}-\hat{\beta}_{Hajek} \right)^2</code>
</p>

<p>where <code class="reqn">\hat{\beta}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\beta}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.RegCoI.Hajek">VE.Jk.Tukey.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCo.Hajek">VE.Jk.CBS.HT.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCo.Hajek">VE.Jk.CBS.SYG.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCo.Hajek">VE.Jk.B.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCo.Hajek">VE.Jk.EB.SW2.RegCo.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the regression coeff. point estimator using y1
VE.Jk.Tukey.RegCo.Hajek(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the var. est. of the regression coeff. point estimator using y2
VE.Jk.Tukey.RegCo.Hajek(y2[s==1], x[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.RegCoI.Hajek'>The Tukey (1958) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek point estimator</h2><span id='topic+VE.Jk.Tukey.RegCoI.Hajek'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the estimator of the intercept regression coefficient using the Hajek (1971) point estimator.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.RegCoI.Hajek(VecY.s, VecX.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.RegCoI.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest Y; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCoI.Hajek_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the variable of interest X; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCoI.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCoI.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is utilised for the finite population correction only; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.RegCoI.Hajek_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>From Linear Regression Analysis, for an imposed population model
</p>
<p style="text-align: center;"><code class="reqn">y=\alpha + \beta x</code>
</p>

<p>the population intercept regression coefficient <code class="reqn">\alpha</code>, assuming that the population size <code class="reqn">N</code> is unknown (see Sarndal et al., 1992, Sec. 5.10), can be estimated by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\alpha}_{Hajek} = \hat{\bar{y}}_{Hajek} - \frac{\sum_{k\in s} w_k (y_k - \hat{\bar{y}}_{Hajek})(x_k - \hat{\bar{x}}_{Hajek})}{\sum_{k\in s} w_k (x_k - \hat{\bar{x}}_{Hajek})^2} \hat{\bar{x}}_{Hajek}</code>
</p>

<p>where <code class="reqn">\hat{\bar{y}}_{Hajek}</code> and <code class="reqn">\hat{\bar{x}}_{Hajek}</code> are the Hajek (1971) point estimators of the population means <code class="reqn">\bar{y} = N^{-1} \sum_{k\in U} y_k</code> and <code class="reqn">\bar{x} = N^{-1} \sum_{k\in U} x_k</code>, respectively,
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{Hajek} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p style="text-align: center;"><code class="reqn">\hat{\bar{x}}_{Hajek} = \frac{\sum_{k\in s} w_k x_k}{\sum_{k\in s} w_k}</code>
</p>

<p>and <code class="reqn">w_k=1/\pi_k</code> with <code class="reqn">\pi_k</code> denoting the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\alpha}_{Hajek}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\alpha}_{Hajek}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{\alpha}_{Hajek(k)}-\hat{\alpha}_{Hajek} \right)^2</code>
</p>

<p>where <code class="reqn">\hat{\alpha}_{Hajek(k)}</code> has the same functional form as <code class="reqn">\hat{\alpha}_{Hajek}</code> but omitting the <code class="reqn">k</code>-th element from the sample <code class="reqn">s</code>.
We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.Tukey.RegCo.Hajek">VE.Jk.Tukey.RegCo.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.RegCoI.Hajek">VE.Jk.CBS.HT.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.RegCoI.Hajek">VE.Jk.CBS.SYG.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.RegCoI.Hajek">VE.Jk.B.RegCoI.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.RegCoI.Hajek">VE.Jk.EB.SW2.RegCoI.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
x     &lt;- oaxaca$HOMES10                     #Defines the variable of interest x
#Computes the var. est. of the intercept reg. coeff. point estimator using y1
VE.Jk.Tukey.RegCoI.Hajek(y1[s==1], x[s==1], pik.U[s==1], N)
#Computes the var. est. of the intercept reg. coeff. point estimator using y2
VE.Jk.Tukey.RegCoI.Hajek(y2[s==1], x[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Jk.Tukey.Total.Hajek'>The Tukey (1958) jackknife variance estimator for the Hajek estimator of a total</h2><span id='topic+VE.Jk.Tukey.Total.Hajek'></span>

<h3>Description</h3>

<p>Computes the Quenouille(1956); Tukey (1958) jackknife variance estimator for the Hajek (1971) estimator of a total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Jk.Tukey.Total.Hajek(VecY.s, VecPk.s, N, FPC= TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Jk.Tukey.Total.Hajek_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Total.Hajek_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Total.Hajek_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part. This information is also utilised for the finite population correction; see <code>FPC</code> below.</p>
</td></tr>
<tr><td><code id="VE.Jk.Tukey.Total.Hajek_+3A_fpc">FPC</code></td>
<td>
<p>logical value. If an ad hoc finite population correction <code class="reqn">FPC=1-n/N</code> is to be used. The default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the approximately unbiased Hajek (1971) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek} = N \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{Hajek}</code> can be estimated by the Quenouille(1956); Tukey (1958) jackknife variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{Hajek}) = \left(1-\frac{n}{N}\right)\frac{n-1}{n}\sum_{k\in s} \left( \hat{t}_{Hajek(k)}-\hat{t}_{Hajek} \right)^2</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{Hajek(k)} = N \frac{\sum_{l\in s, l\neq k} w_l y_l}{\sum_{l\in s, l\neq k} w_l}</code>
</p>

<p>We are implementing the Tukey (1958) jackknife variance estimator using the &lsquo;ad hoc&rsquo; finite population correction <code class="reqn">1-n/N</code> (see Shao and Tu, 1995; Wolter, 2007). If <code>FPC=FALSE</code>, then the term <code class="reqn">1-n/N</code> is omitted from the above formula.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Hajek, J. (1971) Comment on <em>An essay on the logical foundations of survey sampling</em> by Basu, D. in <em>Foundations of Statistical Inference</em> (Godambe, V.P. and Sprott, D.A. eds.), p. 236. Holt, Rinehart and Winston.
</p>
<p>Quenouille, M. H. (1956) Notes on bias in estimation. <em>Biometrika</em>, <b>43</b>, 353&ndash;360.
</p>
<p>Shao, J. and Tu, D. (1995) <em>The Jackknife and Bootstrap</em>. Springer-Verlag, Inc.
</p>
<p>Tukey, J. W. (1958) Bias and confidence in not-quite large samples (abstract). <em>The Annals of Mathematical Statistics</em>, <b>29</b>, 2, p. 614.
</p>
<p>Wolter, K. M. (2007) <em>Introduction to Variance Estimation</em>. 2nd Ed. Springer, Inc.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Jk.CBS.HT.Total.Hajek">VE.Jk.CBS.HT.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Total.Hajek">VE.Jk.CBS.SYG.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.B.Total.Hajek">VE.Jk.B.Total.Hajek</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Total.Hajek">VE.Jk.EB.SW2.Total.Hajek</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                #Loads the Oaxaca municipalities dataset
pik.U &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s     &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N     &lt;- dim(oaxaca)[1]                     #Defines the population size
y1    &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2    &lt;- oaxaca$POPMAL10                    #Defines the variable of interest y2
#Computes the var. est. of the Hajek total point estimator using y1
VE.Jk.Tukey.Total.Hajek(y1[s==1], pik.U[s==1], N)
#Computes the var. est. of the Hajek total point estimator using y2
VE.Jk.Tukey.Total.Hajek(y2[s==1], pik.U[s==1], N, FPC= FALSE)
</code></pre>

<hr>
<h2 id='VE.Lin.HT.Ratio'>The unequal probability linearisation variance estimator for the estimator of a ratio (Horvitz-Thompson form)</h2><span id='topic+VE.Lin.HT.Ratio'></span>

<h3>Description</h3>

<p>Computes the unequal probability Taylor linearisation variance estimator for the estimator of a ratio of two totals/means. It uses the Horvitz-Thompson (1952) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Lin.HT.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Lin.HT.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Lin.HT.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Lin.HT.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Lin.HT.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the unequal probability linearisation variance estimator (implemented by the current function). For details see Woodruff (1971); Deville (1999); Demnati-Rao (2004); Sarndal et al., (1992, Secs. 5.5 and 5.6):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} w_k u_k w_l u_l</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">u_k = \frac{y_k - \hat{R} x_k}{\hat{t}_{x,NHT}}</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{x,NHT} = \sum_{k\in s} w_k x_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of the population total for the (denominator) variable <code>VecX.s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Deville, J.-C. (1999) Variance estimation for complex statistics and estimators: linearization and residual techniques. <em>Survey Methodology</em>, <b>25</b>, 193&ndash;203.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Woodruff, R. S. (1971) A Simple Method for Approximating the Variance of a Complicated Estimate. <em>Journal of the American Statistical Association</em>, <b>66</b>, 334, 411&ndash;414.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.SYG.Ratio">VE.Lin.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.SYG.Ratio">VE.Jk.CBS.SYG.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x      &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.Lin.HT.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the ratio point estimator using y2
VE.Lin.HT.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.Lin.SYG.Ratio'>The unequal probability linearisation variance estimator for the estimator of a ratio (Sen-Yates-Grundy form)</h2><span id='topic+VE.Lin.SYG.Ratio'></span>

<h3>Description</h3>

<p>Computes the unequal probability Taylor linearisation variance estimator for the estimator of a ratio of two totals/means. It uses the Sen (1953); Yates-Grundy(1953) variance form.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.Lin.SYG.Ratio(VecY.s, VecX.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.Lin.SYG.Ratio_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the numerator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecX.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Lin.SYG.Ratio_+3A_vecx.s">VecX.s</code></td>
<td>
<p>vector of the denominator variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code> and <code>VecY.s</code>. There must not be missing values. All values of <code>VecX.s</code> should be greater than zero. A warning is displayed if this does not hold, and computations continue if mathematical expressions allow this kind of values for the denominator variable.</p>
</td></tr>
<tr><td><code id="VE.Lin.SYG.Ratio_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.Lin.SYG.Ratio_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population ratio of two totals/means of the variables <code class="reqn">y</code> and <code class="reqn">x</code>:
</p>
<p style="text-align: center;"><code class="reqn">R = \frac{\sum_{k\in U} y_k/N}{\sum_{k\in U} x_k/N} = \frac{\sum_{k\in U} y_k}{\sum_{k\in U} x_k}</code>
</p>

<p>the ratio estimator of <code class="reqn">R</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{R} = \frac{\sum_{k\in s} w_k y_k}{\sum_{k\in s} w_k x_k}</code>
</p>

<p>where <code class="reqn">w_k=1/\pi_k</code> and <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{R}</code> can be estimated by the unequal probability linearisation variance estimator (implemented by the current function). For details see Woodruff (1971); Deville (1999); Demnati-Rao (2004); Sarndal et al., (1992, Secs. 5.5 and 5.6):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{R}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}} (w_k u_k - w_l u_l)^{2}</code>
</p>

<p>where
</p>
<p style="text-align: center;"><code class="reqn">u_k = \frac{y_k - \hat{R} x_k}{\hat{t}_{x,NHT}}</code>
</p>

<p>with
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{x,NHT} = \sum_{k\in s} w_k x_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of the population total for the (denominator) variable <code>VecX.s</code>.
</p>


<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Demnati, A. and Rao, J. N. K. (2004) Linearization variance estimators for survey data. <em>Survey Methodology</em>, <b>30</b>, 17&ndash;26.
</p>
<p>Deville, J.-C. (1999) Variance estimation for complex statistics and estimators: linearization and residual techniques. <em>Survey Methodology</em>, <b>25</b>, 193&ndash;203.
</p>
<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>
<p>Sarndal, C.-E. and Swensson, B. and Wretman, J. (1992) <em>Model Assisted Survey Sampling</em>. Springer-Verlag, Inc.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Woodruff, R. S. (1971) A Simple Method for Approximating the Variance of a Complicated Estimate. <em>Journal of the American Statistical Association</em>, <b>66</b>, 334, 411&ndash;414.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.Lin.HT.Ratio">VE.Lin.HT.Ratio</a></code><code><a href="#topic+VE.Jk.Tukey.Ratio">VE.Jk.Tukey.Ratio</a></code><br /><code><a href="#topic+VE.Jk.CBS.HT.Ratio">VE.Jk.CBS.HT.Ratio</a></code><br /><code><a href="#topic+VE.Jk.B.Ratio">VE.Jk.B.Ratio</a></code><br /><code><a href="#topic+VE.Jk.EB.SW2.Ratio">VE.Jk.EB.SW2.Ratio</a></code><br /><code><a href="#topic+VE.EB.HT.Ratio">VE.EB.HT.Ratio</a></code><br /><code><a href="#topic+VE.EB.SYG.Ratio">VE.EB.SYG.Ratio</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used for
y1     &lt;- oaxaca$POP10                       #Defines the numerator variable y1
y2     &lt;- oaxaca$POPMAL10                    #Defines the numerator variable y2
x      &lt;- oaxaca$HOMES10                     #Defines the denominator variable x
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the ratio point estimator using y1
VE.Lin.SYG.Ratio(y1[s==1], x[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the ratio point estimator using y2
VE.Lin.SYG.Ratio(y2[s==1], x[s==1], pik.U[s==1], pikl.s)
</code></pre>

<hr>
<h2 id='VE.SYG.Mean.NHT'>The Sen-Yates-Grundy variance estimator for the Narain-Horvitz-Thompson point estimator for a mean</h2><span id='topic+VE.SYG.Mean.NHT'></span>

<h3>Description</h3>

<p>Computes the Sen (1953); Yates-Grundy(1953) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population mean.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.SYG.Mean.NHT(VecY.s, VecPk.s, MatPkl.s, N)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.SYG.Mean.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.SYG.Mean.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.SYG.Mean.NHT_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.SYG.Mean.NHT_+3A_n">N</code></td>
<td>
<p>the population size. It must be an integer or a double-precision scalar with zero-valued fractional part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population mean of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">\bar{y} = \frac{1}{N}\sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">\bar{y}</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{\bar{y}}_{NHT} = \frac{1}{N}\sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. Let <code class="reqn">\pi_{kl}</code> denotes the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{\bar{y}}_{NHT}</code> is given by: 
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{\bar{y}}_{NHT}) = \frac{1}{N^2}\sum_{k\in U}\sum_{l\in U} (\pi_{kl}-\pi_k\pi_l)\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>

<p>which, if the utilised sampling design is of fixed sample size, can therefore be estimated by the Sen-Yates-Grundy variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{\bar{y}}_{NHT}) = \frac{1}{N^2}\frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}}\left(\frac{y_k}{\pi_k}-\frac{y_l}{\pi_l}\right)^2</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.HT.Mean.NHT">VE.HT.Mean.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Mean.NHT">VE.Hajek.Mean.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
N      &lt;- dim(oaxaca)[1]                     #Defines the population size
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
#This approx. is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the NHT point estimator for y1
VE.SYG.Mean.NHT(y1[s==1], pik.U[s==1], pikl.s, N)
#Computes the var. est. of the NHT point estimator for y2
VE.SYG.Mean.NHT(y2[s==1], pik.U[s==1], pikl.s, N)
</code></pre>

<hr>
<h2 id='VE.SYG.Total.NHT'>The Sen-Yates-Grundy variance estimator for the Narain-Horvitz-Thompson point estimator for a total</h2><span id='topic+VE.SYG.Total.NHT'></span>

<h3>Description</h3>

<p>Computes the Sen (1953); Yates-Grundy(1953) variance estimator for the Narain (1951); Horvitz-Thompson (1952) point estimator for a population total.  </p>


<h3>Usage</h3>

<pre><code class='language-R'>VE.SYG.Total.NHT(VecY.s, VecPk.s, MatPkl.s)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VE.SYG.Total.NHT_+3A_vecy.s">VecY.s</code></td>
<td>
<p>vector of the variable of interest; its length is equal to <code class="reqn">n</code>, the sample size. Its length has to be the same as that of <code>VecPk.s</code>. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.SYG.Total.NHT_+3A_vecpk.s">VecPk.s</code></td>
<td>
<p>vector of the first-order inclusion probabilities; its length is equal to <code class="reqn">n</code>, the sample size. Values in <code>VecPk.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
<tr><td><code id="VE.SYG.Total.NHT_+3A_matpkl.s">MatPkl.s</code></td>
<td>
<p>matrix of the second-order inclusion probabilities; its number of rows and columns equals <code class="reqn">n</code>, the sample size. Values in <code>MatPkl.s</code> must be greater than zero and less than or equal to one. There must not be missing values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the population total of the variable <code class="reqn">y</code>:
</p>
<p style="text-align: center;"><code class="reqn">t = \sum_{k\in U} y_k</code>
</p>

<p>the unbiased Narain (1951); Horvitz-Thompson (1952) estimator of <code class="reqn">t</code> is given by:
</p>
<p style="text-align: center;"><code class="reqn">\hat{t}_{NHT} = \sum_{k\in s} \frac{y_k}{\pi_k}</code>
</p>

<p>where <code class="reqn">\pi_k</code> denotes the inclusion probability of the <code class="reqn">k</code>-th element in the sample <code class="reqn">s</code>. Let <code class="reqn">\pi_{kl}</code> denotes the joint-inclusion probabilities of the <code class="reqn">k</code>-th and <code class="reqn">l</code>-th elements in the sample <code class="reqn">s</code>. The variance of <code class="reqn">\hat{t}_{NHT}</code> is given by: 
</p>
<p style="text-align: center;"><code class="reqn">V(\hat{t}_{NHT}) = \sum_{k\in U}\sum_{l\in U} (\pi_{kl}-\pi_k\pi_l)\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}</code>
</p>

<p>which, if the utilised sampling design is of fixed sample size, can therefore be estimated by the Sen-Yates-Grundy variance estimator (implemented by the current function):
</p>
<p style="text-align: center;"><code class="reqn">\hat{V}(\hat{t}_{NHT}) = \frac{-1}{2}\sum_{k\in s}\sum_{l\in s} \frac{\pi_{kl}-\pi_k\pi_l}{\pi_{kl}}\left(\frac{y_k}{\pi_k}-\frac{y_l}{\pi_l}\right)^2</code>
</p>



<h3>Value</h3>

<p>The function returns a value for the estimated variance.
</p>


<h3>Author(s)</h3>

<p>Emilio Lopez Escobar.</p>


<h3>References</h3>

<p>Horvitz, D. G. and Thompson, D. J. (1952) A generalization of sampling without replacement from a finite universe. <em>Journal of the American Statistical Association</em>, <b>47</b>, 663&ndash;685.
</p>
<p>Narain, R. D. (1951) On sampling without replacement with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>3</b>, 169&ndash;175.
</p>
<p>Sen, A. R. (1953) On the estimate of the variance in sampling with varying probabilities. <em>Journal of the Indian Society of Agricultural Statistics</em>, <b>5</b>, 119&ndash;127.
</p>
<p>Yates, F. and Grundy, P. M. (1953) Selection without replacement from within strata with probability proportional to size. <em>Journal of the Royal Statistical Society B</em>, <b>15</b>, 253&ndash;261.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+VE.HT.Total.NHT">VE.HT.Total.NHT</a></code><br /><code><a href="#topic+VE.Hajek.Total.NHT">VE.Hajek.Total.NHT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(oaxaca)                                 #Loads the Oaxaca municipalities dataset
pik.U  &lt;- Pk.PropNorm.U(373, oaxaca$HOMES00) #Reconstructs the 1st order incl. probs.
s      &lt;- oaxaca$sHOMES00                    #Defines the sample to be used
y1     &lt;- oaxaca$POP10                       #Defines the variable of interest y1
y2     &lt;- oaxaca$HOMES10                     #Defines the variable of interest y2
#This approximation is only suitable for large-entropy sampling designs
pikl.s &lt;- Pkl.Hajek.s(pik.U[s==1])           #Approx. 2nd order incl. probs. from s
#Computes the var. est. of the NHT point estimator for y1
VE.SYG.Total.NHT(y1[s==1], pik.U[s==1], pikl.s)
#Computes the var. est. of the NHT point estimator for y2
VE.SYG.Total.NHT(y2[s==1], pik.U[s==1], pikl.s)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
