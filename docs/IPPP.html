<!DOCTYPE html><html lang="en"><head><title>Help for package IPPP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IPPP}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#IPPP-package'>
<p>Inhomogeneous Poisson Point Processes</p></a></li>
<li><a href='#IPPPcond'><p>Simulate Location of Events for a Fixed Number of Events</p></a></li>
<li><a href='#IPPPconddens'><p>Conditional Probability Density Given the Location of one Event</p></a></li>
<li><a href='#IPPPcondrandnum'>
<p>Generate Events Relative to a Known Event of an Inhomogeneous Poisson Point Process</p></a></li>
<li><a href='#IPPPinterval'>
<p>Simulate the Number of Events in an Interval</p></a></li>
<li><a href='#IPPPnthpointdens'><p> Probability Density of Events in an Inhomogeneous Poisson Point Process</p></a></li>
<li><a href='#IPPPuncond'><p>Simulate Events according to an Inhomogeneous Poisson Point Process</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Inhomogeneous Poisson Point Processes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-05-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Niklas Hohmann</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates random numbers corresponding to the events on a Poisson point process with changing event rates. This includes the possibility to incorporate additional information such as the number of events occurring or the location of an already known event. It can also generate the probability density functions of specific events in the cases where additional information is available. Based on Hohmann (2019) &lt;<a href="https://doi.org/10.48550/arXiv.1901.10754">doi:10.48550/arXiv.1901.10754</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-05-21 11:02:45 UTC; nick</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-05-21 12:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='IPPP-package'>
Inhomogeneous Poisson Point Processes
</h2><span id='topic+IPPP-package'></span><span id='topic+IPPP'></span>

<h3>Description</h3>

<p>Generates random numbers corresponding to the events on a Poisson point process with changing event rates. This includes the possibility to incorporate additional information such as the number of events occurring or the location of an already known event. It can also generate the probability density functions of specific events in the cases where additional information is available. Based on Hohmann (2019) &lt;arXiv:1901.10754&gt;.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> IPPP</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Inhomogeneous Poisson Point Processes</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-05-21</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Niklas Hohmann</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Generates random numbers corresponding to the events on a Poisson point process with changing event rates. This includes the possibility to incorporate additional information such as the number of events occurring or the location of an already known event. It can also generate the probability density functions of specific events in the cases where additional information is available. Based on Hohmann (2019) &lt;arXiv:1901.10754&gt;.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> CC BY 4.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> stats</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> 
knitr,
rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
IPPP-package            Inhomogeneous Poisson Point Processes
IPPPcond                Simulate Location of Events for a Fixed Number
                        of Events
IPPPconddens            Conditional Probability Density Given the
                        Location of one Event
IPPPcondrandnum         Generate Events Relative to a Known Event of an
                        Inhomogeneous Poisson Point Process
IPPPinterval            Simulate the Number of Events in an Interval
IPPPnthpointdens        Probability Density of Events in an
                        Inhomogeneous Poisson Point Process
IPPPuncond              Simulate Events according to an Inhomogeneous
                        Poisson Point Process
</pre>
<p>For the vignette, use <code>vignette("IPPP")</code>
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann
</p>
<p>Maintainer: Niklas Hohmann &lt;Niklas.Hohmann@fau.de&gt;
</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>

<hr>
<h2 id='IPPPcond'>Simulate Location of Events for a Fixed Number of Events</h2><span id='topic+IPPPcond'></span>

<h3>Description</h3>

<p>Returns a vector of random numbers that correspond to the location of events of an inhomogeneous Poisson point process (IPPP) in the case that the number of events is fixed.
</p>
<p>The IPPP is described by a rate function r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPcond(samplesize, xrate, yrate, rnpr = 100)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPcond_+3A_samplesize">samplesize</code></td>
<td>
<p>Natural number. The number of events occurring</p>
</td></tr>
<tr><td><code id="IPPPcond_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPcond_+3A_yrate">yrate</code></td>
<td>
<p>Vector of positive real numbers of the same length as xrate. The vectors xrate and yrate form the rate function r in the sense that r=approxfun(xrate,yrate)</p>
</td></tr>
<tr><td><code id="IPPPcond_+3A_rnpr">rnpr</code></td>
<td>
<p>OPTIONAL, default is 100. The number of random numbers used per run in the loop of the rejection method. For details see the corresponding preprint</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Below min(xrate) and above max(xrate), the rate function r is assumed to have the value zero.
</p>


<h3>Value</h3>

<p>A vector of length samplesize, containing the locations of the simulated events</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IPPPuncond">IPPPuncond</a></code> for the unconditioned version with a random number of events occurring.
</p>
<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#define rate function
sx=1:5
sy=c(0,1,1,3,0)
sm=c(1,0,1,0,-1)
xrate=seq(1,5,length.out=100)
yrate=splinefunH(sx,sy,sm)(xrate)
#plot rate function
plot(xrate,yrate,type='l',xlim=c(0.5,5.5), main='Rate Function')
#simulate location of 5 events:
samplesize=5
p5=IPPPcond(samplesize,xrate,yrate) 
points(p5,rep(0,samplesize),cex=2) #plot results
#simulate location of 30 events
samplesize=30
p30=IPPPcond(samplesize,xrate,yrate) 
points(p30,rep(1,samplesize),cex=2,pch=3) #compare with former results
</code></pre>

<hr>
<h2 id='IPPPconddens'>Conditional Probability Density Given the Location of one Event</h2><span id='topic+IPPPconddens'></span>

<h3>Description</h3>

<p>Given knowledge of the location of one event, this function determines the probability density function (pdf) of the distribution of the n-th point above/below
the known event.</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPconddens(x, pointlocation, xrate, yrate, nthpoint = 1, mode = "forward")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPconddens_+3A_x">x</code></td>
<td>
<p>Points at which the values of the pdf are determined</p>
</td></tr>
<tr><td><code id="IPPPconddens_+3A_pointlocation">pointlocation</code></td>
<td>
<p>Location of the known event</p>
</td></tr>
<tr><td><code id="IPPPconddens_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPconddens_+3A_yrate">yrate</code></td>
<td>
<p>Vector of strictly positive real numbers of the same length as xrate. The vectors xrate and yrate form the rate function r in the sense that r=approxfun(xrate,yrate)</p>
</td></tr>
<tr><td><code id="IPPPconddens_+3A_nthpoint">nthpoint</code></td>
<td>
<p>OPTIONAL, default is 1. Setting this to a value i will determine the pdf of the ith event above/below the event at the position pointlocation.</p>
</td></tr>
<tr><td><code id="IPPPconddens_+3A_mode">mode</code></td>
<td>
<p>OPTIONAL, default is &quot;forward&quot;. Determines whether the pdf for points above(right) the known event is determined (mode=&quot;forward&quot;), or whether the pdf for points below(left) the known event is determined (mode=&quot;backward&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of the rate function r below min(xrate) is set to r(min(xrate)), and for values above max(xrate) it is set to r(max(xrate)). Both r(min(xrate)) and r(max(xrate)) need to be strictly positive for the results to be correct.</p>


<h3>Value</h3>

<p>Returns a list containing two entries:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>Duplicate of the input of the same name</p>
</td></tr>
<tr><td><code>densval</code></td>
<td>
<p>Vector consisting of the values of the conditional probability density, evaluated at x</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IPPPnthpointdens">IPPPnthpointdens</a></code> for the probability density of the location of the of the n-th event, given that a fixed number of events occur.
</p>
<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#define rate function
xrate=seq(0,2*pi,length.out=1000)
yrate=sin(xrate)+1.01
plot(xrate,yrate,type="l",main="Rate Function")
#define known event:
pointlocation=3
lines(c(3,3),c(0,3),lwd=3)
#values where the density is calulated:
x=xrate
#simulate the pdf of the event above the known event:
r1=IPPPconddens(x,pointlocation,xrate,yrate)
lines(r1$x,r1$densval,col="red",lwd=3)
#simulate the pdf of the event below the known event:
r2=IPPPconddens(x,pointlocation,xrate,yrate,mode="backward")
lines(r2$x,r2$densval,col="blue",lwd=3)
#simulate the pdf of the third event below the known event:
r2=IPPPconddens(x,pointlocation,xrate,yrate,mode="backward",nthpoint=3)
lines(r2$x,r2$densval,col="green",lwd=3)
</code></pre>

<hr>
<h2 id='IPPPcondrandnum'>
Generate Events Relative to a Known Event of an Inhomogeneous Poisson Point Process
</h2><span id='topic+IPPPcondrandnum'></span>

<h3>Description</h3>

<p>Given knowledge of the location of one event from an inhomogeneous Poisson point process (IPPP), this function determines random numbers corresponding to the location of the n-th event above/below the known event.
</p>
<p>The IPPP is described by a rate function r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPcondrandnum(pointlocation, xrate, yrate, no = 1, nthpoint = 1, mode = "forward")</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPcondrandnum_+3A_pointlocation">pointlocation</code></td>
<td>
<p>Location of the known event</p>
</td></tr>
<tr><td><code id="IPPPcondrandnum_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPcondrandnum_+3A_yrate">yrate</code></td>
<td>
<p>Vector of strictly positive real numbers of the same length as
xrate. The vectors xrate and yrate form the rate function r in the sense
that r=approxfun(xrate,yrate)</p>
</td></tr>
<tr><td><code id="IPPPcondrandnum_+3A_no">no</code></td>
<td>
<p>OPTIONAL, default is 1. The number of random events to generate</p>
</td></tr>
<tr><td><code id="IPPPcondrandnum_+3A_nthpoint">nthpoint</code></td>
<td>
<p>OPTIONAL, default is 1. Setting this to a value i will simulate the location of the ith event above/below the event at the position pointlocation</p>
</td></tr>
<tr><td><code id="IPPPcondrandnum_+3A_mode">mode</code></td>
<td>
<p>OPTIONAL, default is &quot;forward&quot;. Determines whether the pdf for points above(right) the known event is determined (mode=&quot;forward&quot;&quot;), or whether the pdf for points below(left) the known event is determined (mode=&quot;backward&quot;&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The value of rate function r below min(xrate) is set to r(min(xrate)), and for values above max(xrate) it is set to r(max(xrate)). Both r(min(xrate)) and r(max(xrate)) need to be strictly positive for the results to be correct.</p>


<h3>Value</h3>

<p>Vector of length no, containing the locations of the simulated events.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#define rate function
xrate=seq(0,2*pi,length.out=1000)
yrate=sin(xrate)+1.01
plot(xrate,yrate,type="l",main="Rate Function")
#define known event:
pointlocation=3
lines(c(3,3),c(0,3),lwd=3)
#values where the density is calulated:
x=xrate
#simulate the next point above the known event:
p1=IPPPcondrandnum(pointlocation, xrate,yrate)
points(p1,0.5,pch=1,cex=2)
#simulate 10 times the next event below the known location:
p2=IPPPcondrandnum(pointlocation, xrate,yrate,no=10,mode="backward")
points(p2,rep(1,length(p2)),cex=2,pch=2)
#simulate the second point above the known event:
p3=IPPPcondrandnum(pointlocation, xrate,yrate,no=1,nthpoint=2)
points(p3,1.5,cex=2,pch=3) #might be out of the plot
</code></pre>

<hr>
<h2 id='IPPPinterval'>
Simulate the Number of Events in an Interval
</h2><span id='topic+IPPPinterval'></span>

<h3>Description</h3>

<p>Generates random numbers that correspond to the number of events of an inhomogeneous Poisson point process (IPPP) in a given interval.
</p>
<p>The IPPP is described by a rate function r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPinterval(from, to, xrate, yrate, no = 1, expsamplesize = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPinterval_+3A_from">from</code></td>
<td>
<p>Real number, describing the lower boundary of the interval of interest</p>
</td></tr>
<tr><td><code id="IPPPinterval_+3A_to">to</code></td>
<td>
<p>Real number larger than from, describing the upper boundary of the interval of interest</p>
</td></tr>
<tr><td><code id="IPPPinterval_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPinterval_+3A_yrate">yrate</code></td>
<td>
<p>Vector of positive real numbers of the same length as xrate. The vectors xrate and yrate form the rate function r in the sense that r=approxfun(xrate,yrate)</p>
</td></tr>
<tr><td><code id="IPPPinterval_+3A_no">no</code></td>
<td>
<p>OPTIONAL, default is 1. The number of times the random number is determined</p>
</td></tr>
<tr><td><code id="IPPPinterval_+3A_expsamplesize">expsamplesize</code></td>
<td>
<p>OPTIONAL, default is NULL. Setting this parameter to a numeric value changes the average number of events generated by the IPPP as a whole to the chosen value. The number of events in the interval changes accordingly</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Below min(xrate) and above max(xrate), the rate function r is assumed to have
the value zero.</p>


<h3>Value</h3>

<p>Vector of length no, whose i-th entry contains the number of events in the interval generated in the i-th run.
</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#determine rate function
sx=1:5
sy=c(0,1,1,3,0)
sm=c(1,0,1,0,-1)
xrate=seq(1,5,length.out=100)
yrate=splinefunH(sx,sy,sm)(xrate)
#plot rate function
plot(xrate,yrate,type='l',xlim=c(0.5,5.5), main='Rate Function') 
#determine no of events between 3 and 6
from=3
to=5
lines(c(from,from),c(0,10)) #mark interval in the plot
lines(c(to,to),c(0,10))
#simulate the number of events in the interval [from, to]
IPPPinterval(from,to,xrate,yrate) #simulate the number of events in the interval [from, to]
#rescale so that the whole rate function will on average generate 200 events:
IPPPinterval(from,to,xrate,yrate,expsamplesize=200)
#now more events occur in the interval [from, to]!
#Make 20 repetitions of the upper simulation
IPPPinterval(from,to,xrate,yrate,no=20,expsamplesize=200)
</code></pre>

<hr>
<h2 id='IPPPnthpointdens'> Probability Density of Events in an Inhomogeneous Poisson Point Process</h2><span id='topic+IPPPnthpointdens'></span>

<h3>Description</h3>

<p>Determines values of the probability density function of the n-th point of an inhomogeneous Poisson point process (IPPP), given that a fixed number of events occur.
The IPPP is described by a rate function r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPnthpointdens(x, n, samplesize, xrate, yrate)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPnthpointdens_+3A_x">x</code></td>
<td>
<p>Vector of real numbers where the value of the probability density is determined</p>
</td></tr>
<tr><td><code id="IPPPnthpointdens_+3A_n">n</code></td>
<td>
<p>Natural number smaller than samplesize. Determines the event for which the probability density is determined. 1=first event from the left, i=i-th event from the left.</p>
</td></tr>
<tr><td><code id="IPPPnthpointdens_+3A_samplesize">samplesize</code></td>
<td>
<p>Natural number. The overall number of events occurring</p>
</td></tr>
<tr><td><code id="IPPPnthpointdens_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPnthpointdens_+3A_yrate">yrate</code></td>
<td>
<p>Vector of positive real numbers of the same length as xrate. The vectors xrate and yrate form the rate function r in the sense that r=approxfun(xrate,yrate)</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Below min(xrate) and above max(xrate), the rate function r is assumed to have the value zero.</p>


<h3>Value</h3>

<p>A list containing two entries:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>A duplicate of the input of the same name</p>
</td></tr>
<tr><td><code>densval</code></td>
<td>
<p>A vector consisting of the values of the probability density, evaluated at x</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IPPPconddens">IPPPconddens</a></code> for the probability density of the n-th event above/below the location of some given event. 
</p>
<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sx=c(1,2,3,4,5)
sy=c(0,1,1,3,0)
sm=c(1,0,1,0,-1)
xrate=seq(1,5,length.out=100)
yrate=splinefunH(sx,sy,sm)(xrate)
#plot rate function
plot(xrate,yrate,type='l',xlim=c(0.5,5.5), main='Rate Function') 

x=seq(0,6,length.out = 1000) #point where the pdf is determined
n=1          #get the pdf of the first point from the left ...
samplesize=5  #... out of a sample of five
ll=IPPPnthpointdens(x,n,samplesize,xrate,yrate)
plot(ll$x,ll$densval,type='l') #plot the resulting pdf
legend('topleft',legend=paste('pdf of point no.',as.character(n),
'out of ',as.character(samplesize)), 'points' ,lty=1)
</code></pre>

<hr>
<h2 id='IPPPuncond'>Simulate Events according to an Inhomogeneous Poisson Point Process</h2><span id='topic+IPPPuncond'></span>

<h3>Description</h3>

<p>Generates random numbers corresponding to the locations of events of an inhomogeneous Poisson point process (IPPP). The IPPP is described by a rate function r.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IPPPuncond(xrate, yrate, expsamplesize = NULL, rnpr = 100)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="IPPPuncond_+3A_xrate">xrate</code></td>
<td>
<p>Vector of (strictly increasing) real numbers</p>
</td></tr>
<tr><td><code id="IPPPuncond_+3A_yrate">yrate</code></td>
<td>
<p>Vector of positive real numbers of the same length as xrate. The vectors xrate and yrate form the rate function r in the sense that r=approxfun(xrate,yrate)</p>
</td></tr>
<tr><td><code id="IPPPuncond_+3A_expsamplesize">expsamplesize</code></td>
<td>
<p>OPTIONAL, default is NULL. If this variable is set to a numeric value, it determines the average number of events occurring</p>
</td></tr>
<tr><td><code id="IPPPuncond_+3A_rnpr">rnpr</code></td>
<td>
<p>OPTIONAL, default is 100. The number of random numbers used per run in the loop of the rejection method. For more details see the corresponding preprint</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Below min(xrate) and above max(xrate), the rate function r is assumed to have
the value zero.</p>


<h3>Value</h3>

<p>A vector of variable length, containing the generated locations of the events. If no events occur, the output is numeric(0)</p>


<h3>Author(s)</h3>

<p>Niklas Hohmann</p>


<h3>References</h3>

<p>Hohmann, Niklas. &quot;Conditional Densities and Simulations of Inhomogeneous Poisson Point Processes: The R package &quot;IPPP&quot;&quot; arXiv 2019. &lt;arXiv:1901.10754&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IPPPuncond">IPPPuncond</a></code> for a version with a fixed number of events occurring.
</p>
<p><code>vignette("IPPP")</code> for an overview of the features of the IPPP package and some background.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Define rate function
sx=1:5
sy=c(0,1,1,3,0)
sm=c(1,0,1,0,-1)
xrate=seq(1,5,length.out=100)
yrate=splinefunH(sx,sy,sm)(xrate)
#plot rate function
plot(xrate,yrate,type='l',xlim=c(0.5,5.5), main='Rate Function') 

p=IPPPuncond(xrate,yrate) #simulate one set of events
points(p,rep(0,length(p)),cex=2) #plot results
#simulate location of events with the expected number of events being 20
expsamplesize=20
pp=IPPPuncond(xrate,yrate,expsamplesize) 
length(pp) #in most cases, the result is not exactely 20
points(pp,rep(1,length(pp)),cex=2,pch=3) #compare with former results
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
