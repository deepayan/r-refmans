<!DOCTYPE html><html><head><title>Help for package ppdiag</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ppdiag}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#drawHPIntensity'><p>Draw the intensity of Hawkes Process</p></a></li>
<li><a href='#drawHPPIntensity'><p>Draw intensity of homogeneous Poisson process</p></a></li>
<li><a href='#drawUniMMHPIntensity'><p>Draw the intensity of the Markov-modulated Hawkes Process(MMHP)</p></a></li>
<li><a href='#drawUniMMPPIntensity'><p>Draw the intensity of the Markov-modulated Poisson Process(MMPP)</p></a></li>
<li><a href='#fithp'><p>Determine the MLE of Hawkes process numerically</p></a></li>
<li><a href='#fithpp'><p>Fit a homogeneous poisson process to event data</p></a></li>
<li><a href='#hawkes_max_intensity'><p>max intensity of a hawkes process</p></a></li>
<li><a href='#intensityqqplot'><p>Draw intensity of fitted point process and QQ-Plot of rescaled events</p></a></li>
<li><a href='#interpolate_mmhp_latent'><p>Interpolate latent process of MMHP</p></a></li>
<li><a href='#mmhp_event_state'><p>Estimate the latent state for events of an MMHP</p></a></li>
<li><a href='#mmpp_event_state'><p>Estimate the latent state for events of an MMPP</p></a></li>
<li><a href='#mmpp_latent'><p>Estimate Latent process of MMPP</p></a></li>
<li><a href='#negloglik'><p>Compute negative log likelihood for point process models</p></a></li>
<li><a href='#negloglik_hp'><p>Fit a Hawkes process with exponential kernel to event data</p></a></li>
<li><a href='#pearsonresidual'><p>Compute Pearson residuals for point process models</p></a></li>
<li><a href='#pp_compensator'><p>Compensators for point processes</p></a></li>
<li><a href='#pp_diag'><p>Summarise diagnostics for point process models</p></a></li>
<li><a href='#pp_hp'><p>Create a Hawkes process object</p></a></li>
<li><a href='#pp_hpp'><p>Create a homogeneous Poisson process object</p></a></li>
<li><a href='#pp_ksplot'><p>KS plot of empirical and theoretical cdf curve of fitted point process</p></a></li>
<li><a href='#pp_mmhp'><p>Create a Markov-modulated Hawkes Process(MMHP) object</p></a></li>
<li><a href='#pp_mmpp'><p>Create a Markov-modulated Poisson Process(MMPP) object</p></a></li>
<li><a href='#pp_qqexp'><p>Plot QQ-plot for rescaled-inter-event-times of fitted point process</p></a></li>
<li><a href='#pp_residual'><p>Compute raw and pearson residuals for point process models</p></a></li>
<li><a href='#pp_simulate'><p>Simulate events from a temporal point process</p></a></li>
<li><a href='#rawresidual'><p>Compute raw residuals for point process models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Diagnosis and Visualizations Tools for Temporal Point Processes</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A suite of diagnostic tools for univariate point processes.
    This includes tools for simulating and fitting both common and more
    complex temporal point processes. We also include functions to 
    visualise these point processes and collect existing diagnostic
    tools of Brown et al. (2002) &lt;<a href="https://doi.org/10.1162%2F08997660252741149">doi:10.1162/08997660252741149</a>&gt; and
    Wu et al. (2021) &lt;<a href="https://doi.org/10.1002%2F9781119821588.ch7">doi:10.1002/9781119821588.ch7</a>&gt;,
    which can be used to assess the fit of a chosen point process
    model.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://owenward.github.io/ppdiag/">https://owenward.github.io/ppdiag/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OwenWard/ppdiag/issues">https://github.com/OwenWard/ppdiag/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), knitr, rmarkdown, covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-12 13:15:10 UTC; owenw</td>
</tr>
<tr>
<td>Author:</td>
<td>Sally Sun [aut],
  Owen G. Ward <a href="https://orcid.org/0000-0002-9678-3542"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Jing Wu [aut],
  Xiaoxi Zhao [aut],
  Lihao Xiao [ctb],
  Tian Zheng [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Owen G. Ward &lt;owen.ward@columbia.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-12 13:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='drawHPIntensity'>Draw the intensity of Hawkes Process</h2><span id='topic+drawHPIntensity'></span>

<h3>Description</h3>

<p>Draw the intensity of a Hawkes Process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawHPIntensity(
  hp = NULL,
  events,
  int_title = "Hawkes Intensity",
  start = 0,
  end = max(events),
  history = NULL,
  color = 1,
  i = 1,
  add = FALSE,
  fit = FALSE,
  plot_events = TRUE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawHPIntensity_+3A_hp">hp</code></td>
<td>
<p>object parameters for Hawkes process.</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_events">events</code></td>
<td>
<p>the event times happened in this state</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_int_title">int_title</code></td>
<td>
<p>title of the intensity plot</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_start">start</code></td>
<td>
<p>the start time of current state</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_end">end</code></td>
<td>
<p>the end time of current state</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_history">history</code></td>
<td>
<p>the past event times</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_color">color</code></td>
<td>
<p>specify the default plotting color.</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_i">i</code></td>
<td>
<p>state number, used only for drawUniMMHPIntensity</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_add">add</code></td>
<td>
<p>whether to add the hawkes intensity to an existing plot, used
for drawUniMMHPIntensity</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_fit">fit</code></td>
<td>
<p>a boolean indicating whether to fit a new HP to events</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_plot_events">plot_events</code></td>
<td>
<p>indicate whether events will be plotted</p>
</td></tr>
<tr><td><code id="drawHPIntensity_+3A_verbose">verbose</code></td>
<td>
<p>whether to output informative messages as running</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, intensity plot of Hawkes process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
hp_obj &lt;- pp_hp(lambda0 = 0.5, alpha = 0.45, beta = 0.5)
events &lt;- pp_simulate(hp_obj, start = 0, end = 20)
drawHPIntensity(hp_obj, events)
</code></pre>

<hr>
<h2 id='drawHPPIntensity'>Draw intensity of homogeneous Poisson process</h2><span id='topic+drawHPPIntensity'></span>

<h3>Description</h3>

<p>Draw the intensity for a homogeneous Poisson process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawHPPIntensity(
  hpp = NULL,
  events,
  int_title = "Homogeneous Poisson Process",
  start = 0,
  end = max(events),
  color = "red",
  plot_events = TRUE,
  fit = FALSE,
  add = FALSE,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawHPPIntensity_+3A_hpp">hpp</code></td>
<td>
<p>object for homogeneous Poisson process</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_events">events</code></td>
<td>
<p>event times input</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_int_title">int_title</code></td>
<td>
<p>the plot title</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_start">start</code></td>
<td>
<p>start of events</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_end">end</code></td>
<td>
<p>end of events</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_color">color</code></td>
<td>
<p>a specification for the default plotting color.</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_plot_events">plot_events</code></td>
<td>
<p>a boolean indicating whether input events will be plotted</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_fit">fit</code></td>
<td>
<p>a boolean indicating whether to fit a hpp or
use the passed object</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_add">add</code></td>
<td>
<p>whether to add the hpp intensity to an existing plot</p>
</td></tr>
<tr><td><code id="drawHPPIntensity_+3A_verbose">verbose</code></td>
<td>
<p>whether to output informative messages as running</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, intensity plot of homogeneous Poisson process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pois_y &lt;- pp_hpp(lambda = 1)
drawHPPIntensity(pois_y, events = pp_simulate(pois_y, end = 10))
</code></pre>

<hr>
<h2 id='drawUniMMHPIntensity'>Draw the intensity of the Markov-modulated Hawkes Process(MMHP)</h2><span id='topic+drawUniMMHPIntensity'></span>

<h3>Description</h3>

<p>Take a mmhp object and draw its intensity accordingly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawUniMMHPIntensity(
  mmhp,
  simulation,
  int_title = "Intensity of MMHP",
  leg_location = "topright",
  color = 1,
  add = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawUniMMHPIntensity_+3A_mmhp">mmhp</code></td>
<td>
<p>a mmhp object including its state, state_time,
events, lambda0, lambda1, beta and alpha.</p>
</td></tr>
<tr><td><code id="drawUniMMHPIntensity_+3A_simulation">simulation</code></td>
<td>
<p>the simulated Markov-modulated Hawkes Process(MMHP)</p>
</td></tr>
<tr><td><code id="drawUniMMHPIntensity_+3A_int_title">int_title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
<tr><td><code id="drawUniMMHPIntensity_+3A_leg_location">leg_location</code></td>
<td>
<p>location of legend, if moving needed</p>
</td></tr>
<tr><td><code id="drawUniMMHPIntensity_+3A_color">color</code></td>
<td>
<p>A specification for the default plotting color.</p>
</td></tr>
<tr><td><code id="drawUniMMHPIntensity_+3A_add">add</code></td>
<td>
<p>logical; if TRUE add to an already existing plot;
if NA start a new plot taking the defaults
for the limits and log-scaling of the x-axis from the previous plot.
Taken as FALSE (with a warning if a different value is supplied)
if no graphics device is open.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, intensity plot of Markov-modulated Hawkes process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
x &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9, lambda1 = 1.1,
  alpha = 0.8, beta = 1.2
)
y &lt;- pp_simulate(x, n = 25)
drawUniMMHPIntensity(x, y)
</code></pre>

<hr>
<h2 id='drawUniMMPPIntensity'>Draw the intensity of the Markov-modulated Poisson Process(MMPP)</h2><span id='topic+drawUniMMPPIntensity'></span>

<h3>Description</h3>

<p>Take a mmpp object and draw its intensity accordingly
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drawUniMMPPIntensity(
  mmpp,
  simulation,
  add = FALSE,
  color = 1,
  fit = FALSE,
  int_title = "Intensity Plot of MMPP"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drawUniMMPPIntensity_+3A_mmpp">mmpp</code></td>
<td>
<p>a mmpp object including its transition probability matrix, lambda0, delta, and c.</p>
</td></tr>
<tr><td><code id="drawUniMMPPIntensity_+3A_simulation">simulation</code></td>
<td>
<p>the simulated Markov-modulated Poisson Process(MMPP)</p>
</td></tr>
<tr><td><code id="drawUniMMPPIntensity_+3A_add">add</code></td>
<td>
<p>logical; if TRUE add to an already existing plot;
if NA start a new plot taking the defaults
for the limits and log-scaling of the x-axis from the previous plot.
Taken as FALSE (with a warning if a different value is supplied)
if no graphics device is open.</p>
</td></tr>
<tr><td><code id="drawUniMMPPIntensity_+3A_color">color</code></td>
<td>
<p>A specification for the default plotting color.</p>
</td></tr>
<tr><td><code id="drawUniMMPPIntensity_+3A_fit">fit</code></td>
<td>
<p>a boolean indicating whether to fit the events provided</p>
</td></tr>
<tr><td><code id="drawUniMMPPIntensity_+3A_int_title">int_title</code></td>
<td>
<p>title of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, intensity plot of Markov-modulated Poisson process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
x &lt;- pp_mmpp(Q, delta = c(1 / 3, 2 / 3), lambda0 = 0.9, c = 1.2)
y &lt;- pp_simulate(x, n = 10)
drawUniMMPPIntensity(x, y)
</code></pre>

<hr>
<h2 id='fithp'>Determine the MLE of Hawkes process numerically</h2><span id='topic+fithp'></span>

<h3>Description</h3>

<p>Determine the MLE of Hawkes process numerically
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fithp(events, end = max(events), vec = c(0.1, 0.2, 0.3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fithp_+3A_events">events</code></td>
<td>
<p>event times</p>
</td></tr>
<tr><td><code id="fithp_+3A_end">end</code></td>
<td>
<p>end of observation period starting from 0 (default last event)</p>
</td></tr>
<tr><td><code id="fithp_+3A_vec">vec</code></td>
<td>
<p>vector of initial parameter values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a hp object indicating the maximum
likelihood parameter values (lambda0,alpha,beta) for Hawkes process.
This is a non-convex problem and a (unique) solution is not guaranteed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hp_obj &lt;- pp_hp(lambda0 = 0.1, alpha = 0.45, beta = 0.5)
sims &lt;- pp_simulate(hp_obj, start = 0, n = 10)
fithp(sims)
</code></pre>

<hr>
<h2 id='fithpp'>Fit a homogeneous poisson process to event data</h2><span id='topic+fithpp'></span>

<h3>Description</h3>

<p>Compute maximum likelihood estimator of the rate of a homogeneous Poisson
process for the given events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fithpp(events, end = max(events))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fithpp_+3A_events">events</code></td>
<td>
<p>vector containing the event times.</p>
</td></tr>
<tr><td><code id="fithpp_+3A_end">end</code></td>
<td>
<p>end of observation period, starting from 0 (default is last event)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a hpp object containing the events and the estimated parameter
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pois_y &lt;- pp_hpp(lambda = 1)
events &lt;- pp_simulate(pois_y, end = 10)
fithpp(events)
</code></pre>

<hr>
<h2 id='hawkes_max_intensity'>max intensity of a hawkes process</h2><span id='topic+hawkes_max_intensity'></span>

<h3>Description</h3>

<p>max intensity of a hawkes process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hawkes_max_intensity(object, events)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hawkes_max_intensity_+3A_object">object</code></td>
<td>
<p>hawkes process object containing parameters for Hawkes process.</p>
</td></tr>
<tr><td><code id="hawkes_max_intensity_+3A_events">events</code></td>
<td>
<p>events for Hawkes process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>max of intensity
</p>

<hr>
<h2 id='intensityqqplot'>Draw intensity of fitted point process and QQ-Plot of rescaled events</h2><span id='topic+intensityqqplot'></span><span id='topic+intensityqqplot.default'></span><span id='topic+intensityqqplot.hp'></span><span id='topic+intensityqqplot.hpp'></span><span id='topic+intensityqqplot.mmpp'></span><span id='topic+intensityqqplot.mmhp'></span>

<h3>Description</h3>

<p>Draw the intensity and q-q plot for models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>intensityqqplot(object, events, markov_states)

## Default S3 method:
intensityqqplot(object, events, markov_states)

## S3 method for class 'hp'
intensityqqplot(object, events, markov_states = NULL)

## S3 method for class 'hpp'
intensityqqplot(object, events, markov_states = NULL)

## S3 method for class 'mmpp'
intensityqqplot(object, events = markov_states$events, markov_states)

## S3 method for class 'mmhp'
intensityqqplot(object, events = markov_states$events, markov_states)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="intensityqqplot_+3A_object">object</code></td>
<td>
<p>parameters for the models: hp, hpp, and mmhp</p>
</td></tr>
<tr><td><code id="intensityqqplot_+3A_events">events</code></td>
<td>
<p>event times</p>
</td></tr>
<tr><td><code id="intensityqqplot_+3A_markov_states">markov_states</code></td>
<td>
<p>only for mmhp and mmpp, markov states simulation output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, intensity and qq-plot in a single plot
</p>

<hr>
<h2 id='interpolate_mmhp_latent'>Interpolate latent process of MMHP</h2><span id='topic+interpolate_mmhp_latent'></span>

<h3>Description</h3>

<p>Interpolate latent process of MMHP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolate_mmhp_latent(params, events, zt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="interpolate_mmhp_latent_+3A_params">params</code></td>
<td>
<p>parameters of the MMHP, an MMHP object</p>
</td></tr>
<tr><td><code id="interpolate_mmhp_latent_+3A_events">events</code></td>
<td>
<p>events (not including 0, but assumes start at 0)</p>
</td></tr>
<tr><td><code id="interpolate_mmhp_latent_+3A_zt">zt</code></td>
<td>
<p>inferred latent state of events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of the states of the Markov process (z.hat), including
initial state
and the times of the transitions between these times (x.hat).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
mmhp_obj &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9, lambda1 = 1.1,
  alpha = 0.8, beta = 1.2
)
ppdiag:::interpolate_mmhp_latent(
  params = mmhp_obj,
  events = c(1, 2, 3, 5), zt = c(2, 1, 1, 2)
)
</code></pre>

<hr>
<h2 id='mmhp_event_state'>Estimate the latent state for events of an MMHP</h2><span id='topic+mmhp_event_state'></span>

<h3>Description</h3>

<p>Given a MMHP object and events from that MMHP, infer the
most likely state of the Markov Process and each event time, along
with the probability of being in the active state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmhp_event_state(
  params = list(lambda0, lambda1, alpha, beta, Q),
  events,
  start = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmhp_event_state_+3A_params">params</code></td>
<td>
<p>the parameters of the chosen MMHP</p>
</td></tr>
<tr><td><code id="mmhp_event_state_+3A_events">events</code></td>
<td>
<p>the event times</p>
</td></tr>
<tr><td><code id="mmhp_event_state_+3A_start">start</code></td>
<td>
<p>the start of observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>probability of being in state 1 (active state) at each event,
along with most likely state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
mmhp_obj &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9,
  lambda1 = 1.1,
  alpha = 0.8, beta = 1.2
)
## evaluate at some fake event times
ppdiag:::mmhp_event_state(params = mmhp_obj, events = c(1, 2, 3, 5))
</code></pre>

<hr>
<h2 id='mmpp_event_state'>Estimate the latent state for events of an MMPP</h2><span id='topic+mmpp_event_state'></span>

<h3>Description</h3>

<p>Given a MMPP object and events from that MMPP, infer the
most likely state of the Markov Process at each event time, along
with the probability of being in the active state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmpp_event_state(params = list(lambda0, c, Q), events, start = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmpp_event_state_+3A_params">params</code></td>
<td>
<p>the parameters of the chosen MMPP</p>
</td></tr>
<tr><td><code id="mmpp_event_state_+3A_events">events</code></td>
<td>
<p>the event times</p>
</td></tr>
<tr><td><code id="mmpp_event_state_+3A_start">start</code></td>
<td>
<p>the start of observation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>probability of being in state 1 (active state) at each event,
along with most likely state
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
mmpp_obj &lt;- pp_mmpp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9,
  c = 1.1
)
## evaluate at some fake event times
ppdiag:::mmpp_event_state(params = mmpp_obj, events = c(1, 2, 3, 5))
</code></pre>

<hr>
<h2 id='mmpp_latent'>Estimate Latent process of MMPP</h2><span id='topic+mmpp_latent'></span>

<h3>Description</h3>

<p>Estimate Latent process of MMPP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmpp_latent(params = list(lambda0, c, Q), events, zt, start = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmpp_latent_+3A_params">params</code></td>
<td>
<p>parameters of the MMPP, an MMPP object</p>
</td></tr>
<tr><td><code id="mmpp_latent_+3A_events">events</code></td>
<td>
<p>events (not including 0, but assumes start at 0)</p>
</td></tr>
<tr><td><code id="mmpp_latent_+3A_zt">zt</code></td>
<td>
<p>inferred latent state of events</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of the states of the Markov process (z.hat)
and the times of the transitions between these times (x.hat).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.04, 0.04, 0.02, -0.02), ncol = 2, byrow = TRUE)
mmpp_obj &lt;- pp_mmpp(Q, delta = c(1 / 3, 2 / 3), lambda0 = 1, c = 1)
ppdiag:::mmpp_latent(params = mmpp_obj, events = c(1, 2, 3), zt = c(2, 1, 1))
</code></pre>

<hr>
<h2 id='negloglik'>Compute negative log likelihood for point process models</h2><span id='topic+negloglik'></span>

<h3>Description</h3>

<p>Compute negative log likelihood for point process models
with model specified time events or simulated time events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>negloglik(object, events, end)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="negloglik_+3A_object">object</code></td>
<td>
<p>point process object containing the parameters</p>
</td></tr>
<tr><td><code id="negloglik_+3A_events">events</code></td>
<td>
<p>vector containing the event times.</p>
</td></tr>
<tr><td><code id="negloglik_+3A_end">end</code></td>
<td>
<p>the end time of event times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scalar indicating the negative log likelihood
</p>

<hr>
<h2 id='negloglik_hp'>Fit a Hawkes process with exponential kernel to event data</h2><span id='topic+negloglik_hp'></span>

<h3>Description</h3>

<p>Compute the negative log likelihood parameter values for hawkes process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>negloglik_hp(vec, events, end = max(events))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="negloglik_hp_+3A_vec">vec</code></td>
<td>
<p>vector containing initial values for the
object parameters (lambda0,alpha,beta) to be optimized.</p>
</td></tr>
<tr><td><code id="negloglik_hp_+3A_events">events</code></td>
<td>
<p>vector containing event times.</p>
</td></tr>
<tr><td><code id="negloglik_hp_+3A_end">end</code></td>
<td>
<p>the end time of event times.</p>
</td></tr>
</table>

<hr>
<h2 id='pearsonresidual'>Compute Pearson residuals for point process models</h2><span id='topic+pearsonresidual'></span>

<h3>Description</h3>

<p>Compute Pearson residuals for point processes
with specified parameters and events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pearsonresidual(object, events, start, end, steps = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pearsonresidual_+3A_object">object</code></td>
<td>
<p>point process model</p>
</td></tr>
<tr><td><code id="pearsonresidual_+3A_events">events</code></td>
<td>
<p>vector of event times</p>
</td></tr>
<tr><td><code id="pearsonresidual_+3A_start">start</code></td>
<td>
<p>start of observation period (default 0)</p>
</td></tr>
<tr><td><code id="pearsonresidual_+3A_end">end</code></td>
<td>
<p>termination time (default final event)</p>
</td></tr>
<tr><td><code id="pearsonresidual_+3A_steps">steps</code></td>
<td>
<p>number of steps for numeric integration (if needed)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the Pearson residual
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
x &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9,
  lambda1 = 1.1, alpha = 0.8, beta = 1.2
)
y &lt;- pp_simulate(x, n = 10)
ppdiag:::pearsonresidual.mmhp(x, events = y$events[-1])
</code></pre>

<hr>
<h2 id='pp_compensator'>Compensators for point processes</h2><span id='topic+pp_compensator'></span><span id='topic+pp_compensator.default'></span><span id='topic+pp_compensator.mmpp'></span><span id='topic+pp_compensator.hp'></span><span id='topic+pp_compensator.mmhp'></span><span id='topic+pp_compensator.hpp'></span>

<h3>Description</h3>

<p>Computes the compensator for included point processes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_compensator(object, events)

## Default S3 method:
pp_compensator(object, events)

## S3 method for class 'mmpp'
pp_compensator(object, events)

## S3 method for class 'hp'
pp_compensator(object, events)

## S3 method for class 'mmhp'
pp_compensator(object, events)

## S3 method for class 'hpp'
pp_compensator(object, events)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_compensator_+3A_object">object</code></td>
<td>
<p>a point process model</p>
</td></tr>
<tr><td><code id="pp_compensator_+3A_events">events</code></td>
<td>
<p>event times, which can have first value as 0</p>
</td></tr>
</table>


<h3>Value</h3>

<p>compensator vector of rescaled interevent times
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hpp_obj &lt;- pp_hpp(lambda = 1)
events &lt;- pp_simulate(hpp_obj, end = 10)
comp &lt;- pp_compensator(hpp_obj, events)
</code></pre>

<hr>
<h2 id='pp_diag'>Summarise diagnostics for point process models</h2><span id='topic+pp_diag'></span><span id='topic+pp_diag.default'></span><span id='topic+pp_diag.hp'></span><span id='topic+pp_diag.mmhp'></span><span id='topic+pp_diag.mmpp'></span><span id='topic+pp_diag.hpp'></span>

<h3>Description</h3>

<p>Generate diagnostic tools for different point process models,
including quantile-quantile plot, ks plot,
raw residual and pearson residual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_diag(object, events)

## Default S3 method:
pp_diag(object, events)

## S3 method for class 'hp'
pp_diag(object, events)

## S3 method for class 'mmhp'
pp_diag(object, events)

## S3 method for class 'mmpp'
pp_diag(object, events)

## S3 method for class 'hpp'
pp_diag(object, events)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_diag_+3A_object">object</code></td>
<td>
<p>a point process model</p>
</td></tr>
<tr><td><code id="pp_diag_+3A_events">events</code></td>
<td>
<p>event times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns NULL. Outputs plots and summary of diagnostics to
console
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hpp_obj &lt;- pp_hpp(lambda = 1)
events &lt;- pp_simulate(hpp_obj, end = 50)
pp_diag(hpp_obj, events)
</code></pre>

<hr>
<h2 id='pp_hp'>Create a Hawkes process object</h2><span id='topic+pp_hp'></span>

<h3>Description</h3>

<p>Create a Hawkes Process with an exponential
kernel according to the given parameters:
lambda0, alpha, beta and events.
If events are missing, then it means that data will be
added later(simulated from this process)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_hp(lambda0, alpha, beta, events = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_hp_+3A_lambda0">lambda0</code></td>
<td>
<p>initial intensity at the start time</p>
</td></tr>
<tr><td><code id="pp_hp_+3A_alpha">alpha</code></td>
<td>
<p>jump size in increase of intensity</p>
</td></tr>
<tr><td><code id="pp_hp_+3A_beta">beta</code></td>
<td>
<p>exponential decay of intensity</p>
</td></tr>
<tr><td><code id="pp_hp_+3A_events">events</code></td>
<td>
<p>vector containing the event times.
Note that the first event is at time zero.
Alternatively, events could be specified as NULL,
meaning that the data will be added later (e.g. simulated).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hp object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp_hp(lambda0 = 0.1, alpha = 0.45, beta = 0.5)
</code></pre>

<hr>
<h2 id='pp_hpp'>Create a homogeneous Poisson process object</h2><span id='topic+pp_hpp'></span>

<h3>Description</h3>

<p>Create a homogeneous Poisson object according to given parameters:
lambda, and events.
If events are missing, then it means that data will be
added later(simulated from this process).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_hpp(lambda, events = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_hpp_+3A_lambda">lambda</code></td>
<td>
<p>rate of the Poisson process</p>
</td></tr>
<tr><td><code id="pp_hpp_+3A_events">events</code></td>
<td>
<p>event times, optional</p>
</td></tr>
</table>


<h3>Value</h3>

<p>hpp object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pp_hpp(lambda = 1)
</code></pre>

<hr>
<h2 id='pp_ksplot'>KS plot of empirical and theoretical cdf curve of fitted point process</h2><span id='topic+pp_ksplot'></span>

<h3>Description</h3>

<p>Plot empirical cdf plot for rescaled-inter-event-times and
exponential cdf as a reference curve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_ksplot(r, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_ksplot_+3A_r">r</code></td>
<td>
<p>rescaled-inter-event-times</p>
</td></tr>
<tr><td><code id="pp_ksplot_+3A_...">...</code></td>
<td>
<p>other arguments for plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, KS plot for rescaled-inter-event-times and exponential cdf curve
</p>

<hr>
<h2 id='pp_mmhp'>Create a Markov-modulated Hawkes Process(MMHP) object</h2><span id='topic+pp_mmhp'></span>

<h3>Description</h3>

<p>Create a Markov-modulated Hawkes Process(MMHP) model
according to the given parameters: lambda0, lambda1,
alpha, beta, event times and transition probability matrix.
If event time events is missing,
then it means that data will be added later(e.g. simulated)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_mmhp(lambda0, lambda1, alpha, beta, Q = NULL, delta = NULL, events = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_mmhp_+3A_lambda0">lambda0</code></td>
<td>
<p>intensity for homogeneous Poisson process.</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_lambda1">lambda1</code></td>
<td>
<p>base intensity for Hawkes process.</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_alpha">alpha</code></td>
<td>
<p>jump size of the increase in intensity in the hawkes process</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_beta">beta</code></td>
<td>
<p>exponential decrease of intensity in the hawkes process</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_q">Q</code></td>
<td>
<p>transition probability matrix.</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_delta">delta</code></td>
<td>
<p>initial state probability.</p>
</td></tr>
<tr><td><code id="pp_mmhp_+3A_events">events</code></td>
<td>
<p>vector containing the event times.
Note that the first event is at time zero.
Alternatively, events could be specified as NULL,
meaning that the data will be added later (e.g. simulated).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mmhp object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9, lambda1 = 1.1,
  alpha = 0.8, beta = 1.2
)
</code></pre>

<hr>
<h2 id='pp_mmpp'>Create a Markov-modulated Poisson Process(MMPP) object</h2><span id='topic+pp_mmpp'></span>

<h3>Description</h3>

<p>Create a Markov-modulated Poisson Process(MMPP) model
according to the given parameters: lambda0, c, q1, q2 and event times.
If event time tau is missing,
then it means that data will be added later(e.g. simulated)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_mmpp(lambda0, c, Q, events = NULL, delta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_mmpp_+3A_lambda0">lambda0</code></td>
<td>
<p>parameters for Poisson process.</p>
</td></tr>
<tr><td><code id="pp_mmpp_+3A_c">c</code></td>
<td>
<p>the proportion of intensity 1 over intensity 2</p>
</td></tr>
<tr><td><code id="pp_mmpp_+3A_q">Q</code></td>
<td>
<p>transition probability matrix</p>
</td></tr>
<tr><td><code id="pp_mmpp_+3A_events">events</code></td>
<td>
<p>vector containing the event times.
Note that the first event is often specified as zero.
Alternatively, events could be specified as NULL,
meaning that the data will be added later (e.g. simulated).</p>
</td></tr>
<tr><td><code id="pp_mmpp_+3A_delta">delta</code></td>
<td>
<p>initial state probability.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>mmpp object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
pp_mmpp(Q = Q, lambda0 = 1, c = 1.5, delta = c(1 / 3, 2 / 3))
</code></pre>

<hr>
<h2 id='pp_qqexp'>Plot QQ-plot for rescaled-inter-event-times of fitted point process</h2><span id='topic+pp_qqexp'></span>

<h3>Description</h3>

<p>Generate Quantile-quantile plot for rescaled-inter-event-times,
which are independently
and identically distributed as exponential random variables with rate 1
under the true point process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_qqexp(r, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_qqexp_+3A_r">r</code></td>
<td>
<p>rescaled-inter-event-times</p>
</td></tr>
<tr><td><code id="pp_qqexp_+3A_...">...</code></td>
<td>
<p>other arguments for plots</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, quantile-quantile plot for rescaled-inter-event-times
</p>

<hr>
<h2 id='pp_residual'>Compute raw and pearson residuals for point process models</h2><span id='topic+pp_residual'></span>

<h3>Description</h3>

<p>Compute raw and pearson residuals for point process models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_residual(object, events, start = 0, end = max(events), steps = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_residual_+3A_object">object</code></td>
<td>
<p>point process model containing the parameters</p>
</td></tr>
<tr><td><code id="pp_residual_+3A_events">events</code></td>
<td>
<p>vector of event times</p>
</td></tr>
<tr><td><code id="pp_residual_+3A_start">start</code></td>
<td>
<p>start of observation period (default 0)</p>
</td></tr>
<tr><td><code id="pp_residual_+3A_end">end</code></td>
<td>
<p>end of observation period (default final event)</p>
</td></tr>
<tr><td><code id="pp_residual_+3A_steps">steps</code></td>
<td>
<p>number of steps for numeric integration (if needed)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the raw and pearson residuals
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
x &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9,
  lambda1 = 1.1, alpha = 0.8, beta = 1.2
)
y &lt;- pp_simulate(x, n = 10)
pp_residual(x, events = y$events)
</code></pre>

<hr>
<h2 id='pp_simulate'>Simulate events from a temporal point process</h2><span id='topic+pp_simulate'></span><span id='topic+pp_simulate.default'></span><span id='topic+pp_simulate.hpp'></span><span id='topic+pp_simulate.hp'></span><span id='topic+pp_simulate.mmpp'></span><span id='topic+pp_simulate.mmhp'></span>

<h3>Description</h3>

<p>Currently available point processes are homogeneous Poisson,
Hawkes with exponential kernel, MMHP and MMPP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)

## Default S3 method:
pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)

## S3 method for class 'hpp'
pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)

## S3 method for class 'hp'
pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)

## S3 method for class 'mmpp'
pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)

## S3 method for class 'mmhp'
pp_simulate(object, start = 0, end = 1, n = NULL, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pp_simulate_+3A_object">object</code></td>
<td>
<p>point process model object of type hpp, hp, mmhp, or mmpp</p>
</td></tr>
<tr><td><code id="pp_simulate_+3A_start">start</code></td>
<td>
<p>start time of events simulated. Not used for Markov modulated
models</p>
</td></tr>
<tr><td><code id="pp_simulate_+3A_end">end</code></td>
<td>
<p>end time of events simulated. Not used for Markov modulated models</p>
</td></tr>
<tr><td><code id="pp_simulate_+3A_n">n</code></td>
<td>
<p>number of events simulated. Required for Markov modulated models,
optional otherwise</p>
</td></tr>
<tr><td><code id="pp_simulate_+3A_verbose">verbose</code></td>
<td>
<p>whether to output informative messages as running</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of event times for all models. For Markov modulated models,
also returns details on the underlying latent process
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hpp_obj &lt;- pp_hpp(lambda = 1)
s &lt;- pp_simulate(hpp_obj, n = 50)
</code></pre>

<hr>
<h2 id='rawresidual'>Compute raw residuals for point process models</h2><span id='topic+rawresidual'></span>

<h3>Description</h3>

<p>Compute raw residuals for for point processes
with specified parameters and events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rawresidual(object, events, start, end, steps = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rawresidual_+3A_object">object</code></td>
<td>
<p>point process model containing the parameters</p>
</td></tr>
<tr><td><code id="rawresidual_+3A_events">events</code></td>
<td>
<p>vector of event times</p>
</td></tr>
<tr><td><code id="rawresidual_+3A_start">start</code></td>
<td>
<p>start of observation period (default 0)</p>
</td></tr>
<tr><td><code id="rawresidual_+3A_end">end</code></td>
<td>
<p>end of observation period (default final event)</p>
</td></tr>
<tr><td><code id="rawresidual_+3A_steps">steps</code></td>
<td>
<p>number of steps for numeric integration (if needed)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the raw residual
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Q &lt;- matrix(c(-0.4, 0.4, 0.2, -0.2), ncol = 2, byrow = TRUE)
x &lt;- pp_mmhp(Q,
  delta = c(1 / 3, 2 / 3), lambda0 = 0.9,
  lambda1 = 1.1, alpha = 0.8, beta = 1.2
)
y &lt;- pp_simulate(x, n = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
