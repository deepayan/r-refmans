<!DOCTYPE html><html><head><title>Help for package robustsur</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robustsur}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eigenkronecker'><p>Spectral Decomposition of a kronecker product of a matrix</p>
with an identity matrix</a></li>
<li><a href='#summary.surerob'>
<p>Summary of surerob estimation</p></a></li>
<li><a href='#surerob'><p>Robust estimation for Seemingly Unrelated Regression Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.0-7</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-10-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Estimation for Seemingly Unrelated Regression Models</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Claudio Agostinelli &lt;claudio.agostinelli@unitn.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Data sets are often corrupted by outliers. When data are multivariate outliers can be classified as case-wise or cell-wise. The latters are particularly challenge to handle. We implement a robust estimation procedure for Seemingly Unrelated Regression Models which is able to cope well with both type of outliers. Giovanni Saraceno, Fatemah Alqallaf, Claudio Agostinelli (2021) &lt;<a href="https://doi.org/10.48550/arXiv.2107.00975">doi:10.48550/arXiv.2107.00975</a>&gt;. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), robustbase, robreg3S</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, GSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>systemfit</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-10-03 14:59:00 UTC; claudio</td>
</tr>
<tr>
<td>Author:</td>
<td>Claudio Agostinelli
    <a href="https://orcid.org/0000-0001-6702-4312"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Giovanni Saraceno <a href="https://orcid.org/0000-0002-1753-2367"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-10-04 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='eigenkronecker'>Spectral Decomposition of a kronecker product of a matrix
with an identity matrix</h2><span id='topic+eigenkronecker'></span>

<h3>Description</h3>

<p>Computes eigenvalues and eigenvectors of the kronecker product of a
matrix with an identity matrix.</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenkronecker(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenkronecker_+3A_x">x</code></td>
<td>
<p>a numeric or complex symmetric matrix whose spectral
decomposition is to be computed. Logical matrices are coerced to numeric.</p>
</td></tr>
<tr><td><code id="eigenkronecker_+3A_n">n</code></td>
<td>
<p>dimension of the identity matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Only symmetric matrices are considered.
</p>


<h3>Value</h3>

<p>The spectral decomposition of kronecher product between <code>x</code> and
an identity matrix of dimesion <code>n</code> is returned as a list with
components
</p>
<table>
<tr><td><code>values</code></td>
<td>
<p>a vector containing the eigenvalues.</p>
</td></tr>
<tr><td><code>vectors</code></td>
<td>
<p>a matrix whose columns contain the eigenvectors.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli and Giovanni Saraceno
</p>


<h3>References</h3>

<p>R.A. Horn and C.R. Johnson (1994) Topics in Matrix Analysis, Cambridge University Press. Theorem 4.2.12.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+eigen">eigen</a></code> and <code><a href="base.html#topic+kronecker">kronecker</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> eigenkronecker(x=cbind(c(1,-1), c(-1,1)), n=2)
</code></pre>

<hr>
<h2 id='summary.surerob'>
Summary of surerob estimation
</h2><span id='topic+summary.surerob'></span><span id='topic+print.summary.surerob'></span>

<h3>Description</h3>

<p>These functions create and print summary results
of the estimated equation system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'surerob'
summary(object, residCov=TRUE, equations=TRUE, ...)
## S3 method for class 'summary.surerob'
print(x, digits=max(3, getOption("digits")-1),
   residCov=x$printResidCov, equations=x$printEquations, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.surerob_+3A_object">object</code></td>
<td>
<p>an object of class <code>surerob</code>.</p>
</td></tr>
<tr><td><code id="summary.surerob_+3A_x">x</code></td>
<td>
<p>an object of class <code>summary.surerob</code>.</p>
</td></tr>
<tr><td><code id="summary.surerob_+3A_residcov">residCov</code></td>
<td>
<p>logical. If <code>TRUE</code>, the residual correlation matrix,
the residual covariance matrix, and its determinant are printed.</p>
</td></tr>
<tr><td><code id="summary.surerob_+3A_equations">equations</code></td>
<td>
<p>logical. If <code>TRUE</code>, summary results of each equation
are printed. If <code>FALSE</code>, just the coefficients are printed.</p>
</td></tr>
<tr><td><code id="summary.surerob_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>  
<tr><td><code id="summary.surerob_+3A_...">...</code></td>
<td>
<p>not yet used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Applying <code>summary</code> on an object of class <code>surerob</code>
returns a list of class <code>summary.surerob</code>.
An object of class <code>summary.surerob</code>
contains all results that belong to the whole system.
This list contains one special object: <code>eq</code>.
This is a list and contains objects of class
<code>summary.lmrob</code>.
These objects contain the results that belong to each of the estimated equations.
</p>
<p>The objects of classes <code>summary.surerob</code> 
have the following components
</p>
<table>
<tr><td><code>method</code></td>
<td>
<p>estimation method.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals.</p>
</td></tr>
<tr><td><code>residCovEst</code></td>
<td>
<p>residual covariance matrix used for estimation.</p>
</td></tr>
<tr><td><code>residCov</code></td>
<td>
<p>estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code>residCor</code></td>
<td>
<p>correlation matrix of the residuals.</p>
</td></tr>
<tr><td><code>detResidCov</code></td>
<td>
<p>determinant of <code>residCov</code>.</p>
</td></tr>
<tr><td><code>rweights</code></td>
<td>
<p>matrix of robust weights.</p>
</td></tr>
<tr><td><code>eq</code></td>
<td>
<p>a list containing the summary from function
<code><a href="robustbase.html#topic+summary.lmrob">summary.lmrob</a></code> and <code>ssr</code>: residual
sum of squares, <code>eqnNo</code>: equation number and <code>eqnLabel</code>:
equation label.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom, a 2-vector, where the first element is
the number of coefficients and the second element is the number of
observations minus the number of coefficients.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a matrix with columns for the estimated coefficients,
their standard errors, t-statistic and corresponding (two-sided) p-values.</p>
</td></tr>
<tr><td><code>ssr_weighted</code></td>
<td>
<p>weighted residual sum of squares.</p>
</td></tr>
<tr><td><code>r.squared</code></td>
<td>
<p><code class="reqn">R^2</code> value.</p>
</td></tr>
<tr><td><code>adj.r.squared</code></td>
<td>
<p>adjusted <code class="reqn">R^2</code> value.</p>
</td></tr>
<tr><td><code>coefCov</code></td>
<td>
<p>estimated covariance matrix of the coefficients.</p>
</td></tr>
<tr><td><code>printResidCov</code></td>
<td>
<p>argument <code>residCov</code>.</p>
</td></tr>
<tr><td><code>printEquations</code></td>
<td>
<p>argument <code>equations</code>.</p>
</td></tr>  
<tr><td><code>control</code></td>
<td>
<p>list of control parameters used for the estimation.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call of <code>surerob</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli and Giovanni Saraceno  
</p>


<h3>References</h3>

<p>Giovanni Saraceno, Fatemah Alqallaf and Claudio Agostinelli (2021?) A Robust Seemingly Unrelated Regressions For Row-Wise And Cell-Wise Contamination, submitted
</p>


<h3>See Also</h3>

<p><code><a href="#topic+surerob">surerob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  library(systemfit)
  data("Kmenta")
  eqDemand &lt;- consump~price+income
  eqSupply &lt;- consump~price+farmPrice+trend
  system &lt;- list(demand=eqDemand, supply=eqSupply)
     
  ## Robust estimation
  fitrob &lt;- surerob(system, data=Kmenta)
  summary(fitrob)  
</code></pre>

<hr>
<h2 id='surerob'>Robust estimation for Seemingly Unrelated Regression Models</h2><span id='topic+surerob'></span><span id='topic+print.surerob'></span>

<h3>Description</h3>

<p>Robust estimation for Seemingly Unrelated Regression Models in presence
of cell-wise and case-wise outliers performed using a three-stage
procedure. In the first step estimation of the coefficients in each
single-equation model is obtained using a Robust Regression procedure,
robust estimation of the residual covariance is obtained by a Two-Step
Generalized S-estimator, a weighted least square is performed on the
whole system to get final estimates of the regression coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surerob(formula, data, control=lmrob.control(), ...)
## S3 method for class 'surerob'
print(x, digits=max(3, getOption("digits")-1), ...)  
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="surerob_+3A_formula">formula</code></td>
<td>
<p>a list of objects of class <code>formula</code> for
multiple-equation models; for single-equation models use function
<code><a href="robustbase.html#topic+lmrob">lmrob</a></code>.</p>
</td></tr>
<tr><td><code id="surerob_+3A_data">data</code></td>
<td>

<p>a list of objects of class <code>data.frame</code>. Each <code>data.frame</code>
contains the data for the corresponding model and all the
<code>data.frame</code>s must have the same number of observations.</p>
</td></tr>
<tr><td><code id="surerob_+3A_control">control</code></td>
<td>
<p>list of control parameters. The default is constructed
by the function <code><a href="robustbase.html#topic+lmrob.control">lmrob.control</a></code>, and it is
passed to function <code><a href="robustbase.html#topic+lmrob">lmrob</a></code>.</p>
</td></tr>
<tr><td><code id="surerob_+3A_...">...</code></td>
<td>
<p>arguments passed to the function
<code><a href="GSE.html#topic+TSGS">TSGS</a></code>.</p>
</td></tr>
<tr><td><code id="surerob_+3A_x">x</code></td>
<td>
<p>an object of class <code>surerob</code>.</p>
</td></tr>
<tr><td><code id="surerob_+3A_digits">digits</code></td>
<td>
<p>number of digits to print.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The estimation of systems of equations with unequal numbers of observations
is not implemented.
</p>


<h3>Value</h3>

<p><code>surerob</code> returns a list of the class <code>surerob</code> and
contains all results that belong to the whole system.
This list contains one special object: &quot;eq&quot;. It is a list and contains
one object for each estimated equation. These objects are of the class
<code>lmrob</code> and contain the results that belong only to the
regarding equation.
</p>
<p>The objects of the class <code>surerob</code> have the following components:
</p>
<table>
<tr><td><code>eq</code></td>
<td>
<p>a list that contains the results that belong to the
individual equations.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the matched call.</p>
</td></tr>  
<tr><td><code>method</code></td>
<td>
<p>estimation method.</p>
</td></tr>
<tr><td><code>rank</code></td>
<td>
<p>total number of linear independent coefficients.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>vector of all estimated coefficients.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>matrix of fitted values.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>matrix of residuals</p>
</td></tr> 
<tr><td><code>imp.residuals</code></td>
<td>
<p>imputed residuals from <code><a href="GSE.html#topic+TSGS">TSGS</a></code>.</p>
</td></tr>
<tr><td><code>residCovEst</code></td>
<td>
<p>residual covariance matrix used for estimation.</p>
</td></tr>
<tr><td><code>residCov</code></td>
<td>
<p>estimated residual covariance matrix.</p>
</td></tr>
<tr><td><code>rweights</code></td>
<td>
<p>matrix of robust weights.</p>
</td></tr>
<tr><td><code>TSGS</code></td>
<td>
<p>object from function <code><a href="GSE.html#topic+TSGS">TSGS</a></code>.</p>
</td></tr>
<tr><td><code>control</code></td>
<td>
<p>list of control parameters used for the estimation.</p>
</td></tr>
<tr><td><code>df.residual</code></td>
<td>
<p>degrees of freedom of the whole system.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>response observations used in the second step.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>design matrix used in the second step.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Claudio Agostinelli and Giovanni Saraceno  
</p>


<h3>References</h3>

<p>Giovanni Saraceno, Fatemah Alqallaf and Claudio Agostinelli (2021?) A Robust Seemingly Unrelated Regressions For Row-Wise And Cell-Wise Contamination, submitted
</p>


<h3>See Also</h3>

<p><code><a href="robustbase.html#topic+lmrob">lmrob</a></code>, <code><a href="stats.html#topic+lm">lm</a></code> and <code><a href="systemfit.html#topic+systemfit">systemfit</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  library(systemfit)
  data("Kmenta")
  eqDemand &lt;- consump~price+income
  eqSupply &lt;- consump~price+farmPrice+trend
  system &lt;- list(demand=eqDemand, supply=eqSupply)
     
  ## Robust estimation
  fitrob &lt;- surerob(system, data=Kmenta)
  print(fitrob)  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
