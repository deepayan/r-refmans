<!DOCTYPE html><html lang="en"><head><title>Help for package leafpop</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {leafpop}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#leafpop-package'><p>Include Tables, Images and Graphs in Leaflet Popups</p></a></li>
<li><a href='#addPopupGraphs'><p>Add graph/plot popups to leaflet layers.</p></a></li>
<li><a href='#addPopupImages'><p>Add image popups to leaflet layers.</p></a></li>
<li><a href='#popupGraph'><p>Create HTML strings for popups</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Include Tables, Images and Graphs in Leaflet Pop-Ups</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-22</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tim Appelhans &lt;tim.appelhans@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Creates 'HTML' strings to embed tables, images or graphs in pop-ups
  of interactive maps created with packages like 'leaflet' or 'mapview'. Handles
  local images located on the file system or via remote URL. Handles graphs created 
  with 'lattice' or 'ggplot2' as well as interactive plots created with 'htmlwidgets'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/r-spatial/leafpop">https://github.com/r-spatial/leafpop</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/r-spatial/leafpop/issues">https://github.com/r-spatial/leafpop/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>base64enc, brew, htmltools, htmlwidgets, sf, svglite, uuid</td>
</tr>
<tr>
<td>Suggests:</td>
<td>lattice, leaflet (&ge; 2.0.0), sp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-22 09:14:01 UTC; timpanse</td>
</tr>
<tr>
<td>Author:</td>
<td>Tim Appelhans [cre, aut],
  Florian Detsch [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-22 10:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='leafpop-package'>Include Tables, Images and Graphs in Leaflet Popups</h2><span id='topic+leafpop-package'></span>

<h3>Description</h3>

<p>Include Tables, Images and Graphs in Leaflet Popups
</p>


<h3>Details</h3>

<p>Creates HTML strings to embed tables, images or graphs in popups
of interactive maps created with packages 'leaflet' or 'mapview'. Handles
local paths to images on the file system or remote urls. Handles graphs created
with 'base' graphics, 'lattice' or 'ggplot2' as well as interactive plots created
with 'htmlwidgets'.
</p>


<h3>Author(s)</h3>

<p>Tim Appelhans, Florian Detsch
<em>Maintainer:</em> Tim Appelhans <a href="mailto:tim.appelhans@gmail.com">tim.appelhans@gmail.com</a>
</p>

<hr>
<h2 id='addPopupGraphs'>Add graph/plot popups to leaflet layers.</h2><span id='topic+addPopupGraphs'></span>

<h3>Description</h3>

<p>Add graph/plot popups to leaflet layers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addPopupGraphs(map, graph, group, width = 300, height = 300, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addPopupGraphs_+3A_map">map</code></td>
<td>
<p>the <code>leaflet</code> map to add the popups to.</p>
</td></tr>
<tr><td><code id="addPopupGraphs_+3A_graph">graph</code></td>
<td>
<p>A <code>list</code> of lattice or ggplot2 objects. Needs to be a list,
even for a single plot!</p>
</td></tr>
<tr><td><code id="addPopupGraphs_+3A_group">group</code></td>
<td>
<p>the map group to which the popups should be added.</p>
</td></tr>
<tr><td><code id="addPopupGraphs_+3A_width">width</code></td>
<td>
<p>the width of the graph(s) in pixels.</p>
</td></tr>
<tr><td><code id="addPopupGraphs_+3A_height">height</code></td>
<td>
<p>the height of the graph(s) in pixels.</p>
</td></tr>
<tr><td><code id="addPopupGraphs_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+addPopupImages">addPopupImages</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>leaflet</code> map.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
library(sf)
library(leaflet)
library(lattice)

pt = data.frame(x = 174.764474, y = -36.877245)
pt = st_as_sf(pt, coords = c("x", "y"), crs = 4326)

p2 = levelplot(t(volcano), col.regions = terrain.colors(100))

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pt, group = "pt") %&gt;%
  addPopupGraphs(list(p2), group = "pt", width = 300, height = 400)

}

</code></pre>

<hr>
<h2 id='addPopupImages'>Add image popups to leaflet layers.</h2><span id='topic+addPopupImages'></span>

<h3>Description</h3>

<p>Add image popups to leaflet layers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addPopupImages(
  map,
  image,
  group,
  width = NULL,
  height = NULL,
  tooltip = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="addPopupImages_+3A_map">map</code></td>
<td>
<p>the <code>leaflet</code> map to add the popups to.</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_image">image</code></td>
<td>
<p>A character <code>vector</code> of file path(s) or
web-URL(s) to any sort of image file(s).</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_group">group</code></td>
<td>
<p>the map group to which the popups should be added.</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_width">width</code></td>
<td>
<p>the width of the image(s) in pixels.</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_height">height</code></td>
<td>
<p>the height of the image(s) in pixels.</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_tooltip">tooltip</code></td>
<td>
<p>logical, whether to show image(s) as popup(s) (on click) or
tooltip(s) (on hover).</p>
</td></tr>
<tr><td><code id="addPopupImages_+3A_...">...</code></td>
<td>
<p>additional options passed on to the JavaScript creator function.
See <a href="https://leafletjs.com/reference-1.7.1.html#popup">https://leafletjs.com/reference-1.7.1.html#popup</a> &amp;
<a href="https://leafletjs.com/reference-1.7.1.html#tooltip">https://leafletjs.com/reference-1.7.1.html#tooltip</a> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>leaflet</code> map.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
## remote images -----
### one image
library(leaflet)
library(sf)
library(lattice)

pnt = st_as_sf(data.frame(x = 174.764474, y = -36.877245),
                coords = c("x", "y"),
                crs = 4326)

img = "http://bit.ly/1TVwRiR"

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pnt, group = "pnt") %&gt;%
  addPopupImages(img, group = "pnt")

### multiple file (types)
library(sf)
images = c(img,
            "https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg",
            "https://www.r-project.org/logo/Rlogo.png",
            "https://upload.wikimedia.org/wikipedia/commons/d/d6/MeanMonthlyP.gif")

pt4 = data.frame(x = jitter(rep(174.764474, 4), factor = 0.01),
                  y = jitter(rep(-36.877245, 4), factor = 0.01))
pt4 = st_as_sf(pt4, coords = c("x", "y"), crs = 4326)

leaflet() %&gt;%
  addTiles() %&gt;%
  addMarkers(data = pt4, group = "points") %&gt;%
  addPopupImages(images, group = "points", width = 400) # NOTE the gif animation

## local images -----
pnt = st_as_sf(data.frame(x = 174.764474, y = -36.877245),
                coords = c("x", "y"), crs = 4326)
img = system.file("img","Rlogo.png",package="png")
leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pnt, group = "pnt") %&gt;%
  addPopupImages(img, group = "pnt")
}

</code></pre>

<hr>
<h2 id='popupGraph'>Create HTML strings for popups</h2><span id='topic+popupGraph'></span><span id='topic+popupImage'></span><span id='topic+popupTable'></span>

<h3>Description</h3>

<p>Create HTML strings for <code>popup</code> graphs used as input for
<code>mapview</code> or <code>leaflet</code>.
</p>
<p>Create HTML strings for <code>popup</code> images used as input for
<code>mapview</code> or <code>leaflet</code>.
</p>
<p>Create HTML strings for <code>popup</code> tables used as input for
<code>mapview</code> or <code>leaflet</code>.
This optionally allows the user to include only a subset of feature attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popupGraph(
  graphs,
  type = c("png", "svg", "html"),
  width = 300,
  height = 300,
  ...
)

popupImage(img, src = c("local", "remote"), embed = FALSE, ...)

popupTable(x, zcol, row.numbers = TRUE, feature.id = TRUE, className = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="popupGraph_+3A_graphs">graphs</code></td>
<td>
<p>A <code>list</code> of figures associated with <code>x</code>.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_type">type</code></td>
<td>
<p>Output filetype, one of &quot;png&quot; (default), &quot;svg&quot; or &quot;html&quot;.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_width">width</code></td>
<td>
<p>popup width in pixels.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_height">height</code></td>
<td>
<p>popup height in pixels.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_...">...</code></td>
<td>
<p>further arguments passed on to underlying methods such as
height and width.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_img">img</code></td>
<td>
<p>A character <code>vector</code> of file path(s) or
web-URL(s) to any sort of image file(s).</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_src">src</code></td>
<td>
<p>Whether the source is &quot;local&quot; (i.e. valid file path(s)) or
&quot;remote&quot; (i.e. valid URL(s)).</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_embed">embed</code></td>
<td>
<p>whether to embed the (local) images in the popup html as
base64 ecoded. Set this to TRUE if you want to save and share your map, unless
you want render many images, then set to FALSE and make sure to copy ../graphs
when copying the map to a different location.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_x">x</code></td>
<td>
<p>A <code>Spatial*</code> object.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_zcol">zcol</code></td>
<td>
<p><code>numeric</code> or <code>character</code> vector indicating the columns
included in the output popup table. If missing, all columns are displayed.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_row.numbers">row.numbers</code></td>
<td>
<p><code>logical</code> whether to include row numbers in the popup table.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_feature.id">feature.id</code></td>
<td>
<p><code>logical</code> whether to add 'Feature ID' entry to popup table.</p>
</td></tr>
<tr><td><code id="popupGraph_+3A_classname">className</code></td>
<td>
<p>CSS class name(s) that can be used to style the table through
additional css dependencies (see <a href="htmltools.html#topic+attachDependencies">attachDependencies</a>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Type <code>svg</code> uses native <code>svg</code> encoding via <code><a href="base.html#topic+readLines">readLines</a></code>.
<code>height</code> and <code>width</code> are set via <code>...</code> and passed on to
<code><a href="grDevices.html#topic+svg">svg</a></code> <br />
Type <code>png</code> embeds via <code>"&lt;img src = ..."</code>.
<code>height</code> and <code>width</code> are set via <code>...</code> and passed on to
<code><a href="grDevices.html#topic+png">png</a></code> <br />
Type <code>html</code> embeds via <code>"&lt;iframe src = ..."</code>.
<code>height</code> and <code>width</code> are set directly in pixels. <br />
</p>


<h3>Value</h3>

<p>A <code>list</code> of HTML strings required to create popup graphs.
</p>
<p>A <code>list</code> of HTML strings required to create popup graphs.
</p>
<p>A <code>list</code> of HTML strings required to create feature popup tables.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (interactive()) {
### example: svg -----

library(sp)
library(lattice)

data(meuse)
coordinates(meuse) = ~ x + y
proj4string(meuse) = CRS("+init=epsg:28992")
meuse = spTransform(meuse, CRS("+init=epsg:4326"))

## create plots with points colored according to feature id
library(lattice)
p = xyplot(copper ~ cadmium, data = meuse@data, col = "grey")
p = mget(rep("p", length(meuse)))

clr = rep("grey", length(meuse))
p = lapply(1:length(p), function(i) {
  clr[i] = "red"
  update(p[[i]], col = clr)
})

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = meuse, popup = popupGraph(p, type = "svg"))

### example: png -----
pt = data.frame(x = 174.764474, y = -36.877245)

coordinates(pt) = ~ x + y
proj4string(pt) = "+init=epsg:4326"

p2 = levelplot(t(volcano), col.regions = terrain.colors(100))

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pt, popup = popupGraph(p2, width = 300, height = 400))

### example: html -----
leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(
    data = breweries91[1, ],
    popup = popupGraph(
      leaflet() %&gt;%
        addProviderTiles("Esri.WorldImagery") %&gt;%
        addMarkers(data = breweries91[1, ],
                   popup = popupTable(breweries91[1, ])),
     type = "html"
    )
  )

}

if (interactive()) {
## remote images -----
### one image
library(sf)

pnt = st_as_sf(data.frame(x = 174.764474, y = -36.877245),
                coords = c("x", "y"),
                crs = 4326)

img = "http://bit.ly/1TVwRiR"

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pnt, popup = popupImage(img, src = "remote"))

### multiple file (types)
library(sp)
images = c(img,
            "https://upload.wikimedia.org/wikipedia/commons/9/91/Octicons-mark-github.svg",
            "https://www.r-project.org/logo/Rlogo.png",
            "https://upload.wikimedia.org/wikipedia/commons/d/d6/MeanMonthlyP.gif")

pt4 = data.frame(x = jitter(rep(174.764474, 4), factor = 0.01),
                  y = jitter(rep(-36.877245, 4), factor = 0.01))
coordinates(pt4) = ~ x + y
proj4string(pt4) = "+init=epsg:4326"

leaflet() %&gt;%
  addTiles() %&gt;%
  addMarkers(data = pt4, popup = popupImage(images)) # NOTE the gif animation

## local images -----
pnt = st_as_sf(data.frame(x = 174.764474, y = -36.877245),
                coords = c("x", "y"), crs = 4326)
img = system.file("img","Rlogo.png",package="png")
leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = pnt, popup = popupImage(img))
}

library(leaflet)

leaflet() %&gt;% addTiles() %&gt;% addCircleMarkers(data = breweries91)

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = breweries91,
                   popup = popupTable(breweries91))

leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = breweries91,
                   popup = popupTable(breweries91,
                                      zcol = c("brewery", "zipcode", "village"),
                                      feature.id = FALSE,
                                      row.numbers = FALSE))

## using a custom css to style the table
className = "my-popup"

css = list(
  "background" = "#ff00ff"
)

css = list(css)
names(css) = sprintf("table.%s", className)

evenodd = list("#ffff00", "#00ffff")
names(evenodd) = rep("background", 2)

evenodd = lapply(evenodd, function(i) {
  list("background" = i)
})

names(evenodd) = c(
  sprintf("table.%s tr:nth-child(even)", className)
  , sprintf("table.%s tr:nth-child(odd)", className)
)

lst = append(css, evenodd)

jnk = Map(function(...) do.call(htmltools::css, ...), lst)

dir = tempfile()
dir.create(dir)
fl = file.path(dir, "myCSS.css")

cat(
  sprintf(
    "%s{ \n  %s\n}\n\n"
    , names(jnk)
    , jnk
  )
  , sep = ""
  , file = fl
)

mymap = leaflet() %&gt;%
  addTiles() %&gt;%
  addCircleMarkers(data = breweries91,
                   popup = popupTable(breweries91, className = className))

addMyCSSDependency = function() {
  list(
    htmltools::htmlDependency(
      name = "mycss"
      , version = "0.0.1"
      , src = dir
      , stylesheet = basename(fl)
    )
  )
}

mymap$dependencies = c(
  mymap$dependencies
  , addMyCSSDependency()
)

mymap


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
