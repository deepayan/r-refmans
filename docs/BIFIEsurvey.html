<!DOCTYPE html><html lang="en"><head><title>Help for package BIFIEsurvey</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BIFIEsurvey}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BIFIEsurvey-package'>
<p>Tools for Survey Statistics in Educational Assessment</p></a></li>
<li><a href='#BIFIE.BIFIEdata2BIFIEcdata'>
<p>Conversion and Selection of <code>BIFIEdata</code> Objects</p></a></li>
<li><a href='#BIFIE.by'>
<p>Statistics for User Defined Functions</p></a></li>
<li><a href='#BIFIE.correl'>
<p>Correlations and Covariances</p></a></li>
<li><a href='#BIFIE.crosstab'>
<p>Cross Tabulation</p></a></li>
<li><a href='#BIFIE.data'>
<p>Creates an Object of Class <code>BIFIEdata</code></p></a></li>
<li><a href='#BIFIE.data.boot'>
<p>Create <code>BIFIE.data</code> Object based on Bootstrap</p></a></li>
<li><a href='#BIFIE.data.jack'>
<p>Create <code>BIFIE.data</code> Object with Jackknife Zones</p></a></li>
<li><a href='#BIFIE.data.transform'>
<p>Data Transformation for <code>BIFIEdata</code> Objects</p></a></li>
<li><a href='#BIFIE.derivedParameters'>
<p>Statistical Inference for Derived Parameters</p></a></li>
<li><a href='#BIFIE.ecdf'>
<p>Empirical Distribution Function and Quantiles</p></a></li>
<li><a href='#BIFIE.freq'>
<p>Frequency Statistics</p></a></li>
<li><a href='#BIFIE.hist'>
<p>Histogram</p></a></li>
<li><a href='#BIFIE.lavaan.survey'>
<p>Fitting a Model in <span class="pkg">lavaan</span> or in <span class="pkg">survey</span></p></a></li>
<li><a href='#BIFIE.linreg'>
<p>Linear Regression</p></a></li>
<li><a href='#BIFIE.logistreg'>
<p>Logistic Regression</p></a></li>
<li><a href='#BIFIE.mva'>
<p>Missing Value Analysis</p></a></li>
<li><a href='#BIFIE.pathmodel'>
<p>Path Model Estimation</p></a></li>
<li><a href='#BIFIE.twolevelreg'>
<p>Two Level Regression</p></a></li>
<li><a href='#BIFIE.univar'>
<p>Univariate Descriptive Statistics (Means and Standard Deviations)</p></a></li>
<li><a href='#BIFIE.univar.test'>
<p>Analysis of Variance and Effect Sizes for Univariate Statistics</p></a></li>
<li><a href='#BIFIE.waldtest'>
<p>Wald Tests for BIFIE Methods</p></a></li>
<li><a href='#BIFIEdata.select'>
<p>Selection of Variables and Imputed Datasets for Objects of Class <code>BIFIEdata</code></p></a></li>
<li><a href='#BIFIEdata2svrepdesign'>
<p>Conversion of a <code>BIFIEdata</code> Object into a <code>svyrep</code> Object in the</p>
<span class="pkg">survey</span> Package (and the other way around)</a></li>
<li><a href='#BIFIEsurvey-utilities'><p>Utility Functions in <span class="pkg">BIFIEsurvey</span></p></a></li>
<li><a href='#bifietable'>
<p>An <span class="pkg">Rcpp</span> Based Version of the <code>table</code> Function</p></a></li>
<li><a href='#data.bifie'>
<p>Example Datasets for the <span class="pkg">BIFIEsurvey</span> Package</p></a></li>
<li><a href='#data.pisaNLD'>
<p>Some PISA Datasets</p></a></li>
<li><a href='#data.test1'>
<p>Some Datasets for Testing Purposes</p></a></li>
<li><a href='#data.timss'>
<p>Dataset TIMSS 2011</p></a></li>
<li><a href='#save.BIFIEdata'>
<p>Saving, Writing and Loading <code>BIFIEdata</code> Objects</p></a></li>
<li><a href='#se'>
<p>Standard Errors of Estimated Parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Survey Statistics in Educational Assessment</td>
</tr>
<tr>
<td>Version:</td>
<td>3.6-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-25 13:32:27</td>
</tr>
<tr>
<td>Author:</td>
<td>BIFIE [aut], Alexander Robitzsch [aut, cre], 
        Konrad Oberwimmer [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Contains tools for survey statistics (especially in educational
    assessment) for datasets with replication designs (jackknife, 
    bootstrap, replicate weights; see Kolenikov, 2010;
    Pfefferman &amp; Rao, 2009a, 2009b, &lt;<a href="https://doi.org/10.1016%2FS0169-7161%2809%2970003-3">doi:10.1016/S0169-7161(09)70003-3</a>&gt;,
    &lt;<a href="https://doi.org/10.1016%2FS0169-7161%2809%2970037-9">doi:10.1016/S0169-7161(09)70037-9</a>&gt;); Shao, 1996, 
    &lt;<a href="https://doi.org/10.1080%2F02331889708802523">doi:10.1080/02331889708802523</a>&gt;). 
    Descriptive statistics, linear and logistic regression, 
    path models for manifest variables with measurement error 
    correction and two-level hierarchical regressions for weighted 
    samples are included. Statistical inference can be conducted for 
    multiply imputed datasets and nested multiply imputed datasets
    and is in particularly suited for the analysis of plausible values
    (for details see George, Oberwimmer &amp; Itzlinger-Bruneforth, 2016; 
    Bruneforth, Oberwimmer &amp; Robitzsch, 2016; Robitzsch, Pham &amp;
    Yanagida, 2016). The package development was supported by BIFIE 
    (Federal Institute for Educational Research, Innovation and Development 
    of the Austrian School System; Salzburg, Austria).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, miceadds, Rcpp, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>graphics, grDevices, lavaan, mitools, survey, TAM</td>
</tr>
<tr>
<td>Enhances:</td>
<td>Hmisc, intsvy, LSAmitR</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alexanderrobitzsch/BIFIEsurvey">https://github.com/alexanderrobitzsch/BIFIEsurvey</a>,
<a href="https://sites.google.com/view/alexander-robitzsch/software">https://sites.google.com/view/alexander-robitzsch/software</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-25 11:35:47 UTC; sunpn563</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-25 12:00:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='BIFIEsurvey-package'>
Tools for Survey Statistics in Educational Assessment
</h2><span id='topic+BIFIEsurvey-package'></span><span id='topic+BIFIEsurvey'></span>

<h3>Description</h3>


<p>    Contains tools for survey statistics (especially in educational
    assessment) for datasets with replication designs (jackknife, 
    bootstrap, replicate weights; see Kolenikov, 2010;
    Pfefferman &amp; Rao, 2009a, 2009b, &lt;doi:10.1016/S0169-7161(09)70003-3&gt;,
    &lt;doi:10.1016/S0169-7161(09)70037-9&gt;); Shao, 1996, 
    &lt;doi:10.1080/02331889708802523&gt;). 
    Descriptive statistics, linear and logistic regression, 
    path models for manifest variables with measurement error 
    correction and two-level hierarchical regressions for weighted 
    samples are included. Statistical inference can be conducted for 
    multiply imputed datasets and nested multiply imputed datasets
    and is in particularly suited for the analysis of plausible values
    (for details see George, Oberwimmer &amp; Itzlinger-Bruneforth, 2016; 
    Bruneforth, Oberwimmer &amp; Robitzsch, 2016; Robitzsch, Pham &amp;
    Yanagida, 2016). The package development was supported by BIFIE 
    (Federal Institute for Educational Research, Innovation and Development 
    of the Austrian School System; Salzburg, Austria).
</p>


<h3>Details</h3>

<p>The <span class="pkg">BIFIEsurvey</span> package include basic descriptive functions for large scale assessment data
to complement the more comprehensive <span class="pkg">survey</span> package. The
functions in this package were written in <span class="pkg">Rcpp</span>.
</p>
<p>The features of <span class="pkg">BIFIEsurvey</span> include for designs with replicate weights
(which includes Jackknife and Bootstrap as general approaches):
</p>

<ul>
<li><p> Descriptive statistics: means and standard deviations (<code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>),
frequencies (<code><a href="#topic+BIFIE.freq">BIFIE.freq</a></code>),
crosstabs (<code><a href="#topic+BIFIE.crosstab">BIFIE.crosstab</a></code>)
</p>
</li>
<li><p> Linear regression (<code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>)
</p>
</li>
<li><p> Logistic regression (<code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code>)
</p>
</li>
<li><p> Path models with measurement error correction for manifest
variables (<code><a href="#topic+BIFIE.pathmodel">BIFIE.pathmodel</a></code>)
</p>
</li>
<li><p> Two-level regression for hierarchical data (<code><a href="#topic+BIFIE.twolevelreg">BIFIE.twolevelreg</a></code>;
random slope model)
</p>
</li>
<li><p> Statistical inference for derived parameters (<code><a href="#topic+BIFIE.derivedParameters">BIFIE.derivedParameters</a></code>)
</p>
</li>
<li><p> Wald tests (<code><a href="#topic+BIFIE.waldtest">BIFIE.waldtest</a></code>) of model parameters based on
replicated statistics
</p>
</li>
<li><p> User-defined <span class="rlang"><b>R</b></span> functions (<code><a href="#topic+BIFIE.by">BIFIE.by</a></code>)
</p>
</li></ul>



<h3>Author(s)</h3>

<p>BIFIE [aut], Alexander Robitzsch [aut, cre], 
        Konrad Oberwimmer [aut]
</p>
<p>Maintainer: Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;
</p>


<h3>References</h3>

<p>Bruneforth, M., Oberwimmer, K., &amp; Robitzsch, A. (2016). Reporting und Analysen. 
In S. Breit &amp; C. Schreiner (Hrsg.). <em>Large-Scale Assessment mit R: Methodische 
Grundlagen der oesterreichischen Bildungsstandardueberpruefung</em> (S. 333-362). Wien: facultas.
</p>
<p>George, A. C., Oberwimmer, K., &amp; Itzlinger-Bruneforth, U. (2016). Stichprobenziehung. 
In S. Breit &amp; C. Schreiner (Hrsg.). <em>Large-Scale Assessment mit R: Methodische 
Grundlagen der oesterreichischen Bildungsstandardueberpruefung</em> (S. 51-81). Wien: facultas.
</p>
<p>Kolenikov, S. (2010). Resampling variance estimation for complex survey data.
<em>Stata Journal, 10</em>(2), 165-199.
</p>
<p>Pfefferman, D., &amp; Rao, C. R. (2009a). <em>Handbook of statistics, Vol. 29A:
Sample surveys: Design, methods and applications</em>. Amsterdam: North Holland.
</p>
<p>Pfefferman, D., &amp; Rao, C. R. (2009b). <em>Handbook of statistics, Vol. 29B:
Sample surveys: Inference and analysis</em>. Amsterdam: North Holland.
</p>
<p>Robitzsch, A., Pham, G., &amp; Yanagida, T. (2016). Fehlende Daten und Plausible Values. 
In S. Breit &amp; C. Schreiner (Hrsg.). <em>Large-Scale Assessment mit R: Methodische 
Grundlagen der oesterreichischen Bildungsstandardueberpruefung</em> (S. 259-293). Wien: facultas.
</p>
<p>Shao, J. (1996). Invited discussion paper: Resampling methods in sample surveys. 
<em>Statistics, 27</em>(3-4), 203-237.
</p>


<h3>See Also</h3>

<p>See also the <span class="pkg">survey</span>, <span class="pkg">intsvy</span>, <span class="pkg">EdSurvey</span>,
<b>lavaan.survey</b>, <span class="pkg">EVER</span> and
the <span class="pkg">eatRep</span> packages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##   |-----------------------------------------------------------------
##   | BIFIEsurvey 0.1-21 (2014-06-21)
##   | Maintainer: Alexander Robitzsch &lt;a.robitzsch at bifie.at &gt;
##   | http://www.bifie.at
##   |-----------------------------------------------------------------

##   .........................*,::;              :,:;       * .;*;. .,:
##   :::::::::::::::::::::::::.  ##+@              ##+#       .@####+ ;+# *
##   :::::::::::::::::::::::::.  ###@              ####       @@;   :*;##**
##   :::::::::::::::::::::::::.  ###@              ##+#     *##.      .,,
##   :::::::::::::::::::::::::.  ###@              ::,:    * ##
##   :::::::::::::::::::::::::.  ###@                 *      @@
##   :::::::::::::::::::::::::.  ###@                      * #@
##   :::::::::::::::::::::::::.  ###@                        #@                   *
##   :::::::::::::::::::::::::.  ##@#,@###@       @@## * @@@+##@@@@   #@     *.@#####
##   :::::::::::::::::::::::::.  ####*@#####@.**   ####   @@#@@@####   #@     ;##+**#+@*
##   :::::::::::::::::::::::::.  ##@@##,,#+##@     ####      @@        #@    .#@*  * *##
##   ::::,::::::::::::::::::::.  ##+@@    ####,    ####      #@        #@    ##,      #+*
##   ::::**.::::::::::::::::::.  ##+@, **,###@    ####      #@        #@    @@       ;@;
##   :::::*  .::::::::::::::::.  ##*       ####    ####      #@        #@   .##@@@@@@@#+#
##   :::::::*   *,,:::::::::::.     :      ###@    ####      #@        #@   ;##@@@@@@@@@@
##   :::::::::.      **....*    ,@#      ####    ####      #@        #@   *@**
##   ::::::::::::.*              ####      @###*   ####      #@        #@  *+#*
##   ::::::::::::::::,,,,,,,::.  ####      ####    ####      #@        #@  **#*
##   :::::::::::::::::::::::::.  ####      @###    ####      #@        #@ ,##
##   :::::::::::::::::::::::::.  ###@   *  @##+    ####      #@        #@   *#@
##   :::::::::::::::::::::::::*  @@##   ,#@##    ####      #@        #@    @#
##   :::::::::::::::::::::::::*  @+##,    @###*    ####      #@        #@   *+#@
##   ::::::::::::::::::::::::.    ###@:  *###@     ####      #@        #@     #@+
##   :::::::::::::::::::::::.   **;@#@#@####@.     ####      #@        #@     *@#@:*   *
##   ::::::::::::::::::::::.     ,@######@.      ####*     ##        @+      *#####@##
##   ::::::::::::::::::::.*        * .*##*. *        ***     *.        **         ;##+;.

</code></pre>

<hr>
<h2 id='BIFIE.BIFIEdata2BIFIEcdata'>
Conversion and Selection of <code>BIFIEdata</code> Objects
</h2><span id='topic+BIFIE.BIFIEdata2BIFIEcdata'></span><span id='topic+BIFIE.BIFIEcdata2BIFIEdata'></span><span id='topic+BIFIE.BIFIEdata2datalist'></span>

<h3>Description</h3>

<p>Functions for converting and selecting objects of class <code>BIFIEdata</code>.
The function <code>BIFIE.BIFIEdata2BIFIEcdata</code> converts the <code>BIFIEdata</code>
objects in a non-compact form (<code>cdata=FALSE</code>) into an object of
class <code>BIFIEdata</code> in a compact form (<code>cdata=TRUE</code>).
The function <code>BIFIE.BIFIE2data2BIFIEdata</code> takes the reverse operation.
</p>
<p>The function <code>BIFIE.BIFIEdata2datalist</code> converts a (part) of the
object of class <code>BIFIEdata</code> into a list of multiply-imputed
datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.BIFIEdata2BIFIEcdata(bifieobj, varnames=NULL, impdata.index=NULL)

BIFIE.BIFIEcdata2BIFIEdata(bifieobj, varnames=NULL, impdata.index=NULL)

BIFIE.BIFIEdata2datalist(bifieobj, varnames=NULL, impdata.index=NULL,
    as_data_frame=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.BIFIEdata2BIFIEcdata_+3A_bifieobj">bifieobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.BIFIEdata2BIFIEcdata_+3A_varnames">varnames</code></td>
<td>

<p>Variables chosen for the selection
</p>
</td></tr>
<tr><td><code id="BIFIE.BIFIEdata2BIFIEcdata_+3A_impdata.index">impdata.index</code></td>
<td>

<p>Selected indices of imputed datasets
</p>
</td></tr>
<tr><td><code id="BIFIE.BIFIEdata2BIFIEcdata_+3A_as_data_frame">as_data_frame</code></td>
<td>
<p>Logical indicating whether list of length one should
be converted into a data frame</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BIFIEdata</code> saved in a non-compact
or compact way, see value <code>cdata</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BIFIE.data">BIFIE.data</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: BIFIEdata conversions using data.timss1 dataset
#############################################################################
data(data.timss1)
data(data.timssrep)

# create BIFIEdata object
bdat1 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ])
summary(bdat1)

# convert BIFIEdata object bdat1 into a BIFIEcdata object with
#  only using the first three datasets and a variable selection
bdat2 &lt;- BIFIEsurvey::BIFIE.BIFIEdata2BIFIEcdata( bifieobj=bdat1,
                varnames=bdat1$varnames[ c(1:7,10) ] )

# convert bdat2 into BIFIEdata object and only use the first three imputed datasets
bdat3 &lt;- BIFIEsurvey::BIFIE.BIFIEcdata2BIFIEdata( bifieobj=bdat2, impdata.index=1:3)

# object summaries
summary(bdat1)
summary(bdat2)
summary(bdat3)

## Not run: 
#############################################################################
# EXAMPLE 2: Extract unique elements in BIFIEdata object
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIEdata object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ])
summary(bifieobj)

# define variables for which unique values should be extracted
vars &lt;- c( "female", "books","ASMMAT" )
# convert these variables from BIFIEdata object into a list of datasets
bdatlist &lt;- BIFIEsurvey::BIFIE.BIFIEdata2datalist( bifieobj, varnames=vars )
# look for unique values in first dataset for variables
values &lt;- lapply( bdatlist[[1]], FUN=function(vv){
                sort( unique( vv ) ) } )
# number of unique values in first dataset
Nvalues &lt;- lapply( bdatlist[[1]], FUN=function(vv){
                length( unique( vv ) ) } )
# number of unique values in all datasets
Nvalues2 &lt;- lapply( vars, FUN=function(vv){
    #vv &lt;- vars[1]
    unlist( lapply( bdatlist, FUN=function(dd){
                length( unique( dd[,vv]  ) )
                        }    )     )
                    } )
# --&gt; for extracting the number of unique values using BIFIE.by and a user
#     defined function see Example 1, Model 3 in "BIFIE.by"

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.by'>
Statistics for User Defined Functions
</h2><span id='topic+BIFIE.by'></span><span id='topic+summary.BIFIE.by'></span><span id='topic+coef.BIFIE.by'></span><span id='topic+vcov.BIFIE.by'></span>

<h3>Description</h3>

<p>Computes statistics for user defined functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.by( BIFIEobj, vars, userfct, userparnames=NULL,
     group=NULL, group_values=NULL, se=TRUE, use_Rcpp=TRUE)

## S3 method for class 'BIFIE.by'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.by'
coef(object,...)

## S3 method for class 'BIFIE.by'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.by_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_userfct">userfct</code></td>
<td>
<p>User defined function. This function must include
a matrix <code>X</code> and a weight vector <code>w</code> as
arguments. The value of this function must be a vector.
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_userparnames">userparnames</code></td>
<td>
<p>An optional vector of parameter names for the
value of <code>userfct</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_use_rcpp">use_Rcpp</code></td>
<td>
<p>Optional logical indicating whether the user defined
function should be evaluated in <span class="pkg">Rcpp</span>.</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.by</code></p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.by_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with statistics defined in <code>userfct</code></p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+svyby">survey::svyby</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

#****************************
#*** Model 1: Weighted means (as a toy example)
userfct &lt;- function(X,w){
        pars &lt;- c( stats::weighted.mean( X[,1], w ),
                     stats::weighted.mean(X[,2], w )   )
        return(pars)
                        }
res1 &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars=c("ASMMAT", "migrant", "books"),
                userfct=userfct, userparnames=c("MW_MAT", "MW_Migr"),
                group="female" )
summary(res1)

# evaluate function in pure R implementation using the use_Rcpp argument
res1b &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars=c("ASMMAT", "migrant", "books" ),
                userfct=userfct, userparnames=c("MW_MAT", "MW_Migr"),
                group="female", use_Rcpp=FALSE )
summary(res1b)

#--- statistical inference for a derived parameter (see ?BIFIE.derivedParameters)
# define gender difference for mathematics score (divided by 100)
derived.parameters &lt;- list(
        "gender_diff"=~ 0 + I( ( MW_MAT_female1 - MW_MAT_female0 ) / 100 )
                            )
# inference derived parameter
res1d &lt;- BIFIEsurvey::BIFIE.derivedParameters( res1,
                derived.parameters=derived.parameters )
summary(res1d)

## Not run: 
#****************************
#**** Model 2: Robust linear model

# (1) start from scratch to formulate the user function for X and w
dat1 &lt;- bifieobj$dat1
vars &lt;- c("ASMMAT", "migrant", "books" )
X &lt;- dat1[,vars]
w &lt;- bifieobj$wgt
library(MASS)
# ASMMAT ~ migrant + books
mod &lt;- MASS::rlm( X[,1] ~  as.matrix( X[, -1 ] ), weights=w )
coef(mod)
# (2) define a user function "my_rlm"
my_rlm &lt;- function(X,w){
    mod &lt;- MASS::rlm( X[,1] ~  as.matrix( X[, -1 ] ), weights=w )
    return( coef(mod) )
                }
# (3) estimate model
res2 &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars, userfct=my_rlm,
                group="female", group_values=0:1)
summary(res2)
# estimate model without computing standard errors
res2a &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars, userfct=my_rlm,
                group="female", se=FALSE)
summary(res2a)

# define a user function with formula language
my_rlm2 &lt;- function(X,w){
    colnames(X) &lt;- vars
    X &lt;- as.data.frame(X)
    mod &lt;- MASS::rlm( ASMMAT ~  migrant + books, weights=w, data=X)
    return( coef(mod) )
                }
# estimate model
res2b &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars, userfct=my_rlm2,
                group="female", group_values=0:1)
summary(res2b)


#****************************
#**** Model 3: Number of unique values for variables in BIFIEdata

#*** define variables for which the number of unique values should be calculated
vars &lt;- c( "female", "books","ASMMAT" )
#*** define a user function extracting these unqiue values
userfct &lt;- function(X,w){
        pars &lt;- apply( X, 2, FUN=function(vv){
                     length( unique(vv))  } )
        # Note that weights are (of course) ignored in this function
        return(pars)
                        }
#*** extract number of unique values
res3 &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars=vars, userfct=userfct,
              userparnames=paste0( vars, "_Nunique"),  se=FALSE )
summary(res3)
  ##   Statistical Inference for User Definition Function
  ##               parm Ncases  Nweight    est
  ##   1 female_Nunique   4668 78332.99    2.0
  ##   2  books_Nunique   4668 78332.99    5.0
  ##   3 ASMMAT_Nunique   4668 78332.99 4613.4
# number of unique values in each of the five imputed datasets
res3$output$parsrepM
  ##        [,1] [,2] [,3] [,4] [,5]
  ##   [1,]    2    2    2    2    2
  ##   [2,]    5    5    5    5    5
  ##   [3,] 4617 4619 4614 4609 4608

#****************************
#**** Model 4: Estimation of a lavaan model with BIFIE.by

#* estimate model in lavaan

data0 &lt;- data.timss1[[1]]
# define lavaan model
lavmodel &lt;- "
  ASSSCI ~ likesc
  ASSSCI ~~ ASSSCI
  likesc ~ female
  likesc ~~ likesc
  female ~~ female
"

mod0 &lt;- lavaan::lavaan(lavmodel, data=data0, sampling.weights="TOTWGT")
summary(mod0, stand=TRUE, fit.measures=TRUE)

#* construct input for BIFIE.by
vars &lt;- c("ASSSCI","likesc","female","TOTWGT")
X &lt;- data0[,vars]
mod0 &lt;- lavaan::lavaan(lavmodel, data=X, sampling.weights="TOTWGT")
w &lt;- data0$TOTWGT

#* define user function
userfct &lt;- function(X,w){
  X1 &lt;- as.data.frame(X)
  colnames(X1) &lt;- vars
  X1$studwgt &lt;- w
  mod0 &lt;- lavaan::lavaan(lavmodel, data=X1, sampling.weights="TOTWGT")
  pars &lt;- coef(mod0)
  # extract some fit statistics
  pars2 &lt;- lavaan::fitMeasures(mod0)
  pars &lt;- c(pars, pars2[c("cfi","tli")])
  return(pars)
}

#* test function
res0 &lt;- userfct(X,w)
userparnames &lt;- names(res0)

#* estimate lavaan model with replicated sampling weights
res1 &lt;-  BIFIEsurvey::BIFIE.by( bifieobj, vars=vars, userfct=userfct,
                  userparnames=userparnames, use_Rcpp=FALSE )
summary(res1)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.correl'>
Correlations and Covariances
</h2><span id='topic+BIFIE.correl'></span><span id='topic+summary.BIFIE.correl'></span><span id='topic+coef.BIFIE.correl'></span><span id='topic+vcov.BIFIE.correl'></span>

<h3>Description</h3>

<p>Computes correlations and covariances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.correl(BIFIEobj, vars, group=NULL, group_values=NULL, se=TRUE)

## S3 method for class 'BIFIE.correl'
summary(object,digits=4, ...)

## S3 method for class 'BIFIE.correl'
coef(object,type=NULL, ...)

## S3 method for class 'BIFIE.correl'
vcov(object,type=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.correl_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed
</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.correl</code></p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_type">type</code></td>
<td>
<p>If <code>type="cov"</code>, then covariances instead of
correlations are extracted.</p>
</td></tr>
<tr><td><code id="BIFIE.correl_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat.cor</code></td>
<td>
<p>Data frame with correlation statistics</p>
</td></tr>
<tr><td><code>stat.cov</code></td>
<td>
<p>Data frame with covariance statistics</p>
</td></tr>
<tr><td><code>cor_matrix</code></td>
<td>
<p>List of estimated correlation matrices</p>
</td></tr>
<tr><td><code>cov_matrix</code></td>
<td>
<p>List of estimated covariance matrices</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cov.wt">stats::cov.wt</a></code>,
<code><a href="intsvy.html#topic+timss.rho">intsvy::timss.rho</a></code>,
<code><a href="intsvy.html#topic+timss.rho.pv">intsvy::timss.rho.pv</a></code>,
<code><a href="Hmisc.html#topic+rcorr">Hmisc::rcorr</a></code>,
<code><a href="miceadds.html#topic+ma.wtd.statNA">miceadds::ma.wtd.corNA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# Correlations splitted by gender
res1 &lt;- BIFIEsurvey::BIFIE.correl( bdat, vars=c("lang", "books", "migrant" ),
              group="female", group_values=0:1 )
summary(res1)

# Correlations splitted by gender: no statistical inference (se=FALSE)
res1a &lt;- BIFIEsurvey::BIFIE.correl( bdat, vars=c("lang", "books", "migrant" ),
              group="female", group_values=0:1, se=FALSE)
summary(res1a)
</code></pre>

<hr>
<h2 id='BIFIE.crosstab'>
Cross Tabulation
</h2><span id='topic+BIFIE.crosstab'></span><span id='topic+summary.BIFIE.crosstab'></span><span id='topic+coef.BIFIE.crosstab'></span><span id='topic+vcov.BIFIE.crosstab'></span>

<h3>Description</h3>

<p>Creates cross tabulations and computes some effect sizes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.crosstab( BIFIEobj, vars1, vars2, vars_values1=NULL, vars_values2=NULL,
     group=NULL, group_values=NULL, se=TRUE )

## S3 method for class 'BIFIE.crosstab'
summary(object,digits=3,...)

## S3 method for class 'BIFIE.crosstab'
coef(object,...)

## S3 method for class 'BIFIE.crosstab'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.crosstab_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_vars1">vars1</code></td>
<td>

<p>Row variable
</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_vars2">vars2</code></td>
<td>

<p>Column variable
</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_vars_values1">vars_values1</code></td>
<td>
<p>Optional vector of values of variable <code>vars1</code></p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_vars_values2">vars_values2</code></td>
<td>
<p>Optional vector of values of variable <code>vars2</code></p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.univar</code></p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.crosstab_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat.probs</code></td>
<td>
<p>Statistics for joint and conditional probabilities</p>
</td></tr>
<tr><td><code>stat.marg</code></td>
<td>
<p>Statistics for marginal probabilities</p>
</td></tr>
<tr><td><code>stat.es</code></td>
<td>
<p>Statistics for effect sizes <code class="reqn">w</code> (based on <code class="reqn">\chi^2</code>),
Cramers <code class="reqn">V</code>, Goodman's gamma, the PRE lambda measure and
Kruskals tau.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+svytable">survey::svytable</a></code>,
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

#--- Model 1: cross tabulation
res1 &lt;- BIFIEsurvey::BIFIE.crosstab( bifieobj, vars1="migrant",
               vars2="books", group="female" )
summary(res1)
</code></pre>

<hr>
<h2 id='BIFIE.data'>
Creates an Object of Class <code>BIFIEdata</code>
</h2><span id='topic+BIFIE.data'></span><span id='topic+summary.BIFIEdata'></span><span id='topic+print.BIFIEdata'></span>

<h3>Description</h3>

<p>This function creates an object of class <code>BIFIEdata</code>.
Finite sampling correction of statistical inferences can be
conducted by specifying appropriate input in the <code>fayfac</code>
argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.data(data.list, wgt=NULL, wgtrep=NULL, fayfac=1, pv_vars=NULL,
     pvpre=NULL, cdata=FALSE, NMI=FALSE)

## S3 method for class 'BIFIEdata'
summary(object,...)

## S3 method for class 'BIFIEdata'
print(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.data_+3A_data.list">data.list</code></td>
<td>

<p>List of multiply imputed datasets. Can be also a list of list of imputed
datasets in case of nested multiple imputation. Then, the argument
<code>NMI=TRUE</code> must be specified.
</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_wgt">wgt</code></td>
<td>

<p>A string indicating the label of case weight or a vector
containing all case weights.
</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_wgtrep">wgtrep</code></td>
<td>

<p>Optional vector of replicate weights
</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_fayfac">fayfac</code></td>
<td>
<p>Fay factor for calculating standard errors, a numeric value.
If finite sampling correction
is requested, an appropriate vector input can be used (see Example 3).
</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_pv_vars">pv_vars</code></td>
<td>
<p>Optional vector for names of plausible values, see
<code><a href="#topic+BIFIE.data.jack">BIFIE.data.jack</a></code>.</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_pvpre">pvpre</code></td>
<td>
<p>Optional vector for prefixes of plausible values, see
<code><a href="#topic+BIFIE.data.jack">BIFIE.data.jack</a></code>.</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_cdata">cdata</code></td>
<td>
<p>An optional logical indicating whether the <code>BIFIEdata</code>
object should be compactly saved. The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_nmi">NMI</code></td>
<td>
<p>Optional logical indicating whether <code>data.list</code> is obtained
by nested multiple imputation.</p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIEdata</code></p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_x">x</code></td>
<td>
<p>Object of class <code>BIFIEdata</code></p>
</td></tr>
<tr><td><code id="BIFIE.data_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BIFIEdata</code> saved in a non-compact
or compact way, see value <code>cdata</code>. The following entries are
included in the list:
</p>
<table role = "presentation">
<tr><td><code>datalistM</code></td>
<td>
<p>Stacked list of imputed datasets (if <code>cdata=FALSE</code>)</p>
</td></tr>
<tr><td><code>wgt</code></td>
<td>
<p>Vector with case weights</p>
</td></tr>
<tr><td><code>wgtrep</code></td>
<td>
<p>Matrix with replicate weights</p>
</td></tr>
<tr><td><code>Nimp</code></td>
<td>
<p>Number of imputed datasets</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of observations in a dataset</p>
</td></tr>
<tr><td><code>dat1</code></td>
<td>
<p>Last imputed dataset</p>
</td></tr>
<tr><td><code>varnames</code></td>
<td>
<p>Vector with variable names</p>
</td></tr>
<tr><td><code>fayfac</code></td>
<td>
<p>Fay factor.</p>
</td></tr>
<tr><td><code>RR</code></td>
<td>
<p>Number of replicate weights</p>
</td></tr>
<tr><td><code>NMI</code></td>
<td>
<p>Logical indicating whether the dataset is nested multiply
imputed.</p>
</td></tr>
<tr><td><code>cdata</code></td>
<td>
<p>Logical indicating whether the <code>BIFIEdata</code> object is in
compact format (<code>cdata=TRUE</code>) or in a non-compact format
(<code>cdata=FALSE</code>).
</p>
</td></tr>
<tr><td><code>Nvars</code></td>
<td>
<p>Number of variables</p>
</td></tr>
<tr><td><code>variables</code></td>
<td>
<p>Data frame including some informations about variables.
All transformations are saved in the column <code>source</code>.</p>
</td></tr>
<tr><td><code>datalistM_ind</code></td>
<td>
<p>Data frame with response indicators
(if <code>cdata=TRUE</code>)</p>
</td></tr>
<tr><td><code>datalistM_imputed</code></td>
<td>
<p>Data frame with imputed values
(if <code>cdata=TRUE</code>)</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>See <code><a href="#topic+BIFIE.data.transform">BIFIE.data.transform</a></code> for data transformations on
<code>BIFIEdata</code> objects.
</p>
<p>For saving and loading <code>BIFIEdata</code> objects see
<code><a href="#topic+save.BIFIEdata">save.BIFIEdata</a></code>.
</p>
<p>For converting PIRLS/TIMSS or PISA datasets into <code>BIFIEdata</code>
objects see <code><a href="#topic+BIFIE.data.jack">BIFIE.data.jack</a></code>.
</p>
<p>See the <code><a href="#topic+BIFIEdata2svrepdesign">BIFIEdata2svrepdesign</a></code> function for converting
<code>BIFIEdata</code> objects to objects used in the <span class="pkg">survey</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Create BIFIEdata object with multiply-imputed TIMSS data
#############################################################################
data(data.timss1)
data(data.timssrep)

bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ] )
summary(bdat)
# create BIFIEdata object in a compact way
bdat2 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ], cdata=TRUE)
summary(bdat2)

## Not run: 
#############################################################################
# EXAMPLE 2: Create BIFIEdata object with one dataset
#############################################################################
data(data.timss2)

# use first dataset with missing data from data.timss2
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss2[[1]], wgt=data.timss2[[1]]$TOTWGT)

## End(Not run)

#############################################################################
# EXAMPLE 3: BIFIEdata objects with finite sampling correction
#############################################################################

data(data.timss1)
data(data.timssrep)

#-----
# BIFIEdata object without finite sampling correction
bdat1 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ] )
summary(bdat1)

#-----
# generate BIFIEdata object with finite sampling correction by adjusting
# the "fayfac" factor
bdat2 &lt;- bdat1
#-- modify "fayfac" constant
fayfac0 &lt;- bdat1$fayfac
# set fayfac=.75 for the first 50 replication zones (25% of students in the
# population were sampled) and fayfac=.20 for replication zones 51-75
# (meaning that 80% of students were sampled)
fayfac &lt;- rep( fayfac0, bdat1$RR )
fayfac[1:50] &lt;- fayfac0 * .75
fayfac[51:75] &lt;- fayfac0 * .20
# include this modified "fayfac" factor in bdat2
bdat2$fayfac &lt;- fayfac
summary(bdat2)
summary(bdat1)

#---- compare some univariate statistics
# no finite sampling correction
res1 &lt;- BIFIEsurvey::BIFIE.univar( bdat1, vars="ASMMAT")
summary(res1)
# finite sampling correction
res2 &lt;- BIFIEsurvey::BIFIE.univar( bdat2, vars="ASMMAT")
summary(res2)

## Not run: 
#############################################################################
# EXAMPLE 4: Create BIFIEdata object with nested multiply imputed dataset
#############################################################################

data(data.timss4)
data(data.timssrep)

# nested imputed dataset, save it in compact format
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss4,
            wgt=data.timss4[[1]][[1]]$TOTWGT, wgtrep=data.timssrep[, -1 ],
            NMI=TRUE, cdata=TRUE )
summary(bdat)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.data.boot'>
Create <code>BIFIE.data</code> Object based on Bootstrap
</h2><span id='topic+BIFIE.data.boot'></span>

<h3>Description</h3>

<p>Creates a <code>BIFIE.data</code> object based on bootstrap designs.
The sampling is done assuming independence of cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.data.boot( data, wgt=NULL,  pv_vars=NULL,
         Nboot=500, seed=.Random.seed, cdata=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.data.boot_+3A_data">data</code></td>
<td>

<p>Data frame: Can be a single or a list of multiply imputed datasets
</p>
</td></tr>
<tr><td><code id="BIFIE.data.boot_+3A_wgt">wgt</code></td>
<td>

<p>A string indicating the label of case weight.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.boot_+3A_pv_vars">pv_vars</code></td>
<td>

<p>An optional vector of plausible values which define multiply
imputed datasets.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.boot_+3A_nboot">Nboot</code></td>
<td>
<p>Number of
bootstrap samples for usage</p>
</td></tr>
<tr><td><code id="BIFIE.data.boot_+3A_seed">seed</code></td>
<td>
<p>Simulation seed.</p>
</td></tr>
<tr><td><code id="BIFIE.data.boot_+3A_cdata">cdata</code></td>
<td>
<p>An optional logical indicating whether the <code>BIFIEdata</code>
object should be compactly saved. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>BIFIEdata</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BIFIE.data">BIFIE.data</a></code>, <code><a href="#topic+BIFIE.data.jack">BIFIE.data.jack</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: Bootstrap TIMSS data set
#############################################################################
data(data.timss1)

# bootstrap samples using weights
bifieobj1 &lt;- BIFIEsurvey::BIFIE.data.boot( data.timss1, wgt="TOTWGT" )
summary(bifieobj1)

# bootstrap samples without weights
bifieobj2 &lt;- BIFIEsurvey::BIFIE.data.boot( data.timss1  )
summary(bifieobj2)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.data.jack'>
Create <code>BIFIE.data</code> Object with Jackknife Zones
</h2><span id='topic+BIFIE.data.jack'></span>

<h3>Description</h3>

<p>Creates a <code>BIFIE.data</code> object for designs with jackknife zones,
especially for TIMSS/PIRLS and PISA studies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.data.jack(data, wgt=NULL, jktype="JK_TIMSS", pv_vars=NULL,
     jkzone=NULL, jkrep=NULL, jkfac=NULL, fayfac=NULL,
     wgtrep="W_FSTR", pvpre=paste0("PV",1:5), ngr=100,
     seed=.Random.seed, cdata=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.data.jack_+3A_data">data</code></td>
<td>

<p>Data frame: Can be a single or a list of multiply-imputed datasets
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_wgt">wgt</code></td>
<td>

<p>A string indicating the label of case weight.
In case of <code>jktype="JK_TIMSS"</code> the weight is specified as
<code>wgt="TOTWGT"</code> as the default.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_pv_vars">pv_vars</code></td>
<td>

<p>An optional vector of plausible values which define multiply-imputed datasets.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_jktype">jktype</code></td>
<td>

<p>Type of jackknife procedure for creating the <code>BIFIE.data</code> object.
<code>jktype="JK_TIMSS"</code> refers to TIMSS/PIRLS datasets up to 2011 data,
<code>jktype="JK_TIMSS2"</code> refers to TIMSS/PIRLS datasets starting from 2015 data. The type
<code>"JK_GROUP"</code> creates jackknife weights based on a user defined
grouping, the type <code>"JK_RANDOM"</code> creates random groups. The number
of random groups can be defined in <code>ngr</code>. The argument <code>jktype="RW_PISA"</code>
converts PISA datasets into objects of class <code>BIFIEdata</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_jkzone">jkzone</code></td>
<td>

<p>Jackknife zones. If <code>jktype="JK_TIMSS"</code>, then <code>jkzone="JKZONE"</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_jkrep">jkrep</code></td>
<td>

<p>Jackknife replicate factors. If <code>jktype="JK_TIMSS"</code>, then <code>jkrep="JKREP"</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_jkfac">jkfac</code></td>
<td>

<p>Factor for multiplying jackknife replicate weights.
If <code>jktype="JK_TIMSS"</code>, then <code>jkfac=2</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_fayfac">fayfac</code></td>
<td>

<p>Fay factor for statistical inference. The default is set to <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_wgtrep">wgtrep</code></td>
<td>
<p>Variables in the dataset which refer to the replicate
weights. In case of <code>cdata=TRUE</code>, the replicate weights
are deleted from <code>datalistM</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_pvpre">pvpre</code></td>
<td>
<p>Only applicable for <code>jktype="RW_PISA"</code>. The vector contains
the prefixes of the variables containing plausible values.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_ngr">ngr</code></td>
<td>
<p>Number of randomly created groups in <code>"JK_RANDOM"</code>.</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_seed">seed</code></td>
<td>
<p>The simulation seed if <code>"JK_RANDOM"</code> is chosen.
If <code>seed=NULL</code>, then the grouping is done according the
order in the dataset.</p>
</td></tr>
<tr><td><code id="BIFIE.data.jack_+3A_cdata">cdata</code></td>
<td>
<p>An optional logical indicating whether the <code>BIFIEdata</code>
object should be compactly saved. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>BIFIEdata</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BIFIE.data">BIFIE.data</a></code>, <code><a href="#topic+BIFIE.data.boot">BIFIE.data.boot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Convert TIMSS dataset to BIFIE.data object
#############################################################################

data(data.timss3)

# define plausible values
pv_vars &lt;- c("ASMMAT", "ASSSCI" )
# create BIFIE.data objects -&gt; 5 imputed datasets
bdat1 &lt;- BIFIEsurvey::BIFIE.data.jack( data=data.timss3,  pv_vars=pv_vars,
             jktype="JK_TIMSS"  )
summary(bdat1)

# create BIFIE.data objects -&gt; all PVs are included in one dataset
bdat2 &lt;- BIFIEsurvey::BIFIE.data.jack( data=data.timss3,  jktype="JK_TIMSS"  )
summary(bdat2)

#############################################################################
# EXAMPLE 2: Creation of Jackknife zones and replicate weights for data.test1
#############################################################################

data(data.test1)

# create jackknife zones based on random group creation
bdat1 &lt;- BIFIEsurvey::BIFIE.data.jack( data=data.test1,  jktype="JK_RANDOM",
                    ngr=50 )
summary(bdat1)
stat1 &lt;- BIFIEsurvey::BIFIE.univar( bdat1, vars="math",  group="stratum" )
summary(stat1)

# random creation of groups and inclusion of weights
bdat2 &lt;- BIFIEsurvey::BIFIE.data.jack( data=data.test1,  jktype="JK_RANDOM",
                ngr=75, seed=987, wgt="wgtstud")
summary(bdat2)
stat2 &lt;- BIFIEsurvey::BIFIE.univar( bdat2, vars="math",  group="stratum" )
summary(stat2)

# using idclass as jackknife zones
bdat3 &lt;- BIFIEsurvey::BIFIE.data.jack( data=data.test1,  jktype="JK_GROUP",
                jkzone="idclass", wgt="wgtstud")
summary(bdat3)
stat3 &lt;- BIFIEsurvey::BIFIE.univar( bdat3, vars="math",  group="stratum" )
summary(stat3)

# create BIFIEdata object with a list of imputed datasets
dataList &lt;- list( data.test1, data.test1, data.test1 )
bdat4 &lt;- BIFIEsurvey::BIFIE.data.jack( data=dataList,  jktype="JK_GROUP",
                jkzone="idclass", wgt="wgtstud")
summary(bdat4)

## Not run: 
#############################################################################
# EXAMPLE 3: Converting a PISA dataset into a BIFIEdata object
#############################################################################

data(data.pisaNLD)

# BIFIEdata with cdata=FALSE
bifieobj &lt;- BIFIEsurvey::BIFIE.data.jack( data.pisaNLD, jktype="RW_PISA", cdata=FALSE)
summary(bifieobj)
# BIFIEdata with cdata=TRUE
bifieobj1 &lt;- BIFIEsurvey::BIFIE.data.jack( data.pisaNLD, jktype="RW_PISA", cdata=TRUE)
summary(bifieobj1)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.data.transform'>
Data Transformation for <code>BIFIEdata</code> Objects
</h2><span id='topic+BIFIE.data.transform'></span>

<h3>Description</h3>

<p>Computes a data transformation for <code>BIFIEdata</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.data.transform( bifieobj, transform.formula, varnames.new=NULL )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.data.transform_+3A_bifieobj">bifieobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.data.transform_+3A_transform.formula">transform.formula</code></td>
<td>

<p><span class="rlang"><b>R</b></span> formula object for data transformation.
</p>
</td></tr>
<tr><td><code id="BIFIE.data.transform_+3A_varnames.new">varnames.new</code></td>
<td>
<p>Optional vector of names for new defined variables.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BIFIEdata</code>. Additional values are
</p>
<table role = "presentation">
<tr><td><code>varnames.added</code></td>
<td>
<p>Added variables in data transformation</p>
</td></tr>
<tr><td><code>varsindex.added</code></td>
<td>
<p>Indices of added variables</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>library(miceadds)

#############################################################################
# EXAMPLE 1: Data transformations for TIMSS data
#############################################################################

data(data.timss2)
data(data.timssrep)
# create BIFIEdata object
bifieobj1 &lt;- BIFIEsurvey::BIFIE.data( data.timss2, wgt=data.timss2[[1]]$TOTWGT,
            wgtrep=data.timssrep[,-1] )
# create BIFIEdata object in compact way (cdata=TRUE)
bifieobj2 &lt;- BIFIEsurvey::BIFIE.data( data.timss2, wgt=data.timss2[[1]]$TOTWGT,
            wgtrep=data.timssrep[,-1], cdata=TRUE)

#****************************
#*** Transformation 1: Squared and cubic book variable
transform.formula &lt;- ~ I( books^2 ) + I( books^3 )
# as.character(transform.formula)
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj1,
                  transform.formula=transform.formula)
bifieobj$variables
# rename added variables
bifieobj$varnames[ bifieobj$varsindex.added ] &lt;- c("books_sq", "books_cub")

# check descriptive statistics
res1 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj, vars=c("books_sq", "books_cub" ) )
summary(res1)

## Not run: 
#****************************
#*** Transformation 2: Create dummy variables for variable book
transform.formula &lt;- ~ as.factor(books)
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
                    transform.formula=transform.formula )
##   Included 5 variables: as.factor(books)1 as.factor(books)2 as.factor(books)3
##        as.factor(books)4 as.factor(books)5
bifieobj$varnames[ bifieobj$varsindex.added ] &lt;- paste0("books_D", 1:5)

#****************************
#*** Transformation 3: Discretized mathematics score
hi3a &lt;- BIFIEsurvey::BIFIE.hist( bifieobj, vars="ASMMAT" )
plot(hi3a)
transform.formula &lt;- ~ I( as.numeric(cut( ASMMAT, breaks=seq(200,800,100) )) )
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
                 transform.formula=transform.formula, varnames.new="ASMMAT_discret")
hi3b &lt;- BIFIEsurvey::BIFIE.hist( bifieobj, vars="ASMMAT_discret", breaks=1:7 )
plot(hi3b)
# check frequencies
fr3b &lt;- BIFIEsurvey::BIFIE.freq( bifieobj, vars="ASMMAT_discret", se=FALSE )
summary(fr3b)

#****************************
#*** Transformation 4: include standardization variables for book variable

# start with testing the transformation function on a single dataset
dat1 &lt;- bifieobj$dat1
stats::weighted.mean( dat1[,"books"], dat1[,"TOTWGT"], na.rm=TRUE)
sqrt( Hmisc::wtd.var( dat1[,"books"], dat1[,"TOTWGT"], na.rm=TRUE) )
# z standardization
transform.formula &lt;- ~ I( ( books - weighted.mean( books, TOTWGT, na.rm=TRUE) )/
                                sqrt( Hmisc::wtd.var( books, TOTWGT, na.rm=TRUE) ))
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
               transform.formula=transform.formula, varnames.new="z_books" )
# standardize variable books with M=500 and SD=100
transform.formula &lt;- ~ I(
        500 + 100*( books - stats::weighted.mean( books, w=TOTWGT, na.rm=TRUE) ) /
              sqrt( Hmisc::wtd.var( books, weights=TOTWGT, na.rm=TRUE) )  )
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
             transform.formula=transform.formula, varnames.new="z500_books" )

# standardize variable books with respect to M and SD of ALL imputed datasets
res &lt;- BIFIEsurvey::BIFIE.univar( bifieobj, vars="books" )
summary(res)
##       var  Nweight Ncases     M M_SE M_fmi M_VarMI M_VarRep    SD SD_SE SD_fmi
##   1 books 76588.72   4554 2.945 0.04     0       0    0.002 1.146 0.015      0
M &lt;- round(res$output$mean1,5)
SD &lt;- round(res$output$sd1,5)
transform.formula &lt;- paste0( " ~ I( ( books - ",  M, " ) / ", SD, ")"  )
##   &gt; transform.formula
##   [1] " ~ I( ( books - 2.94496 ) / 1.14609)"
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
                 transform.formula=stats::as.formula(transform.formula),
                 varnames.new="zall_books" )

# check statistics
res4 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj,
              vars=c("z_books", "z500_books", "zall_books") )
summary(res4)

#****************************
#*** Transformation 5: include rank transformation for variable ASMMAT

# calculate percentage ranks using wtd.rank function from Hmisc package
dat1 &lt;- bifieobj$dat1
100 * Hmisc::wtd.rank( dat1[,"ASMMAT"], w=dat1[,"TOTWGT"] ) / sum( dat1[,"TOTWGT"] )
# define an auxiliary function for calculating percentage ranks
wtd.percrank &lt;- function( x, w ){
    100 * Hmisc::wtd.rank( x, w, na.rm=TRUE ) / sum( w, na.rm=TRUE )
}
wtd.percrank( dat1[,"ASMMAT"], dat1[,"TOTWGT"] )
# define transformation formula
transform.formula &lt;- ~ I( wtd.percrank( ASMMAT, TOTWGT ) )
# add ranks to BIFIEdata object
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
               transform.formula=transform.formula,  varnames.new="ASMMAT_rk")
# check statistic
res5 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj, vars=c("ASMMAT_rk" ) )
summary(res5)

#****************************
#*** Transformation 6: recode variable books

library(car)
# recode variable books according to "1,2=0, 3,4=1, 5=2"
dat1 &lt;- bifieobj$dat1
# use Recode function from car package
car::Recode( dat1[,"books"], "1:2='0'; c(3,4)='1';5='2'")
# define transformation formula
transform.formula &lt;- ~ I( car::Recode( books, "1:2='0'; c(3,4)='1';5='2'") )
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
               transform.formula=transform.formula,  varnames.new="book_rec" )
res6 &lt;- BIFIEsurvey::BIFIE.freq( bifieobj, vars=c("book_rec" ) )
summary(res6)

#****************************
#*** Transformation 7: include some variables aggregated to the school level

dat1 &lt;- as.data.frame(bifieobj$dat1)
# at first, create school ID in the dataset by transforming the student ID
dat1$idschool &lt;- as.numeric(substring( dat1$IDSTUD, 1, 5 ))
transform.formula &lt;- ~ I( as.numeric( substring( IDSTUD, 1, 5 ) ) )
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
               transform.formula=transform.formula, varnames.new="idschool" )

#*** test function for a single dataset bifieobj$dat1
dat1 &lt;- as.data.frame(bifieobj$dat1)
gm &lt;- miceadds::GroupMean( data=dat1$ASMMAT, group=dat1$idschool, extend=TRUE)[,2]

# add school mean ASMMAT
tformula &lt;- ~ I( miceadds::GroupMean( ASMMAT, group=idschool, extend=TRUE)[,2] )
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj, transform.formula=tformula,
                varnames.new="M_ASMMAT" )
# add within group centered mathematics values of ASMMAT
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
                transform.formula=~ 0 + I( ASMMAT - M_ASMMAT ),
                varnames.new="WC_ASMMAT" )

# add school mean books
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj,
                transform.formula=~ 0 + I( add.groupmean( books, idschool ) ),
                varnames.new="M_books" )

#****************************
#*** Transformation 8: include fitted values and residuals from a linear model
# create new BIFIEdata object
data(data.timss1)
bifieobj3 &lt;- BIFIEsurvey::BIFIE.data( data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[,-1] )

# specify transformation
transform.formula &lt;- ~ I( fitted( stats::lm( ASMMAT ~ migrant + female ) ) ) +
                             I( residuals( stats::lm( ASMMAT ~ migrant + female ) ) )
  # Note that lm omits cases in regression by listwise deletion.
# add fitted values and residual to BIFIEdata object
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj3,
                  transform.formula=transform.formula )
bifieobj$varnames[ bifieobj$varsindex.added ] &lt;- c("math_fitted1", "math_resid1")

#****************************
#*** Transformation 9: Including principal component scores in BIFIEdata object

# define auxiliary function for extracting PCA scores
BIFIE.princomp &lt;- function( formula, Ncomp ){
    X &lt;- stats::princomp( formula, cor=TRUE)
    Xp &lt;- X$scores[, 1:Ncomp ]
    return(Xp)
}
# define transformation formula
transform.formula &lt;- ~ I( BIFIE.princomp( ~ migrant + female + books + lang + ASMMAT, 3 ))
# apply transformation
bifieobj &lt;- BIFIEsurvey::BIFIE.data.transform( bifieobj3,
                transform.formula=transform.formula )
bifieobj$varnames[ bifieobj$varsindex.added ] &lt;- c("pca_sc1", "pca_sc2","pca_sc3")
# check descriptive statistics
res9 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj, vars="pca_sc1", se=FALSE)
summary(res9)
res9$output$mean1M

# The transformation formula can also be conveniently generated by string operations
vars &lt;- c("migrant", "female", "books", "lang" )
transform.formula2 &lt;- as.formula( paste0( "~ 0 + I ( BIFIE.princomp( ~ ",
       paste0( vars, collapse="+" ),  ", 3 ) )") )
  ##   &gt; transform.formula2
  ##   ~ I(BIFIE.princomp(~migrant + female + books + lang, 3))

#****************************
#*** Transformation 10: Overwriting variables books and migrant
bifieobj4 &lt;-  BIFIEsurvey::BIFIE.data.transform( bifieobj3,
                  transform.formula=~ I( 1*(books &gt;=1 ) ) + I(2*migrant),
                  varnames.new=c("books","migrant") )
summary(bifieobj4)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.derivedParameters'>
Statistical Inference for Derived Parameters
</h2><span id='topic+BIFIE.derivedParameters'></span><span id='topic+summary.BIFIE.derivedParameters'></span><span id='topic+coef.BIFIE.derivedParameters'></span><span id='topic+vcov.BIFIE.derivedParameters'></span>

<h3>Description</h3>

<p>This function performs statistical for derived parameters for objects of classes
<code><a href="#topic+BIFIE.by">BIFIE.by</a></code>,
<code><a href="#topic+BIFIE.correl">BIFIE.correl</a></code>, <code><a href="#topic+BIFIE.crosstab">BIFIE.crosstab</a></code>, <code><a href="#topic+BIFIE.freq">BIFIE.freq</a></code>,
<code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>, <code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code> and <code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.derivedParameters( BIFIE.method, derived.parameters, type=NULL)

## S3 method for class 'BIFIE.derivedParameters'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.derivedParameters'
coef(object,...)

## S3 method for class 'BIFIE.derivedParameters'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.derivedParameters_+3A_bifie.method">BIFIE.method</code></td>
<td>

<p>Object of classes <code><a href="#topic+BIFIE.by">BIFIE.by</a></code>, <code><a href="#topic+BIFIE.correl">BIFIE.correl</a></code>,
<code><a href="#topic+BIFIE.crosstab">BIFIE.crosstab</a></code>,
<code><a href="#topic+BIFIE.freq">BIFIE.freq</a></code>,  <code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>,
<code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code> or <code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>
(see <code>parnames</code> in the Output of these methods for saved parameters)
</p>
</td></tr>
<tr><td><code id="BIFIE.derivedParameters_+3A_derived.parameters">derived.parameters</code></td>
<td>
<p>List with <span class="rlang"><b>R</b></span> formulas for derived
parameters (see Examples for specification)</p>
</td></tr>
<tr><td><code id="BIFIE.derivedParameters_+3A_type">type</code></td>
<td>
<p>Only applies to <code>BIFIE.correl</code>. In case of <code>type="cov"</code>
covariances instead of correlations are used for derived parameters.</p>
</td></tr>
<tr><td><code id="BIFIE.derivedParameters_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.derivedParameters</code></p>
</td></tr>
<tr><td><code id="BIFIE.derivedParameters_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding decimals in output</p>
</td></tr>
<tr><td><code id="BIFIE.derivedParameters_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The distribution of derived parameters is derived by the direct
calculation using original resampled parameters.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with statistics</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>Estimates of derived parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Covariance matrix of derived parameters</p>
</td></tr>
<tr><td><code>parnames</code></td>
<td>
<p>Parameter names</p>
</td></tr>
<tr><td><code>res_wald</code></td>
<td>
<p>Output of Wald test (global test regarding all parameters)</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>See also <code><a href="#topic+BIFIE.waldtest">BIFIE.waldtest</a></code> for multi-parameter tests.
</p>
<p>See <code>car::deltaMethod</code> for the Delta method assuming that the multivariate
distribution of the parameters is
asymptotically normal.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#            Inference for correlations and derived parameters
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# compute correlations
res1 &lt;- BIFIEsurvey::BIFIE.correl( bdat,
            vars=c("ASSSCI", "ASMMAT", "books", "migrant" )  )
summary(res1)
res1$parnames
  ##    [1] "ASSSCI_ASSSCI"   "ASSSCI_ASMMAT"   "ASSSCI_books"    "ASSSCI_migrant"
  ##    [5] "ASMMAT_ASMMAT"   "ASMMAT_books"    "ASMMAT_migrant"  "books_books"
  ##    [9] "books_migrant"   "migrant_migrant"

# define four derived parameters
derived.parameters &lt;- list(
        # squared correlation of science and mathematics
        "R2_sci_mat"=~ I( 100* ASSSCI_ASMMAT^2  ),
        # partial correlation of science and mathematics controlling for books
        "parcorr_sci_mat"=~ I( ( ASSSCI_ASMMAT - ASSSCI_books * ASMMAT_books ) /
                            sqrt(( 1 - ASSSCI_books^2 ) * ( 1-ASMMAT_books^2 ) ) ),
        # original correlation science and mathematics (already contained in res1)
        "cor_sci_mat"=~ I(ASSSCI_ASMMAT),
        # original correlation books and migrant
        "cor_book_migra"=~ I(books_migrant)
        )

# statistical inference for derived parameters
res2 &lt;- BIFIEsurvey::BIFIE.derivedParameters( res1, derived.parameters )
summary(res2)
</code></pre>

<hr>
<h2 id='BIFIE.ecdf'>
Empirical Distribution Function and Quantiles
</h2><span id='topic+BIFIE.ecdf'></span><span id='topic+summary.BIFIE.ecdf'></span>

<h3>Description</h3>

<p>Computes an empirical distribution function (and quantiles).
If only some quantiles should
be calculated, then an appropriate vector of <code>breaks</code> (which are quantiles)
must be specified.
Statistical inference is not conducted for this method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.ecdf( BIFIEobj, vars, breaks=NULL, quanttype=1, group=NULL, group_values=NULL )

## S3 method for class 'BIFIE.ecdf'
summary(object,digits=4,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.ecdf_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed.
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_breaks">breaks</code></td>
<td>

<p>Optional vector of breaks. Otherwise, it will be automatically defined.
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_quanttype">quanttype</code></td>
<td>

<p>Type of calculation for quantiles. In case of <code>quanttype=1</code>,
a linear interpolation is used (which is <code>type='i/n'</code> in
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.quantile</a></code>),
while for <code>quanttype=2</code> no interpolation is used.
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_group">group</code></td>
<td>

<p>Optional grouping variable
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.ecdf</code></p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.ecdf_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>ecdf</code></td>
<td>
<p>Data frame with probabilities and the empirical
distribution function (See Examples).
</p>
</td></tr>
<tr><td><code>stat</code></td>
<td>
<p>Data frame with empirical distribution function stacked with
respect to variables, groups and group values</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>More extensive output</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.ecdf</a></code>,
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# ecdf
vars &lt;- c( "ASMMAT", "books")
group &lt;- "female" ; group_values &lt;- 0:1
# quantile type 1
res1 &lt;- BIFIEsurvey::BIFIE.ecdf( bifieobj,  vars=vars, group=group )
summary(res1)
res2 &lt;- BIFIEsurvey::BIFIE.ecdf( bifieobj,  vars=vars, group=group, quanttype=2)
# plot distribution function
ecdf1 &lt;- res1$ecdf
plot( ecdf1$ASMMAT_female0, ecdf1$yval, type="l")
plot( res2$ecdf$ASMMAT_female0, ecdf1$yval, type="l", lty=2)
plot( ecdf1$books_female0, ecdf1$yval, type="l", col="blue")
</code></pre>

<hr>
<h2 id='BIFIE.freq'>
Frequency Statistics
</h2><span id='topic+BIFIE.freq'></span><span id='topic+summary.BIFIE.freq'></span><span id='topic+coef.BIFIE.freq'></span><span id='topic+vcov.BIFIE.freq'></span>

<h3>Description</h3>

<p>Computes absolute and relative frequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.freq(BIFIEobj, vars, group=NULL, group_values=NULL, se=TRUE)

## S3 method for class 'BIFIE.freq'
summary(object,digits=3,...)

## S3 method for class 'BIFIE.freq'
coef(object,...)

## S3 method for class 'BIFIE.freq'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.freq_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed
</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.freq</code></p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.freq_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with frequency statistics</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+svytable">survey::svytable</a></code>,
<code><a href="intsvy.html#topic+timss.table">intsvy::timss.table</a></code>,
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# Frequencies for three variables
res1 &lt;- BIFIEsurvey::BIFIE.freq( bdat, vars=c("lang", "books", "migrant" )  )
summary(res1)

# Frequencies splitted by gender
res2 &lt;- BIFIEsurvey::BIFIE.freq( bdat, vars=c("lang", "books", "migrant" ),
              group="female", group_values=0:1 )
summary(res2)

# Frequencies splitted by gender and likesc
res3 &lt;- BIFIEsurvey::BIFIE.freq( bdat, vars=c("lang", "books", "migrant" ),
              group=c("likesc","female")  )
summary(res3)
</code></pre>

<hr>
<h2 id='BIFIE.hist'>
Histogram
</h2><span id='topic+BIFIE.hist'></span><span id='topic+summary.BIFIE.hist'></span><span id='topic+plot.BIFIE.hist'></span>

<h3>Description</h3>

<p>Computes a histogram with same output as in
<code><a href="graphics.html#topic+hist">graphics::hist</a></code>.
Statistical inference is not conducted for this method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.hist( BIFIEobj, vars, breaks=NULL, group=NULL, group_values=NULL  )

## S3 method for class 'BIFIE.hist'
summary(object,...)

## S3 method for class 'BIFIE.hist'
plot(x,ask=TRUE,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.hist_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed.
</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_breaks">breaks</code></td>
<td>

<p>Optional vector of breaks. Otherwise, it will be automatically defined.
</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.hist</code></p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_x">x</code></td>
<td>
<p>Object of class <code>BIFIE.hist</code></p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_ask">ask</code></td>
<td>
<p>Optional logical whether it should be asked for new plots.</p>
</td></tr>
<tr><td><code id="BIFIE.hist_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>histobj</code></td>
<td>
<p>List with objects of class <code>histogram</code></p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>More extensive output</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">graphics::hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# histogram
res1 &lt;- BIFIEsurvey::BIFIE.hist( bifieobj, vars="ASMMAT", group="female" )
# plot histogram for first group (female=0)
plot( res1$histobj$ASMMAT_female0, col="lightblue")
# plot both histograms after each other
plot( res1 )

# user-defined vector of breaks
res2 &lt;- BIFIEsurvey::BIFIE.hist( bifieobj, vars="ASMMAT",
              breaks=seq(0,900,10), group="female" )
plot( res2, col="orange")
</code></pre>

<hr>
<h2 id='BIFIE.lavaan.survey'>
Fitting a Model in <span class="pkg">lavaan</span> or in <span class="pkg">survey</span>
</h2><span id='topic+BIFIE.lavaan.survey'></span><span id='topic+summary.BIFIE.lavaan.survey'></span><span id='topic+coef.BIFIE.lavaan.survey'></span><span id='topic+vcov.BIFIE.lavaan.survey'></span><span id='topic+BIFIE.survey'></span><span id='topic+summary.BIFIE.survey'></span><span id='topic+coef.BIFIE.survey'></span><span id='topic+vcov.BIFIE.survey'></span>

<h3>Description</h3>

<p>The function <code>BIFIE.lavaan.survey</code> fits a structural equation model in <span class="pkg">lavaan</span>
using the <b>lavaan.survey</b> package (currently not on CRAN). Currently, only
maximum likelihood estimation for normally distributed data is available.
</p>
<p>The function <code>BIFIE.survey</code> fits a model defined in the <span class="pkg">survey</span> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.lavaan.survey(lavmodel, svyrepdes, lavaan_fun="sem",
    lavaan_survey_default=FALSE, fit.measures=NULL, ...)

## S3 method for class 'BIFIE.lavaan.survey'
summary(object, ...)

## S3 method for class 'BIFIE.lavaan.survey'
coef(object,...)

## S3 method for class 'BIFIE.lavaan.survey'
vcov(object,...)

BIFIE.survey(svyrepdes, survey.function, ...)

## S3 method for class 'BIFIE.survey'
summary(object, digits=3, ...)

## S3 method for class 'BIFIE.survey'
coef(object,...)

## S3 method for class 'BIFIE.survey'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.lavaan.survey_+3A_lavmodel">lavmodel</code></td>
<td>

<p>Model string in <span class="pkg">lavaan</span> syntax
</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_svyrepdes">svyrepdes</code></td>
<td>

<p>Replication design object of class <code>BIFIEdata</code> or replication design
object from <span class="pkg">survey</span> package (generated by <code><a href="#topic+BIFIEdata2svrepdesign">BIFIEdata2svrepdesign</a></code> or
<code><a href="survey.html#topic+svrepdesign">survey::svrepdesign</a></code>)
</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_lavaan_fun">lavaan_fun</code></td>
<td>
<p>Estimation funcion in <span class="pkg">lavaan</span>. Can be <code>"lavaan"</code>,
<code>"sem"</code>, <code>"cfa"</code> or <code>"growth"</code>.
</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_lavaan_survey_default">lavaan_survey_default</code></td>
<td>
<p>Logical indicating whether the <b>lavaan.survey</b>
package should be used for statistical inference for multiply imputed datasets.
</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.by</code></p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_fit.measures">fit.measures</code></td>
<td>
<p>Optional vector of fit measures used in
<code><a href="lavaan.html#topic+fitMeasures">lavaan::fitMeasures</a></code> function</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_survey.function">survey.function</code></td>
<td>
<p>Function from the <span class="pkg">survey</span> package</p>
</td></tr>
<tr><td><code id="BIFIE.lavaan.survey_+3A_digits">digits</code></td>
<td>
<p>Number of digits after decimal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>BIFIE.lavaan.survey</code> a list with following entries
</p>
<table role = "presentation">
<tr><td><code>lavfit</code></td>
<td>
<p>Object of class <code>lavaan</code></p>
</td></tr>
<tr><td><code>fitstat</code></td>
<td>
<p>Fit statistics from <span class="pkg">lavaan</span></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="lavaan.html#topic+lavaan">lavaan::lavaan</a></code>,
<code>lavaan.survey::lavaan.survey</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: Multiply imputed datasets, TIMSS replication design
#############################################################################

library(lavaan)
data(data.timss2)
data(data.timssrep)

#--- create BIFIEdata object
bdat4 &lt;- BIFIEsurvey::BIFIE.data( data=data.timss2, wgt="TOTWGT",
                wgtrep=data.timssrep[,-1], fayfac=1)
print(bdat4)

#--- create survey object with conversion function
svydes4 &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat4)

#*** regression model
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat4, formula=ASMMAT ~ ASSSCI )
mod2 &lt;- mitools::MIcombine( with(svydes4, survey::svyglm( formula=ASMMAT ~ ASSSCI,
                       design=svydes4 )))
#--- regression with lavaan.survey package
lavmodel &lt;- "ASMMAT ~ 1
             ASMMAT ~ ASSSCI"
mod3 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=svydes4)
# inference included in lavaan.survey package
mod4 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=svydes4,
                        lavaan_survey_default=TRUE)
summary(mod3)
# extract fit statistics
lavaan::fitMeasures(mod3$lavfit)

#--- use BIFIE.lavaan.survey function with BIFIEdata object
mod5 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=bdat4)
summary(mod5)

# compare estimated parameters
coef(mod1); coef(mod2); coef(mod3); coef(mod4); coef(mod5)

# compare standard error estimates
se(mod1); BIFIEsurvey::se(mod2); BIFIEsurvey::se(mod3); BIFIEsurvey::se(mod4); BIFIEsurvey::se(mod5)

#############################################################################
# EXAMPLE 2: Examples BIFIE.survey function
#############################################################################

data(data.timss2)
data(data.timssrep)

#--- create BIFIEdata object
bdat &lt;- BIFIEsurvey::BIFIE.data( data=data.timss2, wgt="TOTWGT",
              wgtrep=data.timssrep[,-1], fayfac=1)
print(bdat)

#--- survey object
sdat &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat)
print(sdat)

#- fit models in survey
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat, formula=ASMMAT~ASSSCI)
mod2 &lt;- BIFIEsurvey::BIFIE.survey( sdat, survey.function=survey::svyglm,
                                    formula=ASMMAT~ASSSCI)
mod3 &lt;- BIFIEsurvey::BIFIE.survey( bdat, survey.function=survey::svyglm,
                                     formula=ASMMAT~ASSSCI)
summary(mod1)
summary(mod2)
summary(mod3)

#############################################################################
# EXAMPLE 3: Nested multiply imputed datasets | linear regression
#############################################################################

library(lavaan)
data(data.timss4)
data(data.timssrep)

# nested imputed dataset
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss4,
            wgt=data.timss4[[1]][[1]]$TOTWGT, wgtrep=data.timssrep[, -1 ],  NMI=TRUE )
summary(bdat)

#*** BIFIEsurvey::BIFIE.linreg
mod1 &lt;- BIFIEsurvey::BIFIE.linreg(bdat, formula=ASMMAT ~ migrant )

#*** survey::svyglm
mod2 &lt;- BIFIEsurvey::BIFIE.survey(bdat, survey.function=survey::svyglm,
                                    formula=ASMMAT~migrant)

#*** lavaan.survey::lavaan.survey
lavmodel &lt;- "ASMMAT ~ 1
             ASMMAT ~ migrant"
mod3 &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=bdat)

coef(mod1); coef(mod2); coef(mod3)
se(mod1); BIFIEsurvey::se(mod2), BIFIEsurvey::se(mod3)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.linreg'>
Linear Regression
</h2><span id='topic+BIFIE.linreg'></span><span id='topic+summary.BIFIE.linreg'></span><span id='topic+coef.BIFIE.linreg'></span><span id='topic+vcov.BIFIE.linreg'></span>

<h3>Description</h3>

<p>Computes linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.linreg(BIFIEobj, dep=NULL, pre=NULL, formula=NULL,
    group=NULL, group_values=NULL, se=TRUE)

## S3 method for class 'BIFIE.linreg'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.linreg'
coef(object,...)

## S3 method for class 'BIFIE.linreg'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.linreg_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_dep">dep</code></td>
<td>
<p>String for the dependent variable in the regression model</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_pre">pre</code></td>
<td>

<p>Vector of predictor variables. If the intercept should be included,
then use the variable <code>one</code> for specifying it (see Examples).
</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_formula">formula</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> formula object which can be applied instead of
providing <code>dep</code> and <code>pre</code>. Note that there is
additional computation time needed for model matrix creation.</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.linreg</code></p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.linreg_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with unstandardized and standardized regression
coefficients, residual standard deviation and <code class="reqn">R^2</code></p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Alternative implementations: <code><a href="survey.html#topic+svyglm">survey::svyglm</a></code>,
<code><a href="intsvy.html#topic+timss.reg">intsvy::timss.reg</a></code>,
<code><a href="intsvy.html#topic+timss.reg.pv">intsvy::timss.reg.pv</a></code>,
<code><a href="stats.html#topic+lm">stats::lm</a></code>
</p>
<p>See <code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code> for logistic regression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
             wgtrep=data.timssrep[, -1 ] )

#**** Model 1: Linear regression for mathematics score
mod1 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, dep="ASMMAT", pre=c("one","books","migrant"),
              group="female" )
summary(mod1)

## Not run: 
# same model but specified with R formulas
mod1a &lt;- BIFIEsurvey::BIFIE.linreg( bdat, formula=ASMMAT ~ books + migrant,
               group="female", group_values=0:1 )
summary(mod1a)

# compare result with lm function and first imputed dataset
dat1 &lt;- data.timss1[[1]]
mod1b &lt;- stats::lm( ASMMAT ~ 0 + as.factor(female) + as.factor(female):books +
                              as.factor(female):migrant,
                         data=dat1,  weights=dat1$TOTWGT )
summary(mod1b)

#**** Model 2: Like Model 1, but books is now treated as a factor
mod2 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, formula=ASMMAT ~ as.factor(books) + migrant)
summary(mod2)

#############################################################################
# EXAMPLE 2: PISA data | Nonlinear regression models
#############################################################################

data(data.pisaNLD)
data &lt;- data.pisaNLD

#--- Create BIFIEdata object immediately using BIFIE.data.jack function
bdat &lt;- BIFIEsurvey::BIFIE.data.jack( data.pisaNLD, jktype="RW_PISA", cdata=TRUE)
summary(bdat)

#****************************************************
#*** Model 1: linear regression
mod1 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, formula=MATH ~ HISEI )
summary(mod1)

#****************************************************
#*** Model 2: Cubic regression
mod2 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, formula=MATH ~ HISEI + I(HISEI^2) + I(HISEI^3) )
summary(mod2)

#****************************************************
#*** Model 3: B-spline regression

# test with design of HISEI values
dfr &lt;- data.frame("HISEI"=16:90 )
des &lt;- stats::model.frame( ~ splines::bs( HISEI, df=5 ), dfr )
des &lt;- des$splines
plot( dfr$HISEI, des[,1], type="l", pch=1, lwd=2, ylim=c(0,1) )
for (vv in 2:ncol(des) ){
    lines( dfr$HISEI, des[,vv], lty=vv, col=vv, lwd=2)
}

# apply B-spline regression in BIFIEsurvey::BIFIE.linreg
mod3 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, formula=MATH ~ splines::bs(HISEI,df=5) )
summary(mod3)

#*** include transformed HISEI values for B-spline matrix in bdat
bdat2 &lt;- BIFIEsurvey::BIFIE.data.transform( bdat, ~ 0 + splines::bs( HISEI, df=5 ))
bdat2$varnames[ bdat2$varsindex.added ] &lt;- paste0("HISEI_bsdes",
            seq( 1, length( bdat2$varsindex.added ) ) )

#****************************************************
#*** Model 4: Nonparametric regression using BIFIE.by

?BIFIE.by

#---- (1) test function with one dataset
dat1 &lt;- bdat$dat1
vars &lt;- c("MATH", "HISEI")
X &lt;- dat1[,vars]
w &lt;- bdat$wgt
X &lt;- as.data.frame(X)
# estimate model
mod &lt;- stats::loess( MATH ~ HISEI, weights=w, data=X )

# predict HISEI values
hisei_val &lt;- data.frame( "HISEI"=seq(16,90) )
y_pred &lt;- stats::predict( mod, hisei_val )
graphics::plot( hisei_val$HISEI, y_pred, type="l")

#--- (2) define loess function
loess_fct &lt;- function(X,w){
    X1 &lt;- data.frame( X, w )
    colnames(X1) &lt;- c( vars, "wgt")
    X1 &lt;- stats::na.omit(X1)
#    mod &lt;- stats::lm( MATH ~ HISEI, weights=X1$wgt, data=X1 )
    mod &lt;- stats::loess( MATH ~ HISEI, weights=X1$wgt, data=X1 )
    y_pred &lt;- stats::predict( mod, hisei_val )
    return(y_pred)
}

#--- (3) estimate model
mod4 &lt;-  BIFIEsurvey::BIFIE.by( bdat, vars, userfct=loess_fct )
summary(mod4)

# plot linear function pointwise and confidence intervals
graphics::plot( hisei_val$HISEI, mod4$stat$est, type="l", lwd=2,
        xlab="HISEI", ylab="PVMATH", ylim=c(430,670) )
graphics::lines( hisei_val$HISEI, mod4$stat$est - 1.96* mod4$stat$SE, lty=3 )
graphics::lines( hisei_val$HISEI, mod4$stat$est + 1.96* mod4$stat$SE, lty=3 )

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.logistreg'>
Logistic Regression
</h2><span id='topic+BIFIE.logistreg'></span><span id='topic+summary.BIFIE.logistreg'></span><span id='topic+coef.BIFIE.logistreg'></span><span id='topic+vcov.BIFIE.logistreg'></span>

<h3>Description</h3>

<p>Computes logistic regression. Explained variance <code class="reqn">R^2</code> is computed
by the approach of McKelvey and Zavoina.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.logistreg(BIFIEobj, dep=NULL, pre=NULL, formula=NULL,
    group=NULL, group_values=NULL, se=TRUE, eps=1E-8, maxiter=100)

## S3 method for class 'BIFIE.logistreg'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.logistreg'
coef(object,...)

## S3 method for class 'BIFIE.logistreg'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.logistreg_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_dep">dep</code></td>
<td>
<p>String for the dependent variable in the regression model</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_pre">pre</code></td>
<td>

<p>Vector of predictor variables. If the intercept should be included,
then use the variable <code>one</code> for specifying it (see Examples).
</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_formula">formula</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> formula object which can be applied instead of
providing <code>dep</code> and <code>pre</code>. Note that there is
additional computation time needed for model matrix creation.</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_eps">eps</code></td>
<td>
<p>Convergence criterion for parameters</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.logistreg</code></p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.logistreg_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with regression coefficients</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+svyglm">survey::svyglm</a></code>,
<code><a href="stats.html#topic+glm">stats::glm</a></code>
</p>
<p>For linear regressions see <code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: TIMSS dataset | Logistic regression
#############################################################################

data(data.timss2)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss2, wgt=data.timss2[[1]]$TOTWGT,
                      wgtrep=data.timssrep[, -1 ] )

#**** Model 1: Logistic regression - prediction of migrational background
res1 &lt;- BIFIEsurvey::BIFIE.logistreg( BIFIEobj=bdat, dep="migrant",
           pre=c("one","books","lang"), group="female", se=FALSE )
summary(res1)

## Not run: 
# same model, but with formula specification and standard errors
res1a &lt;- BIFIEsurvey::BIFIE.logistreg( BIFIEobj=bdat,
              formula=migrant ~ books + lang, group="female"  )
summary(res1a)

#############################################################################
# SIMULATED EXAMPLE 2: Comparison of stats::glm and BIFIEsurvey::BIFIE.logistreg
#############################################################################

#*** (1) simulate data
set.seed(987)
N &lt;- 300
x1 &lt;- stats::rnorm(N)
x2 &lt;- stats::runif(N)
ypred &lt;- -0.75+.2*x1 + 3*x2
y &lt;- 1*( stats::plogis(ypred) &gt; stats::runif(N) )
data &lt;- data.frame( "y"=y, "x1"=x1, "x2"=x2 )

#*** (2) estimation logistic regression using glm
mod1 &lt;- stats::glm( y ~ x1 + x2, family="binomial")

#*** (3) estimation logistic regression using BIFIEdata
# create BIFIEdata object by defining 30 Jackknife zones
bifiedata &lt;- BIFIEsurvey::BIFIE.data.jack( data, jktype="JK_RANDOM", ngr=30 )
summary(bifiedata)
# estimate logistic regression
mod2 &lt;- BIFIEsurvey::BIFIE.logistreg( bifiedata, formula=y ~ x1+x2 )

#*** (4) compare results
summary(mod2)    # BIFIE.logistreg
summary(mod1)   # glm

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.mva'>
Missing Value Analysis
</h2><span id='topic+BIFIE.mva'></span><span id='topic+summary.BIFIE.mva'></span>

<h3>Description</h3>

<p>Conducts a missing value analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.mva( BIFIEobj, missvars, covariates=NULL, se=TRUE )

## S3 method for class 'BIFIE.mva'
summary(object,digits=4,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.mva_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_missvars">missvars</code></td>
<td>

<p>Vector of variables for which missing value statistics should be computed
</p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_covariates">covariates</code></td>
<td>
<p>Vector of variables which work as covariates</p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.correl</code></p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.mva_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat.mva</code></td>
<td>
<p>Data frame with missing value statistics</p>
</td></tr>
<tr><td><code>res_list</code></td>
<td>
<p>List with extensive output split
according to each variable in <code>missvars</code></p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
BIFIEdata &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1,
                wgt=data.timss1[[1]]$TOTWGT, wgtrep=data.timssrep[, -1 ] )

# missing value analysis for "scsci" and "books" and three covariates
res1 &lt;- BIFIEsurvey::BIFIE.mva( BIFIEdata, missvars=c("scsci", "books" ),
             covariates=c("ASMMAT", "female", "ASSSCI") )
summary(res1)

# missing value analysis without statistical inference and without covariates
res2 &lt;- BIFIEsurvey::BIFIE.mva( BIFIEdata, missvars=c("scsci", "books"), se=FALSE)
summary(res2)
</code></pre>

<hr>
<h2 id='BIFIE.pathmodel'>
Path Model Estimation
</h2><span id='topic+BIFIE.pathmodel'></span><span id='topic+summary.BIFIE.pathmodel'></span><span id='topic+coef.BIFIE.pathmodel'></span><span id='topic+vcov.BIFIE.pathmodel'></span>

<h3>Description</h3>

<p>This function computes a path model. Predictors are allowed to possess
measurement errors.
Known measurement error variances (and covariances) or reliabilities
can be specified by the user. Alternatively, a set of indicators can be
defined for each latent variable, and for each imputed and replicated
dataset the measurement error variance is determined by means
of calculating the reliability Cronbachs alpha. Measurement errors
are handled by adjusting covariance matrices (see Buonaccorsi, 2010, Ch. 5).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.pathmodel( BIFIEobj, lavaan.model, reliability=NULL, group=NULL,
        group_values=NULL, se=TRUE )

## S3 method for class 'BIFIE.pathmodel'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.pathmodel'
coef(object,...)

## S3 method for class 'BIFIE.pathmodel'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.pathmodel_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_lavaan.model">lavaan.model</code></td>
<td>
<p>String including the model specification in
<span class="pkg">lavaan</span> syntax. <code>lavaan.model</code> also allows the
extended functionality in the
<code><a href="TAM.html#topic+lavaanify.IRT">TAM::lavaanify.IRT</a></code> function.
</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_reliability">reliability</code></td>
<td>

<p>Optional vector containing the reliabilities of each variable.
This vector can also include only a subset of all variables.
</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.pathmodel</code></p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.pathmodel_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following conventions are used as parameter labels in the output.
</p>
<p><code>Y~X</code> is the regression coefficient of the regression from <code class="reqn">Y</code>
on <code class="reqn">X</code>.
</p>
<p><code>X-&gt;Z-&gt;Y</code> denotes the path coefficient from <code class="reqn">X</code> to <code class="reqn">Y</code>
passing the mediating variable <code class="reqn">Z</code>.
</p>
<p><code>X-+&gt;Y</code> denotes the total effect (of all paths) from <code class="reqn">X</code> to <code class="reqn">Y</code>.
</p>
<p><code>X-~&gt;Y</code> denotes the sum of all indirect effects from <code class="reqn">X</code> to <code class="reqn">Y</code>.
</p>
<p>The parameter suffix <code>_stand</code> refers to parameters for which
all variables are standardized.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with unstandardized and standardized regression
coefficients, path coefficients, total and indirect effects,
residual variances, and <code class="reqn">R^2</code></p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Buonaccorsi, J. P. (2010).
<em>Measurement error: Models, methods, and applications</em>. CRC Press.
</p>


<h3>See Also</h3>

<p>See the <span class="pkg">lavaan</span> and <b>lavaan.survey</b> package.
</p>
<p>For the <code>lavaan</code> syntax, see
<code><a href="lavaan.html#topic+lavaanify">lavaan::lavaanify</a></code> and
<code><a href="TAM.html#topic+lavaanify.IRT">TAM::lavaanify.IRT</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: Path model data.bifie01
#############################################################################

data(data.bifie01)
dat &lt;- data.bifie01
# create dataset with replicate weights and plausible values
bifieobj &lt;- BIFIEsurvey::BIFIE.data.jack( data=dat,  jktype="JK_TIMSS",
                jkzone="JKCZONE", jkrep="JKCREP", wgt="TOTWGT",
                pv_vars=c("ASMMAT","ASSSCI") )

#**************************************************************
#*** Model 1: Path model
lavmodel1 &lt;- "
     ASMMAT ~ ASBG07A + ASBG07B  + ASBM03 + ASBM02A + ASBM02E
     # define latent variable with 2nd and 3rd item in reversed scoring
     ASBM03=~ 1*ASBM03A + (-1)*ASBM03B + (-1)*ASBM03C + 1*ASBM03D
     ASBG07A ~ ASBM02E
     ASBG07A ~~ .2*ASBG07A    # measurement error variance of .20
     ASBM02E ~~ .45*ASBM02E     # measurement error variance of .45
     ASBM02E ~ ASBM02A + ASBM02B
        "
#--- Model 1a: model calculated by gender
mod1a &lt;- BIFIEsurvey::BIFIE.pathmodel( bifieobj, lavmodel1, group="female" )
summary(mod1a)

#--- Model 1b: Input of some known reliabilities
reliability &lt;- c( "ASBM02B"=.6, "ASBM02A"=.8 )
mod1b &lt;- BIFIEsurvey::BIFIE.pathmodel( bifieobj, lavmodel1, reliability=reliability)
summary(mod1b)

#**************************************************************
#*** Model 2: Linear regression with errors in predictors

# specify lavaan model
lavmodel2 &lt;- "
     ASMMAT ~ ASBG07A + ASBG07B + ASBM03A
     ASBG07A ~~ .2*ASBG07A
        "
mod2 &lt;- BIFIEsurvey::BIFIE.pathmodel( bifieobj, lavmodel2  )
summary(mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.twolevelreg'>
Two Level Regression
</h2><span id='topic+BIFIE.twolevelreg'></span><span id='topic+summary.BIFIE.twolevelreg'></span><span id='topic+coef.BIFIE.twolevelreg'></span><span id='topic+vcov.BIFIE.twolevelreg'></span>

<h3>Description</h3>

<p>This function computes the hierarchical two level model with
random intercepts and random slopes. The full maximum
likelihood estimation is conducted by means of an
EM algorithm (Raudenbush &amp; Bryk, 2002).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.twolevelreg( BIFIEobj, dep, formula.fixed, formula.random, idcluster,
   wgtlevel2=NULL, wgtlevel1=NULL, group=NULL, group_values=NULL,
   recov_constraint=NULL, se=TRUE, globconv=1E-6, maxiter=1000 )

## S3 method for class 'BIFIE.twolevelreg'
summary(object,digits=4,...)

## S3 method for class 'BIFIE.twolevelreg'
coef(object,...)

## S3 method for class 'BIFIE.twolevelreg'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.twolevelreg_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_dep">dep</code></td>
<td>
<p>String for the dependent variable in the regression model</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_formula.fixed">formula.fixed</code></td>
<td>

<p>An <span class="rlang"><b>R</b></span> formula for fixed effects
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_formula.random">formula.random</code></td>
<td>
<p>An <span class="rlang"><b>R</b></span> formula for random effects</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_idcluster">idcluster</code></td>
<td>
<p>Cluster identifier. The cluster identifiers must be
sorted in the <code>BIFIE.data</code> object.</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_wgtlevel2">wgtlevel2</code></td>
<td>
<p>Name of Level 2 weight variable</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_wgtlevel1">wgtlevel1</code></td>
<td>
<p>Name of Level 1 weight variable. This is optional.
If it is not provided, <code>wgtlevel</code> is calculated from
the total weight and <code>wgtlevel2</code>.</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_group">group</code></td>
<td>

<p>Optional grouping variable
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_recov_constraint">recov_constraint</code></td>
<td>
<p>Matrix for constraints of random effects covariance
matrix. The random effects are numbered according to the order in
the specification in <code>formula.random</code>. The first column in
<code>recov_constraint</code> contains the row index in the
covariance matrix, the second column the column index and the third column
the value to be fixed.
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed. In case of <code>se=FALSE</code>,
standard errors are computed as maximum likelihood estimates under
the assumption of random sampling of level 2 clusters.
</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_globconv">globconv</code></td>
<td>
<p>Convergence criterion for maximum parameter change</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_maxiter">maxiter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.twolevelreg</code></p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.twolevelreg_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The implemented random slope model can be written as
</p>
<p style="text-align: center;"><code class="reqn">y_{ij}=\bold{X}_{ij} \bold{\gamma}  +  \bold{Z}_{ij} \bold{u}_j +
\varepsilon_{ij}</code>
</p>

<p>where <code class="reqn">y_{ij}</code> is the dependent variable, <code class="reqn">\bold{X}_{ij}</code>
includes the fixed effects predictors (specified by <code>formula.fixed</code>)
and <code class="reqn">\bold{Z}_{ij}</code> includes the random effects predictors
(specified by <code>formula.random</code>). The random effects <code class="reqn">\bold{u}_j</code>
follow a multivariate normal distribution.
</p>
<p>The function also computes a variance decomposition of explained
variance due to fixed and random effects for the within and the
between level. This variance decomposition is conducted for the predictor
matrices <code class="reqn">\bold{X}</code> and <code class="reqn">\bold{Z}</code>. It is assumed that
<code class="reqn"> \bold{X}_{ij}=\bold{X}_j^B + \bold{X}_{ij}^W</code>.
The different sources of variance are computed by formulas as
proposed in Snijders and Bosker (2012, Ch. 7).
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with coefficients and different sources
of variance.</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Raudenbush, S. W., &amp; Bryk, A. S. (2002).
<em>Hierarchical linear models: Applications and data analysis methods</em>.
Thousand Oaks: Sage.
</p>
<p>Snijders, T. A. B., &amp; Bosker, R. J. (2012).
<em>Multilevel analysis: An introduction to basic and advanced multilevel
modeling</em>. Thousand Oaks: Sage.
</p>


<h3>See Also</h3>

<p>The <code>lme4::lmer</code> function in the <span class="pkg">lme4</span> package allows only
weights at the first level.
</p>
<p>See the <span class="pkg">WeMix</span> package (and the function <code>WeMix::mix</code>) for estimation of
mixed effects models with weights at different levels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(lme4)

#############################################################################
# EXAMPLE 1: Dataset data.bifie01 | TIMSS 2011
#############################################################################

data(data.bifie01)
dat &lt;- data.bifie01
set.seed(987)

# create dataset with replicate weights and plausible values
bdat1 &lt;- BIFIEsurvey::BIFIE.data.jack( data=dat, jktype="JK_TIMSS", jkzone="JKCZONE",
            jkrep="JKCREP", wgt="TOTWGT", pv_vars=c("ASMMAT","ASSSCI") )

# create dataset without plausible values and ignoring weights
bdat2 &lt;- BIFIEsurvey::BIFIE.data.jack( data=dat, jktype="JK_RANDOM", ngr=10 )
#=&gt; standard errors from ML estimation

#***********************************************
# Model 1: Random intercept model

#--- Model 1a: without weights, first plausible value
mod1a &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat2, dep="ASMMAT01",
                formula.fixed=~ 1, formula.random=~ 1, idcluster="idschool",
                wgtlevel2="one", se=FALSE )
summary(mod1a)

#--- Model 1b: estimation in lme4
mod1b &lt;- lme4::lmer( ASMMAT01 ~ 1 + ( 1 | idschool), data=dat, REML=FALSE)
summary(mod1b)

#--- Model 1c: Like Model 1a but for five plausible values and ML inference
mod1c &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat1, dep="ASMMAT",
                formula.fixed=~ 1, formula.random=~ 1, idcluster="idschool",
                wgtlevel2="one",  se=FALSE )
summary(mod1c)

#--- Model 1d: weights and sampling design and all plausible values
mod1d &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat1, dep="ASMMAT",
                formula.fixed=~ 1, formula.random=~ 1, idcluster="idschool",
                wgtlevel2="SCHWGT" )
summary(mod1d)

#***********************************************
# Model 2: Random slope model

#--- Model 2a: without weights
mod2a &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat2, dep="ASMMAT01",
                formula.fixed=~  female +  ASBG06A, formula.random=~ ASBG06A,
                idcluster="idschool", wgtlevel2="one",  se=FALSE )
summary(mod2a)

#--- Model 2b: estimation in lme4
mod2b &lt;- lme4::lmer( ASMMAT01 ~ female +  ASBG06A + ( 1 + ASBG06A | idschool),
                   data=dat, REML=FALSE)
summary(mod2b)

#--- Model 2c: weights and sampling design and all plausible values
mod2c &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat1, dep="ASMMAT",
                formula.fixed=~  female +  ASBG06A, formula.random=~ ASBG06A,
                idcluster="idschool", wgtlevel2="SCHWGT", maxiter=500, se=FALSE)
summary(mod2c)

#--- Model 2d: Uncorrelated intecepts and slopes

# constraint for zero covariance between intercept and slope
recov_constraint &lt;- matrix( c(1,2,0), ncol=3 )
mod2d &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat2, dep="ASMMAT01",
                formula.fixed=~ female +  ASBG06A, formula.random=~ ASBG06A,
                idcluster="idschool", wgtlevel2="one",  se=FALSE,
                recov_constraint=recov_constraint )
summary(mod2d)

#--- Model 2e: Fixed entries in the random effects covariance matrix

# two constraints for random effects covariance
# Cov(Int, Slo)=0  # zero slope for intercept and slope
# Var(Slo)=10      # slope variance of 10
recov_constraint &lt;- matrix( c(1,2,0,
                      2,2,10), ncol=3, byrow=TRUE)
mod2e &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat2, dep="ASMMAT01",
                formula.fixed=~  female +  ASBG06A, formula.random=~ ASBG06A,
                idcluster="idschool", wgtlevel2="one",  se=FALSE,
                recov_constraint=recov_constraint )
summary(mod2e)

#############################################################################
# SIMULATED EXAMPLE 2: Two-level regression with random slopes
#############################################################################

#--- (1) simulate data
set.seed(9876)
NC &lt;- 100    # number of clusters
Nj &lt;- 20     # number of persons per cluster
iccx &lt;- .4   # intra-class correlation predictor
theta &lt;- c( 0.7, .3 )    # fixed effects
Tmat &lt;- diag( c(.3, .1 ) ) # variances of random intercept and slope
sig2 &lt;- .60    # residual variance
N &lt;- NC*Nj
idcluster &lt;- rep( 1:NC, each=Nj )
dat1 &lt;- data.frame("idcluster"=idcluster )
dat1$X &lt;- rep( stats::rnorm( NC, sd=sqrt(iccx) ), each=Nj ) +
                 stats::rnorm( N, sd=sqrt( 1 - iccx) )
dat1$Y &lt;- theta[1] + rep( stats::rnorm(NC, sd=sqrt(Tmat[1,1] ) ), each=Nj ) +
      theta[2] + rep( stats::rnorm(NC, sd=sqrt(Tmat[2,2])), each=Nj )) * dat1$X +
      stats::rnorm(N, sd=sqrt(sig2) )

#--- (2) create design object
bdat1 &lt;- BIFIEsurvey::BIFIE.data.jack( data=dat1, jktype="JK_GROUP", jkzone="idcluster")
summary(bdat1)

#*** Model 1: Random slope model (ML standard errors)

#- estimation using BIFIE.twolevelreg
mod1a &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat1, dep="Y",
                formula.fixed=~ 1+X, formula.random=~ 1+X, idcluster="idcluster",
                wgtlevel2="one",  se=FALSE )
summary(mod1a)

#- estimation in lme4
mod1b &lt;- lme4::lmer( Y ~ X + ( 1+X | idcluster), data=dat1, REML=FALSE  )
summary(mod1b)

#- using Jackknife for inference
mod1c &lt;- BIFIEsurvey::BIFIE.twolevelreg( BIFIEobj=bdat1, dep="Y",
                formula.fixed=~ 1+X, formula.random=~ 1+X, idcluster="idcluster",
                wgtlevel2="one",  se=TRUE )
summary(mod1c)

# extract coefficients
coef(mod1a)
coef(mod1c)
# covariance matrix
vcov(mod1a)
vcov(mod1c)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.univar'>
Univariate Descriptive Statistics (Means and Standard Deviations)
</h2><span id='topic+BIFIE.univar'></span><span id='topic+summary.BIFIE.univar'></span><span id='topic+coef.BIFIE.univar'></span><span id='topic+vcov.BIFIE.univar'></span>

<h3>Description</h3>

<p>Computes some univariate descriptive statistics
(means and standard deviations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.univar(BIFIEobj, vars, group=NULL, group_values=NULL, se=TRUE)

## S3 method for class 'BIFIE.univar'
summary(object,digits=3,...)

## S3 method for class 'BIFIE.univar'
coef(object,...)

## S3 method for class 'BIFIE.univar'
vcov(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.univar_+3A_bifieobj">BIFIEobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_vars">vars</code></td>
<td>

<p>Vector of variables for which statistics should be computed
</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_group">group</code></td>
<td>

<p>Optional grouping variable(s)
</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_group_values">group_values</code></td>
<td>

<p>Optional vector of grouping values. This can be omitted and grouping
values will be determined automatically.
</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_se">se</code></td>
<td>
<p>Optional logical indicating whether statistical inference
based on replication should be employed.</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.univar</code></p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.univar_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat</code></td>
<td>
<p>Data frame with univariate statistics</p>
</td></tr>
<tr><td><code>stat_M</code></td>
<td>
<p>Data frame with means</p>
</td></tr>
<tr><td><code>stat_SD</code></td>
<td>
<p>Data frame with standard deviations</p>
</td></tr>
<tr><td><code>output</code></td>
<td>
<p>Extensive output with all replicated statistics</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>See <code><a href="#topic+BIFIE.univar.test">BIFIE.univar.test</a></code> for a test of equal means and
effect sizes <code class="reqn">\eta</code> and <code class="reqn">d</code>.
</p>
<p>Descriptive statistics without statistical inference can be
estimated by the collection of
<code><a href="miceadds.html#topic+ma.wtd.statNA">miceadds::ma.wtd.statNA</a></code>
functions from the <span class="pkg">miceadds</span> package.
</p>
<p>Further descriptive functions:
</p>
<p><code><a href="survey.html#topic+svymean">survey::svymean</a></code>,
<code><a href="intsvy.html#topic+timss.mean">intsvy::timss.mean</a></code>,
<code><a href="intsvy.html#topic+timss.mean.pv">intsvy::timss.mean.pv</a></code>,
<code><a href="stats.html#topic+weighted.mean">stats::weighted.mean</a></code>,
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.mean</a></code>,
<code><a href="miceadds.html#topic+ma.wtd.statNA">miceadds::ma.wtd.meanNA</a></code>
</p>
<p><code><a href="survey.html#topic+svyvar">survey::svyvar</a></code>,
<code><a href="Hmisc.html#topic+wtd.stats">Hmisc::wtd.var</a></code>,
<code><a href="miceadds.html#topic+ma.wtd.statNA">miceadds::ma.wtd.sdNA</a></code>,
<code><a href="miceadds.html#topic+ma.wtd.statNA">miceadds::ma.wtd.covNA</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

# compute descriptives for plausible values
res1 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT","ASSSCI","books") )
summary(res1)

# split descriptives by number of books
res2 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT","ASSSCI"), group="books",
            group_values=1:5)
summary(res2)

#############################################################################
# EXAMPLE 2: TIMSS dataset with missings
#############################################################################

data(data.timss2)
data(data.timssrep)

# use first dataset with missing data from data.timss2
bdat1 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss2[[1]], wgt=data.timss2[[1]]$TOTWGT,
               wgtrep=data.timssrep[, -1 ])

# some descriptive statistics without statistical inference
res1a &lt;- BIFIEsurvey::BIFIE.univar( bdat1, vars=c("ASMMAT","ASSSCI","books"), se=FALSE)
# descriptive statistics with statistical inference
res1b &lt;- BIFIEsurvey::BIFIE.univar( bdat1, vars=c("ASMMAT","ASSSCI","books") )
summary(res1a)
summary(res1b)

# split descriptives by number of books
res2 &lt;- BIFIEsurvey::BIFIE.univar( bdat1, vars=c("ASMMAT","ASSSCI"), group="books")
# Note that if group_values is not specified as an argument it will be
# automatically determined by the observed frequencies in the dataset
summary(res2)
</code></pre>

<hr>
<h2 id='BIFIE.univar.test'>
Analysis of Variance and Effect Sizes for Univariate Statistics
</h2><span id='topic+BIFIE.univar.test'></span><span id='topic+summary.BIFIE.univar.test'></span>

<h3>Description</h3>

<p>Computes a Wald test which tests equality of means (univariate
analysis of variance). In addition, the <code class="reqn">d</code> and <code class="reqn">\eta</code>
effect sizes are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.univar.test(BIFIE.method, wald_test=TRUE)

## S3 method for class 'BIFIE.univar.test'
summary(object,digits=4,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.univar.test_+3A_bifie.method">BIFIE.method</code></td>
<td>

<p>Object of class <code>BIFIE.univar</code>
</p>
</td></tr>
<tr><td><code id="BIFIE.univar.test_+3A_wald_test">wald_test</code></td>
<td>
<p>Optional logical indicating whether a Wald test should
be performed.</p>
</td></tr>
<tr><td><code id="BIFIE.univar.test_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.univar.test</code></p>
</td></tr>
<tr><td><code id="BIFIE.univar.test_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.univar.test_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat.F</code></td>
<td>
<p>Data frame with <code class="reqn">F</code> statistic for Wald test</p>
</td></tr>
<tr><td><code>stat.eta</code></td>
<td>
<p>Data frame with <code class="reqn">\eta</code> effect size and its inference</p>
</td></tr>
<tr><td><code>stat.dstat</code></td>
<td>
<p>Data frame with Cohen's <code class="reqn">d</code> effect size and its inference</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset - One grouping variable
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

#**** Model 1: 3 variables splitted by book
res1 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT", "ASSSCI","scsci"),
                    group="books")
summary(res1)
# analysis of variance
tres1 &lt;- BIFIEsurvey::BIFIE.univar.test(res1)
summary(tres1)

#**** Model 2: One variable splitted by gender
res2 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT"), group="female" )
summary(res2)
# analysis of variance
tres2 &lt;- BIFIEsurvey::BIFIE.univar.test(res2)
summary(tres2)

## Not run: 
#**** Model 3: Univariate statistic: math
res3 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT") )
summary(res3)
tres3 &lt;- BIFIEsurvey::BIFIE.univar.test(res3)

#############################################################################
# EXAMPLE 2: Imputed TIMSS dataset - Two grouping variables
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
                  wgtrep=data.timssrep[, -1 ] )

#**** Model 1: 3 variables splitted by book and female
res1 &lt;- BIFIEsurvey::BIFIE.univar(bdat, vars=c("ASMMAT", "ASSSCI","scsci"),
                  group=c("books","female"))
summary(res1)

# analysis of variance
tres1 &lt;- BIFIEsurvey::BIFIE.univar.test(res1)
summary(tres1)

# extract data frame with Cohens d statistic
dstat &lt;- tres1$stat.dstat

# extract d values for gender comparisons with same value of books
# -&gt; 'books' refers to the first variable
ind &lt;- which(
  unlist( lapply( strsplit( dstat$groupval1, "#"), FUN=function(vv){vv[1]}) )==
  unlist( lapply( strsplit( dstat$groupval2, "#"), FUN=function(vv){vv[1]}) )
        )
dstat[ ind, ]

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIE.waldtest'>
Wald Tests for BIFIE Methods
</h2><span id='topic+BIFIE.waldtest'></span><span id='topic+summary.BIFIE.waldtest'></span>

<h3>Description</h3>

<p>This function performs a Wald test for objects of classes
<code><a href="#topic+BIFIE.by">BIFIE.by</a></code>,
<code><a href="#topic+BIFIE.correl">BIFIE.correl</a></code>, <code><a href="#topic+BIFIE.crosstab">BIFIE.crosstab</a></code>, <code><a href="#topic+BIFIE.freq">BIFIE.freq</a></code>,
<code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>, <code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code> and <code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIE.waldtest(BIFIE.method, Cdes, rdes, type=NULL)

## S3 method for class 'BIFIE.waldtest'
summary(object,digits=4,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIE.waldtest_+3A_bifie.method">BIFIE.method</code></td>
<td>

<p>Object of classes <code><a href="#topic+BIFIE.by">BIFIE.by</a></code>,
<code><a href="#topic+BIFIE.correl">BIFIE.correl</a></code>, <code><a href="#topic+BIFIE.crosstab">BIFIE.crosstab</a></code>,
<code><a href="#topic+BIFIE.freq">BIFIE.freq</a></code>,  <code><a href="#topic+BIFIE.linreg">BIFIE.linreg</a></code>,
<code><a href="#topic+BIFIE.logistreg">BIFIE.logistreg</a></code> or <code><a href="#topic+BIFIE.univar">BIFIE.univar</a></code>
(see <code>parnames</code> in the Output of these methods for saved parameters)
</p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_cdes">Cdes</code></td>
<td>
<p>Design matrix <code class="reqn">C</code> (see Details)</p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_rdes">rdes</code></td>
<td>
<p>Design vector <code class="reqn">r</code> (see Details)</p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_type">type</code></td>
<td>
<p>Only applies to <code>BIFIE.correl</code>. In case of <code>type="cov"</code>
covariances instead of correlations are used for parameter tests.</p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_object">object</code></td>
<td>
<p>Object of class <code>BIFIE.waldtest</code></p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_digits">digits</code></td>
<td>
<p>Number of digits for rounding output</p>
</td></tr>
<tr><td><code id="BIFIE.waldtest_+3A_...">...</code></td>
<td>
<p>Further arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Wald test is conducted for a parameter vector <code class="reqn">\bold{\theta}</code>,
specifying the hypothesis <code class="reqn">C \bold{\theta}=r</code>. Statistical inference
is performed by using the <code class="reqn">D_1</code> and the <code class="reqn">D_2</code> statistic
(Enders, 2010, Ch. 8).
</p>
<p>For objects of class <code>bifie.univar</code>, only hypotheses with respect
to means are implemented.
</p>


<h3>Value</h3>

<p>A list with following entries
</p>
<table role = "presentation">
<tr><td><code>stat.D</code></td>
<td>
<p>Data frame with <code class="reqn">D_1</code> and <code class="reqn">D_2</code> statistic, degrees of freedom
and p value</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p>More values</p>
</td></tr>
</table>


<h3>References</h3>

<p>Enders, C. K. (2010). <em>Applied missing data analysis</em>. Guilford Press.
</p>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+regTermTest">survey::regTermTest</a></code>,
<code><a href="survey.html#topic+anova.svyglm">survey::anova.svyglm</a></code>,
<code>car::linearHypothesis</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Imputed TIMSS dataset
#############################################################################

data(data.timss1)
data(data.timssrep)

# create BIFIE.dat object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
           wgtrep=data.timssrep[, -1 ] )

#******************
#*** Model 1: Linear regression
res1 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, dep="ASMMAT", pre=c("one","books","migrant"),
         group="female" )
summary(res1)

#*** Wald test which tests whether sigma and R^2 values are the same
res1$parnames    # parameter names
pn &lt;- res1$parnames ; PN &lt;- length(pn)
Cdes &lt;- matrix(0,nrow=2, ncol=PN)
colnames(Cdes) &lt;- pn
# equality of R^2  ( R^2(female0) - R^2(female1)=0 )
Cdes[ 1, c("R^2_NA_female_0", "R^2_NA_female_1" ) ] &lt;- c(1,-1)
# equality of sigma ( sigma(female0) - sigma(female1)=0)
Cdes[ 2, c("sigma_NA_female_0", "sigma_NA_female_1" ) ] &lt;- c(1,-1)
# design vector
rdes &lt;- rep(0,2)
# perform Wald test
wmod1 &lt;- BIFIEsurvey::BIFIE.waldtest( BIFIE.method=res1, Cdes=Cdes, rdes=rdes )
summary(wmod1)

## Not run: 
#******************
#*** Model 2: Correlations

# compute some correlations
res2a &lt;- BIFIEsurvey::BIFIE.correl( bdat, vars=c("ASMMAT","ASSSCI","migrant","books"))
summary(res2a)

# test whether r(MAT,migr)=r(SCI,migr) and r(MAT,books)=r(SCI,books)
pn &lt;- res2a$parnames; PN &lt;- length(pn)
Cdes &lt;- matrix( 0, nrow=2, ncol=PN )
colnames(Cdes) &lt;- pn
Cdes[ 1, c("ASMMAT_migrant", "ASSSCI_migrant") ] &lt;- c(1,-1)
Cdes[ 2, c("ASMMAT_books", "ASSSCI_books") ] &lt;- c(1,-1)
rdes &lt;- rep(0,2)
# perform Wald test
wres2a &lt;- BIFIEsurvey::BIFIE.waldtest( res2a, Cdes, rdes )
summary(wres2a)

#******************
#*** Model 3: Frequencies

# Number of books splitted by gender
res3a &lt;- BIFIEsurvey::BIFIE.freq( bdat, vars=c("books"), group="female" )
summary(res3a)

# test whether book(cat4,female0)+book(cat5,female0)=book(cat4,female1)+book(cat5,female5)
pn &lt;- res3a$parnames
PN &lt;- length(pn)
Cdes &lt;- matrix( 0, nrow=1, ncol=PN )
colnames(Cdes) &lt;- pn
Cdes[ 1, c("books_4_female_0", "books_5_female_0",
    "books_4_female_1", "books_5_female_1" ) ] &lt;- c(1,1,-1,-1)
rdes &lt;- c(0)
# Wald test
wres3a &lt;- BIFIEsurvey::BIFIE.waldtest( res3a, Cdes, rdes )
summary(wres3a)

#******************
#*** Model 4: Means

# math and science score splitted by gender
res4a &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT","ASSSCI"), group="female")
summary(res4a)

# test whether there are significant gender differences in math and science
#=&gt; multivariate ANOVA
pn &lt;- res4a$parnames
PN &lt;- length(pn)
Cdes &lt;- matrix( 0, nrow=2, ncol=PN )
colnames(Cdes) &lt;- pn
Cdes[ 1, c("ASMMAT_female_0", "ASMMAT_female_1"  ) ] &lt;- c(1,-1)
Cdes[ 2, c("ASSSCI_female_0", "ASSSCI_female_1"  ) ] &lt;- c(1,-1)
rdes &lt;- rep(0,2)
# Wald test
wres4a &lt;- BIFIEsurvey::BIFIE.waldtest( res4a, Cdes, rdes )
summary(wres4a)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIEdata.select'>
Selection of Variables and Imputed Datasets for Objects of Class <code>BIFIEdata</code>
</h2><span id='topic+BIFIEdata.select'></span>

<h3>Description</h3>

<p>This function select variables and some (or all) imputed datasets of
an object of class <code>BIFIEdata</code> and saves the resulting
object also of class <code>BIFIEdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIEdata.select(bifieobj, varnames=NULL, impdata.index=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIEdata.select_+3A_bifieobj">bifieobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIEdata.select_+3A_varnames">varnames</code></td>
<td>

<p>Variables chosen for the selection
</p>
</td></tr>
<tr><td><code id="BIFIEdata.select_+3A_impdata.index">impdata.index</code></td>
<td>

<p>Selected indices of imputed datasets
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BIFIEdata</code> saved in a non-compact
or compact way, see value <code>cdata</code>
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+BIFIE.data">BIFIE.data</a></code> for creating <code>BIFIEdata</code> objects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Some manipulations of BIFIEdata objects created from data.timss1
#############################################################################
data(data.timss1)
data(data.timssrep)

# create BIFIEdata
bdat1 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ])
summary(bdat1)

# create BIFIEcdata object
bdat2 &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
            wgtrep=data.timssrep[, -1 ], cdata=TRUE )
summary(bdat2)

# selection of variables for BIFIEdata object
bdat1a &lt;- BIFIEsurvey::BIFIEdata.select( bdat1, varnames=bdat1$varnames[ 1:7 ] )
# selection of variables and 1st, 2nd and 4th imputed datasets of BIFIEcdata object
bdat2a &lt;- BIFIEsurvey::BIFIEdata.select( bdat2, varnames=bdat2$varnames[ 1:7 ],
                impdata.index=c(1,2,4) )
summary(bdat1a)
summary(bdat2a)
</code></pre>

<hr>
<h2 id='BIFIEdata2svrepdesign'>
Conversion of a <code>BIFIEdata</code> Object into a <code>svyrep</code> Object in the
<span class="pkg">survey</span> Package (and the other way around)
</h2><span id='topic+BIFIEdata2svrepdesign'></span><span id='topic+svrepdesign2BIFIEdata'></span>

<h3>Description</h3>

<p>The function <code>BIFIEdata2svrepdesign</code> converts of a <code>BIFIEdata</code> object into a
<code>svyrep</code> object in the <span class="pkg">survey</span> package.
</p>
<p>The function <code>svrepdesign2BIFIEdata</code> converts a
<code>svyrep</code> object in the <span class="pkg">survey</span> package into an object of class <code>BIFIEdata</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIFIEdata2svrepdesign(bifieobj, varnames=NULL, impdata.index=NULL)

svrepdesign2BIFIEdata(svrepdesign, varnames=NULL, cdata=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIEdata2svrepdesign_+3A_bifieobj">bifieobj</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="BIFIEdata2svrepdesign_+3A_varnames">varnames</code></td>
<td>
<p>Optional vector with variable names</p>
</td></tr>
<tr><td><code id="BIFIEdata2svrepdesign_+3A_impdata.index">impdata.index</code></td>
<td>

<p>Selected indices of imputed datasets
</p>
</td></tr>
<tr><td><code id="BIFIEdata2svrepdesign_+3A_svrepdesign">svrepdesign</code></td>
<td>
<p>Object of class <code>svyrep.design</code> or <code>svyimputationList</code></p>
</td></tr>
<tr><td><code id="BIFIEdata2svrepdesign_+3A_cdata">cdata</code></td>
<td>
<p>Logical inducating whether <code>BIFIEdata</code> object should be
saved in compact format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function <code>BIFIEdata2svrepdesign</code>:
Object of class <code>svyrep.design</code> or <code>svyimputationList</code> <br />
</p>
<p>Function <code>svrepdesign2BIFIEdata</code>: Object of class <code>BIFIEdata</code>
</p>


<h3>See Also</h3>

<p>See the <code><a href="#topic+BIFIE.data">BIFIE.data</a></code> function for creating objects of class
<code>BIFIEdata</code> in <span class="pkg">BIFIEsurvey</span>.
</p>
<p>See the <code><a href="survey.html#topic+svrepdesign">survey::svrepdesign</a></code> function in
the <span class="pkg">survey</span> package.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: One dataset, TIMSS replication design
#############################################################################

data(data.timss3)
data(data.timssrep)

#--- create BIFIEdata object
bdat3 &lt;- BIFIEsurvey::BIFIE.data.jack(data.timss3, jktype="JK_TIMSS")
summary(bdat3)

#--- create survey object directly in survey package
dat3a &lt;- as.data.frame( cbind( data.timss3, data.timssrep ) )
RR &lt;- ncol(data.timssrep) - 1       # number of jackknife zones
svydes3a &lt;- survey::svrepdesign(data=dat3a, weights=~TOTWGT,type="JKn",
                 repweights='w_fstr[0-9]', scale=1,  rscales=rep(1,RR), mse=TRUE )
print(svydes3a)

#--- create survey object by converting the BIFIEdata object to survey
svydes3b &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat3)

#--- convert survey object into BIFIEdata object
bdat3e &lt;- BIFIEsurvey::svrepdesign2BIFIEdata(svrepdesign=svydes3b)

#*** compare results for the mean in Mathematics scores
mod1a &lt;- BIFIEsurvey::BIFIE.univar( bdat3, vars="ASMMAT1")
mod1b &lt;- survey::svymean( ~ ASMMAT1, design=svydes3a )
mod1c &lt;- survey::svymean( ~ ASMMAT1, design=svydes3b )
lavmodel &lt;- "ASMMAT1 ~ 1"
mod1d &lt;- BIFIEsurvey::BIFIE.lavaan.survey(lavmodel, svyrepdes=svydes3b)

#- coefficients
coef(mod1a); coef(mod1b); coef(mod1c); coef(mod1d)[1]
#- standard errors
survey::SE(mod1a); survey::SE(mod1b); survey::SE(mod1c); sqrt(vcov(mod1d)[1,1])

#############################################################################
# EXAMPLE 2: Multiply imputed datasets, TIMSS replication design
#############################################################################

data(data.timss2)
data(data.timssrep)

#--- create BIFIEdata object
bdat4 &lt;- BIFIEsurvey::BIFIE.data( data=data.timss2, wgt="TOTWGT",
              wgtrep=data.timssrep[,-1], fayfac=1)
print(bdat4)

#--- create object with imputed datasets in survey
datL &lt;- mitools::imputationList( data.timss2 )
RR &lt;- ncol(data.timssrep) - 1
weights &lt;- data.timss2[[1]]$TOTWGT
repweights &lt;-  data.timssrep[,-1]
svydes4a &lt;- survey::svrepdesign(data=datL, weights=weights, type="other",
               repweights=repweights, scale=1,  rscales=rep(1,RR), mse=TRUE)
print(svydes4a)

#--- create BIFIEdata object with conversion function
svydes4b &lt;- BIFIEsurvey::BIFIEdata2svrepdesign(bdat4)

#--- reconvert survey object into BIFIEdata object
bdat4c &lt;- BIFIEsurvey::svrepdesign2BIFIEdata(svrepdesign=svydes4b)

#*** compare results for a mean
mod1a &lt;- BIFIEsurvey::BIFIE.univar(bdat4, vars="ASMMAT")
mod1b &lt;- mitools::MIcombine( with(svydes4a, survey::svymean( ~ ASMMAT, design=svydes4a )))
mod1c &lt;- mitools::MIcombine( with(svydes4b, survey::svymean( ~ ASMMAT, design=svydes4b )))

# results
coef(mod1a); coef(mod1b); coef(mod1c)
survey::SE(mod1a); survey::SE(mod1b); survey::SE(mod1c)

## End(Not run)
</code></pre>

<hr>
<h2 id='BIFIEsurvey-utilities'>Utility Functions in <span class="pkg">BIFIEsurvey</span></h2><span id='topic+BIFIEsurvey-utilities'></span><span id='topic+bifiesurvey_rcpp_rubin_rules'></span><span id='topic+bifiesurvey_rcpp_replication_variance'></span><span id='topic+BIFIE_NMI_inference_parameters'></span>

<h3>Description</h3>

<p>Utility functions in <span class="pkg">BIFIEsurvey</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Rubin rules for combining multiple imputation estimates
bifiesurvey_rcpp_rubin_rules(estimates, variances)

## computation of replication variance
bifiesurvey_rcpp_replication_variance(pars, pars_repl, fay_factor)

## statistical inference for nested multiple imputation
BIFIE_NMI_inference_parameters( parsM, parsrepM, fayfac, RR, Nimp, Nimp_NMI,
      comp_cov=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BIFIEsurvey-utilities_+3A_estimates">estimates</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_variances">variances</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_pars">pars</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_pars_repl">pars_repl</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_fay_factor">fay_factor</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_parsm">parsM</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_parsrepm">parsrepM</code></td>
<td>
<p>Matrix</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_fayfac">fayfac</code></td>
<td>
<p>Vector</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_rr">RR</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_nimp">Nimp</code></td>
<td>
<p>Integer</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_nimp_nmi">Nimp_NMI</code></td>
<td>
<p>Integer</p>
</td></tr>
<tr><td><code id="BIFIEsurvey-utilities_+3A_comp_cov">comp_cov</code></td>
<td>
<p>Logical</p>
</td></tr>
</table>

<hr>
<h2 id='bifietable'>
An <span class="pkg">Rcpp</span> Based Version of the <code>table</code> Function
</h2><span id='topic+bifietable'></span>

<h3>Description</h3>

<p>This is an <span class="pkg">Rcpp</span> based version of the
<code><a href="base.html#topic+table">base::table</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bifietable(vec, sort.names=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bifietable_+3A_vec">vec</code></td>
<td>

<p>A numeric or character vector
</p>
</td></tr>
<tr><td><code id="bifietable_+3A_sort.names">sort.names</code></td>
<td>
<p>An optional logical indicating whether values in the
character vector should also be sorted in the table output</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Same output like <code><a href="base.html#topic+table">base::table</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+table">base::table</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(data.timss1)
table( data.timss1[[1]][,"books"] )
BIFIEsurvey::bifietable( data.timss1[[1]][,"books"] )
</code></pre>

<hr>
<h2 id='data.bifie'>
Example Datasets for the <span class="pkg">BIFIEsurvey</span> Package
</h2><span id='topic+data.bifie'></span><span id='topic+data.bifie01'></span>

<h3>Description</h3>

<p>Some example datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.bifie01)
</code></pre>


<h3>Format</h3>


<ul>
<li><p> The dataset <code>data.bifie01</code> contains data of 4th Grade Austrian
students from the TIMSS 2011 study.
</p>
</li></ul>


<hr>
<h2 id='data.pisaNLD'>
Some PISA Datasets
</h2><span id='topic+data.pisaNLD'></span>

<h3>Description</h3>

<p>Some PISA datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.pisaNLD)
</code></pre>


<h3>Format</h3>

<p>The dataset <code>data.pisaNLD</code> is a data frame with 3992 observations on 405 variables
which is a part of the Dutch PISA 2006 data.
</p>


<h3>Source</h3>

<p>Downloaded from <a href="https://doi.org/10.18637/jss.v020.i05">doi:10.18637/jss.v020.i05</a> (Fox, 2007).
</p>


<h3>References</h3>

<p>Fox, J.-P. (2007). Multilevel IRT Modeling in practice with the package mlirt.
<em>Journal of Statistical Software, 20</em>(5), 1-16. <a href="https://doi.org/10.18637/jss.v020.i05">doi:10.18637/jss.v020.i05</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(mitools)
library(survey)
library(intsvy)

#############################################################################
# EXAMPLE 1: Dutch PISA 2006 dataset
#############################################################################

data(data.pisaNLD)
data &lt;- data.pisaNLD

#--- Create object of class BIFIEdata

# list variables with plausible values: These must be named
# as pv1math, pv2math, ..., pv5math, ...
pv_vars &lt;- toupper( c("math", "math1", "math2", "math3", "math4",
             "read", "scie", "prob") )
# create 5 datasets including different sets of plausible values
dfr &lt;- NULL
VV &lt;- length(pv_vars)
Nimp &lt;- 5           # number of plausible values
for (vv in 1:VV){
      vv1 &lt;- pv_vars[vv]
      ind.vv1 &lt;- which( colnames(data) %in% paste0("PV", 1:Nimp, vv1) )
      dfr2 &lt;- data.frame( "variable"=paste0("PV", vv1), "var_index"=vv,
          "data_index"=ind.vv1, "impdata_index"=1:Nimp )
      dfr &lt;- rbind( dfr, dfr2 )
}

sel_ind &lt;- setdiff( 1:( ncol(data) ), dfr$data_index )
data0 &lt;- data[, sel_ind ]
V0 &lt;- ncol(data0)
newvars &lt;- seq( V0+1, V0+VV )
datalist &lt;- as.list( 1:Nimp )
for (ii in 1:Nimp ){
    dat1 &lt;- data.frame( data0, data[, dfr[ dfr$impdata_index==ii, "data_index" ]])
    colnames(dat1)[ newvars ] &lt;- paste0("PV",pv_vars)
    datalist[[ii]] &lt;- dat1
}

# dataset with replicate weights
datarep &lt;- data[, grep( "W_FSTR", colnames(data) ) ]
RR &lt;- ncol(datarep)     # number of replicate weights

# create BIFIE object
bifieobj &lt;- BIFIEsurvey::BIFIE.data( datalist, wgt=data[, "W_FSTUWT"],
                 wgtrep=datarep, fayfac=1 / RR / ( 1 - .5 )^2 )
# For PISA: RR=80 and therefore fayfac=1/20=.05
summary(bifieobj)

#--- Create BIFIEdata object immediately using BIFIE.data.jack function
bifieobj1 &lt;- BIFIEsurvey::BIFIE.data.jack( data.pisaNLD, jktype="RW_PISA", cdata=TRUE)
summary(bifieobj1)

#--- Create object in survey package
datL &lt;- mitools::imputationList(list( datalist[[1]],datalist[[2]],
                  datalist[[3]],datalist[[4]],datalist[[5]]) )
pisades &lt;- survey::svrepdesign(ids=~ 1, weights=~W_FSTUWT, data=datL,
                    repweights="W_FSTR[0-9]+", type="Fay", rho=0.5, mse=TRUE)
print(pisades)

#++++++++++++++ some comparisons with other packages +++++++++++++++++++++++++++++++

#**** Model 1: Means for mathematics and reading
# BIFIEsurvey package
mod1a &lt;- BIFIEsurvey::BIFIE.univar( bifieobj, vars=c("PVMATH", "PVREAD") )
summary(mod1a)

# intsvy package
mod1b &lt;- intsvy::pisa.mean.pv(pvlabel="MATH", data=data.pisaNLD )
mod1b

# survey package
mod1c &lt;- with( pisades, survey::svymean(PVMATH~1, design=pisades) )
res1c &lt;- mitools::MIcombine(mod1c)
summary(res1c)

#**** Model 2: Linear regression
# BIFIEsurvey package
mod2a &lt;- BIFIEsurvey::BIFIE.linreg( bifieobj, dep="PVMATH",
              pre=c("one","ANXMAT","HISEI"))
summary(mod2a)

# intsvy package
mod2b &lt;- intsvy::pisa.reg.pv(pvlabel="MATH", x=c("ANXMAT","HISEI"), data=data.pisaNLD)
mod2b

# survey package
mod2c &lt;- with( pisades, survey::svyglm(PVMATH~ANXMAT+HISEI, design=pisades) )
res2c &lt;- mitools::MIcombine(mod2c)
summary(res2c)

## End(Not run)
</code></pre>

<hr>
<h2 id='data.test1'>
Some Datasets for Testing Purposes
</h2><span id='topic+data.test1'></span>

<h3>Description</h3>

<p>Some datasets for testing purposes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.test1)
</code></pre>


<h3>Format</h3>

<p>The dataset <code>data.test1</code> is a dataset with a stratified clustered sample of
2101 students nested within 89 classes and 4 strata. The format is
</p>
<p><code>'data.frame':   2101 obs. of  16 variables:</code> <br />
<code> $ idstud : num  10101 10102 10103 10104 10105 ...</code> <br />
<code> $ idclass: num  101 101 101 101 101 101 101 101 101 101 ...</code> <br />
<code> $ math   : num  108 107 101 91 157 ...</code> <br />
<code> $ engl   : num  95.2 133.3 94.9 97.6 142.3 ...</code> <br />
<code> $ germ   : num  125 150 107 113 139 ...</code> <br />
<code> $ stratum: num  1 1 1 1 1 1 1 1 1 1 ...</code> <br />
<code> $ female : int  1 1 1 1 0 0 0 0 0 0 ...</code> <br />
<code> $ age    : num  14.6 14.3 14.8 14.6 14.5 ...</code> <br />
<code> $ hisei  : int  43 43 43 67 51 30 30 51 68 70 ...</code> <br />
<code> $ paredu : int  2 2 1 4 5 2 1 5 7 7 ...</code> <br />
<code> $ books  : int  4 2 3 3 5 3 2 4 3 5 ...</code> <br />
<code> $ satisf : int  5 4 6 7 6 5 7 3 6 6 ...</code> <br />
<code> $ migrant: int  1 0 0 1 0 0 0 0 0 0 ...</code> <br />
<code> $ wgtstud: num  20.9 20.9 20.9 20.9 20.9 ...</code> <br />
<code> $ jkzone : num  101 101 101 101 101 101 101 101 101 101 ...</code> <br />
<code> $ jkrep  : num  0 0 0 0 0 0 0 0 0 0 ...</code> <br />
</p>

<hr>
<h2 id='data.timss'>
Dataset TIMSS 2011
</h2><span id='topic+data.timss'></span><span id='topic+data.timss1'></span><span id='topic+data.timss2'></span><span id='topic+data.timssrep'></span><span id='topic+data.timss3'></span><span id='topic+data.timss1.ind'></span><span id='topic+data.timss4'></span>

<h3>Description</h3>

<p>Example dataset TIMSS 2011
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(data.timss1)
data(data.timss1.ind)
data(data.timss2)
data(data.timssrep)
data(data.timss3)
data(data.timss4)
</code></pre>


<h3>Format</h3>

<p>The dataset <code>data.timss1</code> is a list containing 5 imputed datasets.
The dataset <code>data.timss1.ind</code> contains response indicators of these
5 imputed datasets in <code>data.timss1</code>.
</p>
<p>The dataset <code>data.timss2</code> is a list containing 5 datasets in which
only plausible values are imputed, but student covariates are missing.
</p>
<p>The dataset <code>data.timssrep</code> contains replicate weights of students.
</p>
<p>The dataset <code>data.timss3</code> is a TIMSS dataset with some missing
student covariates and all 5 plausible values contained in one file.
</p>
<p>The dataset <code>data.timss4</code> is a list containing nested multiply imputed
datasets, with 5 between-nest and 4 within-nest imputations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(survey)
library(lavaan.survey)
library(intsvy)
library(mitools)

#############################################################################
# EXAMPLE 1: TIMSS dataset data.timss3 (one dataset including all PVs)
#############################################################################

data(data.timss2)
data(data.timss3)
data(data.timssrep)

# Analysis based on official 'single' datasets (data.timss3)
# There are 5 plausible values, but student covariates are not imputed.

#--- create object of class BIFIE data
bdat3 &lt;- BIFIEsurvey::BIFIE.data(data.timss3, wgt=data.timss3$TOTWGT,
              wgtrep=data.timssrep[,-1], fayfac=1)
summary(bdat3)
# This BIFIEdata object contains one dataset in which all
# plausible values are included. This object can be used
# in analysis without plausible values.
# Equivalently, one can define bdat3 much simpler by
bdat3 &lt;- BIFIEsurvey::BIFIE.data.jack(data.timss3, jktype="JK_TIMSS")
summary(bdat3)

#--- In the following, the object bdat4 is defined with 5 datasets
# referring to 5 plausible values.
bdat4 &lt;- BIFIEsurvey::BIFIE.data.jack(data.timss3, pv_vars=c("ASMMAT","ASSSCI"),
               jktype="JK_TIMSS")
summary(bdat4)

#--- create object in survey package
dat3a &lt;- as.data.frame( cbind( data.timss2[[1]], data.timssrep ) )
RR &lt;- ncol(data.timssrep) - 1       # number of jackknife zones
svydes3 &lt;- survey::svrepdesign(data=dat3a, weights=~TOTWGT, type="JKn",
                 repweights='w_fstr[0-9]', scale=1,  rscales=rep(1,RR), mse=TRUE)
summary(svydes3)

#--- create object with imputed datasets in survey
datL &lt;- data.timss2
# include replicate weights in each dataset
for (ii in 1:5){
    dat1 &lt;- datL[[ii]]
    dat1 &lt;- cbind(  dat1, data.timssrep[,-1] )
    datL[[ii]] &lt;- dat1
}
datL &lt;- mitools::imputationList(list( datL[[1]],datL[[2]],datL[[3]],datL[[4]],datL[[5]]))
svydes4 &lt;- survey::svrepdesign(data=datL, weights=~TOTWGT, type="JKn",
                   repweights='w_fstr[0-9]', scale=1,  rscales=rep(1,RR), mse=TRUE)
summary(svydes4)

#--- reconstruct data.timss3 for intsvy package. Plausible values must be labeled
# as PV01, PV02, ... and NOT PV1, PV2, ...
data.timss3a &lt;- data.timss3
colnames(data.timss3a) &lt;- gsub( "ASMMAT", "ASMMAT0", colnames(data.timss3a) )
colnames(data.timss3a) &lt;- gsub( "ASSSCI", "ASSSCI0", colnames(data.timss3a) )

#***************************
# Model 1: Linear regression (no grouping variable)

#--- linear regression in survey
mod1a &lt;-  survey::svyglm( scsci ~ migrant + books, design=svydes3)
summary(mod1a)

#--- regression with pirls.reg (intsvy)
mod1b &lt;- intsvy::pirls.reg( y="scsci", x=c("migrant", "books" ), data=data.timss3)
mod1b

#---- regression with BIFIEsurvey
mod1c &lt;- BIFIEsurvey::BIFIE.linreg( bdat3, dep="scsci", pre=c("one","migrant","books"))
summary(mod1c)

#--- regression with lavaan.survey package
lavmodel &lt;- "
    scsci ~ migrant + books
    scsci ~ 1
    scsci ~~ scsci
        "
# fit in lavaan
lavaan.fit &lt;- lavaan::lavaan( lavmodel, data=data.timss3, estimator="MLM")
summary(lavaan.fit)
# using all replicated weights
mod1d &lt;- lavaan.survey::lavaan.survey(lavaan.fit=lavaan.fit, survey.design=svydes3 )
summary(mod1d)

#***************************
# Model 2: Linear regression (grouped by female)

#--- linear regression in survey
mod2a &lt;- survey::svyglm( scsci ~ 0 + as.factor(female) + as.factor(female):migrant
               + as.factor(female):books, design=svydes3)
summary(mod2a)

#--- regression with pirls.reg (intsvy)
mod2b &lt;- intsvy::pirls.reg( y="scsci", x=c("migrant", "books" ),
                 by="female", data=data.timss3)
mod2b[["0"]]   # regression coefficients female=0
mod2b[["1"]]   # regression coefficients female=1

#--- regression with BIFIEsurvey
mod2c &lt;- BIFIEsurvey::BIFIE.linreg( bdat3, dep="scsci",
               pre=c("one","migrant","books"), group="female")
summary(mod2c)

#--- regression with lavaan.survey package
lavmodel &lt;- "
    scsci ~ migrant + books
    scsci ~ 1
    scsci ~~ scsci
        "
# fit in lavaan
lavaan.fit &lt;- lavaan::lavaan( lavmodel, data=data.timss3, group="female", estimator="MLM")
summary(lavaan.fit)
mod2d &lt;- lavaan.survey::lavaan.survey(lavaan.fit=lavaan.fit, survey.design=svydes3 )
summary(mod2d)

#***************************
# Model 3: Linear regression with mathematics PVs
library(mitools)

#--- linear regression in survey
mod3a &lt;- with(svydes4,  survey::svyglm( ASMMAT ~ migrant + books, design=svydes4 ) )
res3a &lt;- mitools::MIcombine(mod3a)
summary(res3a)

#--- regression with pirls.reg.pv (intsvy)
mod3b &lt;- intsvy::pirls.reg.pv( pvlabel="ASMMAT", x=c("migrant", "books" ),
             data=data.timss3a)

#--- regression with BIFIEsurvey
mod3c &lt;- BIFIEsurvey::BIFIE.linreg( bdat4, dep="ASMMAT", pre=c("one","migrant","books"))
summary(mod3c)

#--- regression with lavaan.survey package
lavmodel &lt;- "
    ASMMAT ~ migrant + books
    ASMMAT ~ 1
    ASMMAT ~~ ASMMAT
        "
# fit in lavaan
lavaan.fit &lt;- lavaan::lavaan( lavmodel, data=data.timss3a, group="female", estimator="MLM")
summary(lavaan.fit)
mod3d &lt;- lavaan.survey::lavaan.survey(lavaan.fit=lavaan.fit, survey.design=svydes4 )
summary(mod3d)

#############################################################################
# EXAMPLE 2: TIMSS dataset data.timss4 | Nested multiply imputed dataset
#############################################################################

data(data.timss4)
data(data.timssrep)

#**** create BIFIEdata object
bdat &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss4, wgt=data.timss4[[1]][[1]]$TOTWGT,
               wgtrep=data.timssrep[, -1 ], NMI=TRUE, cdata=TRUE )
summary(bdat)

#**** Model 1: Linear regression for mathematics score
mod1 &lt;- BIFIEsurvey::BIFIE.linreg( bdat, dep="ASMMAT", pre=c("one","books","migrant"))
summary(mod1)

#*** Model 2: Univariate statistics ?BIFIEsurvey::BIFIE.univar
mod2 &lt;- BIFIEsurvey::BIFIE.univar( bdat, vars=c("ASMMAT","ASSSCI","books") )
summary(mod2)

## End(Not run)
</code></pre>

<hr>
<h2 id='save.BIFIEdata'>
Saving, Writing and Loading <code>BIFIEdata</code> Objects
</h2><span id='topic+save.BIFIEdata'></span><span id='topic+load.BIFIEdata'></span><span id='topic+write.BIFIEdata'></span><span id='topic+load.BIFIEdata.files'></span>

<h3>Description</h3>

<p>These functions save (<code>save.BIFIEdata</code>), write (<code>write.BIFIEdata</code>)
or load (<code>load.BIFIEdata</code>) objects of class <code>BIFIEdata</code>.
</p>
<p>The function <code>load.BIFIEdata.files</code> allows the creation
of <code>BIFIEdata</code> objects by loading separate files of imputed datasets,
replicate weights and a possible indicator dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save.BIFIEdata(BIFIEdata, name.BIFIEdata, cdata=TRUE, varnames=NULL)

write.BIFIEdata( BIFIEdata, name.BIFIEdata, dir=getwd(), varnames=NULL,
    impdata.index=NULL, type="Rdata", ... )

load.BIFIEdata(filename, dir=getwd() )

load.BIFIEdata.files( files.imp, wgt, file.wgtrep, file.ind=NULL,
    type="Rdata",varnames=NULL, cdata=TRUE, dir=getwd(), ... )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save.BIFIEdata_+3A_bifiedata">BIFIEdata</code></td>
<td>

<p>Object of class <code>BIFIEdata</code>
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_name.bifiedata">name.BIFIEdata</code></td>
<td>

<p>Name of <code>BIFIEdata</code> set to be saved
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_cdata">cdata</code></td>
<td>
<p>An optional logical indicating whether the dataset should be
saved in a 'compact way'</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_varnames">varnames</code></td>
<td>
<p>Vector of variable names which should be saved. The default
is to use all variables.
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_dir">dir</code></td>
<td>
<p>Directory in which data files should be saved. The default
is the working directory.</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_impdata.index">impdata.index</code></td>
<td>
<p>Vector of indices for selecting imputed datasets</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_type">type</code></td>
<td>
<p>Type of saved data. Options are <code>Rdata</code> (function
<code><a href="base.html#topic+save">base::save</a></code>,
<code>csv</code> (function <code><a href="utils.html#topic+write.csv">utils::write.csv</a></code>),
<code>csv2</code> (function <code><a href="utils.html#topic+write.csv2">utils::write.csv2</a></code>),
<code>table</code> (function <code><a href="utils.html#topic+write.table">utils::write.table</a></code>),
<code>sav</code> (function <code><a href="foreign.html#topic+read.spss">foreign::read.spss</a></code>
for reading sav files and function
<code>sjlabelled::write_spss</code> for writing sav files).
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to
<code><a href="base.html#topic+save">base::save</a></code>,
<code><a href="utils.html#topic+write.csv">utils::write.csv</a></code>,
<code><a href="utils.html#topic+write.csv2">utils::write.csv2</a></code>,
<code><a href="utils.html#topic+write.table">utils::write.table</a></code>,
<code><a href="foreign.html#topic+read.spss">foreign::read.spss</a></code>,
<code>sjlabelled::write_spss</code>
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_filename">filename</code></td>
<td>

<p>File name of <code>BIFIEdata</code> object
</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_files.imp">files.imp</code></td>
<td>
<p>Vector of file names of imputed datasets</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_wgt">wgt</code></td>
<td>
<p>Variable name of case weight</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_file.wgtrep">file.wgtrep</code></td>
<td>
<p>File name for dataset with replicate weights</p>
</td></tr>
<tr><td><code id="save.BIFIEdata_+3A_file.ind">file.ind</code></td>
<td>
<p>Optional. File name for dataset with response data indicators</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Saved <span class="rlang"><b>R</b></span> object and a summary in working directory or a loaded <span class="rlang"><b>R</b></span> object.
</p>


<h3>See Also</h3>

<p>For creating objects of class <code>BIFIEdata</code> see <code><a href="#topic+BIFIE.data">BIFIE.data</a></code>.
</p>
<p><code><a href="base.html#topic+save">base::save</a></code>, <code><a href="base.html#topic+load">base::load</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#############################################################################
# EXAMPLE 1: Saving and loading BIFIE data objects
#############################################################################
data(data.timss1)
data(data.timssrep)

bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt=data.timss1[[1]]$TOTWGT,
                 wgtrep=data.timssrep[, -1 ] )
summary(bifieobj)

# save bifieobj in a compact way
BIFIEsurvey::save.BIFIEdata( BIFIEdata=bifieobj, name.BIFIEdata="timss1_cdata" )
# save bifieobj in a non-compact way
BIFIEsurvey::save.BIFIEdata( BIFIEdata=bifieobj, name.BIFIEdata="timss1_data", cdata=FALSE)

# load this object with object name "bdat2"
bdat2 &lt;- BIFIEsurvey::load.BIFIEdata( filename="timss1_data.Rdata" )
summary(bdat2)

# save bifieobj with selected variables
BIFIEsurvey::save.BIFIEdata( bifieobj, name.BIFIEdata="timss1_selectvars_cdata",
                     varnames=bifieobj$varnames[ c(1:7,13,12,9) ] )
# the same object, but use the non-compact way of saving
BIFIEsurvey::save.BIFIEdata( bifieobj, name.BIFIEdata="timss1_selectvars_data", cdata=FALSE,
                     varnames=bifieobj$varnames[ c(1:7,13,12,9) ] )

# load object timss1_cdata (in compact data format)
bdat3 &lt;- BIFIEsurvey::load.BIFIEdata( filename="timss1_cdata.Rdata" )
summary(bdat3)
# save selected variables of object bdat3
BIFIEsurvey::save.BIFIEdata( bdat3, name.BIFIEdata="timss1_selectvars2_cdata",
                     varnames=bifieobj$varnames[ c(1:4,12,8) ] )

#############################################################################
# EXAMPLE 2: Writing BIFIEdata objects
#############################################################################

data(data.timss2)
data(data.timssrep)

# create compactBIFIEdata
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss2, wgt=data.timss2[[1]]$TOTWGT,
                wgtrep=data.timssrep[, -1 ], cdata=TRUE)
summary(bifieobj)

# save imputed datasets in format csv2
BIFIEsurvey::write.BIFIEdata( bifieobj, name.BIFIEdata="timss2_save1", type="csv2", row.names=FALSE)

# save imputed datasets of BIFIEdata object in format table without column names
# and code missings as "."
BIFIEsurvey::write.BIFIEdata( bifieobj, name.BIFIEdata="timss2_save2", type="table",
                  col.names=FALSE, row.names=FALSE, na="." )

# save imputed datasets of  BIFIEdata object in format csv and select some variables
# and only the first three datasets
varnames &lt;- c("IDSTUD","TOTWGT","female","books","lang","ASMMAT")
BIFIEsurvey::write.BIFIEdata( bifieobj, name.BIFIEdata="timss2_save3", type="csv",
                   impdata.index=1:3, varnames=varnames)

# save imputed datasets of BIFIEdata object in format Rdata, the R binary format
BIFIEsurvey::write.BIFIEdata( bifieobj, name.BIFIEdata="timss2_save4", type="Rdata"  )

# save imputed datasets in sav (SPSS) format
BIFIEsurvey::write.BIFIEdata( bifieobj, name.BIFIEdata="timss2_save5", type="sav" )

#############################################################################
# EXAMPLE 3: Loading BIFIEdata objects saved in separate files
#                   (no indicator dataset)
#############################################################################

# We assume that Example 2 is applied and we build on the saved files
# from this example.

#***--- read Rdata format
# extract files with imputed datasets and replicate weights
files.imp &lt;- miceadds::grep.vec( c("timss2_save4__IMP", ".Rdata" ),
            list.files(getwd())  )$x
file.wgtrep &lt;- miceadds::grep.vec( c("timss2_save4__WGTREP", ".Rdata" ),
            list.files(getwd())  )$x
# select some variables in varnames
varnames &lt;- scan( nlines=1, what="character")
   IDSTUD   TOTWGT books lang migrant likesc  ASMMAT

# load files and create BIFIEdata object
bifieobj1 &lt;- BIFIEsurvey::load.BIFIEdata.files( files.imp, wgt="TOTWGT", file.wgtrep,
                        type="Rdata", varnames=varnames )
summary(bifieobj1)

#***--- read csv2 format
files.imp &lt;- miceadds::grep.vec( c("timss2_save1__IMP", ".csv" ),
                        list.files(getwd()) )$x
file.wgtrep &lt;- miceadds::grep.vec( c("timss2_save1__WGTREP", ".csv" ),
                        list.files(getwd()) )$x
bifieobj2 &lt;- BIFIEsurvey::load.BIFIEdata.files( files.imp, wgt="TOTWGT",
                    file.wgtrep, type="csv2" )
summary(bifieobj2)

#***--- read sav format
files.imp &lt;- miceadds::grep.vec( c("timss2_save5__IMP", ".sav" ),
                        list.files(getwd()) )$x
file.wgtrep &lt;- miceadds::grep.vec( c("timss2_save5__WGTREP", ".sav" ),
                        list.files(getwd()) )$x
bifieobj3 &lt;- BIFIEsurvey::load.BIFIEdata.files( files.imp, wgt="TOTWGT",
                file.wgtrep, type="sav", to.data.frame=TRUE, use.value.labels=FALSE)
summary(bifieobj3)

#############################################################################
# EXAMPLE 4: Loading BIFIEdata objects saved in separate files
#                   (with an indicator dataset)
#############################################################################

data(data.timss1)
data(data.timss1.ind)
data(data.timssrep)

# create BIFIEdata object at first
bifieobj &lt;- BIFIEsurvey::BIFIE.data( data.list=data.timss1, wgt="TOTWGT",
            wgtrep=data.timssrep[, -1 ] )
summary(bifieobj)

#--- save datasets for the purpose of the following example
write.BIFIEdata( BIFIEdata=bifieobj, name.BIFIEdata="timss1_ex", type="Rdata" )
# save indicator dataset
save( data.timss1.ind, file="timss1_ex__IND.Rdata" )

# grep file names
files.imp &lt;- miceadds::grep.vec( c("timss1_ex__IMP", ".Rdata" ),
                      list.files(getwd()) )$x
file.wgtrep &lt;- miceadds::grep.vec( c("timss1_ex__WGTREP", ".Rdata" ),
                      list.files(getwd()) )$x
file.ind &lt;- miceadds::grep.vec( c("timss1_ex__IND", ".Rdata" ),
                      list.files(getwd()) )$x
# define variables for selection
varnames &lt;- c("IDSTUD","TOTWGT","female","books","lang","ASMMAT")
# read files using indicator dataset
bifieobj2 &lt;- BIFIEsurvey::load.BIFIEdata.files( files.imp, wgt="TOTWGT",
                  file.wgtrep=file.wgtrep, file.ind=file.ind, type="Rdata",
                  varnames=varnames)
summary(bifieobj2)

# read files without indicator dataset
bifieobj3 &lt;- BIFIEsurvey::load.BIFIEdata.files( files.imp, wgt="TOTWGT",
                file.wgtrep=file.wgtrep, type="Rdata", varnames=varnames)
summary(bifieobj3)

# compare some descriptive statistics
res2 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj2, vars=c("books", "ASMMAT", "lang") )
res3 &lt;- BIFIEsurvey::BIFIE.univar( bifieobj3, vars=c("books", "ASMMAT", "lang") )
summary(res2)
summary(res3)

## End(Not run)
</code></pre>

<hr>
<h2 id='se'>
Standard Errors of Estimated Parameters
</h2><span id='topic+se'></span>

<h3>Description</h3>

<p>Outputs vector of standard errors of an estimated parameter vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>se(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="se_+3A_object">object</code></td>
<td>

<p>Object for which S3 method <code>vcov</code> can be applied
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector
</p>


<h3>See Also</h3>

<p><code><a href="survey.html#topic+SE">survey::SE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Toy example with lm function
#############################################################################

set.seed(906)
N &lt;- 100
x &lt;- seq(0,1,length=N)
y &lt;- .6*x + stats::rnorm(N, sd=1)
mod &lt;- stats::lm( y ~ x )
coef(mod)
vcov(mod)
se(mod)
summary(mod)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
