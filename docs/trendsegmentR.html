<!DOCTYPE html><html><head><title>Help for package trendsegmentR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {trendsegmentR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#invTGUW'><p>Inverse Tail-Greedy Unbalanced Wavelet (TGUW) transformation</p></a></li>
<li><a href='#TGUW'><p>Tail-Greedy Unbalanced Wavelet (TGUW) transformation of a vector</p></a></li>
<li><a href='#thresholding'><p>Noise reduction from the sequence of detail coefficients returned by the Tail-Greedy Unbalanced Wavelet (TGUW) transformation</p></a></li>
<li><a href='#trendsegment'><p>Detecting linear trend changes for univariate time series</p></a></li>
<li><a href='#trendsegmentR-package'><p>trendsegmentR: Linear Trend Segmentation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Linear Trend Segmentation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hyeyoung Maeng &lt;hyeyoung.maeng@durham.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs the detection of linear trend changes for univariate time series 
    by implementing the bottom-up unbalanced wavelet transformation proposed by 
    H. Maeng and P. Fryzlewicz (2023). The estimated number and locations of the 
    change-points are returned with the piecewise-linear estimator for signal.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-24 10:59:33 UTC; hyeyoung</td>
</tr>
<tr>
<td>Author:</td>
<td>Hyeyoung Maeng [aut, cre],
  Piotr Fryzlewicz [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-24 11:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='invTGUW'>Inverse Tail-Greedy Unbalanced Wavelet (TGUW) transformation</h2><span id='topic+invTGUW'></span>

<h3>Description</h3>

<p>This function is used inside <code><a href="#topic+trendsegment">trendsegment</a></code> and performs the inverse TGUW transformation by undoing the orthonormal transformation of <code>TGUW</code> in reverse order.
Details of the inverse TGUW transformation can be found in H. Maeng and P. Fryzlewicz (2023), Detecting linear trend changes in data sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>invTGUW(ts.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="invTGUW_+3A_ts.obj">ts.obj</code></td>
<td>
<p>A list returned by <code>thresholding</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ts.obj</code></td>
<td>
<p>The modified ts.obj is the result of the inverse TGUW transformation and <code>ts.coeffs</code> now presents the estimated piecewise-linear signal of the data.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>, Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trendsegment">trendsegment</a></code>, <code><a href="#topic+TGUW">TGUW</a></code>, <code><a href="#topic+thresholding">thresholding</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:10, rep(5,9))
n &lt;- length(x)
x &lt;- x + rnorm(n)
tguwfit &lt;- TGUW(x)
th.const &lt;- 1.3
lambda &lt;- (stats::mad(diff(diff(x)))/sqrt(6)) * sqrt(2 * log(n)) * th.const
thrfit &lt;- thresholding(ts.obj = tguwfit, lambda = lambda, minsegL = 5, bal = 0, connected = TRUE)
invfit &lt;- invTGUW(ts.obj = thrfit)
invfit
</code></pre>

<hr>
<h2 id='TGUW'>Tail-Greedy Unbalanced Wavelet (TGUW) transformation of a vector</h2><span id='topic+TGUW'></span>

<h3>Description</h3>

<p>Performs the bottom-up unbalanced wavelet decomposition. This function is used inside <code><a href="#topic+trendsegment">trendsegment</a></code>.
Details of the TGUW transformation can be found in H. Maeng and P. Fryzlewicz (2023), Detecting linear trend changes in data sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGUW(x, p = 0.04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TGUW_+3A_x">x</code></td>
<td>
<p>An input vector to be decomposed.</p>
</td></tr>
<tr><td><code id="TGUW_+3A_p">p</code></td>
<td>
<p>Proportion of all possible remaining merges which specifies the number of merges allowed in a single pass over the data. The default is 0.04.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the followings:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The original input vector <code>x</code>.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>The length of <code>x</code>.</p>
</td></tr>
<tr><td><code>twotogether</code></td>
<td>
<p>A vector indicating locations of the detail coefficients returned by Type 3 merges (merging two sets of paired smooth coefficients). This is used in <code><a href="#topic+thresholding">thresholding</a></code> to apply the &quot;two together&quot; rule which makes both detail coefficients (paired by a Type 3 merge) survived if at least one of their size is over threshold.</p>
</td></tr>
<tr><td><code>merging.hist</code></td>
<td>
<p>An array of dimension 4 by 3 by <code>n</code>-2 which has the full record of the <code>n</code>-2 merges in the TGUW transformation. Each matrix contains the information of each merge. The first row shows the indices of merged smooth coefficients in increasing order and the second row gives the value of detail filter coefficients which is the weight vector for computing the corresponding detail coefficient. The third row shows the (detail coefficient, first smooth coefficient, second smooth coefficient) obtained by an orthonormal transform. The fourth row gives the balancedness of merging. If it is Type 1 merging (three initial smooth coefficients) then the fourth row is always (1/3, 1/3, 1/3). In Type 2 and Type 3 mergings, the values depend on the ratio of the length of the left and right wings to the entire merged region and only first two components of the fourth row are filled with the corresponding ratios (sum to 1) but the third one is left as NA.</p>
</td></tr>
<tr><td><code>ts.coeffs</code></td>
<td>
<p>The transformed <code>x</code> by the TGUW transformation.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>, Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trendsegment">trendsegment</a></code>, <code><a href="#topic+thresholding">thresholding</a></code>, <code><a href="#topic+invTGUW">invTGUW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:10, rep(5,9))
n &lt;- length(x)
x &lt;- x + rnorm(n)
tguwfit &lt;- TGUW(x)
tguwfit
</code></pre>

<hr>
<h2 id='thresholding'>Noise reduction from the sequence of detail coefficients returned by the Tail-Greedy Unbalanced Wavelet (TGUW) transformation</h2><span id='topic+thresholding'></span>

<h3>Description</h3>

<p>This function is used inside <code><a href="#topic+trendsegment">trendsegment</a></code> and performs the thresholding of the detail coefficients returned by the Tail-Greedy Unbalanced Wavelet (TGUW) transformation.
The denoising is achieved by a prespecified threshold in a &quot;connected&quot; way in that it prunes the branches if and only if
the detail coefficient itself and all of its children coefficients are below some thresholds in its size. Also, the
&quot;two together&quot; rule is applied to any paired detail coefficients returned by Type 3
merging (merging two sets of paired smooth coefficients) in the sense that both detail coefficients should be survived if at least one of their size is over threshold. For details, see H. Maeng and P. Fryzlewicz (2023), Detecting linear trend changes in data sequences.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresholding(ts.obj, lambda, minsegL, bal = 0, connected = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="thresholding_+3A_ts.obj">ts.obj</code></td>
<td>
<p>A list returned by <code>TGUW</code>.</p>
</td></tr>
<tr><td><code id="thresholding_+3A_lambda">lambda</code></td>
<td>
<p>The magnitude of the threshold. It has a form of <code>sigma * th.const * sqrt(2 * log(n))</code> where <code>n</code> is the length of input data <code>x</code>, the default of <code>th.const</code> is 1.3 and the <code>sigma</code> can be estimated by Median Absolute Deviation (MAD) method under the Gaussian assumption for noise.</p>
</td></tr>
<tr><td><code id="thresholding_+3A_minsegl">minsegL</code></td>
<td>
<p>The minimum segment length of estimated signal returned by <code>trendsegment</code>.</p>
</td></tr>
<tr><td><code id="thresholding_+3A_bal">bal</code></td>
<td>
<p>The minimum ratio of the length of the shorter region to the length of the entire merging region especially when the merges of Type 2 (merging one initial and a paired smooth coefficient) or of Type 3 (merging two sets of (paired) smooth coefficients) are performed. Only triplets which satisfy this balancedness condition survives in denoising. Point anomalies can be detected only if <code>bal &lt; 1/n</code> and <code>minsegL = 1</code>. The default is set to 0.</p>
</td></tr>
<tr><td><code id="thresholding_+3A_connected">connected</code></td>
<td>
<p>If connected=TRUE, the thresholding puts the connected rule above the <code>minsegL</code>, otherwise it makes keeping the <code>minsegL</code> a priority.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ts.obj</code></td>
<td>
<p>The modified ts.obj containing zero detail coefficients in the <code>merging.hist</code> if not survived from thresholding.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>, Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trendsegment">trendsegment</a></code>, <code><a href="#topic+TGUW">TGUW</a></code>, <code><a href="#topic+invTGUW">invTGUW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1:10, rep(5,9))
n &lt;- length(x)
x &lt;- x + rnorm(n)
tguwfit &lt;- TGUW(x)
th.const &lt;- 1.3
lambda &lt;- (stats::mad(diff(diff(x)))/sqrt(6)) * sqrt(2 * log(n)) * th.const
thrfit &lt;- thresholding(ts.obj = tguwfit, lambda = lambda, minsegL = 5, bal = 0, connected = FALSE)
thrfit
</code></pre>

<hr>
<h2 id='trendsegment'>Detecting linear trend changes for univariate time series</h2><span id='topic+trendsegment'></span>

<h3>Description</h3>

<p>The main function of the package <code><a href="#topic+trendsegmentR">trendsegmentR</a></code>. This function estimates the number and locations of change-points in linear trend of noisy data. The estimated change-points may contain point anomalies (segments including only one data point) if any. It also returns the estimated signal, the best linear fit for each segment between a pair of adjacent change-points. The algorithm includes three steps, Tail-Greedy Unbalanced Wavelet (TGUW) transform (<code><a href="#topic+TGUW">TGUW</a></code>), thresholding (<code><a href="#topic+thresholding">thresholding</a></code>) and inverse TGUW transform (<code><a href="#topic+invTGUW">invTGUW</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trendsegment(
  x,
  indep = FALSE,
  th.const = krt.hvt(x)$thr,
  p = 0.04,
  bal = 0,
  minsegL = floor(0.9 * log(length(x))),
  continuous = FALSE,
  connected = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trendsegment_+3A_x">x</code></td>
<td>
<p>A data vector to be examined for change-point detection.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_indep">indep</code></td>
<td>
<p>If x is known to be independent over time, let indep=TRUE, otherwise the default is indep=FALSE.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_th.const">th.const</code></td>
<td>
<p>Robust thresholding parameter used in <code><a href="#topic+thresholding">thresholding</a></code>. The default is obtained by considering sample kurtosis and long run standard deviation. The exact magnitude of the threshold also depends on <code>sigma</code> which is estimated by Median Absolute Deviation (MAD) method under the i.i.d. Gaussian noise assumption.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_p">p</code></td>
<td>
<p>Proportion of all possible remaining merges which specifies the number of merges allowed in a single pass over the data. This is used in <code><a href="#topic+TGUW">TGUW</a></code> and the default is 0.04.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_bal">bal</code></td>
<td>
<p>The minimum ratio of the length of the shorter region to the length of the entire merging region especially when the merges of Type 2 (merging one initial and a paired smooth coefficient) or of Type 3 (merging two sets of (paired) smooth coefficients) are performed. The default is set to 0.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_minsegl">minsegL</code></td>
<td>
<p>The minimum segment length of estimated signal returned by <code>trendsegment</code>. The default is set to <code>sigma * log(n)</code> for the noise which is possibly dependent and/or non-Gaussian.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_continuous">continuous</code></td>
<td>
<p>If continuous=TRUE, the estimated signal returned by <code>trendsegment</code> is continuous at change-points, otherwise discontinuous at change-points. The default is set to FALSE.</p>
</td></tr>
<tr><td><code id="trendsegment_+3A_connected">connected</code></td>
<td>
<p>If connected=TRUE, the <code>trendsegment</code> algorithm puts the connected rule above the <code>minsegL</code>, otherwise it makes keeping the <code>minsegL</code> a priority. The default is set to FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm is described in H. Maeng and P. Fryzlewicz (2023), Detecting linear trend changes in data sequences.
</p>


<h3>Value</h3>

<p>A list with the following.
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>The original input vector <code>x</code>.</p>
</td></tr>
<tr><td><code>est</code></td>
<td>
<p>The estimated piecewise-linear signal of <code>x</code>.</p>
</td></tr>
<tr><td><code>no.of.cpt</code></td>
<td>
<p>The estimated number of change-points.</p>
</td></tr>
<tr><td><code>cpt</code></td>
<td>
<p>The estimated locations of change-points.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>, Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TGUW">TGUW</a></code>, <code><a href="#topic+thresholding">thresholding</a></code>, <code><a href="#topic+invTGUW">invTGUW</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(rep(0,100), seq(0, 4, length.out = 100), rep(3, 100), seq(3, -1, length.out=99))
n &lt;- length(x)
x &lt;- x + rnorm(n)
tsfit &lt;- trendsegment(x = x)
tsfit

plot(x, type = "b", ylim = range(x, tsfit$est))
lines(tsfit$est, col=2, lwd=2)
abline(v=tsfit$cpt, col=3, lty=2, lwd=2)
</code></pre>

<hr>
<h2 id='trendsegmentR-package'>trendsegmentR: Linear Trend Segmentation</h2><span id='topic+trendsegmentR'></span><span id='topic+trendsegmentR-package'></span>

<h3>Description</h3>

<p>Performs the detection of linear trend changes for univariate time series by implementing the bottom-up unbalanced wavelet transformation proposed by H. Maeng and P. Fryzlewicz (2023). The estimated number and locations of the change-points are returned with the piecewise-linear estimator for signal.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hyeyoung Maeng <a href="mailto:hyeyoung.maeng@durham.ac.uk">hyeyoung.maeng@durham.ac.uk</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Piotr Fryzlewicz <a href="mailto:p.fryzlewicz@lse.ac.uk">p.fryzlewicz@lse.ac.uk</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
