<!DOCTYPE html><html><head><title>Help for package qch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qch}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FastKerFdr'><p>FastKerFdr</p></a></li>
<li><a href='#GetHinfo'><p>Generate H0/H1 configurations and specify the ones corresponding to the composed H1</p></a></li>
<li><a href='#GetHinfoEqual'><p>Generate H0/H1 configurations and specify the ones corresponding to the composed H1</p></a></li>
<li><a href='#PvalSets'><p>Synthetic example to illustrate the main qch functions</p></a></li>
<li><a href='#qch-package'><p>qch: Query Composed Hypotheses</p></a></li>
<li><a href='#qch.fit'><p>Infer Hconfig posteriors</p></a></li>
<li><a href='#qch.test'><p>Perform composed hypothesis testing with FDR control</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Query Composed Hypotheses</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions for the joint analysis of K sets
    of p-values obtained for a same list of items. This joint analysis is
    performed by querying a composed hypothesis, i.e. an arbitrary complex
    combination of simple hypotheses, as described in Mary-Huard et al.
    (2021) &lt;<a href="https://arxiv.org/abs/2104.14601">arXiv:2104.14601</a>&gt;. The null distribution corresponding to the
    composed hypothesis of interest is obtained by fitting non-parametric
    mixtures models (one for each of the simple hypothesis of the complex
    combination). Type I error rate control is achieved through Bayesian
    False Discovery Rate control.  The 3 main functions of the package
    GetHinfo(), qch.fit() and qch.test() correspond to the 3 steps for
    querying a composed hypothesis (composed H0/H1 formulation, inferring
    the null distribution and testing the null hypothesis).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, ks, mclust, stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-06 13:12:40 UTC; dsi</td>
</tr>
<tr>
<td>Author:</td>
<td>Tristan Mary-Huard
    <a href="https://orcid.org/0000-0002-3839-9067"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tristan Mary-Huard &lt;tristan.mary-huard@agroparistech.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-07 12:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='FastKerFdr'>FastKerFdr</h2><span id='topic+FastKerFdr'></span>

<h3>Description</h3>

<p>FastKerFdr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FastKerFdr(Pval, p0 = NULL, plotting = FALSE, NbKnot = 1e+05, tol = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FastKerFdr_+3A_pval">Pval</code></td>
<td>
<p>a vector of p-values (corresponding to a p-value serie)</p>
</td></tr>
<tr><td><code id="FastKerFdr_+3A_p0">p0</code></td>
<td>
<p>a priori proportion of H0 hypotheses</p>
</td></tr>
<tr><td><code id="FastKerFdr_+3A_plotting">plotting</code></td>
<td>
<p>boolean, should some diagnostic graphs be plotted. Default is FALSE.</p>
</td></tr>
<tr><td><code id="FastKerFdr_+3A_nbknot">NbKnot</code></td>
<td>
<p>The (maximum) number of knot for the kde procedure. Default is 1e5</p>
</td></tr>
<tr><td><code id="FastKerFdr_+3A_tol">tol</code></td>
<td>
<p>a tolerance value for convergence. Default is 1e-5</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 3 objects. Object p0 is an estimate of the proportion of H0 hypotheses.,
tau is the vector of H1 posteriors.
f1 is a numeric vector, each coordinate i corresponding to the evaluation of the H1 density at point pi, where pi is the ith p-value in Pval.
</p>

<hr>
<h2 id='GetHinfo'>Generate H0/H1 configurations and specify the ones corresponding to the composed H1</h2><span id='topic+GetHinfo'></span>

<h3>Description</h3>

<p>Generate H0/H1 configurations and specify the ones corresponding to the composed H1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetHinfo(Q, AtLeast, Consecutive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetHinfo_+3A_q">Q</code></td>
<td>
<p>number of test series to be combined</p>
</td></tr>
<tr><td><code id="GetHinfo_+3A_atleast">AtLeast</code></td>
<td>
<p>How many H1 hypotheses at least for the item to be of interest ?</p>
</td></tr>
<tr><td><code id="GetHinfo_+3A_consecutive">Consecutive</code></td>
<td>
<p>Should the significant test series be consecutive ? Default=FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two objects 'Hconfig' and 'Hconfig.H1'.
Hconfig is the list of all possible combination of H0 and H1 hypotheses among Q hypotheses tested.
Hconfig.H1 is the vector of components of Hconfig that correspond to the 'AtLeast' specification.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetHinfoEqual">GetHinfoEqual()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GetHinfo(4,2)

</code></pre>

<hr>
<h2 id='GetHinfoEqual'>Generate H0/H1 configurations and specify the ones corresponding to the composed H1</h2><span id='topic+GetHinfoEqual'></span>

<h3>Description</h3>

<p>Generate H0/H1 configurations and specify the ones corresponding to the composed H1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetHinfoEqual(Q, Equal, Consecutive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetHinfoEqual_+3A_q">Q</code></td>
<td>
<p>number of test series to be combined</p>
</td></tr>
<tr><td><code id="GetHinfoEqual_+3A_equal">Equal</code></td>
<td>
<p>How many H1 hypotheses exactly for the item to be of interest ?</p>
</td></tr>
<tr><td><code id="GetHinfoEqual_+3A_consecutive">Consecutive</code></td>
<td>
<p>Should the significant test series be consecutive ? Default=FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two objects 'Hconfig' and 'Hconfig.H1'.
Hconfig is the list of all possible combination of H0 and H1 hypotheses among Q hypotheses tested.
Hconfig.H1 is the vector of components of Hconfig that correspond to the 'Equal' specification.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GetHinfo">GetHinfo()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GetHinfoEqual(4,2)
</code></pre>

<hr>
<h2 id='PvalSets'>Synthetic example to illustrate the main qch functions</h2><span id='topic+PvalSets'></span>

<h3>Description</h3>

<p>PvalSets is a data.frame with 10,000 rows and 3 columns. Each row corresponds to an item,
columns 'Pval1' and 'Pval2'  each correspond to a test serie over the items, and column 'Class'
provides the truth, i.e. if item <code class="reqn">i</code> belongs to class 1 then the H0 hypothesis is true for the 2 tests,
if item <code class="reqn">i</code> belongs to class 2 (resp. 3) then the H0 hypothesis is true for the first (resp. second)
test only, and if item <code class="reqn">i</code> belongs to class 4 then both H0 hypotheses are false (for the first
and the second test).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PvalSets
</code></pre>


<h3>Format</h3>

<p>A data.frame
</p>

<hr>
<h2 id='qch-package'>qch: Query Composed Hypotheses</h2><span id='topic+qch'></span><span id='topic+qch-package'></span>

<h3>Description</h3>

<p>Provides functions for the joint analysis of K sets
of p-values obtained for a same list of items. This joint analysis is
performed by querying a composed hypothesis, i.e. an arbitrary complex
combination of simple hypotheses, as described in Mary-Huard et al.
(2021) &lt;arXiv:2104.14601&gt;. The null distribution corresponding to the
composed hypothesis of interest is obtained by fitting non-parametric
mixtures models (one for each of the simple hypothesis of the complex
combination). Type I error rate control is achieved through Bayesian
False Discovery Rate control.  The 3 main functions of the package
GetHinfo(), qch.fit() and qch.test() correspond to the 3 steps for
querying a composed hypothesis (composed H0/H1 formulation, inferring
the null distribution and testing the null hypothesis).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Tristan Mary-Huard <a href="mailto:tristan.mary-huard@agroparistech.fr">tristan.mary-huard@agroparistech.fr</a> (<a href="https://orcid.org/0000-0002-3839-9067">ORCID</a>)
</p>

<hr>
<h2 id='qch.fit'>Infer Hconfig posteriors</h2><span id='topic+qch.fit'></span>

<h3>Description</h3>

<p>Infer Hconfig posteriors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qch.fit(pValMat, Hconfig, plotting = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qch.fit_+3A_pvalmat">pValMat</code></td>
<td>
<p>a matrix of p-values, each column corresponding to a p-value serie.</p>
</td></tr>
<tr><td><code id="qch.fit_+3A_hconfig">Hconfig</code></td>
<td>
<p>an Hconfig list as generated by the <code><a href="#topic+GetHinfo">GetHinfo()</a></code> function.</p>
</td></tr>
<tr><td><code id="qch.fit_+3A_plotting">plotting</code></td>
<td>
<p>a boolean. Should some diagnostic graphs be plotted ? Default is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 2 objects 'prior' and 'posterior'.
Object 'prior' is a vector of estimated prior probabilities for each of the H-configurations.
Object 'posterior' is a matrix providing for each item (in row) its posterior probability to belong to each of the H-configurations (in columns).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PvalSets)
PvalMat &lt;- as.matrix(PvalSets[,-3])
## Build the Hconfig objects
Q &lt;- 2
AtLeast &lt;- 2
Hconfig &lt;- GetHinfo(Q,AtLeast)$Hconfig

## Run the function
res.fit &lt;- qch.fit(PvalMat,Hconfig)

## Display the prior of each class of items
res.fit$prior

## Display the first posteriors
head(res.fit$posterior)
</code></pre>

<hr>
<h2 id='qch.test'>Perform composed hypothesis testing with FDR control</h2><span id='topic+qch.test'></span>

<h3>Description</h3>

<p>Perform composed hypothesis testing with FDR control
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qch.test(posterior, Hconfig.H1, Alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qch.test_+3A_posterior">posterior</code></td>
<td>
<p>a matrix of posterior probabilities for each item to belong the different H-configurations, as provided by the <code><a href="#topic+qch.fit">qch.fit()</a></code> function.</p>
</td></tr>
<tr><td><code id="qch.test_+3A_hconfig.h1">Hconfig.H1</code></td>
<td>
<p>a list of H1 config, as created by the <code><a href="#topic+GetHinfo">GetHinfo()</a></code> function.</p>
</td></tr>
<tr><td><code id="qch.test_+3A_alpha">Alpha</code></td>
<td>
<p>the nominal Type I error rate for FDR control.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of 2 objects 'Rejection' and 'lFDR'.
Object 'Rejection' is a vector providing for each item the result of the composed hypothesis test, after multiple testing correction.
Object 'lFDR' is a vector providing for each item its local FDR estimate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(PvalSets)
PvalMat &lt;- as.matrix(PvalSets[,-3])
Truth &lt;- PvalSets[,3]

## Build the Hconfig objects
Q &lt;- 2
AtLeast &lt;- 2
Hconfig &lt;- GetHinfo(Q,AtLeast)$Hconfig
Hconfig.H1 &lt;- GetHinfo(Q,AtLeast)$Hconfig.H1

## Infer the posteriors
res.fit &lt;- qch.fit(PvalMat,Hconfig)

## Run the test procedure with FDR control
res.test &lt;- qch.test(res.fit$posterior,Hconfig.H1)
table(res.test$Rejection,Truth==4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
