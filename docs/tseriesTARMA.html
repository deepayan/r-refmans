<!DOCTYPE html><html lang="en"><head><title>Help for package tseriesTARMA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<script type="text/javascript" src="mathjax-config.js"></script>
<script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tseriesTARMA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tseriesTARMA'><p>tseriesTARMA: Analysis of Nonlinear Time Series through Threshold Autoregressive Moving Average Models (TARMA) models</p></a></li>
<li><a href='#ACValues'><p>Andrews Tabulated Critical Values</p></a></li>
<li><a href='#plot.tsfit'><p>Plot from fitted/forecasted time series models.</p></a></li>
<li><a href='#predict.TARMA'><p>Forecast from fitted TARMA models.</p></a></li>
<li><a href='#print.TARMA'><p>Methods for TARMA fits</p></a></li>
<li><a href='#print.TARMAtest'><p>Methods for TARMA tests</p></a></li>
<li><a href='#supLMQur'><p>Tabulated Critical Values for the Unit Root IMA vs TARMA test</p></a></li>
<li><a href='#TAR.test'><p>AR versus TARMA supLM robust test for nonlinearity</p></a></li>
<li><a href='#TAR.test.B'><p>AR versus TAR bootstrap supLM test for nonlinearity</p></a></li>
<li><a href='#TARMA.fit'><p>TARMA Modelling of Time Series</p></a></li>
<li><a href='#TARMA.fit2'><p>TARMA Modelling of Time Series</p></a></li>
<li><a href='#TARMA.sim'><p>Simulation of a two-regime <code>TARMA(p1,p2,q1,q2)</code> process</p></a></li>
<li><a href='#TARMA.test'><p>ARMA versus TARMA (and AR versus TAR) supLM tests for nonlinearity</p></a></li>
<li><a href='#TARMAGARCH.test'><p>ARMA GARCH versus TARMA GARCH supLM test for nonlinearity</p></a></li>
<li><a href='#TARMAur.test'><p>Unit root supLM test for an integrated MA versus a stationary TARMA process</p></a></li>
<li><a href='#TARMAur.test.B'><p>Unit root supLM test for an integrated MA versus a stationary TARMA process</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analysis of Nonlinear Time Series Through Threshold
Autoregressive Moving Average Models (TARMA) Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, stats, Rsolnp, lbfgsb3c, Matrix, Rdpack, mathjaxr,
rugarch, zoo, fitdistrplus</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack, mathjaxr</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for nonlinear time series analysis based on Threshold Autoregressive Moving Average (TARMA) models. It provides functions and methods for: TARMA model fitting and forecasting, including robust estimators, see Goracci et al. JBES (2025) &lt;<a href="https://doi.org/10.1080%2F07350015.2024.2412011">doi:10.1080/07350015.2024.2412011</a>&gt;; tests for threshold effects, see Giannerini et al. JoE (2024) &lt;<a href="https://doi.org/10.1016%2Fj.jeconom.2023.01.004">doi:10.1016/j.jeconom.2023.01.004</a>&gt;, Goracci et al. Statistica Sinica (2023) &lt;<a href="https://doi.org/10.5705%2Fss.202021.0120">doi:10.5705/ss.202021.0120</a>&gt;, Angelini et al. (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2308.00444">doi:10.48550/arXiv.2308.00444</a>&gt;;  unit-root tests based on TARMA models, see Chan et al. Statistica Sinica (2024) &lt;<a href="https://doi.org/10.5705%2Fss.202022.0125">doi:10.5705/ss.202022.0125</a>&gt;.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Simone Giannerini &lt;simone.giannerini@uniud.it&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-08 14:42:21 UTC; simone.giannerini2</td>
</tr>
<tr>
<td>Author:</td>
<td>Simone Giannerini <a href="https://orcid.org/0000-0002-0710-668X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Greta Goracci <a href="https://orcid.org/0000-0001-5212-0539"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-08 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tseriesTARMA'>tseriesTARMA: Analysis of Nonlinear Time Series through Threshold Autoregressive Moving Average Models (TARMA) models</h2><span id='topic+tseriesTARMA-package'></span><span id='topic+tseriesTARMA'></span>

<h3>Description</h3>

<p>It provides advanced functions for:
</p>

<ul>
<li><p> TARMA model fitting and forecasting:
</p>

<ul>
<li><p> Least Squares fitting of a full subset TARMA model, including robust LS fitting.
</p>
</li>
<li><p> Maximum Likelihood fitting of a subset TARMA model with common MA parts and possible covariates.
</p>
</li></ul>

</li>
<li><p> TARMA testing for threshold type nonlinearity:
</p>

<ul>
<li><p> Tests for AR vs TAR (asymptotic, bootstrap, wild bootstrap)
</p>
</li>
<li><p> Tests for ARMA vs TARMA with both i.i.d. errors and GARCH errors.
</p>
</li></ul>

</li>
<li><p> Unit-root testing against a stationary TARMA model
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G, Rahbek A (2024).
&ldquo;The validity of bootstrap testing in the threshold framework.&rdquo;
<em>Journal of Econometrics</em>, <b>239</b>(1), 105379.
ISSN 0304-4076, <a href="https://doi.org/10.1016/j.jeconom.2023.01.004">doi:10.1016/j.jeconom.2023.01.004</a>, Climate Econometrics.
</p>
</li>
<li> <p>Angelini F, Castellani M, Giannerini S, Goracci G (2023).
&ldquo;Testing for Threshold Effects in Presence of Heteroskedasticity and Measurement Error with an application to Italian Strikes.&rdquo;
University of Bologna and Free University of Bolzano.
2308.00444, <a href="https://arxiv.org/abs/2308.00444">https://arxiv.org/abs/2308.00444</a>.
</p>
</li>
<li> <p>Giannerini S, Goracci G, Rahbek A (2022).
&ldquo;The validity of bootstrap testing in the threshold framework.&rdquo;
<a href="https://doi.org/10.48550/ARXIV.2201.00028">doi:10.48550/ARXIV.2201.00028</a>, <a href="https://arxiv.org/abs/2201.00028">https://arxiv.org/abs/2201.00028</a>.
</p>
</li>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2021).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
University of Bologna, Free University of Bolzano, University of Iowa,  London School of Economics.
<a href="https://arxiv.org/abs/2103.13977">https://arxiv.org/abs/2103.13977</a>.
</p>
</li>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2023).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
<em>Statistica Sinica</em>, <b>33</b>(3), 1879-1901.
<a href="https://doi.org/10.5705/ss.202021.0120">doi:10.5705/ss.202021.0120</a>.
</p>
</li>
<li> <p>Chan K, Goracci G (2019).
&ldquo;On the Ergodicity of First-Order Threshold Autoregressive Moving-Average Processes.&rdquo;
<em>J. Time Series Anal.</em>, <b>40</b>(2), 256-264.
</p>
</li>
<li> <p>Chan K, Giannerini S, Goracci G, Tong H (2024).
&ldquo;Testing for threshold regulation in presence of measurement error.&rdquo;
<em>Statistica Sinica</em>, <b>34</b>(3), 1413-1434.
<a href="https://doi.org/10.5705/ss.202022.0125">doi:10.5705/ss.202022.0125</a>, <a href="https://doi.org/10.5705/ss.202022.0125">https://doi.org/10.5705/ss.202022.0125</a>.
</p>
</li></ul>


<hr>
<h2 id='ACValues'>Andrews Tabulated Critical Values</h2><span id='topic+ACValues'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>The data is taken from Table 1 of (Andrews 2003), which provides asymptotic critical
values for sup Wald, LM, and LR tests for parameter instability. Critical values are given for
degrees of freedom \(p=1,\dots,20\).
They can be used as asymptotic critical values for the following tests:
</p>

<ul>
<li> <p><code><a href="#topic+TAR.test">TAR.test</a></code>
</p>
</li>
<li> <p><code><a href="#topic+TARMA.test">TARMA.test</a></code>
</p>
</li>
<li> <p><code><a href="#topic+TARMAGARCH.test">TARMAGARCH.test</a></code>
</p>
</li></ul>

<p>Provided <code>pb = 1- pa</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ACValues
</code></pre>


<h3>Format</h3>



<h4><code>ACValues</code></h4>

<p>A matrix with 13 rows and 62 columns. The first two columns contain the parameters, whereas
the remaining 60 columns contain 3 critical values (at level 10%, 5%, and 1%) for each value of the
parameter \(p\):
</p>

<dl>
<dt><code>pi</code></dt><dd><p>\(\pi_0\) in the paper, corresponds to <code>pa</code>.</p>
</dd>
<dt><code>lambda</code></dt><dd><p>\(\lambda\) in the paper, not relevant here.</p>
</dd>
<dt><code>1-90</code></dt><dd><p>\(p=1\), critical level 10%.</p>
</dd>
<dt><code>1-95</code></dt><dd><p>\(p=1\), critical level 5%.</p>
</dd>
<dt><code>1-99</code></dt><dd><p>\(p=1\), critical level 1%.</p>
</dd>
</dl>
<p>...
</p>
<dl>
<dt><code>20-90</code></dt><dd><p>\(p=20\), critical level 10%.</p>
</dd>
<dt><code>20-95</code></dt><dd><p>\(p=20\), critical level 5%.</p>
</dd>
<dt><code>20-99</code></dt><dd><p>\(p=20\), critical level 1%.</p>
</dd>
</dl>

<p>Note that \(p\) are the degrees of freedom and correspond to the total number of tested parameter
in the above tests.
</p>



<h3>Source</h3>

<p>Andrews DWK (2003).
&ldquo;Tests for Parameter Instability and Structural Change with Unknown Change Point: A Corrigendum.&rdquo;
<em>Econometrica</em>, <b>71</b>(1), 395-397.
<a href="https://doi.org/10.1111/1468-0262.00405">doi:10.1111/1468-0262.00405</a>.
</p>

<hr>
<h2 id='plot.tsfit'>Plot from fitted/forecasted time series models.</h2><span id='topic+plot.tsfit'></span>

<h3>Description</h3>

<p>Plots a time series model fit, possibly together with its forecast and forecast bands.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'tsfit'
plot(
  x,
  fit,
  plot.fit = TRUE,
  fore = NULL,
  lcols = list(series = "lightblue", fit = 4, pred = "red4", band = "red"),
  ptype = list(series = 20, fit = 1, pred = 16, band = 20),
  ltype = list(series = 1, fit = 1, pred = 1, band = 1),
  lwdt = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.tsfit_+3A_x">x</code></td>
<td>
<p>A time series</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_fit">fit</code></td>
<td>
<p>A time series model fitted upon <code>x</code>, e.g. an object obtained with <code>TARMA.fit</code></p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_plot.fit">plot.fit</code></td>
<td>
<p>Logical. If <code>TRUE</code> adds the fitted values from the model.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_fore">fore</code></td>
<td>
<p>Forecast derived from <code>fit</code>, e.g. an object obtained with <code>predict.TARMA</code>
if not null it adds the prediction together with its confidence bands.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_lcols">lcols</code></td>
<td>
<p>List of colours for the plots.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_ptype">ptype</code></td>
<td>
<p>List of point types (<code>pch</code>) for the plots.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_ltype">ltype</code></td>
<td>
<p>List of line types (<code>lty</code>) for the plots.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_lwdt">lwdt</code></td>
<td>
<p>A common line width for the plots.</p>
</td></tr>
<tr><td><code id="plot.tsfit_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TARMA.fit">TARMA.fit</a></code> and <code><a href="#topic+TARMA.fit2">TARMA.fit2</a></code> for TARMA modelling.
<code><a href="#topic+predict.TARMA">predict.TARMA</a></code> for prediction and forecasting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) model
set.seed(13)
x    &lt;- TARMA.sim(n=200, phi1=c(0.5,-0.5), phi2=c(0.0,0.5), theta1=-0.5, theta2=0.7, d=1, thd=0.2)
fit1 &lt;- TARMA.fit(x,tar1.lags = 1, tar2.lags = 1, tma1.lags = 1, tma2.lags = 1, d=1, threshold=0.2)
xp1  &lt;- predict(fit1,x,n.ahead=5)

# plots both the fitted and the forecast
plot.tsfit(x,fit=fit1,fore=xp1);grid();

# plots only the forecast
plot.tsfit(x,fit=fit1,plot.fit=FALSE,fore=xp1);grid();

# plots only the fitted
plot.tsfit(x,fit=fit1);grid();

</code></pre>

<hr>
<h2 id='predict.TARMA'>Forecast from fitted TARMA models.</h2><span id='topic+predict.TARMA'></span>

<h3>Description</h3>

<p>Forecasting with TARMA models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TARMA'
predict(
  object,
  x,
  n.ahead = 0,
  n.sim = 1000,
  quant = c(0.05, 0.95),
  pred.matrix = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.TARMA_+3A_object">object</code></td>
<td>
<p>A <code>TARMA</code> fit upon x.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_x">x</code></td>
<td>
<p>The fitted time series.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_n.ahead">n.ahead</code></td>
<td>
<p>The number of steps ahead for which prediction is required.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_n.sim">n.sim</code></td>
<td>
<p>The number of Monte Carlo replications used to simulate the prediction density.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_quant">quant</code></td>
<td>
<p>Vector of quantiles (in the interval <code>[0, 1]</code>) to be computed upon the prediction density.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_pred.matrix">pred.matrix</code></td>
<td>
<p>Logical. if <code>TRUE</code> prints also the whole simulated prediction density for each prediction horizon from <code>1</code> to <code>n.ahead</code>.</p>
</td></tr>
<tr><td><code id="predict.TARMA_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>n.ahead = 0</code> it gives the fitted values from the model.
If the fit is from <code>TARMA.fit2</code> and includes covariates, these are ignored.
</p>


<h3>Value</h3>

<p>A list with components <code>pred.matrix</code>, <code>pred</code>, and <code>pred.interval</code>. The latter two are <code>ts</code> objects that contain the prediction and the quantiles of the prediction density, respectively.
If <code>pred.matrix = TRUE</code> then the prediction density from which the quantiles are computed is also returned.
</p>


<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMA.fit">TARMA.fit</a></code> and <code><a href="#topic+TARMA.fit2">TARMA.fit2</a></code> for TARMA modelling. <code><a href="#topic+plot.tsfit">plot.tsfit</a></code> for plotting TARMA fits and forecasts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) model
set.seed(13)
x1   &lt;- TARMA.sim(n=200, phi1=c(0.5,-0.5), phi2=c(0.0,0.5), theta1=-0.5, theta2=0.7, d=1, thd=0.2)
fit1 &lt;- TARMA.fit(x1, method='L-BFGS-B',tar1.lags = 1, tar2.lags = 1, tma1.lags = 1, 
        tma2.lags = 1, d=1, threshold=0.2)
xp1  &lt;- predict(fit1,x1,n.ahead=2)
xp1
</code></pre>

<hr>
<h2 id='print.TARMA'>Methods for TARMA fits</h2><span id='topic+print.TARMA'></span><span id='topic+coef.TARMA'></span><span id='topic+vcov.TARMA'></span><span id='topic+residuals.TARMA'></span>

<h3>Description</h3>

<p>Methods for TARMA fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TARMA'
print(x, digits = max(3L, getOption("digits") - 3L), se = TRUE, ...)

## S3 method for class 'TARMA'
coef(object, ...)

## S3 method for class 'TARMA'
vcov(object, ...)

## S3 method for class 'TARMA'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.TARMA_+3A_x">x</code></td>
<td>
<p>A <code>TARMA</code> fit.</p>
</td></tr>
<tr><td><code id="print.TARMA_+3A_digits">digits</code></td>
<td>
<p>Number of decimal digits for the output.</p>
</td></tr>
<tr><td><code id="print.TARMA_+3A_se">se</code></td>
<td>
<p>Logical. if <code>TRUE</code> (the default) prints also the standard errors.</p>
</td></tr>
<tr><td><code id="print.TARMA_+3A_...">...</code></td>
<td>
<p>Further parameters.</p>
</td></tr>
<tr><td><code id="print.TARMA_+3A_object">object</code></td>
<td>
<p>A <code>TARMA</code> fit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>See Also</h3>

<p><code><a href="#topic+TARMA.fit">TARMA.fit</a></code> and <code><a href="#topic+TARMA.fit2">TARMA.fit2</a></code> for TARMA modelling, <code><a href="#topic+plot.tsfit">plot.tsfit</a></code> for plotting TARMA fits and forecasts.
</p>

<hr>
<h2 id='print.TARMAtest'>Methods for TARMA tests</h2><span id='topic+print.TARMAtest'></span>

<h3>Description</h3>

<p>Methods for TARMA tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TARMAtest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.TARMAtest_+3A_x">x</code></td>
<td>
<p>A <code>TARMAtest</code> object.</p>
</td></tr>
<tr><td><code id="print.TARMAtest_+3A_...">...</code></td>
<td>
<p>Further parameters passed to <code><a href="stats.html#topic+print.htest">print.htest</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Print method for <code>TARMAtest</code> objects. Prints the results using the method for class <code>htest</code>
and adds critical values extracted from <code><a href="#topic+ACValues">ACValues</a></code> for the test for threshold nonlinearity
and <code><a href="#topic+supLMQur">supLMQur</a></code> for the unit root test against the TARMA alternative.
Note that the bootstrap version of the tests also print the bootstrap p-value.
</p>


<h3>Value</h3>

<p>No return value, called for side effects
</p>


<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+print.htest">print.htest</a></code>
</p>

<hr>
<h2 id='supLMQur'>Tabulated Critical Values for the Unit Root IMA vs TARMA test</h2><span id='topic+supLMQur'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>The data provides asymptotic null critical
values for the unit root supLM test described in (Chan et al. 2024).
They are used with the following tests:
</p>

<ul>
<li> <p><code><a href="#topic+TARMAur.test">TARMAur.test</a></code>
</p>
</li>
<li> <p><code><a href="#topic+TARMAur.test.B">TARMAur.test.B</a></code>
</p>
</li></ul>

<p>Provided <code>pb = 1- pa</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supLMQur
</code></pre>


<h3>Format</h3>



<h4><code>supLMQur</code></h4>

<p>A 4-dimensional array that contains 4 critical values (at level 10%, 5%, 1%, 0.1%)
for each combination of
</p>

<dl>
<dt><code>pa</code></dt><dd><p>Lower bound for the threshold range. From 0.01 to 0.4</p>
</dd>
<dt><code>th</code></dt><dd><p>MA(1) parameter.</p>
</dd>
<dt><code>n</code></dt><dd><p>Sample size.</p>
</dd>
</dl>




<h3>Source</h3>

<p>Chan K, Giannerini S, Goracci G, Tong H (2024).
&ldquo;Testing for threshold regulation in presence of measurement error.&rdquo;
<em>Statistica Sinica</em>, <b>34</b>(3), 1413-1434.
<a href="https://doi.org/10.5705/ss.202022.0125">doi:10.5705/ss.202022.0125</a>, <a href="https://doi.org/10.5705/ss.202022.0125">https://doi.org/10.5705/ss.202022.0125</a>.
</p>

<hr>
<h2 id='TAR.test'>AR versus TARMA supLM robust test for nonlinearity</h2><span id='topic+TAR.test'></span>

<h3>Description</h3>

<p>Heteroskedasticity robust supremum Lagrange Multiplier test for a AR specification versus
a TAR specification. Includes the classic (non robust) AR versus TAR test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TAR.test(x, pa = 0.25, pb = 0.75, ar.ord, d = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TAR.test_+3A_x">x</code></td>
<td>
<p>A univariate time series.</p>
</td></tr>
<tr><td><code id="TAR.test_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TAR.test_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TAR.test_+3A_ar.ord">ar.ord</code></td>
<td>
<p>Order of the AR part.</p>
</td></tr>
<tr><td><code id="TAR.test_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements a heteroskedasticity robust asymptotic supremum Lagrange Multiplier test to test an AR specification versus a TAR specification.
This is an asymptotic test and the value of the test statistic has to be compared with the critical values tabulated
in (Goracci et al. 2021) or (Andrews 2003).
Both the non-robust <code>supLM</code> and the robust <code>supLMh</code> statistics are returned.
</p>


<h3>Value</h3>

<p>An object of class <code>TARMAtest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>A named vector with the values of the classic <code>supLM</code> and robust <code>supLMh</code> statistics.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximises the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Matrix of values of the LM statistic for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit</code></dt><dd><p>The null model: AR fit over <code>x</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the AR fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>prop</code></dt><dd><p>Proportion of values of the series that fall in the lower regime.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The p-value of the test. It is <code>NULL</code> for the asymptotic test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>d</code></dt><dd><p>The delay parameter.</p>
</dd>
<dt><code>pa</code></dt><dd><p>Lower threshold quantile.</p>
</dd>
<dt><code>dfree</code></dt><dd><p>Effective degrees of freedom. It is the number of tested parameters.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2023).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
<em>Statistica Sinica</em>, <b>33</b>(3), 1879-1901.
<a href="https://doi.org/10.5705/ss.202021.0120">doi:10.5705/ss.202021.0120</a>.
</p>
</li>
<li> <p>Andrews DWK (2003).
&ldquo;Tests for Parameter Instability and Structural Change with Unknown Change Point: A Corrigendum.&rdquo;
<em>Econometrica</em>, <b>71</b>(1), 395-397.
<a href="https://doi.org/10.1111/1468-0262.00405">doi:10.1111/1468-0262.00405</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TAR.test.B">TAR.test.B</a></code> for the bootstrap version of the test.
<code><a href="#topic+TARMA.test">TARMA.test</a></code> for the (robust) ARMA vs TARMA asymptotic version of the test, which includes also the AR vs TAR test, with different defaults.
<code><a href="#topic+TARMAGARCH.test">TARMAGARCH.test</a></code> for the robust version of the ARMA vs TARMA test that assumes GARCH innovations.
<code><a href="#topic+TARMA.sim">TARMA.sim</a></code> to simulate from a TARMA process.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
## a TAR(1,1) ---------------
x1   &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0, theta2=0, d=1, thd=0.2)
TAR.test(x1, ar.ord=1, d=1)

## a AR(1)    ----------------
x2   &lt;- arima.sim(n=100, model=list(order=c(1,0,0), ar=0.5))
TAR.test(x2, ar.ord=1, d=1)


</code></pre>

<hr>
<h2 id='TAR.test.B'>AR versus TAR bootstrap supLM test for nonlinearity</h2><span id='topic+TAR.test.B'></span>

<h3>Description</h3>

<p>Implements various bootstrap supremum Lagrange Multiplier tests for a AR specification versus
a TAR specification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TAR.test.B(
  x,
  B = 1000,
  pa = 0.25,
  pb = 0.75,
  ar.ord,
  d = 1,
  btype = c("iid", "wb.h", "wb.r", "wb.n"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TAR.test.B_+3A_x">x</code></td>
<td>
<p>A univariate time series.</p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_b">B</code></td>
<td>
<p>Integer. Number of bootstrap resamples. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_ar.ord">ar.ord</code></td>
<td>
<p>Order of the AR part.</p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_btype">btype</code></td>
<td>
<p>Bootstrap type, can be one of <code>'iid','wb.h','wb.r','wb.n'</code>, see Details.</p>
</td></tr>
<tr><td><code id="TAR.test.B_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>arima</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the bootstrap version of <code><a href="#topic+TAR.test">TAR.test</a></code> the supremum Lagrange Multiplier test to test an AR specification versus a TARMA specification.
The option <code>btype</code> specifies the type of bootstrap as follows:
</p>

<dl>
<dt><code>iid</code></dt><dd><p>Residual iid bootstrap. See (Giannerini et al. 2022), (Giannerini et al. 2024).</p>
</dd>
<dt><code>wb.h</code></dt><dd><p>Stochastic permutation of (Hansen 1996).</p>
</dd>
<dt><code>wb.r</code></dt><dd><p>Residual wild bootstrap with Rademacher auxiliary distribution. See (Giannerini et al. 2022), (Giannerini et al. 2024).</p>
</dd>
<dt><code>wb.n</code></dt><dd><p>Residual wild bootstrap with Normal auxiliary distribution. See (Giannerini et al. 2022), (Giannerini et al. 2024).</p>
</dd>
</dl>



<h3>Value</h3>

<p>A list of class <code>htest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>The value of the supLM statistic.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximises the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Vector of values of the LM statistic for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit</code></dt><dd><p>The null model: AR fit over <code>x</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the AR fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>prop</code></dt><dd><p>Proportion of values of the series that fall in the lower regime.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The bootstrap p-value of the test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>Tb</code></dt><dd><p>The bootstrap null distribution.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G, Rahbek A (2022).
&ldquo;The validity of bootstrap testing in the threshold framework.&rdquo;
<a href="https://doi.org/10.48550/ARXIV.2201.00028">doi:10.48550/ARXIV.2201.00028</a>, <a href="https://arxiv.org/abs/2201.00028">https://arxiv.org/abs/2201.00028</a>.
</p>
</li>
<li> <p>Giannerini S, Goracci G, Rahbek A (2024).
&ldquo;The validity of bootstrap testing in the threshold framework.&rdquo;
<em>Journal of Econometrics</em>, <b>239</b>(1), 105379.
ISSN 0304-4076, <a href="https://doi.org/10.1016/j.jeconom.2023.01.004">doi:10.1016/j.jeconom.2023.01.004</a>, Climate Econometrics.
</p>
</li>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2023).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
<em>Statistica Sinica</em>, <b>33</b>(3), 1879-1901.
<a href="https://doi.org/10.5705/ss.202021.0120">doi:10.5705/ss.202021.0120</a>.
</p>
</li>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li>
<li> <p>Hansen BE (1996).
&ldquo;Inference When a Nuisance Parameter Is Not Identified Under the Null Hypothesis.&rdquo;
<em>Econometrica</em>, <b>64</b>(2), 413&ndash;430.
ISSN 00129682, 14680262, <a href="https://doi.org/10.2307/2171789">https://doi.org/10.2307/2171789</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TAR.test">TAR.test</a></code> for the heteroskedastic robust asymptotic test.  <code><a href="#topic+TARMAGARCH.test">TARMAGARCH.test</a></code> for the
robust version of the test with respect to GARCH innovations. <code><a href="#topic+TARMA.sim">TARMA.sim</a></code> to simulate from a TARMA process.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TAR(1,1) where the threshold effect is on the AR parameters
set.seed(123)
x1 &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0, theta2=0, d=1, thd=0.2)
TAR.test.B(x1, ar.ord=1, d=1)
TAR.test.B(x1, ar.ord=1, d=1, btype='wb.r')
TAR.test.B(x1, ar.ord=1, d=1, btype='wb.h')

## a AR(1)
x2 &lt;- arima.sim(n=100, model=list(order = c(1,0,0),ar=0.5))
TAR.test.B(x2, ar.ord=1, d=1)
TAR.test.B(x2, ar.ord=1, d=1, btype='wb.r')
TAR.test.B(x2, ar.ord=1, d=1, btype='wb.h')

</code></pre>

<hr>
<h2 id='TARMA.fit'>TARMA Modelling of Time Series</h2><span id='topic+TARMA.fit'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Implements a Least Squares fit of full subset two-regime <code>TARMA(p1,p2,q1,q2)</code> model to a univariate time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMA.fit(
  x,
  tar1.lags = c(1),
  tar2.lags = c(1),
  tma1.lags = c(1),
  tma2.lags = c(1),
  threshold = NULL,
  d = 1,
  pa = 0.25,
  pb = 0.75,
  method = c("L-BFGS-B", "solnp", "lbfgsb3c", "robust", "trimmed"),
  alpha = 0,
  qu = c(0.05, 0.95),
  innov = c("norm", "student"),
  optim.control = list(trace = 0),
  irls.control = list(maxiter = 100, tol = 1e-04),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMA.fit_+3A_x">x</code></td>
<td>
<p>A univariate time series.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_tar1.lags">tar1.lags</code></td>
<td>
<p>Vector of AR lags for the lower regime. It can be a subset of <code>1 ... p1 = max(tar1.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_tar2.lags">tar2.lags</code></td>
<td>
<p>Vector of AR lags for the upper regime. It can be a subset of <code>1 ... p2 = max(tar2.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_tma1.lags">tma1.lags</code></td>
<td>
<p>Vector of MA lags for the lower regime. It can be a subset of <code>1 ... q1 = max(tma1.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_tma2.lags">tma2.lags</code></td>
<td>
<p>Vector of MA lags for the upper regime. It can be a subset of <code>1 ... q2 = max(tma2.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_threshold">threshold</code></td>
<td>
<p>Threshold parameter. If <code>NULL</code> estimates the threshold over the threshold range specified by
<code>pa</code> and <code>pb</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_method">method</code></td>
<td>
<p>Optimization/fitting method, can be one of <code>"L-BFGS-B", "solnp", "lbfgsb3c", "robust", "trimmed"</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_alpha">alpha</code></td>
<td>
<p>Real positive number. Tuning parameter for robust estimation. Only used if <code>method</code> is <code>robust</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_qu">qu</code></td>
<td>
<p>Quantiles for (initial) trimmed estimation. Tuning parameter for robust estimation. Only used if <code>method</code> is either <code>robust</code> or <code>trimmed</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_innov">innov</code></td>
<td>
<p>Innovation density for robust estimation. can be one of <code>"norm", "student"</code>. Only used if <code>method</code> is <code>"robust"</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_optim.control">optim.control</code></td>
<td>
<p>List of control parameters for the main optimization method.</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_irls.control">irls.control</code></td>
<td>
<p>List of control parameters for the irls optimization method (see details).</p>
</td></tr>
<tr><td><code id="TARMA.fit_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the Least Squares fit of the following two-regime <code>TARMA(p1,p2,q1,q2)</code> process: <br />
\[X_{t} = \left\lbrace
    \begin{array}{ll}
\phi_{1,0} + \sum_{i \in I_1} \phi_{1,i} X_{t-i} + \sum_{j \in M_1} \theta_{1,j} \varepsilon_{t-j} + \varepsilon_{t} & \mathrm{if } X_{t-d} \leq \mathrm{thd} \\
 &\\
\phi_{2,0} + \sum_{i \in I_2} \phi_{2,i} X_{t-i} + \sum_{j \in M_2} \theta_{2,j} \varepsilon_{t-j} + \varepsilon_{t} & \mathrm{if } X_{t-d} > \mathrm{thd}
\end{array}
\right. \]
where  \(\phi_{1,i}\) and \(\phi_{2,i}\) are the TAR parameters for the lower and upper regime, respectively, and
<code>I1 = tar1.lags</code> and <code>I2 = tar2.lags</code> are the corresponding vectors of TAR lags.
\(\theta_{1,j}\) and \(\theta_{2,j}\) are the TMA parameters
and \(j \in M_1, M_2\), where <code>M1 = tma1.lags</code> and <code>M2 = tma2.lags</code>, are the vectors of TMA lags. <br />
The most demanding routines have been reimplemented in Fortran and dynamically loaded.
</p>


<h3>Value</h3>

<p>A list of class <code>TARMA</code> with components:
</p>

<ul>
<li> <p><code>fit</code> - List with the following components <br />
</p>

<ul>
<li> <p><code>coef</code> - Vector of estimated parameters which can be extracted by the coef method.
</p>
</li>
<li> <p><code>sigma2</code> - Estimated innovation variance.
</p>
</li>
<li> <p><code>var.coef</code> - The estimated variance matrix of the coefficients coef, which can be extracted by the vcov method
</p>
</li>
<li> <p><code>residuals</code> - Vector of residuals from the fit.
</p>
</li>
<li> <p><code>nobs</code> - Effective sample size used for fitting the model.
</p>
</li></ul>

</li>
<li> <p><code>se</code> - Standard errors for the parameters. Note that they are computed conditionally upon the threshold so that they are generally smaller than the true ones.
</p>
</li>
<li> <p><code>thd</code>    - Estimated threshold.
</p>
</li>
<li> <p><code>aic</code>    - Value of the AIC for the minimised least squares criterion over the threshold range.
</p>
</li>
<li> <p><code>bic</code>    - Value of the BIC for the minimised least squares criterion over the threshold range.
</p>
</li>
<li> <p><code>rss</code>    - Minimised value of the target function. Coincides with the residual sum of squares for ordinary least squares estimation.
</p>
</li>
<li> <p><code>rss.v</code>  - Vector of values of the rss over the threshold range.
</p>
</li>
<li> <p><code>thd.range</code> - Vector of values of the threshold range.
</p>
</li>
<li> <p><code>d</code>      - Delay parameter.
</p>
</li>
<li> <p><code>phi1</code>   - Estimated AR parameters for the lower regime.
</p>
</li>
<li> <p><code>phi2</code>   - Estimated AR parameters for the upper regime.
</p>
</li>
<li> <p><code>theta1</code> - Estimated MA parameters for the lower regime.
</p>
</li>
<li> <p><code>theta2</code> - Estimated MA parameters for the upper regime.
</p>
</li>
<li> <p><code>tlag1</code>  - TAR lags for the lower regime
</p>
</li>
<li> <p><code>tlag2</code>  - TAR lags for the upper regime
</p>
</li>
<li> <p><code>mlag1</code>  - TMA lags for the lower regime
</p>
</li>
<li> <p><code>mlag2</code>  - TMA lags for the upper regime
</p>
</li>
<li> <p><code>method</code> - Estimation method.
</p>
</li>
<li> <p><code>innov</code>  - Innovation density model.
</p>
</li>
<li> <p><code>alpha</code>  - Tuning parameter for robust estimation.
</p>
</li>
<li> <p><code>qu</code>     - Tuning parameter for robust estimation.
</p>
</li>
<li> <p><code>call</code>   - The matched call.
</p>
</li>
<li> <p><code>convergence</code> - Convergence code from the optimization routine.
</p>
</li>
<li> <p><code>innovpar</code> - Parameter vector for the innovation density. Defaults to <code>NULL</code>.
</p>
</li></ul>



<h3>Fitting methods</h3>

<p><code>method</code> has the following options: <br />
</p>

<dl>
<dt><code>L-BFGS-B</code></dt><dd><p>Calls the corresponding method of <code><a href="stats.html#topic+optim">optim</a></code>. Linear ergodicity constraints are imposed.</p>
</dd>
<dt><code>solnp</code></dt><dd><p>Calls the function <code><a href="Rsolnp.html#topic+solnp">solnp</a></code>. It is a nonlinear optimization using augmented Lagrange method with
linear and nonlinear inequality bounds. This allows to impose all the ergodicity constraints so that in theory it always
return an ergodic solution. In practice the solution should be checked since this is a local solver and there is no guarantee
that the minimum has been reached.</p>
</dd>
<dt><code>lbfgsb3c</code></dt><dd><p>Calls the function <code><a href="lbfgsb3c.html#topic+lbfgsb3c">lbfgsb3c</a></code> in package <code>lbfgsb3c</code>. Improved version of the L-BFGS-B in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>robust</code></dt><dd><p>Robust M-estimator of Ferrari and La Vecchia (Ferrari and La-Vecchia 2011). Based on the L-BFGS-B in <code><a href="stats.html#topic+optim">optim</a></code> and an additional iterative re-weighted least squares step to estimate the robust weights.
Uses the tuning parameters <code>alpha</code> and <code>qu</code>. Robust standard errors are derived from the sandwich estimator of the variance/covariance matrix of the estimates.
The IRLS step can be controlled through the parameters <code>maxiter</code> (maximum number of iterations) and <code>tol</code> (target tolerance). These can be passed using <code>irls.control</code>.</p>
</dd>
<dt><code>trimmed</code></dt><dd><p>Experimental: Estimator based on trimming the sample using the tuning parameters <code>qu</code> (lower and upper quantile).</p>
</dd>
</dl>

<p>Where possible, the conditions for ergodicity and invertibility are imposed to the optimization routines but there is no guarantee that the solution will be ergodic and invertible so that it is
advisable to check the fitted parameters.
</p>


<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li>
<li> <p>Chan K, Goracci G (2019).
&ldquo;On the Ergodicity of First-Order Threshold Autoregressive Moving-Average Processes.&rdquo;
<em>J. Time Series Anal.</em>, <b>40</b>(2), 256-264.
</p>
</li>
<li> <p>Goracci G, Ferrari D, Giannerini S, Ravazzolo F (2023).
&ldquo;Robust estimation for Threshold Autoregressive Moving-Average models.&rdquo;
Free University of Bolzano, University of Bologna.
<a href="https://doi.org/10.48550/ARXIV.2211.08205">doi:10.48550/ARXIV.2211.08205</a>.
</p>
</li>
<li> <p>Ferrari D, La-Vecchia D (2011).
&ldquo;On robust estimation via pseudo-additive information.&rdquo;
<em>Biometrika</em>, <b>99</b>(1), 238-244.
ISSN 0006-3444, <a href="https://doi.org/10.1093/biomet/asr061">doi:10.1093/biomet/asr061</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMA.fit2">TARMA.fit2</a></code> for Maximum Likelihood estimation of TARMA
models with common MA part. <code><a href="#topic+print.TARMA">print.TARMA</a></code> for print methods for <code>TARMA</code> fits.
<code><a href="#topic+predict.TARMA">predict.TARMA</a></code> for prediction and forecasting. <code><a href="#topic+plot.tsfit">plot.tsfit</a></code> for plotting TARMA fits and forecasts.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## a TARMA(1,1,1,1) model
set.seed(13)
x    &lt;- TARMA.sim(n=200, phi1=c(0.5,-0.5), phi2=c(0.0,0.5), theta1=-0.5, theta2=0.7, d=1, thd=0.2)
fit1 &lt;- TARMA.fit(x,tar1.lags=1, tar2.lags=1, tma1.lags=1, tma2.lags=1, d=1)

## --------------------------------------------------------------------------
## In the following examples the threshold is fixed to speed up computations
## --------------------------------------------------------------------------

## --------------------------------------------------------------------------
## Least Squares fit
## --------------------------------------------------------------------------

set.seed(26)
n    &lt;- 200
y    &lt;- TARMA.sim(n=n, phi1=c(0.6,0.6), phi2=c(-1.0,0.4), theta1=-0.7, theta2=0.5, d=1, thd=0.2)

fit1 &lt;- TARMA.fit(y,tar1.lags=1, tar2.lags=1, tma1.lags=1, tma2.lags=1, d=1, threshold=0.2)
fit1

## ---------------------------------------------------------------------------
## Contaminate the data with one additive outlier
## ---------------------------------------------------------------------------
x     &lt;- y           # contaminated series
x[54] &lt;- x[54] + 10

## ---------------------------------------------------------------------------
## Compare the non-robust LS fit with the robust fit
## ---------------------------------------------------------------------------

fitls  &lt;- TARMA.fit(x,tar1.lags=1, tar2.lags=1, tma1.lags=1, tma2.lags=1, d=1, threshold=0.2)
fitrob &lt;- TARMA.fit(x,tar1.lags=1, tar2.lags=1, tma1.lags=1, tma2.lags=1, d=1,
            method='robust',alpha=0.7,qu=c(0.1,0.95), threshold=0.2)

par.true &lt;- c(0.6,0.6,-1,0.4,-0.7,0.5)
pnames   &lt;- c("int.1", "ar1.1", "int.2", "ar2.1", "ma1.1", "ma2.1")
names(par.true) &lt;- pnames

par.ls  &lt;- round(fitls$fit$coef,2)  # Least Squares
par.rob &lt;- round(fitrob$fit$coef,2) # robust

rbind(par.true,par.ls,par.rob)
</code></pre>

<hr>
<h2 id='TARMA.fit2'>TARMA Modelling of Time Series</h2><span id='topic+TARMA.fit2'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Maximum Likelihood fit of a two-regime <code>TARMA(p1,p2,q,q)</code>
model with common MA parameters, possible common AR parameters and possible covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMA.fit2(
  x,
  ar.lags = NULL,
  tar1.lags = c(1),
  tar2.lags = c(1),
  ma.ord = 1,
  sma.ord = 0L,
  period = NA,
  threshold = NULL,
  d = 1,
  pa = 0.25,
  pb = 0.75,
  thd.var = NULL,
  include.int = TRUE,
  x.reg = NULL,
  optim.control = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMA.fit2_+3A_x">x</code></td>
<td>
<p>A univariate time series.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_ar.lags">ar.lags</code></td>
<td>
<p>Vector of common AR lags. Defaults to <code>NULL</code>. It can be a subset of lags.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_tar1.lags">tar1.lags</code></td>
<td>
<p>Vector of AR lags for the lower regime. It can be a subset of <code>1 ... p1 = max(tar1.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_tar2.lags">tar2.lags</code></td>
<td>
<p>Vector of AR lags for the upper regime. It can be a subset of <code>1 ... p2 = max(tar2.lags)</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_ma.ord">ma.ord</code></td>
<td>
<p>Order of the MA part (also called <code>q</code> below).</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_sma.ord">sma.ord</code></td>
<td>
<p>Order of the seasonal MA part (also called <code>Q</code> below).</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_period">period</code></td>
<td>
<p>Period of the seasonal MA part (also called <code>s</code> below).</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_threshold">threshold</code></td>
<td>
<p>Threshold parameter. If <code>NULL</code> estimates the threshold over the threshold range specified by
<code>pa</code> and <code>pb</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_thd.var">thd.var</code></td>
<td>
<p>Optional exogenous threshold variable. If <code>NULL</code> it is set to <code>lag(x,-d)</code>.
If not <code>NULL</code> it has to be a <code>ts</code> object.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_include.int">include.int</code></td>
<td>
<p>Logical. If <code>TRUE</code> includes the intercept terms in both regimes, a common intercept is included otherwise.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_x.reg">x.reg</code></td>
<td>
<p>Covariates to be included in the model. These are passed to <code>arima</code>. If they are not <code>ts</code> objects they must have the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_optim.control">optim.control</code></td>
<td>
<p>List of control parameters for the optimization method.</p>
</td></tr>
<tr><td><code id="TARMA.fit2_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>arima</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits the following two-regime <code>TARMA</code> process with optional components: linear <code>AR</code> part, seasonal <code>MA</code> and covariates. <br />
\[X_{t} = \phi_{0} + \sum_{h \in I} \phi_{h} X_{t-h} + \sum_{l=1}^Q \Theta_{l} \epsilon_{t-ls} + \sum_{j=1}^q \theta_{j} \epsilon_{t-j} + \sum_{k=1}^K \delta_{k} Z_{k} + \epsilon_{t} + \left\lbrace
    \begin{array}{ll}
\phi_{1,0} + \sum_{i \in I_1} \phi_{1,i} X_{t-i}   & \mathrm{if } X_{t-d} \leq \mathrm{thd} \\
 &\\
\phi_{2,0} + \sum_{i \in I_2} \phi_{2,i} X_{t-i}   & \mathrm{if } X_{t-d} > \mathrm{thd}
\end{array}
\right. \]
</p>
<p>where \(\phi_h\) are the common AR parameters and \(h\) ranges in <code>I = ar.lags</code>. \(\theta_j\) are the common MA parameters and \(j = 1,\dots,q\)
(<code>q = ma.ord</code>), \(\Theta_l\) are the common seasonal MA parameters and \(l = 1,\dots,Q\) (<code>Q = sma.ord</code>)
\(\delta_k\) are the parameters for the covariates. Finally, \(\phi_{1,i}\) and \(\phi_{2,i}\) are the TAR parameters
for the lower and upper regime, respectively and <code>I1 = tar1.lags</code> <code>I2 = tar2.lags</code> are the vector of TAR lags.
</p>


<h3>Value</h3>

<p>A list of class <code>TARMA</code> with components:
</p>

<ul>
<li> <p><code>fit</code>    - The output of the fit. It is a <code>arima</code> object.
</p>
</li>
<li> <p><code>aic</code>    - Value of the AIC for the minimised least squares criterion over the threshold range.
</p>
</li>
<li> <p><code>bic</code>    - Value of the BIC for the minimised least squares criterion over the threshold range.
</p>
</li>
<li> <p><code>aic.v</code>  - Vector of values of the AIC over the threshold range.
</p>
</li>
<li> <p><code>thd.range</code> - Vector of values of the threshold range.
</p>
</li>
<li> <p><code>d</code>      - Delay parameter.
</p>
</li>
<li> <p><code>thd</code>    - Estimated threshold.
</p>
</li>
<li> <p><code>phi1</code>   - Estimated AR parameters for the lower regime.
</p>
</li>
<li> <p><code>phi2</code>   - Estimated AR parameters for the upper regime.
</p>
</li>
<li> <p><code>theta1</code> - Estimated MA parameters for the lower regime.
</p>
</li>
<li> <p><code>theta2</code> - Estimated MA parameters for the upper regime.
</p>
</li>
<li> <p><code>delta</code>  - Estimated parameters for the covariates <code>x.reg</code>.
</p>
</li>
<li> <p><code>tlag1</code>  - TAR lags for the lower regime
</p>
</li>
<li> <p><code>tlag2</code>  - TAR lags for the upper regime
</p>
</li>
<li> <p><code>mlag1</code>  - TMA lags for the lower regime
</p>
</li>
<li> <p><code>mlag2</code>  - TMA lags for the upper regime
</p>
</li>
<li> <p><code>arlag</code>  -  Same as the input slot <code>ar.lags</code>
</p>
</li>
<li> <p><code>include.int</code> -  Same as the input slot <code>include.int</code>
</p>
</li>
<li> <p><code>se</code>     - Standard errors for the parameters. Note that they are computed conditionally upon the threshold so that they are generally smaller than the true ones.
</p>
</li>
<li> <p><code>rss</code>    - Minimised residual sum of squares.
</p>
</li>
<li> <p><code>method</code> - Estimation method.
</p>
</li>
<li> <p><code>call</code>   - The matched call.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li>
<li> <p>Chan K, Goracci G (2019).
&ldquo;On the Ergodicity of First-Order Threshold Autoregressive Moving-Average Processes.&rdquo;
<em>J. Time Series Anal.</em>, <b>40</b>(2), 256-264.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMA.fit">TARMA.fit</a></code> for Least Square estimation of full subset TARMA
models. <code><a href="#topic+print.TARMA">print.TARMA</a></code> for print methods for <code>TARMA</code> fits.
<code><a href="#topic+predict.TARMA">predict.TARMA</a></code> for prediction and forecasting.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1)
set.seed(127)
x    &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0,0.8), theta1=0.5, theta2=0.5, d=1, thd=0.2)
fit1 &lt;- TARMA.fit2(x, tar1.lags=1, tar2.lags=1, ma.ord=1, d=1)


## Showcase of the fit with covariates ---
## simulates from a TARMA(3,3,1,1) model with common MA parameter
## and common AR(1) and AR(2) parameters. Only the lag 3 parameter varies across regimes
set.seed(212)
n &lt;- 300
x &lt;- TARMA.sim(n=n, phi1=c(0.5,0.3,0.2,0.4), phi2=c(0.5,0.3,0.2,-0.2), theta1=0.4, theta2=0.4,
     d=1, thd=0.2, s1=1, s2=1)

## FIT 1: estimates lags 1,2,3 as threshold lags ---
fit1 &lt;- TARMA.fit2(x, ma.ord=1, tar1.lags=c(1,2,3), tar2.lags=c(1,2,3), d=1)

## FIT 2: estimates lags 1 and 2 as fixed AR and lag 3 as the threshold lag
fit2 &lt;- TARMA.fit2(x, ma.ord=1, tar1.lags=c(3),  tar2.lags=c(3), ar.lags=c(1,2), d=1)

## FIT 3: creates lag 1 and 2 and fits them as covariates ---
z1   &lt;- lag(x,-1)
z2   &lt;- lag(x,-2)
fit3 &lt;- TARMA.fit2(x, ma.ord=1,  tar1.lags=c(3), tar2.lags=c(3), x.reg=ts.intersect(z1,z2), d=1)

## FIT 4: estimates lag 1 as a covariate, lag 2 as fixed AR and lag 3 as the threshold lag
fit4 &lt;- TARMA.fit2(x, ma.ord = 1,  tar1.lags=c(3), tar2.lags=c(3), x.reg=z1, ar.lags=2, d=1)


</code></pre>

<hr>
<h2 id='TARMA.sim'>Simulation of a two-regime <code>TARMA(p1,p2,q1,q2)</code> process</h2><span id='topic+TARMA.sim'></span>

<h3>Description</h3>

<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script>
<p>Simulates from the following two-regime <code>TARMA(p1,p2,q1,q2)</code> process: <br />
</p>
\[X_{t} = \left\lbrace
\begin{array}{ll}
 \phi_{1,0} + \sum_{i=1}^{p_1} \phi_{1,i} X_{t-i} + \sum_{j=1}^{q_1} \theta_{1,j} \varepsilon_{t-j} + \varepsilon_{t}, & \quad\mathrm{if}\quad X_{t-d} \leq \mathrm{thd} \\
 &\\
 \phi_{2,0} + \sum_{i=1}^{p_2} \phi_{2,i} X_{t-i} + \sum_{j=1}^{q_2} \theta_{2,j} \varepsilon_{t-j} + \varepsilon_{t}, & \quad\mathrm{if}\quad X_{t-d} > \mathrm{thd}
\end{array}
\right.
\]


<h3>Usage</h3>

<pre><code class='language-R'>TARMA.sim(
  n,
  phi1,
  phi2,
  theta1,
  theta2,
  d = 1,
  thd = 0,
  s1 = 1,
  s2 = 1,
  rand.gen = rnorm,
  innov = rand.gen(n, ...),
  n.start = 500,
  xstart,
  start.innov = rand.gen(n.start, ...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMA.sim_+3A_n">n</code></td>
<td>
<p>Length of the series.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_phi1">phi1</code></td>
<td>
<p>Vector of <code>p1+1</code> Autoregressive parameters of the lower regime.
The first element is the intercept.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_phi2">phi2</code></td>
<td>
<p>Vector of <code>p2+1</code> Autoregressive parameters of the upper regime.
The first element is the intercept.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_theta1">theta1</code></td>
<td>
<p>Vector of <code>q1</code> Moving Average parameters of the lower regime.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_theta2">theta2</code></td>
<td>
<p>Vector of <code>q2</code> Moving Average parameters of the upper regime.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_thd">thd</code></td>
<td>
<p>Threshold parameter. Defaults to <code>0</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_s1">s1</code></td>
<td>
<p>Innovation variance for the lower regime. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_s2">s2</code></td>
<td>
<p>Innovation variance for the upper regime. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_rand.gen">rand.gen</code></td>
<td>
<p>Optional: a function to generate the innovations. Defaults to <code>rnorm</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_innov">innov</code></td>
<td>
<p>Optional: a time series of innovations. If not provided, <code>rand.gen</code> is used.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_n.start">n.start</code></td>
<td>
<p>Length of the burn-in period. Defaults to <code>500</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_xstart">xstart</code></td>
<td>
<p>Initial condition as a named list: <br />
<code>$ar</code>: AR part length <code>k = max(p1,p2,d),  X[k], X[k-1], ... ,X[1]</code>; <br />
<code>$ma</code>: MA part length <code>q = ma.ord,   e[q], ... , e[1]</code>.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_start.innov">start.innov</code></td>
<td>
<p>Optional: a time series of innovations for the burn-in period.</p>
</td></tr>
<tr><td><code id="TARMA.sim_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>rand.gen</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the parameters are not checked for ergodicity.
</p>


<h3>Value</h3>

<p>A time series object of class <code>ts</code> generated from the above model.
</p>


<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Giannerini S, Goracci G (2021).
&ldquo;Estimating and Forecasting with TARMA models.&rdquo;
University of Bologna.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) model
set.seed(123)
x &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=-0.5, theta2=0.5, d=1, thd=0.2)

## a TARMA(1,2,1,1) model
x &lt;- TARMA.sim(n=100,phi1=c(0.5,-0.5,0),phi2=c(0,0.5,0.3),theta1=-0.5,theta2=0.5,d=1,thd=0.2)

</code></pre>

<hr>
<h2 id='TARMA.test'>ARMA versus TARMA (and AR versus TAR) supLM tests for nonlinearity</h2><span id='topic+TARMA.test'></span>

<h3>Description</h3>

<p>Heteroskedasticity robust supremum Lagrange Multiplier tests for a ARMA specification versus
a TARMA specification. Includes the AR versus TAR test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMA.test(
  x,
  pa = 0.25,
  pb = 0.75,
  ar.ord,
  ma.ord,
  ma.fixed = TRUE,
  d,
  thd.range,
  method = "CSS-ML",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMA.test_+3A_x">x</code></td>
<td>
<p>A univariate time series, either a <code>ts</code> or <code>zoo</code> object.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_ar.ord">ar.ord</code></td>
<td>
<p>Order of the AR part.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_ma.ord">ma.ord</code></td>
<td>
<p>Order of the MA part.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_ma.fixed">ma.fixed</code></td>
<td>
<p>Logical. Only applies to testing ARMA vs TARMA. If <code>TRUE</code> computes the test where only the AR parameters are tested, see (Goracci et al. 2021) for details.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_thd.range">thd.range</code></td>
<td>
<p>Vector of optional user defined threshold range. If missing then <code>pa</code> and <code>pb</code> are used.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_method">method</code></td>
<td>
<p>Fitting method to be passed to <code>arima</code>.</p>
</td></tr>
<tr><td><code id="TARMA.test_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>arima</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements an asymptotic supremum Lagrange Multiplier test to test an ARMA specification versus a TARMA specification.
Both the non-robust <code>supLM</code> and the robust <code>supLMh</code> statistics are returned.
If <code>ma.fixed=TRUE</code> (the default), the AR parameters are tested whereas the MA parameters are fixed. If <code>ma.fixed=FALSE</code> both the AR and the MA parameters are tested.
This is an asymptotic test and the value of the test statistic has to be compared with the critical values tabulated in (Goracci et al. 2021) and (Andrews 2003). These are automatically computed and printed by <code><a href="#topic+print.TARMAtest">print.TARMAtest</a></code>.
If <code>ma.ord=0</code> then the AR versus TAR test is used. Note that when <code>method='CSS'</code>, this is equivalent to <code>TAR.test</code>, which uses least squares.
</p>


<h3>Value</h3>

<p>An object of class <code>TARMAtest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>The value of the <code>supLM</code> statistic and its robust version <code>supLMh</code>.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximizes the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Vector of values of the two LM statistics for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit.ARMA</code></dt><dd><p>The null model: ARMA fit over <code>x</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the ARMA fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>prop</code></dt><dd><p>Proportion of values of the series that fall in the lower regime.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The p-value of the test. It is <code>NULL</code> for the asymptotic test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>d</code></dt><dd><p>The delay parameter.</p>
</dd>
<dt><code>pa</code></dt><dd><p>Lower threshold quantile.</p>
</dd>
<dt><code>dfree</code></dt><dd><p>Effective degrees of freedom. It is the number of tested parameters.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2023).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
<em>Statistica Sinica</em>, <b>33</b>(3), 1879-1901.
<a href="https://doi.org/10.5705/ss.202021.0120">doi:10.5705/ss.202021.0120</a>.
</p>
</li>
<li> <p>Andrews DWK (2003).
&ldquo;Tests for Parameter Instability and Structural Change with Unknown Change Point: A Corrigendum.&rdquo;
<em>Econometrica</em>, <b>71</b>(1), 395-397.
<a href="https://doi.org/10.1111/1468-0262.00405">doi:10.1111/1468-0262.00405</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TAR.test">TAR.test</a></code> for the AR vs TAR asymptotic version of the test with different defaults. <code><a href="#topic+TAR.test.B">TAR.test.B</a></code> for the bootstrap version of the AR vs TAR test. <code><a href="#topic+TARMAGARCH.test">TARMAGARCH.test</a></code> for the robust version of the test that assumes GARCH innovations. <code><a href="#topic+TARMA.sim">TARMA.sim</a></code> to simulate from a TARMA process.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) where the threshold effect is on the AR parameters
set.seed(123)
x1    &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0.5, theta2=0.5, d=1, thd=0.2)
TARMA.test(x1, ar.ord=1, ma.ord=1, d=1)
TARMA.test(x1, ar.ord=1, ma.ord=1, d=1, ma.fixed=FALSE) # full TARMA test

## a TARMA(1,1,1,1) where the threshold effect is on the MA parameters
set.seed(212)
x2    &lt;- TARMA.sim(n=100, phi1=c(0.5,0.2), phi2=c(0.5,0.2), theta1=0.6, theta2=-0.6, d=1, thd=0.2)
TARMA.test(x2, ar.ord=1, ma.ord=1, d=1)
TARMA.test(x2, ar.ord=1, ma.ord=1, d=1, ma.fixed=FALSE) # full TARMA test

## a ARMA(1,1)
x3   &lt;- arima.sim(n=100, model=list(order = c(1,0,1),ar=0.5, ma=0.5))
TARMA.test(x3, ar.ord=1, ma.ord=1, d=1)

## a TAR(1,1)
x4   &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0, theta2=0, d=1, thd=0.2)
TARMA.test(x4, ar.ord=1, ma.ord=0, d=1)

## a AR(1)
x5   &lt;- arima.sim(n=100, model=list(order = c(1,0,0),ar=0.5))
TARMA.test(x5, ar.ord=1, ma.ord=0, d=1)


</code></pre>

<hr>
<h2 id='TARMAGARCH.test'>ARMA GARCH versus TARMA GARCH supLM test for nonlinearity</h2><span id='topic+TARMAGARCH.test'></span>

<h3>Description</h3>

<p>Implements a supremum Lagrange Multiplier test for a ARMA-GARCH specification versus
a TARMA-GARCH specification. Both the AR and MA parameters are tested. Also includes the ARCH case.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMAGARCH.test(
  x,
  pa = 0.25,
  pb = 0.75,
  ar.ord = 1,
  ma.ord = 1,
  arch.ord = 1,
  garch.ord = 1,
  d = 1,
  thd.range,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMAGARCH.test_+3A_x">x</code></td>
<td>
<p>A univariate time series.</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_ar.ord">ar.ord</code></td>
<td>
<p>Order of the AR part.  It must be a positive integer</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_ma.ord">ma.ord</code></td>
<td>
<p>Order of the MA part.  It must be a positive integer</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_arch.ord">arch.ord</code></td>
<td>
<p>Order of the ARCH part. It must be a positive integer</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_garch.ord">garch.ord</code></td>
<td>
<p>Order of the GARCH part.  It must be a non negative integer.</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_d">d</code></td>
<td>
<p>Delay parameter. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_thd.range">thd.range</code></td>
<td>
<p>Vector of optional user defined threshold range. If missing then <code>pa</code> and <code>pb</code> are used.</p>
</td></tr>
<tr><td><code id="TARMAGARCH.test_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>ugarchfit</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements an asymptotic supremum Lagrange Multiplier test to test an ARMA-GARCH specification versus
a TARMA-GARCH specification. In other words, the test is robust with respect to heteroskedasticity.
Both the AR parameters and the MA parameters are tested. This is an asymptotic test and the value of
the test statistic has to be compared with the critical values reported in the output and taken from
(Andrews 2003). It includes the ARCH case if <code>garch.ord=0</code>.
The null ARMA-GARCH model is estimated in one step with the function <code>ugarchfit</code>
from the package <code>rugarch</code>. The estimated AR and MA polynomials are checked for stationarity and invertibility.
</p>


<h3>Value</h3>

<p>A list of class <code>htest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>The value of the supLM statistic.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximises the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Vector of values of the LM statistic for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit</code></dt><dd><p>The null model: ARMA-GARCH fit using <code>rugarch</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the ARMA fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>prop</code></dt><dd><p>Proportion of values of the series that fall in the lower regime.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The p-value of the test. It is <code>NULL</code> for the asymptotic test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>d</code></dt><dd><p>The delay parameter.</p>
</dd>
<dt><code>pa</code></dt><dd><p>Lower threshold quantile.</p>
</dd>
<dt><code>dfree</code></dt><dd><p>Effective degrees of freedom. It is the number of tested parameters.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Angelini F, Castellani M, Giannerini S, Goracci G (2023).
&ldquo;Testing for Threshold Effects in Presence of Heteroskedasticity and Measurement Error with an application to Italian Strikes.&rdquo;
University of Bologna and Free University of Bolzano.
2308.00444, <a href="https://arxiv.org/abs/2308.00444">https://arxiv.org/abs/2308.00444</a>.
</p>
</li>
<li> <p>Goracci G, Giannerini S, Chan K, Tong H (2021).
&ldquo;Testing for threshold effects in the TARMA framework.&rdquo;
University of Bologna, Free University of Bolzano, University of Iowa,  London School of Economics.
<a href="https://arxiv.org/abs/2103.13977">https://arxiv.org/abs/2103.13977</a>.
</p>
</li>
<li> <p>Andrews DWK (2003).
&ldquo;Tests for Parameter Instability and Structural Change with Unknown Change Point: A Corrigendum.&rdquo;
<em>Econometrica</em>, <b>71</b>(1), 395-397.
<a href="https://doi.org/10.1111/1468-0262.00405">doi:10.1111/1468-0262.00405</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMA.test">TARMA.test</a></code> and <code><a href="#topic+TAR.test.B">TAR.test.B</a></code> for the asymptotic and bootstrap test without the GARCH component. <code><a href="#topic+TARMA.sim">TARMA.sim</a></code> to simulate from a TARMA process. <code><a href="#topic+TARMA.fit">TARMA.fit</a></code> and <code><a href="#topic+TARMA.fit2">TARMA.fit2</a></code> for TARMA modelling.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Function to simulate from a ARMA-GARCH process

arma11.garch11 &lt;- function(n, ph, th, a, b, a0=1, rand.gen = rnorm, innov = rand.gen(n, ...),
n.start = 500, start.innov = rand.gen(n.start, ...),...){

  #  Simulates a ARMA(1,1)-GARCH(1,1) process
  #  with parameters ph, th, a, b, a0.
  #         x[t] &lt;- ph*x[t-1] + th*eps[t-1] + eps[t]
  #       eps[t] &lt;- e[t]*sqrt(v[t])
  #         v[t] &lt;- a0 + a*eps[t-1]^2 + b*v[t-1];
  # ph  : AR
  # th  : MA
  # a   : ARCH
  # b   : GARCH

  # checks
  if(abs(a+b)&gt;=1)   stop("model is not stationary")
  if(b/(1-a)&gt;=1) stop("model has infinite fourth moments")

  if (!missing(start.innov) &amp;&amp; length(start.innov) &lt; n.start)
    stop(gettextf("'start.innov' is too short: need %d points", n.start), domain = NA)
  e &lt;- c(start.innov[1L:n.start], innov[1L:n])
  ntot &lt;- length(e)
  x &lt;- v &lt;- eps &lt;- double(ntot)
  v[1]   &lt;- a0/(1.0-a-b);
  eps[1] &lt;- e[1]*sqrt(v[1])
  x[1]   &lt;- eps[1];
  for(i in 2:ntot){
    v[i]   &lt;- a0 + a*eps[i-1]^2 + b*v[i-1];
    eps[i] &lt;- e[i]*sqrt(v[i])
    x[i]   &lt;- ph*x[i-1] + th*eps[i-1] + eps[i]
  }
  if (n.start &gt; 0)  x &lt;- x[-(1L:n.start)]
  return(ts(x));
}

## **************************************************************************
## Comparison between the robust and the non-robust test in presence of GARCH errors
## Simulates from the ARMA(1,1)-GARCH(1,1)

set.seed(12)
x1 &lt;- arma11.garch11(n=100, ph=0.9, th=0.5, a=0.85, b=0.1, a0=1,n.start=500)
TARMAGARCH.test(x1, ar.ord=1, ma.ord=1, arch.ord=1, garch.ord=1, d=1)
TARMA.test(x1, ar.ord=1, ma.ord=1, d=1, ma.fixed=FALSE)

## a TARMA(1,1,1,1) where the threshold effect is on the AR parameters
set.seed(123)
x2  &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0.5, theta2=0.5, d=1, thd=0.2)
TARMAGARCH.test(x2, ar.ord=1, ma.ord=1, d=1)


</code></pre>

<hr>
<h2 id='TARMAur.test'>Unit root supLM test for an integrated MA versus a stationary TARMA process</h2><span id='topic+TARMAur.test'></span>

<h3>Description</h3>

<p>Implements a supremum Lagrange Multiplier unit root test for the null hypiythesis of a integrated MA  process versus
a stationary TARMA process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMAur.test(x, pa = 0.25, pb = 0.75, thd.range, method = "ML", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMAur.test_+3A_x">x</code></td>
<td>
<p>A univariate vector or time series.</p>
</td></tr>
<tr><td><code id="TARMAur.test_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMAur.test_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMAur.test_+3A_thd.range">thd.range</code></td>
<td>
<p>Vector of optional user defined threshold range. If missing then <code>pa</code> and <code>pb</code> are used.</p>
</td></tr>
<tr><td><code id="TARMAur.test_+3A_method">method</code></td>
<td>
<p>Fitting method to be passed to <code>arima</code>.</p>
</td></tr>
<tr><td><code id="TARMAur.test_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>arima</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements an asymptotic supremum Lagrange Multiplier test to test an integrate MA(1) specification versus a
stationary TARMA(1,1) specification. This is an asymptotic test and the value of the test statistic has to be compared with the critical
values tabulated in (Chan et al. 2024) and available in <code><a href="#topic+supLMQur">supLMQur</a></code>.
The relevant critical values are automatically shown upon printing the test, see <code><a href="#topic+print.TARMAtest">print.TARMAtest</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>TARMAtest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>The value of the supLM statistic.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximises the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Vector of values of the LM statistic for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit.ARMA</code></dt><dd><p>The null model: IMA(1) fit over <code>x</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the IMA fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The p-value of the test. It is <code>NULL</code> for the asymptotic test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>d</code></dt><dd><p>The delay parameter.</p>
</dd>
<dt><code>pa</code></dt><dd><p>Lower threshold quantile.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Chan K, Giannerini S, Goracci G, Tong H (2024).
&ldquo;Testing for threshold regulation in presence of measurement error.&rdquo;
<em>Statistica Sinica</em>, <b>34</b>(3), 1413-1434.
<a href="https://doi.org/10.5705/ss.202022.0125">doi:10.5705/ss.202022.0125</a>, <a href="https://doi.org/10.5705/ss.202022.0125">https://doi.org/10.5705/ss.202022.0125</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMAur.test.B">TARMAur.test.B</a></code> for the bootstrap version of the test.
<code><a href="#topic+print.TARMAtest">print.TARMAtest</a></code> for the print method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) 
set.seed(123)
x1    &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0.5, theta2=0.5, d=1, thd=0.2)
TARMAur.test(x1)


## a IMA(1,1)
x2   &lt;- arima.sim(n=100, model=list(order = c(0,1,1),ma=0.6))
TARMAur.test(x2)


</code></pre>

<hr>
<h2 id='TARMAur.test.B'>Unit root supLM test for an integrated MA versus a stationary TARMA process</h2><span id='topic+TARMAur.test.B'></span>

<h3>Description</h3>

<p>Implements a supremum Lagrange Multiplier unit root test for the null hypothesis of a integrated MA  process versus
a stationary TARMA process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TARMAur.test.B(
  x,
  B = 1000,
  pa = 0.25,
  pb = 0.75,
  thd.range,
  method = "ML",
  btype = c("wb.r", "wb.n", "iid"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TARMAur.test.B_+3A_x">x</code></td>
<td>
<p>A univariate vector or time series.</p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_b">B</code></td>
<td>
<p>Integer. Number of bootstrap resamples. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_pa">pa</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the lower limit for the threshold search to the <code>100*pa</code>-th sample percentile.
The default is <code>0.25</code></p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_pb">pb</code></td>
<td>
<p>Real number in <code>[0,1]</code>. Sets the upper limit for the threshold search to the <code>100*pb</code>-th sample percentile.
The default is <code>0.75</code></p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_thd.range">thd.range</code></td>
<td>
<p>Vector of optional user defined threshold range. If missing then <code>pa</code> and <code>pb</code> are used.</p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_method">method</code></td>
<td>
<p>Fitting method to be passed to <code>arima</code>.</p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_btype">btype</code></td>
<td>
<p>Bootstrap type, can be one of <code>'iid','wb.r','wb.n'</code>, see Details.</p>
</td></tr>
<tr><td><code id="TARMAur.test.B_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>arima</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the bootstrap version of <code><a href="#topic+TARMAur.test">TARMAur.test</a></code> the supremum Lagrange Multiplier test
to test an integrate MA(1) specification versus a stationary TARMA(1,1) specification.
The option <code>btype</code> specifies the type of bootstrap as follows:
</p>

<dl>
<dt><code>wb.r</code></dt><dd><p>Residual wild bootstrap with Rademacher auxiliary distribution. See (Giannerini et al. 2022).</p>
</dd>
<dt><code>wb.n</code></dt><dd><p>Residual wild bootstrap with Normal auxiliary distribution. See (Giannerini et al. 2022).</p>
</dd>
<dt><code>iid</code></dt><dd><p>Residual iid bootstrap. See (Goracci et al. 2021).</p>
</dd>
</dl>



<h3>Value</h3>

<p>An object of class <code>TARMAtest</code> with components:
</p>

<dl>
<dt><code>statistic</code></dt><dd><p>The value of the supLM statistic.</p>
</dd>
<dt><code>parameter</code></dt><dd><p>A named vector: <code>threshold</code> is the value that maximises the Lagrange Multiplier values.</p>
</dd>
<dt><code>test.v</code></dt><dd><p>Vector of values of the LM statistic for each threshold given in <code>thd.range</code>.</p>
</dd>
<dt><code>thd.range</code></dt><dd><p>Range of values of the threshold.</p>
</dd>
<dt><code>fit.ARMA</code></dt><dd><p>The null model: IMA(1) fit over <code>x</code>.</p>
</dd>
<dt><code>sigma2</code></dt><dd><p>Estimated innovation variance from the IMA fit.</p>
</dd>
<dt><code>data.name</code></dt><dd><p>A character string giving the name of the data.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>The bootstrap p-value of the test.</p>
</dd>
<dt><code>method</code></dt><dd><p>A character string indicating the type of test performed.</p>
</dd>
<dt><code>d</code></dt><dd><p>The delay parameter.</p>
</dd>
<dt><code>pa</code></dt><dd><p>Lower threshold quantile.</p>
</dd>
<dt><code>Tb</code></dt><dd><p>The bootstrap null distribution.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Simone Giannerini, <a href="mailto:simone.giannerini@uniud.it">simone.giannerini@uniud.it</a>
</p>
<p>Greta Goracci, <a href="mailto:greta.goracci@unibz.it">greta.goracci@unibz.it</a>
</p>


<h3>References</h3>


<ul>
<li> <p>Chan K, Giannerini S, Goracci G, Tong H (2024).
&ldquo;Testing for threshold regulation in presence of measurement error.&rdquo;
<em>Statistica Sinica</em>, <b>34</b>(3), 1413-1434.
<a href="https://doi.org/10.5705/ss.202022.0125">doi:10.5705/ss.202022.0125</a>, <a href="https://doi.org/10.5705/ss.202022.0125">https://doi.org/10.5705/ss.202022.0125</a>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+TARMAur.test">TARMAur.test</a></code> for the asymptotic version of the test. <code><a href="#topic+print.TARMAtest">print.TARMAtest</a></code> for the print method.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## a TARMA(1,1,1,1) 
set.seed(123)
x1    &lt;- TARMA.sim(n=100, phi1=c(0.5,-0.5), phi2=c(0.0,0.8), theta1=0.5, theta2=0.5, d=1, thd=0.2)
TARMAur.test.B(x1, B=100) # B=100 for speedup


## a IMA(1,1)
x2   &lt;- arima.sim(n=100, model=list(order = c(0,1,1),ma=0.6))
TARMAur.test.B(x2, B=100) # B=100 for speedup


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
