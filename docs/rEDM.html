<!DOCTYPE html><html lang="en"><head><title>Help for package rEDM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rEDM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rEDM'><p>Empirical dynamic modeling</p></a></li>
<li><a href='#block_3sp'><p>Time series for a three-species coupled model.</p></a></li>
<li><a href='#CCM'><p>Convergent cross mapping using simplex projection</p></a></li>
<li><a href='#circle'><p>2-D timeseries of a circle.</p></a></li>
<li><a href='#ComputeError'><p>Compute error</p></a></li>
<li><a href='#Embed'><p>Embed data with time lags</p></a></li>
<li><a href='#EmbedDimension'><p>Optimal embedding dimension</p></a></li>
<li><a href='#EvergladesFlow'><p>Water flow to NE Everglades</p></a></li>
<li><a href='#Lorenz5D'><p>5-D Lorenz'96</p></a></li>
<li><a href='#MakeBlock'><p>Make embedded data block</p></a></li>
<li><a href='#Multiview'><p>Forecasting using multiview embedding</p></a></li>
<li><a href='#paramecium_didinium'><p>Time series for the Paramecium-Didinium laboratory experiment</p></a></li>
<li><a href='#PredictInterval'><p>Forecast interval accuracy</p></a></li>
<li><a href='#PredictNonlinear'><p>Test for nonlinear dynamics</p></a></li>
<li><a href='#sardine_anchovy_sst'><p>Time series for the California Current Anchovy-Sardine-SST system</p></a></li>
<li><a href='#Simplex'><p>Simplex forecasting</p></a></li>
<li><a href='#SMap'><p>SMap forecasting</p></a></li>
<li><a href='#SurrogateData'><p>Generate surrogate data for permutation/randomization tests</p></a></li>
<li><a href='#TentMap'><p>Time series for a tent map with mu = 2.</p></a></li>
<li><a href='#TentMapNoise'><p>Time series of tent map plus noise.</p></a></li>
<li><a href='#Thrips'><p>Apple-blossom Thrips time series</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Empirical Dynamic Modeling ('EDM')</td>
</tr>
<tr>
<td>Version:</td>
<td>1.15.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-04-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Joseph Park &lt;JosephPark@IEEE.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of 'EDM' algorithms based on research software developed for internal use at the Sugihara Lab ('UCSD/SIO').  The package is implemented with 'Rcpp' wrappers around the 'cppEDM' library.  It implements the 'simplex' projection method from Sugihara &amp; May (1990) &lt;<a href="https://doi.org/10.1038%2F344734a0">doi:10.1038/344734a0</a>&gt;, the 'S-map' algorithm from Sugihara (1994) &lt;<a href="https://doi.org/10.1098%2Frsta.1994.0106">doi:10.1098/rsta.1994.0106</a>&gt;, convergent cross mapping described in Sugihara et al. (2012) &lt;<a href="https://doi.org/10.1126%2Fscience.1227079">doi:10.1126/science.1227079</a>&gt;, and, 'multiview embedding' described in Ye &amp; Sugihara (2016) &lt;<a href="https://doi.org/10.1126%2Fscience.aag0863">doi:10.1126/science.aag0863</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/BSD-2-Clause">BSD_2_clause</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, Rcpp (&ge; 1.0.1)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppThread</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, formatR</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-05 17:24:24 UTC; jpark</td>
</tr>
<tr>
<td>Author:</td>
<td>Joseph Park <a href="https://orcid.org/0000-0001-5411-1409"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Cameron Smith <a href="https://orcid.org/0000-0003-0020-5607"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  George Sugihara <a href="https://orcid.org/0000-0002-2863-6946"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, ccp],
  Ethan Deyle <a href="https://orcid.org/0000-0001-8704-8434"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Erik Saberski <a href="https://orcid.org/0000-0002-6475-6187"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb],
  Hao Ye <a href="https://orcid.org/0000-0002-8630-1458"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  The Regents of the University of California [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-06 10:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='rEDM'>Empirical dynamic modeling</h2><span id='topic+EDM'></span><span id='topic+rEDM-package'></span>

<h3>Description</h3>

<p><span class="pkg">rEDM</span> provides tools for data-driven time series analyses. It is
based on reconstructing multivariate state space
representations from uni or multivariate time series, then projecting
state changes using various metrics applied to nearest neighbors.
</p>
<p><span class="pkg">rEDM</span> is a <span class="pkg">Rcpp</span> interface to the
<a href="https://github.com/SugiharaLab/cppEDM">cppEDM</a> library of
Empirical Dynamic Modeling tools. Functionality includes:
</p>

<ul>
<li><p> Simplex projection (Sugihara and May 1990)
</p>
</li>
<li><p> Sequential Locally Weighted Global Linear Maps (S-map) (Sugihara 1994)
</p>
</li>
<li><p> Multivariate embeddings (Dixon et. al. 1999)
</p>
</li>
<li><p> Convergent cross mapping (Sugihara et. al. 2012)
</p>
</li>
<li><p> Multiview embedding (Ye and Sugihara 2016)
</p>
</li></ul>



<h3>Details</h3>

<p><strong>Main Functions</strong>: 
</p>

<ul>
<li> <p><code><a href="#topic+Simplex">Simplex</a></code> - simplex projection
</p>
</li>
<li> <p><code><a href="#topic+SMap">SMap</a></code> - S-map projection
</p>
</li>
<li> <p><code><a href="#topic+CCM">CCM</a></code> - convergent cross mapping
</p>
</li>
<li> <p><code><a href="#topic+Multiview">Multiview</a></code> - multiview forecasting
</p>
</li></ul>

<p><strong>Helper Functions</strong>: 
</p>

<ul>
<li> <p><code><a href="#topic+Embed">Embed</a></code> - time delay embedding
</p>
</li>
<li> <p><code><a href="#topic+ComputeError">ComputeError</a></code> - forecast skill metrics
</p>
</li>
<li> <p><code><a href="#topic+EmbedDimension">EmbedDimension</a></code> - optimal embedding dimension
</p>
</li>
<li> <p><code><a href="#topic+PredictInterval">PredictInterval</a></code> - optimal prediction interval
</p>
</li>
<li> <p><code><a href="#topic+PredictNonlinear">PredictNonlinear</a></code> - evaluate nonlinearity
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Joseph Park
</p>
<p><strong>Authors</strong>: Joseph Park, Cameron Smith, Ethan Deyle, Erik
Saberski, George Sugihara
</p>


<h3>References</h3>

<p>Sugihara G. and May R. 1990. Nonlinear forecasting as a way of
distinguishing chaos from measurement error in time series.
Nature, 344:734-741.
</p>
<p>Sugihara G. 1994. Nonlinear forecasting for the classification of
natural time series. Philosophical Transactions: Physical Sciences
and Engineering, 348 (1688) : 477-495.
</p>
<p>Dixon, P. A., M. Milicich, and G. Sugihara, 1999. Episodic
fluctuations in larval supply. Science 283:1528-1530.
</p>
<p>Sugihara G., May R., Ye H., Hsieh C., Deyle E., Fogarty M.,
Munch S., 2012. Detecting Causality in Complex Ecosystems.
Science 338:496-500.
</p>
<p>Ye H., and G. Sugihara, 2016. Information leverage in
interconnected ecosystems: Overcoming the curse of dimensionality.
Science 353:922-925.
</p>

<hr>
<h2 id='block_3sp'>Time series for a three-species coupled model.</h2><span id='topic+block_3sp'></span>

<h3>Description</h3>

<p>Time series generated from a discrete-time coupled 
Lotka-Volterra model exhibiting chaotic dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>block_3sp
</code></pre>


<h3>Format</h3>

<p>A data frame with 198 rows and 10 columns: 
</p>

<dl>
<dt><code>time</code></dt><dd><p>time index (# of generations)</p>
</dd>
<dt><code>x_t</code>  </dt><dd><p>abundance of simulated species x at time t</p>
</dd>
<dt><code>x_t-1</code></dt><dd><p>abundance of simulated species x at time t-1</p>
</dd>
<dt><code>x_t-2</code></dt><dd><p>abundance of simulated species x at time t-2</p>
</dd>
<dt><code>y_t</code>  </dt><dd><p>abundance of simulated species y at time t</p>
</dd>
<dt><code>y_t-1</code></dt><dd><p>abundance of simulated species y at time t-1</p>
</dd>
<dt><code>y_t-2</code></dt><dd><p>abundance of simulated species y at time t-2</p>
</dd>
<dt><code>z_t</code>  </dt><dd><p>abundance of simulated species z at time t</p>
</dd>
<dt><code>z_t-1</code></dt><dd><p>abundance of simulated species z at time t-1</p>
</dd>
<dt><code>z_t-2</code></dt><dd><p>abundance of simulated species z at time t-2</p>
</dd>
</dl>

<hr>
<h2 id='CCM'>Convergent cross mapping using simplex projection</h2><span id='topic+CCM'></span>

<h3>Description</h3>

<p>The state-space of a multivariate dynamical system (not a purely
stochastic one) encodes coherent phase-space variable trajectories. If
enough information is available, one can infer the presence or absence
of cross-variable interactions associated with causal links between
variables. <code><a href="#topic+CCM">CCM</a></code> measures the extent to which states of
variable Y can reliably estimate states of variable X. This can happen
if X is causally influencing Y. 
</p>
<p>If cross-variable state predictability converges as more state-space
information is provided, this indicates a causal link. <code><a href="#topic+CCM">CCM</a></code>
performs this cross-variable mapping using Simplex, with convergence
assessed across a range of observational library sizes as described in
<cite>Sugihara et al. 2012</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CCM(pathIn = "./", dataFile = "", dataFrame = NULL,
  E = 0, Tp = 0, knn = 0, tau = -1,
  exclusionRadius = 0, columns = "", target = "", libSizes = "",
  sample = 0, random = TRUE, seed = 0, 
  embedded = FALSE, includeData = FALSE, parameterList = FALSE,
  verbose = FALSE, showPlot = FALSE, noTime = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CCM_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="CCM_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="CCM_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="CCM_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="CCM_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="CCM_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to E+1.</p>
</td></tr>
<tr><td><code id="CCM_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="CCM_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="CCM_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="CCM_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="CCM_+3A_libsizes">libSizes</code></td>
<td>
<p>string of 3 whitespace separated integer values
specifying the intial library size, the final library size,
and the library size increment. Can also be a list of strictly
increasing library sizes.</p>
</td></tr>
<tr><td><code id="CCM_+3A_sample">sample</code></td>
<td>
<p>integer specifying the number of random samples to draw at
each library size evaluation.</p>
</td></tr>
<tr><td><code id="CCM_+3A_random">random</code></td>
<td>
<p>logical to specify random (<code>TRUE</code>) or sequential
library sampling. Note <code>random = FALSE</code> is not convergent
cross mapping.</p>
</td></tr>
<tr><td><code id="CCM_+3A_seed">seed</code></td>
<td>
<p>integer specifying the random sampler seed.  If
<code>seed=0</code> then a random seed is generated.</p>
</td></tr>
<tr><td><code id="CCM_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="CCM_+3A_includedata">includeData</code></td>
<td>
<p>logical to include statistics and predictions for
every prediction in the ensemble.</p>
</td></tr>
<tr><td><code id="CCM_+3A_parameterlist">parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td></tr>
<tr><td><code id="CCM_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="CCM_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="CCM_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+CCM">CCM</a></code> computes the X:Y and Y:X cross-mappings in parallel
using threads. 
</p>


<h3>Value</h3>

<p>A data.frame with 3 columns. The first column is <code>LibSize</code>
specifying the subsampled library size.  Columns 2 and 3 report
Pearson correlation coefficients for the prediction of X from Y, and
Y from X.
</p>
<p>if <code>includeData = TRUE</code> a named list with the following data.frames
data.frame <code>Combo_rho</code> columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
      LibMeans</td><td style="text-align: left;"> CCM mean correlations for each library size</td>
</tr>
<tr>
 <td style="text-align: left;">
      CCM1_PredictStat</td><td style="text-align: left;"> Forward cross map prediction statistics</td>
</tr>
<tr>
 <td style="text-align: left;">
      CCM1_Predictions</td><td style="text-align: left;"> Forward cross map prediction values</td>
</tr>
<tr>
 <td style="text-align: left;">
      CCM2_PredictStat</td><td style="text-align: left;"> Reverse cross map prediction statistics</td>
</tr>
<tr>
 <td style="text-align: left;">
      CCM2_Predictions</td><td style="text-align: left;"> Reverse cross map prediction values</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>

<p>If <code>includeData = TRUE</code> and <code>parameterList = TRUE</code> a
named list &quot;parameters&quot; is added.
</p>


<h3>References</h3>

<p>Sugihara G., May R., Ye H., Hsieh C., Deyle E., Fogarty M., Munch S., 2012. Detecting Causality in Complex Ecosystems. Science 338:496-500.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sardine_anchovy_sst)
df = CCM( dataFrame = sardine_anchovy_sst, E = 3, Tp = 0, columns = "anchovy",
target = "np_sst", libSizes = "10 70 10", sample = 100 )

</code></pre>

<hr>
<h2 id='circle'>2-D timeseries of a circle.</h2><span id='topic+circle'></span>

<h3>Description</h3>

<p>Time series of of circle in 2-D (sin and cos).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circle
</code></pre>


<h3>Format</h3>

<p>A data frame with 200 rows and 3 columns: 
</p>

<dl>
<dt><code>Time</code></dt><dd><p>time index.</p>
</dd>
<dt><code>x</code></dt><dd><p>sin component.</p>
</dd>
<dt><code>y</code></dt><dd><p>cos component.</p>
</dd>
</dl>

<hr>
<h2 id='ComputeError'>Compute error</h2><span id='topic+ComputeError'></span>

<h3>Description</h3>

<p><code><a href="#topic+ComputeError">ComputeError</a></code> evaluates the Pearson correlation
coefficient, mean absolute error and root mean square error between two
numeric vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ComputeError(obs, pred)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ComputeError_+3A_obs">obs</code></td>
<td>
<p>vector of observations.</p>
</td></tr>
<tr><td><code id="ComputeError_+3A_pred">pred</code></td>
<td>
<p>vector of predictions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A name list with components:
</p>

<table>
<tr>
 <td style="text-align: left;">
    rho   </td><td style="text-align: left;"> Pearson correlation</td>
</tr>
<tr>
 <td style="text-align: left;">
    MAE   </td><td style="text-align: left;"> mean absolute error</td>
</tr>
<tr>
 <td style="text-align: left;">
    RMSE  </td><td style="text-align: left;"> root mean square error</td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Examples</h3>

<pre><code class='language-R'>data(block_3sp)
smplx &lt;- Simplex( dataFrame=block_3sp, lib="1 99", pred="105 190", E=3,
columns="x_t", target="x_t")
err &lt;- ComputeError( smplx$Observations, smplx$Predictions )
</code></pre>

<hr>
<h2 id='Embed'>Embed data with time lags</h2><span id='topic+Embed'></span>

<h3>Description</h3>

<p><code><a href="#topic+Embed">Embed</a></code> performs Takens time-delay embedding on <code>columns</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Embed(path = "./", dataFile = "", dataFrame = NULL, E = 0, tau = -1, 
columns = "", verbose = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Embed_+3A_path">path</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="Embed_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values. The first row must be column names. One of
<code>dataFile</code> or <code>dataFrame</code> are required.</p>
</td></tr>
<tr><td><code id="Embed_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values. The columns must be named. One of
<code>dataFile</code> or <code>dataFrame</code> are required.</p>
</td></tr>
<tr><td><code id="Embed_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="Embed_+3A_tau">tau</code></td>
<td>
<p>integer time delay embedding lag specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="Embed_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="Embed_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each <code>columns</code> item will have E-1 time-lagged vectors created.
The column name is appended with <code>(t-n)</code>.  For example, data
columns X, Y, with E = 2 will have columns named
<code>X(t-0) X(t-1) Y(t-0) Y(t-1)</code>.
</p>
<p>The returned data.frame does not have a time column.  The returned
data.frame is truncated by tau * (E-1) rows to remove state vectors
with partial data (NaN elements).
</p>


<h3>Value</h3>

<p>A data.frame with lagged columns. E columns for each variable specified
in <code>columns</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(circle)
embed &lt;- Embed( dataFrame = circle, E = 2, tau = -1, columns = "x y" ) 
</code></pre>

<hr>
<h2 id='EmbedDimension'>Optimal embedding dimension</h2><span id='topic+EmbedDimension'></span>

<h3>Description</h3>

<p><code><a href="#topic+EmbedDimension">EmbedDimension</a></code> uses <code><a href="#topic+Simplex">Simplex</a></code> to evaluate
prediction accuracy as a function of embedding dimension.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EmbedDimension(pathIn = "./", dataFile = "", dataFrame = NULL, pathOut = "", 
  predictFile = "", lib = "", pred = "", maxE = 10, Tp = 1, tau = -1,
  exclusionRadius = 0, columns = "", target = "", embedded = FALSE,
  verbose = FALSE, validLib = vector(), numThreads = 4, showPlot = TRUE,
  noTime = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EmbedDimension_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_pathout">pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_predictfile">predictFile</code></td>
<td>
<p>output file name.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_lib">lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_pred">pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_maxe">maxE</code></td>
<td>
<p>maximum value of E to evalulate.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_validlib">validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_numthreads">numThreads</code></td>
<td>
<p>number of parallel threads for computation.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="EmbedDimension_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns <code>E, rho</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TentMap)
E.rho = EmbedDimension( dataFrame = TentMap, lib = "1 100", pred = "201 500",
columns = "TentMap", target = "TentMap", showPlot = FALSE )
</code></pre>

<hr>
<h2 id='EvergladesFlow'>Water flow to NE Everglades</h2><span id='topic+EvergladesFlow'></span>

<h3>Description</h3>

<p>Cumulative weekly water flow into northeast Everglades from water
control structures S12C, S12D and S333 from 1980 through 2005.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EvergladesFlow
</code></pre>


<h3>Format</h3>

<p>A data frame with 1379 rows and 2 columns: 
</p>

<dl>
<dt><code>Date</code></dt><dd><p>Date.</p>
</dd>
<dt><code>S12CD_S333_CFS</code></dt><dd><p>Cumulative weekly flow (CFS).</p>
</dd>
</dl>


<hr>
<h2 id='Lorenz5D'>5-D Lorenz'96</h2><span id='topic+Lorenz5D'></span>

<h3>Description</h3>

<p>5-D Lorenz'96 timeseries with F = 8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Lorenz5D
</code></pre>


<h3>Format</h3>

<p>Data frame with 1000 rows and 6 columns
</p>

<dl>
<dt><code>Time</code></dt><dd><p>Time.</p>
</dd>
<dt><code>V1</code></dt><dd><p>variable 1.</p>
</dd>
<dt><code>V2</code></dt><dd><p>variable 2.</p>
</dd>
<dt><code>V3</code></dt><dd><p>variable 3.</p>
</dd>
<dt><code>V4</code></dt><dd><p>variable 4.</p>
</dd>
<dt><code>V5</code></dt><dd><p>variable 5.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lorenz, Edward (1996). Predictability - A problem partly solved,
Seminar on Predictability, Vol. I, ECMWF.
</p>

<hr>
<h2 id='MakeBlock'>Make embedded data block</h2><span id='topic+MakeBlock'></span>

<h3>Description</h3>

<p><code><a href="#topic+MakeBlock">MakeBlock</a></code> performs Takens time-delay embedding on
<code>columns</code>. It is an internal function called by <code><a href="#topic+Embed">Embed</a></code>
that does not perform input error checking or validation. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MakeBlock(dataFrame, E = 0, tau = -1, columns = "", deletePartial = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MakeBlock_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values. The columns must be named.</p>
</td></tr>
<tr><td><code id="MakeBlock_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="MakeBlock_+3A_tau">tau</code></td>
<td>
<p>integer time delay embedding lag specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="MakeBlock_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s) in the
input data to be embedded.</p>
</td></tr>
<tr><td><code id="MakeBlock_+3A_deletepartial">deletePartial</code></td>
<td>
<p>boolean to delete rows with partial data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each <code>columns</code> item will have E-1 time-lagged vectors created.
The column name is appended with <code>(t-n)</code>.  For example, data
columns X, Y, with E = 2 will have columns named
<code>X(t-0) X(t-1) Y(t-0) Y(t-1)</code>.
</p>
<p>The returned data.frame does not have a time column.
</p>
<p>If <code>deletePartial</code> is <code>TRUE</code>, the returned
data.frame is truncated by tau * (E-1) rows to remove state vectors
with partial data (NaN elements).
</p>


<h3>Value</h3>

<p>A data.frame with lagged columns. E columns for each variable specified
in <code>columns</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TentMap)
embed &lt;- MakeBlock(TentMap, 3, 1, "TentMap")
</code></pre>

<hr>
<h2 id='Multiview'>Forecasting using multiview embedding</h2><span id='topic+Multiview'></span>

<h3>Description</h3>

<p><code><a href="#topic+Multiview">Multiview</a></code> applies the method of <cite>Ye &amp; Sugihara</cite>
to find optimal combinations of variables that best represent the
dynamics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Multiview(pathIn = "./", dataFile = "", dataFrame = NULL,
  lib = "", pred = "", D = 0, E = 1, Tp = 1, knn = 0, 
  tau = -1, columns = "", target = "", multiview = 0, exclusionRadius = 0,
  trainLib = TRUE, excludeTarget = FALSE, parameterList = FALSE,
  verbose = FALSE, numThreads = 4, showPlot = FALSE, noTime = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Multiview_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values. The first row must be column names unless noTime is TRUE.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_lib">lib</code></td>
<td>
<p>a 2-column matrix, data.frame, 2-element vector or string of 
row indice pairs, where each pair specifies the first and last *rows* of
the time series to create the library.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_pred">pred</code></td>
<td>
<p>(same format as lib), but specifying the sections of the time 
series to forecast.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_d">D</code></td>
<td>
<p>multivariate dimension.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="Multiview_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to E+1.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_multiview">multiview</code></td>
<td>
<p>number of multiview ensembles to average for the final
prediction estimate.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>number of adjacent observation vector rows to exclude as
nearest neighbors in prediction.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_trainlib">trainLib</code></td>
<td>
<p>logical to use in-sample (lib=pred) projections for the
ranking of column combinations.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_excludetarget">excludeTarget</code></td>
<td>
<p>logical to exclude embedded target column from combinations.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_parameterlist">parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_numthreads">numThreads</code></td>
<td>
<p>number of CPU threads to use in multiview processing.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="Multiview_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Multiview embedding is a method to identify variables in a
multivariate dynamical system that are most likely to contribute to
the observed dynamics.  It is a multistep algorithm with these general
steps:
</p>

<ol>
<li><p> Compute D-dimensional variable combination forecasts.
</p>
</li>
<li><p> Rank forecasts.
</p>
</li>
<li><p> Compute predictions of top combinations.
</p>
</li>
<li><p> Compute multiview averaged prediction.
</p>
</li></ol>

<p>If <code>E&gt;1</code>, all variables are embedded to dimension E. 
If <code>trainLib</code> is <code>TRUE</code> initial forecasts and ranking are
done in-sample (<code>lib=pred</code>) and predictions using the top ranked
combinations use the specified <code>lib</code> and <code>pred</code>.
If <code>trainLib</code> is <code>FALSE</code> initial forecasts and ranking use
the specified <code>lib</code> and <code>pred</code>, the step of computing
predictions of the top combinations is skipped. 
</p>


<h3>Value</h3>

<p>Named list with data.frames <code>[[View, Predictions]]</code>.
</p>
<p>data.frame <code>View</code> columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
  Col_1 </td><td style="text-align: left;"> column index</td>
</tr>
<tr>
 <td style="text-align: left;">
  ...   </td><td style="text-align: left;"> column index</td>
</tr>
<tr>
 <td style="text-align: left;">
  Col_D </td><td style="text-align: left;"> column index</td>
</tr>
<tr>
 <td style="text-align: left;">
  rho   </td><td style="text-align: left;"> Pearson correlation</td>
</tr>
<tr>
 <td style="text-align: left;">
  MAE   </td><td style="text-align: left;"> mean absolute error</td>
</tr>
<tr>
 <td style="text-align: left;">
  RMSE  </td><td style="text-align: left;"> root mean square error</td>
</tr>
<tr>
 <td style="text-align: left;">
  name_1 </td><td style="text-align: left;"> column name</td>
</tr>
<tr>
 <td style="text-align: left;">
  ...    </td><td style="text-align: left;"> column name</td>
</tr>
<tr>
 <td style="text-align: left;">
  name_D </td><td style="text-align: left;"> column name</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>If <code>parameterList = TRUE</code> a named list &quot;parameters&quot; is added.
</p>


<h3>References</h3>

<p>Ye H., and G. Sugihara, 2016. Information leverage in 
interconnected ecosystems: Overcoming the curse of dimensionality.
Science 353:922-925.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(block_3sp)
L = Multiview( dataFrame = block_3sp, lib = "1 100", pred = "101 190",
E = 2, columns = "x_t y_t z_t", target = "x_t" )
</code></pre>

<hr>
<h2 id='paramecium_didinium'>Time series for the Paramecium-Didinium laboratory experiment</h2><span id='topic+paramecium_didinium'></span>

<h3>Description</h3>

<p>Time series of Paramecium and Didinium abundances (#/mL) from 
an experiment by Veilleux (1979)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paramecium_didinium
</code></pre>

<hr>
<h2 id='PredictInterval'>Forecast interval accuracy</h2><span id='topic+PredictInterval'></span>

<h3>Description</h3>

<p><code><a href="#topic+PredictInterval">PredictInterval</a></code> uses <code><a href="#topic+Simplex">Simplex</a></code> to evaluate
prediction accuracy as a function of forecast interval Tp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredictInterval(pathIn = "./", dataFile = "", dataFrame = NULL, pathOut = "./", 
  predictFile = "", lib = "", pred = "", maxTp = 10, E = 1, tau = -1,
  exclusionRadius = 0, columns = "", target = "", embedded = FALSE,
  verbose = FALSE, validLib = vector(), numThreads = 4, showPlot = TRUE,
  noTime = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PredictInterval_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_pathout">pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_predictfile">predictFile</code></td>
<td>
<p>output file name.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_lib">lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_pred">pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_maxtp">maxTp</code></td>
<td>
<p>maximum value of Tp to evalulate.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_validlib">validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_numthreads">numThreads</code></td>
<td>
<p>number of parallel threads for computation.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="PredictInterval_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with columns <code>Tp, rho</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TentMap)
Tp.rho = PredictInterval( dataFrame = TentMap, lib = "1 100",
pred = "201 500", E = 2, columns = "TentMap", target = "TentMap",
showPlot = FALSE )
</code></pre>

<hr>
<h2 id='PredictNonlinear'>Test for nonlinear dynamics</h2><span id='topic+PredictNonlinear'></span>

<h3>Description</h3>

<p><code><a href="#topic+PredictNonlinear">PredictNonlinear</a></code> uses <code><a href="#topic+SMap">SMap</a></code> to evaluate
prediction accuracy as a function of the localisation parameter
<code>theta</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PredictNonlinear(pathIn = "./", dataFile = "", dataFrame = NULL,
  pathOut = "./",  predictFile = "", lib = "", pred = "", theta = "",
  E = 1, Tp = 1, knn = 0, tau = -1, exclusionRadius = 0,
  columns = "", target = "", embedded = FALSE, verbose = FALSE,
  validLib = vector(), ignoreNan = TRUE, numThreads = 4,
  showPlot = TRUE, noTime = FALSE )  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PredictNonlinear_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_pathout">pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_predictfile">predictFile</code></td>
<td>
<p>output file name.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_lib">lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_pred">pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_theta">theta</code></td>
<td>
<p>A whitespace delimeted string with values of the S-map 
localisation parameter. An empty string will use default values of
<code>[0.01 0.1 0.3 0.5 0.75 1 1.5 2 3 4 5 6 7 8 9]</code>.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to the
library size.</p>
</td></tr> 
<tr><td><code id="PredictNonlinear_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_validlib">validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_ignorenan">ignoreNan</code></td>
<td>
<p>logical to internally redefine library to avoid nan.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_numthreads">numThreads</code></td>
<td>
<p>number of parallel threads for computation.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="PredictNonlinear_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The localisation parameter <code>theta</code> weights nearest
neighbors according to exp( (-theta D / D_avg) ) where D is the
distance between the observation vector and neighbor, D_avg the mean
distance.  If theta = 0, weights are uniformally unity corresponding
to a global autoregressive model.  As theta increases, neighbors in
closer proximity to the observation are considered. 
</p>


<h3>Value</h3>

<p>A data.frame with columns <code>Theta, rho</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(TentMapNoise)
theta.rho = PredictNonlinear( dataFrame = TentMapNoise, E = 2,
lib = "1 100", pred = "201 500", columns = "TentMap",
target = "TentMap", showPlot = FALSE )
</code></pre>

<hr>
<h2 id='sardine_anchovy_sst'>Time series for the California Current Anchovy-Sardine-SST system</h2><span id='topic+sardine_anchovy_sst'></span>

<h3>Description</h3>

<p>Time series of Pacific sardine landings (CA), Northern anchovy 
landings (CA), and sea-surface temperature (3-year average) at the SIO 
pier and Newport pier
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sardine_anchovy_sst
</code></pre>


<h3>Format</h3>


<dl>
<dt><code>year</code></dt><dd><p>year of measurement</p>
</dd>
<dt><code>anchovy</code></dt><dd><p>anchovy landings, scaled to mean = 0, sd = 1</p>
</dd>
<dt><code>sardine</code></dt><dd><p>sardine landings, scaled to mean = 0, sd = 1</p>
</dd>
<dt><code>sio_sst</code></dt><dd><p>3-year running average of sea surface temperature at 
SIO pier, scaled to mean = 0, sd = 1</p>
</dd>
<dt><code>np_sst</code></dt><dd><p>3-year running average of sea surface temperature at 
Newport pier, scaled to mean = 0, sd = 1</p>
</dd>
</dl>

<hr>
<h2 id='Simplex'>Simplex forecasting</h2><span id='topic+Simplex'></span>

<h3>Description</h3>

<p><code><a href="#topic+Simplex">Simplex</a></code> performs time series forecasting based on
weighted nearest neighbors projection in the time series phase space as
described in <cite>Sugihara and May</cite>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Simplex(pathIn = "./", dataFile = "", dataFrame = NULL, pathOut = "./", 
  predictFile = "", lib = "", pred = "", E = 0, Tp = 1, knn = 0, tau = -1, 
  exclusionRadius = 0, columns = "", target = "", embedded = FALSE,
  verbose = FALSE, validLib = vector(), generateSteps = 0,
  parameterList = FALSE, showPlot = FALSE, noTime = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Simplex_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_pathout">pathOut</code></td>
<td>
<p>path for <code>predictFile</code> containing output predictions.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_predictfile">predictFile</code></td>
<td>
<p>output file name.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_lib">lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_pred">pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="Simplex_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to E+1.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_validlib">validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows.  Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_generatesteps">generateSteps</code></td>
<td>
<p>number of predictive feedback generative steps.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_parameterlist">parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="Simplex_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If embedded is <code>FALSE</code>, the data <code>column(s)</code> are embedded to
dimension <code>E</code> with time lag <code>tau</code>. This embedding forms an
E-dimensional phase space for the <code><a href="#topic+Simplex">Simplex</a></code> projection.
If embedded is <code>TRUE</code>, the data are assumed to contain an
E-dimensional embedding with E equal to the number of <code>columns</code>.
Predictions are made using leave-one-out cross-validation, i.e.
observation vectors are excluded from the prediction simplex. 
</p>
<p>To assess an optimal embedding dimension <code><a href="#topic+EmbedDimension">EmbedDimension</a></code>
can be applied. Accuracy statistics can be estimated by
<code><a href="#topic+ComputeError">ComputeError</a></code>.
</p>


<h3>Value</h3>

<p>A data.frame with columns <code>Observations, Predictions</code>.
The first column contains the time values.
</p>
<p>If <code>parameterList = TRUE</code>, a named list with &quot;predictions&quot; holding the
data.frame, &quot;parameters&quot; with a named list of invoked parameters.
</p>


<h3>References</h3>

<p>Sugihara G. and May R. 1990. Nonlinear forecasting as a way
of distinguishing chaos from measurement error in time series.
Nature, 344:734-741.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data( block_3sp )
smplx = Simplex( dataFrame = block_3sp, lib = "1 100", pred = "101 190",
E = 3, columns = "x_t", target = "x_t" )
ComputeError( smplx $ Predictions, smplx $ Observations )
</code></pre>

<hr>
<h2 id='SMap'>SMap forecasting</h2><span id='topic+SMap'></span>

<h3>Description</h3>

<p><code><a href="#topic+SMap">SMap</a></code> performs time series forecasting based on localised
(or global) nearest neighbor projection in the time series phase space as
described in <cite>Sugihara 1994</cite>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMap(pathIn = "./", dataFile = "", dataFrame = NULL, 
  lib = "", pred = "", E = 0, Tp = 1, knn = 0, tau = -1, 
  theta = 0, exclusionRadius = 0, columns = "", target = "", 
  embedded = FALSE, verbose = FALSE,
  validLib = vector(), ignoreNan = TRUE,
  generateSteps = 0, parameterList = FALSE,
  showPlot = FALSE, noTime = FALSE)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SMap_+3A_pathin">pathIn</code></td>
<td>
<p>path to <code>dataFile</code>.</p>
</td></tr>
<tr><td><code id="SMap_+3A_datafile">dataFile</code></td>
<td>
<p>.csv format data file name. The first column must be a time
index or time values unless noTime is TRUE. The first row must be column names.</p>
</td></tr>
<tr><td><code id="SMap_+3A_dataframe">dataFrame</code></td>
<td>
<p>input data.frame. The first column must be a time
index or time values unless noTime is TRUE. The columns must be named.</p>
</td></tr>
<tr><td><code id="SMap_+3A_lib">lib</code></td>
<td>
<p>string or vector with start and stop indices of input data
rows used to create the library from observations. Mulitple row index
pairs can be specified with each pair defining the first and last
rows of time series observation segments used to create the library.</p>
</td></tr>
<tr><td><code id="SMap_+3A_pred">pred</code></td>
<td>
<p>string with start and stop indices of input data rows used for
predictions. A single contiguous range is supported.</p>
</td></tr>
<tr><td><code id="SMap_+3A_e">E</code></td>
<td>
<p>embedding dimension.</p>
</td></tr>
<tr><td><code id="SMap_+3A_tp">Tp</code></td>
<td>
<p>prediction horizon (number of time column rows).</p>
</td></tr>
<tr><td><code id="SMap_+3A_knn">knn</code></td>
<td>
<p>number of nearest neighbors. If knn=0, knn is set to the
library size.</p>
</td></tr> 
<tr><td><code id="SMap_+3A_tau">tau</code></td>
<td>
<p>lag of time delay embedding specified as number of
time column rows.</p>
</td></tr>
<tr><td><code id="SMap_+3A_theta">theta</code></td>
<td>
<p>neighbor localisation exponent.</p>
</td></tr>
<tr><td><code id="SMap_+3A_exclusionradius">exclusionRadius</code></td>
<td>
<p>excludes vectors from the search space of nearest 
neighbors if their relative time index is within exclusionRadius.</p>
</td></tr>
<tr><td><code id="SMap_+3A_columns">columns</code></td>
<td>
<p>string of whitespace separated column name(s), or vector
of column names used to create the library. If individual column names
contain whitespace place names in a vector, or, append ',' to the name.</p>
</td></tr>
<tr><td><code id="SMap_+3A_target">target</code></td>
<td>
<p>column name used for prediction.</p>
</td></tr>
<tr><td><code id="SMap_+3A_embedded">embedded</code></td>
<td>
<p>logical specifying if the input data are embedded.</p>
</td></tr>
<tr><td><code id="SMap_+3A_verbose">verbose</code></td>
<td>
<p>logical to produce additional console reporting.</p>
</td></tr>
<tr><td><code id="SMap_+3A_validlib">validLib</code></td>
<td>
<p>logical vector the same length as the number of data
rows. Any data row represented in this vector as FALSE, will not be
included in the library.</p>
</td></tr>
<tr><td><code id="SMap_+3A_ignorenan">ignoreNan</code></td>
<td>
<p>logical to internally redefine library to avoid nan.</p>
</td></tr>
<tr><td><code id="SMap_+3A_generatesteps">generateSteps</code></td>
<td>
<p>number of predictive feedback generative steps.</p>
</td></tr>
<tr><td><code id="SMap_+3A_parameterlist">parameterList</code></td>
<td>
<p>logical to add list of invoked parameters.</p>
</td></tr>
<tr><td><code id="SMap_+3A_showplot">showPlot</code></td>
<td>
<p>logical to plot results.</p>
</td></tr>
<tr><td><code id="SMap_+3A_notime">noTime</code></td>
<td>
<p>logical to allow input data with no time column.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>embedded</code> is <code>FALSE</code>, the data <code>column(s)</code> are embedded
to dimension <code>E</code> with time lag <code>tau</code>. This embedding forms an
n-columns * E-dimensional phase space for the <code><a href="#topic+SMap">SMap</a></code> projection.
If embedded is <code>TRUE</code>, the data are assumed to contain an
E-dimensional embedding with E equal to the number of <code>columns</code>.
See the Note below for proper use of multivariate data (number of
<code>columns</code> &gt; 1).
</p>
<p>If <code>ignoreNan</code> is <code>TRUE</code>, the library (<code>lib</code>) is
internally redefined to exclude nan embedding vectors. If
<code>ignoreNan</code> is <code>FALSE</code> no library adjustment is made. The
(<code>lib</code>) can be explicitly specified to exclude nan library vectors.
</p>
<p>Predictions are made using leave-one-out cross-validation, i.e.
observation rows are excluded from the prediction regression.
</p>
<p>In contrast to <code><a href="#topic+Simplex">Simplex</a></code>, <code><a href="#topic+SMap">SMap</a></code> uses all
available neighbors and weights them with an exponential decay
in phase space distance with exponent <code>theta</code>. <code>theta</code>=0
uses all neighbors corresponding to a global autoregressive model.
As <code>theta</code> increases, neighbors closer in vicinity to the
observation are considered. 
</p>


<h3>Value</h3>

<p>A named list with three data.frames
<code>[[predictions, coefficients, singularValues]]</code>.
<code>predictions</code> has columns <code>Observations, Predictions</code>.
The first column contains time or index values.
</p>
<p><code>coefficients</code> data.frame has time or index values in the first column.
Columns 2 through E+2 (E+1 columns) are the SMap coefficients.
</p>
<p><code>singularValues</code> data.frame has time or index values in the first column.
Columns 2 through E+2 (E+1 columns) are the SVD singularValues. The
first value corresponds to the SVD bias (intercept) term.
</p>
<p>If <code>parameterList = TRUE</code> a named list &quot;parameters&quot; is added.
</p>


<h3>Note</h3>

<p><code><a href="#topic+SMap">SMap</a></code> should be called with columns explicitly corresponding to
dimensions E. In the univariate case (number of <code>columns</code> = 1) with
default <code>embedded = FALSE</code>, the time series will be time-delay
embedded to dimension E, SMap coefficients correspond to each dimension. 
</p>
<p>If a multivariate data set is used (number of <code>columns</code> &gt; 1) it
must use <code>embedded = TRUE</code> with E equal to the number of columns.
This prevents the function from internally time-delay embedding the
multiple columns to dimension E.  If the internal time-delay embedding
is performed, then state-space columns will not correspond to the
intended dimensions in the matrix inversion, coefficient assignment,
and prediction. In the multivariate case, the user should first prepare
the embedding (using <code><a href="#topic+Embed">Embed</a></code> for time-delay embedding), then
pass this embedding to <code><a href="#topic+SMap">SMap</a></code> with appropriately specified
<code>columns</code>, <code>E</code>, and <code>embedded = TRUE</code>.
</p>


<h3>References</h3>

<p>Sugihara G. 1994. Nonlinear forecasting for the classification of natural time series. Philosophical Transactions: Physical Sciences and Engineering, 348 (1688):477-495.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(circle)
L = SMap( dataFrame = circle, lib="1 100", pred="110 190", theta = 4,
E = 2, embedded = TRUE, columns = "x y", target = "x" )
</code></pre>

<hr>
<h2 id='SurrogateData'>Generate surrogate data for permutation/randomization tests</h2><span id='topic+SurrogateData'></span>

<h3>Description</h3>

<p><code>SurrogateData</code> generates surrogate data under several different 
null models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurrogateData( ts, method = c("random_shuffle", "ebisuzaki",
"seasonal"), num_surr = 100, T_period = 1, alpha = 0 )
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurrogateData_+3A_ts">ts</code></td>
<td>
<p>the original time series</p>
</td></tr>
<tr><td><code id="SurrogateData_+3A_method">method</code></td>
<td>
<p>which algorithm to use to generate surrogate data</p>
</td></tr>
<tr><td><code id="SurrogateData_+3A_num_surr">num_surr</code></td>
<td>
<p>the number of null surrogates to generate</p>
</td></tr>
<tr><td><code id="SurrogateData_+3A_t_period">T_period</code></td>
<td>
<p>the period of seasonality for seasonal surrogates
(ignored for other methods)</p>
</td></tr>
<tr><td><code id="SurrogateData_+3A_alpha">alpha</code></td>
<td>
<p>additive noise factor: N(0,alpha)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method &quot;random_shuffle&quot; creates surrogates by randomly permuting the values 
of the original time series.
</p>
<p>Method &quot;Ebisuzaki&quot; creates surrogates by randomizing the phases of a Fourier 
transform, preserving the power spectra of the null surrogates.
</p>
<p>Method &quot;seasonal&quot; creates surrogates by computing a mean seasonal trend of 
the specified period and shuffling the residuals.  It is presumed that
the seasonal trend can be exracted with a smoothing spline.  Additive
Gaussian noise is included according to N(0,alpha). 
</p>


<h3>Value</h3>

<p>A matrix where each column is a separate surrogate with the same
length as <code>ts</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("block_3sp")
ts &lt;- block_3sp$x_t
SurrogateData(ts, method = "ebisuzaki")
</code></pre>

<hr>
<h2 id='TentMap'>Time series for a tent map with mu = 2.</h2><span id='topic+TentMap'></span>

<h3>Description</h3>

<p>First-differenced time series generated from the tent map
recurrence relation with mu = 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TentMap
</code></pre>


<h3>Format</h3>

<p>Data frame with 999 rows and 2 columns
</p>

<dl>
<dt><code>Time</code></dt><dd><p>time index.</p>
</dd>
<dt><code>TentMap</code></dt><dd><p>tent map values.</p>
</dd>
</dl>


<hr>
<h2 id='TentMapNoise'>Time series of tent map plus noise.</h2><span id='topic+TentMapNoise'></span>

<h3>Description</h3>

<p>First-differenced time series generated from the tent map
recurrence relation with mu = 2 and random noise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TentMapNoise
</code></pre>


<h3>Format</h3>

<p>Data frame with 999 rows and 2 columns
</p>

<dl>
<dt><code>Time</code></dt><dd><p>time index.</p>
</dd>
<dt><code>TentMap</code></dt><dd><p>tent map values.</p>
</dd>
</dl>


<hr>
<h2 id='Thrips'>Apple-blossom Thrips time series</h2><span id='topic+Thrips'></span>

<h3>Description</h3>

<p>Seasonal outbreaks of Thrips imaginis.
</p>


<h3>References</h3>

<p>Davidson and Andrewartha, Annual trends in a natural population of
Thrips imaginis <em>Thysanoptera</em>, Journal of Animal Ecology, 17,
193-199, 1948.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
