<!DOCTYPE html><html><head><title>Help for package repolr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {repolr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#achilles'><p>Achilles Tendon Rupture</p></a></li>
<li><a href='#begonia'><p>Begonia Pot Plant Quality Scores</p></a></li>
<li><a href='#confint.repolr'>
<p>Confidence Intervals for repolr Model Parameters</p></a></li>
<li><a href='#HHSpain'><p>Harris Hip Pain Scores</p></a></li>
<li><a href='#mobility'><p>Mobility after Hip Fracture Fixation Surgery</p></a></li>
<li><a href='#ord.expand'><p>Expand Ordinal Data for Model Fitting with repolr</p></a></li>
<li><a href='#polycuts'>
<p>Estimates Cut-point Parameters for Fitted repolr Model</p></a></li>
<li><a href='#predict.repolr'>
<p>Predict Method for Fitted repolr Model</p></a></li>
<li><a href='#QIC'><p>Quasilikelihood Information Criterion</p></a></li>
<li><a href='#QoL'><p>Quality of Life Scores</p></a></li>
<li><a href='#repolr-package'>
<p>Repeated Measures Proportional Odds Logistic Regression using GEE</p></a></li>
<li><a href='#summary.repolr'>
<p>Summary of Fitted repolr Model</p></a></li>
<li><a href='#vcov.repolr'>
<p>Calculates the Variance-Covariance Matrix for Fitted repolr Model</p></a></li>
<li><a href='#work.corr'>
<p>Working Correlation Matrix for Fitted repolr Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Repeated Measures Proportional Odds Logistic Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>3.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-02-26</td>
</tr>
<tr>
<td>Author:</td>
<td>Nick Parsons</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nick Parsons &lt;nick.parsons@warwick.ac.uk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits linear models to repeated ordinal scores using GEE methodology.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.11.3), Matrix, methods</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-02-26 08:36:36 UTC; mlsgbf</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-02-27 10:11:34</td>
</tr>
</table>
<hr>
<h2 id='achilles'>Achilles Tendon Rupture</h2><span id='topic+achilles'></span>

<h3>Description</h3>

<p>EuroQol activity scores, measured on a three point ordinal score scale, post-surgery for 48 patients at three occasions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(achilles)</code></pre>


<h3>Format</h3>

<p>A data frame with 144 observations on the following four variables.
</p>

<dl>
<dt><code>Patient</code></dt><dd><p>a patient identifier variable.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>post-surgery treatments are either immediate mobilisation in a carbon-fibre orthosis with three 1.5cm heel raises (1) or traditional plaster cast immobilisation (2).</p>
</dd>
<dt><code>Time</code></dt><dd><p>recorded at baseline (1), six months (2) and one year (3) post-surgery.</p>
</dd>
<dt><code>Activity</code></dt><dd><p>ability to undertake usual activities post-surgery; this was scored by each patient as either no problem (1), some problem (2) or an inability (3) to perform usual activity (e.g. work, leisure, housework etc).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Costa, M.L., MacMillan, K., Halliday, D., Chester, R., Shepstone, L., Robinson, A.H.N., Donell, S.T. (2006). Randomised controlled trials of immediate weight-bearing mobilisation for rupture of the tendon Achillis. <em>Journal of Bone and Joint Surgery (British)</em> 88-B, 69-77.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(achilles)
head(achilles)
</code></pre>

<hr>
<h2 id='begonia'>Begonia Pot Plant Quality Scores</h2><span id='topic+begonia'></span>

<h3>Description</h3>

<p>Begonia pot plant quality scores (for 2 varieties and 3 transport chains), during 5 weeks in simulated shelf-life conditions (temperature, light and irrigation). Quality scores were originally made on an ordinal scale from 1 to 10 (highest quality). However, only categories 2 to 9 were used, so these were re-coded to scale from 1 to 8. In addition to overall quality scores, a range of plant physiological characteristics were also observed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(begonia)</code></pre>


<h3>Format</h3>

<p>A data frame with 720 observations on the following variables.
</p>

<dl>
<dt><code>Pot</code></dt><dd><p>pot plant identifier; 1 to 144.</p>
</dd>
<dt><code>Plot</code></dt><dd><p>location in growing compartment; 1 to 48.</p>
</dd>
<dt><code>Week</code></dt><dd><p>week number in simulated shelf-life; 1 to 5.</p>
</dd>
<dt><code>Temp</code></dt><dd><p>temperature in compartment; <code>16C</code> or <code>21C</code>.</p>
</dd>
<dt><code>Light</code></dt><dd><p>light level in compartment; <code>High</code> or <code>Low</code>.</p>
</dd>
<dt><code>Chain</code></dt><dd><p>transport chain; <code>Cold</code>, <code>Comm</code> (commercial) or <code>Optm</code> (optimum).</p>
</dd>
<dt><code>Irrig</code></dt><dd><p>irrigation in compartment; <code>Cont</code> (control) or <code>Fluct</code> (fluctuating).</p>
</dd>    
<dt><code>Variety</code></dt><dd><p>variety; <code>Balli</code> or <code>Batik</code>.</p>
</dd>
<dt><code>Qual</code></dt><dd><p>quality score; 1 to 8.</p>
</dd>
<dt><code>FDrop</code></dt><dd><p>count of dropped flowers.</p>
</dd>
<dt><code>CBDrop</code></dt><dd><p>count of dropped coloured buds.</p>
</dd>
<dt><code>GBDrop</code></dt><dd><p>count of dropped green buds.</p>
</dd>
<dt><code>FDam</code></dt><dd><p>count of damaged flowers.</p>
</dd>    
<dt><code>FSing</code></dt><dd><p>count of single flowers.</p>
</dd>
<dt><code>FDoub</code></dt><dd><p>count of double flowers.</p>
</dd>
<dt><code>LYell</code></dt><dd><p>count of yellow leaves.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Parsons NR, Edmondson RN, Gilmour SG. A generalized estimating equation method for fitting autocorrelated ordinal score data with an application in horticultural research. <em>Journal of the Royal Statistical Society C</em> 2006; 55:507-524.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(begonia)
head(begonia)
</code></pre>

<hr>
<h2 id='confint.repolr'>
Confidence Intervals for repolr Model Parameters
</h2><span id='topic+confint.repolr'></span>

<h3>Description</h3>

<p>Computes confidence intervals for one or more parameters in a fitted <code>repolr</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'repolr'
confint(object, parm, level = 0.95, robust.var = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.repolr_+3A_object">object</code></td>
<td>
<p>is a model fitted using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="confint.repolr_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be used, either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.repolr_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.repolr_+3A_robust.var">robust.var</code></td>
<td>
<p>logical; if <code>TRUE</code>, intervals are based on the robust variance matrix.</p>
</td></tr>
<tr><td><code id="confint.repolr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>The method assumes normality and uses as default the estimated robust variance matrix.
</p>


<h3>Value</h3>

<p>A matrix (or vector) with columns giving lower and upper confidence limits for each parameter.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
confint(mod.0, robust.var = FALSE)
</code></pre>

<hr>
<h2 id='HHSpain'>Harris Hip Pain Scores</h2><span id='topic+HHSpain'></span>

<h3>Description</h3>

<p>Harris hip pain scores, measured on a four point ordinal score scale, post-surgery for 58 patients at three occasions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(HHSpain)</code></pre>


<h3>Format</h3>

<p>A data frame with 174 observations on the following four variables.
</p>

<dl>
<dt><code>Patient</code></dt><dd><p>a patient identifier variable.</p>
</dd>
<dt><code>Sex</code></dt><dd><p>a factor with levels <code>F</code> or <code>M</code></p>
</dd>
<dt><code>Time</code></dt><dd><p>recorded at baseline (1), two years (2) and five years (5) post-surgery.</p>
</dd>
<dt><code>HHSpain</code></dt><dd><p>a pain score coded as none (1), slight (2), mild (3) and moderate or marked (4).</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(HHSpain)
head(HHSpain)
</code></pre>

<hr>
<h2 id='mobility'>Mobility after Hip Fracture Fixation Surgery</h2><span id='topic+mobility'></span>

<h3>Description</h3>

<p>Patient mobility score after hip fracture fixation surgery, using two distinct procedures. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mobility)</code></pre>


<h3>Format</h3>

<p>A data frame with 600 observations on the following variables.
</p>

<dl>
<dt><code>subject</code></dt><dd><p>patient identifier.</p>
</dd>
<dt><code>time</code></dt><dd><p>assessemnt occasions; month 1, 2, 3 and 4.</p>
</dd>
<dt><code>treat</code></dt><dd><p>intervention group; <code>A</code> or <code>B</code>.</p>
</dd>
<dt><code>age</code></dt><dd><p>patient age in years.</p>
</dd>
<dt><code>gender</code></dt><dd><p>gender; <code>F</code> or <code>M</code>.</p>
</dd>
<dt><code>mobility</code></dt><dd><p>mobility score; 1, 2 and 3.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(mobility)
head(mobility)
</code></pre>

<hr>
<h2 id='ord.expand'>Expand Ordinal Data for Model Fitting with repolr</h2><span id='topic+ord.expand'></span>

<h3>Description</h3>

<p>Expands ordinal score data into an appropriate form, <em>K</em>-1 new binary variables for an ordinal score with <em>K</em> categories, for model fitting using <code>repolr</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ord.expand(space, formula, times, poly, data, subjects, categories)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ord.expand_+3A_space">space</code></td>
<td>
<p>a vector indicating the category spacing when fitting the polynomial model.</p>
</td></tr>
<tr><td><code id="ord.expand_+3A_formula">formula</code></td>
<td>
<p>a formula, as for other regression models.</p>
</td></tr>
<tr><td><code id="ord.expand_+3A_times">times</code></td>
<td>
<p>a vector of times which occur within subject clusters.</p>
</td></tr>
<tr><td><code id="ord.expand_+3A_poly">poly</code></td>
<td>
<p>a numeric variable indicating the order of the polynomial contrasts used for the cut-point model.</p>
</td></tr>  
<tr><td><code id="ord.expand_+3A_data">data</code></td>
<td>
<p>a dataframe in which to interpret the variables occurring in the formula.</p>
</td></tr>
<tr><td><code id="ord.expand_+3A_subjects">subjects</code></td>
<td>
<p>a character string specifying the name of the subject variable.</p>
</td></tr>
<tr><td><code id="ord.expand_+3A_categories">categories</code></td>
<td>
<p>a numeric variable indicating the number of ordinal score categories.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For internal use with <code>repolr</code>.
</p>


<h3>Value</h3>

<p>An expanded dataframe.
</p>

<hr>
<h2 id='polycuts'>
Estimates Cut-point Parameters for Fitted repolr Model
</h2><span id='topic+polycuts'></span>

<h3>Description</h3>

<p>After fitting a model using <code>repolr</code>, function <code>polycuts</code> gives estimates and standard errors for the <em>K</em>-1 cut-point parameters, based on the polynomial model from the fit of <code>repolr</code>. Polynomial cut-point parameter estimates from the orginal model are also shown.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polycuts(object, digits = 3, robust.var = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polycuts_+3A_object">object</code></td>
<td>
<p>is a model fitted using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="polycuts_+3A_digits">digits</code></td>
<td>
<p>the number of decimal places to display in reported summaries.</p>
</td></tr>
<tr><td><code id="polycuts_+3A_robust.var">robust.var</code></td>
<td>
<p>a logical variable: if <code>TRUE</code> standard errors are based on robust variance estimates, otherwise naive estimates are used.</p>
</td></tr>  
</table>


<h3>Value</h3>

<table>
<tr><td><code>coef</code></td>
<td>
<p>polynomial parameter estimates from <code>repolr</code>.</p>
</td></tr>
<tr><td><code>poly</code></td>
<td>
<p>a vector of <em>K</em>-1 cut-point parameters.</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p>the order of the polynomial.</p>
</td></tr> 
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
summary(mod.0)
mod.1 &lt;- update(mod.0, poly=1)
summary(mod.1)
polycuts(mod.1)
mod.2 &lt;- update(mod.0, poly=2)
summary(mod.2)
polycuts(mod.2)

</code></pre>

<hr>
<h2 id='predict.repolr'>
Predict Method for Fitted repolr Model
</h2><span id='topic+predict.repolr'></span>

<h3>Description</h3>

<p>Calculates predictions and standard errors of predictions for a fitted <code>repolr</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'repolr'
predict(object, newdata = NULL, se.fit = FALSE,
           robust.var = TRUE, type = c("link", "response", "terms"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.repolr_+3A_object">object</code></td>
<td>
<p>is a model fitted using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="predict.repolr_+3A_newdata">newdata</code></td>
<td>
<p>optionally, a data frame in which to find variables with which to predict; if missing the model fitted values are reported.</p>
</td></tr>
<tr><td><code id="predict.repolr_+3A_se.fit">se.fit</code></td>
<td>
<p>Logical indicating if standard errors are required.</p>
</td></tr>
<tr><td><code id="predict.repolr_+3A_robust.var">robust.var</code></td>
<td>
<p>logical; if <code>TRUE</code>, standard errors are based on the robust variance matrix.</p>
</td></tr>  
<tr><td><code id="predict.repolr_+3A_type">type</code></td>
<td>
<p>is the type of prediction required. The default &ldquo;<code>link</code>&rdquo; is to use the scale of the linear predictors; i.e. the log-odds of cumulative probabilities. The alternative is to report the predicted cumulative probabilities; &ldquo;<code>response</code>&rdquo;. The &ldquo;<code>terms</code>&rdquo; option returns the matrix of fitted values for each model term on the scale of the linear predictor.</p>
</td></tr>
<tr><td><code id="predict.repolr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>If newdata is missing predictions are based on the data used to fit the <code>repolr</code> model. If newdata are supplied then the format of these data must conform to the same format required for model fitting using <code>repolr</code>. See <code><a href="#topic+repolr">repolr</a></code> for details.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fit</code></td>
<td>
<p>Predictions.</p>
</td></tr>
<tr><td><code>se.fit</code></td>
<td>
<p>Estimated standard errors.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
predict(mod.0, newdata = data.frame(Patient = rep(100, 3), Time = c(1, 2, 5),
       Sex = factor(rep(1, 3), levels=1:2, labels=c("F", "M"))), 
       type="link", se.fit = TRUE)
</code></pre>

<hr>
<h2 id='QIC'>Quasilikelihood Information Criterion</h2><span id='topic+QIC'></span>

<h3>Description</h3>

<p>The quasilikelihood information criterion (QIC) developed by Pan (2001) is a modification of the Akaike information criterion (AIC) for models fitted by GEE. <code>QIC</code> is used for choosing the best correaltion structure and <code>QICu</code> is used for choosing the best subset of covariates. The quasilikelihood (<code>QLike</code>) is also reported for completeness. When choosing between two or more models, with different subset of covariates, the one with the smallest <code>QICu</code> measure is preferred and similarly, when choosing between competing correlation structures, with the same subset of covariates in both, the model with the smallest <code>QIC</code> measure is preferred.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QIC(object, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="QIC_+3A_object">object</code></td>
<td>
<p>is a fitted model using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="QIC_+3A_digits">digits</code></td>
<td>
<p>the number of decimal places to display in reported summaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>QLike</code></td>
<td>
<p>model quasilikelihood.</p>
</td></tr>
<tr><td><code>QIC</code></td>
<td>
<p>model <code>QIC</code>.</p>
</td></tr>
<tr><td><code>QICu</code></td>
<td>
<p>model <code>QICu</code>.</p>
</td></tr> 
</table>


<h3>References</h3>

<p>Pan W. Akaikes information criterion in generalized estimating equations. <em>Biometrics</em> 2001; 57:120-125.<br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="independence", alpha=0.5)
QIC(mod.0)
QIC(update(mod.0, formula = HHSpain~Time + Sex))$QICu
QIC(update(mod.0, formula = HHSpain~Time * Sex))$QICu

</code></pre>

<hr>
<h2 id='QoL'>Quality of Life Scores</h2><span id='topic+QoL'></span>

<h3>Description</h3>

<p>Quality of life scores after hip replacement.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(QoL)</code></pre>


<h3>Format</h3>

<p>A data frame with 336 observations on the following four variables.
</p>

<dl>
<dt><code>QoL</code></dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Patient</code></dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Time</code></dt><dd><p>a numeric vector.</p>
</dd>
<dt><code>Treat</code></dt><dd><p>a factor with levels <code>A</code> <code>B</code>.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(QoL)
head(QoL)
</code></pre>

<hr>
<h2 id='repolr-package'>
Repeated Measures Proportional Odds Logistic Regression using GEE</h2><span id='topic+repolr-package'></span><span id='topic+repolr'></span><span id='topic+print.repolr'></span><span id='topic+coef.repolr'></span><span id='topic+fitted.repolr'></span><span id='topic+model.matrix.repolr'></span><span id='topic+terms.repolr'></span><span id='topic+residuals.repolr'></span><span id='topic+smat'></span><span id='topic+cmat'></span><span id='topic+alphpow'></span><span id='topic+hgmat'></span><span id='topic+ordgee'></span><span id='topic+upalpha'></span><span id='topic+icormat'></span><span id='topic+potest'></span>

<h3>Description</h3>

<p>The package allows regression models to be fitted to repeated ordinal scores, for the proportional odds model, using a generalized estimating equation (GEE) methodology. The algorithm estimates the correlation parameter by minimizing the generalized variance of the regression parameters at each step of the fitting algorithm. Parameter estimation is available for the uniform and first-order autoregressive correlation models, for data potentially recorded at irregularly spaced time intervals. A test for the proportional odds assumption is available, as is an option to fit a polynomial model to the the cut-point parameters.</p>


<h3>Usage</h3>

<pre><code class='language-R'>repolr(formula, subjects, data, times, categories, corr.mod = "independence",
         alpha = 0.5, po.test = FALSE, fixed = FALSE, poly = NULL, 
         space = NULL, diffmeth = "analytic", fit.opt = rep(NA, 5))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repolr-package_+3A_formula">formula</code></td>
<td>
<p>a formula, as for other regression models.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_subjects">subjects</code></td>
<td>
<p>a character string specifying the name of the subject variable.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_data">data</code></td>
<td>
<p>a dataframe in which to interpret the variables occurring in the formula.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_times">times</code></td>
<td>
<p>a vector of times which occur within subject clusters; e.g. for four evenly spaced times c(1, 2, 3, 4).</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_categories">categories</code></td>
<td>
<p>a numeric variable indicating the number of ordinal score categories.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_corr.mod">corr.mod</code></td>
<td>
<p>a character string specifying the correlation structure. The following are permitted: &ldquo;<code>ar1</code>&rdquo;, &ldquo;<code>uniform</code>&rdquo; and &ldquo;<code>independence</code>&rdquo;.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_alpha">alpha</code></td>
<td>
<p>an initial value for the correlation parameter.</p>
</td></tr>  
<tr><td><code id="repolr-package_+3A_po.test">po.test</code></td>
<td>
<p>a logical variable; if true a score test for proportional odds is reported.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_fixed">fixed</code></td>
<td>
<p>a logical variable; if true the correlation is fixed at the initial value (<code>alpha</code>) during model fitting.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_poly">poly</code></td>
<td>
<p>a numeric variable indicating the order of the polynomial contrasts used for the cut-point model.</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_space">space</code></td>
<td>
<p>a vector indicating the category spacing when fitting the polynomial model; can generally be set to 1:<code>categories</code></p>
</td></tr>
<tr><td><code id="repolr-package_+3A_diffmeth">diffmeth</code></td>
<td>
<p>a character string specifying the method used for estimation of <code>alpha</code>. The folowing are available:&ldquo;<code>analytic</code>&rdquo; and &ldquo;<code>numeric</code>&rdquo;</p>
</td></tr>
<tr><td><code id="repolr-package_+3A_fit.opt">fit.opt</code></td>
<td>
<p>a vector of options to control the behaviour of the fitting algorithm.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>repolr</code> function fits models for repeated ordinal scores using GEE methodology.
</p>
<p>The user is required to specify, as a minimum: (i) a data set name (<code>data</code>), (ii) a model formula (<code>formula</code>), (iii) a cluster identification variable (<code>subjects</code>), (iv) a time variable (<code>time</code>) and (v) the number of categories used for the response variable (<code>categories</code>). 
</p>
<p>The data may contain records with missing data for either the response variable or the explanatory variables. The response variable must have at least three ordered categories (<em>K</em> greater than or equal to 3) and, as <em>K</em>-1 cut-point parameters are estimated, an additional intercept term can not be explicitly included in the model formula. A subject variable, which takes integer values from 1 to <em>N</em> with no missing values allowed, indicates the data clusters (patients or experimental units) and a time variable indicates the within cluster ordering; times must be ordered integers starting from one and spaced to indicate the relative distance between successive times. For instance, four observations at equally spaced times would be entered as 1, 2, 3 and 4, whereas if the first two observations were separated by half the time interval of the other observations then coding would be 1, 2, 4 and 6. The data must be pre-sorted by time clusters within each subject, and complete, i.e. where data is missing for a particular time it must be indicated as such. the datasets provided with this package provide exemplars of the required data formatting; e.g. <code><a href="#topic+HHSpain">HHSpain</a></code> and <code><a href="#topic+QoL">QoL</a></code>.
</p>
<p>The available options for the correlation model (<code>corstr</code>) are AR1, uniform, fixed and independence, with default setting independence. 
</p>
<p>Additionally there are a number of other algorithm related options.
</p>
<p>The algorithm is generally robust to the initial value for <code>alpha</code> (default setting = 0.5), where estimation is rerquired, however a starting value for <code>alpha</code> can be set. If required the correlation parameter, set via <code>alpha</code>, can be fixed throughout model fitting, and not updated, by setting the option <code>fixed</code> to <code>TRUE</code>.
</p>
<p>The partial derivatives of the log of the determinant of the robust variance matrix (generalized variance), with respect to <code>alpha</code>, can either be determined analytically (&ldquo;<code>analytic</code>&rdquo; setting for <code>diffmeth</code>) or numerically by finite differencing (&ldquo;<code>numeric</code>&rdquo; setting for <code>diffmeth</code>). The latter method is often quicker for complex regression models, or if <em>K</em> is large.
</p>
<p>Function <code>poly</code>, specifies the order of fitted orthogonal polynomial contrasts for the cut-point parameters; the default setting for <span class="pkg">repolr</span> is to fit the complete set of cut-point parameters. Fitting polynomial contrasts can be particularly useful for long ordinal scores, where <em>K</em> is large, or where a particular form for the cut-point parameters is preferred; e.g. increasing  uniformly at the extremes of the score scale. The order of the polynomial must be an integer less than  <em>K</em>-1. The function requires one additional argument, <code>space</code>, that indicates the spacing between categories. This is normally set to 1:<code>categories</code> when all categories are observed, but can be modified to provide more realsitic models if for instance some categories are not observed.
</p>
<p>The proportional odds assumption can be tested, using a score test, by setting the option <code>po.test</code> to TRUE.
</p>
<p>The <code>fit.opt</code> argument provides control of the fitting algorithm; the defaults are
</p>
<p><code>c(cmaxit = 10, omaxit = 5, ctol = 0.001, otol = 0.00001, h = 0.01)</code>.
</p>
<p>These control the maximum number of iterations for updating estimates of <code>alpha</code>, the maximum number of iterations for updating the regression parameters within each of the updating steps for <code>alpha</code>, the convergence tolerances for estimation of <code>alpha</code> and the regression parameters, and the interval <code>h</code> for finite differencing, if the &ldquo;<code>numeric</code>&rdquo; option is selected.
</p>
<p>Model fitting is implemented via a suite of of functions developed using <span class="pkg">RcppArmadillo</span> (<span class="pkg">Rcpp</span>) that construct correlations between derived binary variables at each time-point (<code>smat</code>) and between time-points (<code>cmat</code>). Complete (sparse) model covariance matrices are constructed using <code>hgmat</code> and <code>alphpow</code>, with model parameter estimation implemented in <code>ordgee</code>, using current estimates of the inverse of the correlation matrix from <code>icormat</code>. Function <code>upalpha</code> provides updates of  correlation parameter estimates, and <code>potest</code> implements the test of proportional odds. These functions are not documented in detail here as they are primarily for internal use within <span class="pkg">repolr</span>. There use outside of this setting is not recommended. 
</p>


<h3>Value</h3>

<p>The function <code>summary.repolr</code> is used to obtain and print a summary of the fitted model.
</p>
<p>The fitted model is an object of class &ldquo;<code>repolr</code>&rdquo; and has the following values:
</p>
<table>
<tr><td><code>poly.mod</code></td>
<td>
<p>polynomial model for cut points: a <code>list</code> with elements
<code>poly</code>, <code>polycuts</code> and <code>space</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response variable.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>a vector of linear predictors.</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>a vector of the fitted values.</p>
</td></tr>
<tr><td><code>coefficients</code></td>
<td>
<p>a named vector of regression coefficients.</p>
</td></tr>
<tr><td><code>robust.var</code></td>
<td>
<p>the robust (sandwich) variance matrix.</p>
</td></tr>
<tr><td><code>naive.var</code></td>
<td>
<p>the naive variance matrix.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>an estimate of the correlation parameter.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>a logical variable to reported if convergence was achieved.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations.</p>
</td></tr>
<tr><td><code>grad1</code></td>
<td>
<p>first derivative of generalized variance at convergence.</p>
</td></tr>
<tr><td><code>grad2</code></td>
<td>
<p>second derivative of generalized variance at convergence.</p>
</td></tr>
<tr><td><code>crit</code></td>
<td>
<p>convergence criterion.</p>
</td></tr>
<tr><td><code>po.test</code></td>
<td>
<p>results of po test: a <code>list</code> with elements
<code>po.stat</code>, <code>po.df</code> and <code>po.chi</code>.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Parsons NR, Costa ML, Achten J, Stallard N. Repeated measures proportional odds logistic regression analysis of ordinal score data in the statistical software package R. <em>Computational Statistics and Data Analysis</em> 2009; 53:632-641.<br />
</p>
<p>Parsons NR, Edmondson RN, Gilmour SG. A generalized estimating equation method for fitting autocorrelated ordinal score data with an application in horticultural research. <em>Journal of the Royal Statistical Society C</em> 2006; 55:507-524.<br />
</p>
<p>Stiger TR, Barnhart HX, Williamson JM. Testing proportionality in the proportional odds model fitted with GEE. <em>Statistics in Medicine</em> 1999; 18:1419-1433.<br />
</p>
<p>Parsons NR. Proportional-odds models for repeated composite and long ordinal outcome scales. <em>Statistics in Medicine</em> 2013; 32:3181-3191.<br />
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QIC">QIC</a></code>, <code><a href="#topic+polycuts">polycuts</a></code>, <code><a href="#topic+work.corr">work.corr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
summary(mod.0)
summary(update(mod.0, diffmeth = "numeric"))
summary(update(mod.0, fixed = TRUE, alpha =0.5))

</code></pre>

<hr>
<h2 id='summary.repolr'>
Summary of Fitted repolr Model
</h2><span id='topic+summary.repolr'></span><span id='topic+print.summary.repolr'></span>

<h3>Description</h3>

<p>Function to summarise the fit of a repolr model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'repolr'
summary(object, digits, robust.var, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.repolr_+3A_object">object</code></td>
<td>
<p>fitted model.</p>
</td></tr>
<tr><td><code id="summary.repolr_+3A_digits">digits</code></td>
<td>
<p>integer for number formatting.</p>
</td></tr>
<tr><td><code id="summary.repolr_+3A_robust.var">robust.var</code></td>
<td>
<p>logical; if <code>TRUE</code>, standard errors are based on robust variance estimates</p>
</td></tr>
<tr><td><code id="summary.repolr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Default is to use robust variance estimates. However, if <code>robust.var</code> is set to <code>FALSE</code>, naive variance estimates are used.
</p>

<hr>
<h2 id='vcov.repolr'>
Calculates the Variance-Covariance Matrix for Fitted repolr Model 
</h2><span id='topic+vcov.repolr'></span>

<h3>Description</h3>

<p>Returns the variance-covariance matrix of the main parameters of a fitted <code>repolr</code> model object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'repolr'
vcov(object, robust.var = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.repolr_+3A_object">object</code></td>
<td>
<p>is a model fitted using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="vcov.repolr_+3A_robust.var">robust.var</code></td>
<td>
<p>logical; if <code>TRUE</code>, outputs the robust variance matrix.</p>
</td></tr>
<tr><td><code id="vcov.repolr_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Default is to output the estimated robust variance matrix. However, if <code>robust.var</code> is set to <code>FALSE</code>, the naive variance matrix is reported.
</p>


<h3>Value</h3>

<p>A matrix of the estimated covariances between the parameter estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
vcov(mod.0, robust.var = FALSE)
</code></pre>

<hr>
<h2 id='work.corr'>
Working Correlation Matrix for Fitted repolr Model
</h2><span id='topic+work.corr'></span>

<h3>Description</h3>

<p>The working correlation matrix for the selected model; &ldquo;<code>ar1</code>&rdquo;, &ldquo;<code>uniform</code>&rdquo; or &ldquo;<code>independence</code>&rdquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>work.corr(object, digits = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="work.corr_+3A_object">object</code></td>
<td>
<p>is a model fitted using <code>repolr</code>.</p>
</td></tr>
<tr><td><code id="work.corr_+3A_digits">digits</code></td>
<td>
<p>integer for number formatting.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <em>T</em>(<em>K</em>-1) correlation matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HHSpain)
mod.0 &lt;- repolr(HHSpain~Sex*Time, data=HHSpain, categories=4, subjects="Patient",
            times=c(1,2,5), corr.mod="uniform", alpha=0.5)
work.corr(mod.0)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
