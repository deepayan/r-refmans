<!DOCTYPE html><html lang="en-US"><head><title>Help for package eia</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eia}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eia'><p>eia: EIA API wrapper</p></a></li>
<li><a href='#eia_clear_cache'><p>Clear API results cache</p></a></li>
<li><a href='#eia_data'><p>EIA data</p></a></li>
<li><a href='#eia_dir'><p>EIA directory</p></a></li>
<li><a href='#eia_facets'><p>EIA facets</p></a></li>
<li><a href='#eia_key'><p>Set and get API key</p></a></li>
<li><a href='#eia_metadata'><p>EIA metadata</p></a></li>
<li><a href='#eiadate'><p>EIA date parsing</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>API Wrapper for U.S. Energy Information Administration ('EIA')
Open Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides API access to data from the U.S. Energy Information Administration ('EIA') <a href="https://www.eia.gov/">https://www.eia.gov/</a>.
    Use of the EIA's API and this package requires a free API key obtainable at <a href="https://www.eia.gov/opendata/register.php">https://www.eia.gov/opendata/register.php</a>.
    This package includes functions for searching the EIA data directory and returning time series and geoset time series datasets.
    Datasets returned by these functions are provided by default in a tidy format, or alternatively, in more raw formats.
    It also offers helper functions for working with EIA date strings and time formats and for inspecting different summaries of series metadata.
    The package also provides control over API key storage and caching of API request results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://docs.ropensci.org/eia/">https://docs.ropensci.org/eia/</a>, <a href="https://github.com/ropensci/eia">https://github.com/ropensci/eia</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ropensci/eia/issues">https://github.com/ropensci/eia/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>tibble, httr, jsonlite, memoise, lubridate</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, covr, rmarkdown, dplyr, tidyr,
ggplot2, spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-15 16:05:25 UTC; mghoff</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Leonawicz <a href="https://orcid.org/0000-0001-9452-2771"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Matthew Hoff [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Hoff &lt;matthew.g.hoff@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-15 19:10:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='eia'>eia: EIA API wrapper</h2><span id='topic+eia'></span><span id='topic+eia-package'></span>

<h3>Description</h3>

<p>This package provides API access to data from the US
<a href="https://www.eia.gov/">Energy Information Administration</a> (EIA).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Matthew Hoff <a href="mailto:matthew.g.hoff@gmail.com">matthew.g.hoff@gmail.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Matthew Leonawicz (<a href="https://orcid.org/0000-0001-9452-2771">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://docs.ropensci.org/eia/">https://docs.ropensci.org/eia/</a>
</p>
</li>
<li> <p><a href="https://github.com/ropensci/eia">https://github.com/ropensci/eia</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ropensci/eia/issues">https://github.com/ropensci/eia/issues</a>
</p>
</li></ul>


<hr>
<h2 id='eia_clear_cache'>Clear API results cache</h2><span id='topic+eia_clear_cache'></span><span id='topic+eia_clear_dir'></span><span id='topic+eia_clear_metadata'></span><span id='topic+eia_clear_data'></span><span id='topic+eia_clear_facets'></span>

<h3>Description</h3>

<p>Reset the results of API calls that are currently cached in memory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_clear_cache()

eia_clear_dir()

eia_clear_metadata()

eia_clear_data()

eia_clear_facets()
</code></pre>


<h3>Details</h3>

<p><code>eia_clear_cache()</code> clears the entire cache. The other functions clear the
cache associated with specific endpoints.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
key &lt;- Sys.getenv("EIA_KEY") # your stored API key
system.time(eia_dir(key))
system.time(eia_dir(key))
eia_clear_cache()
system.time(eia_dir(key))

## End(Not run)
</code></pre>

<hr>
<h2 id='eia_data'>EIA data</h2><span id='topic+eia_data'></span>

<h3>Description</h3>

<p>Obtain data from the EIA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_data(
  dir,
  data = NULL,
  facets = NULL,
  freq = NULL,
  start = NULL,
  end = NULL,
  sort = NULL,
  length = NULL,
  offset = NULL,
  tidy = TRUE,
  check_metadata = FALSE,
  cache = TRUE,
  key = eia_get_key()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eia_data_+3A_dir">dir</code></td>
<td>
<p>character, directory path.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_data">data</code></td>
<td>
<p>character or <code>NULL</code>,
</p>

<ul>
<li><p> note: if <code>NULL</code>, <code>eia_data()</code> will only return column headings; must input a character value
as provided by <code>eia_metadata()</code> for data to be returned.
</p>
</li>
<li><p> see details.
</p>
</li></ul>
</td></tr>
<tr><td><code id="eia_data_+3A_facets">facets</code></td>
<td>
<p>character list or <code>NULL</code>, see details.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_freq">freq</code></td>
<td>
<p>character or <code>NULL</code>, see details.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_start">start</code>, <code id="eia_data_+3A_end">end</code></td>
<td>
<p>character or <code>NULL</code>, see details.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_sort">sort</code></td>
<td>
<p>named list of two.
</p>

<ul>
<li> <p><code>cols</code>: list column names on which to sort.
</p>
</li>
<li> <p><code>order</code>: <code>"asc"</code> or <code>"desc"</code> for ascending or descending, respectively.
</p>
</li></ul>
</td></tr>
<tr><td><code id="eia_data_+3A_length">length</code></td>
<td>
<p>numeric or <code>NULL</code>, number of rows to return.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_offset">offset</code></td>
<td>
<p>numeric or <code>NULL</code>, number of rows to skip before return.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_tidy">tidy</code></td>
<td>
<p>logical or <code>NULL</code>, return a tidier result. See details.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_check_metadata">check_metadata</code></td>
<td>
<p>logical, if <code>TRUE</code> checks input values against metadata endpoint.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_cache">cache</code></td>
<td>
<p>logical, cache result for duration of R session using memoization.
See details.</p>
</td></tr>
<tr><td><code id="eia_data_+3A_key">key</code></td>
<td>
<p>API key: character if set explicitly; not needed if key is set
globally. See <code>eia_set_key()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, <code>data</code>, <code>facets</code>, and <code>freq</code> are set to <code>NULL</code>. To obtain valid
input values for each of these arguments, use the specific ID labels
as provided by <code>eia_metadata()</code>.
</p>
<p>The use of <code>start</code> and <code>end</code> require some input to <code>freq</code>.
By default (<code>check_metadata = FALSE</code>), the resulting data will match the
temporal resolution provided to <code>freq</code>, however, <code>check_metadata = TRUE</code> applies
further restrictions such that the format of values provided to <code>start</code>/<code>end</code> must match
that of <code>freq</code>. Furthermore, regardless of the input format provided to <code>start</code>/<code>end</code>,
the resulting data will always match the specification of <code>freq</code>. And lastly,
regardless of chosen format, <code>end</code> must be strictly greater than <code>start</code> to return data.
</p>
<p>By default, additional processing is done to return a list containing tibble data frames.
Set <code>tidy = FALSE</code> to return only the initial list result of <code>jsonlite::fromJSON</code>.
Set <code>tidy = NA</code> to return the original JSON as a character string.
</p>
<p>Set to <code>cache = FALSE</code> to force a new API call for updated data.
Using <code>FALSE</code> always makes a new API call and returns the result from the server.
<code>TRUE</code> uses memoization on a per R session basis, caching the result of the
function call in memory for the duration of the R session.
You can reset the entire cache by calling <code>eia_clear_cache()</code>.
</p>


<h3>Value</h3>

<p>data frame
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
eia_data(
  dir = "electricity/retail-sales",
  data = "price",
  facets = list(sectorid = c("COM", "RES"), stateid = "OH")
)

## End(Not run)
</code></pre>

<hr>
<h2 id='eia_dir'>EIA directory</h2><span id='topic+eia_dir'></span>

<h3>Description</h3>

<p>Obtain EIA directory listing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_dir(dir = NULL, tidy = TRUE, cache = TRUE, key = eia_get_key())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eia_dir_+3A_dir">dir</code></td>
<td>
<p>character, directory path, if <code>NULL</code> then the API root directory.</p>
</td></tr>
<tr><td><code id="eia_dir_+3A_tidy">tidy</code></td>
<td>
<p>logical, return a tidier result. See details.</p>
</td></tr>
<tr><td><code id="eia_dir_+3A_cache">cache</code></td>
<td>
<p>logical, cache result for duration of R session using memoization.
See details.</p>
</td></tr>
<tr><td><code id="eia_dir_+3A_key">key</code></td>
<td>
<p>API key: character if set explicitly; not needed if key is set
globally. See <code>eia_set_key()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, additional processing is done to return a list containing tibble data frames.
Set <code>tidy = FALSE</code> to return only the initial list result of <code>jsonlite::fromJSON()</code>.
Set <code>tidy = NA</code> to return the original JSON as a character string.
</p>
<p>Set to <code>cache = FALSE</code> to force a new API call for updated data.
Using <code>FALSE</code> always makes a new API call and returns the result from the server.
<code>TRUE</code> uses memoization on a per R session basis, caching the result of the
function call in memory for the duration of the R session.
You can reset the entire cache by calling <code>eia_clear_cache()</code>.
</p>


<h3>Value</h3>

<p>data frame, list, or character; see details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# use eia_set_key() to store API key
eia_dir()
eia_dir("electricity")
eia_dir("electricity/rto")

## End(Not run)
</code></pre>

<hr>
<h2 id='eia_facets'>EIA facets</h2><span id='topic+eia_facets'></span>

<h3>Description</h3>

<p>Obtain facets for a given set of EIA data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_facets(dir, facet, tidy = TRUE, cache = TRUE, key = eia_get_key())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eia_facets_+3A_dir">dir</code></td>
<td>
<p>character, directory path.</p>
</td></tr>
<tr><td><code id="eia_facets_+3A_facet">facet</code></td>
<td>
<p>character</p>
</td></tr>
<tr><td><code id="eia_facets_+3A_tidy">tidy</code></td>
<td>
<p>logical, return a tidier result. See details.</p>
</td></tr>
<tr><td><code id="eia_facets_+3A_cache">cache</code></td>
<td>
<p>logical, cache result for duration of R session using memoization.
See details.</p>
</td></tr>
<tr><td><code id="eia_facets_+3A_key">key</code></td>
<td>
<p>API key: character if set explicitly; not needed if key is set
globally. See <code>eia_set_key()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, additional processing is done to return a list containing tibble data frames.
Set <code>tidy = FALSE</code> to return only the initial list result of <code>jsonlite::fromJSON()</code>.
Set <code>tidy = NA</code> to return the original JSON as a character string.
</p>
<p>Set to <code>cache = FALSE</code> to force a new API call for updated data.
Using <code>FALSE</code> always makes a new API call and returns the result from the server.
<code>TRUE</code> uses memoization on a per R session basis, caching the result of the
function call in memory for the duration of the R session.
You can reset the entire cache by calling <code>eia_clear_cache()</code>.
</p>


<h3>Value</h3>

<p>data frame, list, or character; see details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
eia_facets("electricity/retail-sales", facet = "sectorid")

## End(Not run)
</code></pre>

<hr>
<h2 id='eia_key'>Set and get API key</h2><span id='topic+eia_key'></span><span id='topic+eia_set_key'></span><span id='topic+eia_get_key'></span>

<h3>Description</h3>

<p>Set and get API key
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_set_key(key, store = c("env", "options", "sysenv"))

eia_get_key(store = c("env", "options", "sysenv"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eia_key_+3A_key">key</code></td>
<td>
<p>character, API key.</p>
</td></tr>
<tr><td><code id="eia_key_+3A_store">store</code></td>
<td>
<p>character, method for storing API key. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setter and getter helpers allow you to store your EIA API key in one of
three ways. Their use is optional. You can always pass the API key string to
the <code>key</code> argument of any package function that requires it, but you do not
have to.
</p>
<p>By default the <code>key</code> argument for these functions is <code>key = eia_get_key()</code>.
If your key has been stored in a manner that can be retrieved, then you can
call all the package API functions without having to provide the <code>key</code>
argument repeatedly.
</p>


<h3>Value</h3>

<p><code>eia_get_key()</code> returns the key string or <code>NULL</code> with a warning.
<code>eia_set_key()</code> returns a success message or an error.
</p>


<h3>Key storage methods</h3>

<p>If you have already set your key globally somewhere using <code>eia_set_key()</code>,
<code>eia_get_key()</code> will retrieve it. You can add the <code>EIA_KEY = "yourkey"</code>
key-value pair to <code>options()</code> or as a system environment variable yourself
and <code>eia_get_key()</code> will pick it up as long as you use the name <code>EIA_KEY</code>.
For convenience you can do this in your R session with <code>eia_set_key()</code>. It
gives you three options for how to store the key. The default is to use the
<code>eia</code> package environment that is created when the package is loaded.
</p>


<h3>Precedence</h3>

<p>Choose one method when setting a key. When getting the key, the three
locations are checked in the order: package environment, <code>options()</code>, then
the system environment. To override the order, specify the method explicitly
and the check will only occur there. This also makes it possible to override
a system level key by working with one stored in the package environment or
<code>options()</code>.
</p>


<h3>Persistence</h3>

<p>Note that none of these three storage methods, including <code>"sysenv"</code> are
persistent; the stored key is lost when the R session is terminated. A key
that is stored outside of R as a system environment variable is retrievable
with <code>eia_get_key()</code>, just like those set in an R session with <code>eia_set_key()</code>
and <code>store = "sysenv"</code>. However, if you truly want the key to persist as an
environment variable when R terminates, you must manually add it somewhere
like <code>.Renviron</code>; <code>Sys.setenv</code> in R cannot achieve this.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eia_set_key("fake")
eia_get_key()
# eia_get_key("options") # `NULL` with warning if not set where specified
</code></pre>

<hr>
<h2 id='eia_metadata'>EIA metadata</h2><span id='topic+eia_metadata'></span>

<h3>Description</h3>

<p>Obtain EIA data metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eia_metadata(dir, tidy = TRUE, cache = TRUE, key = eia_get_key())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eia_metadata_+3A_dir">dir</code></td>
<td>
<p>character, directory path.</p>
</td></tr>
<tr><td><code id="eia_metadata_+3A_tidy">tidy</code></td>
<td>
<p>logical, return a tidier result. See details.</p>
</td></tr>
<tr><td><code id="eia_metadata_+3A_cache">cache</code></td>
<td>
<p>logical, cache result for duration of R session using memoization.
See details.</p>
</td></tr>
<tr><td><code id="eia_metadata_+3A_key">key</code></td>
<td>
<p>API key: character if set explicitly; not needed if key is set
globally. See <code>eia_set_key()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By default, additional processing is done to return a list containing tibble data frames.
Set <code>tidy = FALSE</code> to return only the initial list result of <code>jsonlite::fromJSON()</code>.
Set <code>tidy = NA</code> to return the original JSON as a character string.
</p>
<p>Set to <code>cache = FALSE</code> to force a new API call for updated data.
Using <code>FALSE</code> always makes a new API call and returns the result from the server.
<code>TRUE</code> uses memoization on a per R session basis, caching the result of the
function call in memory for the duration of the R session.
You can reset the entire cache by calling <code>eia_clear_cache()</code>.
</p>


<h3>Value</h3>

<p>named list or character; see details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
eia_dir("electricity/retail-sales")
eia_metadata("electricity/retail-sales")

## End(Not run)
</code></pre>

<hr>
<h2 id='eiadate'>EIA date parsing</h2><span id='topic+eiadate'></span><span id='topic+eiadate_to_date'></span><span id='topic+date_to_eiadate'></span><span id='topic+eiadate_to_date_seq'></span>

<h3>Description</h3>

<p>Helper functions for manipulating and converting between regular
year-month-day date strings and EIA date string notation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eiadate_to_date(x)

date_to_eiadate(x, date_format = c("A", "Q", "M", "W", "D", "H"))

eiadate_to_date_seq(start, end, weekly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="eiadate_+3A_x">x</code></td>
<td>
<p>character, EIA date string; character or date object for regular
dates. See details.</p>
</td></tr>
<tr><td><code id="eiadate_+3A_date_format">date_format</code></td>
<td>
<p>EIA date format: &quot;A&quot;, &quot;Q&quot;, &quot;M&quot;, &quot;W&quot;, &quot;D&quot;, &quot;H&quot;.
These stand for annual, quarterly, monthly, weekly, daily, hourly. See details.</p>
</td></tr>
<tr><td><code id="eiadate_+3A_start">start</code></td>
<td>
<p>start EIA date or date.</p>
</td></tr>
<tr><td><code id="eiadate_+3A_end">end</code></td>
<td>
<p>end EIA date or date.</p>
</td></tr>
<tr><td><code id="eiadate_+3A_weekly">weekly</code></td>
<td>
<p>logical. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There is no reason to mix EIA date formats in this context. Functions that
take EIA date strings expect a consistent format. Also, EIA date formats are
parsed automatically from the dates themselves. However, daily and weekly use
the same format. Too avoid ambiguity in <code>eia_date_seq()</code>, daily is assumed;
set <code>weekly = TRUE</code> to treat as weekly.
</p>
<p>When providing a real date or date string, such as to <code>date_to_eiadate()</code>,
dates should be in <code>YYYY-MM-DD</code> format, or at least any format that can be
parsed by <code>lubridate::ymd</code> or <code>lubridate::ymd_hms</code> for dates and hourly date
times, respectively.
</p>
<p><code>"LH"</code> is not a supported date format. Use <code>"H"</code>. The API does not translate
the date and time when using <code>"LH"</code> anyhow; it simply appends the date string
with the number of hours time difference.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eiadate_to_date(c("2018-03", "2018-04"))

date_to_eiadate("2018-05-14", "A")
date_to_eiadate("2018-05-14", "Q")
date_to_eiadate("2018-05-14", "M")

(x &lt;- eiadate_to_date_seq("2018-Q1", "2018-Q4"))
date_to_eiadate(x, "Q")
date_to_eiadate(x, "M")

(x &lt;- eiadate_to_date("2019-01-02T16Z"))
date_to_eiadate(x, "H")
(x &lt;- eiadate_to_date_seq("2019-01-02T16Z", "2019-01-02T19Z"))
date_to_eiadate(x, "H")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
