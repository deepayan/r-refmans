<!DOCTYPE html><html><head><title>Help for package efreadr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {efreadr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#efreadr-package'><p>Read European Fluxes CSV Files</p></a></li>
<li><a href='#read_ef_file'><p>Load a CSV file from the European Flux Database</p></a></li>
<li><a href='#read_ef_files'><p>Load all European Fluxes CSV files in one or more directories, bind all observations in a list of dataframes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Read European Eddy Fluxes CSV Files</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-05-05</td>
</tr>
<tr>
<td>Description:</td>
<td>The European Eddy Fluxes Database Cluster distributes fluxes of different Green House Gases measured mainly using the eddy covariance technique acquired in sites involved in EU projects but also single sites in Europe, Africa and others continents that decided to share their measurements in the database <a href="http://gaia.agraria.unitus.it">http://gaia.agraria.unitus.it</a>. The package provides two functions to load and row-wise bind CSV files distributed by the database. Currently only L2, L3, and L4 (L=Level), half-hourly and daily (aggregation) files are supported.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), readr, dplyr, ensurer, magrittr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-05-06 04:46:09 UTC; bask</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco Bascietto [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Bascietto &lt;marco.bascietto@crea.gov.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-05-06 05:21:16 UTC</td>
</tr>
</table>
<hr>
<h2 id='efreadr-package'>Read European Fluxes CSV Files</h2><span id='topic+efreadr-package'></span>

<h3>Description</h3>

<p>The European Eddy Fluxes Database Cluster distributes fluxes of different Green House Gases measured mainly using the eddy covariance technique acquired in sites involved in EU projects but also single sites in Europe, Africa and others continents that decided to share their measurements in the database (cit. http://gaia.agraria.unitus.it ). The package provides two functions to load and row-wise bind CSV files distributed by the database. Currently only L3 and L4 (L=Level), half-hourly and daily (aggregation) files are supported.
</p>


<h3>Author(s)</h3>

<p>Marco Bascietto <a href="mailto:marco.bascietto@crea.gov.it">marco.bascietto@crea.gov.it</a>
</p>


<h3>References</h3>

<p>Source code is hosted at GitHub (<a href="https://github.com/mbask/efreadr">https://github.com/mbask/efreadr</a>)
</p>

<hr>
<h2 id='read_ef_file'>Load a CSV file from the European Flux Database</h2><span id='topic+read_ef_file'></span>

<h3>Description</h3>

<p>File name is parsed to extract year, site identification and aggregation type.
The file name must point to a valid European Fluxes file, in CSV format and must
resolve to a valid file format name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ef_file(file_name, aggregation = NA_character_, year = NA_integer_,
  fill_value = -9999L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ef_file_+3A_file_name">file_name</code></td>
<td>
<p>Full path to 1 fluxes file</p>
</td></tr>
<tr><td><code id="read_ef_file_+3A_aggregation">aggregation</code></td>
<td>
<p>character string, aggregation of the flux file to be imported (default <code>NA_character_</code>). This is important to properly define variable types for each aggregation type. When <code>NA_character_</code> it is assumed no aggregation (eg L2 files).</p>
</td></tr>
<tr><td><code id="read_ef_file_+3A_year">year</code></td>
<td>
<p>integer value (default <code>NA_integer</code>). Important to correctly add <code>efreadr_date</code> field</p>
</td></tr>
<tr><td><code id="read_ef_file_+3A_fill_value">fill_value</code></td>
<td>
<p>a code for a not available (<code>NA</code>) observation in CSV file. All the observations with 'fill_value' values are converted to <code>NA</code>s during import. Default is -9999L.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>File name is added as a field in the returned data frame
as  <code>pathname</code>. The <code>pathname</code> variable may be used to join a dataframe with
file metadata such as year, site code, level, aggregation, as <code>reaf_ef_files</code> does.
</p>
<p>The fluxes files code not available measures as -9999 (integer variables) or -9999.00 (floating point variables).
Default behaviour of <code>read_ef_file</code> is to treat them as <code>NA</code>s. All -9999L, and -9999.0, -9999.00,
-9999.000 values are converted to <code>NA</code> during import of files.
Occasionally, -9999.00 (floting point representation of NA) appear in variables that are inherently integer
(i.e. sqc variables in daily flux file). This forces a type conversion of the entire variable to <code>double</code>.
</p>


<h3>Value</h3>

<p>a data frame as loaded from the file, added with 'pathname' column, and 'efreadr_date' column for half-hourly fluxes files
</p>


<h3>Note</h3>

<p>For semi-hourly L4 aggregation (i.e. &quot;h&quot; aggregation in file name) the last row is
reported as month 1, day 1, hour 00:00. A normal date conversion would convert this date to
be the very first half-hour in January 1st of the current year whereas it should be the first half-hour of the
January 1st of the following year.
Therefore a class date field (<code>efreader_date</code>) is added to the returned data frame holding the correct
date (ie: 1st January of the following year).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>file_name &lt;- system.file(package = "efreadr", "examples", "CEIP_EC_L4_d_FABar_2015_v02.txt")
read_ef_file(file_name)
</code></pre>

<hr>
<h2 id='read_ef_files'>Load all European Fluxes CSV files in one or more directories, bind all observations in a list of dataframes</h2><span id='topic+read_ef_files'></span>

<h3>Description</h3>

<p>European fluxes CSV files are distributed as one or more zip-compressed files from http://gaia.agraria.unitus.it .
Once unzipped, all CSV files are to be found in uniquely identifed directories.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_ef_files(dirs = getwd(), only_level = NULL, only_aggr = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_ef_files_+3A_dirs">dirs</code></td>
<td>
<p>a vector of directories where fluxes files are looked for. Defaults to current directory.</p>
</td></tr>
<tr><td><code id="read_ef_files_+3A_only_level">only_level</code></td>
<td>
<p>levels of fluxes files (defaults to NULL). Allowed levels are (currently) 3 and 4. When NULL, either L3 and L4 files are looked for.</p>
</td></tr>
<tr><td><code id="read_ef_files_+3A_only_aggr">only_aggr</code></td>
<td>
<p>aggregations of data (defaults to NULL). Allowed aggregations are (currently) &quot;h&quot; (half-hourly) and &quot;d&quot; (daily). When NULL, either &quot;d&quot; and &quot;h&quot; files are looked for.</p>
</td></tr>
<tr><td><code id="read_ef_files_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed to <code>read_ef_file</code>, specifically <code>fill_value</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>All CSV files in that or those directories will be loaded and returned as a single row-wise bound data frame.
The function assumes the file name regular expression pattern is like <code>^[A-Z]{4}_EC_Ln_a_[A-Z]{2}[a-ZA-Z]{3}_20[0-9]{2}_v[0-9]{2}\.txt$</code>
where n is level <code>[1-4]</code> and a is aggregation period <code>[hdwm]</code> (optionally given as function arguments)
</p>


<h3>Value</h3>

<p>a data frame of 3 variables: <code>level</code>, <code>aggr</code>, and <code>fluxes</code>. <code>fluxes</code> is a dataframe that
binds the rows of all fluxes files imported for each level/aggregation combination found.
Additional columns to <code>fluxes</code> include metadata parsed from the file names:
For levels 3 and 4: <code>project</code>, <code>level</code>, <code>aggr</code>, <code>country_id</code>, <code>site_id</code>, <code>year</code>, <code>version</code>, <code>pathname</code>, <code>dirname</code>
For level 2: <code>project</code>, <code>level</code>, <code>type</code>, <code>country_id</code>, <code>site_id</code>, <code>year</code>, <code>version</code>, <code>time_res</code>, <code>pathname</code>, <code>dirname</code>
</p>


<h3>Note</h3>

<p>Files in the same directory may belong to different aggregation/level
combinations. The returned dataframe will keep aggregation/level
combinations in separate rows.
</p>
<p>For semi-hourly L4 aggregation (i.e. &quot;h&quot; aggregation in file name) the last row is
reported as month 1, day 1, hour 00:00. A normal date conversion would convert this date to
be the very first half-hour of the current year whereas it should be the very first half-hour of the
following year. Therefore a class date field ('efreader_date') is added to the returned data frame holding the correct
date (ie: January 1st of the following year).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dir_name &lt;- system.file(package = "efreadr", "examples")
read_ef_files(dir_name)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
