<!DOCTYPE html><html><head><title>Help for package pgam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pgam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.pgam'><p>AIC extraction</p></a></li>
<li><a href='#aihrio'><p>Sample dataset</p></a></li>
<li><a href='#backfitting'><p>Backfitting algorithm</p></a></li>
<li><a href='#bkfsmooth'><p>Smoothing of nonparametric terms</p></a></li>
<li><a href='#coef.pgam'><p>Coefficients extraction</p></a></li>
<li><a href='#deviance.pgam'><p>Deviance extraction</p></a></li>
<li><a href='#elapsedtime'><p>Utility function</p></a></li>
<li><a href='#envelope'><p>Generic function for simulated envelope generation.</p></a></li>
<li><a href='#envelope.pgam'><p>Normal plot with simulated envelope of the residuals.</p></a></li>
<li><a href='#f'><p>Utility function</p></a></li>
<li><a href='#fitted.pgam'><p>Fitted values extraction</p></a></li>
<li><a href='#fnz'><p>Utility function</p></a></li>
<li><a href='#formparser'><p>Read the model formula and split it into the	parametric and nonparametric partitions</p></a></li>
<li><a href='#framebuilder'><p>Utility function</p></a></li>
<li><a href='#g'><p>Utility function</p></a></li>
<li><a href='#link'><p>Utility function</p></a></li>
<li><a href='#logLik.pgam'><p>Loglik extraction</p></a></li>
<li><a href='#lpnorm'><p>Utility function</p></a></li>
<li><a href='#periodogram'><p>Raw Periodogram</p></a></li>
<li><a href='#pgam'><p>Poisson-Gamma Additive Models</p></a></li>
<li><a href='#pgam.filter'><p>Estimation of the conditional distributions parameters of the level</p></a></li>
<li><a href='#pgam.fit'><p>One-step ahead prediction and variance</p></a></li>
<li><a href='#pgam.hes2se'><p>Utility function</p></a></li>
<li><a href='#pgam.likelihood'><p>Likelihood function to be maximized</p></a></li>
<li><a href='#pgam.par2psi'><p>Utility function</p></a></li>
<li><a href='#pgam.psi2par'><p>Utility function</p></a></li>
<li><a href='#plot.pgam'><p>Plot of estimated curves</p></a></li>
<li><a href='#predict.pgam'><p>Prediction</p></a></li>
<li><a href='#print.pgam'><p>Model output</p></a></li>
<li><a href='#print.summary.pgam'><p>Summary output</p></a></li>
<li><a href='#residuals.pgam'><p>Residuals extraction</p></a></li>
<li><a href='#summary.pgam'><p>Summary output</p></a></li>
<li><a href='#tbl2tex'><p>LaTeX table exporter</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.4.17</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-19</td>
</tr>
<tr>
<td>Author:</td>
<td>Washington Junger &lt;wjunger@ims.uerj.br&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Washington Junger &lt;wjunger@ims.uerj.br&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0),stats,utils</td>
</tr>
<tr>
<td>Title:</td>
<td>Poisson-Gamma Additive Models</td>
</tr>
<tr>
<td>Description:</td>
<td>This work is an extension of the state space model for Poisson count data, Poisson-Gamma model, towards a semiparametric specification. Just like the generalized additive models (GAM), cubic splines are used for covariate smoothing. The semiparametric models are fitted by an iterative process that combines maximization of likelihood and backfitting algorithm.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> | file LICENSE</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-19 17:38:13 UTC; wjunger</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-19 19:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.pgam'>AIC extraction</h2><span id='topic+AIC.pgam'></span>

<h3>Description</h3>

<p>Method for approximate Akaike Information Criterion extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
AIC(object, k = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AIC.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="AIC.pgam_+3A_k">k</code></td>
<td>
<p>default is 2 for AIC. If <code class="reqn">k=\log\left(n\right)</code> then an approximation for BIC is obtained. Important to note that these are merely approximations.</p>
</td></tr>
<tr><td><code id="AIC.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An approximate measure of parsimony of the Poisson-Gama Additive Models can be achieved by the expression
</p>
<p style="text-align: center;"><code class="reqn">AIC=\left(D\left(y;\hat\mu\right)+2gle\right)/\left(n-\tau\right)</code>
</p>

<p>where <code class="reqn">gle</code> is the number of degrees of freedom of the fitted model and <code class="reqn">\tau</code> is the index of the first non-zero observation.
</p>


<h3>Value</h3>

<p>The approximate AIC value of the fitted model.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+deviance.pgam">deviance.pgam</a></code>, <code><a href="#topic+logLik.pgam">logLik.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

AIC(m)

</code></pre>

<hr>
<h2 id='aihrio'>Sample dataset</h2><span id='topic+aihrio'></span>

<h3>Description</h3>

<p>This is a dataset for Poisson-Gamma Additive Models functions testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aihrio)</code></pre>


<h3>Format</h3>

<p>A data frame with 365 observations on the following 33 variables.
</p>

<dl>
<dt>DATE</dt><dd><p>a factor with levels</p>
</dd>
<dt>TIME</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITRESP65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITCIRC65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITDPOC65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITPNM65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITAVC65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITIAM65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITDIC65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITTCA65</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITRESP5</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITPNEU5</dt><dd><p>a numeric vector</p>
</dd>
<dt>ITDPC5</dt><dd><p>a numeric vector</p>
</dd>
<dt>WEEK</dt><dd><p>a numeric vector</p>
</dd>
<dt>MON</dt><dd><p>a numeric vector</p>
</dd>
<dt>TUE</dt><dd><p>a numeric vector</p>
</dd>
<dt>WED</dt><dd><p>a numeric vector</p>
</dd>
<dt>THU</dt><dd><p>a numeric vector</p>
</dd>
<dt>FRI</dt><dd><p>a numeric vector</p>
</dd>
<dt>SAT</dt><dd><p>a numeric vector</p>
</dd>
<dt>SUN</dt><dd><p>a numeric vector</p>
</dd>
<dt>HOLIDAYS</dt><dd><p>a numeric vector</p>
</dd>
<dt>MONTH</dt><dd><p>a numeric vector</p>
</dd>
<dt>warm.season</dt><dd><p>a numeric vector</p>
</dd>
<dt>tmpmed</dt><dd><p>a numeric vector</p>
</dd>
<dt>tmpmin</dt><dd><p>a numeric vector</p>
</dd>
<dt>tmpmax</dt><dd><p>a numeric vector</p>
</dd>
<dt>wet</dt><dd><p>a numeric vector</p>
</dd>
<dt>rain</dt><dd><p>a numeric vector</p>
</dd>
<dt>rainy</dt><dd><p>a numeric vector</p>
</dd>
<dt>PM</dt><dd><p>a numeric vector</p>
</dd>
<dt>SO2</dt><dd><p>a numeric vector</p>
</dd>
<dt>CO</dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>This is a reduced dataset of those used to estimate possible effects of air pollution on hospital admissions outcomes in Universidade do Estado do Rio de Janeiro, Rio de Janeiro, Brasil.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>Source</h3>

<p>Secretary for the Environment of the Rio de Janeiro City, Brazilian Ministry of Defense and Brazilian Ministry of Health
</p>

<hr>
<h2 id='backfitting'>Backfitting algorithm</h2><span id='topic+backfitting'></span>

<h3>Description</h3>

<p>Fit the nonparametric part of the model via backfitting algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>backfitting(y, x, df, smoother = "spline",
w = rep(1, length(y)), eps = 0.001, maxit = 100, info = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="backfitting_+3A_y">y</code></td>
<td>
<p>dependent variable for fitting. In semiparametric models, this is the partial residuals of parametric fit</p>
</td></tr>
<tr><td><code id="backfitting_+3A_x">x</code></td>
<td>
<p>matrix of covariates</p>
</td></tr>
<tr><td><code id="backfitting_+3A_df">df</code></td>
<td>
<p>equivalent degrees of freedom. If <code>NULL</code> the smoothing parameter is selected by cross-validation</p>
</td></tr>
<tr><td><code id="backfitting_+3A_smoother">smoother</code></td>
<td>
<p>string with the name of the smoother to be used</p>
</td></tr>
<tr><td><code id="backfitting_+3A_w">w</code></td>
<td>
<p>vector with the diagonal elements of the weight matrix. Default is a vector of <code class="reqn">1</code> with the same length of <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="backfitting_+3A_eps">eps</code></td>
<td>
<p>convergence control criterion</p>
</td></tr>
<tr><td><code id="backfitting_+3A_maxit">maxit</code></td>
<td>
<p>convergence control iterations</p>
</td></tr>
<tr><td><code id="backfitting_+3A_info">info</code></td>
<td>
<p>if <code>FALSE</code> only fitted values are returned. It it is faster during iterations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Backfitting algorithm estimates the approximating regression surface, working around the &quot;curse of dimentionality&quot;.
</p>
<p>More details soon enough.
</p>


<h3>Value</h3>

<p>Fitted smooth curves and partial residuals.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code>, <code><a href="#topic+bkfsmooth">bkfsmooth</a></code></p>

<hr>
<h2 id='bkfsmooth'>Smoothing of nonparametric terms</h2><span id='topic+bkfsmooth'></span>

<h3>Description</h3>

<p>Interface for smoothing functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bkfsmooth(y, x, df, smoother = "spline", w = rep(1, length(y)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bkfsmooth_+3A_y">y</code></td>
<td>
<p>dependent variable for fitting. In semiparametric models, this is the partial residuals of parametric fit</p>
</td></tr>
<tr><td><code id="bkfsmooth_+3A_x">x</code></td>
<td>
<p>independent variable. Univariate fit only</p>
</td></tr>
<tr><td><code id="bkfsmooth_+3A_df">df</code></td>
<td>
<p>equivalent degrees of freedom. If <code>NULL</code> the smoothing parameter is selected by cross-validation</p>
</td></tr>
<tr><td><code id="bkfsmooth_+3A_smoother">smoother</code></td>
<td>
<p>string with the name of the smoother to be used</p>
</td></tr>
<tr><td><code id="bkfsmooth_+3A_w">w</code></td>
<td>
<p>vector with the diagonal elements of the weight matrix. Default is a vector of <code class="reqn">1</code> with the same length of <code class="reqn">y</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Although several smoothers can be used in semiparametric regression models, only natural cubic splines is intended to be used in Poisson-Gamma Additive Models due to its interesting mathematical properties.
</p>
<p>Nowadays, this function interfaces the <code><a href="stats.html#topic+smooth.spline">smooth.spline</a></code> in <code>stats</code> library. It will become not dependent soon enough.
</p>


<h3>Value</h3>

<table>
<tr><td><code>fitted</code></td>
<td>
<p>smoothed values</p>
</td></tr>
<tr><td><code>lev</code></td>
<td>
<p>diagonal of the influence matrix</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>

<hr>
<h2 id='coef.pgam'>Coefficients extraction</h2><span id='topic+coef.pgam'></span>

<h3>Description</h3>

<p>Method for parametric coefficients extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="coef.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only retrieves the estimated coefficients from the model object returned by <code>pgam</code>.
</p>


<h3>Value</h3>

<p>Vector of coefficients estimates of the model fitted.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

coef(m)

</code></pre>

<hr>
<h2 id='deviance.pgam'>Deviance extraction</h2><span id='topic+deviance.pgam'></span>

<h3>Description</h3>

<p>Method for total deviance value extraction.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="deviance.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+predict.pgam">predict.pgam</a></code> for further information on deviance extration in Poisson-Gamma models.
</p>


<h3>Value</h3>

<p>The sum of deviance components.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+pgam.likelihood">pgam.likelihood</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

deviance(m)

</code></pre>

<hr>
<h2 id='elapsedtime'>Utility function</h2><span id='topic+elapsedtime'></span>

<h3>Description</h3>

<p>Gadget to compute the elapsed time of a process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elapsedtime(st, et)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="elapsedtime_+3A_st">st</code></td>
<td>
<p>start time</p>
</td></tr>
<tr><td><code id="elapsedtime_+3A_et">et</code></td>
<td>
<p>end time</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Start and end times can be obtained with <code><a href="base.html#topic+proc.time">proc.time</a></code>.
</p>


<h3>Value</h3>

<p>String with the elapsed time in <code>hh:mm:ss</code> format.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code></p>

<hr>
<h2 id='envelope'>Generic function for simulated envelope generation.
</h2><span id='topic+envelope'></span>

<h3>Description</h3>

<p>A normal plot with simulated envelope of the residual is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope_+3A_object">object</code></td>
<td>
<p>object holding the fitted model</p>
</td></tr>
<tr><td><code id="envelope_+3A_...">...</code></td>
<td>
<p>further arguments to passed to methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>envelope</code> holding the information needed to plot the envelope.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Atkinson, A. C. (1985) Plots, transformations and regression : an introduction to graphical methods of diagnostic regression analysis. Oxford Science Publications, Oxford.
</p>

<hr>
<h2 id='envelope.pgam'>Normal plot with simulated envelope of the residuals.
</h2><span id='topic+envelope.pgam'></span>

<h3>Description</h3>

<p>A normal plot with simulated envelope of the residual is produced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
envelope(object, type = "deviance", size = 0.95, 
rep = 19, optim.method = NULL, epsilon = 0.001, maxit = 100, 
plot = TRUE, title="Simulated Envelope of Residuals", verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_type">type</code></td>
<td>
<p>type of residuals to be extracted. Default is <code>deviance</code>. Options are described in <code><a href="#topic+residuals.pgam">residuals.pgam</a></code></p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_size">size</code></td>
<td>
<p>value giving the size of the envelope. Default is <code>.95</code> which is equivalent to a 95% band</p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_rep">rep</code></td>
<td>
<p>number of replications for envelope construction. Default is <code>19</code></p>
</td></tr></table>
<p>, that is the smallest 95% band that can be build
</p>
<table>
<tr><td><code id="envelope.pgam_+3A_optim.method">optim.method</code></td>
<td>
<p>optimization method to be passed to <code><a href="#topic+pgam">pgam</a></code> and therefore to <code><a href="stats.html#topic+optim">optim</a></code></p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_epsilon">epsilon</code></td>
<td>
<p>convergence control to be passed to <code><a href="#topic+pgam">pgam</a></code></p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_maxit">maxit</code></td>
<td>
<p>convergence control to be passed to <code><a href="#topic+pgam">pgam</a></code></p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> a plot of the envelope is produced</p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_title">title</code></td>
<td>
<p>title for the plot</p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> a sort of information is printed during the running time</p>
</td></tr>
<tr><td><code id="envelope.pgam_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+plot">plot</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Method for the generic function <code><a href="#topic+envelope">envelope</a></code>.
</p>
<p>Sometimes the usual Q-Q plot shows an unsatisfactory pattern of the residuals of a model fitted and we are led to think that the model is badly specificated. The normal plot with simulated envelope indicates that under the distribution of the response variable the model is OK if only a few points fall off the envelope.
</p>
<p>If <code>object</code> is of class <code>pgam</code> the envelope is estimated and optionally plotted, else if is of class <code>envelope</code> then it is only plotted.
</p>


<h3>Value</h3>

<p>An object of class <code>envelope</code> holding the information needed to plot the envelope.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Atkinson, A. C. (1985) Plots, transformations and regression : an introduction to graphical methods of diagnostic regression analysis. Oxford Science Publications, Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code>, <code><a href="#topic+residuals.pgam">residuals.pgam</a></code></p>

<hr>
<h2 id='f'>Utility function</h2><span id='topic+f'></span>

<h3>Description</h3>

<p>Generate the partition of design matrix regarded to the seasonal factor in its argument. Used in the model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>f(factorvar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="f_+3A_factorvar">factorvar</code></td>
<td>
<p>variable with the seasonal levels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing data matrix of dummy variables, level names and seasonal periods.
</p>


<h3>Note</h3>

<p>This function is intended to be called from within a model formula.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='fitted.pgam'>Fitted values extraction</h2><span id='topic+fitted.pgam'></span>

<h3>Description</h3>

<p>Method for fitted values extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="fitted.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Actually, the fitted values are worked out by the function <code>predict.pgam</code>. Thus, this method is supposed to turn fitted values extraction easier. See <code><a href="#topic+predict.pgam">predict.pgam</a></code> for details on one-step ahead prediction.
</p>


<h3>Value</h3>

<p>Vector of predicted values of the model fitted.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

f &lt;- fitted(m)

</code></pre>

<hr>
<h2 id='fnz'>Utility function</h2><span id='topic+fnz'></span>

<h3>Description</h3>

<p>Return the index of first non-zero observation of a variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fnz(y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fnz_+3A_y">y</code></td>
<td>
<p>variable vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The index of first non-zero value.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code></p>

<hr>
<h2 id='formparser'>Read the model formula and split it into the	parametric and nonparametric partitions</h2><span id='topic+formparser'></span>

<h3>Description</h3>

<p>Read the model formula and split it into two new ones concerning the parametric and nonparametric partitions of the predictor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formparser(formula, env=parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formparser_+3A_formula">formula</code></td>
<td>
<p>object representing the model formula. <span class="rlang"><b>R</b></span> standard for GLM models</p>
</td></tr>
<tr><td><code id="formparser_+3A_parent.frame">parent.frame</code></td>
<td>
<p>an environment to be used as the parent of the environment created</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts all the information in the model formula. Most important, split the model into two parts regarding the parametric nature of the model.
A model can be specified as following:
</p>
<p style="text-align: center;"><code class="reqn">Y~f\left(sf_{r}\right)+V1+V2+V3+g\left(V4,df_{4}\right)+g\left(V5,df_{5}\right)</code>
</p>

<p>where <code class="reqn">sf_{r}</code> is a seasonal factor with period <code class="reqn">r</code> and <code class="reqn">df_{i}</code> is the degree of freedom of the smoother of the <em>i</em>-th covariate. Actually, two new formulae will be created:
</p>
<p style="text-align: center;"><code class="reqn">~sf_{1}+\dots+sf_{r}+V1+V2+V3</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">~V4+V5</code>
</p>

<p>These two formulae will be used to build the necessary datasets for model estimation. <em>Dummy</em> variables reproducing the seasonal factors will be created also.
</p>
<p>Models without explanatory variables must be specified as in the following formula
</p>
<p style="text-align: center;"><code class="reqn">Y~NULL</code>
</p>



<h3>Value</h3>

<p>List containing the information needed for model fitting.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+f">f</a></code>, <code><a href="#topic+g">g</a></code></p>

<hr>
<h2 id='framebuilder'>Utility function</h2><span id='topic+framebuilder'></span>

<h3>Description</h3>

<p>Generate a data frame given a formula and a dataset.</p>


<h3>Usage</h3>

<pre><code class='language-R'>framebuilder(formula, dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="framebuilder_+3A_formula">formula</code></td>
<td>
<p>model formula</p>
</td></tr>
<tr><td><code id="framebuilder_+3A_dataset">dataset</code></td>
<td>
<p>model dataset</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Actually, this function is a wrapper for <code><a href="stats.html#topic+model.frame">model.frame</a></code>.
</p>


<h3>Value</h3>

<p>A data frame restricted to the model.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='g'>Utility function</h2><span id='topic+g'></span>

<h3>Description</h3>

<p>Collect information to smooth the term in its argument. Used in the model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>g(var, df = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="g_+3A_var">var</code></td>
<td>
<p>variable to be smoothed</p>
</td></tr>
<tr><td><code id="g_+3A_df">df</code></td>
<td>
<p>equivalent degrees of freedom to be passed to the smoother. If <code>NULL</code>, smoothing parameter is selected by cross-validation</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only sets things up for model fitting. The smooth terms are actually fitted by <code><a href="#topic+bkfsmooth">bkfsmooth</a></code>.
</p>


<h3>Value</h3>

<p>List containing the same elements of its argument.
</p>


<h3>Note</h3>

<p>This function is intended to be called from within a model formula.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='link'>Utility function</h2><span id='topic+link'></span>

<h3>Description</h3>

<p>Apply the link function or its inverse to the argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>link(x, link = "log", inv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="link_+3A_x">x</code></td>
<td>
<p>vector containing the predictor</p>
</td></tr>
<tr><td><code id="link_+3A_link">link</code></td>
<td>
<p>string with the name of the link function</p>
</td></tr>
<tr><td><code id="link_+3A_inv">inv</code></td>
<td>
<p>if <code>TRUE</code> its inverse is applied</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is intended to port other link functions than <code class="reqn">\log{\left(\right)}</code> to Poisson-Gamma Additive Models. For now, the only allowed value is <code>"log"</code>.
</p>


<h3>Value</h3>

<p>Evaluated link function at <code>x</code> values.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='logLik.pgam'>Loglik extraction</h2><span id='topic+logLik.pgam'></span>

<h3>Description</h3>

<p>Method for loglik value extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="logLik.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+pgam.likelihood">pgam.likelihood</a></code> for more information on log-likelihood evaluation in Poisson-Gamma models.
</p>


<h3>Value</h3>

<p>The maximum value achieved by the likelihood optimization process.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+pgam.likelihood">pgam.likelihood</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

logLik(m)

</code></pre>

<hr>
<h2 id='lpnorm'>Utility function</h2><span id='topic+lpnorm'></span>

<h3>Description</h3>

<p>Compute the Lp-norm of two sequencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpnorm(seq1, seq2 = 0, p = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lpnorm_+3A_seq1">seq1</code></td>
<td>
<p>first sequency</p>
</td></tr>
<tr><td><code id="lpnorm_+3A_seq2">seq2</code></td>
<td>
<p>second sequency</p>
</td></tr>
<tr><td><code id="lpnorm_+3A_p">p</code></td>
<td>
<p>L-space of the norm. <code>0</code> is infinity norm or max norm, <code>1</code> is the absolute value norm, <code>2</code> is L2 norm and so on</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The computed norm value.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code></p>

<hr>
<h2 id='periodogram'>Raw Periodogram</h2><span id='topic+periodogram'></span>

<h3>Description</h3>

<p>A raw periodogram is returned and optionally plotted.</p>


<h3>Usage</h3>

<pre><code class='language-R'>periodogram(y, rows = trunc(length(na.omit(y))/2-1), plot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodogram_+3A_y">y</code></td>
<td>
<p>time series</p>
</td></tr>
<tr><td><code id="periodogram_+3A_rows">rows</code></td>
<td>
<p>number of rows to be returned. Default and largest is <code class="reqn">n/2-1</code>, where <code class="reqn">n</code> is the number of valid observations of the time series <code class="reqn">y</code></p>
</td></tr>
<tr><td><code id="periodogram_+3A_plot">plot</code></td>
<td>
<p>if <code>TRUE</code> a raw periodogram is plotted</p>
</td></tr>
<tr><td><code id="periodogram_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+plot">plot</a></code> function</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The raw periodogram is an estimator of the spectrum of a time series, it still is a good indicator of unresolved seasonality patterns in residuals of the fitted model. Check the function <code>intensity</code> for frequencies extraction.
</p>
<p>This function plots a fancy periodogram where the intensities of the angular frequencies are plotted resembling tiny lollipops.
</p>


<h3>Value</h3>

<p>Periodogram ordered by intensity.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Box, G., Jenkins, G., Reinsel, G. (1994) Time Series Analysis : Forecasting and Control. 3rd edition, Prentice Hall, New Jersey.
</p>
<p>Diggle, P. J. (1989) Time Series : A Biostatistical Introduction. Oxford University Press, Oxford.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code></p>

<hr>
<h2 id='pgam'>Poisson-Gamma Additive Models</h2><span id='topic+pgam'></span>

<h3>Description</h3>

<p>Fit Poisson-Gamma Additive Models using the roughness penalty approach
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam(formula, dataset, omega = 0.8, beta = 0.1, offset = 1, digits = getOption("digits"),
na.action="na.exclude", maxit = 100, eps = 1e-06, lfn.scale=1, control = list(), 
optim.method = "L-BFGS-B", bkf.eps = 0.001, bkf.maxit = 100, se.estimation = "numerical", 
verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam_+3A_formula">formula</code></td>
<td>
<p>a model formula. See <code><a href="#topic+formparser">formparser</a></code> for details</p>
</td></tr>
<tr><td><code id="pgam_+3A_dataset">dataset</code></td>
<td>
<p>a data set in the environment search path. Missing data is temporarily not handled</p>
</td></tr>
<tr><td><code id="pgam_+3A_omega">omega</code></td>
<td>
<p>initial value for the discount factor</p>
</td></tr>
<tr><td><code id="pgam_+3A_beta">beta</code></td>
<td>
<p>vector of initial values for covariates coefficients. If a sigle value is supplied it is replicated to fill in the whole vector</p>
</td></tr>
<tr><td><code id="pgam_+3A_offset">offset</code></td>
<td>
<p>default is <code class="reqn">1</code>. Other value can be supplied here</p>
</td></tr>
<tr><td><code id="pgam_+3A_digits">digits</code></td>
<td>
<p>number of decimal places for printing information out</p>
</td></tr>
<tr><td><code id="pgam_+3A_na.action">na.action</code></td>
<td>
<p>action to be taken if missing values are found. Default is <code>"na.exclude"</code> and residuals and predictions are padded to fit the length of the data. If <code>"na.fail"</code> then the process will stop if missing values are found. If <code>"na.omit"</code> the process will continue without padding though. If <code>"na.pass"</code> the process will stop due to errors</p>
</td></tr>
<tr><td><code id="pgam_+3A_maxit">maxit</code></td>
<td>
<p>convergence control iterations</p>
</td></tr>
<tr><td><code id="pgam_+3A_eps">eps</code></td>
<td>
<p>convergence control criterion</p>
</td></tr>
<tr><td><code id="pgam_+3A_lfn.scale">lfn.scale</code></td>
<td>
<p>scales the likelihood function and is passed to <code>control</code> in <code><a href="stats.html#topic+optim">optim</a></code>. Value must be positive to ensure maximization</p>
</td></tr>
<tr><td><code id="pgam_+3A_control">control</code></td>
<td>
<p>convergence control of <code><a href="stats.html#topic+optim">optim</a></code>. See its help for details</p>
</td></tr>
<tr><td><code id="pgam_+3A_optim.method">optim.method</code></td>
<td>
<p>optimization method passed to <code><a href="stats.html#topic+optim">optim</a></code>. Different methods can lead to different results, so the user must attempt to the trade off between speed and robustness. For example, <code>BFGS</code> is faster but sensitive to starting values and <code>L-BFGS-B</code> is more robust but slower. See its help for details.</p>
</td></tr>


<tr><td><code id="pgam_+3A_bkf.eps">bkf.eps</code></td>
<td>
<p>convergence control criterion for the backfitting algorithm</p>
</td></tr>
<tr><td><code id="pgam_+3A_bkf.maxit">bkf.maxit</code></td>
<td>
<p>convergence control iterations for the backfitting algorithm</p>
</td></tr>
<tr><td><code id="pgam_+3A_se.estimation">se.estimation</code></td>
<td>
<p>if <code>numerical</code> numerical standard error of parameters are returned. If <code>analytical</code> then analytical extraction of the standard errors is performed. By setting it to <code>none</code> standard error estimation is avoided</p>
</td></tr>
<tr><td><code id="pgam_+3A_verbose">verbose</code></td>
<td>
<p>if <code>TRUE</code> information during estimation process is printed out</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula is parsed by <code><a href="#topic+formparser">formparser</a></code> in order to extract all the information necessary for model fit. Split the model into two parts regarding the parametric nature of the model.
A model can be specified as following:
</p>
<p style="text-align: center;"><code class="reqn">Y~f\left(sf_{r}\right)+V1+V2+V3+g\left(V4,df_{4}\right)+g\left(V5,df_{5}\right)</code>
</p>

<p>where <code class="reqn">sf_{r}</code> is a seasonal factor with period <code class="reqn">r</code> and <code class="reqn">df_{i}</code> is the degree of freedom of the smoother of the <em>i</em>-th covariate. Actually, two new formulae will be created:
</p>
<p style="text-align: center;"><code class="reqn">~sf_{1}+\dots+sf_{r}+V1+V2+V3</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">~V4+V5</code>
</p>

<p>These two formulae will be used to build the necessary datasets for model estimation. <em>Dummy</em> variables reproducing the seasonal factors will be created also.
</p>
<p>Models without explanatory variables must be specified as in the following formula
</p>
<p style="text-align: center;"><code class="reqn">Y~NULL</code>
</p>

<p>There are a lot of details to be written. It will be very soon.
</p>
<p>Specific information can be obtained on functions help.
</p>
<p>This algorithm fits fully parametric Poisson-Gamma model also.
</p>


<h3>Value</h3>

<p>List containing an object of class <code>pgam</code>.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.pgam">predict.pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code>, <code><a href="#topic+residuals.pgam">residuals.pgam</a></code>, <code><a href="#topic+backfitting">backfitting</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

summary(m)

</code></pre>

<hr>
<h2 id='pgam.filter'>Estimation of the conditional distributions parameters of the level</h2><span id='topic+pgam.filter'></span>

<h3>Description</h3>

<p>The priori and posteriori conditional distributions of the level is gamma and their parameters are estimated through this recursive filter. See <b>Details</b> for a thorough description.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.filter(w, y, eta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.filter_+3A_w">w</code></td>
<td>
<p>running estimate of discount factor <code class="reqn">\omega</code> of a Poisson-Gamma model</p>
</td></tr>
<tr><td><code id="pgam.filter_+3A_y">y</code></td>
<td>
<p><code class="reqn">n</code> length vector of the time series observations</p>
</td></tr>
<tr><td><code id="pgam.filter_+3A_eta">eta</code></td>
<td>
<p>full linear or semiparametric predictor. Linear predictor is a trivial case of semiparameric model</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider <code class="reqn">Y_{t-1}</code> a vector of observed values of a Poisson process untill the instant <code class="reqn">t-1</code>. Conditional on that, <code class="reqn">\mu_{t}</code> has gamma distribution with parameters given by
</p>
<p style="text-align: center;"><code class="reqn">a_{t|t-1}=\omega a_{t-1}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{t|t-1}=\omega b_{t-1}\exp\left(-\eta_{t}\right)</code>
</p>

<p>Once <code class="reqn">y_{t}</code> is known, the posteriori distribution of <code class="reqn">\mu_{t}|Y_{t}</code> is also gamma with parameters given by
</p>
<p style="text-align: center;"><code class="reqn">a_{t}=\omega a_{t-1}+y_{t}</code>
</p>

<p style="text-align: center;"><code class="reqn">b_{t}=\omega b_{t-1}+\exp\left(\eta_{t}\right)</code>
</p>

<p>with <code class="reqn">t=\tau,\ldots,n</code>, where <code class="reqn">\tau</code> is the index of the first non-zero observation of <code class="reqn">y</code>.
</p>
<p>Diffuse initialization of the filter is applied by setting <code class="reqn">a_{0}=0</code> and <code class="reqn">b_{0}=0</code>. A proper distribution of <code class="reqn">\mu_{t}</code> is obtained at <code class="reqn">t=\tau</code>, where <code class="reqn">\tau</code> is the fisrt non-zero observation of the time series.
</p>


<h3>Value</h3>

<p>A list containing the time varying parmeters of the priori and posteriori conditional distribution is returned.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.likelihood">pgam.likelihood</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>

<hr>
<h2 id='pgam.fit'>One-step ahead prediction and variance</h2><span id='topic+pgam.fit'></span>

<h3>Description</h3>

<p>Estimate one-step ahead expectation and variance of <code class="reqn">y_{t}</code> conditional on observed time series until the instant <code class="reqn">t-1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.fit(w, y, eta, partial.resid)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.fit_+3A_w">w</code></td>
<td>
<p>estimate of discount factor <code class="reqn">\omega</code> of a Poisson-Gamma model</p>
</td></tr>
<tr><td><code id="pgam.fit_+3A_y">y</code></td>
<td>
<p>observed time series which is the response variable of the model</p>
</td></tr>
<tr><td><code id="pgam.fit_+3A_eta">eta</code></td>
<td>
<p>semiparametric predictor</p>
</td></tr>
<tr><td><code id="pgam.fit_+3A_partial.resid">partial.resid</code></td>
<td>
<p>type of partial residuals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Partial residuals for semiparametric estimation is extracted. Those are regarded to the parametric partition fit of the model. Available types are <code>raw</code>, <code>pearson</code> and <code>deviance</code>. The type <code>raw</code> is prefered. Properties of other form of residuals not fully tested. Must be careful on choosing it.
See details in <code><a href="#topic+predict.pgam">predict.pgam</a></code> and <code><a href="#topic+residuals.pgam">residuals.pgam</a></code>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>yhat</code></td>
<td>
<p>vector of one-step ahead prediction</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>vector partial residuals</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+residuals.pgam">residuals.pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>

<hr>
<h2 id='pgam.hes2se'>Utility function</h2><span id='topic+pgam.hes2se'></span>

<h3>Description</h3>

<p>Put hyperparameters hessian matrix in the form of omega and beta standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.hes2se(hes, fperiod, se.estimation="numerical")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.hes2se_+3A_hes">hes</code></td>
<td>
<p>hessian matrix returned by <code>optim</code></p>
</td></tr>
<tr><td><code id="pgam.hes2se_+3A_fperiod">fperiod</code></td>
<td>
<p>vector containing as many seasonal factors as there are in model formula</p>
</td></tr>
<tr><td><code id="pgam.hes2se_+3A_se.estimation">se.estimation</code></td>
<td>
<p>indicate what method is used to extract the stardard errors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the hyperparameters <code class="reqn">omega</code> and <code class="reqn">beta</code> standard errors.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='pgam.likelihood'>Likelihood function to be maximized</h2><span id='topic+pgam.likelihood'></span>

<h3>Description</h3>

<p>This is the log-likelihood function that is passed to <code>optim</code> for likelihood maximization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.likelihood(par, y, x, offset, fperiod, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.likelihood_+3A_par">par</code></td>
<td>
<p>vector of parameters to be optimized</p>
</td></tr>
<tr><td><code id="pgam.likelihood_+3A_y">y</code></td>
<td>
<p>observed time series which is the response variable of the model</p>
</td></tr>
<tr><td><code id="pgam.likelihood_+3A_x">x</code></td>
<td>
<p>observed explanatory variables for parametric fit</p>
</td></tr>
<tr><td><code id="pgam.likelihood_+3A_offset">offset</code></td>
<td>
<p>model offset. Just like in GLM</p>
</td></tr>
<tr><td><code id="pgam.likelihood_+3A_fperiod">fperiod</code></td>
<td>
<p>vector of seasonal factors to be passed to <code>pgam.par2psi</code></p>
</td></tr>
<tr><td><code id="pgam.likelihood_+3A_env">env</code></td>
<td>
<p>the caller environment for log-likelihood value to be stored</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Log-likelihood function of hyperparameters <code class="reqn">\omega</code> and <code class="reqn">\beta</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">\log L\left(\omega,\beta\right)=\sum_{t=\tau+1}^{n}{\log \Gamma\left(a_{t|t-1}+y_{t}\right)-\log y_{t}!-\log \Gamma\left(a_{t|t-1}\right)+a_{t|t-1}\log b_{t|t-1}-\left(a_{t|t-1}+y_{t}\right)\log \left(1+b_{t|t-1}\right)}</code>
</p>

<p>where <code class="reqn">a_{t|t-1}</code> and <code class="reqn">b_{t|t-1}</code> are estimated as it is shown in <code><a href="#topic+pgam.filter">pgam.filter</a></code>.
</p>


<h3>Value</h3>

<p>List containing log-likelihood value, optimum linear predictor and the gamma parameters vectors.</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.filter">pgam.filter</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code></p>

<hr>
<h2 id='pgam.par2psi'>Utility function</h2><span id='topic+pgam.par2psi'></span>

<h3>Description</h3>

<p>Put unconstrained optimized parameters back into omega and beta form.</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.par2psi(par, fperiod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.par2psi_+3A_par">par</code></td>
<td>
<p>vector of unconstrained parameters</p>
</td></tr>
<tr><td><code id="pgam.par2psi_+3A_fperiod">fperiod</code></td>
<td>
<p>vector containing as many seasonal factors as there are in model formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the hyperparameters <code class="reqn">omega</code> and <code class="reqn">beta</code>.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='pgam.psi2par'>Utility function</h2><span id='topic+pgam.psi2par'></span>

<h3>Description</h3>

<p>Put hyperparameters into unconstrained form for optimization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pgam.psi2par(w, beta, fperiod)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pgam.psi2par_+3A_w">w</code></td>
<td>
<p>discount factor of the Poisson-Gamma model</p>
</td></tr>
<tr><td><code id="pgam.psi2par_+3A_beta">beta</code></td>
<td>
<p>explanatory variables coefficients</p>
</td></tr>
<tr><td><code id="pgam.psi2par_+3A_fperiod">fperiod</code></td>
<td>
<p>vector containing as many seasonal factors as there are in model formula</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of unconstrained parameters.
</p>


<h3>Note</h3>

<p>This function is not intended to be called directly.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+formparser">formparser</a></code></p>

<hr>
<h2 id='plot.pgam'>Plot of estimated curves</h2><span id='topic+plot.pgam'></span>

<h3>Description</h3>

<p>Plot of the local level and, when semiparametric model is fitted, the estimated smooth terms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
plot(x, rug = TRUE, se = TRUE, at.once = FALSE, scaled = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pgam_+3A_x">x</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="plot.pgam_+3A_rug">rug</code></td>
<td>
<p>if <code>TRUE</code> a density rug is drawn on the bottom of the graphic</p>
</td></tr>
<tr><td><code id="plot.pgam_+3A_se">se</code></td>
<td>
<p>if <code>TRUE</code> error band is drawn around the fitted values</p>
</td></tr>
<tr><td><code id="plot.pgam_+3A_at.once">at.once</code></td>
<td>
<p>if <code>TRUE</code> each plot goes to a separate window, else the user is prompted to continue</p>
</td></tr>
<tr><td><code id="plot.pgam_+3A_scaled">scaled</code></td>
<td>
<p>if <code>TRUE</code> the same scale will be used for plots of smoothed functions</p>
</td></tr>
<tr><td><code id="plot.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Error band of smooth terms is approximated.
</p>


<h3>Value</h3>

<p>No value returned.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+pgam.likelihood">pgam.likelihood</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

plot(m,at.once=TRUE)

</code></pre>

<hr>
<h2 id='predict.pgam'>Prediction</h2><span id='topic+predict.pgam'></span>

<h3>Description</h3>

<p>Prediction and forecasting of the fitted model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
predict(object, forecast = FALSE, k = 1, x = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="predict.pgam_+3A_forecast">forecast</code></td>
<td>
<p>if <code>TRUE</code> the function tries to forecast</p>
</td></tr>
<tr><td><code id="predict.pgam_+3A_k">k</code></td>
<td>
<p>steps for forecasting</p>
</td></tr>
<tr><td><code id="predict.pgam_+3A_x">x</code></td>
<td>
<p>covariate values for forecasting if the model has covariates. Must have the <code class="reqn">k</code> rows and <code class="reqn">p</code> columns</p>
</td></tr>
<tr><td><code id="predict.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It estimates predicted values, their variances, deviance components, generalized Pearson statistics components, local level, smoothed prediction and forecast.
</p>
<p>Considering a Poisson process and a gamma priori, the predictive distribution of the model is negative binomial with parameters <code class="reqn">a_{t|t-1}</code> and <code class="reqn">b_{t|t-1}</code>. So, the conditional mean and variance are given by
</p>
<p style="text-align: center;"><code class="reqn">E\left(y_{t}|Y_{t-1}\right)=a_{t|t-1}/b_{t|t-1}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">Var\left(y_{t}|Y_{t-1}\right)=a_{t|t-1}\left(1+b_{t|t-1}\right)/b_{t|t-1}^{2}</code>
</p>

<p>Deviance components are estimated as follow
</p>
<p style="text-align: center;"><code class="reqn">D\left(y;\hat\mu\right)=2\sum_{t=\tau+1}^{n}{a_{t|t-1}\log \left(\frac{a_{t|t-1}}{y_{t}b_{t|t-1}}\right)-\left(a_{t|t-1}+y_{t}\right)\log \frac{\left(y_{t}+a_{t|t-1}\right)}{\left(1+b_{t|t-1}\right)y_{t}}}</code>
</p>

<p>Generalized Pearson statistics has the form
</p>
<p style="text-align: center;"><code class="reqn">X^{2}=\sum_{t=\tau+1}^{n}\frac{\left(y_{t}b_{t|t-1}-a_{t|t-1}\right)^{2}} {a_{t|t-1}\left(1+b_{t|t-1}\right)}</code>
</p>

<p>Approximate scale parameter is given by the expression
</p>
<p style="text-align: center;"><code class="reqn">\hat\phi=frac{X^{2}}{edf}</code>
</p>

<p>where <code class="reqn">edf</code> is the number o degrees of reedom of the fitted model.
</p>


<h3>Value</h3>

<p>List with those described in <b>Details</b>
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Harvey, A. C. (1990) Forecasting, structural time series models and the Kalman Filter. Cambridge, New York
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+residuals.pgam">residuals.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

p &lt;- predict(m)$yhat
plot(ITRESP5)
lines(p)

</code></pre>

<hr>
<h2 id='print.pgam'>Model output</h2><span id='topic+print.pgam'></span>

<h3>Description</h3>

<p>Print model information</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
print(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.pgam_+3A_x">x</code></td>
<td>
<p>object of class <code>summary.pgam</code> holding the fitted model information</p>
</td></tr>
<tr><td><code id="print.pgam_+3A_digits">digits</code></td>
<td>
<p>number of decimal places for output</p>
</td></tr>
<tr><td><code id="print.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only prints out the information. 
</p>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>

<hr>
<h2 id='print.summary.pgam'>Summary output</h2><span id='topic+print.summary.pgam'></span>

<h3>Description</h3>

<p>Print output of model information</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
print.summary(x, digits, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.pgam_+3A_x">x</code></td>
<td>
<p>object of class <code>summary.pgam</code> holding the fitted model information</p>
</td></tr>
<tr><td><code id="print.summary.pgam_+3A_digits">digits</code></td>
<td>
<p>number of decimal places for output</p>
</td></tr>
<tr><td><code id="print.summary.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function actually only prints out the information. 
</p>


<h3>Value</h3>

<p>No value is returned.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>

<hr>
<h2 id='residuals.pgam'>Residuals extraction</h2><span id='topic+residuals.pgam'></span>

<h3>Description</h3>

<p>Method for residuals extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
residuals(object, type = "deviance", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="residuals.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="residuals.pgam_+3A_type">type</code></td>
<td>
<p>type of residuals to be extracted. Default is <code>deviance</code>. Options are described in <b>Details</b></p>
</td></tr>
<tr><td><code id="residuals.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The types of residuals available and a brief description are the following:
</p>
<p><code>response</code><br />
These are raw residuals of the form <code class="reqn">r_{t}=y_{t}-E\left(y_{t}|Y_{t-1}\right)</code>.
</p>
<p><code>pearson</code><br />
Pearson residuals are quite known and for this model they take the form <code class="reqn">r_{t}=\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)/Var\left(y_{t}|Y_{t-1}\right)</code>.
</p>
<p><code>deviance</code><br />
Deviance residuals are estimated by <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}\right)</code>, where <code class="reqn">d_{t}</code> is the deviance contribution of the <em>t</em>-th observation. See <code><a href="#topic+deviance.pgam">deviance.pgam</a></code> for details on deviance component estimation.
</p>
<p><code>std_deviance</code><br />
Same as deviance, but the deviance component is divided by <code class="reqn">(1-h_{t})</code>, where <code class="reqn">h_{t}</code> is the <em>t</em>-th element of the diagonal of the pseudo hat matrix of the approximating linear model. So they turn into <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}/\left(1-h_{t}\right)\right)</code>.<br />
The element <code class="reqn">h_{t}</code> has the form <code class="reqn">h_{t}=\omega\exp\left(\eta_{t+1}\right)/\sum_{j=0}^{t-1}\omega^{j}\exp\left(\eta_{t-j}\right)</code>, where <code class="reqn">\eta</code> is the predictor of the approximating linear model.
</p>
<p><code>std_scl_deviance</code><br />
Just like the last one except for the dispersion parameter in its expression, so they have the form <code class="reqn">r_{t}=sign\left(y_{t}-E\left(y_{t}|Y_{t-1}\right)\right)*sqrt\left(d_{t}/\phi*\left(1-h_{t}\right)\right)</code>, where <code class="reqn">\phi</code> is the estimated dispersion parameter of the model. See <code><a href="#topic+summary.pgam">summary.pgam</a></code> for <code class="reqn">\phi</code> estimation.
</p>




<h3>Value</h3>

<p>Vector of residuals of the model fitted.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>
<p>Pierce, D. A., Schafer, D. W. (1986) Residuals in generalized linear models. Journal of the American Statistical Association, 81(396),977-986
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+pgam.fit">pgam.fit</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

r &lt;- resid(m,"pearson")
plot(r)

</code></pre>

<hr>
<h2 id='summary.pgam'>Summary output</h2><span id='topic+summary.pgam'></span>

<h3>Description</h3>

<p>Output of model information</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pgam'
summary(object, smo.test = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.pgam_+3A_object">object</code></td>
<td>
<p>object of class <code>pgam</code> holding the fitted model</p>
</td></tr>
<tr><td><code id="summary.pgam_+3A_smo.test">smo.test</code></td>
<td>
<p>Approximate significance test of smoothing terms. It can take long, so default is <code>FALSE</code></p>
</td></tr>
<tr><td><code id="summary.pgam_+3A_...">...</code></td>
<td>
<p>further arguments passed to method</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Hypothesis tests of coefficients are based o <em>t</em> distribution. Significance tests of smooth terms are approximate for model selection purpose only. Be very careful about the later.
</p>


<h3>Value</h3>

<p>List containing all the information about the model fitted.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a> and Antonio Ponce de Leon <a href="mailto:ponce@ims.uerj.br">ponce@ims.uerj.br</a>
</p>


<h3>References</h3>

<p>Harvey, A. C., Fernandes, C. (1989) Time series models for count data or qualitative observations. Journal of Business and Economic Statistics, 7(4):407&ndash;417
</p>
<p>Junger, W. L. (2004) Semiparametric Poisson-Gamma models: a roughness penalty approach. MSc Dissertation. Rio de Janeiro, PUC-Rio, Department of Electrical Engineering. 
</p>
<p>Green, P. J., Silverman, B. W. (1994) Nonparametric Regression and Generalized Linear Models: a roughness penalty approach. Chapman and Hall, London
</p>
<p>Hastie, T. J., Tibshirani, R. J.(1990) Generalized Additive Models. Chapman and Hall, London
</p>
<p>McCullagh, P., Nelder, J. A. (1989). Generalized Linear Models. Chapman and Hall, 2nd edition, London
</p>
<p>Pierce, D. A., Schafer, D. W. (1986) Residuals in generalized linear models. Journal of the American Statistical Association, 81(396),977-986
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code>, <code><a href="#topic+predict.pgam">predict.pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
attach(aihrio)
form &lt;- ITRESP5~f(WEEK)+HOLIDAYS+rain+PM+g(tmpmax,7)+g(wet,3)
m &lt;- pgam(form,aihrio,omega=.8,beta=.01,maxit=1e2,eps=1e-4,optim.method="BFGS")

summary(m)

</code></pre>

<hr>
<h2 id='tbl2tex'>LaTeX table exporter</h2><span id='topic+tbl2tex'></span>

<h3>Description</h3>

<p>Export a data frame to a fancy LaTeX table environment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tbl2tex(tbl, label = "tbl:label(must_be_changed!)", 
caption = "Table generated with tbl2tex.", centered = TRUE, 
alignment = "center", digits = getOption("digits"), hline = TRUE, 
vline = TRUE, file = "", topleftcell = "   ")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tbl2tex_+3A_tbl">tbl</code></td>
<td>
<p>object of type data frame or matrix</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_label">label</code></td>
<td>
<p>label for LaTeX cross reference</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_caption">caption</code></td>
<td>
<p>caption for LaTeX tabular environment</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_centered">centered</code></td>
<td>
<p>logical. <code>TRUE</code> for centered cells</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_alignment">alignment</code></td>
<td>
<p>alignment of the object on the page</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_digits">digits</code></td>
<td>
<p>decimal digits after decimal point</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_hline">hline</code></td>
<td>
<p>logical. <code>TRUE</code> for horizontal borders</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_vline">vline</code></td>
<td>
<p>logical. <code>TRUE</code> for vertical borders</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_file">file</code></td>
<td>
<p>filename for outputting. If none is provided, LaTeX code is routed through the console</p>
</td></tr>
<tr><td><code id="tbl2tex_+3A_topleftcell">topleftcell</code></td>
<td>
<p>text for the top-left cell of the table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a utility function intended to ease convertion of <em>R</em> objects to LaTeX format. It only exports data frame or data matrix nonetheless.
</p>


<h3>Value</h3>

<p>LaTeX code is routed through file or console for copying and pasting.
</p>


<h3>Note</h3>

<p>For now, it handles only numerical data.
</p>


<h3>Author(s)</h3>

<p>Washington Leite Junger <a href="mailto:wjunger@ims.uerj.br">wjunger@ims.uerj.br</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pgam">pgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pgam)
data(aihrio)
m &lt;- aihrio[1:10,4:10]
tbl2tex(m,label="tbl:r_example",caption="R example of tbl2tex",digits=4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
