<!DOCTYPE html><html lang="en"><head><title>Help for package nlmixr2plot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {nlmixr2plot}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.nlmixr2AugPred'><p>Plot a nlmixr2 augPred object</p></a></li>
<li><a href='#plot.nlmixr2FitData'><p>Plot a nlmixr2 data object</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#traceplot'><p>Produce trace-plot for fit if applicable</p></a></li>
<li><a href='#vpcPlot'><p>VPC based on ui model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Nonlinear Mixed Effects Models in Population PK/PD, Plot
Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>3.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Fit and compare nonlinear mixed-effects models in
    differential equations with flexible dosing information commonly seen
    in pharmacokinetics and pharmacodynamics (Almquist, Leander, and
    Jirstrand 2015 &lt;<a href="https://doi.org/10.1007%2Fs10928-015-9409-1">doi:10.1007/s10928-015-9409-1</a>&gt;). Differential equation
    solving is by compiled C code provided in the 'rxode2' package (Wang,
    Hallow, and James 2015 &lt;<a href="https://doi.org/10.1002%2Fpsp4.12052">doi:10.1002/psp4.12052</a>&gt;). This package is for
    'ggplot2' plotting methods for 'nlmixr2' objects.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/nlmixr2/nlmixr2plot">https://github.com/nlmixr2/nlmixr2plot</a>,
<a href="https://nlmixr2.github.io/nlmixr2plot/">https://nlmixr2.github.io/nlmixr2plot/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nlmixr2/nlmixr2plot/issues/">https://github.com/nlmixr2/nlmixr2plot/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.4.0), nlmixr2est, nlmixr2extra, rxode2, utils,
vpc, xgxr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), dplyr, withr, nlmixr2data</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-14 14:35:36 UTC; matt</td>
</tr>
<tr>
<td>Author:</td>
<td>Matthew Fidler <a href="https://orcid.org/0000-0001-8538-6691"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Bill Denney <a href="https://orcid.org/0000-0002-5759-428X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb],
  Wenping Wang [aut],
  Vipul Mann [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matthew Fidler &lt;matthew.fidler@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-14 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot.nlmixr2AugPred'>Plot a nlmixr2 augPred object</h2><span id='topic+plot.nlmixr2AugPred'></span>

<h3>Description</h3>

<p>Plot a nlmixr2 augPred object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmixr2AugPred'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.nlmixr2AugPred_+3A_x">x</code></td>
<td>
<p>augPred object</p>
</td></tr>
<tr><td><code id="plot.nlmixr2AugPred_+3A_y">y</code></td>
<td>
<p>ignored, used to mach plot generic</p>
</td></tr>
<tr><td><code id="plot.nlmixr2AugPred_+3A_...">...</code></td>
<td>
<p>Other arguments (ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing called for side effects
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(nlmixr2est)
## The basic model consiss of an ini block that has initial estimates
one.compartment &lt;- function() {
  ini({
    tka &lt;- 0.45 # Log Ka
    tcl &lt;- 1 # Log Cl
    tv &lt;- 3.45    # Log V
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  # and a model block with the error sppecification and model specification
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    d/dt(depot) = -ka * depot
    d/dt(center) = ka * depot - cl / v * center
    cp = center / v
    cp ~ add(add.sd)
  })
}

## The fit is performed by the function nlmixr/nlmix2 specifying the model, data and estimate
fit &lt;- nlmixr2est::nlmixr2(one.compartment, theo_sd,  est="saem", saemControl(print=0))

# augPred shows more points for the fit:

a &lt;- nlmixr2est::augPred(fit)

# you can plot it with plot(augPred object)
plot(a)


</code></pre>

<hr>
<h2 id='plot.nlmixr2FitData'>Plot a nlmixr2 data object</h2><span id='topic+plot.nlmixr2FitData'></span>

<h3>Description</h3>

<p>Plot some standard goodness of fit plots for the focei fitted object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nlmixr2FitData'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.nlmixr2FitData_+3A_x">x</code></td>
<td>
<p>a focei fit object</p>
</td></tr>
<tr><td><code id="plot.nlmixr2FitData_+3A_...">...</code></td>
<td>
<p>additional arguments (currently ignored)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An <code>nlmixr2PlotList</code> object (a list of ggplot2 objects with easier
plotting for all of them at the same time)
</p>


<h3>Author(s)</h3>

<p>Wenping Wang &amp; Matthew Fidler
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(nlmixr2est)
one.compartment &lt;- function() {
  ini({
    tka &lt;- 0.45
    tcl &lt;- 1
    tv &lt;- 3.45
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    d/dt(depot) = -ka * depot
    d/dt(center) = ka * depot - cl / v * center
    cp = center / v
    cp ~ add(add.sd)
  })
}

## The fit is performed by the function nlmixr/nlmix2 specifying the model, data and estimate
fit &lt;- nlmixr2(one.compartment, theo_sd,  est="saem", saemControl(print=0, nBurn = 10, nEm = 20))

# This shows many goodness of fit plots
plot(fit)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+geom_cens'></span><span id='topic+geom_amt'></span><span id='topic+stat_cens'></span><span id='topic+stat_amt'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>rxode2</dt><dd><p><code><a href="rxode2.html#topic+stat_amt">geom_amt</a></code>, <code><a href="rxode2.html#topic+stat_cens">geom_cens</a></code>, <code><a href="rxode2.html#topic+stat_amt">stat_amt</a></code>, <code><a href="rxode2.html#topic+stat_cens">stat_cens</a></code></p>
</dd>
</dl>

<hr>
<h2 id='traceplot'>Produce trace-plot for fit if applicable</h2><span id='topic+traceplot'></span><span id='topic+traceplot.nlmixr2FitCore'></span>

<h3>Description</h3>

<p>Produce trace-plot for fit if applicable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceplot(x, ...)

## S3 method for class 'nlmixr2FitCore'
traceplot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="traceplot_+3A_x">x</code></td>
<td>
<p>fit object</p>
</td></tr>
<tr><td><code id="traceplot_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fit traceplot or nothing.
</p>


<h3>Author(s)</h3>

<p>Rik Schoemaker, Wenping Wang &amp; Matthew L. Fidler
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(nlmixr2est)
## The basic model consiss of an ini block that has initial estimates
one.compartment &lt;- function() {
  ini({
    tka &lt;- 0.45 # Log Ka
    tcl &lt;- 1 # Log Cl
    tv &lt;- 3.45    # Log V
    eta.ka ~ 0.6
    eta.cl ~ 0.3
    eta.v ~ 0.1
    add.sd &lt;- 0.7
  })
  # and a model block with the error sppecification and model specification
  model({
    ka &lt;- exp(tka + eta.ka)
    cl &lt;- exp(tcl + eta.cl)
    v &lt;- exp(tv + eta.v)
    d/dt(depot) = -ka * depot
    d/dt(center) = ka * depot - cl / v * center
    cp = center / v
    cp ~ add(add.sd)
  })
}

## The fit is performed by the function nlmixr/nlmix2 specifying the model, data and estimate
fit &lt;- nlmixr2(one.compartment, theo_sd,  est="saem", saemControl(print=0))

# This shows the traceplot of the fit (useful for saem)
traceplot(fit)


</code></pre>

<hr>
<h2 id='vpcPlot'>VPC based on ui model</h2><span id='topic+vpcPlot'></span><span id='topic+vpcPlotTad'></span><span id='topic+vpcCensTad'></span><span id='topic+vpcCens'></span>

<h3>Description</h3>

<p>VPC based on ui model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vpcPlot(
  fit,
  data = NULL,
  n = 300,
  bins = "jenks",
  n_bins = "auto",
  bin_mid = "mean",
  show = NULL,
  stratify = NULL,
  pred_corr = FALSE,
  pred_corr_lower_bnd = 0,
  pi = c(0.05, 0.95),
  ci = c(0.05, 0.95),
  uloq = fit$dataUloq,
  lloq = fit$dataLloq,
  log_y = FALSE,
  log_y_min = 0.001,
  xlab = NULL,
  ylab = NULL,
  title = NULL,
  smooth = TRUE,
  vpc_theme = NULL,
  facet = "wrap",
  scales = "fixed",
  labeller = NULL,
  vpcdb = FALSE,
  verbose = FALSE,
  ...,
  seed = 1009,
  idv = "time",
  cens = FALSE
)

vpcPlotTad(..., idv = "tad")

vpcCensTad(..., cens = TRUE, idv = "tad")

vpcCens(..., cens = TRUE, idv = "time")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vpcPlot_+3A_fit">fit</code></td>
<td>
<p>nlmixr2 fit object</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_data">data</code></td>
<td>
<p>this is the data to use to augment the VPC fit.  By
default is the fitted data, (can be retrieved by
<code><a href="nlme.html#topic+getData">getData</a></code>), but it can be changed by specifying
this argument.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_n">n</code></td>
<td>
<p>Number of VPC simulations</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_bins">bins</code></td>
<td>
<p>either &quot;density&quot;, &quot;time&quot;, or &quot;data&quot;, &quot;none&quot;, or one of the approaches available in classInterval() such as &quot;jenks&quot; (default) or &quot;pretty&quot;, or a numeric vector specifying the bin separators.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_n_bins">n_bins</code></td>
<td>
<p>when using the &quot;auto&quot; binning method, what number of bins to aim for</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_bin_mid">bin_mid</code></td>
<td>
<p>either &quot;mean&quot; for the mean of all timepoints (default) or &quot;middle&quot; to use the average of the bin boundaries.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_show">show</code></td>
<td>
<p>what to show in VPC (obs_dv, obs_ci, pi, pi_as_area, pi_ci, obs_median, sim_median, sim_median_ci)</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_stratify">stratify</code></td>
<td>
<p>character vector of stratification variables. Only 1 or 2 stratification variables can be supplied.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_pred_corr">pred_corr</code></td>
<td>
<p>perform prediction-correction?</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_pred_corr_lower_bnd">pred_corr_lower_bnd</code></td>
<td>
<p>lower bound for the prediction-correction</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_pi">pi</code></td>
<td>
<p>simulated prediction interval to plot. Default is c(0.05, 0.95),</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_ci">ci</code></td>
<td>
<p>confidence interval to plot. Default is (0.05, 0.95)</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_uloq">uloq</code></td>
<td>
<p>Number or NULL indicating upper limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_lloq">lloq</code></td>
<td>
<p>Number or NULL indicating lower limit of quantification. Default is NULL.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_log_y">log_y</code></td>
<td>
<p>Boolean indicting whether y-axis should be shown as logarithmic. Default is FALSE.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_log_y_min">log_y_min</code></td>
<td>
<p>minimal value when using log_y argument. Default is 1e-3.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_xlab">xlab</code></td>
<td>
<p>label for x axis</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_ylab">ylab</code></td>
<td>
<p>label for y axis</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_title">title</code></td>
<td>
<p>title</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_smooth">smooth</code></td>
<td>
<p>&quot;smooth&quot; the VPC (connect bin midpoints) or show bins as rectangular boxes. Default is TRUE.</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_vpc_theme">vpc_theme</code></td>
<td>
<p>theme to be used in VPC. Expects list of class vpc_theme created with function vpc_theme()</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_facet">facet</code></td>
<td>
<p>either &quot;wrap&quot;, &quot;columns&quot;, or &quot;rows&quot;</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_scales">scales</code></td>
<td>
<p>either &quot;fixed&quot; (default), &quot;free_y&quot;, &quot;free_x&quot; or &quot;free&quot;</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_labeller">labeller</code></td>
<td>
<p>ggplot2 labeller function to be passed to underlying ggplot object</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_vpcdb">vpcdb</code></td>
<td>
<p>Boolean whether to return the underlying vpcdb rather than the plot</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_verbose">verbose</code></td>
<td>
<p>show debugging information (TRUE or FALSE)</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_...">...</code></td>
<td>
<p>Args sent to <code><a href="rxode2.html#topic+rxSolve">rxSolve</a></code></p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_seed">seed</code></td>
<td>
<p>an object specifying if and how the random number
generator should be initialized</p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_idv">idv</code></td>
<td>
<p>Name of independent variable. For <code>vpcPlot()</code> and
<code>vpcCens()</code> the default is <code>"time"</code> for <code>vpcPlotTad()</code> and
<code>vpcCensTad()</code> this is <code>"tad"</code></p>
</td></tr>
<tr><td><code id="vpcPlot_+3A_cens">cens</code></td>
<td>
<p>is a boolean to show if this is a censoring plot or
not.  When <code>cens=TRUE</code> this is actually a censoring vpc plot
(with <code>vpcCens()</code> and <code>vpcCensTad()</code>).  When <code>cens=FALSE</code> this is
traditional VPC plot (<code>vpcPlot()</code> and <code>vpcPlotTad()</code>).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Simulated dataset (invisibly)
</p>


<h3>Author(s)</h3>

<p>Matthew L. Fidler
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
one.cmt &lt;- function() {
 ini({
   tka &lt;- 0.45; label("Ka")
   tcl &lt;- log(c(0, 2.7, 100)); label("Cl")
   tv &lt;- 3.45; label("V")
   eta.ka ~ 0.6
   eta.cl ~ 0.3
   eta.v ~ 0.1
   add.sd &lt;- 0.7; label("Additive residual error")
 })
 model({
   ka &lt;- exp(tka + eta.ka)
   cl &lt;- exp(tcl + eta.cl)
   v &lt;- exp(tv + eta.v)
   linCmt() ~ add(add.sd)
 })
}

fit &lt;-
  nlmixr2est::nlmixr(
    one.cmt,
    data = nlmixr2data::theo_sd,
    est = "saem",
    control = list(print = 0)
  )

vpcPlot(fit)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
