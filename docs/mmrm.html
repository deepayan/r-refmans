<!DOCTYPE html><html><head><title>Help for package mmrm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mmrm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mmrm-package'><p><code>mmrm</code> Package</p></a></li>
<li><a href='#Anova.mmrm'><p>Conduct type II/III hypothesis testing on the MMRM fit results.</p></a></li>
<li><a href='#as.cov_struct'><p>Coerce into a Covariance Structure Definition</p></a></li>
<li><a href='#bcva_data'><p>Example Data on BCVA</p></a></li>
<li><a href='#cached_mmrm_results'><p>Cache Data for <code>mmrm</code> Model Comparison</p></a></li>
<li><a href='#car_add_mmrm'><p>Register <code>mmrm</code> For Use With <code>car::Anova</code></p></a></li>
<li><a href='#check_package_version'><p>Check Suggested Dependency Against Version Requirements</p></a></li>
<li><a href='#component'><p>Component Access for <code>mmrm_tmb</code> Objects</p></a></li>
<li><a href='#cov_struct'><p>Define a Covariance Structure</p></a></li>
<li><a href='#cov_type_abbr'><p>Retrieve Associated Abbreviated Covariance Structure Type Name</p></a></li>
<li><a href='#cov_type_name'><p>Retrieve Associated Full Covariance Structure Type Name</p></a></li>
<li><a href='#COV_TYPES'><p>Covariance Type Database</p></a></li>
<li><a href='#covariance_types'><p>Covariance Types</p></a></li>
<li><a href='#df_1d'><p>Calculation of Degrees of Freedom for One-Dimensional Contrast</p></a></li>
<li><a href='#df_md'><p>Calculation of Degrees of Freedom for Multi-Dimensional Contrast</p></a></li>
<li><a href='#drop_elements'><p>Drop Items from an Indexible</p></a></li>
<li><a href='#emit_tidymodels_register_msg'><p>Format a Message to Emit When Tidymodels is Loaded</p></a></li>
<li><a href='#emmeans_support'><p>Support for <code>emmeans</code></p></a></li>
<li><a href='#emp_start'><p>Empirical Starting Value</p></a></li>
<li><a href='#fev_data'><p>Example Data on FEV1</p></a></li>
<li><a href='#fill_names'><p>Complete <code>character</code> Vector Names From Values</p></a></li>
<li><a href='#fit_mmrm'><p>Low-Level Fitting Function for MMRM</p></a></li>
<li><a href='#fit_single_optimizer'><p>Fitting an MMRM with Single Optimizer</p></a></li>
<li><a href='#flat_expr'><p>Flatten Expressions for Non-standard Evaluation</p></a></li>
<li><a href='#format_symbols'><p>Format Symbol Objects</p></a></li>
<li><a href='#format.cov_struct'><p>Format Covariance Structure Object</p></a></li>
<li><a href='#formula_rhs'><p>Extract Right-Hand-Side (rhs) from Formula</p></a></li>
<li><a href='#h_add_covariance_terms'><p>Add Individual Covariance Variables As Terms to Formula</p></a></li>
<li><a href='#h_add_terms'><p>Add Formula Terms with Character</p></a></li>
<li><a href='#h_coef_table'><p>Coefficients Table for MMRM Fit</p></a></li>
<li><a href='#h_confirm_large_levels'><p>Ask for Confirmation on Large Visit Levels</p></a></li>
<li><a href='#h_construct_model_frame_inputs'><p>Construction of Model Frame Formula and Data Inputs</p></a></li>
<li><a href='#h_default_value'><p>Default Value on NULL</p>
Return default value when first argument is NULL.</a></li>
<li><a href='#h_df_1d_bw'><p>Calculation of Between-Within Degrees of Freedom for One-Dimensional Contrast</p></a></li>
<li><a href='#h_df_1d_kr'><p>Calculation of Kenward-Roger Degrees of Freedom for One-Dimensional Contrast</p></a></li>
<li><a href='#h_df_1d_res'><p>Calculation of Residual Degrees of Freedom for One-Dimensional Contrast</p></a></li>
<li><a href='#h_df_1d_sat'><p>Calculation of Satterthwaite Degrees of Freedom for One-Dimensional Contrast</p></a></li>
<li><a href='#h_df_bw_calc'><p>Calculation of Between-Within Degrees of Freedom</p></a></li>
<li><a href='#h_df_md_bw'><p>Calculation of Between-Within Degrees of Freedom for Multi-Dimensional Contrast</p></a></li>
<li><a href='#h_df_md_from_1d'><p>Creating F-Statistic Results from One-Dimensional Contrast</p></a></li>
<li><a href='#h_df_md_kr'><p>Calculation of Kenward-Roger Degrees of Freedom for Multi-Dimensional Contrast</p></a></li>
<li><a href='#h_df_md_res'><p>Calculation of Residual Degrees of Freedom for Multi-Dimensional Contrast</p></a></li>
<li><a href='#h_df_md_sat'><p>Calculation of Satterthwaite Degrees of Freedom for Multi-Dimensional Contrast</p></a></li>
<li><a href='#h_df_min_bw'><p>Assign Minimum Degrees of Freedom Given Involved Coefficients</p></a></li>
<li><a href='#h_df_to_tibble'><p>Coerce a Data Frame to a <code>tibble</code></p></a></li>
<li><a href='#h_drop_covariance_terms'><p>Drop Formula Terms used for Covariance Structure Definition</p></a></li>
<li><a href='#h_extract_covariance_terms'><p>Extract Formula Terms used for Covariance Structure Definition</p></a></li>
<li><a href='#h_factor_ref'><p>Convert Character to Factor Following Reference</p></a></li>
<li><a href='#h_get_contrast'><p>Obtain Contrast for Specified Effect</p></a></li>
<li><a href='#h_get_cov_default'><p>Obtain Default Covariance Method</p></a></li>
<li><a href='#h_get_empirical'><p>Obtain Empirical/Jackknife/Bias-Reduced Covariance</p></a></li>
<li><a href='#h_get_kr_comp'><p>Obtain Kenward-Roger Adjustment Components</p></a></li>
<li><a href='#h_get_optimizers'><p>Obtain Optimizer according to Optimizer String Value</p></a></li>
<li><a href='#h_get_prediction'><p>Get Prediction</p></a></li>
<li><a href='#h_get_prediction_variance'><p>Get Prediction Variance</p></a></li>
<li><a href='#h_get_sim_per_subj'><p>Get simulated values by patient.</p></a></li>
<li><a href='#h_get_theta_from_cov'><p>Obtain Theta from Covariance Matrix</p></a></li>
<li><a href='#h_gradient'><p>Computation of a Gradient Given Jacobian and Contrast Vector</p></a></li>
<li><a href='#h_jac_list'><p>Obtain List of Jacobian Matrix Entries for Covariance Matrix</p></a></li>
<li><a href='#h_kr_df'><p>Obtain the Adjusted Kenward-Roger degrees of freedom</p></a></li>
<li><a href='#h_md_denom_df'><p>Calculating Denominator Degrees of Freedom for the Multi-Dimensional Case</p></a></li>
<li><a href='#h_mmrm_tmb_assert_start'><p>Asserting Sane Start Values for <code>TMB</code> Fit</p></a></li>
<li><a href='#h_mmrm_tmb_check_conv'><p>Checking the <code>TMB</code> Optimization Result</p></a></li>
<li><a href='#h_mmrm_tmb_data'><p>Data for <code>TMB</code> Fit</p></a></li>
<li><a href='#h_mmrm_tmb_extract_cov'><p>Extract covariance matrix from <code>TMB</code> report and input data</p></a></li>
<li><a href='#h_mmrm_tmb_fit'><p>Build <code>TMB</code> Fit Result List</p></a></li>
<li><a href='#h_mmrm_tmb_formula_parts'><p>Processing the Formula for <code>TMB</code> Fit</p></a></li>
<li><a href='#h_mmrm_tmb_parameters'><p>Start Parameters for <code>TMB</code> Fit</p></a></li>
<li><a href='#h_newdata_add_pred'><p>Add Prediction Results to New Data</p></a></li>
<li><a href='#h_optimizer_fun'><p>Obtain Optimizer Function with Character</p></a></li>
<li><a href='#h_partial_fun_args'><p>Create Partial Functions</p></a></li>
<li><a href='#h_print_aic_list'><p>Printing AIC and other Model Fit Criteria</p></a></li>
<li><a href='#h_print_call'><p>Printing MMRM Function Call</p></a></li>
<li><a href='#h_print_cov'><p>Printing MMRM Covariance Type</p></a></li>
<li><a href='#h_quad_form'><p>Quadratic Form Calculations</p></a></li>
<li><a href='#h_reconcile_cov_struct'><p>Reconcile Possible Covariance Structure Inputs</p></a></li>
<li><a href='#h_record_all_output'><p>Capture all Output</p></a></li>
<li><a href='#h_register_s3'><p>Register S3 Method</p>
Register S3 method to a generic.</a></li>
<li><a href='#h_residuals_normalized'><p>Calculate normalized residuals</p></a></li>
<li><a href='#h_residuals_pearson'><p>Calculate Pearson Residuals</p></a></li>
<li><a href='#h_residuals_response'><p>Calculate response residuals.</p></a></li>
<li><a href='#h_split_control'><p>Split Control List</p></a></li>
<li><a href='#h_summarize_all_fits'><p>Summarizing List of Fits</p></a></li>
<li><a href='#h_tbl_confint_terms'><p>Extract <code>tibble</code> with Confidence Intervals and Term Names</p></a></li>
<li><a href='#h_test_1d'><p>Creating T-Statistic Test Results For One-Dimensional Contrast</p></a></li>
<li><a href='#h_test_md'><p>Creating F-Statistic Test Results For Multi-Dimensional Contrast</p></a></li>
<li><a href='#h_tr'><p>Trace of a Matrix</p></a></li>
<li><a href='#h_valid_formula'><p>Validate mmrm Formula</p></a></li>
<li><a href='#h_var_adj'><p>Obtain the Adjusted Covariance Matrix</p></a></li>
<li><a href='#h_warn_na_action'><p>Warn on na.action</p></a></li>
<li><a href='#h_within_or_between'><p>Determine Within or Between for each Design Matrix Column</p></a></li>
<li><a href='#is_infix'><p>Test Whether a Symbol is an Infix Operator</p></a></li>
<li><a href='#mmrm'><p>Fit an MMRM</p></a></li>
<li><a href='#mmrm_control'><p>Control Parameters for Fitting an MMRM</p></a></li>
<li><a href='#mmrm_methods'><p>Methods for <code>mmrm</code> Objects</p></a></li>
<li><a href='#mmrm_tidiers'><p>Tidying Methods for <code>mmrm</code> Objects</p></a></li>
<li><a href='#mmrm_tmb_methods'><p>Methods for <code>mmrm_tmb</code> Objects</p></a></li>
<li><a href='#parsnip_add_mmrm'><p>Register <code>mmrm</code> For Use With <code>tidymodels</code></p></a></li>
<li><a href='#position_symbol'><p>Search For the Position of a Symbol</p></a></li>
<li><a href='#print.cov_struct'><p>Print a Covariance Structure Object</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#refit_multiple_optimizers'><p>Refitting MMRM with Multiple Optimizers</p></a></li>
<li><a href='#register_on_load'><p>Helper Function for Registering Functionality With Suggests Packages</p></a></li>
<li><a href='#std_start'><p>Standard Starting Value</p></a></li>
<li><a href='#tmb_cov_type'><p>Produce A Covariance Identifier Passing to TMB</p></a></li>
<li><a href='#validate_cov_struct'><p>Validate Covariance Structure Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Mixed Models for Repeated Measures</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.11</td>
</tr>
<tr>
<td>Description:</td>
<td>Mixed models for repeated measures (MMRM) are a popular
    choice for analyzing longitudinal continuous outcomes in randomized
    clinical trials and beyond; see Cnaan, Laird and Slasor (1997)
    &lt;<a href="https://doi.org/10.1002/(SICI)1097-0258(19971030)16:20%3C2349::AID-SIM667%3E3.0.CO;2-E">doi:10.1002/(SICI)1097-0258(19971030)16:20%3C2349::AID-SIM667%3E3.0.CO;2-E</a>&gt;
    for a tutorial and Mallinckrodt, Lane, Schnell, Peng and Mancuso
    (2008) &lt;<a href="https://doi.org/10.1177%2F009286150804200402">doi:10.1177/009286150804200402</a>&gt; for a review. This package
    implements MMRM based on the marginal linear model without random
    effects using Template Model Builder ('TMB') which enables fast and
    robust model fitting. Users can specify a variety of covariance
    matrices, weight observations, fit models with restricted or standard
    maximum likelihood inference, perform hypothesis testing with
    Satterthwaite or Kenward-Roger adjustment, and extract least square
    means estimates by using 'emmeans'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://openpharma.github.io/mmrm/">https://openpharma.github.io/mmrm/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/openpharma/mmrm/issues">https://github.com/openpharma/mmrm/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate (&ge; 2.0), generics, lifecycle, Matrix, methods,
nlme, parallel, Rcpp, Rdpack, stats, stringr, tibble, TMB (&ge;
1.9.1), utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>car (&ge; 3.1.2), cli, clubSandwich, clusterGeneration, dplyr,
emmeans (&ge; 1.6), estimability, ggplot2, glmmTMB, hardhat,
knitr, lme4, MASS, microbenchmark, mockery, parallelly (&ge;
1.32.0), parsnip (&ge; 1.1.0), purrr, rmarkdown, sasr, scales,
testthat (&ge; 3.0.0), tidymodels, xml2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppEigen, testthat, TMB (&ge; 1.9.1)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Collate:</td>
<td>'between-within.R' 'catch-routine-registration.R'
'component.R' 'cov_struct.R' 'data.R' 'empirical.R' 'fit.R'
'kenwardroger.R' 'mmrm-methods.R' 'mmrm-package.R' 'utils.R'
'residual.R' 'utils-nse.R' 'utils-formula.R' 'satterthwaite.R'
'skipping.R' 'tidiers.R' 'testing.R' 'tmb-methods.R' 'tmb.R'
'interop-emmeans.R' 'interop-parsnip.R' 'interop-car.R' 'zzz.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-04 20:26:57 UTC; sabanesd</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniel Sabanes Bove [aut, cre],
  Liming Li [aut],
  Julia Dedic [aut],
  Doug Kelkhoff [aut],
  Kevin Kunzmann [aut],
  Brian Matthew Lang [aut],
  Christian Stock [aut],
  Ya Wang [aut],
  Craig Gower-Page [ctb],
  Dan James [aut],
  Jonathan Sidi [aut],
  Daniel Leibovitz [aut],
  Daniel D. Sjoberg <a href="https://orcid.org/0000-0003-0862-2018"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Boehringer Ingelheim Ltd. [cph, fnd],
  Gilead Sciences, Inc. [cph, fnd],
  F. Hoffmann-La Roche AG [cph, fnd],
  Merck Sharp &amp; Dohme, Inc. [cph, fnd],
  AstraZeneca plc [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniel Sabanes Bove &lt;daniel.sabanes_bove@roche.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 08:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mmrm-package'><code>mmrm</code> Package</h2><span id='topic+mmrm-package'></span>

<h3>Description</h3>

<p><code>mmrm</code> implements mixed models with repeated measures (MMRM) in R.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Daniel Sabanes Bove <a href="mailto:daniel.sabanes_bove@roche.com">daniel.sabanes_bove@roche.com</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Liming Li <a href="mailto:liming.li@roche.com">liming.li@roche.com</a>
</p>
</li>
<li><p> Julia Dedic <a href="mailto:julia.dedic@roche.com">julia.dedic@roche.com</a>
</p>
</li>
<li><p> Doug Kelkhoff <a href="mailto:doug.kelkhoff@roche.com">doug.kelkhoff@roche.com</a>
</p>
</li>
<li><p> Kevin Kunzmann <a href="mailto:kevin.kunzmann@boehringer-ingelheim.com">kevin.kunzmann@boehringer-ingelheim.com</a>
</p>
</li>
<li><p> Brian Matthew Lang <a href="mailto:brian.lang@msd.com">brian.lang@msd.com</a>
</p>
</li>
<li><p> Christian Stock <a href="mailto:christian.stock@boehringer-ingelheim.com">christian.stock@boehringer-ingelheim.com</a>
</p>
</li>
<li><p> Ya Wang <a href="mailto:ya.wang10@gilead.com">ya.wang10@gilead.com</a>
</p>
</li>
<li><p> Dan James <a href="mailto:dan.james@astrazeneca.com">dan.james@astrazeneca.com</a>
</p>
</li>
<li><p> Jonathan Sidi <a href="mailto:yoni@pinpointstrategies.io">yoni@pinpointstrategies.io</a>
</p>
</li>
<li><p> Daniel Leibovitz <a href="mailto:daniel.leibovitz@roche.com">daniel.leibovitz@roche.com</a>
</p>
</li>
<li><p> Daniel D. Sjoberg <a href="mailto:sjobergd@gene.com">sjobergd@gene.com</a> (<a href="https://orcid.org/0000-0003-0862-2018">ORCID</a>)
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Craig Gower-Page <a href="mailto:craig.gower-page@roche.com">craig.gower-page@roche.com</a> [contributor]
</p>
</li>
<li><p> Boehringer Ingelheim Ltd. [copyright holder, funder]
</p>
</li>
<li><p> Gilead Sciences, Inc. [copyright holder, funder]
</p>
</li>
<li><p> F. Hoffmann-La Roche AG [copyright holder, funder]
</p>
</li>
<li><p> Merck Sharp &amp; Dohme, Inc. [copyright holder, funder]
</p>
</li>
<li><p> AstraZeneca plc [copyright holder, funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://openpharma.github.io/mmrm/">https://openpharma.github.io/mmrm/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/openpharma/mmrm/issues">https://github.com/openpharma/mmrm/issues</a>
</p>
</li></ul>


<hr>
<h2 id='Anova.mmrm'>Conduct type II/III hypothesis testing on the MMRM fit results.</h2><span id='topic+Anova.mmrm'></span>

<h3>Description</h3>

<p>Conduct type II/III hypothesis testing on the MMRM fit results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Anova.mmrm(
  mod,
  type = c("II", "III", "2", "3"),
  tol = sqrt(.Machine$double.eps),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Anova.mmrm_+3A_mod">mod</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the fitted MMRM.</p>
</td></tr>
<tr><td><code id="Anova.mmrm_+3A_type">type</code></td>
<td>
<p>(<code>string</code>) type of test, &quot;II&quot;, &quot;III&quot;, '2', or '3'.</p>
</td></tr>
<tr><td><code id="Anova.mmrm_+3A_tol">tol</code></td>
<td>
<p>(<code>numeric</code>) threshold blow which values are treated as 0.</p>
</td></tr>
<tr><td><code id="Anova.mmrm_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>Anova</code> will return <code>anova</code> object with one row per variable and columns
<code style="white-space: pre;">&#8288;Num Df&#8288;</code>(numerator degrees of freedom), <code style="white-space: pre;">&#8288;Denom Df&#8288;</code>(denominator degrees of freedom),
<code style="white-space: pre;">&#8288;F Statistic&#8288;</code> and <code style="white-space: pre;">&#8288;Pr(&gt;=F)&#8288;</code>.
</p>

<hr>
<h2 id='as.cov_struct'>Coerce into a Covariance Structure Definition</h2><span id='topic+as.cov_struct'></span><span id='topic+as.cov_struct.formula'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.cov_struct(x, ...)

## S3 method for class 'formula'
as.cov_struct(x, warn_partial = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.cov_struct_+3A_x">x</code></td>
<td>
<p>an object from which to derive a covariance structure. See object
specific sections for details.</p>
</td></tr>
<tr><td><code id="as.cov_struct_+3A_...">...</code></td>
<td>
<p>additional arguments unused.</p>
</td></tr>
<tr><td><code id="as.cov_struct_+3A_warn_partial">warn_partial</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to emit a warning when parts of the
formula are disregarded.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A covariance structure can be parsed from a model definition formula or call.
Generally, covariance structures defined using non-standard evaluation take
the following form:
</p>
<div class="sourceCode"><pre>type( (visit, )* visit | (group /)? subject )
</pre></div>
<p>For example, formulas may include terms such as
</p>
<div class="sourceCode r"><pre>us(time | subject)
cp(time | group / subject)
sp_exp(coord1, coord2 | group / subject)
</pre></div>
<p>Note that only <code>sp_exp</code> (spatial) covariance structures may provide multiple
coordinates, which identify the Euclidean distance between the time points.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+cov_struct">cov_struct()</a></code> object.
</p>


<h3>Methods (by class)</h3>


<ul>
<li> <p><code>as.cov_struct(formula)</code>: When provided a formula, any specialized functions are assumed to be
covariance structure definitions and must follow the form:
</p>
<div class="sourceCode"><pre>y ~ xs + type( (visit, )* visit | (group /)? subject )
</pre></div>
<p>Any component on the right hand side of a formula is considered when
searching for a covariance definition.
</p>
</li></ul>


<h3>See Also</h3>

<p>Other covariance types: 
<code><a href="#topic+cov_struct">cov_struct</a>()</code>,
<code><a href="#topic+covariance_types">covariance_types</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># provide a covariance structure as a right-sided formula
as.cov_struct(~ csh(visit | group / subject))

# when part of a full formula, suppress warnings using `warn_partial = FALSE`
as.cov_struct(y ~ x + csh(visit | group / subject), warn_partial = FALSE)

</code></pre>

<hr>
<h2 id='bcva_data'>Example Data on BCVA</h2><span id='topic+bcva_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bcva_data
</code></pre>


<h3>Format</h3>

<p>A <code>tibble</code> with 10,000 rows and 7 variables:
</p>

<ul>
<li> <p><code>USUBJID</code>: subject ID.
</p>
</li>
<li> <p><code>VISITN</code>: visit number (numeric).
</p>
</li>
<li> <p><code>AVISIT</code>: visit number (factor).
</p>
</li>
<li> <p><code>ARMCD</code>: treatment, <code>TRT</code> or <code>CTL</code>.
</p>
</li>
<li> <p><code>RACE</code>: 3-category race.
</p>
</li>
<li> <p><code>BCVA_BL</code>: BCVA at baseline.
</p>
</li>
<li> <p><code>BCVA_CHG</code>: Change in BCVA at study visits.
</p>
</li></ul>



<h3>Note</h3>

<p>Measurements of BCVA (best corrected visual acuity) is a measure of how
how many letters a person can read off of an eye chart using corrective
lenses or contacts. This a common endpoint in ophthalmology trials.
</p>


<h3>Source</h3>

<p>This is an artificial dataset.
</p>

<hr>
<h2 id='cached_mmrm_results'>Cache Data for <code>mmrm</code> Model Comparison</h2><span id='topic+cached_mmrm_results'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cached_mmrm_results
</code></pre>


<h3>Format</h3>

<p>A <code>list</code> with following elements:
</p>

<ul>
<li> <p><code>conv_time_fev</code>: Convergence time on FEV data.
</p>
</li>
<li> <p><code>conv_time_bcva</code>: Convergence time on BCVA data.
</p>
</li>
<li> <p><code>rel_diff_ests_tbl_fev</code>: Relative difference in estimates on FEV data.
</p>
</li>
<li> <p><code>rel_diff_ests_tbl_bcva</code>: Relative difference in estimates on BCVA data.
</p>
</li>
<li> <p><code>conv_rate</code>: Convergence rate on data with different missing levels.
</p>
</li>
<li> <p><code>df_missingness</code>: Summary of missingness on simulated data.
</p>
</li></ul>



<h3>Note</h3>

<p>The cached data for comparison is used for the vignettes generation.
Please make sure that this data is refreshed before each package release
by running the script <code>data-raw/mmrm_review.R</code>.
Please make sure to install the <code>mmrm</code> package instead of using
<code>devtools::load_all()</code> before running the script to achieve accurate timings.
</p>


<h3>Source</h3>

<p>This is created based on simulations on FEV data and BCVA data.
</p>

<hr>
<h2 id='car_add_mmrm'>Register <code>mmrm</code> For Use With <code>car::Anova</code></h2><span id='topic+car_add_mmrm'></span>

<h3>Description</h3>

<p>Register <code>mmrm</code> For Use With <code>car::Anova</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>car_add_mmrm(quietly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="car_add_mmrm_+3A_quietly">quietly</code></td>
<td>
<p>logical: should progress and error messages be suppressed?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical value indicating whether registration was successful.
</p>

<hr>
<h2 id='check_package_version'>Check Suggested Dependency Against Version Requirements</h2><span id='topic+check_package_version'></span>

<h3>Description</h3>

<p>Check Suggested Dependency Against Version Requirements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_package_version(pkg, ver = c(NA_character_, NA_character_))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_package_version_+3A_pkg">pkg</code></td>
<td>
<p>(<code>string</code>)<br /> package name.</p>
</td></tr>
<tr><td><code id="check_package_version_+3A_ver">ver</code></td>
<td>
<p>(<code>character</code>)<br /> of length 2 whose elements can be provided to
<code><a href="base.html#topic+numeric_version">numeric_version()</a></code>, representing a minimum and maximum (inclusive) version
requirement for interoperability. When <code>NA</code>, no version requirement is
imposed. Defaults to no version requirement.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical (invisibly) indicating whether the loaded package meets
the version requirements. A warning is emitted otherwise.
</p>

<hr>
<h2 id='component'>Component Access for <code>mmrm_tmb</code> Objects</h2><span id='topic+component'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>component(
  object,
  name = c("cov_type", "subject_var", "n_theta", "n_subjects", "n_timepoints", "n_obs",
    "beta_vcov", "beta_vcov_complete", "varcor", "formula", "dataset", "n_groups",
    "reml", "convergence", "evaluations", "method", "optimizer", "conv_message", "call",
    "theta_est", "beta_est", "beta_est_complete", "beta_aliased", "x_matrix", "y_vector",
    "neg_log_lik", "jac_list", "theta_vcov", "full_frame")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="component_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM.</p>
</td></tr>
<tr><td><code id="component_+3A_name">name</code></td>
<td>
<p>(<code>character</code>)<br /> the component(s) to be retrieved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Available <code>component()</code> names are as follows:
</p>

<ul>
<li> <p><code>call</code>: low-level function call which generated the model.
</p>
</li>
<li> <p><code>formula</code>: model formula.
</p>
</li>
<li> <p><code>dataset</code>: data set name.
</p>
</li>
<li> <p><code>cov_type</code>: covariance structure type.
</p>
</li>
<li> <p><code>n_theta</code>: number of parameters.
</p>
</li>
<li> <p><code>n_subjects</code>: number of subjects.
</p>
</li>
<li> <p><code>n_timepoints</code>: number of modeled time points.
</p>
</li>
<li> <p><code>n_obs</code>: total number of observations.
</p>
</li>
<li> <p><code>reml</code>: was REML used (ML was used if <code>FALSE</code>).
</p>
</li>
<li> <p><code>neg_log_lik</code>: negative log likelihood.
</p>
</li>
<li> <p><code>convergence</code>: convergence code from optimizer.
</p>
</li>
<li> <p><code>conv_message</code>: message accompanying the convergence code.
</p>
</li>
<li> <p><code>evaluations</code>: number of function evaluations for optimization.
</p>
</li>
<li> <p><code>method</code>: Adjustment method which was used (for <code>mmrm</code> objects),
otherwise <code>NULL</code> (for <code>mmrm_tmb</code> objects).
</p>
</li>
<li> <p><code>beta_vcov</code>: estimated variance-covariance matrix of coefficients
(excluding aliased coefficients). When Kenward-Roger/Empirical adjusted
coefficients covariance matrix is used, the adjusted covariance matrix is returned (to still obtain the
original asymptotic covariance matrix use <code>object$beta_vcov</code>).
</p>
</li>
<li> <p><code>beta_vcov_complete</code>: estimated variance-covariance matrix including
aliased coefficients with entries set to <code>NA</code>.
</p>
</li>
<li> <p><code>varcor</code>: estimated covariance matrix for residuals. If there are multiple
groups, a named list of estimated covariance matrices for residuals will be
returned. The names are the group levels.
</p>
</li>
<li> <p><code>theta_est</code>: estimated variance parameters.
</p>
</li>
<li> <p><code>beta_est</code>: estimated coefficients (excluding aliased coefficients).
</p>
</li>
<li> <p><code>beta_est_complete</code>: estimated coefficients including aliased coefficients
set to <code>NA</code>.
</p>
</li>
<li> <p><code>beta_aliased</code>: whether each coefficient was aliased (i.e. cannot be estimated)
or not.
</p>
</li>
<li> <p><code>theta_vcov</code>:  estimated variance-covariance matrix of variance parameters.
</p>
</li>
<li> <p><code>x_matrix</code>: design matrix used (excluding aliased columns).
</p>
</li>
<li> <p><code>y_vector</code>: response vector used.
</p>
</li>
<li> <p><code>jac_list</code>: Jacobian, see  <code><a href="#topic+h_jac_list">h_jac_list()</a></code> for details.
</p>
</li>
<li> <p><code>full_frame</code>: <code>data.frame</code> with <code>n</code> rows containing all variables needed in the model.
</p>
</li></ul>



<h3>Value</h3>

<p>The corresponding component of the object, see details.
</p>


<h3>See Also</h3>

<p>In the <code>lme4</code> package there is a similar function <code>getME()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)
# Get all available components.
component(fit)
# Get convergence code and message.
component(fit, c("convergence", "conv_message"))
# Get modeled formula as a string.
component(fit, c("formula"))

</code></pre>

<hr>
<h2 id='cov_struct'>Define a Covariance Structure</h2><span id='topic+cov_struct'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_struct(
  type = cov_types(),
  visits,
  subject,
  group = character(),
  heterogeneous = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov_struct_+3A_type">type</code></td>
<td>
<p>(<code>string</code>)<br /> the name of the covariance structure type to use.
For available options, see <code>cov_types()</code>. If a type abbreviation is used
that implies heterogeneity (e.g. <code>cph</code>) and no value is provided to
<code>heterogeneous</code>, then the heterogeneity is derived from the type name.</p>
</td></tr>
<tr><td><code id="cov_struct_+3A_visits">visits</code></td>
<td>
<p>(<code>character</code>)<br /> a vector of variable names to use for the
longitudinal terms of the covariance structure. Multiple terms are only
permitted for the <code>"spatial"</code> covariance type.</p>
</td></tr>
<tr><td><code id="cov_struct_+3A_subject">subject</code></td>
<td>
<p>(<code>string</code>)<br /> the name of the variable that encodes a subject
identifier.</p>
</td></tr>
<tr><td><code id="cov_struct_+3A_group">group</code></td>
<td>
<p>(<code>string</code>)<br /> optionally, the name of the variable that encodes
a grouping variable for subjects.</p>
</td></tr>
<tr><td><code id="cov_struct_+3A_heterogeneous">heterogeneous</code></td>
<td>
<p>(<code>flag</code>)<br /></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cov_struct</code> object.
</p>


<h3>See Also</h3>

<p>Other covariance types: 
<code><a href="#topic+as.cov_struct">as.cov_struct</a>()</code>,
<code><a href="#topic+covariance_types">covariance_types</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cov_struct("csh", "AVISITN", "USUBJID")
cov_struct("spatial", c("VISITA", "VISITB"), group = "GRP", subject = "SBJ")

</code></pre>

<hr>
<h2 id='cov_type_abbr'>Retrieve Associated Abbreviated Covariance Structure Type Name</h2><span id='topic+cov_type_abbr'></span>

<h3>Description</h3>

<p>Retrieve Associated Abbreviated Covariance Structure Type Name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_type_abbr(type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov_type_abbr_+3A_type">type</code></td>
<td>
<p>(<code>string</code>)<br /> either a full name or abbreviate covariance
structure type name to collapse into an abbreviated type.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding abbreviated covariance type name.
</p>

<hr>
<h2 id='cov_type_name'>Retrieve Associated Full Covariance Structure Type Name</h2><span id='topic+cov_type_name'></span>

<h3>Description</h3>

<p>Retrieve Associated Full Covariance Structure Type Name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_type_name(type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cov_type_name_+3A_type">type</code></td>
<td>
<p>(<code>string</code>)<br /> either a full name or abbreviate covariance
structure type name to convert to a long-form type.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The corresponding abbreviated covariance type name.
</p>

<hr>
<h2 id='COV_TYPES'>Covariance Type Database</h2><span id='topic+COV_TYPES'></span>

<h3>Description</h3>

<p>An internal constant for covariance type information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COV_TYPES
</code></pre>


<h3>Format</h3>

<p>A data frame with 5 variables and one record per covariance type:
</p>

<dl>
<dt>name</dt><dd>
<p>The long-form name of the covariance structure type
</p>
</dd>
<dt>abbr</dt><dd>
<p>The abbreviated name of the covariance structure type
</p>
</dd>
<dt>habbr</dt><dd>
<p>The abbreviated name of the heterogeneous version of a covariance
structure type (The abbreviated name (<code>abbr</code>) with a trailing <code>"h"</code> if
the structure has a heterogeneous implementation or <code>NA</code> otherwise).
</p>
</dd>
<dt>heterogeneous</dt><dd>
<p>A logical value indicating whether the covariance structure has a
heterogeneous counterpart.
</p>
</dd>
<dt>spatial</dt><dd>
<p>A logical value indicating whether the covariance structure is spatial.
</p>
</dd>
</dl>


<hr>
<h2 id='covariance_types'>Covariance Types</h2><span id='topic+covariance_types'></span><span id='topic+cov_types'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#maturing"><img src="../help/figures/lifecycle-maturing.svg" alt='[Maturing]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cov_types(
  form = c("name", "abbr", "habbr"),
  filter = c("heterogeneous", "spatial")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covariance_types_+3A_form">form</code></td>
<td>
<p>(<code>character</code>)<br /> covariance structure type name form. One or
more of <code>"name"</code>, <code>"abbr"</code> (abbreviation), or <code>"habbr"</code> (heterogeneous
abbreviation).</p>
</td></tr>
<tr><td><code id="covariance_types_+3A_filter">filter</code></td>
<td>
<p>(<code>character</code>)<br /> covariance structure type filter. One or
more of <code>"heterogeneous"</code> or <code>"spatial"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of accepted covariance structure type names and
abbreviations.
</p>


<h3>Abbreviations for Covariance Structures</h3>



<h4>Common Covariance Structures:</h4>


<table>
<tr>
 <td style="text-align: center;">

<strong>Structure</strong>
</td><td style="text-align: left;"> <strong>Description</strong>
</td><td style="text-align: left;"> <strong>Parameters</strong>
</td><td style="text-align: left;"> <strong><code class="reqn">(i, j)</code> element</strong>
</td>
</tr>
<tr>
 <td style="text-align: center;">

ad
</td><td style="text-align: left;"> Ante-dependence
</td><td style="text-align: left;"> <code class="reqn">m</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma^{2}\prod_{k=i}^{j-1}\rho_{k}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

adh
</td><td style="text-align: left;"> Heterogeneous ante-dependence
</td><td style="text-align: left;"> <code class="reqn">2m-1</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{i}\sigma_{j}\prod_{k=i}^{j-1}\rho_{k}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

ar1
</td><td style="text-align: left;"> First-order auto-regressive
</td><td style="text-align: left;"> <code class="reqn">2</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma^{2}\rho^{\left \vert {i-j} \right \vert}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

ar1h
</td><td style="text-align: left;"> Heterogeneous first-order auto-regressive
</td><td style="text-align: left;"> <code class="reqn">m+1</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{i}\sigma_{j}\rho^{\left \vert {i-j} \right \vert}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

cs
</td><td style="text-align: left;"> Compound symmetry
</td><td style="text-align: left;"> <code class="reqn">2</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma^{2}\left[ \rho I(i \neq j)+I(i=j) \right]</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

csh
</td><td style="text-align: left;"> Heterogeneous compound symmetry
</td><td style="text-align: left;"> <code class="reqn">m+1</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{i}\sigma_{j}\left[ \rho I(i \neq j)+I(i=j) \right]</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

toep
</td><td style="text-align: left;"> Toeplitz
</td><td style="text-align: left;"> <code class="reqn">m</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{\left \vert {i-j} \right \vert +1}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

toeph
</td><td style="text-align: left;"> Heterogeneous Toeplitz
</td><td style="text-align: left;"> <code class="reqn">2m-1</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{i}\sigma_{j}\rho_{\left \vert {i-j} \right \vert}</code>
</td>
</tr>
<tr>
 <td style="text-align: center;">

us
</td><td style="text-align: left;"> Unstructured
</td><td style="text-align: left;"> <code class="reqn">m(m+1)/2</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma_{ij}</code>

</td>
</tr>

</table>

<p>where <code class="reqn">i</code> and <code class="reqn">j</code> denote <code class="reqn">i</code>-th and <code class="reqn">j</code>-th time points,
respectively, out of total <code class="reqn">m</code> time points, <code class="reqn">1 \leq i, j \leq m</code>.
</p>



<h3>Note</h3>

<p>The <strong>ante-dependence</strong> covariance structure in this package refers to
homogeneous ante-dependence, while the ante-dependence covariance structure
from SAS <code style="white-space: pre;">&#8288;PROC MIXED&#8288;</code> refers to heterogeneous ante-dependence and the
homogeneous version is not available in SAS.
</p>
<p>For all non-spatial covariance structures, the time variable must
be coded as a factor.
</p>


<h4>Spatial Covariance structures:</h4>


<table>
<tr>
 <td style="text-align: center;">

<strong>Structure</strong>
</td><td style="text-align: left;"> <strong>Description</strong>
</td><td style="text-align: left;"> <strong>Parameters</strong>
</td><td style="text-align: left;"> <strong><code class="reqn">(i, j)</code> element</strong>
</td>
</tr>
<tr>
 <td style="text-align: center;">

sp_exp
</td><td style="text-align: left;"> spatial exponential
</td><td style="text-align: left;"> <code class="reqn">2</code>
</td><td style="text-align: left;"> <code class="reqn">\sigma^{2}\rho^{-d_{ij}}</code>

</td>
</tr>

</table>

<p>where <code class="reqn">d_{ij}</code> denotes the Euclidean distance between time points
<code class="reqn">i</code> and <code class="reqn">j</code>.
</p>



<h3>See Also</h3>

<p>Other covariance types: 
<code><a href="#topic+as.cov_struct">as.cov_struct</a>()</code>,
<code><a href="#topic+cov_struct">cov_struct</a>()</code>
</p>

<hr>
<h2 id='df_1d'>Calculation of Degrees of Freedom for One-Dimensional Contrast</h2><span id='topic+df_1d'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Calculates the estimate, adjusted standard error, degrees of freedom,
t statistic and p-value for one-dimensional contrast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_1d(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_1d_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="df_1d_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>object &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)
contrast &lt;- numeric(length(object$beta_est))
contrast[3] &lt;- 1
df_1d(object, contrast)
</code></pre>

<hr>
<h2 id='df_md'>Calculation of Degrees of Freedom for Multi-Dimensional Contrast</h2><span id='topic+df_md'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Calculates the estimate, standard error, degrees of freedom,
t statistic and p-value for one-dimensional contrast, depending on the method
used in <code><a href="#topic+mmrm">mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>df_md(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="df_md_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="df_md_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix, if given a <code>numeric</code>
then this is coerced to a row vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>object &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)
contrast &lt;- matrix(data = 0, nrow = 2, ncol = length(object$beta_est))
contrast[1, 2] &lt;- contrast[2, 3] &lt;- 1
df_md(object, contrast)
</code></pre>

<hr>
<h2 id='drop_elements'>Drop Items from an Indexible</h2><span id='topic+drop_elements'></span>

<h3>Description</h3>

<p>Drop elements from an indexible object (<code>vector</code>, <code>list</code>, etc.).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drop_elements(x, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drop_elements_+3A_x">x</code></td>
<td>
<p>Any object that can be consumed by <code><a href="base.html#topic+seq_along">seq_along()</a></code> and indexed by a
logical vector of the same length.</p>
</td></tr>
<tr><td><code id="drop_elements_+3A_n">n</code></td>
<td>
<p>(<code>integer</code>)<br /> the number of terms to drop.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A subset of <code>x</code>.
</p>

<hr>
<h2 id='emit_tidymodels_register_msg'>Format a Message to Emit When Tidymodels is Loaded</h2><span id='topic+emit_tidymodels_register_msg'></span>

<h3>Description</h3>

<p>Format a Message to Emit When Tidymodels is Loaded
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emit_tidymodels_register_msg()
</code></pre>


<h3>Value</h3>

<p>A character message to emit. Either a ansi-formatted cli output if
package 'cli' is available or a plain-text message otherwise.
</p>

<hr>
<h2 id='emmeans_support'>Support for <code>emmeans</code></h2><span id='topic+emmeans_support'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This package includes methods that allow <code>mmrm</code> objects to be used
with the <code>emmeans</code> package. <code>emmeans</code> computes estimated marginal means
(also called least-square means) for the coefficients of the MMRM.
We can also e.g. obtain differences between groups by applying
<code><a href="emmeans.html#topic+contrast">pairs()</a></code> on the object returned
by <code><a href="emmeans.html#topic+emmeans">emmeans::emmeans()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)
if (require(emmeans)) {
  emmeans(fit, ~ ARMCD | AVISIT)
  pairs(emmeans(fit, ~ ARMCD | AVISIT), reverse = TRUE)
}
</code></pre>

<hr>
<h2 id='emp_start'>Empirical Starting Value</h2><span id='topic+emp_start'></span>

<h3>Description</h3>

<p>Obtain empirical start value for unstructured covariance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emp_start(data, model_formula, visit_var, subject_var, subject_groups, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emp_start_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> data used for model fitting.</p>
</td></tr>
<tr><td><code id="emp_start_+3A_model_formula">model_formula</code></td>
<td>
<p>(<code>formula</code>)<br /> the formula in mmrm model without covariance structure part.</p>
</td></tr>
<tr><td><code id="emp_start_+3A_visit_var">visit_var</code></td>
<td>
<p>(<code>string</code>)<br /> visit variable.</p>
</td></tr>
<tr><td><code id="emp_start_+3A_subject_var">subject_var</code></td>
<td>
<p>(<code>string</code>)<br /> subject id variable.</p>
</td></tr>
<tr><td><code id="emp_start_+3A_subject_groups">subject_groups</code></td>
<td>
<p>(<code>factor</code>)<br /> subject group assignment.</p>
</td></tr>
<tr><td><code id="emp_start_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This <code>emp_start</code> only works for unstructured covariance structure.
It uses linear regression to first obtain the coefficients and use the residuals
to obtain the empirical variance-covariance, and it is then used to obtain the
starting values.
</p>


<h3>Value</h3>

<p>A numeric vector of starting values.
</p>


<h3>Note</h3>

<p><code>data</code> is used instead of <code>full_frame</code> because <code>full_frame</code> is already
transformed if model contains transformations, e.g. <code>log(FEV1) ~ exp(FEV1_BL)</code> will
drop <code>FEV1</code> and <code>FEV1_BL</code> but add <code>log(FEV1)</code> and <code>exp(FEV1_BL)</code> in <code>full_frame</code>.
</p>

<hr>
<h2 id='fev_data'>Example Data on FEV1</h2><span id='topic+fev_data'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fev_data
</code></pre>


<h3>Format</h3>

<p>A <code>tibble</code> with 800 rows and 7 variables:
</p>

<ul>
<li> <p><code>USUBJID</code>: subject ID.
</p>
</li>
<li> <p><code>AVISIT</code>: visit number.
</p>
</li>
<li> <p><code>ARMCD</code>: treatment, <code>TRT</code> or <code>PBO</code>.
</p>
</li>
<li> <p><code>RACE</code>: 3-category race.
</p>
</li>
<li> <p><code>SEX</code>: sex.
</p>
</li>
<li> <p><code>FEV1_BL</code>: FEV1 at baseline (%).
</p>
</li>
<li> <p><code>FEV1</code>: FEV1 at study visits.
</p>
</li>
<li> <p><code>WEIGHT</code>: weighting variable.
</p>
</li>
<li> <p><code>VISITN</code>: integer order of the visit.
</p>
</li>
<li> <p><code>VISITN2</code>: coordinates of the visit for distance calculation.
</p>
</li></ul>



<h3>Note</h3>

<p>Measurements of FEV1 (forced expired volume in one second) is a measure
of how quickly the lungs can be emptied. Low levels of FEV1 may indicate
chronic obstructive pulmonary disease (COPD).
</p>


<h3>Source</h3>

<p>This is an artificial dataset.
</p>

<hr>
<h2 id='fill_names'>Complete <code>character</code> Vector Names From Values</h2><span id='topic+fill_names'></span>

<h3>Description</h3>

<p>Complete <code>character</code> Vector Names From Values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fill_names(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fill_names_+3A_x">x</code></td>
<td>
<p>(<code>character</code> or <code>list</code>)<br /> value whose names should be completed
from element values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector or list.
</p>

<hr>
<h2 id='fit_mmrm'>Low-Level Fitting Function for MMRM</h2><span id='topic+fit_mmrm'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This is the low-level function to fit an MMRM. Note that this does not
try different optimizers or adds Jacobian information etc. in contrast to
<code><a href="#topic+mmrm">mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_mmrm(
  formula,
  data,
  weights,
  reml = TRUE,
  covariance = NULL,
  tmb_data,
  formula_parts,
  control = mmrm_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_mmrm_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> model formula with exactly one special term
specifying the visits within subjects, see details.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> input data containing the variables used in
<code>formula</code>.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_weights">weights</code></td>
<td>
<p>(<code>vector</code>)<br /> input vector containing the weights.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_reml">reml</code></td>
<td>
<p>(<code>flag</code>)<br /> whether restricted maximum likelihood (REML) estimation is used,
otherwise maximum likelihood (ML) is used.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> A covariance structure type definition,
or value that can be coerced to a covariance structure using
<code><a href="#topic+as.cov_struct">as.cov_struct()</a></code>. If no value is provided, a structure is derived from
the provided formula.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> object.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_formula_parts">formula_parts</code></td>
<td>
<p>(<code>mmrm_tmb_formula_parts</code>)<br /> list with formula parts
from <code><a href="#topic+h_mmrm_tmb_formula_parts">h_mmrm_tmb_formula_parts()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_mmrm_+3A_control">control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br /> list of control options produced by
<code><a href="#topic+mmrm_control">mmrm_control()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>formula</code> typically looks like:
</p>
<p><code>FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</code>
</p>
<p>which specifies response and covariates as usual, and exactly one special term
defines which covariance structure is used and what are the visit and
subject variables.
</p>
<p>Always use only the first optimizer if multiple optimizers are provided.
</p>


<h3>Value</h3>

<p>List of class <code>mmrm_tmb</code>, see <code><a href="#topic+h_mmrm_tmb_fit">h_mmrm_tmb_fit()</a></code> for details.
In addition, it contains elements <code>call</code> and <code>optimizer</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formula &lt;- FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
data &lt;- fev_data
system.time(result &lt;- fit_mmrm(formula, data, rep(1, nrow(fev_data))))
</code></pre>

<hr>
<h2 id='fit_single_optimizer'>Fitting an MMRM with Single Optimizer</h2><span id='topic+fit_single_optimizer'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This function helps to fit an MMRM using <code>TMB</code> with a single optimizer,
while capturing messages and warnings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_single_optimizer(
  formula,
  data,
  weights,
  reml = TRUE,
  covariance = NULL,
  tmb_data,
  formula_parts,
  ...,
  control = mmrm_control(...)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit_single_optimizer_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> the model formula, see details.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_data">data</code></td>
<td>
<p>(<code>data</code>)<br /> the data to be used for the model.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_weights">weights</code></td>
<td>
<p>(<code>vector</code>)<br /> an optional vector of weights to be used in
the fitting process. Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_reml">reml</code></td>
<td>
<p>(<code>flag</code>)<br /> whether restricted maximum likelihood (REML)
estimation is used, otherwise maximum likelihood (ML) is used.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure type definition
as produced with <code><a href="#topic+cov_struct">cov_struct()</a></code>, or value that can be coerced to a
covariance structure using <code><a href="#topic+as.cov_struct">as.cov_struct()</a></code>. If no value is provided,
a structure is derived from the provided formula.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> object.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_formula_parts">formula_parts</code></td>
<td>
<p>(<code>mmrm_tmb_formula_parts</code>)<br /> object.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_...">...</code></td>
<td>
<p>Additional arguments to pass to <code><a href="#topic+mmrm_control">mmrm_control()</a></code>.</p>
</td></tr>
<tr><td><code id="fit_single_optimizer_+3A_control">control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br /> object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fit_single_optimizer</code> will fit the <code>mmrm</code> model using the <code>control</code> provided.
If there are multiple optimizers provided in <code>control</code>, only the first optimizer
will be used.
If <code>tmb_data</code> and <code>formula_parts</code> are both provided, <code>formula</code>, <code>data</code>, <code>weights</code>,
<code>reml</code>, and <code>covariance</code> are ignored.
</p>


<h3>Value</h3>

<p>The <code>mmrm_fit</code> object, with additional attributes containing warnings,
messages, optimizer used and convergence status in addition to the
<code>mmrm_tmb</code> contents.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod_fit &lt;- fit_single_optimizer(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  weights = rep(1, nrow(fev_data)),
  optimizer = "nlminb"
)
attr(mod_fit, "converged")
</code></pre>

<hr>
<h2 id='flat_expr'>Flatten Expressions for Non-standard Evaluation</h2><span id='topic+flat_expr'></span><span id='topic+flatten_call'></span><span id='topic+flatten_expr'></span>

<h3>Description</h3>

<p>Used primarily to support the parsing of covariance structure definitions
from formulas, these functions flatten the syntax tree into a hierarchy-less
grammar, allowing for parsing that doesn't abide by R's native operator
precedence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten_call(call)

flatten_expr(expr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flat_expr_+3A_call">call</code>, <code id="flat_expr_+3A_expr">expr</code></td>
<td>
<p>(<code>language</code>)<br /> a language object to flatten.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Where <code>1 + 2 | 3</code> in R's syntax tree is <code>(|, (+, 1, 2), 3)</code>,
flattening it into its visual order produces <code>(1, +, 2, |, 3)</code>, which
makes for more fluent interpretation of non-standard grammar rules used in
formulas.
</p>


<h3>Value</h3>

<p>A list of atomic values, symbols, infix operator names and
subexpressions.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>flatten_call()</code>: Flatten a call into a list of names and argument expressions.
</p>
<p>The call name and all arguments are flattened into the same list, meaning a
call of the form <code>sp_exp(a, b, c | d / e)</code> produces a list of the form
<code>(sp_exp, a, b, c, |, d, /, e)</code>.
</p>
<div class="sourceCode"><pre>flatten_call(quote(sp_exp(a, b, c | d / e)))
</pre></div>
</li>
<li> <p><code>flatten_expr()</code>: Flatten nested expressions
</p>
<div class="sourceCode"><pre>flatten_expr(quote(1 + 2 + 3 | 4))
</pre></div>
</li></ul>

<hr>
<h2 id='format_symbols'>Format Symbol Objects</h2><span id='topic+format_symbols'></span>

<h3>Description</h3>

<p>For printing, variable names are converted to symbols and deparsed to use R's
built-in formatting of variables that may contain spaces or quote characters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_symbols(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format_symbols_+3A_x">x</code></td>
<td>
<p>(<code>character</code>) A vector of variable names.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formatted string of comma-separated variables.
</p>

<hr>
<h2 id='format.cov_struct'>Format Covariance Structure Object</h2><span id='topic+format.cov_struct'></span>

<h3>Description</h3>

<p>Format Covariance Structure Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cov_struct'
format(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="format.cov_struct_+3A_x">x</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure object.</p>
</td></tr>
<tr><td><code id="format.cov_struct_+3A_...">...</code></td>
<td>
<p>Additional arguments unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formatted string for <code>x</code>.
</p>

<hr>
<h2 id='formula_rhs'>Extract Right-Hand-Side (rhs) from Formula</h2><span id='topic+formula_rhs'></span>

<h3>Description</h3>

<p>Extract Right-Hand-Side (rhs) from Formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formula_rhs(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula_rhs_+3A_f">f</code></td>
<td>
<p>(<code>formula</code>)<br /> a formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A formula without a response, derived from the right-hand-side of the
formula, <code>f</code>.
</p>
<div class="sourceCode"><pre>formula_rhs(a ~ b + c)
formula_rhs(~ b + c)
</pre></div>

<hr>
<h2 id='h_add_covariance_terms'>Add Individual Covariance Variables As Terms to Formula</h2><span id='topic+h_add_covariance_terms'></span>

<h3>Description</h3>

<p>Add Individual Covariance Variables As Terms to Formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_add_covariance_terms(f, covariance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_add_covariance_terms_+3A_f">f</code></td>
<td>
<p>(<code>formula</code>)<br /> a formula to which covariance structure terms should
be added.</p>
</td></tr>
<tr><td><code id="h_add_covariance_terms_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure object from which
additional variables should be sourced.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="stats.html#topic+update">stats::update()</a></code> is used to append the covariance structure and the environment
attribute will not be changed. This ensures the returned formula and the input formula
have the same environment.
</p>


<h3>Value</h3>

<p>A new formula with included covariance terms.
</p>

<hr>
<h2 id='h_add_terms'>Add Formula Terms with Character</h2><span id='topic+h_add_terms'></span>

<h3>Description</h3>

<p>Add formula terms from the original formula with character representation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_add_terms(f, adds, drop_response = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_add_terms_+3A_f">f</code></td>
<td>
<p>(<code>formula</code>)<br /> a formula to be updated.</p>
</td></tr>
<tr><td><code id="h_add_terms_+3A_adds">adds</code></td>
<td>
<p>(<code>character</code>)<br /> representation of elements to be added.</p>
</td></tr>
<tr><td><code id="h_add_terms_+3A_drop_response">drop_response</code></td>
<td>
<p>(<code>flag</code>)<br /> whether response should be dropped.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Elements in <code>adds</code> will be added from the formula, while the environment
of the formula is unchanged. If <code>adds</code> is <code>NULL</code> or <code>character(0)</code>, the formula is
unchanged.
</p>


<h3>Value</h3>

<p>A new formula with elements in <code>drops</code> removed.
</p>

<hr>
<h2 id='h_coef_table'>Coefficients Table for MMRM Fit</h2><span id='topic+h_coef_table'></span>

<h3>Description</h3>

<p>This is used by <code><a href="#topic+summary.mmrm">summary.mmrm()</a></code> to obtain the coefficients table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_coef_table(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_coef_table_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> model fit.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with one row per coefficient and columns
<code>Estimate</code>, <code style="white-space: pre;">&#8288;Std. Error&#8288;</code>, <code>df</code>, <code style="white-space: pre;">&#8288;t value&#8288;</code> and <code style="white-space: pre;">&#8288;Pr(&gt;|t|)&#8288;</code>.
</p>

<hr>
<h2 id='h_confirm_large_levels'>Ask for Confirmation on Large Visit Levels</h2><span id='topic+h_confirm_large_levels'></span>

<h3>Description</h3>

<p>Ask the user for confirmation if there are too many visit levels
for non-spatial covariance structure in interactive sessions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_confirm_large_levels(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_confirm_large_levels_+3A_x">x</code></td>
<td>
<p>(<code>numeric</code>)<br /> number of visit levels.</p>
</td></tr>
</table>

<hr>
<h2 id='h_construct_model_frame_inputs'>Construction of Model Frame Formula and Data Inputs</h2><span id='topic+h_construct_model_frame_inputs'></span>

<h3>Description</h3>

<p>Input formulas are converted from mmrm-style to a style compatible
with default <code><a href="stats.html#topic+model.frame">stats::model.frame()</a></code> and <code><a href="stats.html#topic+model.matrix">stats::model.matrix()</a></code> methods.
</p>
<p>The full formula is returned so we can construct, for example, the
<code>model.frame()</code> including all columns as well as the requested subset.
The full set is used to identify rows to include in the reduced model frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_construct_model_frame_inputs(
  formula,
  data,
  include,
  include_choice = c("subject_var", "visit_var", "group_var", "response_var"),
  full
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_construct_model_frame_inputs_+3A_formula">formula</code></td>
<td>
<p>(<code>mmrm</code>)<br /> mmrm fit object.</p>
</td></tr>
<tr><td><code id="h_construct_model_frame_inputs_+3A_data">data</code></td>
<td>
<p>optional data frame that will be
passed to <code>model.frame()</code> or <code>model.matrix()</code></p>
</td></tr>
<tr><td><code id="h_construct_model_frame_inputs_+3A_include">include</code></td>
<td>
<p>(<code>character</code>)<br /> names of variable to include</p>
</td></tr>
<tr><td><code id="h_construct_model_frame_inputs_+3A_full">full</code></td>
<td>
<p>(<code>flag</code>)<br /> indicator whether to return full model frame (deprecated).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>named list with four elements:
</p>

<ul>
<li> <p><code>"formula"</code>: the formula including the columns requested in the <code style="white-space: pre;">&#8288;include=&#8288;</code> argument.
</p>
</li>
<li> <p><code>"formula_full"</code>: the formula including all columns
</p>
</li>
<li> <p><code>"data"</code>: a data frame including all columns where factor and
character columns have been processed with <code><a href="#topic+h_factor_ref">h_factor_ref()</a></code>.
</p>
</li>
<li> <p><code>"is_full"</code>: a logical scalar indicating if the formula and
full formula are identical
</p>
</li></ul>


<hr>
<h2 id='h_default_value'>Default Value on NULL
Return default value when first argument is NULL.</h2><span id='topic+h_default_value'></span>

<h3>Description</h3>

<p>Default Value on NULL
Return default value when first argument is NULL.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_default_value(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_default_value_+3A_x">x</code></td>
<td>
<p>Object.</p>
</td></tr>
<tr><td><code id="h_default_value_+3A_y">y</code></td>
<td>
<p>Object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> is NULL, returns <code>y</code>. Otherwise return <code>x</code>.
</p>

<hr>
<h2 id='h_df_1d_bw'>Calculation of Between-Within Degrees of Freedom for One-Dimensional Contrast</h2><span id='topic+h_df_1d_bw'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_1d">df_1d()</a></code> if method is &quot;Between-Within&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_1d_bw(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_1d_bw_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_1d_bw_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code>.
</p>

<hr>
<h2 id='h_df_1d_kr'>Calculation of Kenward-Roger Degrees of Freedom for One-Dimensional Contrast</h2><span id='topic+h_df_1d_kr'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_1d">df_1d()</a></code> if method is
&quot;Kenward-Roger&quot; or &quot;Kenward-Roger-Linear&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_1d_kr(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_1d_kr_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_1d_kr_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code>.
</p>

<hr>
<h2 id='h_df_1d_res'>Calculation of Residual Degrees of Freedom for One-Dimensional Contrast</h2><span id='topic+h_df_1d_res'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_1d">df_1d()</a></code> if method is
&quot;Residual&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_1d_res(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_1d_res_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_1d_res_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code>.
</p>

<hr>
<h2 id='h_df_1d_sat'>Calculation of Satterthwaite Degrees of Freedom for One-Dimensional Contrast</h2><span id='topic+h_df_1d_sat'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_1d">df_1d()</a></code> if method is
&quot;Satterthwaite&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_1d_sat(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_1d_sat_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_1d_sat_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code>.
</p>

<hr>
<h2 id='h_df_bw_calc'>Calculation of Between-Within Degrees of Freedom</h2><span id='topic+h_df_bw_calc'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+h_df_1d_bw">h_df_1d_bw()</a></code> and <code><a href="#topic+h_df_md_bw">h_df_md_bw()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_bw_calc(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_bw_calc_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the fitted MMRM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with:
</p>

<ul>
<li> <p><code>coefs_between_within</code> calculated via <code><a href="#topic+h_within_or_between">h_within_or_between()</a></code>
</p>
</li>
<li> <p><code>ddf_between</code>
</p>
</li>
<li> <p><code>ddf_within</code>
</p>
</li></ul>


<hr>
<h2 id='h_df_md_bw'>Calculation of Between-Within Degrees of Freedom for Multi-Dimensional Contrast</h2><span id='topic+h_df_md_bw'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_md">df_md()</a></code> if method is &quot;Between-Within&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_md_bw(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_md_bw_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_md_bw_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix, if given a <code>numeric</code>
then this is coerced to a row vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_df_md_from_1d'>Creating F-Statistic Results from One-Dimensional Contrast</h2><span id='topic+h_df_md_from_1d'></span>

<h3>Description</h3>

<p>Creates multi-dimensional result from one-dimensional contrast from <code><a href="#topic+df_1d">df_1d()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_md_from_1d(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_md_from_1d_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> model fit.</p>
</td></tr>
<tr><td><code id="h_df_md_from_1d_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> one-dimensional contrast.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The one-dimensional degrees of freedom are calculated and then
based on that the p-value is calculated.
</p>

<hr>
<h2 id='h_df_md_kr'>Calculation of Kenward-Roger Degrees of Freedom for Multi-Dimensional Contrast</h2><span id='topic+h_df_md_kr'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_md">df_md()</a></code> if method is &quot;Kenward-Roger&quot; or &quot;Kenward-Roger-Linear&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_md_kr(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_md_kr_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_md_kr_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix, if given a <code>numeric</code>
then this is coerced to a row vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_df_md_res'>Calculation of Residual Degrees of Freedom for Multi-Dimensional Contrast</h2><span id='topic+h_df_md_res'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_md">df_md()</a></code> if method is &quot;Residual&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_md_res(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_md_res_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_md_res_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix, if given a <code>numeric</code>
then this is coerced to a row vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_df_md_sat'>Calculation of Satterthwaite Degrees of Freedom for Multi-Dimensional Contrast</h2><span id='topic+h_df_md_sat'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+df_md">df_md()</a></code> if method is &quot;Satterthwaite&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_md_sat(object, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_md_sat_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_df_md_sat_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix, if given a <code>numeric</code>
then this is coerced to a row vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_df_min_bw'>Assign Minimum Degrees of Freedom Given Involved Coefficients</h2><span id='topic+h_df_min_bw'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+h_df_1d_bw">h_df_1d_bw()</a></code> and <code><a href="#topic+h_df_md_bw">h_df_md_bw()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_min_bw(bw_calc, is_coef_involved)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_min_bw_+3A_bw_calc">bw_calc</code></td>
<td>
<p>(<code>list</code>)<br /> from <code><a href="#topic+h_df_bw_calc">h_df_bw_calc()</a></code>.</p>
</td></tr>
<tr><td><code id="h_df_min_bw_+3A_is_coef_involved">is_coef_involved</code></td>
<td>
<p>(<code>logical</code>)<br /> whether each coefficient is involved
in the contrast.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The minimum of the degrees of freedom assigned to each involved
coefficient according to its between-within categorization.
</p>

<hr>
<h2 id='h_df_to_tibble'>Coerce a Data Frame to a <code>tibble</code></h2><span id='topic+h_df_to_tibble'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+h_newdata_add_pred">h_newdata_add_pred()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_df_to_tibble(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_df_to_tibble_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> what to coerce.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is only a thin wrapper around <code><a href="tibble.html#topic+as_tibble">tibble::as_tibble()</a></code>, except
giving a useful error message and it checks for <code>rownames</code> and adds them
as a new column <code>.rownames</code> if they are not just a numeric sequence as
per the <code><a href="tibble.html#topic+rownames">tibble::has_rownames()</a></code> decision.
</p>


<h3>Value</h3>

<p>The <code>data</code> as a <code>tibble</code>, potentially with a <code>.rownames</code> column.
</p>

<hr>
<h2 id='h_drop_covariance_terms'>Drop Formula Terms used for Covariance Structure Definition</h2><span id='topic+h_drop_covariance_terms'></span>

<h3>Description</h3>

<p>Drop Formula Terms used for Covariance Structure Definition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_drop_covariance_terms(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_drop_covariance_terms_+3A_f">f</code></td>
<td>
<p>(<code>formula</code>)<br /> a formula from which covariance terms should be
dropped.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>terms</code> is used and it will preserve the environment attribute.
This ensures the returned formula and the input formula have the same environment.
</p>


<h3>Value</h3>

<p>The formula without accepted covariance terms.
</p>

<hr>
<h2 id='h_extract_covariance_terms'>Extract Formula Terms used for Covariance Structure Definition</h2><span id='topic+h_extract_covariance_terms'></span>

<h3>Description</h3>

<p>Extract Formula Terms used for Covariance Structure Definition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_extract_covariance_terms(f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_extract_covariance_terms_+3A_f">f</code></td>
<td>
<p>(<code>formula</code>)<br /> a formula from which covariance terms should be
extracted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of covariance structure expressions found in <code>f</code>.
</p>

<hr>
<h2 id='h_factor_ref'>Convert Character to Factor Following Reference</h2><span id='topic+h_factor_ref'></span>

<h3>Description</h3>

<p>Convert Character to Factor Following Reference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_factor_ref(x, ref, var_name = vname(x))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_factor_ref_+3A_x">x</code></td>
<td>
<p>(<code>character</code> or <code>factor</code>)<br />  input.</p>
</td></tr>
<tr><td><code id="h_factor_ref_+3A_ref">ref</code></td>
<td>
<p>(<code>factor</code>)<br /> reference.</p>
</td></tr>
<tr><td><code id="h_factor_ref_+3A_var_name">var_name</code></td>
<td>
<p>(<code>string</code>)<br /> variable name of input <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code>ref</code> to convert <code>x</code> into factor with the same levels.
This is needed even if <code>x</code> and <code>ref</code> are both <code>character</code> because
in <code>model.matrix</code> if <code>x</code> only has one level there could be errors.
</p>

<hr>
<h2 id='h_get_contrast'>Obtain Contrast for Specified Effect</h2><span id='topic+h_get_contrast'></span>

<h3>Description</h3>

<p>This is support function to obtain contrast matrix for type II/III testing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_contrast(
  object,
  effect,
  type = c("II", "III", "2", "3"),
  tol = sqrt(.Machine$double.eps)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_contrast_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the fitted MMRM.</p>
</td></tr>
<tr><td><code id="h_get_contrast_+3A_effect">effect</code></td>
<td>
<p>(<code>string</code>) the name of the effect.</p>
</td></tr>
<tr><td><code id="h_get_contrast_+3A_type">type</code></td>
<td>
<p>(<code>string</code>) type of test, &quot;II&quot;, &quot;III&quot;, '2', or '3'.</p>
</td></tr>
<tr><td><code id="h_get_contrast_+3A_tol">tol</code></td>
<td>
<p>(<code>numeric</code>) threshold blow which values are treated as 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> of the contrast.
</p>

<hr>
<h2 id='h_get_cov_default'>Obtain Default Covariance Method</h2><span id='topic+h_get_cov_default'></span>

<h3>Description</h3>

<p>Obtain the default covariance method depending on
the degrees of freedom method used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_cov_default(
  method = c("Satterthwaite", "Kenward-Roger", "Residual", "Between-Within")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_cov_default_+3A_method">method</code></td>
<td>
<p>(<code>string</code>)<br /> degrees of freedom method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default covariance method is different for different degrees of freedom method.
For &quot;Satterthwaite&quot; or &quot;Between-Within&quot;, &quot;Asymptotic&quot; is returned.
For &quot;Kenward-Roger&quot; only, &quot;Kenward-Roger&quot; is returned.
For &quot;Residual&quot; only, &quot;Empirical&quot; is returned.
</p>

<hr>
<h2 id='h_get_empirical'>Obtain Empirical/Jackknife/Bias-Reduced Covariance</h2><span id='topic+h_get_empirical'></span>

<h3>Description</h3>

<p>Obtain the empirical or Jackknife covariance for <code class="reqn">\beta</code>.
Used in <code>mmrm</code> fitting if method is &quot;Empirical&quot;, &quot;Empirical-Jackknife&quot; or
&quot;Empirical-Bias-Reduced&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_empirical(tmb_data, theta, beta, beta_vcov, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_empirical_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
<tr><td><code id="h_get_empirical_+3A_theta">theta</code></td>
<td>
<p>(<code>numeric</code>)<br /> theta estimate.</p>
</td></tr>
<tr><td><code id="h_get_empirical_+3A_beta">beta</code></td>
<td>
<p>(<code>numeric</code>)<br /> beta estimate.</p>
</td></tr>
<tr><td><code id="h_get_empirical_+3A_beta_vcov">beta_vcov</code></td>
<td>
<p>(<code>matrix</code>)<br /> covariance of beta estimate.</p>
</td></tr>
<tr><td><code id="h_get_empirical_+3A_type">type</code></td>
<td>
<p>(<code>string</code>)<br /> type of empirical method, including &quot;Empirical&quot;, &quot;Empirical-Jackknife&quot;
and &quot;Empirical-Bias-Reduced&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with elements:
</p>

<ul>
<li> <p><code>cov</code>: <code>matrix</code> empirical covariance.
</p>
</li>
<li> <p><code>df_mat</code>: <code>matrix</code> to calculate Satterthwaite degree of freedom.
</p>
</li></ul>


<hr>
<h2 id='h_get_kr_comp'>Obtain Kenward-Roger Adjustment Components</h2><span id='topic+h_get_kr_comp'></span>

<h3>Description</h3>

<p>Obtains the components needed downstream for the computation of Kenward-Roger degrees of freedom.
Used in <code><a href="#topic+mmrm">mmrm()</a></code> fitting if method is &quot;Kenward-Roger&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_kr_comp(tmb_data, theta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_kr_comp_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
<tr><td><code id="h_get_kr_comp_+3A_theta">theta</code></td>
<td>
<p>(<code>numeric</code>)<br /> theta estimate.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>the function returns a named list, <code class="reqn">P</code>, <code class="reqn">Q</code> and <code class="reqn">R</code>, which corresponds to the
paper in 1997. The matrices are stacked in columns so that <code class="reqn">P</code>, <code class="reqn">Q</code> and <code class="reqn">R</code> has the same
column number(number of beta parameters). The number of rows, is dependent on
the total number of theta and number of groups, if the fit is a grouped mmrm.
For <code class="reqn">P</code> matrix, it is stacked sequentially. For <code class="reqn">Q</code> and <code class="reqn">R</code> matrix, it is stacked so
that the <code class="reqn">Q_{ij}</code> and <code class="reqn">R_{ij}</code> is stacked from <code class="reqn">j</code> then to <code class="reqn">i</code>, i.e. <code class="reqn">R_{i1}</code>, <code class="reqn">R_{i2}</code>, etc.
<code class="reqn">Q</code> and <code class="reqn">R</code> only contains intra-group results and inter-group results should be all zero matrices
so they are not stacked in the result.
</p>


<h3>Value</h3>

<p>Named list with elements:
</p>

<ul>
<li> <p><code>P</code>: <code>matrix</code> of <code class="reqn">P</code> component.
</p>
</li>
<li> <p><code>Q</code>: <code>matrix</code> of <code class="reqn">Q</code> component.
</p>
</li>
<li> <p><code>R</code>: <code>matrix</code> of <code class="reqn">R</code> component.
</p>
</li></ul>


<hr>
<h2 id='h_get_optimizers'>Obtain Optimizer according to Optimizer String Value</h2><span id='topic+h_get_optimizers'></span>

<h3>Description</h3>

<p>This function creates optimizer functions with arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_optimizers(
  optimizer = c("L-BFGS-B", "BFGS", "CG", "nlminb"),
  optimizer_fun = h_optimizer_fun(optimizer),
  optimizer_args = list(),
  optimizer_control = list()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_optimizers_+3A_optimizer">optimizer</code></td>
<td>
<p>(<code>character</code>)<br /> names of built-in optimizers to try, subset
of &quot;L-BFGS-B&quot;, &quot;BFGS&quot;, &quot;CG&quot; and &quot;nlminb&quot;.</p>
</td></tr>
<tr><td><code id="h_get_optimizers_+3A_optimizer_fun">optimizer_fun</code></td>
<td>
<p>(<code>function</code> or <code>list</code> of <code>function</code>)<br /> alternatively to <code>optimizer</code>,
an optimizer function or a list of optimizer functions can be passed directly here.</p>
</td></tr>
<tr><td><code id="h_get_optimizers_+3A_optimizer_args">optimizer_args</code></td>
<td>
<p>(<code>list</code>)<br /> additional arguments for <code>optimizer_fun</code>.</p>
</td></tr>
<tr><td><code id="h_get_optimizers_+3A_optimizer_control">optimizer_control</code></td>
<td>
<p>(<code>list</code>)<br /> passed to argument <code>control</code> in <code>optimizer_fun</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you want to use only the built-in optimizers:
</p>

<ul>
<li> <p><code>optimizer</code> is a shortcut to create a list of built-in optimizer functions
passed to <code>optimizer_fun</code>.
</p>
</li>
<li><p> Allowed are &quot;L-BFGS-B&quot;, &quot;BFGS&quot;, &quot;CG&quot; (using <code><a href="stats.html#topic+optim">stats::optim()</a></code> with corresponding method)
and &quot;nlminb&quot; (using <code><a href="stats.html#topic+nlminb">stats::nlminb()</a></code>).
</p>
</li>
<li><p> Other arguments should go into <code>optimizer_args</code>.
</p>
</li></ul>

<p>If you want to use your own optimizer function:
</p>

<ul>
<li><p> Make sure that there are three arguments: parameter (start value), objective function
and gradient function are sequentially in the function arguments.
</p>
</li>
<li><p> If there are other named arguments in front of these, make sure they are correctly
specified through <code>optimizer_args</code>.
</p>
</li>
<li><p> If the hessian can be used, please make sure its argument name is <code>hessian</code> and
please add attribute <code>use_hessian = TRUE</code> to the function,
using <code style="white-space: pre;">&#8288;attr(fun, "use_hessian) &lt;- TRUE&#8288;</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>Named <code>list</code> of optimizers created by <code><a href="#topic+h_partial_fun_args">h_partial_fun_args()</a></code>.
</p>

<hr>
<h2 id='h_get_prediction'>Get Prediction</h2><span id='topic+h_get_prediction'></span>

<h3>Description</h3>

<p>Get predictions with given <code>data</code>, <code>theta</code>, <code>beta</code>, <code>beta_vcov</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_prediction(tmb_data, theta, beta, beta_vcov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_prediction_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> object.</p>
</td></tr>
<tr><td><code id="h_get_prediction_+3A_theta">theta</code></td>
<td>
<p>(<code>numeric</code>)<br /> theta value.</p>
</td></tr>
<tr><td><code id="h_get_prediction_+3A_beta">beta</code></td>
<td>
<p>(<code>numeric</code>)<br /> beta value.</p>
</td></tr>
<tr><td><code id="h_get_prediction_+3A_beta_vcov">beta_vcov</code></td>
<td>
<p>(<code>matrix</code>)<br /> beta_vcov matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>predict</code> function in <code>predict.cpp</code> which is called internally.
</p>


<h3>Value</h3>

<p>List with:
</p>

<ul>
<li> <p><code>prediction</code>: Matrix with columns <code>fit</code>, <code>conf_var</code>, and <code>var</code>.
</p>
</li>
<li> <p><code>covariance</code>: List with subject specific covariance matrices.
</p>
</li>
<li> <p><code>index</code>: List of zero-based subject indices.
</p>
</li></ul>


<hr>
<h2 id='h_get_prediction_variance'>Get Prediction Variance</h2><span id='topic+h_get_prediction_variance'></span>

<h3>Description</h3>

<p>Get prediction variance with given fit, <code>tmb_data</code> with the Monte Carlo sampling method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_prediction_variance(object, nsim, tmb_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_prediction_variance_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM.</p>
</td></tr>
<tr><td><code id="h_get_prediction_variance_+3A_nsim">nsim</code></td>
<td>
<p>(<code>count</code>)<br /> number of samples.</p>
</td></tr>
<tr><td><code id="h_get_prediction_variance_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> object.</p>
</td></tr>
</table>

<hr>
<h2 id='h_get_sim_per_subj'>Get simulated values by patient.</h2><span id='topic+h_get_sim_per_subj'></span>

<h3>Description</h3>

<p>Get simulated values by patient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_sim_per_subj(predict_res, nsub, nsim)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_sim_per_subj_+3A_predict_res">predict_res</code></td>
<td>
<p>(<code>list</code>)<br /> from <code><a href="#topic+h_get_prediction">h_get_prediction()</a></code>.</p>
</td></tr>
<tr><td><code id="h_get_sim_per_subj_+3A_nsub">nsub</code></td>
<td>
<p>(<code>count</code>)<br /> number of subjects.</p>
</td></tr>
<tr><td><code id="h_get_sim_per_subj_+3A_nsim">nsim</code></td>
<td>
<p>(<code>count</code>)<br /> number of values to simulate.</p>
</td></tr>
</table>

<hr>
<h2 id='h_get_theta_from_cov'>Obtain Theta from Covariance Matrix</h2><span id='topic+h_get_theta_from_cov'></span>

<h3>Description</h3>

<p>Obtain unstructured theta from covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_get_theta_from_cov(covariance)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_get_theta_from_cov_+3A_covariance">covariance</code></td>
<td>
<p>(<code>matrix</code>) of covariance matrix values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the covariance matrix has <code>NA</code> in some of the elements, they will be replaced by
0 (non-diagonal) and 1 (diagonal). This ensures that the matrix is positive definite.
</p>

<hr>
<h2 id='h_gradient'>Computation of a Gradient Given Jacobian and Contrast Vector</h2><span id='topic+h_gradient'></span>

<h3>Description</h3>

<p>Computes the gradient of a linear combination of <code>beta</code> given the Jacobian matrix and
variance parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_gradient(jac_list, contrast)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_gradient_+3A_jac_list">jac_list</code></td>
<td>
<p>(<code>list</code>)<br /> Jacobian list produced e.g. by <code><a href="#topic+h_jac_list">h_jac_list()</a></code>.</p>
</td></tr>
<tr><td><code id="h_gradient_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector, which needs to have the
same number of elements as there are rows and columns in each element of
<code>jac_list</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector which contains the quadratic forms of each element of
<code>jac_list</code> with the <code>contrast</code> vector.
</p>

<hr>
<h2 id='h_jac_list'>Obtain List of Jacobian Matrix Entries for Covariance Matrix</h2><span id='topic+h_jac_list'></span>

<h3>Description</h3>

<p>Obtain the Jacobian matrices given the covariance function and variance parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_jac_list(tmb_data, theta_est, beta_vcov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_jac_list_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
<tr><td><code id="h_jac_list_+3A_theta_est">theta_est</code></td>
<td>
<p>(<code>numeric</code>)<br /> variance parameters point estimate.</p>
</td></tr>
<tr><td><code id="h_jac_list_+3A_beta_vcov">beta_vcov</code></td>
<td>
<p>(<code>matrix</code>)<br /> vairance covariance matrix of coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with one element per variance parameter containing a matrix
of the same dimensions as the covariance matrix. The values are the derivatives
with regards to this variance parameter.
</p>

<hr>
<h2 id='h_kr_df'>Obtain the Adjusted Kenward-Roger degrees of freedom</h2><span id='topic+h_kr_df'></span>

<h3>Description</h3>

<p>Obtains the adjusted Kenward-Roger degrees of freedom and F statistic scale parameter.
Used in <code><a href="#topic+h_df_md_kr">h_df_md_kr()</a></code> or <a href="#topic+h_df_1d_kr">h_df_1d_kr</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_kr_df(v0, l, w, p)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_kr_df_+3A_v0">v0</code></td>
<td>
<p>(<code>matrix</code>)<br /> unadjusted covariance matrix.</p>
</td></tr>
<tr><td><code id="h_kr_df_+3A_l">l</code></td>
<td>
<p>(<code>matrix</code>)<br /> linear combination matrix.</p>
</td></tr>
<tr><td><code id="h_kr_df_+3A_w">w</code></td>
<td>
<p>(<code>matrix</code>)<br /> hessian matrix.</p>
</td></tr>
<tr><td><code id="h_kr_df_+3A_p">p</code></td>
<td>
<p>(<code>matrix</code>)<br /> P matrix from <code><a href="#topic+h_get_kr_comp">h_get_kr_comp()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with elements:
</p>

<ul>
<li> <p><code>m</code>: <code>numeric</code> degrees of freedom.
</p>
</li>
<li> <p><code>lambda</code>: <code>numeric</code> F statistic scale parameter.
</p>
</li></ul>


<hr>
<h2 id='h_md_denom_df'>Calculating Denominator Degrees of Freedom for the Multi-Dimensional Case</h2><span id='topic+h_md_denom_df'></span>

<h3>Description</h3>

<p>Calculates the degrees of freedom for multi-dimensional contrast.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_md_denom_df(t_stat_df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_md_denom_df_+3A_t_stat_df">t_stat_df</code></td>
<td>
<p>(<code>numeric</code>)<br /> <code>n</code> t-statistic derived degrees of freedom.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Usually the calculation is returning <code>2 * E / (E - n)</code> where
<code>E</code> is the sum of <code>t / (t - 2)</code> over all <code>t_stat_df</code> values <code>t</code>.
</p>


<h3>Note</h3>

<p>If the input values are two similar to each other then just the average
of them is returned. If any of the inputs is not larger than 2 then 2 is
returned.
</p>

<hr>
<h2 id='h_mmrm_tmb_assert_start'>Asserting Sane Start Values for <code>TMB</code> Fit</h2><span id='topic+h_mmrm_tmb_assert_start'></span>

<h3>Description</h3>

<p>Asserting Sane Start Values for <code>TMB</code> Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_assert_start(tmb_object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_assert_start_+3A_tmb_object">tmb_object</code></td>
<td>
<p>(<code>list</code>)<br /> created with <code><a href="TMB.html#topic+MakeADFun">TMB::MakeADFun()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, only used for assertions.
</p>

<hr>
<h2 id='h_mmrm_tmb_check_conv'>Checking the <code>TMB</code> Optimization Result</h2><span id='topic+h_mmrm_tmb_check_conv'></span>

<h3>Description</h3>

<p>Checking the <code>TMB</code> Optimization Result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_check_conv(tmb_opt, mmrm_tmb)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_check_conv_+3A_tmb_opt">tmb_opt</code></td>
<td>
<p>(<code>list</code>)<br /> optimization result.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_check_conv_+3A_mmrm_tmb">mmrm_tmb</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> result from <code><a href="#topic+h_mmrm_tmb_fit">h_mmrm_tmb_fit()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, only used to generate warnings in case that the model
did not converge.
</p>

<hr>
<h2 id='h_mmrm_tmb_data'>Data for <code>TMB</code> Fit</h2><span id='topic+h_mmrm_tmb_data'></span>

<h3>Description</h3>

<p>Data for <code>TMB</code> Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_data(
  formula_parts,
  data,
  weights,
  reml,
  singular = c("drop", "error", "keep"),
  drop_visit_levels,
  allow_na_response = FALSE,
  drop_levels = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_data_+3A_formula_parts">formula_parts</code></td>
<td>
<p>(<code>mmrm_tmb_formula_parts</code>)<br /> list with formula parts
from <code><a href="#topic+h_mmrm_tmb_formula_parts">h_mmrm_tmb_formula_parts()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> which contains variables used in <code>formula_parts</code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_weights">weights</code></td>
<td>
<p>(<code>vector</code>)<br /> weights to be used in the fitting process.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_reml">reml</code></td>
<td>
<p>(<code>flag</code>)<br /> whether restricted maximum likelihood (REML) estimation is used,
otherwise maximum likelihood (ML) is used.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_singular">singular</code></td>
<td>
<p>(<code>string</code>)<br /> choices of method deal with rank-deficient matrices. &quot;error&quot; to
stop the function return the error, &quot;drop&quot; to drop these columns, and &quot;keep&quot; to keep all the columns.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_drop_visit_levels">drop_visit_levels</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to drop levels for visit variable, if visit variable is a factor.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_allow_na_response">allow_na_response</code></td>
<td>
<p>(<code>flag</code>)<br /> whether NA in response is allowed.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_data_+3A_drop_levels">drop_levels</code></td>
<td>
<p>(<code>flag</code>)<br /> whether drop levels for covariates. If not dropped could lead to singular matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the <code>subject_var</code> must not be factor but can also be character.
If it is character, then it will be converted to factor internally. Here
the levels will be the unique values, sorted alphabetically and numerically if there
is a common string prefix of numbers in the character elements. For full control
on the order please use a factor.
</p>


<h3>Value</h3>

<p>List of class <code>mmrm_tmb_data</code> with elements:
</p>

<ul>
<li> <p><code>full_frame</code>: <code>data.frame</code> with <code>n</code> rows containing all variables needed in the model.
</p>
</li>
<li> <p><code>data</code>: <code>data.frame</code> of input dataset.
</p>
</li>
<li> <p><code>x_matrix</code>: <code>matrix</code> with <code>n</code> rows and <code>p</code> columns specifying the overall design matrix.
</p>
</li>
<li> <p><code>x_cols_aliased</code>: <code>logical</code> with potentially more than <code>p</code> elements indicating which
columns in the original design matrix have been left out to obtain a full rank
<code>x_matrix</code>.
</p>
</li>
<li> <p><code>y_vector</code>: length <code>n</code> <code>numeric</code> specifying the overall response vector.
</p>
</li>
<li> <p><code>weights_vector</code>: length <code>n</code> <code>numeric</code> specifying the weights vector.
</p>
</li>
<li> <p><code>n_visits</code>: <code>int</code> with the number of visits, which is the dimension of the
covariance matrix.
</p>
</li>
<li> <p><code>n_subjects</code>: <code>int</code> with the number of subjects.
</p>
</li>
<li> <p><code>subject_zero_inds</code>: length <code>n_subjects</code> <code>integer</code> containing the zero-based start
indices for each subject.
</p>
</li>
<li> <p><code>subject_n_visits</code>: length <code>n_subjects</code> <code>integer</code> containing the number of
observed visits for each subjects. So the sum of this vector equals <code>n</code>.
</p>
</li>
<li> <p><code>cov_type</code>: <code>string</code> value specifying the covariance type.
</p>
</li>
<li> <p><code>is_spatial_int</code>: <code>int</code> specifying whether the covariance structure is spatial(1) or not(0).
</p>
</li>
<li> <p><code>reml</code>: <code>int</code> specifying whether REML estimation is used (1), otherwise ML (0).
</p>
</li>
<li> <p><code>subject_groups</code>: <code>factor</code> specifying the grouping for each subject.
</p>
</li>
<li> <p><code>n_groups</code>: <code>int</code> with the number of total groups
</p>
</li></ul>


<hr>
<h2 id='h_mmrm_tmb_extract_cov'>Extract covariance matrix from <code>TMB</code> report and input data</h2><span id='topic+h_mmrm_tmb_extract_cov'></span>

<h3>Description</h3>

<p>This helper does some simple post-processing to extract covariance matrix or named
list of covariance matrices if the fitting is using grouped covariance matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_extract_cov(tmb_report, tmb_data, visit_var, is_spatial)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_extract_cov_+3A_tmb_report">tmb_report</code></td>
<td>
<p>(<code>list</code>)<br /> report created with <code><a href="TMB.html#topic+MakeADFun">TMB::MakeADFun()</a></code> report function.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_extract_cov_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_extract_cov_+3A_visit_var">visit_var</code></td>
<td>
<p>(<code>character</code>)<br /> character vector of the visit variable</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_extract_cov_+3A_is_spatial">is_spatial</code></td>
<td>
<p>(<code>flag</code>)<br /> indicator whether the covariance structure is spatial.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a simple covariance matrix if there is no grouping, or a named
list of estimated grouped covariance matrices,
with its name equal to the group levels.
</p>

<hr>
<h2 id='h_mmrm_tmb_fit'>Build <code>TMB</code> Fit Result List</h2><span id='topic+h_mmrm_tmb_fit'></span>

<h3>Description</h3>

<p>This helper does some simple post-processing of the <code>TMB</code> object and
optimization results, including setting names, inverting matrices etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_fit(tmb_object, tmb_opt, formula_parts, tmb_data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_fit_+3A_tmb_object">tmb_object</code></td>
<td>
<p>(<code>list</code>)<br /> created with <code><a href="TMB.html#topic+MakeADFun">TMB::MakeADFun()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_fit_+3A_tmb_opt">tmb_opt</code></td>
<td>
<p>(<code>list</code>)<br /> optimization result.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_fit_+3A_formula_parts">formula_parts</code></td>
<td>
<p>(<code>mmrm_tmb_formula_parts</code>)<br /> produced by
<code><a href="#topic+h_mmrm_tmb_formula_parts">h_mmrm_tmb_formula_parts()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_fit_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Instead of inverting or decomposing <code>beta_vcov</code>, it can be more efficient to use its robust
Cholesky decomposition <code>LDL^T</code>, therefore we return the corresponding two components <code>L</code> and <code>D</code>
as well since they have been available on the <code style="white-space: pre;">&#8288;C++&#8288;</code> side already.
</p>


<h3>Value</h3>

<p>List of class <code>mmrm_tmb</code> with:
</p>

<ul>
<li> <p><code>cov</code>: estimated covariance matrix, or named list of estimated group specific covariance matrices.
</p>
</li>
<li> <p><code>beta_est</code>: vector of coefficient estimates.
</p>
</li>
<li> <p><code>beta_vcov</code>: Variance-covariance matrix for coefficient estimates.
</p>
</li>
<li> <p><code>beta_vcov_inv_L</code>: Lower triangular matrix <code>L</code> of the inverse variance-covariance matrix decomposition.
</p>
</li>
<li> <p><code>beta_vcov_inv_D</code>: vector of diagonal matrix <code>D</code> of the inverse variance-covariance matrix decomposition.
</p>
</li>
<li> <p><code>theta_est</code>: vector of variance parameter estimates.
</p>
</li>
<li> <p><code>theta_vcov</code>: variance-covariance matrix for variance parameter estimates.
</p>
</li>
<li> <p><code>neg_log_lik</code>: obtained negative log-likelihood.
</p>
</li>
<li> <p><code>formula_parts</code>: input.
</p>
</li>
<li> <p><code>data</code>: input.
</p>
</li>
<li> <p><code>weights</code>: input.
</p>
</li>
<li> <p><code>reml</code>: input as a flag.
</p>
</li>
<li> <p><code>opt_details</code>: list with optimization details including convergence code.
</p>
</li>
<li> <p><code>tmb_object</code>: original <code>TMB</code> object created with <code><a href="TMB.html#topic+MakeADFun">TMB::MakeADFun()</a></code>.
</p>
</li>
<li> <p><code>tmb_data</code>: input.
</p>
</li></ul>


<hr>
<h2 id='h_mmrm_tmb_formula_parts'>Processing the Formula for <code>TMB</code> Fit</h2><span id='topic+h_mmrm_tmb_formula_parts'></span>

<h3>Description</h3>

<p>Processing the Formula for <code>TMB</code> Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_formula_parts(
  formula,
  covariance = as.cov_struct(formula, warn_partial = FALSE)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_formula_parts_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> Original formula.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_formula_parts_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> A covariance structure from which
additional formula parts should be added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of class <code>mmrm_tmb_formula_parts</code> with elements:
</p>

<ul>
<li> <p><code>formula</code>: the original input.
</p>
</li>
<li> <p><code>model_formula</code>: <code>formula</code> with the covariance term is removed.
</p>
</li>
<li> <p><code>model_formula</code>: <code>formula</code> with the covariance term removed.
</p>
</li>
<li> <p><code>full_formula</code>: same as <code>model_formula</code> but includes the covariance
structure's subject, visit and (optionally) group variables.
</p>
</li>
<li> <p><code>cov_type</code>: <code>string</code> with covariance term type (e.g. <code>"us"</code>).
</p>
</li>
<li> <p><code>is_spatial</code>: <code>flag</code> indicator of whether the covariance structure is
spatial
</p>
</li>
<li> <p><code>visit_var</code>: <code>character</code> with the visit variable name.
</p>
</li>
<li> <p><code>subject_var</code>: <code>string</code> with the subject variable name.
</p>
</li>
<li> <p><code>group_var</code>: <code>string</code> with the group variable name. If no group specified,
this element is <code>NULL</code>.
</p>
</li></ul>


<hr>
<h2 id='h_mmrm_tmb_parameters'>Start Parameters for <code>TMB</code> Fit</h2><span id='topic+h_mmrm_tmb_parameters'></span>

<h3>Description</h3>

<p>Start Parameters for <code>TMB</code> Fit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_mmrm_tmb_parameters(formula_parts, tmb_data, start, n_groups = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_mmrm_tmb_parameters_+3A_formula_parts">formula_parts</code></td>
<td>
<p>(<code>mmrm_tmb_formula_parts</code>)<br /> produced by
<code><a href="#topic+h_mmrm_tmb_formula_parts">h_mmrm_tmb_formula_parts()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_parameters_+3A_tmb_data">tmb_data</code></td>
<td>
<p>(<code>mmrm_tmb_data</code>)<br /> produced by <code><a href="#topic+h_mmrm_tmb_data">h_mmrm_tmb_data()</a></code>.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_parameters_+3A_start">start</code></td>
<td>
<p>(<code>numeric</code> or <code>NULL</code>)<br /> optional start values for variance
parameters.</p>
</td></tr>
<tr><td><code id="h_mmrm_tmb_parameters_+3A_n_groups">n_groups</code></td>
<td>
<p>(<code>int</code>)<br /> number of groups.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with element <code>theta</code> containing the start values for the variance
parameters.
</p>

<hr>
<h2 id='h_newdata_add_pred'>Add Prediction Results to New Data</h2><span id='topic+h_newdata_add_pred'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+augment.mmrm">augment.mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_newdata_add_pred(x, newdata, se_fit, interval, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_newdata_add_pred_+3A_x">x</code></td>
<td>
<p>(<code>mmrm</code>)<br /> fit.</p>
</td></tr>
<tr><td><code id="h_newdata_add_pred_+3A_newdata">newdata</code></td>
<td>
<p>(<code>data.frame</code>)<br /> data to predict.</p>
</td></tr>
<tr><td><code id="h_newdata_add_pred_+3A_se_fit">se_fit</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to return standard error of prediction,
can only be used when <code>interval</code> is not &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="h_newdata_add_pred_+3A_interval">interval</code></td>
<td>
<p>(<code>string</code>)<br /> type of interval.</p>
</td></tr>
<tr><td><code id="h_newdata_add_pred_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+predict.mmrm_tmb">predict.mmrm_tmb()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The <code>newdata</code> as a <code>tibble</code> with additional columns <code>.fitted</code>,
<code>.lower</code>, <code>.upper</code> (if interval is not <code>none</code>) and <code>.se.fit</code> (if <code>se_fit</code>
requested).
</p>

<hr>
<h2 id='h_optimizer_fun'>Obtain Optimizer Function with Character</h2><span id='topic+h_optimizer_fun'></span>

<h3>Description</h3>

<p>Obtain the optimizer function through the character provided.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_optimizer_fun(optimizer = c("L-BFGS-B", "BFGS", "CG", "nlminb"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_optimizer_fun_+3A_optimizer">optimizer</code></td>
<td>
<p>(<code>character</code>)<br /> vector of optimizers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (<code>list</code>)<br /> of optimizer functions generated from <code><a href="#topic+h_partial_fun_args">h_partial_fun_args()</a></code>.
</p>

<hr>
<h2 id='h_partial_fun_args'>Create Partial Functions</h2><span id='topic+h_partial_fun_args'></span>

<h3>Description</h3>

<p>Creates partial functions with arguments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_partial_fun_args(fun, ..., additional_attr = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_partial_fun_args_+3A_fun">fun</code></td>
<td>
<p>(<code>function</code>)<br /> to be wrapped.</p>
</td></tr>
<tr><td><code id="h_partial_fun_args_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code>fun</code>.</p>
</td></tr>
<tr><td><code id="h_partial_fun_args_+3A_additional_attr">additional_attr</code></td>
<td>
<p>(<code>list</code>)<br /> of additional attributes to apply to the result.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function add <code>args</code> attribute to the original function,
and add an extra class <code>partial</code> to the function.
<code>args</code> is the argument for the function, and elements in <code>...</code> will override the existing
arguments in attribute <code>args</code>. <code>additional_attr</code> will override the existing attributes.
</p>


<h3>Value</h3>

<p>Object with S3 class <code>"partial"</code>, a <code>function</code> with <code>args</code> attribute (and possibly more
attributes from <code>additional_attr</code>).
</p>

<hr>
<h2 id='h_print_aic_list'>Printing AIC and other Model Fit Criteria</h2><span id='topic+h_print_aic_list'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+print.summary.mmrm">print.summary.mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_print_aic_list(aic_list, digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_print_aic_list_+3A_aic_list">aic_list</code></td>
<td>
<p>(<code>list</code>)<br /> list as part of from <code><a href="#topic+summary.mmrm">summary.mmrm()</a></code>.</p>
</td></tr>
<tr><td><code id="h_print_aic_list_+3A_digits">digits</code></td>
<td>
<p>(<code>number</code>)<br /> number of decimal places used with <code><a href="base.html#topic+round">round()</a></code>.</p>
</td></tr>
</table>

<hr>
<h2 id='h_print_call'>Printing MMRM Function Call</h2><span id='topic+h_print_call'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+print.summary.mmrm">print.summary.mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_print_call(call, n_obs, n_subjects, n_timepoints)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_print_call_+3A_call">call</code></td>
<td>
<p>(<code>call</code>)<br /> original <code><a href="#topic+mmrm">mmrm()</a></code> function call.</p>
</td></tr>
<tr><td><code id="h_print_call_+3A_n_obs">n_obs</code></td>
<td>
<p>(<code>int</code>)<br /> number of observations.</p>
</td></tr>
<tr><td><code id="h_print_call_+3A_n_subjects">n_subjects</code></td>
<td>
<p>(<code>int</code>)<br /> number of subjects.</p>
</td></tr>
<tr><td><code id="h_print_call_+3A_n_timepoints">n_timepoints</code></td>
<td>
<p>(<code>int</code>)<br /> number of timepoints.</p>
</td></tr>
</table>

<hr>
<h2 id='h_print_cov'>Printing MMRM Covariance Type</h2><span id='topic+h_print_cov'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+print.summary.mmrm">print.summary.mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_print_cov(cov_type, n_theta, n_groups)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_print_cov_+3A_cov_type">cov_type</code></td>
<td>
<p>(<code>string</code>)<br /> covariance structure abbreviation.</p>
</td></tr>
<tr><td><code id="h_print_cov_+3A_n_theta">n_theta</code></td>
<td>
<p>(<code>count</code>)<br /> number of variance parameters.</p>
</td></tr>
<tr><td><code id="h_print_cov_+3A_n_groups">n_groups</code></td>
<td>
<p>(<code>count</code>)<br /> number of groups.</p>
</td></tr>
</table>

<hr>
<h2 id='h_quad_form'>Quadratic Form Calculations</h2><span id='topic+h_quad_form'></span><span id='topic+h_quad_form_vec'></span><span id='topic+h_quad_form_mat'></span>

<h3>Description</h3>

<p>These helpers are mainly for easier readability and slightly better efficiency
of the quadratic forms used in the Satterthwaite calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_quad_form_vec(vec, center)

h_quad_form_mat(mat, center)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_quad_form_+3A_vec">vec</code></td>
<td>
<p>(<code>numeric</code>)<br /> interpreted as a row vector.</p>
</td></tr>
<tr><td><code id="h_quad_form_+3A_center">center</code></td>
<td>
<p>(<code>matrix</code>)<br /> square numeric matrix with the same dimensions as
<code>x</code> as the center of the quadratic form.</p>
</td></tr>
<tr><td><code id="h_quad_form_+3A_mat">mat</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric matrix to be multiplied left and right of
<code>center</code>, therefore needs to have as many columns as there are rows and columns
in <code>center</code>.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>h_quad_form_vec()</code>: calculates the number <code>vec %*% center %*% t(vec)</code>
as a numeric (not a matrix).
</p>
</li>
<li> <p><code>h_quad_form_mat()</code>: calculates the quadratic form <code>mat %*% center %*% t(mat)</code>
as a matrix, the result is square and has dimensions identical to the number
of rows in <code>mat</code>.
</p>
</li></ul>

<hr>
<h2 id='h_reconcile_cov_struct'>Reconcile Possible Covariance Structure Inputs</h2><span id='topic+h_reconcile_cov_struct'></span>

<h3>Description</h3>

<p>Reconcile Possible Covariance Structure Inputs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_reconcile_cov_struct(formula = NULL, covariance = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_reconcile_cov_struct_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> the model formula, see details.</p>
</td></tr>
<tr><td><code id="h_reconcile_cov_struct_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure type definition
as produced with <code><a href="#topic+cov_struct">cov_struct()</a></code>, or value that can be coerced to a
covariance structure using <code><a href="#topic+as.cov_struct">as.cov_struct()</a></code>. If no value is provided,
a structure is derived from the provided formula.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The value <code>covariance</code> if it's provided or a covariance structure
derived from the provided <code>formula</code> otherwise. An error is raised of both
are provided.
</p>

<hr>
<h2 id='h_record_all_output'>Capture all Output</h2><span id='topic+h_record_all_output'></span>

<h3>Description</h3>

<p>This function silences all warnings, errors &amp; messages and instead returns a list
containing the results (if it didn't error), as well as the warnings, errors
and messages and divergence signals as character vectors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_record_all_output(expr, remove = list(), divergence = list())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_record_all_output_+3A_expr">expr</code></td>
<td>
<p>(<code>expression</code>)<br /> to be executed.</p>
</td></tr>
<tr><td><code id="h_record_all_output_+3A_remove">remove</code></td>
<td>
<p>(<code>list</code>)<br /> optional list with elements <code>warnings</code>, <code>errors</code>,
<code>messages</code> which can be character vectors, which will be removed from the
results if specified.</p>
</td></tr>
<tr><td><code id="h_record_all_output_+3A_divergence">divergence</code></td>
<td>
<p>(<code>list</code>)<br /> optional list similar as <code>remove</code>, but these
character vectors will be moved to the <code>divergence</code> result and signal
that the fit did not converge.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li> <p><code>result</code>: The object returned by <code>expr</code> or <code>list()</code> if an error was thrown.
</p>
</li>
<li> <p><code>warnings</code>: <code>NULL</code> or a character vector if warnings were thrown.
</p>
</li>
<li> <p><code>errors</code>: <code>NULL</code> or a string if an error was thrown.
</p>
</li>
<li> <p><code>messages</code>: <code>NULL</code> or a character vector if messages were produced.
</p>
</li>
<li> <p><code>divergence</code>: <code>NULL</code> or a character vector if divergence messages were caught.
</p>
</li></ul>


<hr>
<h2 id='h_register_s3'>Register S3 Method
Register S3 method to a generic.</h2><span id='topic+h_register_s3'></span>

<h3>Description</h3>

<p>Register S3 Method
Register S3 method to a generic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_register_s3(pkg, generic, class, envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_register_s3_+3A_pkg">pkg</code></td>
<td>
<p>(<code>string</code>) name of the package name.</p>
</td></tr>
<tr><td><code id="h_register_s3_+3A_generic">generic</code></td>
<td>
<p>(<code>string</code>) name of the generic.</p>
</td></tr>
<tr><td><code id="h_register_s3_+3A_class">class</code></td>
<td>
<p>(<code>string</code>) class name the function want to dispatch.</p>
</td></tr>
<tr><td><code id="h_register_s3_+3A_envir">envir</code></td>
<td>
<p>(<code>environment</code>) the location the method is defined.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is adapted from <code>emmeans:::register_s3_method()</code>.
</p>

<hr>
<h2 id='h_residuals_normalized'>Calculate normalized residuals</h2><span id='topic+h_residuals_normalized'></span>

<h3>Description</h3>

<p>This is used by <code><a href="#topic+residuals.mmrm_tmb">residuals.mmrm_tmb()</a></code> to calculate normalized / scaled residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_residuals_normalized(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_residuals_normalized_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of residuals
</p>

<hr>
<h2 id='h_residuals_pearson'>Calculate Pearson Residuals</h2><span id='topic+h_residuals_pearson'></span>

<h3>Description</h3>

<p>This is used by <code><a href="#topic+residuals.mmrm_tmb">residuals.mmrm_tmb()</a></code> to calculate Pearson residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_residuals_pearson(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_residuals_pearson_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of residuals.
</p>

<hr>
<h2 id='h_residuals_response'>Calculate response residuals.</h2><span id='topic+h_residuals_response'></span>

<h3>Description</h3>

<p>This is used by <code><a href="#topic+residuals.mmrm_tmb">residuals.mmrm_tmb()</a></code> to calculate response residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_residuals_response(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_residuals_response_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of residuals
</p>

<hr>
<h2 id='h_split_control'>Split Control List</h2><span id='topic+h_split_control'></span>

<h3>Description</h3>

<p>Split the <code><a href="#topic+mmrm_control">mmrm_control()</a></code> object according to its optimizers and use additional arguments
to replace the elements in the original object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_split_control(control, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_split_control_+3A_control">control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br /> object.</p>
</td></tr>
<tr><td><code id="h_split_control_+3A_...">...</code></td>
<td>
<p>additional parameters to update the <code>control</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> of <code>mmrm_control</code> entries.
</p>

<hr>
<h2 id='h_summarize_all_fits'>Summarizing List of Fits</h2><span id='topic+h_summarize_all_fits'></span>

<h3>Description</h3>

<p>Summarizing List of Fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_summarize_all_fits(all_fits)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_summarize_all_fits_+3A_all_fits">all_fits</code></td>
<td>
<p>(<code>list</code> of <code>mmrm_fit</code> or <code>try-error</code>)<br /> list of fits.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>warnings</code>, <code>messages</code>, <code>log_liks</code> and <code>converged</code> results.
</p>

<hr>
<h2 id='h_tbl_confint_terms'>Extract <code>tibble</code> with Confidence Intervals and Term Names</h2><span id='topic+h_tbl_confint_terms'></span>

<h3>Description</h3>

<p>This is used in <code><a href="#topic+tidy.mmrm">tidy.mmrm()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_tbl_confint_terms(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_tbl_confint_terms_+3A_x">x</code></td>
<td>
<p>(<code>mmrm</code>)<br /> fit object.</p>
</td></tr>
<tr><td><code id="h_tbl_confint_terms_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="stats.html#topic+confint">stats::confint()</a></code>, hence not used at the moment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code> with <code>term</code>, <code>conf.low</code>, <code>conf.high</code> columns.
</p>

<hr>
<h2 id='h_test_1d'>Creating T-Statistic Test Results For One-Dimensional Contrast</h2><span id='topic+h_test_1d'></span>

<h3>Description</h3>

<p>Creates a list of results for one-dimensional contrasts using
a t-test statistic and the given degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_test_1d(object, contrast, df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_test_1d_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_test_1d_+3A_contrast">contrast</code></td>
<td>
<p>(<code>numeric</code>)<br /> contrast vector. Note that this should not include
elements for singular coefficient estimates, i.e. only refer to the
actually estimated coefficients.</p>
</td></tr>
<tr><td><code id="h_test_1d_+3A_df">df</code></td>
<td>
<p>(<code>number</code>)<br /> degrees of freedom for the one-dimensional contrast.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>est</code>, <code>se</code>, <code>df</code>, <code>t_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_test_md'>Creating F-Statistic Test Results For Multi-Dimensional Contrast</h2><span id='topic+h_test_md'></span>

<h3>Description</h3>

<p>Creates a list of results for multi-dimensional contrasts using
an F-test statistic and the given degrees of freedom.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_test_md(object, contrast, df, f_stat_factor = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_test_md_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the MMRM fit.</p>
</td></tr>
<tr><td><code id="h_test_md_+3A_contrast">contrast</code></td>
<td>
<p>(<code>matrix</code>)<br /> numeric contrast matrix.</p>
</td></tr>
<tr><td><code id="h_test_md_+3A_df">df</code></td>
<td>
<p>(<code>number</code>)<br /> denominator degrees of freedom for the multi-dimensional contrast.</p>
</td></tr>
<tr><td><code id="h_test_md_+3A_f_stat_factor">f_stat_factor</code></td>
<td>
<p>(<code>number</code>)<br /> optional scaling factor on top of the standard F-statistic.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with <code>num_df</code>, <code>denom_df</code>, <code>f_stat</code> and <code>p_val</code> (2-sided p-value).
</p>

<hr>
<h2 id='h_tr'>Trace of a Matrix</h2><span id='topic+h_tr'></span>

<h3>Description</h3>

<p>Obtain the trace of a matrix if the matrix is diagonal, otherwise raise an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_tr(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_tr_+3A_x">x</code></td>
<td>
<p>(<code>matrix</code>)<br /> square matrix input.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The trace of the square matrix.
</p>

<hr>
<h2 id='h_valid_formula'>Validate mmrm Formula</h2><span id='topic+h_valid_formula'></span>

<h3>Description</h3>

<p>Validate mmrm Formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_valid_formula(formula)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_valid_formula_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> to check.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In mmrm models, <code>.</code> is not allowed as it introduces ambiguity of covariates
to be used, so it is not allowed to be in formula.
</p>

<hr>
<h2 id='h_var_adj'>Obtain the Adjusted Covariance Matrix</h2><span id='topic+h_var_adj'></span>

<h3>Description</h3>

<p>Obtains the Kenward-Roger adjusted covariance matrix for the
coefficient estimates.
Used in <code><a href="#topic+mmrm">mmrm()</a></code> fitting if method is &quot;Kenward-Roger&quot; or &quot;Kenward-Roger-Linear&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_var_adj(v, w, p, q, r, linear = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_var_adj_+3A_v">v</code></td>
<td>
<p>(<code>matrix</code>)<br /> unadjusted covariance matrix.</p>
</td></tr>
<tr><td><code id="h_var_adj_+3A_w">w</code></td>
<td>
<p>(<code>matrix</code>)<br /> hessian matrix.</p>
</td></tr>
<tr><td><code id="h_var_adj_+3A_p">p</code></td>
<td>
<p>(<code>matrix</code>)<br /> P matrix from <code><a href="#topic+h_get_kr_comp">h_get_kr_comp()</a></code>.</p>
</td></tr>
<tr><td><code id="h_var_adj_+3A_q">q</code></td>
<td>
<p>(<code>matrix</code>)<br /> Q matrix from <code><a href="#topic+h_get_kr_comp">h_get_kr_comp()</a></code>.</p>
</td></tr>
<tr><td><code id="h_var_adj_+3A_r">r</code></td>
<td>
<p>(<code>matrix</code>)<br /> R matrix from <code><a href="#topic+h_get_kr_comp">h_get_kr_comp()</a></code>.</p>
</td></tr>
<tr><td><code id="h_var_adj_+3A_linear">linear</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to use linear Kenward-Roger approximation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of adjusted covariance matrix.
</p>

<hr>
<h2 id='h_warn_na_action'>Warn on na.action</h2><span id='topic+h_warn_na_action'></span>

<h3>Description</h3>

<p>Warn on na.action
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_warn_na_action()
</code></pre>

<hr>
<h2 id='h_within_or_between'>Determine Within or Between for each Design Matrix Column</h2><span id='topic+h_within_or_between'></span>

<h3>Description</h3>

<p>Used in <code><a href="#topic+h_df_bw_calc">h_df_bw_calc()</a></code> to determine whether a variable
differs only between subjects or also within subjects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h_within_or_between(x_matrix, subject_ids)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_within_or_between_+3A_x_matrix">x_matrix</code></td>
<td>
<p>(<code>matrix</code>)<br /> the design matrix with column names.</p>
</td></tr>
<tr><td><code id="h_within_or_between_+3A_subject_ids">subject_ids</code></td>
<td>
<p>(<code>factor</code>)<br /> the subject IDs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector with &quot;intercept&quot;, &quot;within&quot; or &quot;between&quot; for each
design matrix column identified via the names of the vector.
</p>

<hr>
<h2 id='is_infix'>Test Whether a Symbol is an Infix Operator</h2><span id='topic+is_infix'></span>

<h3>Description</h3>

<p>Test Whether a Symbol is an Infix Operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_infix(name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_infix_+3A_name">name</code></td>
<td>
<p>(<code>symbol</code> or <code>name</code> or <code>string</code>)<br /> a possible reference to an
infix operator to check.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical indicating whether the name is the name of an infix
operator.
</p>
<div class="sourceCode"><pre>is_infix(as.name("|"))
is_infix("|")
is_infix("c")
</pre></div>

<hr>
<h2 id='mmrm'>Fit an MMRM</h2><span id='topic+mmrm'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This is the main function fitting the MMRM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmrm(
  formula,
  data,
  weights = NULL,
  covariance = NULL,
  reml = TRUE,
  control = mmrm_control(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmrm_+3A_formula">formula</code></td>
<td>
<p>(<code>formula</code>)<br /> the model formula, see details.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_data">data</code></td>
<td>
<p>(<code>data</code>)<br /> the data to be used for the model.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_weights">weights</code></td>
<td>
<p>(<code>vector</code>)<br /> an optional vector of weights to be used in
the fitting process. Should be <code>NULL</code> or a numeric vector.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_covariance">covariance</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure type definition
as produced with <code><a href="#topic+cov_struct">cov_struct()</a></code>, or value that can be coerced to a
covariance structure using <code><a href="#topic+as.cov_struct">as.cov_struct()</a></code>. If no value is provided,
a structure is derived from the provided formula.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_reml">reml</code></td>
<td>
<p>(<code>flag</code>)<br /> whether restricted maximum likelihood (REML)
estimation is used, otherwise maximum likelihood (ML) is used.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_control">control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br /> fine-grained fitting specifications list
created with <code><a href="#topic+mmrm_control">mmrm_control()</a></code>.</p>
</td></tr>
<tr><td><code id="mmrm_+3A_...">...</code></td>
<td>
<p>arguments passed to <code><a href="#topic+mmrm_control">mmrm_control()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>formula</code> typically looks like:
<code>FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)</code>
so specifies response and covariates as usual, and exactly one special term
defines which covariance structure is used and what are the time point and
subject variables. The covariance structures in the formula can be
found in <code><a href="#topic+covariance_types">covariance_types</a></code>.
</p>
<p>The time points have to be unique for each subject. That is,
there cannot be time points with multiple observations for any subject.
The rationale is that these observations would need to be correlated, but it
is not possible within the currently implemented covariance structure framework
to do that correctly. Moreover, for non-spatial covariance structures, the time
variable must be a factor variable.
</p>
<p>When optimizer is not set, first the default optimizer
(<code>L-BFGS-B</code>) is used to fit the model. If that converges, this is returned.
If not, the other available optimizers from <code><a href="#topic+h_get_optimizers">h_get_optimizers()</a></code>,
including <code>BFGS</code>, <code>CG</code> and <code>nlminb</code> are
tried (in parallel if <code>n_cores</code> is set and not on Windows).
If none of the optimizers converge, then the function fails. Otherwise
the best fit is returned.
</p>
<p>Note that fine-grained control specifications can either be passed directly
to the <code>mmrm</code> function, or via the <code>control</code> argument for bundling together
with the <code><a href="#topic+mmrm_control">mmrm_control()</a></code> function. Both cannot be used together, since
this would delete the arguments passed via <code>mmrm</code>.
</p>


<h3>Value</h3>

<p>An <code>mmrm</code> object.
</p>


<h3>Note</h3>

<p>The <code>mmrm</code> object is also an <code>mmrm_fit</code> and an <code>mmrm_tmb</code> object,
therefore corresponding methods also work (see <code><a href="#topic+mmrm_tmb_methods">mmrm_tmb_methods</a></code>).
</p>
<p>Additional contents depend on the choice of the adjustment <code>method</code>:
</p>

<ul>
<li><p> If Satterthwaite adjustment is used, the Jacobian information <code>jac_list</code>
is included.
</p>
</li>
<li><p> If Kenward-Roger adjustment is used, <code>kr_comp</code> contains necessary
components and <code>beta_vcov_adj</code> includes the adjusted coefficients covariance
matrix.
</p>
</li></ul>

<p>Use of the package <code>emmeans</code> is supported, see <code><a href="#topic+emmeans_support">emmeans_support</a></code>.
</p>
<p>NA values are always omitted regardless of <code>na.action</code> setting.
</p>
<p>When the number of visit levels is large, it usually requires large memory to create the
covariance matrix. By default, the maximum allowed visit levels is 100, and if there are more
visit levels, a confirmation is needed if run interactively.
You can use <code style="white-space: pre;">&#8288;options(mmrm.max_visits = &lt;target&gt;)&#8288;</code> to increase the maximum allowed number of visit
levels. In non-interactive sessions the confirmation is not raised and will directly give you an error if
the number of visit levels exceeds the maximum.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)

# Direct specification of control details:
fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  weights = fev_data$WEIGHTS,
  method = "Kenward-Roger"
)

# Alternative specification via control argument (but you cannot mix the
# two approaches):
fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  control = mmrm_control(method = "Kenward-Roger")
)
</code></pre>

<hr>
<h2 id='mmrm_control'>Control Parameters for Fitting an MMRM</h2><span id='topic+mmrm_control'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
Fine-grained specification of the MMRM fit details is possible using this
control function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mmrm_control(
  n_cores = 1L,
  method = c("Satterthwaite", "Kenward-Roger", "Residual", "Between-Within"),
  vcov = NULL,
  start = std_start,
  accept_singular = TRUE,
  drop_visit_levels = TRUE,
  ...,
  optimizers = h_get_optimizers(...)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmrm_control_+3A_n_cores">n_cores</code></td>
<td>
<p>(<code>count</code>)<br /> number of cores to be used.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_method">method</code></td>
<td>
<p>(<code>string</code>)<br /> adjustment method for degrees of freedom.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_vcov">vcov</code></td>
<td>
<p>(<code>string</code>)<br /> coefficients covariance matrix adjustment method.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_start">start</code></td>
<td>
<p>(<code>NULL</code>, <code>numeric</code> or <code>function</code>)<br /> optional start values for variance
parameters. See details for more information.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_accept_singular">accept_singular</code></td>
<td>
<p>(<code>flag</code>)<br /> whether singular design matrices are reduced
to full rank automatically and additional coefficient estimates will be missing.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_drop_visit_levels">drop_visit_levels</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to drop levels for visit variable,
if visit variable is a factor, see details.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="#topic+h_get_optimizers">h_get_optimizers()</a></code>.</p>
</td></tr>
<tr><td><code id="mmrm_control_+3A_optimizers">optimizers</code></td>
<td>
<p>(<code>list</code>)<br /> optimizer specification, created with <code><a href="#topic+h_get_optimizers">h_get_optimizers()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For example, if the data only has observations at visits <code>VIS1</code>, <code>VIS3</code> and <code>VIS4</code>, by default
they are treated to be equally spaced, the distance from <code>VIS1</code> to <code>VIS3</code>, and from <code>VIS3</code> to <code>VIS4</code>,
are identical. However, you can manually convert this visit into a factor, with
<code>levels = c("VIS1", "VIS2", "VIS3", "VIS4")</code>, and also use <code>drop_visits_levels = FALSE</code>,
then the distance from <code>VIS1</code> to <code>VIS3</code> will be double, as <code>VIS2</code> is a valid visit.
However, please be cautious because this can lead to convergence failure
when using an unstructured covariance matrix and there are no observations
at the missing visits.
</p>

<ul>
<li><p> The <code>method</code> and <code>vcov</code> arguments specify the degrees of freedom and coefficients
covariance matrix adjustment methods, respectively.
</p>

<ul>
<li><p> Allowed <code>vcov</code> includes: &quot;Asymptotic&quot;, &quot;Kenward-Roger&quot;, &quot;Kenward-Roger-Linear&quot;, &quot;Empirical&quot; (CR0),
&quot;Empirical-Jackknife&quot; (CR3), and &quot;Empirical-Bias-Reduced&quot; (CR2).
</p>
</li>
<li><p> Allowed <code>method</code> includes: &quot;Satterthwaite&quot;, &quot;Kenward-Roger&quot;, &quot;Between-Within&quot; and &quot;Residual&quot;.
</p>
</li>
<li><p> If <code>method</code> is &quot;Kenward-Roger&quot; then only &quot;Kenward-Roger&quot; or &quot;Kenward-Roger-Linear&quot; are allowed for <code>vcov</code>.
</p>
</li></ul>

</li>
<li><p> The <code>vcov</code> argument can be <code>NULL</code> to use the default covariance method depending on the <code>method</code>
used for degrees of freedom, see the following table:</p>

<table>
<tr>
 <td style="text-align: left;">
   <code>method</code> </td><td style="text-align: left;"> Default <code>vcov</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Satterthwaite </td><td style="text-align: left;"> Asymptotic </td>
</tr>
<tr>
 <td style="text-align: left;">
   Kenward-Roger </td><td style="text-align: left;"> Kenward-Roger </td>
</tr>
<tr>
 <td style="text-align: left;">
   Residual </td><td style="text-align: left;"> Empirical </td>
</tr>
<tr>
 <td style="text-align: left;">
   Between-Within </td><td style="text-align: left;"> Asymptotic </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

</li>
<li><p> Please note that &quot;Kenward-Roger&quot; for &quot;Unstructured&quot; covariance gives different results
compared to SAS; Use &quot;Kenward-Roger-Linear&quot; for <code>vcov</code> instead for better matching
of the SAS results.
</p>
</li>
<li><p> The argument <code>start</code> is used to facilitate the choice of initial values for fitting the model.
If <code>function</code> is provided, make sure its parameter is a valid element of <code>mmrm_tmb_data</code>
or <code>mmrm_tmb_formula_parts</code> and it returns a numeric vector.
By default or if <code>NULL</code> is provided, <code>std_start</code> will be used.
Other implemented methods include <code>emp_start</code>.
</p>
</li></ul>



<h3>Value</h3>

<p>List of class <code>mmrm_control</code> with the control parameters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mmrm_control(
  optimizer_fun = stats::optim,
  optimizer_args = list(method = "L-BFGS-B")
)
</code></pre>

<hr>
<h2 id='mmrm_methods'>Methods for <code>mmrm</code> Objects</h2><span id='topic+mmrm_methods'></span><span id='topic+summary.mmrm'></span><span id='topic+print.summary.mmrm'></span><span id='topic+confint.mmrm'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mmrm'
summary(object, ...)

## S3 method for class 'summary.mmrm'
print(
  x,
  digits = max(3, getOption("digits") - 3),
  signif.stars = getOption("show.signif.stars"),
  ...
)

## S3 method for class 'mmrm'
confint(object, parm, level = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmrm_methods_+3A_object">object</code></td>
<td>
<p>(<code>mmrm</code>)<br /> the fitted MMRM including Jacobian and call etc.</p>
</td></tr>
<tr><td><code id="mmrm_methods_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While printing the summary of (<code>mmrm</code>)<br /> object, the following will be displayed:
</p>

<ol>
<li><p> Formula. The formula used in the model.
</p>
</li>
<li><p> Data. The data used for analysis, including number of subjects, number of valid observations.
</p>
</li>
<li><p> Covariance. The covariance structure and number of variance parameters.
</p>
</li>
<li><p> Method. Restricted maximum likelihood(REML) or maximum likelihood(ML).
</p>
</li>
<li><p> Model selection criteria. AIC, BIC, log likelihood and deviance.
</p>
</li>
<li><p> Coefficients. Coefficients of the covariates.
</p>
</li>
<li><p> Covariance estimate. The covariance estimate(for each group).
</p>

<ol>
<li><p> If the covariance structure is non-spatial, the covariance matrix of all categorical time points available
in data will be displayed.
</p>
</li>
<li><p> If the covariance structure is spatial, the covariance matrix of two time points with unit distance
will be displayed.
</p>
</li></ol>

</li></ol>

<p><code>confint</code> is used to obtain the confidence intervals for the coefficients.
Please note that this is different from the confidence interval of difference
of least square means from <code>emmeans</code>.
</p>


<h3>Value</h3>

<p>Depends on the method, see Details and Functions.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>summary(mmrm)</code>: summarizes the MMRM fit results.
</p>
</li>
<li> <p><code>print(summary.mmrm)</code>: prints the MMRM fit summary.
</p>
</li>
<li> <p><code>confint(mmrm)</code>: obtain the confidence intervals for the coefficients.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+mmrm_tmb_methods">mmrm_tmb_methods</a></code>, <code><a href="#topic+mmrm_tidiers">mmrm_tidiers</a></code> for additional methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formula &lt;- FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
object &lt;- mmrm(formula, fev_data)
# Summary:
summary(object)
# Confidence Interval:
confint(object)
</code></pre>

<hr>
<h2 id='mmrm_tidiers'>Tidying Methods for <code>mmrm</code> Objects</h2><span id='topic+mmrm_tidiers'></span><span id='topic+tidy.mmrm'></span><span id='topic+glance.mmrm'></span><span id='topic+augment.mmrm'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>These methods tidy the estimates from an <code>mmrm</code> object into a
summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mmrm'
tidy(x, conf.int = FALSE, conf.level = 0.95, ...)

## S3 method for class 'mmrm'
glance(x, ...)

## S3 method for class 'mmrm'
augment(
  x,
  newdata = NULL,
  interval = c("none", "confidence", "prediction"),
  se_fit = (interval != "none"),
  type.residuals = c("response", "pearson", "normalized"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmrm_tidiers_+3A_x">x</code></td>
<td>
<p>(<code>mmrm</code>)<br /> fitted model.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_conf.int">conf.int</code></td>
<td>
<p>(<code>flag</code>)<br /> if <code>TRUE</code> columns for the lower (<code>conf.low</code>) and upper bounds
(<code>conf.high</code>) of coefficient estimates are included.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_conf.level">conf.level</code></td>
<td>
<p>(<code>number</code>)<br /> defines the range of the optional confidence internal.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_...">...</code></td>
<td>
<p>only used by <code>augment()</code> to pass arguments to the <code><a href="#topic+predict.mmrm_tmb">predict.mmrm_tmb()</a></code> method.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_newdata">newdata</code></td>
<td>
<p>(<code>data.frame</code> or <code>NULL</code>)<br /> optional new data frame.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_interval">interval</code></td>
<td>
<p>(<code>string</code>)<br /> type of interval calculation.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_se_fit">se_fit</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to return standard errors of fit.</p>
</td></tr>
<tr><td><code id="mmrm_tidiers_+3A_type.residuals">type.residuals</code></td>
<td>
<p>(<code>string</code>)<br /> passed on to <code><a href="#topic+residuals.mmrm_tmb">residuals.mmrm_tmb()</a></code>.</p>
</td></tr>
</table>


<h3>Functions</h3>


<ul>
<li> <p><code>tidy(mmrm)</code>: derives tidy <code>tibble</code> from an <code>mmrm</code> object.
</p>
</li>
<li> <p><code>glance(mmrm)</code>: derives <code>glance</code> <code>tibble</code> from an <code>mmrm</code> object.
</p>
</li>
<li> <p><code>augment(mmrm)</code>: derives <code>augment</code> <code>tibble</code> from an <code>mmrm</code> object.
</p>
</li></ul>


<h3>See Also</h3>

<p><code><a href="#topic+mmrm_methods">mmrm_methods</a></code>, <code><a href="#topic+mmrm_tmb_methods">mmrm_tmb_methods</a></code> for additional methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- mmrm(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data
)
# Applying tidy method to return summary table of covariate estimates.
fit |&gt; tidy()
fit |&gt; tidy(conf.int = TRUE, conf.level = 0.9)
# Applying glance method to return summary table of goodness of fit statistics.
fit |&gt; glance()
# Applying augment method to return merged `tibble` of model data, fitted and residuals.
fit |&gt; augment()
fit |&gt; augment(interval = "confidence")
fit |&gt; augment(type.residuals = "pearson")
</code></pre>

<hr>
<h2 id='mmrm_tmb_methods'>Methods for <code>mmrm_tmb</code> Objects</h2><span id='topic+mmrm_tmb_methods'></span><span id='topic+coef.mmrm_tmb'></span><span id='topic+fitted.mmrm_tmb'></span><span id='topic+predict.mmrm_tmb'></span><span id='topic+model.frame.mmrm_tmb'></span><span id='topic+model.matrix.mmrm_tmb'></span><span id='topic+terms.mmrm_tmb'></span><span id='topic+logLik.mmrm_tmb'></span><span id='topic+formula.mmrm_tmb'></span><span id='topic+vcov.mmrm_tmb'></span><span id='topic+VarCorr.mmrm_tmb'></span><span id='topic+VarCorr'></span><span id='topic+deviance.mmrm_tmb'></span><span id='topic+AIC.mmrm_tmb'></span><span id='topic+BIC.mmrm_tmb'></span><span id='topic+print.mmrm_tmb'></span><span id='topic+residuals.mmrm_tmb'></span><span id='topic+simulate.mmrm_tmb'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mmrm_tmb'
coef(object, complete = TRUE, ...)

## S3 method for class 'mmrm_tmb'
fitted(object, ...)

## S3 method for class 'mmrm_tmb'
predict(
  object,
  newdata,
  se.fit = FALSE,
  interval = c("none", "confidence", "prediction"),
  level = 0.95,
  nsim = 1000L,
  ...
)

## S3 method for class 'mmrm_tmb'
model.frame(
  formula,
  data,
  include = c("subject_var", "visit_var", "group_var", "response_var"),
  full,
  na.action = "na.omit",
  ...
)

## S3 method for class 'mmrm_tmb'
model.matrix(object, data, include = NULL, ...)

## S3 method for class 'mmrm_tmb'
terms(x, include = "response_var", ...)

## S3 method for class 'mmrm_tmb'
logLik(object, ...)

## S3 method for class 'mmrm_tmb'
formula(x, ...)

## S3 method for class 'mmrm_tmb'
vcov(object, complete = TRUE, ...)

## S3 method for class 'mmrm_tmb'
VarCorr(x, sigma = NA, ...)

## S3 method for class 'mmrm_tmb'
deviance(object, ...)

## S3 method for class 'mmrm_tmb'
AIC(object, corrected = FALSE, ..., k = 2)

## S3 method for class 'mmrm_tmb'
BIC(object, ...)

## S3 method for class 'mmrm_tmb'
print(x, ...)

## S3 method for class 'mmrm_tmb'
residuals(object, type = c("response", "pearson", "normalized"), ...)

## S3 method for class 'mmrm_tmb'
simulate(
  object,
  nsim = 1,
  seed = NULL,
  newdata,
  ...,
  method = c("conditional", "marginal")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mmrm_tmb_methods_+3A_object">object</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> the fitted MMRM object.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_complete">complete</code></td>
<td>
<p>(<code>flag</code>)<br /> whether to include potential non-estimable
coefficients.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_...">...</code></td>
<td>
<p>mostly not used;
Exception is <code>model.matrix()</code> passing <code>...</code> to the default method.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_newdata">newdata</code></td>
<td>
<p>(<code>data.frame</code>)<br /> optional new data, otherwise data from <code>object</code> is used.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_se.fit">se.fit</code></td>
<td>
<p>(<code>flag</code>)<br /> indicator if standard errors are required.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_interval">interval</code></td>
<td>
<p>(<code>string</code>)<br /> type of interval calculation. Can be abbreviated.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_level">level</code></td>
<td>
<p>(<code>number</code>)<br /> tolerance/confidence level.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_nsim">nsim</code></td>
<td>
<p>(<code>count</code>)<br /> number of simulations to use.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_formula">formula</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> same as <code>object</code>.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_data">data</code></td>
<td>
<p>(<code>data.frame</code>)<br /> object in which to construct the frame.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_include">include</code></td>
<td>
<p>(<code>character</code>)<br /> names of variable types to include.
Must be <code>NULL</code> or one or more of <code>c("subject_var", "visit_var", "group_var", "response_var")</code>.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_full">full</code></td>
<td>
<p>(<code>flag</code>)<br /> indicator whether to return full model frame (deprecated).</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_na.action">na.action</code></td>
<td>
<p>(<code>string</code>)<br /> na action.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_x">x</code></td>
<td>
<p>(<code>mmrm_tmb</code>)<br /> same as <code>object</code>.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_sigma">sigma</code></td>
<td>
<p>cannot be used (this parameter does not exist in MMRM).</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_corrected">corrected</code></td>
<td>
<p>(<code>flag</code>)<br /> whether corrected AIC should be calculated.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_k">k</code></td>
<td>
<p>(<code>number</code>)<br /> the penalty per parameter to be used; default <code>k = 2</code>
is the classical AIC.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_type">type</code></td>
<td>
<p>(<code>string</code>)<br /> unscaled (<code>response</code>), <code>pearson</code> or <code>normalized</code>. Default is <code>response</code>,
and this is the only type available for use with models with a spatial covariance structure.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_seed">seed</code></td>
<td>
<p>unused argument from <code><a href="stats.html#topic+simulate">stats::simulate()</a></code>.</p>
</td></tr>
<tr><td><code id="mmrm_tmb_methods_+3A_method">method</code></td>
<td>
<p>(<code>string</code>)<br /> simulation method to use. If &quot;conditional&quot;,
simulated values are sampled given the estimated covariance matrix of <code>object</code>.
If &quot;marginal&quot;, the variance of the estimated covariance matrix is taken into account.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>include</code> argument controls the variables the returned model frame will include.
Possible options are &quot;response_var&quot;, &quot;subject_var&quot;, &quot;visit_var&quot; and &quot;group_var&quot;, representing the
response variable, subject variable, visit variable or group variable.
<code>character</code> values in new data will always be factorized according to the data in the fit
to avoid mismatched in levels or issues in <code>model.matrix</code>.
</p>


<h3>Value</h3>

<p>Depends on the method, see Functions.
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>coef(mmrm_tmb)</code>: obtains the estimated coefficients.
</p>
</li>
<li> <p><code>fitted(mmrm_tmb)</code>: obtains the fitted values.
</p>
</li>
<li> <p><code>predict(mmrm_tmb)</code>: predict conditional means for new data;
optionally with standard errors and confidence or prediction intervals.
Returns a vector of predictions if <code>se.fit == FALSE</code> and
<code>interval == "none"</code>; otherwise it returns a data.frame with multiple
columns and one row per input data row.
</p>
</li>
<li> <p><code>model.frame(mmrm_tmb)</code>: obtains the model frame.
</p>
</li>
<li> <p><code>model.matrix(mmrm_tmb)</code>: obtains the model matrix.
</p>
</li>
<li> <p><code>terms(mmrm_tmb)</code>: obtains the terms object.
</p>
</li>
<li> <p><code>logLik(mmrm_tmb)</code>: obtains the attained log likelihood value.
</p>
</li>
<li> <p><code>formula(mmrm_tmb)</code>: obtains the used formula.
</p>
</li>
<li> <p><code>vcov(mmrm_tmb)</code>: obtains the variance-covariance matrix estimate
for the coefficients.
</p>
</li>
<li> <p><code>VarCorr(mmrm_tmb)</code>: obtains the variance-covariance matrix estimate
for the residuals.
</p>
</li>
<li> <p><code>deviance(mmrm_tmb)</code>: obtains the deviance, which is defined here
as twice the negative log likelihood, which can either be integrated
over the coefficients for REML fits or the usual one for ML fits.
</p>
</li>
<li> <p><code>AIC(mmrm_tmb)</code>: obtains the Akaike Information Criterion,
where the degrees of freedom are the number of variance parameters (<code>n_theta</code>).
If <code>corrected</code>, then this is multiplied with <code>m / (m - n_theta - 1)</code> where
<code>m</code> is the number of observations minus the number of coefficients, or
<code>n_theta + 2</code> if it is smaller than that (Hurvich and Tsai 1989; Burnham and Anderson 1998).
</p>
</li>
<li> <p><code>BIC(mmrm_tmb)</code>: obtains the Bayesian Information Criterion,
which is using the natural logarithm of the number of subjects for the
penalty parameter <code>k</code>.
</p>
</li>
<li> <p><code>print(mmrm_tmb)</code>: prints the object.
</p>
</li>
<li> <p><code>residuals(mmrm_tmb)</code>: to obtain residuals - either unscaled ('response'), 'pearson' or 'normalized'.
</p>
</li>
<li> <p><code>simulate(mmrm_tmb)</code>: simulate responses from a fitted model according
to the simulation <code>method</code>, returning a <code>data.frame</code> of dimension <code style="white-space: pre;">&#8288;[n, m]&#8288;</code>
where n is the number of rows in <code>newdata</code>,
and m is the number <code>nsim</code> of simulated responses.
</p>
</li></ul>


<h3>References</h3>


<ul>
<li> <p>Hurvich CM, Tsai C (1989).
&ldquo;Regression and time series model selection in small samples.&rdquo;
<em>Biometrika</em>, <b>76</b>(2), 297&ndash;307.
<a href="https://doi.org/10.2307/2336663">doi:10.2307/2336663</a>.
</p>
</li>
<li> <p>Burnham KP, Anderson DR (1998).
&ldquo;Practical use of the information-theoretic approach.&rdquo;
In <em>Model selection and inference</em>, 75&ndash;117.
Springer.
<a href="https://doi.org/10.1007/978-1-4757-2917-7_3">doi:10.1007/978-1-4757-2917-7_3</a>.
</p>
</li></ul>


<ul>
<li> <p>Gałecki A, Burzykowski T (2013).
&ldquo;Linear mixed-effects model.&rdquo;
In <em>Linear mixed-effects models using R</em>, 245&ndash;273.
Springer.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+mmrm_methods">mmrm_methods</a></code>, <code><a href="#topic+mmrm_tidiers">mmrm_tidiers</a></code> for additional methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>formula &lt;- FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID)
object &lt;- fit_mmrm(formula, fev_data, weights = rep(1, nrow(fev_data)))
# Estimated coefficients:
coef(object)
# Fitted values:
fitted(object)
predict(object, newdata = fev_data)
# Model frame:
model.frame(object)
model.frame(object, include = "subject_var")
# Model matrix:
model.matrix(object)
# terms:
terms(object)
terms(object, include = "subject_var")
# Log likelihood given the estimated parameters:
logLik(object)
# Formula which was used:
formula(object)
# Variance-covariance matrix estimate for coefficients:
vcov(object)
# Variance-covariance matrix estimate for residuals:
VarCorr(object)
# REML criterion (twice the negative log likelihood):
deviance(object)
# AIC:
AIC(object)
AIC(object, corrected = TRUE)
# BIC:
BIC(object)
# residuals:
residuals(object, type = "response")
residuals(object, type = "pearson")
residuals(object, type = "normalized")
</code></pre>

<hr>
<h2 id='parsnip_add_mmrm'>Register <code>mmrm</code> For Use With <code>tidymodels</code></h2><span id='topic+parsnip_add_mmrm'></span>

<h3>Description</h3>

<p>Register <code>mmrm</code> For Use With <code>tidymodels</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parsnip_add_mmrm(quietly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parsnip_add_mmrm_+3A_quietly">quietly</code></td>
<td>
<p>logical: should progress and error messages be suppressed?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We can use <code>parsnip::show_model_info("linear_reg")</code> to check the
registration with <code>parsnip</code> and thus the wider <code>tidymodels</code> ecosystem.
</p>


<h3>Value</h3>

<p>A logical value indicating whether registration was successful.
</p>

<hr>
<h2 id='position_symbol'>Search For the Position of a Symbol</h2><span id='topic+position_symbol'></span>

<h3>Description</h3>

<p>A thin wrapper around <code><a href="base.html#topic+funprog">base::Position()</a></code> to search through a list of language
objects, as produced by <code><a href="#topic+flatten_call">flatten_call()</a></code> or <code><a href="#topic+flatten_expr">flatten_expr()</a></code>, for the
presence of a specific symbol.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>position_symbol(x, sym, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="position_symbol_+3A_x">x</code></td>
<td>
<p>(<code>list</code> of <code>language</code>)<br /> a list of language objects in which to
search for a specific symbol.</p>
</td></tr>
<tr><td><code id="position_symbol_+3A_sym">sym</code></td>
<td>
<p>(<code>name</code> or <code>symbol</code> or <code>character</code>)<br /> a symbol to search for in
<code>x</code>.</p>
</td></tr>
<tr><td><code id="position_symbol_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code>Position()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The position of the symbol if found, or the <code>nomatch</code> value
otherwise.
</p>

<hr>
<h2 id='print.cov_struct'>Print a Covariance Structure Object</h2><span id='topic+print.cov_struct'></span>

<h3>Description</h3>

<p>Print a Covariance Structure Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cov_struct'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cov_struct_+3A_x">x</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure object.</p>
</td></tr>
<tr><td><code id="print.cov_struct_+3A_...">...</code></td>
<td>
<p>Additional arguments unused.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> invisibly.
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+tidy'></span><span id='topic+glance'></span><span id='topic+augment'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+augment">augment</a></code>, <code><a href="generics.html#topic+glance">glance</a></code>, <code><a href="generics.html#topic+tidy">tidy</a></code></p>
</dd>
</dl>

<hr>
<h2 id='refit_multiple_optimizers'>Refitting MMRM with Multiple Optimizers</h2><span id='topic+refit_multiple_optimizers'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refit_multiple_optimizers(fit, ..., control = mmrm_control(...))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="refit_multiple_optimizers_+3A_fit">fit</code></td>
<td>
<p>(<code>mmrm_fit</code>)<br /> original model fit from <code><a href="#topic+fit_single_optimizer">fit_single_optimizer()</a></code>.</p>
</td></tr>
<tr><td><code id="refit_multiple_optimizers_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+mmrm_control">mmrm_control()</a></code>.</p>
</td></tr>
<tr><td><code id="refit_multiple_optimizers_+3A_control">control</code></td>
<td>
<p>(<code>mmrm_control</code>)<br /> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The best (in terms of log likelihood) fit which converged.
</p>


<h3>Note</h3>

<p>For Windows, no parallel computations are currently implemented.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit &lt;- fit_single_optimizer(
  formula = FEV1 ~ RACE + SEX + ARMCD * AVISIT + us(AVISIT | USUBJID),
  data = fev_data,
  weights = rep(1, nrow(fev_data)),
  optimizer = "nlminb"
)
best_fit &lt;- refit_multiple_optimizers(fit)
</code></pre>

<hr>
<h2 id='register_on_load'>Helper Function for Registering Functionality With Suggests Packages</h2><span id='topic+register_on_load'></span>

<h3>Description</h3>

<p>Helper Function for Registering Functionality With Suggests Packages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>register_on_load(
  pkg,
  ver = c(NA_character_, NA_character_),
  callback,
  message = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="register_on_load_+3A_pkg">pkg</code></td>
<td>
<p>(<code>string</code>)<br /> package name.</p>
</td></tr>
<tr><td><code id="register_on_load_+3A_ver">ver</code></td>
<td>
<p>(<code>character</code>)<br /> of length 2 whose elements can be provided to
<code><a href="base.html#topic+numeric_version">numeric_version()</a></code>, representing a minimum and maximum (inclusive) version
requirement for interoperability. When <code>NA</code>, no version requirement is
imposed. Defaults to no version requirement.</p>
</td></tr>
<tr><td><code id="register_on_load_+3A_callback">callback</code></td>
<td>
<p>(<code>function(...) ANY</code>)<br /> a callback to execute upon package
load. Note that no arguments are passed to this function. Any necessary
data must be provided upon construction.</p>
</td></tr>
<tr><td><code id="register_on_load_+3A_message">message</code></td>
<td>
<p>(<code>NULL</code> or <code>string</code>)<br /> an optional message to print after
the callback is executed upon successful registration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A logical (invisibly) indicating whether registration was successful.
If not, a onLoad hook was set for the next time the package is loaded.
</p>

<hr>
<h2 id='std_start'>Standard Starting Value</h2><span id='topic+std_start'></span>

<h3>Description</h3>

<p>Obtain standard start values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>std_start(cov_type, n_visits, n_groups, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="std_start_+3A_cov_type">cov_type</code></td>
<td>
<p>(<code>string</code>)<br /> name of the covariance structure.</p>
</td></tr>
<tr><td><code id="std_start_+3A_n_visits">n_visits</code></td>
<td>
<p>(<code>int</code>)<br /> number of visits.</p>
</td></tr>
<tr><td><code id="std_start_+3A_n_groups">n_groups</code></td>
<td>
<p>(<code>int</code>)<br /> number of groups.</p>
</td></tr>
<tr><td><code id="std_start_+3A_...">...</code></td>
<td>
<p>not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>std_start</code> will try to provide variance parameter from identity matrix.
However, for <code>ar1</code> and <code>ar1h</code> the corresponding values are not ideal because the
<code class="reqn">\rho</code> is usually a positive number thus using 0 as starting value can lead to
incorrect optimization result, and we use 0.5 as the initial value of <code class="reqn">\rho</code>.
</p>


<h3>Value</h3>

<p>A numeric vector of starting values.
</p>

<hr>
<h2 id='tmb_cov_type'>Produce A Covariance Identifier Passing to TMB</h2><span id='topic+tmb_cov_type'></span>

<h3>Description</h3>

<p>Produce A Covariance Identifier Passing to TMB
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmb_cov_type(cov)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tmb_cov_type_+3A_cov">cov</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string used for method dispatch when passed to TMB.
</p>

<hr>
<h2 id='validate_cov_struct'>Validate Covariance Structure Data</h2><span id='topic+validate_cov_struct'></span>

<h3>Description</h3>

<p>Run checks against relational integrity of covariance definition
</p>


<h3>Usage</h3>

<pre><code class='language-R'>validate_cov_struct(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="validate_cov_struct_+3A_x">x</code></td>
<td>
<p>(<code>cov_struct</code>)<br /> a covariance structure object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> if successful, or an error is thrown otherwise.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
