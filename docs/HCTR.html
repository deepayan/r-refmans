<!DOCTYPE html><html lang="en"><head><title>Help for package HCTR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HCTR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bounding.seq'><p>Bounding Sequence</p></a></li>
<li><a href='#est.lambda'><p>Estimated Lambda</p></a></li>
<li><a href='#est.prop'><p>Proportion Estimation</p></a></li>
<li><a href='#final.selection'><p>Final Selection</p></a></li>
<li><a href='#highdim.p'><p>p-values in high-dimensional linear model</p></a></li>
<li><a href='#multi.adlasso'><p>Multi-split Adaptive Lasso</p></a></li>
<li><a href='#multi.lasso'><p>Multi-split Lasso</p></a></li>
<li><a href='#multi.mcp'><p>Multi-split MCP</p></a></li>
<li><a href='#multi.scad'><p>Multi-split SCAD</p></a></li>
<li><a href='#pmpv'><p>Permutation p-values</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Higher Criticism Tuned Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A novel searching scheme for tuning parameter in high-dimensional 
             penalized regression. We propose a new estimate of the regularization
             parameter based on an estimated lower bound of the proportion of false 
             null hypotheses (Meinshausen and Rice (2006) &lt;<a href="https://doi.org/10.1214%2F009053605000000741">doi:10.1214/009053605000000741</a>&gt;).
             The bound is estimated by applying the empirical null distribution of the higher 
             criticism statistic, a second-level significance testing, which is constructed
             by dependent p-values from a multi-split regression and aggregation method
             (Jeng, Zhang and Tzeng (2019) &lt;<a href="https://doi.org/10.1080%2F01621459.2018.1518236">doi:10.1080/01621459.2018.1518236</a>&gt;). An estimate 
             of tuning parameter in penalized regression is decided corresponding to the lower 
             bound of the proportion of false null hypotheses. Different penalized 
             regression methods are provided in the multi-split algorithm. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet (&ge; 2.0-18), harmonicmeanp (&ge; 3.0), MASS, ncvreg (&ge;
3.11-1), Rdpack (&ge; 0.11-0), stats</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-11-22 21:26:00 UTC; tjiang8</td>
</tr>
<tr>
<td>Author:</td>
<td>Tao Jiang [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Tao Jiang &lt;tjiang8@ncsu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-11-22 21:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='bounding.seq'>Bounding Sequence</h2><span id='topic+bounding.seq'></span>

<h3>Description</h3>

<p>Calculates bounding sequence of higher crticism for proportion estimator using p-values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bounding.seq(p.value, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bounding.seq_+3A_p.value">p.value</code></td>
<td>
<p>A matrix of p-values from permutation: row is from each permutation; column is from each variable.</p>
</td></tr>
<tr><td><code id="bounding.seq_+3A_alpha">alpha</code></td>
<td>
<p>Probability of Type I error for bounding sequence, the default value is 1 / sqrt(log(p)), where p is number of p-values in each permutation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A bounding value of higher criticism with (1 - alpha) confidence.
</p>


<h3>References</h3>

<p>Jeng XJ, Zhang T, Tzeng J (2019).
&ldquo;Efficient Signal Inclusion With Genomic Applications.&rdquo;
<em>Journal of the American Statistical Association</em>, 1&ndash;23.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(runif(n = 10000, min = 0, max = 1), nrow = 100)
result &lt;- bounding.seq(p.value = X)

</code></pre>

<hr>
<h2 id='est.lambda'>Estimated Lambda</h2><span id='topic+est.lambda'></span>

<h3>Description</h3>

<p>Estimate upper and lower bound of new tuning region of regularization parameter Lambda.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.lambda(cv.fit, pihat, p, cov.num = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est.lambda_+3A_cv.fit">cv.fit</code></td>
<td>
<p>An object of either class &quot;cv.glmnet&quot; from glmnet::cv.glmnet() or class &quot;cv.ncvreg&quot; from ncvreg::cv.ncvreg(), which is a list generated by a cross-validation fit.</p>
</td></tr>
<tr><td><code id="est.lambda_+3A_pihat">pihat</code></td>
<td>
<p>eatimated proprtion from HCTR::est.prop().</p>
</td></tr>
<tr><td><code id="est.lambda_+3A_p">p</code></td>
<td>
<p>Total number of variables, except for covariates.</p>
</td></tr>
<tr><td><code id="est.lambda_+3A_cov.num">cov.num</code></td>
<td>
<p>Number of covariates in model, default is 0. Covariate matrix, W, is assumed on the left side of variable matrix, X. The column index of covariates are before those of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of (1) lambda.max, upper bound of new tuning region; (2) lambda.min, lower bound of new tuning region.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(rnorm(20000), nrow = 100)
beta &lt;- rep(0, 200)
beta[1:100] &lt;- 5
Y &lt;- MASS::mvrnorm(n = 1, mu = X%*%beta, Sigma = diag(100))
fit &lt;- glmnet::cv.glmnet(x = X, y = Y)
pihat &lt;- 0.01
result &lt;- est.lambda(cv.fit = fit, pihat = pihat, p = ncol(X))
</code></pre>

<hr>
<h2 id='est.prop'>Proportion Estimation</h2><span id='topic+est.prop'></span>

<h3>Description</h3>

<p>Estimates false null hypothesis Proportion from multiple p-values using higher criticism test estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.prop(p.value, cn, adj = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est.prop_+3A_p.value">p.value</code></td>
<td>
<p>A sequence of p-values from test data, not including p-values from covariates.</p>
</td></tr>
<tr><td><code id="est.prop_+3A_cn">cn</code></td>
<td>
<p>A value of bounding sequence generated by HCTR::bounding.seq().</p>
</td></tr>
<tr><td><code id="est.prop_+3A_adj">adj</code></td>
<td>
<p>A boolean algebra to decide whether to use adjusted Higher Criticism test statistic, the default value is TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An estimated proportion of false null hypothesis.
</p>


<h3>References</h3>

<p>Meinshausen N, Rice J (2006).
&ldquo;Estimating the proportion of false null hypotheses among a large number of independently tested hypotheses.&rdquo;
<em>The Annals of Statistics</em>, <b>34</b>(1), 373&ndash;393.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(runif(n = 10000, min = 0, max = 1), nrow = 100)
result &lt;- bounding.seq(p.value = X)
Y &lt;- matrix(runif(n = 100, min = 0, max = 1), nrow = 100)
test &lt;- est.prop(p.value = Y, cn = result)

</code></pre>

<hr>
<h2 id='final.selection'>Final Selection</h2><span id='topic+final.selection'></span>

<h3>Description</h3>

<p>Returns the index of final selected variables in the final chosen model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>final.selection(cv.fit, pihat, p, cov.num = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="final.selection_+3A_cv.fit">cv.fit</code></td>
<td>
<p>An object of either class &quot;cv.glmnet&quot; from glmnet::cv.glmnet() or class &quot;cv.ncvreg&quot; from ncvreg::cv.ncvreg(), which is a list generated by a cross-validation fit.</p>
</td></tr>
<tr><td><code id="final.selection_+3A_pihat">pihat</code></td>
<td>
<p>eatimated proprtion from HCTR::est.prop().</p>
</td></tr>
<tr><td><code id="final.selection_+3A_p">p</code></td>
<td>
<p>Total number of variables, except for covariates.</p>
</td></tr>
<tr><td><code id="final.selection_+3A_cov.num">cov.num</code></td>
<td>
<p>Number of covariates in model, default is 0. Covariate matrix, W, is assumed on the left side of variable matrix, X. The column index of covariates are before those of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A sequence of index of final selected variables in the final chosen model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(rnorm(20000), nrow = 100)
beta &lt;- rep(0, 200)
beta[1:100] &lt;- 5
Y &lt;- MASS::mvrnorm(n = 1, mu = X%*%beta, Sigma = diag(100))
fit &lt;- glmnet::cv.glmnet(x = X, y = Y)
pihat &lt;- 0.01
result &lt;- est.lambda(cv.fit = fit, pihat = pihat, p = ncol(X))
lambda.seq &lt;- seq(from = result$lambda.min, to = result$lambda.max, length.out = 100)
# Note: The lambda sequences in glmnet and ncvreg are diffrent.
fit2 &lt;- glmnet::cv.glmnet(x = X, y = Y, lambda = lambda.seq)
result2 &lt;- final.selection(cv.fit = fit2, pihat = 0.01, p = ncol(X))
</code></pre>

<hr>
<h2 id='highdim.p'>p-values in high-dimensional linear model</h2><span id='topic+highdim.p'></span>

<h3>Description</h3>

<p>Calculates p-values in high-dimentional linear models using multi-split method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>highdim.p(Y, X, W = NULL, type, B = 100, fold.num)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="highdim.p_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="highdim.p_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="highdim.p_+3A_w">W</code></td>
<td>
<p>A covariate matrix, of dimension nobs x ncors, default is NULL.</p>
</td></tr>
<tr><td><code id="highdim.p_+3A_type">type</code></td>
<td>
<p>Penalized regression type, valid parameters include &quot;Lasso&quot;, &quot;AdaLasso&quot;, &quot;SCAD&quot;, and &quot;MCP&quot;.</p>
</td></tr>
<tr><td><code id="highdim.p_+3A_b">B</code></td>
<td>
<p>Multi-split times, default is 100.</p>
</td></tr>
<tr><td><code id="highdim.p_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of objects containing: (1) harmonic mean p-values; (2) original p-values; (3) index of selected samples; (4) index of selected variables
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(rnorm(20000), nrow = 100)
beta &lt;- rep(0, 200)
beta[1:100] &lt;- 5
Y &lt;- MASS::mvrnorm(n = 1, mu = X%*%beta, Sigma = diag(100))
result &lt;- highdim.p(Y=Y, X=X, type = "Lasso", B = 2, fold.num = 10)
</code></pre>

<hr>
<h2 id='multi.adlasso'>Multi-split Adaptive Lasso</h2><span id='topic+multi.adlasso'></span>

<h3>Description</h3>

<p>Multi-splitted variable selection using Adaptive Lasso
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.adlasso(X, Y, covar.num = NULL, fold.num)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi.adlasso_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="multi.adlasso_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="multi.adlasso_+3A_covar.num">covar.num</code></td>
<td>
<p>Number of covariates in model, default is NULL.</p>
</td></tr>
<tr><td><code id="multi.adlasso_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric objects of index of (1) selected and (2) unselected variables.
</p>

<hr>
<h2 id='multi.lasso'>Multi-split Lasso</h2><span id='topic+multi.lasso'></span>

<h3>Description</h3>

<p>Multi-splitted variable selection using Lasso
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.lasso(X, Y, p.fac = NULL, fold.num)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi.lasso_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="multi.lasso_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="multi.lasso_+3A_p.fac">p.fac</code></td>
<td>
<p>A sequence of penalty factor applied on each variable.</p>
</td></tr>
<tr><td><code id="multi.lasso_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric objects of index of (1) selected and (2) unselected variables.
</p>

<hr>
<h2 id='multi.mcp'>Multi-split MCP</h2><span id='topic+multi.mcp'></span>

<h3>Description</h3>

<p>Multi-splitted variable selection using MCP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.mcp(X, Y, p.fac = NULL, fold.num)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi.mcp_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="multi.mcp_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="multi.mcp_+3A_p.fac">p.fac</code></td>
<td>
<p>A sequence of penalty factor applied on each variable.</p>
</td></tr>
<tr><td><code id="multi.mcp_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric objects of index of (1) selected and (2) unselected variables.
</p>

<hr>
<h2 id='multi.scad'>Multi-split SCAD</h2><span id='topic+multi.scad'></span>

<h3>Description</h3>

<p>Multi-splitted variable selection using SCAD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.scad(X, Y, p.fac = NULL, fold.num)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multi.scad_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="multi.scad_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="multi.scad_+3A_p.fac">p.fac</code></td>
<td>
<p>A sequence of penalty factor applied on each variable.</p>
</td></tr>
<tr><td><code id="multi.scad_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of two numeric objects of index of (1) selected and (2) unselected variables.
</p>

<hr>
<h2 id='pmpv'>Permutation p-values</h2><span id='topic+pmpv'></span>

<h3>Description</h3>

<p>Calculates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pmpv(Y, X, W = NULL, type, B = 100, fold.num = 10, perm.num = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pmpv_+3A_y">Y</code></td>
<td>
<p>A numeric response vector, containing nobs variables.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_x">X</code></td>
<td>
<p>An input matrix, of dimension nobs x nvars.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_w">W</code></td>
<td>
<p>A covariate matrix, of dimension nobs x ncors, default is NULL.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_type">type</code></td>
<td>
<p>Penalized regression type, valid parameters include &quot;Lasso&quot;, &quot;AdaLasso&quot;, &quot;SCAD&quot;, and &quot;MCP&quot;.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_b">B</code></td>
<td>
<p>Multi-split times, default is 100.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_fold.num">fold.num</code></td>
<td>
<p>The number of cross validation folds, default is 10.</p>
</td></tr>
<tr><td><code id="pmpv_+3A_perm.num">perm.num</code></td>
<td>
<p>Permutation times, default is 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix containing harmonic mean p-values from permutation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(10)
X &lt;- matrix(rnorm(20000), nrow = 100)
beta &lt;- rep(0, 200)
beta[1:100] &lt;- 5
Y &lt;- MASS::mvrnorm(n = 1, mu = X%*%beta, Sigma = diag(100))
result &lt;- pmpv(Y=Y, X=X, type = "Lasso", B = 2, fold.num = 10, perm.num = 10)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
