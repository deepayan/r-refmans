<!DOCTYPE html><html><head><title>Help for package CatDyn</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CatDyn}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.CatDynData'>
<p>Data Object for the Estimation of Catch Dynamic Models</p></a></li>
<li><a href='#catdyn'>
<p>Class Attribute of Numerically Fit CatDyn Model Objects</p></a></li>
<li><a href='#CatDyn-package'>
<p>Fisheries Stock Assessment by Generalized Depletion (Catch Dynamics) Models</p></a></li>
<li><a href='#CatDynBSD'>
<p>Calculate Annual Biomass and its Standard Error</p></a></li>
<li><a href='#CatDynCor'>
<p>Correlation Plot Among Parameter Estimates</p></a></li>
<li><a href='#CatDynData'>
<p>Class Attribute of CatDyn Data Object</p></a></li>
<li><a href='#catdynexp'>
<p>Exploratory Evaluation of Initial Values of CatDyn Models</p></a></li>
<li><a href='#CatDynExp'>
<p>Class Attribute of Exploratory Analysis Object</p></a></li>
<li><a href='#CatDynFit'>
<p>Fit CatDyn Models by Maximum Likelihood</p></a></li>
<li><a href='#CatDynMod'>
<p>Class Attribute of Model Output Object</p></a></li>
<li><a href='#CatDynPar'>
<p>Table of Parameter Estimates and Coefficients of Variation</p></a></li>
<li><a href='#CatDynPred'>
<p>Predictions from a Generalized Depletion (Catch Dynamics) Model</p></a></li>
<li><a href='#CatDynSum'>
<p>Summary Table for Generalized Depletion (Catch Dynamics) Model Comparison</p></a></li>
<li><a href='#cor2cov'>
<p>Correlation Matrix to Covariance Matrix Conversion</p></a></li>
<li><a href='#deltamethod'>
<p>First-order Taylor Series Expansion of Functions of Random Variables</p></a></li>
<li><a href='#gayhake'>
<p>Industrial and Artisanal Catch and Effort Data from the Chilean Hake Fishery</p></a></li>
<li><a href='#gayhakelm'>
<p>Length and Month data of Chilean hake from Artisanal Fishery</p></a></li>
<li><a href='#gayhakelw'>
<p>Length and Weight data of Chilean hake from Artisanal Fishery</p></a></li>
<li><a href='#lolgahi'>
<p>Industrial Trawling Data from the Squid Fishery of the Falkland Islands</p></a></li>
<li><a href='#m.hoenig'>
<p>Marine animals natural mortality and longevity database</p></a></li>
<li><a href='#M.Hoenig'>
<p>Estimate natural mortality rate from longevity data</p></a></li>
<li><a href='#mobw.kg'>
<p>Mean body weight per month</p></a></li>
<li><a href='#plot.CatDynData'>
<p>Exploratory Analysis of Catch and Effort Fisheries Data</p></a></li>
<li><a href='#plot.CatDynExp'>
<p>Exploratory Modeling of Fisheries with Catch Dynamic (generalized depletion) Models</p></a></li>
<li><a href='#plot.CatDynMod'>
<p>Examination of Results from Fitting Catch Dynamic Models</p></a></li>
<li><a href='#twelver'>
<p>Sport Fishing for Eel Juveniles in Taiwan</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fishery Stock Assessment by Catch Dynamics Models</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-12-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Ruben H. Roa-Ureta</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ruben H. Roa-Ureta &lt;ruben.roa.ureta@mail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>optimx (&ge; 2013.8.6), BB</td>
</tr>
<tr>
<td>Description:</td>
<td>Based on fishery Catch Dynamics instead of fish Population Dynamics (hence CatDyn) and using high-frequency or medium-frequency catch in biomass or numbers, fishing nominal effort, and mean fish body weight by time step, from one or two fishing fleets, estimate stock abundance, natural mortality rate, and fishing operational parameters. It includes methods for data organization, plotting standard exploratory and analytical plots, predictions, for 100 types of models of increasing complexity, and 72 likelihood models for the data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-12-25 05:59:35 UTC; Rubin</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-01-02 12:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.CatDynData'>
Data Object for the Estimation of Catch Dynamic Models
</h2><span id='topic+as.CatDynData'></span>

<h3>Description</h3>

<p>It takes the vectors of catch, effort, and mean body weight from a dataframe and 
creates an object of class CatDynData. Objects of this class are lists with two 
components, one for properties of the data such as units and another for the data: 
catch, effort, mean body weight by fleet, and the catch spike statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.CatDynData(x, step, fleet.name, coleff, colcat, colmbw, 
              unitseff, unitscat, unitsmbw, nmult, season.dates)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.CatDynData_+3A_x">x</code></td>
<td>

<p>A dataframe where to find the columns of catch, effort, and mean body weight
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_step">step</code></td>
<td>

<p>Character. The time step of the dynamics, either &quot;day&quot;, &quot;week&quot;, or &quot;month&quot;.
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_fleet.name">fleet.name</code></td>
<td>

<p>Character. The name of the fleet(s). 
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_coleff">coleff</code></td>
<td>

<p>Integer. The column(s) in &quot;x&quot; where to find the effort data. 
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_colcat">colcat</code></td>
<td>

<p>Integer. The column(s) in &quot;x&quot; where to find the catch data. 
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_colmbw">colmbw</code></td>
<td>

<p>Integer. The column(s) in &quot;x&quot; where to find the mean body weight data.
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_unitseff">unitseff</code></td>
<td>

<p>Character. The unit(s) of effort.
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_unitscat">unitscat</code></td>
<td>

<p>Character. The unit of catch. Either &quot;ton&quot; (metric tonnes), &quot;kg&quot;, or &quot;ind&quot; 
(individuals).
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_unitsmbw">unitsmbw</code></td>
<td>

<p>Character. The unit of body weight. Either &quot;kg&quot;, &quot;g&quot;, or &quot;ind&quot; (individuals).
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_nmult">nmult</code></td>
<td>

<p>Character. The multiplier that scales the catch in numbers. Either &quot;bill&quot; 
(billions), &quot;mill&quot; (millions), &quot;thou&quot; (thousands), or &quot;ind&quot; (individuals).
</p>
</td></tr>
<tr><td><code id="as.CatDynData_+3A_season.dates">season.dates</code></td>
<td>

<p>Character vector. A two component character vector with the initial and final 
dates of the season in the ISO 8601 standard.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time step determines the rows of x. Make it sure that the number of rows,
i.e. the length of the season in time steps, is large enough to estimate all 
parameters in the model. The simplest model has five parameters, the most complex 
model has 50 parameters. A rule of thumb would be that the number of time steps 
be at least three times the number of parameters. 
</p>
<p>If it is a two fleet system, combine the fleet names, such as c(&quot;industrial&quot;, 
&quot;artisanal&quot;), and likewise with coleff, colcat, and colmbw, such as c(5,9) to 
indicate the columns of catch for the industrial and artisanal fleets respectively. 
The same applies to units of effort. In a two fleet system, the time step, and 
the units of catch, mean body weight, and the multiplier must be the same for both 
fleets. 
</p>
<p>When the unit of catch and of body weight is &quot;ind&quot;, it means that the catch was 
counted in numbers, not in biomass. In that case the mandatory column of mean body 
weight should be a column of 1s. The multiplier is the quantity by which the catch 
in the model shall be raised to be scaled to the actual catch. The idea here is 
that in many fisheries the daily, weekly, or monthly catch (for example, anchovies, 
squids) is very large so by setting the multiplier to &quot;bill&quot;, &quot;mill&quot;, or &quot;thou&quot;, 
the model is working with catches in the orders of tens at most. If the multiplier 
is set to &quot;ind&quot; then the catch is modeled at the level of the actual catch by time 
step. This option is useful for sport fisheries, in combination with the poisson
or negbin option for distribution.
</p>
<p>The season.dates parameter will allow counting the number of steps in integer
sequential fashion. If the &quot;time.step&quot; parameter is &quot;day&quot; or &quot;week&quot; the dates may 
jump one year at most, whereas if the time.step parameter is &quot;month&quot; then
season.dates may jump over many years. When the time step is week or months,
this parameter needs not be precisely specified; any day within the right week 
or month will suffice. If you get an error message saying that the number of time 
steps is not right and that you should consider changing season.dates, then just
change the dates a few days until you no longer get the error message.
</p>
<p>The catch spike statistic is a fleet-specific statistic that is useful to identify 
the timing of perturbations to depletion; it is defined as
</p>
<p style="text-align: center;"><code class="reqn">S_{f,t} = 10 \times (X_{f,t}/max(X_{f,t}) - E_{f,t}/max(E_{f,t}))</code>
</p>

<p>where <em>X</em> is the observed catch at time step <em>t</em> by fleet <em>f</em>, and 
<em>E</em> is the observed effort. When this statistic is positive and high then the 
time step at which this happened is a candidate for a perturbation. In transit 
fisheries the complementary reasoning is valid: when the statistic is negative and 
low then the time step at which this happened is a candidate for the timing of one 
emmigration event.
</p>


<h3>Value</h3>

<p>A list of length 2.
</p>
<table>
<tr><td><code>Properties</code></td>
<td>
<p>The units for time step, catch, body weight, and the catch 
numbers multiplier; the names of the fleets and the units of 
effort, and the start date and end date of the fishing season</p>
</td></tr>
<tr><td><code>Data</code></td>
<td>
<p>One dataframe for each fleet with the time step, effort, catch in 
biomass, mean body weight, catch in the numbers multiplier, and the
catch spike statistic</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The objects created with as.CatDynData will pass the raw data to plotting and 
estimating functions.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8), 1403-1415.
</p>
<p>Roa-Ureta, R. H. et al. 2015. Fisheries Research 171 (Special Issue), 59-67.
</p>
<p>Roa-Ureta, R. H. 2015. Fisheries Research 171 (Special Issue), 68-77.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lgahi &lt;- as.CatDynData(x=lolgahi,
                       step="day",
                       fleet.name="Fk",
                       coleff=2,
                       colcat=1,
                       colmbw=3,
                       unitseff="nboats",
                       unitscat="kg",
                       unitsmbw="kg",
                       nmult="bill",
                       season.dates=c(as.Date("1990-01-31"),
                                      as.Date("1990-05-30")))
</code></pre>

<hr>
<h2 id='catdyn'>
Class Attribute of Numerically Fit CatDyn Model Objects
</h2><span id='topic+catdyn'></span>

<h3>Description</h3>

<p>To be used by CatDynPred() to create model results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catdyn(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catdyn_+3A_x">x</code></td>
<td>

<p>A list object coming from the optimization wrapper CatDynFit().
</p>
</td></tr>
<tr><td><code id="catdyn_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class attribute.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDyn-package'>
Fisheries Stock Assessment by Generalized Depletion (Catch Dynamics) Models
</h2><span id='topic+CatDyn-package'></span>

<h3>Description</h3>

<p>Using high-frequency (daily, weekly) or medium frequency (monthly) catch and effort 
data CatDyn implements a type of stock assessment model oriented to the operational 
fishing data. The estimated parameters are in two groups, stock abundance (initial
abundance, episodic pulses of abundance, and natural mortality) and fishing operation
(hyperstability/hyperdepletion, saturability/synergy, catchability). CatDyn includes
100 versions of the models depending on the number of fleets (1 or 2), the number of
perturbations to depletion (1 to 25), whether the stock is resident without emigration,
resident with emigration, or in transit, and 72 likelihood models for the data depending
on the kind of random mechanism(s) assumed to have generated the data. The package has
graphical functions for exploratory analysis (to select reasonable initial values of
parameter to me estimated), it calls the optimx function from package optimx to use
many options for the numerical method to minimize the negative loglikelihood, and
several functions for post-analysis of results to select a best model for the data.
Considering the combinations that can be made with model versions, likelihood options,
and numerical methods, any data set can be fit to hundreds of model varieties making
model selection a substantial part of the stock assessment work.
</p>
<p>Once the best model has been selected, the package also has functions to produce the
input information to fit a population dynamics model in a hierarchical inference
framework. See Roa-Ureta et al. (2015) below.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> CatDyn</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-12-20</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Create a data object using raw data and the as.CatDynData() function.
Examine the data for regularities and perturbations using the generic plot()
function on an object of class CatDynData.
Examine the goodness of initial parameter values before statistical inference
by using the catdynexp() exploratory prediction function and the plot
generic function on an object of class CatDynExp.
Fit the model to the data by using the wrapper function CatDynFit(), which in turn
will call the optimx() optimizer wrapper of package optimx, with several 
numerical methods available to be used.
Examine the quality of the fit with the plot() function on an object of class
CatDynMod created by the CatDynPred() function.
Compare different models fit to the data with CatDynSum(), CatDynCor(), and
CatDynPar(), based on information theoretic, statistical, and numerical criteria.
Create the input file for further population dynamics modeling with CatDynBSD().
</p>
<p>The process equations in the Catch Dynamics Models in this package are of the form
</p>
<p style="text-align: center;"><code class="reqn">C_t = k e^{-M/2} E^{a}_{t} N^{b}_{t}</code>
</p>

<p>whith versions for resident stock without emigration
</p>
<p style="text-align: center;"><code class="reqn">N_{t}=N_0 e^{-Mt}-e^{M/2}\sum_{i&lt;t} C_{t-1} e^{-M(t-i-1)}+\sum_{j}R_{j} e^{-M(t-j)}</code>
</p>

<p>resident stock with emigration
</p>
<p style="text-align: center;"><code class="reqn">N_{t}=N_0 e^{-Mt}-e^{M/2}\sum_{i&lt;t} C_{t-1} e^{-M(t-i-1)}+\sum_{j}R_{j} e^{-M(t-v_j)}-\sum_{l}S_{l} e^{-M(t-w_l)}</code>
</p>

<p>and stock in transit through the fishing grounds
</p>
<p style="text-align: center;"><code class="reqn">N_{t}=N_0 e^{-Mt}-e^{M/2}\sum_{i&lt;t} C_{t-1} e^{-M(t-i-1)}+\sum_{j}I_j R_{j} e^{-M(t-v_j)}-\sum_{l}J_j R_{j} e^{-M(t-w_j)}</code>
</p>

<p>where <em>C</em> is the observed catch in numbers, a random variable, <em>t</em>,
<em>i</em>, <em>l</em>, are time step indicators, <em>j</em>
is perturbation index (<em>j</em>=1,2,...,25), <em>k</em> is a scaling constant, <em>E</em> is
nominal fishing effort, a predictor of catch observed exactly, <em>a</em> is a parameter of effort
synergy or saturability, <em>N</em> is abundance, a latent predictor of catch, <em>b</em> is
a parameter of hyperstability or hyperdepletion, <em>M</em> is natural mortality rate
per time step, <em>I</em> and <em>J</em> are indicator variables, taking values of 0 before
<em>v</em> and 1 after, before <em>w</em> and 1 after, respectively. The second summand of the expanded
latent predictor is a discount applied to the earlier catches in order to avoid an
<em>M</em>-biased estimate of initial abundance.
</p>
<p>Positive perturbations to depletion represent fish migrations into the fishing grounds or expansions
of the fishing grounds by the fleet(s) resulting in point pulses of abundance. Negative perturbations
represente emigration of parts of the stock (resident stock with emigration above) or the totality
of a recruitment wave (transit stock above).
</p>
<p>In 2 fleet cases the fleets contribute complementary information about stock abundance, and
thus operate additively; any interaction between the fleets is latent and affects the 
estimated values of fleet dependent parameters, such as <em>k</em>, <em>a</em>, and <em>b</em>.
</p>
<p>The catch observation model can take any of the following forms: a Poisson counts process or a
negative binomial counts process for catch recorded in numbers, an additive random normal 
term added to the continuous catch (in weight) predicted by the process (normal and adjusted 
profile normal), a multiplicative exponential term acting on the process-predicted catch such 
as the logarithm of this multiplier distributes normally (lognormal, adjusted profile
lognornmal, and robust lognormal), Gamma (shape and scale parameterization), and Gumbel.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta &lt;ruben.roa.ureta@mail.com&gt; (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8), 1403-1415.
</p>
<p>Roa-Ureta, R. H. et al. 2015. Fisheries Research 171 (Special Issue), 59-67.
</p>
<p>Roa-Ureta, R. H. 2015. Fisheries Research 171 (Special Issue), 68-77.
</p>
<p>Lin, Y-J. et al. 2017. Fisheries Research 195, 130-140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit()
</code></pre>

<hr>
<h2 id='CatDynBSD'>
Calculate Annual Biomass and its Standard Error
</h2><span id='topic+CatDynBSD'></span>

<h3>Description</h3>

<p>Using results of a model fit by CatDynFit, calculate annual biomass considering
initial abundance, mean weight, abundance inputs, fishery removals, and natural
mortality, and then computes its standard error using the delta method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynBSD(x, method, multi, mbw.sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynBSD_+3A_x">x</code></td>
<td>

<p>One object of class catdyn when the time step is the month (multi-annual version)
or a list of objects of class catdyn when the time step is the week or the day
(intra-annual versions). The number of years when the time step is the month or
the number of separate catdyn objects when the time step is the week or the day
must be 15 or higher.
</p>
</td></tr>
<tr><td><code id="CatDynBSD_+3A_method">method</code></td>
<td>

<p>Character or character vector. The numerical method used to fit the model when the
time step is the month or a character vector with all the methods used to fit the
several models when the time step is the week or the day.
</p>
</td></tr>
<tr><td><code id="CatDynBSD_+3A_multi">multi</code></td>
<td>

<p>Logical. Wheter there is a single multi-annual model (monthly time step), or
many intra-annual models (daily or weekly time step)
</p>
</td></tr>
<tr><td><code id="CatDynBSD_+3A_mbw.sd">mbw.sd</code></td>
<td>

<p>Numeric. A vector of length 12 with the standard deviation or standard error of
the mean weight in kg per month when the time step is the month, or a data.frame
with three columns when the time step is the week or the day: year, mean weight
in kg, and standard deviation or standard error of mean weight in kg. In the latter
case the number of rows must equal the number of years (&gt;14), also the length of
the list x.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main purpose of this function is to obtain annual biomass estimates to be passed
as input information for the fit of a population dynamics of the surplus production
kind in a hierarchical inference framework. Thus is carries over most of the
uncertainty in the original catch, effort and mean weight data, to inform the
population dynamics model. The limit of 15 years of data as a minimum for the use
of this function is set so that the fit of the population dynamics model has
sufficient information to estimate its parameters.
</p>
<p>When the time step is the month, this function will calculate the biomass and its
standard error for every month in the time series of data. When the time step is
the week or the day it will calculate the biomass and its standard error at the
start of the season, only one value per year.
</p>


<h3>Value</h3>

<p>When the time step is the month, a data.frame with columns for year, month, time
step, mean weight (kg), standard deviation or standard error of mean weight,
abundance, standard error of abundance, biomass (tons), and standard error of
biomass (tons). The data.frame has as many rows as time steps (minimum of 180 months)
</p>
<p>When the time step is the week or the day, a data.frame with the year, mean weight
(kg), standard deviation or standard error of mean weight, abundance, standard error
of abundance, biomass (tons), and standard error of biomass (tons). The data.frame
has as many rows as years (minimum of 15 years).
</p>


<h3>Note</h3>

<p>This function makes extensive use of the delta method for carrying over the original
uncertainty. It uses the asymptotic standard errors of parameters in the object of
class catdyn and their correlation matrix, along with standard deviation or
standard error of mean weight per time step, to calculate the standard error of
biomass.
</p>
<p>In case a model output (object of class catdyn) is selected which has not produced
standard errors for all parameters that are involved in the calculation of biomass
(natural mortality, initial abundance, and magnitude of each input/output pulses of
abundance) then the missing standard errors are replaced by imputed standard errors
computed as the estimate for which the standard error is missing times the mean
coefficient of variation across all parameters which did get standard errors. In this
manner the degree of statistical uncertainty is preserved and all standard errors
are available to use the delta method to calculate the standard error of biomass.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. et al. 2015. Fisheries Research 171 (Special Issue), 59-67.
</p>

<hr>
<h2 id='CatDynCor'>
Correlation Plot Among Parameter Estimates
</h2><span id='topic+CatDynCor'></span>

<h3>Description</h3>

<p>It extracts the correlation matrices output by CatDynFit() from several model fits
and plots histograms of pairwise correlation coefficients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynCor(x, ttl, method, arr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynCor_+3A_x">x</code></td>
<td>

<p>A list of model objects of class catdyn output by CatDynFit().
</p>
</td></tr>
<tr><td><code id="CatDynCor_+3A_ttl">ttl</code></td>
<td>

<p>A character vector to use as title of each histogram.
</p>
</td></tr>
<tr><td><code id="CatDynCor_+3A_method">method</code></td>
<td>

<p>A character vector of numerical methods to extract correlation matrices.
</p>
</td></tr>
<tr><td><code id="CatDynCor_+3A_arr">arr</code></td>
<td>

<p>A numerical vector of length 2 used to organize the panels containing each histogram.
Passed as is to par().
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments x, ttl, and method must be of the same length.
</p>
<p>It might be useful to examine the results of different numerical methods applied
to the same model with this function. To do this just repeat the name of the 
object in x and specify the different numerical methods in method.
</p>


<h3>Value</h3>

<p>A multiple panel correlation plot.
</p>


<h3>Note</h3>

<p>Those histograms that show more correlations concentrated around zero indicate a 
better fit.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynData'>
Class Attribute of CatDyn Data Object
</h2><span id='topic+CatDynData'></span>

<h3>Description</h3>

<p>To be used by plot.CatDynData() to examine raw data and CatDynFit() to fit models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynData(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynData_+3A_x">x</code></td>
<td>

<p>A list object coming from as.CatDynData().
</p>
</td></tr>
<tr><td><code id="CatDynData_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class attribute.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See example for as.CatDynData().
</code></pre>

<hr>
<h2 id='catdynexp'>
Exploratory Evaluation of Initial Values of CatDyn Models
</h2><span id='topic+catdynexp'></span>

<h3>Description</h3>

<p>Using a CatDynData object and initial parameter values, create predictions of
model results to examine the goodness of initial parameter values before
passing them to the numerical optimizer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catdynexp(x, p, par, dates, distr, partial=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catdynexp_+3A_x">x</code></td>
<td>

<p>An object of class CatDynData.
</p>
</td></tr>
<tr><td><code id="catdynexp_+3A_p">p</code></td>
<td>

<p>Integer. The process model type, which quantifies the number of perturbations to
depletion. In one-fleet cases p is a scalar integer that can take any value
between -25 and 25. In two-fleet cases p is a two-components integer vector that
quantifies the number of perturbation events of each fleet. It can take values
c(0,0), c(0,1), ..., c(0,5), c(1,1), ..., c(1,5), ..., c(4,5), c(5,5), c(6,6),
..., c(25,25). In fisheries with emigration, where in addition to perturbations due
to positive pulses of abundance, there are perturbation due to negative pulses of
exodus, p should be negative and will take any integer value between -1 and -25,
this number fixing both the number of input and exit pulses.
</p>
</td></tr>
<tr><td><code id="catdynexp_+3A_par">par</code></td>
<td>

<p>Numeric. Vector of initial parameter values in the log scale.
</p>
</td></tr>
<tr><td><code id="catdynexp_+3A_dates">dates</code></td>
<td>

<p>Integer. Vector with the time steps of start of season, perturbations (if any), 
and end of season. In fisheries with emigration, in addition to the timing of entry
of perturbations, the timing of exit for each perturbation shall also be provided,
right after the time of entry. For example, p=c(1,4,50,10,60,61) would specify
a two-perturbations model which starts at time step 1, has the first input
perturbation at time step 4, first exit perturbation at time step 50, second
input perturbation at time 10, second exit perturbation at time step 60, and
season finishing at time step 61.
</p>
</td></tr>
<tr><td><code id="catdynexp_+3A_distr">distr</code></td>
<td>

<p>Character, either &quot;poisson&quot;, &quot;negbin&quot;, &quot;normal&quot;, &quot;apnormal&quot;, &quot;lognormal&quot;,
&quot;aplnormal&quot;, &quot;gamma&quot;, &quot;roblognormal&quot;, &quot;gumbel&quot;, or any pair of these seven
(2-fleets systems), corresponding to the likelihood model.
</p>
</td></tr>
<tr><td><code id="catdynexp_+3A_partial">partial</code></td>
<td>

<p>Logical, if the model incluyes emigration (p between -1 and -25) partial = TRUE
(the default) means that an unknown part of the abundance emigrate at some time
step within the season, causing a negative pulse of abundance. Alternatively,
partial = FALSE is used for transit stock models where the whole pulse of input
yet surviving exits the fishing grounds.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &quot;negbin&quot; value for the distr parameter corresponds to the negative binomial
distribution for counts, as an alternative to the poisson for cases where the
assumption of the mean equal to the variance is untenable.
</p>
<p>The difference between &quot;normal&quot; and &quot;apnormal&quot;, &quot;lognormal&quot; and &quot;aplnormal&quot; is 
that in the former the dispersion parameters is included in the likelihood function 
and it is a free parameter to be estimated along with the parameters of the 
generalized depletion model (and therefore an initial value for the dispersion must 
be provided) whereas in the latter the dispersion is eliminated by using the 
adjusted profile likelihood approximation. Setting distr=&quot;roblognormal&quot; will
use a robustified version of the lognormal which includes the dispersion parameter.
For the &quot;negbin&quot;, &quot;gamma&quot; and &quot;gumbel&quot; distributions the dispersion parameter is
always estimated along with the model parameters. In two-fleets models any pair of
the nine available likelihood models can be specified.
</p>
<p>In models with emigration, the logical parameter partial should be TRUE (the default)
when the magnitude of the exit pulse is an unknown parameter that needs to be estimated.
This could be the case of females exiting the fishing grounds to spawn, for instance.
On the other hand partial should be FALSE in transit stock fisheries, and in this case
the magnitude of the exit pulse need not be estimated, since all survivors leave.
Thus setting partial to TRUE and p negative estimates more parameters than
non-emigration and transit stock models.
</p>
<p>At this point there is no allowance for models with emigration that include a different
number of entry and exit pulses. Transit stock fisheries (partial=FALSE) must have the
same number of entry and exit pulses but other emigration models (partial=TRUE) need not
be restricted. Next versions of the function will include options for different
number of entry and exit pulses.
</p>


<h3>Value</h3>

<p>A list of length 2.
</p>
<table>
<tr><td><code>Properties</code></td>
<td>
<p>A list of length 3. 
Units is a dataframe with the units of time step,
catch, body weight, and the numbers multiplier. Fleets is a dataframe with the
fleets names and the units of nominal effort for each fleet. Dates is a dataframe
with start and end dates of the fishing season in the ISO 8601 format</p>
</td></tr>
<tr><td><code>Model</code></td>
<td>
<p>A list of length 5.
Type is the perturbation type of model. Dates is the timing of perturbations,
Distr is the chosen likelihood model, Parameters is the
parameter values being explored, and Results, is a dataframe with the time step,
and for each fleet, observed effort, observed catch in numbers, predicted catch
in numbers, observed catch in weight, predicted catch in weight, deviance,
likelihood, deviance residuals, predicted population abundance, predicted population
biomass, observed exploitation rate, predicted exploitation rate, observed fishing
mortality, and predicted fishing mortality.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The plot.CatDynData() function, acting on objects of class CatDynData, provides 
a plot of a statistic called the catch spike statistic, that can be useful to
determine the p and dates arguments.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynExp'>
Class Attribute of Exploratory Analysis Object
</h2><span id='topic+CatDynExp'></span>

<h3>Description</h3>

<p>To be used by plot.CatDynExp() to explore initial parameter values before fitting 
models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynExp(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynExp_+3A_x">x</code></td>
<td>

<p>A list object coming from internal functions.
</p>
</td></tr>
<tr><td><code id="CatDynExp_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class attribute.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynFit'>
Fit CatDyn Models by Maximum Likelihood
</h2><span id='topic+CatDynFit'></span>

<h3>Description</h3>

<p>A wrapper and post-processing tool that checks that the data are passed with proper 
characteristics, calls optimx() (from package optimx) on any of dozens of possible
versions of the generalized depletion models (as internal functions), and then it
post-processes optimx() results and join all results in a list of lists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynFit(x, p, par, dates, distr, method, control = list(), 
          hessian = TRUE, itnmax, partial = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynFit_+3A_x">x</code></td>
<td>

<p>A data object of class CatDynData. See as.CatDynData().
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_p">p</code></td>
<td>

<p>Integer. The process model type, which quantifies the number of perturbations to
depletion. In one-fleet cases p is a scalar integer that can take any value
between -25 and 25. In two-fleet cases p is a two-components integer vector that
quantifies the number of perturbation events of each fleet. It can take values
c(0,0), c(0,1), ..., c(0,5), c(1,1), ..., c(1,5), ..., c(4,5), c(5,5), c(6,6),
..., c(25,25). In fisheries with emigration, where in addition to perturbations due
to positive pulses of abundance, there are perturbation due to negative pulses of
exodus, p should be negative and will take any integer value between -1 and -25,
this number fixing both the number of input and exit pulses.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_par">par</code></td>
<td>

<p>Numeric. Vector of initial parameter values in the log scale.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_dates">dates</code></td>
<td>

<p>Integer. Vector with the time steps of start of season, perturbations (if any),
and end of season. In fisheries with emigration, in addition to the timing of entry
of perturbations, the timing of exit for each perturbation shall also be provided,
right after the time of entry. For example, p=c(1,4,50,10,60,61) would specify
a two-perturbations model which starts at time step 1, has the first input
perturbation at time step 4, first exit perturbation at time step 50, second
input perturbation at time 10, second exit perturbation at time step 60, and
season finishing at time step 61.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_distr">distr</code></td>
<td>

<p>Character, either &quot;poisson&quot;, &quot;negbin&quot;, &quot;normal&quot;, &quot;apnormal&quot;, &quot;lognormal&quot;,
&quot;aplnormal&quot;, &quot;gamma&quot;, &quot;roblognormal&quot;, &quot;gumbel&quot;, or any pair of these seven
(2-fleets systems), corresponding to the likelihood model.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_method">method</code></td>
<td>

<p>Character. Any method accepted by optimx() can be used, but some may return 
warnings or errors.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_control">control</code></td>
<td>

<p>A list of control arguments to be passed to optimx().
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_hessian">hessian</code></td>
<td>

<p>Logical. Defaults to TRUE. If set to FALSE all numerical methods tried will fail.
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_itnmax">itnmax</code></td>
<td>

<p>Numeric. Maximum number of iterations, to pass to optimx().
</p>
</td></tr>
<tr><td><code id="CatDynFit_+3A_partial">partial</code></td>
<td>

<p>Logical, if the model incluyes emigration (p between -1 and -25) partial = TRUE
(the default) means that an unknown part of the abundance emigrate at some time
step within the season, causing a negative pulse of abundance. Alternatively,
partial = FALSE is used for transit stock models where the whole pulse of input
yet surviving exits the fishing grounds.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Much care should be taken in selecting good initial values to pass in the par 
argument. To accomplish this CatDyn includes the CatDynExp class, and the catdynexp()
and the plot.CatDynExp() functions to graphically fine tune the initial values for
all model parameters. In multi-annual applications and monthly time step this might 
be time consuming but it should be carried out to increase the chance that the 
optimizers will converge to reasonable parameter space.
</p>
<p>Initial parameter values must be passed log-transformed by the user. CatDynFit() will
backtransform the maximum likelihood estimates and its numerical Hessian matrix
without user intervention using the delta method.
</p>
<p>Generally, when p is 5 or lower (one fleet) or c(5,5) (two fleets) or lower,
the model is applied to one annual season of data and the time step is &quot;day&quot; or 
&quot;week&quot;. Conversely, when p is 6 (one fleet) or c(6,6) (two fleets) or higher
the model is applied to multiannual series and the time step is the month, although 
it is conceivable that for a higly perturbed fishing system higher p values would
be applied to single season cases.
</p>
<p>The models set up for fisheries with emigration are single fleet only, so when p
is negative, taking any value in the admissible range, its length must be 1.
</p>
<p>The discrete Poisson distribution option is recommended for fisheries where the 
catch is counted in number of fish instead of weight.
</p>
<p>The &quot;negbin&quot; value for the distr parameter corresponds to the negative binomial
distribution for counts, as an alternative to &quot;poisson&quot; for cases where the
assumption of the mean equal to the variance is untenable.
</p>
<p>The difference between &quot;normal&quot; and &quot;apnormal&quot;, &quot;lognormal&quot; and &quot;aplnormal&quot; is that
in the former the dispersion parameters is included in the likelihood function and 
it is a free parameter to be estimated along with the parameters of the generalized 
depletion model (and therefore an initial value for the dispersion has to be 
provided) whereas in the latter the dispersion is eliminated by using the adjusted 
profile likelihood approximation. Setting distr=&quot;roblognormal&quot; will
use a robustified version of the lognormal which includes the dispersion parameter.
For the &quot;negbin&quot;, &quot;gamma&quot; and &quot;gumbel&quot; distributions the dispersion parameter is
always estimated along with the model parameters. In two-fleets models any pair of
the nine available likelihood models can be specified.
</p>
<p>In models with emigration, the logical parameter partial should be TRUE (the default)
when the magnitude of the exit pulse is an unknown parameter that needs to be estimated.
This could be the case of females exiting the fishing grounds to spawn, for instance.
On the other hand partial should be FALSE in transit stock fisheries, and in this case
the magnitude of the exit pulse need not be estimated, since all survivors leave.
Thus setting partial to TRUE and p negative estimates more parameters than
non-emigration and transit stock models.
</p>
<p>At this point there is no allowance for models with emigration that include a different
number of entry and exit pulses. Transit stock fisheries (partial=FALSE) must have the
same number of entry and exit pulses but other emigration models (partial=TRUE) need not
be restricted. Next versions of the function will include options for different
number of entry and exit pulses.
</p>


<h3>Value</h3>

<p>A list of length 3.
</p>
<table>
<tr><td><code>Data</code></td>
<td>
<p>A list of length 2. 
Properties is a list of length 3. Units is a dataframe with the units of time
step, catch, body weight, and the numbers multiplier.
Fleets is a dataframe with the fleets names and the units of nominal effort for
each fleet. 
Dates is a dataframe with the start and end dates of the season in the ISO 8601
format. Data is a list of length equal to the number of fleets (1 or 2). Each
component is a dataframe with the raw data, time step, observed effort, observed 
catch, observed mean body weight, observed catch in numbers, and the catch spike 
statistic.</p>
</td></tr>
<tr><td><code>Initial</code></td>
<td>
<p>A dataframe with named initial values of all free parameters in 
the model.</p>
</td></tr>
<tr><td><code>Model</code></td>
<td>
<p>A list with length equal to the number of numerical methods. Each
component has the perturbation type model, the dates of events, the chosen 
distribution for the observation of catch, the integer code describing the success 
or not of covergence returned by the method, the Karush Kuhn Tucker conditions, 
hopefully TRUE and TRUE, the value of the Akaike Information Criterion, not 
comparable between different distributions, the back-transformed (from log) maximum 
likelihood estimates, the numerical gradients at each maximum likelihood estimate, 
the standard errors of backtransformed (from log) maximum 
likelihood estimates, and the correlation matrix of the back-transformed (from log) 
maximum likelihood estimates.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Complex models may take several hours to converge on a PC. As an example, a
two fleet model with 18 perturbations each fleet, p=c(18,18), and the aplnormal
likelihood model, totalling 44 parameters to estimate from 216 monthly time 
steps, coverged successfully in 16 hours on a Windows 7, 64 bit, 3 GHz processor, 
8 GB RAM. 
</p>
<p>Some effort has been made to avoid being kicked out of numerical optimization by
just one numerical method that fails, so that optimization continues with other 
methods, but there may remain some cases when the whole optimization process is 
aborted by failure in just one method. Try taking out some suspicious methods and 
optimize again. Experience shows that methods spg and CG are robust for this
kind of model so both should be considered as the baseline case for numerical
optimization. When using the option of modeling transit fisheries with the Poisson
distribution it has been observed that methods bobyqa and newuoa also perform
well, so keep an open mind and take advantage of optimx by trying several numerical
methods.
</p>
<p>In resident stock models without emigration partial must be left at its default
value in order not to have any effect.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8), 1403-1415.
</p>
<p>Roa-Ureta, R. H. et al. 2015. Fisheries Research 171 (Special Issue), 59-67.
</p>
<p>Roa-Ureta, R. H. 2015. Fisheries Research 171 (Special Issue), 68-77.
</p>
<p>Lin, Y-J. et al. 2017. Fisheries Research 195, 130-140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#NOTE: These examples are run with very few maximum number of iterations for the
#optimization methods passed to the CatDynFit function. Real applications should
#run many more, setting the itnmax parameter in the order of thousands for models
#with dozens of free parameters to estimate.
#
#Falkland Islands one-fleet squid fishery in 1990.
#Create the data object
lgahi &lt;- as.CatDynData(x=lolgahi,
                       step="day",
                       fleet.name="Fk",
                       coleff=2,
                       colcat=1,
                       colmbw=3,
                       unitseff="nboats",
                       unitscat="kg",
                       unitsmbw="kg",
                       nmult="bill",
                       season.dates=c(as.Date("1990-01-31"),as.Date("1990-05-30")))
#Not run
#plot(lgahi,mark=TRUE,offset=c(NA,NA,.75),hem="S")
#
#1) Fit a 1-fleet 1P model with lognormal observation error and the adjusted
#profile approximation to the likelihood to eliminate the dispersion parameter
M         &lt;- 0.011 #1/Time step
N0.ini    &lt;- 3.8 #billions
P1.ini    &lt;- 1.3 #billions
k.ini     &lt;- 5.0e-05 #1/n of boats
alpha.ini &lt;- 1.7 #adimensional
beta.ini  &lt;- 0.6 #adimensional
pars.ini  &lt;- log(c(M,
                   N0.ini,
                   P1.ini,
                   k.ini,
                   alpha.ini,
                   beta.ini))
#Dates
P1    &lt;- 70 #Selected by visual inspection of standard plot
dates &lt;- c(head(lgahi$Data$Fk$time.step,1),
           P1,
           tail(lgahi$Data$Fk$time.step,1))
lgahi.apln.1P.ini &lt;- catdynexp(x=lgahi,
                               p=1,
                               par=pars.ini,
                               dates=dates,
                               distr="aplnormal")
plot(x=lgahi.apln.1P.ini,
     leg.pos="topright",
     Biom.tstep=7,
     Cat.tstep=120,
     Biom.xpos=0.4,
     Biom.ypos=0,
     Cat.xpos=0.4,
     Cat.ypos=0.1)
#fit
lgahi.apln.1P.fit &lt;- CatDynFit(x=lgahi,
                               p=1,
                               par=pars.ini,
                               dates=dates,
                               distr="aplnormal",
                               method="spg",
                               itnmax=10)
#examine results
lgahi.apln.1P.pred.spg &lt;- CatDynPred(lgahi.apln.1P.fit,"spg")
plot(x=lgahi.apln.1P.pred.spg,
     leg.pos="topright",
     Biom.tstep=7,
     Cat.tstep=120,
     Biom.xpos=0.18,
     Biom.ypos=0.1,
     Cat.xpos=0.18,
     Cat.ypos=0.2)
#
#2) Fit a 1-fleet 2P model with lognormal observation error and full exact
#likelihood including the dispersion parameter
M         &lt;- 0.011 #1/Time step
N0.ini    &lt;- 3.8 #billions
P1.ini    &lt;- 1.3 #billions
P2.ini    &lt;- 0.5 #billions
k.ini     &lt;- 4.0e-05 #1/n of boats
alpha.ini &lt;- 1.7 #adimensional
beta.ini  &lt;- 0.6 #adimensional
#Note how to get reasonable initial value for dispersion parameter
psi.ini   &lt;- 0.33*sd(log(lgahi$Data$Fk$obscat.bill))^2
pars.ini  &lt;- log(c(M,
                   N0.ini,
                   P1.ini,
                   P2.ini,
                   k.ini,
                   alpha.ini,
                   beta.ini,
                   psi.ini))
#Dates
P1    &lt;- 70  #Selected by visual inspection of standard plot
P2    &lt;- 135 #Selected by visual inspection of standard plot
dates &lt;- c(head(lgahi$Data$Fk$time.step,1),
           P1,
           P2,
           tail(lgahi$Data$Fk$time.step,1))
lgahi.ln.2P.ini &lt;- catdynexp(x=lgahi,
                             p=2,
                             par=pars.ini,
                             dates=dates,
                             distr="lognormal")
plot(x=lgahi.ln.2P.ini,
     leg.pos="topright",
     Biom.tstep=7,
     Cat.tstep=120,
     Biom.xpos=0.4,
     Biom.ypos=0,
     Cat.xpos=0.18,
     Cat.ypos=0.2)
#fit lognormal
lgahi.ln.2P.fit &lt;- CatDynFit(x=lgahi,
                              p=2,
                              par=pars.ini,
                              dates=dates,
                              distr="lognormal",
                              method="spg",
                              itnmax=10)
#examine results
lgahi.ln.2P.pred.spg &lt;- CatDynPred(lgahi.ln.2P.fit,"spg")
plot(x=lgahi.ln.2P.pred.spg,
     leg.pos="topright",
     Biom.tstep=7,
     Cat.tstep=120,
     Biom.xpos=0.18,
     Biom.ypos=0.1,
     Cat.xpos=0.18,
     Cat.ypos=0.2)
#
#Summary table for model selection
lgahi.sum &lt;- CatDynSum(x=list(lgahi.apln.1P.fit,
                               lgahi.ln.2P.fit),
                       season=1990,
                       method=c("spg","spg"))
#Plot for correlations among parameter estimates
CatDynCor(x=list(lgahi.apln.1P.fit,
                 lgahi.ln.2P.fit),
          ttl=c("Adjusted Profile Lognormal 1P","Lognormal 2P"),
          method=c("spg","spg"),
          arr=c(2,1))
#Create neat table with optimization results
CatDynPar(x=lgahi.ln.2P.fit,method="spg")
#
</code></pre>

<hr>
<h2 id='CatDynMod'>
Class Attribute of Model Output Object
</h2><span id='topic+CatDynMod'></span>

<h3>Description</h3>

<p>To be used by plot.CatDynMod() to graphically examine model results.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynMod(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynMod_+3A_x">x</code></td>
<td>

<p>A list object coming from CatDyn().
</p>
</td></tr>
<tr><td><code id="CatDynMod_+3A_...">...</code></td>
<td>

<p>Not used.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class attribute
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynPar'>
Table of Parameter Estimates and Coefficients of Variation
</h2><span id='topic+CatDynPar'></span>

<h3>Description</h3>

<p>It takes parameter estimates from output by CatDynFit() from a single model fit
and creates a neat table of estimates, dates in ISO 8601 format for each abundance
input/output, and coefficient of variation of estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynPar(x, method, partial = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynPar_+3A_x">x</code></td>
<td>

<p>A single model object of class catdyn output by CatDynFit().
</p>
</td></tr>
<tr><td><code id="CatDynPar_+3A_method">method</code></td>
<td>

<p>The numerical method used to minimize the loglikelihod of x.
</p>
</td></tr>
<tr><td><code id="CatDynPar_+3A_partial">partial</code></td>
<td>

<p>Logical, FALSE for transit models, TRUE (the default) for all other model versions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Arguments x and method must both be of length = 1.
</p>


<h3>Value</h3>

<p>A data.frame with the following columns: parameter names (all estimated parameters,
including the dispersion parameter for likelihood options other than Poisson, adjusted
profile normal, and adjusted profile lognormal), timing (the data in ISO 8601 format
of each input/output event), the maximum likelihood estimates, and the percent
coefficient of variation. In two fleet models the last three columns are duplicated,
with the fleet name added to the column names.
</p>


<h3>Note</h3>

<p>In model fits with a monthly time step, the timing column includes year and month.
In model fits with a weekly time step, the timing includes the full date with initial
and final date of that week.
</p>
<p>In model fits with a daily time step, the timing includes the full data.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynPred'>
Predictions from a Generalized Depletion (Catch Dynamics) Model
</h2><span id='topic+CatDynPred'></span>

<h3>Description</h3>

<p>Calculates the predicted catch, residuals, by fleet, population biomass, exploitation
rate, fishing mortality, of a fish stock using parameters estimated for a Catch
Dynamic Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynPred(x, method, partial = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynPred_+3A_x">x</code></td>
<td>

<p>An object of class catdyn from function CatDynFit().
</p>
</td></tr>
<tr><td><code id="CatDynPred_+3A_method">method</code></td>
<td>

<p>Character. The particular numerical method from which estimates have to be drawn.
</p>
</td></tr>
<tr><td><code id="CatDynPred_+3A_partial">partial</code></td>
<td>

<p>Logical, FALSE for transit models, TRUE (the default) for all other model versions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is very similar to catdynexp() but instead of using arbitrary
parameter values given by the user, it takes the maximum likelihood estimates
produced by the call to the optimizer by function CatDynFit().
</p>


<h3>Value</h3>

<p>A list of length 2.
</p>
<table>
<tr><td><code>Properties</code></td>
<td>
<p>A list of length 3.
Units is a dataframe with the units of time step,
catch, body weight, and the numbers multiplier. Fleets is a dataframe with the
fleets names and the units of nominal effort for each fleet. Dates is a dataframe
with start and end dates of the fishing season in the ISO 8601 format.</p>
</td></tr>
<tr><td><code>Model</code></td>
<td>
<p>A list of length 5.
Type is the perturbation type of model. Dates is the timing of perturbations,
Distr is the chosen likelihood model, Parameters is the
parameter values being explored, and Results, is a dataframe with the time step,
and for each fleet, observed effort, observed catch in numbers, predicted catch
in numbers, observed catch in weight, predicted catch in weight, deviance,
likelihood, deviance residuals, predicted population abundance, predicted population
biomass, observed exploitation rate, predicted exploitation rate, observed fishing
mortality, and predicted fishing mortality.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>In resident stock models without emigration partial must be left at its default
value in order not to have any effect.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8), 1403-1415.
</p>
<p>Roa-Ureta, R. H. et al. 2015. Fisheries Research 171 (Special Issue), 59-67.
</p>
<p>Roa-Ureta, R. H. 2015. Fisheries Research 171 (Special Issue), 68-77.
</p>
<p>Lin, Y-J. et al. 2017. Fisheries Research 195, 130-140.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='CatDynSum'>
Summary Table for Generalized Depletion (Catch Dynamics) Model Comparison
</h2><span id='topic+CatDynSum'></span>

<h3>Description</h3>

<p>Summarize information theoretic, numerical and statistical results of several models
fit to the data to select a best working model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CatDynSum(x, season, method, partial=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CatDynSum_+3A_x">x</code></td>
<td>

<p>A list of model objects of class catdyn output by CatDynFit().
</p>
</td></tr>
<tr><td><code id="CatDynSum_+3A_season">season</code></td>
<td>

<p>Character, an identifier for the set of models.
</p>
</td></tr>
<tr><td><code id="CatDynSum_+3A_method">method</code></td>
<td>

<p>A character vector of numerical methods to extract from each element of the x
list.
</p>
</td></tr>
<tr><td><code id="CatDynSum_+3A_partial">partial</code></td>
<td>

<p>Logical, FALSE for transit models, TRUE (the default) for all other model versions.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments x and method must be of the same length.
</p>
<p>It might be useful to examine the results of different numerical methods applied
to the same model with this function. To do this just repeat the name of the 
object in x and specify the different numerical methods in method.
</p>


<h3>Value</h3>

<p>A data.frame with an extraction of comparative information from several models 
fitted to the data.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='cor2cov'>
Correlation Matrix to Covariance Matrix Conversion
</h2><span id='topic+cor2cov'></span>

<h3>Description</h3>

<p>Function to convert a correlation matrix to a covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cor2cov(cor.mat, sd, discrepancy = 1e-05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cor2cov_+3A_cor.mat">cor.mat</code></td>
<td>

<p>The correlation matrix to be converted.
</p>
</td></tr>
<tr><td><code id="cor2cov_+3A_sd">sd</code></td>
<td>

<p>A vector that contains the standard deviations of the variables in the correlation matrix.
</p>
</td></tr>
<tr><td><code id="cor2cov_+3A_discrepancy">discrepancy</code></td>
<td>

<p>A neighborhood of 1, such that numbers on the main diagonal of the correlation matrix will
be considered as equal to 1 if they fall in this neighborhood
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was copied from package MBESS.
</p>
<p>The correlation matrix to convert can be either symmetric or triangular. The covariance
matrix returned is always a symmetric matrix.
</p>


<h3>Note</h3>

<p>The correlation matrix input should be a square matrix, and the length of sd should be
equal to the number of variables in the correlation matrix (i.e., the number of rows/columns).
Sometimes the correlation matrix input may not have exactly 1s on the main diagonal, due to, eg,
rounding; discrepancy specifies the allowable discrepancy so that the function still considers
the input as a correlation matrix and can proceed (but the function does not change the numbers
on the main diagonal).
</p>


<h3>Author(s)</h3>

<p>Ken Kelley (University of Notre Dame; KKelley@ND.Edu), Keke Lai
</p>

<hr>
<h2 id='deltamethod'>
First-order Taylor Series Expansion of Functions of Random Variables
</h2><span id='topic+deltamethod'></span>

<h3>Description</h3>

<p>The delta method for approximating the standard error of a transformation 
<em>g</em>(<em>X</em>) of a random variable <em>X</em> = (<em>x</em>1, <em>x</em>2, ...), 
given estimates of the mean and covariance matrix of <em>X</em>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deltamethod(g, mean, cov, ses = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deltamethod_+3A_g">g</code></td>
<td>

<p>A formula representing the transformation. The variables must be 
labelled <em>x</em>1, <em>x</em>2, ... For example, ~ 1 / (<em>x</em>1 + <em>x</em>2). 
If the transformation returns a vector, then a list of formulae representing 
(<em>g</em>1, <em>g</em>2, ...) can be provided, for example list( ~ <em>x</em>1 + 
<em>x</em>2, ~ <em>x</em>1 / (<em>x</em>1 + <em>x</em>2) ).
</p>
</td></tr>
<tr><td><code id="deltamethod_+3A_mean">mean</code></td>
<td>

<p>The estimated mean of <em>X</em>.
</p>
</td></tr>
<tr><td><code id="deltamethod_+3A_cov">cov</code></td>
<td>

<p>The estimated covariance matrix of <em>X</em>.
</p>
</td></tr>
<tr><td><code id="deltamethod_+3A_ses">ses</code></td>
<td>

<p>If TRUE, then the standard errors of <em>g</em>1(<em>X</em>), <em>g</em>2(<em>X</em>), 
... are returned. Otherwise the covariance matrix of <em>g</em>(<em>X</em>) is returned.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function was copied from package msm.
</p>
<p>It is used in CatDyn to backtransform
from the logarithm because CatDyn parameters are all estimated in the log scale
to improve numerical performance.
</p>
<p>For more details see the help pages for function deltamethod of package msm.
</p>


<h3>Value</h3>

<p>A vector containing the standard errors of <em>g</em>1(<em>X</em>), <em>g</em>2(<em>X</em>), 
... or a matrix containing the covariance of <em>g</em>(<em>X</em>). 
</p>


<h3>Author(s)</h3>

<p>C. H. Jackson &lt;chris.jackson@mrc-bsu.cam.ac.uk&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See the examples in package msm.
</code></pre>

<hr>
<h2 id='gayhake'>
Industrial and Artisanal Catch and Effort Data from the Chilean Hake Fishery
</h2><span id='topic+gayhake'></span>

<h3>Description</h3>

<p>Exhaustive recorded operational activity of the <em>Merluccius gayi</em> two fleet
fishery off Central Chile in 2006.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gayhake")</code></pre>


<h3>Format</h3>

<p>A data frame with 53 observations on the following 7 variables.
</p>

<dl>
<dt><code>TimeStep</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Catch.Ind.kg</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>NShips.Ind</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Body.Ind.g</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Catch.Art.kg</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>NShips.Art</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Body.Art.g</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Under-Secretariat of Fishing, Chilean government.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gayhake)
</code></pre>

<hr>
<h2 id='gayhakelm'>
Length and Month data of Chilean hake from Artisanal Fishery
</h2><span id='topic+gayhakelm'></span>

<h3>Description</h3>

<p>A small sample from hundreds of thousand of records of length by month from
individual fish captured by artisanal fishing boats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gayhakelm")</code></pre>


<h3>Format</h3>

<p>A data frame with 600 observations on the following 2 variables.
</p>

<dl>
<dt><code>Month</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>lon.cm</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Under-Secretariat of Fishing, Chilean government.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gayhakelm)
</code></pre>

<hr>
<h2 id='gayhakelw'>
Length and Weight data of Chilean hake from Artisanal Fishery
</h2><span id='topic+gayhakelw'></span>

<h3>Description</h3>

<p>A small sample from hundreds of thousand of records of length and weight of
individual fish captured by artisanal fishing boats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("gayhakelw")</code></pre>


<h3>Format</h3>

<p>A data frame with 250 observations on the following 2 variables.
</p>

<dl>
<dt><code>Length.cm</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Weight.kg</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Under-Secretariat of Fishing, Chilean government.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gayhakelw)
</code></pre>

<hr>
<h2 id='lolgahi'>
Industrial Trawling Data from the Squid Fishery of the Falkland Islands
</h2><span id='topic+lolgahi'></span>

<h3>Description</h3>

<p>Exhaustive recorded operational activity of the <em>Loligo gahi</em> fleet off the Falkland 
Islands during the summer season of 1990.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("lolgahi")</code></pre>


<h3>Format</h3>

<p>A data frame with 120 observations on the following 6 variables.
</p>

<dl>
<dt><code>obscat</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>obseff</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>obsmbm</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Department of Fisheries, Falklands Islands government.
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8):1403-1415.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(lolgahi)
</code></pre>

<hr>
<h2 id='m.hoenig'>
Marine animals natural mortality and longevity database
</h2><span id='topic+m.hoenig'></span>

<h3>Description</h3>

<p>A database of natural mortality estimates and longetvity in fish, cetaceans and molluscs
compiled by Prof. John M. Hoenig.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("m.hoenig")</code></pre>


<h3>Format</h3>

<p>A data frame with 123 observations on the following 2 variables.
</p>

<dl>
<dt><code>maxage</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>natmort</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>Mortality rates in 1/yr and longevity in yr.
</p>


<h3>References</h3>

<p>Hoening, J.M. 2005. Empirical use of longevity data to estimate mortality rates.
SEDAR33-RD17. SEDAR, North Charleston, SC. 8 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(m.hoenig)
</code></pre>

<hr>
<h2 id='M.Hoenig'>
Estimate natural mortality rate from longevity data
</h2><span id='topic+M.Hoenig'></span>

<h3>Description</h3>

<p>Using the empirical regression parameters obtained by Prof. John M. Hoenig
and the longevity provided with max.age, estimate the natural mortality rate and its
standard error from application of the delta method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>M.Hoenig(max.age, time.step)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="M.Hoenig_+3A_max.age">max.age</code></td>
<td>

<p>Numeric, longevity in years.
</p>
</td></tr>
<tr><td><code id="M.Hoenig_+3A_time.step">time.step</code></td>
<td>

<p>Character, either day, week, or month, the desired unit of the estimate.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used to obtain a good initial value for natural mortality
rate to be input in the exploratory or statistical feet of a catch dynamics model,
at the time step in which the model will be run.
</p>


<h3>Value</h3>

<p>A length 2 numeric vector with estimated natural mortality and its standard error.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Hoening, J.M. 2005. Empirical use of longevity data to estimate mortality rates.
SEDAR33-RD17. SEDAR, North Charleston, SC. 8 pp.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>max.age &lt;- 5.8
time.step &lt;- "day"
M.Hoenig(max.age,time.step)
</code></pre>

<hr>
<h2 id='mobw.kg'>
Mean body weight per month
</h2><span id='topic+mobw.kg'></span>

<h3>Description</h3>

<p>Using a data.frame with paired observations of length and weight of individuals, and
a second data.frame with paired observations of length and month of individuals, predict
the mean weight per month in kg and its standard error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mobw.kg(par, lenw, lenm, method, span)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mobw.kg_+3A_par">par</code></td>
<td>

<p>Numeric vector length 2 with the initial values for parameters of the length-weight relationship.
</p>
</td></tr>
<tr><td><code id="mobw.kg_+3A_lenw">lenw</code></td>
<td>

<p>Numeric data.frame with paired observations of length and weight (kg).
</p>
</td></tr>
<tr><td><code id="mobw.kg_+3A_lenm">lenm</code></td>
<td>

<p>Numeric data.frame with paired observations of length and month in numeric format.
</p>
</td></tr>
<tr><td><code id="mobw.kg_+3A_method">method</code></td>
<td>

<p>Character, the numerical method to fit the length-weight relationship. Use one of
the following: BFGS,CG,Nelder-Mead,SANN.
</p>
</td></tr>
<tr><td><code id="mobw.kg_+3A_span">span</code></td>
<td>

<p>The span parameter of the loess function to fit the length-month relationship.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The length data in lenw and lenm must be in the same units.
</p>


<h3>Value</h3>

<p>A data.frame with five columns: month, predicted mean weight from the length data
and the length-weight relationship, its standard error, smoothed mean length from
the loess fit of the length-month relationship, and its standard error.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(gayhakelm)
data(gayhakelw)
par &lt;-  c(4e-4,2.9)
method &lt;- "SANN"
span   &lt;- 1
chihake.mobw &lt;- mobw.kg(par=par, lenw=gayhakelw, lenm=gayhakelm,
                        method=method, span=span)
</code></pre>

<hr>
<h2 id='plot.CatDynData'>
Exploratory Analysis of Catch and Effort Fisheries Data
</h2><span id='topic+plot.CatDynData'></span>

<h3>Description</h3>

<p>Allows examining the relation between catch and effort, the marginal distributions
of catch and effort, and the time series of catch, effort, the catch spike
statistic, and mean body weight in the catch.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CatDynData'
plot(x, mark, offset, hem, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.CatDynData_+3A_x">x</code></td>
<td>

<p>An object of class CatDynData.
</p>
</td></tr>
<tr><td><code id="plot.CatDynData_+3A_mark">mark</code></td>
<td>

<p>Logical. If TRUE then the time step is posted on top of each point of the time
series of catch, effort, and the catch spike statistic.
</p>
</td></tr>
<tr><td><code id="plot.CatDynData_+3A_offset">offset</code></td>
<td>

<p>Numeric. A vector of length 3 that positions the mark above a given distance 
over the point.
</p>
</td></tr>
<tr><td><code id="plot.CatDynData_+3A_hem">hem</code></td>
<td>

<p>Character. Either N (northern hemisphere) or S (southern hemisphere).
</p>
</td></tr>
<tr><td><code id="plot.CatDynData_+3A_...">...</code></td>
<td>

<p>Further arguments to be passed to plot(), hist().
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use NA to cancel the mark over the points of any of the three time series that can
be marked.
In the case of two-fleet models, the plot will display the data for the first
fleet, then the user needs to hit Enter to display the data for the second fleet.
</p>


<h3>Value</h3>

<p>A seven panel plot.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='plot.CatDynExp'>
Exploratory Modeling of Fisheries with Catch Dynamic (generalized depletion) Models
</h2><span id='topic+plot.CatDynExp'></span>

<h3>Description</h3>

<p>Evaluate and refine the goodness of initial parameter values before fitting 
catch dynamic models to data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CatDynExp'
plot(x, leg.pos, Biom.tstep, Cat.tstep, Biom.xpos, Biom.ypos,
                         Cat.xpos, Cat.ypos,
                         diagnostics.panels = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.CatDynExp_+3A_x">x</code></td>
<td>

<p>An object of class CatDynExp
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_leg.pos">leg.pos</code></td>
<td>

<p>The position of the legend in the first panel. Passed to legend().
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_biom.tstep">Biom.tstep</code></td>
<td>

<p>Integer. The number of time steps over which to average the population biomass 
counting from the end of the season backwards.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_cat.tstep">Cat.tstep</code></td>
<td>

<p>Integer. The number of time steps over which to add the catch counting from the
end of the season backwards.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_biom.xpos">Biom.xpos</code></td>
<td>

<p>Numeric. The position of the biomass value on the x-axis of the first panel of 
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_biom.ypos">Biom.ypos</code></td>
<td>

<p>Numeric. The position of the biomass value on the y-axis of the first panel of 
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_cat.xpos">Cat.xpos</code></td>
<td>

<p>Numeric. The position of the catch value on the x-axis of the first panel of
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_cat.ypos">Cat.ypos</code></td>
<td>

<p>Numeric. The position of the catch value on the y-axis of the first panel of
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_diagnostics.panels">diagnostics.panels</code></td>
<td>

<p>Logical. Whether to plot deviance residual diagnostic panels (default to TRUE)
or just the data and model prediction (diagnostics.panels = FALSE).
</p>
</td></tr>
<tr><td><code id="plot.CatDynExp_+3A_...">...</code></td>
<td>

<p>Further arguments to pass to plot(), hist().
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the average population biomass over the whole season is to be posted then an
integer equal to the number of time steps in the season shall be entered for the
Biom.tstep argument.
</p>


<h3>Value</h3>

<p>A four panel plot of data, model predictions, and residual analysis.
</p>


<h3>Note</h3>

<p>The target symbols on the bottom of the tope left panel are the timings of any
perturbations set by the user.
In transit stock fisheries and resident stock fisheries with emigration, entry target
symbols are in red and exit target symbols are in blue.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8):1403-1415.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='plot.CatDynMod'>
Examination of Results from Fitting Catch Dynamic Models
</h2><span id='topic+plot.CatDynMod'></span>

<h3>Description</h3>

<p>After model fit and prediction, examine model results on a graphical display.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'CatDynMod'
plot(x, leg.pos, Biom.tstep, Cat.tstep, Biom.xpos, Biom.ypos,
                         Cat.xpos, Cat.ypos,
                         diagnostics.panels = 2, top.lab = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.CatDynMod_+3A_x">x</code></td>
<td>

<p>An object of class CatDynMod.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_leg.pos">leg.pos</code></td>
<td>

<p>The position of the legend in the top left panel. Passed to legend().
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_biom.tstep">Biom.tstep</code></td>
<td>

<p>Integer. The number of time steps over which to average the population biomass 
counting from the end of the season backwards.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_cat.tstep">Cat.tstep</code></td>
<td>

<p>Integer. The number of time steps over which to add the catch counting from the
end of the season backwards.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_biom.xpos">Biom.xpos</code></td>
<td>

<p>Numeric. The position of the biomass estimate on the x-axis of the first panel 
of the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_biom.ypos">Biom.ypos</code></td>
<td>

<p>Numeric. The position of the biomass estimate on the y-axis of the first panel 
of the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_cat.xpos">Cat.xpos</code></td>
<td>

<p>Numeric. The position of the catch value on the x-axis of the first panel of
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_cat.ypos">Cat.ypos</code></td>
<td>

<p>Numeric. The position of the catch value on the y-axis of the first panel of
the plot in relative units.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_diagnostics.panels">diagnostics.panels</code></td>
<td>

<p>Integer. Whether to plot just one panel with the data and model prediction
(diagnostics.panels = 0), or add three more panels for diagnostics based on
deviance residual of the same size as the data-prediction panel
(diagnostics.panels = 1), or to make the deviance residual panels smaller
(diagnostics.panels = 2, the default).
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_top.lab">top.lab</code></td>
<td>

<p>Logical. Whether to put a top label describing choices of model type, likelihood,
and numerical method. Defaults to TRUE.
</p>
</td></tr>
<tr><td><code id="plot.CatDynMod_+3A_...">...</code></td>
<td>

<p>Further arguments to pass to plot(), hist().
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the average population biomass over the whole season is to be posted then an
integer equal to the number of time steps in the season shall be entered for the
Biom.tstep argument.
</p>


<h3>Value</h3>

<p>A four panel plot of data, model predictions, and residual analysis.
</p>


<h3>Note</h3>

<p>The target symbols on the bottom of the tope left panel are the timings of any
perturbations set by the user.
</p>
<p>In transit fisheries, entry target symbols are in red and exit target symbols 
are in blue.
</p>


<h3>Author(s)</h3>

<p>Ruben H. Roa-Ureta (ORCID ID 0000-0002-9620-5224)
</p>


<h3>References</h3>

<p>Roa-Ureta, R. H. 2012. ICES Journal of Marine Science 69(8):1403-1415.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#See examples for CatDynFit().
</code></pre>

<hr>
<h2 id='twelver'>
Sport Fishing for Eel Juveniles in Taiwan
</h2><span id='topic+twelver'></span>

<h3>Description</h3>

<p>Exhaustive recorded operational activity of the <em>Anguilla japonica</em> sport
fishery in Taiwan during the 1983-1984 season.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("twelver")</code></pre>


<h3>Format</h3>

<p>A data frame with 110 observations on the following 4 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a Date</p>
</dd>
<dt><code>Effort.Hour.Soak</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Catch.Ind</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Mbw</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>Dpt. of Zoology, National Taiwan University
</p>


<h3>References</h3>

<p>Lin, Y-J. et al. 2017. Fisheries Research 195, 130-140
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(twelver)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
