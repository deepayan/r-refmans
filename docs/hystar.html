<!DOCTYPE html><html><head><title>Help for package hystar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {hystar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#hystar-package'><p>hystar: Fit the Hysteretic Threshold Autoregressive Model</p></a></li>
<li><a href='#hystar_fit'><p>Estimate the HysTAR model using conditional least squares estimation</p></a></li>
<li><a href='#hystar_sim'><p>Simulate data from the HysTAR model</p></a></li>
<li><a href='#z_sim'><p>Simulate the threshold/control variable Z</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Fit the Hysteretic Threshold Autoregressive Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-03</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daan de Jong &lt;daandejong94@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate parameters of the hysteretic threshold autoregressive
    (HysTAR) model, using conditional least squares.
    In addition, you can generate time series data from the HysTAR model.
    For details, see Li, Guan, Li and Yu (2015) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2Fasv017">doi:10.1093/biomet/asv017</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/daandejongen/hystar/">https://github.com/daandejongen/hystar/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/daandejongen/hystar/issues/">https://github.com/daandejongen/hystar/issues/</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, Rcpp, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-03 11:16:05 UTC; daandejong</td>
</tr>
<tr>
<td>Author:</td>
<td>Daan de Jong <a href="https://orcid.org/0000-0001-6034-0136"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  European Research Council [fnd]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-05 14:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='hystar-package'>hystar: Fit the Hysteretic Threshold Autoregressive Model</h2><span id='topic+hystar'></span><span id='topic+hystar-package'></span>

<h3>Description</h3>

<p>Estimate parameters of the hysteretic threshold autoregressive (HysTAR) model, using conditional least squares. In addition, you can generate time series data from the HysTAR model. For details, see Li, Guan, Li and Yu (2015) <a href="https://doi.org/10.1093/biomet/asv017">doi:10.1093/biomet/asv017</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Daan de Jong <a href="mailto:daandejong94@gmail.com">daandejong94@gmail.com</a> (<a href="https://orcid.org/0000-0001-6034-0136">ORCID</a>) [copyright holder]
</p>
<p>Other contributors:
</p>

<ul>
<li><p> European Research Council [funder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/daandejongen/hystar/">https://github.com/daandejongen/hystar/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/daandejongen/hystar/issues/">https://github.com/daandejongen/hystar/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='hystar_fit'>Estimate the HysTAR model using conditional least squares estimation</h2><span id='topic+hystar_fit'></span>

<h3>Description</h3>

<p>This function allows you to estimate the parameters of the hysteretic threshold
autoregressive (HysTAR) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hystar_fit(
  data,
  r = c(0.1, 0.9),
  d = 0L,
  p0 = 1L,
  p1 = 1L,
  p_select = "bic",
  thin = FALSE,
  tar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hystar_fit_+3A_data">data</code></td>
<td>
<p>a vector, matrix or data.frame containing the outcome variable
<code class="reqn">y</code> in the first column and the threshold variable <code class="reqn">z</code> in the second.
Other columns are ignored.
A vector, is taken to be both the outcome and control variable,
so, in that case, a self-exciting HysTAR is fitted.</p>
</td></tr>
<tr><td><code id="hystar_fit_+3A_r">r</code></td>
<td>
<p>A vector or a matrix with search values for <code class="reqn">\hat{r}_0, \hat{r}_1</code>.
Defaults to <code>c(.1, .9)</code>.
</p>

<ul>
<li><p> A vector <code>r</code> must contain two values <code class="reqn">a</code> and <code class="reqn">b</code> in <code class="reqn">[0, 1]</code>.
The search space for the thresholds will be observed values of <code>z</code>
between its <code class="reqn">100a\%</code> and <code class="reqn">100b\%</code> percentiles.
</p>
</li>
<li><p> A matrix <code>r</code> allows for a custom search. It must have two columns,
such that each row represents a pair <code class="reqn">r_0 \le r_1</code> to test.
You can use a matrix with one row if you don't want to estimate
the thresholds. Note that the values in these matrix should be
on the scale of <code>z</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="hystar_fit_+3A_d">d</code></td>
<td>
<p>A numeric vector with one or more values for the search space
of the delay parameter. Defaults to 1. Typically, d is not very large, so
a reasonable search space might be 0, 1, 2, ..., 5.</p>
</td></tr>
<tr><td><code id="hystar_fit_+3A_p0">p0</code></td>
<td>
<p>A numeric vector with one or more values for the search space
of the autoregressive order of Regime 0. Defaults to 1.</p>
</td></tr>
<tr><td><code id="hystar_fit_+3A_p1">p1</code></td>
<td>
<p>Same as <code>p0</code>, but for regime 1. Note that it does not need to be
equal to <code>p0</code>.</p>
</td></tr>
<tr><td><code id="hystar_fit_+3A_p_select">p_select</code></td>
<td>
<p>The information criterion that should be minimized to select
the orders <code class="reqn">p_0</code> and <code class="reqn">p_1</code>. Choices:
</p>

<ul>
<li> <p><code>"aic"</code> (Akaike Information Criterion)
</p>
</li>
<li> <p><code>"aicc"</code> (Corrected Akaike Information Criterion)
</p>
</li>
<li> <p><code>"bic"</code> (default, Bayesian Information Criterion)
</p>
</li></ul>
</td></tr>
<tr><td><code id="hystar_fit_+3A_thin">thin</code></td>
<td>
<p><code>TRUE</code> (default) or <code>FALSE</code>. Only relevant when <code>r</code> is a vector.
</p>

<ul>
<li><p> If <code>TRUE</code> (default), the search space for the thresholds are the
<code class="reqn">100a\%, 100(a+0.01)\%, \dots, 100b\%</code> percentiles of <code>z</code>.
This drastically reduces computation costs while keeping a reasonably large
search space for the thresholds. Note that this is a purely practical
choice with no theoretical justification.
</p>
</li>
<li><p> If <code>FALSE</code>, all observed unique values of <code>z</code> between
the <code class="reqn">100a\%</code> and <code class="reqn">100b\%</code> percentiles of <code>z</code> will be considered.
</p>
</li></ul>
</td></tr>
<tr><td><code id="hystar_fit_+3A_tar">tar</code></td>
<td>
<p><code>TRUE</code> or <code>FALSE</code> (default). Choose <code>TRUE</code> if you want to fit a traditional
2-regime threshold autoregressive (TAR) model. In this model,
there is only one threshold (or equivalently, a HysTAR model with <code class="reqn">r_0 = r_1</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In regime 0, <code class="reqn">y_{t}</code> is predicted by values up to <code class="reqn">y_{t - p_0}</code>.
This implies that the first <code class="reqn">p_0</code> time points can not be predicted. E.g.,
if <code class="reqn">p_0 = 2</code>, <code class="reqn">y_1</code> would miss a value from <code class="reqn">y_{-1}</code>. Similarly, the
value of the delay parameter implies that the regime is unknown for the first
<code class="reqn">d</code> time points. To ensure that the same data are used on all options for
<code>d</code>, <code>p0</code> and <code>p1</code>, the first <code>max(d, p0, p1)</code> observations are discarded for
estimation of the parameters.
</p>


<h3>Value</h3>

<p>An object of S3 class <code>hystar_fit</code>, which is a <code>list</code> containing the following
items:
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$data&#8288;</code>. A <code>data.frame</code> containing
</p>

<ul>
<li> <p><code>y</code>, the outcome variable
</p>
</li>
<li> <p><code>z</code>, the threshold variable
</p>
</li>
<li> <p><code>H</code>, a logical vector that indicates at which time points the hysteresis
effect is happening. Note that this vector starts with <code>NA</code>(s), since not all
values can be predicted in the HysTAR model. See Details.
</p>
</li>
<li> <p><code>R</code>, the regime indicator vector. (Also starts with <code>NA</code>(s).)
</p>
</li></ul>

</li>
<li> <p><code style="white-space: pre;">&#8288;$residuals&#8288;</code>. Also accessible with the <code>residuals()</code> S3 method.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$coefficients&#8288;</code>, a vector with the estimated coefficients.
With the <code>coef()</code> S3 method, the coefficients are represented in a matrix.
Use the <code>confint()</code> method to get the confidence intervals of the estimates.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$delay&#8288;</code>, a scalar with the estimate for the delay parameter.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$thresholds&#8288;</code>, a vector with the estimates of the thresholds.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$orders&#8288;</code>, a vector with the estimates of the orders.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$resvar&#8288;</code>, a vector with the estimates of the residual variances.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$rss&#8288;</code>, the minimized residual sum of squares.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$ic&#8288;</code>, a vector with the aic, the corrected aic and the bic.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$n&#8288;</code>, a vector with the total effective observations and the
effective obeservations in regime 0 and regime 1.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$eff&#8288;</code>, a vector with the time indicators of the effective observations.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$equiv&#8288;</code>, a matrix containing equivalent estimates for the delay and thresholds,
i.e., estimates that imply exactly the same regime indicator vector, and
as a result the same minimal residual sum of squares.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$r_search&#8288;</code>, a vector with the <code class="reqn">r</code>-values that were considered.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$tar&#8288;</code>, Logical: <code>TRUE</code> if a TAR model was fitted.
</p>
</li></ul>

<p>Implemented generics for the <code>hystar_fit</code> class:
</p>

<ul>
<li> <p><code>plot()</code> plots the <code>z</code> variable and the <code>y</code> variable above one another.
Shading of the background visualizes the regimes. Thresholds are drawn as
horizontal lines in the <code>z</code> plot. You can provide regime_names (char vector of 2),
main (char vector of 1), xlab (char vector of 1) and ylab (char vector of 2).
</p>
</li>
<li> <p><code>summary()</code>, this also provides the p-values and standard errors for the
estimates of the coefficients.
</p>
</li>
<li> <p><code>print()</code> prints the estimates within the mathematical representation of the model.
Note that the scalar multiplied with <code>e[t]</code> is the standard deviation
of the residuals, <em>not</em> the variance. See also the model definition above.
</p>
</li>
<li> <p><code>coef()</code>
</p>
</li>
<li> <p><code>confint()</code>
</p>
</li>
<li> <p><code>residuals()</code>
</p>
</li>
<li> <p><code>fitted()</code>
</p>
</li>
<li> <p><code>nobs()</code>
</p>
</li></ul>



<h3>The HysTAR model</h3>

<p>The HysTAR model is defined as:
</p>
<p><code class="reqn"> y_t = \begin{cases} \phi_{00} + \phi_{01} y_{t-1} + \cdots +
  \phi_{0 p_0} y_{t-p_0} + \sigma_{0} \epsilon_{t} \quad \mathrm{if}~R_{t} = 0 \\
  \phi_{10} + \phi_{11} y_{t-1} + \cdots + \phi_{1 p_1} y_{t-p_1} + \sigma_{1} \epsilon_{t}
  \quad \mathrm{if}~R_{t} = 1, \\ \end{cases} </code>
</p>
<p>with <code class="reqn"> R_t = \begin{cases} 0 \quad \quad \mathrm{if} \, z_{t-d} \in (-\infty, r_{0}] \\
  R_{t-1} \quad \mathrm{if} \, z_{t-d} \in (r_0, r_1] \\ 1 \quad \quad \mathrm{if} \, z_{t-d}
  \in (r_1, \infty), \\ \end{cases} </code>
</p>
<p>where <code class="reqn">p_j</code> denotes the order of regime <code class="reqn">j \in \{0,1\}</code> with
coefficients <code class="reqn">\phi_{j0}, \dots, \phi_{j p_j \in (-1, 1)}</code>,
<code class="reqn">\sigma_{j}</code> is the standard deviation of the residuals, and <code class="reqn">d \in
  \{0, 1, 2, \dots\}</code> is a delay parameter. The parameters of primary interest are
the thresholds <code class="reqn">r_0 \le r_1</code>. We let <code class="reqn">t = 0, 1, 2, ..., T</code>, where <code class="reqn">T</code>
is the number of observations.
</p>


<h3>Author(s)</h3>

<p>Daan de Jong.
</p>


<h3>References</h3>

<p>Li, Guodong, Bo Guan, Wai Keung Li, en Philip L. H. Yu.
‘Hysteretic Autoregressive Time Series Models’. Biometrika 102, nr. 3
(september 2015): 717–23.
</p>
<p>Zhu, Ke, Philip L H Yu, en Wai Keung Li. ‘Testing for the Buffered
Autoregressive Process’. Munich Personal RePEc Archive, (november 2013).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z &lt;- z_sim(n_t = 200, n_switches = 5, start_regime = 1)
sim &lt;- hystar_sim(z = z, r = c(-.5, .5), d = 2, phi_R0 = c(0, .6), phi_R1 = 1)
plot(sim)
fit &lt;- hystar_fit(sim$data)
summary(fit)
</code></pre>

<hr>
<h2 id='hystar_sim'>Simulate data from the HysTAR model</h2><span id='topic+hystar_sim'></span>

<h3>Description</h3>

<p>With this function, you can simulate observations from the
HysTAR model, given its parameter values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hystar_sim(z, r, d, phi_R0, phi_R1, resvar = c(1, 1), start_regime = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hystar_sim_+3A_z">z</code></td>
<td>
<p>A numeric vector representing the observed threshold variable.
You can simulate <code>z</code> with <code><a href="#topic+z_sim">z_sim()</a></code>. Can not have missing values.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_r">r</code></td>
<td>
<p>A numeric vector of length 2, representing the threshold values
<code class="reqn">r_0</code> and <code class="reqn">r_1</code>. The values must be inside the range of z, that is,
larger than <code>min(z)</code> and smaller than <code>max(z)</code>. Otherwise, only one regime will
be active so you might as well simulate an AR process, e.g. with <code><a href="stats.html#topic+arima.sim">arima.sim()</a></code>.
If you simulated <code>z</code> with <code>z_sim()</code> and <code>start_hyst = TRUE</code>, make sure to
set the threshold values around the middle of the range of <code>z</code>, otherwise,
the start will not be hysteretic.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_d">d</code></td>
<td>
<p>A positive whole number representing the value of the
delay parameter. It must be smaller than <code>length(z)</code>.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_phi_r0">phi_R0</code></td>
<td>
<p>A vector containing the constant and autoregressive parameters
<code class="reqn">(\phi_0^{(0)}, \phi_1^{(0)}, \dots, \phi_{p_0}^{(0)})</code> of Regime 0.
Note that the first value of this vector is <em>always</em> interpreted as the
constant, so for an AR(1) process with no constant, you must use
<code>phi_R0 = c(0, .5)</code>, for example. Both orders must be smaller than <code>length(z)</code>.
For valid standard errors of the estimates in <code><a href="#topic+hystar_fit">hystar_fit()</a></code>, the coefficients
should imply that <code>y</code> is stationary, see Details.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_phi_r1">phi_R1</code></td>
<td>
<p>The same as <code>phi_R0</code>, but for Regime 1.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_resvar">resvar</code></td>
<td>
<p>A numeric vector of length 2 representing the variances of the
residuals <code class="reqn">\sigma_{(0)}^2</code> and <code class="reqn">\sigma_{(1)}^2</code>. The residuals are
sampled from a normal distribution in the current implementation, but note
that the model is defined for any i.i.d. vector of residuals with zero mean and
finite variance.</p>
</td></tr>
<tr><td><code id="hystar_sim_+3A_start_regime">start_regime</code></td>
<td>
<p>Optionally, a 0 or 1 that indicates which regime should be the
first, in case the <code>z</code> variable starts in the hysteresis zone.
This is only necessary when you use your 'own' <code>z</code> variable
AND <code>z</code> starts in the hysteresis zone.
A vector <code>z</code> simulated with <code><a href="#topic+z_sim">z_sim()</a></code> will contain information about if
the start is hysteretic and what the starting regime is supposed to be
(in the <code>attributes()</code> of <code>z</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Some details:
</p>

<ul>
<li><p> To simulate <code>y</code>, 50 burn-in samples according the starting regime are used.
</p>
</li>
<li><p> The coefficients imply a stationary process of <code class="reqn">y_t</code> if
<code class="reqn">\sum_{i=1}^{p_0} \phi_i^{(0)} &lt; 1</code> and
<code class="reqn">\sum_{i=1}^{p_1} \phi_i^{(1)} &lt; 1</code>. See Zhu, Yu and Li (2013), p5.
</p>
</li></ul>



<h3>Value</h3>

<p>A list of class <code>hystar_sim</code> with elements
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;$data&#8288;</code>, a <code>data.frame</code> with <code>length(z)</code> rows and 4 columns:
</p>

<ul>
<li> <p><code>y</code>, the outcome variable
</p>
</li>
<li> <p><code>z</code>, the threshold variable
</p>
</li>
<li> <p><code>H</code>, a logical vector that indicates at which time
points the hysteresis effect is happening. Note that this vector starts
with <code>NA</code>(s), since the first <code class="reqn">d</code> time points have no values observed
for <code class="reqn">z_{t-d}</code>.
</p>
</li>
<li> <p><code>R</code>, the regime indicator vector.
</p>
</li></ul>

</li>
<li> <p><code style="white-space: pre;">&#8288;$r&#8288;</code>, a numeric vector with the two threshold values,
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$d&#8288;</code>, the delay parameter,
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$phi&#8288;</code>, a numeric vector containing the coefficients. The names are such
that <code>phi_R1_2</code> represents <code class="reqn">\phi_{2}^{(1)}</code>, the second lag
autoregressive coefficient in Regime 1,
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$orders&#8288;</code>, a numeric vector containing the two orders, and
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$resvar&#8288;</code>, a numeric vector with the residual variances of both regimes.
</p>
</li></ul>

<p>Implemented generics for the <code>hystar_sim</code> class:
</p>

<ul>
<li> <p><code>plot()</code> plots the <code>z</code> variable and the <code>y</code> variable above one another.
Shading of the background visualizes the regimes. Thresholds are drawn as
horizontal lines in the <code>z</code> plot. You can provide regime_names (char vector of 2),
main (char vector of 1), xlab (char vector of 1) and ylab (char vector of 2).
</p>
</li>
<li> <p><code>summary()</code> gives an overview of the true parameter values that were used.
</p>
</li>
<li> <p><code>print()</code> prints the parameter values within the mathematical representation
of the model. Note that the scalar multiplied with <code>e[t]</code> is the standard deviation
of the residuals, <em>not</em> the variance. See also the model definition above.
</p>
</li></ul>



<h3>The HysTAR model</h3>

<p>The HysTAR model is defined as:
</p>
<p><code class="reqn"> y_t = \begin{cases} \phi_{00} + \phi_{01} y_{t-1} + \cdots +
  \phi_{0 p_0} y_{t-p_0} + \sigma_{0} \epsilon_{t} \quad \mathrm{if}~R_{t} = 0 \\
  \phi_{10} + \phi_{11} y_{t-1} + \cdots + \phi_{1 p_1} y_{t-p_1} + \sigma_{1} \epsilon_{t}
  \quad \mathrm{if}~R_{t} = 1, \\ \end{cases} </code>
</p>
<p>with <code class="reqn"> R_t = \begin{cases} 0 \quad \quad \mathrm{if} \, z_{t-d} \in (-\infty, r_{0}] \\
  R_{t-1} \quad \mathrm{if} \, z_{t-d} \in (r_0, r_1] \\ 1 \quad \quad \mathrm{if} \, z_{t-d}
  \in (r_1, \infty), \\ \end{cases} </code>
</p>
<p>where <code class="reqn">p_j</code> denotes the order of regime <code class="reqn">j \in \{0,1\}</code> with
coefficients <code class="reqn">\phi_{j0}, \dots, \phi_{j p_j \in (-1, 1)}</code>,
<code class="reqn">\sigma_{j}</code> is the standard deviation of the residuals, and <code class="reqn">d \in
  \{0, 1, 2, \dots\}</code> is a delay parameter. The parameters of primary interest are
the thresholds <code class="reqn">r_0 \le r_1</code>. We let <code class="reqn">t = 0, 1, 2, ..., T</code>, where <code class="reqn">T</code>
is the number of observations.
</p>


<h3>Author(s)</h3>

<p>Daan de Jong.
</p>


<h3>References</h3>

<p>Li, Guodong, Bo Guan, Wai Keung Li, en Philip L. H. Yu.
‘Hysteretic Autoregressive Time Series Models’. Biometrika 102, nr. 3
(september 2015): 717–23.
</p>
<p>Zhu, Ke, Philip L H Yu, en Wai Keung Li. ‘Testing for the Buffered
Autoregressive Process’. Munich Personal RePEc Archive, (november 2013).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z &lt;- z_sim(n_t = 200, n_switches = 5, start_regime = 1)
sim &lt;- hystar_sim(z = z, r = c(-.5, .5), d = 2, phi_R0 = c(0, .6), phi_R1 = 1)
plot(sim)
fit &lt;- hystar_fit(sim$data)
summary(fit)
</code></pre>

<hr>
<h2 id='z_sim'>Simulate the threshold/control variable Z</h2><span id='topic+z_sim'></span>

<h3>Description</h3>

<p>This is a function you can use to simulate time series data
for a threshold variable of the HysTAR model. The time series is a (co)sine
wave, such that thresholds are crossed in a predictable way.
This function is designed to be used in combination with <code>hystar_sim()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>z_sim(n_t, n_switches, start_regime = 0, start_hyst = FALSE, range = c(-1, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="z_sim_+3A_n_t">n_t</code></td>
<td>
<p>The desired length of the simulated time series of <code>z</code>. The actual
vector that is returned will contain 10 more time points, see Details.
Note that <code>n_t</code> will also be the length of <code>y</code>, when you feed <code>z</code> to <code><a href="#topic+hystar_sim">hystar_sim</a></code>.</p>
</td></tr>
<tr><td><code id="z_sim_+3A_n_switches">n_switches</code></td>
<td>
<p>A scalar indicating the desired number of regime switches.
Basically, it is the number of times the variable moves to (and reaches) its
minimum or to its maximum. If the thresholds are within the range of <code>z</code>,
as they should, this will guarantee the same number of regime switches when
the delay parameter of the HysTAR model is greater or equal than the highest order.
See Details.</p>
</td></tr>
<tr><td><code id="z_sim_+3A_start_regime">start_regime</code></td>
<td>
<p>The starting regime of the HysTAR model, 0 (default) or 1.</p>
</td></tr>
<tr><td><code id="z_sim_+3A_start_hyst">start_hyst</code></td>
<td>
<p>Logical, should <code>z</code> start in the hysteresis zone? Of course, this also
depends on <code>r</code>, and <code>r</code> is not yet specified in this function. Rather, setting <code>start_hyst</code>
to <code>TRUE</code> makes <code>z</code> start at in the middle of its range, which makes it easy to
set the threshold values &quot;around&quot; the first values of <code>z</code>.</p>
</td></tr>
<tr><td><code id="z_sim_+3A_range">range</code></td>
<td>
<p>A numeric vector of length 2 indicating the desired range (min, max) of <code>z</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first value of <code>y</code> that can be predicted in the HysTAR model is
at time point <code class="reqn">\max\{d, p\} + 1</code>, where <code class="reqn">p = \max\{p_0, p_1\}</code>.
This is because we need to observe <code class="reqn">y_{t - p}</code> and <code class="reqn">z_{t - d}</code>.
So the first observed value of <code>z</code> that determines a regime
is at time point <code class="reqn">\max\{d, p\} + 1 - d</code>.
To make sure that this time point corresponds to the start that you request,
<code>z_sim()</code> starts with 10 extra time points. In this way, <code><a href="#topic+hystar_sim">hystar_sim</a></code> can
select the appropriate time points, based on <code>d</code> and <code>p0</code>, <code>p1</code>.
</p>


<h3>Value</h3>

<p>A numeric vector of length <code>n_t</code>. This vector has two attributes
<code>"start_regime"</code> and <code>"start_hyst"</code> corresponding to the values you provided.
These attributes are used by <code><a href="#topic+hystar_sim">hystar_sim()</a></code>.
</p>


<h3>The HysTAR model</h3>

<p>The HysTAR model is defined as:
</p>
<p><code class="reqn"> y_t = \begin{cases} \phi_{00} + \phi_{01} y_{t-1} + \cdots +
  \phi_{0 p_0} y_{t-p_0} + \sigma_{0} \epsilon_{t} \quad \mathrm{if}~R_{t} = 0 \\
  \phi_{10} + \phi_{11} y_{t-1} + \cdots + \phi_{1 p_1} y_{t-p_1} + \sigma_{1} \epsilon_{t}
  \quad \mathrm{if}~R_{t} = 1, \\ \end{cases} </code>
</p>
<p>with <code class="reqn"> R_t = \begin{cases} 0 \quad \quad \mathrm{if} \, z_{t-d} \in (-\infty, r_{0}] \\
  R_{t-1} \quad \mathrm{if} \, z_{t-d} \in (r_0, r_1] \\ 1 \quad \quad \mathrm{if} \, z_{t-d}
  \in (r_1, \infty), \\ \end{cases} </code>
</p>
<p>where <code class="reqn">p_j</code> denotes the order of regime <code class="reqn">j \in \{0,1\}</code> with
coefficients <code class="reqn">\phi_{j0}, \dots, \phi_{j p_j \in (-1, 1)}</code>,
<code class="reqn">\sigma_{j}</code> is the standard deviation of the residuals, and <code class="reqn">d \in
  \{0, 1, 2, \dots\}</code> is a delay parameter. The parameters of primary interest are
the thresholds <code class="reqn">r_0 \le r_1</code>. We let <code class="reqn">t = 0, 1, 2, ..., T</code>, where <code class="reqn">T</code>
is the number of observations.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z &lt;- z_sim(n_t = 200, n_switches = 5, start_regime = 1)
sim &lt;- hystar_sim(z = z, r = c(-.5, .5), d = 2, phi_R0 = c(0, .6), phi_R1 = 1)
plot(sim)
fit &lt;- hystar_fit(sim$data)
summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
