<!DOCTYPE html><html lang="en"><head><title>Help for package anoint</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {anoint}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anoint-package'>
<p>Analysis of interactions for generalized linear models (GLM) or Cox proportional hazards regression models.</p></a></li>
<li><a href='#anoint'><p>Create analysis of interactions object</p></a></li>
<li><a href='#anoint.fit'><p>Fits and global tests of analysis of interaction models</p></a></li>
<li><a href='#anoint.formula'><p>Create a <code>formula.anoint</code> object</p></a></li>
<li><a href='#anoint.subgroups'><p>Perform one-by-one subgroup analyses</p></a></li>
<li><a href='#coef'><p>Get coefs from <code>pim</code> object.</p></a></li>
<li><a href='#confint'><p>Compute confindence intervals of <code>pim</code> model terms.</p></a></li>
<li><a href='#data.anoint'><p>Generate a clinical trial data set under a specified multiple interaction model</p></a></li>
<li><a href='#fits'><p>Extract fits from <code>anoint.fit</code> object</p></a></li>
<li><a href='#forest'><p>Construct a forestplot from a <code>anoint</code> object</p></a></li>
<li><a href='#forest.subsets'><p>Subsets forest plot for proportional interactions models</p></a></li>
<li><a href='#formula.anoint-class'><p>Class &quot;formula.anoint&quot;</p></a></li>
<li><a href='#obo'><p>Perform one-by-one (OBO) estimates of treatment-covariate interaction</p></a></li>
<li><a href='#pim'><p>Fit proportional interaction model</p></a></li>
<li><a href='#pim-class'><p>Class &quot;pim&quot;</p></a></li>
<li><a href='#pim.fit'><p>Fit proportional interactions model</p></a></li>
<li><a href='#pim.subsets'><p>Perform all subsets proportional interactions modeling</p></a></li>
<li><a href='#plot'><p>Prognostic response plot (PR-plot) for <code>anoint</code> class.</p></a></li>
<li><a href='#predict'><p>Get risk predictions for <code>pim</code> object.</p></a></li>
<li><a href='#print'><p>Print coefficients of <code>pim</code></p></a></li>
<li><a href='#prognostic.score'><p>Prognostic scores for <code>pim</code> object.</p></a></li>
<li><a href='#show'><p>Show coefficients of <code>pim</code></p></a></li>
<li><a href='#show-anoint.fit'><p>Show table of LRT global test results for <code>anoint.fit</code> object</p></a></li>
<li><a href='#show.anoint'><p>Show <code>anoint</code> object</p></a></li>
<li><a href='#show.formula.anoint'><p>Show <code>formula.anoint</code> object</p></a></li>
<li><a href='#simsolvd'><p>Simulated SOLVD-Trial data set</p></a></li>
<li><a href='#summary'><p>Summary of <code>anoint</code> model fit.</p></a></li>
<li><a href='#uim'><p>Perform unrestricted multiple treatment-covariate interaction regression</p></a></li>
<li><a href='#vcov'><p>Get variance-covariance from <code>pim</code> object.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Interactions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-09-04</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ravi Varadhan &lt;ravi.varadhan@jhu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The tools in this package are intended to help researchers assess multiple treatment-covariate interactions with data from a parallel-group randomized controlled clinical trial. The methods implemented in the package were proposed in Kovalchik, Varadhan and Weiss (2013) &lt;<a href="https://doi.org/10.1002%2Fsim.5881">doi:10.1002/sim.5881</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.13.0), stats, survival, MASS, graphics, grid</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, glmnet</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-04 15:07:59 UTC; raviv</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Author:</td>
<td>Ravi Varadhan [aut, cre],
  Stephanie Kovalchik [aut],
  Leon Wang [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-09 10:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='anoint-package'>
Analysis of interactions for generalized linear models (GLM) or Cox proportional hazards regression models.
</h2><span id='topic+anoint-package'></span>

<h3>Description</h3>

<p>Testing procedures and models for investigating the heterogeneity of treatment effect in a clinical trial with multiple baseline covariates.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> anoint</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-7-10</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Ravi Varadhan &lt;rvaradhan@jhmi.edu&gt; and Stephanie Kovalchik (maintainer) &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>References</h3>

<p>Follmann DA, Proschan MA. A multivariate test of interaction for use in clinical trials. <em>Biometrics</em> 1999; 55(4):1151-1155
</p>

<hr>
<h2 id='anoint'>Create analysis of interactions object</h2><span id='topic+anoint'></span><span id='topic+anoint-class'></span>

<h3>Description</h3>

<p>Prepares formula and data to be used in methods with the analysis of interactions class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anoint(formula,data,family="binomial",select=NULL,nfolds=10,
  type.measure="deviance",keep.vars=NULL,na.action=na.omit,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anoint_+3A_formula">formula</code></td>
<td>
<p>analysis of interaction formula for <code>glm</code> or <code>coxph</code>, see details</p>
</td></tr>
<tr><td><code id="anoint_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code></p>
</td></tr>
<tr><td><code id="anoint_+3A_family">family</code></td>
<td>
<p>character specifying family of <code>glm</code> or character &quot;coxph&quot; if <code>coxph</code> model is fit</p>
</td></tr>
<tr><td><code id="anoint_+3A_select">select</code></td>
<td>
<p>character for type of selection to perform, either &quot;<code>stepAIC</code>&quot; or &quot;<code>glmnet</code>&quot;.</p>
</td></tr> 
<tr><td><code id="anoint_+3A_nfolds">nfolds</code></td>
<td>
<p>number of folds used in cross-validation to find lasso penalty parameter when <code>select</code> is set to <code>TRUE</code>. Used only when <code>select</code> is <code>glmnet</code>. See <a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></p>
</td></tr>
<tr><td><code id="anoint_+3A_type.measure">type.measure</code></td>
<td>
<p>loss to use for cross-validation. Used only when <code>select</code> is <code>glmnet</code>. See <a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></p>
</td></tr>
<tr><td><code id="anoint_+3A_keep.vars">keep.vars</code></td>
<td>
<p>vector of names of variables to retain if selection procedure is used. Used only when <code>select</code> is <code>glmnet</code>.</p>
</td></tr>
<tr><td><code id="anoint_+3A_na.action">na.action</code></td>
<td>
<p>function, <a href="stats.html#topic+na.action">na.action</a> to perform for handling observations with missing variables among variables in formula. Default is <code>na.omit</code></p>
</td></tr>
<tr><td><code id="anoint_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>cv.glmnet</code> when <code>select</code> is <code>glmnet</code> or <code>stepAIC</code> when <code>select</code> is <code>stepAIC</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To test proportional multiple interactions between treatment variable indicator <code>z</code> (binary, 0 or 1) and variables <code>a</code>, <code>b</code>, with response <code>y</code> of a GLM model, <code>formula</code> must be <code>y~(a+b)*z</code>. If a Cox model with event time <code>time</code> and event indicator <code>event</code>, <code>formula</code> is <code>Surv(time,event)~(a+b)*z</code>.
</p>
<p>Factors should not be included as <code>a</code> or <code>b</code> because this could change how the reference group is represented in the model. Separate 0/1 dummy variables must be supplied by the user. 
</p>
<p>When <code>select</code> is <code>glmnet</code> a Lasso method (<code>cv.glmnet</code>) is used to select prognostic factors using 10-fold cross-validation with the control data only. If <code>select</code> is set to <a href="MASS.html#topic+stepAIC">stepAIC</a> a stepwise selection procedure is used with specifications based on arguments passed to <code>...</code>.
</p>


<h3>Value</h3>

<p>Returns instance of <code>anoint</code> class.
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>References</h3>

<p>Follmann DA, Proschan MA. A multivariate test of interaction for use in clinical trials. <em>Biometrics</em> 1999; 55(4):1151-1155
</p>


<h3>See Also</h3>

<p><a href="#topic+data.anoint">data.anoint</a>,<a href="glmnet.html#topic+cv.glmnet">cv.glmnet</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# NO INTERACTION CONDITION, LOGISTIC MODEL

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(c(1.5,2)),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival", n = 500
                             )

head(null.interaction)

object &lt;- anoint(Surv(y, event)~(V1+V2)*trt,data=null.interaction,family="coxph")

object

summary(object)

# NO INTERACTION CONDITION, WITH PROGNOSTIC SELECTION

null.interaction &lt;- data.anoint(
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = c(1.5,2,0,0),
                             gamma = rep(1,4),
                             mean = rep(0,4),
                             vcov = diag(4),
                             type="binomial", n = 500
                             )

head(null.interaction)

object &lt;- anoint(y~(V1+V2+V3+V4)*trt,data=null.interaction,select="glmnet")

summary(object)

# FORCE V1, V2 INTO THE MODEL; INTERCEPT IS ALWAYS THE FIRST TERM OF MODEL
object &lt;- anoint(y~(V1+V2+V3+V4)*trt,data=null.interaction,
			select="glmnet",keep.vars=c("V1","V2"))

summary(object)

# SELECTION WITH STEPWISE SELECTION AND AIC CRITERION
object &lt;- anoint(y~(V1+V2+V3+V4)*trt,data=null.interaction,
			select="stepAIC")

summary(object)

</code></pre>

<hr>
<h2 id='anoint.fit'>Fits and global tests of analysis of interaction models</h2><span id='topic+anoint.fit'></span><span id='topic+anoint.fit-class'></span>

<h3>Description</h3>

<p>Fits one-by-one (OBO), unrestricted (UIM), and proportional interaction (PIM) regression models to investigate multiple treatment response factors in a parallel-group clinical trial.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anoint.fit_+3A_object">object</code></td>
<td>
<p>object of <code>anoint</code> class</p>
</td></tr>
<tr><td><code id="anoint.fit_+3A_level">level</code></td>
<td>
<p>significance level for global interaction tests</p>
</td></tr>
<tr><td><code id="anoint.fit_+3A_interval">interval</code></td>
<td>
<p>interval of possible values for responsiveness parameter of PIM</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The global tests for the presence of treatment response factors (treatment-covariate interaction) are one-stage or two-stage likelihood ratio tests.
</p>
<p>The fitted multiple interaction models include: one-by-one univariate interaction models (OBO), a full unrestricted model with all pairwise treatment-covariate interactions (UIM), and a proportional interactions model (PIM) fit with an exact or asymptotic approximate estimate for the likelihood ratio test and responsiveness parameter, <code>theta</code>.
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>anoint.fit(object, level = .05, interval=c(.5,3))</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>K</code></dt><dd><p>number of prognostic factors</p>
</dd>
<dt><code>responsiveness</code></dt><dd><p>list with exact and approximate estimates of PIM responsiveness parameter</p>
</dd>
<dt><code>tests</code></dt><dd><p>list of global interaction test results</p>
</dd>
<dt><code>pvalues</code></dt><dd><p>list of pvalues on which test rejections are based</p>
</dd>
<dt><code>fits</code></dt><dd><p>list of fitted models for each <code>anoint</code> method</p>
</dd>
</dl>

<p>Components of <code>tests</code> are the results of the global tests of interaction:
</p>

<dl>
<dt><code>obo.reject</code></dt><dd><p>Result of unadjusted one-by-one global test of interaction. Null is no effect modification for K subgroups, the alternative is at least one K is an effect modifier.</p>
</dd>
<dt><code>obo.adjust</code></dt><dd><p>Same as <code>obo.reject</code> but with Bonferroni-correction for K comparisons</p>
</dd>
<dt><code>uim.reject</code></dt><dd><p>Result of UIM global test of interaction. Null is no effect modification for K subgroups, the alternative is at least one K is an effect modifier.</p>
</dd>
<dt><code>pim.exact.reject</code></dt><dd><p>Result of PIM exact global test of interaction. Null is no <em>proportional</em> effect modification (theta responsiveness parameter = 1) against the alternative that the treatment responsiveness parameter theta is not equal to 1.</p>
</dd>
<dt><code>pim.approx.reject</code></dt><dd><p>Same as <code>pim.exact.reject</code> but using approximate method.</p>
</dd>
<dt><code>pim.obo</code></dt><dd><p>Two-stage global test. First stage tests PIM using an exact method at <code>level/2</code> significance. If not rejected, the second stage is a test of adjusted OBO with a second-stage global <code>level/2</code> significance.</p>
</dd>
<dt><code>pim.uim</code></dt><dd><p>Same as <code>pim.obo</code> but with UIM at the second stage.</p>
</dd>
</dl>

<p>Components of <code>pvalues</code> on which the global tests are based:
</p>

<dl>
<dt><code>obo.p</code></dt><dd><p>p-value for the maximum LRT of the one-by-one testing</p>
</dd>
<dt><code>uim.p</code></dt><dd><p>p-value for the global LRT of any interaction base on UIM</p>
</dd>
<dt><code>pim.exact.p</code></dt><dd><p>p-value for the test of proportional interaction using the PIM exact method</p>
</dd>
<dt><code>pim.approx.p</code></dt><dd><p>p-value for the test of proportional interaction using the PIM approximate method</p>
</dd>
</dl>

<p>Components of <code>fits</code> are the models underlying the global interaction tests:
</p>

<dl>
<dt><code>obo</code></dt><dd><p>Univariate interaction regression models of each subgroup.</p>
</dd>
<dt><code>uim</code></dt><dd><p>Full regression model with all pairwise treatment-covariate interactionns</p>
</dd>
<dt><code>pim.exact</code></dt><dd><p>Proportional interactions model with exact fit</p>
</dd>
<dt><code>pim.approx</code></dt><dd><p>Proportional interactions model with asymptotic approximate estimation</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "anoint.fit")</code>:
Display table of results of global test of interaction.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "anoint.fit",...)</code>:
Display table of results of global test of interaction.
</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "anoint.fit",...)</code>:
Display results of global test of interaction and p-values. Returns list with <code>tests</code> and <code>pvalues</code>.
</p>
</dd>
<dt>fits</dt><dd><p><code>signature(object = "anoint.fit",type=c("obo","uim","pim.exact","pim.approx")</code>:
Extracts the specified fitted object from a <code>anoint.fit</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="#topic+anoint">anoint</a>,<a href="#topic+anoint-class">anoint-class</a>,<a href="#topic+obo">obo</a>,<a href="#topic+uim">uim</a>,<a href="#topic+pim">pim</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# NO INTERACTION CONDITION, LOGISTIC MODEL

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(c(1.5,2)),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival", n = 500
                             )

object &lt;- anoint(Surv(y, event)~(V1+V2)*trt,data=null.interaction,family="coxph")

fit &lt;- anoint.fit(object)

summary(fit)

fits(fit,type="obo")
</code></pre>

<hr>
<h2 id='anoint.formula'>Create a <code>formula.anoint</code> object</h2><span id='topic+anoint.formula'></span>

<h3>Description</h3>

<p>Create formula for use with <code>anoint</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anoint.formula(formula=y~(a+b)*trt,family="binomial")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anoint.formula_+3A_formula">formula</code></td>
<td>
<p>formula specifying analysis of interaction model</p>
</td></tr>
<tr><td><code id="anoint.formula_+3A_family">family</code></td>
<td>
<p>string indicating model family, should be one of <code>glm</code> families or <code>coxph</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>formula</code> should have all subgroups enclosed in parantheses and the treatment variable as an interaction, as shown in default.
</p>


<h3>Value</h3>

<p>Returns instance of <code>formula.anoint</code> class.
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>See Also</h3>

<p><a href="#topic+formula.anoint-class">formula.anoint-class</a>,<a href="#topic+anoint">anoint</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
anoint.formula()

</code></pre>

<hr>
<h2 id='anoint.subgroups'>Perform one-by-one subgroup analyses</h2><span id='topic+anoint.subgroups'></span>

<h3>Description</h3>

<p>Computes all interaction effects one variable at a time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anoint.subgroups(formula,trt,data,family="binomial",na.action=na.omit,fwer=0.05,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anoint.subgroups_+3A_formula">formula</code></td>
<td>
<p>formula for covariate model as given in <code>glm</code> or <code>coxph</code>, i.e. <code>y~x1+x2</code></p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_trt">trt</code></td>
<td>
<p>character name of treatment assignment indicator</p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code> and <code>trt</code></p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_family">family</code></td>
<td>
<p>character specifying family of <code>glm</code> or character &quot;coxph&quot; if <code>coxph</code> model is fit</p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_na.action">na.action</code></td>
<td>
<p>function, <a href="stats.html#topic+na.action">na.action</a> to perform for handling observations with missing variables among variables in formula. Default is <code>na.omit</code></p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_fwer">fwer</code></td>
<td>
<p>numeric value for the desired familywise error rate, should be between 0 and 1.</p>
</td></tr>
<tr><td><code id="anoint.subgroups_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>glm</code> or <code>coxph</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with 
</p>

<dl>
<dt>subset</dt><dd><p>indicator of the covariates included in the fitted model</p>
</dd>
<dt>interaction</dt><dd><p>value of the of treatment-covariate interaction effect (using model with treatment-covariate product term)</p>
</dd>
<dt>LRT</dt><dd><p>value of likelihood ratio test of treatment-covariate interaction</p>
</dd>
<dt>lower</dt><dd><p>lower endpoints of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>upper</dt><dd><p>upper endpoints of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>pvalue</dt><dd><p>pvalue for 1-df chi-squared test</p>
</dd>
<dt>include.exclude.matrix</dt><dd><p>matrix of same rows as covariates and columns as covariates with logical entries indicating which covariates (columns) were include in the fitted model (row)</p>
</dd>
<dt>covariates</dt><dd><p>vector of covariate names as in formula</p>
</dd>
<dt>reject</dt><dd><p>indicator of rejected hypotheses using a Bonferroni multiple testing correction such that familywise error is controlled at level <code>fwer</code></p>
</dd></dl>
<p>.

</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(11903)

# NO INTERACTION CONDITION, LOGISTIC MODEL

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(c(1.5,2)),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival", n = 500
                             )

head(null.interaction)

anoint.subgroups(Surv(y, event)~V1+V2,trt="trt",data=null.interaction,family="coxph")


# PROPORTIONAL INTERACTION WITH THREE COVARIATES AND BINARY OUTCOME

pim.interaction &lt;- data.anoint(
			     n = 5000,
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = rep(log(.8),3),
                             gamma = rep(1.5,3),
                             mean = c(0,0,0),
                             vcov = diag(3),
                             type="binomial"
                             )

anoint.subgroups(y~V1+V2+V3,trt="trt",data=pim.interaction,family="binomial")
</code></pre>

<hr>
<h2 id='coef'>Get coefs from <code>pim</code> object.</h2><span id='topic+coef'></span><span id='topic+coef+2Cpim-method'></span>

<h3>Description</h3>

<p>Extract vector of coefs of the fit of a <code>pim</code> model.
</p>


<h3>Methods</h3>


<dl>
<dt>coef</dt><dd><p><code>signature(object = "pim")</code>:
Extractor for MLEs returned as a matrix with one column.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='confint'>Compute confindence intervals of <code>pim</code> model terms.</h2><span id='topic+confint'></span><span id='topic+confint+2Cpim-method'></span>

<h3>Description</h3>

<p>Computes Wald-based confidence intervals for the terms of a PIM model.
</p>


<h3>Methods</h3>


<dl>
<dt>confint</dt><dd><p><code>signature(object = "pim", parm,level =0.95,...)</code>:
Returns estimate and confidence intervals for specified <code>parm</code>. Default is to return all params of the model.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='data.anoint'>Generate a clinical trial data set under a specified multiple interaction model</h2><span id='topic+data.anoint'></span>

<h3>Description</h3>

<p>Returns a simulated equal-allocation, parallel-group clinical trial with possibly multiple interactions among prognostic factors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data.anoint(alpha, beta, gamma, mean, vcov, n=100, event=.8,
type = c("binomial","survival"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data.anoint_+3A_alpha">alpha</code></td>
<td>
<p>vector specifying control and treatment group intercept</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_beta">beta</code></td>
<td>
<p>vector specifying prognostic factor main effects</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_gamma">gamma</code></td>
<td>
<p>vector specifying modification of prognostic effects in the presence of treatment</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_mean">mean</code></td>
<td>
<p>vector of covariate mean to be supplied to <code>mvrnorm</code> of the <code>MASS</code> package.</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_vcov">vcov</code></td>
<td>
<p>matrix of variance-covariance matrix of prognostic covariates to be supplied to <code>mvrnorm</code></p>
</td></tr>
<tr><td><code id="data.anoint_+3A_n">n</code></td>
<td>
<p>number of subjects in each treatment arm</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_event">event</code></td>
<td>
<p>proportion of observed events when <code>type</code> is &quot;survival&quot;</p>
</td></tr>
<tr><td><code id="data.anoint_+3A_type">type</code></td>
<td>
<p>string indicating type of response variable</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>type</code> is &quot;survival&quot;, the parameters specify the log-rate for an exponentially distributed random variable. Censored times are non-informatively right-censored. When <code>type</code> is &quot;binomial&quot;, the parameters specify a log-odds model.
</p>


<h3>Value</h3>

<p>Data frame with <code>y</code>, <code>trt</code>, and <code>V1</code>,...,<code>VK</code> prognostic factors. The data frame also has <code>event</code> with a time-to-event reponse, which is an indicator for an observed event.
</p>


<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
null.interaction &lt;- data.anoint(
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = c(1.5,2),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="binomial"
                             )

fit &lt;- glm(y~(.)*trt,data=null.interaction,family="binomial")

summary(fit)


null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = c(1.5,2),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival",
                             event = .7
                             )

fit &lt;- coxph(Surv(y, event)~(.)*trt,data=null.interaction)

summary(fit)
</code></pre>

<hr>
<h2 id='fits'>Extract fits from <code>anoint.fit</code> object</h2><span id='topic+fits'></span><span id='topic+fits+2Canoint.fit-method'></span>

<h3>Description</h3>

<p>Extract the specified <code>anoint</code> model from a <code>anoint.fit</code> object.
</p>


<h3>Methods</h3>


<dl>
<dt>fits</dt><dd><p><code>signature(object = "anoint.fit",type=c("obo","uim","pim.exact","pim.approx")</code>:
Extracts the specified fitted object from a <code>anoint.fit</code>.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='forest'>Construct a forestplot from a <code>anoint</code> object</h2><span id='topic+forest'></span>

<h3>Description</h3>

<p>Constructs a forestplot displaying the treatment effect within subgroups for each set of specified categorical variables. Provides a visual comparison of subgroup treatment effect to overall treatment effect, without adjustment for confounding factors or multiplicity.
</p>
<p>Includes unadjusted p-values for each subgroup's treatment-covariate interaction test for glm or Cox regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
forest(object,terms=NULL,x.axis=NULL,labels=NULL,fun=exp,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forest_+3A_object">object</code></td>
<td>
<p>object of <code>anoint</code> class</p>
</td></tr>
<tr><td><code id="forest_+3A_terms">terms</code></td>
<td>
<p>numeric index indicating which terms in prognostic model to include in plot</p>
</td></tr>
<tr><td><code id="forest_+3A_x.axis">x.axis</code></td>
<td>
<p>Points for tick marks of the bottom axis</p>
</td></tr>
<tr><td><code id="forest_+3A_labels">labels</code></td>
<td>
<p>Matrix of labels of the same rows as <code>onebyone</code>, columns printed from left to right</p>
</td></tr>
<tr><td><code id="forest_+3A_fun">fun</code></td>
<td>
<p>functional transformation applied to treatment effects and confidence intervals</p>
</td></tr>
<tr><td><code id="forest_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>foresplot</code> (see details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional arguments that can be specified include:
</p>

<dl>
<dt>pch.size</dt><dd><p>one number of a vector of two elements indicating the (min, max) for the relative plotting symbols. These reflect the relative precision of the symbol estimates</p>
</dd>
<dt>x.axis</dt><dd><p>Points for tick marks of the bottom axis</p>
</dd>
<dt>header</dt><dd><p>Vector of names for the columns of <code>labels</code></p>
</dd>
<dt>main</dt><dd><p>String of the title of plot</p>
</dd>
</dl>

<p>If no values are specifed for the <code>x.axis</code>, eight values over the range of the CIs is used. 
</p>
<p>If no values are specified for <code>labels</code>, the row names are used.
</p>


<h3>Value</h3>

<p>A labeled forestplot of subgroup treatment effects.
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simsolvd)

obj &lt;- anoint(Surv(ttodthorchfhosp, censor==0)~(nyha+cardratio+current)*trt,data=simsolvd,
       		       family="coxph")

forest(obj)

grid.newpage()

forest(obj,x.axis=seq(0.7,1.5,by=.2))


</code></pre>

<hr>
<h2 id='forest.subsets'>Subsets forest plot for proportional interactions models</h2><span id='topic+forest.subsets'></span>

<h3>Description</h3>

<p>Plot of interaction effects for all possible proportional interactions models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forest.subsets(object, index = 1:(min(length(object$interaction), 
    30)), labels = NULL, exclude.fill = "white", include.fill = "grey30", 
    signif.fill = "red", percent.inner = 0.9, xlimits = NULL, 
    legend = TRUE, subgroup.text = NULL, subgroup.axis = NULL, 
    subgroup.title = "Included Covariates", 
    effects.text = NULL, effects.axis = NULL, confint = TRUE, 
    segments.gpar = NULL, subgroup = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forest.subsets_+3A_object">object</code></td>
<td>
<p>result of <code>pim.subsets</code></p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_index">index</code></td>
<td>
<p>vector indicating which subset models to include in plot, maximum of 30 of the best subsets if not specified.</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_labels">labels</code></td>
<td>
<p>vector of names for subgroups. If <code>NULL</code>, covariates of <code>pim.subsets</code> is used.</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_exclude.fill">exclude.fill</code></td>
<td>
<p>color for grid squares of excluded covariates</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_include.fill">include.fill</code></td>
<td>
<p>color for grid squares of included covariates</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_signif.fill">signif.fill</code></td>
<td>
<p>color for plot circles indicating multiplicity-corrected significance</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_percent.inner">percent.inner</code></td>
<td>
<p>percentage of graphic device window for plot region</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_xlimits">xlimits</code></td>
<td>
<p>vector of two elements indicating minimum and maximum value for effects plot. Values and confidence intervals outside <code>xlimits</code> will be clipped.</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_legend">legend</code></td>
<td>
<p>logical value indicating whether legend for significant values should be included</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_subgroup.text">subgroup.text</code></td>
<td>
<p><code>gpar</code> list for modifying title of subgroup grid</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_subgroup.axis">subgroup.axis</code></td>
<td>
<p><code>gpar</code> list for modifying text of subgroup grid labels</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_subgroup.title">subgroup.title</code></td>
<td>
<p>character for title over inclusion/exclusion grid</p>
</td></tr> 				  
<tr><td><code id="forest.subsets_+3A_effects.text">effects.text</code></td>
<td>
<p><code>gpar</code> list for modifying title of effects plot</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_effects.axis">effects.axis</code></td>
<td>
<p><code>gpar</code> list for modifying text of effects plot axis</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_confint">confint</code></td>
<td>
<p>logical indicating whether to include 95 percent confidence intervals on effects plot</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_segments.gpar">segments.gpar</code></td>
<td>
<p><code>gpar</code> list for rendering of confidence interval segments</p>
</td></tr>
<tr><td><code id="forest.subsets_+3A_subgroup">subgroup</code></td>
<td>
<p>logical indicator of whether fitted object is the result of <code>anoint.subgroups</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The significance level is the multiplicity corrected criterion with <code>fwer</code> control as specified by <code>pim.subsets</code>.
</p>


<h3>Value</h3>

<p>Returns a plot of the results of all subsets of proportional interactions models. On the lefthand side we plot a grid describing the subsets models. This is a grid showing the included and exclude covariates of each proportional interactions model. Each row corresponds to a particular model. Colored squares in each row indicate the covariates given a proportional interaction effect, while unfilled (<code>exclude.fill</code>) indicate covariates left out of the model. The righthand side shows the interaction effect estimates (effects) for the corresponding subset model. 
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>See Also</h3>

<p><a href="#topic+pim.subsets">pim.subsets</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(11903)

# NO INTERACTION CONDITION, LOGISTIC MODEL
# SUPPOSE 5 HYPOTHESIZED EFFECT MODIFIERS

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(rep(1.5,5)),
                             gamma = rep(1,5),
                             mean = rep(0,5),
                             vcov = diag(5),
                             type="survival", n = 500
                             )

head(null.interaction)

fit &lt;- pim.subsets(Surv(y, event)~V1+V2+V3+V4+V5,trt="trt",
		data=null.interaction,family="coxph")

forest.subsets(fit)
</code></pre>

<hr>
<h2 id='formula.anoint-class'>Class &quot;formula.anoint&quot;</h2><span id='topic+formula.anoint-class'></span>

<h3>Description</h3>

<p>Formula class for <code>anoint</code> objects
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("formula.anoint", ...)</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt><code>formula</code>:</dt><dd><p>formula supplied to <code>anoint</code></p>
</dd>
<dt><code>uni</code>:</dt><dd><p>list of all univariate interaction model formulas</p>
</dd>
<dt><code>prognostic</code>:</dt><dd><p>formula of subgroup main effects</p>
</dd>
<dt><code>prognostic.trt</code>:</dt><dd><p>formula of subgroup and treatment main effects model (no interactions)</p>
</dd>
<dt><code>trt</code>:</dt><dd><p>character string of treatment variable</p>
</dd>
<dt><code>family</code>:</dt><dd><p>character string describing model family</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "formula.anoint")</code>:
Display main formula of <code>formula.anoint</code> object.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "formula.anoint",...)</code>:
Display main formula of <code>formula.anoint</code> object.
</p>
</dd>
<dt>update</dt><dd><p><code>signature(object = "formula.anoint",...)</code>:
Updates formula with same syntax as supplied to <code>anoint</code> function.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="#topic+anoint">anoint</a></p>

<hr>
<h2 id='obo'>Perform one-by-one (OBO) estimates of treatment-covariate interaction</h2><span id='topic+obo'></span>

<h3>Description</h3>

<p>Fits GLM of Cox regression models with a treatment-covariate interaction separately for each covariate specified in <code>anoint</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>obo(anoint,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="obo_+3A_anoint">anoint</code></td>
<td>
<p>object of class <code>anoint</code></p>
</td></tr>
<tr><td><code id="obo_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>glm</code> or <code>coxph</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of model fits (<code>fit</code>), interaction likelihood-ratio statistics (<code>LRT</code>), and pvalues per interaction test (<code>pvalue</code>).
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="#topic+anoint">anoint</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simsolvd)

obj &lt;- anoint(Surv(ttodthorchfhosp,censor==0)~(age+beat+lvef)*trt,
				data = simsolvd, family = "coxph")

fits &lt;- obo(obj)

fits

lapply(fits$fit, summary)
</code></pre>

<hr>
<h2 id='pim'>Fit proportional interaction model</h2><span id='topic+pim'></span>

<h3>Description</h3>

<p>Fits a proportional interactions model from parallel-group clinical trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim(object,exact=TRUE,interval=c(-3,3),n.boot=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pim_+3A_object">object</code></td>
<td>
<p>object of class <code>anoint</code></p>
</td></tr>
<tr><td><code id="pim_+3A_exact">exact</code></td>
<td>
<p>logical indicator whether <code>exact</code>  or approximate fit is performed</p>
</td></tr>
<tr><td><code id="pim_+3A_interval">interval</code></td>
<td>
<p>interval passed to <code>optimize</code> if <code>exact</code> is <code>TRUE</code></p>
</td></tr>
<tr><td><code id="pim_+3A_n.boot">n.boot</code></td>
<td>
<p>number of bootstrap resamples for variance calculations</p>
</td></tr>
<tr><td><code id="pim_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>optimize</code> if <code>exact</code> is <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>exact</code> is <code>FALSE</code> the method of Follmann and Proschan (1999) is used to estimate the PIM coefficients and perform a likelihood-ratio test on the responsiveness parameter <code>theta</code>.
</p>
<p>If <code>exact</code> method is specified, then <code>optimize</code> is used to maximize the profile-likelihood alternating between fixing <code>theta</code> and fixing all other PIM parameters. The arguments <code>interval</code> and additional arguments to <code>...</code> control the optimization with respect to <code>theta</code>.
</p>
<p>When <code>n.boot</code> is <code>NULL</code> no bootstrap resamples are taken. In this case, when using the <code>exact</code> method the variance-covariance for the main effects is based on the model likelihood treating the responsiveness parameter as fixed. To include uncertainty measures for the responsiveness parameter, bootstrap resampling can be used. For the approximate method, only the bootstrap resampling variance is provided for the <code>vcov</code> and <code>confint</code> methods, which is invoked by specifying a positive integer number of samples or <code>n.boot</code>. 
</p>


<h3>Value</h3>

<p>Returns instance of <code>pim</code> class.
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>References</h3>

<p>Follmann DA, Proschan MA. A multivariate test of interaction for use in clinical trials. <em>Biometrics</em> 1999; 55(4):1151-1155
</p>


<h3>See Also</h3>

<p><a href="#topic+pim-class">pim-class</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(1115)

pim.interaction &lt;- data.anoint(
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = log(c(1.25,1.5)),
                             gamma = rep(1.2,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="binomial", n = 500
                             )


object &lt;- anoint(y~(V1+V2)*trt,data=pim.interaction,family="binomial")

object

fit &lt;- pim(object)

fit

summary(fit)

# EXAMPLE WITH BOOTSTRAP 
fit &lt;- pim(object, n=50)
summary(fit)
confint(fit)
</code></pre>

<hr>
<h2 id='pim-class'>Class &quot;pim&quot;</h2><span id='topic+pim-class'></span>

<h3>Description</h3>

<p>Class for proportional interactions model (PIM).
</p>


<h3>Objects from the Class</h3>

<p>Objects can be created by calls of the form <code>new("pim", ...)</code>. 
</p>


<h3>Slots</h3>


<dl>
<dt><code>formula</code>:</dt><dd><p>object of <code>anoint</code> class</p>
</dd>
<dt><code>coef</code>:</dt><dd><p>list of baseline (alpha), control prognostic effects (beta), and responsiveness parameter (theta)</p>
</dd>
<dt><code>exact</code>:</dt><dd><p>logical indicator whether <code>exact</code> fit used</p>
</dd>
<dt><code>LRT</code>:</dt><dd><p>likelihood ratio test statistic of responsiveness parameter</p>
</dd>
<dt><code>interval</code>:</dt><dd><p>numeric vector supplied to <code>optimize</code> if <code>exact</code> fit is used</p>
</dd>
<dt><code>boot.pim</code>:</dt><dd><p>matrix of bootstrap estimates of PIM coefficients</p>
</dd>
<dt><code>vcov</code>:</dt><dd><p>matrix of bootstrap variance-covariance</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "pim")</code>:
Display point estimates of <code>pim</code> object.
</p>
</dd>
<dt>print</dt><dd><p><code>signature(x = "pim",...)</code>:
Display point estimates of <code>pim</code> object.
</p>
</dd>
<dt>summary</dt><dd><p><code>signature(object = "pim",...)</code>:
List of estimates and convergence information.
</p>
</dd>
<dt>coef</dt><dd><p><code>signature(object = "pim")</code>:
Extractor for MLEs. 
</p>
</dd>
<dt>confint</dt><dd><p><code>signature(object = "pim",parm,level=0.95,...)</code>:
Computes confidence interval for specified parameters and level. Intervals are based on bootstrap resamples of PIM model. 
</p>
</dd>
<dt>predict</dt><dd><p><code>signature(object = "pim")</code>:
Returns linear predictor for each subject.
</p>
</dd>
<dt>vcov</dt><dd><p><code>signature(object = "pim")</code>:
Extractor for variance-covariance matrix which is estimated with bootstrap resampling.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>See Also</h3>

<p><a href="#topic+pim">pim</a></p>

<hr>
<h2 id='pim.fit'>Fit proportional interactions model</h2><span id='topic+pim.fit'></span>

<h3>Description</h3>

<p>Fits a single proportional interactions model for generalized linear or Cox regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim.fit(formula, trt, data, family="binomial", na.action=na.omit, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pim.fit_+3A_formula">formula</code></td>
<td>
<p>formula for covariate model as given in <code>glm</code> or <code>coxph</code>, i.e. <code>y~x1+x2</code></p>
</td></tr>
<tr><td><code id="pim.fit_+3A_trt">trt</code></td>
<td>
<p>character name of treatment assignment indicator</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code> and <code>trt</code></p>
</td></tr>
<tr><td><code id="pim.fit_+3A_family">family</code></td>
<td>
<p>character specifying family of <code>glm</code> or character &quot;coxph&quot; if <code>coxph</code> model is fit</p>
</td></tr>
<tr><td><code id="pim.fit_+3A_na.action">na.action</code></td>
<td>
<p>function, <a href="stats.html#topic+na.action">na.action</a> to perform for handling observations with missing variables among variables in formula. Default is <code>na.omit</code></p>
</td></tr>
<tr><td><code id="pim.fit_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>glm</code> or <code>coxph</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the proportional interaction model the <code>coef</code> of the main covariate effects in the control arm are multiplied by the <code>interaction</code> effect to get the covariate effects for the treatment group.
</p>


<h3>Value</h3>

<p>Returns a list with 
</p>

<dl>
<dt>interaction</dt><dd><p>value of the interaction effect of the proportional interaction model, see details</p>
</dd>
<dt>LRT</dt><dd><p>value of likelihood ratio test of proportional interaction</p>
</dd>
<dt>lower</dt><dd><p>lower endpoint of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>upper</dt><dd><p>upper endpoint of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>pvalue</dt><dd><p>pvalue for 1-df chi-squared test</p>
</dd>
<dt>model0</dt><dd><p>model object for control group</p>
</dd>
<dt>model1</dt><dd><p>model object for treatment group</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>References</h3>

<p>Follmann DA, Proschan MA. A multivariate test of interaction for use in clinical trials. <em>Biometrics</em> 1999; 55(4):1151-1155
</p>


<h3>See Also</h3>

<p><a href="#topic+pim.subsets">pim.subsets</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(11903)

# NO INTERACTION CONDITION, LOGISTIC MODEL

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(c(1.5,2)),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival", n = 500
                             )

head(null.interaction)

pim.fit(Surv(y, event)~V1+V2,trt="trt",data=null.interaction,family="coxph")


# PROPORTIONAL INTERACTION WITH THREE COVARIATES AND BINARY OUTCOME

pim.interaction &lt;- data.anoint(
			     n = 5000,
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = rep(log(.8),3),
                             gamma = rep(1.5,3),
                             mean = c(0,0,0),
                             vcov = diag(3),
                             type="binomial"
                             )

pim.fit(y~V1+V2+V3,trt="trt",data=pim.interaction,family="binomial")
</code></pre>

<hr>
<h2 id='pim.subsets'>Perform all subsets proportional interactions modeling</h2><span id='topic+pim.subsets'></span>

<h3>Description</h3>

<p>Computes all possible proportional interactions model among <code>p</code> covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pim.subsets(formula,trt,data,family="binomial",na.action=na.omit,fwer=0.05,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pim.subsets_+3A_formula">formula</code></td>
<td>
<p>formula for covariate model as given in <code>glm</code> or <code>coxph</code>, i.e. <code>y~x1+x2</code></p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_trt">trt</code></td>
<td>
<p>character name of treatment assignment indicator</p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_data">data</code></td>
<td>
<p>data.frame containing the variables of <code>formula</code> and <code>trt</code></p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_family">family</code></td>
<td>
<p>character specifying family of <code>glm</code> or character &quot;coxph&quot; if <code>coxph</code> model is fit</p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_na.action">na.action</code></td>
<td>
<p>function, <a href="stats.html#topic+na.action">na.action</a> to perform for handling observations with missing variables among variables in formula. Default is <code>na.omit</code></p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_fwer">fwer</code></td>
<td>
<p>numeric value for the desired familywise error rate, should be between 0 and 1.</p>
</td></tr>
<tr><td><code id="pim.subsets_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>glm</code> or <code>coxph</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Under the proportional interaction model the <code>coef</code> of the main covariate effects in the control arm are multiplied by the <code>interaction</code> effect to get the covariate effects for the treatment group.
</p>


<h3>Value</h3>

<p>Returns a list with 
</p>

<dl>
<dt>subset</dt><dd><p>indicator of the covariates included in the fitted model</p>
</dd>
<dt>interaction</dt><dd><p>value of the interaction effect of the proportional interaction model, see details</p>
</dd>
<dt>LRT</dt><dd><p>value of likelihood ratio test of proportional interaction</p>
</dd>
<dt>lower</dt><dd><p>lower endpoints of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>upper</dt><dd><p>upper endpoints of 95 percent confidence interval for interaction parameter</p>
</dd>
<dt>pvalue</dt><dd><p>pvalue for 1-df chi-squared test</p>
</dd>
<dt>include.exclude.matrix</dt><dd><p>matrix of same rows as subsets and columns as covariates with logical entries indicating which covariates (columns) were include in which subset model (row)</p>
</dd>
<dt>covariates</dt><dd><p>vector of covariate names as in formula</p>
</dd>
<dt>reject</dt><dd><p>indicator of rejected hypotheses using a multiple testing correction such that familywise error is controlled at level <code>fwer</code></p>
</dd></dl>
<p>.

</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>References</h3>

<p>Follmann DA, Proschan MA. A multivariate test of interaction for use in clinical trials. <em>Biometrics</em> 1999; 55(4):1151-1155
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(11903)

# NO INTERACTION CONDITION, LOGISTIC MODEL

null.interaction &lt;- data.anoint(
                             alpha = c(log(.5),log(.5*.75)),
                             beta = log(c(1.5,2)),
                             gamma = rep(1,2),
                             mean = c(0,0),
                             vcov = diag(2),
                             type="survival", n = 500
                             )

head(null.interaction)

pim.subsets(Surv(y, event)~V1+V2,trt="trt",data=null.interaction,family="coxph")


# PROPORTIONAL INTERACTION WITH THREE COVARIATES AND BINARY OUTCOME

pim.interaction &lt;- data.anoint(
			     n = 5000,
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = rep(log(.8),3),
                             gamma = rep(1.5,3),
                             mean = c(0,0,0),
                             vcov = diag(3),
                             type="binomial"
                             )

pim.subsets(y~V1+V2+V3,trt="trt",data=pim.interaction,family="binomial")
</code></pre>

<hr>
<h2 id='plot'>Prognostic response plot (PR-plot) for <code>anoint</code> class.</h2><span id='topic+plot'></span><span id='topic+plot+2Canoint-method'></span>

<h3>Description</h3>

<p>Computes the prognostic score (baseline risk) based on the covariates of <code>anoint</code> or a supplied set of predictions. Risk scores are binned into ten groups based on risk deciles and a treatment effect (and confidence interval) is estimated in each group. This is compared to the overall treatment effect which is indicated by the shaded region.
</p>


<h3>Details</h3>

<p>Additional arguments are passed to <code>glm</code> or <code>coxph</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(object = "anoint",predict=NULL,fun=exp,...)</code>:
Prognostic response plot.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(11903)

# BINOMIAL EVENT DATA WITH 4 NORMAL PROGNOSTIC FACTORS
pim.interaction &lt;- data.anoint(
                             alpha = c(log(.2/.8),log(.2*.75/(1-.2*.75))),
                             beta = log(c(1.5,1.1,2,1.3)),
                             gamma = rep(1.5,4),
                             mean = rep(0,4),
                             vcov = diag(4),
                             type="binomial", n = 500
                             )

object &lt;- anoint(y~(V1+V2+V3+V4)*trt,data=pim.interaction)

plot(object,bty="n",las=1)

# PLOT TREATMENT EFFECT ON LINEAR PREDICTOR SCALE
plot(object,fun=function(x)x,bty="n",las=1,ylab="treatment effect (linear predictor)")

</code></pre>

<hr>
<h2 id='predict'>Get risk predictions for <code>pim</code> object.</h2><span id='topic+predict'></span><span id='topic+predict+2Cpim-method'></span>

<h3>Description</h3>

<p>Computes linear predictors for the dataset used to fit the model.
</p>


<h3>Methods</h3>


<dl>
<dt>predict</dt><dd><p><code>signature(object = "pim")</code>:
Linear predictors for dataset used to fit <code>pim</code> model.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='print'>Print coefficients of <code>pim</code></h2><span id='topic+print'></span><span id='topic+print+2Cpim-method'></span>

<h3>Description</h3>

<p>Prints the regression coefficients of the fit of a <code>pim</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>print</dt><dd><p><code>signature(x = "pim",digits=4,...)</code>:
Prints call, coefficients, and responsiveness parameter for <code>pim</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='prognostic.score'>Prognostic scores for <code>pim</code> object.</h2><span id='topic+prognostic.score'></span><span id='topic+prognostic.score+2Cpim-method'></span>

<h3>Description</h3>

<p>Computes prognostic score from <code>pim</code> model, which is the linear predictor for the main effects of the prognostic factors for untreated subjects.
</p>


<h3>Methods</h3>


<dl>
<dt>prognostic.score</dt><dd><p><code>signature(object = "pim")</code>:
Prognostic score at baseline.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='show'>Show coefficients of <code>pim</code></h2><span id='topic+show'></span><span id='topic+show+2Cpim-method'></span>

<h3>Description</h3>

<p>Shows the regression coefficients of the fit of a <code>pim</code>.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "pim")</code>:
Shows call, coefficients, and multiple interaction parameter for <code>pim</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='show-anoint.fit'>Show table of LRT global test results for <code>anoint.fit</code> object</h2><span id='topic+show+2Canoint.fit-method'></span>

<h3>Description</h3>

<p>Prints a matrix with logical indicators of whether the given <code>anoint</code> test rejected the null hypothesis for the global test of interaction.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "anoint.fit")</code>:
Matrix of logical indicators for global LRT test rejection.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='show.anoint'>Show <code>anoint</code> object</h2><span id='topic+show+2Canoint-method'></span>

<h3>Description</h3>

<p>Shows the formula specification of the <code>anoint</code> object.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "anoint")</code>:
Shows formula call for <code>anoint</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='show.formula.anoint'>Show <code>formula.anoint</code> object</h2><span id='topic+show+2Cformula.anoint-method'></span>

<h3>Description</h3>

<p>Returns the formula of the <code>formula.anoint</code> object.
</p>


<h3>Methods</h3>


<dl>
<dt>show</dt><dd><p><code>signature(object = "formula.anoint")</code>:
Shows formula of the <code>formula.anoint</code> object.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='simsolvd'>Simulated SOLVD-Trial data set</h2><span id='topic+simsolvd'></span>

<h3>Description</h3>

<p>A simulated clinical trial based on the design of the Studies of Left Ventricular Dysfunction Trial (SOLVD-T), a placebo-controlled trial of the angiotensin-converting-enzyme inhibitor enalapril for patients with congestive heart failure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simsolvd)</code></pre>


<h3>Format</h3>

<p>A data frame with 2569 observations on the following 12 variables.
</p>

<dl>
<dt>trt</dt><dd><p>indicator for enalapril group</p>
</dd>
<dt>age</dt><dd><p>age at baseline (centered and scaled)</p>
</dd>
<dt>beat</dt><dd><p>pulse at baseline (centered and scaled)</p>
</dd>
<dt>lymphocyte</dt><dd><p>lymphocyte count at baseline (centered and scaled)</p>
</dd>
<dt>lvef</dt><dd><p>left ventricular ejection fraction at baseline (centered and scaled)</p>
</dd>
<dt>noise</dt><dd><p>simulated vector of random uniform variables</p>
</dd> 
<dt>nyha</dt><dd><p>indicator whether New York Heart Association score greater than 2</p>
</dd>
<dt>cardratio</dt><dd><p>indicator whether cardiothoracic ratio is greater than 0.5</p>
</dd>
<dt>creatinine</dt><dd><p>creatinine at baseline (centered and scaled)</p>
</dd>
<dt>sodium</dt><dd><p>sodium at baseline (centered and scaled)</p>
</dd>
<dt>ttodthorchfhosp</dt><dd><p>time to death or hospitalization in days</p>
</dd>
<dt>censor</dt><dd><p>indicator whether censored (1) or an event (0)</p>
</dd>
<dt>current</dt><dd><p>indicator whether current smoker</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data set based on the clinical study reported by:
Yusuf, S. et al. (1991). Effect of Enalapril on Survival in Patients with Reduced Left-Ventricular Ejection Fractions and Congestive-Heart-Failure. <em>NEJM</em> 325:293-302.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(simsolvd)

obj &lt;- anoint(Surv(ttodthorchfhosp,censor==0)~(age+beat+lvef)*trt,
				data = simsolvd, family = "coxph")

uim(obj)$fit

</code></pre>

<hr>
<h2 id='summary'>Summary of <code>anoint</code> model fit.</h2><span id='topic+summary'></span><span id='topic+summary+2Canoint-method'></span>

<h3>Description</h3>

<p>A list of estimates and convergence status of a <code>anoint</code> model fit. When <code>exact</code> is <code>TRUE</code> the test statistic is the likelihood ratio test, otherwise the Follmann approximate likelihood ratio test statistic is used.
</p>


<h3>Methods</h3>


<dl>
<dt>summary</dt><dd><p><code>signature(x = "anoint",...)</code>:
Calls summary method of underlying model fit.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

<hr>
<h2 id='uim'>Perform unrestricted multiple treatment-covariate interaction regression</h2><span id='topic+uim'></span>

<h3>Description</h3>

<p>Fits GLM of Cox regression analysis for model with all pairwise interactions between treatment and covariates specified in <code>anoint</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uim(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="uim_+3A_object">object</code></td>
<td>
<p>object of class <code>anoint</code></p>
</td></tr>
<tr><td><code id="uim_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>glm</code> or <code>coxph</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of model fit of <code>glm</code> or <code>coxph</code> class (<code>fit</code>), likelihood-ratio test of global test of treatment-covariate interaction (<code>LRT</code>), and LRT p-value for global test of interaction (<code>pvalue</code>).
</p>


<h3>Author(s)</h3>

<p>Stephanie Kovalchik &lt;s.a.kovalchik@gmail.com&gt;</p>


<h3>See Also</h3>

<p><a href="stats.html#topic+glm">glm</a>,<a href="survival.html#topic+coxph">coxph</a>,<a href="#topic+anoint">anoint</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simsolvd)

obj &lt;- anoint(Surv(ttodthorchfhosp,censor==0)~(age+beat+lvef)*trt,
				data = simsolvd, family = "coxph")

fit &lt;- uim(obj)

fit 

summary(fit$fit)
</code></pre>

<hr>
<h2 id='vcov'>Get variance-covariance from <code>pim</code> object.</h2><span id='topic+vcov'></span><span id='topic+vcov+2Cpim-method'></span>

<h3>Description</h3>

<p>Returns Hessian-based variance-covariance matrix of the fit of a <code>pim</code> model. 
</p>


<h3>Methods</h3>


<dl>
<dt>vcov</dt><dd><p><code>signature(object = "pim")</code>:
Extractor for variance-covariance of MLEs. 
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>S. Kovalchik <a href="mailto:s.a.kovalchik@gmail.com">s.a.kovalchik@gmail.com</a></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
