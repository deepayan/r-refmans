<!DOCTYPE html><html><head><title>Help for package warpMix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {warpMix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#criterion'><p>Compute the empirical L_2 distance related to the warping function.</p></a></li>
<li><a href='#estimationTheta'><p>Estimate the warping parameters.</p></a></li>
<li><a href='#initialisationPara'><p>Initialize the functional parameters (associated to the aligned curves).</p></a></li>
<li><a href='#initialisationTheta'><p>Initialize the warping parameters.</p></a></li>
<li><a href='#majPara'><p>Update the functional parameters (associated to the aligned curves).</p></a></li>
<li><a href='#predictionTheta'><p>Predict the warping parameters.</p></a></li>
<li><a href='#warpMix'><p>Estimate the non linear mixed effect functional model.</p></a></li>
<li><a href='#warpTimeFunction'><p>Compute the warped time points</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Mixed Effects Modeling with Warping for Functional Data Using
B-Spline</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Emilie Devijver, Gerda Claeskens, Irene Gijbels</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emilie Devijver &lt;emilie.devijver@kuleuven.be&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Mixed effects modeling with warping for functional data using B-
    spline. Warping coefficients are considered as random effects, and warping
    functions are general functions, parameters representing the projection onto B-
    spline basis of a part of the warping functions. Warped data are modelled by a
    linear mixed effect functional model, the noise is Gaussian and independent from
    the warping functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Imports:</td>
<td>fda (&ge; 2.4.4), fields (&ge; 8.4-1), MASS (&ge; 7.3-44), reshape2
(&ge; 1.4.2), nlme (&ge; 3.1-128), lme4 (&ge; 1.1-12)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.2)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-02-15 13:43:41 UTC; u0106095</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-02-15 15:11:39</td>
</tr>
</table>
<hr>
<h2 id='criterion'>Compute the empirical L_2 distance related to the warping function.</h2><span id='topic+criterion'></span>

<h3>Description</h3>

<p>This function returns the empirical L_2 between two functions, the
first one being warped.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>criterion(t, f, g, theta, splineBasisW)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="criterion_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="criterion_+3A_f">f</code></td>
<td>
<p>A vector of numbers, corresponding to the evaluated function.</p>
</td></tr>
<tr><td><code id="criterion_+3A_g">g</code></td>
<td>
<p>A vector of numbers, corresponding to the evaluated function.</p>
</td></tr>
<tr><td><code id="criterion_+3A_theta">theta</code></td>
<td>
<p>A vector of warping parameters.</p>
</td></tr>
<tr><td><code id="criterion_+3A_splinebasisw">splineBasisW</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the warping functions, evaluted in time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with crit the distance.
</p>

<hr>
<h2 id='estimationTheta'>Estimate the warping parameters.</h2><span id='topic+estimationTheta'></span>

<h3>Description</h3>

<p>This function estimate the warping parameters, knowing the observations and
the individual aligned curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimationTheta(t, y, splineBasisW, indSignal, thetaObs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimationTheta_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="estimationTheta_+3A_y">y</code></td>
<td>
<p>A matrix of numbers, corresponding to observations (size: T * n).</p>
</td></tr>
<tr><td><code id="estimationTheta_+3A_splinebasisw">splineBasisW</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the warping functions, evaluted in time points.</p>
</td></tr>
<tr><td><code id="estimationTheta_+3A_indsignal">indSignal</code></td>
<td>
<p>A matrix, corresponding to the individual aligned curves.</p>
</td></tr>
<tr><td><code id="estimationTheta_+3A_thetaobs">thetaObs</code></td>
<td>
<p>A matrix, corresponding to initial values for the warping parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with theta, a matrix of estimated warping parameters,
and wT, the corresponding warping functions.
</p>

<hr>
<h2 id='initialisationPara'>Initialize the functional parameters (associated to the aligned curves).</h2><span id='topic+initialisationPara'></span>

<h3>Description</h3>

<p>This function initializes the mean curve, the individual effect U_i, related to
aligned curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initialisationPara(t, y, splineBasisMu, splineBasisU, warpTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialisationPara_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="initialisationPara_+3A_y">y</code></td>
<td>
<p>A matrix of numbers, corresponding to observations (size: T * n).</p>
</td></tr>
<tr><td><code id="initialisationPara_+3A_splinebasismu">splineBasisMu</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the global mean function, evaluted in time points.</p>
</td></tr>
<tr><td><code id="initialisationPara_+3A_splinebasisu">splineBasisU</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the individual curves, evaluted in time points.</p>
</td></tr>
<tr><td><code id="initialisationPara_+3A_warptime">warpTime</code></td>
<td>
<p>A matrix, corresponding to warping time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with x, aligned curves, alphaMu the coefficients of the mean curve,
sigmaEpsilon the variance of the noise, sigmaU the variance of the random effects,
and indSignal each individual curves.
</p>

<hr>
<h2 id='initialisationTheta'>Initialize the warping parameters.</h2><span id='topic+initialisationTheta'></span>

<h3>Description</h3>

<p>This function initializes the warping parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>initialisationTheta(t, y, splineBasisW)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="initialisationTheta_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="initialisationTheta_+3A_y">y</code></td>
<td>
<p>A matrix of numbers, corresponding to observations (size: T * n).</p>
</td></tr>
<tr><td><code id="initialisationTheta_+3A_splinebasisw">splineBasisW</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the warping functions, evaluted in time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with theta, a matrix of estimated warping parameters,
and wT, the corresponding warping functions.
</p>

<hr>
<h2 id='majPara'>Update the functional parameters (associated to the aligned curves).</h2><span id='topic+majPara'></span>

<h3>Description</h3>

<p>This function updates the estimations of the mean curve,
the individual effect U_i, related to aligned curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>majPara(t, y, splineBasisMu, splineBasisU, warpTime)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="majPara_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="majPara_+3A_y">y</code></td>
<td>
<p>A matrix of numbers, corresponding to observations (size: T * n).</p>
</td></tr>
<tr><td><code id="majPara_+3A_splinebasismu">splineBasisMu</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the global mean function, evaluted in time points.</p>
</td></tr>
<tr><td><code id="majPara_+3A_splinebasisu">splineBasisU</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the individual curves, evaluted in time points.</p>
</td></tr>
<tr><td><code id="majPara_+3A_warptime">warpTime</code></td>
<td>
<p>A matrix, corresponding to warping time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with x, aligned curves, alphaMu the coefficients of the mean curve,
sigmaEpsilon the variance of the noise, sigmaU the variance of the random effects,
and indSignal the individual curves.
</p>

<hr>
<h2 id='predictionTheta'>Predict the warping parameters.</h2><span id='topic+predictionTheta'></span>

<h3>Description</h3>

<p>This function predict the warping parameters, using the estimations of those parameters,
and fitting a linear mixed effect model on them.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictionTheta(thetaObs, sigmaEpsilon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictionTheta_+3A_thetaobs">thetaObs</code></td>
<td>
<p>A matrix (size: n * T) corresponding of the estimations of the warping parameters.</p>
</td></tr>
<tr><td><code id="predictionTheta_+3A_sigmaepsilon">sigmaEpsilon</code></td>
<td>
<p>A number, defining the variance of the noise in the linear mixed-
effect model fitted on the warping parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list, with theta, a matrix of predicted warping parameters,
sigmaE the covariance of the random effects, and theta0 the mean.
</p>

<hr>
<h2 id='warpMix'>Estimate the non linear mixed effect functional model.</h2><span id='topic+warpMix'></span>

<h3>Description</h3>

<p>This function returns estimates of parameters in the
non linear functional mixed-effect model defined to warp
data and estimate the underlying model with mixed effect.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warpMix(t, y, baseMu, baseU, baseW, sigmaEpsilonTilde = 10^-3,
  threshold = 10^-3, nIte = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warpMix_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_y">y</code></td>
<td>
<p>A matrix of numbers, corresponding to observations (size: T * n).</p>
</td></tr>
<tr><td><code id="warpMix_+3A_basemu">baseMu</code></td>
<td>
<p>A B-spline used to decompose the global mean.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_baseu">baseU</code></td>
<td>
<p>A B-spline used to decompose the individual effects.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_basew">baseW</code></td>
<td>
<p>A B-spline used to decompose the warping functions.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_sigmaepsilontilde">sigmaEpsilonTilde</code></td>
<td>
<p>A number, defining the variance of the noise in the linear mixed-
effect model fitted on the warping parameters.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_threshold">threshold</code></td>
<td>
<p>A number, defining the threshold of convergence.</p>
</td></tr>
<tr><td><code id="warpMix_+3A_nite">nIte</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Notice that the warping parameters are considered as random effects.
</p>


<h3>Value</h3>

<p>A list, with fonct, functional quantities (indCurvAlign
the individual aligned curves, warping the warping functions and theta,
the warping parameters), para the estimates of parameters (alphaMu,
sigmaU,theta0, sigmaTheta, sigmaEpsHat), dist the criterion computed to
reach the convergence, and others other values (successAlphaMu,
initTheta, initPara, CPUtime).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>T = seq(0.5,0.841,length.out = 9)
n = 10
t = c(qnorm(T),1)
mu = cos(2*pi*t+pi/2)
library(fda)
baseMu = create.bspline.basis(c(0,max(t)), norder = 2, breaks = seq(0,1,0.5))
splineBasisMu = eval.basis(t,baseMu)
alphaMu = Data2fd(mu,argvals = t, baseMu)$coef
muApprox = (splineBasisMu) %*% alphaMu
baseU = create.bspline.basis(c(0,max(t)),norder = 2, breaks = seq(0,1,0.5))
mU = baseU$nbasis
sigmaU = diag(0.1,mU)
library(MASS)
alphaU = t(mvrnorm(n,rep(0,mU),sigmaU))
splineBasisU = eval.basis(t,baseU)
U = splineBasisU %*% alphaU
epsilon = t(mvrnorm(n,rep(0,length(t)),0.01 * diag(1,length(t))))
X = as.vector(muApprox) + U + epsilon
baseW = create.bspline.basis(c(0,max(t)), norder = 2, breaks = c(0,0.6,1))
mW = baseW$nbasis
splineBasisW = eval.basis(t,baseW)
theta = t(mvrnorm(n,rep(0,mW),diag(0.1,mW + 1e-3 * diag(1,mW))))
wtheta = matrix(rep(0,n*length(t)),ncol = n)
for (i in c(1:n)){
 wtheta[,i] = warpTimeFunction(splineBasisW,theta[,i],t)$warpTime
}
Y = matrix(0, nrow = length(t), ncol = n)
for (i in c(1:n)){
 y = approxfun(wtheta[,i],X[,i])
 Y[,i] = y(t)
}
warpMix(t,Y,baseMu, baseU, baseW, nIte = 2)



</code></pre>

<hr>
<h2 id='warpTimeFunction'>Compute the warped time points</h2><span id='topic+warpTimeFunction'></span>

<h3>Description</h3>

<p>This function returns warped time points for a known warping parameter theta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>warpTimeFunction(splineBasisW, theta, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="warpTimeFunction_+3A_splinebasisw">splineBasisW</code></td>
<td>
<p>A matrix, corresponding to the spline basis for
the warping functions, evaluted in time points.</p>
</td></tr>
<tr><td><code id="warpTimeFunction_+3A_theta">theta</code></td>
<td>
<p>A matrix, corresponding to initial values for the warping parameters.</p>
</td></tr>
<tr><td><code id="warpTimeFunction_+3A_t">t</code></td>
<td>
<p>A vector of numbers, corresponding to time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector, corresponding to the warped time points.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
