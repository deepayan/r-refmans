<!DOCTYPE html><html><head><title>Help for package MMeM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MMeM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MMeM'><p>MMeM: Estimating the variance covariance components of the multivariate mixed effects model</p></a></li>
<li><a href='#MMeM_henderson3'><p>Multivariate Henderson3 method</p></a></li>
<li><a href='#MMeM_reml'><p>Multivariate REML Method</p></a></li>
<li><a href='#MMeM_terms'><p>parses formulas to creates model matrices</p></a></li>
<li><a href='#simdata'><p>simulated bivariate data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Multivariate Mixed Effects Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luyao Peng &lt;luyaopeng.cn@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzing data under multivariate mixed effects model using multivariate REML and multivariate Henderson3 methods. 
  See Meyer (1985) &lt;<a href="https://doi.org/10.2307%2F2530651">doi:10.2307/2530651</a>&gt; and Wesolowska Janczarek (1984) &lt;<a href="https://doi.org/10.1002%2Fbimj.4710260613">doi:10.1002/bimj.4710260613</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS, Matrix, jointDiag, lme4, matrixcalc, psych,
stringr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/pengluyaoyao/MMeM/issues">https://github.com/pengluyaoyao/MMeM/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-09-07 15:16:34 UTC; pengluyao</td>
</tr>
<tr>
<td>Author:</td>
<td>Luyao Peng [aut, cre],
  Rui Yang [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-09-08 08:00:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='MMeM'>MMeM: Estimating the variance covariance components of the multivariate mixed effects model</h2><span id='topic+MMeM'></span><span id='topic+MMeM-package'></span>

<h3>Description</h3>

<p>This package analyzes data under multivariate mixed effects model using multivariate REML and multivariate Henderson3 methods.
Currently, it only supports multivariate mixed effects model with one fixed effects and one random effects and two response
variates.
See Meyer (1985) &lt;doi:10.2307/2530651&gt; and Wesolowska Janczarek (1984) &lt;doi:10.1002/bimj.4710260613&gt;.
</p>


<h3>Author(s)</h3>

<p>Luyao Peng <a href="mailto:luyaopeng.cn@gmail.com">luyaopeng.cn@gmail.com</a>
</p>
<p>Rui Yang <a href="mailto:ray.cn.us@gmail.com">ray.cn.us@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li><p> Report bugs at <a href="https://github.com/pengluyaoyao/MMeM/issues">https://github.com/pengluyaoyao/MMeM/issues</a>
</p>
</li></ul>


<hr>
<h2 id='MMeM_henderson3'>Multivariate Henderson3 method</h2><span id='topic+MMeM_henderson3'></span>

<h3>Description</h3>

<p>Multivariate Henderson3 method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMeM_henderson3(fml, data, factor_X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MMeM_henderson3_+3A_fml">fml</code></td>
<td>
<p>two-sided linear formula object describing both the fixed-effects and random-effects  parts  of  the  model,
with  the  response  on  the  left  of  a ~ operator. For univariate response, put variable name directly; for multivariate responses
combine variables using concatenate operator, for example, for bivariate responses, c(var1, var2).  The predictor terms are separated  by + operators,  on  the  right.   Random-effects  terms  are
distinguished by vertical bars '|' separating expressions for design matrices from grouping factors.</p>
</td></tr>
<tr><td><code id="MMeM_henderson3_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="MMeM_henderson3_+3A_factor_x">factor_X</code></td>
<td>
<p>(logical) indicating whether predictor is a factor or continuous. By default is TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<ul>
<li> <p><code>T.estimates</code> is the estimated variance covariance components (T.estimates) of the variance covariance matrix of the block random effects with corresponding sampling variances (T.variance)
</p>
</li>
<li> <p><code>E.estimates</code> is the estimated variance covariance components (E.estimates) of the variance covariance matrix of the residuals with corresponding sampling variances (E.variance)
</p>
</li></ul>



<h3>References</h3>

<p>Wesolowska Janczarek, M. T. &quot;Estimation of covariance matrices in unbalanced random and mixed multivariate models.&quot; Biometrical journal 26.6 (1984): 665,674.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
results_henderson &lt;- MMeM_henderson3(fml = c(V1,V2) ~ X_vec + (1|Z_vec),
data = simdata, factor_X = TRUE)

</code></pre>

<hr>
<h2 id='MMeM_reml'>Multivariate REML Method</h2><span id='topic+MMeM_reml'></span>

<h3>Description</h3>

<p>Estimating the variance components under the multivariate mixed effects model using REML methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMeM_reml(fml, data, factor_X, T.start, E.start, maxit = 50,
  tol = 1e-09)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MMeM_reml_+3A_fml">fml</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed-effects and random-effects  parts  of  the  model,
with  the  response  on  the  left  of  a ~ operator. For univariate response, put variable name directly; for multivariate responses
combine variables using concatenate operator, for example, for bivariate responses, c(var1, var2).  The predictor terms are separated  by + operators,  on  the  right.   Random-effects  terms  are
distinguished by vertical bars '|' separating expressions for design matrices from grouping factors.</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_factor_x">factor_X</code></td>
<td>
<p>(logical) indicating whether predictor is a factor or continuous. By default is TRUE</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_t.start">T.start</code></td>
<td>
<p>the starting matrix for the variance covariance matrix of the block random effects, it has to be positive definite q by q symmetric matrix.</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_e.start">E.start</code></td>
<td>
<p>the starting matrix for the variance covariance matrix of the block random effects, it has to be positive definite q by q symmetric matrix.</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of iterations</p>
</td></tr>
<tr><td><code id="MMeM_reml_+3A_tol">tol</code></td>
<td>
<p>the convergence tolerance</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose n observational units, q variates, p fixed effects coefficients and s random effects units.
The model supports multivariate mixed effects model for one-way randomized block design with equal design matrices:
</p>
<p style="text-align: center;"><code class="reqn">Y = XB + ZU + E</code>
</p>

<p>where Y is n by q response variates matrix;
X is n by p design matrix for the fixed effects;
B is p by q coefficients matrix for the fixed effects;
Z is n by s design matrix for the random effects;
U is s by q matrix for the random effects;
E is n by q random errors matrix.
</p>
<p>The model also supports simple OLS multivariate regression:
</p>
<p style="text-align: center;"><code class="reqn">y = Xb + Zu + e</code>
</p>

<p>where y is n by 1 response vector;
b is p by 1 coefficients vector for the fixed effects;
u is s by 1 matrix for the random effects.
</p>


<h3>Value</h3>

<p>The function returns a list with the following objects:
</p>

<ul>
<li> <p><code>T.estimates</code> is the estimated variance covariance components of the variance covariance matrix of the block random effects
</p>
</li>
<li> <p><code>E.estimates</code> is the estimated variance covariance components of the variance covariance matrix of the residuals
</p>
</li>
<li> <p><code>VCOV</code> is the asymptotic
dispersion matrix of the estimated variance covariance components for the block random effects and the residuals.
</p>
</li></ul>



<h3>References</h3>

<p>Meyer, K. &quot;Maximum likelihood estimation of variance components for a multivariate mixed model with equal design matrices.&quot; Biometrics 1985: 153,165.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(simdata)
T.start &lt;- matrix(c(10,5,5,15),2,2)
E.start &lt;- matrix(c(10,1,1,3),2,2)
results_reml &lt;- MMeM_reml(fml = c(V1,V2) ~ X_vec + (1|Z_vec), data = simdata,
factor_X = TRUE, T.start = T.start, E.start = E.start, maxit = 10)


</code></pre>

<hr>
<h2 id='MMeM_terms'>parses formulas to creates model matrices</h2><span id='topic+MMeM_terms'></span>

<h3>Description</h3>

<p>parses formulas to creates model matrices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MMeM_terms(fml, data, factor_X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MMeM_terms_+3A_fml">fml</code></td>
<td>
<p>a two-sided linear formula object describing both the fixed-effects and random-effects  parts  of  the  model,
with  the  response  on  the  left  of  a ~ operator. For univariate response, put variable name directly; for multivariate responses
combine variables using concatenate operator, for example, for bivariate responses, c(var1, var2).  The predictor terms are separated  by + operators,  on  the  right.   Random-effects  terms  are
distinguished by vertical bars '|' separating expressions for design matrices from grouping factors.</p>
</td></tr>
<tr><td><code id="MMeM_terms_+3A_data">data</code></td>
<td>
<p>data frame containing the variables named in formula.</p>
</td></tr>
<tr><td><code id="MMeM_terms_+3A_factor_x">factor_X</code></td>
<td>
<p>(logical) indicating whether predictor is a factor or continuous. By default is TRUE</p>
</td></tr>
</table>

<hr>
<h2 id='simdata'>simulated bivariate data</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>This is a simulated data with 2 dependent variables and one fixed effects
and one random effects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(simdata)
</code></pre>


<h3>Details</h3>

<p>simulated datasets
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
