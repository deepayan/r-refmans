<!DOCTYPE html><html lang="en"><head><title>Help for package mgwrhw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mgwrhw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mgwrhw'><p>mgwrhw</p></a></li>
<li><a href='#redsb'><p>Data to show stunting prevalence in every district from an island</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Displays GWR (Geographically Weighted Regression) and Mixed GWR
Output and Map</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Display processing results using the GWR (Geographically Weighted Regression) method, display maps, and show the results of the Mixed GWR (Mixed Geographically Weighted Regression) model which automatically selects global variables based on variability between regions. This function refers to 
    Yasin, &amp; Purhadi. (2012). "Mixed Geographically Weighted Regression Model (Case Study the Percentage of Poor Households in Mojokerto 2008)". European Journal of Scientific Research, 188-196.
    <a href="https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf">https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Author:</td>
<td>Asy-Syaja'ul Haqqul Amin [cre, aut],
  Waris Marsisno [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Asy-Syaja'ul Haqqul Amin &lt;haqqul.amin06@gmail.com&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>spgwr, sf, psych, ggplot2, dplyr, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-17 16:08:05 UTC; User</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-17 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='mgwrhw'>mgwrhw</h2><span id='topic+mgwrhw'></span>

<h3>Description</h3>

<p>displays the GWR and mixed GWR models automatically along with the tests and significance maps that are formed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mgwrhw(dpk, pers.reg, coor_lat, coor_long, vardep, GWRonly, kp, alp)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mgwrhw_+3A_dpk">dpk</code></td>
<td>
<p>dataframe all variables that come from the shp data format and have geometric attributes that are usually imported with the st_read function from library(sf)</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_pers.reg">pers.reg</code></td>
<td>
<p>The form of the regression equation that will be used as a GWR model is in the general form y~x1+x2+x3</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_coor_lat">coor_lat</code></td>
<td>
<p>the name of the variable that is in the dpk dataframe that contains latitude coordinates and is written with quotation marks such as &quot;Latitude&quot; which indicates a column named Latitude</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_coor_long">coor_long</code></td>
<td>
<p>the name of the variable that is in the dpk dataframe that contains latitude coordinates and is written with quotation marks such as &quot;Longitude&quot; which indicates a column named Longitude</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_vardep">vardep</code></td>
<td>
<p>the name of a variable that is in a dpk dataframe that contains one dependent variable and is written with quotation marks such as &quot;y&quot; which indicates a column named y</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_gwronly">GWRonly</code></td>
<td>
<p>user option to choose to display GWR results only or to form an MGWR model. Option 1 displays GWR output only while option 0 displays GWR and MGWR output.</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_kp">kp</code></td>
<td>
<p>user option to select kernel functions. Option 1 for Fixed Bisquare, option 2 for Fixed Gaussian, option 3 for Adaptive Bisquare, and option 4 for Adaptive Bisquare</p>
</td></tr>
<tr><td><code id="mgwrhw_+3A_alp">alp</code></td>
<td>
<p>alpha value (type 1 error) used in spatial regression model</p>
</td></tr>
</table>


<h3>Value</h3>

<p>no return value, called for side effects
</p>
<p>This function returns a list with the following objects:
</p>


<h4>for Mixed GWR model (GWRonly = 0)</h4>

<p>the general equation form of the Mixed GWR model is
</p>
<p><code class="reqn">y_{i}</code> = <code class="reqn">\beta_{0}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) + <code class="reqn">\sum</code><code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>)<code class="reqn">x_{ik}</code> + <code class="reqn">\sum</code><code class="reqn">\beta_{k}</code><code class="reqn">x_{ik}</code> + <code class="reqn">\epsilon_{i}</code>
</p>

<dl>
<dt>output</dt><dd><p>A character vector containing the captured output of GWR model and Mixed GWR model.</p>
</dd>
<dt>gwr</dt><dd><p>The result of the GWR model include CV, bandwith, Quasi R square, etc.</p>
</dd>
<dt>Variability.Test</dt><dd><p>Results of the variability test for global and local variables.</p>
</dd>
</dl>
<p><code class="reqn">H_{0}</code> : <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{1}</code>,<code class="reqn">v_{1}</code>) = <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{2}</code>,<code class="reqn">v_{2}</code>) = ... = <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{n}</code>,<code class="reqn">v_{n}</code>)
</p>
<p><code class="reqn">H_{1}</code> : not all <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) (<code class="reqn">i</code> = 1, 2, ..., n) are equal
</p>
<p style="text-align: center;"><code class="reqn">F_{Variability.Test_{k}} = \frac{V^{2}_{k}{/}\gamma_{1}}{\widehat{\sigma}}</code>
</p>

<p>Conclusion : Reject <code class="reqn">H_{0}</code> if <code class="reqn">F_{Variability.Test_{k}}</code> <code class="reqn">\geq</code> <code class="reqn">F_{\alpha}</code>(<code class="reqn">\frac{\gamma_{1}^{2}}{\gamma_{2}},\frac{\delta_{1}^{2}}{\delta_{2}}</code>) or p-value &lt; <code class="reqn">\alpha</code>.
</p>
<p>If <code class="reqn">H_{0}</code> is rejected, it means that the k-th variable has a local influence, while if <code class="reqn">H_{0}</code> fails to be rejected, it means that the k-th variable has a global influence.
</p>
<p>Reference : Leung, Y., Mei, C.L., &amp; Zhang, W.X., (2000). &quot;Statistic Tests for Spatial Non-Stationarity Based on the Geographically Weighted Regression Model&quot;, Environment and Planning A, 32 pp. 9-32. <a href="doi:10.1068/a3162">doi:10.1068/a3162</a>.
</p>
<dl>
<dt>F1.F2.F3.mgwr.Test</dt><dd><p>Results of the F1(GoF Mixed GWR), F2(Global Simultaneous), F3(Local Simultaneous) tests.</p>
</dd>
</dl>
<p>F1(GoF Mixed GWR) :
</p>
<p><code class="reqn">H_{0}</code> : <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) = <code class="reqn">\beta_{k}</code>
</p>
<p><code class="reqn">H_{1}</code> : at least there is one  <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) <code class="reqn">\neq</code> <code class="reqn">\beta_{k}</code>
</p>
<p style="text-align: center;"><code class="reqn">F(1) = \frac{y^{T}((I-H)-(I-S)^{T}(I-S))y {/} v_{1}} {y^{T}(I-S)^{T}(I-S)y {/} u_{1}}</code>
</p>

<p>if <code class="reqn">H_{0}</code> is rejected, it shows that the Mixed GWR model is different from the OLS model]
</p>
<p>F2(Global Simultaneous) :
</p>
<p><code class="reqn">H_{0}</code> : <code class="reqn">\beta_{q+1}</code> = <code class="reqn">\beta_{q+2}</code> = ... = <code class="reqn">\beta_{p}</code> = 0
</p>
<p><code class="reqn">H_{1}</code> : at least one of <code class="reqn">\beta_{k}</code> <code class="reqn">\neq</code> 0
</p>
<p style="text-align: center;"><code class="reqn">F(2) = \frac{y^{T}((I-S_{l})^{T}(I-S_{l})-(I-S)^{T}(I-S))y {/} r_{1}} {y^{T}(I-S)^{T}(I-S)y {/} u_{1}}</code>
</p>

<p>If <code class="reqn">H_{0}</code> is rejected, it indicates that there is at least one global variable that has a significant effect in the model
</p>
<p>F3(Local Simultaneous)
</p>
<p><code class="reqn">H_{0}</code> : <code class="reqn">\beta_{1}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) = <code class="reqn">\beta_{2}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) = ... = <code class="reqn">\beta_{q}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) = 0
</p>
<p><code class="reqn">H_{1}</code> : at least one of <code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) <code class="reqn">\neq</code> 0
</p>
<p style="text-align: center;"><code class="reqn">F(2) = \frac{y^{T}((I-S_{g})^{T}(I-S_{g})-(I-S)^{T}(I-S))y {/} r_{1}} {y^{T}(I-S)^{T}(I-S)y {/} u_{1}}</code>
</p>

<p>If <code class="reqn">H_{0}</code> is rejected, it indicates that there is at least one local variable that has a significant effect in the model
</p>
<p>Reference : Yasin, &amp; Purhadi. (2012). &quot;Mixed Geographically Weighted Regression Model (Case Study the Percentage of Poor Households in Mojokerto 2008)&quot;. European Journal of Scientific Research, 188-196.
<a href="https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf">https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf</a>.
</p>
<dl>
<dt>Global.Partial.Test</dt><dd><p>Results of the global partial test.</p>
</dd>
</dl>
<p><code class="reqn">H_{0}</code> : <code class="reqn">\beta_{k}</code> = 0 (k-th global variables are not significant)
</p>
<p><code class="reqn">H_{1}</code> : <code class="reqn">\beta_{k}</code> <code class="reqn">\neq</code> 0 (k-th global variables are significant)
</p>
<p style="text-align: center;"><code class="reqn">T_{g} = \frac{\widehat{\beta_{k}}}{\widehat{\sigma}\sqrt{g_{kk}}}</code>
</p>

<p>If <code class="reqn">H_{0}</code> is rejected, it indicates that the k-th global variable has a significant effect
</p>
<p>Reference : Yasin, &amp; Purhadi. (2012). &quot;Mixed Geographically Weighted Regression Model (Case Study the Percentage of Poor Households in Mojokerto 2008)&quot;. European Journal of Scientific Research, 188-196.
<a href="https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf">https://www.researchgate.net/profile/Hasbi-Yasin-2/publication/289689583_Mixed_geographically_weighted_regression_model_case_study_The_percentage_of_poor_households_in_Mojokerto_2008/links/58e46aa40f7e9bbe9c94d641/Mixed-geographically-weighted-regression-model-case-study-The-percentage-of-poor-households-in-Mojokerto-2008.pdf</a>.
</p>
<dl>
<dt>map.mgwr</dt><dd><p>Visualization of Mixed GWR results in the form of a regional map with variables that are significant globally and locally.</p>
</dd>
<dt>Global_variable</dt><dd><p>A list of global variables used in the analysis.</p>
</dd>
<dt>Local_variable</dt><dd><p>A list of local variables used in the analysis.</p>
</dd>
<dt>AICc</dt><dd><p>The corrected Akaike Information Criterion.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>R_square</dt><dd><p>The coefficient of determination.</p>
</dd>
<dt>adj_R_square</dt><dd><p>The adjusted coefficient of determination.</p>
</dd>
<dt>table.mgwr</dt><dd><p>A data frame about output table of MGWR model (include estimator, standar error, t-statistics, p-value).</p>
</dd>
</dl>




<h4>for GWR model (GWRonly = 1)</h4>

<p>the general equation form of the GWR model is
</p>
<p><code class="reqn">y_{i}</code> = <code class="reqn">\beta_{0}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>) + <code class="reqn">\sum</code><code class="reqn">\beta_{k}</code>(<code class="reqn">u_{i}</code>,<code class="reqn">v_{i}</code>)<code class="reqn">x_{ik}</code> + <code class="reqn">\epsilon_{i}</code>
</p>

<dl>
<dt>output</dt><dd><p>A character vector containing the captured output of GWR model.</p>
</dd>
<dt>gwr</dt><dd><p>A character vector containing the result of the GWR model include CV, bandwith, Quasi R square, etc.</p>
</dd>
<dt>GoF.test</dt><dd><p>A character vector containing the results of the Godness of Fit Test.</p>
</dd>
<dt>anova_gwr</dt><dd><p>Results of the anova table.</p>
</dd>
<dt>map.gwr</dt><dd><p>Visualization of the GWR results.</p>
</dd>
<dt>table.gwr</dt><dd><p>A data frame about output table of GWR model (include estimator, standar error, t-statistics, p-value).</p>
</dd>
</dl>




<h3>Examples</h3>

<pre><code class='language-R'>mod1 = mgwrhw(dpk=redsb, pers.reg = Y ~ X2 + X4 + X5 + X6,
coor_lat = "Latitude", coor_long = "Longitude",
vardep = "Y", GWRonly = 0, kp = 3, alp = 0.05)
mod1$gwr
mod1$Variability.Test
mod1$Global_variable
mod1$Local_variable
mod1$F1.F2.F3.mgwr.Test
mod1$Global.Partial.Test
mod1$map.mgwr
</code></pre>

<hr>
<h2 id='redsb'>Data to show stunting prevalence in every district from an island</h2><span id='topic+redsb'></span>

<h3>Description</h3>

<p>Data to show stunting prevalence in every district from an island
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redsb
</code></pre>


<h3>Format</h3>

<p>An object of class <code>sf</code> (inherits from <code>data.frame</code>) with 33 rows and 15 columns.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
