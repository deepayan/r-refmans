<!DOCTYPE html><html><head><title>Help for package coxphw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {coxphw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coxphw-package'><p> Weighted Estimation in Cox Regression</p></a></li>
<li><a href='#biofeedback'><p>  Biofeedback Treatment Data</p></a></li>
<li><a href='#coef.coxphw'><p> Extract Model Coefficients for Objects of Class <code>coxphw</code></p></a></li>
<li><a href='#concord'><p> Compute Generalized Concordance Probabilities for Objects of Class <code>coxphw</code> or</p>
<code>coxph</code></a></li>
<li><a href='#confint.coxphw'><p> Confidence Intervals for Model Parameters</p></a></li>
<li><a href='#coxphw'><p> Weighted Estimation in Cox Regression</p></a></li>
<li><a href='#coxphw.control'><p>Ancillary arguments for controlling coxphw fits</p></a></li>
<li><a href='#fp.power'><p> Provides Fractional Polynomials as Accessible Function</p></a></li>
<li><a href='#gastric'><p> Gastric Cancer Data</p></a></li>
<li><a href='#plot.coxphw'><p> Plot Weights of Weighted Estimation in Cox Regression</p></a></li>
<li><a href='#plot.coxphw.predict'><p> Plot the Relative or Log Relative Hazard Versus Values of a Continuous Covariable.</p></a></li>
<li><a href='#predict.coxphw'><p>Predictions for a weighted Cox model</p></a></li>
<li><a href='#print.coxphw'><p> Print Method for Objects of Class <code>coxphw</code></p></a></li>
<li><a href='#print.coxphw.predict'><p> Print Method for Objects of Class <code>predict.coxphw</code></p></a></li>
<li><a href='#PT'><p> Pretransformation function</p></a></li>
<li><a href='#summary.coxphw'><p> Summary Method for Objects of Class <code>coxphw</code></p></a></li>
<li><a href='#vcov.coxphw'><p> Obtain the Variance-Covariance Matrix for a Fitted Model Object of Class <code>coxphw</code></p></a></li>
<li><a href='#wald'><p> Wald-Test for Model Coefficients</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Estimation in Cox Regression</td>
</tr>
<tr>
<td>Version:</td>
<td>4.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-31</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements weighted estimation in Cox regression as proposed by
             Schemper, Wakounig and Heinze (Statistics in Medicine, 2009, 
             &lt;<a href="https://doi.org/10.1002%2Fsim.3623">doi:10.1002/sim.3623</a>&gt;) and as described in Dunkler, Ploner, Schemper and 
             Heinze (Journal of Statistical Software, 2018, &lt;<a href="https://doi.org/10.18637%2Fjss.v084.i02">doi:10.18637/jss.v084.i02</a>&gt;). 
             Weighted Cox regression provides unbiased average hazard ratio 
             estimates also in case of non-proportional hazards. 
             Approximated generalized concordance probability an effect size measure for clear-cut
             decisions can be obtained.
             The package provides options to estimate time-dependent effects conveniently by
             including interactions of covariates with arbitrary functions of time, with or without
             making use of the weighting option.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), survival</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/biometrician/coxphw">https://github.com/biometrician/coxphw</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/biometrician/coxphw/issues">https://github.com/biometrician/coxphw/issues</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-28 11:28:44 UTC; Biometrician</td>
</tr>
<tr>
<td>Author:</td>
<td>Daniela Dunkler [aut, cre],
  Georg Heinze [aut],
  Meinhard Ploner [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daniela Dunkler &lt;daniela.dunkler@meduniwien.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-28 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coxphw-package'> Weighted Estimation in Cox Regression </h2><span id='topic+coxphw-package'></span>

<h3>Description</h3>

<p>This package implements weighted estimation in Cox regression as proposed by
Schemper, Wakounig and Heinze (Statistics in Medicine, 2009, <a href="https://doi.org/10.1002/sim.3623">doi:10.1002/sim.3623</a>). Weighted Cox regression
provides unbiased average hazard ratio estimates also in case of non-proportional hazards.
The package provides options to estimate time-dependent effects conveniently by
including interactions of covariates with arbitrary functions of time, with or without
making use of the weighting option. For more details we refer to Dunkler, Ploner, Schemper and Heinze
(Journal of Statistical Software, 2018, <a href="https://doi.org/10.18637/jss.v084.i02">doi:10.18637/jss.v084.i02</a>).  </p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> <code>coxphw</code></td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.0.2</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-06-16</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Main functions included in the <span class="pkg">coxphw</span> package are
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+coxphw">coxphw</a></code>    </td><td style="text-align: left;"> weighted estimation of Cox regression: either (recommended) estimation of </td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> average hazard ratios (Schemper et al., 2009), estimation of average regression </td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> effects (Xu and O'Quigley, 2000), or proportional hazards regression. </td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="graphics.html#topic+plot">plot</a></code>      </td><td style="text-align: left;"> plots the weights used in a weighted Cox regression analysis against time. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+concord">concord</a></code>   </td><td style="text-align: left;"> obtains generalized concordance probabilities with confidence intervalls. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="stats.html#topic+predict">predict</a></code>   </td><td style="text-align: left;"> obtains the effect estimates (of e.g. a nonlinear or a time-dependent effect)</td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> at specified values of a continuous covariable. With <code><a href="#topic+plot.coxphw.predict">plot.coxphw.predict</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> these relative or log relative hazard versus values of the continuous covariable </td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> can be plotted. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+wald">wald</a></code>      </td><td style="text-align: left;"> obtain Wald chi-squared test statistics and p-values for one or more regression </td>
</tr>
<tr>
 <td style="text-align: left;">
                        </td><td style="text-align: left;"> coefficients given their variance-covariance matrix. </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Data sets included in the <span class="pkg">coxphw</span> package are
</p>

<table>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+biofeedback">biofeedback</a></code> </td><td style="text-align: left;"> biofeedback treatment data </td>
</tr>
<tr>
 <td style="text-align: left;">
<code><a href="#topic+gastric">gastric</a></code>     </td><td style="text-align: left;"> gastric cancer data </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Note</h3>

<p> The <code>SAS</code> macro <code>WCM</code> with similar functionality can be obtained at <br />
<a href="https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/wcmcoxphw/">https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/wcmcoxphw/</a>.
</p>
<p>Important version changes: <br />
Up to Version 2.13 <span class="pkg">coxphw</span> used a slightly different syntax (arguments: <code>AHR</code>, <code>AHR.norobust</code>,
<code>ARE</code>, <code>PH</code>, <code>normalize</code>, <code>censcorr</code>, <code>prentice</code>, <code>breslow</code>,
<code>taroneware</code>).
From Version 3.0.0 on the old syntax is disabled.
From Version 4.0.0 fractional polynomials are disabled and <code>plotshape</code> is replaced with <code>predict</code>
and <code>plot.coxphw.predict</code>. </p>


<h3>Author(s)</h3>

<p>Georg Heinze, Meinhard Ploner, Daniela Dunkler <br />
Maintainer: <a href="mailto:daniela.dunkler@meduniwien.ac.at">daniela.dunkler@meduniwien.ac.at</a> </p>


<h3>References</h3>

<p>Dunkler D, Ploner M, Schemper M, Heinze G. (2018) Weighted Cox Regression Using the R Package coxphw. <em>JSS</em> <b>84</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v084.i02">doi:10.18637/jss.v084.i02</a>.
</p>
<p>Dunkler D, Schemper M, Heinze G. (2010) Gene Selection in Microarray Survival Studies Under
Possibly Non-Proportional Hazards. <em>Bioinformatics</em> <b>26</b>:784-90.
</p>
<p>Lin D and Wei L (1989). The Robust Inference for the Cox Proportional Hazards Model.
<em>J AM STAT ASSOC</em> <b>84</b>, 1074-1078.
</p>
<p>Lin D (1991). Goodness-of-Fit Analysis for the Cox Regression Model Based on a Class of Parameter
Estimators. <em>J AM STAT ASSOC</em> <b>86</b>, 725-728.
</p>
<p>Royston P and Altman D (1994). Regression Using Fractional Polynomials of Continuous Covariates:
Parsimonious Parametric Modelling. <em>J R STAT SOC C-APPL</em> <b>43</b>, 429-467.
</p>
<p>Royston P and Sauerbrei W (2008). <em>Multivariable Model-Building. A Pragmatic Approach to Regression
Analysis Based on Fractional Polynomials for Modelling Continuous Variables.</em> Wiley, Chichester, UK.
</p>
<p>Sasieni P (1993). Maximum Weighted Partial Likelihood Estimators for the Cox Model. <em>J AM STAT ASSOC</em>
<b>88</b>, 144-152.
</p>
<p>Schemper M (1992).  Cox Analysis of Survival Data with Non-Proportional Hazard Functions. <em>J R STAT SOC D</em>
<b>41</b>, 455-465.
</p>
<p>Schemper M, Wakounig S and Heinze G (2009). The Estimation of Average Hazard Ratios by Weighted Cox
Regression. <em>Stat Med</em> <b>28</b>, 2473-2489, <a href="https://doi.org/10.1002/sim.3623">doi:10.1002/sim.3623</a>.
</p>
<p>Xu R and O'Quigley J (2000). Estimating Average Regression Effect Under Non-Proportional Hazards.
<em>Biostatistics</em> <b>1</b>, 423-439. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code>, <code><a href="#topic+concord">concord</a></code>, <code><a href="#topic+plot.coxphw">plot.coxphw</a></code>, <code><a href="#topic+predict.coxphw">predict.coxphw</a></code>, <code><a href="#topic+plot.coxphw.predict">plot.coxphw.predict</a></code>, <code><a href="#topic+wald">wald</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>## for examples see coxphw
</code></pre>

<hr>
<h2 id='biofeedback'>  Biofeedback Treatment Data </h2><span id='topic+biofeedback'></span>

<h3>Description</h3>

<p> In this study the effect of biofeedback treatment on time until treatment <code>success</code> 
was evaluated in patients suffering from aspiration after head and neck 
surgery. The outcome of interest was the time from start of treatment until the patient achieved full
swallowing rehabilitation (<code>thdur</code>). Patients were randomized into two groups (<code>bfb</code>): 
one group of patients received videoendoscopic biofeedback treatment; the other group received the 
conservative treatment including thermal stimulation with ice and exercises for the lips, tongue, 
laryngeal closure and elevation. Treatment was started as soon as the healing process after surgery 
was finished (<code>thealing</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(biofeedback)</code></pre>


<h3>Format</h3>

<p>A data frame with 33 observations on the following 6 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p> the patient id. </p>
</dd>
<dt><code>success</code></dt><dd><p> of treatment within the first 100 days; either 0 = no success or 1 = success. </p>
</dd>
<dt><code>thdur</code></dt><dd><p> the duration of therapy in days. </p>
</dd>
<dt><code>bfb</code></dt><dd><p> indicates the treatment group; either 0 = conservative or 1 = biofeedback. </p>
</dd>
<dt><code>theal</code></dt><dd><p> time from surgery to start of therapy in days. </p>
</dd>
<dt><code>log2heal</code></dt><dd><p> log2-transformed time from surgery to start of therapy. </p>
</dd>
</dl>



<h3>Source</h3>

<p>  Data were supplied by Dr. D.-M. Denk, who gave permission to freely distribute 
the data and use them for non-commercial purposes. </p>


<h3>References</h3>

<p> Denk, D.-M. &amp; Kaider, A. (1997). Videoendoscopic Biofeedback: A Simple Method to Improve 
the Efficacy of Swallowing Rehabilitation of Patients After Head and Neck Surgery. <em>ORL J OTO-RHINO-LARY</em>
<b>59</b>, 100-105. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("biofeedback")

plot(survfit(Surv(thdur, success) ~ bfb, data = biofeedback), lty = 1:2, las = 1,
     xlab = "time (days)", ylab = "propability of success")
     
coxphw(Surv(thdur, success) ~ bfb, data = biofeedback,  template = "AHR")     
</code></pre>

<hr>
<h2 id='coef.coxphw'> Extract Model Coefficients for Objects of Class <code>coxphw</code> </h2><span id='topic+coef.coxphw'></span>

<h3>Description</h3>

<p> This class of objects is returned by the <code>coxphw</code> function. 
Objects of this class have methods for the functions <code>summary</code>, <code>print</code>, <code>coef</code>, 
<code>vcov</code>, <code>plot</code> and <code>confint</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
coef(object, ...)
        
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.coxphw_+3A_object">object</code></td>
<td>
<p> object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="coef.coxphw_+3A_...">...</code></td>
<td>
<p> further arguments. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

<hr>
<h2 id='concord'> Compute Generalized Concordance Probabilities for Objects of Class <code>coxphw</code> or  
<code>coxph</code> </h2><span id='topic+concord'></span>

<h3>Description</h3>

<p> Compute generalized concordance probabilities with accompanying 
confidence intervals for objects of class <code>coxphw</code> or <code>coxph</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> concord(fit, digits = 4) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="concord_+3A_fit">fit</code></td>
<td>
<p> an object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="concord_+3A_digits">digits</code></td>
<td>
<p> integer indicating the number of decimal places to be used. Default is 4. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The generalized concordance probability is defined as <code class="reqn">P(T_i &lt; T_j | x_i = x_j + 1)</code>
with <code class="reqn">T_i</code> and <code class="reqn">T_j</code> as survival times of randomly chosen subjects with covariate 
values <code class="reqn">x_i</code> and <code class="reqn">x_j</code>, respectively. Assuming that <code class="reqn">x_i</code> and <code class="reqn">x_j</code> are
1 and 0, respectively, this definition includes a two-group comparison.
</p>
<p>If proportional hazards can be assumed, the generalized concordance probability can also
be derived from Cox proportional hazards regression (<code>coxphw</code> with <code>template = "PH"</code> 
or <code>coxph</code>) or weighted Cox regression as suggested by Xu and O'Quigley (2000)
(<code>coxphw</code> with <code>template = "ARE"</code>).
</p>
<p>If in a fit to <code>coxphw</code> the <code>betafix</code> argument was used, then for the 
fixed parameters only the point estimates are given. </p>


<h3>Value</h3>

<p> A matrix with estimates of the generalized concordance probability with 
accompanying confidence intervalls for each explanatory variable in the model. </p>


<h3>Author(s)</h3>

<p>Daniela Dunkler</p>


<h3>References</h3>

<p> Dunkler D, Schemper M, Heinze G. (2010) Gene Selection in Microarray Survival Studies Under 
Possibly Non-Proportional Hazards. <em>Bioinformatics</em> <b>26</b>:784-90. 
</p>
<p>Xu R and O'Quigley J (2000). Estimating Average Regression Effect Under Non-Proportional Hazards.
<em>Biostatistics</em> <b>1</b>, 423-439. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gastric")
fit &lt;- coxphw(Surv(time, status) ~ radiation, data = gastric, template = "AHR")
concord(fit)
</code></pre>

<hr>
<h2 id='confint.coxphw'> Confidence Intervals for Model Parameters </h2><span id='topic+confint.coxphw'></span>

<h3>Description</h3>

<p> Computes confidence intervals for one or more parameters in a model fitted by 
<code>coxphw</code>. Objects of this class have methods for the functions <code>summary</code>, 
<code>print</code>, <code>coef</code>, <code>vcov</code>, <code>plot</code>, and <code>confint</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
confint(object, parm, level = 0.95, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.coxphw_+3A_object">object</code></td>
<td>
<p> a fitted model object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="confint.coxphw_+3A_parm">parm</code></td>
<td>
<p> a specification of which parameters are to be given confidence intervals, either a 
vector of numbers or a vector of names. If missing, all parameters are considered. </p>
</td></tr>
<tr><td><code id="confint.coxphw_+3A_level">level</code></td>
<td>
<p> the confidence level required. </p>
</td></tr>
<tr><td><code id="confint.coxphw_+3A_...">...</code></td>
<td>
<p> additional argument(s) for methods. </p>
</td></tr>
</table>


<h3>Value</h3>

<p> A matrix (or vector) with columns giving lower and upper confidence limits for each parameter. 
These will be labeled as (1-level)/2 and 1 - (1-level)/2 in % (by default 2.5% and 
97.5%). </p>


<h3>Author(s)</h3>

<p> Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

<hr>
<h2 id='coxphw'> Weighted Estimation in Cox Regression </h2><span id='topic+coxphw'></span>

<h3>Description</h3>

<p> Weighted Cox regression as proposed by Schemper et al. (2009) <a href="https://doi.org/10.1002/sim.3623">doi:10.1002/sim.3623</a>
provides unbiased estimates of average hazard ratios also in case of non-proportional hazards. Time-dependent
effects can be conveniently estimated by including interactions of covariates with arbitrary
functions of time, with or without making use of the weighting option. </p>


<h3>Usage</h3>

<pre><code class='language-R'>coxphw(formula, data, template = c("AHR", "ARE", "PH"), subset, na.action,
       robust = TRUE, jack = FALSE, betafix = NULL, alpha = 0.05,
       trunc.weights = 1, control, caseweights, x = TRUE, y = TRUE,
       verbose = FALSE, sorted = FALSE, id = NULL, clusterid = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxphw_+3A_formula">formula</code></td>
<td>
<p> a formula object with the response on the left of the  operator and the model terms
on the right. The response must be a survival object as returned by
<code><a href="survival.html#topic+Surv">Surv</a></code>. <code>formula</code> may include <code>offset</code>-terms or
functions of time (see example).</p>
</td></tr>
<tr><td><code id="coxphw_+3A_data">data</code></td>
<td>
<p> a data frame in which to interpret the variables named in <code>formula</code>. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_template">template</code></td>
<td>
<p> choose among three pre-defined templates: <code>"AHR"</code> requests estimation of
average hazard ratios (Schemper et al., 2009), <code>"ARE"</code> requests estimation of
average regression effects (Xu and O'Quigley, 2000) and <code>"PH"</code> requests
Cox proportional hazards regression.
Recommended and default template is <code>"AHR"</code>. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_subset">subset</code></td>
<td>
<p>expression indicating which subset of the rows of data should be used in the fit.
All observations are included by default.</p>
</td></tr>
<tr><td><code id="coxphw_+3A_na.action">na.action</code></td>
<td>
<p>missing-data filtering. Defaults to <code>options$na.action</code>. Applied after subsetting data,
but applied to the all variables in the data set (not only those listed in the formula).</p>
</td></tr>
<tr><td><code id="coxphw_+3A_robust">robust</code></td>
<td>
<p> if set to TRUE, the robust covariance estimate (Lin-Wei) is used; otherwise the Lin-Sasieni
covariance estimate is applied. Default is TRUE. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_jack">jack</code></td>
<td>
<p> if set to TRUE, the variance is based on a complete jackknife. Each individual (as
identified by <code>id</code>) is left out in turn. The resulting matrix of DFBETA residuals
D is then used to compute the variance matrix: V = D'D. Default is FALSE. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_betafix">betafix</code></td>
<td>
<p> can be used to restrict the estimation of one or more regression coefficients to pre-defined
values. A vector with one element for each model term as given in <code>formula</code> is expected
(with an identical order as in <code>formula</code>). If estimation of a model term is requested,
then the corresponding element in <code>betafix</code> has to be set to <code>NA</code>, otherwise it
should be set to the fixed parameter value. The default value is <code>betafix = NULL</code>,
yielding unrestricted estimation of all regression coefficients.</p>
</td></tr>
<tr><td><code id="coxphw_+3A_alpha">alpha</code></td>
<td>
<p> the significance level (1-<code class="reqn">\alpha</code>), 0.05 as default. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_trunc.weights">trunc.weights</code></td>
<td>
<p> specifies a quantile at which the (combined normalized) weights are to be truncated.
It can be used to increase the precision of the estimates, particularly if
<code>template</code> <code>= "AHR"</code> or <code>"ARE"</code> is used. Default is 1 (no truncation).
Recommended value is 0.95 for mild truncation. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_control">control</code></td>
<td>
<p> Object of class <code><a href="#topic+coxphw.control">coxphw.control</a></code> specifying iteration limit and other
control options. Default is <code>coxphw.control(...)</code>.  </p>
</td></tr>
<tr><td><code id="coxphw_+3A_caseweights">caseweights</code></td>
<td>
<p> vector of case weights, equivalent to <code>weights</code> in <code><a href="survival.html#topic+coxph">coxph</a></code>.
If <code>caseweights</code> is a vector of integers, then the estimated coefficients
are equivalent to estimating the model from data with the individual cases replicated as
many times as indicated by <code>caseweights</code>. These weights should not be confused with the
weights in weighted Cox regression which account for the non-proportional hazards. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_x">x</code></td>
<td>
<p> requests copying explanatory variables into the output object. Default is TRUE. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_y">y</code></td>
<td>
<p> requests copying survival information into the output object. Default is TRUE. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_verbose">verbose</code></td>
<td>
<p> requests echoing of intermediate results. Default is FALSE. </p>
</td></tr>

<tr><td><code id="coxphw_+3A_sorted">sorted</code></td>
<td>
<p> if set to TRUE, the data set will not be sorted prior to passing it to FORTRAN.
This may speed up computations. Default is FALSE. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_id">id</code></td>
<td>
<p> a vector of subject identification integer numbers starting from 1 used only if the data are
in the counting process format. These IDs are used to compute the robust covariance matrix.
If <code>id = NA</code> (the default) the program assumes that each line of the data set refers to
a distinct subject. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_clusterid">clusterid</code></td>
<td>
<p>a vector of cluster identification integer numbers starting from 1. These IDs are used
to compute the robust covariance matrix. If <code>clusterid = NA</code> (the default) the program
assumes that no cluster exist. </p>
</td></tr>
<tr><td><code id="coxphw_+3A_...">...</code></td>
<td>
<p> additional arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> If Cox's proportional hazards regression is used in the presence of non-proportional
hazards, i.e., with underlying time-dependent hazard ratios of prognostic factors, the average relative
risk for such a factor is under- or overestimated and testing power for the corresponding regression
parameter is reduced. In such a situation weighted estimation provides a parsimonious
alternative to more elaborate modelling of time-dependent effects. Weighted estimation in Cox regression
extends the tests by Breslow and Prentice to a multi-covariate situation as does the Cox model to Mantel's
logrank test. Weighted Cox regression can also be seen as a robust alternative to the standard Cox
estimator, reducing the influence of outlying survival times on parameter estimates.
</p>
<p>Three pre-defined templates can be requested: <br /> 1) <code>"AHR"</code>, i.e., estimation of average hazard ratios
(Schemper et al., 2009) using Prentice weights with censoring correction and robust variance estimation; <br />
2) <code>"ARE"</code>, i.e., estimation of average regression effects (Xu and O'Quigley, 2000) using censoring
correction and robust variance estimation; or <br /> 3) <code>"PH"</code>, i.e., Cox proportional hazards regression
using robust variance estimation.
</p>
<p>Breslow's tie-handling method is used by the program, other methods to handle ties are currently not
available.
</p>
<p>A fit of <code>coxphw</code> with <code>template = "PH"</code> will yield identical estimates as a fit of
<code><a href="survival.html#topic+coxph">coxph</a></code> using Breslow's tie handling method and robust variance estimation
(using <code><a href="survival.html#topic+cluster">cluster</a></code>).
</p>
<p>If <code>robust = FALSE</code>, the program estimates the covariance matrix using the Lin (1991)
and Sasieni (1993) sandwich estimate <code class="reqn">A^{-1}BA^{-1}</code> with <code class="reqn">-A</code> and <code class="reqn">-B</code> denoting the sum
of contributions to the second derivative of the log likelihood, weighted by <code class="reqn">w(t_j)</code> and <code class="reqn">w(t_j)^2</code>,
respectively. This estimate is independent from the scaling of the weights and reduces to the inverse
of the information matrix in case of no weighting. However, it is theoretically valid only in case of
proportional hazards. Therefore, since application of weighted Cox regression usually implies a violated
proportional hazards assumption, the robust Lin-Wei covariance estimate is used by default (<code>robust = </code>
<code>TRUE</code>).
</p>
<p>If some regression coefficients are held constant using <code>betafix</code>, no standard errors
are given for these coefficients as they are not estimated in the model. The global Wald test
only relates to those variables for which regression coefficients were estimated.
</p>
<p>An <code><a href="stats.html#topic+offset">offset</a></code> term can be included in the <code>formula</code> of <code>coxphw</code>.
In this way a variable can be specified which is included in the model but its parameter estimate is
fixed at 1.
</p>


<h3>Value</h3>

<p> A list with the following components:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>the parameter estimates.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>the estimated covariance matrix.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>the degrees of freedom.</p>
</td></tr>
<tr><td><code>ci.lower</code></td>
<td>
<p>the lower confidence limits of exp(beta).</p>
</td></tr>
<tr><td><code>ci.upper</code></td>
<td>
<p>the upper confidence limits of exp(beta).</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the p-values.</p>
</td></tr>
<tr><td><code>linear.predictors</code></td>
<td>
<p>the linear predictors.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code>dfbeta.resid</code></td>
<td>
<p> matrix of DFBETA residuals. </p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>the number of iterations needed to converge.</p>
</td></tr>
<tr><td><code>method.ties</code></td>
<td>
<p>the ties handling method.</p>
</td></tr>
<tr><td><code>PTcoefs</code></td>
<td>
<p> matrix with scale and shift used for pretransformation of <code>fp()</code>-terms. </p>
</td></tr>
<tr><td><code>cov.j</code></td>
<td>
<p>the covariance matrix computed by the jackknife method (only computed if <code>jack = TRUE</code>).</p>
</td></tr>
<tr><td><code>cov.lw</code></td>
<td>
<p>the covariance matrix computed by the Lin-Wei method (robust covariance)</p>
</td></tr>
<tr><td><code>cov.ls</code></td>
<td>
<p>the covariance matrix computed by the Lin-Sasieni method.</p>
</td></tr>
<tr><td><code>cov.method</code></td>
<td>
<p>the method used to compute the (displayed) covariance matrix and the standard errors.
This method is either &quot;jack&quot; if <code>jack = TRUE</code>, or &quot;Lin-Wei&quot; if <code>jack = FALSE</code>. </p>
</td></tr>
<tr><td><code>w.matrix</code></td>
<td>
<p>a matrix with four columns according to the number of uncensored failure
times. The first column contains the failure times, the remaining columns (labeled
<code>w.raw</code>, <code>w.obskm</code>, and <code>w</code>) contain the raw weights, the weights
according to the inverse of the Kaplan-Meier estimates with reverse status indicator
and the normalized product of both.</p>
</td></tr>
<tr><td><code>caseweights</code></td>
<td>
<p> if <code>x = TRUE</code> the case weights. </p>
</td></tr>
<tr><td><code>Wald</code></td>
<td>
<p> Wald-test statistics. </p>
</td></tr>
<tr><td><code>means</code></td>
<td>
<p>the means of the covariates.</p>
</td></tr>
<tr><td><code>offset.values</code></td>
<td>
<p>offset values. </p>
</td></tr>
<tr><td><code>dataline</code></td>
<td>
<p>the first dataline of the input data set (required for <code>plotfp</code>).</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> if <code>x = TRUE</code> the explanatory variables. </p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the response.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>the significance level = 1 - confidence level.</p>
</td></tr>
<tr><td><code>template</code></td>
<td>
<p> the requested template. </p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>the model formula.</p>
</td></tr>
<tr><td><code>betafix</code></td>
<td>
<p>the <code>betafix</code> vector.</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the function call.</p>
</td></tr>








</table>


<h3>Note</h3>

<p> The <code>SAS</code> macro <code>WCM</code> with similar functionality is offered for download at
<a href="https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/wcmcoxphw/">https://cemsiis.meduniwien.ac.at/en/kb/science-research/software/statistical-software/wcmcoxphw/</a> .
</p>
<p>Up to Version 2.13 <span class="pkg">coxphw</span> used a slightly different syntax (arguments: <code>AHR</code>,
<code>AHR.norobust</code>, <code>ARE</code>, <code>PH</code>, <code>normalize</code>, <code>censcorr</code>, <code>prentice</code>,
<code>breslow</code>, <code>taroneware</code>). From Version 3.0.0 on the old syntax is disabled.
From Version 4.0.0 estimation of fractional polynomials is disabled. </p>


<h3>Author(s)</h3>

<p>Georg Heinze, Meinhard Ploner, Daniela Dunkler</p>


<h3>References</h3>

<p>Dunkler D, Ploner M, Schemper M, Heinze G. (2018) Weighted Cox Regression Using the R Package coxphw. <em>JSS</em> <b>84</b>, 1&ndash;26, <a href="https://doi.org/10.18637/jss.v084.i02">doi:10.18637/jss.v084.i02</a>.
</p>
<p>Lin D and Wei L (1989). The Robust Inference for the Cox Proportional Hazards Model.
<em>J AM STAT ASSOC</em> <b>84</b>, 1074-1078.
</p>
<p>Lin D (1991). Goodness-of-Fit Analysis for the Cox Regression Model Based on a Class of Parameter
Estimators. <em>J AM STAT ASSOC</em> <b>86</b>, 725-728.
</p>
<p>Royston P and Altman D (1994). Regression Using Fractional Polynomials of Continuous Covariates:
Parsimonious Parametric Modelling. <em>J R STAT SOC C-APPL</em> <b>43</b>, 429-467.
</p>
<p>Royston P and Sauerbrei W (2008). <em>Multivariable Model-Building. A Pragmatic Approach to Regression
Analysis Based on Fractional Polynomials for Modelling Continuous Variables.</em> Wiley, Chichester, UK.
</p>
<p>Sasieni P (1993). Maximum Weighted Partial Likelihood Estimators for the Cox Model. <em>J AM STAT ASSOC</em>
<b>88</b>, 144-152.
</p>
<p>Schemper M (1992).  Cox Analysis of Survival Data with Non-Proportional Hazard Functions. <em>J  R STAT SOC D</em>
<b>41</b>, 455-465.
</p>
<p>Schemper M, Wakounig S and Heinze G (2009). The Estimation of Average Hazard Ratios by Weighted Cox
Regression. <em>STAT MED</em> <b>28</b>, 2473-2489. <a href="https://doi.org/10.1002/sim.3623">doi:10.1002/sim.3623</a>
</p>
<p>Xu R and O'Quigley J (2000). Estimating Average Regression Effect Under Non-Proportional Hazards.
<em>Biostatistics</em> <b>1</b>, 423-439. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+concord">concord</a></code>, <code><a href="#topic+plot.coxphw">plot.coxphw</a></code>, <code><a href="#topic+predict.coxphw">predict.coxphw</a></code>, <code><a href="#topic+plot.coxphw.predict">plot.coxphw.predict</a></code>, <code><a href="survival.html#topic+coxph">coxph</a> </code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gastric")

# weighted estimation of average hazard ratio
fit1 &lt;- coxphw(Surv(time, status) ~ radiation, data = gastric, template = "AHR")
summary(fit1)
fit1$cov.lw     # robust covariance
fit1$cov.ls     # Lin-Sasieni covariance


# unweighted estimation, include interaction with years
# ('radiation' must be included in formula!)
gastric$years &lt;- gastric$time / 365.25
fit2 &lt;- coxphw(Surv(years, status) ~ radiation + years : radiation, data = gastric,
               template = "PH")
summary(fit2)


# unweighted estimation with a function of time
data("gastric")
gastric$yrs &lt;- gastric$time / 365.25

fun &lt;- function(t) { (t &gt; 1) * 1 }
fit3 &lt;- coxphw(Surv(yrs, status) ~ radiation + fun(yrs):radiation, data = gastric,
               template = "PH")

# for more examples see vignette or predict.coxphw
</code></pre>

<hr>
<h2 id='coxphw.control'>Ancillary arguments for controlling coxphw fits</h2><span id='topic+coxphw.control'></span>

<h3>Description</h3>

<p>This is used to set various numeric parameters controlling a Cox model fit using <code>coxphw</code>.
Typically it would only be used in a call to <code>coxphw</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coxphw.control(iter.max = 200, maxhs = 5, xconv = 1e-4, gconv = 1e-4, maxstep = 1,
               round.times.to = 0.00001, add.constant = 0, pc = TRUE, pc.time = TRUE,
               normalize = TRUE) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coxphw.control_+3A_iter.max">iter.max</code></td>
<td>
<p> maximum number of iterations to attempt for convergence. Default is 200. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_maxhs">maxhs</code></td>
<td>
<p> maximum number of step-halvenings per iterations. Default is 5. The increments of the
parameter vector in one Newton-Rhaphson iteration step are halved, unless the new
pseudo-likelihood is greater than the old one, maximally doing <code>maxhs</code> halvings. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_xconv">xconv</code></td>
<td>
<p> specifies the maximum allowed change in standardized parameter estimates to declare
convergence. Default is 0.0001. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_gconv">gconv</code></td>
<td>
<p> specifies the maximum allowed change in score function to declare convergence.
Default is 0.0001. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_maxstep">maxstep</code></td>
<td>
<p> specifies the maximum change of (standardized) parameter values allowed in one
iteration. Default is 1. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_round.times.to">round.times.to</code></td>
<td>
<p> rounds survival times to the nearest number that is a multiple of
<code>round.times.to</code>. This may improve numerical stability if very small
survival times are used (mostly in simulations). Default is 0.00001. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_add.constant">add.constant</code></td>
<td>
<p> this number will be added to all times. It can be used if some survival times
are exactly 0. Default is 0. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_pc">pc</code></td>
<td>
<p> if set to TRUE, it will orthogonalize the model matrix to speed up convergence. Default is TRUE. </p>
</td></tr>

<tr><td><code id="coxphw.control_+3A_pc.time">pc.time</code></td>
<td>
<p> if set to TRUE, it will orthogonalize time-dependent covariates (i.e., interactions of
covariates with functions of time) to speed up convergence. Default is TRUE. </p>
</td></tr>
<tr><td><code id="coxphw.control_+3A_normalize">normalize</code></td>
<td>
<p> if set to TRUE, weights are normalized such that their sum is equal to the number of
events. This may speed up or enable convergence, but has no consequences on the
estimated regression coefficients. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the values of each of the above constants
</p>


<h3>Author(s)</h3>

<p> Daniela Dunkler </p>


<h3>See Also</h3>

<p><code><a href="#topic+coxphw">coxphw</a></code>
</p>

<hr>
<h2 id='fp.power'> Provides Fractional Polynomials as Accessible Function </h2><span id='topic+fp.power'></span>

<h3>Description</h3>

<p> Provides fractional polynomials as accessible function. </p>


<h3>Usage</h3>

<pre><code class='language-R'> fp.power(z, a, b = NULL)  </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fp.power_+3A_z">z</code></td>
<td>
<p>a scalar or vector of positive numerical values. </p>
</td></tr>
<tr><td><code id="fp.power_+3A_a">a</code></td>
<td>
<p>first power. </p>
</td></tr>
<tr><td><code id="fp.power_+3A_b">b</code></td>
<td>
<p>optional second power. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The function returns fp(<code>a</code>) of <code>z</code> (and optionally <code>fp(b)</code> of <code>z</code>). </p>


<h3>Value</h3>

<p> A matrix with one or two columns (if a second power <code>b</code> was specified), and number of 
rows equal to the length of <code>z</code>. The columns are sorted by descending power. </p>


<h3>Author(s)</h3>

<p>Georg Heinze</p>


<h3>References</h3>

<p> Royston P and Altman D (1994). Regression Using Fractional Polynomials of Continuous Covariates: Parsimonious Parametric Modelling. <em>J R STAT SOC C-APPL</em> <b>43</b>, 429-467.
</p>
<p>Royston P and Sauerbrei W (2008). <em>Multivariable Model-Building. A Pragmatic Approach to Regression 
Analysis Based on Fractional Polynomials for Modelling Continuous Variables.</em> Wiley, Chichester, UK. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>fp.power(z = c(1, 4, 6), a = 1)
fp.power(z = c(1, 4, 6), a = 0.5)
fp.power(z = c(1, 4, 6), a = 0.5, b = 0.5)
fp.power(z = c(1, 4, 6), a = 0, b = 2)
</code></pre>

<hr>
<h2 id='gastric'> Gastric Cancer Data </h2><span id='topic+gastric'></span>

<h3>Description</h3>

<p> A data set of survival times of patients with locally advanced, nonresectable gastric
carcinoma. The patients were either treated with chemotherapy plus radiation or
chemotherapy alone. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(gastric)</code></pre>


<h3>Format</h3>

<p>A data frame with 90 observations on the following 4 variables:
</p>

<dl>
<dt><code>id</code></dt><dd><p> unique patient id. </p>
</dd>
<dt><code>radiation</code></dt><dd><p> treatment of either 0 = chemotherapy alone or 1 = chemotherapy plus radiation. </p>
</dd>
<dt><code>time</code></dt><dd><p> survival time in days. </p>
</dd>
<dt><code>status</code></dt><dd><p> 0 = censored or 1 = death. </p>
</dd>
</dl>



<h3>Source</h3>

<p> Stablein DM, Carter J, Novak JW. (1981) Analysis of Survival Data with Nonproportional Hazard
Functions. <em>Controlled Clinical Trials</em> <b>2</b>:149-159. OR
</p>
<p><a href="https://www.mayo.edu/research/documents/gastrichtml/DOC-10027680">https://www.mayo.edu/research/documents/gastrichtml/DOC-10027680</a> </p>


<h3>References</h3>

<p>  Gastrointestinal Tumor Study Group. (1982) A Comparison of Combination
Chemotherapy and Combined Modality Therapy for Locally Advanced Gastric Carcinoma. <em>Cancer</em>
<b>49</b>:1771-7. </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gastric")
plot(survfit(Surv(time, status) ~ radiation, data = gastric), lty = 1:2, las = 1,
     xscale = 365.25, xlab = "time (years)", ylab = "survival distribution function")

coxphw(Surv(time, status) ~ radiation, data = gastric, template = "AHR")
</code></pre>

<hr>
<h2 id='plot.coxphw'> Plot Weights of Weighted Estimation in Cox Regression </h2><span id='topic+plot.coxphw'></span>

<h3>Description</h3>

<p> This function plots the weights used in a weighted Cox regression analysis against time. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
plot(x, rank = FALSE, log = FALSE, legendxy = NULL,...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.coxphw_+3A_x">x</code></td>
<td>
<p> a <code>coxphw</code> object. </p>
</td></tr>
<tr><td><code id="plot.coxphw_+3A_rank">rank</code></td>
<td>
<p> if set to TRUE, plots the weights against ranked time. Default is FALSE. </p>
</td></tr>
<tr><td><code id="plot.coxphw_+3A_log">log</code></td>
<td>
<p> if set to TRUE, shows logarithm of weights. Default is FALSE. </p>
</td></tr>
<tr><td><code id="plot.coxphw_+3A_legendxy">legendxy</code></td>
<td>
<p> an optional vector of length 2 of the x and y co-ordinates to be used to position the legend. </p>
</td></tr>
<tr><td><code id="plot.coxphw_+3A_...">...</code></td>
<td>
<p> additional arguments for plotting </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The function plots the survival weights, i.e., the left-continuous survivor function
estimates, the censoring weights, i.e., estimates of the follow-up distribution obtained by
Kaplan-Meier estimation with reversed meaning of the status indicator and the combined
normalized weights, i.e. the product of the survival and the censoring weights, rescaled to a mean of 1.</p>


<h3>Value</h3>

<p> No output value. </p>


<h3>Note</h3>

<p> In <span class="pkg">coxphw</span> version 4.0.0 the new <code>plot</code> function replaces the old <code>plotw</code> function. </p>


<h3>Author(s)</h3>

<p>Georg Heinze, Daniela Dunkler</p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>data("gastric")

# weighted estimation of average hazard ratio
fit1 &lt;- coxphw(Surv(time, status) ~ radiation, data = gastric,  template = "AHR")
plot(fit1)

# estimation of average regression effect by inverse probability of censoring weights;
# truncate weights at 95th percentile
fit2 &lt;- coxphw(Surv(time, status) ~ radiation, data = gastric, template = "ARE",
               trunc.weights = 0.95)
plot(fit2)
</code></pre>

<hr>
<h2 id='plot.coxphw.predict'> Plot the Relative or Log Relative Hazard Versus Values of a Continuous Covariable.</h2><span id='topic+plot.coxphw.predict'></span>

<h3>Description</h3>

<p> This function visualizes a nonlinear or a time-dependent effect of a <code>predict.coxphw</code>
object. </p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxphw.predict'
plot(x, addci = TRUE,  xlab = NULL, ylab = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.coxphw.predict_+3A_x">x</code></td>
<td>
<p> an output object of <code>coxphw</code>.</p>
</td></tr> 
<tr><td><code id="plot.coxphw.predict_+3A_addci">addci</code></td>
<td>
<p> confidence intervalls are obtained. Default is TRUE. </p>
</td></tr>
<tr><td><code id="plot.coxphw.predict_+3A_xlab">xlab</code></td>
<td>
<p> label for x-axis of plot, uses variable specified in <code>x</code> in <code>predict</code> as default. </p>
</td></tr>
<tr><td><code id="plot.coxphw.predict_+3A_ylab">ylab</code></td>
<td>
<p> label for y-axis of plot, uses as appropriate either &quot;relative hazard&quot; or &quot;log relative hazard&quot; as default. </p>
</td></tr>
<tr><td><code id="plot.coxphw.predict_+3A_...">...</code></td>
<td>
<p> further parameters, to be used for plots (e.g., scaling of axes). </p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function can be used to depict the estimated nonlinear or time-dependent
effect of an object of class <code>predict.coxphw</code>. It supports simple nonlinear
effects as well as interaction effects of continuous variables with binary
covariates (see examples section in <code><a href="#topic+predict.coxphw">predict.coxphw</a></code>. ).
</p>


<h3>Value</h3>

<p> No output value. </p>


<h3>Note</h3>

<p> In <span class="pkg">coxphw</span> version 4.0.0 the old <code>plotshape</code> function is replaced with
<code>predict.coxphw</code> and <code>plot.coxphw.predict</code>. </p>


<h3>Author(s)</h3>

<p>Georg Heinze, Meinhard Ploner, Daniela Dunkler</p>


<h3>References</h3>

<p> Royston P and Altman D (1994). Regression Using Fractional Polynomials of Continuous
Covariates: Parsimonious Parametric Modelling. <em>Applied Statistics J R STAT SOC C-APPL</em> <b>43</b>, 429-467.
</p>
<p>Royston P and Sauerbrei W (2008). <em>Multivariable Model-building. A pragmatic approach to regression
analysis based on fractional polynomials for modelling continuous variables.</em> Wiley, Chichester, UK. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code>, <code><a href="#topic+predict.coxphw">predict.coxphw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(30091)
n &lt;- 300
x &lt;- 1:n
true.func &lt;- function(x) 3 * (x / 100)^{2} - log(x / 100) - 3 * x / 100
x &lt;- round(rnorm(n = x) * 10 + 40, digits = 0)
time &lt;- rexp(n = n, rate = 1) / exp(true.func(x))
event &lt;- rep(x = 1, times = n)
futime &lt;- runif(n = n, min = 0, max = 309000)
event &lt;- (time &lt; futime) + 0
time[event == 0] &lt;- futime[event == 0]
my.data &lt;- data.frame(x, time, event)

fitahr &lt;- coxphw(Surv(time, event) ~ x, data = my.data, template = "AHR")

# estimated function
plotx &lt;- quantile(x, probs = 0.05):quantile(x, probs = 0.95)
plot(predict(fitahr, type = "shape", newx = plotx, refx = median(x), x = "x",
             verbose = FALSE))

# true function
lines(x = plotx, true.func(plotx) - true.func(median(plotx)), lty = 2)

legend("topright", legend=c("AHR estimates", "true"), bty = "n", lty = 1:2, inset = 0.05)

# for more examples see predict.coxphw
</code></pre>

<hr>
<h2 id='predict.coxphw'>Predictions for a weighted Cox model</h2><span id='topic+predict.coxphw'></span>

<h3>Description</h3>

<p> This function obtains the effect estimates (e.g. of a nonlinear or a
time-dependent effect) at specified values of a continuous
covariable for a model fitted by <code><a href="#topic+coxphw">coxphw</a></code>. It prints the
relative or log relative hazard. Additionally, the linear predictor lp
or the risk score exp(lp) can be obtained. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
predict(object, type = c("shape", "slice.time", "slice.z", "slice.x", "lp", "risk"),
        x = NULL, newx = NA, refx = NA, z = NULL, at = NULL, exp = FALSE,
        se.fit = FALSE, pval = FALSE, digits = 4, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.coxphw_+3A_object">object</code></td>
<td>
<p> an output object of <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_type">type</code></td>
<td>
<p>the type of predicted value. Choices are:
<code>"lp"</code> for the linear predictors, <br />
<code>"risk"</code> for the risk scores <code>exp(lp)</code> <br />
<code>"shape"</code> for visualizing a nonlinear effect of <code>x</code>, <br />
<code>"slice.x"</code>  for slicing an interaction of type <code>fun(x)*z</code> at values of <code>x</code>,
<code>"slice.z"</code> for slicing an interaction of type <code>fun(x)*z</code> at a value of <code>z</code>, <br />
<code>"slice.time"</code> for slicing a time-by-covariate interaction of type <code>z + fun(time):z</code> at values of <code>time</code> <br />
See details. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_x">x</code></td>
<td>
<p> name of the continuous or time variable (use &quot;&quot;) for <code>type = "shape"</code>,
<code>"slice.time"</code>, <code>"slice.x"</code>, or <code>"slice.z"</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_newx">newx</code></td>
<td>
<p> the data values for <code>x</code> for which the effect estimates should be
obtained (e.g., <code>30:70</code>) for <code>type = "shape"</code>,
<code>"slice.time"</code>, <code>"slice.x"</code>, or <code>"slice.z"</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_refx">refx</code></td>
<td>
<p> the reference value for variable <code>x</code> for <code>type = "shape"</code> or <code>"slice.z"</code>.
The log relative hazard at this value will be 0. (e.g., <code>refx= 50</code>).</p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_z">z</code></td>
<td>
<p> variable which is in interaction with <code>x</code> (use &quot;&quot;) for <code>"slice.time"</code>,
<code>"slice.x"</code>, or <code>"slice.z"</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_at">at</code></td>
<td>
<p> if <code>type = "slice.z"</code> at which level (&quot;slice&quot;) of <code>z</code> should the effect estimates of the
<code>x</code> be obtained. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_exp">exp</code></td>
<td>
<p> if set to TRUE (default), the log relative hazard is given, otherwise the relative hazard
is requested for <code>type = "shape"</code>, <code>"slice.time"</code>, <code>"slice.x"</code>,
or <code>"slice.z"</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_se.fit">se.fit</code></td>
<td>
<p>if set to TRUE, pointwise standard errors are produced for the predictions for
<code>type = "shape"</code>, <code>"slice.time"</code>, <code>"slice.x"</code>, or <code>"slice.z"</code>. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_pval">pval</code></td>
<td>
<p> if set to TRUE add Wald-test p-values to effect estimates at values of
<code>newx</code> for <code>type = "shape"</code>, <code>"slice.time"</code>, <code>"slice.x"</code>,
or <code>"slice.z"</code>. Default is set to FALSE. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_digits">digits</code></td>
<td>
<p> number of printed digits. Default is 4. </p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_verbose">verbose</code></td>
<td>
<p> if set to TRUE (default), results are printed.</p>
</td></tr>
<tr><td><code id="predict.coxphw_+3A_...">...</code></td>
<td>
<p> further parameters. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function can be used to depict the estimated nonlinear or time-dependent
effect of an object of class <code>coxphw</code>. It supports simple nonlinear
effects as well as interaction effects of a continuous variable with a binary
covariate or with time (see examples section).
</p>
<p>If the effect estimates of a simple nonlinear effect of <code>x</code> without
interaction is requested with <code>type = "shape"</code>, then <code>x</code> (the usually
continuous covariate), <code>refx</code> (the reference value of <code>x</code>) and <code>newx</code>
(for these values of <code>x</code> the effect estimates are obtained) must be given.
</p>
<p>If the effect estimates of an interaction of <code>z</code> with <code>x</code> are requested
with <code>type = "slice.x"</code>, then <code>x</code> (the usually continuous variable),
<code>z</code> (the categorical variable) and <code>newx</code> (for these values of <code>x</code>
the effect estimates are obtained) must be given.
</p>
<p>If the effect estimates of an interaction of <code>z</code> with <code>x</code> for one level of <code>z</code>
are requested with <code>type = "slice.z"</code>), then <code>x</code> (the usually continuous variable),
<code>z</code> (the categorical variable), <code>at</code> (at which level of <code>z</code>),
<code>refx</code> (the reference value of <code>x</code>), and <code>newx</code> (for these values of <code>x</code>
the effect estimates are obtained) must be given.
</p>
<p>If the effect estimates of an interaction of <code>z</code> with <code>time</code> are requested
with <code>type = "slice.time"</code>, then <code>x</code> (the <code>time</code>), <code>z</code> (the
categorical variable) and <code>newx</code> (for these values of <code>x</code> the effect
estimates are obtained) must be given.
</p>
<p>Note that if the model formula contains time-by-covariate interactions, then the linear predictor
and the risk score are obtained for the failure or censoring time of each subject.
</p>


<h3>Value</h3>

<p> If <code>type = "shape"</code>, <code>"slice.time"</code>, <code>"slice.x"</code>, or <code>"slice.z"</code>
a list with the following components:
</p>
<table>
<tr><td><code>estimates</code></td>
<td>
<p> a matrix with estimates of (log) relative hazard and corresponding confidence limits. </p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p> pointwise standard errors, only if <code>se.fit = TRUE</code>. </p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p> p-value, only if <code>pval = TRUE</code>. </p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p> the significance level = 1 - confidence level. </p>
</td></tr>
<tr><td><code>exp</code></td>
<td>
<p> an indicator if log relative hazard or relative hazard was obtained. </p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> name of <code>x</code>. </p>
</td></tr>
</table>
<p>If  <code>type = "lp"</code> or <code>"risk"</code>, a vector.
</p>


<h3>Note</h3>

<p> In <span class="pkg">coxphw</span> version 4.0.0 the old <code>plotshape</code> function is replaced with
<code>predict.coxphw</code> and <code>plot.coxphw.predict</code>. </p>


<h3>Author(s)</h3>

<p>Georg Heinze, Meinhard Ploner, Daniela Dunkler</p>


<h3>References</h3>

<p> Royston P and Altman D (1994). Regression Using Fractional Polynomials of Continuous
Covariates: Parsimonious Parametric Modelling. <em>Applied Statistics</em> <b>43</b>, 429-467.
</p>
<p>Royston P and Sauerbrei W (2008). <em>Multivariable Model-building. A pragmatic approach to regression
analysis based on fractional polynomials for modelling continuous variables.</em> Wiley, Chichester, UK. </p>


<h3>See Also</h3>

<p><code><a href="#topic+coxphw">coxphw</a></code>, <code><a href="#topic+plot.coxphw.predict">plot.coxphw.predict</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>### Example for type = "slice.time"
data("gastric")
gastric$yrs &lt;- gastric$time / 365.25

# check proportional hazards
fitcox &lt;- coxph(Surv(yrs, status) ~ radiation + cluster(id), data = gastric, x = TRUE,
                method = "breslow")
fitcox.ph &lt;- cox.zph(fit = fitcox, transform = "identity")


## compare and visualize linear and log-linear time-dependent effects of radiation
fit1 &lt;- coxphw(Surv(yrs, status) ~ yrs * radiation, data = gastric, template = "PH")
summary(fit1)

predict(fit1, type = "slice.time", x = "yrs", z = "radiation", newx = c(0.5, 1, 2),
        verbose = TRUE, exp = TRUE, pval = TRUE)


fit2 &lt;- coxphw(Surv(yrs, status) ~ log(yrs) * radiation, data = gastric, template = "PH")
summary(fit2)

predict(fit2, type = "slice.time", x = "yrs", z = "radiation", newx = c(0.5, 1, 2),
        verbose = TRUE, exp = TRUE, pval = TRUE)


plotx &lt;- seq(from = quantile(gastric$yrs, probs = 0.05),
             to = quantile(gastric$yrs, probs = 0.95), length = 100)
y1 &lt;- predict(fit1, type = "slice.time", x = "yrs", z = "radiation", newx = plotx)
y2 &lt;- predict(fit2, type = "slice.time", x = "yrs", z = "radiation", newx = plotx)

plot(x = fitcox.ph, se = FALSE, xlim = c(0, 3), las = 1, lty = 3)
abline(a = 0, b = 0, lty = 3)
lines(x = plotx, y = y1$estimates[, "coef"], col = "red", lty = 1, lwd = 2)
lines(x = plotx, y = y2$estimates[, "coef"], col = "blue", lty = 2, lwd = 2)
legend(x = 1.7, y = 1.6, title = "time-dependent effect", title.col = "black",
       legend = c("LOWESS", "linear", "log-linear"), col = c("black", "red", "blue"),
       lty = c(3, 1:2), bty = "n", lwd = 2, text.col = c("black", "red", "blue"))



### Example for type = "shape"
set.seed(512364)
n &lt;- 200
x &lt;- 1:n
true.func &lt;- function(x) 2.5 * log(x) - 2
x &lt;- round(runif(x) * 60 + 10, digits = 0)
time &lt;- round(100000 * rexp(n= n, rate = 1) / exp(true.func(x)), digits = 1)
event &lt;- rep(x = 1, times = n)
my.data &lt;- data.frame(x,time,event)

fit &lt;- coxphw(Surv(time, event) ~ log(x) + x, data = my.data, template = "AHR")

predict(fit, type = "shape", newx = c(30, 50), refx = 40, x = "x", verbose = TRUE)

plotx &lt;- seq(from = quantile(x, probs = 0.05),
             to = quantile(x, probs = 0.95), length = 100)
plot(predict(fit, type = "shape", newx = plotx, refx = 40, x = "x"))


### Example for type = "slice.x" and "slice.z"
set.seed(75315)
n &lt;- 200
trt &lt;- rbinom(n = n, size = 1, prob = 0.5)
x &lt;- 1:n
true.func &lt;- function(x) 2.5 * log(x) - 2
x &lt;- round(runif(n = x) * 60 + 10, digits = 0)
time &lt;- 100 * rexp(n = n, rate = 1) / exp(true.func(x) /
                                      4 * trt - (true.func(x) / 4)^2 * (trt==0))
event &lt;- rep(x = 1, times = n)
my.data &lt;- data.frame(x, trt, time, event)

fun&lt;-function(x) x^(-2)
fit &lt;- coxphw(Surv(time, event) ~ x * trt + fun(x) * trt , data = my.data,
              template = "AHR", verbose = FALSE)

# plots the interaction of trt with x (the effect of trt dependent on the values of x)
plotx &lt;- quantile(x, probs = 0.05):quantile(x, probs = 0.95)
plot(predict(fit, type = "slice.x", x = "x", z = "trt",
             newx = plotx, verbose = FALSE), main = "interaction of trt with x")

# plot the effect of x in subjects with trt = 0
y0 &lt;- predict(fit, type = "slice.z", x = "x", z = "trt", at = 0, newx = plotx,
              refx = median(x), verbose = FALSE)
plot(y0, main = "effect of x in subjects with trt = 0")


# plot the effect of x in subjects with trt = 1
y1 &lt;- predict(fit, type = "slice.z", x = "x", z = "trt", at = 1, newx = plotx,
              refx = median(x), verbose = FALSE)
plot(y1, main = "effect of x in subjects with trt = 1")


# Example for type = "slice.time"
set.seed(23917)
time &lt;- 100 * rexp(n = n, rate = 1) / exp((true.func(x) / 10)^2 / 2000 * trt + trt)
event &lt;- rep(x = 1, times = n)
my.data &lt;- data.frame(x, trt, time, event)
plot.x &lt;- seq(from = 1, to = 100, by = 1)

fun  &lt;- function(t) { PT(t)^-2 * log(PT(t)) }
fun2 &lt;- function(t) { PT(t)^-2 }
fitahr &lt;- coxphw(Surv(time, event) ~ fun(time) * trt + fun2(time) * trt + x,
                 data = my.data, template = "AHR")
yahr &lt;- predict(fitahr, type = "slice.time", x = "time", z = "trt", newx = plot.x)

fitph &lt;- coxphw(Surv(time, event) ~ fun(time) * trt + fun2(time) * trt + x,
                data = my.data, template = "PH")
yph &lt;- predict(fitph, type = "slice.time", x = "time", z = "trt", newx = plot.x)

plot(yahr, addci = FALSE)
lines(yph$estimates$time, yph$estimates$coef, lty = 2)
legend("bottomright", legend = c("AHR", "PH"), bty = "n", lty = 1:2,
       inset = 0.05)
</code></pre>

<hr>
<h2 id='print.coxphw'> Print Method for Objects of Class <code>coxphw</code> </h2><span id='topic+print.coxphw'></span>

<h3>Description</h3>

<p> This class of objects is returned by the <code>coxphw</code> function. 
Objects of this class have methods for the functions <code>summary</code>, <code>print</code>, <code>coef</code>, 
<code>vcov</code>, <code>plot</code>, and <code>confint</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
print(x, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.coxphw_+3A_x">x</code></td>
<td>
<p> object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="print.coxphw_+3A_...">...</code></td>
<td>
<p> further arguments. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>If  some regression coefficients were held fixed by <code>betafix</code>, then no standard errors are
given for these coefficients as they are not estimated in the model. The global Wald test 
only relates to those variables for which regression coefficients were estimated.</p>


<h3>Author(s)</h3>

<p>  Georg Heinze, Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

<hr>
<h2 id='print.coxphw.predict'> Print Method for Objects of Class <code>predict.coxphw</code> </h2><span id='topic+print.coxphw.predict'></span>

<h3>Description</h3>

<p> This class of objects is returned by the <code>predict.coxphw</code> function.
Objects of this class have methods for the functions <code>print</code> and <code>plot</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw.predict'
print(x, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.coxphw.predict_+3A_x">x</code></td>
<td>
<p> object of class <code>coxphw.predict</code>. </p>
</td></tr>
<tr><td><code id="print.coxphw.predict_+3A_...">...</code></td>
<td>
<p> further arguments. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>  Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code>, <code><a href="#topic+predict.coxphw">predict.coxphw</a></code> <code><a href="#topic+plot.coxphw.predict">plot.coxphw.predict</a></code> </p>

<hr>
<h2 id='PT'> Pretransformation function </h2><span id='topic+PT'></span>

<h3>Description</h3>

<p> Provides automatic pretransformation of variables (to well-scaled and nonzero values). </p>


<h3>Usage</h3>

<pre><code class='language-R'> PT(z) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PT_+3A_z">z</code></td>
<td>
<p>a vector of numerical values. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The function transforms a variable by shifting to positive values, and dividing by scaling 
factor (a power of 10) such that the standard deviation is approximately equal to 1. </p>


<h3>Value</h3>

<p> (<code>z</code> + shift) / scale </p>


<h3>Author(s)</h3>

<p>Georg Heinze</p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>PT(z = c(-6, -1, 4, 6))
</code></pre>

<hr>
<h2 id='summary.coxphw'> Summary Method for Objects of Class <code>coxphw</code> </h2><span id='topic+summary.coxphw'></span>

<h3>Description</h3>

<p> This class of objects is returned by the <code>coxphw</code> function. 
Objects of this class have methods for the functions <code>summary</code>, <code>print</code>, <code>coef</code>, 
<code>vcov</code>, <code>plot</code>, and <code>confint</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
summary(object, print = TRUE, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.coxphw_+3A_object">object</code></td>
<td>
<p> object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="summary.coxphw_+3A_print">print</code></td>
<td>
<p> print summary. Default is TRUE. </p>
</td></tr>
<tr><td><code id="summary.coxphw_+3A_...">...</code></td>
<td>
<p> further arguments. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> If some regression coefficients are held fixed by <code>betafix</code>, no standard errors and related quantities
are given for these coefficients as they are not estimated in the model. The global Wald test 
only relates to those variables for which regression coefficients were estimated.</p>


<h3>Author(s)</h3>

<p> Georg Heinze, Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

<hr>
<h2 id='vcov.coxphw'> Obtain the Variance-Covariance Matrix for a Fitted Model Object of Class <code>coxphw</code> </h2><span id='topic+vcov.coxphw'></span>

<h3>Description</h3>

<p> This class of objects is returned by the <code>coxphw</code> function. 
Objects of this class have methods for the functions <code>summary</code>, <code>print</code>, <code>coef</code>, 
<code>vcov</code>, <code>plot</code>, and <code>confint</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'> ## S3 method for class 'coxphw'
vcov(object, ...) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.coxphw_+3A_object">object</code></td>
<td>
<p> object of class <code>coxphw</code>. </p>
</td></tr>
<tr><td><code id="vcov.coxphw_+3A_...">...</code></td>
<td>
<p> further arguments. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Daniela Dunkler </p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

<hr>
<h2 id='wald'> Wald-Test for Model Coefficients </h2><span id='topic+wald'></span>

<h3>Description</h3>

<p> Obtain Wald chi-squared test statistics and p-values for one or more regression
coefficients given their variance-covariance matrix. </p>


<h3>Usage</h3>

<pre><code class='language-R'> wald(coeff, cov, index = NULL, h0 = NULL) </code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wald_+3A_coeff">coeff</code></td>
<td>
<p> a vector with regression coefficients. </p>
</td></tr>
<tr><td><code id="wald_+3A_cov">cov</code></td>
<td>
<p> a variance-covariance matrix. </p>
</td></tr>
<tr><td><code id="wald_+3A_index">index</code></td>
<td>
<p> an integer specifying which parameters should be jointly tested. Default is to test
all parameters given in <code>coeff</code> and <code>cov</code>.</p>
</td></tr>
<tr><td><code id="wald_+3A_h0">h0</code></td>
<td>
<p> a vector with the same length as <code>coeff</code> stating the null hypothesis for the test.
Default is 0 for all coefficients. </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The test is based on the assumption that the coefficients asymptotically follow
a (multivariate) normal distribution with mean <code>coeff</code> and a variance-covariance
matrix <code>cov</code>. </p>


<h3>Value</h3>

<p> A vector with the following components:
</p>
<table>
<tr><td><code>chi2</code></td>
<td>
<p> the Wald-test statistic. </p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p> degrees of freedom. </p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p> p-value. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniela Dunkler</p>


<h3>See Also</h3>

 <p><code><a href="#topic+coxphw">coxphw</a></code> </p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
