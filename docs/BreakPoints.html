<!DOCTYPE html><html><head><title>Help for package BreakPoints</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BreakPoints}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#N_break_point'><p>N_break_point</p></a></li>
<li><a href='#SNHT'><p>Buishand Range Test and Standard Normal Homogeneity Test</p></a></li>
<li><a href='#Student'><p>Mann-Whitney-Wilcoxon Test, Student t-test and Pettit Test</p></a></li>
<li><a href='#yamamoto'><p>Yamamoto</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Identify Breakpoints in Series of Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Santiago I. Hurtado [cre, aut] &lt;santih@carina.fcaglp.unlp.edu.ar&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Santiago I. Hurtado &lt;santih@carina.fcaglp.unlp.edu.ar&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Compute Buishand Range Test, Pettit Test, SNHT, Student t-test, and Mann-Whitney Rank Test, to identify breakpoints in series. For all functions NA is allowed. Since all of the mention methods identify only one breakpoint in a series, a general function to look for N breakpoint is given. Also, the Yamamoto test for climate jump is available. Alexandersson, H. (1986) &lt;<a href="https://doi.org/10.1002%2Fjoc.3370060607">doi:10.1002/joc.3370060607</a>&gt;, Buishand, T. (1982) &lt;<a href="https://doi.org/10.1016%2F0022-1694%2882%2990066-X">doi:10.1016/0022-1694(82)90066-X</a>&gt;, Hurtado, S. I., Zaninelli, P. G., &amp; Agosta, E. A. (2020) &lt;<a href="https://doi.org/10.1016%2Fj.atmosres.2020.104955">doi:10.1016/j.atmosres.2020.104955</a>&gt;, Mann, H. B., Whitney, D. R. (1947) &lt;<a href="https://doi.org/10.1214%2Faoms%2F1177730491">doi:10.1214/aoms/1177730491</a>&gt;, Pettitt, A. N. (1979) &lt;<a href="https://doi.org/10.2307%2F2346729">doi:10.2307/2346729</a>&gt;, Ruxton, G. D., jul (2006) &lt;<a href="https://doi.org/10.1093%2Fbeheco%2Fark016">doi:10.1093/beheco/ark016</a>&gt;, Yamamoto, R., Iwashima, T., Kazadi, S. N., &amp; Hoshiai, M. (1985) &lt;<a href="https://doi.org/10.2151%2Fjmsj1965.63.6_1157">doi:10.2151/jmsj1965.63.6_1157</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, zoo</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-08 12:25:50 UTC; santiago</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-12 10:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='N_break_point'>N_break_point</h2><span id='topic+N_break_point'></span>

<h3>Description</h3>

<p>Look for several breakpoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  N_break_point(serie, n_max = 1, n_period=10,
                          seed=FALSE, auto_select = FALSE,
                          alpha = NULL,method='SNHT',dstr='norm',
                          seed_set = 9658, change_random_seed = TRUE,
                          seed_method = 6842)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="N_break_point_+3A_serie">serie</code></td>
<td>
<p>numeric vector where the breakpoint is looked for</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_n_max">n_max</code></td>
<td>
<p>integer up to how many breakpoint should be test</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_n_period">n_period</code></td>
<td>
<p>an integer specifying the minimal length of a complete period to consider</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_seed">seed</code></td>
<td>
<p> if FALSE (default) the first breakpoints to inicialize the iteration are calculated by splitting the serie in equal separated parts. If seed is given must be a list() of length n_max where it is specified the first breakpoints to take for each iteration. </p>
</td></tr>
<tr><td><code id="N_break_point_+3A_method">method</code></td>
<td>
<p>which method should be used for breakpoint detection, supported: 'student', 'mann-whitney','SNHT' (default),'buishand' and 'pettit'</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_dstr">dstr</code></td>
<td>
<p>character specifying which distribution should be used for test simulations, only used if method is SNHT or buishand. Posible distributions 'norm' (default, normal dist), 'gamma', and 'self' (bootstrap)</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_auto_select">auto_select</code></td>
<td>
<p> logical, should an automatic selection of how many breakpoints are be made, default FALSE</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_alpha">alpha</code></td>
<td>
<p>numeric, critical p value to use for auto_select</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_seed_set">seed_set</code></td>
<td>
<p>Either a number to used to set a seed or NULL to set no seed inside the function</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_change_random_seed">change_random_seed</code></td>
<td>
<p>Logical, can the .Random.seed change inside the function, or must remain the same after applying the function</p>
</td></tr>
<tr><td><code id="N_break_point_+3A_seed_method">seed_method</code></td>
<td>
<p>Either a number to used to set seed inside SNHT or buishand methods or NULL to set no seed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute homogeneity test for all possible breaks in the serie considering several breakpoints. NA values are allow. In order to guarantee same result for the same input seed_set and seed_method (if method in SNHT or buishand) must be given.
</p>


<h3>Value</h3>

<p><code>N_break_point</code> returns a list with the breakpoints index, it's p value and how many breakpoints are. If auto_select = F, a list with one list as specify for each n breakpoint tried
</p>

<dl>
<dt>breaks</dt><dd><p>index where the breakpoints are found</p>
</dd>
<dt>p.value</dt><dd><p>p value of the test</p>
</dd>
<dt>n</dt><dd><p>how many breakpoints are looked for</p>
</dd>
</dl>



<h3>References</h3>

<p>Hurtado, S. I., Zaninelli, P. G., &amp; Agosta, E. A. (2020). A multi-breakpoint methodology to detect changes in climatic time series. An application to wet season precipitation in subtropical Argentina. Atmospheric Research, 104955.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Make a serie with three jumps, same as yamamoto example
  set.seed(524)
  x &lt;- c(rnorm(30,1,1),rnorm(30,2,1),rnorm(30,1,1),rnorm(20,2,1))

  # Look up to 5 breaks using pettit
  break_prosition &lt;- N_break_point(serie=x, n_max = 5, method='pettit',
                                    auto_select=TRUE,alpha=0.1)

  plot(x)
  abline(v = break_prosition$breaks, col='red')
</code></pre>

<hr>
<h2 id='SNHT'>Buishand Range Test and Standard Normal Homogeneity Test</h2><span id='topic+SNHT'></span><span id='topic+Buishand_R'></span>

<h3>Description</h3>

<p>Compute Buishand Range Test or Standard Normal Homogeneity Test for a serie, NAs allow in both Test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  SNHT(serie,n_period=10,dstr='norm',simulations = 1000,
                  seed_set = 9658, change_random_seed = TRUE)

  Buishand_R(serie,n_period=10,dstr='norm',simulations = 1000,
                  seed_set = 9658, change_random_seed = TRUE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SNHT_+3A_serie">serie</code></td>
<td>
<p>numeric vector where the breakpoint is looked for</p>
</td></tr>
<tr><td><code id="SNHT_+3A_n_period">n_period</code></td>
<td>
<p>an integer specifying the minimal length of a complete period to consider</p>
</td></tr>
<tr><td><code id="SNHT_+3A_dstr">dstr</code></td>
<td>
<p>character specifying which distribution should be used for test simulations, 'norm' (default; normal distribution), 'gamma', and 'self' (will compute bootstrap)</p>
</td></tr>
<tr><td><code id="SNHT_+3A_simulations">simulations</code></td>
<td>
<p>an integer specifying how many Monte Carlo simulations to perform, default is 1000.</p>
</td></tr>
<tr><td><code id="SNHT_+3A_seed_set">seed_set</code></td>
<td>
<p>Either a number to used to set a seed or NULL to set no seed inside the function</p>
</td></tr>
<tr><td><code id="SNHT_+3A_change_random_seed">change_random_seed</code></td>
<td>
<p>Logical, can the .Random.seed change inside the function, or must remain the same after applying the function</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>SNHT</code> compute Standard Normal Homogeneity Test where NA values are allow. In order to guarantee same result for the same input seed_set must be given.
</p>
<p><code>Buishand_R</code> Compute Buishand Range Test for Homogeneity where NA values are allow. In order to guarantee same result for the same input seed_set must be given.
</p>


<h3>Value</h3>

<p><code>SNHT</code> and <code>Buishand_R</code> returns a list with the breakpoint index and it's p value
</p>

<dl>
<dt>breaks</dt><dd><p>index where the breakpoint is found</p>
</dd>
<dt>p.value</dt><dd><p>p value of the test</p>
</dd>
</dl>



<h3>References</h3>

<p>- Alexandersson, H., jan 1986. A homogeneity test applied to precipitation data. Journal of Climatology 6 (6), 661–675. URL http://doi.wiley.com/10.1002/joc.3370060607
</p>
<p>- Buishand, T., aug 1982. Some methods for testing the homogeneity of rainfall records. Journal of Hydrology 58 (1-2), 11–27. URL https://doi.org/10.1016/0022-1694(82)90066-X
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Make a serie with one breakpoint
  x &lt;- c(rnorm(60,1,1),rnorm(40,2,1))

  # Look for break using SNHT, Buishand_R can be used in exactly the same way
  break_prosition &lt;- SNHT(serie = x)

  plot(x)
  abline(v = break_prosition$breaks)
</code></pre>

<hr>
<h2 id='Student'>Mann-Whitney-Wilcoxon Test, Student t-test and Pettit Test </h2><span id='topic+stu'></span><span id='topic+man.whi'></span><span id='topic+pettit'></span>

<h3>Description</h3>

<p>Compute Rolling Mann-Whitney-Wilcoxon Test, Rolling Student t-test and Pettit test for homogeneity, NAs allow.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  stu(serie,n_period=10)

  man.whi(serie,n_period=10)

  pettit(serie,n_period=10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Student_+3A_serie">serie</code></td>
<td>
<p>numeric vector where the breakpoint is looked for</p>
</td></tr>
<tr><td><code id="Student_+3A_n_period">n_period</code></td>
<td>
<p>an integer specifying the minimal length of a complete period to consider</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>man.whi</code> compute Mann-Whitney-Wilcoxon Test and <code>stu</code> the Student t-test for all possible breaks in the serie and get the most significant break.In both test NA values are allow.
</p>
<p><code>pettit</code> Compute the Pettit Test for Homogeneity. NA values are allow.
</p>


<h3>Value</h3>

<p><code>pettit</code>, <code>man.whi</code> and <code>stu</code> returns a list with the breakpoint index and its p value
</p>

<dl>
<dt>breaks</dt><dd><p>index where the breakpoint is found</p>
</dd>
<dt>p.value</dt><dd><p>p value of the test</p>
</dd>
</dl>



<h3>References</h3>

<p>- Ruxton, G. D., jul 2006. The unequal variance t-test is an underused alternative to Student’s t-test and the Mann–Whitney U test. Behavioral Ecology 17 (4), 688–690. URL: http://academic.oup.com/beheco/article/17/4/688/215960/The-unequal-variance-ttest-is-an-underused
</p>
<p>- Mann, H. B., Whitney, D. R., mar 1947. On a Test of Whether one of Two Random Variables is
Stochastically Larger than the Other. The Annals of Mathematical Statistics 18 (1), 50–60.
URL http://projecteuclid.org/euclid.aoms/1177730491
</p>
<p>- Pettitt, A. N., 1979. A Non-Parametric Approach to the Change-Point Problem. Applied Statistics 28 (2), 126. URL https://www.jstor.org/stable/10.2307/2346729?origin=crossref
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Make a serie with one breakpoint
  x &lt;- c(rnorm(60,1,1),rnorm(40,2,1))

  # Look for break using pettit(), man.whi() and stu()
  break_prosition_pettit &lt;- pettit(serie = x)
  break_prosition_man.whi &lt;- man.whi(serie = x)
  break_prosition_stu &lt;- stu(serie = x)

  plot(x)
  abline(v = break_prosition_pettit$breaks,col='red')
  abline(v = break_prosition_man.whi$breaks,col='blue')
  abline(v = break_prosition_stu$breaks,col= 'green')

</code></pre>

<hr>
<h2 id='yamamoto'>Yamamoto</h2><span id='topic+yamamoto'></span><span id='topic+sum_yam'></span>

<h3>Description</h3>

<p>Compute Yamamoto Test for climate jumps in a serie.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  yamamoto(serie, alpha = 0.1, n_period = 10)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yamamoto_+3A_serie">serie</code></td>
<td>
<p>numeric vector where the breakpoint is looked for</p>
</td></tr>
<tr><td><code id="yamamoto_+3A_n_period">n_period</code></td>
<td>
<p>an integer specifying the length of the window to use, can not bet odd</p>
</td></tr>
<tr><td><code id="yamamoto_+3A_alpha">alpha</code></td>
<td>
<p>numeric, p value to use</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>yamamoto</code> compute the Yamamoto Test.
</p>


<h3>Value</h3>

<p><code>yamamoto</code> returns a list with the breakpoints indexes and the amount
</p>

<dl>
<dt>breaks</dt><dd><p>vector of indexes where the breakpoint is found</p>
</dd>
<dt>n</dt><dd><p>Amount of breakpoints</p>
</dd>
</dl>



<h3>References</h3>

<p>Yamamoto, R., Iwashima, T., Kazadi, S. N., &amp; Hoshiai, M. (1985). Climatic jump: a hypothesis in climate diagnosis. Journal of the Meteorological Society of Japan. Ser. II, 63(6), 1157-1160.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  # Make a serie with three jumps, same as N_break_point example
  set.seed(524)
  x &lt;- c(rnorm(30,1,1),rnorm(30,2,1),rnorm(30,1,1),rnorm(20,2,1))

  # Look for break using yamamoto()
  break_prosition &lt;- yamamoto(serie = x)

  plot(x)
  abline(v = break_prosition$breaks, col='red')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
