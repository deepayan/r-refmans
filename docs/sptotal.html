<!DOCTYPE html><html lang="en"><head><title>Help for package sptotal</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sptotal}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AIC.slmfit'><p>Extract the AIC from a <code>slmfit</code> object for comparing models.</p></a></li>
<li><a href='#AKmoose_df'><p>Data Set with Alaska Moose Counts.</p></a></li>
<li><a href='#check.variogram-deprecated'><p>Plot an Empirical Semi-Variogram of Residuals</p></a></li>
<li><a href='#coef.slmfit'><p>Extract Model Coefficients from a <code>slmfit</code> object</p></a></li>
<li><a href='#corModelExponential'><p>Spatial Correlation Models</p></a></li>
<li><a href='#estcovparm'><p>Estimate Covariance Parameters</p></a></li>
<li><a href='#exampledataset'><p>Data Set with Uncorrelated Poisson Counts.</p></a></li>
<li><a href='#fitted.slmfit'><p>Extract Fitted Values from an <code>slmfit</code> object.</p></a></li>
<li><a href='#geostatSim'><p>Simulate geostatistical data on set of given locations</p></a></li>
<li><a href='#get.predinfo-deprecated'><p>Display basic summary information in a tabular form.</p></a></li>
<li><a href='#get.predplot-deprecated'><p>Create a default map from predictions</p></a></li>
<li><a href='#GR2'><p>Computes the Generalized R-squared.</p></a></li>
<li><a href='#LLtoTM'><p>Convert Lat and Long to Transverse Mercator (TM)</p></a></li>
<li><a href='#loglik.slmfit'><p>Extract Log-Likelihood from a fitted class <code>slmfit</code> object</p></a></li>
<li><a href='#m2LL.FPBK.nodet'><p>Covariance Parameter Estimation Function.</p></a></li>
<li><a href='#mginv'><p>Constructing the generalized inverse of a matrix</p></a></li>
<li><a href='#plot.predict.slmfit'><p>Create a default map from predictions</p></a></li>
<li><a href='#plot.slmfit'><p>Plot an Empirical Semi-Variogram of Residuals</p></a></li>
<li><a href='#pointSimCSR'><p>simulate completely spatially random point patterns.</p></a></li>
<li><a href='#pointSimSyst'><p>Creates a systematic grid of points.</p></a></li>
<li><a href='#predict.slmfit'><p>Perform Finite Population Block Kriging</p></a></li>
<li><a href='#predict.stratafit'><p>Perform Finite Population Block Kriging</p></a></li>
<li><a href='#print.predict.slmfit'><p>Prints a short summary for the <code>predict.slmfit()</code> function.</p></a></li>
<li><a href='#print.predict.stratafit'><p>Prints a short summary for the <code>predict.stratafit()</code> function.</p></a></li>
<li><a href='#print.slmfit'><p>Prints the fitted coefficient table of a fitted spatial linear model.</p></a></li>
<li><a href='#print.summary.slmfit'><p>Prints the summary of a fitted spatial linear model.</p></a></li>
<li><a href='#residuals.slmfit'><p>Extract Model Residuals from an <code>slmfit</code> object.</p></a></li>
<li><a href='#simdata'><p>Simulated Spatially Autocorrelated Data.</p></a></li>
<li><a href='#slmfit'><p>Fits a Spatial Linear Model</p></a></li>
<li><a href='#sptotal'><p>sptotal: A package used for performing Finite Population Block</p>
Kriging (FPBK) on polygonal count data.</a></li>
<li><a href='#stratafit'><p>Fits a Separate Spatial Linear Model for Each Stratum</p></a></li>
<li><a href='#summary.slmfit'><p>Summarizes a fitted spatial linear model.</p></a></li>
<li><a href='#summary.stratafit'><p>Summarizes a fitted spatial linear model with a stratification variable..</p></a></li>
<li><a href='#sv'><p>Semi-variogram computation</p></a></li>
<li><a href='#USlakes'><p>Dissolved Organic Carbon in U.S. Lakes</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Predicting Totals and Weighted Sums from Spatial Data</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-12-09</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs predictions of totals and weighted sums, or finite population block kriging, on spatial data using the methods in Ver Hoef (2008) &lt;<a href="https://doi.org/10.1007%2Fs10651-007-0035-y">doi:10.1007/s10651-007-0035-y</a>&gt;. The primary outputs are an estimate of the total, mean, or weighted sum in the region, an estimated prediction variance, and a plot of the predicted and observed values. This is useful primarily to users with ecological data that are counts or densities measured on some sites in a finite area of interest. Spatial prediction for the total count or average density in the entire region can then be done using the functions in this package. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/highamm/sptotal/issues">https://github.com/highamm/sptotal/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, stats, viridis, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, testthat, prettydoc, tibble, gstat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://highamm.github.io/sptotal/index.html">https://highamm.github.io/sptotal/index.html</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-12-11 16:55:21 UTC; highamm</td>
</tr>
<tr>
<td>Author:</td>
<td>Matt Higham [cre, aut],
  Jay Ver Hoef [aut],
  Bryce Frank [aut],
  Michael Dumelle <a href="https://orcid.org/0000-0002-3393-5529"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Matt Higham &lt;mhigham@stlawu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-12-11 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AIC.slmfit'>Extract the AIC from a <code><a href="#topic+slmfit">slmfit</a></code> object for comparing models.</h2><span id='topic+AIC.slmfit'></span>

<h3>Description</h3>

<p>Extract the AIC from a <code><a href="#topic+slmfit">slmfit</a></code> object for comparing models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
AIC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.slmfit_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+slmfit">slmfit</a></code> object</p>
</td></tr>
<tr><td><code id="AIC.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The AIC value of the slmfit object.  Here, AIC is computed as 2 times the
negative log-likelihood plus 2 times the number of model parameters for Maximum Likelihood (ML) and 2 times the negative log-likelihood for REML. For REML, AIC should only be used to compare two models with the same covariates but different spatial covariance structures.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
AIC(slmobj)
</code></pre>

<hr>
<h2 id='AKmoose_df'>Data Set with Alaska Moose Counts.</h2><span id='topic+AKmoose_df'></span>

<h3>Description</h3>

<p>A data set that can be used with the <code>sptotal</code> package. In
this example, the counts are of moose on 860 sites of equal area.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AKmoose_df
</code></pre>


<h3>Format</h3>

<p>A dataframe object. The data frame <code>AKmoose_df</code> contains 860 rows and 4 columns:
</p>

<dl>
<dt>elev_mean</dt><dd><p>The mean elevation for each sitefor each site</p>
</dd>
<dt>strat</dt><dd><p>A stratification variable (either L or M)</p>
</dd>
<dt>surveyed</dt><dd><p>Assigned a 1 if the site was surveyed and a 0 otherwise</p>
</dd>
<dt>total</dt><dd><p>The total moose count on each site (<code>NA</code> if the site was not surveyed)</p>
</dd>
<dt>x</dt><dd><p>the x-coordinate centroid of the site (TM)</p>
</dd>
<dt>y</dt><dd><p>the y-coordinate centroid of the site (TM)</p>
</dd>
<dt>lon</dt><dd><p>the longitudinal centroid of the site</p>
</dd>
<dt>lat</dt><dd><p>the latitudinal centroid of the site</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="http://www.adfg.alaska.gov/index.cfm?adfg=hunting.main">Alaska Department of Fish and Game, Division of Wildlife Conservation</a> has released this data set under the CC0 (creative commons) license. To the extent possible under law, Alaska Department of Fish and Game, Division of Wildlife Conservation waives all copyright and related or neighboring rights to An Alaskan GSPE (Geospatial Population Estimator) Survey of Moose, AKmoose.rda. This work is published from: United States.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AKmoose_df)
names(AKmoose_df)
summary(AKmoose_df)
</code></pre>

<hr>
<h2 id='check.variogram-deprecated'>Plot an Empirical Semi-Variogram of Residuals</h2><span id='topic+check.variogram-deprecated'></span><span id='topic+check.variogram'></span>

<h3>Description</h3>

<p><code>check.variogram()</code> has been deprecated: use <code><a href="#topic+plot.slmfit">plot.slmfit</a>()</code> instead. Plots an empirical semi-variogram of the residuals from the spatial linear model
with the fitted parametric model as a curve overtop of the
binned points. By default, the empirical semi-variogram only shows distances
that are less than or equal to the maximum distance in the data
set divided by 2. Therefore, it's possible that the REML-fitted model
will not &quot;fit&quot; the points perfectly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check.variogram(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check.variogram-deprecated_+3A_object">object</code></td>
<td>
<p>is an object of class <code><a href="#topic+slmfit">slmfit</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of the empirical semi-variogram with the fitted model overlayed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
## Not Run
## check.variogram(slmobj)
</code></pre>

<hr>
<h2 id='coef.slmfit'>Extract Model Coefficients from a <code><a href="#topic+slmfit">slmfit</a></code> object</h2><span id='topic+coef.slmfit'></span>

<h3>Description</h3>

<p>Extract Model Coefficients from a <code><a href="#topic+slmfit">slmfit</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.slmfit_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+slmfit">slmfit</a></code> object</p>
</td></tr>
<tr><td><code id="coef.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of fitted model coefficients.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
coef(slmobj)
</code></pre>

<hr>
<h2 id='corModelExponential'>Spatial Correlation Models</h2><span id='topic+corModelExponential'></span><span id='topic+corModelGaussian'></span><span id='topic+corModelSpherical'></span>

<h3>Description</h3>

<p>Note that, currently, only three of these models are implemented
in the <code>sptotal</code> package: <code>corModelExponential()</code>,
<code>corModelGaussian()</code>, and <code>corModelSpherical()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corModelExponential(distance.matrix, range)

corModelGaussian(distance.matrix, range)

corModelSpherical(distance.matrix, range)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corModelExponential_+3A_distance.matrix">distance.matrix</code></td>
<td>
<p>The distance matrix for sampled sites</p>
</td></tr>
<tr><td><code id="corModelExponential_+3A_range">range</code></td>
<td>
<p>The range that determines how quickly covariance
among sites tapers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Correlation Matrix
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>corModelExponential()</code>: Exponential Correlation Structure
</p>
</li>
<li> <p><code>corModelGaussian()</code>: Gaussian Correlation Structure
</p>
</li>
<li> <p><code>corModelSpherical()</code>: Spherical Correlation Structure
</p>
</li></ul>

<hr>
<h2 id='estcovparm'>Estimate Covariance Parameters</h2><span id='topic+estcovparm'></span>

<h3>Description</h3>

<p>Used to estimate spatial covariance parameters for a few different spatial models.
Estimated parameters can then be used in <code>predict.slmfit()</code> to predict values at unobserved locations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estcovparm(
  response,
  designmatrix,
  xcoordsvec,
  ycoordsvec,
  CorModel = "Exponential",
  estmethod = "REML",
  covestimates = c(NA, NA, NA)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estcovparm_+3A_response">response</code></td>
<td>
<p>a vector of a response variable, possibly with
missing values.</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_designmatrix">designmatrix</code></td>
<td>
<p>is the matrix of covariates used to regress
the response on.</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_xcoordsvec">xcoordsvec</code></td>
<td>
<p>is a vector of x coordinates</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_ycoordsvec">ycoordsvec</code></td>
<td>
<p>is a vector of y coordinates</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_cormodel">CorModel</code></td>
<td>
<p>is the covariance structure. By default,
<code>CorModel</code> is <code>"Exponential"</code> but other options are
<code>"Spherical"</code> and <code>"Gaussian"</code>.</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_estmethod">estmethod</code></td>
<td>
<p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients.</p>
</td></tr>
<tr><td><code id="estcovparm_+3A_covestimates">covestimates</code></td>
<td>
<p>is an optional vector of covariance parameter estimates (nugget, partial sill, range). If these are given and <code>estmethod = "None"</code>, the the provided vector are treated as the estimators to create the covariance structure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is a helper function used internally in <code>predict.slmfit()</code>.
</p>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li> <p><code>parms.est</code>, a vector of estimated covariance parameters
</p>
</li>
<li> <p><code>Sigma</code>, the fitted covariance matrix for all of the sites
</p>
</li>
<li> <p><code>qrV</code>, the qr decomposition
</p>
</li>
<li> <p><code>b.hat</code>, the vector of estimated fixed effect coefficients
</p>
</li>
<li> <p><code>covbi</code>, the inverse of the covariance matrix for the fixed effects
</p>
</li>
<li> <p><code>covb</code>, the covariance matrix for the fixed effects
</p>
</li>
<li> <p><code>min2loglik</code>, minus two times the loglikelihood
</p>
</li></ul>


<hr>
<h2 id='exampledataset'>Data Set with Uncorrelated Poisson Counts.</h2><span id='topic+exampledataset'></span>

<h3>Description</h3>

<p>A toy data set that can be used with the <code>sptotal</code> package. In
this example, the true counts are actually uncorrelated, the covariates are
generated as uniform random variables, and the sites fall on a
regular grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exampledataset
</code></pre>


<h3>Format</h3>

<p>A data frame with 40  rows and 7 variables:
</p>

<dl>
<dt>counts</dt><dd><p>counts, with NA values for unsampled sites</p>
</dd>
<dt>pred1</dt><dd><p>a possible predictor</p>
</dd>
<dt>pred2</dt><dd><p>a second possible predictor</p>
</dd>
<dt>xcoords</dt><dd><p>coordinates on the x-axis</p>
</dd>
<dt>ycoords</dt><dd><p>coordinates on the y-axis</p>
</dd>
<dt>dummyvar</dt><dd><p>an extra variable</p>
</dd>
<dt>areavar</dt><dd><p>Variable for the area of each plot</p>
</dd>
</dl>
<p>...

</p>

<hr>
<h2 id='fitted.slmfit'>Extract Fitted Values from an <code>slmfit</code> object.</h2><span id='topic+fitted.slmfit'></span>

<h3>Description</h3>

<p>Extract Fitted Values from an <code>slmfit</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted.slmfit_+3A_object">object</code></td>
<td>
<p>a <code>slmfit</code> object generated from the <code><a href="#topic+slmfit">slmfit</a>()</code> function.</p>
</td></tr>
<tr><td><code id="fitted.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of fitted values (estimated means)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
fitted(slmobj)
</code></pre>

<hr>
<h2 id='geostatSim'>Simulate geostatistical data on set of given locations</h2><span id='topic+geostatSim'></span>

<h3>Description</h3>

<p>Spatially correlated data are simulated assuming a multivariate normal
random error vector. For simplicity, only <code>"Exponential"</code> and <code>"Spherical"</code> simulation options are given here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geostatSim(
  loc.data,
  xcol = "x",
  ycol = "y",
  parsil = 1,
  range = 1,
  nugget = 0,
  minorp = 1,
  rotate = 90,
  extrap = NULL,
  CorModel = "Exponential"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geostatSim_+3A_loc.data">loc.data</code></td>
<td>
<p>data.frame with x- and y-coordinates of locations for simulated data</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_xcol">xcol</code></td>
<td>
<p>name of the column in loc.data with x-coordinates, default is &quot;x&quot;</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_ycol">ycol</code></td>
<td>
<p>name of the column loc.data with y-coordinates, default is &quot;y&quot;</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_parsil">parsil</code></td>
<td>
<p>partial sill of autocorrelation model, default = 1</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_range">range</code></td>
<td>
<p>range of autocorrelation model, default = 1</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_nugget">nugget</code></td>
<td>
<p>range of autocorrelation model, default = 0</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_minorp">minorp</code></td>
<td>
<p>proportion of range in x direction to that of y direction for unrotated anisotropic model, default = 1</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_rotate">rotate</code></td>
<td>
<p>rotation of anisotropic axes, default = 90</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_extrap">extrap</code></td>
<td>
<p>extra covariance parameter</p>
</td></tr>
<tr><td><code id="geostatSim_+3A_cormodel">CorModel</code></td>
<td>
<p>autocorrelation model, default = &quot;Exponential&quot;.  Other possibilities are &quot;Spherical&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of three columns, the original location data appended with a 3rd column of simulated geostatistical data
</p>


<h3>Author(s)</h3>

<p>Jay Ver Hoef
</p>


<h3>Examples</h3>

<pre><code class='language-R'>locations &lt;- expand.grid(1:10, 1:10)
geostatSim(locations, xcol = "Var1", ycol = "Var2",
parsil = 4, range = 20, nugget = 1, CorModel = "Exponential")
</code></pre>

<hr>
<h2 id='get.predinfo-deprecated'>Display basic summary information in a tabular form.</h2><span id='topic+get.predinfo-deprecated'></span><span id='topic+get.predinfo'></span>

<h3>Description</h3>

<p><code>get.predinfo()</code> has been deprecated. Information given
is now provided in the basic print of a
<code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> object. Creates a list of tables that shows the prediction, standard error, and
confidence interval for the prediction, as well as some summary information
about the sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.predinfo(x, conf_level = 0.9)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.predinfo-deprecated_+3A_x">x</code></td>
<td>
<p>the output of the <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> function, of class <code>predict.slmfit</code></p>
</td></tr>
<tr><td><code id="get.predinfo-deprecated_+3A_conf_level">conf_level</code></td>
<td>
<p>is the confidence level for a normal-based
confidence interval (default = 0.90).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of three tables, including </p>

<ul>
<li> <p><code>simptab</code>, which contains the prediction and its standard error,
</p>
</li>
<li> <p><code>confbounds</code>, which contains a confidence interval for the prediction, and
</p>
</li>
<li> <p><code>outptmat</code>, a table of sampling information, including the number of sites sampled, the total number of sites, the total observed response, and the
observed average density (equal to the average response if all site areas are
equal).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predobj &lt;- predict(slmobj)
## Not Run
## get.predinfo(predobj)
</code></pre>

<hr>
<h2 id='get.predplot-deprecated'>Create a default map from predictions</h2><span id='topic+get.predplot-deprecated'></span><span id='topic+get.predplot'></span>

<h3>Description</h3>

<p>Creates a default map for the predictions of unobserved sites. Note that all predictions are stored
in a data frame in the output of <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code>. Therefore, if a user
would like to create his or her own plot, he or she can easily do so using
this data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.predplot(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.predplot-deprecated_+3A_x">x</code></td>
<td>
<p>the output of the <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> function, of class <code>predict.slmfit</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with x-coordinates on the x-axis and y-coordinates on the y-axis that is coloured by predictions, with points with an X denoting that a site was sampled and filled circles denoting unsampled sites.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predobj &lt;- predict(slmobj)
## Not Run
## get.predplot(predobj)
</code></pre>

<hr>
<h2 id='GR2'>Computes the Generalized R-squared.</h2><span id='topic+GR2'></span>

<h3>Description</h3>

<p>Computes the Generalized R-squared.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GR2(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GR2_+3A_object">object</code></td>
<td>
<p>is an object of class <code>slmfit</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the value for generalized R-squared
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
GR2(slmobj)
</code></pre>

<hr>
<h2 id='LLtoTM'>Convert Lat and Long to Transverse Mercator (TM)</h2><span id='topic+LLtoTM'></span>

<h3>Description</h3>

<p>Latitude and Longitude coordinates are converted to TM
projection coordinates with a user-defined central meridian.
The resulting units from applying the function are kilometers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLtoTM(cm, lat, lon, xcol = "x", ycol = "y", minx = NULL, miny = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LLtoTM_+3A_cm">cm</code></td>
<td>
<p>is the user defined central median. A common choice is the
mean of the longitude values in your data set</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_lat">lat</code></td>
<td>
<p>is the vector of latitudes</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_lon">lon</code></td>
<td>
<p>is the vector of longitudes</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_xcol">xcol</code></td>
<td>
<p>is the name of the output TM column of x coordinates</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_ycol">ycol</code></td>
<td>
<p>is the name of the output TM column of y coordinates</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_minx">minx</code></td>
<td>
<p>is 'NULL' by default and sets the minimum x-coordinate value to 0. This is an optional minimum value for the x-coordinate vector.</p>
</td></tr>
<tr><td><code id="LLtoTM_+3A_miny">miny</code></td>
<td>
<p>is 'NULL' by default and sets the minimum y-coordinate value to 0. This is an optional minimum value for the y-coordinate vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function only should only be used if the coordinates supplied by the
user are latitude and longitude. The default TM projection here specifies
that both the minimum x and y-coordinate values are 0 scaled to 1 km.
</p>


<h3>Value</h3>

<p>A list with the TM coordinates as the first component of the list. The first component of the list contains x coordinates in the first column and y coordinates in the second column. The remaining elements of the list are the <code>cm</code>, <code>minx</code>, and <code>miny</code> values that were input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Add transverse Mercator x and y coordinates to a data frame with
## latitude/longitude coordinates. Name these \code{xc_TM_} and \code{yc_TM_}.
exampledataset$xc_TM_ &lt;- LLtoTM(cm = base::mean(exampledataset[ ,"xcoords"]),
 lat = exampledataset[ ,"ycoords"],
 lon = exampledataset[ ,"xcoords"])$xy[ ,1]
exampledataset$yc_TM_ &lt;- LLtoTM(cm = base::mean(exampledataset[ ,"xcoords"]),
 lat = exampledataset[ ,"ycoords"],
 lon = exampledataset[ ,"xcoords"])$xy[ ,2]
</code></pre>

<hr>
<h2 id='loglik.slmfit'>Extract Log-Likelihood from a fitted class <code>slmfit</code> object</h2><span id='topic+loglik.slmfit'></span>

<h3>Description</h3>

<p>Extract Log-Likelihood from a fitted class <code>slmfit</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik.slmfit(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loglik.slmfit_+3A_object">object</code></td>
<td>
<p>is a class <code>slmfit</code> object</p>
</td></tr>
<tr><td><code id="loglik.slmfit_+3A_...">...</code></td>
<td>
<p>additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log-likelihood of the model fit in the <code>slmfit</code> object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
loglik.slmfit(slmobj)
</code></pre>

<hr>
<h2 id='m2LL.FPBK.nodet'>Covariance Parameter Estimation Function.</h2><span id='topic+m2LL.FPBK.nodet'></span>

<h3>Description</h3>

<p>The primary purpose of <code>m2LL.FPBK.nodet()</code> is to estimate the spatial
covariance parameters using REML. This is a helper function to <code>slmfit()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>m2LL.FPBK.nodet(theta, zcol, XDesign, distmat, CorModel, estmethod)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="m2LL.FPBK.nodet_+3A_theta">theta</code></td>
<td>
<p>is the parameter vector of (nugget, partialsill, range)</p>
</td></tr>
<tr><td><code id="m2LL.FPBK.nodet_+3A_zcol">zcol</code></td>
<td>
<p>is the response vector of densities</p>
</td></tr>
<tr><td><code id="m2LL.FPBK.nodet_+3A_xdesign">XDesign</code></td>
<td>
<p>is the design matrix containing the covariates used to predict animal or plant abundance (including a column of 1's for the intercept).</p>
</td></tr>
<tr><td><code id="m2LL.FPBK.nodet_+3A_distmat">distmat</code></td>
<td>
<p>is the distance matrix of the sampled sites</p>
</td></tr>
<tr><td><code id="m2LL.FPBK.nodet_+3A_cormodel">CorModel</code></td>
<td>
<p>is the geostatistical spatial correlation model to be used. See the <code>corModels</code> documentation for possible models to use.</p>
</td></tr>
<tr><td><code id="m2LL.FPBK.nodet_+3A_estmethod">estmethod</code></td>
<td>
<p>is either &quot;REML&quot; for restricted maximum likelihood or &quot;ML&quot; for maximum likelihood.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric output of minus 2 times the restricted log likelihood to be minimized by 'optim' to obtain spatial parameter estimates.
</p>

<hr>
<h2 id='mginv'>Constructing the generalized inverse of a matrix</h2><span id='topic+mginv'></span>

<h3>Description</h3>

<p>Computes the generalized inverse of a matrix X. This function is used in
the <code>m2LL.FPBK.nodet</code> functions in order
to estimate the spatial covariance parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mginv(X, tol = sqrt(.Machine$double.eps))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mginv_+3A_x">X</code></td>
<td>
<p>The matrix to be inverted</p>
</td></tr>
<tr><td><code id="mginv_+3A_tol">tol</code></td>
<td>
<p>The tolerance of the estimation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The generalized inverse matrix
</p>

<hr>
<h2 id='plot.predict.slmfit'>Create a default map from predictions</h2><span id='topic+plot.predict.slmfit'></span>

<h3>Description</h3>

<p>Creates a default map for the predictions of unobserved sites. Note that all predictions are stored
in a data frame in the output of <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code>. Therefore, if a user
would like to create his or her own plot, they can easily do so using
this data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.slmfit'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.predict.slmfit_+3A_x">x</code></td>
<td>
<p>the output of the <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> function, of class <code>predict.slmfit</code></p>
</td></tr>
<tr><td><code id="plot.predict.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot with x-coordinates on the x-axis and y-coordinates on the y-axis that is coloured by predictions, with points with an X denoting that a site was sampled and filled circles denoting unsampled sites.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predobj &lt;- predict(slmobj)
plot(predobj)
</code></pre>

<hr>
<h2 id='plot.slmfit'>Plot an Empirical Semi-Variogram of Residuals</h2><span id='topic+plot.slmfit'></span>

<h3>Description</h3>

<p>Plots an empirical semi-variogram of the residuals from the spatial linear model
with the fitted parametric model as a curve overtop of the
binned points. By default, the empirical semi-variogram only shows distances
that are less than or equal to the maximum distance in the data
set divided by 2. Therefore, it's possible that the REML-fitted model
will not &quot;fit&quot; the points perfectly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.slmfit_+3A_x">x</code></td>
<td>
<p>is an object of class <code><a href="#topic+slmfit">slmfit</a></code>.</p>
</td></tr>
<tr><td><code id="plot.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a plot of the empirical semi-variogram with the fitted model overlayed.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
plot(slmobj)

data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
plot(strataobj[[1]])
</code></pre>

<hr>
<h2 id='pointSimCSR'>simulate completely spatially random point patterns.</h2><span id='topic+pointSimCSR'></span>

<h3>Description</h3>

<p>simulates a completely spatially random point patterns. This function is
only used in simulating data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointSimCSR(
  npoints = 100,
  lower_x_lim = 0,
  upper_x_lim = 1,
  lower_y_lim = 0,
  upper_y_lim = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointSimCSR_+3A_npoints">npoints</code></td>
<td>
<p>number of points to add that are completely spatially random (CSR), default = 100</p>
</td></tr>
<tr><td><code id="pointSimCSR_+3A_lower_x_lim">lower_x_lim</code></td>
<td>
<p>left limit of boundary, default = 0</p>
</td></tr>
<tr><td><code id="pointSimCSR_+3A_upper_x_lim">upper_x_lim</code></td>
<td>
<p>right limit of boundary, default = 1</p>
</td></tr>
<tr><td><code id="pointSimCSR_+3A_lower_y_lim">lower_y_lim</code></td>
<td>
<p>lower limit of boundary, default = 0</p>
</td></tr>
<tr><td><code id="pointSimCSR_+3A_upper_y_lim">upper_y_lim</code></td>
<td>
<p>upper limit of boundary, default = 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of two columns, x-coordinate in the first, and y-coordinate in the second.
</p>


<h3>Author(s)</h3>

<p>Jay Ver Hoef
</p>

<hr>
<h2 id='pointSimSyst'>Creates a systematic grid of points.</h2><span id='topic+pointSimSyst'></span>

<h3>Description</h3>

<p>Creates a systematic grid of points. This function is only used
in simulating data sets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pointSimSyst(
  nrow = 10,
  ncol = 10,
  lower_x_lim = 0,
  upper_x_lim = 1,
  lower_y_lim = 0,
  upper_y_lim = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pointSimSyst_+3A_nrow">nrow</code></td>
<td>
<p>the number of rows in the systematic grid, default is 10</p>
</td></tr>
<tr><td><code id="pointSimSyst_+3A_ncol">ncol</code></td>
<td>
<p>the number of cols in the systematic grid, default is 10</p>
</td></tr>
<tr><td><code id="pointSimSyst_+3A_lower_x_lim">lower_x_lim</code></td>
<td>
<p>the lower limit for x-coordinate, default is 0</p>
</td></tr>
<tr><td><code id="pointSimSyst_+3A_upper_x_lim">upper_x_lim</code></td>
<td>
<p>the upper limit for x-coordinate, default is 1</p>
</td></tr>
<tr><td><code id="pointSimSyst_+3A_lower_y_lim">lower_y_lim</code></td>
<td>
<p>the lower limit for y-coordinate, default is 0</p>
</td></tr>
<tr><td><code id="pointSimSyst_+3A_upper_y_lim">upper_y_lim</code></td>
<td>
<p>the upper limit for y-coordinate, default is 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with x- and y-coordinates of simulated locations
</p>


<h3>Author(s)</h3>

<p>Jay Ver Hoef
</p>

<hr>
<h2 id='predict.slmfit'>Perform Finite Population Block Kriging</h2><span id='topic+predict.slmfit'></span>

<h3>Description</h3>

<p>Uses an object of class <code>slmfit</code> from the <code><a href="#topic+slmfit">slmfit</a>()</code>
function to predict the response on the unsampled sites.
The column of the data set that has the response should have numeric values for the observed response
on the sampled sites and 'NA' for any site that was not sampled.
Note that there is no <code>newdata</code> argument to
<code>predict.slmfit()</code>: any point in space for which a prediction
is needed should be included in the original data set in <code><a href="#topic+slmfit">slmfit</a>()</code>
with the response variable as <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
predict(object, wtscol = NULL, conf_level = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.slmfit_+3A_object">object</code></td>
<td>
<p>is an object generated from <code><a href="#topic+slmfit">slmfit</a>()</code></p>
</td></tr>
<tr><td><code id="predict.slmfit_+3A_wtscol">wtscol</code></td>
<td>
<p>is the name of the column that contains the weights
for prediction. The default setting predicts the population total</p>
</td></tr>
<tr><td><code id="predict.slmfit_+3A_conf_level">conf_level</code></td>
<td>
<p>is the confidence level for a prediction
interval, 0.90 by default</p>
</td></tr>
<tr><td><code id="predict.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> the estimated population total
</p>
</li>
<li><p> the estimated prediction variance
</p>
</li>
<li><p> a data frame containing </p>

<ol>
<li><p> x-coordinates
</p>
</li>
<li><p> y-coordinates
</p>
</li>
<li><p> density predictions
</p>
</li>
<li><p> count predictions
</p>
</li>
<li><p> site-by-site density prediction variances
</p>
</li>
<li><p> site-by-site count prediction variances
</p>
</li>
<li><p> indicator variable for whether or not the each site was sampled
</p>
</li>
<li><p> estimated mean for each site
</p>
</li>
<li><p> area of each site
</p>
</li></ol>

</li>
<li><p> vector with estimated covariance parameters
</p>
</li>
<li><p> the formula used to fit the model in <code>slmfit()</code>
</p>
</li>
<li><p> the confidence level
</p>
</li>
<li><p> the confidence interval bounds
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predict(slmobj)
</code></pre>

<hr>
<h2 id='predict.stratafit'>Perform Finite Population Block Kriging</h2><span id='topic+predict.stratafit'></span>

<h3>Description</h3>

<p>Uses an object of class <code>stratafit</code> from the <code><a href="#topic+stratafit">stratafit</a>()</code>
function to predict the response on the unsampled sites for separate strata.
The column of the data set that has the response should have numeric values for the observed response
on the sampled sites and 'NA' for any site that was not sampled.
Note that there is no <code>newdata</code> argument to
<code>predict.stratafit()</code>: any point in space for which a prediction
is needed should be included in the original data set in <code><a href="#topic+stratafit">stratafit</a>()</code>
with the response variable as <code>NA</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stratafit'
predict(object, wtscol = NULL, conf_level = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.stratafit_+3A_object">object</code></td>
<td>
<p>is an object generated from <code><a href="#topic+stratafit">stratafit</a>()</code></p>
</td></tr>
<tr><td><code id="predict.stratafit_+3A_wtscol">wtscol</code></td>
<td>
<p>is the name of the column that contains the weights for prediction. The default setting predicts the population total</p>
</td></tr>
<tr><td><code id="predict.stratafit_+3A_conf_level">conf_level</code></td>
<td>
<p>by default, 0.90, this is the desired
confidence level for a prediction interval</p>
</td></tr>
<tr><td><code id="predict.stratafit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> the estimated population total
</p>
</li>
<li><p> the estimated prediction variance
</p>
</li>
<li><p> a data frame containing </p>

<ol>
<li><p> x-coordinates
</p>
</li>
<li><p> y-coordinates
</p>
</li>
<li><p> density predictions
</p>
</li>
<li><p> count predictions
</p>
</li>
<li><p> site-by-site density prediction variances
</p>
</li>
<li><p> site-by-site count prediction variances
</p>
</li>
<li><p> indicator variable for whether or not the each site was sampled
</p>
</li>
<li><p> estimated mean for each site
</p>
</li>
<li><p> area of each site
</p>
</li></ol>

</li>
<li><p> vector with estimated covariance parameters
</p>
</li>
<li><p> the formula used to fit the model in <code>slmfit()</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- stratafit(formula = counts ~ pred1 + pred2,
 data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predict(strataobj)
</code></pre>

<hr>
<h2 id='print.predict.slmfit'>Prints a short summary for the <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> function.</h2><span id='topic+print.predict.slmfit'></span>

<h3>Description</h3>

<p>This function uses the object that is output from <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code> of class <code>predict.slmfit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.slmfit'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.predict.slmfit_+3A_x">x</code></td>
<td>
<p>is a prediction object generated from <code><a href="#topic+predict.slmfit">predict.slmfit</a>()</code></p>
</td></tr>
<tr><td><code id="print.predict.slmfit_+3A_digits">digits</code></td>
<td>
<p>is the number of digits to be displayed in the
model output</p>
</td></tr>
<tr><td><code id="print.predict.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
print(predict(slmobj), digits = 4)
</code></pre>

<hr>
<h2 id='print.predict.stratafit'>Prints a short summary for the <code><a href="#topic+predict.stratafit">predict.stratafit</a>()</code> function.</h2><span id='topic+print.predict.stratafit'></span>

<h3>Description</h3>

<p>This function uses the object that is output from <code><a href="#topic+predict.stratafit">predict.stratafit</a>()</code> of class <code>predict.stratafit</code>..
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'predict.stratafit'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.predict.stratafit_+3A_x">x</code></td>
<td>
<p>is a prediction object generated from <code><a href="#topic+predict.stratafit">predict.stratafit</a>()</code></p>
</td></tr>
<tr><td><code id="print.predict.stratafit_+3A_digits">digits</code></td>
<td>
<p>is the number of digits to be displayed in the
model output</p>
</td></tr>
<tr><td><code id="print.predict.stratafit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> a table of predictions, standard errors, and confidence
intervals for each stratum and for the total.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- stratafit(formula = counts ~ pred1 + pred2,
 data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
predict(strataobj)
</code></pre>

<hr>
<h2 id='print.slmfit'>Prints the fitted coefficient table of a fitted spatial linear model.</h2><span id='topic+print.slmfit'></span>

<h3>Description</h3>

<p>This function uses the object that is output from <code><a href="#topic+slmfit">slmfit</a>()</code> of class <code>slmfit</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.slmfit_+3A_x">x</code></td>
<td>
<p>is an object generated from <code><a href="#topic+slmfit">slmfit</a>()</code></p>
</td></tr>
<tr><td><code id="print.slmfit_+3A_digits">digits</code></td>
<td>
<p>is the number of digits to be displayed in the
model output</p>
</td></tr>
<tr><td><code id="print.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> model formula
</p>
</li>
<li><p> summary statistics for the residuals.
</p>
</li>
<li><p> a table of fixed effects estimates and associated standard errors.
</p>
</li>
<li><p> estimated spatial covariance parameter estimates.
</p>
</li>
<li><p> generalized r-squared value.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
print(slmobj)
</code></pre>

<hr>
<h2 id='print.summary.slmfit'>Prints the summary of a fitted spatial linear model.</h2><span id='topic+print.summary.slmfit'></span>

<h3>Description</h3>

<p>This function uses the object that is output from <code><a href="#topic+summary.slmfit">summary.slmfit</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.slmfit'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.slmfit_+3A_x">x</code></td>
<td>
<p>is an summary object generated from <code><a href="#topic+summary.slmfit">summary.slmfit</a>()</code></p>
</td></tr>
<tr><td><code id="print.summary.slmfit_+3A_digits">digits</code></td>
<td>
<p>is the number of digits to be displayed in the
model output</p>
</td></tr>
<tr><td><code id="print.summary.slmfit_+3A_signif.stars">signif.stars</code></td>
<td>
<p>is an option to show which predictors
are significant.</p>
</td></tr>
<tr><td><code id="print.summary.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> model formula
</p>
</li>
<li><p> summary statistics for the residuals.
</p>
</li>
<li><p> a table of fixed effects estimates and associated standard errors.
</p>
</li>
<li><p> estimated spatial covariance parameter estimates.
</p>
</li>
<li><p> generalized r-squared value.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
print(summary(slmobj))
</code></pre>

<hr>
<h2 id='residuals.slmfit'>Extract Model Residuals from an <code>slmfit</code> object.</h2><span id='topic+residuals.slmfit'></span>

<h3>Description</h3>

<p>Extract Model Residuals from an <code>slmfit</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
residuals(object, type = "raw", cross.validation = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.slmfit_+3A_object">object</code></td>
<td>
<p>a <code>slmfit</code> object generated from the <code><a href="#topic+slmfit">slmfit</a>()</code> function.</p>
</td></tr>
<tr><td><code id="residuals.slmfit_+3A_type">type</code></td>
<td>
<p>residual type: <code>"raw"</code> (the default) or <code>"normalized"</code></p>
</td></tr>
<tr><td><code id="residuals.slmfit_+3A_cross.validation">cross.validation</code></td>
<td>
<p>a logical (<code>TRUE</code> or <code>FALSE</code>) that
indicates whether the residuals computed should be found using
leave one out cross-validation. Set to <code>FALSE</code> by default.</p>
</td></tr>
<tr><td><code id="residuals.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of residuals, consisting of each observed response/density minus the estimated mean, or, in the case of cross-validation, the observed response/density minus the leave-one-out-cross-validation prediction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
residuals(slmobj)
residuals(slmobj, cross.validation = TRUE)
</code></pre>

<hr>
<h2 id='simdata'>Simulated Spatially Autocorrelated Data.</h2><span id='topic+simdata'></span>

<h3>Description</h3>

<p>A simulated data set that can be used with the <code>sptotal</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simdata
</code></pre>


<h3>Format</h3>

<p>A data frame object including:
</p>

<dl>
<dt>x</dt><dd><p>The x-coordinate for each site</p>
</dd>
<dt>y</dt><dd><p>The y-coordinate for each site</p>
</dd>
<dt>X1</dt><dd><p>Simulated independent variable to be used as a predictor</p>
</dd>
<dt>X2</dt><dd><p>Simulated independent variable to be used as a predictor</p>
</dd>
<dt>X3</dt><dd><p>Simulated independent variable to be used as a predictor</p>
</dd>
<dt>X4</dt><dd><p>Simulated independent variable to be used as a predictor</p>
</dd>
<dt>X5</dt><dd><p>Simulated independent variable to be used as a predictor</p>
</dd>
<dt>X6</dt><dd><p>Simulated spatially correlated random variable to be used as a predictor</p>
</dd>
<dt>X7</dt><dd><p>Simulated spatially correlated random variable to be used as a predictor</p>
</dd>
<dt>F1</dt><dd><p>Simulated factor variable to be used as a predictor</p>
</dd>
<dt>F2</dt><dd><p>Simulated factor variable to be used as a predictor</p>
</dd>
<dt>Z</dt><dd><p>The simulated response variable.</p>
</dd>
<dt>wts1</dt><dd><p>Prediction weights if estimating an overall mean</p>
</dd>
<dt>wts2</dt><dd><p>Prediction weights for estimating a total over a subset of 25 contiguous plots</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(simdata)
names(simdata)
summary(simdata)
</code></pre>

<hr>
<h2 id='slmfit'>Fits a Spatial Linear Model</h2><span id='topic+slmfit'></span>

<h3>Description</h3>

<p>Estimates regression coefficients and spatial autocorrelation
parameters, given spatial coordinates and a model formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slmfit(
  formula,
  data,
  xcoordcol,
  ycoordcol,
  areacol = NULL,
  stratacol = NULL,
  CorModel = "Exponential",
  estmethod = "REML",
  covestimates = c(NA, NA, NA)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slmfit_+3A_formula">formula</code></td>
<td>
<p>is an <code>R</code> linear model formula specifying the
response variable as well as covariates for predicting the response on the unsampled sites.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_data">data</code></td>
<td>
<p>is a data frame or tibble with the response column, the covariates to
be used for the block kriging, and the spatial coordinates for all of the sites. Alternatively, data can be an <code>sp</code> Spatial Points Data Frame or <code>sf</code> object with POINT geometry.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_xcoordcol">xcoordcol</code></td>
<td>
<p>is the name of the column in the data frame with x coordinates or longitudinal coordinates</p>
</td></tr>
<tr><td><code id="slmfit_+3A_ycoordcol">ycoordcol</code></td>
<td>
<p>is the name of the column in the data frame with y coordinates or latitudinal coordinates</p>
</td></tr>
<tr><td><code id="slmfit_+3A_areacol">areacol</code></td>
<td>
<p>is the name of the column with the areas of the sites. By default, we assume that all sites have equal area, in which
case a vector of 1's is used as the areas.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_stratacol">stratacol</code></td>
<td>
<p>is the name of the the column with the
stratification variable, if strata are to be fit separately,
with different covariance parameter estimates.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_cormodel">CorModel</code></td>
<td>
<p>is the covariance structure. By default, <code>CorModel</code> is
Exponential but other options include the Spherical and Gaussian.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_estmethod">estmethod</code></td>
<td>
<p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients. This argument can also be set to
<code>"None"</code>, in which case <code>covestimates</code> must be provided.</p>
</td></tr>
<tr><td><code id="slmfit_+3A_covestimates">covestimates</code></td>
<td>
<p>is an optional vector of covariance parameter estimates (nugget, partial sill, range). If these are given and <code>estmethod = "None"</code>, the the provided vector are treated as the estimators to create the covariance structure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class <code>slmfit</code> with </p>

<ul>
<li><p> the spatial covariance estimates
</p>
</li>
<li><p> the regression coefficient estimates
</p>
</li>
<li><p> the covariance matrix of the fixed effects
</p>
</li>
<li><p> minus two times the log-likelihood of the model
</p>
</li>
<li><p> the names of the predictors
</p>
</li>
<li><p> the sample size
</p>
</li>
<li><p> the name of the covariance model used
</p>
</li>
<li><p> a vector of residuals
</p>
</li>
<li><p> the design matrix
</p>
</li>
<li><p> a vector of the sampled densities
</p>
</li>
<li><p> a list containing </p>

<ol>
<li><p> formula, the model formula
</p>
</li>
<li><p> data, the data set input as the <code>data</code> argument
</p>
</li>
<li><p> xcoordcol, the name of the x-coordinate column
</p>
</li>
<li><p> ycoordcol, the name of the y-coordinate column
</p>
</li>
<li><p> estmethod, either REML or ML
</p>
</li>
<li><p> CorModel, the correlation model used
</p>
</li>
<li><p> estimated covariance matrix of all sites
</p>
</li>
<li><p> Inverted covariance matrix on the sampled sites
</p>
</li>
<li><p> the vector of areas.
</p>
</li></ol>

</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(slmobj)

data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(strataobj)
</code></pre>

<hr>
<h2 id='sptotal'>sptotal: A package used for performing Finite Population Block
Kriging (FPBK) on polygonal count data.</h2><span id='topic+sptotal'></span>

<h3>Description</h3>

<p>The package provides an option to perform FPBK on counts assuming
perfect detection of counts on the sites that were in the survey sample. The
functions in the package use methods in (Ver Hoef, 2008,
&lt;doi:10.1007/s10651-007-0035-y&gt;)
</p>


<h3>Details</h3>

<p><code>sptotal</code> Main Functions:
</p>
<p><code><a href="#topic+slmfit">slmfit</a></code> fits a spatial linear model to the response on the
observed/sampled sites.
The function <code><a href="#topic+check.variogram">check.variogram</a></code> can be used to construct
an empirical variogram of the residuals of the spatial linear model.
</p>
<p><code><a href="#topic+predict.slmfit">predict.slmfit</a></code> uses the spatial linear model fit from <code><a href="#topic+slmfit">slmfit</a></code> and finite
population block kriging to predict the response at unobserved locations.
A prediction for the total response as well as a prediction variance
are given by default.
</p>
<p><code><a href="#topic+get.predinfo">get.predinfo</a></code> and <code><a href="#topic+get.predplot">get.predplot</a></code> take the resulting object from
<code><a href="#topic+predict.slmfit">predict.slmfit</a></code> to construct (1) summary information, including the
prediction, prediction variance, and a prediction interval as well as
(2) a plot of the site-wise predictions.
</p>
<p>Most of the remaining functions in the package are either helper functions
or extra optional functions to extract various specific things from an
<code><a href="#topic+slmfit">slmfit</a></code> object, such as residuals, AIC, log-likelihood, etc.
</p>
<p>See the Vignette for more details: <code>browseVignettes("sptotal")</code>
Reference for Mathematical Details:
</p>
<p>Ver Hoef, Jay M. &quot;Spatial methods for plot-based sampling of wildlife
populations.&quot;
A <em>Environmental and Ecological Statistics</em> 15,
no. 1 (2008): 3-13.
</p>

<hr>
<h2 id='stratafit'>Fits a Separate Spatial Linear Model for Each Stratum</h2><span id='topic+stratafit'></span>

<h3>Description</h3>

<p>Estimates regression coefficients and spatial autocorrelation
parameters, given spatial coordinates, a model formula, and a
stratification variable. Arguments are the same here as they are
for <code><a href="#topic+slmfit">slmfit</a>()</code>, with an extra argument for
<code>stratacol</code>, the name of the stratification column. Note that
stratum can either by incorporated as a covariate in
<code><a href="#topic+slmfit">slmfit</a>()</code>, in which case the errors have the same
spatial covariance, or, models with differing spatial covariances
for the errors can be fit to each level of stratum, as is done here
in <code>stratafit()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stratafit(
  formula,
  data,
  xcoordcol,
  ycoordcol,
  stratacol = NULL,
  areacol = NULL,
  CorModel = "Exponential",
  estmethod = "REML"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stratafit_+3A_formula">formula</code></td>
<td>
<p>is an <code>R</code> linear model formula specifying the
response variable as well as covariates for predicting the response on the unsampled sites.</p>
</td></tr>
<tr><td><code id="stratafit_+3A_data">data</code></td>
<td>
<p>is the data set with the response column, the covariates to
be used for the block kriging, and the spatial coordinates for all of the sites.</p>
</td></tr>
<tr><td><code id="stratafit_+3A_xcoordcol">xcoordcol</code></td>
<td>
<p>is the name of the column in the data frame with x coordinates or longitudinal coordinates</p>
</td></tr>
<tr><td><code id="stratafit_+3A_ycoordcol">ycoordcol</code></td>
<td>
<p>is the name of the column in the data frame with y coordinates or latitudinal coordinates</p>
</td></tr>
<tr><td><code id="stratafit_+3A_stratacol">stratacol</code></td>
<td>
<p>is the name of the stratification column</p>
</td></tr>
<tr><td><code id="stratafit_+3A_areacol">areacol</code></td>
<td>
<p>is the name of the column with the areas of the sites. By default, we assume that all sites have equal area, in which
case a vector of 1's is used as the areas.</p>
</td></tr>
<tr><td><code id="stratafit_+3A_cormodel">CorModel</code></td>
<td>
<p>is the covariance structure. By default, <code>CorModel</code> is
Exponential but other options include the Spherical and Gaussian.</p>
</td></tr>
<tr><td><code id="stratafit_+3A_estmethod">estmethod</code></td>
<td>
<p>is either the default <code>"REML"</code> for restricted
maximum likelihood to estimate the covariance parameters and
regression coefficients or <code>"ML"</code> to estimate the covariance
parameters and regression coefficients.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of class <code>slmfit</code> with </p>

<ul>
<li><p> the spatial covariance estimates
</p>
</li>
<li><p> the regression coefficient estimates
</p>
</li>
<li><p> the covariance matrix of the fixed effects
</p>
</li>
<li><p> minus two times the log-likelihood of the model
</p>
</li>
<li><p> the names of the predictors
</p>
</li>
<li><p> the sample size
</p>
</li>
<li><p> the name of the covariance model used
</p>
</li>
<li><p> a vector of residuals
</p>
</li>
<li><p> the design matrix
</p>
</li>
<li><p> a vector of the sampled densities
</p>
</li>
<li><p> a list containing </p>

<ol>
<li><p> formula, the model formula
</p>
</li>
<li><p> data, the data set input as the <code>data</code> argument
</p>
</li>
<li><p> xcoordcol, the name of the x-coordinate column
</p>
</li>
<li><p> ycoordcol, the name of the y-coordinate column
</p>
</li>
<li><p> estmethod, either REML or ML
</p>
</li>
<li><p> CorModel, the correlation model used
</p>
</li>
<li><p> estimated covariance matrix of all sites
</p>
</li>
<li><p> Inverted covariance matrix on the sampled sites
</p>
</li>
<li><p> the vector of areas.
</p>
</li></ol>

</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 19), rep("B", 21))
strataobj &lt;- stratafit(formula = counts ~ pred1 + pred2,
 data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(strataobj)
</code></pre>

<hr>
<h2 id='summary.slmfit'>Summarizes a fitted spatial linear model.</h2><span id='topic+summary.slmfit'></span>

<h3>Description</h3>

<p>In conjunction with <code>print.summary.slmfit()</code>, the output looks similar
to output from <code>R</code>'s standard <code>lm()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'slmfit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.slmfit_+3A_object">object</code></td>
<td>
<p>is an object generated from <code><a href="#topic+slmfit">slmfit</a>()</code> of class <code>slmfit</code>.</p>
</td></tr>
<tr><td><code id="summary.slmfit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> model formula
</p>
</li>
<li><p> a table of fixed effects estimates and associated standard errors
</p>
</li>
<li><p> estimated spatial covariance parameter estimates
</p>
</li>
<li><p> residuals
</p>
</li>
<li><p> generalized r-squared.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(slmobj)
</code></pre>

<hr>
<h2 id='summary.stratafit'>Summarizes a fitted spatial linear model with a stratification variable..</h2><span id='topic+summary.stratafit'></span>

<h3>Description</h3>

<p>If a model is fitted with <code><a href="#topic+stratafit">stratafit</a>()</code>, then
this summary function produces summary output for each level
of the stratification variable in the same style as the
<code><a href="#topic+summary.slmfit">summary.slmfit</a>()</code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stratafit'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.stratafit_+3A_object">object</code></td>
<td>
<p>is an object generated from <code><a href="#topic+slmfit">slmfit</a>()</code> of class <code>slmfit</code>.</p>
</td></tr>
<tr><td><code id="summary.stratafit_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with </p>

<ul>
<li><p> model formula
</p>
</li>
<li><p> a table of fixed effects estimates and associated standard errors
</p>
</li>
<li><p> estimated spatial covariance parameter estimates
</p>
</li>
<li><p> residuals
</p>
</li>
<li><p> generalized r-squared.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
exampledataset$strata &lt;- c(rep("A", 25), rep("B", 15))
strataobj &lt;- stratafit(formula = counts ~ pred1 + pred2,
 data = exampledataset, stratacol = "strata",
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
summary(strataobj)
</code></pre>

<hr>
<h2 id='sv'>Semi-variogram computation</h2><span id='topic+sv'></span>

<h3>Description</h3>

<p>Compute the empirical semivariogram for a data set with specified
x and y spatial coordinates and residuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sv(data, xcoordcol, ycoordcol, residcol, bins = 15, cutoff = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sv_+3A_data">data</code></td>
<td>
<p>A data frame or tibble that contains variables for the
x coordinates, y coordinates, and residuals.</p>
</td></tr>
<tr><td><code id="sv_+3A_xcoordcol">xcoordcol</code></td>
<td>
<p>is the name of the column in the data frame with
x coordinates or longitudinal coordinates</p>
</td></tr>
<tr><td><code id="sv_+3A_ycoordcol">ycoordcol</code></td>
<td>
<p>is the name of the column in the data frame with
y coordinates or latitudinal coordinates</p>
</td></tr>
<tr><td><code id="sv_+3A_residcol">residcol</code></td>
<td>
<p>is the name of the column in the data frame with residuals.</p>
</td></tr>
<tr><td><code id="sv_+3A_bins">bins</code></td>
<td>
<p>Number of equally spaced semivariogram bins. The default is 15.</p>
</td></tr>
<tr><td><code id="sv_+3A_cutoff">cutoff</code></td>
<td>
<p>The maximum spatial distance to be considered. The default is
half of the maximum observed distance in the data frame.</p>
</td></tr>
<tr><td><code id="sv_+3A_...">...</code></td>
<td>
<p>Additional arguments to be used by <code>stats::dist()</code> for
spatial distance calculations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the average distance in each bin (dist), the
semivariance (gamma), and the number of unique pairs in each bin (np)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(exampledataset) ## load a toy data set
slmobj &lt;- slmfit(formula = counts ~ pred1 + pred2, data = exampledataset,
xcoordcol = 'xcoords', ycoordcol = 'ycoords', areacol = 'areavar')
sampleddataset &lt;- na.omit(exampledataset)
svexample &lt;- data.frame(
  xcoords = sampleddataset$xcoords,
  ycoords = sampleddataset$ycoords,
  resids = residuals(slmobj)
)
svdata &lt;- sv(svexample, "xcoords", "ycoords", "resids")
</code></pre>

<hr>
<h2 id='USlakes'>Dissolved Organic Carbon in U.S. Lakes</h2><span id='topic+USlakes'></span>

<h3>Description</h3>

<p>These data contain dissolved organic carbon (DOC) in National Lakes Data from the U.S. Environmental Protection Agency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>USlakes
</code></pre>


<h3>Format</h3>

<p>A data frame with 1206 rows and 9 variables:
</p>

<dl>
<dt>XCOORD</dt><dd><p>x-coordinate from US Contiguous Albers Equal Area Conic projection</p>
</dd>
<dt>YCOORD</dt><dd><p>y-coordinate from US Contiguous Albers Equal Area Conic projection</p>
</dd>
<dt>DOC_RESULT</dt><dd><p>Analyte value, in mg/L, for Dissolved Organic Carbon</p>
</dd>
<dt>ELEVATION</dt><dd><p>Elevation at lake coordinates (LAT_DD_N83, LON_DD_N83) from NHD Digital Elevation Map layer</p>
</dd>
<dt>FCIBIG_LIT</dt><dd><p>Fish cover: index of fish cover due to large structures in the littoral zone</p>
</dd>
<dt>RVFCGNDBARE_RIP</dt><dd><p>riparian zone and vegetation: fraction of ground lacking cover in the riparian zone</p>
</dd>
<dt>RVFCGNDWOODY_RIP</dt><dd><p>riparian zone and vegetation: fraction of ground cover by woody vegetation in the riparian zone</p>
</dd>
<dt>RVFPUNDWOODY_RIP</dt><dd><p>riparian zone and vegetation: fraction of understory with nonwoody cover present in the riparian zone</p>
</dd>
<dt>UID</dt><dd><p>A unique lake identifier in the EPA lake survey databases</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.epa.gov/national-aquatic-resource-surveys/data-national-aquatic-resource-surveys">National Aquatic Resource Surveys</a> webpage.  We combined <a href="https://www.epa.gov/sites/production/files/2016-12/nla2012_wide_siteinfo_08232016.csv">site data</a>, <a href="https://www.epa.gov/sites/production/files/2016-12/nla2012_waterchem_wide.csv">DOC data</a>, and <a href="https://www.epa.gov/sites/production/files/2016-12/nla2012_wide_phabmet_10202016.csv">habitat metrics</a> to create a data set of 1206 lakes in the conterminous United States.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(USlakes)
names(USlakes)
summary(USlakes)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
