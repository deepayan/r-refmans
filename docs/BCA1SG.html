<!DOCTYPE html><html><head><title>Help for package BCA1SG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BCA1SG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adapt_duser'>
<p>A data set adapted from the data set &quot;duser&quot; in the package &quot;FHtest&quot;</p></a></li>
<li><a href='#adapt_skiTum'>
<p>A data set adapted from the data set &quot;skiTum&quot; in the package &quot;spef&quot;</p></a></li>
<li><a href='#BCA1SG_degradation'>
<p>BCA1SG algorithm for degradation data</p></a></li>
<li><a href='#BCA1SG_interval_censor'>
<p>BCA1SG algorithm for interval-censored survival data</p></a></li>
<li><a href='#BCA1SG_NHPP'>
<p>BCA1SG algorithm for panel count data</p></a></li>
<li><a href='#liner'>
<p>The marine engine cylinder liner data from Giorgio et al. (2012)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Block Coordinate Ascent with One-Step Generalized Rosen
Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Wang Yudong, Ye Zhisheng, and Cao Hongyuan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wang Yudong &lt;yudongw@u.nus.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementing the Block Coordinate Ascent with One-Step Generalized Rosen (BCA1SG) algorithm on the semiparametric models for panel count data, interval-censored survival data, and degradation data. A comprehensive description of the BCA1SG algorithm can be found in Wang et al. (2020) <a href="https://github.com/yudongstat/BCA1SG/blob/master/BCA1SG.pdf">https://github.com/yudongstat/BCA1SG/blob/master/BCA1SG.pdf</a>. For details of the semiparametric models for panel count data, interval-censored survival data, and degradation data, please see Wellner and Zhang (2007) &lt;<a href="https://doi.org/10.1214%2F009053607000000181">doi:10.1214/009053607000000181</a>&gt;, Huang and Wellner (1997) &lt;ISBN:978-0-387-94992-5&gt;, and Wang and Xu (2010) &lt;<a href="https://doi.org/10.1198%2FTECH.2009.08197">doi:10.1198/TECH.2009.08197</a>&gt;, respectively.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>FALSE</td>
</tr>
<tr>
<td>Imports:</td>
<td>Matrix, logOfGamma, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-02 02:29:01 UTC; e0265296</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-06 17:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adapt_duser'>
A data set adapted from the data set &quot;duser&quot; in the package &quot;FHtest&quot;
</h2><span id='topic+adapt_duser'></span>

<h3>Description</h3>

<p>Data set of 763 drug users in Badalona (Spain). The data come from the detoxification unit of Hospital Universitari Germans Trias i Pujol in Badalona, Spain. See Gómez et al. (2000) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("adapt_duser")</code></pre>


<h3>Format</h3>

<p>A data frame with 763 observations on the following 4 variables.
</p>

<dl>
<dt><code>left</code></dt><dd><p>left endpoint of time to HIV-infection.</p>
</dd>
<dt><code>right</code></dt><dd><p>right endpoint of time to HIV-infectio.n</p>
</dd>
<dt><code>zgen</code></dt><dd><p>gender (0: male; 1: female).</p>
</dd>
<dt><code>age</code></dt><dd><p>patient's age.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The &quot;FHtest&quot; package.
</p>


<h3>References</h3>

<p>Gómez, G., Calle, M. L., Egea, J. M., and Muga, R.(2000). Risk of HIV infection as a function of the duration of intravenous drug use: A non-parametric Bayesian approach. Statistics in Medicine 19(19), 2641–2656.
</p>

<hr>
<h2 id='adapt_skiTum'>
A data set adapted from the data set &quot;skiTum&quot; in the package &quot;spef&quot;
</h2><span id='topic+adapt_skiTum'></span>

<h3>Description</h3>

<p>A data frame containing the recurrence of skin tumors. See Chiou et al. (2017) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("adapt_skiTum")</code></pre>


<h3>Format</h3>

<p>A data frame with 894 observations on the following 7 variables.
</p>

<dl>
<dt><code>id</code></dt><dd><p>patient id (repeated for each recurrence).</p>
</dd>
<dt><code>time</code></dt><dd><p>observation time.</p>
</dd>
<dt><code>count</code></dt><dd><p>cumulative number of tumors till the current observation time.</p>
</dd>
<dt><code>age</code></dt><dd><p>patient's age at enrollment; age = 1 if greater than 65, age = 0 otherwise.</p>
</dd>
<dt><code>male</code></dt><dd><p>gender; male = 1, female = 0.</p>
</dd>
<dt><code>dfmo</code></dt><dd><p>treatment (DFMO) group = 1; placebo = 0.</p>
</dd>
<dt><code>priorTumor</code></dt><dd><p>number of prior tumor from diagnosis to randomization.</p>
</dd>
</dl>



<h3>Source</h3>

<p>The &quot;spef&quot; package.
</p>


<h3>References</h3>

<p>Chiou S. H., Xu G., Yan J., and Huang C.(2018). Semiparametric Estimation of the Accelerated Mean Model with Panel Count Data under Informative Examination Times. Biometrics, 74(3), 944-953.
</p>

<hr>
<h2 id='BCA1SG_degradation'>
BCA1SG algorithm for degradation data
</h2><span id='topic+BCA1SG_degradation'></span>

<h3>Description</h3>

<p>This function implements the BCA1SG algorithm on the semiparametric random-effects inverse Gaussian process model for degradation data to solve the ML estimates of the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCA1SG_degradation(input_data, initial_delta, initial_r, initial_Lambda = function(x){x},
threshold = 1e-05, max_iter = 5000, max_stepsize = 1e+05, xi = 0.3, contraction = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BCA1SG_degradation_+3A_input_data">input_data</code></td>
<td>

<p>An object of class data.frame.
The structure of the data frame must be
{subject ID, time of measurement, measurement}..
This data frame cannot contain missing values. See the dataset &quot;liner&quot; for an example.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_initial_delta">initial_delta</code></td>
<td>

<p>The initial value of the shape parameter of the gamma distributed scale parameter in the random-effects inverse Gaussian process. See Wang and Xu (2010) for details.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_initial_r">initial_r</code></td>
<td>

<p>The initial value of the rate parameter of the gamma distributed scale parameter in the random-effects inverse Gaussian process. See Wang and Xu (2010) for details.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_initial_lambda">initial_Lambda</code></td>
<td>

<p>An R function which serves as the initial value of the baseline mean function.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_threshold">threshold</code></td>
<td>

<p>Convergence threshold. The algorithm is terminated when the infinity norm of the difference between successive iterates is less than the convergence threshold.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_max_iter">max_iter</code></td>
<td>

<p>Maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_max_stepsize">max_stepsize</code></td>
<td>

<p>Maximum stepsize allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_xi">xi</code></td>
<td>

<p>The xi parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
<tr><td><code id="BCA1SG_degradation_+3A_contraction">contraction</code></td>
<td>

<p>The contraction parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details about the BCA1SG algorithm can be found in Wang et al. (2020), and the details concerning the semiparametric random-effects inverse Gaussian process model can be found in Section 3 of Wang and Xu (2010).
</p>


<h3>Value</h3>

<table>
<tr><td><code>distinct_time</code></td>
<td>
<p>The set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_Lambda</code></td>
<td>
<p>The estimated baseline mean function at the set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_delta</code></td>
<td>
<p>The estimated shape parameter of the gamma distributed scale parameter in the random-effects inverse Gaussian process.</p>
</td></tr>
<tr><td><code>est_r</code></td>
<td>
<p>The estimated rate parameter of the gamma distributed scale parameter in the random-effects inverse Gaussian process.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>The number of iterations.</p>
</td></tr>
<tr><td><code>timecost</code></td>
<td>
<p>The computational time in seconds.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wang Y., Ye Z., and Cao H.
</p>


<h3>References</h3>

<p>Wang Y., Ye, Z.-S., and Cao, H.(2020). On Computation of Semi-Parametric Maximum Likelihood Estimators with Shape Constraints. Submitted.
</p>
<p>Wang X. and Xu, D.(2010). An Inverse Gaussian Process Model for Degradation Data. Technometrics, 52(2), 188-197.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(liner)
res&lt;-BCA1SG_degradation(liner, initial_delta = 1, initial_r = 1, threshold = 5e-2)
res$est_delta
res$est_r
res$iteration
res$timecost
plot(res$distinct_time,res$est_Lambda,type="s",lwd=3,xlab="time",ylab="Baseline mean function")
</code></pre>

<hr>
<h2 id='BCA1SG_interval_censor'>
BCA1SG algorithm for interval-censored survival data
</h2><span id='topic+BCA1SG_interval_censor'></span>

<h3>Description</h3>

<p>This function implements the BCA1SG algorithm on the semiparametric proportional hazard model for interval-censored data to solve the ML estimates of the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCA1SG_interval_censor(input_data, initial_beta, initial_Lambda = function(x){x},
threshold = 1e-05, max_iter = 5000, max_stepsize = 10000, xi = 0.3, contraction = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BCA1SG_interval_censor_+3A_input_data">input_data</code></td>
<td>

<p>An object of class data.frame.
The structure of the data frame must be
{lower bound of the survival time,upper bound of the survival time,covariate_1,...,covariate_p}.
This data frame cannot contain missing values. See the dataset &quot;duser&quot; for an example.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_initial_beta">initial_beta</code></td>
<td>

<p>The initial value of the regression coefficients.
The dimension of this input should comply with the dimension of the covariates.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_initial_lambda">initial_Lambda</code></td>
<td>

<p>An R function which serves as the initial value of the baseline cumulative hazard function.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_threshold">threshold</code></td>
<td>

<p>Convergence threshold. The algorithm is terminated when the infinity norm of the difference between successive iterates is less than the convergence threshold.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_max_iter">max_iter</code></td>
<td>

<p>Maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_max_stepsize">max_stepsize</code></td>
<td>

<p>Maximum stepsize allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_xi">xi</code></td>
<td>

<p>The xi parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
<tr><td><code id="BCA1SG_interval_censor_+3A_contraction">contraction</code></td>
<td>

<p>The contraction parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details about the BCA1SG algorithm can be found in Wang et al. (2020), and the details concerning the semiparametric proportional hazard model can be found in Section 4 of Huang and Wellner (1997).
</p>


<h3>Value</h3>

<table>
<tr><td><code>distinct_time</code></td>
<td>
<p>The set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_Lambda</code></td>
<td>
<p>The estimated baseline cumulative hazard function at the set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_beta</code></td>
<td>
<p>The estimated regression coefficients.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>The number of iterations.</p>
</td></tr>
<tr><td><code>timecost</code></td>
<td>
<p>The computational time in seconds.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If we directly run this function on the data set &quot;duser&quot;, we may get a different result from that presented in Section 6.2 of Wang et al. (2020). This is because the settings about the initial values of the nonparametric baseline cumulative hazard function are different.
</p>


<h3>Author(s)</h3>

<p>Wang Y., Ye Z., and Cao H.
</p>


<h3>References</h3>

<p>Wang Y., Ye, Z.-S., and Cao, H.(2020). On Computation of Semi-Parametric Maximum Likelihood Estimators with Shape Constraints. Submitted.
</p>
<p>Huang J. and Wellner, J.A.(1997). Interval-Censored Survival Data: A Review of Recent Progress. Proceedings of the Fifth Seattle Symposium in Biostatistics, 123-169.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(adapt_duser)
res&lt;-BCA1SG_interval_censor(adapt_duser, initial_beta = rep(0,2), threshold = 5e-3)
res$est_beta
res$iteration
res$timecost
plot(res$distinct_time,res$est_Lambda,type="s",lwd=3,
xlab="time",ylab="Baseline cumulative hazard function")
</code></pre>

<hr>
<h2 id='BCA1SG_NHPP'>
BCA1SG algorithm for panel count data
</h2><span id='topic+BCA1SG_NHPP'></span>

<h3>Description</h3>

<p>This function implements the BCA1SG algorithm on the semiparametric nonhomogeneous Poisson process model for panel count data to solve the ML estimates of the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BCA1SG_NHPP(input_data, initial_beta, initial_Lambda = function(x){x}, threshold = 1e-05,
            max_iter = 5000, max_stepsize = 10000, xi = 0.3, contraction = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BCA1SG_NHPP_+3A_input_data">input_data</code></td>
<td>

<p>An object of class data.frame.
The structure of the data frame must be
{patient ID, time of measurement, measurement(cumulative counts),covariate_1,...,covariate_p}.
This data frame cannot contain missing values. See the dataset &quot;skiTum&quot; for an example.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_initial_beta">initial_beta</code></td>
<td>

<p>The initial value of the regression coefficients.
The dimension of this input should comply with the dimension of the covariates.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_initial_lambda">initial_Lambda</code></td>
<td>

<p>An R function which serves as the initial value of the baseline mean cumulative function.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_threshold">threshold</code></td>
<td>

<p>Convergence threshold. The algorithm is terminated when the infinity norm of the difference between successive iterates is less than the convergence threshold.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_max_iter">max_iter</code></td>
<td>

<p>Maximum number of iterations allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_max_stepsize">max_stepsize</code></td>
<td>

<p>Maximum stepsize allowed.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_xi">xi</code></td>
<td>

<p>The xi parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
<tr><td><code id="BCA1SG_NHPP_+3A_contraction">contraction</code></td>
<td>

<p>The contraction parameter in the inexact backtracking line search algorithm. See Wang et al. (2020) for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Details about the BCA1SG algorithm can be found in Wang et al. (2020), and the details concerning the semiparametric NHPP model can be found in Wellner and Zhang (2007).
</p>


<h3>Value</h3>

<table>
<tr><td><code>distinct_time</code></td>
<td>
<p>The set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_Lambda</code></td>
<td>
<p>The estimated baseline mean cumulative function at the set of distinct observation time points.</p>
</td></tr>
<tr><td><code>est_beta</code></td>
<td>
<p>The estimated regression coefficients.</p>
</td></tr>
<tr><td><code>iteration</code></td>
<td>
<p>The number of iterations.</p>
</td></tr>
<tr><td><code>timecost</code></td>
<td>
<p>The computational time in seconds.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Wang Y., Ye Z., and Cao H.
</p>


<h3>References</h3>

<p>Wang Y., Ye, Z.-S., and Cao, H.(2020). On Computation of Semi-Parametric Maximum Likelihood Estimators with Shape Constraints. Submitted.
</p>
<p>Wellner J.A. and Zhang Y.(2007). Two Likelihood-Based Semiparametric Estimation Methods for Panel Count Data with Covariates. The Annals of Statistics, 35(5), 2106-2142.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(adapt_skiTum)
res&lt;-BCA1SG_NHPP(adapt_skiTum, initial_beta = rep(0,4), threshold = 2e-3)
res$est_beta
res$iteration
res$timecost
plot(res$distinct_time,res$est_Lambda,type="s",lwd=3,
xlab="Time",ylab="Baseline mean cumulative function")
</code></pre>

<hr>
<h2 id='liner'>
The marine engine cylinder liner data from Giorgio et al. (2012)
</h2><span id='topic+liner'></span>

<h3>Description</h3>

<p>The degradation data measured on 32 marine engine cylinder liners from January 1999 to August 2006. See Giorgio et al. (2012) for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("liner")</code></pre>


<h3>Format</h3>

<p>A data frame with 64 observations on the following 3 variables.
</p>

<dl>
<dt><code>ID</code></dt><dd><p>liner ID.</p>
</dd>
<dt><code>Timepoints</code></dt><dd><p>the time of measurement (in years).</p>
</dd>
<dt><code>Measurements</code></dt><dd><p>the measurement (in mm).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Giorgio M., Guida M., and Pulcini G.(2012). A State-Dependent Wear Model with an Application to Marine Engine Cylinder Liners. Technometrics, 52(2), 172-187.
</p>


<h3>References</h3>

<p>Giorgio M., Guida M., and Pulcini G.(2012). A State-Dependent Wear Model with an Application to Marine Engine Cylinder Liners. Technometrics, 52(2), 172-187.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
