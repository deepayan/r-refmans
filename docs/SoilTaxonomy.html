<!DOCTYPE html><html><head><title>Help for package SoilTaxonomy</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SoilTaxonomy}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#code_to_level'><p>Determine taxonomic level of a taxonomic letter code</p></a></li>
<li><a href='#decompose_taxon_code'><p>Decompose taxon letter codes</p></a></li>
<li><a href='#explainST'><p>Explain a taxon name using formative elements</p></a></li>
<li><a href='#extractSMR'><p>Extract Soil Moisture Regime from Subgroup or Higher Level Taxon</p></a></li>
<li><a href='#FormativeElements'><p>Identify formative elements in taxon names at Soil Order, Suborder, Great Group or Subgroup level</p></a></li>
<li><a href='#get_ST_family_classes'><p>Get soil family / series differentiae and class names</p></a></li>
<li><a href='#get_ST_features'><p>Get soil diagnostic horizons, characteristics and features</p></a></li>
<li><a href='#getChildTaxa'><p>Get the lower (child) taxa for a taxon name or code</p></a></li>
<li><a href='#getLastChildTaxon'><p>Get last child taxon in Keys at specified taxonomic level</p></a></li>
<li><a href='#getParentTaxa'><p>Get the higher (parent) taxa for a taxon name or code</p></a></li>
<li><a href='#getTaxonAtLevel'><p>Get the taxon name at the Soil Order, Suborder, Great Group or Subgroup level</p></a></li>
<li><a href='#isValidST'><p>Check for valid taxonomic level (Order, Suborder, Great Group, Subgroup)</p></a></li>
<li><a href='#level_hierarchy'><p>Order of Hierarchical Levels in Soil Taxonomy</p></a></li>
<li><a href='#level_to_taxon'><p>Get all taxa at specified level</p></a></li>
<li><a href='#newick_string'><p>Generate Newick Tree Format Parenthetic Strings</p></a></li>
<li><a href='#parent_level'><p>Parent/Child Hierarchy</p></a></li>
<li><a href='#parse_family'><p>Parse components of a &quot;family-level&quot; taxon name</p></a></li>
<li><a href='#preceding_taxon_codes'><p>Get taxon codes of preceding taxa</p></a></li>
<li><a href='#relative_taxon_code_position'><p>Determine relative position of taxon within Keys to Soil Taxonomy (Order to Subgroup)</p></a></li>
<li><a href='#SoilTaxonomy-package'><p>SoilTaxonomy: A System of Soil Classification for Making and Interpreting Soil Surveys</p></a></li>
<li><a href='#SoilTaxonomyLevels'><p>Get (Ordered) Factors based on Soil Taxonomy Key position</p></a></li>
<li><a href='#ST'><p>Soil Taxonomy Hierarchy</p></a></li>
<li><a href='#ST_family_classes'><p>Family-level Classes for Soil Taxonomy</p></a></li>
<li><a href='#ST_features'><p>Epipedons, Diagnostic Horizons, Characteristics and Features in Soil Taxonomy</p></a></li>
<li><a href='#ST_formative_elements'><p>Formative Elements used by Soil Taxonomy</p></a></li>
<li><a href='#ST_higher_taxa_codes_12th'><p>Letter Code Lookup Table for Position of Taxa within the Keys to Soil Taxonomy (12th Edition)</p></a></li>
<li><a href='#ST_higher_taxa_codes_13th'><p>Letter Code Lookup Table for Position of Taxa within the Keys to Soil Taxonomy (13th Edition)</p></a></li>
<li><a href='#taxon_code_to_taxon'><p>Convert taxon code to taxon name</p></a></li>
<li><a href='#taxon_to_level'><p>Determine taxonomic level of specified taxa</p></a></li>
<li><a href='#taxon_to_taxon_code'><p>Convert taxon name to taxon code</p></a></li>
<li><a href='#taxonTree'><p>Create a <code>data.tree</code> Object from Taxon Names</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>A System of Soil Classification for Making and Interpreting Soil
Surveys</td>
</tr>
<tr>
<td>Description:</td>
<td>Taxonomic dictionaries, formative element lists, and functions related to the maintenance, development and application of U.S. Soil Taxonomy. 
   Data and functionality are based on official U.S. Department of Agriculture sources including the latest edition of the Keys to Soil Taxonomy. Descriptions and metadata are obtained from the National Soil Information System or Soil Survey Geographic databases. Other sources are referenced in the data documentation. 
   Provides tools for understanding and interacting with concepts in the U.S. Soil Taxonomic System. Most of the current utilities are for working with taxonomic concepts at the "higher" taxonomic levels: Order, Suborder, Great Group, and Subgroup.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.4</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Brown &lt;andrew.g.brown@usda.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ncss-tech/SoilTaxonomy">https://github.com/ncss-tech/SoilTaxonomy</a>,
<a href="https://ncss-tech.github.io/SoilTaxonomy/">https://ncss-tech.github.io/SoilTaxonomy/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ncss-tech/SoilTaxonomy/issues">https://github.com/ncss-tech/SoilTaxonomy/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, stringr, data.table</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, rmarkdown, markdown, soilDB, ape, data.tree</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-16 18:38:34 UTC; Andrew.G.Brown</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Brown [aut, cre],
  Dylan Beaudette [aut]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-16 18:54:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='code_to_level'>Determine taxonomic level of a taxonomic letter code</h2><span id='topic+code_to_level'></span>

<h3>Description</h3>

<p>Determine taxonomic level of a taxonomic letter code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>code_to_level(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="code_to_level_+3A_code">code</code></td>
<td>
<p>A character vector of taxon codes (case sensitive)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector containing <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code> or <code>"subgroup"</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# order level code (1 character)
code_to_level("B")

# subgroup level code (4 characters)
code_to_level("ABCD")

# subgroup level code (5 characters, 4 uppercase + 1 lowercase)
code_to_level("IFFZh")

</code></pre>

<hr>
<h2 id='decompose_taxon_code'>Decompose taxon letter codes</h2><span id='topic+decompose_taxon_code'></span>

<h3>Description</h3>

<p>Find all codes that logically comprise the specified codes. For instance, code &quot;ABC&quot; (&quot;Anhyturbels&quot;) returns &quot;A&quot; (&quot;Gelisols&quot;), &quot;AB&quot; (&quot;Turbels&quot;), &quot;ABC&quot; (&quot;Anhyturbels&quot;). Use in conjunction with a lookup table that maps Order, Suborder, Great Group and Subgroup taxa to their codes (see <code><a href="#topic+taxon_code_to_taxon">taxon_code_to_taxon</a></code> and <code><a href="#topic+taxon_to_taxon_code">taxon_to_taxon_code</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decompose_taxon_code(codes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decompose_taxon_code_+3A_codes">codes</code></td>
<td>
<p>A character vector of taxon codes to &quot;decompose&quot; &ndash; case sensitive</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Accounts for Keys that run out of capital letters (more than 26 subgroups) and use lowercase letters for a unique subdivision within the &quot;fourth character position.&quot;
</p>


<h3>Value</h3>

<p>A list with equal length to input vector; one character vector per element
</p>


<h3>See Also</h3>

<p><code><a href="#topic+preceding_taxon_codes">preceding_taxon_codes</a></code>, <code><a href="#topic+taxon_code_to_taxon">taxon_code_to_taxon</a></code>, <code><a href="#topic+taxon_to_taxon_code">taxon_to_taxon_code</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
decompose_taxon_code(c("ABC", "ABCDe", "BCDEf"))

</code></pre>

<hr>
<h2 id='explainST'>Explain a taxon name using formative elements</h2><span id='topic+explainST'></span>

<h3>Description</h3>

<p>Explain a taxon name using formative elements
</p>


<h3>Usage</h3>

<pre><code class='language-R'>explainST(x, format = c("text", "html"), viewer = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="explainST_+3A_x">x</code></td>
<td>
<p>a Subgroup, Great Group, Suborder or Order-level taxonomic name; matching is exact and case-insensitive</p>
</td></tr>
<tr><td><code id="explainST_+3A_format">format</code></td>
<td>
<p>output format: 'text' | 'html'</p>
</td></tr>
<tr><td><code id="explainST_+3A_viewer">viewer</code></td>
<td>
<p>show <code>format = 'html'</code> output in browser? default: <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a block of text, suitable for display in fixed-width font
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
cat(explainST("ids"), "\n\n")              #  -ids (order suffix) 
cat(explainST("aridisols"), "\n\n")        # Aridisols (order name)
cat(explainST("argids"), "\n\n")           # Arg- (suborder) 
cat(explainST("haplargids"), "\n\n")       # Hap- (great group)
cat(explainST("typic haplargids"), "\n\n") # Typic (subgroup)

</code></pre>

<hr>
<h2 id='extractSMR'>Extract Soil Moisture Regime from Subgroup or Higher Level Taxon</h2><span id='topic+extractSMR'></span>

<h3>Description</h3>

<p>Extract Soil Moisture Regime from Subgroup or Higher Level Taxon
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractSMR(taxon, as.is = FALSE, droplevels = FALSE, ordered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractSMR_+3A_taxon">taxon</code></td>
<td>
<p>character. Vector of taxon names.</p>
</td></tr>
<tr><td><code id="extractSMR_+3A_as.is">as.is</code></td>
<td>
<p>Return character labels rather than an (ordered) factor? Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="extractSMR_+3A_droplevels">droplevels</code></td>
<td>
<p>Drop unused levels? Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="extractSMR_+3A_ordered">ordered</code></td>
<td>
<p>Create an ordinal factor? Default: <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an (ordered) factor of Soil Moisture Regimes, or character vector when <code>as.is=TRUE</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>extractSMR(c("aquic haploxeralfs", "typic epiaqualfs", "humic inceptic eutroperox"))
</code></pre>

<hr>
<h2 id='FormativeElements'>Identify formative elements in taxon names at Soil Order, Suborder, Great Group or Subgroup level</h2><span id='topic+FormativeElements'></span><span id='topic+OrderFormativeElements'></span><span id='topic+SubOrderFormativeElements'></span><span id='topic+GreatGroupFormativeElements'></span><span id='topic+SubGroupFormativeElements'></span><span id='topic+get_ST_formative_elements'></span>

<h3>Description</h3>

<p>Identify formative elements in taxon names at Soil Order, Suborder, Great Group or Subgroup level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FormativeElements(x, level = c("order", "suborder", "greatgroup", "subgroup"))

OrderFormativeElements(x)

SubOrderFormativeElements(x)

GreatGroupFormativeElements(x)

SubGroupFormativeElements(x)

get_ST_formative_elements(
  level = c("order", "suborder", "greatgroup", "subgroup")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FormativeElements_+3A_x">x</code></td>
<td>
<p>A character vector containing subgroup-level taxonomic names</p>
</td></tr>
<tr><td><code id="FormativeElements_+3A_level">level</code></td>
<td>
<p>one of <code>c("order","suborder","greatgroup","subgroup")</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code style="white-space: pre;">&#8288;$defs&#8288;</code>: a <code>data.frame</code> containing taxonomic elements, derivations, connotations and links. And <code style="white-space: pre;">&#8288;$char.index&#8288;</code>: a numeric denoting the position where the formative element occurs in the search text <code>x</code>
</p>
<p><code>get_ST_formative_elements()</code>: a data.frame containing descriptors of formative elements used at the specified <code>level</code>
</p>


<h3>Author(s)</h3>

<p>D.E. Beaudette, A.G. Brown
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
FormativeElements("acrudoxic plinthic kandiudults", level = "subgroup")
SubGroupFormativeElements("acrudoxic plinthic kandiudults")

FormativeElements("acrudoxic plinthic kandiudults", level = "greatgroup")
GreatGroupFormativeElements("acrudoxic plinthic kandiudults")

FormativeElements("acrudoxic plinthic kandiudults", level = "suborder")
SubOrderFormativeElements("acrudoxic plinthic kandiudults")

FormativeElements("acrudoxic plinthic kandiudults", level = "order")
OrderFormativeElements("acrudoxic plinthic kandiudults")

</code></pre>

<hr>
<h2 id='get_ST_family_classes'>Get soil family / series differentiae and class names</h2><span id='topic+get_ST_family_classes'></span>

<h3>Description</h3>

<p>All parameters to this function are optional (default <code>NULL</code>). If specified, they are used as filters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ST_family_classes(
  classname = NULL,
  group = NULL,
  name = NULL,
  chapter = NULL,
  page = NULL,
  multiline_sep = "\n",
  multiline_col = "criteria"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ST_family_classes_+3A_classname">classname</code></td>
<td>
<p>optional filtering vector; levels of <code>ChoiceName</code> column from NASIS metadata</p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_group">group</code></td>
<td>
<p>optional filtering vector; one or more of: <code>"Mineral Family"</code>, <code>"Organic Family"</code>, <code>"Mineral or Organic"</code></p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_name">name</code></td>
<td>
<p>optional filtering vector; one or more of: <code>"Mineralogy Classes"</code>, <code>"Mineralogy Classes Applied Only to Limnic Subgroups"</code>, <code>"Mineralogy Classes Applied Only to Terric Subgroups"</code>, <code>"Key to the Particle-Size and Substitute Classes of Mineral Soils"</code>, <code>"Calcareous and Reaction Classes of Mineral Soils"</code>, <code>"Reaction Classes for Organic Soils"</code>, <code>"Soil Moisture Subclasses"</code>, <code>"Other Family Classes"</code>, <code>"Soil Temperature Classes"</code>, <code>"Soil Moisture Regimes"</code>, <code>"Cation-Exchange Activity Classes"</code>, <code>"Use of Human-Altered and Human-Transported Material Classes"</code></p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_chapter">chapter</code></td>
<td>
<p>optional filtering vector for chapter number</p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_page">page</code></td>
<td>
<p>optional filtering vector; page number (12th Edition Keys to Soil Taxonomy)</p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_multiline_sep">multiline_sep</code></td>
<td>
<p>default <code>"\n"</code> returns <code>multiline_col</code> column as a character vector concatenated with <code>"\n"</code>. Use <code>NULL</code> for list</p>
</td></tr>
<tr><td><code id="get_ST_family_classes_+3A_multiline_col">multiline_col</code></td>
<td>
<p>character. vector of &quot;multi-line&quot; column names to concatenate. Default: <code>"criteria"</code>; use <code>NULL</code> for no concatenation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper method around the package data set <code>ST_family_classes</code>.
</p>


<h3>Value</h3>

<p>a <em>data.frame</em>
</p>
<p>a subset of <code>ST_family_classes</code> <em>data.frame</em>
</p>


<h3>See Also</h3>

<p><code>ST_family_classes</code> <code>ST_features</code> <code>get_ST_features()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get classes in chapter 17
str(get_ST_family_classes(chapter = 17))

# get classes on page 323
get_ST_family_classes(page = 323)

# get the description for the mesic temperature class from list column
str(get_ST_family_classes(classname = "mesic")$description)

</code></pre>

<hr>
<h2 id='get_ST_features'>Get soil diagnostic horizons, characteristics and features</h2><span id='topic+get_ST_features'></span>

<h3>Description</h3>

<p>All parameters to this function are optional (default <code>NULL</code>). If specified, they are used as filters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ST_features(
  group = NULL,
  chapter = NULL,
  name = NULL,
  page = NULL,
  multiline_sep = "\n",
  multiline_col = "criteria"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ST_features_+3A_group">group</code></td>
<td>
<p>optional filtering vector; one of: <code>"Surface"</code>, <code>"Subsurface"</code>, <code>"Mineral"</code>, <code>"Organic"</code>, <code>"Mineral or Organic"</code></p>
</td></tr>
<tr><td><code id="get_ST_features_+3A_chapter">chapter</code></td>
<td>
<p>optional filtering vector for chapter number</p>
</td></tr>
<tr><td><code id="get_ST_features_+3A_name">name</code></td>
<td>
<p>optional filtering vector; these are the &quot;names&quot; of features used in headers</p>
</td></tr>
<tr><td><code id="get_ST_features_+3A_page">page</code></td>
<td>
<p>optional filtering vector; page number (12th Edition Keys to Soil Taxonomy)</p>
</td></tr>
<tr><td><code id="get_ST_features_+3A_multiline_sep">multiline_sep</code></td>
<td>
<p>default <code>"\n"</code> returns <code>multiline_col</code> column as a character vector concatenated with <code>"\n"</code>. Use <code>NULL</code> for list</p>
</td></tr>
<tr><td><code id="get_ST_features_+3A_multiline_col">multiline_col</code></td>
<td>
<p>character. vector of &quot;multi-line&quot; column names to concatenate. Default: <code>"criteria"</code>; use <code>NULL</code> for no concatenation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a wrapper method around the package data set <code>ST_features</code>.
</p>


<h3>Value</h3>

<p>a subset of <code>ST_features</code> <em>data.frame</em>
</p>


<h3>See Also</h3>

<p><code>ST_features</code> <code>ST_family_classes</code> <code>get_ST_family_classes()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get all features
str(get_ST_features())

# get features in chapter 3
str(get_ST_features(chapter = 3))

# get features on pages 18, 19, 20
get_ST_features(page = 18:20)

# get the required characteristics for the mollic epipedon from list column
str(get_ST_features(name = "Mollic Epipedon")$criteria)

</code></pre>

<hr>
<h2 id='getChildTaxa'>Get the lower (child) taxa for a taxon name or code</h2><span id='topic+getChildTaxa'></span>

<h3>Description</h3>

<p>Get the lower (child) taxa for a taxon name or code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getChildTaxa(
  taxon = NULL,
  code = NULL,
  convert = TRUE,
  level = c("order", "suborder", "greatgroup", "subgroup")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getChildTaxa_+3A_taxon">taxon</code></td>
<td>
<p>A character vector of taxa (case-insensitive)</p>
</td></tr>
<tr><td><code id="getChildTaxa_+3A_code">code</code></td>
<td>
<p>A character vector of taxon codes (case sensitive)</p>
</td></tr>
<tr><td><code id="getChildTaxa_+3A_convert">convert</code></td>
<td>
<p>Convert results from taxon codes to taxon names? Default: TRUE</p>
</td></tr>
<tr><td><code id="getChildTaxa_+3A_level">level</code></td>
<td>
<p>Filter results to specific level? Default: <code>"order"</code>,<code>"suborder"</code>,<code>"greatgroup"</code>,<code>"subgroup"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list, where names are taxon codes and values are character vectors representing parent taxa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# suborder children of "Mollisols"
getChildTaxa("Mollisols", level = "suborder")

# get all children within a great group, given a subgroup
getChildTaxa(getTaxonAtLevel("Ultic Haploxeralfs", "greatgroup"))

</code></pre>

<hr>
<h2 id='getLastChildTaxon'>Get last child taxon in Keys at specified taxonomic level</h2><span id='topic+getLastChildTaxon'></span>

<h3>Description</h3>

<p>Get last child taxon in Keys at specified taxonomic level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLastChildTaxon(level = c("order", "suborder", "greatgroup"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getLastChildTaxon_+3A_level">level</code></td>
<td>
<p>Get child taxa from keys at specified level. One of: <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing <code>key</code> (parent key), <code>taxon</code> (last taxon name), <code>code</code> (letter code), <code>position</code> (relative taxon position)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get last taxa in suborder-level keys
x &lt;- getLastChildTaxon(level = "suborder")

# proportion of keys where last taxon has "Hap" formative element
prop.table(table(grepl("^Hap", x$taxon)))
</code></pre>

<hr>
<h2 id='getParentTaxa'>Get the higher (parent) taxa for a taxon name or code</h2><span id='topic+getParentTaxa'></span>

<h3>Description</h3>

<p>Must specify either <code>taxon</code> or <code>code</code>. <code>taxon</code> is used if both are specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getParentTaxa(
  taxon = NULL,
  code = NULL,
  convert = TRUE,
  level = c("order", "suborder", "greatgroup", "subgroup")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getParentTaxa_+3A_taxon">taxon</code></td>
<td>
<p>A character vector of taxa (case-insensitive)</p>
</td></tr>
<tr><td><code id="getParentTaxa_+3A_code">code</code></td>
<td>
<p>A character vector of taxon codes (case sensitive)</p>
</td></tr>
<tr><td><code id="getParentTaxa_+3A_convert">convert</code></td>
<td>
<p>Convert results from taxon codes to taxon names? Default: <code>TRUE</code></p>
</td></tr>
<tr><td><code id="getParentTaxa_+3A_level">level</code></td>
<td>
<p>level    Filter results to specific level? Default: <code>"order"</code>,<code>"suborder"</code>,<code>"greatgroup"</code>,<code>"subgroup"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named list, where names are taxon codes and values are character vectors representing parent taxa
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
getParentTaxa("ultic haploxeralfs")

getParentTaxa(code = c("ABCD", "DABC"))

getParentTaxa("folists", convert = FALSE)

</code></pre>

<hr>
<h2 id='getTaxonAtLevel'>Get the taxon name at the Soil Order, Suborder, Great Group or Subgroup level</h2><span id='topic+getTaxonAtLevel'></span>

<h3>Description</h3>

<p>Get the taxon name at the Soil Order, Suborder, Great Group or Subgroup level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getTaxonAtLevel(x, level = "order", simplify = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getTaxonAtLevel_+3A_x">x</code></td>
<td>
<p>A character vector containing subgroup-level taxonomic names</p>
</td></tr>
<tr><td><code id="getTaxonAtLevel_+3A_level">level</code></td>
<td>
<p>one of <code>c("order","suborder","greatgroup","subgroup")</code></p>
</td></tr>
<tr><td><code id="getTaxonAtLevel_+3A_simplify">simplify</code></td>
<td>
<p>Return a vector when <code>level</code> has length <code>1</code>? Default: <code>TRUE</code>. Otherwise, a data.frame is returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named character vector of taxa at specified level, where names are the internal Soil Taxonomy letter codes.  When <code>length(level) &gt; 1</code>?  a data.frame is returned with column names for each <code>level</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# default gets the soil order
getTaxonAtLevel(c("typic haplargids", "typic glacistels")) #, level = "order")

# specify alternate levels
getTaxonAtLevel("humic haploxerands", level = "greatgroup")

# can't get subgroup (child) from great group (parent)
getTaxonAtLevel("udifolists", level = "subgroup")

# but can do parents of children
getTaxonAtLevel("udifolists", level = "suborder")

# specify multiple levels (returns a list element for each level)
getTaxonAtLevel("hapludolls", c("order", "suborder", "greatgroup", "subgroup"))
</code></pre>

<hr>
<h2 id='isValidST'>Check for valid taxonomic level (Order, Suborder, Great Group, Subgroup)</h2><span id='topic+isValidST'></span>

<h3>Description</h3>

<p>Checks <code>needle</code> for matches against a single level of Soil Taxonomy hierarchy: <code>order</code>, <code>suborder</code>, <code>greatgroup</code>, <code>subgroup</code>. Matches are case-insensitive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isValidST(needle, level = c("order", "suborder", "greatgroup", "subgroup"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isValidST_+3A_needle">needle</code></td>
<td>
<p>vector of taxa</p>
</td></tr>
<tr><td><code id="isValidST_+3A_level">level</code></td>
<td>
<p>single level of Soil Taxonomy hierarchy; one of: <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code>, <code>"subgroup"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>logical</code> vector, same length as needle
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
isValidST('typic haploxeralfs', level = 'subgroup')

</code></pre>

<hr>
<h2 id='level_hierarchy'>Order of Hierarchical Levels in Soil Taxonomy</h2><span id='topic+level_hierarchy'></span>

<h3>Description</h3>

<p>Creates an ordered factor such that different levels (the values used in <code>level</code> arguments to various SoilTaxonomy package functions) in the Soil Taxonomy hierarchy can be distinguished or compared to one another.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>level_hierarchy(
  x = c("order", "suborder", "greatgroup", "subgroup", "family"),
  family = TRUE,
  as.is = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="level_hierarchy_+3A_x">x</code></td>
<td>
<p>Passed as input to <code>factor()</code>; defaults to full set: <code>"order"</code>, <code>"suborder"</code>,  <code>"greatgroup"</code>, <code>"subgroup"</code>, <code>"family"</code>,</p>
</td></tr>
<tr><td><code id="level_hierarchy_+3A_family">family</code></td>
<td>
<p>Allow <code>"family"</code> as input in <code>x</code>? Used for validating inputs that must be a &quot;taxon above family&quot;.</p>
</td></tr>
<tr><td><code id="level_hierarchy_+3A_as.is">as.is</code></td>
<td>
<p>Return <code>x</code> &quot;as is&quot; (after validation)? Shorthand for <code>unclass(taxon_hierarchy())</code> to return simple character vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The levels of Soil Taxonomy hierarchy include: <code>"family"</code>, <code>"subgroup"</code>, <code>"greatgroup"</code>, <code>"suborder"</code>, <code>"order"</code>. The <code>"order"</code> is a level above <code>"suborder"</code>. <code>"subgroup"</code> and above are <code>"taxa above family"</code>.  Note: <code>"family"</code> is always included as the &quot;lowest&quot; level when the result is an ordered factor, even when family-level input is disallowed by <code>family=FALSE</code>.
</p>


<h3>Value</h3>

<p>An ordered factor with the values &quot;order&quot;, &quot;suborder&quot;, &quot;greatgroup&quot;, &quot;subgroup&quot;. or character when <code>as.is=TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# is great group a taxon above family?

level_hierarchy("greatgroup") &gt; "family"

# is order lower level than suborder?
level_hierarchy("order") &lt; "suborder"

# what levels are above or equal to a particular taxon's level?
level_hierarchy(as.is = TRUE)[level_hierarchy() &gt;= taxon_to_level("aquisalids")]

## this produces an error (used for checking for taxa above family)
# level_hierarchy("family", family = FALSE)
</code></pre>

<hr>
<h2 id='level_to_taxon'>Get all taxa at specified level</h2><span id='topic+level_to_taxon'></span>

<h3>Description</h3>

<p>Convenience method for getting taxa from <code>ST_unique_list</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>level_to_taxon(level = c("order", "suborder", "greatgroup", "subgroup"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="level_to_taxon_+3A_level">level</code></td>
<td>
<p>character. One or more of &quot;order&quot;, &quot;suborder&quot;, &quot;greatgroup&quot;, &quot;subgroup&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of taxa at the specified level
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get all order and suborder level taxa

level_to_taxon(level = c("order","suborder"))

</code></pre>

<hr>
<h2 id='newick_string'>Generate Newick Tree Format Parenthetic Strings</h2><span id='topic+newick_string'></span>

<h3>Description</h3>

<p>This function generates <a href="https://en.wikipedia.org/wiki/Newick_format">Newick tree format</a> strings for a single tree. Taxa are assigned relative positions within their parent to indicate the order that they &quot;key out.&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newick_string(
  x = NULL,
  level = c("suborder", "greatgroup", "subgroup"),
  what = c("taxon", "code")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newick_string_+3A_x">x</code></td>
<td>
<p>Optional: a taxon name to get children of.</p>
</td></tr>
<tr><td><code id="newick_string_+3A_level">level</code></td>
<td>
<p>Level to build the tree at. One of <code>"suborder"</code>, <code>"greatgroup"</code>, <code>"subgroup"</code>. Defaults to <code>"suborder"</code> when <code>x</code> is not specified. When <code>x</code> is specified but <code>level</code> is not specified, <code>level</code> is calculated from <code>taxon_to_level(x)</code>.</p>
</td></tr>
<tr><td><code id="newick_string_+3A_what">what</code></td>
<td>
<p>Either <code>"taxon"</code> (default; for taxon names (quoted for subgroups)) or <code>"code"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The output from this function is a character string with parenthetical format encoding a single tree suitable for input into functions such as <code>ape::read.tree()</code>. Multiple trees can be combined together in the file or text string supplied to your tree-parsing function of choice.
</p>


<h3>Value</h3>

<p>character. A single tree in parenthetical Newick or New Hampshire format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace("ape")) {
  par(mar = c(0, 0, 0, 0))

  # "fan"
  mytr &lt;- ape::read.tree(text = newick_string(level = "suborder"))
  plot(mytr, "f", rotate.tree = 180, cex = 0.75)

  # "cladogram"
  mytr &lt;- ape::read.tree(text = newick_string("durixeralfs", level = "subgroup"))
  plot(mytr, "c")

  # "cladogram" (using taxon codes instead of subgroups)
  mytr &lt;- ape::read.tree(text = newick_string("xeralfs", level = "subgroup", what = "code"))
  plot(mytr, "c")

  dev.off()
}
</code></pre>

<hr>
<h2 id='parent_level'>Parent/Child Hierarchy</h2><span id='topic+parent_level'></span><span id='topic+child_level'></span>

<h3>Description</h3>

<p>Parent/Child Hierarchy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parent_level(level, n = 1)

child_level(level, n = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parent_level_+3A_level">level</code></td>
<td>
<p>character. Initial level name of a taxon. Vectors include values that are one of: <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code>, <code>"subgroup"</code>, <code>"family"</code></p>
</td></tr>
<tr><td><code id="parent_level_+3A_n">n</code></td>
<td>
<p>Number of levels above/below (parent/child). Default: <code>1</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>character. Level name of parent or child at specified level above input <code>level</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parent_level('subgroup')

child_level('greatgroup')

parent_level('family', 3)

# no level above order
parent_level('family', 5)
</code></pre>

<hr>
<h2 id='parse_family'>Parse components of a &quot;family-level&quot; taxon name</h2><span id='topic+parse_family'></span>

<h3>Description</h3>

<p>Parse components of a &quot;family-level&quot; taxon name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parse_family(family, column_metadata = TRUE, flat = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parse_family_+3A_family">family</code></td>
<td>
<p>character. vector of taxonomic families, e.g. <code>"fine-loamy, mixed, semiactive, mesic ultic haploxeralfs"</code></p>
</td></tr>
<tr><td><code id="parse_family_+3A_column_metadata">column_metadata</code></td>
<td>
<p>logical. include parsed NASIS physical column names and values from family taxon components? Default: <code>TRUE</code> requires soilDB package.</p>
</td></tr>
<tr><td><code id="parse_family_+3A_flat">flat</code></td>
<td>
<p>logical Default: <code>TRUE</code> to return concatenated family-level classes for <code>"taxminalogy"</code> and <code>"taxfamother"</code>? Alternately, if <code>FALSE</code>, list columns are returned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> containing column names: <code>"family"</code> (input), <code>"subgroup"</code> (parsed taxonomic subgroup), <code>"subgroup_code"</code> (letter code for subgroup), <code>"class_string"</code> (comma-separated family classes), <code>"classes_split"</code> (split <code>class_string</code> vector stored as <code>list</code> column).
</p>
<p>In addition, the following column names are identified and returned based on NASIS (National Soil Information System) metadata (via soilDB package):
</p>

<ul>
<li> <p><code>"taxpartsize"</code>, <code>"taxpartsizemod"</code>, <code>"taxminalogy"</code>, <code>"taxceactcl"</code>, <code>"taxreaction"</code>, <code>"taxtempcl"</code>, <code>"taxfamhahatmatcl"</code>, <code>"taxfamother"</code>, <code>"taxsubgrp"</code>, <code>"taxgreatgroup"</code>, <code>"taxsuborder"</code>, <code>"taxorder"</code>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>if (requireNamespace('soilDB')) {
  families &lt;- c("fine, kaolinitic, thermic typic kanhapludults",
                "fine-loamy, mixed, semiactive, mesic ultic haploxeralfs",
                "euic, thermic typic haplosaprists",
                "coarse-loamy, mixed, active, mesic aquic dystrudepts")

  # inspect parsed list result
  str(parse_family(families))
}
</code></pre>

<hr>
<h2 id='preceding_taxon_codes'>Get taxon codes of preceding taxa</h2><span id='topic+preceding_taxon_codes'></span>

<h3>Description</h3>

<p>Find all codes that logically precede the specified codes. For instance, code &quot;ABC&quot; (&quot;Anhyturbels&quot;) returns &quot;AA&quot; (&quot;Histels&quot;) &quot;ABA&quot; (&quot;Histoturbels&quot;) and &quot;ABB&quot; (&quot;Aquiturbels&quot;). Use in conjunction with a lookup table that maps Order, Suborder, Great Group and Subgroup taxa to their codes (see <code><a href="#topic+taxon_code_to_taxon">taxon_code_to_taxon</a></code> and <code><a href="#topic+taxon_to_taxon_code">taxon_to_taxon_code</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preceding_taxon_codes(codes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preceding_taxon_codes_+3A_codes">codes</code></td>
<td>
<p>A character vector of codes to calculate preceding codes for</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Accounts for Keys that run out of capital letters (more than 26 subgroups) and use lowercase letters for a unique subdivision within the &quot;fourth character position.&quot;
</p>


<h3>Value</h3>

<p>A list with equal length to input vector; one character vector per element
</p>


<h3>See Also</h3>

<p><code><a href="#topic+decompose_taxon_code">decompose_taxon_code</a></code>, <code><a href="#topic+taxon_code_to_taxon">taxon_code_to_taxon</a></code>, <code><a href="#topic+taxon_to_taxon_code">taxon_to_taxon_code</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
preceding_taxon_codes(c("ABCDe", "BCDEf"))

</code></pre>

<hr>
<h2 id='relative_taxon_code_position'>Determine relative position of taxon within Keys to Soil Taxonomy (Order to Subgroup)</h2><span id='topic+relative_taxon_code_position'></span>

<h3>Description</h3>

<p>The relative position of a taxon is <code style="white-space: pre;">&#8288;[number of preceding Key steps] + 1&#8288;</code>, or <code>NA</code> if it does not exist in the lookup table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relative_taxon_code_position(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relative_taxon_code_position_+3A_code">code</code></td>
<td>
<p>A character vector of taxon codes to determine the relative position of.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector with the relative position of each code with respect to their individual Keys.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# "ABCD" -&gt; "Gypsic Anhyturbels", relative position 7
# "WXYZa" does not exist, theoretical position is 97
# "BAD" -&gt; "Udifolists", relative position is 5

relative_taxon_code_position(c("ABCD", "WXYZa", "BAD"))

# [1]  7 NA  5

</code></pre>

<hr>
<h2 id='SoilTaxonomy-package'>SoilTaxonomy: A System of Soil Classification for Making and Interpreting Soil Surveys</h2><span id='topic+SoilTaxonomy-package'></span><span id='topic+_PACKAGE'></span><span id='topic+SoilTaxonomy.env'></span>

<h3>Description</h3>

<p>Taxonomic dictionaries, formative element lists, and functions related to the maintenance, development and application of U.S. Soil Taxonomy. Data and functionality are based on official U.S. Department of Agriculture sources including the latest edition of the Keys to Soil Taxonomy. Descriptions and metadata are obtained from the National Soil Information System or Soil Survey Geographic databases. Other sources are referenced in the data documentation. Provides tools for understanding and interacting with concepts in the U.S. Soil Taxonomic System. Most of the current utilities are for working with taxonomic concepts at the &quot;higher&quot; taxonomic levels: Order, Suborder, Great Group, and Subgroup.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Andrew Brown <a href="mailto:andrew.g.brown@usda.gov">andrew.g.brown@usda.gov</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Dylan Beaudette <a href="mailto:dylan.beaudette@usda.gov">dylan.beaudette@usda.gov</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ncss-tech/SoilTaxonomy">https://github.com/ncss-tech/SoilTaxonomy</a>
</p>
</li>
<li> <p><a href="https://ncss-tech.github.io/SoilTaxonomy/">https://ncss-tech.github.io/SoilTaxonomy/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ncss-tech/SoilTaxonomy/issues">https://github.com/ncss-tech/SoilTaxonomy/issues</a>
</p>
</li></ul>


<hr>
<h2 id='SoilTaxonomyLevels'>Get (Ordered) Factors based on Soil Taxonomy Key position</h2><span id='topic+SoilTaxonomyLevels'></span><span id='topic+SoilMoistureRegimeLevels'></span><span id='topic+SoilTemperatureRegimeLevels'></span>

<h3>Description</h3>

<p>Get (Ordered) Factors based on Soil Taxonomy Key position
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SoilTaxonomyLevels(
  level = c("order", "suborder", "greatgroup", "subgroup"),
  as.is = FALSE,
  ordered = TRUE
)

SoilMoistureRegimeLevels(as.is = FALSE, ordered = TRUE)

SoilTemperatureRegimeLevels(as.is = FALSE, ordered = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SoilTaxonomyLevels_+3A_level">level</code></td>
<td>
<p>One of: <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code>, <code>"subgroup"</code></p>
</td></tr>
<tr><td><code id="SoilTaxonomyLevels_+3A_as.is">as.is</code></td>
<td>
<p>Return character labels rather than an (ordered) factor? Default: <code>FALSE</code></p>
</td></tr>
<tr><td><code id="SoilTaxonomyLevels_+3A_ordered">ordered</code></td>
<td>
<p>Create an ordinal factor? Default: <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an (ordered) factor or character vector (when <code>as.is=TRUE</code>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
SoilTaxonomyLevels("order")

SoilTaxonomyLevels("order", ordered = FALSE)

SoilTaxonomyLevels("order", as.is = TRUE)

SoilTaxonomyLevels("suborder")

</code></pre>

<hr>
<h2 id='ST'>Soil Taxonomy Hierarchy</h2><span id='topic+ST'></span><span id='topic+ST_unique_list'></span>

<h3>Description</h3>

<p>The first 4 levels of the US Soil Taxonomy hierarchy (soil order, suborder, greatgroup, subgroup), presented as a <code>data.frame</code> (denormalized) and a <code>list</code> of unique taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 2665 rows and 9 columns.
</p>


<h3>Details</h3>

<p>Ordered based on the unique letter codes denoting taxa from the 13th edition of the Keys to Soil Taxonomy.
</p>


<h3>References</h3>

<p>Soil Survey Staff. 1999. Soil taxonomy: A basic system of soil classification for making and interpreting soil surveys. 2nd edition. Natural Resources Conservation Service. U.S. Department of Agriculture Handbook 436.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/soil-taxonomy</a>
</p>
<p>Soil Survey Staff. 2014. Keys to Soil Taxonomy, 12th ed. USDA-Natural Resources Conservation Service, Washington, DC.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>

<hr>
<h2 id='ST_family_classes'>Family-level Classes for Soil Taxonomy</h2><span id='topic+ST_family_classes'></span>

<h3>Description</h3>

<p>A database of family-level class names for Soil Taxonomy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST_family_classes)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 193 rows and 8 columns.
</p>


<h3>References</h3>

<p>Soil Survey Staff. 2014. Keys to Soil Taxonomy, 12th ed. USDA-Natural Resources Conservation Service, Washington, DC.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>

<hr>
<h2 id='ST_features'>Epipedons, Diagnostic Horizons, Characteristics and Features in Soil Taxonomy</h2><span id='topic+ST_features'></span>

<h3>Description</h3>

<p>A <code>data.frame</code> with columns &quot;group&quot;, &quot;name&quot;, &quot;chapter&quot;, &quot;page&quot;, &quot;description&quot;, &quot;criteria&quot;. Currently page numbers and contents are referenced to 12th Edition Keys to Soil Taxonomy and derived from products in the ncss-tech SoilKnowledgeBase repository (https://github.com/ncss-tech/SoilKnowledgeBase).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST_features)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 84 rows and 6 columns.
</p>


<h3>References</h3>

<p>Soil Survey Staff. 2014. Keys to Soil Taxonomy, 12th ed. USDA-Natural Resources Conservation Service, Washington, DC.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>

<hr>
<h2 id='ST_formative_elements'>Formative Elements used by Soil Taxonomy</h2><span id='topic+ST_formative_elements'></span>

<h3>Description</h3>

<p>A database of formative elements used by the first 4 levels of US Soil Taxonomy hierarchy (soil order, suborder, greatgroup, subgroup).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST_formative_elements)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 4.
</p>


<h3>References</h3>

<p>S. W. Buol and R. C. Graham and P. A. McDaniel and R. J. Southard. Soil Genesis and Classification, 5th edition. Iowa State Press, 2003.
</p>

<hr>
<h2 id='ST_higher_taxa_codes_12th'>Letter Code Lookup Table for Position of Taxa within the Keys to Soil Taxonomy (12th Edition)</h2><span id='topic+ST_higher_taxa_codes_12th'></span>

<h3>Description</h3>

<p>A lookup table mapping unique taxonomic Order, Suborder, Great Group and Subgroups to letter codes that denote their logical position within the Keys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST_higher_taxa_codes_12th)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 3082 rows and 2 columns.
</p>


<h3>Details</h3>

<p>The lookup table has been corrected to reflect errata that were posted after the print publication of the 12th Edition Keys, as well as typos in the Spanish language edition.
</p>


<h3>References</h3>

<p>Soil Survey Staff. 2014. Keys to Soil Taxonomy, 12th ed. USDA-Natural Resources Conservation Service, Washington, DC.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>
<p>Soil Survey Staff. 2014. Claves para la Taxonom√≠a de Suelos, 12th ed. USDA-Natural Resources Conservation Service, Washington, DC.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>

<hr>
<h2 id='ST_higher_taxa_codes_13th'>Letter Code Lookup Table for Position of Taxa within the Keys to Soil Taxonomy (13th Edition)</h2><span id='topic+ST_higher_taxa_codes_13th'></span>

<h3>Description</h3>

<p>A lookup table mapping unique taxonomic Order, Suborder, Great Group and Subgroups to letter codes that denote their logical position within the Keys.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ST_higher_taxa_codes_13th)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 3153 rows and 2 columns.
</p>


<h3>References</h3>

<p>Soil Survey Staff. 2022. Keys to Soil Taxonomy, 13th ed. USDA-Natural Resources Conservation Service.
<a href="https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy">https://www.nrcs.usda.gov/resources/guides-and-instructions/keys-to-soil-taxonomy</a>
</p>

<hr>
<h2 id='taxon_code_to_taxon'>Convert taxon code to taxon name</h2><span id='topic+taxon_code_to_taxon'></span>

<h3>Description</h3>

<p>Convert taxon code to taxon name
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_code_to_taxon(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_code_to_taxon_+3A_code">code</code></td>
<td>
<p>A character vector of Taxon Codes</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of matching Taxon Names
</p>


<h3>See Also</h3>

<p><code><a href="#topic+decompose_taxon_code">decompose_taxon_code</a></code>, <code><a href="#topic+preceding_taxon_codes">preceding_taxon_codes</a></code>, <code><a href="#topic+taxon_to_taxon_code">taxon_to_taxon_code</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
taxon_code_to_taxon(c("ABC", "XYZ", "DAB", NA))

</code></pre>

<hr>
<h2 id='taxon_to_level'>Determine taxonomic level of specified taxa</h2><span id='topic+taxon_to_level'></span>

<h3>Description</h3>

<p>Taxa that resolve to a subgroup level taxon and contain a comma <code>","</code> are assumed to be <code>"family"</code>-level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_to_level(taxon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_to_level_+3A_taxon">taxon</code></td>
<td>
<p>character vector of taxon names at Order, Suborder, Great Group or Subgroup level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character of taxonomic hierarchy levels (such as &quot;order&quot;, &quot;suborder&quot;, &quot;greatgroup&quot;, &quot;subgroup&quot;, &quot;family&quot;) for each element of input vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# get the taxonomic levels for various taxa

taxon_to_level(c("gelisols", NA, "foo", "typic folistels", "folistels"))

</code></pre>

<hr>
<h2 id='taxon_to_taxon_code'>Convert taxon name to taxon code</h2><span id='topic+taxon_to_taxon_code'></span>

<h3>Description</h3>

<p>Convert taxon name to taxon code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxon_to_taxon_code(taxon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxon_to_taxon_code_+3A_taxon">taxon</code></td>
<td>
<p>A character vector of taxon names, case insensitive</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of matching taxon codes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+decompose_taxon_code">decompose_taxon_code</a></code>, <code><a href="#topic+preceding_taxon_codes">preceding_taxon_codes</a></code>, <code><a href="#topic+taxon_code_to_taxon">taxon_code_to_taxon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
taxon_to_taxon_code(c("Anhyturbels", "foo", "Cryaquands", NA))

</code></pre>

<hr>
<h2 id='taxonTree'>Create a <code>data.tree</code> Object from Taxon Names</h2><span id='topic+taxonTree'></span>

<h3>Description</h3>

<p>This function takes one or more taxon names and taxonomic levels as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taxonTree(
  taxon,
  level = c("order", "suborder", "greatgroup", "subgroup"),
  root = "Soil Taxonomy",
  verbose = TRUE,
  special.chars = c("|--", "|", "|", "-"),
  file = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taxonTree_+3A_taxon">taxon</code></td>
<td>
<p>A vector of taxon names</p>
</td></tr>
<tr><td><code id="taxonTree_+3A_level">level</code></td>
<td>
<p>One or more of: <code>"order"</code>, <code>"suborder"</code>, <code>"greatgroup"</code>, <code>"subgroup"</code>. The lowest level is passed to <code>getChildLevel()</code> to generate the leaf nodes.</p>
</td></tr>
<tr><td><code id="taxonTree_+3A_root">root</code></td>
<td>
<p>Label for root node. Default: <code>"Soil Taxonomy"</code>; <code>NULL</code> for &quot;unrooted&quot; tree.</p>
</td></tr>
<tr><td><code id="taxonTree_+3A_verbose">verbose</code></td>
<td>
<p>Print tree output? Default: <code>TRUE</code></p>
</td></tr>
<tr><td><code id="taxonTree_+3A_special.chars">special.chars</code></td>
<td>
<p>Characters used to print the tree to console. Default: <code>c("|--", "|", "|", "-")</code>. For fancy markup try: <code>c("\u251c","\u2502", "\u2514", "\u2500 ")</code></p>
</td></tr>
<tr><td><code id="taxonTree_+3A_file">file</code></td>
<td>
<p>Optional: path to output file. Default: <code>""</code> prints to standard output connection (unless redirected by <code>sink()</code>)</p>
</td></tr>
<tr><td><code id="taxonTree_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code>data.tree::as.Node.data.frame()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A subclass of data.tree <code>Node</code> object is returned. This object has a custom <code>print()</code> method
</p>


<h3>Value</h3>

<p>A <code>SoilTaxonNode</code> (subclass of <code>data.tree</code> <code>Node</code>) object (invisibly). A text representation of the tree is printed to stdout when <code>verbose=TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>


# hapludults and hapludalfs (to subgroup level)
taxonTree(c("hapludults", "hapludalfs"))

# alfisols suborders and great groups
taxonTree("alfisols", root = "Alfisols", level = c("suborder", "greatgroup"))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
