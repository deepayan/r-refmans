<!DOCTYPE html><html><head><title>Help for package regrap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {regrap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#checkConditionW'><p>Condition check for weak FWER control in RGA</p></a></li>
<li><a href='#conditionCheck'><p>Condition check for strong FWER control in RGA</p></a></li>
<li><a href='#ga2h'><p>Graphical approach for two hypotheses</p></a></li>
<li><a href='#ga3h'><p>Graphical approach for three hypotheses</p></a></li>
<li><a href='#graphUpdate'><p>Graph Update</p></a></li>
<li><a href='#graphUpdateOne'><p>Single Step Graph Update</p></a></li>
<li><a href='#randomGraph'><p>Generate a Random Graph</p></a></li>
<li><a href='#rga2h'><p>reverse graphical approach for two hypotheses</p></a></li>
<li><a href='#rga2pwr'><p>Power Analysis for Graphical Approaches and Reverse Graphical Approaches with Two Hypotheses</p></a></li>
<li><a href='#rga3h'><p>reverse graphical approach for three hypotheses</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Reverse Graphical Approaches</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-22</td>
</tr>
<tr>
<td>Description:</td>
<td>The graphical approach is proposed as a general framework for clinical trial designs involving multiple hypotheses, where decisions are made only based on the observed marginal p-values. A reverse graphical approach starts from a set of singleton graphs, and gradually add vertices into graphs until rejection of a set of hypotheses is made. See Gou, J. (2020). Reverse graphical approaches for multiple test procedures. Technical Report. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, stats</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0.9000</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-02 00:43:23 UTC; jgou</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiangtao Gou [aut, cre],
  Fengqing Zhang [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jiangtao Gou &lt;gouRpackage@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-03 11:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='checkConditionW'>Condition check for weak FWER control in RGA</h2><span id='topic+checkConditionW'></span>

<h3>Description</h3>

<p>Check the sufficient condition in RGA for the weak FWER control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkConditionW(w, G)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkConditionW_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="checkConditionW_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conditions verified here are sufficient conditions. If a logical value <code>TRUE</code> is returned, then the weak control of the FWER is guaranteed. The weak control of the FWER may still hold even if the output is <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>a logical value indicating whether the RGA's conditions are satisfied or not for the weak FWER control
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>
<p>Fengqing Zhang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.31, 0.33, 0.36)
G &lt;- matrix(c(0,0.4,0.6, 0.7,0,0.3, 0.5,0.5,0),nrow=3,byrow=TRUE)
checkConditionW(w=w,G=G)
w &lt;- c(0.5,0.5,0)
G &lt;- matrix(c(0,1,0, 0.25,0,0.75, 1,0,0), nrow=3, byrow=TRUE)
checkConditionW(w=w,G=G)
</code></pre>

<hr>
<h2 id='conditionCheck'>Condition check for strong FWER control in RGA</h2><span id='topic+conditionCheck'></span>

<h3>Description</h3>

<p>Check the sufficient condition in RGA for the strong FWER control.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditionCheck(w, G)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conditionCheck_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="conditionCheck_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conditions verified here are sufficient conditions. If a logical value <code>TRUE</code> is returned, then the strong control of the FWER is guaranteed. The strong control of the FWER may still hold even if the output is <code>FALSE</code>.
</p>


<h3>Value</h3>

<p>a logical value indicating whether the RGA's conditions are satisfied or not for the strong FWER control
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.1,0.2,0.3,0.4)
G &lt;- matrix(c(0,0.3,0.3,0.4, 0.6,0,0.2,0.2, 0.5,0.2,0,0.3, 0.3,0.4,0.3,0),nrow=4,byrow=TRUE)
conditionCheck(w=w,G=G)
</code></pre>

<hr>
<h2 id='ga2h'>Graphical approach for two hypotheses</h2><span id='topic+ga2h'></span>

<h3>Description</h3>

<p>Graphical approach for two hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ga2h(w, G, p, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ga2h_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="ga2h_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
<tr><td><code id="ga2h_+3A_p">p</code></td>
<td>
<p>a vector of p-values</p>
</td></tr>
<tr><td><code id="ga2h_+3A_alpha">alpha</code></td>
<td>
<p>a number of significance level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector indicating whether the hypothesis is rejected: TRUE = rejected, FALSE = accepted
</p>


<h3>References</h3>

<p>Bretz, F., Maurer, W., Brannath, W., and Posch, M. (2009). A graphical approach to sequentially rejective multiple test procedures. Statistics in Medicine 28, 586–-604. &lt;doi:10.1002/sim.3495&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.3,0.7)
G &lt;- matrix(c(0,1,1,0),nrow=2,byrow=TRUE)
p &lt;- c(0.032, 0.038)
alpha &lt;- 0.05
ga2h(w=w,G=G,p=p, alpha=alpha)

</code></pre>

<hr>
<h2 id='ga3h'>Graphical approach for three hypotheses</h2><span id='topic+ga3h'></span>

<h3>Description</h3>

<p>Graphical approach for three hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ga3h(w, G, p, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ga3h_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="ga3h_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
<tr><td><code id="ga3h_+3A_p">p</code></td>
<td>
<p>a vector of p-values</p>
</td></tr>
<tr><td><code id="ga3h_+3A_alpha">alpha</code></td>
<td>
<p>a number of significance level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector indicating whether the hypothesis is rejected: TRUE = rejected, FALSE = accepted
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>References</h3>

<p>Bretz, F., Maurer, W., Brannath, W., and Posch, M. (2009). A graphical approach to sequentially rejective multiple test procedures. Statistics in Medicine 28, 586–-604. &lt;doi:10.1002/sim.3495&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.3,0.5,0.2)
G &lt;- matrix(c(0,1/3,2/3, 1/2,0,1/2, 1/5,4/5,0),nrow=3,byrow=TRUE)
p &lt;- c(0.012, 0.051, 0.021)
p &lt;- c(0.012, 0.051, 0.019)
alpha &lt;- 0.05
ga3h(w=w,G=G,p=p, alpha=alpha)

</code></pre>

<hr>
<h2 id='graphUpdate'>Graph Update</h2><span id='topic+graphUpdate'></span>

<h3>Description</h3>

<p>Update the graph by removing a set of vertices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphUpdate(w, G, vec01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphUpdate_+3A_w">w</code></td>
<td>
<p>a numeric vector of vertex weights</p>
</td></tr>
<tr><td><code id="graphUpdate_+3A_g">G</code></td>
<td>
<p>a matrix of transition weights</p>
</td></tr>
<tr><td><code id="graphUpdate_+3A_vec01">vec01</code></td>
<td>
<p>a binary vector indicating the set of vertices planned to be removed: the vertex corresponding to the zeros in this vector will be removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of one updated vertex weight vector, one updated transition weight matrix, and a binory TRUE/FALSE indicater to show whether a node has been removed
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.1,0.2,0.3,0.4)
G &lt;- matrix(c(0,0.3,0.3,0.4, 0.6,0,0.2,0.2, 0.5,0.2,0,0.3, 0.3,0.4,0.3,0),nrow=4,byrow=TRUE)
vec01 &lt;- c(1,0,0,1)
graphUpdate(w=w,G=G,vec01=vec01)

</code></pre>

<hr>
<h2 id='graphUpdateOne'>Single Step Graph Update</h2><span id='topic+graphUpdateOne'></span>

<h3>Description</h3>

<p>Update the graph by removing one vertex
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphUpdateOne(w, G, vec01)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphUpdateOne_+3A_w">w</code></td>
<td>
<p>a numeric vector of vertex weights</p>
</td></tr>
<tr><td><code id="graphUpdateOne_+3A_g">G</code></td>
<td>
<p>a matrix of transition weights</p>
</td></tr>
<tr><td><code id="graphUpdateOne_+3A_vec01">vec01</code></td>
<td>
<p>a binary vector indicating the set of vertices planned to be removed: the vertex corresponding to the first zero in this vector will be removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of one updated vertex weight vector, one updated transition weight matrix, one updated indicator vector, and a binory TRUE/FALSE indicater to show whether a node has been removed
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.1,0.2,0.3,0.4)
G &lt;- matrix(c(0,0.3,0.3,0.4, 0.6,0,0.2,0.2, 0.5,0.2,0,0.3, 0.3,0.4,0.3,0),nrow=4,byrow=TRUE)
vec01 &lt;- c(1,0,0,1)
graphUpdateOne(w=w,G=G,vec01=vec01)

</code></pre>

<hr>
<h2 id='randomGraph'>Generate a Random Graph</h2><span id='topic+randomGraph'></span>

<h3>Description</h3>

<p>Generate a random graph from uniform distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>randomGraph(n, seed = as.numeric(Sys.time()), wlim = c(0, 1), Glim = c(0, 1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="randomGraph_+3A_n">n</code></td>
<td>
<p>an integer: number of vertices</p>
</td></tr>
<tr><td><code id="randomGraph_+3A_seed">seed</code></td>
<td>
<p>an integer: a seed for random number generator</p>
</td></tr>
<tr><td><code id="randomGraph_+3A_wlim">wlim</code></td>
<td>
<p>a vector of two numbers: range of vertex weights</p>
</td></tr>
<tr><td><code id="randomGraph_+3A_glim">Glim</code></td>
<td>
<p>a vector of two numbers: range of transition weights</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of one vector for vertex weights and one matrix for transition weights
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>
<p>Fengqing Zhang
</p>


<h3>Examples</h3>

<pre><code class='language-R'>wG &lt;- randomGraph(n=5)
</code></pre>

<hr>
<h2 id='rga2h'>reverse graphical approach for two hypotheses</h2><span id='topic+rga2h'></span>

<h3>Description</h3>

<p>reverse graphical approach for two hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rga2h(w, G, p, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rga2h_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="rga2h_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
<tr><td><code id="rga2h_+3A_p">p</code></td>
<td>
<p>a vector of p-values</p>
</td></tr>
<tr><td><code id="rga2h_+3A_alpha">alpha</code></td>
<td>
<p>a number of significance level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector indicating whether the hypothesis is rejected: TRUE = rejected, FALSE = accepted
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>References</h3>

<p>Gou, J. (2020). Reverse graphical approaches for multiple test procedures. Technical Report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.3,0.7)
G &lt;- matrix(c(0,1,1,0),nrow=2,byrow=TRUE)
p &lt;- c(0.032, 0.038)
alpha &lt;- 0.05
rga2h(w=w,G=G,p=p, alpha=alpha)

</code></pre>

<hr>
<h2 id='rga2pwr'>Power Analysis for Graphical Approaches and Reverse Graphical Approaches with Two Hypotheses</h2><span id='topic+rga2pwr'></span>

<h3>Description</h3>

<p>Power Analysis for Graphical Approaches and Reverse Graphical Approaches with Two Hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rga2pwr(w, G, alpha, delta, corr, method = "rga")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rga2pwr_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="rga2pwr_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
<tr><td><code id="rga2pwr_+3A_alpha">alpha</code></td>
<td>
<p>a number of significance level</p>
</td></tr>
<tr><td><code id="rga2pwr_+3A_delta">delta</code></td>
<td>
<p>a vector of effect sizes</p>
</td></tr>
<tr><td><code id="rga2pwr_+3A_corr">corr</code></td>
<td>
<p>a correlation matrix</p>
</td></tr>
<tr><td><code id="rga2pwr_+3A_method">method</code></td>
<td>
<p>a string specified the method: &quot;rga&quot; for Reverse Graphical Approaches and &quot;ga&quot; for Graphical Approaches</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numerical matrix including the probabilities of four combinations of being rejected and being accepted for two hypotheses. Row indices stand for the first hypothesis, and column indices stand for the second hypothesis. The first index stands for the probability of acceptance, and the second index stands for the probability of rejection.
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>References</h3>

<p>Bretz, F., Maurer, W., Brannath, W., and Posch, M. (2009). A graphical approach to sequentially rejective multiple test procedures. Statistics in Medicine 28, 586–-604. &lt;doi:10.1002/sim.3495&gt;
</p>
<p>Gou, J. (2020). Reverse graphical approaches for multiple test procedures. Technical Report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.3,0.7)
G &lt;- matrix(c(0,1,1,0),nrow=2,byrow=TRUE)
alpha &lt;- 0.05
delta &lt;- c(0,2)
rho &lt;- 0.0
corr &lt;- matrix(c(1,rho,rho,1), nrow=2)
method="rga"
rga2pwr(w=w, G=G, alpha=alpha, delta=delta, corr=corr, method=method)



</code></pre>

<hr>
<h2 id='rga3h'>reverse graphical approach for three hypotheses</h2><span id='topic+rga3h'></span>

<h3>Description</h3>

<p>reverse graphical approach for three hypotheses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rga3h(w, G, p, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rga3h_+3A_w">w</code></td>
<td>
<p>a vector of initial weights</p>
</td></tr>
<tr><td><code id="rga3h_+3A_g">G</code></td>
<td>
<p>a matrix of initial transaction weights</p>
</td></tr>
<tr><td><code id="rga3h_+3A_p">p</code></td>
<td>
<p>a vector of p-values</p>
</td></tr>
<tr><td><code id="rga3h_+3A_alpha">alpha</code></td>
<td>
<p>a number of significance level</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical vector indicating whether the hypothesis is rejected: TRUE = rejected, FALSE = accepted
</p>


<h3>Author(s)</h3>

<p>Jiangtao Gou
</p>


<h3>References</h3>

<p>Gou, J. (2020). Reverse graphical approaches for multiple test procedures. Technical Report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>w &lt;- c(0.3,0.5,0.2)
G &lt;- matrix(c(0,1/3,2/3, 1/2,0,1/2, 1/5,4/5,0),nrow=3,byrow=TRUE)
p &lt;- c(0.012, 0.051, 0.021)
p &lt;- c(0.012, 0.051, 0.019)
alpha &lt;- 0.05
rga3h(w=w,G=G,p=p, alpha=alpha)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
