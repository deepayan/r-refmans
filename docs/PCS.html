<!DOCTYPE html><html lang="en"><head><title>Help for package PCS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {PCS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#PCS-package'><p> Probability of Correct Selection (PCS)</p></a></li>
<li><a href='#G.H.Quad'><p>Gauss-Hermite Quadrature function</p></a></li>
<li><a href='#PCS.boot.par'><p> Probability of Correct Selection (PCS) Calculator</p></a></li>
<li><a href='#PdCSGt.bootstrap.NP2'><p> Non-Parametric Bootstrap for Computing G-best and d-best PCS</p></a></li>
<li><a href='#PdofCSGt.bootstrap5'><p> Parametric Bootstrap for Computing G-best and d-best PCS</p></a></li>
<li><a href='#PdofCSt.T1or2'><p> Exact PCS, When Selecting t=1 or t=2 or More Populations</p></a></li>
<li><a href='#PofCSLt.bootstrap5'><p> Parametric Bootstrap for Computing L-best PCS</p></a></li>
<li><a href='#PofCSt'><p> Probability of Correct Selection (PCS) for Selecting t out of k Populations</p></a></li>
<li><a href='#tindep'><p> Standardized Scores for Two Independent Samples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate the Probability of Correct Selection (PCS)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-09</td>
</tr>
<tr>
<td>Depends:</td>
<td>statmod, multtest</td>
</tr>
<tr>
<td>Author:</td>
<td>Jason Wilson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jason Wilson &lt;jason.wilson@biola.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Given k populations (can be in thousands), what is the probability that a given subset of size t contains the true top t populations?  This package finds this probability and offers three tuning parameters (G, d, L) to relax the definition.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-16 22:04:02 UTC; jasonw</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-20 17:10:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='PCS-package'> Probability of Correct Selection (PCS) </h2><span id='topic+PCS-package'></span><span id='topic+PCS'></span>

<h3>Description</h3>

<p> These functions calculate the probability of correct selection (PCS) with G-best, 
d-best, and L-best selection as described in Cui &amp; Wilson (2008) and Cui, Zhao, &amp; Wilson (2008).  
The specific parameters (G,d,L), distributional assumptions (normal, Student's t, non-parametric),
and calculation method (exact, bootstrap) are user-settable.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> PCS</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2009-04-15</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> What license is it under?</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Probability of Correct Selection (PCS) is the probability of selecting the best t of k populations.
This package allows the user to calculate the PCS for a given dataset.  When k is large, even if the best 
t populations are significantly different from the rest, the PCS may be small due to sample variance.  To
address this issue, Cui &amp; Wilson (2008, 2009) developed three tuning parameters whereby the definition of 
correct selection is modified (d-best, G-best, L-best) to more realistic and acceptable standards for 
large k problems.  This package is the implementation of these three definitions, using different 
calculation methods. 
</p>
<p>The PCS package consists of three primary functions for users: PCS.boot.par, PCS.boot.np, and PCS.exact.
PCS.boot.par and PCS.boot.np use parametric and non-parametric bootstraps, respectively, to calculate 
d-best, G-best, and L-best PCS.  PCS.boot.par is the fastest function for large k problems.  
It is expected to be the most commonly used, as the parametric distributional (normal &amp; Student's t) 
assumptions are reasonable and moderately robust (Cui &amp; Wilson 2009).  When k is large and the 
distributional assumptions are not met, then PCS.boot.np may be used.  For information regarding the 
necessary sample size, see (Cui &amp; Wilson 2009).  When k is small to moderate, PCS.exact may be used to 
obtain PCS using the analytic formula. 
</p>


<h3>Note</h3>

<p> I would like to thank Xinping Cui for her support while creating this package, Thomas Girke
for use of the UCR Bioinformatics Cluster, Bushi Wang for stress testing the code, and God for all
the help on the way.
</p>


<h3>Author(s)</h3>

<p>Jason Wilson,
Maintainer: Jason Wilson &lt;jason.wilson@biola.edu&gt;
</p>


<h3>References</h3>

<p>Cui, X. and Wilson, J.  2007.  On How to Calculate the Probability of Correct Selection for Large k 
Populations.  University of California, Riverside Statistics Department Technical Report 297.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY</a>
<br />
Cui, X. and Wilson, J.  2008.  On the Probability of Correct Selection for Large k Populations, 
with Application to Microarray Data.  Biometrical Journal, 50:5, 870-883.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjE2YjI4MGRkNzA0ZTRjMDc">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjE2YjI4MGRkNzA0ZTRjMDc</a>
<br />
Cui, X. and Wilson, J.  2009.  A Simulation Study on the Probability of Correct Selection for Large k Populations.  
Communications in Statistics - Simulation and Computation, 38:6.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA</a>
<br />
Cui, X.; Zhao, H. and Wilson, J.  2010.  Optimized Ranking and Selection Methods for Feature Selection with Application in Microarray Experiments.  Journal of Biopharmaceutical Statistics.  Volume 20, No. 2, pp. 223-239.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Small example for PCS.boot.par &amp; PCS.exact
theta = c(4.2, 2.5, 2.3, 1.7, 1.5, 1.0)
theta = sort(theta)
T = c(1,2,3,5); G = 1:3; D = c(0.5,1,1.5); L = 1:2
PCS.boot.par(theta, T, G, D, L, B=100, SDE=1, dist="normal", df=14, trunc=6)
PCS.exact(theta, t=2, g=1, d=NULL, m=20, tol=1e-8)

##### Small example for PCS.boot.np
k=20 #number of populations
n=10 #sample size
SD=.1 #standard deviation
theta = seq(0,6,length.out=k)
X1 = rnorm(k*n,0,SD)   #Sample 1
X1 = matrix(X1,nrow=k,ncol=n,byrow=FALSE)
X2 = rnorm(k*n,theta,SD) #Sample 2, shifted
X2 = matrix(X2,nrow=k,ncol=n,byrow=FALSE)
T = c(1,2,3,5); G = 1:3; D = c(0.5,1,1.5)
PCS.boot.np(X1, X2, T, G, D, B=100, trunc=6)

##### Microarray example of t-statistics with PCS.boot.par
require(multtest)
data(golub)  	#Load microarray data
sub = 500	#Subset index for speed
ans = tindep(golub[1:sub,1:27], golub[1:sub,28:38], flag=1) #Obtain t-statistics
golub.T = sort(abs(ans[,1]))  	#Massage t-statistics
T=c(1,5,10,25,50,92); G=c(1,10,25,50,150); D=c(0,1,2) #Set PCS parameters
df=18 			  #Degrees of freedom from Satterthwaite approximation
sde=sqrt((18/(18-2))/19)  #Estimate SDE by MOM SD, divided by mean sample size
PCS.boot.par(golub.T, T, G, D, L=NULL, B=100, SDE=sde, dist="t", df=18) #Small B for speed

##### Microarray example of Golub's correlation statistics
##### (see reference) with PCS.boot.par
require(multtest)
data(golub)  					#Load microarray data
Pgc &lt;- function(x,y) {  		#Function to calculate Golub's correlation statistics
  xbar1 = apply(x,1,mean)
  xbar2 = apply(y,1,mean)
  sd1   = apply(x,1,sd)
  sd2   = apply(y,1,sd)
  Pgc = abs((xbar1-xbar2))/(sd1+sd2)
  return(Pgc)
} #end function
sub = 500	#Subset index for speed
Pgc.gol = Pgc(golub[1:sub,1:27],golub[1:sub,28:38]) #Calculate correlation statistics
T=c(1,5,10,25,50,92); G=c(1,10,25,50,150); D=c(0,1,2) #Set PCS parameters
sde=0.20 		#Obtained by simulation on Golub data
PCS.boot.par(Pgc.gol, T, G, D, L=NULL, B=100, SDE=0.2, dist="t", df=18) #Small B for speed

##### Microarray example using non-parametric bootstrap
require(multtest)
data(golub)  							#Load microarray data
T=c(1,5,10); G=c(1,3,5); D=c(0,1,2) 	#Set PCS parameters
sub = 100	#Subset index for speed
PCS.boot.np(golub[1:sub,1:27], golub[1:sub,28:38], T, G, D, B=10, trunc=6) #Small B for speed
</code></pre>

<hr>
<h2 id='G.H.Quad'>Gauss-Hermite Quadrature function</h2><span id='topic+G.H.Quad'></span>

<h3>Description</h3>

<p>Performs Gauss-Hermite Quadrature for an arbitrary number of nodes.  Function for use in PofCSt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>G.H.Quad(x, m)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="G.H.Quad_+3A_x">x</code></td>
<td>
<p>  is an m-vector upon which Gauss-Hermite Quadrature is to be applied </p>
</td></tr>
<tr><td><code id="G.H.Quad_+3A_m">m</code></td>
<td>
<p>  is the number of nodes desired for the Gauss-Hermite Quadrature </p>
</td></tr>
</table>


<h3>Details</h3>

<p> This function uses gauss.quad.prob in the statmod package to perform Gauss-Hermite 
Quadrature inside of the PofCSt function. </p>


<h3>Value</h3>

<p> The result of the Gauss-Hermite Quadrature. </p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

<p> Hildebrand, F.B.  1956.  Introduction to Numerical Analysis.  McGraw-Hill. </p>


<h3>See Also</h3>

 <p><code><a href="#topic+PofCSt">PofCSt</a></code> </p>

<hr>
<h2 id='PCS.boot.par'> Probability of Correct Selection (PCS) Calculator </h2><span id='topic+PCS.boot.par'></span><span id='topic+PCS.exact'></span><span id='topic+PCS.boot.np'></span>

<h3>Description</h3>

<p>These functions calculate the probability of correct selection (PCS) with G-best, 
d-best, and L-best selection as described in Cui &amp; Wilson (2008) and Cui, Zhao, &amp; Wilson (2008).  
The specific parameters (G,d,L), distributional assumptions (normal, Student's t, non-parametric),
and calculation method (exact, bootstrap) are user-settable. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PCS.boot.par(theta, T = 1:1, G = NULL, D = NULL, L = NULL, B = 100, SDE = 1, 
	dist = c("normal", "t"), df = 14, trunc = 6)
PCS.boot.np(X1, X2, T = 1, G = 1, D = NULL, B, trunc = 6)
PCS.exact(theta, t = 1, g = NULL, d = NULL, m = 20, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PCS.boot.par_+3A_theta">theta</code></td>
<td>
<p>  Vector of statistics (or parameters) from which it is desired to select 
the top t of them </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_t">T</code></td>
<td>
<p>  Vector of the number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_t">t</code></td>
<td>
<p>  The number of statistics (or parameters) desired to be selected (scalar) </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_g">G</code></td>
<td>
<p>  Vector of G-best selection parameters </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_g">g</code></td>
<td>
<p>  The G-best selection parameter (scalar) </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_d">D</code></td>
<td>
<p>  Vector of d-best selection parameters </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_d">d</code></td>
<td>
<p>  The d-best selection parameter (scalar) </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_l">L</code></td>
<td>
<p>  Vector of L-best selection parameters </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_x1">X1</code></td>
<td>
<p> k by n1 matrix of data.  k is the number of populations and n1 the sample size 
of the first treatment. </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_x2">X2</code></td>
<td>
<p> k by n2 matrix of data.  k is the number of populations and n2 the sample size 
of the second treatment. </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_b">B</code></td>
<td>
<p>  Bootstrap sample size </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_sde">SDE</code></td>
<td>
<p>  Standard error of the statistics theta (row-wise) </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_dist">dist</code></td>
<td>
<p>  Distributional assumption used for estimating PCS </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_df">df</code></td>
<td>
<p>  Common degrees of freedom for one of the t-statistics in theta;
the parameter is only used if dist=&quot;t&quot; </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_trunc">trunc</code></td>
<td>
<p>  Number of standard errors below the minimum selected
population to disregard in the estimation of PCS; it is a truncation parameter
to decrease run time </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_m">m</code></td>
<td>
<p>  Number of nodes employed in the Gauss-Hermite quadrature </p>
</td></tr>
<tr><td><code id="PCS.boot.par_+3A_tol">tol</code></td>
<td>
<p>  Tolerance parameter to set the cut-off level for the inclusion of additional 
probability components in PCS </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The probability of correct selection (PCS) is a single statistic calculated on a vector of sample 
statistics whose interpretation is the probability that the top t populations selected according to
the sample rank would be the true top t populations.  PCS may be used in addition to, or
instead of, multiple comparison procedures.  The PCS package is an implementation of the formulas
and ideas in Cui &amp; Wilson (2008) and Cui, Zhao, &amp; Wilson (2008).
<br />
After a multi-population experiment is conducted, whether with one, two, or more treatments, a vector of 
one sample statistic for each population is obtained.  This vector is theta.  Suppose theta has length k.  
The user will want to know the probability of correctly selecting some number t of the k populations.
T is a vector of all such t desired to be checked.  When k is large, the resulting probabilities can be 
uncomfortably small, even if the corresponding multiple-testing p-values are significant.
In order to increase the resulting probabilities (PCS), three tuning parameters have been devised.
<br />
g is the number of populations which will be selected in addition to t.  Thus, g+t populations are selected, 
only t of which must be the true top t populations in order to be considered correct.  (Cui &amp; Wilson 2007).
G is a vector of such g's.  Scalar g is used in the exact function (PCS.exact) and vector G is used in the bootstraps 
(PCS.boot.par &amp; PCS.boot.np).
<br />
d does not directly specify a number of additional populations.  Rather, d is the number of standard errors 
above and below the statistic whose rank is t (hereafter the &quot;tth&quot; statistic).  The other statistics 
which fall in this range are considered close enough to the top t statistics which will be considered 
comparable to the tth population and therefore considered correct (since the tth statistic is an estimate
of the tth population parameter).  Thus, t populations are selected, 
but a random subset of the populations determined by d are considered &quot;close enough&quot; to the top t and are 
also considered correct (Cui &amp; Wilson 2007).  D is a vector of such d's.  Scalar d is used in the exact function 
(PCS.exact) and vector D is used in the bootstraps (PCS.boot.par &amp; PCS.boot.np).  The above interpretation holds when 
the statistics of theta are standardized (SDE=1); when they are not, then d represents the number of units 
from the tth statistic, where the units are given by the data.  Simulation studies suggest d&gt;2 often produces 
significantly biased PCS when standardized statistics are used.  Therefore, it is recommended that d&lt;=2 be used when
theta is standardized and d not greater than two standard errors when theta is not standardized.
<br />
l is the number of populations, out of the top t, which need to be included in the selected t to be considered 
a correct selection.  Thus, t populations are selected, only l of which must be in the true top t, in order to 
be considered correct.  (Cui &amp; Wilson &amp; Zahn 2008).  L is a vector of such l.  The parameter has not been 
implemented in the exact function (PCS.exact) or the non-parametric bootstrap (PCS.boot.np), only the 
parametric bootstrap (PCS.boot.par).
<br />
The run time of the function is directly proportional to the bootstrap sample size, B, (as well as the number
of elements of T, D, G, and L).  In practice, it is recommended that preliminary runs us a small B (e.g. B=100),
in order to obtain estimates of PCS (off by several percent).  Then, when the desired parameters for final 
calculations are known, B should be run at B=10000, or more, depending on the application.
<br />
The SDE needs to be supplied by the user (this potential inconvenience 
is balanced by serving to make the code more general).  
If the statistics in theta are already standardized, as they often will be, then SDE=1.  If the statistics in 
theta are not standardized, then a form of pooled standard error could be used for SDE.  As for distributional 
assumptions, PCS.exact assumes a normal distribution on the elements of theta.  PCS.boot.par allows for a 
&quot;normal&quot; or a &quot;t&quot; (Student's t, with degrees of freedom = df) distribution.  PCS.boot.np is non-parametric, 
and requires significantly larger sample sizes in order to accurately estimate PCS (see Cui &amp; Wilson 2009). 
In order to reduce run time, PCS.exact implements a tolerance parameter, tol, at four different levels of 
the calculations.  It is defaulted conservatively to 1e-8 in order to produce answers exact to at least five 
decimal places of accuracy.  PCS.boot.par and PCS.boot.np both implement a truncation parameter that reduces 
the size of the bootstrapped theta vector.  It works by cutting the vector 'trunc' standard errors below the 
maximum Tth element of theta.  trunc=6 produced no loss of accuracy on the runs attempted, while a loss of 
over 1
and m is the number of nodes employed.  It is defaulted to m=20, which produced the same accuracy, to four or 
more decimal places, as m=1000.
<br />
As is customary in the Ranking and Selection literature, the three functions PCS.exact, PCS.boot.par, and PCS.boot.np 
all assume that the best statistics in theta are the largest.  If the best statistics are the smallest, then a simple
conversion will allow the functions to work equally well on the data.  See the examples.
</p>


<h3>Value</h3>

<p>For PCS.exact, the value is a scalar of the PCS for the parameters entered.  For PCS.boot.par and 
PCS.boot.np, a matrix is returned whose rows are the entries of G, D, or L and 
whose columns are the entries of T.  If more than one of G, D, or L is entered, then a list is returned, 
where the G element of the list is the G-best matrix, the d element is the d-best matrix, and the 
L element is the L-best matrix.
</p>


<h3>Author(s)</h3>

<p>Jason Wilson,
Maintainer: Jason Wilson &lt;jason.wilson@biola.edu&gt;
</p>


<h3>References</h3>

 
<p>Cui, X. and Wilson, J.  2007.  On How to Calculate the Probability of Correct Selection for Large k 
Populations.  University of California, Riverside Statistics Department Technical Report 297.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY</a>
<br />
Cui, X. and Wilson, J.  2008.  On the Probability of Correct Selection for Large k Populations, 
with Application to Microarray Data.  Biometrical Journal, 50:5, 870-883.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjE2YjI4MGRkNzA0ZTRjMDc">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjE2YjI4MGRkNzA0ZTRjMDc</a>
<br />
Cui, X. and Wilson, J.  2009.  A Simulation Study on the Probability of Correct Selection for Large k Populations.  
Communications in Statistics: Simulation and Computation.  38:6.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA</a>
<br />
Cui, X.; Zhao, H. and Wilson, J.  2010.  Optimized Ranking and Selection Methods for Feature Selection with Application in Microarray Experiments.  Journal of Biopharmaceutical Statistics.  Volume 20, No. 2, pp. 223-239.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg</a>
<br />
Golub, T. et al.  1999.  Molecular Classification of Cancer Class Discovery and Class Prediction 
by Gene Expression Monitoring.  Science.  286:531-537.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##### Small example for PCS.boot.par &amp; PCS.exact
theta = c(1.0, 1.5, 1.7, 2.3, 2.5, 4.2)
T = c(1,2,3,5); G = 0:3; D = c(0.5,1,1.5); L = 1:2
PCS.boot.par(theta, T, G, D, L, B=100, SDE=1, dist="normal", trunc=6)
PCS.exact(theta, t=2, g=1, d=NULL, m=20, tol=1e-8)

#The above assumes the largest thetas are best.
#To select the smallest thetas, reverse the order of the indices, e.g.
theta.new = max(theta) - theta + min(theta)
T = c(1,2,3,5); G = 0:3; D = c(0.5,1,1.5); L = 1:2
PCS.boot.par(theta.new, T, G, D, L, B=100, SDE=1, dist="normal", trunc=6)
PCS.exact(theta.new, t=2, g=1, d=NULL, m=20, tol=1e-8)

##### Small example for PCS.boot.np
k=20 #number of populations
n=10 #sample size
SD=.1 #standard deviation
theta = seq(0,6,length.out=k)
X1 = rnorm(k*n,0,SD)   #Sample 1
X1 = matrix(X1,nrow=k,ncol=n,byrow=FALSE)
X2 = rnorm(k*n,theta,SD) #Sample 2, shifted
X2 = matrix(X2,nrow=k,ncol=n,byrow=FALSE)
T = c(1,2,3,5); G = 0:3; D = c(0.5,1,1.5); L = 1:2
PCS.boot.np(X1, X2, T, G, D, B=10, trunc=6)

##### Microarray example of t-statistics with PCS.boot.par
require(multtest)
data(golub)  	#Load microarray data
sub = 500	#Subset index for speed
ans = tindep(golub[1:sub,1:27], golub[1:sub,28:38], flag=1) #Obtain t-statistics
golub.T = sort(abs(ans[,1]))  	#Massage t-statistics
T=c(1,5,10,25,50,92); G=c(1,10,25,50,150); D=c(0,1,2) #Set PCS parameters
df=18 			  #Degrees of freedom from Satterthwaite approximation
sde=sqrt((18/(18-2))/19)  #Estimate SDE by MOM SD, divided by mean sample size
PCS.boot.par(golub.T, T, G, D, L=NULL, B=100, SDE=sde, dist="t", df=18) #Small B for speed

##### Microarray example of Golub's correlation statistics
##### (see reference) with PCS.boot.par
require(multtest)
data(golub)  					#Load microarray data
Pgc &lt;- function(x,y) {  		#Function to calculate Golub's correlation statistics
  xbar1 = apply(x,1,mean)
  xbar2 = apply(y,1,mean)
  sd1   = apply(x,1,sd)
  sd2   = apply(y,1,sd)
  Pgc = abs((xbar1-xbar2))/(sd1+sd2)
  return(Pgc)
} #end function
sub = 500	#Subset index for speed
Pgc.gol = Pgc(golub[1:sub,1:27],golub[1:sub,28:38]) #Calculate correlation statistics
T=c(1,5,10,25,50,92); G=c(1,10,25,50,150); D=c(0,1,2) #Set PCS parameters
sde=0.20 		#Obtained by simulation on Golub data
PCS.boot.par(Pgc.gol, T, G, D, L=NULL, B=100, SDE=0.2, dist="t", df=18) #Small B for speed

##### Microarray example using non-parametric bootstrap
require(multtest)
data(golub)  							#Load microarray data
T=c(1,5,10); G=c(1,3,5); D=c(0,1,2) 	#Set PCS parameters
sub = 100	#Subset index for speed
PCS.boot.np(golub[1:sub,1:27], golub[1:sub,28:38], T, G, D, B=10, trunc=6) #Small B for speed
</code></pre>

<hr>
<h2 id='PdCSGt.bootstrap.NP2'> Non-Parametric Bootstrap for Computing G-best and d-best PCS </h2><span id='topic+PdCSGt.bootstrap.NP2'></span>

<h3>Description</h3>

<p>Non-parametric bootstrap for computing G-best and d-best PCS.  This function is called by the wrapper PCS.boot.np. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PdCSGt.bootstrap.NP2(X1, X2, T, D, G, N, trunc = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_x1">X1</code></td>
<td>
<p>  k by n1 matrix of data.  k is the number of populations and n1 the sample size 
of the first treatment. </p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_x2">X2</code></td>
<td>
<p>  k by n2 matrix of data.  k is the number of populations and n2 the sample size 
of the second treatment. </p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_t">T</code></td>
<td>
<p>  Vector of the number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_d">D</code></td>
<td>
<p>  Vector of d-best selection parameters </p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_g">G</code></td>
<td>
<p>  Vector of G-best selection parameters </p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_n">N</code></td>
<td>
<p>  The bootstrap sample size</p>
</td></tr>
<tr><td><code id="PdCSGt.bootstrap.NP2_+3A_trunc">trunc</code></td>
<td>
<p>  Number of standard errors below the minimum selected
population to disregard in the estimation of PCS; it is a truncation parameter
to decrease run time </p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix whose rows are the entries of G or D and 
whose columns are the entries of T.  If both G and D are entered, then a list is returned, 
where the $G element is the G-best matrix, the $d element is the d-best matrix.  
</p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

 
<p>Cui, X. and Wilson, J.  2009.  A Simulation Study on the Probability of Correct Selection for Large k Populations.  
Communications in Statistics: Simulation and Computation.  38:6.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjMxYTdjNjJkNzY3NTU4NzA</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+PCS.boot.np">PCS.boot.np</a></code> </p>

<hr>
<h2 id='PdofCSGt.bootstrap5'> Parametric Bootstrap for Computing G-best and d-best PCS </h2><span id='topic+PdofCSGt.bootstrap5'></span>

<h3>Description</h3>

<p>Parametric bootstrap for computing G-best and d-best PCS.  This function is called by the wrapper PCS.boot.par.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PdofCSGt.bootstrap5(theta, T, D, G, B, SDE, dist = c("normal", "t"), 
	df = 14, trunc = 6, est.names = c("O"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PdofCSGt.bootstrap5_+3A_theta">theta</code></td>
<td>
<p>  Vector of statistics (or parameters) from which it is desired to select 
the top t of them </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_t">T</code></td>
<td>
<p>  Vector of the number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_d">D</code></td>
<td>
<p>  Vector of d-best selection parameters </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_g">G</code></td>
<td>
<p>  Vector of G-best selection parameters </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_b">B</code></td>
<td>
<p>  Bootstrap sample size </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_sde">SDE</code></td>
<td>
<p>  Standard error of the statistics theta (row-wise) </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_dist">dist</code></td>
<td>
<p>  Distributional assumption used for estimating PCS </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_df">df</code></td>
<td>
<p>  Common degrees of freedom for one of the t-statistics in theta;
the parameter is only used if dist=&quot;t&quot; </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_trunc">trunc</code></td>
<td>
<p>  Number of standard errors below the minimum selected
population to disregard in the estimation of PCS; it is a truncation parameter
to decrease run time </p>
</td></tr>
<tr><td><code id="PdofCSGt.bootstrap5_+3A_est.names">est.names</code></td>
<td>
<p>  Kind of shrinkage estimator employed.  Default estimator 
is &quot;O&quot; for the Olkin estimator.  Other estimators will be considered for future releases. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array, the non-empty part of which is a matrix whose rows are the entries of G or D and 
whose columns are the entries of T.  If both G and D are entered, then a list is returned, 
where the $G element is the G-best matrix, the $d element is the d-best matrix.  
</p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

 
<p>Cui, X. and Wilson, J.  2007.  On How to Calculate the Probability of Correct Selection for Large k 
Populations.  University of California, Riverside Statistics Department Technical Report 297.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+PCS.boot.par">PCS.boot.par</a></code> </p>

<hr>
<h2 id='PdofCSt.T1or2'> Exact PCS, When Selecting t=1 or t=2 or More Populations </h2><span id='topic+PdofCSt.T1or2'></span><span id='topic+PdofCSt.cyc2'></span><span id='topic+PofCSGt'></span>

<h3>Description</h3>

<p>PdofCSt.T1or2 calls PofCSt to implement the d-best PCS formula for the case of t=1 or t=2 
populations.  It is called by PdofCSt.cyc2, which implements the d-best PCS formula for 
general t populations.  PofCSGt calls PofCSt to implement the G-best formula for general t. 
These functions are modular and implement the time reduction techniques of Cui and Wilson (2007).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PdofCSt.T1or2(theta, T, d, m = 20, tol = 1e-08)
PdofCSt.cyc2(theta, T, d, m = 20, tol = 1e-08)
PofCSGt(theta, T, Gd, m = 20, tol = 1e-08)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PdofCSt.T1or2_+3A_theta">theta</code></td>
<td>
<p>  Vector of statistics (or parameters) from which it is desired to select 
the top t of them </p>
</td></tr>
<tr><td><code id="PdofCSt.T1or2_+3A_t">T</code></td>
<td>
<p>  The number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PdofCSt.T1or2_+3A_d">d</code></td>
<td>
<p>  The d-best selection parameter (scalar) </p>
</td></tr>
<tr><td><code id="PdofCSt.T1or2_+3A_gd">Gd</code></td>
<td>
<p>  The G-best selection parameter (scalar) </p>
</td></tr>
<tr><td><code id="PdofCSt.T1or2_+3A_m">m</code></td>
<td>
<p>  Number of nodes employed in the Gauss-Hermite quadrature </p>
</td></tr>
<tr><td><code id="PdofCSt.T1or2_+3A_tol">tol</code></td>
<td>
<p>  Tolerance parameter to set the cut-off level for the inclusion of additional 
probability components in PCS </p>
</td></tr>
</table>


<h3>Value</h3>

<p> The probability of correct selection. </p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

 
<p>Cui, X. and Wilson, J.  2007.  On How to Calculate the Probability of Correct Selection for Large k 
Populations.  University of California, Riverside Statistics Department Technical Report 297.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+PofCSt">PofCSt</a></code>, <code><a href="#topic+PdofCSt.T1or2">PdofCSt.T1or2</a></code>, <code><a href="#topic+PdofCSt.cyc2">PdofCSt.cyc2</a></code>, <code><a href="#topic+PofCSGt">PofCSGt</a></code>  </p>

<hr>
<h2 id='PofCSLt.bootstrap5'> Parametric Bootstrap for Computing L-best PCS </h2><span id='topic+PofCSLt.bootstrap5'></span>

<h3>Description</h3>

<p>Parametric bootstrap for computing L-best PCS.  This function is called by the wrapper PCS.boot.np.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PofCSLt.bootstrap5(theta, T, L, B, SDE, dist = c("normal", "t"), 
     df = 14, trunc = 6, est.names = c("O"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PofCSLt.bootstrap5_+3A_theta">theta</code></td>
<td>
<p>  Vector of statistics (or parameters) from which it is desired to select 
the top t of them </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_t">T</code></td>
<td>
<p>  Vector of the number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_l">L</code></td>
<td>
<p>  Vector of L-best selection parameters </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_b">B</code></td>
<td>
<p>  Bootstrap sample size </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_sde">SDE</code></td>
<td>
<p>  Standard error of the statistics theta (row-wise) </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_dist">dist</code></td>
<td>
<p>  Distributional assumption used for estimating PCS </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_df">df</code></td>
<td>
<p>  Common degrees of freedom for one of the t-statistics in theta;
the parameter is only used if dist=&quot;t&quot; </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_trunc">trunc</code></td>
<td>
<p>  Number of standard errors below the minimum selected
population to disregard in the estimation of PCS; it is a truncation parameter
to decrease run time </p>
</td></tr>
<tr><td><code id="PofCSLt.bootstrap5_+3A_est.names">est.names</code></td>
<td>
<p>  Kind of shrinkage estimator employed.  Default estimator 
is &quot;O&quot; for the Olkin estimator.  Other estimators will be considered for future releases. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>An array, the non-empty part of which is a matrix whose rows are the entries of L and 
whose columns are the entries of T.
</p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

 
<p>Cui, X.; Zhao, H. and Wilson, J.  2010.  Optimized Ranking and Selection Methods for Feature Selection with Application in Microarray Experiments.  Journal of Biopharmaceutical Statistics.  Volume 20, No. 2, pp. 223-239.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjY0ZTJkNDNlMzNiNjE0ZDg</a>
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+PCS.boot.par">PCS.boot.par</a></code> </p>

<hr>
<h2 id='PofCSt'> Probability of Correct Selection (PCS) for Selecting t out of k Populations </h2><span id='topic+PofCSt'></span>

<h3>Description</h3>

<p>Implementation of the Gupta &amp; Liang (1998) formula for computing the probability of 
correct selection (PCS) for selecting t out of k populations.  The results are exact
up to a user-settable tolerance parameter.  This function is modular and is called by 
PdofCSt.T1or2, PdofCSt.cyc2, and PofCSGt.
</p>


<h3>Usage</h3>

<pre><code class='language-R'> PofCSt(theta, T, m, tol = 1e-07) </code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PofCSt_+3A_theta">theta</code></td>
<td>
<p>  Vector of statistics (or parameters) from which it is desired to select 
the top t of them </p>
</td></tr>
<tr><td><code id="PofCSt_+3A_t">T</code></td>
<td>
<p>  The number of statistics (or parameters) desired to be selected </p>
</td></tr>
<tr><td><code id="PofCSt_+3A_m">m</code></td>
<td>
<p>  Number of nodes employed in the Gauss-Hermite quadrature </p>
</td></tr>
<tr><td><code id="PofCSt_+3A_tol">tol</code></td>
<td>
<p>  Tolerance parameter to set the cut-off level for the inclusion of additional 
probability components in PCS </p>
</td></tr>
</table>


<h3>Details</h3>

<p> The analytic formula for computing PCS for t of k populations is an integral whose integrad
is the product of normal densities.  This function obtains the appropriate values and computes the
integral using a Gauss-Hermite quadrature.  See equation 2.4 of Gupta (1998). </p>


<h3>Value</h3>

<p> The probability of correct selection. </p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>References</h3>

 
<p>Cui, X. and Wilson, J.  2007.  On How to Calculate the Probability of Correct Selection for Large k 
Populations.  University of California, Riverside Statistics Department Technical Report 297.
<a href="https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY">https://docs.google.com/a/biola.edu/viewer?a=v&amp;pid=sites&amp;srcid=YmlvbGEuZWR1fGphc29ud2lsc29ufGd4OjJmYTY2YTJjY2EwYjg2ZmY</a>
<br />
Gupta, S.S. and Liang, T.C.  1998.  Simultaneous lower confidence bounds for probabilities of correct 
selections. Journal of Statistical Planning and Inference.  72(1-2), 279-290.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+PdofCSt.T1or2">PdofCSt.T1or2</a></code>, <code><a href="#topic+PdofCSt.cyc2">PdofCSt.cyc2</a></code>, <code><a href="#topic+PofCSGt">PofCSGt</a></code> </p>

<hr>
<h2 id='tindep'> Standardized Scores for Two Independent Samples </h2><span id='topic+tindep'></span>

<h3>Description</h3>

<p>Calculate the independent two-sample Welch t-statistics for k populations simultaneously. 
This function is used in PCS.bootstrap.np.  It may also be used to summarize data from two sample experiments 
for use in PCS.exact and PCS.bootstrap.par.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tindep(X, Y, flag = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tindep_+3A_x">X</code></td>
<td>
<p>  k by n1 matrix of data.  k is the number of populations and n1 the sample size 
of the first treatment. </p>
</td></tr>
<tr><td><code id="tindep_+3A_y">Y</code></td>
<td>
<p>  k by n2 matrix of data.  k is the number of populations and n2 the sample size 
of the second treatment. </p>
</td></tr>
<tr><td><code id="tindep_+3A_flag">flag</code></td>
<td>
<p>  Determines whether the output is t-statistics (flag=0) or t-statistics with p-values 
(flag!=0) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>X &amp; Y are the data matrices for input.  When called inside of the function PCS.bootstrap.np, or when 
used to obtain t-statistics for use with PCS.exact and PCS.bootstrap.par, setting 'flag'=0 will return the 
needed vector of t-statistics.  If flag!=0, then the function 'mt.rawp2adjp' from the multtest 
library is called, producing multiple comparison adjustd pvalues (&quot;Bonferroni&quot;, &quot;Holm&quot;, &quot;Hochberg&quot;, 
&quot;SidakSS&quot;, &quot;SidakSD&quot;, &quot;BH&quot;, &quot;BY&quot;).  The t-statistics and p-values are stored in a matrix.
</p>


<h3>Value</h3>

<p>If flag = 0, the result is a k by 1 vector of t-statistics.
If flag != 0, the result is a k by 7 vector of t-statistics and pvalues (see details).
</p>


<h3>Author(s)</h3>

<p> Jason Wilson &lt;jason.wilson@biola.edu&gt; </p>


<h3>See Also</h3>

 <p><code><a href="#topic+PCS.boot.np">PCS.boot.np</a></code>  </p>


<h3>Examples</h3>

<pre><code class='language-R'>### Small example
k=20 #number of populations
n=10 #sample size
SD=.1 #standard deviation
theta = seq(0,6,length.out=k)
X1 = rnorm(k*n,0,SD)   #Sample 1
X1 = matrix(X1,nrow=k,ncol=n,byrow=FALSE)
X2 = rnorm(k*n,theta,SD) #Sample 2, shifted
X2 = matrix(X2,nrow=k,ncol=n,byrow=FALSE)
tindep(X1,X2, flag=1)

### Microarray example
#require(multtest)
data(golub)
sub = 500 #Subset index for speed
golub.Tp = tindep(golub[1:sub,1:27], golub[1:sub,28:38], flag=0) #Obtain t-statistics + p-values

ans = tindep(golub[1:sub,1:27], golub[1:sub,28:38], flag=1)  #Obtain t-statistics
golub.T = sort(abs(ans[,1]))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
