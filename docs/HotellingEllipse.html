<!DOCTYPE html><html lang="en-US"><head><title>Help for package HotellingEllipse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {HotellingEllipse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#HotellingEllipse-package'><p>HotellingEllipse: Hotelling’s T-Squared Statistic and Ellipse</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#ellipseCoord'><p>Coordinate Points of the Hotelling’s T-squared Ellipse</p></a></li>
<li><a href='#ellipseParam'><p>Hotelling’s T-squared Statistic and Ellipse Parameters</p></a></li>
<li><a href='#specData'><p>LIBS spectra of 100 soil samples</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Hotelling’s T-Squared Statistic and Ellipse</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate the Hotelling’s T-squared statistic and corresponding confidence ellipses. Provides the semi-axes of the Hotelling’s T-squared ellipses at 95% and 99% confidence levels. Enables users to obtain the coordinates in two or three dimensions at user-defined confidence levels, allowing for the construction of 2D or 3D ellipses with customized confidence levels. Bro and Smilde (2014) &lt;<a href="https://doi.org/10.1039%2Fc3ay41907j">doi:10.1039/c3ay41907j</a>&gt;. Brereton (2016) &lt;<a href="https://doi.org/10.1002%2Fcem.2763">doi:10.1002/cem.2763</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ChristianGoueguel/HotellingEllipse">https://github.com/ChristianGoueguel/HotellingEllipse</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ChristianGoueguel/HotellingEllipse/issues">https://github.com/ChristianGoueguel/HotellingEllipse/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, FactoMineR, ggforce, ggplot2, lifecycle, magrittr,
purrr, rgl, stats, tibble</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr, markdown, testthat (&ge; 3.0.0), spelling,
covr, scales, viridisLite</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-07-04 16:03:50 UTC; christiangoueguel</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian L. Goueguel
    <a href="https://orcid.org/0000-0003-0521-3446"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian L. Goueguel &lt;christian.goueguel@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-04 23:10:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='HotellingEllipse-package'>HotellingEllipse: Hotelling’s T-Squared Statistic and Ellipse</h2><span id='topic+HotellingEllipse'></span><span id='topic+HotellingEllipse-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Functions to calculate the Hotelling’s T-squared statistic and corresponding confidence ellipses. Provides the semi-axes of the Hotelling’s T-squared ellipses at 95
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Christian L. Goueguel <a href="mailto:christian.goueguel@gmail.com">christian.goueguel@gmail.com</a> (<a href="https://orcid.org/0000-0003-0521-3446">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ChristianGoueguel/HotellingEllipse">https://github.com/ChristianGoueguel/HotellingEllipse</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ChristianGoueguel/HotellingEllipse/issues">https://github.com/ChristianGoueguel/HotellingEllipse/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='ellipseCoord'>Coordinate Points of the Hotelling’s T-squared Ellipse</h2><span id='topic+ellipseCoord'></span>

<h3>Description</h3>

<p>This function calculates the coordinate points for drawing a Hotelling’s T-squared
ellipse based on multivariate data. It can generate points for both 2D and 3D ellipses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipseCoord(x, pcx = 1, pcy = 2, pcz = NULL, conf.limit = 0.95, pts = 200)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ellipseCoord_+3A_x">x</code></td>
<td>
<p>A matrix, data frame or tibble containing scores from PCA, PLS, ICA, or other dimensionality reduction methods. Each column should represent a component, and each row an observation.</p>
</td></tr>
<tr><td><code id="ellipseCoord_+3A_pcx">pcx</code></td>
<td>
<p>An integer specifying which component to use for the x-axis (default is 1).</p>
</td></tr>
<tr><td><code id="ellipseCoord_+3A_pcy">pcy</code></td>
<td>
<p>An integer specifying which component to use for the y-axis (default is 2).</p>
</td></tr>
<tr><td><code id="ellipseCoord_+3A_pcz">pcz</code></td>
<td>
<p>An integer specifying which component to use for the z-axis for 3D ellipsoids. If <code>NULL</code> (default), a 2D ellipse is computed.</p>
</td></tr>
<tr><td><code id="ellipseCoord_+3A_conf.limit">conf.limit</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the confidence level for the ellipse (default is 0.95, i.e., 95% confidence).</p>
</td></tr>
<tr><td><code id="ellipseCoord_+3A_pts">pts</code></td>
<td>
<p>An integer specifying the number of points to generate for drawing the ellipse (default is 200). Higher values result in smoother ellipses.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the shape and orientation of the ellipse based on the
Hotelling’s T-squared distribution and the specified components. It then generates a set of
points that lie on the ellipse's surface at the specified confidence level.
For 2D ellipses, the function uses two components <code>pcx</code>
and <code>pcy</code>. For 3D ellipsoids, it uses three components <code>pcx</code>, <code>pcy</code>, and <code>pcz</code>.
The <code>conf.limit</code> parameter determines the size of the ellipse. A higher confidence
level results in a larger ellipse that encompasses more data points.
</p>


<h3>Value</h3>

<p>A data frame containing the coordinate points of the Hotelling’s T-squared ellipse:
</p>

<ul>
<li><p> For 2D ellipses: columns <code>x</code> and <code>y</code>
</p>
</li>
<li><p> For 3D ellipsoids: columns <code>x</code>, <code>y</code>, and <code>z</code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Christian L. Goueguel <a href="mailto:christian.goueguel@gmail.com">christian.goueguel@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load required libraries
library(HotellingEllipse)
library(dplyr)

data("specData", package = "HotellingEllipse")

# Perform PCA
set.seed(123)
pca_mod &lt;- specData %&gt;%
  select(where(is.numeric)) %&gt;%
  FactoMineR::PCA(scale.unit = FALSE, graph = FALSE)

# Extract PCA scores
pca_scores &lt;- pca_mod$ind$coord %&gt;% as.data.frame()

# Example 1: Calculate Hotelling’s T-squared ellipse coordinates
xy_coord &lt;- ellipseCoord(pca_scores, pcx = 1, pcy = 2)

# Example 2: Calculate Hotelling’s T-squared ellipsoid coordinates
xyz_coord &lt;- ellipseCoord(pca_scores, pcx = 1, pcy = 2, pcz = 3)

## End(Not run)

</code></pre>

<hr>
<h2 id='ellipseParam'>Hotelling’s T-squared Statistic and Ellipse Parameters</h2><span id='topic+ellipseParam'></span>

<h3>Description</h3>

<p>This function calculates Hotelling’s T-squared statistic and, when applicable,
the lengths of the semi-axes of the Hotelling’s ellipse. It can work with a
specified number of components or use a cumulative variance threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ellipseParam(
  x,
  k = 2,
  pcx = 1,
  pcy = 2,
  threshold = NULL,
  rel.tol = 0.001,
  abs.tol = .Machine$double.eps
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ellipseParam_+3A_x">x</code></td>
<td>
<p>A matrix, data frame or tibble containing scores from PCA, PLS, ICA, or other similar methods. Each column should represent a component, and each row an observation.</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_k">k</code></td>
<td>
<p>An integer specifying the number of components to use (default is 2). This parameter is ignored if <code>threshold</code> is provided.</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_pcx">pcx</code></td>
<td>
<p>An integer specifying which component to use for the x-axis when <code>k = 2</code> (default is 1).</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_pcy">pcy</code></td>
<td>
<p>An integer specifying which component to use for the y-axis when <code>k = 2</code> (default is 2).</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_threshold">threshold</code></td>
<td>
<p>A numeric value between 0 and 1 specifying the desired cumulative explained variance threshold (default is <code>NULL</code>). If provided, the function determines the minimum number of components needed to explain at least this proportion of total variance. When <code>NULL</code>, the function uses the fixed number of components specified by <code>k</code>.</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_rel.tol">rel.tol</code></td>
<td>
<p>A numeric value specifying the minimum proportion of total variance a component should explain to be considered non-negligible (default is 0.001, i.e., 0.1%).</p>
</td></tr>
<tr><td><code id="ellipseParam_+3A_abs.tol">abs.tol</code></td>
<td>
<p>A numeric value specifying the minimum absolute variance a component should have to be considered non-negligible (default is <code>.Machine$double.eps</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>threshold</code> is used, the function selects the minimum number of <code>k</code> components
that cumulatively explain at least the specified proportion of variance. This
parameter allows for dynamic component selection based on explained variance,
rather than using a fixed number of components. It must be greater than <code>rel.tol</code>.
Typical values range from 0.8 to 0.95.
</p>
<p>The <code>rel.tol</code> parameter sets a minimum variance threshold for individual components.
Components with variance below this threshold are considered negligible and are
removed from the analysis. Setting <code>rel.tol</code> too high
may remove potentially important components, while setting it too low may
retain noise or cause computational issues. Adjust based on your data
characteristics and analysis goals.
</p>
<p>Note that components are considered to have near-zero variance and are removed
if their relative variance is below <code>rel_tol</code> or their absolute variance is
below <code>abs_tol</code>. This dual-threshold approach helps ensure numerical stability
while also accounting for the relative importance of components. The default
value for <code>abs.tol</code> is set to <code>.Machine$double.eps</code>, providing a lower bound
for detecting near-zero variance that may cause numerical instability.
</p>


<h3>Value</h3>

<p>A list containing the following elements:
</p>

<ul>
<li> <p><code>Tsquare</code>: A data frame containing the T-squared statistic for each observation.
</p>
</li>
<li> <p><code>Ellipse</code>: A data frame containing the lengths of the semi-minor and semi-major axes (only when <code>k = 2</code>).
</p>
</li>
<li> <p><code>cutoff.99pct</code>: The T-squared cutoff value at the 99% confidence level.
</p>
</li>
<li> <p><code>cutoff.95pct</code>: The T-squared cutoff value at the 95% confidence level.
</p>
</li>
<li> <p><code>nb.comp</code>: The number of components used in the calculation.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Christian L. Goueguel <a href="mailto:christian.goueguel@gmail.com">christian.goueguel@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load required libraries
library(HotellingEllipse)
library(dplyr)

data("specData", package = "HotellingEllipse")

# Perform PCA
set.seed(123)
pca_mod &lt;- specData %&gt;%
  select(where(is.numeric)) %&gt;%
  FactoMineR::PCA(scale.unit = FALSE, graph = FALSE)

# Extract PCA scores
pca_scores &lt;- pca_mod$ind$coord %&gt;% as.data.frame()

# Example 1: Calculate Hotelling’s T-squared and ellipse parameters using
# the 2nd and 4th components
T2_fixed &lt;- ellipseParam(x = pca_scores, pcx = 2, pcy = 4)

# Example 2: Calculate using the first 4 components
T2_comp &lt;- ellipseParam(x = pca_scores, k = 4)

# Example 3: Calculate using a cumulative variance threshold
T2_threshold &lt;- ellipseParam(x = pca_scores, threshold = 0.95)

## End(Not run)


</code></pre>

<hr>
<h2 id='specData'>LIBS spectra of 100 soil samples</h2><span id='topic+specData'></span>

<h3>Description</h3>

<p>Data set of the emission spectra of 100 soils measured in laboratory conditions.
The samples were cleaned, dried, homogenized, sieved (10 Mesh size) and thereafter pelletized prior to LIBS measurements.
LIBS spectra were preprocessed by performing baseline removal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specData
</code></pre>


<h3>Format</h3>

<p>Data frame of 100 rows (soil samples) and 3152 columns (wavelengths).
</p>


<h3>Source</h3>

<p><a href="https://doi.org/10.1039/C9JA00090A">doi:10.1039/C9JA00090A</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
