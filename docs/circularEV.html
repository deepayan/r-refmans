<!DOCTYPE html><html><head><title>Help for package circularEV</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {circularEV}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CalcRLsplineML'><p>Calculate T-year levels for spline ML model</p></a></li>
<li><a href='#circularEV-package'><p>circularEV: Extreme Value Analysis for Circular Data</p></a></li>
<li><a href='#drc'><p>Directional covariate for HsSP data</p></a></li>
<li><a href='#HsSP'><p>Hindcast storm peak significant wave height data</p></a></li>
<li><a href='#LocalEstim'><p>Local bootstrap estimation of EVI, scale and T-year levels</p></a></li>
<li><a href='#PlotData'><p>Plot of circular data</p></a></li>
<li><a href='#PlotParamEstim'><p>Plot of parameter estimates with bootstrap confidence intervals</p></a></li>
<li><a href='#PlotRL'><p>Plot of T-year levels</p></a></li>
<li><a href='#PolarPlotData'><p>Polar plot of circular data</p></a></li>
<li><a href='#PolarPlotRL'><p>Polar plot of T-year levels</p></a></li>
<li><a href='#SplineML'><p>Spline ML fitting</p></a></li>
<li><a href='#thresholdExampleML'><p>Threshold for spline ML and local ML examples</p></a></li>
<li><a href='#thresholdExampleMom'><p>Threshold for local Moment examples</p></a></li>
<li><a href='#ThrSelection'><p>Threshold selection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extreme Value Analysis for Circular Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-02</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, foreach, doParallel, mgcv, circular, NPCirc,
ggplot2, utils, stats</td>
</tr>
<tr>
<td>Author:</td>
<td>Evandro Konzen</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Evandro Konzen &lt;circularev.r@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>General functions for performing extreme value analysis on a circular 
    domain as part of the statistical methodology in the paper by Konzen, E., 
    Neves, C., and Jonathan, P. (2021). Modeling nonstationary extremes of storm severity: Comparing parametric and semiparametric inference. Environmetrics, 32(4), e2667.</td>
</tr>
<tr>
<td>Acknowledgements:</td>
<td>This work was supported by the EPSRC UKRI Innovation
Fellowship (grant number EP/S001263/1)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>plotly, testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-02 18:57:41 UTC; evandro</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-13 09:10:18 UTC</td>
</tr>
</table>
<hr>
<h2 id='CalcRLsplineML'>Calculate T-year levels for spline ML model</h2><span id='topic+CalcRLsplineML'></span>

<h3>Description</h3>

<p>Calculate T-year levels for spline ML model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CalcRLsplineML(
  Data,
  drc,
  h,
  xiBoot,
  sigBoot,
  TTs = c(100, 10000),
  thetaGrid = 1:360,
  timeRange,
  thr
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CalcRLsplineML_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_h">h</code></td>
<td>
<p>Bandwidth value</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_xiboot">xiBoot</code></td>
<td>
<p>Bootstrap estimates for EVI</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_sigboot">sigBoot</code></td>
<td>
<p>Bootstrap estimates for shape</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_tts">TTs</code></td>
<td>
<p>T-year levels. For example, TTs = c(100, 10000).</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_timerange">timeRange</code></td>
<td>
<p>Time range of the sample</p>
</td></tr>
<tr><td><code id="CalcRLsplineML_+3A_thr">thr</code></td>
<td>
<p>Threshold values along thetaGrid</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List including bootstrap estimates of T-year levels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineML">SplineML</a></code> for examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See also examples in vignettes:
# vignette("localMethods", package = "circularEV")
# vignette("splineML", package = "circularEV")
</code></pre>

<hr>
<h2 id='circularEV-package'>circularEV: Extreme Value Analysis for Circular Data</h2><span id='topic+circularEV'></span><span id='topic+circularEV-package'></span>

<h3>Description</h3>

<p>General functions for performing extreme value analysis on a circular 
domain as part of the statistical methodology in the paper by Konzen, E., 
Neves, C., and Jonathan, P. (2021). Modeling nonstationary extremes of storm severity: Comparing parametric and semiparametric inference. Environmetrics, 32(4), e2667.
</p>

<hr>
<h2 id='drc'>Directional covariate for HsSP data</h2><span id='topic+drc'></span>

<h3>Description</h3>

<p>A vector of length 1521.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drc
</code></pre>


<h3>Format</h3>

<p>A vector of length 1521.</p>


<h3>Details</h3>

<p>Directional covariate of HsSP data used by Reistad, M., Breivik, Ø.,
Haakenstad, H., Aarnes, O. J., Furevik, B. R., and Bidlot, J.-R. (2011), A
high-resolution hindcast of wind and waves for the North Sea, the Norwegian
Sea, and the Barents Sea, J. Geophys. Res., 116:1-18.
</p>

<hr>
<h2 id='HsSP'>Hindcast storm peak significant wave height data</h2><span id='topic+HsSP'></span>

<h3>Description</h3>

<p>A vector of length 1521.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HsSP
</code></pre>


<h3>Format</h3>

<p>A vector of length 1521.</p>


<h3>Details</h3>

<p>HsSP data used by Reistad, M., Breivik, Ø., Haakenstad, H., Aarnes,
O. J., Furevik, B. R., and Bidlot, J.-R. (2011), A high-resolution hindcast
of wind and waves for the North Sea, the Norwegian Sea, and the Barents
Sea, J. Geophys. Res., 116:1-18.
</p>

<hr>
<h2 id='LocalEstim'>Local bootstrap estimation of EVI, scale and T-year levels</h2><span id='topic+LocalEstim'></span>

<h3>Description</h3>

<p>Local bootstrap estimation of EVI, scale and T-year levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LocalEstim(
  Data,
  drc,
  thr = NULL,
  thetaGrid,
  nBoot = 100,
  EVIestimator = "Mom",
  h = 30,
  useKernel = TRUE,
  concent = 10,
  movThr = TRUE,
  TTs = NULL,
  timeRange = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LocalEstim_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_thr">thr</code></td>
<td>
<p>Threshold values along thetaGrid</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_nboot">nBoot</code></td>
<td>
<p>Number of bootstrap resamples. Default to 100.</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_eviestimator">EVIestimator</code></td>
<td>
<p>It can be either &quot;ML&quot; or &quot;Mom&quot;</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_h">h</code></td>
<td>
<p>Bandwidth value</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_usekernel">useKernel</code></td>
<td>
<p>Logical. If TRUE (default), use kernel to assign weights
depending on the directional distance.</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_concent">concent</code></td>
<td>
<p>Concentration parameter value for von Mises kernel</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_movthr">movThr</code></td>
<td>
<p>Logical. If TRUE (default), moving threshold within the window
used.</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_tts">TTs</code></td>
<td>
<p>T-year levels. For example, TTs = c(100, 10000).</p>
</td></tr>
<tr><td><code id="LocalEstim_+3A_timerange">timeRange</code></td>
<td>
<p>Time range of the sample</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Konzen, E., Neves, C., and Jonathan, P. (2021). Modeling nonstationary extremes of storm severity: Comparing parametric and semiparametric inference. Environmetrics, 32(4), e2667.
</p>


<h3>Value</h3>

<p>List including bootstrap estimates of EVI, scale and T-year levels.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HsSP)
data(drc)
timeRange &lt;- 54.5

idx &lt;- order(drc)
drc &lt;- drc[idx]
Data &lt;- HsSP[idx]
set.seed(1234)
Data &lt;- Data + runif(length(Data), -1e-4, 1e-4)

thetaVec &lt;- 1:360

data(thresholdExampleMom) # loads threshold example
thrResultMom &lt;- thresholdExampleMom



h &lt;- 60
useKernel &lt;- TRUE
concent &lt;- 10
movThr &lt;- TRUE
nBoot &lt;- 30
set.seed(1234)
output &lt;- LocalEstim(Data=Data, drc=drc, thr=thrResultMom,
                     thetaGrid=thetaVec, nBoot=nBoot, EVIestimator="Mom", h=h,
                     useKernel=useKernel, concent=concent, movThr=movThr,
                     TTs=c(100, 10000), timeRange=timeRange)

RLBoot &lt;- output$RLBoot

PlotParamEstim(bootEstimates=output$xiBoot, thetaGrid=thetaVec, ylab=bquote(hat(xi)),
               alpha=0.05, ylim=NULL, cex.axis=15, cex.lab=2, thrWidth=2)

PlotParamEstim(bootEstimates=output$sigBoot, thetaGrid=thetaVec, ylab=bquote(hat(sigma)),
               alpha=0.05, ylim=NULL, cex.axis=15, cex.lab=2, thrWidth=2)

# 100-year level
PlotRL(RLBootList=RLBoot, thetaGrid=thetaVec, Data=Data, drc=drc,
       TTs=c(100, 10000), whichPlot=1, alpha=0.05, ylim=NULL,
       pointSize=1, cex.axis=15, cex.lab=2, thrWidth=2)

PolarPlotRL(RLBootList=RLBoot, thetaGrid=thetaVec, Data=Data, drc=drc,
            TTs=c(100, 10000), whichPlot=1, alpha=0.05, ylim=NULL,
            pointSize=4, fontSize=12, lineWidth=2)



## See examples in vignette:
# vignette("localMethods", package = "circularEV")
</code></pre>

<hr>
<h2 id='PlotData'>Plot of circular data</h2><span id='topic+PlotData'></span>

<h3>Description</h3>

<p>Plot of circular data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotData(
  Data,
  drc,
  thr = NULL,
  ylim = NULL,
  pointSize = 4,
  cex.axis = 15,
  cex.lab = 2,
  thrWidth = 2,
  thrColor = "#D45E1A",
  thrLineType = 1,
  ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotData_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="PlotData_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="PlotData_+3A_thr">thr</code></td>
<td>
<p>Threshold values along thetaGrid</p>
</td></tr>
<tr><td><code id="PlotData_+3A_ylim">ylim</code></td>
<td>
<p>Range of values</p>
</td></tr>
<tr><td><code id="PlotData_+3A_pointsize">pointSize</code></td>
<td>
<p>Size of points (observations)</p>
</td></tr>
<tr><td><code id="PlotData_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotData_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotData_+3A_thrwidth">thrWidth</code></td>
<td>
<p>Threshold width</p>
</td></tr>
<tr><td><code id="PlotData_+3A_thrcolor">thrColor</code></td>
<td>
<p>Threshold colour</p>
</td></tr>
<tr><td><code id="PlotData_+3A_thrlinetype">thrLineType</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotData_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of circular data, possibly including a threshold.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HsSP)
data(drc)

PlotData(Data=HsSP, drc=drc, thr=NULL, pointSize=1, cex.axis=15, cex.lab=2,
         thrWidth=2)

data(thresholdExampleML) # loads threshold example

PlotData(Data=HsSP, drc=drc, thr=thresholdExampleML, pointSize=1, cex.axis=15,
         cex.lab=2, thrWidth=2)
</code></pre>

<hr>
<h2 id='PlotParamEstim'>Plot of parameter estimates with bootstrap confidence intervals</h2><span id='topic+PlotParamEstim'></span>

<h3>Description</h3>

<p>Plot of parameter estimates with bootstrap confidence intervals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotParamEstim(
  bootEstimates,
  thetaGrid = 1:360,
  alpha = 0.05,
  ylim = NULL,
  cex.axis = 15,
  cex.lab = 2,
  thrWidth = 2,
  ylab = NULL,
  thrColor = "#D45E1A"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotParamEstim_+3A_bootestimates">bootEstimates</code></td>
<td>
<p>Bootstrap estimates (for example, shape or scale)</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for the confidence intervals. Default to 0.05.</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_ylim">ylim</code></td>
<td>
<p>Range for the y-axis</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_thrwidth">thrWidth</code></td>
<td>
<p>Threshold width</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
<tr><td><code id="PlotParamEstim_+3A_thrcolor">thrColor</code></td>
<td>
<p>Threshold colour</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of parameter estimates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineML">SplineML</a></code> and <code><a href="#topic+LocalEstim">LocalEstim</a></code> for examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See examples in vignettes:
# vignette("localMethods", package = "circularEV")
# vignette("splineML", package = "circularEV")
</code></pre>

<hr>
<h2 id='PlotRL'>Plot of T-year levels</h2><span id='topic+PlotRL'></span>

<h3>Description</h3>

<p>Plot of T-year levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotRL(
  RLBootList,
  Data,
  drc,
  thetaGrid = 1:360,
  TTs,
  whichPlot,
  alpha = 0.05,
  ylim = NULL,
  pointSize = 1,
  cex.axis = 15,
  cex.lab = 2,
  thrWidth = 2,
  thrColor = "#D45E1A",
  ylab = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PlotRL_+3A_rlbootlist">RLBootList</code></td>
<td>
<p>List containing bootstrap estimates of T-year levels</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_tts">TTs</code></td>
<td>
<p>T-year levels. For example, TTs = c(100, 10000).</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_whichplot">whichPlot</code></td>
<td>
<p>Index identifying which T-year level should be plotted from
TTs. If TTs = c(100, 10000), then whichPlot=2 produces a plot for the
10000-year level</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for the confidence intervals. Default to 0.05.</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_ylim">ylim</code></td>
<td>
<p>Range for the y-axis</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_pointsize">pointSize</code></td>
<td>
<p>Size of points (observations)</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_cex.lab">cex.lab</code></td>
<td>
<p>Graphical parameter</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_thrwidth">thrWidth</code></td>
<td>
<p>Threshold width</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_thrcolor">thrColor</code></td>
<td>
<p>Threshold colour</p>
</td></tr>
<tr><td><code id="PlotRL_+3A_ylab">ylab</code></td>
<td>
<p>y-axis label</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of T-year levels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineML">SplineML</a></code> and <code><a href="#topic+LocalEstim">LocalEstim</a></code> for examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See also examples in vignettes:
# vignette("localMethods", package = "circularEV")
# vignette("splineML", package = "circularEV")
</code></pre>

<hr>
<h2 id='PolarPlotData'>Polar plot of circular data</h2><span id='topic+PolarPlotData'></span>

<h3>Description</h3>

<p>Polar plot of circular data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PolarPlotData(
  Data,
  drc,
  thr = NULL,
  ylim = NULL,
  pointSize = 1,
  fontSize = 12,
  thrWidth = 4,
  thrColor = "#D45E1A"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PolarPlotData_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_thr">thr</code></td>
<td>
<p>Threshold values along thetaGrid</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_ylim">ylim</code></td>
<td>
<p>Range of values</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_pointsize">pointSize</code></td>
<td>
<p>Size of points (observations)</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_fontsize">fontSize</code></td>
<td>
<p>Font size</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_thrwidth">thrWidth</code></td>
<td>
<p>Threshold width</p>
</td></tr>
<tr><td><code id="PolarPlotData_+3A_thrcolor">thrColor</code></td>
<td>
<p>Threshold colour</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Polar plot of circular data, possibly including a threshold
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HsSP)
data(drc)

PolarPlotData(Data=HsSP, drc=drc, thr=NULL, pointSize=4, fontSize=14,
              thrWidth=4, ylim=c(0,max(HsSP)))

data(thresholdExampleML) # loads threshold example

PolarPlotData(Data=HsSP, drc=drc, thr=thresholdExampleML, pointSize=4,
              fontSize=12, thrWidth=4, ylim=c(0,max(HsSP)))
</code></pre>

<hr>
<h2 id='PolarPlotRL'>Polar plot of T-year levels</h2><span id='topic+PolarPlotRL'></span>

<h3>Description</h3>

<p>Polar plot of T-year levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PolarPlotRL(
  RLBootList,
  Data,
  drc,
  thetaGrid = 1:360,
  TTs,
  whichPlot,
  alpha = 0.05,
  ylim = NULL,
  pointSize = 4,
  fontSize = 12,
  lineWidth = 4
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PolarPlotRL_+3A_rlbootlist">RLBootList</code></td>
<td>
<p>List containing bootstrap estimates of T-year levels</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_tts">TTs</code></td>
<td>
<p>T-year levels. For example, TTs = c(100, 10000).</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_whichplot">whichPlot</code></td>
<td>
<p>Index identifying which T-year level should be plotted from
TTs. If TTs = c(100, 10000), then whichPlot=2 produces a plot for the
10000-year level</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_alpha">alpha</code></td>
<td>
<p>Significance level for the confidence intervals. Default to 0.05.</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_ylim">ylim</code></td>
<td>
<p>Range for the y-axis</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_pointsize">pointSize</code></td>
<td>
<p>Size of points (observations)</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_fontsize">fontSize</code></td>
<td>
<p>Font size</p>
</td></tr>
<tr><td><code id="PolarPlotRL_+3A_linewidth">lineWidth</code></td>
<td>
<p>Threshold width</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Polar plot of T-year levels.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SplineML">SplineML</a></code> and <code><a href="#topic+LocalEstim">LocalEstim</a></code> for examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## See also examples in vignettes:
# vignette("localMethods", package = "circularEV")
# vignette("splineML", package = "circularEV")
</code></pre>

<hr>
<h2 id='SplineML'>Spline ML fitting</h2><span id='topic+SplineML'></span>

<h3>Description</h3>

<p>Spline ML fitting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SplineML(
  excesses,
  drc,
  thetaVec = 0:360,
  nBoot = 100,
  numIntKnots = 10,
  knotsType = "eqSpaced",
  lambda = seq(0, 2, by = 0.5),
  kappa = seq(0, 2, by = 0.5),
  nCandidatesInit = 1000,
  numCores = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SplineML_+3A_excesses">excesses</code></td>
<td>
<p>Excesses data</p>
</td></tr>
<tr><td><code id="SplineML_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="SplineML_+3A_thetavec">thetaVec</code></td>
<td>
<p>Grid values at which the threshold will be evaluated</p>
</td></tr>
<tr><td><code id="SplineML_+3A_nboot">nBoot</code></td>
<td>
<p>Number of bootstrap resamples</p>
</td></tr>
<tr><td><code id="SplineML_+3A_numintknots">numIntKnots</code></td>
<td>
<p>Number of internal knots</p>
</td></tr>
<tr><td><code id="SplineML_+3A_knotstype">knotsType</code></td>
<td>
<p>Position of knots. Default to &quot;eqSpaced&quot;. Otherwise, the
knots will be placed at the quantiles of observed directions.</p>
</td></tr>
<tr><td><code id="SplineML_+3A_lambda">lambda</code></td>
<td>
<p>Penalty parameter values for lambda</p>
</td></tr>
<tr><td><code id="SplineML_+3A_kappa">kappa</code></td>
<td>
<p>Penalty parameter values for kappa</p>
</td></tr>
<tr><td><code id="SplineML_+3A_ncandidatesinit">nCandidatesInit</code></td>
<td>
<p>Number of initial parameter vectors.
Optimisation will start with the best.</p>
</td></tr>
<tr><td><code id="SplineML_+3A_numcores">numCores</code></td>
<td>
<p>Number of CPU cores to be used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Konzen, E., Neves, C., and Jonathan, P. (2021). Modeling nonstationary extremes of storm severity: Comparing parametric and semiparametric inference. Environmetrics, 32(4), e2667.
</p>


<h3>Value</h3>

<p>List of bootstrap estimates of shape and scale, and optimal values of lambda and kappa.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HsSP)
data(drc)
timeRange &lt;- 54.5

idx &lt;- order(drc)
drc &lt;- drc[idx]
Data &lt;- HsSP[idx]
set.seed(1234)
Data &lt;- Data + runif(length(Data), -1e-4, 1e-4)

thetaVec &lt;- 1:360

data(thresholdExampleML) # loads threshold example
thrResultML &lt;- thresholdExampleML

lambda &lt;- 100
kappa &lt;- 40

thrPerObs &lt;- thrResultML[drc]
excess &lt;- Data - thrPerObs
drcExcess &lt;- drc[excess&gt;0]
excess &lt;- excess[excess&gt;0]



splineFit &lt;- SplineML(excesses = excess, drc = drcExcess, nBoot = 30,
                      numIntKnots = 16, lambda=lambda, kappa=kappa, numCores=2)

xiBoot &lt;- splineFit$xi
sigBoot &lt;- splineFit$sig

PlotParamEstim(bootEstimates=xiBoot, thetaGrid=0:360, ylab=bquote(hat(xi)),
               alpha=0.05, ylim=NULL, cex.axis=15, cex.lab=2, thrWidth=2)

PlotParamEstim(bootEstimates=sigBoot, thetaGrid=0:360, ylab=bquote(hat(sigma)),
               alpha=0.05, ylim=NULL, cex.axis=15, cex.lab=2, thrWidth=2)

h &lt;- 60 # needed for calculating local probability of exceedances
RLBoot &lt;- CalcRLsplineML(Data=Data, drc=drc, xiBoot=xiBoot, sigBoot=sigBoot, h=h,
                         TTs=c(100, 10000), thetaGrid=thetaVec,
                         timeRange=timeRange, thr=thrResultML)

# 100-year level
PlotRL(RLBootList=RLBoot, thetaGrid=thetaVec, Data=Data, drc=drc,
       TTs=c(100, 10000), whichPlot=1, alpha=0.05, ylim=NULL,
       pointSize=1, cex.axis=15, cex.lab=2, thrWidth=2)

PolarPlotRL(RLBootList=RLBoot, thetaGrid=thetaVec, Data=Data, drc=drc,
            TTs=c(100, 10000), whichPlot=1, alpha=0.05, ylim=c(0, 25),
            pointSize=4, fontSize=12, lineWidth=2)



## See also examples in vignette:
# vignette("splineML", package = "circularEV")
</code></pre>

<hr>
<h2 id='thresholdExampleML'>Threshold for spline ML and local ML examples</h2><span id='topic+thresholdExampleML'></span>

<h3>Description</h3>

<p>A vector of threshold values at directions 1,...,360. It is used for spline ML
and local ML examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresholdExampleML
</code></pre>


<h3>Format</h3>

<p>A vector of 360 values.</p>


<h3>Details</h3>

<p>It has been generated as follows: <br />  <br />
</p>
<pre>
data(HsSP)
data(drc)
timeRange &lt;- 54.5

idx &lt;- order(drc)
drc &lt;- drc[idx]
Data &lt;- HsSP[idx]
set.seed(1234)
Data &lt;- Data + runif(length(Data), -1e-4, 1e-4)

thetaVec &lt;- 1:360

thresholdExampleML &lt;- ThrSelection(Data=Data, drc=drc, h=60, b=0.35,
                                   thetaGrid=thetaVec, EVIestimator="ML",
                                   useKernel=T, concent=10, bw=30, numCores=2)$thr
</pre>

<hr>
<h2 id='thresholdExampleMom'>Threshold for local Moment examples</h2><span id='topic+thresholdExampleMom'></span>

<h3>Description</h3>

<p>A vector of threshold values at directions 1,...,360. It is used for local Moment examples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>thresholdExampleMom
</code></pre>


<h3>Format</h3>

<p>A vector of 360 values.</p>


<h3>Details</h3>

<p>It has been generated as follows: <br />  <br />
</p>
<pre>
data(HsSP)
data(drc)
timeRange &lt;- 54.5

idx &lt;- order(drc)
drc &lt;- drc[idx]
Data &lt;- HsSP[idx]
set.seed(1234)
Data &lt;- Data + runif(length(Data), -1e-4, 1e-4)

thetaVec &lt;- 1:360

thresholdExampleMom &lt;- ThrSelection(Data=Data, drc=drc, h=60, b=0.35,
                                    thetaGrid=thetaVec, EVIestimator="Mom",
                                    useKernel=T, concent=10, bw=30, numCores=2)$thr
</pre>

<hr>
<h2 id='ThrSelection'>Threshold selection</h2><span id='topic+ThrSelection'></span>

<h3>Description</h3>

<p>This function selects a moving threshold for circular data using an automatic
procedure for selecting the local number of exceedances
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ThrSelection(
  Data,
  drc,
  h = 30,
  b = 0.35,
  thetaGrid,
  EVIestimator = "ML",
  useKernel = TRUE,
  concent = 10,
  bw = 30,
  numCores = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ThrSelection_+3A_data">Data</code></td>
<td>
<p>Response variable</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_drc">drc</code></td>
<td>
<p>Directional covariate</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_h">h</code></td>
<td>
<p>Bandwidth value</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_b">b</code></td>
<td>
<p>Parameter used in the automatic procedure for selection of local
number of exceedances</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_thetagrid">thetaGrid</code></td>
<td>
<p>Grid values at which the estimation is performed</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_eviestimator">EVIestimator</code></td>
<td>
<p>It can be either &quot;ML&quot; or &quot;Mom&quot;</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_usekernel">useKernel</code></td>
<td>
<p>Logical. If TRUE (default), use kernel to assign weights
depending on the directional distance.</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_concent">concent</code></td>
<td>
<p>Concentration parameter value for von Mises kernel</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_bw">bw</code></td>
<td>
<p>Bandwidth parameter value for smoothing the sample path of the
selected threshold</p>
</td></tr>
<tr><td><code id="ThrSelection_+3A_numcores">numCores</code></td>
<td>
<p>Number of CPU cores to be used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Konzen, E., Neves, C., and Jonathan, P. (2021). Modeling nonstationary extremes of storm severity: Comparing parametric and semiparametric inference. Environmetrics, 32(4), e2667.
</p>


<h3>Value</h3>

<p>List containing the selected threshold and selected number of local
exceedances at each direction in the grid.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+PlotData">PlotData</a></code> and <code><a href="#topic+PolarPlotData">PolarPlotData</a></code> to see how
the threshold can be visualised.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HsSP)
data(drc)
timeRange &lt;- 54.5

idx &lt;- order(drc)
drc &lt;- drc[idx]
Data &lt;- HsSP[idx]
set.seed(1234)
Data &lt;- Data + runif(length(Data), -1e-4, 1e-4)

thetaVec &lt;- 1:360



thrResultMom &lt;- ThrSelection(Data=Data, drc=drc, h=60, b=0.35, thetaGrid=thetaVec,
                             EVIestimator="Mom", useKernel=T, concent=10, bw=30,
                             numCores=2)$thr
thrResultML &lt;- ThrSelection(Data=Data, drc=drc, h=60, b=0.35, thetaGrid=thetaVec,
                            EVIestimator="ML", useKernel=T, concent=10, bw=30,
                            numCores=2)$thr



## See also examples in vignettes:
# vignette("localMethods", package = "circularEV")
# vignette("splineML", package = "circularEV")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
