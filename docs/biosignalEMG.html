<!DOCTYPE html><html><head><title>Help for package biosignalEMG</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biosignalEMG}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.emg'>
<p>Coerce to an 'emg' object</p></a></li>
<li><a href='#biosignalEMG-internal'>
<p>Internal biosignalEMG functions</p></a></li>
<li><a href='#biosignalEMG-package'>
<p>Tools for Electromyogram Signals (EMG) Analysis</p></a></li>
<li><a href='#dcbiasremoval'>
<p>Remove the DC bias</p></a></li>
<li><a href='#eaemg'>
<p>Ensemble-averaged EMG</p></a></li>
<li><a href='#emg'>
<p>EMG object</p></a></li>
<li><a href='#emg95306000'>
<p>Sample EMG data from a decorticate cat</p></a></li>
<li><a href='#emg96627009'>
<p>Sample EMG data from a decorticate cat (4 channels)</p></a></li>
<li><a href='#envelope'>
<p>RMS or MA Envelope of an EMG</p></a></li>
<li><a href='#extractchannel'>
<p>Extracts a single channel from a multichannel 'emg' object</p></a></li>
<li><a href='#highpass'>
<p>Highpass filter an EMG signal</p></a></li>
<li><a href='#iemg'>
<p>Integrated EMG</p></a></li>
<li><a href='#integration'>
<p>Integration of an EMG</p></a></li>
<li><a href='#loadABF1'>
<p>Imports data in the Axon(TM) ABF format v1.0</p></a></li>
<li><a href='#lowpass'>
<p>Lowpass filter an EMG signal</p></a></li>
<li><a href='#movingaverage'>
<p>Moving average of an EMG</p></a></li>
<li><a href='#on/off detection quality measures'>
<p>Measure the quality of an automatic on/off detection</p></a></li>
<li><a href='#onoff_bonato'>
<p>Automatic on/off detection algorithm based on a double threshold scheme</p></a></li>
<li><a href='#onoff_singlethres'>
<p>Automatic on/off detection algorithm based on a simple threshold rule</p></a></li>
<li><a href='#phasestats'>
<p>local statistics of each phase on an EMG (beta)</p></a></li>
<li><a href='#print.summary.eaemg'>
<p>Shows the content of an 'eaemg' summary on the console</p></a></li>
<li><a href='#print.summary.emg'>
<p>Shows the content of an 'emg' summary on the console</p></a></li>
<li><a href='#rectification'>
<p>Full-wave and half-wave rectification of an EMG</p></a></li>
<li><a href='#syntheticemg'>
<p>Synthetic EMG</p></a></li>
<li><a href='#whitening'>
<p>Decorrelates an EMG signal</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools for Electromyogram Signals (EMG) Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-02-18</td>
</tr>
<tr>
<td>Author:</td>
<td>J.A. Guerrero, J.E. Macias-Diaz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Antonio Guerrero &lt;jaguerrero@correo.uaa.mx&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Data processing tools to compute the rectified, integrated and the averaged EMG. Routines for automatic detection of activation phases. A routine to compute and plot the ensemble average of the EMG. An EMG signal simulator for general purposes.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils, signal</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-02-18 08:00:22 UTC; antoniog</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-02-18 08:11:14 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.emg'>
Coerce to an 'emg' object
</h2><span id='topic+as.emg'></span><span id='topic+as.emg.default'></span><span id='topic+as.emg.numeric'></span><span id='topic+as.emg.matrix'></span><span id='topic+as.emg.data.frame'></span><span id='topic+is.emg'></span>

<h3>Description</h3>

<p>Functions to check if an object is an &lsquo;emg&rsquo; object, or coerce it if possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.emg(x, ...)
## Default S3 method:
as.emg(x, ...)
## S3 method for class 'numeric'
as.emg(x, ...)
## S3 method for class 'matrix'
as.emg(x, ...)
## S3 method for class 'data.frame'
as.emg(x, ...)
is.emg(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.emg_+3A_x">x</code></td>
<td>

<p>any <span class="rlang"><b>R</b></span> object.
</p>
</td></tr>
<tr><td><code id="as.emg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to methods (such as the samplingrate or the units of the <abbr><span class="acronym">EMG</span></abbr> signal).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as.emg</code> is a generic function with many methods to coerce an object to an &lsquo;emg&rsquo; object.
</p>
<p><code>is.emg</code> checks if <code>x</code> is an &lsquo;emg&rsquo; object.
</p>


<h3>Value</h3>

<p><code>as.emg</code> returns an &lsquo;emg&rsquo; object.
</p>
<p><code>is.emg</code> returns <code>TRUE</code> if its argument is an &lsquo;emg&rsquo; object (that is, has &ldquo;emg&rdquo; amongst its classes) and <code>FALSE</code> otherwise. 
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creates 1 sec. of a simulated EMG with only baseline noise
x &lt;- rnorm(1000)
# Coerce a vector into an 'emg' object
emgx &lt;- as.emg(x, sampligrate = 1000)
# Plot the data in emgx
plot(emgx, main = "Synthetic EMG noise")

# Load a data.frame with EMG data
data(emg96627009)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg96627009)
# Plot the data in x
plot(x, main = "EMG of limb muscles of decorticated cat")
</code></pre>

<hr>
<h2 id='biosignalEMG-internal'>
Internal biosignalEMG functions
</h2><span id='topic+.validchannel'></span>

<h3>Description</h3>

<p>Internal biosignalEMG functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.validchannel(data, channel)
</code></pre>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a> 
</p>

<hr>
<h2 id='biosignalEMG-package'>
Tools for Electromyogram Signals (EMG) Analysis
</h2><span id='topic+biosignalEMG-package'></span><span id='topic+biosignalEMG'></span>

<h3>Description</h3>

<p>Data processing tools to compute the rectified, integrated and the averaged <abbr><span class="acronym">EMG</span></abbr>.  Routines for automatic detection of activation phases.  A routine to compute and plot the ensemble average of the <abbr><span class="acronym">EMG</span></abbr>.  An <abbr><span class="acronym">EMG</span></abbr> signal simulator for general purposes.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> biosignalEMG</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-02-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 3)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Standard processing tools (rectification, integration, average, ensemble-average, onset/offset detection) of raw data of an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero, J.E. Macias-Diaz
</p>
<p>Maintainer: J.A. Guerrero &lt;jaguerrero@correo.uaa.mx&gt;
</p>


<h3>References</h3>

<p>Konrad P. (2005) <em>The ABC of EMG: A Practical Introduction to Kinesiological
Electromyography</em>. Version 1.0, Noraxon INC. USA 
</p>
<p>Winter D.A., Rau G., Kadefors R., Broman H., Deluca C.J. (1980) Units, Terms, and Sandards in the Reporting of
EMG Research: A Report by the AdHoc Committee of the International Society of Electrophysiology
and Kinesiology.
</p>
<p>Guerrero J.A., Macias-Diaz J.E. (2014) A computational method for the detection of activation/deactivation patterns in biological signals with three levels of electric intensity. <em>Math. Biosci.</em> <b>248</b>, 117&ndash;127.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 2))

# Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emgx, main = "Synthetic EMG")

# Full-wave rectified EMG
emgr &lt;- rectification(emgx, rtype = "fullwave")
plot(emgr, main = "Rectified EMG")

# Integration of the full-wave rectified EMG with reset points every
# 200 samples
emgi &lt;- integration(emgr, reset = TRUE, reset.criteria = "samples", vreset = 200)
plot(emgi, main = "Integrated EMG")

# MA-envelope
emgma &lt;- envelope(emgx, method = "MA", wsize = 60)
# Ensemble-averaged EMG
ea &lt;- eaemg(emgma, runs = emgx$on.off, what = 1, timenormalization = "mean", 
    scalem = 1, empirical = TRUE, level = 0.9)
plot(ea, lwd = 2, main = "Ensemble-averaged EMG")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='dcbiasremoval'>
Remove the DC bias
</h2><span id='topic+dcbiasremoval'></span>

<h3>Description</h3>

<p>Adds a constant to all samples in the <abbr><span class="acronym">EMG</span></abbr> to move the baseline noise mean in the presence of DC-offset or DC-bias. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcbiasremoval(data, channel, baseline, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcbiasremoval_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="dcbiasremoval_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="dcbiasremoval_+3A_baseline">baseline</code></td>
<td>

<p>constant to be substracted to the <abbr><span class="acronym">EMG</span></abbr> signal. If not provided, this values is set so the resulting <abbr><span class="acronym">EMG</span></abbr> has and overall mean of 0.
</p>
</td></tr>
<tr><td><code id="dcbiasremoval_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+emg">emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Creates a random vector to simulate a baseline noise with a DC-offset
x &lt;- rnorm(1000, 1, 1)
emg1 &lt;- emg(x, samplingrate = 1000, units = "mV", data.name = "")
plot(emg1, main = "Simulated EMG with a DC-offset")
abline(h = mean(emg1$values), col = "red", lwd = 2)  # Show the position of the overall mean

# Remove the baseline noise mean
emg2 &lt;- dcbiasremoval(emg1)
plot(emg2, main = "Simulated EMG with an overall zero mean")
abline(h = mean(emg2$values), col = "red", lwd = 2)  # Show the position of the overall mean

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='eaemg'>
Ensemble-averaged EMG
</h2><span id='topic+eaemg'></span><span id='topic+plot.eaemg'></span><span id='topic+print.eaemg'></span><span id='topic+summary.eaemg'></span>

<h3>Description</h3>

<p>Creates an ensemble-averaged <abbr><span class="acronym">EMG</span></abbr> associated with a cyclical activity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eaemg(data, channel, runs, what, timenormalization = c("min", "mean", "median", "max"),
   scalem = 1, empirical = TRUE, level = 0.9)

## S3 method for class 'eaemg'
plot(x, ci.lty ="dashed", ...)
## S3 method for class 'eaemg'
print(x, ...)
## S3 method for class 'eaemg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eaemg_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object, usually rectified, moving-average of a rectified <abbr><span class="acronym">EMG</span></abbr> or the computed envelope of an <abbr><span class="acronym">EMG</span></abbr>.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_runs">runs</code></td>
<td>

<p>an &lsquo;rle&rsquo; object indicating the lengths of succesive phases (active and inactive) or an atomic vector indicating in each position if the signal corresponds to a silence phase (0) or an active phase (1 or a greater integer).
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_what">what</code></td>
<td>

<p>which phases are going to be ensemble-averaged, active phases (1) or silence phases (0).
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_timenormalization">timenormalization</code></td>
<td>

<p>a string that indicates with respect to which value all phase durations should be normalized. It can be the &ldquo;min&rdquo; (default), &ldquo;mean&rdquo;, &ldquo;median&rdquo; or &ldquo;max&rdquo; duration of the phases.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_scalem">scalem</code></td>
<td>

<p>a value (&gt;=1) that controls the local detail of the ensemble.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_empirical">empirical</code></td>
<td>

<p>logical; if <code>TRUE</code> (default), the confidence intervals are computed based on the empirical quantiles; if <code>FALSE</code>, confidence intervals are computed asumming a Gaussian distribution.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_level">level</code></td>
<td>

<p>a value in <code class="reqn">[0,1]</code> indicating the confidence level.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_x">x</code>, <code id="eaemg_+3A_object">object</code></td>
<td>

<p>an &lsquo;eaemg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_ci.lty">ci.lty</code></td>
<td>

<p>line type to plot the confidence intervals.
</p>
</td></tr>
<tr><td><code id="eaemg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Ensemble-Averaged <abbr><span class="acronym">EMG</span></abbr> is usually applied to <abbr><span class="acronym">EMG</span></abbr> signals associated with cyclical activities.  In Ensemble-Averaged <abbr><span class="acronym">EMG</span></abbr> the time base for each cycle is normalized and all the profiles are averaged.  To successfully obtain the average profile, the data should be a rectified <abbr><span class="acronym">EMG</span></abbr>, the moving average of a rectified <abbr><span class="acronym">EMG</span></abbr> or the envelope of an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>
<p>The <code>runs</code> argument can be computed througth the <code>rle</code> function of a thresholded envelope (see <b>Examples</b>) or computed with an onset/offset detection algorithm (see <code><a href="#topic+onoff_singlethres">onoff_singlethres</a></code> and <code><a href="#topic+onoff_bonato">onoff_bonato</a></code>).
</p>


<h3>Value</h3>

<p>returns an object of class &lsquo;eaemg&rsquo; which is a list with components:
</p>
<table>
<tr><td><code>intervals</code></td>
<td>
<p>a matrix with three columns, each corresponding to the lower limit of the interval, the ensemble average and the upper limit of the interval.</p>
</td></tr>
<tr><td><code>empirical</code></td>
<td>
<p>the <code>empirical</code> argument</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p>the <code>level</code> argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Kumar S., Mital A. (1996) <em>Electromyography In Ergonomics</em>
Taylor &amp; Francis.
</p>
<p>Esquivel M.E., Guerrero J.A., Macias-Diaz J.E. (2010) Activity pattern detection in electroneurographic and electromyogram signals through a heteroscedastic change-point method. <em>Mathematical Biosciences</em> <b>224(2)</b> 109&ndash;117
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rectification">rectification</a></code>, <code><a href="#topic+movingaverage">movingaverage</a></code>, <code><a href="#topic+envelope">envelope</a></code>, <code><a href="#topic+onoff_singlethres">onoff_singlethres</a></code>, <code><a href="#topic+onoff_bonato">onoff_bonato</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Simulate 10 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
# MA-envelope
emgma &lt;- envelope(emgx, method = "MA", wsize = 60)
# Ensemble-averaged EMG
ea1 &lt;- eaemg(emgma, runs = rle(emgx$on.off), what = 1, timenormalization = "max", 
    scalem = 1, empirical = TRUE, level = 0.9)
plot(ea1, lwd = 2, main = "Ensemble-averaged EMG using apriori onset/offset")

# Determine the onset/offset runs using a thresholded envelope
empiricalonoff &lt;- onoff_singlethres(emgx, t = 0.05)
ea2 &lt;- eaemg(emgma, runs = empiricalonoff, what = 1, timenormalization = "max", 
    scalem = 1, empirical = TRUE, level = 0.9)
plot(ea2, lwd = 2, main = "Ensemble-averaged EMG using empirical onset/offset")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='emg'>
EMG object
</h2><span id='topic+emg'></span><span id='topic+plot.emg'></span><span id='topic+print.emg'></span><span id='topic+summary.emg'></span>

<h3>Description</h3>

<p>Creates an &lsquo;emg&rsquo; object to store an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>emg(data, samplingrate = 0, units = "", data.name = "")
## S3 method for class 'emg'
plot(x, channels = "all", samples = 0, type = "l",  timeunits = c("samples", "seconds"),
 add = FALSE, ...)
## S3 method for class 'emg'
print(x, ...)
## S3 method for class 'emg'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="emg_+3A_data">data</code></td>
<td>

<p>a vector or a matrix (one column per channel) containing the observed data.
</p>
</td></tr>
<tr><td><code id="emg_+3A_samplingrate">samplingrate</code></td>
<td>

<p>number of samples carried per second, measured in Hertz. A value of 0 indicates that this value is missing or unknown.
</p>
</td></tr>
<tr><td><code id="emg_+3A_units">units</code></td>
<td>

<p>a character vector specifying the units (usually &lsquo;mV&rsquo;) of the <abbr><span class="acronym">EMG</span></abbr> data.
</p>
</td></tr>
<tr><td><code id="emg_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
<tr><td><code id="emg_+3A_x">x</code>, <code id="emg_+3A_object">object</code></td>
<td>

<p>an object of class &lsquo;emg&rsquo;.
</p>
</td></tr>
<tr><td><code id="emg_+3A_type">type</code></td>
<td>

<p>what type of plot should be drawn. See <code><a href="graphics.html#topic+plot">plot</a></code> for details.
</p>
</td></tr>
<tr><td><code id="emg_+3A_channels">channels</code></td>
<td>

<p>channels to be considered by the procedure. Possible values: &quot;all&quot; to consider all channels in <code>data</code>,
a (vector of) character vector(s) specifying the names(s) of the channel(s) to be considered (case sensitive) or a numeric vector specifying the channels to be considered (number(s) of column(s) in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="emg_+3A_samples">samples</code></td>
<td>
<p>samples to be plotted. Possible values: 0 (all samples), an integer &lsquo;n&rsquo; (to plot the first &lsquo;n&rsquo; samples) and a vectors of 2 integers &lsquo;n1&rsquo; and &lsquo;n2&rsquo; (to plot samples from &lsquo;n1&rsquo; to &lsquo;n2&rsquo;).</p>
</td></tr>
<tr><td><code id="emg_+3A_timeunits">timeunits</code></td>
<td>

<p>a character vector specifying the units (samples or seconds) for the time axis.
</p>
</td></tr>
<tr><td><code id="emg_+3A_add">add</code></td>
<td>

<p>logical; if <code>TRUE</code> add to an already existing plot; if <code>FALSE</code> start a new plot.
</p>
</td></tr>
<tr><td><code id="emg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class &lsquo;emg&rsquo; which is a list with components:
</p>
<table>
<tr><td><code>values</code></td>
<td>
<p>a copy of <code>data</code></p>
</td></tr> 
<tr><td><code>units</code></td>
<td>
<p>the <code>units</code> argument</p>
</td></tr>
<tr><td><code>samplingrate</code></td>
<td>
<p>the <code>samplingrate</code> argument</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>the <code>data.name</code> argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Konrad P. (2005) The ABC of EMG: A Practical Introduction to Kinesiological
Electromyography. Version 1.0, Noraxon INC. USA.
</p>
<p>Winter D.A., Rau G., Kadefors R., Broman H., Deluca C.J. (1980) Units, Terms, and Sandards in the Reporting of
EMG Research: A Report by the AdHoc Committee of the International Society of Electrophysiology
and Kinesiology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iemg">iemg</a></code>, <code><a href="#topic+eaemg">eaemg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creates a random vector to simulate an EMG signal
x &lt;- rnorm(10000, 0, 1)
# Creates an 'emg' object to store x 
emg1 &lt;- emg(x, samplingrate=1000, units="mV", data.name="")

# Summarize and visualize the data 
summary(emg1)
plot(emg1, main="Simulated EMG")</code></pre>

<hr>
<h2 id='emg95306000'>
Sample EMG data from a decorticate cat
</h2><span id='topic+emg95306000'></span>

<h3>Description</h3>

<p>Activity profile of spinal motoneurons recorded during fictive motion (scratching) evoked in an immobilized decorticate cat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("emg95306000")</code></pre>


<h3>Format</h3>

<p>A data frame with 1999 observations on the following variable.
</p>

<dl>
<dt><code>emg95306000</code></dt><dd><p>a numeric vector of <abbr><span class="acronym">EMG</span></abbr> data</p>
</dd>
</dl>



<h3>Details</h3>

<p>The sampling rate of the recorded data was 1000Hz. The data is in &quot;mV&quot;.
</p>


<h3>References</h3>

<p>Esquivel M.E., Guerrero J.A., Macias-Diaz J.E. (2010) Activity pattern detection in electroneurographic and electromyogram signals through a heteroscedastic change-point method. <em>Mathematical Biosciences</em> <b>224(2)</b>, 109&ndash;117
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
data(emg95306000)
# Coerce data into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate=1000, units="mV")
plot(x, main = "EMG of limb muscles of decorticated cat")
</code></pre>

<hr>
<h2 id='emg96627009'>
Sample EMG data from a decorticate cat (4 channels)
</h2><span id='topic+emg96627009'></span>

<h3>Description</h3>

<p>Activity profiles of spinal motoneurons recorded during fictive motion (scratching) evoked in an immobilized decorticate cat.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("emg96627009")</code></pre>


<h3>Format</h3>

<p>A data frame with 31979 observations on the following 4 variables.
</p>

<dl>
<dt>&lsquo;<span class="samp">&#8288;ENG-PB&#8288;</span>&rsquo;</dt><dd><p>a numeric vector of <abbr><span class="acronym">EMG</span></abbr> data of the posterior bicep</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;ENG-GM&#8288;</span>&rsquo;</dt><dd><p>a numeric vector of <abbr><span class="acronym">EMG</span></abbr> data of the medial gastrocnemius</p>
</dd>
<dt>&lsquo;<span class="samp">&#8288;ENG-FDL&#8288;</span>&rsquo;</dt><dd><p>a numeric vector of <abbr><span class="acronym">EMG</span></abbr> data of the flexor digitorum longus</p>
</dd>
<dt><code>MOTON.</code></dt><dd><p>a numeric vector of <abbr><span class="acronym">ENG</span></abbr> data of a spinal motoneuron</p>
</dd>
</dl>



<h3>Details</h3>

<p>This object contains the data in the file &lsquo;<span class="file">emg96627009.DAT</span>&rsquo; (provided within the package) which was recorded using AxoTape(TM).
The sampling rate of the recorded data was 2500Hz. The data is in &quot;mV&quot; for all the 4 channels.
</p>


<h3>References</h3>

<p>Esquivel M.E., Guerrero J.A., Macias-Diaz J.E. (2010) Activity pattern detection in electroneurographic and electromyogram signals through a heteroscedastic change-point method. <em>Mathematical Biosciences</em> <b>224(2)</b>, 109&ndash;117
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load data
data(emg96627009)
# Coerce data into an 'emg' object
x &lt;- as.emg(emg96627009, samplingrate=2500, units="mV")
summary(x)
</code></pre>

<hr>
<h2 id='envelope'>
RMS or MA Envelope of an EMG
</h2><span id='topic+envelope'></span>

<h3>Description</h3>

<p>Computes the RMS-envelope, the MA-envelope ot the LE-envelope of an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>envelope(data, channel, method = c("MA","RMS","LE"), wsize, cutoff, n = 2, data.name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="envelope_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="envelope_+3A_method">method</code></td>
<td>

<p>a string, &quot;MA&quot; (default) for MA-envelope, &quot;RMS&quot; for the RMS-envelope and &quot;LE&quot; for the LE-envelope.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_wsize">wsize</code></td>
<td>

<p>determines the length of the moving window that is used to calculate the local averages of the data in RMS and MA envelopes.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_cutoff">cutoff</code></td>
<td>

<p>cutoff frequency in Hertz for the lowpass filter used in LE-envelope.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_n">n</code></td>
<td>

<p>filter order for the lowpass filter used in LE-envelope.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
<tr><td><code id="envelope_+3A_...">...</code></td>
<td>

<p>Optional parameters for a MA-envelope: <code>rtype</code> for a rectification. See <code><a href="#topic+rectification">rectification</a></code> for details.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MA-envelope corresponds to the moving average of the rectified <abbr><span class="acronym">EMG</span></abbr>.
</p>
<p>The RMS-envelope corresponds to the moving average of
</p>
<p style="text-align: center;"><code class="reqn">y_i=(x_i-\mu_{x})^2</code>
</p>

<p>where <code class="reqn">x_i</code> is each value of the <abbr><span class="acronym">EMG</span></abbr> signal and <code class="reqn">\mu_{x}</code> is the overall mean of the <abbr><span class="acronym">EMG</span></abbr> signal.
</p>
<p>LE-envelope or linear envelope is lowpass filtered rectified signal.
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object containing the envelope of the <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Konrad P. (2005) The ABC of EMG: A Practical Introduction to Kinesiological
Electromyography. Version 1.0, Noraxon INC. USA. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>, <code><a href="#topic+movingaverage">movingaverage</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")

# MA-envelope
emgma &lt;- envelope(emgx, method = "MA", wsize = 60)
# Superimpose the envelope on the EMG
plot(emgx, main = "MA-envelope")
plot(emgma, add = TRUE, lwd = 4, col = "red")

# RMS-envelope
emgrms &lt;- envelope(emgx, method = "RMS", wsize = 60)
# Superimpose the envelope on the EMG
plot(emgx, main = "RMS-envelope")
plot(emgrms, add = TRUE, lwd = 4, col = "red")

# RMS-envelope
emgle &lt;- envelope(emgx, method = "LE", cutoff = 10) #10Hz
# Superimpose the envelope on the EMG
plot(emgx, main = "LE-envelope")
plot(emgle, add = TRUE, lwd = 4, col = "red")

</code></pre>

<hr>
<h2 id='extractchannel'>
Extracts a single channel from a multichannel 'emg' object
</h2><span id='topic+extractchannel'></span>

<h3>Description</h3>

<p>Extracts a specific channel from a multichannel &lsquo;emg&rsquo; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractchannel(data, channel, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractchannel_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="extractchannel_+3A_channel">channel</code></td>
<td>

<p>the specific channel to be extracted.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="extractchannel_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code> (a channel name in <code>data</code>, if it exists).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>if <code>channel</code> is a single channel &lsquo;emg&rsquo; object, that single channel is returned as the output.
</p>


<h3>Value</h3>

<p>an &lsquo;emg&rsquo; object containing a single channel.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>, <code><a href="#topic+as.emg">as.emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg96627009)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg96627009)

# Extract the second channel in x
y &lt;- extractchannel(x, 2)
# Plot the data in y
plot(y, main = "Second channel of emg96627009")

# Extract the channel 'ENG-FDL' in x (third channel)
z &lt;- extractchannel(x, "ENG-FDL")
# Plot the data in z
plot(z, main = "Third channel of emg96627009")
</code></pre>

<hr>
<h2 id='highpass'>
Highpass filter an EMG signal
</h2><span id='topic+highpass'></span>

<h3>Description</h3>

<p>Highpass filter an <abbr><span class="acronym">EMG</span></abbr> signal to remove signal artifacts and baseline noise contamination.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>highpass(data, channel, cutoff = 50, n = 5, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="highpass_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="highpass_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="highpass_+3A_cutoff">cutoff</code></td>
<td>

<p>cutoff frequency in Hertz for the highpass filter. See &lsquo;Details&rsquo; for recommended values.
</p>
</td></tr>
<tr><td><code id="highpass_+3A_n">n</code></td>
<td>

<p>filter order for the highpass filter.
</p>
</td></tr>
<tr><td><code id="highpass_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This procedure performs a highpass filtering to the EMG signal in order to remove signal artifacts and baseline noise contamination (such as the DC-bias).
</p>
<p>There are various recommendations for the value of the cutoff frequency, for example 5Hz (Merletti, 1999) and 10-20Hz (Freriks et.al., 1999).
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object which contains the filtered EMG.
</p>


<h3>Note</h3>

<p>This procedure only uses a butterworth type filter of order <code>n</code>. In order to apply a different type of filter, please see the documentation of the &lsquo;signal&rsquo; package.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Merletti R. (1999) Standards for Reporting EMG data. <em>Journal of Electromyography and Kinesiology</em> <b>9(1)</b>, III-IV <a href="http://www.isek-online.org/standards_emg.html">http://www.isek-online.org/standards_emg.html</a>
</p>
<p>Freriks B., Stegeman D.F. and Hermens H.J. (1999) European Recommendations Standards for Surface Electromyography for Surface Electromyography, results of the SENIAM project. ISBN: 90-75452-14-4.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcbiasremoval">dcbiasremoval</a></code>, <code><a href="#topic+whitening">whitening</a></code>, <code><a href="#topic+lowpass">lowpass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# Filter the fourth channel in x
y &lt;- highpass(x, cutoff = 100)

# change graphical parameters to show multiple plots
op &lt;- par(mfcol = c(2, 2))

# Compute the rectified signals to see the effect of the filter
x_rect &lt;- rectification(x)
y_rect &lt;- rectification(y)

# plot the original channel, the filtered channel and the corresponding
# rectified signals
plot(x, channel = 1, main = "Original  channel")
plot(y, main = "Highpass filtered channel")
plot(x_rect, main = "Rectified  channel")
plot(y_rect, main = "Rectified highpass filtered channel")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='iemg'>
Integrated EMG
</h2><span id='topic+iemg'></span><span id='topic+print.iemg'></span><span id='topic+plot.iemg'></span><span id='topic+summary.iemg'></span><span id='topic+print.summary.iemg'></span>

<h3>Description</h3>

<p>Creates an &lsquo;iemg&rsquo; object to store an integrated <abbr><span class="acronym">EMG</span></abbr> signal.</p>


<h3>Usage</h3>

<pre><code class='language-R'>iemg(data, calliemg, resetpoints, samplingrate = 0, units = "", data.name = "")

## S3 method for class 'iemg'
print(x, ...)
## S3 method for class 'iemg'
plot(x, type = "l", timeunits = c("seconds", "samples"), reset.lty = 2, add = FALSE, ...)
## S3 method for class 'iemg'
summary(object, ...)
## S3 method for class 'summary.iemg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="iemg_+3A_data">data</code></td>
<td>

<p>an object of class &lsquo;emg&rsquo;.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_calliemg">calliemg</code></td>
<td>

<p>a matched <code><a href="#topic+integration">integration</a></code> function call.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_resetpoints">resetpoints</code></td>
<td>

<p>the index of the samples in which a reset point occur.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_samplingrate">samplingrate</code></td>
<td>

<p>number of samples carried per second, measured in Hertz. A value of 0 indicates that this value is missing or unknown.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_units">units</code></td>
<td>

<p>a character vector specifying the units (usually &quot;mV.s&quot;) of the integrated <abbr><span class="acronym">EMG</span></abbr> data.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_object">object</code></td>
<td>

<p>an object of class &lsquo;iemg&rsquo;.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_x">x</code></td>
<td>

<p>an object of class &lsquo;iemg&rsquo; or &lsquo;summary.iemg&rsquo;.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_type">type</code></td>
<td>

<p>what type of plot should be drawn. See <code><a href="graphics.html#topic+plot">plot</a></code> for details.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_timeunits">timeunits</code></td>
<td>

<p>a character vector specifying the units (samples or seconds) for the time axis.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_reset.lty">reset.lty</code></td>
<td>

<p>what type of line should be drawn to represent each reset point. See <code><a href="graphics.html#topic+lines">lines</a></code> for details.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_add">add</code></td>
<td>

<p>logical; if <code>TRUE</code> add to an already existing plot; if <code>FALSE</code> start a new plot.
</p>
</td></tr>
<tr><td><code id="iemg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns an object of class &lsquo;iemg&rsquo; which is a list with components:
</p>
<table>
<tr><td><code>values</code></td>
<td>
<p>a copy of <code>data</code></p>
</td></tr>  
<tr><td><code>call</code></td>
<td>
<p>the matched call</p>
</td></tr>  
<tr><td><code>reset.points</code></td>
<td>
<p>the <code>resetpoints</code> argument</p>
</td></tr>
<tr><td><code>units</code></td>
<td>
<p>the <code>units</code> argument</p>
</td></tr>
<tr><td><code>samplingrate</code></td>
<td>
<p>the <code>samplingrate</code> argument</p>
</td></tr>
<tr><td><code>data.name</code></td>
<td>
<p>the <code>data.name</code> argument</p>
</td></tr>
</table>


<h3>Note</h3>

<p>&lsquo;iemg&rsquo; is not intended to be called directly, but indirectly from the &lsquo;integration&rsquo; function.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Winter D.A., Rau G., Kadefors R., Broman H., Deluca C.J. (1980) Units, Terms, and Sandards in the Reporting of
EMG Research: A Report by the AdHoc Committee of the International Society of Electrophysiology
and Kinesiology.
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+integration">integration</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")

# Full-wave rectified EMG
emgr &lt;- rectification(emgx, rtype = "fullwave")

# Integration of the full-wave rectified EMG without reset points
emgi1 &lt;- integration(emgr, reset = FALSE)
print(emgi1)
plot(emgi1, main = "Integrated EMG")
summary(emgi1)
</code></pre>

<hr>
<h2 id='integration'>
Integration of an EMG
</h2><span id='topic+integration'></span>

<h3>Description</h3>

<p>Computes the integrated <abbr><span class="acronym">EMG</span></abbr>, with or without reset points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integration(data, channel, reset = FALSE, reset.criteria = c("samples", "time", "value"),
   vreset, units, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integration_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object, usually rectified, a moving averaged rectified EMG or a computed envelope of an <abbr><span class="acronym">EMG</span></abbr>.
</p>
</td></tr>
<tr><td><code id="integration_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="integration_+3A_reset">reset</code>, <code id="integration_+3A_reset.criteria">reset.criteria</code></td>
<td>

<p>if <code>reset=TRUE</code>, The integrated signal is reset to zero at a regular number of samples (<code>reset.criteria="samples"</code>), at regular intervals of time (<code>reset.criteria="time"</code>) or when a voltage level is reached (<code>reset.criteria="value"</code>).
</p>
</td></tr>
<tr><td><code id="integration_+3A_vreset">vreset</code></td>
<td>

<p>a value to determine the reset points in an <abbr><span class="acronym">EMG</span></abbr>, see <b>Details</b>.
</p>
</td></tr>
<tr><td><code id="integration_+3A_units">units</code></td>
<td>

<p>a character vector specifying the units (usually &quot;mV.s&quot;) of the integrated <abbr><span class="acronym">EMG</span></abbr> data.
</p>
</td></tr>
<tr><td><code id="integration_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>reset=FALSE</code>, the integrated <abbr><span class="acronym">EMG</span></abbr> is the cumulative sum of the values in <code>data</code>. If <code>reset=TRUE</code>, the cumulative sum is reset to zero at some points, which are determined based on the value of <code>reset.criteria</code> and <code>vreset</code>:
</p>

<ul>
<li><p><code>reset.criteria = samples</code> : reset points are located every <code>vreset</code> samples.
</p>
</li>
<li><p><code>reset.criteria = time</code> : reset points are located every <code>vreset</code> seconds.
</p>
</li>
<li><p><code>reset.criteria = value</code> : reset points appear every time a value <code>vreset</code> is reached in the cumulative sum.
</p>
</li></ul>



<h3>Value</h3>

<p>An &lsquo;iemg&rsquo; object storing the integrated <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Winter D.A., Rau G., Kadefors R., Broman H., Deluca C.J. (1980) Units, Terms, and Sandards in the Reporting of
EMG Research: A Report by the AdHoc Committee of the International Society of Electrophysiology
and Kinesiology.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+iemg">iemg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 2))

# Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emgx, main = "Synthetic EMG")

# Full-wave rectified EMG
emgr &lt;- rectification(emgx, rtype = "fullwave")

# Integration of the full-wave rectified EMG without reset points
emgi1 &lt;- integration(emgr, reset = FALSE)
plot(emgi1, main = "Integrated EMG (no reset)")

# Integration of the full-wave rectified EMG with reset points every
# 200 samples
emgi2 &lt;- integration(emgr, reset = TRUE, reset.criteria = "samples", vreset = 200)
plot(emgi2, main = "Integrated EMG (with reset)")

# Integration of the full-wave rectified EMG with a reset point each
# time the value 200 is reached
emgi3 &lt;- integration(emgr, reset = TRUE, reset.criteria = "value", vreset = 200)
plot(emgi3, main = "Integrated EMG (with reset)")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='loadABF1'>
Imports data in the Axon(TM) ABF format v1.0
</h2><span id='topic+loadABF1'></span>

<h3>Description</h3>

<p>Loads ABFv1.0 files containing data from electrophysiological recordings, as created by Axon Instruments/Molecular Devices software such as AxoTape(TM) and AxoScope(TM).</p>


<h3>Usage</h3>

<pre><code class='language-R'>loadABF1(filename, const = 0.00489615)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loadABF1_+3A_filename">filename</code></td>
<td>

<p>name of the ABF file to load. 
</p>
</td></tr>
<tr><td><code id="loadABF1_+3A_const">const</code></td>
<td>

<p>a multiplier to obtain the value represented in each datum (see &lsquo;References&rsquo;).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Loads electrophysiology data from Version 1.0 ABF files, as created by software like AxoTape and AxoScope. The routine only loads the data section and some parts of the header to know how many channels are represented in the data.
</p>


<h3>Value</h3>

<p>Returns an object of class &lsquo;emg&rsquo;.
</p>


<h3>Note</h3>

<p>To load an Axon ABFv2.x file, please use the <span class="rlang"><b>R</b></span> package <span class="pkg">abf2</span>. 
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Axon(TM) Binary File Format (ABF): User Guide. <a href="http://mdc.custhelp.com/euf/assets/software/FSP_ABFHelp_2.03.pdf">http://mdc.custhelp.com/euf/assets/software/FSP_ABFHelp_2.03.pdf</a>
</p>
<p>Half-precision floating-point format (2015, June 26). In Wikipedia, The Free Encyclopedia. Retrieved July 9, 2015, <a href="https://en.wikipedia.org/w/index.php?title=Half-precision_floating-point_format&amp;oldid=668770694">https://en.wikipedia.org/w/index.php?title=Half-precision_floating-point_format&amp;oldid=668770694</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## Local path to sample data file
path &lt;- paste(system.file("extdata", package = "biosignalEMG"), "/96627009.DAT", 
    sep = "")

## Load and show the data
emg &lt;- loadABF1(path)
plot(emg)

## End(Not run)
</code></pre>

<hr>
<h2 id='lowpass'>
Lowpass filter an EMG signal
</h2><span id='topic+lowpass'></span>

<h3>Description</h3>

<p>Lowpass filter an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lowpass(data, channel, cutoff = 50, n = 5, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lowpass_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="lowpass_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="lowpass_+3A_cutoff">cutoff</code></td>
<td>

<p>cutoff frequency in Hertz for the lowpass filter.
</p>
</td></tr>
<tr><td><code id="lowpass_+3A_n">n</code></td>
<td>

<p>filter order for the lowpass filter.
</p>
</td></tr>
<tr><td><code id="lowpass_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This procedure performs a lowpass filtering to the EMG signal with delay correction.
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object which contains the filtered EMG.
</p>


<h3>Note</h3>

<p>This procedure only uses a butterworth type filter of order <code>n</code>. In order to apply a different type of filter, please see the documentation of the &lsquo;signal&rsquo; package.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcbiasremoval">dcbiasremoval</a></code>, <code><a href="#topic+whitening">whitening</a></code>, <code><a href="#topic+highpass">highpass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This example computes the LE-envelope using the lowpass routine
# Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# Compute the rectified signal
x_rect &lt;- rectification(x)

# Filter the rectified signal
y &lt;- lowpass(x_rect, cutoff = 100)

# change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(3, 1))

# plot the original channel, the filtered channel and the 
# LE-envelope
plot(x, channel = 1, main = "Original  channel")
plot(x_rect, main = "Rectified  channel")
plot(y, main = "LE-envelope")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='movingaverage'>
Moving average of an EMG
</h2><span id='topic+movingaverage'></span>

<h3>Description</h3>

<p>Smooths an <abbr><span class="acronym">EMG</span></abbr> by taking local averages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movingaverage(data, channel, wsize, units = c("samples", "time"), data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movingaverage_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object, usually rectified.
</p>
</td></tr>
<tr><td><code id="movingaverage_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="movingaverage_+3A_wsize">wsize</code>, <code id="movingaverage_+3A_units">units</code></td>
<td>

<p>determines the length of the moving window that is used to calculate the local averages of the data.
</p>
</td></tr>
<tr><td><code id="movingaverage_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The moving average is a running average computed over a moving window over the length of the <abbr><span class="acronym">EMG</span></abbr>.  Usually, the <abbr><span class="acronym">EMG</span></abbr> signal is first rectified due that, generally, the mean value of an <abbr><span class="acronym">EMG</span></abbr> signal is zero.
</p>
<p>The window length is the double of the value of <code>wsize</code> in samples. The <code>units</code> of the window size could be in number of samples (&quot;samples&quot;) or in seconds (&quot;time&quot;). 
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object containing the moving-averaged <abbr><span class="acronym">EMG</span></abbr>. 
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Konrad P. (2005) The ABC of EMG: A Practical Introduction to Kinesiological
Electromyography. Version 1.0, Noraxon INC. USA. 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rectification">rectification</a></code>, <code><a href="stats.html#topic+filter">filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emgx, main = "Synthetic EMG")

# Compute the moving average of the rectified EMG
emgr &lt;- rectification(emgx, rtype = "fullwave")
emgma &lt;- movingaverage(emgr, wsize = 30, units = "samples")
plot(emgma, main = "Moving average of the rectified EMG")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='on+2Foff+20detection+20quality+20measures'>
Measure the quality of an automatic on/off detection
</h2><span id='topic+ANDP'></span><span id='topic+MNChPD'></span><span id='topic+PCE'></span><span id='topic+PR'></span><span id='topic+TD'></span>

<h3>Description</h3>

<p>These quantities measure different aspects of the
accuracy in the determination of activity changes of an electric
signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ANDP(b, bE)
MNChPD(b, bE)
PCE(b, bE)
PR(b, bE, t)
TD(b, bE, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="on+2B2Foff+2B20detection+2B20quality+2B20measures_+3A_b">b</code></td>
<td>

<p>reference vector (target values) indicating for each position if the datum corresponds to a silence phase (0) or an active phase (1 or a greater integer indicating the level of activation).
</p>
</td></tr>
<tr><td><code id="on+2B2Foff+2B20detection+2B20quality+2B20measures_+3A_be">bE</code></td>
<td>

<p>detected vector (output of an automatic detector) indicating for each position if the datum corresponds to a silence phase (0) or an active phase (1 or a greater integer indicating the level of activation).
</p>
</td></tr>
<tr><td><code id="on+2B2Foff+2B20detection+2B20quality+2B20measures_+3A_t">t</code></td>
<td>

<p>tolerance value (see <b>Details</b>).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These quality measures are defined as
</p>

<table>
<tr>
 <td style="text-align: left;">
ANDP</td><td style="text-align: left;"> The absolute difference of the number of detected phases and the actual number of pahses</td>
</tr>
<tr>
 <td style="text-align: left;">
MNChPD </td><td style="text-align: left;"> The mean of the distances of each detected change-point to the nearest actual change-point</td>
</tr>
<tr>
 <td style="text-align: left;">
PCE </td><td style="text-align: left;"> The percentage of incorrectly classified points (silence-activity)</td>
</tr>
<tr>
 <td style="text-align: left;">
TD </td><td style="text-align: left;"> temporal deviation</td>
</tr>
<tr>
 <td style="text-align: left;">
PR </td><td style="text-align: left;"> computes the true positive ratio (TPR) and the false positive ratio (FPR).
</td>
</tr>

</table>

<p><code>TD</code> and <code>PR</code> depends on the value of <code>t</code>, which is a tolerance for the difference between the calculated and exact changepoints.
</p>
<p>See Guerrero et.al. (2014) for details on the computation of these measures.
</p>


<h3>Value</h3>

<p>ANDP, MNChPD, PCE, TD: a numeric value.
PR: a list of two numeric values (TPR and FPR).
</p>


<h3>Note</h3>

<p>The parameter <code>t</code> should be adjusted in terms of the sampling rate of the <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Guerrero J.A., Macias-Diaz J.E. (2014) A computational method for the detection of activation/deactivation patterns in biological signals with three levels of electric intensity. <em>Math. Biosci.</em> <b>248</b>, 117&ndash;127.
</p>
<p>Pistohl T., Schmidt T.S.B., Ball T., Schulze-Bonhage A., Aertsen A., Mehring C. (2013) Grasp detection from human ECoG during natural reach-to-grasp movements. <em>PLoS ONE</em> <b>8</b>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onoff_bonato">onoff_bonato</a></code>, <code><a href="#topic+onoff_singlethres">onoff_singlethres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 10 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")

# Detect the phases of activation in emgx
b_bonato &lt;- onoff_bonato(emgx, sigma_n = 0.05, m = 10, minL = 30)
b_singlet &lt;- onoff_singlethres(emgx, t = 0.2)

# Compute the quality measures
qm_bonato &lt;- c(ANDP(b_bonato, emgx$on.off), MNChPD(b_bonato, emgx$on.off), 
    PCE(b_bonato, emgx$on.off), PR(b_bonato, emgx$on.off, t = 10), TD(b_bonato, 
        emgx$on.off, t = 10))

qm_singlet &lt;- c(ANDP(b_singlet, emgx$on.off), MNChPD(b_singlet, emgx$on.off), 
    PCE(b_singlet, emgx$on.off), PR(b_singlet, emgx$on.off, t = 10), TD(b_singlet, 
        emgx$on.off, t = 10))

res &lt;- as.matrix(cbind(qm_bonato, qm_singlet))
rownames(res) &lt;- c("ANDP", "MNChPD", "PCE", "TPR", "FPR", "TD")
print(res)
</code></pre>

<hr>
<h2 id='onoff_bonato'>
Automatic on/off detection algorithm based on a double threshold scheme
</h2><span id='topic+onoff_bonato'></span>

<h3>Description</h3>

<p>Automatic detection algorithm to determine the times at which muscles &ldquo;turn on&rdquo; (activity periods) and &ldquo;turn off&rdquo; (silence periods) in an <abbr><span class="acronym">EMG</span></abbr> signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onoff_bonato(data, channel, sigma_n, Pfa = 0.05, m = 5, r0 = 1, minL = 15, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="onoff_bonato_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_sigma_n">sigma_n</code></td>
<td>

<p>standard deviation of the baseline noise (need to be estimated).
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_pfa">Pfa</code></td>
<td>

<p>false-alarm probability (see &lsquo;Details&rsquo;).
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_m">m</code></td>
<td>

<p>number of samples observed to perform the detection.
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_r0">r0</code></td>
<td>

<p>minimum number of samples out of <code>m</code> which must be over the threshold (see Details) to detect the signal.
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_minl">minL</code></td>
<td>

<p>minimum length allowed of the detected phases.
</p>
</td></tr>
<tr><td><code id="onoff_bonato_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This technique of detection consists of selecting a initial threshold (such that the probability of false alarm is <code>Pfa</code>) and then observing <code>m</code> successive samples: if
at least <code>r0</code> out of the <code>m</code> successive samples are above the threshold the presence of the signal is acknowledged.
</p>


<h3>Value</h3>

<p>A numeric vector with values 0 (silence) and 1 (activity).
</p>


<h3>Note</h3>

<p>The default values of <code>m</code> and <code>minL</code> where choosen for a sampling rate of 500Hz.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Bonato P., D'Alessio T. and Knaflitz M. (1998) A statistical method for the measurement of muscle activation
intervals from surface myoelectric signal during gait. <em>IEEE Transactions on Biomedical Engineering</em> <b>45 (3)</b>,
287&ndash;299. ISSN 0018&ndash;9294.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onoff_singlethres">onoff_singlethres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Estimate 'sigma_n' from the last 200 samples (only baseline noise)
sigma_n &lt;- sd(tail(x$values, 200))

# Detect the phases of activation in x
b &lt;- onoff_bonato(x, sigma_n = sigma_n, m = 10, minL = 30)

# Plot 'x' and the detected phases
plot(x, main = "Sample EMG")
plot(b, type = "l", main = "Detected phases (Bonato's method)")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='onoff_singlethres'>
Automatic on/off detection algorithm based on a simple threshold rule
</h2><span id='topic+onoff_singlethres'></span>

<h3>Description</h3>

<p>Automatic detection algorithm to determine the times at which muscles &ldquo;turn on&rdquo; (activity periods) and &ldquo;turn off&rdquo; (silence periods) in an EMG signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onoff_singlethres(data, channel, eemg, t = 0.05, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="onoff_singlethres_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="onoff_singlethres_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="onoff_singlethres_+3A_eemg">eemg</code></td>
<td>

<p>an &lsquo;emg&rsquo; object containing an envelope.
</p>
</td></tr>
<tr><td><code id="onoff_singlethres_+3A_t">t</code></td>
<td>

<p>a threshold value to determine if a datum reresent activity (above the threshold) or silence (below the threshold) in a signal.
</p>
</td></tr>
<tr><td><code id="onoff_singlethres_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this procedure, on and off time estimation is determined by the times at which the envelope of the  signal (<code>eemg</code> or determined using <code>envelope</code>) exceeds a threshold. 
</p>


<h3>Value</h3>

<p>A numeric vector with values 0 (silence) and 1 (activity).
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Rose W. (2014) Electromyogram Analysis. <em>Mathematics and Signal Processing for Biomechanics</em>. <a href="http://www.udel.edu/biology/rosewc/kaap686/">http://www.udel.edu/biology/rosewc/kaap686/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+envelope">envelope</a></code>, <code><a href="#topic+onoff_bonato">onoff_bonato</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Detect the phases of activation in x
b &lt;- onoff_singlethres(x, t = 0.1)

# Plot 'x' and the detected phases
plot(x, main = "Sample EMG")
plot(b, type = "l", main = "Detected phases (single thresholding)")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='phasestats'>
local statistics of each phase on an EMG (beta)
</h2><span id='topic+phasestats'></span>

<h3>Description</h3>

<p>Computes local statistics &quot;f&quot; of each phase on an <abbr><span class="acronym">EMG</span></abbr> signal. The phases are defined by the contiguos points that have the same class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phasestats(data,class,f)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phasestats_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="phasestats_+3A_class">class</code></td>
<td>

<p>a vector that indicates the class of each point in data. 
</p>
</td></tr>
<tr><td><code id="phasestats_+3A_f">f</code></td>
<td>

<p>A function that computes the desired local statistic.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>class is usually the result of a detection step (0=not active, 1=active).
&quot;f&quot; could be the mean, standard deviaton, sum, length, etc.
</p>


<h3>Value</h3>

<p>An object storing the local statistics and the class of each value.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>None
</p>


<h3>See Also</h3>

<p><code><a href="#topic+onoff_singlethres">onoff_singlethres</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# Detect the phases of activation in x
b &lt;- onoff_singlethres(x, t = 0.1)

# Computes the length of the detected phases
plengths&lt;-phasestats(x,b,length)
plengths
# Computes the mean of the values within the detected phases
pmeans&lt;-phasestats(x,b,mean)
pmeans

# Only show the means of the active phases
pmeans$stats[names(pmeans$stats)==1]

</code></pre>

<hr>
<h2 id='print.summary.eaemg'>
Shows the content of an 'eaemg' summary on the console
</h2><span id='topic+print.summary.eaemg'></span>

<h3>Description</h3>

<p>S3 generic to show the content of an &lsquo;eaemg&rsquo; summary on the console. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.eaemg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.eaemg_+3A_x">x</code></td>
<td>

<p>an object of class &lsquo;summary.eaemg&rsquo;.
</p>
</td></tr>
<tr><td><code id="print.summary.eaemg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Some values printed on screen.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+eaemg">eaemg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 10 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
# MA-envelope
emgma &lt;- envelope(emgx, method = "MA", wsize = 60)
# Ensemble-averaged EMG
ea &lt;- eaemg(emgma, runs = rle(emgx$on.off), what = 1, timenormalization = "mean", 
    empirical = TRUE, level = 0.9)
summary(ea, lwd = 2)
</code></pre>

<hr>
<h2 id='print.summary.emg'>
Shows the content of an 'emg' summary on the console
</h2><span id='topic+print.summary.emg'></span>

<h3>Description</h3>

<p>S3 generic to show the content of an &lsquo;emg&rsquo; summary on the console. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.emg'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.emg_+3A_x">x</code></td>
<td>

<p>an object of class &lsquo;summary.emg&rsquo;.
</p>
</td></tr>
<tr><td><code id="print.summary.emg_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Some values printed on screen.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Creates a random vector to simulate an EMG signal
x &lt;- rnorm(10000, 0, 1)
# Creates an 'emg' object to store x
emg1 &lt;- emg(x, samplingrate = 1000, units = "mV", data.name = "")
# Summarize and visualize the data
summary(emg1)
</code></pre>

<hr>
<h2 id='rectification'>
Full-wave and half-wave rectification of an EMG
</h2><span id='topic+rectification'></span>

<h3>Description</h3>

<p>Obtains the full-wave or half-wave rectification of an <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rectification(data, channel, rtype = c("fullwave", "halfwave"), data.name, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rectification_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="rectification_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="rectification_+3A_rtype">rtype</code></td>
<td>

<p>a string indicating if the rectification is full-wave (&quot;fullwave&quot;, default) or half-wave (&quot;halfwave&quot;).
</p>
</td></tr>
<tr><td><code id="rectification_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
<tr><td><code id="rectification_+3A_...">...</code></td>
<td>

<p>additional arguments to be passed to the generic function.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A full-wave rectified <abbr><span class="acronym">EMG</span></abbr> is obtained by computing the absolute value of the raw signal; In half wave rectification, the positive values are passed, while the negatives values are blocked (set to zero).
</p>
<p>Rectification is mainly used as a pre-proccessing step before another process like averaging or computing the envelope of the signal.
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object which contains the rectified <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Konrad P. (2005) The ABC of EMG: A Practical Introduction to Kinesiological
Electromyography. Version 1.0, Noraxon INC. USA.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>, <code><a href="#topic+dcbiasremoval">dcbiasremoval</a></code>, <code><a href="#topic+syntheticemg">syntheticemg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(3, 1))

# Simulate 5 seconds of an EMG
emgx &lt;- syntheticemg(n.length.out = 5000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emgx, main = "Synthetic EMG")

# Full-wave rectified EMG
emgr1 &lt;- rectification(emgx, rtype = "fullwave")
plot(emgr1, main = "Full-wave rectified EMG")

# Half-wave rectified EMG
emgr2 &lt;- rectification(emgx, rtype = "halfwave")
plot(emgr2, main = "Half-wave rectified EMG")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='syntheticemg'>
Synthetic EMG
</h2><span id='topic+syntheticemg'></span>

<h3>Description</h3>

<p>Creates a synthetic <abbr><span class="acronym">EMG</span></abbr> based on a simple heteroscedastic model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350,
   on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300,
   off.duration.sd = 20, on.mode.pos = 0.75, shape.factor = 0.5,
   samplingrate = 0, units = "", data.name = "Synthetic EMG")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="syntheticemg_+3A_n.length.out">n.length.out</code></td>
<td>

<p>number of observations.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_on.sd">on.sd</code></td>
<td>

<p>Standard deviation of the random values during an active phase.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_on.duration.mean">on.duration.mean</code></td>
<td>

<p>mean lengths of active phases in number of samples.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_on.duration.sd">on.duration.sd</code></td>
<td>

<p>standard deviation of lengths of active phases in number of samples.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_off.sd">off.sd</code></td>
<td>

<p>standard deviation of the random values during an silence phase (i.e. for the baseline noise).
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_off.duration.mean">off.duration.mean</code></td>
<td>

<p>mean lengths of silence phases in number of samples.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_off.duration.sd">off.duration.sd</code></td>
<td>

<p>standard deviation of lengths of silence phases in number of samples.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_on.mode.pos">on.mode.pos</code></td>
<td>

<p>a value between 0 (beginning of the active phase) and 1 (end of the active phase) indicating the relative position in which the maximum amplitude of an active phase will be located.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_shape.factor">shape.factor</code></td>
<td>

<p>shape parameter (recommended values between 0 and 2).
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_samplingrate">samplingrate</code></td>
<td>

<p>sampling rate associated to the synthetic <abbr><span class="acronym">EMG</span></abbr>.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_units">units</code></td>
<td>

<p>units associated to the synthetic <abbr><span class="acronym">EMG</span></abbr>.
</p>
</td></tr>
<tr><td><code id="syntheticemg_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A random synthetic <abbr><span class="acronym">EMG</span></abbr> signal is generated using an heteroscedastic Gaussian model.  There are two parameters that control the amplitude of the active and silence phases (<code>on.sd</code> and <code>off.sd</code>), two that control the (random) length of the active phases (<code>on.duration.mean</code> and <code>on.duration.sd</code>), two that control the (random) length of the silence phases (<code>off.duration.mean</code> and <code>off.duration.sd</code>) and two that control the shape of the burst during an active phase (<code>on.mode.pos</code> and <code>shape.factor</code>).  A binary vector stores which samples are associated to an active phase for test purposes.
</p>


<h3>Value</h3>

<p>A derived &lsquo;emg&rsquo; object which also contains a binary vector <code>on.off</code> to indicate which samples correspond to an active phase (1) and which to a silence phase (0).
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Esquivel M.E., Guerrero J.A., Macias-Diaz J.E. (2010) Activity pattern detection in electroneurographic and electromyogram signals through a heteroscedastic change-point method. <em>Mathematical Biosciences</em> <b>224(2)</b> 109&ndash;117
</p>


<h3>See Also</h3>

<p><code><a href="#topic+emg">emg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# Simulate 10 seconds of an EMG
emg1 &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.75, shape.factor = 0.5, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emg1, main = "Synthetic EMG")

# Simulate 10 seconds of an EMG (pulse trains)
emg2 &lt;- syntheticemg(n.length.out = 10000, on.sd = 1, on.duration.mean = 350, 
    on.duration.sd = 10, off.sd = 0.05, off.duration.mean = 300, off.duration.sd = 20, 
    on.mode.pos = 0.5, shape.factor = 0, samplingrate = 1000, units = "mV", 
    data.name = "Synthetic EMG")
plot(emg2, main = "Synthetic EMG (pulse trains)")

# reset graphical parameters
par(op)
</code></pre>

<hr>
<h2 id='whitening'>
Decorrelates an EMG signal
</h2><span id='topic+whitening'></span>

<h3>Description</h3>

<p>Decorrelates an <abbr><span class="acronym">EMG</span></abbr> signal using an <abbr><span class="acronym">SVD</span></abbr> decomposition of a covariance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whitening(data, channel, method = c("PCA", "ZCA"), k = 4, r = 1, data.name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="whitening_+3A_data">data</code></td>
<td>

<p>an &lsquo;emg&rsquo; object.
</p>
</td></tr>
<tr><td><code id="whitening_+3A_channel">channel</code></td>
<td>

<p>in case of multi-channel data, <code>channel</code> is the specific channel to be considered by the procedure.  Possible values: a character vector specifying the name of the channel to be considered (case sensitive) or a numeric value specifying the channel to be considered (number of column in <code>data</code>).
</p>
</td></tr>
<tr><td><code id="whitening_+3A_method">method</code></td>
<td>

<p>the whitening method to be applied to the <abbr><span class="acronym">EMG</span></abbr> signal: &quot;PCA&quot; (default) or &quot;ZCA&quot; (see &lsquo;References&rsquo;).
</p>
</td></tr>
<tr><td><code id="whitening_+3A_k">k</code></td>
<td>

<p>number of columns (see &lsquo;Details&rsquo;) to construct the covariance matrix.
</p>
</td></tr>
<tr><td><code id="whitening_+3A_r">r</code></td>
<td>

<p>column to be used as the whitened signal (see &lsquo;Details&rsquo;).
</p>
</td></tr>
<tr><td><code id="whitening_+3A_data.name">data.name</code></td>
<td>

<p>a string specifying the name of the variable which will appears on the plots. If empty or not provided is taken from the object given as <code>data</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Whitening an <abbr><span class="acronym">EMG</span></abbr> signal is a preprocessing step that can improve amplitude estimation, onset activation detection and fecature classification.
</p>
<p>A whitening transformation reduces autocorrelation within a signal.
</p>
<p>The implemented methods are PCA and ZCA, both based on a <abbr><span class="acronym">SVD</span></abbr> decomposition of a covariance matrix.  The (artificial) matrix is constructed with k shifted versions of the <abbr><span class="acronym">EMG</span></abbr> signal.  The result is then an matrix with <code>k</code> columns. The output of the whitening procedure is (usually) the first column (<code>r=1</code>).
</p>


<h3>Value</h3>

<p>An &lsquo;emg&rsquo; object storing the whitened <abbr><span class="acronym">EMG</span></abbr>.
</p>


<h3>Note</h3>

<p>The output is not fully whitened. The method decorrelates the columns of the artificial matrix, which contains a shifted version of the signal. At the end only one column (which can be autocorrelated) is taken as the output.
Also, it works better when the sampling rate is high (low sampling rates tend to produce decorrelated samples).
</p>


<h3>Author(s)</h3>

<p>J.A. Guerrero <a href="mailto:jaguerrero@correo.uaa.mx">jaguerrero@correo.uaa.mx</a>
</p>


<h3>References</h3>

<p>Implementing PCA/Whitening <a href="http://ufldl.stanford.edu/wiki/index.php/Implementing_PCA/Whitening">http://ufldl.stanford.edu/wiki/index.php/Implementing_PCA/Whitening</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcbiasremoval">dcbiasremoval</a></code>, <code><a href="#topic+highpass">highpass</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load a data.frame with EMG data
data(emg95306000)
# Coerce a data.frame into an 'emg' object
x &lt;- as.emg(emg95306000, samplingrate = 1000, units = "mV")

# Whitening x
y &lt;- whitening(x)

# change graphical parameters to show multiple plots
op &lt;- par(mfrow = c(2, 1))

# plot the original channel and the corresponding whitened channel
plot(x, main = "Original  channel")
plot(y, main = "Whitened channel")

# reset graphical parameters
par(op)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
