<!DOCTYPE html><html lang="en"><head><title>Help for package bpca</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bpca}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bpca-package'>
<p>Biplot of Multivariate Data Based on Principal Components Analysis</p></a></li>
<li><a href='#bpca'>
<p>Biplot of Multivariate Data Based on Principal Components Analysis</p></a></li>
<li><a href='#dt.tools'>
<p>Data Tools for Multivariate</p></a></li>
<li><a href='#gabriel1971'>
<p>Percentages of households having various facilities and appliances in East</p>
Jerusalem Arab areas, by quarters of the town</a></li>
<li><a href='#gge2003'>
<p>A didactic matrix of genotypes (rows) and environments (columns)</p></a></li>
<li><a href='#marina'>
<p>Films shown at five festivals in Brazil from 2007 to 2011</p></a></li>
<li><a href='#ontario'>
<p>Ontario winter wheat (1993)</p></a></li>
<li><a href='#plot'>
<p>Biplot of Multivariate Data Based on Principal Components Analysis</p></a></li>
<li><a href='#print.xtable'>
<p>Print Method for xtable.bpca Objects</p></a></li>
<li><a href='#qbpca'>
<p>Quality of the Representation of Variables by Biplot</p></a></li>
<li><a href='#summary.bpca'>
<p>Summary Method for bpca Objects</p></a></li>
<li><a href='#var.rbf'>
<p>Projected Correlations by bpca</p></a></li>
<li><a href='#var.rdf'>
<p>Diagnostic of Projected Correlations</p></a></li>
<li><a href='#xtable.bpca'>
<p>LaTeX table of the Biplot.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>1.3-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-10-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Biplot of Multivariate Data Based on Principal Components
Analysis</td>
</tr>
<tr>
<td>Author:</td>
<td>José C. Faria [aut, cre],
  Ivan B. Allaman [aut],
  Clarice G. B. Demétrio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>José C. Faria &lt;joseclaudio.faria@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.6.0), scatterplot3d, rgl</td>
</tr>
<tr>
<td>Imports:</td>
<td>xtable</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements biplot (2d and 3d) of multivariate data based
             on principal components analysis and diagnostic tools of the quality of the reduction.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-20 10:27:42 UTC; jcfaria</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-20 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bpca-package'>
Biplot of Multivariate Data Based on Principal Components Analysis
</h2><span id='topic+bpca-package'></span>

<h3>Description</h3>

<p>Implements biplot (2d and 3d) and diagnostic tools of the quality of the reduction.
</p>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Gabriel, K. R.  (1971)
The biplot graphical display of matrices with application to principal
component analysis.
<em>Biometrika</em> <b>58</b>, 453-467.
</p>
<p>Galindo Vilardón, M. P. (1986)
Una alternativa de representación simultánea: HJ-Biplot.
<em>Qüestiió</em>, 10(1):13-23, 1986.
</p>
<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>
<p>Gower, J.C. and Hand, D. J.  (1996)
<em>Biplots</em>. Chapman &amp; Hall.
</p>
<p>Yan, B. W. and Kang, M. S. (2003)
<em>GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists</em>. CRC Press, New York, 288p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Grouping objects with different symbols and colors - 2d and 3d
##

dev.new(w=6, h=6)
oask &lt;- devAskNewPage(dev.interactive(orNone=TRUE))

## Not run: 
# 2d
plot(bpca(iris[-5]),
     var.factor=.3,
     var.cex=.7,
     obj.names=FALSE,
     obj.cex=1.5,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d static
plot(bpca(iris[-5],
          d=1:3),
     var.factor=.2,
     var.color=c('blue', 'red'),
     var.cex=1,
     obj.names=FALSE,
     obj.cex=1,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d dynamic
plot(bpca(iris[-5],
          method='hj',
          d=1:3),
     rgl.use=TRUE,
     var.col='brown',
     var.factor=.3,
     var.cex=1.2,
     obj.names=FALSE,
     obj.cex=.8,
     obj.col=c('red', 'green3', 'orange')[unclass(iris$Species)],
     simple.axes=FALSE,
     box=TRUE)

## End(Not run)

##
## New options plotting
##
plot(bpca(ontario))

# Labels for all objects
(obj.lab &lt;- paste('g',
                  1:18,
                  sep=''))

# Giving obj.labels
plot(bpca(ontario),
    obj.labels=obj.lab) 

# Evaluate an object (1 is the default)
plot(bpca(ontario),
     type='eo',
     obj.cex=1)

plot(bpca(ontario),
     type='eo',
     obj.id=7,
     obj.cex=1)

# Giving obj.labels
plot(bpca(ontario),
     type='eo',
     obj.labels=obj.lab,
     obj.id=7,
     obj.cex=1)

# The same as above
plot(bpca(ontario),
     type='eo',
     obj.labels=obj.lab,
     obj.id='g7',
     obj.cex=1)

# Evaluate a variable (1 is the default)
plot(bpca(ontario),
     type='ev',
     var.pos=2,
     var.cex=1)

plot(bpca(ontario),
     type='ev',
     var.id='E7',
     obj.labels=obj.lab,
     var.pos=1,
     var.cex=1)

# A complete plot
cl &lt;- 1:3
plot(bpca(iris[-5]),
     type='ev',
     var.id=1,
     var.fac=.3,
     obj.names=FALSE,
     obj.col=cl[unclass(iris$Species)])

legend('topleft',
       legend=levels(iris$Species),
       text.col=cl,
       pch=19,
       col=cl,
       cex=.9,
       box.lty=0)   

# Compare two objects (1 and 2 are the default)
plot(bpca(ontario),
     type='co')

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab)

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab,
     obj.id=13:14)

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab,
     obj.id=c('g7', 'g13'))

# Compare two variables
plot(bpca(ontario),
     type='cv')

# Which won where/what
plot(bpca(ontario),
     type='ww')

# Discrimitiveness vs. representativeness
plot(bpca(ontario),
     type='dv')

# Means vs. stability
plot(bpca(ontario),
     type='ms')

# Rank objects with ref. to the ideal variable 
plot(bpca(ontario),
     type='ro')

# Rank variables with ref. to the ideal object
plot(bpca(ontario),
     type='rv')

## Not run: 
plot(bpca(iris[-5]),
     type='eo',
     obj.id=42,
     obj.cex=1)

plot(bpca(iris[-5]),
     type='ev',
     var.id='Sepal.Width')

plot(bpca(iris[-5]),
     type='ev',
     var.id='Sepal.Width',
     var.factor=.3)

## End(Not run)

devAskNewPage(oask)
</code></pre>

<hr>
<h2 id='bpca'>
Biplot of Multivariate Data Based on Principal Components Analysis
</h2><span id='topic+bpca'></span><span id='topic+bpca.default'></span><span id='topic+bpca.prcomp'></span>

<h3>Description</h3>

<p>Computes biplot reduction on <code>data.frame</code>, <code>matrix</code> or
<code>prcomp</code> objects and returns a <code>bpca</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  bpca(x, ...)
  ## Default S3 method:
bpca(x,
     d=1:2,
     center=2,
     scale=TRUE,
     method=c('hj', 'sqrt', 'jk', 'gh'),
     iec=FALSE,
     var.rb=FALSE,
     var.rd=FALSE,
     limit=10, ...)
  ## S3 method for class 'prcomp'
bpca(x,
     d=1:2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bpca_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code>, <code>matrix</code> or <code>prcomp</code> object.</p>
</td></tr>
<tr><td><code id="bpca_+3A_d">d</code></td>
<td>
<p>A vector giving the first and last eigenvalue to be considered by the biplot reduction.
It can be <code>d=1:3</code> or <code>d=c(1,3)</code> for 3d biplot.
The default is <code>d=1:2</code>.</p>
</td></tr>
<tr><td><code id="bpca_+3A_center">center</code></td>
<td>
<p>Numeric.
The type of centering to be performed: <br />
&lsquo;<span class="samp">&#8288;0&#8288;</span>&rsquo; - no centering <br />
&lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo; - global-centered = <code>sweep(x, 1, mean(x))</code> <br />
&lsquo;<span class="samp">&#8288;2&#8288;</span>&rsquo; - column-centered = <code>sweep(x, 2, apply(x, 2, mean))</code> <br />
&lsquo;<span class="samp">&#8288;3&#8288;</span>&rsquo; - double-centered = <code>sweep(sweep(x, 1, apply(x, 1, mean)),
                                             2, apply(x, 2, mean)) + mean(x)</code> <br />
The default is 2.</p>
</td></tr>
<tr><td><code id="bpca_+3A_scale">scale</code></td>
<td>
<p>Logical.
A value indicating whether the variables should be
scaled to have unit variance before the analysis takes place: <br />
<code>FALSE</code> - no scale; <br />
<code>TRUE</code> - scale.</p>
</td></tr>
<tr><td><code id="bpca_+3A_method">method</code></td>
<td>
<p>A vector of character strings that indicates the method of factorization: <br />
&lsquo;<span class="samp">&#8288;hj&#8288;</span>&rsquo; - &lsquo;<span class="samp">&#8288;HJ&#8288;</span>&rsquo; (&lsquo;<span class="samp">&#8288;simetric&#8288;</span>&rsquo;, Galindo Villardón (1986)); <br />
&lsquo;<span class="samp">&#8288;sqrt&#8288;</span>&rsquo; - &lsquo;<span class="samp">&#8288;SQRT&#8288;</span>&rsquo; (&lsquo;<span class="samp">&#8288;squared root - simetric&#8288;</span>&rsquo;, Gabriel (1971)); <br />
&lsquo;<span class="samp">&#8288;jk&#8288;</span>&rsquo; - &lsquo;<span class="samp">&#8288;JK&#8288;</span>&rsquo; (&lsquo;<span class="samp">&#8288;row metric preserving&#8288;</span>&rsquo;, Gabriel (1971)); <br />
&lsquo;<span class="samp">&#8288;gh&#8288;</span>&rsquo; - &lsquo;<span class="samp">&#8288;GH&#8288;</span>&rsquo; (&lsquo;<span class="samp">&#8288;column metric preserving&#8288;</span>&rsquo;, Gabriel (1971)).</p>
</td></tr>
<tr><td><code id="bpca_+3A_iec">iec</code></td>
<td>
<p>Logical.
If <code>TRUE</code> the matrix of eigenvalues, coordinates od objects and variables will be inverted.
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="bpca_+3A_var.rb">var.rb</code></td>
<td>
<p>A logical value.
If <code>TRUE</code>, all correlation coefficients for all variables (<em>under the biplot projection</em>) will be computed.</p>
</td></tr>
<tr><td><code id="bpca_+3A_var.rd">var.rd</code></td>
<td>
<p>A logical value.
If <code>TRUE</code>, the diagnostic of the representation of variables projected by the biplot will be computed.
If <code>var.rd</code> is <code>TRUE</code> the <code>var.rb</code> parameter must be also <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="bpca_+3A_limit">limit</code></td>
<td>
<p>A vector giving the percentual limit to define poor representation of variables.</p>
</td></tr>
<tr><td><code id="bpca_+3A_...">...</code></td>
<td>
<p>Additional parameters.
It is necessary to be S3 method.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The biplot is a multivariate method for graphing row and column elements using
a single plot (Gabriel, 1971).
</p>
<p>The biplot of a matrix
</p>
<p style="text-align: center;"><code class="reqn">_{n}Y_{p}</code>
</p>

<p>projects on the same plot: <em>rows</em>
(associated with <em>n</em> objects) and <em>columns</em> (associated with
<em>p</em> variables), markers from data that forms a two-way table
(<code>data.frame</code> or <code>matrix</code> object).
The markers are computed from the singular value decomposition,
<code>svd(Y)</code>, and subsequent factorization.
</p>
<p>The <em>bi</em> refers to the kind of information contained in a data set
disposed in a two-way table. If the data are a <em>tri</em>-dimensional array
the method will be called <em>triplot</em> (not still contemplated in the bpca
package).
</p>
<p>The basic idea behind the biplot method was to add the information about the
variables to the principal component graph (Johnson &amp; Wichern, 1988).
</p>
<p>Considering the results of
</p>
<p style="text-align: center;"><code class="reqn">svd(_{n}Y_{p})</code>
</p>


<ul>
<li> <p><em>d</em>: A vector containing the singular values of Y, of length
<code>min(n, p)</code>;
</p>
</li>
<li> <p><em>u</em>: A matrix whose columns contain the left singular vectors of
Y, present if &lsquo;<span class="samp">&#8288;nu &gt; 0&#8288;</span>&rsquo;. Dimension &lsquo;<span class="samp">&#8288;c(n, nu)&#8288;</span>&rsquo;;
</p>
</li>
<li> <p><em>v</em>: A matrix whose columns contain the right singular vectors of
Y, present if &lsquo;<span class="samp">&#8288;nv &gt; 0&#8288;</span>&rsquo;. Dimension <code>c(p, nv)</code>.
</p>
</li></ul>
  
<p>and also,
</p>
<p style="text-align: center;"><code class="reqn">s^2 = diag(d)</code>
</p>

<p style="text-align: center;"><code class="reqn">n = n\_objects(Y)</code>
</p>

<p>it is possible an approximation of Y:
</p>
<p style="text-align: center;"><code class="reqn">_{n}Y_{p} \approx Y_{m} = g.h'</code>
</p>

<p>in various ways. The methods of factorization computed by the <code>bpca</code>
function are:
</p>

<ul>
<li> <p><em>HJ - simetric</em>, Galindo Villardón (1986):
</p>
<p style="text-align: center;"><code class="reqn">g = u*s^2</code>
</p>

<p style="text-align: center;"><code class="reqn">h = s^2*v'</code>
</p>

</li>
<li> <p><em>SQRT - squared root simetric</em>, Gabriel (1971):
</p>
<p style="text-align: center;"><code class="reqn">g = u*\sqrt{s^2}</code>
</p>

<p style="text-align: center;"><code class="reqn">h = \sqrt{s^2}*v'</code>
</p>

</li>
<li> <p><em>JK - row metric preserving</em>, Gabriel (1971):
</p>
<p style="text-align: center;"><code class="reqn">g = u*s^2</code>
</p>

<p style="text-align: center;"><code class="reqn">h = v'</code>
</p>

</li>
<li> <p><em>GH - column metric preserving</em>, Gabriel (1971):
</p>
<p style="text-align: center;"><code class="reqn">g = \sqrt{n-1}*u</code>
</p>

<p style="text-align: center;"><code class="reqn">h = \frac{1}{\sqrt{n-1}}*s^2*v'</code>
</p>

</li></ul>
  
<p>Considering
</p>
<p style="text-align: center;"><code class="reqn">_{n}Y_{p} \approx Y_{m}</code>
</p>

<p>it is possible to deduce that if the
rank (r) of the matrix
</p>
<p style="text-align: center;"><code class="reqn">_{n}Y_{p}</code>
</p>

<p>is bigger than &lsquo;m&rsquo;, the biplot
representation of Y will be an approximation, and accurate only in the case
of $r=m$.
</p>
<p>Due to the need of different methods of factorization, if &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; is a
<code>prcomp</code> object, the method <code>bpca.prcomp</code> will go back from the
<code>prcomp</code> function. In other words, it will regenerates, or computes, the
inverse of the <code>svd</code> decomposition of the given data
</p>
<p style="text-align: center;"><code class="reqn">_{n}Y_{p}</code>
</p>

<p>After this, it will make a call to the method <code>bpca.default</code> with the
adequate parameters.
</p>
<p>The biplot is used with many multivariate methods to display
relationships between objects, variables and the interrelationship
between objects and variables (as prevalence, importance). There are many
variations of biplots (see the references).
</p>


<h3>Value</h3>

<p>The function <code>bpca</code> returns an object of class <code>bpca.2d</code> or
<code>bpca.3d</code>. Both are <code>list</code> objects with the slots:
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>The call used.</p>
</td></tr>
<tr><td><code>eigenvalues</code></td>
<td>
<p>A vector of the eigenvalues.</p>
</td></tr>
<tr><td><code>eigenvectors</code></td>
<td>
<p>A vector of the eigenvectors.</p>
</td></tr>
<tr><td><code>numer</code></td>
<td>
<p>A vector of the number of eigenvalues considered in the
reduction.</p>
</td></tr>
<tr><td><code>importance</code></td>
<td>
<p>A matrix with the <em>general</em> and <em>partial</em>
variation explained by the reduction.</p>
</td></tr>
<tr><td><code>coord</code></td>
<td>
<p>A list with the coordinates of the two components: objects
and variables.</p>
</td></tr>
<tr><td><code>var.rb</code></td>
<td>
<p>A matrix of all correlation coefficients for all variables
under the biplot projection.</p>
</td></tr>
<tr><td><code>var.rd</code></td>
<td>
<p>A matrix of the diagnostic of the poor projection of variable
correlations by the biplot reduction.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Gabriel, K. R.  (1971)
The biplot graphical display of matrices with application to principal
component analysis.
<em>Biometrika</em> <b>58</b>, 453-467.
</p>
<p>Galindo Vilardón, M. P. (1986)
Una alternativa de representación simultánea: HJ-Biplot.
<em>Qüestiió</em>, 10(1):13-23, 1986.
</p>
<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>
<p>Gower, J.C. and Hand, D. J.  (1996)
<em>Biplots</em>. Chapman &amp; Hall.
</p>
<p>Yan, B. W. and Kang, M. S. (2003)
<em>GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists</em>. CRC Press, New York, 288p.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+biplot.prcomp">biplot.prcomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Computing and ploting a bpca object with 'graphics' package - 2d
##

bp &lt;- bpca(gabriel1971)

dev.new(w=6, h=6)
oask &lt;- devAskNewPage(dev.interactive(orNone=TRUE))
plot(bp,
     var.factor=2)

# Exploring the object 'bp' created by the function 'bpca'
class(bp)
names(bp)
str(bp)

summary(bp)
bp$call
bp$eigenval
bp$eigenvec
bp$numb
bp$import
bp$coord
bp$coord$obj
bp$coord$var
bp$var.rb
bp$var.rd

## Not run: 
##
## Example 2
## Computing and plotting a bpca object with 'scatterplot3d' package - 3d
##

bp &lt;- bpca(gabriel1971,
           d=2:4)

plot(bp,
     var.factor=3,
     xlim=c(-2,2),
     ylim=c(-2,2),
     zlim=c(-2,2))

# Exploring the object 'bp' created by the function 'bpca'
class(bp)
names(bp)
str(bp)

summary(bp)
bp$call
bp$eigenval
bp$eigenvec
bp$numb
bp$import
bp$coord
bp$coord$obj
bp$coord$var
bp$var.rb
bp$var.rd

##
## Example 3
## Computing and plotting a bpca object with 'rgl' package - 3d
##

plot(bpca(gabriel1971,
          d=1:3),
     rgl.use=TRUE,
     var.factor=2)

# Suggestion: Interact with the graphic with the mouse
# left button: press, maintain and movement it to interactive rotation;
# right button: press, maintain and movement it to interactive zoom.
# Enjoy it!

##
## Example 4
## Grouping objects with different symbols and colors - 2d and 3d
##

# 2d
plot(bpca(iris[-5]),
     var.factor=.3,
     var.cex=.7,
     obj.names=FALSE,
     obj.cex=1.5,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d static
plot(bpca(iris[-5],
          d=1:3),
     var.factor=.2,
     var.color=c('blue', 'red'),
     var.cex=1,
     obj.names=FALSE,
     obj.cex=1,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d dynamic
plot(bpca(iris[-5],
          method='hj',
          d=1:3),
     rgl.use=TRUE,
     var.col='brown',
     var.factor=.3,
     var.cex=1.2,
     obj.names=FALSE,
     obj.cex=.8,
     obj.col=c('red', 'green3', 'orange')[unclass(iris$Species)],
     simple.axes=FALSE,
     box=TRUE)

## End(Not run)

devAskNewPage(oask)       
</code></pre>

<hr>
<h2 id='dt.tools'>
Data Tools for Multivariate
</h2><span id='topic+dt.tools'></span>

<h3>Description</h3>

<p>Calculates vector variable lengths, angles between vector variables and
variable correlations from &lsquo;data.frame&rsquo; or &lsquo;matrix&rsquo; objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dt.tools(x,
           center=2,
           scale=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dt.tools_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> or <code>matrix</code> object.</p>
</td></tr>
<tr><td><code id="dt.tools_+3A_center">center</code></td>
<td>
<p>Numeric.
The type of centering to be performed: <br />
&lsquo;<span class="samp">&#8288;0&#8288;</span>&rsquo; - no centering; <br />
&lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo; - global-centered = <code>sweep(x, 1, mean(x))</code>; <br />
&lsquo;<span class="samp">&#8288;2&#8288;</span>&rsquo; - column-centered = <code>sweep(x, 2, apply(x, 2, mean))</code>; <br />
&lsquo;<span class="samp">&#8288;3&#8288;</span>&rsquo; - double-centered = <code>sweep(sweep(x, 1, apply(x, 1, mean)),
                                             2, apply(x, 2, mean)) + mean(x)</code>. <br />
The default is 2.</p>
</td></tr>
<tr><td><code id="dt.tools_+3A_scale">scale</code></td>
<td>
<p>Logical.
A value indicating whether the variables should be scaled to have unit
variance before the analysis takes place: <br />
<code>FALSE</code> - no scale; <br />
<code>TRUE</code> - scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes: vector variable lengths, angles between vector
variables and variable correlations from <code>data.frame</code> or <code>matrix</code> objects.
</p>
<p>If the data are centered (<code>center=2</code>), the correlations are the
same as those obtained by the <code>cor</code> function.
</p>


<h3>Value</h3>

<p>An <code>list</code> with the components:
</p>
<table role = "presentation">
<tr><td><code>length</code></td>
<td>
<p>A vector of the lengths.</p>
</td></tr>
<tr><td><code>angle</code></td>
<td>
<p>A matrix of the angles.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>A matrix of the observed correlations.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Computes: vector variable lengths, angles between vector variables and
## variable correlations from data.frame or matrix objects (n x p)
## n = rows (objects)
## p = columns (variables)
##

dt &lt;- dt.tools(iris,
               2)  # No numeric columns are removed in dt.tools 

# Exploring the object 'bp' created by the function 'var.tools'
class(dt)
names(dt)
str(dt)

dt$length
dt$angle
dt$r
dt

# Checking the determinations
(iris.tools &lt;- round(dt.tools(iris,
                              center=2)$r,
                     5))

(iris.obsv  &lt;- round(cor(iris[-5]),
                     5))

all(iris.tools == iris.obsv)
</code></pre>

<hr>
<h2 id='gabriel1971'>
Percentages of households having various facilities and appliances in East
Jerusalem Arab areas, by quarters of the town
</h2><span id='topic+gabriel1971'></span>

<h3>Description</h3>

<p>Percentages of households having various facilities and appliances in East
Jerusalem Arab areas, by quarters of the town. The average percentages in
each quarter indicate the standard of living of that area and the average
percentage of each facility or appliance its over-all prevalence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(gabriel1971)
</code></pre>


<h3>Format</h3>

<p>The format is:
<code style="white-space: pre;">&#8288;
    num [1:8, 1:9] 98.2 78.8 14.4 86.2 32.9 73 4.6 29.2 97.2 81 ...
    - attr(*, "dimnames")=List of 2
    ..$ : chr [1:8] "toilet" "kitchen" "bath" "eletricity" ...
    ..$ : chr [1:9] "CRISTIAN" "ARMENIAN" "JEWISH" "MOSLEM" ...
  &#8288;</code>
</p>


<h3>References</h3>

<p>Gabriel, K. R.  (1971)
The biplot graphical display of matrices with application to principal component analysis.
<em>Biometrika</em> <b>58</b>, 453-467.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## A simple example
##
data(gabriel1971)
bp &lt;- bpca(gabriel1971)

dev.new(w=6, h=6)
plot(bp,
     var.factor=2)

# Exploring the object 'bp' created by the function 'bpca'
class(bp)
names(bp)
str(bp)

summary(bp)
bp$call
bp$eigenval
bp$eigenvec
bp$numb
bp$import
bp$coord
bp$coord$obj
bp$coord$var
bp$var.rb
bp$var.rd
</code></pre>

<hr>
<h2 id='gge2003'>
A didactic matrix of genotypes (rows) and environments (columns)
</h2><span id='topic+gge2003'></span>

<h3>Description</h3>

<p>A didatic matrix of genotypes (rows) and environments (columns) proposed by
Weikai Yan and Manjit S. Kang in GGE biplot analysis: a graphical tool for
breeders, geneticists, and agronomists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(gge2003)
</code></pre>


<h3>Format</h3>

<p>The format is:
<code style="white-space: pre;">&#8288;
    num [1:4, 1:3] 20 6 -10 8 -9 12 -6 -12 6 -15 ...
    - attr(*, "dimnames")=List of 2
    ..$ : chr [1:4] "G1" "G2" "G3" "G4"
    ..$ : chr [1:3] "E1" "E2" "E3"
  &#8288;</code>
</p>


<h3>References</h3>

<p>Yan, B. W. and Kang, M. S. (2003)
<em>GGE biplot analysis : a graphical tool for breeders,
geneticists, and agronomists</em>. CRC Press, New York, 288p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example from YAN, W &amp; KANG, M.S. GGE biplot analysis : a graphical tool
## for breeders, geneticists, and agronomists
##

data(gge2003)
bp &lt;- bpca(t(gge2003), var.rb=TRUE)

as.dist(bp$var.rb)

dev.new(w=8, h=4)
op = par(no.readonly=TRUE)
par(mfrow=c(1,2))

plot(bpca(gge2003, var.pos=2),
     main='Columns as variables \n (var.pos=2)',
     var.col=1,
     obj.col=c(2:4, 2), obj.cex=.8)

plot(bpca(gge2003, var.pos=1),
     main='Rows as variables \n (var.pos=1)',
     var.col=1,
     obj.col=2:4, obj.cex=.8)

par(op)
</code></pre>

<hr>
<h2 id='marina'>
Films shown at five festivals in Brazil from 2007 to 2011
</h2><span id='topic+marina'></span>

<h3>Description</h3>

<p>A data.frame containing the films shown at five festivals in Brazil from 2007 to 2011.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(marina)
</code></pre>


<h3>Format</h3>

<p>The format is:
<code style="white-space: pre;">&#8288;
    'data.frame': 25 obs. of  6 variables:
    year: int  2011 2011 2011 2011 2011 2010 2010 2010 2010 2010 ...
    regE: Factor w/ 5 levels "CO","N","NE",..: 1 5 4 3 2 1 5 4 3 2 ...
    F   : int  84 55 63 44 25 40 54 37 49 27 ...
    D   : int  26 13 19 16 7 9 14 11 19 6 ...
    MD  : int  22 9 13 14 5 6 11 10 13 3 ...
    WD  : int  4 4 6 2 2 3 3 1 6 3 ...
    #
    # Description
    #
    year: Year in which the film was shown
    regE: Region where the film was shown
    F   : Total number of films
    D   : Number of documentaries
    MD  : Documentary directed by men
    WD  : Documentary directed by woman
  &#8288;</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(marina)

marina
</code></pre>

<hr>
<h2 id='ontario'>
Ontario winter wheat (1993)
</h2><span id='topic+ontario'></span>

<h3>Description</h3>

<p>The sample data are yields from the 1993 Ontario winter wheat (Triticum aestivum L.) performance
trials, in which 18 cultivars were tested at nine locations (Yan and Kang 2003)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(ontario)
</code></pre>


<h3>Format</h3>

<p>A data frame with 18 observations on the following 10 variables.
</p>


<h3>Source</h3>

<p>Yan W, Kang MS (2003). GGE Biplot Analysis: A Graphical Tool for Breeders, Geneticists,
and Agronomists. CRC Press, Boca Raton, FL, USA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ontario)

# 2d
plot(bpca(ontario,
          d=1:2))

# 3d
plot(bpca(ontario,
          d=1:3),
     rgl.use=TRUE)
</code></pre>

<hr>
<h2 id='plot'>
Biplot of Multivariate Data Based on Principal Components Analysis
</h2><span id='topic+plot.bpca.2d'></span><span id='topic+plot.bpca.3d'></span><span id='topic+plot.qbpca'></span>

<h3>Description</h3>

<p>These are methods for objects of class <code>bpca.2d</code>, <code>bpca.3d</code> and
<code>qbpca</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'bpca.2d'
plot(x,
     type=c('bp', 'eo', 'ev', 'co', 'cv', 'ww', 'dv', 'ms', 'ro', 'rv'),
     c.color='darkgray',
     c.lwd=1,
     c.number=5,
     c.radio=1,
     obj.id=1:2,
     var.id=1,
     base.color='red3',
     base.lty='dotted',
     proj.color='gray',
     proj.lty='dotted',
     a.color='blue',
     a.lty='solid',
     a.lwd=2,
     a.length=.1,
     ref.lines=TRUE,
     ref.color='navy',
     ref.lty='dotted',
     var.factor=1,
     var.color='red3',
     var.lty='solid',
     var.pch=20,
     var.pos=4,
     var.cex=.6,
     var.offset=.2,
     obj.factor=1,
     obj.color='black',
     obj.pch=20,
     obj.pos=4,
     obj.cex=.6,
     obj.offset=.2,
     obj.names=TRUE,
     obj.labels,
     obj.identify=FALSE,
     xlim,
     ylim,
     xlab,
     ylab, ...)

  ## S3 method for class 'bpca.3d'
plot(x,
     rgl.use=FALSE,
     ref.lines=TRUE,
     ref.color='navy',
     ref.lty=ifelse(rgl.use, NA, 'dotted'),
     clear3d=ifelse(rgl.use, TRUE, NULL),
     simple.axes=ifelse(rgl.use, TRUE, NULL),
     aspect=ifelse(rgl.use, c(1, 1, 1), NULL),
     var.factor=1,
     var.color='red3',
     var.lty=ifelse(rgl.use, NA, 'solid'),
     var.pch=ifelse(rgl.use, NULL, 20),
     var.pos=ifelse(rgl.use, 0, 4),
     var.cex=ifelse(rgl.use, .8, .6),
     var.offset=ifelse(rgl.use, NULL, .2),
     obj.color='black',
     obj.pch=ifelse(rgl.use, NULL, 20),
     obj.pos=ifelse(rgl.use, 0, 4),
     obj.cex=ifelse(rgl.use, .8, .6),
     obj.offset=ifelse(rgl.use, NULL, .2),
     obj.names=TRUE,
     obj.labels,
     obj.identify=FALSE,
     box=FALSE,
     angle=ifelse(rgl.use, NULL, 40),
     xlim,
     ylim,
     zlim,
     xlab,
     ylab,
     zlab, ...)

  ## S3 method for class 'qbpca'
plot(x,
     xlab='Index',
     ylab='r',
     pch=c(1,8),
     col=c(4,2), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>A <code>bpca.2d</code>, <code>bpca.3d</code> or <code>qbpca</code> object.</p>
</td></tr>
<tr><td><code id="plot_+3A_type">type</code></td>
<td>
<p>Type of biplot: <br />
&lsquo;<span class="samp">&#8288;bp&#8288;</span>&rsquo; - conventional biplot; <br />
&lsquo;<span class="samp">&#8288;eo&#8288;</span>&rsquo; - evaluate an object; <br />
&lsquo;<span class="samp">&#8288;ev&#8288;</span>&rsquo; - evaluate a variable; <br />
&lsquo;<span class="samp">&#8288;co&#8288;</span>&rsquo; - compare two objects; <br />
&lsquo;<span class="samp">&#8288;cv&#8288;</span>&rsquo; - compare (relationship among) variables; <br />
&lsquo;<span class="samp">&#8288;ww&#8288;</span>&rsquo; - which won where/what; <br />
&lsquo;<span class="samp">&#8288;dv&#8288;</span>&rsquo; - discrimitiveness vs. representativeness; <br />
&lsquo;<span class="samp">&#8288;ms&#8288;</span>&rsquo; - mean vs. stability; <br />
&lsquo;<span class="samp">&#8288;ro&#8288;</span>&rsquo; - rank objects with ref. to an &ldquo;ideal&rdquo; variable; <br />
&lsquo;<span class="samp">&#8288;rv&#8288;</span>&rsquo; - rank variables with ref. to an &ldquo;ideal&rdquo; object.</p>
</td></tr>
<tr><td><code id="plot_+3A_c.color">c.color</code></td>
<td>
<p>The color of circles.</p>
</td></tr>
<tr><td><code id="plot_+3A_c.lwd">c.lwd</code></td>
<td>
<p>The <code>lwd</code> of circles.</p>
</td></tr>
<tr><td><code id="plot_+3A_c.number">c.number</code></td>
<td>
<p>The number of circles.</p>
</td></tr>
<tr><td><code id="plot_+3A_c.radio">c.radio</code></td>
<td>
<p>The radio of circles.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.id">obj.id</code></td>
<td>
<p>An object(s) number(s) or name(s).
It is used with reprojctions to identify the object(s) when the <code>type</code> option is &lsquo;<span class="samp">&#8288;'eo'&#8288;</span>&rsquo; or &lsquo;<span class="samp">&#8288;'co'&#8288;</span>&rsquo;.
The default is &lsquo;<span class="samp">&#8288;1&#8288;</span>&rsquo; for &lsquo;<span class="samp">&#8288;'eo'&#8288;</span>&rsquo; and <code>1:2</code> for &lsquo;<span class="samp">&#8288;'co'&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.id">var.id</code></td>
<td>
<p>A variable number or name.
It is used with reprojections to identify the variable when the &lsquo;<span class="samp">&#8288;type&#8288;</span>&rsquo; option is <code>'ev'</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_base.color">base.color</code></td>
<td>
<p>The color for the base lines.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_base.lty">base.lty</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; for the base lines.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_proj.color">proj.color</code></td>
<td>
<p>The color for the projections lines.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_proj.lty">proj.lty</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; for the projections lines.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_a.color">a.color</code></td>
<td>
<p>The color for the arrow.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_a.lty">a.lty</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;lty&#8288;</span>&rsquo; for the arrow.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_a.lwd">a.lwd</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;lwd&#8288;</span>&rsquo; for the arrow.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_a.length">a.length</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;length&#8288;</span>&rsquo; for the arrow.
It is used only with reprojections.</p>
</td></tr>
<tr><td><code id="plot_+3A_rgl.use">rgl.use</code></td>
<td>
<p>A logical value.
If <code>TRUE</code> the 3d scatter will be done with the <code>rgl</code> environment,
in another way the <code>scatterplot3d</code> will be used.</p>
</td></tr>
<tr><td><code id="plot_+3A_ref.lines">ref.lines</code></td>
<td>
<p>A logical value.
If <code>TRUE</code>, the reference lines will be added to the biplot.</p>
</td></tr>
<tr><td><code id="plot_+3A_ref.color">ref.color</code></td>
<td>
<p>Line color for reference lines.</p>
</td></tr>
<tr><td><code id="plot_+3A_ref.lty">ref.lty</code></td>
<td>
<p>Line type of the reference lines.</p>
</td></tr>
<tr><td><code id="plot_+3A_clear3d">clear3d</code></td>
<td>
<p>A logical value.
It clears (or not) a 3d biplot before making a new one.
Used only if <code>rgl.use=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_simple.axes">simple.axes</code></td>
<td>
<p>A logical value to draw simple axes.
Used only if <code>rgl.use=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_aspect">aspect</code></td>
<td>
<p>A vector of the apparent ratios of the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;,
and &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; axes of the bounding box. Used only if <code>rgl.use=TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.factor">var.factor</code></td>
<td>
<p>Factor of expansion/reduction of length lines of the variables.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.color">var.color</code></td>
<td>
<p>A vector of colors for the variables representation.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.lty">var.lty</code></td>
<td>
<p>Line type for the variables.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.pch">var.pch</code></td>
<td>
<p>A vector of plotting symbols or characters for the variables.
If too short, the values are recycled.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.pos">var.pos</code></td>
<td>
<p>Position of labels for the variables.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.cex">var.cex</code></td>
<td>
<p>Character expansion for the variables.</p>
</td></tr>
<tr><td><code id="plot_+3A_var.offset">var.offset</code></td>
<td>
<p>The distance (in character widths) which separates the
label from identified points of variables.
Negative values are allowed.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.factor">obj.factor</code></td>
<td>
<p>Factor of expansion/reduction of length lines of the objects.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.color">obj.color</code></td>
<td>
<p>A vector of colors for the objects representation.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.pch">obj.pch</code></td>
<td>
<p>A vector of plotting symbols or characters for objects.
If too short, the values are recycled.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.pos">obj.pos</code></td>
<td>
<p>Position of labels for objects.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.cex">obj.cex</code></td>
<td>
<p>Character expansion for objects.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.offset">obj.offset</code></td>
<td>
<p>The distance (in character widths) which separates the label
from identified points of objects. Negative values are allowed.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.names">obj.names</code></td>
<td>
<p>A logical value to represent objects as spheres or points.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.identify">obj.identify</code></td>
<td>
<p>A logical value.
If <code>TRUE</code>, it is possible, in interative way, to identify the objects with the mouse.</p>
</td></tr>
<tr><td><code id="plot_+3A_obj.labels">obj.labels</code></td>
<td>
<p>A vector of labels for objects.</p>
</td></tr>
<tr><td><code id="plot_+3A_box">box</code></td>
<td>
<p>A logical value to whether to draw a box.
Used only if &lsquo;<span class="samp">&#8288;rgl.use=TRUE&#8288;</span>&rsquo;.</p>
</td></tr>
<tr><td><code id="plot_+3A_angle">angle</code></td>
<td>
<p>Angle between &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; axis (Attention: result depends on scaling).
For <code class="reqn">180 &lt; angle &lt; 360</code> the returned functions xyz.convert and points3d will not work properly.
Used only if <code>rgl.use=FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot_+3A_pch">pch</code></td>
<td>
<p>A vector of plotting symbols or characters.</p>
</td></tr>
<tr><td><code id="plot_+3A_col">col</code></td>
<td>
<p>A vector of colors.</p>
</td></tr>
<tr><td><code id="plot_+3A_xlab">xlab</code></td>
<td>
<p>A label for the &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; axis.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylab">ylab</code></td>
<td>
<p>A label for the &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; axis.</p>
</td></tr>
<tr><td><code id="plot_+3A_zlab">zlab</code></td>
<td>
<p>A label for the &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; axis (bpca.3d only).</p>
</td></tr>
<tr><td><code id="plot_+3A_xlim">xlim</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo; limits of the plot.</p>
</td></tr>
<tr><td><code id="plot_+3A_ylim">ylim</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; limits of the plot.</p>
</td></tr> 
<tr><td><code id="plot_+3A_zlim">zlim</code></td>
<td>
<p>The &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo; limits of the plot (bpca.3d only).</p>
</td></tr> 
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Other graphical parameters may also be passed as arguments to these functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A biplot aims to represent both the observations and variables
of a matrix of multivariate data on the same plot.
</p>
<p>The methods <code>plot.bpca.2d</code> draw a 2d biplot (PC1 and PC2 on axis &lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;
and &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo;, respectively). It uses the traditional graphics system.
</p>
<p>The methods <code>plot.bpca.3d</code> draw a 3d biplot (PC1, PC2 and PC3 on axis
&lsquo;<span class="samp">&#8288;x&#8288;</span>&rsquo;, &lsquo;<span class="samp">&#8288;y&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;z&#8288;</span>&rsquo;, respectively) in two ways:
</p>

<ol>
<li><p> static: It uses the package <code>scatterplot3d</code> based on
traditional graphic system. Use the parameter &lsquo;<span class="samp">&#8288;rgl.use=FALSE&#8288;</span>&rsquo; for it.
It is the default.
</p>
</li>
<li><p> dinamic: It uses the package <code>rgl</code> a 3D real-time rendering
device driver system for R. Use the parameter &lsquo;<span class="samp">&#8288;rgl.use=TRUE&#8288;</span>&rsquo; for it.
</p>
</li></ol>

<p>The method <code>qb.pca</code> draws a scatterplot of the correlations observed
(in the data) and projected (under the biplot) related to the variables.
It uses the traditional graphics system.
<code>qb.pca</code> is a simple (and graphical) measure of the quality of the biplot
reduction associated to the variables.
</p>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Gabriel, K. R. (1971)
The biplot graphical display of matrices with application to principal
component analysis.
<em>Biometrika</em> <b>58</b>, 453-467.
</p>
<p>Galindo Vilardón, M. P. (1986)
Una alternativa de representación simultánea: HJ-Biplot.
<em>Qüestiió</em>, 10(1):13-23, 1986.
</p>
<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>
<p>Gower, J.C. and Hand, D. J. (1996)
<em>Biplots</em>. Chapman &amp; Hall.
</p>
<p>Yan, B. W. and Kang, M. S. (2003)
<em>GGE biplot analysis: a graphical tool for breeders,
geneticists, and agronomists</em>. CRC Press, New York, 288p.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+biplot.prcomp">biplot.prcomp</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Computing and ploting a bpca object with 'graphics' package - 2d
##

bp &lt;- bpca(gabriel1971)

dev.new(w=6, h=6)
oask &lt;- devAskNewPage(dev.interactive(orNone=TRUE))
plot(bp,
     var.factor=2)

# Additional graphical parameters (nonsense)
plot(bpca(gabriel1971,
          meth='sqrt'),
     main='gabriel1971 - sqrt',
     sub='The graphical parameters are working fine!',
     var.factor=2,
     var.cex=.6,
     var.col=rainbow(9),
     var.pch='v',
     obj.pch='o',
     obj.cex=.5,
     obj.col=rainbow(8),
     obj.pos=1,
     obj.offset=.5)

##
## Example 2
## Computing and plotting a bpca object with 'scatterplot3d' package - 3d
##

bp &lt;- bpca(gabriel1971,
           d=1:3)

plot(bp,
     var.factor=3)

# Additional graphical parameters (nonsense)
plot(bpca(gabriel1971,
          d=1:3,
          meth='jk'),
     main='gabriel1971 - jk',
     sub='The graphical parameters are working fine!',
     var.factor=6,
     var.pch='+',
     var.cex=.6,
     var.col='green4',
     obj.pch='*',
     obj.cex=.8,
     obj.col=1:8,
     ref.lty='solid',
     ref.col='red',
     angle=70)

##
## Example 3
## Computing and plotting a bpca object with 'rgl' package - 3d
##

plot(bpca(gabriel1971,
          d=1:3),
     rgl.use=TRUE,
     var.factor=2)

# Suggestion: Interact with the graphic with the mouse
# left button: press, maintain and movement it to interactive rotation;
# right button: press, maintain and movement it to interactive zoom.
# Enjoy it!

## Not run: 
##
## Example 4
## Grouping objects with different symbols and colors - 2d and 3d
##

# 2d
plot(bpca(iris[-5]),
     var.factor=.3,
     var.cex=.7,
     obj.names=FALSE,
     obj.cex=1.5,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d static
plot(bpca(iris[-5],
          d=1:3),
     var.factor=.2,
     var.color=c('blue', 'red'),
     var.cex=1,
     obj.names=FALSE,
     obj.cex=1,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.pch=c('+', '*', '-')[unclass(iris$Species)])

# 3d dynamic
plot(bpca(iris[-5],
          method='hj',
          d=1:3),
     rgl.use=TRUE,
     var.col='brown',
     var.factor=.3,
     var.cex=1.2,
     obj.names=FALSE,
     obj.cex=.8,
     obj.col=c('red', 'green3', 'orange')[unclass(iris$Species)],
     simple.axes=FALSE, box=TRUE)

##
## Example 5
## Computing and plotting a bpca object with 'obj.identify=TRUE' parameter - 2d
##

bp &lt;- bpca(gabriel1971)

# Normal labels
if(interactive())
plot(bp,
     obj.names=FALSE,
     obj.identify=TRUE)

# Alternative labels
if(interactive())
plot(bp,
     obj.names=FALSE,
     obj.labels=c('toi', 'kit', 'bat', 'ele', 'wat', 'rad', 'tv', 'ref'),
     obj.identify=TRUE)

##
## Example 6
## Computing and plotting a bpca object with 'obj.identify=TRUE' parameter - 3d
##

bp &lt;- bpca(gabriel1971,
           d=1:3)

# Normal labels
if(interactive())
plot(bp,
     obj.names=FALSE,
     obj.identify=TRUE)

# Alternative labels
if(interactive())
plot(bp,
     obj.names=FALSE,
     obj.labels=c('toi', 'kit', 'bat', 'ele', 'wat', 'rad', 'tv', 'ref'),
     obj.identify=TRUE)

##
## New options plotting
##
plot(bpca(ontario))

# Labels for all objects
(obj.lab &lt;- paste('g',
                  1:18,
                  sep=''))

# Giving obj.labels
plot(bpca(ontario),
    obj.labels=obj.lab) 

# Evaluate an object (1 is the default)
plot(bpca(ontario),
     type='eo',
     obj.cex=1)

plot(bpca(ontario),
     type='eo',
     obj.id=7,
     obj.cex=1)

# Giving obj.labels
plot(bpca(ontario),
     type='eo',
     obj.labels=obj.lab,
     obj.id=7,
     obj.cex=1)

# The same as above
plot(bpca(ontario),
     type='eo',
     obj.labels=obj.lab,
     obj.id='g7',
     obj.cex=1)

# Evaluate a variable (1 is the default)
plot(bpca(ontario),
     type='ev',
     var.pos=2,
     var.cex=1)

plot(bpca(ontario),
     type='ev',
     var.id='E7',
     obj.labels=obj.lab,
     var.pos=1,
     var.cex=1)

# A complete plot
cl &lt;- 1:3
plot(bpca(iris[-5]),
     type='ev',
     var.id=1,
     var.fac=.3,
     obj.names=FALSE,
     obj.col=cl[unclass(iris$Species)])
legend('topleft',
       legend=levels(iris$Species),
       text.col=cl,
       pch=19,
       col=cl,
       cex=.9,
       box.lty=0)   

# Compare two objects (1 and 2 are the default)
plot(bpca(ontario), 
     type='co',
     c.radio=.4,
     c.color='blue',
     c.lwd=2)

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab,
     c.radio=.5,
     c.color='blue',
     c.lwd=2)

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab,
     obj.id=13:14)

plot(bpca(ontario),
     type='co',
     obj.labels=obj.lab,
     obj.id=c('g7', 
              'g13'))

# Compare two variables
plot(bpca(ontario),
     type='cv',
     c.number=3,
     c.radio=1.5)

# Which won where/what
plot(bpca(ontario),
     type='ww')

# Discrimitiveness vs. representativeness
plot(bpca(ontario),
     type='dv')

plot(bpca(ontario),
     type='dv',
     c.number=4,
     c.radio=1)

# Means vs. stability
plot(bpca(ontario),
     type='ms')

plot(bpca(ontario),
     type='ms',
     c.number=3)

# Rank objects with ref. to the ideal variable 
plot(bpca(ontario),
     type='ro')

plot(bpca(ontario),
     type='ro',
     c.number=6,
     c.radio=.5)

# Rank variables with ref. to the ideal object
plot(bpca(ontario),
     type='rv')

plot(bpca(ontario),
     type='rv',
     c.number=6,
     c.radio=.5)

plot(bpca(iris[-5]),
     type='eo',
     obj.id=42,
     obj.cex=1)

plot(bpca(iris[-5]),
     type='ev',
     var.id='Sepal.Width')

plot(bpca(iris[-5]),
     type='ev',
     var.id='Sepal.Width',
     var.factor=.3)

## End(Not run)

devAskNewPage(oask)
</code></pre>

<hr>
<h2 id='print.xtable'>
Print Method for xtable.bpca Objects
</h2><span id='topic+print.xtable'></span><span id='topic+print.xtable.bpca'></span><span id='topic+print.xtable.default'></span>

<h3>Description</h3>

<p>Returns (and prints) a summary list for <code>xtable.bpca</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'xtable.bpca'
print(x, 
      hline.after = getOption("xtable.hline.after", NULL), 
      include.colnames = getOption("xtable.include.colnames", FALSE), 
      add.to.row = getOption("xtable.add.to.row", NULL), 
      sanitize.text.function = getOption("xtable.sanitize.text.function", NULL),
      sanitize.rownames.function = getOption("xtable.sanitize.rownames.function", 
                                             sanitize.text.function), 
      sanitize.colnames.function = getOption("xtable.sanitize.rownames.function", 
                                             sanitize.text.function),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.xtable_+3A_x">x</code></td>
<td>
<p>A given object of the class <code>xtable</code> or <code>xtable.bpca</code>.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_hline.after">hline.after</code></td>
<td>
<p>When type=&quot;latex&quot;, a vector of numbers between -1 and nrow(x), 
inclusive, indicating the rows after which a horizontal line should appear.
Default value is NULL which means draw a line before and after the columns names, 
draw a line before variables and at the end of the table.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_include.colnames">include.colnames</code></td>
<td>
<p>If TRUE the columns names are printed.
Default value is FALSE which means a column more elaborate was done.</p>
</td></tr> 
<tr><td><code id="print.xtable_+3A_add.to.row">add.to.row</code></td>
<td>
<p>A list of two components. The first component (which should be called 'pos') 
is a list that contains the position of rows on which extra commands should be added at the end.
The second component (which should be called 'command') is a character vector of the same length
as the first component, which contains the command that should be added at the end of the specified rows. 
Default value is NULL.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_sanitize.text.function">sanitize.text.function</code></td>
<td>
<p>All non-numeric entries (except row and column names) are sanitized 
in an attempt to remove characters which have special meaning for the output format. 
If sanitize.text.function is not NULL, it should be a function taking a character vector and returning one,
and will be used for the sanitization instead of the default internal function. Default value is NULL.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_sanitize.rownames.function">sanitize.rownames.function</code></td>
<td>
<p>Like the sanitize.text.function, but applicable to row names. 
The default uses the sanitize.text.function.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_sanitize.colnames.function">sanitize.colnames.function</code></td>
<td>
<p>Like the sanitize.text.function, but applicable to column names. 
The default uses the sanitize.text.function.</p>
</td></tr>
<tr><td><code id="print.xtable_+3A_...">...</code></td>
<td>
<p>Other arguments of the print.xtable function (see xtable package).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xtable.bpca">xtable.bpca</a></code>; <code>xtable</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example 1: Principal labels in portuguese
library(xtable)

bp2 &lt;- bpca(gabriel1971)  
tbl &lt;- xtable(bp2)
rownames(tbl) &lt;- gsub('Eigenvectors','Autovetores',rownames(tbl))
rownames(tbl) &lt;- c(rownames(tbl)[1:9],'Autovalores','Variância retida','Variância acumulada')
dimnames(tbl)[[2]] &lt;- c('CP 1','CP 2')

print(tbl)

## Example 2: With bold in the column  
tbl1 &lt;- xtable(bp2)
bold &lt;- function(x){
  paste('\textbf{',
        x, 
        '}')
}

print(tbl1,
      sanitize.colnames.function = bold)

# Example 3: With italic in the rows
tbl2 &lt;- xtable(bp2)
italic &lt;- function(x){
  paste('&amp; \textit{',
        x, 
        '}')
} # It is necessary the character "&amp;" to adapt the number of column of the table!

print(tbl2,
      sanitize.rownames.function = italic)

</code></pre>

<hr>
<h2 id='qbpca'>
Quality of the Representation of Variables by Biplot
</h2><span id='topic+qbpca'></span>

<h3>Description</h3>

<p>This function returns an object of the class <code>qbpca</code>. It is a simple
measure of the quality of biplot representation of the variables. The
observed (in the data) and projected (under biplot reduction) correlations
are computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  qbpca(x,
        bpca)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qbpca_+3A_x">x</code></td>
<td>
<p>A <code>data.frame</code> or <code>matrix</code> object.</p>
</td></tr>
<tr><td><code id="qbpca_+3A_bpca">bpca</code></td>
<td>
<p>A object of the class <code><a href="#topic+bpca">bpca</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function binds the vectors of observed (from the matrix or data.frame)
and projected (under biplot reduction) correlations for all variables.
</p>


<h3>Value</h3>

<p>An object of class <code>qbpca</code> and <code>data.frame</code> with two columns:
</p>
<table role = "presentation">
<tr><td><code>obs</code></td>
<td>
<p>A vector of the observed correlations for all variables.</p>
</td></tr>
<tr><td><code>var.rb</code></td>
<td>
<p>A vector of the projected correlations for all variables
determined under biplot reduction).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Example of 'var.rb=TRUE' parameter as a measure of the quality of the biplot - 2d
##

oask &lt;- devAskNewPage(dev.interactive(orNone=TRUE))

## Differences between methods of factorization
# SQRT
bp1 &lt;- bpca(gabriel1971,
            meth='sqrt',
            var.rb=TRUE)

qbp1 &lt;- qbpca(gabriel1971,
              bp1)

plot(qbp1,
     main='sqrt - 2d \n (poor)')


# JK
bp2 &lt;- bpca(gabriel1971,
            meth='jk',
            var.rb=TRUE)

qbp2 &lt;- qbpca(gabriel1971,
              bp2)

plot(qbp2,
     main='jk - 2d \n (very poor)')


# GH
bp3 &lt;- bpca(gabriel1971,
            meth='gh',
            var.rb=TRUE)

qbp3 &lt;- qbpca(gabriel1971,
              bp3)

plot(qbp3,
     main='gh - 2d \n (good)')


# HJ
bp4 &lt;- bpca(gabriel1971,
            meth='hj',
            var.rb=TRUE)

qbp4 &lt;- qbpca(gabriel1971,
             bp4)

plot(qbp4,
     main='hj - 2d \n (good)')

##
## Example 2
## Example of 'var.rb=TRUE' parameter as a measure of the quality of the biplot - 3d
##

## Differences between methods of factorization
# SQRT
bp1 &lt;- bpca(gabriel1971,
            meth='sqrt',
            d=1:3,
            var.rb=TRUE)

qbp1 &lt;- qbpca(gabriel1971,
              bp1)

plot(qbp1,
     main='sqrt - 3d \n (poor)')


# JK
bp2 &lt;- bpca(gabriel1971,
            meth='jk',
            d=1:3,
            var.rb=TRUE)

qbp2 &lt;- qbpca(gabriel1971,
             bp2)

plot(qbp2,
     main='jk - 3d \n (very poor)')


# GH
bp3 &lt;- bpca(gabriel1971,
            meth='gh',
            d=1:3,
            var.rb=TRUE)

qbp3 &lt;- qbpca(gabriel1971,
              bp3)

plot(qbp3,
     main='gh - 3d \n (whow!)')


# HJ
bp4 &lt;- bpca(gabriel1971,
            meth='hj',
            d=1:3,
            var.rb=TRUE)

qbp4 &lt;- qbpca(gabriel1971,
              bp4)

plot(qbp4,
     main='hj - 3d \n (whow!)')

devAskNewPage(oask)  
</code></pre>

<hr>
<h2 id='summary.bpca'>
Summary Method for bpca Objects
</h2><span id='topic+summary.bpca'></span>

<h3>Description</h3>

<p>Returns (and prints) a summary list for <code>bpca</code> (<code>bpca.2d</code> and 
<code>bpca.3d</code>) objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'bpca'
summary(object,
        presentation=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.bpca_+3A_object">object</code></td>
<td>
<p>A given object of the class <code>bpca</code>, (<code>bpca.2d</code> or <code>bpca.3d</code>).</p>
</td></tr>
<tr><td><code id="summary.bpca_+3A_presentation">presentation</code></td>
<td>
<p>Logic.
If <code>TRUE</code> the summary of the class <code>bpca</code>, (<code>bpca.2d</code>, <code>bpca.3d</code> is showed well formated in the screen, else, return a list.
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="summary.bpca_+3A_...">...</code></td>
<td>
<p>Potential further arguments (require by generic).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code>,
<code><a href="#topic+xtable.bpca">xtable.bpca</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## bpca - 2d
##
# bpca
bp &lt;- bpca(gabriel1971)
summary(bp)
summary(bp,
        presentation=TRUE)

##
## Example 2
## bpca - 3d
##
bp &lt;- bpca(gabriel1971,
           d=1:3)

# bpca
sm &lt;- summary(bp)
str(sm)
sm
summary(bp,
        presentation=TRUE)
</code></pre>

<hr>
<h2 id='var.rbf'>
Projected Correlations by bpca
</h2><span id='topic+var.rbf'></span>

<h3>Description</h3>

<p>Computes the matrix of graphical correlations represented by biplot
for a matrix of variable coordinates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  var.rbf(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var.rbf_+3A_x">x</code></td>
<td>
<p>A given object of the classes &lsquo;<span class="samp">&#8288;bpca.2d&#8288;</span>&rsquo; and &lsquo;<span class="samp">&#8288;bpca.3d&#8288;</span>&rsquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> of graphical correlations represented by biplot.
</p>


<h3>Note</h3>

<p>This function is mainly for internal use in the <span class="pkg">bpca</span> package,
and may not remain available (unless we see a good reason).
</p>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Particular use
##

bp1 &lt;- bpca(gabriel1971)
bp1$var.rb # NA

# Computes the correlations of all variables under the biplot projection
(res &lt;- var.rbf(bp1$coord$var)) 

##
## Common use
##

bp2 &lt;- bpca(gabriel1971,
            var.rb=TRUE)

bp2$var.rb
</code></pre>

<hr>
<h2 id='var.rdf'>
Diagnostic of Projected Correlations
</h2><span id='topic+var.rdf'></span>

<h3>Description</h3>

<p>Computes the diagnostic of poor graphical correlations projected by biplot
according to an arbitrary &lsquo;<span class="samp">&#8288;limit&#8288;</span>&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  var.rdf(x,
          var.rb,
          limit)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="var.rdf_+3A_x">x</code></td>
<td>
<p>A given object of the classe <code>data.frame</code> or <code>matrix</code>.</p>
</td></tr>
<tr><td><code id="var.rdf_+3A_var.rb">var.rb</code></td>
<td>
<p>A given object of the class <code>matrix</code> with the projected correlations by biplot.</p>
</td></tr>
<tr><td><code id="var.rdf_+3A_limit">limit</code></td>
<td>
<p>A vector giving the percentual limit to define poor representation of variables.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> of poor graphical correlations projected by biplot.
</p>


<h3>Note</h3>

<p>This function is mainly for internal use in the <span class="pkg">bpca</span> package,
and may not remain available (unless we see a good reason).
</p>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>##
## Example 1
## Diagnostic of gabriel1971 dataset representation
##

oask &lt;- devAskNewPage(dev.interactive(orNone=TRUE))

bp1 &lt;- bpca(gabriel1971,
            meth='hj',
            var.rb=TRUE)

(res &lt;- var.rdf(gabriel1971,
                bp1$var.rb,
                lim=3))
class(res)

##
## Example 2
## Diagnostic of gabriel1971 dataset representation with var.rd parameter
##

bp2 &lt;- bpca(gabriel1971,
            meth='hj',
            var.rb=TRUE,
            var.rd=TRUE,
            limit=3)

plot(bp2,
     var.factor=2)

bp2$var.rd

bp2$eigenvectors

# Graphical visualization of the importance of the variables not contemplated
# in the reduction
plot(bpca(gabriel1971,
          meth='hj',
          d=3:4),
     main='hj',
     xlim=c(-1,1),
     ylim=c(-1,1))

# Interpretation:
# RUR followed by CRISTIAN contains information dimensions that
# wasn't contemplated by the biplot reduction (PC3).
# Between all, RUR followed by CRISTIAN, variables are the most poor represented
# by a 2d biplot.

## Not run: 
##
## Example 3
## Diagnostic of iris dataset representation with var.rd parameter
##

bp3 &lt;- bpca(iris[-5],
            var.rb=TRUE,
            var.rd=TRUE,
            limit=3)

plot(bp3,
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     var.factor=.3)

bp3$var.rd
bp3$eigenvectors

# Graphical diagnostic
plot(bpca(iris[-5],
          d=3:4),
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.names=FALSE,
     var.factor=.6,
     xlim=c(-2,3),
     ylim=c(-1,1))

# Interpretation:
# Sepal.length followed by Petal.Width contains information in dimensions
# (PC3 - the PC3 is, essentially, a contrast among both) that wasn't fully
# contemplated by the biplot reduction (PC1 and PC2) .
# Therefore, between all variables, they have the most poor representation by a
# 2d biplot.

bp4 &lt;- bpca(iris[-5],
            d=1:3,
            var.rb=TRUE,
            var.rd=TRUE,
            limit=2)

plot(bp4,
     obj.names=FALSE,
     obj.pch=c('+', '-', '*')[unclass(iris$Species)],
     obj.col=c('red', 'green3', 'blue')[unclass(iris$Species)],
     obj.cex=1,
     xlim=c(-5,5),
     ylim=c(-5,5),
     zlim=c(-5,5),
     var.factor=.5)

bp4$var.rd
bp4$eigenvectors

round(bp3$var.rb, 2)

round(cor(iris[-5]), 2)

# Good representation of all variables with a 3d biplot!

## End(Not run)

devAskNewPage(oask)
</code></pre>

<hr>
<h2 id='xtable.bpca'>
LaTeX table of the Biplot.
</h2><span id='topic+xtable.bpca'></span>

<h3>Description</h3>

<p>This function returns a LaTeX table of the bpca objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bpca'
xtable(x,
       caption = NULL,
       label = NULL,
       align = NULL,
       digits = NULL,
       display = NULL,
       auto = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xtable.bpca_+3A_x">x</code></td>
<td>
<p>A object of the class <code><a href="#topic+bpca">bpca</a></code> objects.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_caption">caption</code></td>
<td>
<p>Character vector of length 1 or 2 containing the table's
caption or title. If length is 2, the second item is the &quot;short
caption&quot; used when LaTeX generates a &quot;List of Tables&quot;.
Set to NULL to suppress the caption. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_label">label</code></td>
<td>
<p>Character vector of length 1 containing the
LaTeX &lsquo;<span class="samp">&#8288;\label&#8288;</span>&rsquo; or HTML anchor. Set to <code>NULL</code> to suppress
the label. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_align">align</code></td>
<td>
<p>Character vector of length equal to the number of columns of
the resulting table, indicating the alignment of the corresponding
columns. Also, &quot;|&quot; may be used to produce vertical lines between
columns in LaTeX tables, but these are effectively ignored when
considering the required length of the supplied vector.
If a character vector of length one is supplied, it is split as
strsplit(align, &quot;&quot;)[[1]] before processing. Since the row names
are printed in the first column, the length of align is one greater
than ncol(x) if x is a data.frame. Use &quot;l&quot;, &quot;r&quot;, and &quot;c&quot; to denote
left, right, and center alignment, respectively. for a LaTeX column
of the specified width. For HTML output the &quot;p&quot; alignment is interpreted
as &quot;l&quot;, ignoring the width request.
Default depends on the class of x.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_digits">digits</code></td>
<td>
<p>Numeric vector of length equal to one (in which case it
will be replicated as necessary) or to the number of columns of
the resulting <code>table</code> or <code>matrix</code> of the same size as
the resulting table, indicating the number of digits to display
in the corresponding columns. Since the row names are printed
in the first column, the length of the vector digits or the number
of columns of the matrix digits is one greater than ncol(x) if x
is a <code>data.frame</code>. Default depends on the class of x.
If values of digits are negative, the corresponding values of x
are displayed in scientific format with abs(digits) digits.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_display">display</code></td>
<td>
<p>Character vector of length equal to the number of columns
of the resulting table, indicating the format for the corresponding
columns. Since the row names are printed in the first column, the
length of display is one greater than ncol(x) if x is a data.frame.
These values are passed to the formatC function. Use &quot;d&quot; (for integers),
&quot;f&quot;, &quot;e&quot;, &quot;E&quot;, &quot;g&quot;, &quot;G&quot;, &quot;fg&quot; (for reals), or &quot;s&quot; (for strings).
&quot;f&quot; gives numbers in the usual xxx.xxx format; &quot;e&quot; and &quot;E&quot; give
n.ddde+nn or n.dddE+nn (scientific format); &quot;g&quot; and &quot;G&quot; put x[i] into
scientific format only if it saves space to do so. &quot;fg&quot; uses fixed
format as &quot;f&quot;, but digits as number of significant digits. Note that
this can lead to quite long result strings.
Default depends on the class of x.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_auto">auto</code></td>
<td>
<p>Logical, indicating whether to apply automatic format when no
value is passed to align, digits, or display. This autoformat
(based on xalign, xdigits, and xdisplay) can be useful to quickly
format a typical <code>matrix</code> or <code>data.frame</code>.
Default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="xtable.bpca_+3A_...">...</code></td>
<td>
<p>Additional arguments. (Currently ignored.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function extracts tabular information from x and returns an object of class &quot;xtable.bpca&quot;, &quot;xtable&quot; or &quot;data.frame&quot;. 
</p>
<p>It is necessary to declare the latex packages: &lsquo;<span class="samp">&#8288;multirow&#8288;</span>&rsquo; in the preamble of the Rnoweb file to make available all the 
resources of the function <code>xtable.bpca</code>.
</p>


<h3>Value</h3>

<p>An object of the class <code>xtable.bpca</code>.
</p>


<h3>Author(s)</h3>

<p>Faria, J. C. <br />
Allaman, I. B. <br />
Demétrio C. G. B.
</p>


<h3>References</h3>

<p>Johnson, R. A. and Wichern, D. W. (1988)
<em>Applied multivariate statistical analysis</em>.
Prentice-Hall, Inc., Upper Saddle River, NJ, USA, 6 ed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bpca">bpca</a></code>,
<code><a href="xtable.html#topic+xtable">xtable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1: The simplest possible 
library(xtable)

bp &lt;- bpca(iris[-5],
           d=1:3)

xtable(bp)

## Example 2: With caption and label 
bp2 &lt;- bpca(gabriel1971) 

xtable(bp2,
       caption='Biplot gabriel1971',
       label='example_2')
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
