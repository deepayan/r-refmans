<!DOCTYPE html><html><head><title>Help for package IBMPopSim</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IBMPopSim}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_characteristic'><p>Generic method for add_characteristic</p></a></li>
<li><a href='#add_characteristic.population'><p>Add characteristic to a population</p></a></li>
<li><a href='#age_pyramid'><p>Generic method for age_pyramid</p></a></li>
<li><a href='#age_pyramid.population'><p>Age pyramid from a population at a given time.</p></a></li>
<li><a href='#age_pyramids'><p>Generic method for age_pyramids</p></a></li>
<li><a href='#age_pyramids.population'><p>Age pyramid from a population data frame at some given times.</p></a></li>
<li><a href='#assertCharacteristics'><p>Function for internal use</p></a></li>
<li><a href='#assertEvents'><p>Function for internal use</p></a></li>
<li><a href='#assertParameters'><p>Function for internal use</p></a></li>
<li><a href='#assertPopulation'><p>Function for internal use</p></a></li>
<li><a href='#assertPyramid'><p>Function for internal use</p></a></li>
<li><a href='#capitalize'><p>Function for internal use</p></a></li>
<li><a href='#check_intensity_code'><p>Check the intensity code.</p></a></li>
<li><a href='#check_interaction_code'><p>Check the interaction code.</p></a></li>
<li><a href='#check_kernel_code'><p>Check the kernel code.</p></a></li>
<li><a href='#compatibility_chars_events'><p>Check characteristics-events compatibility</p></a></li>
<li><a href='#compatibility_pop_model'><p>Check population-model compatibility</p></a></li>
<li><a href='#death_table'><p>Death table</p></a></li>
<li><a href='#details_cpp'><p>Autogenerate cpp details documentation</p></a></li>
<li><a href='#details_intensity_code'><p>Autogenerated documentation for intensity code</p></a></li>
<li><a href='#details_interaction_code'><p>Autogenerated documentation for interaction code</p></a></li>
<li><a href='#details_kernel_code'><p>Autogenerated documentation for kernel code</p></a></li>
<li><a href='#details_type_event'><p>Autogenerated documentation for event type</p></a></li>
<li><a href='#EW_pop_14'><p>England and Wales (EW) 2014 population, death and birth rates.</p></a></li>
<li><a href='#EW_pop_out'><p>Example of &quot;human population&quot; after 100 years of simulation.</p></a></li>
<li><a href='#EW_popIMD_14'><p>England and Wales (EW) 2014 population and death rates by Index of Multiple Deprivation (IMD).</p></a></li>
<li><a href='#EWdata_hmd'><p>England and Wale mortality data (source: Human Mortality Database)</p></a></li>
<li><a href='#exposure_table'><p>Exposure table</p></a></li>
<li><a href='#get_characteristics'><p>Generic method for get_characteristics</p></a></li>
<li><a href='#get_characteristics.population'><p>Returns names and C types of the characteristics.</p></a></li>
<li><a href='#get_Ctype'><p>Function for internal use</p></a></li>
<li><a href='#get_Rtype'><p>Function for internal use</p></a></li>
<li><a href='#gompertz'><p>Gompertz–Makeham intensity function.</p></a></li>
<li><a href='#has_event_type'><p>Search for a given string in event types</p></a></li>
<li><a href='#id_complete'><p>Complete a population id</p></a></li>
<li><a href='#linfun'><p>Linear interpolation function.</p></a></li>
<li><a href='#max.stepfun'><p>Returns the maximum of a function of class <code>stepfun</code>.</p></a></li>
<li><a href='#merge_pop_withid'><p>A function returning a merged dataframe from a list of population dataframes with id.</p></a></li>
<li><a href='#mk_event_individual'><p>Creating an event with intensity of class individual</p></a></li>
<li><a href='#mk_event_inhomogeneous_poisson'><p>Creating inhomogeneous Poisson class event</p></a></li>
<li><a href='#mk_event_interaction'><p>Creating an event with intensity of type interaction</p></a></li>
<li><a href='#mk_event_poisson'><p>Creating Poisson class event</p></a></li>
<li><a href='#mk_individual_type'><p>Function for internal use</p></a></li>
<li><a href='#mk_model'><p>Creates a model for IBMPopSim.</p></a></li>
<li><a href='#mk_parameters_types'><p>Extract types (R and C++) of the parameters</p></a></li>
<li><a href='#mkcpp_declaration_individual'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_definition_events'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_event'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_initialisation_population'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_output_population'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_parameters'><p>Function for internal use</p></a></li>
<li><a href='#mkcpp_popsim'><p>Function for internal use</p></a></li>
<li><a href='#piecewise_x'><p>Piecewise real function.</p></a></li>
<li><a href='#piecewise_xy'><p>Piecewise real function of two variables.</p></a></li>
<li><a href='#plot.population'><p>Plot the age pyramid of a population data frame (at a given time).</p></a></li>
<li><a href='#plot.pyramid'><p>Plot an age pyramid.</p></a></li>
<li><a href='#popsample'><p>Generic method for popsample</p></a></li>
<li><a href='#popsample.pyramid'><p>Sample a population from an age pyramid (at a given time).</p></a></li>
<li><a href='#popsim'><p>Simulation of a model.</p></a></li>
<li><a href='#population'><p>Class population</p></a></li>
<li><a href='#population_alive'><p>Generic method for population_alive</p></a></li>
<li><a href='#population_alive.population'><p>Returns a population of individuals alive.</p></a></li>
<li><a href='#print.event'><p>Print Event</p></a></li>
<li><a href='#print.model'><p>Printing of a model</p></a></li>
<li><a href='#print.population'><p>Printing population</p></a></li>
<li><a href='#pyramid'><p>Class pyramid</p></a></li>
<li><a href='#stepfun'><p>Step Function.</p></a></li>
<li><a href='#summary.event'><p>Summarizing an event</p></a></li>
<li><a href='#summary.logs'><p>Summary logs</p></a></li>
<li><a href='#summary.model'><p>Summary of a model</p></a></li>
<li><a href='#summary.population'><p>Summary population</p></a></li>
<li><a href='#summary.simulation_output'><p>Summary simulation output</p></a></li>
<li><a href='#toy_params'><p>Toy parameters for IBMPopSim-human_popIMD vignette example.</p></a></li>
<li><a href='#weibull'><p>Weibull function.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Individual Based Model Population Simulation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-06</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Daphné Giorgi &lt;daphne.giorgi@sorbonne-universite.fr&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Simulation of the random evolution of heterogeneous populations using stochastic Individual-Based Models (IBMs) &lt;<a href="https://doi.org/10.48550%2FarXiv.2303.06183">doi:10.48550/arXiv.2303.06183</a>&gt;. 
    The package enables users to simulate population evolution, in which individuals are characterized by their age and some characteristics, and the population is modified by different types of events, including births/arrivals, death/exit events, or changes of characteristics. The frequency at which an event can occur to an individual can depend on their age and characteristics, but also on the characteristics of other individuals (interactions). 
    Such models have a wide range of applications. For instance, IBMs can be used for simulating the evolution of a heterogeneous insurance portfolio with selection or for validating  mortality forecasts. 
    This package overcomes the limitations of time-consuming IBMs simulations by implementing new efficient algorithms  based on thinning methods, which are compiled using the 'Rcpp' package while providing a user-friendly interface.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/DaphneGiorgi/IBMPopSim">https://github.com/DaphneGiorgi/IBMPopSim</a>,
<a href="https://DaphneGiorgi.github.io/IBMPopSim/">https://DaphneGiorgi.github.io/IBMPopSim/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/DaphneGiorgi/IBMPopSim/issues">https://github.com/DaphneGiorgi/IBMPopSim/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12), checkmate, stats, readr, rlang, dplyr (&ge;
0.8.0), ggplot2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RcppArmadillo, knitr, rmarkdown, bookdown, ggfortify, magick,
colorspace, gganimate, gridExtra</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-08 10:12:14 UTC; giorgi</td>
</tr>
<tr>
<td>Author:</td>
<td>Daphné Giorgi [aut, cre],
  Sarah Kaakai [aut],
  Vincent Lemaire [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-09 00:30:35 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_characteristic'>Generic method for add_characteristic</h2><span id='topic+add_characteristic'></span>

<h3>Description</h3>

<p>Generic method for add_characteristic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_characteristic(x, name, value = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_characteristic_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="add_characteristic_+3A_name">name</code></td>
<td>
<p>Name of the characteristic to add.</p>
</td></tr>
<tr><td><code id="add_characteristic_+3A_value">value</code></td>
<td>
<p>Value of the characteristic. By default <code>NA</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='add_characteristic.population'>Add characteristic to a population</h2><span id='topic+add_characteristic.population'></span>

<h3>Description</h3>

<p>Add characteristic to a population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
add_characteristic(x, name, value = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_characteristic.population_+3A_x">x</code></td>
<td>
<p>Object of <a href="#topic+population">population</a> class representing a population.</p>
</td></tr>
<tr><td><code id="add_characteristic.population_+3A_name">name</code></td>
<td>
<p>Name of the characteristic to add.</p>
</td></tr>
<tr><td><code id="add_characteristic.population_+3A_value">value</code></td>
<td>
<p>Value of the characteristic. By default <code>NA</code>.</p>
</td></tr>
</table>

<hr>
<h2 id='age_pyramid'>Generic method for age_pyramid</h2><span id='topic+age_pyramid'></span>

<h3>Description</h3>

<p>Generic method for age_pyramid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_pyramid(object, time = 0, ages = c(0:110, Inf), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_pyramid_+3A_object">object</code></td>
<td>
<p>Population.</p>
</td></tr>
<tr><td><code id="age_pyramid_+3A_time">time</code></td>
<td>
<p>The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
<tr><td><code id="age_pyramid_+3A_ages">ages</code></td>
<td>
<p><em>(Optional)</em> A numeric vector of distinct positive values composing age groups. Must be in increasing order.</p>
</td></tr>
<tr><td><code id="age_pyramid_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+pyramid">pyramid</a></code> containing the age pyramid of a population at instant <code>time</code>.
</p>

<hr>
<h2 id='age_pyramid.population'>Age pyramid from a population at a given time.</h2><span id='topic+age_pyramid.population'></span>

<h3>Description</h3>

<p>Reduce a population containing all individuals (with some characteristics) to an age-groups data frame (preserving characteristics). The function computes the number of individuals at <code>time</code> in each age group <code>[ages[i],ages[i+1][</code>, for <code>i</code> in <code>{1,...,N-1}</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
age_pyramid(object, time = 0, ages = c(0:110, Inf), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_pyramid.population_+3A_object">object</code></td>
<td>
<p>Object of <code><a href="#topic+population">population</a></code> class representing a population.</p>
</td></tr>
<tr><td><code id="age_pyramid.population_+3A_time">time</code></td>
<td>
<p>The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
<tr><td><code id="age_pyramid.population_+3A_ages">ages</code></td>
<td>
<p><em>(Optional)</em> A numeric vector of distinct positive values composing age groups. Must be in increasing order.</p>
</td></tr>
<tr><td><code id="age_pyramid.population_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code><a href="#topic+pyramid">pyramid</a></code> containing the age pyramid of the given population at instant <code>time</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+age_pyramids.population">age_pyramids.population</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>age_pyramid(population(EW_pop_14$sample), time = 0)

age_pyramid(population(EW_popIMD_14$sample), time = 0, ages = seq(0, 120, by=2))

</code></pre>

<hr>
<h2 id='age_pyramids'>Generic method for age_pyramids</h2><span id='topic+age_pyramids'></span>

<h3>Description</h3>

<p>Generic method for age_pyramids
</p>


<h3>Usage</h3>

<pre><code class='language-R'>age_pyramids(object, time = 0, ages = c(0:110, Inf))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_pyramids_+3A_object">object</code></td>
<td>
<p>Population.</p>
</td></tr>
<tr><td><code id="age_pyramids_+3A_time">time</code></td>
<td>
<p>The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
<tr><td><code id="age_pyramids_+3A_ages">ages</code></td>
<td>
<p><em>(Optional)</em> A numeric vector of distinct positive values composing age groups. Must be in increasing order.</p>
</td></tr>
</table>

<hr>
<h2 id='age_pyramids.population'>Age pyramid from a population data frame at some given times.</h2><span id='topic+age_pyramids.population'></span>

<h3>Description</h3>

<p>Vectorial version in time of the function <code><a href="#topic+age_pyramid.population">age_pyramid.population</a></code>. Not compatible with IBMs including swap events.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
age_pyramids(object, time = 0, ages = c(0:110, Inf))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="age_pyramids.population_+3A_object">object</code></td>
<td>
<p>Object of <code><a href="#topic+population">population</a></code> class representing a population.</p>
</td></tr>
<tr><td><code id="age_pyramids.population_+3A_time">time</code></td>
<td>
<p>The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
<tr><td><code id="age_pyramids.population_+3A_ages">ages</code></td>
<td>
<p><em>(Optional)</em> A numeric vector of distinct positive values composing age groups. Must be in increasing order.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For convenience. This is a just a <code>lapply</code> call of <code>age_pyramid.population</code> on the vector <code>time</code>.
</p>

<hr>
<h2 id='assertCharacteristics'>Function for internal use</h2><span id='topic+assertCharacteristics'></span>

<h3>Description</h3>

<p>Check characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertCharacteristics(characteristics)
</code></pre>

<hr>
<h2 id='assertEvents'>Function for internal use</h2><span id='topic+assertEvents'></span>

<h3>Description</h3>

<p>Check events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertEvents(events)
</code></pre>

<hr>
<h2 id='assertParameters'>Function for internal use</h2><span id='topic+assertParameters'></span>

<h3>Description</h3>

<p>Check parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertParameters(parameters)
</code></pre>

<hr>
<h2 id='assertPopulation'>Function for internal use</h2><span id='topic+assertPopulation'></span>

<h3>Description</h3>

<p>Check on the population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertPopulation(object)
</code></pre>

<hr>
<h2 id='assertPyramid'>Function for internal use</h2><span id='topic+assertPyramid'></span>

<h3>Description</h3>

<p>Check on a pyramid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assertPyramid(pyramid)
</code></pre>

<hr>
<h2 id='capitalize'>Function for internal use</h2><span id='topic+capitalize'></span>

<h3>Description</h3>

<p>Capitalize first letter of a word
</p>


<h3>Usage</h3>

<pre><code class='language-R'>capitalize(x)
</code></pre>

<hr>
<h2 id='check_intensity_code'>Check the intensity code.</h2><span id='topic+check_intensity_code'></span>

<h3>Description</h3>

<p>Verifies that the intensity contains the string 'result'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_intensity_code(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_intensity_code_+3A_code">code</code></td>
<td>
<p>String containing the intensity code.</p>
</td></tr>
</table>

<hr>
<h2 id='check_interaction_code'>Check the interaction code.</h2><span id='topic+check_interaction_code'></span>

<h3>Description</h3>

<p>Verifies that the interaction contains the string 'result'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_interaction_code(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_interaction_code_+3A_code">code</code></td>
<td>
<p>String containing the interaction code.</p>
</td></tr>
</table>

<hr>
<h2 id='check_kernel_code'>Check the kernel code.</h2><span id='topic+check_kernel_code'></span>

<h3>Description</h3>

<p>Verifies the kernel code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_kernel_code(code)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="check_kernel_code_+3A_code">code</code></td>
<td>
<p>String containing the kernel code.</p>
</td></tr>
</table>

<hr>
<h2 id='compatibility_chars_events'>Check characteristics-events compatibility</h2><span id='topic+compatibility_chars_events'></span>

<h3>Description</h3>

<p>A function to check the compatibility between characteristics and events
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compatibility_chars_events(characteristics, events)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compatibility_chars_events_+3A_characteristics">characteristics</code></td>
<td>
<p>List of characteristics</p>
</td></tr>
<tr><td><code id="compatibility_chars_events_+3A_events">events</code></td>
<td>
<p>List of events</p>
</td></tr>
</table>

<hr>
<h2 id='compatibility_pop_model'>Check population-model compatibility</h2><span id='topic+compatibility_pop_model'></span>

<h3>Description</h3>

<p>A function to check the compatibility between a population and a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compatibility_pop_model(pop, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compatibility_pop_model_+3A_pop">pop</code></td>
<td>
<p>An object of class <a href="#topic+population">population</a></p>
</td></tr>
<tr><td><code id="compatibility_pop_model_+3A_model">model</code></td>
<td>
<p>An Individual Based Model created with the <a href="#topic+mk_model">mk_model</a> function</p>
</td></tr>
</table>

<hr>
<h2 id='death_table'>Death table</h2><span id='topic+death_table'></span>

<h3>Description</h3>

<p>Creates a death table from a population object.
For each <code>i=1..N-1</code> and <code>j=1..M</code>, the number of individuals with age at last birthday in <code>[ages[i],ages[i+1])</code> and died in <code>[times[j],times[j+1])</code> is computed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>death_table(pop, ages, period)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="death_table_+3A_pop">pop</code></td>
<td>
<p>Object of class <code><a href="#topic+population">population</a></code>.</p>
</td></tr>
<tr><td><code id="death_table_+3A_ages">ages</code></td>
<td>
<p>A vector of size <code>N</code> composed of age groups.</p>
</td></tr>
<tr><td><code id="death_table_+3A_period">period</code></td>
<td>
<p>A vector of size <code>M</code> composed of time intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the number of death in each time interval <code>[times[j],times[j+1])</code>, <code>j=1..M</code>.
</p>


<h3>Value</h3>

<p>A death table matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dth_table &lt;-  death_table(population(EW_pop_out), 0:101, 0:11)

</code></pre>

<hr>
<h2 id='details_cpp'>Autogenerate cpp details documentation</h2><span id='topic+details_cpp'></span>

<h3>Description</h3>

<p>Autogenerating documentation details for cpp functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>details_cpp()
</code></pre>

<hr>
<h2 id='details_intensity_code'>Autogenerated documentation for intensity code</h2><span id='topic+details_intensity_code'></span>

<h3>Description</h3>

<p>Autogenerated documentation for intensity code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>details_intensity_code()
</code></pre>

<hr>
<h2 id='details_interaction_code'>Autogenerated documentation for interaction code</h2><span id='topic+details_interaction_code'></span>

<h3>Description</h3>

<p>Autogenerated documentation for interaction code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>details_interaction_code()
</code></pre>

<hr>
<h2 id='details_kernel_code'>Autogenerated documentation for kernel code</h2><span id='topic+details_kernel_code'></span>

<h3>Description</h3>

<p>Autogenerated documentation for kernel code
</p>


<h3>Usage</h3>

<pre><code class='language-R'>details_kernel_code()
</code></pre>

<hr>
<h2 id='details_type_event'>Autogenerated documentation for event type</h2><span id='topic+details_type_event'></span>

<h3>Description</h3>

<p>Autogenerated documentation for event type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>details_type_event()
</code></pre>

<hr>
<h2 id='EW_pop_14'>England and Wales (EW) 2014 population, death and birth rates.</h2><span id='topic+EW_pop_14'></span>

<h3>Description</h3>

<p>EW 2014 population and death rates by age  and gender  (Source: Office for National Statistics, reference number 006518).
</p>
<p>Female birth rates by age of the mother (Source: Office for National Statistics birth summary tables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EW_pop_14
</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>age_pyramid</code></dt><dd><p>Data frame containing EW age pyramid for year 2014, by gender and single year of age (0-115).</p>
</dd>
<dt><code>rates</code></dt><dd><p>A list containing three data frames:</p>

<dl>
<dt><code>birth</code></dt><dd><p>Birth rates data frame, by age of mother and 5 years age groups.</p>
</dd>
<dt><code>death_male</code></dt><dd><p>Male death rates data frame, by single year of age (0-90+).</p>
</dd>
<dt><code>death_female</code></dt><dd><p>Female death rates dataframe, by single year of age (0-90+).</p>
</dd></dl>
</dd>
<dt><code>sample</code></dt><dd><p>Population dataframe composed of 100 000 individuals, sampled from <code>age_pyramid</code>.</p>
</dd>
</dl>


<hr>
<h2 id='EW_pop_out'>Example of &quot;human population&quot; after 100 years of simulation.</h2><span id='topic+EW_pop_out'></span>

<h3>Description</h3>

<p>Example of &quot;human population&quot;  data frame after 100 years of simulation, based on a sample of England and Wales 2014 population and demographic rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EW_pop_out
</code></pre>


<h3>Format</h3>

<p>Data frame containing a population structured by age and gender,
simulated with an initial population of 100 000 individuals sampled from <code>EW_pop_14$age_pyramid</code>
over 100 years, with birth and death events.
</p>

<hr>
<h2 id='EW_popIMD_14'>England and Wales (EW) 2014 population and death rates by Index of Multiple Deprivation (IMD).</h2><span id='topic+EW_popIMD_14'></span>

<h3>Description</h3>

<p>EW population, death rates by age, gender and IMD for year 2014 (Source: Office for National Statistics, reference number 006518).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EW_popIMD_14
</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>age_pyramid</code></dt><dd><p>Data frame containing EW age pyramid for year 2014, by gender, IMD and single year of age (0-115).
</p>
<p>Individuals in the age class 90+ are distributed in the single year of age classes as in the EW population.</p>
</dd>
<dt><code>death_rates</code></dt><dd><p>List containing 4 fields:
</p>

<dl>
<dt><code>male</code></dt><dd><p> Male death rates data frame, by IMD and single year of age (0-90+).</p>
</dd>
<dt><code>female</code></dt><dd><p> Female death rates dataframe, by IMD and single year of age (0-90+).</p>
</dd>
</dl>

</dd>
<dt><code>sample</code></dt><dd><p>Population dataframe composed of 100 000 individuals, sampled from <code>age_pyramid</code>.</p>
</dd>
</dl>


<hr>
<h2 id='EWdata_hmd'>England and Wale mortality data (source: Human Mortality Database)</h2><span id='topic+EWdata_hmd'></span>

<h3>Description</h3>

<p>Obtained with
</p>
<p><code>EWdata_hmd &lt;- hmd.mx(country = "GBRTENW", username = ... , password = ...,label = "England and Wales")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EWdata_hmd
</code></pre>


<h3>Format</h3>

<p>An object of class <code>demogdata</code> of length 7.
</p>

<hr>
<h2 id='exposure_table'>Exposure table</h2><span id='topic+exposure_table'></span>

<h3>Description</h3>

<p>Returns the Central Exposure-to-Risk for given ages groups and time period.
The central Exposure-to-risk is computed as the sum of the time spent by individuals in a given age group over a given period, where age is the age at last birthday.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exposure_table(pop, ages, period)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exposure_table_+3A_pop">pop</code></td>
<td>
<p>Object of class <code><a href="#topic+population">population</a></code>.</p>
</td></tr>
<tr><td><code id="exposure_table_+3A_ages">ages</code></td>
<td>
<p>A vector of size <code>N</code> composed of age groups.</p>
</td></tr>
<tr><td><code id="exposure_table_+3A_period">period</code></td>
<td>
<p>A vector of size <code>M</code> composed of time intervals.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes the central exposure-to-risk in each time interval <code>[t[j],t[j+1])</code>, <code>j=1..M</code>, and age groups.
</p>


<h3>Value</h3>

<p>An exposure matrix
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ex_table &lt;- exposure_table(population(EW_pop_out),0:101,0:11)

</code></pre>

<hr>
<h2 id='get_characteristics'>Generic method for get_characteristics</h2><span id='topic+get_characteristics'></span>

<h3>Description</h3>

<p>Generic method for get_characteristics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_characteristics(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_characteristics_+3A_object">object</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="get_characteristics_+3A_...">...</code></td>
<td>
<p>Additional parameters.</p>
</td></tr>
</table>

<hr>
<h2 id='get_characteristics.population'>Returns names and C types of the characteristics.</h2><span id='topic+get_characteristics.population'></span>

<h3>Description</h3>

<p>Returns names and C types of the characteristics (other than birth and death) of the individuals in a population, from a population data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
get_characteristics(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_characteristics.population_+3A_object">object</code></td>
<td>
<p>Object of <a href="#topic+population">population</a> class representing a population.</p>
</td></tr>
<tr><td><code id="get_characteristics.population_+3A_...">...</code></td>
<td>
<p>additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector composed of characteristics names and C types. If the population has no characteristics, which means that it has only the <code>birth</code> and <code>death</code> columns, this returns <code>NULL</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>get_characteristics(population(EW_pop_14$sample))

</code></pre>

<hr>
<h2 id='get_Ctype'>Function for internal use</h2><span id='topic+get_Ctype'></span>

<h3>Description</h3>

<p>Get C++ type of a parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_Ctype(x)
</code></pre>

<hr>
<h2 id='get_Rtype'>Function for internal use</h2><span id='topic+get_Rtype'></span>

<h3>Description</h3>

<p>Get R type of a parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_Rtype(x)
</code></pre>

<hr>
<h2 id='gompertz'>Gompertz–Makeham intensity function.</h2><span id='topic+gompertz'></span>

<h3>Description</h3>

<p>The intensity function (or hazard function) for the Gompertz-Makeham law of mortality distribution is defined as
</p>
<p style="text-align: center;"><code class="reqn">h(x) = \alpha e^{\beta x} + \lambda</code>
</p>

<p>with <code class="reqn">\alpha, \beta, \lambda \in {R}_+</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gompertz(alpha, beta, lambda = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gompertz_+3A_alpha">alpha</code></td>
<td>
<p>Non-negative real parameter.</p>
</td></tr>
<tr><td><code id="gompertz_+3A_beta">beta</code></td>
<td>
<p>Non-negative real parameter.</p>
</td></tr>
<tr><td><code id="gompertz_+3A_lambda">lambda</code></td>
<td>
<p>Non-negative real parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>Function which associates <code>x</code> to <code class="reqn">\alpha exp(\beta x) + \lambda</code>.
</p>


<h3>See Also</h3>

<p><a href="https://en.wikipedia.org/wiki/Gompertz%E2%80%93Makeham_law_of_mortality">https://en.wikipedia.org/wiki/Gompertz%E2%80%93Makeham_law_of_mortality</a>
</p>

<hr>
<h2 id='has_event_type'>Search for a given string in event types</h2><span id='topic+has_event_type'></span>

<h3>Description</h3>

<p>Search for a given string in event types
</p>


<h3>Usage</h3>

<pre><code class='language-R'>has_event_type(events, str)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="has_event_type_+3A_events">events</code></td>
<td>
<p>list of events</p>
</td></tr>
<tr><td><code id="has_event_type_+3A_str">str</code></td>
<td>
<p>string to search</p>
</td></tr>
</table>


<h3>Value</h3>

<p>boolean
</p>

<hr>
<h2 id='id_complete'>Complete a population id</h2><span id='topic+id_complete'></span>

<h3>Description</h3>

<p>In a population with an <code>id</code> column, verifies that there are no NA <code>id</code> values,
and if there are, completes the missing <code>id</code>s
</p>


<h3>Usage</h3>

<pre><code class='language-R'>id_complete(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="id_complete_+3A_object">object</code></td>
<td>
<p>A data frame containing at least a column <code>birth</code> and <code>death</code>, that will be converted in <a href="#topic+population">population</a> class.</p>
</td></tr>
</table>

<hr>
<h2 id='linfun'>Linear interpolation function.</h2><span id='topic+linfun'></span>

<h3>Description</h3>

<p>Return a function performing the linear interpolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linfun(x, y, yleft = y[1], yright = y[length(y)])
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linfun_+3A_x">x</code>, <code id="linfun_+3A_y">y</code></td>
<td>
<p>Numeric vectors giving the coordinates of the points to be interpolated.</p>
</td></tr>
<tr><td><code id="linfun_+3A_yleft">yleft</code></td>
<td>
<p>The value to be returned when input <code>x</code> values are less than <code>min(x)</code>.</p>
</td></tr>
<tr><td><code id="linfun_+3A_yright">yright</code></td>
<td>
<p>The value to be returned when input <code>x</code> values are greater than <code>max(x)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>Objet of class <code>linfun</code> and <code>function</code> which is an <code><a href="stats.html#topic+approxfun">approxfun</a></code> function with <code>method = 'linear'</code>.
</p>

<hr>
<h2 id='max.stepfun'>Returns the maximum of a function of class <code>stepfun</code>.</h2><span id='topic+max.stepfun'></span>

<h3>Description</h3>

<p>Returns the maximum of a function of class <code>stepfun</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'stepfun'
max(..., na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="max.stepfun_+3A_...">...</code></td>
<td>
<p>argument of class <code>stepfun</code></p>
</td></tr>
<tr><td><code id="max.stepfun_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum of the step function.
</p>

<hr>
<h2 id='merge_pop_withid'>A function returning a merged dataframe from a list of population dataframes with id.</h2><span id='topic+merge_pop_withid'></span>

<h3>Description</h3>

<p>A function returning a merged dataframe from a list of population dataframes with id.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_pop_withid(pop_df_list, chars_tracked = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_pop_withid_+3A_pop_df_list">pop_df_list</code></td>
<td>
<p>A list of population dataframe where the first three columns of each dataframe are id, birth and death.</p>
</td></tr>
<tr><td><code id="merge_pop_withid_+3A_chars_tracked">chars_tracked</code></td>
<td>
<p>A vector of characteristics to be tracked over time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe composed of all individuals with their characteristics at each simulation time.
</p>

<hr>
<h2 id='mk_event_individual'>Creating an event with intensity of class individual</h2><span id='topic+mk_event_individual'></span>

<h3>Description</h3>

<p>Creates an event with intensity of class individual (without interactions). When the event occurs, something happens to an individual <code>I</code> in the population.
The created event must be used with <code><a href="#topic+mk_model">mk_model</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_event_individual(type, name, intensity_code, kernel_code = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_event_individual_+3A_type">type</code></td>
<td>
<p>Must be one of <code>'birth'</code>, <code>'death'</code>, <code>'entry'</code>, <code>'exit'</code>, <code>'swap'</code> or <code>'custom'</code>. See details.</p>
</td></tr>
<tr><td><code id="mk_event_individual_+3A_name">name</code></td>
<td>
<p><em>(Optional)</em> If not specified, the name given to the event is its type.</p>
</td></tr>
<tr><td><code id="mk_event_individual_+3A_intensity_code">intensity_code</code></td>
<td>
<p>String containing some C++ code describing the intensity function. See details.</p>
</td></tr>
<tr><td><code id="mk_event_individual_+3A_kernel_code">kernel_code</code></td>
<td>
<p>String containing some C++ code describing the event action. Optional for <code>'birth'</code>, <code>'death'</code> and <code>'exit'</code> events. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>type</code> argument is one of the following
</p>

<dl>
<dt><code>'birth'</code></dt><dd><p>By default, a new individual <code>newI</code> is created, with the same characteristics of the parent <code>I</code> and birth date equal to the current time. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'death'</code></dt><dd><p>By default, the individual <code>I</code> dies. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'entry'</code></dt><dd><p>A new individual <code>newI</code> is added to the population, and its characteristics have to be defined by the user in the entry <code>kernel_code</code>.</p>
</dd>
<dt><code>'exit'</code></dt><dd><p>An individual <code>I</code> exits from the population. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'swap'</code></dt><dd><p>The user can change the characteristics of the selected individual <code>I</code>. This requires <code>kernel_code</code>.</p>
</dd>
<dt><code>'custom'</code></dt><dd><p>None of the above types, the user defines <code>kernel_code</code> that can act on the selected individual <code>I</code> and on the population <code>pop</code>.</p>
</dd>
</dl>

<p>The <code>intensity_code</code> argument is a string containing some C++ code describing the event intensity for individual <code>I</code> at time <code>t</code>. The intensity value <strong>must be stored</strong> in the variable <code>result</code>.
Some of available variables in the C++ code are: <code>t</code> (the current time), <code>I</code> (the current individual selected for the event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim_Cpp')</code> for more details.
</p>
<p>The <code>kernel_code</code> argument is a string containing some C++ code which describing the action of the event. Some of available variables in the C++ code are: <code>t</code> (the current time), <code>pop</code> (the current population), <code>I</code> (the current individual selected for the event), <code>newI</code> (the new individual if <code>'birth'</code> or <code>'entry'</code> event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim')</code> for more details.
</p>


<h3>Value</h3>

<p>An S3 object of class <code>event</code> of type individual.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk_model">mk_model</a></code>, <code><a href="#topic+mk_event_poisson">mk_event_poisson</a></code>, <code><a href="#topic+mk_event_inhomogeneous_poisson">mk_event_inhomogeneous_poisson</a></code>, and <code><a href="#topic+mk_event_interaction">mk_event_interaction</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>params &lt;- list("p_male"= 0.51,
              "birth_rate" = stepfun(c(15,40), c(0,0.05,0)),
              "death_rate" = gompertz(0.008, 0.02))

death_event &lt;- mk_event_individual(type = "death",
                name = "my_death_event",
                intensity_code = "result = death_rate(age(I,t));")

birth_event &lt;- mk_event_individual(type = "birth",
                intensity_code = "if (I.male) result = 0;
                                  else result = birth_rate(age(I,t));",
                kernel_code = "newI.male = CUnif(0, 1) &lt; p_male;")

</code></pre>

<hr>
<h2 id='mk_event_inhomogeneous_poisson'>Creating inhomogeneous Poisson class event</h2><span id='topic+mk_event_inhomogeneous_poisson'></span>

<h3>Description</h3>

<p>The function <code>mk_event_inhomogeneous_poisson</code> is used to create an event with intensity type inhomogeneous Poisson (time dependent intensity which does not depend on population).
When the event occurs, something happens in the population.
The created event must be used with <code><a href="#topic+mk_model">mk_model</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_event_inhomogeneous_poisson(type, name, intensity_code, kernel_code = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_event_inhomogeneous_poisson_+3A_type">type</code></td>
<td>
<p>Must be one of <code>'birth'</code>, <code>'death'</code>, <code>'entry'</code>, <code>'exit'</code>, <code>'swap'</code> or <code>'custom'</code>. See details.</p>
</td></tr>
<tr><td><code id="mk_event_inhomogeneous_poisson_+3A_name">name</code></td>
<td>
<p><em>(Optional)</em> If not specified, the name given to the event is its type.</p>
</td></tr>
<tr><td><code id="mk_event_inhomogeneous_poisson_+3A_intensity_code">intensity_code</code></td>
<td>
<p>String containing some C++ code describing the intensity function. See details.</p>
</td></tr>
<tr><td><code id="mk_event_inhomogeneous_poisson_+3A_kernel_code">kernel_code</code></td>
<td>
<p>String containing some C++ code describing the event action. Optional for <code>'birth'</code>, <code>'death'</code> and <code>'exit'</code> events. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>type</code> argument is one of the following
</p>

<dl>
<dt><code>'birth'</code></dt><dd><p>By default, a new individual <code>newI</code> is created, with the same characteristics of the parent <code>I</code> and birth date equal to the current time. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'death'</code></dt><dd><p>By default, the individual <code>I</code> dies. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'entry'</code></dt><dd><p>A new individual <code>newI</code> is added to the population, and its characteristics have to be defined by the user in the entry <code>kernel_code</code>.</p>
</dd>
<dt><code>'exit'</code></dt><dd><p>An individual <code>I</code> exits from the population. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'swap'</code></dt><dd><p>The user can change the characteristics of the selected individual <code>I</code>. This requires <code>kernel_code</code>.</p>
</dd>
<dt><code>'custom'</code></dt><dd><p>None of the above types, the user defines <code>kernel_code</code> that can act on the selected individual <code>I</code> and on the population <code>pop</code>.</p>
</dd>
</dl>

<p>The <code>intensity_code</code> argument is a string containing some C++ code describing the event intensity for individual <code>I</code> at time <code>t</code>. The intensity value <strong>must be stored</strong> in the variable <code>result</code>.
Some of available variables in the C++ code are: <code>t</code> (the current time), <code>I</code> (the current individual selected for the event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim_Cpp')</code> for more details.
</p>
<p>The <code>kernel_code</code> argument is a string containing some C++ code which describing the action of the event. Some of available variables in the C++ code are: <code>t</code> (the current time), <code>pop</code> (the current population), <code>I</code> (the current individual selected for the event), <code>newI</code> (the new individual if <code>'birth'</code> or <code>'entry'</code> event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim')</code> for more details.
</p>


<h3>Value</h3>

<p>An S3 object of class <code>event</code> of type inhomogeneous Poisson.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk_model">mk_model</a></code>, <code><a href="#topic+mk_event_poisson">mk_event_poisson</a></code>, <code><a href="#topic+mk_event_individual">mk_event_individual</a></code>, <code><a href="#topic+mk_event_interaction">mk_event_interaction</a></code>.
</p>

<hr>
<h2 id='mk_event_interaction'>Creating an event with intensity of type interaction</h2><span id='topic+mk_event_interaction'></span>

<h3>Description</h3>

<p>Creates an event whose intensity depends on an individual and interactions with the population. When the event occurs, something happens to an individual <code>I</code> in the population. The intensity of the event can depend on time, the characteristics of I and other individuals in the population, and can be written as
</p>
<p style="text-align: center;"><code class="reqn">d(I,t,pop) = \sum_{J \in pop} U(I,J,t),</code>
</p>

<p>where <code class="reqn">U</code> is called the interaction function.
The created event must be used with <code><a href="#topic+mk_model">mk_model</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_event_interaction(
  type,
  name,
  interaction_code,
  kernel_code = "",
  interaction_type = "random"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_event_interaction_+3A_type">type</code></td>
<td>
<p>Must be one of <code>'birth'</code>, <code>'death'</code>, <code>'entry'</code>, <code>'exit'</code>, <code>'swap'</code> or <code>'custom'</code>. See details.</p>
</td></tr>
<tr><td><code id="mk_event_interaction_+3A_name">name</code></td>
<td>
<p><em>(Optional)</em> If not specified, the name given to the event is its type.</p>
</td></tr>
<tr><td><code id="mk_event_interaction_+3A_interaction_code">interaction_code</code></td>
<td>
<p>String containing some C++ code describing the interaction function. See details.</p>
</td></tr>
<tr><td><code id="mk_event_interaction_+3A_kernel_code">kernel_code</code></td>
<td>
<p>String containing some C++ code describing the event action. Optional for <code>'birth'</code>, <code>'death'</code> and <code>'exit'</code> events. See details.</p>
</td></tr>
<tr><td><code id="mk_event_interaction_+3A_interaction_type">interaction_type</code></td>
<td>
<p><em>(Optional)</em> Either <code>'random'</code> or <code>'full'</code>. By default <code>'random'</code> which is faster than <code>'full'</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>type</code> argument is one of the following
</p>

<dl>
<dt><code>'birth'</code></dt><dd><p>By default, a new individual <code>newI</code> is created, with the same characteristics of the parent <code>I</code> and birth date equal to the current time. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'death'</code></dt><dd><p>By default, the individual <code>I</code> dies. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'entry'</code></dt><dd><p>A new individual <code>newI</code> is added to the population, and its characteristics have to be defined by the user in the entry <code>kernel_code</code>.</p>
</dd>
<dt><code>'exit'</code></dt><dd><p>An individual <code>I</code> exits from the population. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'swap'</code></dt><dd><p>The user can change the characteristics of the selected individual <code>I</code>. This requires <code>kernel_code</code>.</p>
</dd>
<dt><code>'custom'</code></dt><dd><p>None of the above types, the user defines <code>kernel_code</code> that can act on the selected individual <code>I</code> and on the population <code>pop</code>.</p>
</dd>
</dl>

<p>The <code>interaction_code</code> argument is a string containing some C++ code describing the event interaction function $U$ at time <code>t</code>. The interaction value <strong>must be stored</strong> in the variable <code>result</code>.
Some of available variables in the C++ code are: <code>t</code> (the current time), <code>I</code> (the current individual selected for the event), <code>J</code> (another individual if <code>interaction_type</code> is <code>'random'</code>), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim_Cpp')</code> for more details.
</p>
<p>The <code>kernel_code</code> argument is a string containing some C++ code which describing the action of the event. Some of available variables in the C++ code are: <code>t</code> (the current time), <code>pop</code> (the current population), <code>I</code> (the current individual selected for the event), <code>newI</code> (the new individual if <code>'birth'</code> or <code>'entry'</code> event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim')</code> for more details.
</p>


<h3>Value</h3>

<p>An S3 object of class <code>event</code> of type interaction.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk_model">mk_model</a></code>, <code><a href="#topic+mk_event_poisson">mk_event_poisson</a></code>, <code><a href="#topic+mk_event_inhomogeneous_poisson">mk_event_inhomogeneous_poisson</a></code>, <code><a href="#topic+mk_event_individual">mk_event_individual</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
death_interaction_code&lt;- " result = max(J.size -I.size,0);"
event &lt;- mk_event_interaction(type="death",
                             interaction_code = death_interaction_code)

</code></pre>

<hr>
<h2 id='mk_event_poisson'>Creating Poisson class event</h2><span id='topic+mk_event_poisson'></span>

<h3>Description</h3>

<p>The function <code>mk_event_poisson</code> is used to create an event with intensity of type Poisson (constant intensity which does not depend on population or time).
When the event occurs, something happens in the population.
The created event must be used with <code><a href="#topic+mk_model">mk_model</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_event_poisson(type, name, intensity, kernel_code = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_event_poisson_+3A_type">type</code></td>
<td>
<p>Must be one of <code>'birth'</code>, <code>'death'</code>, <code>'entry'</code>, <code>'exit'</code>, <code>'swap'</code> or <code>'custom'</code>. See details.</p>
</td></tr>
<tr><td><code id="mk_event_poisson_+3A_name">name</code></td>
<td>
<p><em>(Optional)</em> If not specified, the name given to the event is its type.</p>
</td></tr>
<tr><td><code id="mk_event_poisson_+3A_intensity">intensity</code></td>
<td>
<p>String containing some constant positive value, or name of a parameter which is a constant positive value.</p>
</td></tr>
<tr><td><code id="mk_event_poisson_+3A_kernel_code">kernel_code</code></td>
<td>
<p>String containing some C++ code describing the event action. Optional for <code>'birth'</code>, <code>'death'</code> and <code>'exit'</code> events. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>type</code> argument is one of the following
</p>

<dl>
<dt><code>'birth'</code></dt><dd><p>By default, a new individual <code>newI</code> is created, with the same characteristics of the parent <code>I</code> and birth date equal to the current time. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'death'</code></dt><dd><p>By default, the individual <code>I</code> dies. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'entry'</code></dt><dd><p>A new individual <code>newI</code> is added to the population, and its characteristics have to be defined by the user in the entry <code>kernel_code</code>.</p>
</dd>
<dt><code>'exit'</code></dt><dd><p>An individual <code>I</code> exits from the population. Optional code can be precised in <code>kernel_code</code>.</p>
</dd>
<dt><code>'swap'</code></dt><dd><p>The user can change the characteristics of the selected individual <code>I</code>. This requires <code>kernel_code</code>.</p>
</dd>
<dt><code>'custom'</code></dt><dd><p>None of the above types, the user defines <code>kernel_code</code> that can act on the selected individual <code>I</code> and on the population <code>pop</code>.</p>
</dd>
</dl>

<p>The <code>kernel_code</code> argument is a string containing some C++ code which describing the action of the event. Some of available variables in the C++ code are: <code>t</code> (the current time), <code>pop</code> (the current population), <code>I</code> (the current individual selected for the event), <code>newI</code> (the new individual if <code>'birth'</code> or <code>'entry'</code> event), the name of the model parameters (some variables, or functions, see <code><a href="#topic+mk_model">mk_model</a></code>).
See <code>vignette('IBMPopSim')</code> for more details.
</p>


<h3>Value</h3>

<p>An S3 object of class <code>event</code> of type Poisson.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mk_model">mk_model</a></code>, <code><a href="#topic+mk_event_inhomogeneous_poisson">mk_event_inhomogeneous_poisson</a></code>, <code><a href="#topic+mk_event_individual">mk_event_individual</a></code>, <code><a href="#topic+mk_event_interaction">mk_event_interaction</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>birth &lt;- mk_event_poisson('birth', intensity = 10)


params &lt;- list(beta = 10)
death &lt;- mk_event_poisson('death', intensity = 'beta') # name of one parameter
mk_model(events = list(birth, death), parameters = params)


</code></pre>

<hr>
<h2 id='mk_individual_type'>Function for internal use</h2><span id='topic+mk_individual_type'></span>

<h3>Description</h3>

<p>Get R and C++ type of characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_individual_type(characteristics)
</code></pre>

<hr>
<h2 id='mk_model'>Creates a model for IBMPopSim.</h2><span id='topic+mk_model'></span>

<h3>Description</h3>

<p>This function creates an Individual Based Model describing the population, events which can occur in the population, and the model parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_model(
  characteristics = NULL,
  events,
  parameters = NULL,
  with_compilation = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_model_+3A_characteristics">characteristics</code></td>
<td>
<p>List containing names and types of characteristics of individuals in the population. See <code><a href="#topic+get_characteristics">get_characteristics</a></code>.</p>
</td></tr>
<tr><td><code id="mk_model_+3A_events">events</code></td>
<td>
<p>List of events in the model. See <code><a href="#topic+mk_event_poisson">mk_event_poisson</a></code>, <code><a href="#topic+mk_event_inhomogeneous_poisson">mk_event_inhomogeneous_poisson</a></code>, <code><a href="#topic+mk_event_individual">mk_event_individual</a></code>, and <code><a href="#topic+mk_event_interaction">mk_event_interaction</a></code>.</p>
</td></tr>
<tr><td><code id="mk_model_+3A_parameters">parameters</code></td>
<td>
<p>Model parameters. A list of parameters of the model.</p>
</td></tr>
<tr><td><code id="mk_model_+3A_with_compilation">with_compilation</code></td>
<td>
<p><em>(Optional)</em> Logical parameter, <code>TRUE</code> by default. If <code>FALSE</code> the <code>sourceCpp</code> function is not called.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It builds the C++ model code and produces the function <code>popsim_cpp</code> which will be used for simulating the model. The function used to simulate a population from a model is <code><a href="#topic+popsim">popsim</a></code>.
</p>


<h3>Value</h3>

<p>model List containing the built model :
</p>

<ul>
<li> <p><code>individual_type</code>: Names and types (R and C++) of characteristics.
</p>
</li>
<li> <p><code>parameters_types</code>: Names and types (R and C++) of model parameters.
</p>
</li>
<li> <p><code>events</code>: List of events.
</p>
</li>
<li> <p><code>cpp_code</code>: Output of C++ compilation.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+popsim">popsim</a></code>, <code><a href="#topic+mk_event_poisson">mk_event_poisson</a></code>, <code><a href="#topic+mk_event_individual">mk_event_individual</a></code>, <code><a href="#topic+mk_event_interaction">mk_event_interaction</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
params &lt;- list("p_male"= 0.51,
              "birth_rate" = stepfun(c(15,40),c(0,0.05,0)),
              "death_rate" = gompertz(0.008,0.02))

death_event &lt;- mk_event_individual(type = "death",
                                  intensity_code = "result = death_rate(age(I,t));")

birth_event &lt;- mk_event_individual(type = 'birth',
                                  intensity_code = "if (I.male) result = 0;
                                    else result=birth_rate(age(I,t));",
                                  kernel_code = "newI.male = CUnif(0, 1) &lt; p_male;")

model &lt;- mk_model(characteristics = get_characteristics(population(EW_pop_14$sample)),
                 events = list(death_event,birth_event),
                 parameters = params)

summary(model)


</code></pre>

<hr>
<h2 id='mk_parameters_types'>Extract types (R and C++) of the parameters</h2><span id='topic+mk_parameters_types'></span>

<h3>Description</h3>

<p>Extract types (R and C++) of the parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mk_parameters_types(parameters)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mk_parameters_types_+3A_parameters">parameters</code></td>
<td>
<p>parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>

<hr>
<h2 id='mkcpp_declaration_individual'>Function for internal use</h2><span id='topic+mkcpp_declaration_individual'></span>

<h3>Description</h3>

<p>Build source code for individual creation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_declaration_individual(ind_t)
</code></pre>

<hr>
<h2 id='mkcpp_definition_events'>Function for internal use</h2><span id='topic+mkcpp_definition_events'></span>

<h3>Description</h3>

<p>Build source code for event definition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_definition_events(events)
</code></pre>

<hr>
<h2 id='mkcpp_event'>Function for internal use</h2><span id='topic+mkcpp_event'></span>

<h3>Description</h3>

<p>Build source code for event creation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_event(event, kernel_type, name_type)
</code></pre>

<hr>
<h2 id='mkcpp_initialisation_population'>Function for internal use</h2><span id='topic+mkcpp_initialisation_population'></span>

<h3>Description</h3>

<p>Build source code for population initialization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_initialisation_population(ind_t)
</code></pre>

<hr>
<h2 id='mkcpp_output_population'>Function for internal use</h2><span id='topic+mkcpp_output_population'></span>

<h3>Description</h3>

<p>Build source code for output population creation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_output_population(ind_t)
</code></pre>

<hr>
<h2 id='mkcpp_parameters'>Function for internal use</h2><span id='topic+mkcpp_parameters'></span>

<h3>Description</h3>

<p>Build source code for parameters creation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_parameters(parameters, parameters_t)
</code></pre>

<hr>
<h2 id='mkcpp_popsim'>Function for internal use</h2><span id='topic+mkcpp_popsim'></span>

<h3>Description</h3>

<p>Build source main code for model simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mkcpp_popsim(model, with_id)
</code></pre>

<hr>
<h2 id='piecewise_x'>Piecewise real function.</h2><span id='topic+piecewise_x'></span>

<h3>Description</h3>

<p>Given the vectors <code style="white-space: pre;">&#8288;(breaks[1],...,breaks[n])&#8288;</code> and the list of <code>IBMPopSim</code> compatible
functions <code style="white-space: pre;">&#8288;funs = (f[0],f[1],...,f[n])&#8288;</code> (one value more!), <code>piecewise_x(breaks, funs)</code> returns
the function
</p>
<p style="text-align: center;"><code class="reqn">f(x) = f_0(x){1}_{x\le breaks[1]}+\sum_{k=1}^{n-1} f_k(x) {1}_{[breaks_{k}, breaks_{k+1})}(x) + f_n(x){1}_{x \ge breaks[n]}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>piecewise_x(breaks, funs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="piecewise_x_+3A_breaks">breaks</code></td>
<td>
<p>Numeric vector giving the breaks of functions given in <code>funs</code>. Must be sorted with unique values.</p>
</td></tr>
<tr><td><code id="piecewise_x_+3A_funs">funs</code></td>
<td>
<p>List of functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>Piecewise function built with the given intervals and functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dr &lt;- with(EW_pop_14$rates,
           stepfun(x=death_male[,"age"], y=c(0,death_male[,"value"])))
# before age 80 the stepfun and after age 80 the gompertz function
f &lt;- piecewise_x(80, list(dr, gompertz(0.00006, 0.085)))
x &lt;- seq(40:120)
plot(x, sapply(x, f))

</code></pre>

<hr>
<h2 id='piecewise_xy'>Piecewise real function of two variables.</h2><span id='topic+piecewise_xy'></span>

<h3>Description</h3>

<p>Given the vectors <code style="white-space: pre;">&#8288;(breaks[1],...,breaks[n])&#8288;</code> and the list of <code>IBMPopSim</code> compatible
functions <code style="white-space: pre;">&#8288;funs = (f[0],f[1],...,f[n])&#8288;</code> (one value more!), <code>piecewise_xy(breaks, funs)</code> returns
the function
</p>
<p style="text-align: center;"><code class="reqn">f(x,y) = f_0(x) {1}_{y\le breaks[1]}+\sum_{k=1}^{n-1} f_k(x) {1}_{[breaks_{k}, breaks_{k+1})}(y) + f_n(x){1}_{y \ge breaks[n]}</code>
</p>



<h3>Usage</h3>

<pre><code class='language-R'>piecewise_xy(breaks, funs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="piecewise_xy_+3A_breaks">breaks</code></td>
<td>
<p>Numeric vector giving the breaks of functions given in <code>funs</code>. Must be sorted with unique values.</p>
</td></tr>
<tr><td><code id="piecewise_xy_+3A_funs">funs</code></td>
<td>
<p>List of functions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>Piecewise bivariate function built with the given intervals and functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>time_dep_function &lt;- piecewise_xy(c(5),
                                  list(gompertz(0.1, 0.005), gompertz(0.08, 0.005)))
time_dep_function(0, 65)  # death intensity at time 0 and age 65.

</code></pre>

<hr>
<h2 id='plot.population'>Plot the age pyramid of a population data frame (at a given time).</h2><span id='topic+plot.population'></span>

<h3>Description</h3>

<p>Plot an age pyramid from age pyramid data frame with possibly several characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
plot(
  x,
  group_colors = NULL,
  group_legend = "Group",
  age_breaks = NULL,
  value_breaks = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.population_+3A_x">x</code></td>
<td>
<p>Object of class <a href="#topic+population">population</a>.</p>
</td></tr>
<tr><td><code id="plot.population_+3A_group_colors">group_colors</code></td>
<td>
<p><em>(Optional)</em> Named character vector.</p>
</td></tr>
<tr><td><code id="plot.population_+3A_group_legend">group_legend</code></td>
<td>
<p><em>(Optional)</em> Legend title name. By default set to <code>"Group"</code>.</p>
</td></tr>
<tr><td><code id="plot.population_+3A_age_breaks">age_breaks</code></td>
<td>
<p><em>(Optional)</em> An ordered vector of indexes of vector <code>unique(pyr$age)</code> used for breaks for the axis of ages.</p>
</td></tr>
<tr><td><code id="plot.population_+3A_value_breaks">value_breaks</code></td>
<td>
<p><em>(Optional)</em> Breaks for the axis of values.</p>
</td></tr>
<tr><td><code id="plot.population_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of age pyramid.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.pyramid">plot.pyramid</a></code>, <code><a href="#topic+age_pyramid.population">age_pyramid.population</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(population(EW_pop_14$sample), time = 0)

</code></pre>

<hr>
<h2 id='plot.pyramid'>Plot an age pyramid.</h2><span id='topic+plot.pyramid'></span>

<h3>Description</h3>

<p>Plot an age pyramid from age pyramid data frame with possibly several characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pyramid'
plot(
  x,
  group_colors = NULL,
  group_legend = "Group",
  age_breaks = NULL,
  value_breaks = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.pyramid_+3A_x">x</code></td>
<td>
<p>Object of class <code><a href="#topic+pyramid">pyramid</a></code>.
</p>
<p><em>(Optional)</em> For plotting an age pyramid composed of several subgroups, the population data frame must contain a column named <code>group_name</code>.</p>
</td></tr>
<tr><td><code id="plot.pyramid_+3A_group_colors">group_colors</code></td>
<td>
<p><em>(Optional)</em> Named character vector.</p>
</td></tr>
<tr><td><code id="plot.pyramid_+3A_group_legend">group_legend</code></td>
<td>
<p><em>(Optional)</em> Legend title name. By default set to <code>"Group"</code>.</p>
</td></tr>
<tr><td><code id="plot.pyramid_+3A_age_breaks">age_breaks</code></td>
<td>
<p><em>(Optional)</em> An ordered vector of indexes of vector <code>unique(pyr$age)</code> used for breaks for the axis of ages.</p>
</td></tr>
<tr><td><code id="plot.pyramid_+3A_value_breaks">value_breaks</code></td>
<td>
<p><em>(Optional)</em> Breaks for the axis of values.</p>
</td></tr>
<tr><td><code id="plot.pyramid_+3A_...">...</code></td>
<td>
<p>Additional parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plot of the age pyramid.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.population">plot.population</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot.pyramid(subset(pyramid(EW_pop_14$age_pyramid), as.numeric(age) &lt;= 110))


library(colorspace)
pyr_IMD &lt;- subset(pyramid(EW_popIMD_14$age_pyramid), as.numeric(age) &lt;= 110)
pyr_IMD$group_name &lt;- with(pyr_IMD, ifelse(male, paste('Males - IMD', IMD),
                          paste('Females - IMD', IMD)))
colors &lt;- c(sequential_hcl(n=5, palette = "Magenta"),
            sequential_hcl(n=5, palette = "Teal"))
names(colors) &lt;- c(paste('Females - IMD', 1:5),
                   paste('Males - IMD', 1:5))
# note that you must have setequal(names(colors), pyr_IMD$group_name) is TRUE
plot.pyramid(pyr_IMD, colors)

# age pyramids at different times
library(gganimate)
pyrs = age_pyramids(population(EW_popIMD_14$sample), time = 1:10)
plot.pyramid(pyrs) + transition_time(time) + labs(title = "Time: {frame_time}")

</code></pre>

<hr>
<h2 id='popsample'>Generic method for popsample</h2><span id='topic+popsample'></span>

<h3>Description</h3>

<p>Generic method for popsample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popsample(age_pyramid, size, age_max = 120, time = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popsample_+3A_age_pyramid">age_pyramid</code></td>
<td>
<p>Age pyramid.</p>
</td></tr>
<tr><td><code id="popsample_+3A_size">size</code></td>
<td>
<p>A non-negative integer giving the number of individuals in population.</p>
</td></tr>
<tr><td><code id="popsample_+3A_age_max">age_max</code></td>
<td>
<p><em>(Optional)</em> A non-negative numeric which replace (if exists) the <code>Inf</code> in <code><a href="#topic+age_pyramid.population">age_pyramid.population</a></code>.</p>
</td></tr>
<tr><td><code id="popsample_+3A_time">time</code></td>
<td>
<p><em>(Optional)</em> The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of <code><a href="#topic+population">population</a></code> class representing a data frame of size <code>size</code> containing a population of individuals.
</p>

<hr>
<h2 id='popsample.pyramid'>Sample a population from an age pyramid (at a given time).</h2><span id='topic+popsample.pyramid'></span>

<h3>Description</h3>

<p>Sample a population from an age pyramid (at a given time).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pyramid'
popsample(age_pyramid, size, age_max = 120, time = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popsample.pyramid_+3A_age_pyramid">age_pyramid</code></td>
<td>
<p>Object of <code><a href="#topic+pyramid">pyramid</a></code> class.</p>
</td></tr>
<tr><td><code id="popsample.pyramid_+3A_size">size</code></td>
<td>
<p>A non-negative integer giving the number of individuals in population.</p>
</td></tr>
<tr><td><code id="popsample.pyramid_+3A_age_max">age_max</code></td>
<td>
<p><em>(Optional)</em> A non-negative numeric which replace (if exists) the <code>Inf</code> in <code><a href="#topic+age_pyramid.population">age_pyramid.population</a></code>.</p>
</td></tr>
<tr><td><code id="popsample.pyramid_+3A_time">time</code></td>
<td>
<p><em>(Optional)</em> The age pyramid is computed at instant <code>time</code>. Must be a numeric greater than or equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of <code><a href="#topic+population">population</a></code> class representing a data frame of size <code>size</code> containing a population of individuals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop_sample_1e4 &lt;- popsample(pyramid(EW_pop_14$age_pyramid), size = 1e4)

</code></pre>

<hr>
<h2 id='popsim'>Simulation of a model.</h2><span id='topic+popsim'></span>

<h3>Description</h3>

<p>This function simulates the random evolution of an IBM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popsim(
  model,
  initial_population,
  events_bounds,
  parameters = NULL,
  age_max = Inf,
  time,
  multithreading = FALSE,
  num_threads = NULL,
  clean_step = NULL,
  clean_ratio = 0.1,
  seed = NULL,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popsim_+3A_model">model</code></td>
<td>
<p>Model resulting from a call to the function <code><a href="#topic+mk_model">mk_model</a></code>.</p>
</td></tr>
<tr><td><code id="popsim_+3A_initial_population">initial_population</code></td>
<td>
<p>Object of <a href="#topic+population">population</a> class representing the initial population.</p>
</td></tr>
<tr><td><code id="popsim_+3A_events_bounds">events_bounds</code></td>
<td>
<p>Named vector of events bounds, with names corresponding to events names.</p>
</td></tr>
<tr><td><code id="popsim_+3A_parameters">parameters</code></td>
<td>
<p>List of model parameters.</p>
</td></tr>
<tr><td><code id="popsim_+3A_age_max">age_max</code></td>
<td>
<p>Maximum age of individuals in the population (<code>Inf</code> by default).</p>
</td></tr>
<tr><td><code id="popsim_+3A_time">time</code></td>
<td>
<p>Final time (Numeric). Can be of length 1 or a vector of simulation discretized times.</p>
</td></tr>
<tr><td><code id="popsim_+3A_multithreading">multithreading</code></td>
<td>
<p>Logical for multithread activation, <code>FALSE</code> by default. Should be only activated for IBM simulation with no interactions.</p>
</td></tr>
<tr><td><code id="popsim_+3A_num_threads">num_threads</code></td>
<td>
<p><em>(Optional)</em> Number of threads used for multithreading. Set by default to the number of concurrent threads supported by the available hardware implementation.</p>
</td></tr>
<tr><td><code id="popsim_+3A_clean_step">clean_step</code></td>
<td>
<p><em>(Optional)</em> Optional parameter for improving simulation time. Time step for removing dead (or exited) individuals from the population. By default, equal to age_max.</p>
</td></tr>
<tr><td><code id="popsim_+3A_clean_ratio">clean_ratio</code></td>
<td>
<p><em>(Optional)</em> Optional parameter for improving simulation time. 0.1 by default.</p>
</td></tr>
<tr><td><code id="popsim_+3A_seed">seed</code></td>
<td>
<p><em>(Optional)</em> Random generator seed, random by default.</p>
</td></tr>
<tr><td><code id="popsim_+3A_verbose">verbose</code></td>
<td>
<p><em>(Optional)</em> Activate verbose output, FALSE by default.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List composed of </p>

<dl>
<dt>arguments</dt><dd><p>Simulation inputs (initial population, parameters value, multithreading...)</p>
</dd>
<dt>logs</dt><dd><p>Simulation logs (algorithm duration, accepted/rejected events...).</p>
</dd>
<dt>population</dt><dd><p>If <code>time</code> is of length 1, population is an object of type <a href="#topic+population">population</a> containing of all individuals who lived in the population in the time interval <code>[0,time]</code>. If <code>time</code> is a vector (<code>time[1], ..., time[n]</code>), <code>population</code> is a list of <code>n</code> objects of type <a href="#topic+population">population</a>, each representing the state of the population at time <code>time[i]</code>, for <code>i = 1,..., n</code>.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+mk_model">mk_model</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
init_size &lt;- 100000
pop_df &lt;- data.frame(birth = rep(0, init_size), death = NA)
pop &lt;- population(pop_df)

birth = mk_event_poisson(type = 'birth', intensity = 'lambda')
death = mk_event_poisson(type = 'death', intensity = 'mu')
params = list('lambda' = 100, 'mu' = 100)
birth_death &lt;- mk_model(events = list(birth, death),
                       parameters = params)

sim_out &lt;- popsim(model = birth_death,
                 initial_population = pop,
                 events_bounds = c('birth' = params$lambda, 'death' = params$mu),
                 parameters = params,
                 time = 10)
                       
</code></pre>

<hr>
<h2 id='population'>Class population</h2><span id='topic+population'></span>

<h3>Description</h3>

<p>Data frame containing a population,
with at least a birth and a death column, and eventually some other characteristics
</p>


<h3>Usage</h3>

<pre><code class='language-R'>population(x, entry = FALSE, out = FALSE, id = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="population_+3A_x">x</code></td>
<td>
<p>Data frame or list of data frames, containing at least a birth and a death column</p>
</td></tr>
<tr><td><code id="population_+3A_entry">entry</code></td>
<td>
<p>Boolean flag. By default set to FALSE. If set to TRUE the population must contain a column of numerical values named &quot;entry&quot;,
If the column doesn't exist a column named &quot;entry&quot; is added to the data frame with all values set to NA.</p>
</td></tr>
<tr><td><code id="population_+3A_out">out</code></td>
<td>
<p>Boolean flag. By default set to FALSE. If set to TRUE the population must contain a column of boolean values named &quot;out&quot;,
If the column doesn't exist a column named &quot;out&quot; is added to the data frame with all the values set to FALSE.</p>
</td></tr>
<tr><td><code id="population_+3A_id">id</code></td>
<td>
<p>Boolean flag. By default set to FALSE. If set to TRUE the population must contain a column of integer distinct values named &quot;id&quot;.
If the column doesn't exist a column named &quot;id&quot; is added to the data frame with values seq(1, nrow(x)).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Given data frame augmented of the &quot;population&quot; class. If a list of data frames is given,
the column names should contain the string &quot;id&quot; and the list corresponds to the evolution of a population
at different times. The constructor then returns the last population observed in the list
(corresponding to the final state of the population).
</p>

<hr>
<h2 id='population_alive'>Generic method for population_alive</h2><span id='topic+population_alive'></span>

<h3>Description</h3>

<p>Generic method for population_alive
</p>


<h3>Usage</h3>

<pre><code class='language-R'>population_alive(object, t, a1 = 0, a2 = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="population_alive_+3A_object">object</code></td>
<td>
<p>A population.</p>
</td></tr>
<tr><td><code id="population_alive_+3A_t">t</code></td>
<td>
<p>A numeric indicating the time at which alive individuals are observed.</p>
</td></tr>
<tr><td><code id="population_alive_+3A_a1">a1</code></td>
<td>
<p>0 by default. Lower bound for age.</p>
</td></tr>
<tr><td><code id="population_alive_+3A_a2">a2</code></td>
<td>
<p>Inf by default. Upper bound for age.</p>
</td></tr>
<tr><td><code id="population_alive_+3A_...">...</code></td>
<td>
<p>Additional params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>All individuals alive at time <code>t</code> and of age in <code>[a1,a2)</code>.
</p>

<hr>
<h2 id='population_alive.population'>Returns a population of individuals alive.</h2><span id='topic+population_alive.population'></span>

<h3>Description</h3>

<p>Returns a population of individuals alive.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
population_alive(object, t, a1 = 0, a2 = Inf, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="population_alive.population_+3A_object">object</code></td>
<td>
<p>A population data frame containing at least a column <code>birth</code> and <code>death</code>.</p>
</td></tr>
<tr><td><code id="population_alive.population_+3A_t">t</code></td>
<td>
<p>A numeric indicating the time.</p>
</td></tr>
<tr><td><code id="population_alive.population_+3A_a1">a1</code></td>
<td>
<p>0 by default. All individuals of age over <code>a1</code> at <code>t</code> are selected.</p>
</td></tr>
<tr><td><code id="population_alive.population_+3A_a2">a2</code></td>
<td>
<p>Inf by default. All individuals of age below <code>a2</code> at <code>t</code> are selected.</p>
</td></tr>
<tr><td><code id="population_alive.population_+3A_...">...</code></td>
<td>
<p>Additional params.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a population data frame containing all individuals alive at time <code>t</code> and of age in <code>[a1,a2)</code>.
</p>

<hr>
<h2 id='print.event'>Print Event</h2><span id='topic+print.event'></span>

<h3>Description</h3>

<p><code>print</code> method for class &quot;event&quot; giving a short description of an event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'event'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.event_+3A_x">x</code></td>
<td>
<p>Argument of class <code>event</code>.</p>
</td></tr>
<tr><td><code id="print.event_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='print.model'>Printing of a model</h2><span id='topic+print.model'></span>

<h3>Description</h3>

<p><code>print</code> method for class <code>model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'model'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.model_+3A_x">x</code></td>
<td>
<p>argument of class <code>model</code></p>
</td></tr>
<tr><td><code id="print.model_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='print.population'>Printing population</h2><span id='topic+print.population'></span>

<h3>Description</h3>

<p>Print a population
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.population_+3A_x">x</code></td>
<td>
<p>Object of <a href="#topic+population">population</a> class representing a population.</p>
</td></tr>
<tr><td><code id="print.population_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print the population
</p>

<hr>
<h2 id='pyramid'>Class pyramid</h2><span id='topic+pyramid'></span>

<h3>Description</h3>

<p>Data frame containing an age pyramid, with at least an <code>age</code> and a <code>value</code> column,
and eventually some other characteristics. If a <code>male</code> column is present, it must be a logical vector,
if a <code>group</code> column is present, it must be a vector of type character.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pyramid(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pyramid_+3A_x">x</code></td>
<td>
<p>Data frame, containing at least an <code>age</code> and a <code>value</code> column</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Given data frame augmented of the &quot;age_pyramid&quot; class.
</p>

<hr>
<h2 id='stepfun'>Step Function.</h2><span id='topic+stepfun'></span>

<h3>Description</h3>

<p>Given the vectors <code style="white-space: pre;">&#8288;(x[1],...,x[n])&#8288;</code> and <code style="white-space: pre;">&#8288;(y[0],y[1],...,y[n])&#8288;</code> (one value more!), <code>stepfun(x, y)</code> returns an interpolating step function, say <code>f_n</code>. This is the cadlag version (<code>right = FALSE</code>) of the <code>stepfun</code> function from package <code>stats</code>. The step function value <code>f_n(t)</code> equals to the constant <code>y[k-1]</code> for <code>t</code> in <code style="white-space: pre;">&#8288;[x[k-1], x[k])&#8288;</code> so that
</p>
<p style="text-align: center;"><code class="reqn">f_n(t) = \sum_{k=1}^{n+1} y_{k-1} {1}_{[x_{k-1}, x_{k})}(t),</code>
</p>

<p>with<code class="reqn">x_0=-\infty</code> and <code class="reqn">x_{n+1}=+\infty</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stepfun(x, y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="stepfun_+3A_x">x</code></td>
<td>
<p>Numeric vector giving the knots or jump locations of the step function. Must be sorted with unique values.</p>
</td></tr>
<tr><td><code id="stepfun_+3A_y">y</code></td>
<td>
<p>Numeric vector one longer than x, giving the heights of the function values between the c<code>x</code> values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is defined for documentation purposes only. See <code><a href="stats.html#topic+stepfun">stepfun</a></code> and <code><a href="stats.html#topic+approxfun">approxfun</a></code>.
</p>
<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>Objet of class <code><a href="stats.html#topic+stepfun">stepfun</a></code> with option <code>right = FALSE</code> (cadlag function).
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+plot.stepfun">plot.stepfun</a></code> and <code><a href="#topic+max.stepfun">max.stepfun</a></code>.
</p>

<hr>
<h2 id='summary.event'>Summarizing an event</h2><span id='topic+summary.event'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>event</code> giving a detailed description of an event.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'event'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.event_+3A_object">object</code></td>
<td>
<p>Argument of class <code>event</code>.</p>
</td></tr>
<tr><td><code id="summary.event_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.logs'>Summary logs</h2><span id='topic+summary.logs'></span>

<h3>Description</h3>

<p>Summary of the logs of a simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'logs'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.logs_+3A_object">object</code></td>
<td>
<p>Logs of the output of a call to <a href="#topic+popsim">popsim</a> function</p>
</td></tr>
<tr><td><code id="summary.logs_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print column names and number of individuals
</p>

<hr>
<h2 id='summary.model'>Summary of a model</h2><span id='topic+summary.model'></span>

<h3>Description</h3>

<p><code>summary</code> method for class <code>model</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'model'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.model_+3A_object">object</code></td>
<td>
<p>argument of class <code>model</code></p>
</td></tr>
<tr><td><code id="summary.model_+3A_...">...</code></td>
<td>
<p>additional arguments affecting the summary produced.</p>
</td></tr>
</table>

<hr>
<h2 id='summary.population'>Summary population</h2><span id='topic+summary.population'></span>

<h3>Description</h3>

<p>Summary of a population with column names and number of individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'population'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.population_+3A_object">object</code></td>
<td>
<p>Object of <a href="#topic+population">population</a> class representing a population.</p>
</td></tr>
<tr><td><code id="summary.population_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print column names and number of individuals
</p>

<hr>
<h2 id='summary.simulation_output'>Summary simulation output</h2><span id='topic+summary.simulation_output'></span>

<h3>Description</h3>

<p>Summary of a simulation output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simulation_output'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.simulation_output_+3A_object">object</code></td>
<td>
<p>Output of a call to <a href="#topic+popsim">popsim</a> function</p>
</td></tr>
<tr><td><code id="summary.simulation_output_+3A_...">...</code></td>
<td>
<p>Additional arguments affecting the summary produced</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Summary of population(s) and the logs
</p>

<hr>
<h2 id='toy_params'>Toy parameters for IBMPopSim-human_popIMD vignette example.</h2><span id='topic+toy_params'></span>

<h3>Description</h3>

<p>Toy parameters for IBMPopSim-human_popIMD vignette example.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toy_params
</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>birth</code></dt><dd><p>A list of 3 numeric vectors  (<code>alpha</code>, <code>beta</code>, <code>TFR_weights</code>) for creating birth intensity with the Weibull probability density function.</p>
</dd>
<dt><code>swap</code></dt><dd><p>A List of one numeric vector and two data frames  (<code>ages</code>, <code>intensities</code> and <code>distribution</code>) for creating the swap intensity and kernel functions.</p>
</dd>
</dl>


<hr>
<h2 id='weibull'>Weibull function.</h2><span id='topic+weibull'></span>

<h3>Description</h3>

<p>The Weibull (density) function is defined as
</p>
<p style="text-align: center;"><code class="reqn">h(x) = \bigl(\frac{k}{\lambda}\bigr) {\bigl( \frac{x}{\lambda} \bigr)}^{k-1} e^{-(x/\lambda)^k}</code>
</p>

<p>with <code class="reqn">k, \lambda \in (0, +\infty)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weibull(k, lambda = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weibull_+3A_k">k</code></td>
<td>
<p>Shape parameter, a positive real number.</p>
</td></tr>
<tr><td><code id="weibull_+3A_lambda">lambda</code></td>
<td>
<p>Scale parameter, a positive real number, defaults to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A C++ version of this function is available. See <code>vignette('IBMPopSim_cpp')</code> for more details.
</p>


<h3>Value</h3>

<p>The Weibull density function <code>dweibull</code> with shape parameter <code>k</code> and scale parameter <code>lambda</code>, see <code><a href="stats.html#topic+dweibull">dweibull</a></code>.
</p>


<h3>See Also</h3>

<p><a href="https://en.wikipedia.org/wiki/Weibull_distribution">https://en.wikipedia.org/wiki/Weibull_distribution</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
