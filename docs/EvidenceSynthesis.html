<!DOCTYPE html><html><head><title>Help for package EvidenceSynthesis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {EvidenceSynthesis}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EvidenceSynthesis-package'><p>EvidenceSynthesis: Synthesizing Causal Evidence in a Distributed Research Network</p></a></li>
<li><a href='#approximateHierarchicalNormalPosterior'><p>Approximate Bayesian posterior for hierarchical Normal model</p></a></li>
<li><a href='#approximateLikelihood'><p>Approximate a likelihood function</p></a></li>
<li><a href='#approximateSimplePosterior'><p>Approximate simple Bayesian posterior</p></a></li>
<li><a href='#biasCorrectionInference'><p>Bias Correction with Inference</p></a></li>
<li><a href='#computeBayesianMetaAnalysis'><p>Compute a Bayesian random-effects meta-analysis</p></a></li>
<li><a href='#computeConfidenceInterval'><p>Compute the point estimate and confidence interval given a likelihood function approximation</p></a></li>
<li><a href='#computeFixedEffectMetaAnalysis'><p>Compute a fixed-effect meta-analysis</p></a></li>
<li><a href='#createSimulationSettings'><p>Create simulation settings</p></a></li>
<li><a href='#customFunction'><p>A custom function to approximate a log likelihood function</p></a></li>
<li><a href='#detectApproximationType'><p>Detect the type of likelihood approximation based on the data format</p></a></li>
<li><a href='#fitBiasDistribution'><p>Fit Bias Distribution</p></a></li>
<li><a href='#ncLikelihoods'><p>Example profile likelihoods for negative control outcomes</p></a></li>
<li><a href='#ooiLikelihoods'><p>Example profile likelihoods for a synthetic outcome of interest</p></a></li>
<li><a href='#plotBiasCorrectionInference'><p>Plot bias correction inference</p></a></li>
<li><a href='#plotBiasDistribution'><p>Plot bias distributions</p></a></li>
<li><a href='#plotCovariateBalances'><p>Plot covariate balances</p></a></li>
<li><a href='#plotEmpiricalNulls'><p>Plot empirical null distributions</p></a></li>
<li><a href='#plotLikelihoodFit'><p>Plot the likelihood approximation</p></a></li>
<li><a href='#plotMcmcTrace'><p>Plot MCMC trace</p></a></li>
<li><a href='#plotMetaAnalysisForest'><p>Create a forest plot</p></a></li>
<li><a href='#plotPerDbMcmcTrace'><p>Plot MCMC trace for individual databases</p></a></li>
<li><a href='#plotPerDbPosterior'><p>Plot posterior density per database</p></a></li>
<li><a href='#plotPosterior'><p>Plot posterior density</p></a></li>
<li><a href='#plotPreparedPs'><p>Plot the propensity score distribution</p></a></li>
<li><a href='#preparePsPlot'><p>Prepare to plot the propensity score distribution</p></a></li>
<li><a href='#sequentialFitBiasDistribution'><p>Fit Bias Distribution Sequentially or in Groups</p></a></li>
<li><a href='#simulatePopulations'><p>Simulate survival data for multiple databases</p></a></li>
<li><a href='#skewNormal'><p>The skew normal function to approximate a log likelihood function</p></a></li>
<li><a href='#supportsJava8'><p>Determine if Java virtual machine supports Java</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Synthesizing Causal Evidence in a Distributed Research Network</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-08</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martijn Schuemie &lt;schuemie@ohdsi.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for combining causal effect estimates and study diagnostics across multiple data sites in a distributed study, without sharing patient-level data. 
  Allows for normal and non-normal approximations of the data-site likelihood of the effect parameter. </td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>Java (&gt;= 8)</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggdist, gridExtra, meta, EmpiricalCalibration,
rJava, BeastJar, Cyclops (&ge; 3.1.0), HDInterval, coda, rlang,
methods</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat, sn</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License 2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ohdsi.github.io/EvidenceSynthesis/">https://ohdsi.github.io/EvidenceSynthesis/</a>,
<a href="https://github.com/OHDSI/EvidenceSynthesis">https://github.com/OHDSI/EvidenceSynthesis</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/OHDSI/EvidenceSynthesis/issues">https://github.com/OHDSI/EvidenceSynthesis/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-08 11:57:19 UTC; MSCHUEMI</td>
</tr>
<tr>
<td>Author:</td>
<td>Martijn Schuemie [aut, cre],
  Marc A. Suchard [aut],
  Fan Bu [aut],
  Observational Health Data Science and Informatics [cph]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-08 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='EvidenceSynthesis-package'>EvidenceSynthesis: Synthesizing Causal Evidence in a Distributed Research Network</h2><span id='topic+EvidenceSynthesis'></span><span id='topic+EvidenceSynthesis-package'></span>

<h3>Description</h3>

<p>Routines for combining causal effect estimates and study diagnostics across multiple data sites in a distributed study, without sharing patient-level data. Allows for normal and non-normal approximations of the data-site likelihood of the effect parameter.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Martijn Schuemie <a href="mailto:schuemie@ohdsi.org">schuemie@ohdsi.org</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Marc A. Suchard <a href="mailto:msuchard@ucla.edu">msuchard@ucla.edu</a>
</p>
</li>
<li><p> Fan Bu <a href="mailto:fanbu@ucla.edu">fanbu@ucla.edu</a>
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Observational Health Data Science and Informatics [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ohdsi.github.io/EvidenceSynthesis/">https://ohdsi.github.io/EvidenceSynthesis/</a>
</p>
</li>
<li> <p><a href="https://github.com/OHDSI/EvidenceSynthesis">https://github.com/OHDSI/EvidenceSynthesis</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/OHDSI/EvidenceSynthesis/issues">https://github.com/OHDSI/EvidenceSynthesis/issues</a>
</p>
</li></ul>


<hr>
<h2 id='approximateHierarchicalNormalPosterior'>Approximate Bayesian posterior for hierarchical Normal model</h2><span id='topic+approximateHierarchicalNormalPosterior'></span>

<h3>Description</h3>

<p>Approximate a Bayesian posterior from a set of<code>Cyclops</code> likelihood profiles
under a hierarchical normal model
using the Markov chain Monte Carlo engine BEAST.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approximateHierarchicalNormalPosterior(
  likelihoodProfiles,
  chainLength = 1100000,
  burnIn = 1e+05,
  subSampleFrequency = 100,
  effectPriorMean = 0,
  effectPriorSd = 0.5,
  nu0 = 1,
  sigma0 = 1,
  effectStartingValue = 0,
  precisionStartingValue = 1,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_likelihoodprofiles">likelihoodProfiles</code></td>
<td>
<p>List of grid likelihoods profiled with <code>Cyclops</code>.</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_chainlength">chainLength</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_burnin">burnIn</code></td>
<td>
<p>Number of MCMC iterations to consider as burn in.</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_subsamplefrequency">subSampleFrequency</code></td>
<td>
<p>Subsample frequency for the MCMC.</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_effectpriormean">effectPriorMean</code></td>
<td>
<p>Prior mean for global parameter</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_effectpriorsd">effectPriorSd</code></td>
<td>
<p>Prior standard deviation for the global parameter</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_nu0">nu0</code></td>
<td>
<p>Prior &quot;sample size&quot; for precision
(with precision ~ gamma(nu0/2, nu0*sigma0/2))</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_sigma0">sigma0</code></td>
<td>
<p>Prior &quot;variance&quot; for precision
(with precision ~ gamma(nu0/2, nu0*sigma0/2))</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_effectstartingvalue">effectStartingValue</code></td>
<td>
<p>Initial value for global &amp; local parameter</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_precisionstartingvalue">precisionStartingValue</code></td>
<td>
<p>Initial value for the precision</p>
</td></tr>
<tr><td><code id="approximateHierarchicalNormalPosterior_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the point estimates and 95% credible intervals for the
the global and local parameter, as well as the global precision.
Attributes of the data frame contain the MCMC trace for diagnostics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># TBD

</code></pre>

<hr>
<h2 id='approximateLikelihood'>Approximate a likelihood function</h2><span id='topic+approximateLikelihood'></span>

<h3>Description</h3>

<p>Approximate the likelihood function using a parametric (normal, skew-normal, or custom parametric),
or grid approximation. The approximation does not reveal person-level information, and can
therefore be shared among data sites. When counts are low, a normal approximation might not be
appropriate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approximateLikelihood(
  cyclopsFit,
  parameter = 1,
  approximation = "custom",
  bounds = c(log(0.1), log(10))
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approximateLikelihood_+3A_cyclopsfit">cyclopsFit</code></td>
<td>
<p>A model fitted using the <code><a href="Cyclops.html#topic+fitCyclopsModel">Cyclops::fitCyclopsModel()</a></code> function.</p>
</td></tr>
<tr><td><code id="approximateLikelihood_+3A_parameter">parameter</code></td>
<td>
<p>The parameter in the <code>cyclopsFit</code> object to profile.</p>
</td></tr>
<tr><td><code id="approximateLikelihood_+3A_approximation">approximation</code></td>
<td>
<p>The type of approximation. Valid options are <code>'normal'</code>, <code>'skew normal'</code>,
<code>'custom'</code>, <code>'grid'</code>, or <code>'adaptive grid'</code>.</p>
</td></tr>
<tr><td><code id="approximateLikelihood_+3A_bounds">bounds</code></td>
<td>
<p>The bounds on the effect size used to fit the approximation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of parameters of the likelihood approximation.
</p>


<h3>See Also</h3>

<p><a href="#topic+computeConfidenceInterval">computeConfidenceInterval</a>, <a href="#topic+computeFixedEffectMetaAnalysis">computeFixedEffectMetaAnalysis</a>, <a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = populations[[1]],
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
approximation &lt;- approximateLikelihood(cyclopsFit, "x")
approximation

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='approximateSimplePosterior'>Approximate simple Bayesian posterior</h2><span id='topic+approximateSimplePosterior'></span>

<h3>Description</h3>

<p>Approximate a Bayesian posterior from a <code>Cyclops</code> likelihood profile and normal prior
using the Markov chain Monte Carlo engine BEAST.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approximateSimplePosterior(
  likelihoodProfile,
  chainLength = 1100000,
  burnIn = 1e+05,
  subSampleFrequency = 100,
  priorMean = 0,
  priorSd = 0.5,
  startingValue = 0,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approximateSimplePosterior_+3A_likelihoodprofile">likelihoodProfile</code></td>
<td>
<p>Named vector containing grid likelihood data from <code>Cyclops</code>.</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_chainlength">chainLength</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_burnin">burnIn</code></td>
<td>
<p>Number of MCMC iterations to consider as burn in.</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_subsamplefrequency">subSampleFrequency</code></td>
<td>
<p>Subsample frequency for the MCMC.</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_priormean">priorMean</code></td>
<td>
<p>Prior mean for the regression parameter</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_priorsd">priorSd</code></td>
<td>
<p>Prior standard deviation for the regression parameter</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_startingvalue">startingValue</code></td>
<td>
<p>Initial state for regression parameter</p>
</td></tr>
<tr><td><code id="approximateSimplePosterior_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the point estimates and 95% credible intervals for the regression parameter.
Attributes of the data frame contain the MCMC trace for diagnostics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
population &lt;- simulatePopulations(createSimulationSettings(nSites = 1))[[1]]

# Fit a Cox regression at each data site, and approximate likelihood function:
cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = population,
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
likelihoodProfile &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "grid")

# Run MCMC
mcmcTraces &lt;- approximateSimplePosterior(
  likelihoodProfile = likelihoodProfile,
  priorMean = 0, priorSd = 100
)

# Report posterior expectation
mean(mcmcTraces$theta)

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='biasCorrectionInference'>Bias Correction with Inference</h2><span id='topic+biasCorrectionInference'></span>

<h3>Description</h3>

<p>Perform Bayesian posterior inference regarding an outcome of interest with bias correction
using negative control analysis. There is an option to not perform bias correction so that
un-corrected results can be obtained.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>biasCorrectionInference(
  likelihoodProfiles,
  ncLikelihoodProfiles = NULL,
  biasDistributions = NULL,
  priorMean = 0,
  priorSd = 1,
  numsamps = 10000,
  thin = 10,
  doCorrection = TRUE,
  seed = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="biasCorrectionInference_+3A_likelihoodprofiles">likelihoodProfiles</code></td>
<td>
<p>A list of grid profile likelihoods for the outcome of interest.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_nclikelihoodprofiles">ncLikelihoodProfiles</code></td>
<td>
<p>Likelihood profiles for the negative control outcomes.
Must be a list of lists of profile likelihoods;
if there is only one analysis period, then this must be a length-1 list,
with the first item as a list all outcome-wise profile likelihoods.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_biasdistributions">biasDistributions</code></td>
<td>
<p>Pre-saved bias distribution(s), formatted as the output
from <code><a href="#topic+fitBiasDistribution">fitBiasDistribution()</a></code> or <code><a href="#topic+sequentialFitBiasDistribution">sequentialFitBiasDistribution()</a></code>.
If NULL, then <code>ncLikelihoodProfiles</code> must be provided.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_priormean">priorMean</code></td>
<td>
<p>Prior mean for the effect size (log rate ratio).</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_priorsd">priorSd</code></td>
<td>
<p>Prior standard deviation for the effect size (log rate ratio).</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_numsamps">numsamps</code></td>
<td>
<p>Total number of MCMC samples needed.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_thin">thin</code></td>
<td>
<p>Thinning frequency: how many iterations before another sample is obtained?</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_docorrection">doCorrection</code></td>
<td>
<p>Whether or not to perform bias correction; default: TRUE.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator.</p>
</td></tr>
<tr><td><code id="biasCorrectionInference_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to <code><a href="#topic+sequentialFitBiasDistribution">sequentialFitBiasDistribution()</a></code> to fit
bias distributions if <code>biasDistributions</code> is NULL.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with five columns, including posterior <code>median</code> and <code>mean</code> of log RR
effect size estimates, 95% credible intervals (<code>ci95Lb</code> and <code>ci95Ub</code>),
posterior probability that log RR &gt; 0 (<code>p1</code>), and the period or group ID (<code>Id</code>).
</p>
<p>It is accompanied by the following attributes:
</p>

<ul>
<li> <p><code>samplesCorrected</code>: all MCMC samples for the bias corrected log RR effect size estimate.
</p>
</li>
<li> <p><code>samplesRaw</code>: all MCMC samples for log RR effect size estimate, without bias correction.
</p>
</li>
<li> <p><code>biasDistributions</code>: the learned empirical bias distribution from negative control analysis.
</p>
</li>
<li> <p><code>summaryRaw</code>: a summary dataframe (same format as in the main result) without bias correction.
</p>
</li>
<li> <p><code>corrected</code>: a logical flag indicating if bias correction has been performed; = TRUE if <code>doCorrection = TRUE</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><a href="#topic+approximateSimplePosterior">approximateSimplePosterior</a>, <a href="#topic+fitBiasDistribution">fitBiasDistribution</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load example data
data("ncLikelihoods")
data("ooiLikelihoods")

# perform sequential analysis with bias correction, using the t model
# NOT RUN
# bbcResults = biasCorrectionInference(ooiLikelihoods,
#                                      ncLikelihoodProfiles = ncLikelihoods,
#                                      robust = TRUE,
#                                      seed = 42)

# check out analysis summary
# bbcResults

</code></pre>

<hr>
<h2 id='computeBayesianMetaAnalysis'>Compute a Bayesian random-effects meta-analysis</h2><span id='topic+computeBayesianMetaAnalysis'></span>

<h3>Description</h3>

<p>Compute a Bayesian meta-analysis using the Markov chain Monte Carlo (MCMC) engine BEAST.
A normal and half-normal prior are used for the mu and tau parameters, respectively, with standard
deviations as defined by the <code>priorSd</code> argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeBayesianMetaAnalysis(
  data,
  chainLength = 1100000,
  burnIn = 1e+05,
  subSampleFrequency = 100,
  priorSd = c(2, 0.5),
  alpha = 0.05,
  robust = FALSE,
  df = 4,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_data">data</code></td>
<td>
<p>A data frame containing either normal, skew-normal, custom parametric,
or grid likelihood data, with one row per database.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_chainlength">chainLength</code></td>
<td>
<p>Number of MCMC iterations.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_burnin">burnIn</code></td>
<td>
<p>Number of MCMC iterations to consider as burn in.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_subsamplefrequency">subSampleFrequency</code></td>
<td>
<p>Subsample frequency for the MCMC.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_priorsd">priorSd</code></td>
<td>
<p>A two-dimensional vector with the standard deviation of the prior for mu
and tau, respectively.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_alpha">alpha</code></td>
<td>
<p>The alpha (expected type I error) used for the credible intervals.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_robust">robust</code></td>
<td>
<p>Whether or not to use a t-distribution model; default: FALSE.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for the t-model, only used if robust is TRUE.</p>
</td></tr>
<tr><td><code id="computeBayesianMetaAnalysis_+3A_seed">seed</code></td>
<td>
<p>The seed for the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with the point estimates and 95% credible intervals for the mu and tau parameters (the
mean and standard deviation of the distribution from which the per-site effect sizes are drawn).
Attributes of the data frame contain the MCMC trace and the detected approximation type.
</p>


<h3>See Also</h3>

<p><a href="#topic+approximateLikelihood">approximateLikelihood</a>, <a href="#topic+computeFixedEffectMetaAnalysis">computeFixedEffectMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
estimate

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='computeConfidenceInterval'>Compute the point estimate and confidence interval given a likelihood function approximation</h2><span id='topic+computeConfidenceInterval'></span>

<h3>Description</h3>

<p>Compute the point estimate and confidence interval given a likelihood function approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeConfidenceInterval(approximation, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeConfidenceInterval_+3A_approximation">approximation</code></td>
<td>
<p>An approximation of the likelihood function as fitted using the
<code><a href="#topic+approximateLikelihood">approximateLikelihood()</a></code> function.</p>
</td></tr>
<tr><td><code id="computeConfidenceInterval_+3A_alpha">alpha</code></td>
<td>
<p>The alpha (expected type I error).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Compute the point estimate and confidence interval given a likelihood function approximation.
</p>


<h3>Value</h3>

<p>A data frame containing the point estimate, and upper and lower bound of the confidence interval.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = populations[[1]],
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
approximation &lt;- approximateLikelihood(cyclopsFit, "x")
computeConfidenceInterval(approximation)

</code></pre>

<hr>
<h2 id='computeFixedEffectMetaAnalysis'>Compute a fixed-effect meta-analysis</h2><span id='topic+computeFixedEffectMetaAnalysis'></span>

<h3>Description</h3>

<p>Compute a fixed-effect meta-analysis using a choice of various likelihood approximations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeFixedEffectMetaAnalysis(data, alpha = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeFixedEffectMetaAnalysis_+3A_data">data</code></td>
<td>
<p>A data frame containing either normal, skew-normal, custom parametric, or grid
likelihood data. One row per database.</p>
</td></tr>
<tr><td><code id="computeFixedEffectMetaAnalysis_+3A_alpha">alpha</code></td>
<td>
<p>The alpha (expected type I error) used for the confidence intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The meta-analytic estimate, expressed as the point estimate hazard ratio (rr), its 95 percent
confidence interval (lb, ub), as well as the log of the point estimate (logRr), and the standard
error (seLogRr).
</p>


<h3>See Also</h3>

<p><a href="#topic+approximateLikelihood">approximateLikelihood</a>, <a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
computeFixedEffectMetaAnalysis(approximations)

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='createSimulationSettings'>Create simulation settings</h2><span id='topic+createSimulationSettings'></span>

<h3>Description</h3>

<p>Create an object specifying a simulation. Currently only Cox proportional hazard models are
supported.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createSimulationSettings(
  nSites = 5,
  n = 10000,
  treatedFraction = 0.2,
  nStrata = 10,
  minBackgroundHazard = 2e-07,
  maxBackgroundHazard = 2e-05,
  hazardRatio = 2,
  randomEffectSd = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createSimulationSettings_+3A_nsites">nSites</code></td>
<td>
<p>Number of database sites to simulate.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_n">n</code></td>
<td>
<p>Number of subjects per site. Either a single number, or a vector of
length nSites.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_treatedfraction">treatedFraction</code></td>
<td>
<p>Fraction of subjects that is treated. Either a single number, or a
vector of length nSites.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_nstrata">nStrata</code></td>
<td>
<p>Number of strata per site. Either a single number, or a vector of
length nSites.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_minbackgroundhazard">minBackgroundHazard</code></td>
<td>
<p>Minimum background hazard. Either a single number, or a vector of
length nSites.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_maxbackgroundhazard">maxBackgroundHazard</code></td>
<td>
<p>Maximum background hazard. Either a single number, or a vector of
length nSites.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_hazardratio">hazardRatio</code></td>
<td>
<p>Hazard ratio.</p>
</td></tr>
<tr><td><code id="createSimulationSettings_+3A_randomeffectsd">randomEffectSd</code></td>
<td>
<p>Standard deviation of the log(hazardRatio). Fixed effect if equal to 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of type <code>simulationSettings</code>, to be used in the <code><a href="#topic+simulatePopulations">simulatePopulations()</a></code> function.
</p>


<h3>See Also</h3>

<p><a href="#topic+simulatePopulations">simulatePopulations</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>settings &lt;- createSimulationSettings(nSites = 1, hazardRatio = 2)
populations &lt;- simulatePopulations(settings)

# Fit a Cox regression for the simulated data site:
cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = populations[[1]],
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
coef(cyclopsFit)

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='customFunction'>A custom function to approximate a log likelihood function</h2><span id='topic+customFunction'></span>

<h3>Description</h3>

<p>A custom function to approximate a log likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>customFunction(x, mu, sigma, gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="customFunction_+3A_x">x</code></td>
<td>
<p>The log(hazard ratio) for which to approximate the log likelihood.</p>
</td></tr>
<tr><td><code id="customFunction_+3A_mu">mu</code></td>
<td>
<p>The position parameter.</p>
</td></tr>
<tr><td><code id="customFunction_+3A_sigma">sigma</code></td>
<td>
<p>The scale parameter.</p>
</td></tr>
<tr><td><code id="customFunction_+3A_gamma">gamma</code></td>
<td>
<p>The skew parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A custom parametric function designed to approximate the shape of the Cox log likelihood function.
When <code>gamma = 0</code> this function is the normal distribution.
</p>


<h3>Value</h3>

<p>The approximate log likelihood for the given x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>customFunction(x = 0:3, mu = 0, sigma = 1, gamma = 0)

</code></pre>

<hr>
<h2 id='detectApproximationType'>Detect the type of likelihood approximation based on the data format</h2><span id='topic+detectApproximationType'></span>

<h3>Description</h3>

<p>Detect the type of likelihood approximation based on the data format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detectApproximationType(data, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detectApproximationType_+3A_data">data</code></td>
<td>
<p>The approximation data. Can be a single approximation, or approximations
from multiple sites.</p>
</td></tr>
<tr><td><code id="detectApproximationType_+3A_verbose">verbose</code></td>
<td>
<p>Should the detected type be communicated to the user?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector with one of the following values: &quot;normal&quot;, &quot;custom&quot;, &quot;skew normal&quot;,
&quot;pooled&quot;, &quot;grid&quot;, or &quot;adaptive grid&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>detectApproximationType(data.frame(logRr = 1, seLogRr = 0.1))

</code></pre>

<hr>
<h2 id='fitBiasDistribution'>Fit Bias Distribution</h2><span id='topic+fitBiasDistribution'></span>

<h3>Description</h3>

<p>Learn an empirical distribution on estimation bias by simultaneously analyzing
a large set of negative control outcomes by a Bayesian hierarchical model through MCMC.
Analysis is based on a list of extracted likelihood profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitBiasDistribution(
  likelihoodProfiles,
  priorSds = c(2, 0.5),
  numsamps = 10000,
  thin = 10,
  minNCs = 5,
  robust = FALSE,
  df = 4,
  seed = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitBiasDistribution_+3A_likelihoodprofiles">likelihoodProfiles</code></td>
<td>
<p>A list of grid profile likelihoods regarding negative controls.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_priorsds">priorSds</code></td>
<td>
<p>A two-dimensional vector with the standard deviation of the prior for
the average bias and the sd/scale parameter, respectively.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_numsamps">numsamps</code></td>
<td>
<p>Total number of MCMC samples needed.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_thin">thin</code></td>
<td>
<p>Thinning frequency: how many iterations before another sample is obtained?</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_minncs">minNCs</code></td>
<td>
<p>Minimum number of negative controls needed to fit a bias distribution;
default (also recommended): 5.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_robust">robust</code></td>
<td>
<p>Whether or not to use a t-distribution model; default: FALSE.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_df">df</code></td>
<td>
<p>Degrees of freedom for the t-model, only used if robust is TRUE.</p>
</td></tr>
<tr><td><code id="fitBiasDistribution_+3A_seed">seed</code></td>
<td>
<p>Seed for the random number generator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with three columns and <code>numsamps</code> number of rows.
Column <code>mean</code> includes MCMC samples for the average bias,
<code>scale</code> for the sd/scale parameter,
and <code>bias</code> for predictive samples of the bias.
</p>


<h3>See Also</h3>

<p><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load example data
data("ncLikelihoods")

# fit a bias distributions by analyzing a set of negative control outcomes
# for example, for the 5th analysis period, and using the t model
# NOT RUN
# biasDistribution = fitBiasDistribution(ncLikelihoods[[5]], robust = TRUE)

</code></pre>

<hr>
<h2 id='ncLikelihoods'>Example profile likelihoods for negative control outcomes</h2><span id='topic+ncLikelihoods'></span>

<h3>Description</h3>

<p>A list that contain profile likelihoods a large set of negative control outcomes.
They are extracted from a real-world observational healthcare database, with the
likelihoods profiled using adaptive grids using the <code>Cyclops</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ncLikelihoods
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> containing 12 lists, where each list includes
several dataframes ith column <code>point</code> and <code>value</code> for adaptive grid profile likelihoods.
</p>


<h3>References</h3>

<p>Schuemie et al. (2022). Vaccine safety surveillance using routinely collected
healthcare data—an empirical evaluation of epidemiological designs. Frontiers in Pharmacology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ncLikelihoods")
ncLikEx &lt;- ncLikelihoods[["5"]][[1]]

plot(value ~ point, data = ncLikEx)

</code></pre>

<hr>
<h2 id='ooiLikelihoods'>Example profile likelihoods for a synthetic outcome of interest</h2><span id='topic+ooiLikelihoods'></span>

<h3>Description</h3>

<p>A list that contain profile likelihoods for a synthetic outcome of interest.
They are extracted from a real-world observational healthcare database, with the
likelihoods profiled using adaptive grids using the <code>Cyclops</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ooiLikelihoods
</code></pre>


<h3>Format</h3>

<p>An objects of class <code>list</code>; the list contains 12 lists,
where each list includes several dataframes with column <code>point</code> and <code>value</code>
for adaptive grid profile likelihoods.
</p>


<h3>References</h3>

<p>Schuemie et al. (2022). Vaccine safety surveillance using routinely collected
healthcare data—an empirical evaluation of epidemiological designs. Frontiers in Pharmacology.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("ooiLikelihoods")
ooiLikEx &lt;- ooiLikelihoods[["5"]][[1]]

plot(value ~ point, data = ooiLikEx)

</code></pre>

<hr>
<h2 id='plotBiasCorrectionInference'>Plot bias correction inference</h2><span id='topic+plotBiasCorrectionInference'></span>

<h3>Description</h3>

<p>Plot bias correction inference
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBiasCorrectionInference(
  bbcResult,
  type = "raw",
  ids = bbcResult$Id,
  limits = c(-3, 3),
  logScale = FALSE,
  numericId = TRUE,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBiasCorrectionInference_+3A_bbcresult">bbcResult</code></td>
<td>
<p>A (sequential) analysis object generated by the <code><a href="#topic+biasCorrectionInference">biasCorrectionInference()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_type">type</code></td>
<td>
<p>The type of plot. Must be one of <code>c("corrected", "raw", "compare")</code>.</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_ids">ids</code></td>
<td>
<p>IDs of the periods/groups to plot result for; default is all IDs.</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_limits">limits</code></td>
<td>
<p>The limits on log RR for plotting.</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_logscale">logScale</code></td>
<td>
<p>Whether or not to show bias in log-RR; default FALSE (shown in RR).</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_numericid">numericId</code></td>
<td>
<p>Whether or not to treat <code>Id</code> as a numeric variable; default: TRUE.</p>
</td></tr>
<tr><td><code id="plotBiasCorrectionInference_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot empirical bias distributions learned from analyzing negative controls.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="#topic+biasCorrectionInference">biasCorrectionInference</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Perform sequential analysis using Bayesian bias correction for this example:
data("ncLikelihoods")
data("ooiLikelihoods")
# NOT RUN
# bbcSequential = biasCorrectionInference(ooiLikelihoods, ncLikelihoodProfiles = ncLikelihoods)

# Plot it
# NOT RUN
# plotBiasCorrectionInference(bbcSequential, type = "corrected")

</code></pre>

<hr>
<h2 id='plotBiasDistribution'>Plot bias distributions</h2><span id='topic+plotBiasDistribution'></span>

<h3>Description</h3>

<p>Plot bias distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotBiasDistribution(
  biasDist,
  limits = c(-2, 2),
  logScale = FALSE,
  numericId = TRUE,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotBiasDistribution_+3A_biasdist">biasDist</code></td>
<td>
<p>A bias distribution object generated by the <code><a href="#topic+fitBiasDistribution">fitBiasDistribution()</a></code> or <code><a href="#topic+sequentialFitBiasDistribution">sequentialFitBiasDistribution()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotBiasDistribution_+3A_limits">limits</code></td>
<td>
<p>The lower and upper limits in log-RR to plot.</p>
</td></tr>
<tr><td><code id="plotBiasDistribution_+3A_logscale">logScale</code></td>
<td>
<p>Whether or not to show bias in log-RR; default FALSE (shown in RR).</p>
</td></tr>
<tr><td><code id="plotBiasDistribution_+3A_numericid">numericId</code></td>
<td>
<p>(For sequential or group case only) whether or not to treat <code>Id</code> as a numeric variable; default: TRUE.</p>
</td></tr>
<tr><td><code id="plotBiasDistribution_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot empirical bias distributions learned from analyzing negative controls.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="#topic+fitBiasDistribution">fitBiasDistribution</a>, <a href="#topic+sequentialFitBiasDistribution">sequentialFitBiasDistribution</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Fit a bias distribution for this example:
data("ncLikelihoods")
# NOT RUN
# singleBiasDist = fitBiasDistribution(ncLikelihoods[[5]], seed = 1)

# Plot it
# NOT RUN
# plotBiasDistribution(singleBiasDist)

</code></pre>

<hr>
<h2 id='plotCovariateBalances'>Plot covariate balances</h2><span id='topic+plotCovariateBalances'></span>

<h3>Description</h3>

<p>Plots the covariate balance before and after matching for multiple data sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCovariateBalances(
  balances,
  labels,
  threshold = 0,
  beforeLabel = "Before matching",
  afterLabel = "After matching",
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCovariateBalances_+3A_balances">balances</code></td>
<td>
<p>A list of covariate balance objects as created using the
<code>computeCovariateBalance()</code> function in the <code>CohortMethod</code> package. Each
balance object is expected to be a data frame with at least these two columns:
<code>beforeMatchingStdDiff</code> and <code>afterMatchingStdDiff</code>.</p>
</td></tr>
<tr><td><code id="plotCovariateBalances_+3A_labels">labels</code></td>
<td>
<p>A vector containing the labels for the various sources.</p>
</td></tr>
<tr><td><code id="plotCovariateBalances_+3A_threshold">threshold</code></td>
<td>
<p>Show a threshold value for the standardized difference.</p>
</td></tr>
<tr><td><code id="plotCovariateBalances_+3A_beforelabel">beforeLabel</code></td>
<td>
<p>Label for before matching / stratification / trimming.</p>
</td></tr>
<tr><td><code id="plotCovariateBalances_+3A_afterlabel">afterLabel</code></td>
<td>
<p>Label for after matching / stratification / trimming.</p>
</td></tr>
<tr><td><code id="plotCovariateBalances_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> for supported file formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a plot showing the covariate balance before and after matching. Balance distributions are
displayed as box plots combined with scatterplots.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some example data:
balance1 &lt;- data.frame(
  beforeMatchingStdDiff = rnorm(1000, 0.1, 0.1),
  afterMatchingStdDiff = rnorm(1000, 0, 0.01)
)
balance2 &lt;- data.frame(
  beforeMatchingStdDiff = rnorm(1000, 0.2, 0.1),
  afterMatchingStdDiff = rnorm(1000, 0, 0.05)
)
balance3 &lt;- data.frame(
  beforeMatchingStdDiff = rnorm(1000, 0, 0.1),
  afterMatchingStdDiff = rnorm(1000, 0, 0.03)
)
plotCovariateBalances(
  balances = list(balance1, balance2, balance3),
  labels = c("Site A", "Site B", "Site C")
)

</code></pre>

<hr>
<h2 id='plotEmpiricalNulls'>Plot empirical null distributions</h2><span id='topic+plotEmpiricalNulls'></span>

<h3>Description</h3>

<p>Plot the empirical null distribution for multiple data sources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotEmpiricalNulls(
  logRr,
  seLogRr,
  labels,
  xLabel = "Relative risk",
  limits = c(0.1, 10),
  showCis = TRUE,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotEmpiricalNulls_+3A_logrr">logRr</code></td>
<td>
<p>A numeric vector of effect estimates for the negative controls on the log scale.</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_selogrr">seLogRr</code></td>
<td>
<p>The standard error of the log of the effect estimates. Hint: often the standard
error = (log(lower bound 95 percent confidence interval) - l og(effect
estimate))/qnorm(0.025).</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_labels">labels</code></td>
<td>
<p>A vector containing the labels for the various sources. Should be of equal length
as <code>logRr</code> and <code>seLogRr</code>.</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_xlabel">xLabel</code></td>
<td>
<p>The label on the x-axis: the name of the effect estimate.</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_limits">limits</code></td>
<td>
<p>The limits of the effect size axis.</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_showcis">showCis</code></td>
<td>
<p>Show the 95 percent confidence intervals on the null distribution and distribution
parameter estimates?</p>
</td></tr>
<tr><td><code id="plotEmpiricalNulls_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See the
function <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> for supported file formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a plot showing the empirical null distributions. Distributions are shown as mean plus minus
one standard deviation, as well as a distribution plot.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <code><a href="ggplot2.html#topic+ggsave">ggplot2::ggsave()</a></code> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="EmpiricalCalibration.html#topic+fitNull">EmpiricalCalibration::fitNull</a>, <a href="EmpiricalCalibration.html#topic+fitMcmcNull">EmpiricalCalibration::fitMcmcNull</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some example data:
site1 &lt;- EmpiricalCalibration::simulateControls(n = 50, mean = 0, sd = 0.1, trueLogRr = 0)
site1$label &lt;- "Site 1"
site2 &lt;- EmpiricalCalibration::simulateControls(n = 50, mean = 0.1, sd = 0.2, trueLogRr = 0)
site2$label &lt;- "Site 2"
site3 &lt;- EmpiricalCalibration::simulateControls(n = 50, mean = 0.15, sd = 0.25, trueLogRr = 0)
site3$label &lt;- "Site 3"
sites &lt;- rbind(site1, site2, site3)

plotEmpiricalNulls(logRr = sites$logRr, seLogRr = sites$seLogRr, labels = sites$label)

</code></pre>

<hr>
<h2 id='plotLikelihoodFit'>Plot the likelihood approximation</h2><span id='topic+plotLikelihoodFit'></span>

<h3>Description</h3>

<p>Plot the likelihood approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotLikelihoodFit(
  approximation,
  cyclopsFit,
  parameter = "x",
  logScale = TRUE,
  xLabel = "Hazard Ratio",
  limits = c(0.1, 10),
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotLikelihoodFit_+3A_approximation">approximation</code></td>
<td>
<p>An approximation of the likelihood function as fitted using the
<code><a href="#topic+approximateLikelihood">approximateLikelihood()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_cyclopsfit">cyclopsFit</code></td>
<td>
<p>A model fitted using the <code><a href="Cyclops.html#topic+fitCyclopsModel">Cyclops::fitCyclopsModel()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_parameter">parameter</code></td>
<td>
<p>The parameter in the <code>cyclopsFit</code> object to profile.</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_logscale">logScale</code></td>
<td>
<p>Show the y-axis on the log scale?</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_xlabel">xLabel</code></td>
<td>
<p>The title of the x-axis.</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_limits">limits</code></td>
<td>
<p>The limits on the x-axis.</p>
</td></tr>
<tr><td><code id="plotLikelihoodFit_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots the (log) likelihood and the approximation of the likelihood. Allows for reviewing the
approximation.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a single database population:
population &lt;- simulatePopulations(createSimulationSettings(nSites = 1))[[1]]

# Approximate the likelihood:
cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = population,
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")

plotLikelihoodFit(approximation, cyclopsFit, parameter = "x")

</code></pre>

<hr>
<h2 id='plotMcmcTrace'>Plot MCMC trace</h2><span id='topic+plotMcmcTrace'></span>

<h3>Description</h3>

<p>Plot MCMC trace
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMcmcTrace(
  estimate,
  showEstimate = TRUE,
  dataCutoff = 0.01,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMcmcTrace_+3A_estimate">estimate</code></td>
<td>
<p>An object as generated using the <code><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotMcmcTrace_+3A_showestimate">showEstimate</code></td>
<td>
<p>Show the parameter estimates (mode) and 95 percent confidence intervals?</p>
</td></tr>
<tr><td><code id="plotMcmcTrace_+3A_datacutoff">dataCutoff</code></td>
<td>
<p>This fraction of the data at both tails will be removed.</p>
</td></tr>
<tr><td><code id="plotMcmcTrace_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the samples of the posterior distribution of the mu and tau parameters. Samples are taken
using Markov-chain Monte Carlo (MCMC).
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
plotMcmcTrace(estimate)

</code></pre>

<hr>
<h2 id='plotMetaAnalysisForest'>Create a forest plot</h2><span id='topic+plotMetaAnalysisForest'></span>

<h3>Description</h3>

<p>Creates a forest plot of effect size estimates, including the summary estimate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotMetaAnalysisForest(
  data,
  labels,
  estimate,
  xLabel = "Relative risk",
  summaryLabel = "Summary",
  limits = c(0.1, 10),
  alpha = 0.05,
  showLikelihood = TRUE,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotMetaAnalysisForest_+3A_data">data</code></td>
<td>
<p>A data frame containing either normal, skew-normal, custom parametric, or grid
likelihood data. One row per database.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_labels">labels</code></td>
<td>
<p>A vector of labels for the data sources.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_estimate">estimate</code></td>
<td>
<p>The meta-analytic estimate as created using either ['computeFixedEffectMetaAnalysis()<code style="white-space: pre;">&#8288;] or [&#8288;</code>computeBayesianMetaAnalysis()'] function.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_xlabel">xLabel</code></td>
<td>
<p>The label on the x-axis: the name of the effect estimate.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_summarylabel">summaryLabel</code></td>
<td>
<p>The label for the meta-analytic estimate.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_limits">limits</code></td>
<td>
<p>The limits of the effect size axis.</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_alpha">alpha</code></td>
<td>
<p>The alpha (expected type I error).</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_showlikelihood">showLikelihood</code></td>
<td>
<p>Show the likelihood curve for each estimate?</p>
</td></tr>
<tr><td><code id="plotMetaAnalysisForest_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See the
function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> ifor supported file formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates a forest plot of effect size estimates, including a meta-analysis estimate.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()
labels &lt;- paste("Data site", LETTERS[1:length(populations)])

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
plotMetaAnalysisForest(approximations, labels, estimate)

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='plotPerDbMcmcTrace'>Plot MCMC trace for individual databases</h2><span id='topic+plotPerDbMcmcTrace'></span>

<h3>Description</h3>

<p>Plot MCMC trace for individual databases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPerDbMcmcTrace(
  estimate,
  showEstimate = TRUE,
  dataCutoff = 0.01,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPerDbMcmcTrace_+3A_estimate">estimate</code></td>
<td>
<p>An object as generated using the <code><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotPerDbMcmcTrace_+3A_showestimate">showEstimate</code></td>
<td>
<p>Show the parameter estimates (mode) and 95 percent confidence intervals?</p>
</td></tr>
<tr><td><code id="plotPerDbMcmcTrace_+3A_datacutoff">dataCutoff</code></td>
<td>
<p>This fraction of the data at both tails will be removed.</p>
</td></tr>
<tr><td><code id="plotPerDbMcmcTrace_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the samples of the posterior distribution of the theta parameter (the estimated log hazard
ratio) at each site. Samples are taken using Markov-chain Monte Carlo (MCMC).
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
plotPerDbMcmcTrace(estimate)

</code></pre>

<hr>
<h2 id='plotPerDbPosterior'>Plot posterior density per database</h2><span id='topic+plotPerDbPosterior'></span>

<h3>Description</h3>

<p>Plot posterior density per database
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPerDbPosterior(
  estimate,
  showEstimate = TRUE,
  dataCutoff = 0.01,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPerDbPosterior_+3A_estimate">estimate</code></td>
<td>
<p>An object as generated using the <code><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotPerDbPosterior_+3A_showestimate">showEstimate</code></td>
<td>
<p>Show the parameter estimates (mode) and 95 percent confidence intervals?</p>
</td></tr>
<tr><td><code id="plotPerDbPosterior_+3A_datacutoff">dataCutoff</code></td>
<td>
<p>This fraction of the data at both tails will be removed.</p>
</td></tr>
<tr><td><code id="plotPerDbPosterior_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the density of the posterior distribution of the theta parameter (the estimated log hazard
ratio) at each site.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
plotPerDbPosterior(estimate)

</code></pre>

<hr>
<h2 id='plotPosterior'>Plot posterior density</h2><span id='topic+plotPosterior'></span>

<h3>Description</h3>

<p>Plot posterior density
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPosterior(
  estimate,
  showEstimate = TRUE,
  dataCutoff = 0.01,
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPosterior_+3A_estimate">estimate</code></td>
<td>
<p>An object as generated using the <code><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis()</a></code> function.</p>
</td></tr>
<tr><td><code id="plotPosterior_+3A_showestimate">showEstimate</code></td>
<td>
<p>Show the parameter estimates (mode) and 95 percent confidence intervals?</p>
</td></tr>
<tr><td><code id="plotPosterior_+3A_datacutoff">dataCutoff</code></td>
<td>
<p>This fraction of the data at both tails will be removed.</p>
</td></tr>
<tr><td><code id="plotPosterior_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'. See
the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> in the ggplot2 package for supported file
formats.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot the density of the posterior distribution of the mu and tau parameters.
</p>


<h3>Value</h3>

<p>A Ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file.
</p>


<h3>See Also</h3>

<p><a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
populations &lt;- simulatePopulations()

# Fit a Cox regression at each data site, and approximate likelihood function:
fitModelInDatabase &lt;- function(population) {
  cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
    data = population,
    modelType = "cox"
  )
  cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
  approximation &lt;- approximateLikelihood(cyclopsFit, parameter = "x", approximation = "custom")
  return(approximation)
}
approximations &lt;- lapply(populations, fitModelInDatabase)
approximations &lt;- do.call("rbind", approximations)

# At study coordinating center, perform meta-analysis using per-site approximations:
estimate &lt;- computeBayesianMetaAnalysis(approximations)
plotPosterior(estimate)

</code></pre>

<hr>
<h2 id='plotPreparedPs'>Plot the propensity score distribution</h2><span id='topic+plotPreparedPs'></span>

<h3>Description</h3>

<p>Plot the propensity score distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotPreparedPs(
  preparedPsPlots,
  labels,
  treatmentLabel = "Target",
  comparatorLabel = "Comparator",
  fileName = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotPreparedPs_+3A_preparedpsplots">preparedPsPlots</code></td>
<td>
<p>list of prepared propensity score data as created by the <code><a href="#topic+preparePsPlot">preparePsPlot()</a></code>
function.</p>
</td></tr>
<tr><td><code id="plotPreparedPs_+3A_labels">labels</code></td>
<td>
<p>A vector containing the labels for the various sources.</p>
</td></tr>
<tr><td><code id="plotPreparedPs_+3A_treatmentlabel">treatmentLabel</code></td>
<td>
<p>A label to us for the treated cohort.</p>
</td></tr>
<tr><td><code id="plotPreparedPs_+3A_comparatorlabel">comparatorLabel</code></td>
<td>
<p>A label to us for the comparator cohort.</p>
</td></tr>
<tr><td><code id="plotPreparedPs_+3A_filename">fileName</code></td>
<td>
<p>Name of the file where the plot should be saved, for example 'plot.png'.
See the function <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> for supported file formats.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object. Use the <a href="ggplot2.html#topic+ggsave">ggplot2::ggsave</a> function to save to file in a different format.
</p>


<h3>See Also</h3>

<p><a href="#topic+preparePsPlot">preparePsPlot</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
treatment &lt;- rep(0:1, each = 100)
propensityScore &lt;- c(rnorm(100, mean = 0.4, sd = 0.25), rnorm(100, mean = 0.6, sd = 0.25))
data &lt;- data.frame(treatment = treatment, propensityScore = propensityScore)
data &lt;- data[data$propensityScore &gt; 0 &amp; data$propensityScore &lt; 1, ]
preparedPlot &lt;- preparePsPlot(data)

# Just reusing the same data three times for demonstration purposes:
preparedPsPlots &lt;- list(preparedPlot, preparedPlot, preparedPlot)
labels &lt;- c("Data site A", "Data site B", "Data site C")

plotPreparedPs(preparedPsPlots, labels)

</code></pre>

<hr>
<h2 id='preparePsPlot'>Prepare to plot the propensity score distribution</h2><span id='topic+preparePsPlot'></span>

<h3>Description</h3>

<p>Prepare to plot the propensity (or preference) score distribution. It computes the distribution, so
the output does not contain person-level data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>preparePsPlot(data, unfilteredData = NULL, scale = "preference")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="preparePsPlot_+3A_data">data</code></td>
<td>
<p>A data frame with at least the two columns described below</p>
</td></tr>
<tr><td><code id="preparePsPlot_+3A_unfiltereddata">unfilteredData</code></td>
<td>
<p>To be used when computing preference scores on data from which subjects have
already been removed, e.g. through trimming and/or matching. This data frame
should have the same structure as <code>data</code>.</p>
</td></tr>
<tr><td><code id="preparePsPlot_+3A_scale">scale</code></td>
<td>
<p>The scale of the graph. Two scales are supported: <code>scale = 'propensity'</code> or
<code>scale = 'preference'</code>. The preference score scale is defined by Walker et
al. (2013).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data frame should have a least the following two columns:
</p>

<ul>
<li> <p><strong>treatment</strong> (integer): Column indicating whether the person is in the treated (1) or comparator
(0) group. - <strong>propensityScore</strong> (numeric): Propensity score.
</p>
</li></ul>



<h3>Value</h3>

<p>A data frame describing the propensity score (or preference score) distribution at 100
equally-spaced points.
</p>


<h3>References</h3>

<p>Walker AM, Patrick AR, Lauer MS, Hornbrook MC, Marin MG, Platt R, Roger VL, Stang P, and
Schneeweiss S. (2013) A tool for assessing the feasibility of comparative effectiveness research,
Comparative Effective Research, 3, 11-20
</p>


<h3>See Also</h3>

<p><a href="#topic+plotPreparedPs">plotPreparedPs</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate some data for this example:
treatment &lt;- rep(0:1, each = 100)
propensityScore &lt;- c(rnorm(100, mean = 0.4, sd = 0.25), rnorm(100, mean = 0.6, sd = 0.25))
data &lt;- data.frame(treatment = treatment, propensityScore = propensityScore)
data &lt;- data[data$propensityScore &gt; 0 &amp; data$propensityScore &lt; 1, ]

preparedPlot &lt;- preparePsPlot(data)

</code></pre>

<hr>
<h2 id='sequentialFitBiasDistribution'>Fit Bias Distribution Sequentially or in Groups</h2><span id='topic+sequentialFitBiasDistribution'></span>

<h3>Description</h3>

<p>Learn empirical bias distributions sequentially or in groups; for each sequential
step or analysis group, bias distributions is learned by by simultaneously analyzing
a large set of negative control outcomes by a Bayesian hierarchical model through MCMC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sequentialFitBiasDistribution(LikelihoodProfileList, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sequentialFitBiasDistribution_+3A_likelihoodprofilelist">LikelihoodProfileList</code></td>
<td>
<p>A list of lists, each of which is a set of grid profile likelihoods
regarding negative controls, indexed by analysis period ID
for sequential analyses or group ID for group analyses.</p>
</td></tr>
<tr><td><code id="sequentialFitBiasDistribution_+3A_...">...</code></td>
<td>
<p>Arguments passed to the <code><a href="#topic+fitBiasDistribution">fitBiasDistribution()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A (long) dataframe with four columns.
Column <code>mean</code> includes MCMC samples for the average bias,
<code>scale</code> for the sd/scale parameter,
<code>bias</code> for predictive samples of the bias, and
<code>Id</code> for the period ID or group ID.
</p>


<h3>See Also</h3>

<p><a href="#topic+fitBiasDistribution">fitBiasDistribution</a>, <a href="#topic+computeBayesianMetaAnalysis">computeBayesianMetaAnalysis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load example data
data("ncLikelihoods")

# fit bias distributions over analysis periods
# NOT RUN
# biasDistributions = sequentialFitBiasDistribution(ncLikelihoods, seed = 42)

</code></pre>

<hr>
<h2 id='simulatePopulations'>Simulate survival data for multiple databases</h2><span id='topic+simulatePopulations'></span>

<h3>Description</h3>

<p>Simulate survival data for multiple databases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulatePopulations(settings = createSimulationSettings())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulatePopulations_+3A_settings">settings</code></td>
<td>
<p>An object of type <code>simulationSettings</code>, created by the
<code><a href="#topic+createSimulationSettings">createSimulationSettings()</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A object of class <code>simulation</code>, which is a list of populations, each a data frame with columns
<code>rowId</code>, <code>stratumId</code>, <code>x</code>, <code>time</code>, and <code>y</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>settings &lt;- createSimulationSettings(nSites = 1, hazardRatio = 2)
populations &lt;- simulatePopulations(settings)

# Fit a Cox regression for the simulated data site:
cyclopsData &lt;- Cyclops::createCyclopsData(Surv(time, y) ~ x + strata(stratumId),
  data = populations[[1]],
  modelType = "cox"
)
cyclopsFit &lt;- Cyclops::fitCyclopsModel(cyclopsData)
coef(cyclopsFit)

# (Estimates in this example will vary due to the random simulation)

</code></pre>

<hr>
<h2 id='skewNormal'>The skew normal function to approximate a log likelihood function</h2><span id='topic+skewNormal'></span>

<h3>Description</h3>

<p>The skew normal function to approximate a log likelihood function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>skewNormal(x, mu, sigma, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="skewNormal_+3A_x">x</code></td>
<td>
<p>The log(hazard ratio) for which to approximate the log likelihood.</p>
</td></tr>
<tr><td><code id="skewNormal_+3A_mu">mu</code></td>
<td>
<p>The position parameter.</p>
</td></tr>
<tr><td><code id="skewNormal_+3A_sigma">sigma</code></td>
<td>
<p>The scale parameter.</p>
</td></tr>
<tr><td><code id="skewNormal_+3A_alpha">alpha</code></td>
<td>
<p>The skew parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The skew normal function. When <code>alpha = 0</code> this function is the normal distribution.
</p>


<h3>Value</h3>

<p>The approximate log likelihood for the given x.
</p>


<h3>References</h3>

<p>Azzalini, A. (2013). The Skew-Normal and Related Families. Institute of Mathematical Statistics
Monographs. Cambridge University Press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>skewNormal(x = 0:3, mu = 0, sigma = 1, alpha = 0)

</code></pre>

<hr>
<h2 id='supportsJava8'>Determine if Java virtual machine supports Java</h2><span id='topic+supportsJava8'></span>

<h3>Description</h3>

<p>Tests Java virtual machine (JVM) java.version system property to check if version &gt;= 8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>supportsJava8()
</code></pre>


<h3>Value</h3>

<p>Returns TRUE if JVM supports Java &gt;= 8.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>supportsJava8()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
