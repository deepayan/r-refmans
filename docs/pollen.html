<!DOCTYPE html><html><head><title>Help for package pollen</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pollen}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#base_temp'><p>Determining base temperatures</p></a></li>
<li><a href='#gdd'><p>Growing Degree Days Function</p></a></li>
<li><a href='#gdd_data'><p>Exemplary dataset for GDD calculations</p></a></li>
<li><a href='#outliers_replacer'><p>A Outliers Replacer Function</p></a></li>
<li><a href='#pollen_count'><p>Pollen count of alder, birch, and hazel</p></a></li>
<li><a href='#pollen_index'><p>A Pollen Index Function</p></a></li>
<li><a href='#pollen_season'><p>A Pollen Season Function</p></a></li>
<li><a href='#pollen-package'><p>pollen: Analysis of Aerobiological Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Aerobiological Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.82.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Supports analysis of aerobiological data. 
    Available features include determination of pollen season limits, 
    replacement of outliers (Kasprzyk and Walanus (2014) &lt;<a href="https://doi.org/10.1007%2Fs10453-014-9332-8">doi:10.1007/s10453-014-9332-8</a>&gt;),
    calculation of growing degree days (Baskerville and Emin (1969) &lt;<a href="https://doi.org/10.2307%2F1933912">doi:10.2307/1933912</a>&gt;), 
    and determination of the base temperature for growing degree days
    (Yang et al. (1995) &lt;doi:10.1016/0168-1923(94)02185-M).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lubridate, purrr, dplyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, ggplot2, knitr, tidyr, rmarkdown, testthat</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nowosad.github.io/pollen/">https://nowosad.github.io/pollen/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Nowosad/pollen/issues">https://github.com/Nowosad/pollen/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-03 11:19:30 UTC; jn</td>
</tr>
<tr>
<td>Author:</td>
<td>Jakub Nowosad <a href="https://orcid.org/0000-0002-1057-3721"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jakub Nowosad &lt;nowosad.jakub@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-03 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='base_temp'>Determining base temperatures</h2><span id='topic+base_temp'></span>

<h3>Description</h3>

<p>This function determines a base temperature (&quot;tbase&quot;) based on the mean temperature of the entire season and the number of days of the ith planting to reach a given developmental stage under study. 
It allows to use one of four methods to calculate tbase, including:
(1) the least standard deviation in GDD (Magoon and Culpepper, 1932; Stier, 1939) - '&quot;sd_gdd&quot;';
(2) the least standard deviation in days (Arnold, 1959) - '&quot;sd_day&quot;';
(3) the coefficient of variation in days (Nuttonson, 1958) - '&quot;cv_day&quot;';
(4) the regression coefficient (Hoover, 1955) - '&quot;y_i&quot;'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>base_temp(tavg, d, type)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="base_temp_+3A_tavg">tavg</code></td>
<td>
<p>the mean temperature of the entire season for the plantings (a numerical vector, where one value is a planting)</p>
</td></tr>
<tr><td><code id="base_temp_+3A_d">d</code></td>
<td>
<p>the number of days of the ith planting to reach a given developmental stage under study (e.g., flowering ) (a numerical vector, where one value is a planting)</p>
</td></tr>
<tr><td><code id="base_temp_+3A_type">type</code></td>
<td>
<p>either '&quot;sd_gdd&quot;', '&quot;sd_day&quot;', '&quot;cv_day&quot;', or '&quot;y_i&quot;'. For the explanation of each type, see the Yang et al. 1995</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric value representing base temperature that could be then used, for example, in GDD calculations
</p>


<h3>References</h3>

<p>Yang, S., Logan, J., &amp; Coffey, D. L. (1995). Mathematical formulae for calculating the base temperature for growing degree days. In Agricultural and Forest Meteorology (Vol. 74, Issues 1-2, pp. 61-74). Elsevier BV
</p>
<p>Magoon, C. A., &amp; Culpepper, C. W. (1932). Response of sweet corn to varying temperatures from time of planting to canning maturity (No. 1488-2016-124513).
</p>
<p>Stier, H. S. (1939). A physiological study of growth and fruiting in the tomato (Lycopersicon esculentum L.) with reference to the effect of climatic and edaphic conditions (Doctoral dissertation, Ph. D. Dissertation, University of Maryland, College Park, MD, USA).
</p>
<p>Arnold, C. Y. (1959, January). The determination and significance of the base temperature in a linear heat unit system. In Proceedings of the american Society for horticultural Science (Vol. 74, No. 1, pp. 430-445).
</p>
<p>Nuttonson, M. Y. (1955). Wheat-climate relationships and the use of phenology in ascertaining the thermal and photo-thermal requirements of wheat. Amer. Inst. of Crop Ecology, Washington, D.
</p>
<p>Hoover, M. W. (1955). Some effects of temperature on the growth of southern peas. In Proc. Am. Soc. Hortic. Sci (Vol. 66, pp. 308-312).
</p>


<h3>See Also</h3>

<p>[gdd()] for calculation of growing degree days (GDD)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(pollen)
tavg &lt;- c(25, 20, 15, 10)
d &lt;- c(6, 11, 16, 21)
base_temp(tavg = tavg, d = d, type = "sd_gdd")
base_temp(tavg = tavg, d = d, type = "sd_day")
base_temp(tavg = tavg, d = d, type = "cv_day")
base_temp(tavg = tavg, d = d, type = "y_i")
</code></pre>

<hr>
<h2 id='gdd'>Growing Degree Days Function</h2><span id='topic+gdd'></span>

<h3>Description</h3>

<p>This function calculates growing degree days (GDD) using the average of the daily maximum
and minimum temperatures, a base temperature and a maximum base temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gdd(tmax, tmin, tbase, tbase_max, type = "C")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gdd_+3A_tmax">tmax</code></td>
<td>
<p>daily maximum temperature</p>
</td></tr>
<tr><td><code id="gdd_+3A_tmin">tmin</code></td>
<td>
<p>daily minimum temperature</p>
</td></tr>
<tr><td><code id="gdd_+3A_tbase">tbase</code></td>
<td>
<p>base temperature</p>
</td></tr>
<tr><td><code id="gdd_+3A_tbase_max">tbase_max</code></td>
<td>
<p>maximum base temperature</p>
</td></tr>
<tr><td><code id="gdd_+3A_type">type</code></td>
<td>
<p>either &quot;B&quot;, &quot;C&quot;, or &quot;D&quot;. The default is &quot;C&quot;. Type &quot;B&quot; - The heat units are calculated based on the difference between the mean daily temperature and the threshold ('tbase'). In the case when the value of 'tmin' is lower than 'tbase', then it is replaced by 'tbase'. Type '&quot;C&quot;' - same as type '&quot;B&quot;' and when the value of 'tmax' is larger than 'tbase_max', then it is replaced by 'tbase_max'. Type '&quot;D&quot;'- same as type '&quot;B&quot;' and when the value of 'tmax' is larger than 'tbase_max', then no heat units are added.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric vector with GDD values
</p>


<h3>References</h3>

<p>Baskerville, G., &amp; Emin, P. (1969). Rapid Estimation of Heat Accumulation from Maximum and Minimum Temperatures. Ecology, 50(3), 514-517. doi:10.2307/1933912
</p>


<h3>See Also</h3>

<p>[base_temp()] for determining a base temperature
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(25)
df &lt;- data.frame(tmax = runif(100, 6, 10), tmin = runif(100, 4, 6))

gdd(tmax = df$tmax, tmin = df$tmin, tbase = 5, tbase_max = 30)


</code></pre>

<hr>
<h2 id='gdd_data'>Exemplary dataset for GDD calculations</h2><span id='topic+gdd_data'></span>

<h3>Description</h3>

<p>gdd_data A dataset containing a synthetic data of day, tmax (daily maximum temperature), and tmin (daily minimum temperature)
</p>


<h3>Format</h3>

<p>A data frame with 100 rows and 3 variables:
</p>

<ul>
<li><p> day
</p>
</li>
<li><p> tmax
</p>
</li>
<li><p> tmin
</p>
</li></ul>


<hr>
<h2 id='outliers_replacer'>A Outliers Replacer Function</h2><span id='topic+outliers_replacer'></span>

<h3>Description</h3>

<p>This function finds outliers in pollen time-series and replaces them with background values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outliers_replacer(value, date, threshold = 5, sum_percent = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outliers_replacer_+3A_value">value</code></td>
<td>
<p>pollen concentration values</p>
</td></tr>
<tr><td><code id="outliers_replacer_+3A_date">date</code></td>
<td>
<p>dates</p>
</td></tr>
<tr><td><code id="outliers_replacer_+3A_threshold">threshold</code></td>
<td>
<p>a number indicating how many times outlying value needs to be larger than the background to be replaced (default is 5)</p>
</td></tr>
<tr><td><code id="outliers_replacer_+3A_sum_percent">sum_percent</code></td>
<td>
<p>a sum_percent parameter</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a new data.frame object with replaced outliers
</p>


<h3>References</h3>

<p>Kasprzyk, I. and A. Walanus.: 2014. Gamma, Gaussian and Logistic Distribution Models for Airborne Pollen Grains and Fungal Spore Season Dynamics, Aerobiologia 30(4), 369-83.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(pollen_count)
df &lt;- subset(pollen_count, site=='Shire')
new_df &lt;- outliers_replacer(df$birch, df$date)
identical(df, new_df)

library('purrr')
new_pollen_count &lt;- pollen_count %&gt;% split(., .$site) %&gt;%
       map_df(~outliers_replacer(value=.$hazel, date=.$date, threshold=4))

</code></pre>

<hr>
<h2 id='pollen_count'>Pollen count of alder, birch, and hazel</h2><span id='topic+pollen_count'></span>

<h3>Description</h3>

<p>pollen_count A dataset containing a synthetic data of alder, birch, and hazel pollen count in four locations ('Oz', 'Shire', 'Atlantis', 'Hundred Acre Wood') between 2007 and 2016
</p>


<h3>Format</h3>

<p>A data frame with 8352 rows and 5 variables:
</p>

<ul>
<li><p> site
</p>
</li>
<li><p> date
</p>
</li>
<li><p> alder
</p>
</li>
<li><p> birch
</p>
</li>
<li><p> hazel
</p>
</li></ul>


<hr>
<h2 id='pollen_index'>A Pollen Index Function</h2><span id='topic+pollen_index'></span>

<h3>Description</h3>

<p>This function calculates the Pollen Index (PI), which is implemented as
the average amount of annual pollen collected based on the input data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pollen_index(value, date)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pollen_index_+3A_value">value</code></td>
<td>
<p>pollen concentration values</p>
</td></tr>
<tr><td><code id="pollen_index_+3A_date">date</code></td>
<td>
<p>dates</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(pollen_count)
df &lt;- subset(pollen_count, site == 'Oz')
pollen_index(value = df$birch, date = df$date)
</code></pre>

<hr>
<h2 id='pollen_season'>A Pollen Season Function</h2><span id='topic+pollen_season'></span>

<h3>Description</h3>

<p>This function calculates the start and the end of pollen season for each year
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pollen_season(value, date, method, threshold = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pollen_season_+3A_value">value</code></td>
<td>
<p>pollen concentration values</p>
</td></tr>
<tr><td><code id="pollen_season_+3A_date">date</code></td>
<td>
<p>dates</p>
</td></tr>
<tr><td><code id="pollen_season_+3A_method">method</code></td>
<td>
<p>the pollen season method - &quot;90&quot;, &quot;95&quot;, &quot;98&quot;, &quot;Mesa&quot;, &quot;Jager&quot;, &quot;Lejoly&quot;, or &quot;Driessen&quot;</p>
</td></tr>
<tr><td><code id="pollen_season_+3A_threshold">threshold</code></td>
<td>
<p>a threshold value used for the &quot;Driessen&quot; method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame object with year, date of pollen season start and date of pollen season end
</p>


<h3>References</h3>

<p>Nilsson S. and Persson S.: 1981, Tree pollen spectra in the Stockholm region (Sweden) 1973-1980, Grana 20, 179-182.
</p>
<p>Andersen T.B.: 1991, A model to predict the beginning of the pollen season, Grana 30, 269-275.
</p>
<p>Torben B.A.: 1991, A model to predict the beginning of the pollen season, Grana 30, 269-275.
</p>
<p>Galan C., Emberlin J., Dominguez E., Bryant R.H. and Villamandos F.: 1995, A comparative analysis of daily variations in the Gramineae pollen counts at Cordoba, Spain and London, UK, Grana 34, 189-198.
</p>
<p>Sanchez-Mesa J.A., Smith M., Emberlin J., Allitt U., Caulton E. and Galan C.: 2003, Characteristics of grass pollen seasons in areas of southern Spain and the United Kingdom, Aerobiologia 19, 243-250.
</p>
<p>Jager S., Nilsson S., Berggren B., Pessi A.M., Helander M. and Ramfjord H.: 1996, Trends of some airborne tree pollen in the Nordic countries and Austria, 1980-1993. A comparison between Stockholm, Trondheim, Turku and Vienna, Grana 35, 171-178.
</p>
<p>Lejoly-Gabriel and Leuschner: 1983, Comparison of air-borne pollen at Louvain-la-Neuve (Belgium) and Basel (Switzerland) during 1979 and 1980, Grana 22, 59-64.
</p>
<p>Driessen M. N. B. M., Van Herpen R. M. A. and Smithuis, L. O. M. J.: 1990, Prediction of the start of the grass pollen season for the southern part of the Netherlands, Grana, 29(1), 79-86.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(pollen_count)
df &lt;- subset(pollen_count, site=='Oz')
pollen_season(value=df$birch, date=df$date, method="95")

df2 &lt;- subset(pollen_count, site=='Atlantis')
pollen_season(value=df2$alder, date=df2$date, method="95")

library('purrr')
pollen_count %&gt;% split(., .$site) %&gt;%
                 map_df(~pollen_season(value=.$hazel, date=.$date, method="95"), .id="site")

</code></pre>

<hr>
<h2 id='pollen-package'>pollen: Analysis of Aerobiological Data</h2><span id='topic+pollen'></span><span id='topic+pollen-package'></span>

<h3>Description</h3>

<p>Supports analysis of aerobiological data. Available features include determination of pollen season limits, replacement of outliers (Kasprzyk and Walanus (2014) &lt;doi:10.1007/s10453-014-9332-8&gt;), calculation of growing degree days (Baskerville and Emin (1969) &lt;doi:10.2307/1933912&gt;), and determination of the base temperature for growing degree days (Yang et al. (1995) &lt;doi:10.1016/0168-1923(94)02185-M).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jakub Nowosad <a href="mailto:nowosad.jakub@gmail.com">nowosad.jakub@gmail.com</a> (<a href="https://orcid.org/0000-0002-1057-3721">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://nowosad.github.io/pollen/">https://nowosad.github.io/pollen/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/Nowosad/pollen/issues">https://github.com/Nowosad/pollen/issues</a>
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
