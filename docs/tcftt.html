<!DOCTYPE html><html><head><title>Help for package tcftt</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tcftt}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjust_power'><p>Adjusting power to assure actual size is within significance level</p></a></li>
<li><a href='#boot_test'><p>Bootstrap_t test for two-sample comparisons</p></a></li>
<li><a href='#compute_t'><p>Compute t-statistic</p></a></li>
<li><a href='#pauc'><p>Power-adjustment based on non-parametric estimation of the ROC curve</p></a></li>
<li><a href='#t_cornish_fisher'><p>Cornish-Fisher expansion for Welch's t-statistic</p></a></li>
<li><a href='#t_edgeworth'><p>Edgeworth expansion for Welch's t-statistic</p></a></li>
<li><a href='#tcftt'><p>tcftt: Two-Sample Tests for Skewed Data</p></a></li>
<li><a href='#tcfu'><p>The TCFU test</p></a></li>
<li><a href='#tt'><p>The transformation based test</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Two-Sample Tests for Skewed Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Huaiyu Zhang, Haiyan Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Huaiyu Zhang &lt;huaiyuzhang1988@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The classical two-sample t-test works well for the normally distributed data or 
    data with large sample size. The tcfu() and tt() tests implemented in this package provide 
    better type-I-error control with more accurate power when testing the equality of two-sample 
    means for skewed populations having unequal variances. These tests are especially useful 
    when the sample sizes are moderate. The tcfu() uses the Cornish-Fisher expansion to achieve 
    a better approximation to the true percentiles. The tt() provides transformations of the Welch's 
    t-statistic so that the sampling distribution become more symmetric. For more technical details, 
    please refer to Zhang (2019) <a href="http://hdl.handle.net/2097/40235">http://hdl.handle.net/2097/40235</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-07-16 17:53:42 UTC; huaiyu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-07-23 14:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjust_power'>Adjusting power to assure actual size is within significance level</h2><span id='topic+adjust_power'></span>

<h3>Description</h3>

<p>It is common to use Monte Carlo experiments to evaluate the performance of
hypothesis tests and compare the empirical power among competing
tests. High power is desirable but difficulty arises when the actual sizes of
competing tests are not comparable. A possible way of tackling this issue is
to adjust the empirical power according to the actual size. This function
incorporates three types of power adjustment methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjust_power(size, power, method = "ZW")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adjust_power_+3A_size">size</code></td>
<td>
<p>the empirical size of a test.</p>
</td></tr>
<tr><td><code id="adjust_power_+3A_power">power</code></td>
<td>
<p>the empirical power of a test.</p>
</td></tr>
<tr><td><code id="adjust_power_+3A_method">method</code></td>
<td>
<p>the power adjustment method. 'ZW' is the method proposed by Zhang and Wang (2020), 'CYS' is the method proposed by Cavus et al. (2019),
and 'probit' is the &quot;method 1: probit analysis&quot; in Lloyd (2005).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the power value after adjustment.
</p>


<h3>References</h3>

<p>Lloyd, C. J. (2005). Estimating test power adjusted for size. Journal of Statistical Computation and Simulation, 75(11):921-933.
</p>
<p>Cavus, M., Yazici, B., &amp; Sezer, A. (2019). Penalized power approach to compare the power of the tests when Type I error probabilities are different. Communications in Statistics-Simulation and Computation, 1-15.
</p>
<p>Zhang, H. and Wang, H. (2020). Transformation tests and their asymptotic power in two-sample comparisons Manuscript in review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adjust_power(size = 0.06, power = 0.8, method = 'ZW')
adjust_power(size = 0.06, power = 0.8, method = 'CYS')
adjust_power(size = 0.06, power = 0.8, method = 'probit')
</code></pre>

<hr>
<h2 id='boot_test'>Bootstrap_t test for two-sample comparisons</h2><span id='topic+boot_test'></span>

<h3>Description</h3>

<p>This function provides bootstrap approximation to the sampling distribution of the the
Welch's t-statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boot_test(x1, x2, B = 1000, alternative = "greater")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_test_+3A_x1">x1</code></td>
<td>
<p>the first sample.</p>
</td></tr>
<tr><td><code id="boot_test_+3A_x2">x2</code></td>
<td>
<p>the second sample.</p>
</td></tr>
<tr><td><code id="boot_test_+3A_b">B</code></td>
<td>
<p>number of resampling rounds. Default value is 1000.</p>
</td></tr>
<tr><td><code id="boot_test_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis: &quot;greater&quot; for upper-tailed, &quot;less&quot; for lower-tailed, and &quot;two.sided&quot; for two-sided alternative.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the p-value of the bootstrap_t test.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- rnorm(100, 0, 1)
x2 &lt;- rnorm(100, 0.5, 2)
boot_test(x1, x2)
</code></pre>

<hr>
<h2 id='compute_t'>Compute t-statistic</h2><span id='topic+compute_t'></span>

<h3>Description</h3>

<p>This is a helper function for the bootstrap test. It computes the t-statistic in a fast way.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_t(x1, x2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_t_+3A_x1">x1</code></td>
<td>
<p>the first sample.</p>
</td></tr>
<tr><td><code id="compute_t_+3A_x2">x2</code></td>
<td>
<p>the second sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the Welch's t-statistic.
</p>

<hr>
<h2 id='pauc'>Power-adjustment based on non-parametric estimation of the ROC curve</h2><span id='topic+pauc'></span>

<h3>Description</h3>

<p>It is common to use Monte Carlo experiments to evaluate the performance of
hypothesis tests and compare the empirical power among competing
tests. High power is desirable but difficulty arises when the actual sizes of
competing tests are not comparable. A possible way of tackling this issue is
to adjust the empirical power according to the actual size. This function
implements the &quot;method 2: non-parametric estimation of the ROC curve&quot; in
Lloyd (2005). For more details, please refer to the paper.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pauc(stat_h0, stat_ha, target_range_lower, target_range_upper)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pauc_+3A_stat_h0">stat_h0</code></td>
<td>
<p>simulated test statistics under the null hypothesis.</p>
</td></tr>
<tr><td><code id="pauc_+3A_stat_ha">stat_ha</code></td>
<td>
<p>simulated test statistics under the alternative hypothesis.</p>
</td></tr>
<tr><td><code id="pauc_+3A_target_range_lower">target_range_lower</code></td>
<td>
<p>the lower end of the size range.</p>
</td></tr>
<tr><td><code id="pauc_+3A_target_range_upper">target_range_upper</code></td>
<td>
<p>the upper end of the size range.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the adjusted power.
</p>


<h3>References</h3>

<p>Lloyd, C. J. (2005). Estimating test power adjusted for size. Journal of Statistical Computation and Simulation, 75(11):921-933.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>stath0 &lt;- rnorm(100)
statha &lt;- rnorm(100, mean=1)
pauc(stath0, statha, 0.01, 0.1)
</code></pre>

<hr>
<h2 id='t_cornish_fisher'>Cornish-Fisher expansion for Welch's t-statistic</h2><span id='topic+t_cornish_fisher'></span>

<h3>Description</h3>

<p>This function provides approximation for the quantile function of the sampling distribution
of the Welch's t-statistic using Cornish-Fisher expansion (up to second order).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t_cornish_fisher(
  p,
  order = 2,
  n1,
  n2,
  mu1,
  mu2,
  sigma1,
  sigma2,
  gamma1,
  gamma2,
  tau1,
  tau2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t_cornish_fisher_+3A_p">p</code></td>
<td>
<p>a probability value.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_order">order</code></td>
<td>
<p>the order of Cornish-Fisher expansion. Valid options are 0, 1, and 2. If set to 0,
it reduces to a normal approximation and it returns the p-th percentile of standard normal distribution.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_n1">n1</code></td>
<td>
<p>sample size for the sample from the first population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_n2">n2</code></td>
<td>
<p>sample size for the sample from the second population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_mu1">mu1</code></td>
<td>
<p>mean of the first population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_mu2">mu2</code></td>
<td>
<p>mean of the second population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_sigma1">sigma1</code></td>
<td>
<p>standard deviation of the first population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_sigma2">sigma2</code></td>
<td>
<p>standard deviation of the second population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_gamma1">gamma1</code></td>
<td>
<p>skewness of the first population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_gamma2">gamma2</code></td>
<td>
<p>skewness of the second population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_tau1">tau1</code></td>
<td>
<p>kurtosis of the first population.</p>
</td></tr>
<tr><td><code id="t_cornish_fisher_+3A_tau2">tau2</code></td>
<td>
<p>kurtosis of the second population.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Cornish-Fisher expansion value evaluated at p.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t_cornish_fisher(0.9, order=2,
n1=60, n2=30,
mu1=0, mu2=0,
sigma1=1, sigma2=0.5,
gamma1=1, gamma2=0,
tau1=6, tau2=0)

t_cornish_fisher(0.3, order=1,
n1=60, n2=30,
mu1=0, mu2=0,
sigma1=1, sigma2=0.5,
gamma1=1, gamma2=0,
tau1=6, tau2=0)

</code></pre>

<hr>
<h2 id='t_edgeworth'>Edgeworth expansion for Welch's t-statistic</h2><span id='topic+t_edgeworth'></span>

<h3>Description</h3>

<p>This function provides approximation for the cumulative distribution function
of the sampling distribution of the Welch's t-statistic using Normal distribution, first order or second order Edgeworth expansion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>t_edgeworth(
  x,
  order = 2,
  n1,
  n2,
  mu1,
  mu2,
  sigma1,
  sigma2,
  gamma1,
  gamma2,
  tau1,
  tau2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="t_edgeworth_+3A_x">x</code></td>
<td>
<p>a real number.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_order">order</code></td>
<td>
<p>the order of edgeworth expansion. Valid options are 0, 1, and 2. If set to 0,
it reduces to approximation based on the central limit theorem and returns the CDF of standard normal distribution
evaluated at x.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_n1">n1</code></td>
<td>
<p>sample size for the sample from the first population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_n2">n2</code></td>
<td>
<p>sample size for the sample from the second population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_mu1">mu1</code></td>
<td>
<p>mean of the first population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_mu2">mu2</code></td>
<td>
<p>mean of the second population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_sigma1">sigma1</code></td>
<td>
<p>standard deviation of the first population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_sigma2">sigma2</code></td>
<td>
<p>standard deviation of the second population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_gamma1">gamma1</code></td>
<td>
<p>skewness of the first population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_gamma2">gamma2</code></td>
<td>
<p>skewness of the second population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_tau1">tau1</code></td>
<td>
<p>kurtosis of the first population.</p>
</td></tr>
<tr><td><code id="t_edgeworth_+3A_tau2">tau2</code></td>
<td>
<p>kurtosis of the second population.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Edgeworth expansion evaluated at x.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>t_edgeworth(1.96, order=2,
n1=20, n2=30,
mu1=0, mu2=0,
sigma1=1, sigma2=0.5,
gamma1=1, gamma2=0,
tau1=6, tau2=0)
</code></pre>

<hr>
<h2 id='tcftt'>tcftt: Two-Sample Tests for Skewed Data</h2><span id='topic+tcftt'></span>

<h3>Description</h3>

<p>The classical two-sample t-test works well for the normally distributed data or data with large sample size.
The tcfu() and tt() tests implemented in this package provide better type I error control with more accurate power
when testing the equality of two-sample means for skewed populations having
unequal variances. The approximation is especially useful when the sample sizes are moderate. The tcfu()
uses the Cornish-Fisher expansion to achieve a better approximation to the
true percentiles. The tt() provides transformations of the Welch's t-statistic so that the
sampling distribution become more symmetric. For more technical details, please
refer to Zhang (2019) &lt;http://hdl.handle.net/2097/40235&gt;.
</p>


<h3>tcftt functions</h3>

<p>The function 'tcfu()' implements the Cornish-Fisher based two-sample test (TCFU)
and 'tt()' implements the transformation based two-sample test (TT).
The function 't_edgeworth()' provides the Edgeworth expansion for
cumulative distribution function for the Welch's t-statistic, and 't_cornish_fisher()'
provides the Cornish-Fisher expansion for the percentiles.
The functions 'adjust_power()' and 'pauc()' provide power adjustment
for simulation studies so that the actual size of the tests are within the significance level.
</p>

<hr>
<h2 id='tcfu'>The TCFU test</h2><span id='topic+tcfu'></span>

<h3>Description</h3>

<p>This test is suitable for testing the equality of
two-sample means for the populations having unequal variances.
When the populations are not normally distributed, this test
can provide better type I error control and more accurate power than a large-sample t-test using normal
approximation. The critical values of the test are computed based on the
Cornish-Fisher expansion of the Welch's t-statistic. The order of the
Cornish-Fisher expansion is allowed to be 0, 1, or 2. More details
please refer to Zhang and Wang (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tcfu(x1, x2, effectSize = 0, alternative = "greater", alpha = 0.05, order = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tcfu_+3A_x1">x1</code></td>
<td>
<p>the first sample.</p>
</td></tr>
<tr><td><code id="tcfu_+3A_x2">x2</code></td>
<td>
<p>the second sample.</p>
</td></tr>
<tr><td><code id="tcfu_+3A_effectsize">effectSize</code></td>
<td>
<p>the effect size of the test. The default value is 0.</p>
</td></tr>
<tr><td><code id="tcfu_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis: &quot;greater&quot; for upper-tailed, &quot;less&quot; for lower-tailed, and &quot;two.sided&quot; for two-sided alternative.</p>
</td></tr>
<tr><td><code id="tcfu_+3A_alpha">alpha</code></td>
<td>
<p>the significance level. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="tcfu_+3A_order">order</code></td>
<td>
<p>the order of the Cornish-Fisher expansion.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>test statistic, critical value, p-value, reject decision at the given significance level.
</p>


<h3>References</h3>

<p>Zhang, H. and Wang, H. (2020). Transformation tests and their asymptotic power in two-sample comparisons. Manuscript in review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- rnorm(20, 1, 3)
x2 &lt;- rnorm(21, 2, 3)
tcfu(x1, x2, alternative = 'two.sided')
</code></pre>

<hr>
<h2 id='tt'>The transformation based test</h2><span id='topic+tt'></span>

<h3>Description</h3>

<p>This test is suitable for testing the equality of
two-sample means for the populations having unequal variances.
When the populations are not normally distributed, the sampling distribution of
the Welch's t-statistic may be skewed. This test conducts transformations
of the Welch's t-statistic to make the sampling distribution more symmetric.
For more details, please refer to Zhang and Wang (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tt(x1, x2, alternative = "greater", effectSize = 0, alpha = 0.05, type = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tt_+3A_x1">x1</code></td>
<td>
<p>the first sample.</p>
</td></tr>
<tr><td><code id="tt_+3A_x2">x2</code></td>
<td>
<p>the second sample.</p>
</td></tr>
<tr><td><code id="tt_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis: &quot;greater&quot; for upper-tailed, &quot;less&quot; for lower-tailed, and &quot;two.sided&quot; for two-sided alternative.</p>
</td></tr>
<tr><td><code id="tt_+3A_effectsize">effectSize</code></td>
<td>
<p>the effect size of the test. The default value is 0.</p>
</td></tr>
<tr><td><code id="tt_+3A_alpha">alpha</code></td>
<td>
<p>the significance level. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="tt_+3A_type">type</code></td>
<td>
<p>the type of transformation to be used. Possible choices are 1 to 4. They correspond to the TT1 to TT4 in Zhang and Wang (2020).
Which type provides the best test depends on the relative skewness parameter A in Theorem 2.2 of Zhang and Wang (2020).
In general, if A is greater than 3, <code>type</code> =3 is recommended. Otherwise, <code>type</code>=1 or 4 is recommended. The <code>type</code>=2
transformation may be more conservative in some cases and more liberal in some other cases than the <code>type</code>=1 and 4 transformations.   For more details, please refer to Zhang and Wang (2020).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>test statistic, critical value, p-value, reject decision at the given significance level.
</p>


<h3>References</h3>

<p>Zhang, H. and Wang, H. (2020). Transformation tests and their asymptotic power in two-sample comparisons Manuscript in review.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1 &lt;- rnorm(20, 1, 3)
x2 &lt;- rnorm(21, 2, 3)
tt(x1, x2, alternative = 'two.sided', type = 1)

#Negative lognormal versus normal data
 n1=50;  n2=33
 x1 = -rlnorm(n1, meanlog = 0, sdlog = sqrt(1)) -0.3*sqrt((exp(1)-1)*exp(1))
 x2 = rnorm(n2, -exp(1/2), 0.5)
 tt(x1, x2, alternative = 'less', type = 1)
 tt(x1, x2, alternative = 'less', type = 2)
 tt(x1, x2, alternative = 'less', type = 3)
 tt(x1, x2, alternative = 'less', type = 4)

#Lognormal versus normal data
 n1=50;  n2=33
 x1 = rlnorm(n1, meanlog = 0, sdlog = sqrt(1)) + 0.3*sqrt((exp(1)-1)*exp(1))
 x2 = rnorm(n2, exp(1/2), 0.5)
 tt(x1, x2, alternative = 'greater', type = 1)
 tt(x1, x2, alternative = 'greater', type = 2)
 tt(x1, x2, alternative = 'greater', type = 3)
 tt(x1, x2, alternative = 'greater', type = 4)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
