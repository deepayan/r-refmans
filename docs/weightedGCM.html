<!DOCTYPE html><html lang="en"><head><title>Help for package weightedGCM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {weightedGCM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#wgcm.est'><p>Weighted Generalised Covariance Measure (WGCM) With Estimated Weight Function</p>
Conditional Independence Test</a></li>
<li><a href='#wgcm.fix'><p>Weighted Generalised Covariance Measure (WGCM) With Fixed Weight Functions</p>
Conditional Independence Test</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Weighted Generalised Covariance Measure Conditional Independence
Test</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A conditional independence test that can be applied both to
    univariate and multivariate random variables. The test is based on a
    weighted form of the sample covariance of the residuals after a
    nonlinear regression on the conditioning variables. Details are
    described in Scheidegger, Hoerrmann and Buehlmann (2021) "The Weighted
    Generalised Covariance Measure" &lt;<a href="https://doi.org/10.48550/arXiv.2111.04361">doi:10.48550/arXiv.2111.04361</a>&gt;. The test is a
    generalisation of the Generalised Covariance Measure (GCM) implemented
    in the R package 'GeneralisedCovarianceMeasure' by Jonas Peters and
    Rajen D. Shah based on Shah and Peters (2020) "The Hardness of
    Conditional Independence Testing and the Generalised Covariance
    Measure" &lt;<a href="https://doi.org/10.48550/arXiv.1804.07203">doi:10.48550/arXiv.1804.07203</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>GeneralisedCovarianceMeasure, methods, mgcv, stats, xgboost</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-27 16:25:53 UTC; cyril</td>
</tr>
<tr>
<td>Author:</td>
<td>Cyrill Scheidegger [aut, cre],
  Julia Hoerrmann [ths],
  Peter Buehlmann [ths],
  Jonas Peters [ctb, cph] (The code in 'trainFunctions.R' is copied (with
    small modifications) from the R package
    'GeneralisedCovarianceMeasure' by Jonas Peters and Rajen D. Shah),
  Rajen D. Shah [ctb, cph] (The code in 'trainFunctions.R' is copied
    (with small modifications) from the R package
    'GeneralisedCovarianceMeasure' by Jonas Peters and Rajen D. Shah)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cyrill Scheidegger &lt;cyrill.scheidegger@stat.math.ethz.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-29 09:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='wgcm.est'>Weighted Generalised Covariance Measure (WGCM) With Estimated Weight Function
Conditional Independence Test</h2><span id='topic+wgcm.est'></span>

<h3>Description</h3>

<p>The Weighted Generalised Covariance Measure (WGCM) with Estimated Weight Function
is a test for conditional independence. It is a generalisation of the
Generalised Covariance Measure implemented in the R package
GeneralisedCovarianceMeasure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wgcm.est(X, Y, Z, beta = 0.3, regr.meth, regr.pars = list(), nsim = 499)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wgcm.est_+3A_x">X</code></td>
<td>
<p>A (n x d_X) numeric matrix with n observations of d_X variables.</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_y">Y</code></td>
<td>
<p>A (n x d_Y) numeric matrix with n observations of d_Y variables.</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_z">Z</code></td>
<td>
<p>A (n x d_Z) numeric matrix with n observations of d_Z variables.</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_beta">beta</code></td>
<td>
<p>A real number between 0 and 1 indicating the fraction of the sample
used to estimate the weight function.</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_regr.meth">regr.meth</code></td>
<td>
<p>One of &quot;gam&quot; and &quot;xgboost&quot; indicating the regression method
used to estimate the conditional expectations E[X|Z] and E[Y|Z] and the
weight function sign(E[(X-E[X|Z])(Y-E[Y|Z])|Z]).</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_regr.pars">regr.pars</code></td>
<td>
<p>Optional additional regression parameters according to
GeneralisedCovarianceMeasure::comp.resids()</p>
</td></tr>
<tr><td><code id="wgcm.est_+3A_nsim">nsim</code></td>
<td>
<p>Number of samples used to calculate the p-value using simulation.
Only used if max(d_X, d_Y) &gt; 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A p-value for the null hypothesis of conditional independence of X
and Y given Z.
</p>


<h3>References</h3>

<p>Please cite the following papers.
Cyrill Scheidegger, Julia Hoerrmann, Peter Buehlmann:
&quot;The Weighted Generalised Covariance Measure&quot;
<a href="https://arxiv.org/abs/2111.04361">https://arxiv.org/abs/2111.04361</a>
</p>
<p>Rajen D. Shah, Jonas Peters:
&quot;The Hardness of Conditional Independence Testing and the Generalised
Covariance Measure&quot;
<a href="https://arxiv.org/abs/1804.07203">https://arxiv.org/abs/1804.07203</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 200
Z &lt;- rnorm(n)
X &lt;- Z + 0.3*rnorm(n)
Y1 &lt;- Z + 0.3*rnorm(n)
Y2 &lt;- Z + 0.3*rnorm(n) + 0.3*X
Y3 &lt;- Z + 0.3*rnorm(n) + 0.15*X^2
wgcm.est(X, Y1, Z, beta = 0.3, regr.meth = "gam")
wgcm.est(X, Y2, Z, beta = 0.3, regr.meth = "gam")
wgcm.est(X, Y3, Z, beta = 0.3, regr.meth = "gam")

</code></pre>

<hr>
<h2 id='wgcm.fix'>Weighted Generalised Covariance Measure (WGCM) With Fixed Weight Functions
Conditional Independence Test</h2><span id='topic+wgcm.fix'></span>

<h3>Description</h3>

<p>The Weighted Generalised Covariance Measure (WGCM) with Fixed Weight Functions
is a test for conditional independence. It is a generalisation of the
Generalised Covariance Measure implemented in the R package
GeneralisedCovarianceMeasure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wgcm.fix(
  X,
  Y,
  Z,
  regr.meth,
  regr.pars = list(),
  weight.num,
  weight.meth = "sign",
  nsim = 499
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wgcm.fix_+3A_x">X</code></td>
<td>
<p>A (n x d_X) numeric matrix with n observations of d_X variables.</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_y">Y</code></td>
<td>
<p>A (n x d_Y) numeric matrix with n observations of d_Y variables.</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_z">Z</code></td>
<td>
<p>A (n x d_Z) numeric matrix with n observations of d_Z variables.</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_regr.meth">regr.meth</code></td>
<td>
<p>One of &quot;gam&quot; and &quot;xgboost&quot; indicating the regression method
used to estimate the conditional expectations E[X|Z] and E[Y|Z].</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_regr.pars">regr.pars</code></td>
<td>
<p>Optional additional regression parameters according to
GeneralisedCovarianceMeasure::comp.resids().</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_weight.num">weight.num</code></td>
<td>
<p>Number k_0 of weight functions per dimension of Z to be
used additionally to the constant weight function w(z) = 1. The total number
of weight functions will be 1 + k_0 * d_Z. In case of max(d_X, d_Y) &gt; 1, the
same 1 + k_0 * d_Z weight functions are used for every combination of the
components of X and Y.</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_weight.meth">weight.meth</code></td>
<td>
<p>String indicating the method to choose the weight functions.
Currently, only &quot;sign&quot; is implemented.</p>
</td></tr>
<tr><td><code id="wgcm.fix_+3A_nsim">nsim</code></td>
<td>
<p>Number of samples used to calculate the p-value using simulation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A p-value for the null hypothesis of conditional independence of X
and Y given Z.
</p>


<h3>References</h3>

<p>Please cite the following papers.
Cyrill Scheidegger, Julia Hoerrmann, Peter Buehlmann:
&quot;The Weighted Generalised Covariance Measure&quot;
<a href="https://arxiv.org/abs/2111.04361">https://arxiv.org/abs/2111.04361</a>
</p>
<p>Rajen D. Shah, Jonas Peters:
&quot;The Hardness of Conditional Independence Testing and the Generalised
Covariance Measure&quot;
<a href="https://arxiv.org/abs/1804.07203">https://arxiv.org/abs/1804.07203</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 200
Z &lt;- rnorm(n)
X &lt;- Z + 0.3*rnorm(n)
Y1 &lt;- Z + 0.3*rnorm(n)
Y2 &lt;- Z + 0.3*rnorm(n) + 0.3*X
Y3 &lt;- Z + 0.3*rnorm(n) + 0.15*X^2
wgcm.fix(X, Y1, Z, regr.meth = "gam", weight.num = 7, weight.meth = "sign")
wgcm.fix(X, Y2, Z, regr.meth = "gam", weight.num = 7, weight.meth = "sign")
wgcm.fix(X, Y3, Z, regr.meth = "gam", weight.num = 7, weight.meth = "sign")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
