<!DOCTYPE html><html lang="en"><head><title>Help for package BlueCarbon</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BlueCarbon}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BlueCarbon-package'><p>BlueCarbon: Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data</p></a></li>
<li><a href='#bluecarbon_data'><p>Dataframe containing geochemical data from blue carbon soil cores</p></a></li>
<li><a href='#core_comp'><p>Dataframe containing field measurements of soil cores to estimate compaction caused</p>
by core collection.</a></li>
<li><a href='#decompact'><p>Calculate sediment properties after decompaction</p></a></li>
<li><a href='#estimate_compaction'><p>Estimate Core Compaction</p></a></li>
<li><a href='#estimate_h'><p>Estimation of the thickness of the sample</p></a></li>
<li><a href='#estimate_oc'><p>Estimate organic carbon content</p></a></li>
<li><a href='#estimate_oc_stock'><p>Organic Carbon Stock estimation</p></a></li>
<li><a href='#estimate_seq_rate'><p>Estimate the average organic carbon sequestration rate</p></a></li>
<li><a href='#test_extrapolation'><p>Test differences between observed and extrapolated stocks</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimation of Organic Carbon Stocks and Sequestration Rates from
Soil Core Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to estimate soil organic carbon stocks and sequestration rates 
    in blue carbon ecosystems. 'BlueCarbon' contains functions to estimate and correct
    for core compaction, estimate sample thickness, estimate organic carbon content 
    from organic matter content, estimate organic carbon stocks and 
    sequestration rates, and visualize the error of carbon stock extrapolation. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/EcologyR/BlueCarbon">https://github.com/EcologyR/BlueCarbon</a>,
<a href="https://ecologyr.github.io/BlueCarbon/">https://ecologyr.github.io/BlueCarbon/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EcologyR/BlueCarbon/issues">https://github.com/EcologyR/BlueCarbon/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, gridExtra, reshape</td>
</tr>
<tr>
<td>Config/Needs/website:</td>
<td>rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-21 10:41:51 UTC; frs</td>
</tr>
<tr>
<td>Author:</td>
<td>Nerea Piñeiro-Juncal
    <a href="https://orcid.org/0000-0003-3767-1812"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Julen Astigarraga <a href="https://orcid.org/0000-0001-9520-3713"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Valentina Costa <a href="https://orcid.org/0000-0002-1513-0284"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Marcio Martins <a href="https://orcid.org/0000-0002-6969-2215"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Francisco Rodriguez-Sanchez
    <a href="https://orcid.org/0000-0002-7981-1599"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nerea Piñeiro-Juncal &lt;nerea.pineiro.juncal@uvigo.gal&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-21 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BlueCarbon-package'>BlueCarbon: Estimation of Organic Carbon Stocks and Sequestration Rates from Soil Core Data</h2><span id='topic+BlueCarbon'></span><span id='topic+BlueCarbon-package'></span>

<h3>Description</h3>

<p>Tools to estimate soil organic carbon stocks and sequestration rates in blue carbon ecosystems. 'BlueCarbon' contains functions to estimate and correct for core compaction, estimate sample thickness, estimate organic carbon content from organic matter content, estimate organic carbon stocks and sequestration rates, and visualize the error of carbon stock extrapolation.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nerea Piñeiro-Juncal <a href="mailto:nerea.pineiro.juncal@uvigo.gal">nerea.pineiro.juncal@uvigo.gal</a> (<a href="https://orcid.org/0000-0003-3767-1812">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Julen Astigarraga (<a href="https://orcid.org/0000-0001-9520-3713">ORCID</a>)
</p>
</li>
<li><p> Valentina Costa (<a href="https://orcid.org/0000-0002-1513-0284">ORCID</a>)
</p>
</li>
<li><p> Marcio Martins (<a href="https://orcid.org/0000-0002-6969-2215">ORCID</a>)
</p>
</li>
<li><p> Francisco Rodriguez-Sanchez (<a href="https://orcid.org/0000-0002-7981-1599">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/EcologyR/BlueCarbon">https://github.com/EcologyR/BlueCarbon</a>
</p>
</li>
<li> <p><a href="https://ecologyr.github.io/BlueCarbon/">https://ecologyr.github.io/BlueCarbon/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/EcologyR/BlueCarbon/issues">https://github.com/EcologyR/BlueCarbon/issues</a>
</p>
</li></ul>


<hr>
<h2 id='bluecarbon_data'>Dataframe containing geochemical data from blue carbon soil cores</h2><span id='topic+bluecarbon_data'></span>

<h3>Description</h3>

<p>Example dataset of geochemical data from seagrass, salt marsh and mangroves
soil cores. It does not contain real data. All variables needed to estimate
organic carbon stocks and fluxes are included. Different cores are provided,
one below the other, and samples from the same core are grouped together and
ordered from the sample closer to the soil surface to the deepest.
</p>
<p>There are four ID columns: 'site', 'core', 'ecosystem' and 'species'.
'site' refers to the ID given to the sampling location of the core.
'core' is the Id of each individual core (replicate cores would have the same
site IDs but different cores IDs).
'ecosystem' refers to the type of ecosystem where the core was collected.
'species' identifies the type of vegetation in the sampling area.
Species could either be the name of the species or a code referring to
a mixture of different species (e.g. &quot;Low&quot;, meaning the dominant species
usually found at low marsh areas).
</p>
<p>'compaction' indicates the percentage of compression suffered by the core
during retrieval. Minimum and maximum depths ('mind' and 'maxd') are the depth of
the top and bottom of each sample in the core respectively. Dry bulk density
('dbd') is the dry weight of each sample divided by the volume occupied in the
core (before compression correction). 'om' and 'oc' are the percentage of organic
matter and organic carbon in the sample. 'age' refers to the age of the sample
where the top of the core has age 0. Ages of the samples are estimated from
age-depth models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bluecarbon_data
</code></pre>


<h3>Format</h3>



<h4><code>bluecarbon_data</code></h4>

<p>A data frame with 1719 rows and 11 columns:
</p>

<dl>
<dt>site</dt><dd><p>character column with the id of the sampling locations</p>
</dd>
<dt>core</dt><dd><p>character column with the id of the core</p>
</dd>
<dt>ecosystem</dt><dd><p>character column with the name of the ecosystem,
&quot;seagrass&quot;, &quot;salt marsh&quot; or &quot;mangrove&quot;</p>
</dd>
<dt>species</dt><dd><p>character column with the main species or ecosystem type</p>
</dd>
<dt>compaction</dt><dd><p>numbers between 0 and 100</p>
</dd>
<dt>mind</dt><dd><p>number column with the upper depth of each sample</p>
</dd>
<dt>maxd</dt><dd><p>number column with the lower depth of each sample</p>
</dd>
<dt>dbd</dt><dd><p>number column with dry bulk density values, mass/volume</p>
</dd>
<dt>om</dt><dd><p>number column with percentage of organic matter, numbers between 0 and 100</p>
</dd>
<dt>oc</dt><dd><p>number column with percentage of organic carbon, numbers between 0 and 100</p>
</dd>
<dt>age</dt><dd><p>number column with age of the sample, years from sampling, positive numbers</p>
</dd>
</dl>




<h3>Source</h3>

<p>data from cores collected by the authors that have been anonymized
and modified to cover different cases that may occur when using the package.
It no longer represents any existing dataset.
</p>

<hr>
<h2 id='core_comp'>Dataframe containing field measurements of soil cores to estimate compaction caused
by core collection.</h2><span id='topic+core_comp'></span>

<h3>Description</h3>

<p>Example dataset of field measurements of cores collected by percussion.
All variables needed to estimate core compaction are included.
The 'core' ID is the same as in bluecarbon_data. 'sampler_length' is the length
of the tube or sampler introduced in the soil from top to bottom.
'internal_distance' refers to the distance between the top of the sampler and the
surface of the soil within the sampler (the same depth or lower than the
surface of the soil outside). 'external_distance' refers to the distance from
the top of the sampler to the surface of the soil outside the sampler. The
reference used as &quot;top of the sampler&quot; is the same in the three measurements.
Internal and external distances are measured after sampler insertion in the
soil and before its extraction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>core_comp
</code></pre>


<h3>Format</h3>



<h4><code>core_comp</code></h4>

<p>A data frame with 78 rows and 4 columns:
</p>

<dl>
<dt>core</dt><dd><p>character column with the id of the core</p>
</dd>
<dt>sampler_length</dt><dd><p>numeric column with the length of the sampler/tube
used to extract the core</p>
</dd>
<dt>internal_distance</dt><dd><p>numeric column with the distance between
the top of the sampler/tube and the surface of the sediment inside
the sampler/tube after finishing inserting it in the soil and before
extracting it</p>
</dd>
<dt>external_distance</dt><dd><p>numeric column with the distance between
the top of the sampler/tube and the surface of the sediment outside
the sampler/tube after finishing inserting it in the soil and before
extracting it</p>
</dd>
</dl>




<h3>Source</h3>

<p>made up data
</p>

<hr>
<h2 id='decompact'>Calculate sediment properties after decompaction</h2><span id='topic+decompact'></span>

<h3>Description</h3>

<p>Accepts a data.frame with sample properties and compaction estimations and
returns a modified version with sample properties corrected for
compaction
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decompact(
  df = NULL,
  core = "core",
  compaction = "compaction",
  mind = "mind",
  maxd = "maxd",
  dbd = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="decompact_+3A_df">df</code></td>
<td>
<p>Data.frame with core properties</p>
</td></tr>
<tr><td><code id="decompact_+3A_core">core</code></td>
<td>
<p>Character Name of the column with the id of the core to which
the sample belongs</p>
</td></tr>
<tr><td><code id="decompact_+3A_compaction">compaction</code></td>
<td>
<p>Character Name of the column with core compaction
IN PERCENTAGE, as calculated with <code><a href="#topic+estimate_compaction">estimate_compaction()</a></code>.</p>
</td></tr>
<tr><td><code id="decompact_+3A_mind">mind</code></td>
<td>
<p>Character Name of the column with minimum depth of the sample
(depth at the top of the sample)</p>
</td></tr>
<tr><td><code id="decompact_+3A_maxd">maxd</code></td>
<td>
<p>Character Name of the column with maximum depth of the sample
(depth at the bottom of the sample)</p>
</td></tr>
<tr><td><code id="decompact_+3A_dbd">dbd</code></td>
<td>
<p>Character Name of the column with dry bulk density</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The initial data.frame with the addition of two columns with the
corrected minimum and maximum depth of the samples (additionally, if a
dry bulk density column is specified, it will return another column with
corrected dry bulk density)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>decompact(bluecarbon_data) |&gt;
  head()

</code></pre>

<hr>
<h2 id='estimate_compaction'>Estimate Core Compaction</h2><span id='topic+estimate_compaction'></span>

<h3>Description</h3>

<p>Estimates the percentage of core compaction using measurements
from a data.frame containing core properties. It computes a correction factor
based on sampler tube length, internal distance, and external distance, and
adds a 'compaction' column to the input data.frame with the calculated compaction
rate as a percentage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_compaction(
  df = NULL,
  core = "core",
  sampler_length = "sampler_length",
  internal_distance = "internal_distance",
  external_distance = "external_distance"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_compaction_+3A_df">df</code></td>
<td>
<p>A data.frame containing core properties.</p>
</td></tr>
<tr><td><code id="estimate_compaction_+3A_core">core</code></td>
<td>
<p>Character Name of the column identifying each core.</p>
</td></tr>
<tr><td><code id="estimate_compaction_+3A_sampler_length">sampler_length</code></td>
<td>
<p>Character Name of the column with the total length of the
sampler tube.</p>
</td></tr>
<tr><td><code id="estimate_compaction_+3A_internal_distance">internal_distance</code></td>
<td>
<p>Character Name of the column with the distance between
sampler top and core surface.</p>
</td></tr>
<tr><td><code id="estimate_compaction_+3A_external_distance">external_distance</code></td>
<td>
<p>Character Name of the column with the distance between
sampler top and sediment surface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the input data.frame with an additional 'compaction' column indicating
the estimated percentage of core compaction.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- estimate_compaction(
  core_comp,
  core = "core",
  sampler_length = "sampler_length",
  internal_distance = "internal_distance",
  external_distance = "external_distance"
)
head(df)


</code></pre>

<hr>
<h2 id='estimate_h'>Estimation of the thickness of the sample</h2><span id='topic+estimate_h'></span>

<h3>Description</h3>

<p>checks for space between samples and, if any, divide this space between the previous and
next sample to return sample thickness without gaps in the core
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_h(
  df = NULL,
  core = "core",
  mind = "mind_corrected",
  maxd = "maxd_corrected"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_h_+3A_df">df</code></td>
<td>
<p>A data.frame with columns core, mind (minimum depth of the sample) and maxd (maximum depth of the sample)</p>
</td></tr>
<tr><td><code id="estimate_h_+3A_core">core</code></td>
<td>
<p>Character Name of the column reporting core ID.</p>
</td></tr>
<tr><td><code id="estimate_h_+3A_mind">mind</code></td>
<td>
<p>Character Name of the column reporting the minimum depth of each sample.</p>
</td></tr>
<tr><td><code id="estimate_h_+3A_maxd">maxd</code></td>
<td>
<p>Character Name of the column reporting the maximum depth of each sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the initial data.frame with three additional columns:
</p>

<ul>
<li><p> emin (estimated minimum depth of the sample)
</p>
</li>
<li><p> emax (estimated maximum depth of the sample)
</p>
</li>
<li><p> h (estimated thickness of the sample)
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>bluecarbon_decompact &lt;- decompact(bluecarbon_data)
out &lt;- estimate_h(bluecarbon_decompact)
</code></pre>

<hr>
<h2 id='estimate_oc'>Estimate organic carbon content</h2><span id='topic+estimate_oc'></span>

<h3>Description</h3>

<p>Estimate organic carbon from organic matter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_oc(
  df = NULL,
  core = "core",
  site = "site",
  ecosystem = "ecosystem",
  species = "species",
  om = "om",
  oc = "oc"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_oc_+3A_df">df</code></td>
<td>
<p>A tibble or data.frame containing all the data. Must have at least
five columns (see arguments below).</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_core">core</code></td>
<td>
<p>Character Name of the column with the id of the core to which
the sample belongs</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_site">site</code></td>
<td>
<p>Character Name of the column reporting sample site.</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_ecosystem">ecosystem</code></td>
<td>
<p>Character Name of the column reporting ecosystem type.
To apply published equations for OC estimation, ecosystem names should be
either &quot;Salt Marsh&quot;, &quot;Seagrass&quot; or &quot;Mangrove&quot;.</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_species">species</code></td>
<td>
<p>Character Name of the column reporting the main species in the site.</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_om">om</code></td>
<td>
<p>Character Name of the column reporting organic matter values.</p>
</td></tr>
<tr><td><code id="estimate_oc_+3A_oc">oc</code></td>
<td>
<p>Character Name of the column reporting organic carbon values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of organic Carbon is done by means of linear regressions on
log(organic carbon) ~ log(organic matter), which return estimated organic carbon
value for each organic matter value provided. If there is a value for organic carbon
for that sample it returns the same value; otherwise, it estimates organic carbon
from a model fitted to that site, or a model fitted to that species, or else
a model fitted to that ecosystem. If there are too few samples (&lt;10) to build a
reliable model or the model fit is too poor (r2 &lt; 0.5), <code><a href="#topic+estimate_oc">estimate_oc()</a></code> uses the equations
in Fourqurean et al. (2012) <a href="https://doi.org/10.1038/ngeo1477">doi:10.1038/ngeo1477</a> for seagrasses,
Maxwell et al. (2023) <a href="https://doi.org/10.1038/s41597-023-02633-x">doi:10.1038/s41597-023-02633-x</a> for salt marshes
and Piñeiro-Juncal (in prep.) for mangroves to estimate the organic carbon.
</p>


<h3>Value</h3>

<p>The initial tibble or data.frame with three new columns:
</p>

<ul>
<li><p> one column with estimated organic carbon values (eOC) in %
</p>
</li>
<li><p> the standard error of the prediction (eOC_se)
</p>
</li>
<li><p> the type of model used for estimation (origin)
</p>
</li></ul>

<p>In addition, a plot with the relationship between organic matter and estimated
organic carbon values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bluecarbon_decompact &lt;- decompact(bluecarbon_data)
out &lt;- estimate_oc(bluecarbon_decompact)
head(out$data)
out$models
</code></pre>

<hr>
<h2 id='estimate_oc_stock'>Organic Carbon Stock estimation</h2><span id='topic+estimate_oc_stock'></span>

<h3>Description</h3>

<p>Estimates carbon stocks from soil core data down to a specified
depth, 100 cm by default. If the core does not reach the standardized depth,
it extrapolates the stock from a linear model between accumulated mass of
organic carbon and depth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_oc_stock(
  df = NULL,
  depth = 100,
  core = "core",
  mind = "mind_corrected",
  maxd = "maxd_corrected",
  dbd = "dbd",
  oc = "eoc"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_oc_stock_+3A_df">df</code></td>
<td>
<p>A data.frame with core (core id), mind (minimum depth of the
sample), maxd (maximum depth of the sample), dbd (dry bulk density), oc
(organic carbon %)</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_depth">depth</code></td>
<td>
<p>mas depth to estimate the stock, by default 100.</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_core">core</code></td>
<td>
<p>Character Name of the column reporting core ID.</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_mind">mind</code></td>
<td>
<p>Character Name of the column reporting the minimum depth of each sample.</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_maxd">maxd</code></td>
<td>
<p>Character Name of the column reporting the maximum depth of each sample.</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_dbd">dbd</code></td>
<td>
<p>Character Name of the column reporting dry bulk density.</p>
</td></tr>
<tr><td><code id="estimate_oc_stock_+3A_oc">oc</code></td>
<td>
<p>Character Name of the column reporting organic carbon concentrations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with columns core, stockwc (organic carbon stock at the whole core),
maxd (maximum depth of the core), stock (organic carbon stock at the standardized depth),
and stock_se (standard error for the estimated stock).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bluecarbon_decompact &lt;- decompact(bluecarbon_data)

oc &lt;- estimate_oc(bluecarbon_decompact)

out &lt;- estimate_oc_stock(oc[[1]])
head(out)

</code></pre>

<hr>
<h2 id='estimate_seq_rate'>Estimate the average organic carbon sequestration rate</h2><span id='topic+estimate_seq_rate'></span>

<h3>Description</h3>

<p>estimate the average organic carbon sequestration rate to the soil in a indicated time frame (by default last 100 years)
from the organic carbon concentration and ages obtained from a age-depth or age-accumulated mass model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_seq_rate(
  df = NULL,
  timeframe = 100,
  core = "core",
  mind = "mind_corrected",
  maxd = "maxd_corrected",
  dbd = "dbd",
  oc = "eoc",
  age = "age"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_seq_rate_+3A_df">df</code></td>
<td>
<p>A data.frame with, at least, columns: core, mind (minimum depth of the sample),
maxd (maximum depth of the sample), dbd (dry bulk density), oc (organic carbon %),
age (age of the sample obtained from a age-depth or age-accumulated mass model)</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_timeframe">timeframe</code></td>
<td>
<p>standardization time frame, by default 100 years</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_core">core</code></td>
<td>
<p>Character Name of the column reporting core ID.</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_mind">mind</code></td>
<td>
<p>Character Name of the column reporting the minimum depth of each sample.</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_maxd">maxd</code></td>
<td>
<p>Character Name of the column reporting the maximum depth of each sample.</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_dbd">dbd</code></td>
<td>
<p>Character Name of the column reporting dry bulk density.</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_oc">oc</code></td>
<td>
<p>Character Name of the column reporting organic carbon concentrations.</p>
</td></tr>
<tr><td><code id="estimate_seq_rate_+3A_age">age</code></td>
<td>
<p>Character Name of the column reporting the age of each sample.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with columns 'core', seq_rate_wc (organic carbon sequestration rates at the whole core),
maxage (maximum age of the core), and seq_rate (average organic carbon sequestration rate at the indicated time frame)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bluecarbon_decompact &lt;- decompact(bluecarbon_data)
oc &lt;- estimate_oc(bluecarbon_decompact)
out &lt;- estimate_seq_rate(oc[[1]])
head(out)
</code></pre>

<hr>
<h2 id='test_extrapolation'>Test differences between observed and extrapolated stocks</h2><span id='topic+test_extrapolation'></span>

<h3>Description</h3>

<p>Subset those cores that reach the standardization depth and estimates the stock (observed stock),
estimate the stock from the linear relation of organic carbon accumulated mass and depth using the 90, 75, 50 and 25%
top length of the indicated standardization depth. Compares the observed stock with the estimated stocks by extrapolation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_extrapolation(
  df = NULL,
  depth = 100,
  core = "core",
  mind = "mind_corrected",
  maxd = "maxd_corrected",
  dbd = "dbd",
  oc = "eoc"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="test_extrapolation_+3A_df">df</code></td>
<td>
<p>A data.frame with, at least, columns: core,
mind (minimum depth of the sample), maxd (maximum depth of the sample),
dbd (dry bulk density), oc (organic carbon %)</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_depth">depth</code></td>
<td>
<p>Number Standardization soil depth, by default 100 cm.</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_core">core</code></td>
<td>
<p>Character Name of the column reporting core ID.</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_mind">mind</code></td>
<td>
<p>Character Name of the column reporting the minimum depth of each sample.</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_maxd">maxd</code></td>
<td>
<p>Character Name of the column reporting the maximum depth of each sample.</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_dbd">dbd</code></td>
<td>
<p>Character Name of the column reporting dry bulk density.</p>
</td></tr>
<tr><td><code id="test_extrapolation_+3A_oc">oc</code></td>
<td>
<p>Character Name of the column reporting organic carbon concentrations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with the observed and extrapolated stocks. A plot with comparisons.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bluecarbon_decompact &lt;- decompact(bluecarbon_data)
oc &lt;- estimate_oc(bluecarbon_decompact)
out &lt;- test_extrapolation(oc[[1]])


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
