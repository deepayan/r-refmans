<!DOCTYPE html><html><head><title>Help for package FlexGAM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FlexGAM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#deviance.flexgam'>
<p>Deviance of FlexGAM model</p></a></li>
<li><a href='#flexgam'>
<p>Estimation of generalized additive model with flexible response function</p></a></li>
<li><a href='#flexgam_outputs'>
<p>Prints object of class flexgam</p></a></li>
<li><a href='#match_control'>
<p>Function to check the control parameters</p></a></li>
<li><a href='#Methods'>
<p>Extract model parameters</p></a></li>
<li><a href='#plot.flexgam'>
<p>Plots object of class flexgam.</p></a></li>
<li><a href='#predict.flexgam'>
<p>Predicts values for the object of class flexgam</p></a></li>
<li><a href='#response.flexgam'>
<p>Predicts values for the object of class flexgam</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generalized Additive Models with Flexible Response Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-06-06</td>
</tr>
<tr>
<td>Author:</td>
<td>Elmar Spiegel [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Elmar Spiegel &lt;espiege@uni-goettingen.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), mgcv (&ge; 1.8-23)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, MASS, Matrix, scam, splines, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Standard generalized additive models assume a response function, 
    which induces an assumption on the shape of the distribution of the 
    response. However, miss-specifying the response function results in biased 
    estimates. Therefore in Spiegel et al. (2017) 
    &lt;<a href="https://doi.org/10.1007%2Fs11222-017-9799-6">doi:10.1007/s11222-017-9799-6</a>&gt; we propose to estimate the response function
    jointly with the covariate effects. This package provides the underlying 
    functions to estimate these generalized additive models with flexible 
    response functions. The estimation is based on an iterative algorithm. In 
    the outer loop the response function is estimated, while in the inner loop 
    the covariate effects are determined. For the response function a strictly
    monotone P-spline is used while the covariate effects are estimated based on
    a modified Fisher-Scoring algorithm. Overall the estimation relies on the 
    'mgcv'-package. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-06-06 17:26:40 UTC; Elmar</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-06-07 09:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='deviance.flexgam'>
Deviance of FlexGAM model
</h2><span id='topic+deviance.flexgam'></span>

<h3>Description</h3>

<p>Calculating the (predictive) deviance of the model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
deviance(object, newdata=NULL, use_penalty=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deviance.flexgam_+3A_object">object</code></td>
<td>

<p>Object of class <code>flexgam</code>.
</p>
</td></tr>
<tr><td><code id="deviance.flexgam_+3A_newdata">newdata</code></td>
<td>

<p>Data to estimate the (predictive) deviance.
</p>
</td></tr>
<tr><td><code id="deviance.flexgam_+3A_use_penalty">use_penalty</code></td>
<td>

<p>If the deviance should be penalized according to the smoothing penalties.
</p>
</td></tr>
<tr><td><code id="deviance.flexgam_+3A_...">...</code></td>
<td>

<p>Currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the model deviance of the object for the given data. To get the same value as for <code>object$deviance</code> you need to set <code>use_penalty = TRUE</code>. This is due to the fact that the deviance element of the object is the penalized deviance used for step halving.
</p>


<h3>Value</h3>

<p>Estimated deviance
</p>


<h3>Note</h3>

<p>To get numeric stability the fitted values are truncated (<code>min_mu_k</code>) to achieve numeric stability.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code>, <code><a href="#topic+predict.flexgam">predict.flexgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))
set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)
(deviance           &lt;- deviance(model_2, newdata=Data))
</code></pre>

<hr>
<h2 id='flexgam'>
Estimation of generalized additive model with flexible response function
</h2><span id='topic+flexgam'></span>

<h3>Description</h3>

<p>Main function to estimate generalized additive models with flexible response function. Currently the response must be binomial, Poisson, Gaussian or Gamma distributed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flexgam(formula, data, type = c("FlexGAM1","FlexGAM2","FlexGAM1n",
        "FlexGAM2n"), family, control = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flexgam_+3A_formula">formula</code></td>
<td>

<p>Formula of the covariate effects. The formula must be in the design of the <code>mgcv</code> package.
</p>
</td></tr>
<tr><td><code id="flexgam_+3A_data">data</code></td>
<td>

<p>Data to fit the model.
</p>
</td></tr>
<tr><td><code id="flexgam_+3A_type">type</code></td>
<td>

<p>Should the response function be estimated completely flexible (<code>"FlexGAM2"</code>) or with a surrounding canonical link (<code>"FlexGAM1"</code>)? <code>"FlexGAM1n"</code> and <code>"FlexGAM2n"</code> are similar to <code>"FlexGAM1"</code> and <code>"FlexGAM2"</code>, but without monotonicity constraint. Therefore we do not recommend to use <code>"FlexGAM1n"</code> and <code>"FlexGAM2n"</code>.
</p>
</td></tr>
<tr><td><code id="flexgam_+3A_family">family</code></td>
<td>

<p>Family of the data. Currently only <code>binomial(link="logit")</code>,  <code>poisson(link="log")</code>, <code>gaussian(link="identity")</code> and <code>Gamma(link="log")</code> are possible.
</p>
</td></tr>
<tr><td><code id="flexgam_+3A_control">control</code></td>
<td>

<p>Control parameters to fit the model. The default values are described in <br /> <code><a href="#topic+match_flexgam_control">match_flexgam_control</a></code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To reduce the bias of miss-specified response functions the function estimates the response function jointly with the covariate effects. The covariate effects are build similar to the standard mgcv::gam, while the response function is either estimated as a strictly  monotone P-spline or a combination of the canonical  link and a transformation of the &quot;linear&quot;-predictor. In the outer loop the response function is estimated, while in the inner loop a modified version of the Fisher-Scoring algorithm is applied to get the covariate effects. In the algorithm step-halving is applied. Identifiability is achieved due to at least two smooth effects and scaling of the predictors.
</p>


<h3>Value</h3>

<p>Object of class <code>flexgam</code>. The list includes the 
</p>

<ul>
<li> <p><code>f_k</code>: The estimated response function.
</p>
</li>
<li> <p><code>gam_temp</code>: The final step of the Fisher-Scoring algorithm, so the weighted linear model based on the mgcv-package.
</p>
</li>
<li> <p><code>sm_par_vec</code>: The estimated smoothing parameters.
</p>
</li>
<li> <p><code>coefficients</code>: The coefficients of the predictor as well as of the response function.
</p>
</li>
<li> <p><code>se</code>: The standard deviation of the coefficients.
</p>
</li>
<li> <p><code>mean_eta_k</code>, <code>sd_eta_k</code>: Some information about the scaling of the predictor.
</p>
</li>
<li> <p><code>control</code>: The applied control parameters.
</p>
</li>
<li> <p><code>control_input</code>: The control parameters in the input
</p>
</li>
<li> <p><code>details</code>: Information about the occurrence  of modifications due to extreme values and the convergence. As well as information of the steps done in the algorithm (if saved).
</p>
</li>
<li><p> As well as other stuff for internal usage
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+predict.flexgam">predict.flexgam</a></code>, <code><a href="#topic+plot.flexgam">plot.flexgam</a></code>, <code><a href="#topic+deviance.flexgam">deviance.flexgam</a></code>, <code><a href="#topic+match_flexgam_control">match_flexgam_control</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)

print(model_2)
summary(model_2)

plot(model_2, type = "response")
plot(model_2, type = "covariate")

</code></pre>

<hr>
<h2 id='flexgam_outputs'>
Prints object of class flexgam
</h2><span id='topic+print.flexgam'></span><span id='topic+summary.flexgam'></span>

<h3>Description</h3>

<p>Prints information for objects of class <code>flexgam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
print(x, ...)
## S3 method for class 'flexgam'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flexgam_outputs_+3A_object">object</code></td>
<td>

<p>Object of class <code>flexgam</code>.
</p>
</td></tr>
<tr><td><code id="flexgam_outputs_+3A_x">x</code></td>
<td>

<p>Object of class <code>flexgam</code>.
</p>
</td></tr>
<tr><td><code id="flexgam_outputs_+3A_...">...</code></td>
<td>

<p>Currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>print</code> prints a short list of information about the given object.
<code>summary</code> prints the same list as <code>print</code> and adds the values of the estimated coefficients and the corresponding standard deviations.
</p>


<h3>Value</h3>

<p>None, only printing of object details.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)

print(model_2)
summary(model_2)

</code></pre>

<hr>
<h2 id='match_control'>
Function to check the control parameters
</h2><span id='topic+match_flexgam_control'></span>

<h3>Description</h3>

<p>Controls if the values of the control parameters are correct. If any control parameters are missing those are set to default. For internal use only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>match_flexgam_control(control = NULL, formula = formula, data=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="match_control_+3A_control">control</code></td>
<td>

<p>List of control parameters or NULL.
</p>
</td></tr>
<tr><td><code id="match_control_+3A_formula">formula</code></td>
<td>

<p>Formula of the model to calculate the initial smoothing parameters.
</p>
</td></tr>
<tr><td><code id="match_control_+3A_data">data</code></td>
<td>

<p>Data of the model to calculate the initial smoothing parameters.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Controls if the values of the control parameters are correct. If control parameters are missing they are set to default:
</p>

<ul>
<li> <p><code>"max_iter_in"</code>          =  <code>100</code>         Maximal number of inner iterations. 
</p>
</li>
<li> <p><code>"max_iter_out"</code>         =  <code>100</code>        Maximal number of outer iterations.
</p>
</li>
<li> <p><code>"delta_in"</code>             =  <code>1e-06</code>      Convergence of inner iterations. 
</p>
</li>
<li> <p><code>"delta_out"</code>            =  <code>1e-06</code>       Convergence of outer iterations. 
</p>
</li>
<li> <p><code>"min_mu_k"</code>             =  <code>1e-06</code>       Minimal value  of the fitted value. Also used to generate the upper limit for binomial data. Used to truncate the fitted values for numeric stability. (Occurrence can be read in the details). 
</p>
</li>
<li> <p><code>"min_Psi_d"</code>            =  <code>1e-06</code>      Minimal value of the derivative of the outer function. Used to truncate the derivatives for numeric stability. (Occurrence can be read in the details). 
</p>
</li>
<li> <p><code>"min_increase"</code>         =  <code>1e-04</code>       Minimal increase of the outer function.  



</p>
</li>
<li> <p><code>"delta_halving"</code>        =  <code>1e-06</code>       Minimal difference at step-halving. 
</p>
</li>
<li> <p><code>"min_iter_halving_in"</code>  =  <code>1</code>           From which inner iteration should step halving be possible? 
</p>
</li>
<li> <p><code>"min_iter_halving_out"</code>  =  <code>2</code>          From which outer iteration the deviance stopping criterion should be applied? The minimum value is 2, to get the algorithm always starting.
</p>
</li>
<li> <p><code>"opt_function"</code>         =  <code>"optim"</code>    Which optimization function should be used to optimize the smoothing parameters? (<code>nlminb</code> or <code>optim(Nelder-Mead)</code>) 


</p>
</li>
<li> <p><code>"initial_sm"</code>            =  <code>TRUE</code>        Should the smoothing parameters of the standard <code>mgcv::gam</code> be used as initial values for the covariates smoothing parameters and a grid search be applied to get initial values for the smoothing parameter of the outer function?
</p>
</li>
<li> <p><code>"fix_smooth"</code>           =  <code>FALSE</code>       Should the initial smoothing parameters (<code>sm_par_vec</code>) be used without optimization?  
</p>
</li>
<li> <p><code>"sm_par_vec"</code>           = <code>c("lambda"=1,"s(x1)"=...)</code>    Initial smoothing parameters. Vector must start with <code>"lambda"</code> for the response function. The names of the covariate effects must fit to the <code>mgcv</code> output of the specified formula.  There is no need to specify the initial parameters, if <code>initial_sm = TRUE</code> and <code>fix_smooth = FALSE</code>.
</p>
</li>
<li> <p><code>"sp_range"</code>             =  <code>c(1e-8, 1e15)</code>   Range of all smoothing parameters. 


</p>
</li>
<li> <p><code>"reltol_opt"</code>         =  <code>1e-06</code>       Relative tolerance for optimizing the smoothing parameters. 

</p>
</li>
<li> <p><code>"quietly"</code>              =  <code>FALSE</code>       Should the algorithm print steps of optimizing the smoothing parameters and iteration procedure for the final model? 
</p>
</li>
<li> <p><code>"save_step_response"</code>   =  <code>FALSE</code>       Should the steps of the algorithm be saved for convergences checks? 
</p>
</li>
<li> <p><code>"initial_model"</code>        =  <code>c("with_intercept","no_intercept")</code>       Whether the initial model should be estimated with or without intercept.
</p>
</li></ul>



<h3>Value</h3>

<p>List of control parameters to fit the <code>flexgam</code> model.
</p>


<h3>Note</h3>

<p>The function is designed for internal usage.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># Only for internal usage.
</code></pre>

<hr>
<h2 id='Methods'>
Extract model parameters
</h2><span id='topic+coefficients.flexgam'></span><span id='topic+coef.flexgam'></span><span id='topic+fitted.flexgam'></span><span id='topic+fitted.values.flexgam'></span><span id='topic+residuals.flexgam'></span><span id='topic+resid.flexgam'></span>

<h3>Description</h3>

<p>These are the standard functions to extract parameters of the estimated object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
coefficients(object, ...)
## S3 method for class 'flexgam'
coef(object, ...)
## S3 method for class 'flexgam'
fitted(object, ...)
## S3 method for class 'flexgam'
fitted.values(object, ...)
## S3 method for class 'flexgam'
residuals(object, ...)
## S3 method for class 'flexgam'
resid(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Methods_+3A_object">object</code></td>
<td>

<p>Object of class <code>flexgam</code>.
</p>
</td></tr>
<tr><td><code id="Methods_+3A_...">...</code></td>
<td>

<p>Currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These functions extract the coefficients, fitted values or residuals of the given object.
</p>


<h3>Value</h3>

<p>Coefficients, fitted values or residuals of the given object.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)

coefficients(model_2)

</code></pre>

<hr>
<h2 id='plot.flexgam'>
Plots object of class flexgam.
</h2><span id='topic+plot.flexgam'></span>

<h3>Description</h3>

<p>Plots resulting response (link) function or estimated smooth effects of objects of class <code>flexgam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
plot(x, type=c("response","covariate"), ci = TRUE,  rug = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.flexgam_+3A_x">x</code></td>
<td>

<p>Object of class flexgam.
</p>
</td></tr>
<tr><td><code id="plot.flexgam_+3A_type">type</code></td>
<td>

<p>Whether the response function or the smooth covariate effects should be plotted.
</p>
</td></tr>
<tr><td><code id="plot.flexgam_+3A_ci">ci</code></td>
<td>

<p>Include confidence intervals?
</p>
</td></tr>
<tr><td><code id="plot.flexgam_+3A_rug">rug</code></td>
<td>

<p>Include rug plots?
</p>
</td></tr>
<tr><td><code id="plot.flexgam_+3A_...">...</code></td>
<td>

<p>Standard plot add-ons should work. ylab and xlab check for the length of the smooth predictor.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots either the estimated response function or the estimated smooth covariate effects. Valid confidence intervals are currently only plotted for P-splines.
</p>


<h3>Value</h3>

<p>Plots
</p>


<h3>Note</h3>

<p>If other smooth effects than P-splines are used in the formula the plot function internally calls <code>mgcv::plot.gam</code> to show their effect. Then P-splines are plotted twice.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)

plot(model_2,type="response")
plot(model_2,type="covariate")

</code></pre>

<hr>
<h2 id='predict.flexgam'>
Predicts values for the object of class flexgam
</h2><span id='topic+predict.flexgam'></span>

<h3>Description</h3>

<p>Predicts values for the given object and a given dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
predict(object, newdata=NULL, type=c("response","linear.predictor", 
        "terms"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.flexgam_+3A_object">object</code></td>
<td>

<p>Object of class flexgam.
</p>
</td></tr>
<tr><td><code id="predict.flexgam_+3A_newdata">newdata</code></td>
<td>

<p>New data to build predicted values. Same behaviour as in standard predict.
</p>
</td></tr>
<tr><td><code id="predict.flexgam_+3A_type">type</code></td>
<td>

<p>Should the fitted values (<code>'response'</code>) or the linear predictor (<code>'linear.predictor'</code>) be predicted. Alternatively the linear predictor for each covariate separately is given (<code>'terms'</code>).
</p>
</td></tr>
<tr><td><code id="predict.flexgam_+3A_...">...</code></td>
<td>

<p>Currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates the predicted values for the given model.
</p>


<h3>Value</h3>

<p>Numeric vector or matrix of fitted values
</p>


<h3>Note</h3>

<p>The sum of the <code>'terms'</code> is not the <code>'linear.predictor'</code> since the <code>'terms'</code> misses the scaling.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code>, <code><a href="#topic+deviance.flexgam">deviance.flexgam</a></code>, <code><a href="#topic+response.flexgam">response.flexgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)


set.seed(2)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

newData &lt;- data.frame(y,x1,x2,x3)

fitted_2 &lt;- predict(model_2, newdata=newData)

</code></pre>

<hr>
<h2 id='response.flexgam'>
Predicts values for the object of class flexgam
</h2><span id='topic+response.flexgam'></span><span id='topic+response'></span>

<h3>Description</h3>

<p>Predicts values for the given object, if a new predictor is given.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'flexgam'
response(object, linear.predictor = NULL, ...)
response(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="response.flexgam_+3A_object">object</code></td>
<td>

<p>Object of class flexgam.
</p>
</td></tr>
<tr><td><code id="response.flexgam_+3A_linear.predictor">linear.predictor</code></td>
<td>

<p>New predictor, which has to be centered and scaled properly.
</p>
</td></tr>
<tr><td><code id="response.flexgam_+3A_...">...</code></td>
<td>

<p>Currently not used
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates predicted values for the given model. Used to get the estimated response function separately from the covariate effects. For the same predictor <code>predict.flexgam(...,type="response")</code> and <code>response(...)</code> are equal.
</p>


<h3>Value</h3>

<p>Numeric vector of fitted values.
</p>


<h3>Author(s)</h3>

<p>Elmar Spiegel
</p>


<h3>References</h3>

<p>Spiegel, Elmar, Thomas Kneib and Fabian Otto-Sobotka. Generalized additive models with flexible response functions. Statistics and Computing (2017). https://doi.org/10.1007/s11222-017-9799-6
</p>


<h3>See Also</h3>

<p><code><a href="#topic+flexgam">flexgam</a></code>, <code><a href="#topic+deviance.flexgam">deviance.flexgam</a></code>, <code><a href="#topic+predict.flexgam">predict.flexgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

Data &lt;- data.frame(y,x1,x2,x3)
formula &lt;- y ~ s(x1,k=20,bs="ps") + s(x2,k=20,bs="ps") + x3

# Fix smoothing parameters to save computational time.
control2 &lt;- list("fix_smooth" = TRUE, "quietly" = TRUE, "sm_par_vec" = 
                     c("lambda" = 100, "s(x1)" = 2000, "s(x2)" = 9000))

set.seed(2)
model_2 &lt;- flexgam(formula=formula, data=Data, type="FlexGAM2", 
                   family=binomial(link=logit), control = control2)


set.seed(2)
n &lt;- 1000
x1 &lt;- runif(n)
x2 &lt;- runif(n)
x3 &lt;- runif(n)
eta_orig &lt;- -1 + 2*sin(6*x1) + exp(x2) + x3
pi_orig &lt;- pgamma(eta_orig, shape=2, rate=sqrt(2))
y &lt;- rbinom(n,size=1,prob=pi_orig)

newData &lt;- data.frame(y,x1,x2,x3)



fitted_1 &lt;- predict(model_2, newdata=newData, type="response")
predictor1 &lt;- predict(model_2, newdata=newData, type="linear.predictor")
fitted_2 &lt;- response(model_2, linear.predictor=predictor1)
all.equal(fitted_1,fitted_2)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
