<!DOCTYPE html><html lang="en"><head><title>Help for package splm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {splm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bsjktest'><p>Baltagi, Song, Jung and Koh LM test for spatial panels</p></a></li>
<li><a href='#bsktest'><p>Baltagi, Song and Koh LM test for spatial panels</p></a></li>
<li><a href='#effects.splm'><p>method for extracting fixed effects</p></a></li>
<li><a href='#Insurance'><p>Insurance consumption across Italian provinces, 1998-2002</p></a></li>
<li><a href='#itaww'><p>Spatial weights matrix - Italian provinces</p></a></li>
<li><a href='#listw2dgCMatrix'><p>Interface between Matrix class objects and weights list</p></a></li>
<li><a href='#print.splm'><p>print method for class splm</p></a></li>
<li><a href='#RiceFarms'><p>Production of Rice in India</p></a></li>
<li><a href='#riceww'><p>Spatial weights matrix of Indonesian rice farms</p></a></li>
<li><a href='#rwtest'><p>Randomization-based test of spatial dependence for panel models</p></a></li>
<li><a href='#slag'><p>Spatial lag operator</p></a></li>
<li><a href='#slmtest'><p>Locally robust panel Lagrange Multiplier tests for spatial dependence</p></a></li>
<li><a href='#spgm'><p>GM estimation of spatial panel data models</p></a></li>
<li><a href='#sphtest'><p>Hausman test for spatial panel data models</p></a></li>
<li><a href='#spml'><p>Spatial Panel Model by Maximum Likelihood</p></a></li>
<li><a href='#spreml'><p>Spatial Panel Model with Random Effects by Maximum Likelihood</p></a></li>
<li><a href='#summary.splm'><p>summary method for class splm</p></a></li>
<li><a href='#usaww'><p>Spatial weights matrix - US states</p></a></li>
<li><a href='#vcov.splm'><p>Covariance extractor method for <code>splm</code> objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Econometric Models for Spatial Panel Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-11</td>
</tr>
<tr>
<td>Description:</td>
<td>ML and GM estimation and diagnostic testing of econometric models for spatial panel data.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.12.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>plm, maxLik, MASS, bdsmatrix, nlme, Matrix, spam, methods,
spatialreg (&ge; 1.2-1), spdep (&ge; 1.2-1), stringr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-11 15:00:43 UTC; root</td>
</tr>
<tr>
<td>Author:</td>
<td>Giovanni Millo [aut, cre],
  Gianfranco Piras [aut],
  Roger Bivand <a href="https://orcid.org/0000-0003-2392-6140"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Giovanni Millo &lt;giovanni.millo@deams.units.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 16:20:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='bsjktest'>Baltagi, Song, Jung and Koh LM test for spatial panels</h2><span id='topic+bsjktest'></span><span id='topic+bsjktest.formula'></span>

<h3>Description</h3>

<p>Baltagi, Song, Jung and Koh joint or conditional LM test for
spatial error correlation or serial correlation sub spatial, serial correlation and random effects in panel models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsjktest(x,...)
## S3 method for class 'formula'
bsjktest(x, data, index=NULL, listw,
test=c("C.1","C.2","C.3","J"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bsjktest_+3A_x">x</code></td>
<td>
<p>an object of class  <code>formula</code></p>
</td></tr>
<tr><td><code id="bsjktest_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> or <code>pdata.frame</code> containing the variables in the model</p>
</td></tr>
<tr><td><code id="bsjktest_+3A_index">index</code></td>
<td>
<p>either NULL (default) or a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="bsjktest_+3A_listw">listw</code></td>
<td>
<p>either a <code>matrix</code> or a <code>listw</code> representing the spatial structure</p>
</td></tr>
<tr><td><code id="bsjktest_+3A_test">test</code></td>
<td>
<p>one of <code>c("C.1","C.2","C.3","J")</code>, the
test to be performed.</p>
</td></tr>
<tr><td><code id="bsjktest_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>htest</code>
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Baltagi, B.H., Song, S.H., Jung B. and Koh, W. (2007)
Testing panel data regression models with spatial and serial error correlation.
<em>Journal of Econometrics</em>, <b>140</b>, 5-51.</p>


<h3>See Also</h3>

<p><code>bsktest</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package="plm")
data(usaww)
fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp
bsjktest(fm, data=Produc, listw = usaww, test="C.1")
</code></pre>

<hr>
<h2 id='bsktest'>Baltagi, Song and Koh LM test for spatial panels</h2><span id='topic+bsktest'></span><span id='topic+bsktest.formula'></span>

<h3>Description</h3>

<p>Baltagi, Song and Koh marginal or conditional LM test for
spatial error correlation or random effects in panel models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsktest(x,...)
## S3 method for class 'formula'
bsktest(x, data, index=NULL, listw,
test=c("LMH","LM1","LM2","CLMlambda","CLMmu"), 
standardize=FALSE, method = "eigen", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bsktest_+3A_x">x</code></td>
<td>
<p>a <code>formula</code></p>
</td></tr>
<tr><td><code id="bsktest_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> or <code>pdata.frame</code> containing the variables
in the model</p>
</td></tr>
<tr><td><code id="bsktest_+3A_index">index</code></td>
<td>
<p>either NULL (default) or a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="bsktest_+3A_listw">listw</code></td>
<td>
<p>a <code>listw</code> representing the spatial structure</p>
</td></tr>
<tr><td><code id="bsktest_+3A_test">test</code></td>
<td>
<p>one of <code>c("LMH","LM1","LM2","CLMlambda","CLMmu")</code>, the
test to be performed</p>
</td></tr>
<tr><td><code id="bsktest_+3A_standardize">standardize</code></td>
<td>
<p>whether to standardize the test statistic or not (applies only to LM1 and LM2)</p>
</td></tr>
<tr><td><code id="bsktest_+3A_method">method</code></td>
<td>
<p>select a method for ML in &quot;CLMmu&quot;. the default is &quot;eigen&quot;</p>
</td></tr>
<tr><td><code id="bsktest_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>htest</code>
</p>


<h3>Author(s)</h3>

<p>Gianfranco Piras</p>


<h3>References</h3>

<p>Baltagi, B.H., Song, S.H. and Koh, W. (2003)
Testing panel data regression models with spatial error correlation.
<em>Journal of Econometrics</em>, <b>117</b>, 123&ndash;150.
</p>
<p>Millo, G., Piras, G. (2012)
splm: Spatial Panel Data Models in R.
<em>Journal of Statistical Software</em>, <b>47(1)</b>, 1&ndash;38.
URL http://www.jstatsoft.org/v47/i01/.</p>


<h3>See Also</h3>

<p><code>sphtest</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package="plm")
data(usaww)
fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp
bsktest(fm,data=Produc, listw = spdep::mat2listw(usaww),
  test="LM1")
</code></pre>

<hr>
<h2 id='effects.splm'>method for extracting fixed effects</h2><span id='topic+effects.splm'></span><span id='topic+print.effects.splm'></span>

<h3>Description</h3>

<p>Methods used for extracting fixed effects from objects of class <code>splm</code> where <code>type</code> is one of 
&quot;fixed effects lag&quot; or &quot;fixed effects error&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'splm'
effects(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="effects.splm_+3A_object">object</code></td>
<td>
<p>an object of class <code>'splm'</code></p>
</td></tr>
<tr><td><code id="effects.splm_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed over</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the argument <code>object</code> is not of class <code>splm</code> 
the function will terminate with an error.
</p>
<p>If the argument <code>object</code> is of class <code>splm</code> 
but <code>type</code> is not one of 
&quot;fixed effects lag&quot; or &quot;fixed effects error&quot;,
the function will terminate with an error.
</p>


<h3>Value</h3>

<p>An object of class <code>effects.splm</code>
</p>
<table role = "presentation">
<tr><td><code>res</code></td>
<td>
<p>a list whose elements are various type of fixed effects and the intercept (when present)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianfranco Piras</p>


<h3>References</h3>

<p>Elhorst, J.P. (2003) 
Specification and estimation of spatial panel data models,
<em>International Regional Science Review</em>, <b>26</b>, pages 244&ndash;268.
</p>
<p>Elhorst, J.P. (2009) 
Spatial panel data models,
<em>In</em> Fischer, M.M. and Getis, A. (eds),
<em>Handbook of Applied Spatial Analysis</em> Springer, Berlin.
</p>


<h3>See Also</h3>

<p><code>spml</code> <code>summary.effects.splm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
err &lt;- spml(fm, data = Produc, listw = spdep::mat2listw(usaww), model="within")
summary(err)
eff &lt;- effects(err) 
print(eff)
</code></pre>

<hr>
<h2 id='Insurance'>Insurance consumption across Italian provinces, 1998-2002</h2><span id='topic+Insurance'></span>

<h3>Description</h3>

<p>A panel of 103 observations
</p>
<p><em>number of observations</em> :  515
</p>
<p><em>observation</em> :  provinces
</p>
<p><em>country</em> :  Italy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Insurance)</code></pre>


<h3>Format</h3>

<p>A dataframe containing :
</p>

<dl>
<dt>code</dt><dd><p>the province code according to Istat</p>
</dd>
<dt>year</dt><dd><p>the year of observation</p>
</dd>
<dt>ppcd</dt><dd><p>real per capita premiums in 2000 euros, non-life insurance excluding mandatory motor third-party liability</p>
</dd>
<dt>rgdp</dt><dd><p>real per-capita GDP</p>
</dd>
<dt>bank</dt><dd><p>real per-capita bank deposits</p>
</dd>
<dt>den</dt><dd><p>population density per square Km</p>
</dd>
<dt>rirs</dt><dd><p>real interest rate on lending to families and small enterprises</p>
</dd>
<dt>agen</dt><dd><p>density of insurance agencies per 1000 inhabitants</p>
</dd>
<dt>school</dt><dd><p>share of people with second grade schooling or more</p>
</dd>
<dt>vaagr</dt><dd><p>share of value added, agriculture</p>
</dd>
<dt>fam</dt><dd><p>average number of family members</p>
</dd>
<dt>inef</dt><dd><p>judicial inefficiency index: average years to settle first degree of civil case</p>
</dd>
<dt>trust</dt><dd><p>survey result to the question &quot;do you trust others?&quot;</p>
</dd>
<dt>dXX</dt><dd><p>year dummies</p>
</dd>
<dt>NorthWest</dt><dd><p>macroregional dummy</p>
</dd>
<dt>NorthEast</dt><dd><p>macroregional dummy</p>
</dd>
<dt>Centre</dt><dd><p>macroregional dummy</p>
</dd>
<dt>South</dt><dd><p>macroregional dummy</p>
</dd>
<dt>Islands</dt><dd><p>macroregional dummy (Sicily and Sardinia)</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>Source</h3>

<p>Giovanni Millo and Gaetano Carmeci, (2011) &ldquo;Non-life insurance consumption in Italy: a sub-regional panel data analysis&rdquo;, <em>Journal of Geographical Systems</em>, <b>13:273&ndash;298</b>.
</p>

<hr>
<h2 id='itaww'>Spatial weights matrix - Italian provinces</h2><span id='topic+itaww'></span>

<h3>Description</h3>

<p>Spatial weights matrix of the 103 Italian provinces as in 1992-2005.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(itaww)
</code></pre>


<h3>Format</h3>

<p>A matrix with elements different from zero if province i and j are
neighbors. Weights are row-standardized. Messina and Reggio Calabria, divided by the Messina Strait, are considered neighbours.</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>

<hr>
<h2 id='listw2dgCMatrix'>Interface between Matrix class objects and weights list </h2><span id='topic+listw2dgCMatrix'></span>

<h3>Description</h3>

<p>Interface between Matrix class objects and weights list 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listw2dgCMatrix(listw, zero.policy = NULL) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="listw2dgCMatrix_+3A_listw">listw</code></td>
<td>
<p>a <code>listw</code> object created for example by <code>spdep::nb2listw</code> </p>
</td></tr>
<tr><td><code id="listw2dgCMatrix_+3A_zero.policy">zero.policy</code></td>
<td>
<p>See <code>lagsarlm</code> for details</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix class object: a sparse Matrix</p>


<h3>Author(s)</h3>

<p>Gianfranco Piras</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(columbus, package="spdep")
listw&lt;-spdep::nb2listw(col.gal.nb)
spW&lt;-listw2dgCMatrix(listw)
</code></pre>

<hr>
<h2 id='print.splm'>print method for class splm</h2><span id='topic+print.splm'></span>

<h3>Description</h3>

<p>Method to print objects of class <code>summary.splm</code> and <code>splm</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'splm'
print(x, digits = max(3,getOption("digits") -3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.splm_+3A_x">x</code></td>
<td>
<p>an object of class <code>splm</code></p>
</td></tr>
<tr><td><code id="print.splm_+3A_digits">digits</code></td>
<td>
<p>minimal number of significant digits, see <code>print.default</code></p>
</td></tr>
<tr><td><code id="print.splm_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary function <code>summary.splm</code> 
returns an objects of class 'splm' 
organized in a coefficient matrix.
</p>
<p>Also a matrix for the error components, 
or the spatial coefficients will be generated 
depending on the estimated model. 
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo, Gianfranco Piras</p>


<h3>See Also</h3>

<p><code>spml</code>, <code>spgm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm") 
data(usaww)
spremod&lt;-spml(log(gsp)~log(pcap)+log(pc)+log(emp)+unemp, data=Produc,
listw = spdep::mat2listw(usaww), model="random", lag=TRUE, spatial.error="none")
summary(spremod)
</code></pre>

<hr>
<h2 id='RiceFarms'>Production of Rice in India </h2><span id='topic+RiceFarms'></span>

<h3>Description</h3>

<p>yearly observations of 171 farms
</p>
<p><em>number of observations</em> :  1026
</p>
<p><em>country</em> :  Indonesia
</p>
<p><em>economic topic</em> : producer behavior
</p>
<p><em>econometrics topic</em> : error component
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(RiceFarms)</code></pre>


<h3>Format</h3>

<p>A dataframe containing :
</p>

<dl>
<dt>id</dt><dd><p>the farm identifier</p>
</dd>
<dt>time</dt><dd><p>the growing season</p>
</dd>
<dt>size</dt><dd><p>the total area cultivated with rice, measured in hectares</p>
</dd>
<dt>status</dt><dd><p>land status, on of <code>'owner'</code> (non sharecroppers, owner operators or leasholders or both), <code>'share'</code> (sharecroppers), <code>'mixed'</code> (mixed of the two previous status)</p>
</dd>
<dt>varieties</dt><dd><p>one of <code>'trad'</code> (traditional varieties), <code>'high'</code> (high yielding varieties) and <code>'mixed'</code> (mixed varieties)</p>
</dd>
<dt>bimas</dt><dd><p>bIMAS is an intensification program ; one of <code>'no'</code> (non-bimas famer), <code>'yes'</code> (bimas farmer) or <code>'mixed'</code> (part but not all of farmer's land was registered to be in the bimas program)</p>
</dd>
<dt>seed</dt><dd><p>seed in kilogram</p>
</dd>
<dt>urea</dt><dd><p>urea in kilogram</p>
</dd>
<dt>phosphate</dt><dd><p>phosphate in kilogram</p>
</dd>
<dt>pesticide</dt><dd><p>pesticide cost in Rupiah</p>
</dd>
<dt>pseed</dt><dd><p>price of seed in Rupiah per kg</p>
</dd>
<dt>purea</dt><dd><p>price of urea in Rupiah per kg</p>
</dd>
<dt>pphosph</dt><dd><p>price of phosphate in Rupiah per kg</p>
</dd>
<dt>hiredlabor</dt><dd><p>hired labor in hours</p>
</dd>
<dt>famlabor</dt><dd><p>family labor in hours</p>
</dd>
<dt>totlabor</dt><dd><p>total labor (excluding harvest labor)</p>
</dd>
<dt>wage</dt><dd><p>labor wage in Rupiah per hour</p>
</dd>
<dt>goutput</dt><dd><p>gross output of rice in kg</p>
</dd>
<dt>noutput</dt><dd><p>net output, gross output minus harvesting cost (paid in terms of rice)</p>
</dd>
<dt>price</dt><dd><p>price of rough rice in Rupiah per Kg</p>
</dd>
<dt>region</dt><dd><p>one of <code>'wargabinangun'</code>, <code>'langan'</code>, <code>'gunungwangi'</code>, <code>'malausma'</code>, <code>'sukaambit'</code>, <code>'ciwangi'</code></p>
</dd>
</dl>



<h3>Source</h3>

<p>Journal of Applied Econometrics Data Archive.
</p>


<h3>References</h3>

<p>Qu Feng and William C. Horrace, (2012) &ldquo;Alternative Measures of Technical Efficiency: Skew, Bias and Scale&rdquo;, <em>Journal of Applied Econometrics</em>, <b>forthcoming</b>.
</p>
<p>Horrace, W.C.  and  P.  Schmidt (1996) &ldquo;Confidence statements for efficiency estimates from stochastic frontier models&rdquo;, <em>Journal of Productivity Analysis</em>, <b> 7</b>, 257&ndash;282.
</p>

<hr>
<h2 id='riceww'>Spatial weights matrix of Indonesian rice farms</h2><span id='topic+riceww'></span>

<h3>Description</h3>

<p>Spatial weights matrix of the 171 farms in the Indonesian Rice Farming example. Farms in the same village (out of six) are considered contiguous.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(riceww)
</code></pre>


<h3>Format</h3>

<p>A matrix with elements different from zero if farms i and j are
neighbors. Farms are considered neighbors if in the same village. Weights are row-standardized.</p>


<h3>Author(s)</h3>

<p>Giovanni Millo, data provided by Yves Croissant</p>

<hr>
<h2 id='rwtest'>Randomization-based test of spatial dependence for panel models</h2><span id='topic+rwtest'></span><span id='topic+rwtest.formula'></span><span id='topic+rwtest.panelmodel'></span><span id='topic+rwtest.pseries'></span>

<h3>Description</h3>

<p>Randomization-based test of spatial dependence for panel models, robust
to global dependence induced by common factors and to persistence
(serial correlation) in the data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rwtest(x, ...)
## S3 method for class 'formula'
rwtest(x, data, w, index = NULL, model = NULL,
                         replications = 99, seed=NULL, order=1,
                         mc=1, test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
## S3 method for class 'panelmodel'
rwtest(x, w, replications = 99, seed=NULL,
                         order=1, mc=1,
                         test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
## S3 method for class 'pseries'
rwtest(x, w, replications = 99, seed=NULL,
                         order=1, mc=1,
                         test = c("rho", "cd", "sclm"),
                         alternative=c("twosided", "onesided",
                                       "symmetric"), ...)
                          
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rwtest_+3A_x">x</code></td>
<td>
<p>an object of class <code>formula</code>, <code>panelmodel</code>, or <code>pseries</code> 
(depending on the respective interface) describing the model to be tested</p>
</td></tr>
<tr><td><code id="rwtest_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
<tr><td><code id="rwtest_+3A_w">w</code></td>
<td>
<p>a <code>n x n</code> <code>matrix</code> describing proximity between
individuals, with <code class="reqn">w_ij = a</code> where <code class="reqn">a</code> is any number such
that <code>as.logical(a)==TRUE</code>,
if <code class="reqn">i,j</code> are neighbours, <code class="reqn">0</code> or any number <code class="reqn">b</code> such that
<code>as.logical(b)==FALSE</code> elsewhere. Only the lower triangluar part
(without diagonal) of <code>w</code> after coercing by <code>as.logical()</code>
is evaluated for neighbouring information (but <code>w</code> can be
symmetric). See also <b>Details</b> and <b>Examples</b>.</p>
</td></tr>
<tr><td><code id="rwtest_+3A_index">index</code></td>
<td>
<p>an optional numerical index, in case <code>data</code> has to be
formatted by <code>plm.data</code></p>
</td></tr> 
<tr><td><code id="rwtest_+3A_model">model</code></td>
<td>
<p>an optional character string indicating which type of
model to estimate; 
if left to <code>NULL</code>, the original heterogeneous specification of
Pesaran is used</p>
</td></tr>
<tr><td><code id="rwtest_+3A_replications">replications</code></td>
<td>
<p>the number of Monte Carlo randomizations of the
neighbourhood matrix (default: 99),</p>
</td></tr>
<tr><td><code id="rwtest_+3A_seed">seed</code></td>
<td>
<p>the optional random seed,</p>
</td></tr>
<tr><td><code id="rwtest_+3A_order">order</code></td>
<td>
<p>the order of neighbourhood to test for,</p>
</td></tr>
<tr><td><code id="rwtest_+3A_mc">mc</code></td>
<td>
<p>the number of parallel threads to execute; defaults to 1
(serial execution); is limited to the number of execution cores
actually available, and depends on operating system support.</p>
</td></tr>
<tr><td><code id="rwtest_+3A_test">test</code></td>
<td>
<p>the type of test statistic to be returned. One of 
</p>

<ul>
<li> <p><code>"rho"</code> for the average correlation coefficient,
</p>
</li>
<li> <p><code>"cd"</code> for Pesaran's CD statistic, or
</p>
</li>
<li> <p><code>"sclm"</code> for the scaled version of Breusch and Pagan's LM
statistic,</p>
</li></ul>
</td></tr>
<tr><td><code id="rwtest_+3A_alternative">alternative</code></td>
<td>
<p>the alternative hypothesis for the test, defaulting
to (asymmetric) twosided,</p>
</td></tr>
<tr><td><code id="rwtest_+3A_...">...</code></td>
<td>
<p>further arguments to be passed on to <code>plm</code>, such as
e.g. <code>effect</code> or <code>random.method</code></p>
</td></tr> 
</table>


<h3>Details</h3>

<p>This test is meant as a generalization of Pesaran's spatial dependence
test &quot;CD(p)&quot; for robustness against global dependence (perhaps of the
factor type) and persistence in the data, both of which the original
test does not tolerate. 
</p>
<p>The procedure can be applied to model residuals as well as to
individual <code>pseries</code>.
See the comments in <code>pcdtest</code> as for the different methods.
</p>
<p>Space is defined supplying a proximity matrix (elements coercible to
<code>logical</code>) with argument <code>w</code> which provides information on
whether any pair of individuals are neighbours or not. If
<code>order=1</code>, only first-order neighbouring pairs will be used in
computing the test; else, <code>w</code> will be transformed in the
neighbourhood matrix of the appropriate order. The matrix need not be
binary, so commonly used &ldquo;row&ndash;standardized&rdquo; matrices can be employed
as well. <code>nb</code> objects from <span class="pkg">spdep</span> must instead be transformed
into matrices by <span class="pkg">spdep</span>'s function <code>nb2mat</code> before using.
</p>
<p>Notice that the <code>"rho"</code> and <code>"cd"</code> tests are permutationally
equivalent. 
</p>
<p>The test is suitable also for unbalanced panels.
</p>
<p>The test on a <code>pseries</code> is the same as a test on a pooled
regression model of that variable on a constant,
i.e. <code>rwtest(some_pseries)</code> is equivalent to
<code>rwtest(plm(some_var ~ 1, data = some_pdata.frame, model =
  "pooling")</code> and also equivalent to <code>rwtest(some_var ~ 1, data =
  some_data)</code>, where <code>some_var</code> is the variable name in the data
which corresponds to <code>some_pseries</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>"htest"</code>.
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Millo, G. (2016), A simple randomization test for spatial dependence in
the presence of common factors and serial correlation,
<em>(unpublished)</em>, <b>xx</b>(x), pp. xxx&ndash;xxx. 
Pesaran, M.H. (2004), General Diagnostic Tests for Cross Section
Dependence in Panels, <em>CESifo</em> Working Paper 1229. 
Pesaran, M.H. (2015), Testing Weak Cross&ndash;Sectional Dependence in Large
Panels, <em>Econometric Reviews</em>, <b>34</b>(6-10), pp. 1089&ndash;1117. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## test on heterogeneous model (separate time series regressions)
rwtest(fm, data = Produc, w=usaww, index = c("state", "year"))

## test on two-way fixed effects homogeneous model
rwtest(fm, data = Produc, w=usaww, index = c("state", "year"),
       model = "within", effect = "twoways")

## test on panelmodel object
library(plm)
g &lt;- plm(fm, data = Produc)
rwtest(g, w=usaww)

## test on pseries, higher-order neighbourhood
pprod &lt;- pdata.frame(Produc)
rwtest(pprod$gsp, w=usaww, order=3)
</code></pre>

<hr>
<h2 id='slag'>Spatial lag operator</h2><span id='topic+slag'></span><span id='topic+slag.default'></span><span id='topic+slag.pseries'></span>

<h3>Description</h3>

<p>Spatial lagging method for vectors or <code>pseries</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'pseries'
slag(x, listw, maxlag, ...)
## Default S3 method:
slag(x, listw, maxlag, index, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slag_+3A_x">x</code></td>
<td>
<p>an object of class  <code>pseries</code></p>
</td></tr>
<tr><td><code id="slag_+3A_listw">listw</code></td>
<td>
<p>an object of class <code>listw</code></p>
</td></tr>
<tr><td><code id="slag_+3A_maxlag">maxlag</code></td>
<td>
<p>the spatial lag order (including lower)</p>
</td></tr> 
<tr><td><code id="slag_+3A_index">index</code></td>
<td>
<p>the default method needs a well-specified index</p>
</td></tr>
<tr><td><code id="slag_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>pseries</code>
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package="plm")
data(usaww)
usalw &lt;- spdep::mat2listw(usaww)
fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp+slag(log(pcap),
  listw=usalw)
slxmod &lt;- spreml(fm, data=Produc, w = usaww,
  model="pooling", lag=FALSE, errors="ols")
</code></pre>

<hr>
<h2 id='slmtest'>Locally robust panel Lagrange Multiplier tests for spatial dependence</h2><span id='topic+slmtest'></span><span id='topic+slmtest.formula'></span><span id='topic+slmtest.plm'></span>

<h3>Description</h3>

<p>Locally robust LM tests for spatial lag (error) correlation sub
spatial error (lag) correlation in panel models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>slmtest(x,...)
## S3 method for class 'formula'
slmtest(formula, data, listw, model="pooling",
 test=c("lme","lml","rlme","rlml"), index=NULL, ...)
## S3 method for class 'plm'
slmtest(x, listw,
 test=c("lme","lml","rlme","rlml"), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="slmtest_+3A_formula">formula</code></td>
<td>
<p>an object of class  <code>formula</code></p>
</td></tr>
<tr><td><code id="slmtest_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code> or <code>pdata.frame</code> containing the
variables in the model</p>
</td></tr>
<tr><td><code id="slmtest_+3A_x">x</code></td>
<td>
<p>an object of class <code>plm</code></p>
</td></tr>
<tr><td><code id="slmtest_+3A_listw">listw</code></td>
<td>
<p>either a <code>matrix</code> or a <code>listw</code> representing the
spatial structure</p>
</td></tr>
<tr><td><code id="slmtest_+3A_model">model</code></td>
<td>
<p>a character value specifying the transformation to be
applied to the data.</p>
</td></tr> 
<tr><td><code id="slmtest_+3A_test">test</code></td>
<td>
<p>one of <code>c("lme","lml","rlme","rlml")</code>, the
test to be performed.</p>
</td></tr>
<tr><td><code id="slmtest_+3A_index">index</code></td>
<td>
<p>either NULL (default) or a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="slmtest_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This tests are panel versions of the locally robust LM tests of
Anselin et al. (1996), based on a pooling assumption: i.e., they do
not allow for any kind of individual effect. Therefore it is advisable
to employ a within transformation whenever individual effects cannot
be ruled out.
</p>
<p>It must be kept in mind that these locally robust procedures have been
designed for situations in which the &quot;other&quot; effect is not of
substantial magnitude, and can behave suboptimally otherwise.
</p>
<p>Four tests are available to be chosen through the <code>test</code>
argument: <code>"lml"</code> for &quot;LM lag&quot; and, respectively, <code>"lme"</code>
for &quot;LM error&quot; are the standard, non-robust versions, obtained simply
pooling the cross-sectional versions; <code>"rlml"</code> and <code>"rlme"</code>
are, respectively, the locally robust test for lag, allowing for a
spatial error; and for error, allowing for a spatial lag.
</p>
<p>The <code>model</code> argument, specified according to the standards of
<code>plm</code>, is passed on internally and employed to determine the panel
data transformation to be applied before calculating the test. Defaults
to <code>"pooling"</code> (no transformation).
</p>


<h3>Value</h3>

<p>an object of class <code>htest</code>
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Anselin, L., Bera, A.K., Florax, R. and Yoon, M.J. (1996)
Simple diagnostic tests for spatial dependence.
<em>Regional Science and Urban Economics</em>, <b>26</b>(1), 77-104.
Elhorst, J.P. (2014) Spatial Panel data Models, in Spatial Econometrics
(Springer) 37-93.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package="plm")
data(usaww)
fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp
## robust LM test for spatial error sub spatial lag
## model on original data, pooling hypothesis
slmtest(fm, data=Produc, listw = usaww, test="rlme")
## model on within-transformed (time-demeaned) data,
## eliminates individual effects
slmtest(fm, data=Produc, listw = usaww, test="rlme",
  model="within")
</code></pre>

<hr>
<h2 id='spgm'>GM estimation of spatial panel data models</h2><span id='topic+spgm'></span><span id='topic+ivsplm'></span><span id='topic+spsarargm'></span><span id='topic+sperrorgm'></span>

<h3>Description</h3>

<p>GM estimation of panel data models with spatially correlated 
errors components of the form: 
</p>
<p style="text-align: center;"><code class="reqn"> y_N(t) = \lambda W y + X_N(t) \beta + u_N(t) </code>
</p>

<p style="text-align: center;"><code class="reqn"> u_N(t) = \rho W_N u_N(t) + \epsilon(t)</code>
</p>

<p style="text-align: center;"><code class="reqn"> \epsilon_N = (e_T \otimes I_N ) \mu_N + \nu_N </code>
</p>

<p>where <code class="reqn"> \rho</code>, and the variance components <code class="reqn">\sigma^2_\mu</code> and <code class="reqn">\sigma^2_\nu</code> 
are estimated by GM, and the model coefficients by a Feasible GLS estimator. The model can also include 
additional (other than the spatial lag) endogenous variables. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spgm(formula, data=list(), index=NULL, listw = NULL, listw2 = NULL, Durbin = FALSE,
         model = c("within", "random"), lag = FALSE, spatial.error = TRUE,
         moments = c("initial", "weights", "fullweights"), endog = NULL, 
         instruments = NULL, lag.instruments = FALSE, verbose = FALSE, 
         method = c("w2sls", "b2sls", "g2sls", "ec2sls"), control = list(), 
         optim.method = "nlminb",  pars = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spgm_+3A_formula">formula</code></td>
<td>
<p>a description of the model to be fit. The details of model specification are given
for <code>lm</code> </p>
</td></tr>
<tr><td><code id="spgm_+3A_data">data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. An optional data frame containing the variables
in the model. When the obect is a <code>data.frame</code>, the first two columns may contain the indexes. See <code>index</code></p>
</td></tr>
<tr><td><code id="spgm_+3A_index">index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="spgm_+3A_listw">listw</code></td>
<td>
<p>an object of class <code>listw</code>, <code>matrix</code>, or <code>Matrix</code></p>
</td></tr></table>
<p>. 
</p>
<table role = "presentation">
<tr><td><code id="spgm_+3A_listw2">listw2</code></td>
<td>
<p>an object of class <code>listw</code>, <code>matrix</code>, or <code>Matrix</code>. Only 
if both <code>lag</code> and <code>spatial.error</code> are both <code>TRUE</code></p>
</td></tr>
<tr><td><code id="spgm_+3A_durbin">Durbin</code></td>
<td>
<p>default <code>FALSE</code>. If <code>TRUE</code> all the regressors are also spatially lagged. If it is a formula (Durbin = <code>~ xi + x2</code>), only the variables specified in the formula are lagged.  </p>
</td></tr>
<tr><td><code id="spgm_+3A_model">model</code></td>
<td>
<p>One of <code>"within"</code> or <code>"random"</code>. The assumption
made on the individual effects</p>
</td></tr>
<tr><td><code id="spgm_+3A_lag">lag</code></td>
<td>
<p>if <code>TRUE</code> a spatial lag of the dependent variable is
added to the regression equation</p>
</td></tr>
<tr><td><code id="spgm_+3A_spatial.error">spatial.error</code></td>
<td>
<p>a logic vector. If <code>TRUE</code> the spatial autoregressive error term is added to the model and an estimate for <code class="reqn">\rho</code> is produced</p>
</td></tr>
<tr><td><code id="spgm_+3A_moments">moments</code></td>
<td>
<p><code>"initial"</code> (default) defines the set of GM estimator to be used. Alternatives are  
<code>"weights"</code> and <code>"fullweights"</code> (See Details)</p>
</td></tr>
<tr><td><code id="spgm_+3A_endog">endog</code></td>
<td>
<p>additional endogenous variables. Default <code>NULL</code>. If not <code>NULL</code> should be specified 
as a formula with no dependent variable (endog = ~ x1 + x2). Note the ~ before the expression. </p>
</td></tr>
<tr><td><code id="spgm_+3A_instruments">instruments</code></td>
<td>
<p>external instruments. Default <code>NULL</code>. If not <code>NULL</code> should be specified 
as a formula with no dependent variable (instruments = ~ x1 + x2). Note the ~ before the expression.</p>
</td></tr>
<tr><td><code id="spgm_+3A_lag.instruments">lag.instruments</code></td>
<td>
<p>should the external instruments be spatially lagged?</p>
</td></tr>
<tr><td><code id="spgm_+3A_verbose">verbose</code></td>
<td>
<p>default <code>fALSE</code>, If <code>TRUE</code> reports function values during optimization</p>
</td></tr>  
<tr><td><code id="spgm_+3A_method">method</code></td>
<td>
<p>One of <code>"w2sls"</code>, <code>"b2sls"</code>, <code>"g2sls"</code>, <code>"ec2sls"</code>. (See Details)</p>
</td></tr>
<tr><td><code id="spgm_+3A_control">control</code></td>
<td>
<p>a list of control parameters for the optimization</p>
</td></tr>
<tr><td><code id="spgm_+3A_optim.method">optim.method</code></td>
<td>
<p>default set to <code>"nlminb"</code>. or optionally a method passed to <code>optim</code> to use an alternative optimizer.</p>
</td></tr>
<tr><td><code id="spgm_+3A_pars">pars</code></td>
<td>
<p>initial values of the parameter <code>rho</code> and <code>sigmav</code>. The default for <code>rho</code> is to 
start from a regression of the spatially lagged residuals on the residuals (depending on the model). 
for <code>sigmav</code> the starting value is the variance of the residuals (again this depends on the model).  </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p>The function is a very general interface to estimate various nested specifications of the 
general model including additional endogenous variables described above. 
When both <code>spatial.error</code> and <code>lag</code> are <code>FALSE</code> the model reduces to a 
panel data model with an additional endogeneous variable. The function then uses <code>ivsplm</code> 
to perform the Instrumental Variables and two-stage least squares for panel data model.  <code>method = "w2sls"</code> 
corresponds to the fixed effects estimator, <code>method = "b2sls"</code> to the between effects model,
<code>method = "g2sls"</code> to the GLS random effects model, and <code>method = "ec2sls"</code> to the Baltagi's 
EC2SLS. 
</p>
<p>When <code>spatial.error</code> is <code>TRUE</code> and <code>lag</code> is <code>FALSE</code> the model is one with spatially autocorrelated
error components. If <code>effects</code> is <code>"random"</code>, the Kapoor et al. (2007) GM estimator is performed and
the residuals in the first step come from an OLS regression. 
When <code>moments</code> is <code>"initial"</code>, the initial estimator is calculated. This first set 
of GM estimators is based only on a subset of the moments conditions and assigns 
equal weigths to each of them. 
When <code>moments</code> is <code>"fullweights"</code>, the second set of GM estimators is calculated. This estimator 
is based on the full set of moments conditions. It also involves the expression for the variance 
covariance matrix of the sample moments calculated under the assumption of 
normally distributed innovations. The calculation of the trace terms in the expression 
of the variance covariance matrix of the sample moments 
uses codes from the <code>Matrix</code> package. 
When <code>moments</code> is<code>"weights"</code>, the third set of GM estimator is used. This is motivated by computational 
issues. The procedure is analogous to the second one but uses a simplified expression for the 
variance covariance matrix of the sample moments.
If <code>effects</code> is <code>"fixed"</code>, the initial 
estimator is a within estimator and the moments conditions of Kapoor et al. (2007) are modified accordingly.
</p>
<p>Finally, when both <code>spatial.error</code> and <code>lag</code> are <code>TRUE</code> the complete model is estimated (with or without 
additional endogenous variables). OLS residuals are no longer consistent because of the spatially lagged dependent variable.
If <code>effects</code> is <code>"random"</code>, two initial estimators are computed: a within two-stage least squares
and a between two stage least squares. The two sets of corresponding residuals are used in the spatial generalized moments estimator
(GM) where the moments conditions of Kapoor et al. (2007) are again modified accordingly.
If <code>effects</code> is <code>"fixed"</code>, the initial 
estimator is a within two stage least squares estimator and the moments conditions of Kapoor et al. (2007) are modified accordingly.
</p>
<p>Note that for the random effects models, <code class="reqn">\sigma^2_\mu</code> is not reported. <code class="reqn">\sigma^2_1</code> is reported instead. 
However, a value for <code class="reqn">\sigma^2_\mu</code> can easily be obtained from:
</p>
<p style="text-align: center;"><code class="reqn">\sigma^2_1 = \sigma^2_\nu + T \sigma^2_\mu</code>
</p>

<p>The function also produces an estimate for <code class="reqn">\theta</code> which is a
function of the variance components.
</p>


<h3>Value</h3>

<p>An object of class <code>"splm"</code>.
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>GLS coefficients estimate of the model parameters</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the variance covariance matrix of the estimated coefficients</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the GLS residuals</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>difference between response variable and residuals</p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>GLS residuals variance</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>'a description of the model estimated'</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>a vector including the spatial parameter and the variance components (see Details)</p>
</td></tr>  
<tr><td><code>model</code></td>
<td>
<p>the matrix of the data used</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used to create the object</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gianfranco Piras</p>


<h3>References</h3>

<p>Kapoor, M., Kelejian, H.H. and Prucha, I.R. (2007) 
Panel data model with spatially correlated error components,
<em>Journal of Econometrics</em>, <b>140</b>, pages 97&ndash;130. 
</p>
<p>Mutl, J., and Pfaffermayr, M. (2011) 
The Hausman test in a Cliff and Ord panel model,
<em>Econometrics Journal</em>, <b>14</b>, pages 48&ndash;76. 
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1999) 
A Generalized Moments Estimator for the Autoregressive Parameter in a Spatial Model,
<em>International Economic Review</em>, <b>40</b>, pages 509&ndash;533.
</p>
<p>Kelejian, H.H. and Prucha, I.R. (1999) 
A Generalized Spatial Two Stage Least Square Procedure for Estimating a Spatial Autoregressive
Model with Autoregressive Disturbances,
<em>Journal of Real Estate Finance and Economics</em>, <b>17</b>,
pages 99&ndash;121.
</p>
<p>Millo, G., Piras, G. (2012)
splm: Spatial Panel Data Models in R.
<em>Journal of Statistical Software</em>, <b>47(1)</b>, 1&ndash;38.
URL http://www.jstatsoft.org/v47/i01/.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(splm)
library(plm)
data(Produc)
data(usaww)
########SPATIAL LAG MODEL######
#no space no endog: error use plm
## Not run: GM_lag_b2sls &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                     lag = FALSE, spatial.error = FALSE, method = "b2sls",
                     listw = usaww)
## End(Not run)
#no space but endog 
GM_b2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                       lag = FALSE, spatial.error = FALSE, endog = ~ log(pcap),
                       method = "b2sls",
                       instruments = ~log(hwy), listw = usaww)
summary(GM_b2sls_e)
GM_g2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                   lag = FALSE, spatial.error = FALSE, endog = ~ log(pcap),
                   method = "g2sls",
                   instruments = ~log(hwy), listw = usaww)
summary(GM_g2sls_e)
GM_ec2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                   lag = FALSE, spatial.error = FALSE, endog = ~ log(pcap),
                   method = "ec2sls",
                   instruments = ~log(hwy), listw = usaww)
summary(GM_ec2sls_e)
GM_w2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                   lag = FALSE, spatial.error = FALSE, endog = ~ log(pcap),
                   method = "w2sls",
                   instruments = ~log(hwy), listw = usaww)
summary(GM_w2sls_e)
#SPATIAL LAG MODEL 
GM_lag_b2sls &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
           lag = TRUE, spatial.error = FALSE, method = "b2sls",
           listw = usaww)
summary(GM_lag_b2sls)
GM_lag_g2sls &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
           lag = TRUE, spatial.error = FALSE, method = "g2sls",
           listw = usaww)
summary(GM_lag_g2sls)
GM_lag_ec2sls &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
           lag = TRUE, spatial.error = FALSE, method = "ec2sls",
           listw = usaww)
summary(GM_lag_ec2sls)
GM_lag_w2sls &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
           lag = TRUE, spatial.error = FALSE,
           listw = usaww, method = "w2sls")
summary(GM_lag_w2sls)
#endogenous
GM_lag_b2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                  lag = TRUE,
                  spatial.error = FALSE, endog = ~ log(pcap),
                  method = "b2sls",
                  instruments = ~log(hwy), listw = usaww)
summary(GM_lag_b2sls_e)
GM_lag_g2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                       lag = TRUE,
                       spatial.error = FALSE, endog = ~ log(pcap),
                       method = "g2sls",
                       instruments = ~log(hwy), listw = usaww)
summary(GM_lag_g2sls_e)
GM_lag_ec2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                       lag = TRUE,
                       spatial.error = FALSE, endog = ~ log(pcap),
                       method = "ec2sls",
                       instruments = ~log(hwy), listw = usaww)
summary(GM_lag_ec2sls_e)
GM_lag_w2sls_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                       lag = TRUE,
                       spatial.error = FALSE, endog = ~ log(pcap),
                       method = "w2sls",
                       instruments = ~log(hwy), listw = usaww)
summary(GM_lag_w2sls_e)

########SPATIAL ERROR MODEL######
GM_error_within &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                     lag = FALSE, spatial.error = TRUE, model = "within",
                     listw = usaww)
summary(GM_error_within)
GM_error_random &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                        lag = FALSE, spatial.error = TRUE, model = "random",
                        listw = usaww)
summary(GM_error_random)
GM_error_within_fw &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                        lag = FALSE, spatial.error = TRUE, model = "within",
                        listw = usaww, moments = "fullweights")
summary(GM_error_within_fw)
GM_error_random_w &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                        lag = FALSE, spatial.error = TRUE, model = "random",
                        listw = usaww, moments = "fullweights")
summary(GM_error_random_w)
#endogenous
GM_error_within_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                        lag = FALSE,
                        spatial.error = TRUE, endog = ~ log(pcap),
                        model = "within",
                        instruments = ~log(hwy), listw = usaww)
summary(GM_error_within_e)
GM_error_random_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                       lag = FALSE,
                       spatial.error = TRUE, endog = ~ log(pcap),
                       model = "random",
                       instruments = ~log(hwy), listw = usaww)
summary(GM_error_random_e)

########SARAR MODEL######
GM_sarar_within &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                        lag = TRUE, spatial.error = TRUE, model = "within",
                        listw = usaww)
summary(GM_sarar_within)
GM_sarar_random &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                        lag = TRUE, spatial.error = TRUE, model = "random",
                        listw = usaww)
summary(GM_sarar_random)
GM_sarar_within_fw &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                           lag = TRUE, spatial.error = TRUE, model = "within",
                           listw = usaww, moments = "fullweights")
summary(GM_sarar_within_fw)
GM_sarar_random_fw &lt;- spgm(log(gsp) ~ log(pcap) + log(pc) + unemp, data=Produc,
                          lag = TRUE, spatial.error = TRUE, model = "random",
                          listw = usaww, moments = "fullweights")
summary(GM_sarar_random_fw)
#endogenous
GM_sarar_within_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                          lag = TRUE,
                          spatial.error = TRUE, endog = ~ log(pcap),
                          model = "within",
                          instruments = ~log(hwy), listw = usaww)
summary(GM_sarar_within_e)
GM_sarar_random_e &lt;- spgm(log(gsp) ~  log(pc) + unemp, data=Produc,
                          lag = TRUE,
                          spatial.error = TRUE, endog = ~ log(pcap),
                          model = "random",
                          instruments = ~log(hwy), listw = usaww)
summary(GM_sarar_random_e)
</code></pre>

<hr>
<h2 id='sphtest'>Hausman test for spatial panel data models</h2><span id='topic+sphtest'></span><span id='topic+sphtest.formula'></span><span id='topic+sphtest.splm'></span>

<h3>Description</h3>

<p>Hausman specification test for spatial panel data models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sphtest(x, ...)
## S3 method for class 'formula'
sphtest(x, data, index = NULL, listw,
      spatial.model = c("lag", "error", "sarar"),
      method = c("ML", "GM"), errors = c("KKP", "BSK"),...)
## S3 method for class 'splm'
sphtest(x, x2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sphtest_+3A_x">x</code></td>
<td>
<p>an object of class  <code>formula</code> or <code>splm</code> </p>
</td></tr>
<tr><td><code id="sphtest_+3A_x2">x2</code></td>
<td>
<p>an object of class  <code>splm</code> </p>
</td></tr>
<tr><td><code id="sphtest_+3A_data">data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. An optional data frame containing the variables
in the model. When the obect is a <code>data.frame</code>, the first two columns may contain the indexes. See <code>index</code></p>
</td></tr>
<tr><td><code id="sphtest_+3A_index">index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="sphtest_+3A_listw">listw</code></td>
<td>
<p>an object of class <code>listw</code> created for example by <code>spdep::nb2listw</code> </p>
</td></tr>
<tr><td><code id="sphtest_+3A_spatial.model">spatial.model</code></td>
<td>
<p>one of <code>c("lag","error","sarar")</code>, the model to be estimated (only lag, only error, both lag and error dependence)</p>
</td></tr>
<tr><td><code id="sphtest_+3A_method">method</code></td>
<td>
<p>one of <code>c("ML","GM")</code></p>
</td></tr>
<tr><td><code id="sphtest_+3A_errors">errors</code></td>
<td>
<p>one of <code>c("BSK","KPP")</code>. When <code>method</code> is <code>"ML"</code> defines the specification of the innovations</p>
</td></tr>
<tr><td><code id="sphtest_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>htest</code>
</p>


<h3>Author(s)</h3>

<p>Gianfranco Piras</p>


<h3>References</h3>

<p>Millo, G., Piras, G. (2012)
splm: Spatial Panel Data Models in R.
<em>Journal of Statistical Software</em>, <b>47(1)</b>, 1&ndash;38.
URL http://www.jstatsoft.org/v47/i01/.</p>


<h3>See Also</h3>

<p><code>spgm</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package="plm")
data(usaww)
fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp
test1&lt;-sphtest(fm,data=Produc, listw = spdep::mat2listw(usaww),
                spatial.model = "error", method="GM")
test1
mod1&lt;- spgm(fm, data=Produc, listw = usaww, model = "random",
             spatial.error = TRUE, moments="fullweights")
mod2&lt;- spgm(fm, data=Produc, listw = usaww, model = "within",
             spatial.error = TRUE)
test2&lt;-sphtest(mod1, mod2)
test2
</code></pre>

<hr>
<h2 id='spml'>Spatial Panel Model by Maximum Likelihood</h2><span id='topic+spml'></span><span id='topic+impacts'></span><span id='topic+impacts.splm_ML'></span><span id='topic+impacts.splm_GM'></span>

<h3>Description</h3>

<p>Maximum likelihood (ML) estimation of spatial panel models, possibly with fixed or random effects.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spml(formula, data, index=NULL, listw, listw2=listw, na.action,
                 model=c("within","random","pooling"),
                 effect=c("individual","time","twoways"),
                 lag=FALSE, spatial.error=c("b","kkp","none"),
                 ...)
## S3 method for class 'splm_ML'
impacts(obj, listw = NULL,
                         time = NULL, ...,
                         tr = NULL, R = 200,
                         type = "mult",
                         empirical = FALSE, Q = NULL)
## S3 method for class 'splm_GM'
impacts(obj, ..., tr=NULL, 
                            R=NULL, listw=NULL,
                            type = "mult",
                            time = NULL,
                            evalues=NULL, tol=1e-6, 
                            empirical=FALSE, Q=NULL, 
                            KPformula = FALSE, prt = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spml_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be estimated</p>
</td></tr>
<tr><td><code id="spml_+3A_data">data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. A data frame containing the variables
in the model. When the object is a <code>data.frame</code>, the first two columns shall contain the indexes, unless otherwise specified. See <code>index</code></p>
</td></tr>
<tr><td><code id="spml_+3A_index">index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="spml_+3A_listw">listw</code></td>
<td>
<p>an object of class <code>listw</code> or a <code>matrix</code>. It represents the spatial weights to be used in estimation.</p>
</td></tr>
<tr><td><code id="spml_+3A_listw2">listw2</code></td>
<td>
<p>an object of class <code>listw</code> or a
<code>matrix</code>. Second of set spatial weights for estimation, if
different from the first (e.g., in a 'sarar' model).</p>
</td></tr>
<tr><td><code id="spml_+3A_na.action">na.action</code></td>
<td>
<p>see <span class="pkg">spdep</span> for more details.</p>
</td></tr>
<tr><td><code id="spml_+3A_model">model</code></td>
<td>
<p>one of <code>c("within", "random", "pooling").</code></p>
</td></tr>
<tr><td><code id="spml_+3A_effect">effect</code></td>
<td>
<p>one of <code>c("individual","time","twoways")</code>; the
effects introduced in the model.</p>
</td></tr>
<tr><td><code id="spml_+3A_lag">lag</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code>, a spatial lag of the dependent variable is added.</p>
</td></tr>
<tr><td><code id="spml_+3A_spatial.error">spatial.error</code></td>
<td>
<p>one of <code>c("b","kkp","none")</code>. The type of
spatial error in the specification, if any. See details.</p>
</td></tr>
<tr><td><code id="spml_+3A_...">...</code></td>
<td>
<p>additional argument to pass over to other functions</p>
</td></tr>
<tr><td><code id="spml_+3A_obj">obj</code></td>
<td>
<p>fitted model object</p>
</td></tr>
<tr><td><code id="spml_+3A_time">time</code></td>
<td>
<p>??time??</p>
</td></tr>
<tr><td><code id="spml_+3A_tr">tr</code></td>
<td>
<p>A vector of traces of powers of the spatial weights matrix created using 'trW', for approximate impact measures</p>
</td></tr>
<tr><td><code id="spml_+3A_r">R</code></td>
<td>
<p>If given, simulations are used to compute distributions for the impact measures, returned as 'mcmc' objects</p>
</td></tr>
<tr><td><code id="spml_+3A_type">type</code></td>
<td>
<p>Either &quot;mult&quot; (default) for powering a sparse matrix (with moderate or larger N, the matrix becomes dense, and may lead to swapping), or &quot;MC&quot; for Monte Carlo simulation of the traces (the first two simulated traces are replaced by their analytical equivalents), or &quot;moments&quot; to use the looping space saving algorithm proposed by Smirnov and Anselin (2009) - for &quot;moments&quot;, 'W' must be symmetric, for row-standardised weights through a similarity transformation</p>
</td></tr>
<tr><td><code id="spml_+3A_empirical">empirical</code></td>
<td>
<p>Argument passed to 'mvrnorm' (default FALSE)</p>
</td></tr>
<tr><td><code id="spml_+3A_q">Q</code></td>
<td>
<p>default NULL, else an integer number of cumulative power series impacts to calculate if 'tr' is given</p>
</td></tr>
<tr><td><code id="spml_+3A_evalues">evalues</code></td>
<td>
<p>vector of eigenvalues of spatial weights matrix for impacts calculations</p>
</td></tr>
<tr><td><code id="spml_+3A_tol">tol</code></td>
<td>
<p>Argument passed to 'mvrnorm'</p>
</td></tr>
<tr><td><code id="spml_+3A_kpformula">KPformula</code></td>
<td>
<p>not yet implemented</p>
</td></tr>
<tr><td><code id="spml_+3A_prt">prt</code></td>
<td>
<p>not yet implemented</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The models are estimated by two-step Maximum Likelihood.
Further optional parameters to be passed on to the estimator may be:
pvar: if <code>TRUE</code> the <code>pvar</code> function is called
hess: if <code>TRUE</code> use numerical Hessian instead of GLS for the
standard errors of the estimates
quiet: if <code>FALSE</code> report function and parameters values during
optimization
initval: one of <code>c("zeros", "estimate")</code>, the initial values for
the parameters. If <code>"zeros"</code> a vector of zeros is used. if
<code>"estimate"</code> the initial values are retreived from the estimation
of the nested specifications. Alternatively, a numeric vector can be
specified.
x.tol: Tolerance. See <code>nlminb</code> for details.
rel.tol: Relative tolerance. See <code>nlminb</code> for details.
</p>


<h3>Value</h3>

<p>An object of class <code>"splm"</code>.
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>coefficients estimate of the model parameters </p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>the coefficient for the spatial lag on <code>y</code></p>
</td></tr>
<tr><td><code>errcomp</code></td>
<td>
<p>the estimates of the error variance components</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the asymptotic variance covariance matrix of the estimated coefficients</p>
</td></tr>
<tr><td><code>vcov.arcoef</code></td>
<td>
<p>the asymptotic variance of the
estimated spatial lag parameter</p>
</td></tr>
<tr><td><code>vcov.errcomp</code></td>
<td>
<p>the asymptotic variance covariance matrix of the
estimated error covariance parameters</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>'random effects ML'</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the model residuals</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values, calculated as <code class="reqn">\hat{y}=X \hat{\beta}</code></p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>GLS residuals variance</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the matrix of the data used</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used to create the object</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>the value of the log likelihood function at the optimum </p>
</td></tr>
<tr><td><code>errors</code></td>
<td>
<p>the value of the <code>errors</code> argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Baltagi, B.H., Song, S.H., Jung B. and Koh, W. (2007)
Testing panel data regression models with spatial and serial error correlation.
<em>Journal of Econometrics</em>, <b>140</b>, 5-51.
</p>
<p>Millo, G., Piras, G. (2012)
splm: Spatial Panel Data Models in R.
<em>Journal of Statistical Software</em>, <b>47(1)</b>, 1&ndash;38.
URL http://www.jstatsoft.org/v47/i01/.
</p>


<h3>See Also</h3>

<p><code>spgm</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## the two standard specifications (SEM and SAR) one with FE
## and the other with RE:
## fixed effects panel with spatial errors
fespaterr &lt;- spml(fm, data = Produc, listw = spdep::mat2listw(usaww),
                   model="within", spatial.error="b", Hess = FALSE)
summary(fespaterr)
## random effects panel with spatial lag
respatlag &lt;- spml(fm, data = Produc, listw = spdep::mat2listw(usaww),
                   model="random", spatial.error="none", lag=TRUE)
summary(respatlag)
## calculate impact measures
#impac1 &lt;- impacts.splm(respatlag, listw = spdep::mat2listw(usaww, #style = "W"), time = 17)
#summary(impac1, zstats=TRUE, short=TRUE)
</code></pre>

<hr>
<h2 id='spreml'>Spatial Panel Model with Random Effects by Maximum Likelihood</h2><span id='topic+spreml'></span>

<h3>Description</h3>

<p>Maximum likelihood (ML) estimation of spatial panel models
with random effects and serial error correlation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>spreml(formula, data, index = NULL, w, w2=w, lag = FALSE,
          errors = c("semsrre", "semsr", "srre", "semre",
                     "re", "sr", "sem","ols", "sem2srre",
                     "sem2re", "semgre"),
          pvar = FALSE, hess = FALSE, quiet = TRUE,
          initval = c("zeros", "estimate"),
          x.tol = 1.5e-18, rel.tol = 1e-15, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spreml_+3A_formula">formula</code></td>
<td>
<p>a symbolic description of the model to be estimated</p>
</td></tr>
<tr><td><code id="spreml_+3A_data">data</code></td>
<td>
<p>an object of class <code>data.frame</code> or <code>pdata.frame</code>. A data frame containing the variables
in the model. When the object is a <code>data.frame</code>, the first two columns shall contain the indexes, unless otherwise specified. See <code>index</code></p>
</td></tr>
<tr><td><code id="spreml_+3A_index">index</code></td>
<td>
<p>if not NULL (default), a character vector to identify the indexes among the columns of the <code>data.frame</code></p>
</td></tr>
<tr><td><code id="spreml_+3A_w">w</code></td>
<td>
<p>an object of class <code>listw</code> or a <code>matrix</code>. It represents the spatial weights to be used in estimation.</p>
</td></tr>
<tr><td><code id="spreml_+3A_w2">w2</code></td>
<td>
<p>an object of class <code>listw</code> or a
<code>matrix</code>. Second set of spatial weights for estimation, if
different from the first (e.g., in a 'sarar' model).</p>
</td></tr>
<tr><td><code id="spreml_+3A_lag">lag</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code>, a spatial lag of the dependent variable is added.</p>
</td></tr>
<tr><td><code id="spreml_+3A_errors">errors</code></td>
<td>
<p>Specifies the error covariance structure. See details.</p>
</td></tr>
<tr><td><code id="spreml_+3A_pvar">pvar</code></td>
<td>
<p>legacy parameter here only for compatibility.</p>
</td></tr>
<tr><td><code id="spreml_+3A_hess">hess</code></td>
<td>
<p>default=<code>FALSE</code>. If <code>TRUE</code> estimate the
covariance for beta_hat by numerical Hessian instead of GLS at optimal
values.</p>
</td></tr>
<tr><td><code id="spreml_+3A_quiet">quiet</code></td>
<td>
<p>default=<code>TRUE</code>. If <code>FALSE</code>, report function and
parameters values during optimization.</p>
</td></tr>
<tr><td><code id="spreml_+3A_initval">initval</code></td>
<td>
<p>one of <code>c("zeros", "estimate")</code>, the initial values for
the parameters. If <code>"zeros"</code> a vector of zeros is used. if
<code>"estimate"</code> the initial values are retreived from the estimation
of the nested specifications. Alternatively, a numeric vector can be
specified.</p>
</td></tr>
<tr><td><code id="spreml_+3A_x.tol">x.tol</code></td>
<td>
<p>control parameter for tolerance. See <code>nlminb</code> for details.</p>
</td></tr>
<tr><td><code id="spreml_+3A_rel.tol">rel.tol</code></td>
<td>
<p>control parameter for relative tolerance. See <code>nlminb</code> for details.</p>
</td></tr>
<tr><td><code id="spreml_+3A_...">...</code></td>
<td>
<p>additional arguments to pass over to other functions, e.g. <code>method</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Second-level wrapper for estimation of random effects models
with serial and spatial correlation. The specifications without serial
correlation (no &quot;sr&quot; in <code>errors</code>) can be called through
<code>spml</code>, the extended ones only through <code>spreml</code>. 
The models are estimated by two-step Maximum Likelihood.
Abbreviations in <code>errors</code> correspond to: <code>"sem"</code>
Anselin-Baltagi type spatial autoregressive error: if
present, random effects are not spatially correlated;  <code>"sem2"</code>
Kapoor, Kelejian and Prucha-type spatial autoregressive error model
with spatially correlated random effects; <code>"sr"</code> serially
correlated remainder errors; <code>"re"</code> random effects; <code>"ols"</code>
spherical errors (usually combined with <code>lag=T</code>).
The optimization <code>method</code> can be passed on as optional
parameter. Default is <code>"nlminb"</code>; all constrained optimization
methods from <code>maxLik</code> are allowed (<code>"BFGS", "NM", "SANN"</code>)
but the latter two are still experimental.
</p>


<h3>Value</h3>

<p>An object of class <code>"splm"</code>.
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p>coefficients estimate of the model parameters </p>
</td></tr>
<tr><td><code>arcoef</code></td>
<td>
<p>the coefficient for the spatial lag on <code>y</code></p>
</td></tr>
<tr><td><code>errcomp</code></td>
<td>
<p>the estimates of the error variance components</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>the asymptotic variance covariance matrix of the estimated coefficients</p>
</td></tr>
<tr><td><code>vcov.arcoef</code></td>
<td>
<p>the asymptotic variance of the
estimated spatial lag parameter</p>
</td></tr>
<tr><td><code>vcov.errcomp</code></td>
<td>
<p>the asymptotic variance covariance matrix of the
estimated error covariance parameters</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>'random effects ML'</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>the model residuals</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values, calculated as <code class="reqn">\hat{y}=X \hat{\beta}</code></p>
</td></tr>
<tr><td><code>sigma2</code></td>
<td>
<p>GLS residuals variance</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>the matrix of the data used</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call used to create the object</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p>the value of the log likelihood function at the optimum </p>
</td></tr>
<tr><td><code>errors</code></td>
<td>
<p>the value of the <code>errors</code> argument</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Millo, G. (2014)
Maximum likelihood estimation of spatially and serially correlated
panels with random effects. <em>Computational Statistics and Data
Analysis</em>, <b>71</b>, 914&ndash;933.
</p>


<h3>See Also</h3>

<p><code>spml</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm")
data(usaww)
fm &lt;- log(gsp) ~ log(pcap) + log(pc) + log(emp) + unemp
## random effects panel with spatial lag and serial error correlation
## optimization method set to "BFGS"
sarsrmod &lt;- spreml(fm, data = Produc, w = usaww, errors="sr", lag=TRUE,
                    method="BFGS")
summary(sarsrmod)
</code></pre>

<hr>
<h2 id='summary.splm'>summary method for class splm</h2><span id='topic+summary.splm'></span>

<h3>Description</h3>

<p>Method for summarizing the results of objects of class <code>'splm'</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>
## S3 method for class 'splm'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.splm_+3A_object">object</code></td>
<td>
<p>an object of class <code>'splm'</code></p>
</td></tr>
<tr><td><code id="summary.splm_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The summary function <code>summary.splm</code> 
returns an objects of class 'splm' 
organized in a coefficient matrix.
</p>
<p>Also a matrix for the error components, 
or the spatial coefficients will be generated 
depending on the estimated model. 
</p>
<p>When the <code>'splm'</code> is produced by  
the function 'spsegm', the summary 
will be generated looping over the number
of equations in the system.
</p>


<h3>Value</h3>

<p>An object of class <code>'summary.splm'</code>
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo, Gianfranco Piras</p>


<h3>See Also</h3>

<p><code>spml</code>, <code>spgm</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Produc, package = "plm") 
data(usaww)
GM &lt;- spgm(log(gsp)~log(pcap)+log(pc)+log(emp)+unemp, data=Produc,
            listw=usaww, moments = "fullweights", spatial.error = TRUE)
summary(GM)
</code></pre>

<hr>
<h2 id='usaww'>Spatial weights matrix - US states</h2><span id='topic+usaww'></span>

<h3>Description</h3>

<p>Spatial weights matrix of the 48 continental US States based on the queen contiguity criterium.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(usaww)
</code></pre>


<h3>Format</h3>

<p>A matrix with elements different from zero if state i and j are
neighbors. Weights are row standardized. According to the queen
contiguity criterium, Arizona and Colorado are considered neighbours.</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>

<hr>
<h2 id='vcov.splm'>Covariance extractor method for <code>splm</code> objects</h2><span id='topic+vcov.splm'></span>

<h3>Description</h3>

<p>Covariance extractor method for <code>splm</code> objects. Seldom used as
such but needed, e.g., for
interoperability with testing functions in lmtest and car.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'splm'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vcov.splm_+3A_object">object</code></td>
<td>
<p>an object of class  <code>splm</code></p>
</td></tr>
<tr><td><code id="vcov.splm_+3A_...">...</code></td>
<td>
<p>additional arguments to be passed; currently not used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a covariance matrix of beta coefficients
</p>


<h3>Author(s)</h3>

<p>Giovanni Millo</p>


<h3>References</h3>

<p>Zeileis, A. (2006) Object-Oriented Computation of Sandwich
Estimators. <em>Journal of Statistical Software</em>, <b>16(9)</b>, 1-16.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## not run:
## data(Produc, package="plm")
## data(usaww)
## fm &lt;- log(gsp)~log(pcap)+log(pc)+log(emp)+unemp
## sarremod &lt;- spml(fm, data=Produc, listw = spdep::mat2listw(usaww),
##  model="random", lag=TRUE, spatial.error="none")
## ## compact representation of betas
## library(lmtest)
## coeftest(sarremod)
## ## linear hypothesis test
## library(car)
## lht(sarremod, "log(pcap)=log(pc)")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
