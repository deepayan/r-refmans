<!DOCTYPE html><html lang="en"><head><title>Help for package refset</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {refset}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#refset-package'><p>Subsets with Reference Semantics</p></a></li>
<li><a href='#contents'><p>Returns or changes parcel contents</p></a></li>
<li><a href='#is.parcel'><p>Checks whether an object is a parcel</p></a></li>
<li><a href='#refset'><p>Create a reference to a subset of an object</p></a></li>
<li><a href='#unwrap_as'><p>Unwrap contents of a parcel into a new variable</p></a></li>
<li><a href='#wrap'><p>Wrap an expression and its environment into a parcel.</p></a></li>
<li><a href='#wrapset'><p>Convenience function to create a parcel containing a refset.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Subsets with Reference Semantics</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2014-11-20</td>
</tr>
<tr>
<td>Author:</td>
<td>"David Hugh-Jones" &lt;davidhughjones@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>"David Hugh-Jones" &lt;davidhughjones@gmail.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/hughjonesd/refset">http://github.com/hughjonesd/refset</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provides subsets with reference semantics, i.e. subsets
    which automatically reflect changes in the original object, and which
    optionally update the original object when they are changed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-12-10 14:36:37 UTC; david</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-12-10 15:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='refset-package'>Subsets with Reference Semantics</h2><span id='topic+refset-package'></span>

<h3>Description</h3>

<p>Subsets with Reference Semantics
</p>


<h3>Details</h3>

<p>Refset provides subsets with reference semantics, i.e. subsets
which automatically reflect changes in the original object, and which
also update the original object when they are changed.
</p>
<p>For more info see <code>vignette('refset')</code>.
</p>


<h3>Author(s)</h3>

<p>David Hugh-Jones <a href="mailto:davidhughjones@gmail.com">davidhughjones@gmail.com</a>
</p>

<hr>
<h2 id='contents'>Returns or changes parcel contents</h2><span id='topic+contents'></span><span id='topic+contents+3C-'></span>

<h3>Description</h3>

<p><code>contents</code> returns the value of the parcel contents by evaluating
the expression in the parcel. <code>contents&lt;-</code> attempts to assign
to the expression, which will only work if the expression is appropriate, e.g.
a refset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contents(parcel)

contents(parcel) &lt;- value
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contents_+3A_parcel">parcel</code></td>
<td>
<p>an object of class 'parcel'</p>
</td></tr>
<tr><td><code id="contents_+3A_value">value</code></td>
<td>
<p>a value to assign</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of evaluating the expression stored in the parcel. 
For <code>contents&lt;-</code>, the parcel itself.
</p>
<p><code>contents&lt;-</code> will only work if the expression wrapped in the
parcel can accept assignments.
</p>


<h3>See Also</h3>

<p>Other wrapping functions: <code><a href="#topic+is.parcel">is.parcel</a></code>,
<code><a href="#topic+unwrap_as">unwrap_as</a></code>, <code><a href="#topic+wrapset">wrapset</a></code>,
<code><a href="#topic+wrap">wrap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pcl &lt;- wrap(x^2)
x &lt;- 2
contents(pcl)
x &lt;- 3
contents(pcl)
## Not run: 
contents(pcl) &lt;- 4 # fails

## End(Not run)
p2 &lt;- wrap(names(x))
contents(p2) &lt;- "named"
x

</code></pre>

<hr>
<h2 id='is.parcel'>Checks whether an object is a parcel</h2><span id='topic+is.parcel'></span>

<h3>Description</h3>

<p>Checks whether an object is a parcel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.parcel(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.parcel_+3A_x">x</code></td>
<td>
<p>an object to examine</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>See Also</h3>

<p>Other wrapping functions: <code><a href="#topic+contents">contents</a></code>,
<code><a href="#topic+unwrap_as">unwrap_as</a></code>, <code><a href="#topic+wrapset">wrapset</a></code>,
<code><a href="#topic+wrap">wrap</a></code>
</p>

<hr>
<h2 id='refset'>Create a reference to a subset of an object</h2><span id='topic+refset'></span><span id='topic++60+25r+25+60'></span><span id='topic++25r+25'></span>

<h3>Description</h3>

<p>Create a refset - a reference to a subset of an object. 
When the object changes, the
contents of the refset change, and when the refset is changed, the object
is changed too.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>refset(x, data, ..., drop = TRUE, dyn.idx = TRUE, read.only = FALSE,
  eval.env = parent.frame(), assign.env = parent.frame())

x %r% data
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="refset_+3A_x">x</code></td>
<td>
<p>name of the refset to create, as a bare name or character string</p>
</td></tr>
<tr><td><code id="refset_+3A_data">data</code></td>
<td>
<p>the object to refer to</p>
</td></tr>
<tr><td><code id="refset_+3A_...">...</code></td>
<td>
<p>indices to subset with</p>
</td></tr>
<tr><td><code id="refset_+3A_drop">drop</code></td>
<td>
<p>passed to <code><a href="base.html#topic+Extract">Extract</a></code></p>
</td></tr>
<tr><td><code id="refset_+3A_dyn.idx">dyn.idx</code></td>
<td>
<p>update indices dynamically</p>
</td></tr>
<tr><td><code id="refset_+3A_read.only">read.only</code></td>
<td>
<p>create a read-only refset which throws an error if assigned
to</p>
</td></tr>
<tr><td><code id="refset_+3A_eval.env">eval.env</code></td>
<td>
<p>environment in which <code>data</code> and indices will be evaluated</p>
</td></tr>
<tr><td><code id="refset_+3A_assign.env">assign.env</code></td>
<td>
<p>environment in which the variable named by <code>x</code> will be created</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two ways to call <code>refset</code>. The two-argument form, e.g.
<code>refset(myref, mydata[rows,"column"])</code>, creates a reference to the 
subset of <code>mydata</code> passed in the second argument. 
</p>
<p>The three-or-more argument form acts like the <code><a href="base.html#topic+subset">subset</a></code> function:
the indices in <code>...</code> are applied to <code>data</code>. If <code>data</code> is a
data.frame, then the indices are interpreted within it, so you can refer to
columns directly: <code>refset(myref, mydata, a&gt;1 &amp; b&lt;a,)</code>. Bare column names
must be quoted, however.
</p>
<p>Empty arguments in <code>...</code> are allowed and are treated as indexing 
the whole dimension, just as in <code><a href="base.html#topic+Extract">Extract</a></code>.
</p>
<p>By default, the indices in subset are updated dynamically. 
For example, if you call <code>refset(myref, mydata, x &gt;= 3,)</code> and then
set <code>mydata$x &lt;- 3</code>, the number of rows in <code>myref</code> will probably
increase. To turn this behaviour off and make a reference to a &quot;fixed&quot; 
subset of your object, use <code>dyn.idx=FALSE</code>.
</p>
<p><code>%r%</code> is an infix version of the two-argument form.
</p>


<h3>Value</h3>

<p><code>refset</code> returns <code>NULL</code>, but the <code>x</code> argument 
will be assigned to
in the calling environment (or in <code>env</code>, if it is specified). 
<code>x</code> will have an attribute <code>".refset."</code>.
</p>


<h3>See Also</h3>

<p>Refsets are implemented using <code>makeActiveBinding</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dfr &lt;- data.frame(a=1:4, b=1:4)
ss &lt;- dfr[1:2,]
refset(rs, dfr[1:2,])
dfr$a &lt;- 4:1
ss # 1:2
rs # 4:3

# same:
refset(rs, dfr, 1:2, )

# same:
rs %r% dfr[1:2,]

vec &lt;- 1:10
refset(middle, vec[4:6])
vec[4:6] &lt;- NA
middle 
middle &lt;- 4:6 + 100
vec

# dynamic versus static indices:
dfr &lt;- data.frame(a=rnorm(100), b=rnorm(100))
refset(ss, dfr, a&gt;1,)
refset(ss.static, dfr, a&gt;1,, dyn.idx=FALSE)
nrow(ss) == nrow(ss.static)
dfr$a &lt;- dfr$a + 2 * dfr$b


precious.data &lt;- rnorm(100)
refset(big, precious.data, precious.data&gt;1, read.only=TRUE)
big
## Not run: 
big &lt;- big * 2 # throws an error

## End(Not run)

# Using refset with other functions:
# dynamically updated calculated column
dfr &lt;- data.frame(a=rnorm(10), b=rnorm(10))
refset(rs, transform(dfr, x=a+2*b+rnorm(10)))
rs
rs # different

# Non-readonly refset with other functions. Works but gives a warning:
## Not run: 
vec &lt;- 1:5
refset(ssv, names(vec), read.only=FALSE)
ssv &lt;- LETTERS[1:5]
vec

## End(Not run)

</code></pre>

<hr>
<h2 id='unwrap_as'>Unwrap contents of a parcel into a new variable</h2><span id='topic+unwrap_as'></span>

<h3>Description</h3>

<p><code>unwrap_as</code> creates a new variable which, when evaluated,
calls <code><a href="#topic+contents">contents</a></code> to return the parcel contents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unwrap_as(x, parcel, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unwrap_as_+3A_x">x</code></td>
<td>
<p>name of the variable to bind to</p>
</td></tr>
<tr><td><code id="unwrap_as_+3A_parcel">parcel</code></td>
<td>
<p>an object of class 'parcel'</p>
</td></tr>
<tr><td><code id="unwrap_as_+3A_env">env</code></td>
<td>
<p>environment to assign the variable into</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>Other wrapping functions: <code><a href="#topic+contents">contents</a></code>,
<code><a href="#topic+is.parcel">is.parcel</a></code>, <code><a href="#topic+wrapset">wrapset</a></code>,
<code><a href="#topic+wrap">wrap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vec &lt;- 1:10
parcel &lt;- wrapset(vec, vec &gt; 3) 
unwrap_as(y, parcel)
y
</code></pre>

<hr>
<h2 id='wrap'>Wrap an expression and its environment into a parcel.</h2><span id='topic+wrap'></span>

<h3>Description</h3>

<p>Refsets (and other active bindings) cannot be passed as function
arguments, since doing so makes a copy. <code>wrap</code> allows you to pass
arbitrary expressions between functions and records where they are
ultimately evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrap(expr, env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrap_+3A_expr">expr</code></td>
<td>
<p>an R expression</p>
</td></tr>
<tr><td><code id="wrap_+3A_env">env</code></td>
<td>
<p>environment in which <code>expr</code> is to be evaluated</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'parcel', with components <code>expr</code> and <code>env</code>.
</p>


<h3>See Also</h3>

<p>Other wrapping functions: <code><a href="#topic+contents">contents</a></code>,
<code><a href="#topic+is.parcel">is.parcel</a></code>, <code><a href="#topic+unwrap_as">unwrap_as</a></code>,
<code><a href="#topic+wrapset">wrapset</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dfr &lt;- data.frame(a=1:4, b=1:4)
rs %r% dfr[1:2,]
parcel &lt;- wrap(rs)
f &lt;- function (parcel) contents(parcel) &lt;- contents(parcel)*2
f(parcel)
contents(parcel)
dfr

parcel &lt;- wrap(x^2) # non-refset use
x &lt;- 3           
f &lt;- function(parcel) {x &lt;- 10; contents(parcel)}
f(parcel)

</code></pre>

<hr>
<h2 id='wrapset'>Convenience function to create a parcel containing a refset.</h2><span id='topic+wrapset'></span>

<h3>Description</h3>

<p><code>wrapset</code> calls <code><a href="#topic+refset">refset</a></code> on its arguments and
returns the resulting active binding in a <code>parcel</code> object
for passing around.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrapset(data, ..., env = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wrapset_+3A_data">data</code>, <code id="wrapset_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="#topic+refset">refset</a></code></p>
</td></tr>
<tr><td><code id="wrapset_+3A_env">env</code></td>
<td>
<p>passed to <code><a href="#topic+refset">refset</a></code> as argument <code>eval.env</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>parcel</code> object.
</p>


<h3>See Also</h3>

<p>Other wrapping functions: <code><a href="#topic+contents">contents</a></code>,
<code><a href="#topic+is.parcel">is.parcel</a></code>, <code><a href="#topic+unwrap_as">unwrap_as</a></code>,
<code><a href="#topic+wrap">wrap</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dfr &lt;- data.frame(a=1:5, b=1:5)
parcel &lt;- wrapset(dfr, a&lt;3, , drop=FALSE)
contents(parcel)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
