<!DOCTYPE html><html><head><title>Help for package miCoPTCM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {miCoPTCM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#miCoPTCM-package'>
<p>Promotion Time Cure Model with Mis-Measured Covariates</p></a></li>
<li><a href='#PTCMestimBF'>
<p>Corrected score approach</p></a></li>
<li><a href='#PTCMestimSIMEX'>
<p>SIMEX approach</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Promotion Time Cure Model with Mis-Measured Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-12-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Aurelie Bertrand, Catherine Legrand, Ingrid Van Keilegom</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Aurelie Bertrand &lt;aurelie.bertrand@uclouvain.be&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, nleqslv, survival, compiler, distr</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Semiparametric Promotion Time Cure Models, taking into account (using a 
			 corrected score approach or the SIMEX algorithm) or not the measurement error
			 in the covariates, using a backfitting approach to maximize the likelihood.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-12-07 13:31:57 UTC; aurbertrand</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-12-07 14:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='miCoPTCM-package'>
Promotion Time Cure Model with Mis-Measured Covariates
</h2><span id='topic+miCoPTCM-package'></span><span id='topic+miCoPTCM'></span>

<h3>Description</h3>

<p>Fits Semiparametric Promotion Time Cure Models, taking into account (using a corrected score approach 
or the SIMEX algorithm) or not the measurement error in the covariates, using a backfitting 
approach to maximize the likelihood.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> miCoPTCM</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Promotion Time Cure Model with Mis-Measured Covariates</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-12-07</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Aurelie Bertrand, Catherine Legrand, Ingrid Van Keilegom</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Aurelie Bertrand &lt;aurelie.bertrand@uclouvain.be&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> MASS, nleqslv, survival, compiler, distr</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Fits Semiparametric Promotion Time Cure Models, taking into account (using a 
			 corrected score approach or the SIMEX algorithm) or not the measurement error
			 in the covariates, using a backfitting approach to maximize the likelihood.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
PTCMestimBF             Corrected score approach
PTCMestimSIMEX          SIMEX approach
miCoPTCM-package        Promotion Time Cure Model with Mis-Measured
                        Covariates
</pre>
<p>The survival model of interest is the promotion time cure model, i.e. a survival model which takes into account the existence of subjects who will never experience the event. The survival function of <code class="reqn">T</code>, the survival time, is assumed to be improper:
</p>
<p style="text-align: center;"><code class="reqn">S(t|\bm{x}) = P(T&gt;t|\bm{X}=\bm{x}) = \exp\left\{-\theta(\bm{x}) F(t) \right\},</code>
</p>

<p>where <code class="reqn">F</code> is a proper baseline cumulative distribution function, <code class="reqn">\theta</code> is a link function with an intercept, here <code class="reqn">\theta(\bm{x}) = \exp(\bm{x}^T \bm{\beta})</code>, and <code class="reqn">\bm{x}</code> is the vector of covariates. We work with the semiparametric version of this model, in which no known distribution is assumed for <code class="reqn">F</code>.
It can be shown that the nonparametric estimator of <code class="reqn">F</code> is a step function which increases only at the failure times. 
</p>
<p>We assume that we have right censoring in our data, so that <code class="reqn">Y=\min(T,C)</code> is observed, where <code class="reqn">C</code> is the censoring time.
</p>
<p>The classical additive error model is assumed for the covariates, so that <code class="reqn">\bm{W}=\bm{X}+\bm{U}</code> is observed,  where <code class="reqn">\bm{W}</code> is the vector of observed covariates and <code class="reqn">\bm{U}</code> is the vector of measurement errors. We  assume that <code class="reqn">\bm{U}</code> is independent of <code class="reqn">\bm{X}</code> and <code class="reqn">\bm{U}</code> follows a continuous distribution with mean zero and known covariance matrix <code class="reqn">\bm{V}</code>. It is also assumed that <code class="reqn">(T,C)</code> and <code class="reqn">\bm{W}</code> are independent given <code class="reqn">\bm{X}</code>.
</p>
<p>Three possible estimation methods are available in this package. The corrected score approach of Ma and Yin (2008) is implemented in function <code>PTCMestimBF</code>. It consists in solving, through a backfitting procedure, the score equations in which the terms involving <code class="reqn">\bm{x}</code> are replaced by some terms involving <code class="reqn">\bm{w}</code> and <code class="reqn">\bm{V}</code>. 
The naive method consists in not taking the measurement error in the covariates into account. The naive estimate is obtained by using function <code>PTCMestimBF</code> with a variance-covariance matrix of the error containing only zeros.
Finally, the SIMEX algorithm applied to the promotion time cure model (Bertrand et al., 2015) is implemented in the function <code>PTCMestimSIMEX</code>. The SIMEX algorithm (Cook and Stefanski, 1994) is a generic and intuitive procedure allowing to estimate and reduce the bias in a model in which the covariates are measured with error. In this implementation, the naive estimator required by the procedure is the one of Ma and Yin (2008).
</p>


<h3>Author(s)</h3>

<p>Aurelie Bertrand, Catherine Legrand, Ingrid Van Keilegom
</p>
<p>Maintainer: Aurelie Bertrand &lt;aurelie.bertrand@uclouvain.be&gt;
</p>


<h3>References</h3>

<p>Bertrand A., Legrand C., Carroll R.J., De Meester C., Van Keilegom I. (2015) Inference in a Survival Cure Model with Mismeasured Covariates using a SIMEX Approach. Submitted.
</p>
<p>Cook J.R., Stefanski L.A. (1994) Simulation-Extrapolation Estimation in Parametric Measurement Error Models. Journal of the American Statistical Association, 89, 1314-1328. DOI: 10.2307/2290994
</p>
<p>Ma, Y., Yin, G. (2008) Cure rate models with mismeasured covariates under transformation. Journal of the American Statistical Association, 103, 743-756. DOI: 10.1198/016214508000000319
</p>

<hr>
<h2 id='PTCMestimBF'>
Corrected score approach
</h2><span id='topic+PTCMestimBF'></span><span id='topic+PTCMestimBF.default'></span><span id='topic+PTCMestimBF.formula'></span><span id='topic+print.PTCMestimBF'></span><span id='topic+summary.PTCMestimBF'></span><span id='topic+print.summary.PTCMestimBF'></span>

<h3>Description</h3>

<p>Fits a Semiparametric Promotion Time Cure Model, taking into account (using a corrected score approach) or not the measurement error in the covariates, using a backfitting approach to maximize the likelihood. Both methods were introduced in Ma and Yin (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
PTCMestimBF(x, y, varCov, init, nBack=10000, eps=1e-8, multMaxTime=2,...)
## S3 method for class 'formula'
PTCMestimBF(formula, data=list(), ...)
## S3 method for class 'PTCMestimBF'
print(x,...)
## S3 method for class 'PTCMestimBF'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PTCMestimBF_+3A_x">x</code></td>
<td>
<p> a numerical matrix containing the explanatory variables as columns (without a column of 1s for the intercept).</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_y">y</code></td>
<td>
<p> the response, a survival object returned by the <code>Surv</code> function. </p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_varcov">varCov</code></td>
<td>
<p> the square variance-covariance matrix of measurement error, with as many rows as regression parameters (including the intercept).</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_init">init</code></td>
<td>
<p> a numerical vector of initial values for the regression parameters.</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_nback">nBack</code></td>
<td>
<p> an integer specifying the maximal number of iterations in the backfitting procedure. </p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_eps">eps</code></td>
<td>
<p> convergence criterion. Convergence is declared if the euclidian norm of the vector of changes in the estimated parameters and the euclidian norm of the  score equations evaluated at these values are smaller than <code>eps</code>. </p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_multmaxtime">multMaxTime</code></td>
<td>
<p> a positive number controlling the time allowed, in one iteration of the backfitting procedure, to function <code>nleqslv</code> (used to solve the score equations) to converge.  </p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_formula">formula</code></td>
<td>
<p>a formula object, in which the response is a survival object returned by the <code>Surv</code> function.</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables appearing in the model.</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_object">object</code></td>
<td>
<p> an object of class <code>"PTCMestimBF"</code>, i.e., a fitted model.</p>
</td></tr>
<tr><td><code id="PTCMestimBF_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method assumes normally distributed measurement error. The diagonal elements of the matrix <code>varCov</code> corresponding to covariates without error (as is the case for the intercept) have to be set to 0.
</p>


<h3>Value</h3>

<p>An object of class <code>PTCMestimBF</code>, i.e. a list including the following elements:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>The estimated values of the regression parameters.</p>
</td></tr>
<tr><td><code>estimCDF</code></td>
<td>
<p>The estimated baseline cumulative distribution function.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>The estimated variance-covariance matrix of the estimated regression parameters.</p>
</td></tr>
<tr><td><code>classObs</code></td>
<td>
<p>An integer vector of length 3: the number of censored individuals not considered as cured for the estimation, the number of events, and the number of individuals considered as cured for the estimation.</p>
</td></tr>
<tr><td><code>flag</code></td>
<td>
<p>Termination code: 1 if converged, 2 otherwise.</p>
</td></tr>
<tr><td><code>endK</code></td>
<td>
<p>Number of iterations performed in the backfitting procedure.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bertrand A., Legrand C., Carroll R.J., De Meester C., Van Keilegom I. (2015) Inference in a Survival Cure Model with Mismeasured Covariates using a SIMEX Approach. Submitted.
</p>
<p>Ma, Y., Yin, G. (2008) Cure rate models with mismeasured covariates under transformation. Journal of the American Statistical Association, 103, 743-756. DOI: 10.1198/016214508000000319
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library("survival")
## Data generation
set.seed(123)
n &lt;- 200
varCov &lt;- matrix(nrow=3,ncol=3,0)
varCov[2,2] &lt;- 0.1^1
X1 &lt;- (runif(n)-.5)/sqrt(1/12) 
V &lt;- round(X1 + rnorm(n,rep(0,3),varCov[2,2]),7)# covariate with measurement error
Xc &lt;- round(as.numeric(runif(n)&lt;0.5),7) # covariate without measurement error

 # censoring times: truncated exponential distribution
C &lt;- round(rexp(n,1/5),5) 
Cbin &lt;- (C&gt;30)
while(sum(Cbin)&gt;0)
{
	C[Cbin] &lt;- round(rexp(sum(Cbin),1/5),5)
	Cbin &lt;- (C&gt;30)
}

expb &lt;- exp(0.5+X1-0.5*Xc) 
cure &lt;- exp(-expb) # cure probabilities

 # event times with baseline cdf of a truncated exponential 
U &lt;- runif(n)
d &lt;- rep(NA,n)
T &lt;- round(-6*log( 1+ (1-exp(-20/6))*log(1-(1-cure)*U)/expb ),5) 
T[(runif(n)&lt;cure)] &lt;- 99999 # cured subjects

Tobs &lt;- rep(NA,n)
Tobs &lt;- pmin(C,T) # observed times
Tmax &lt;- max(Tobs[Tobs==T])
d &lt;- (Tobs==T) # censoring indicator
	
Dat &lt;- data.frame(Tobs,d,V,Xc)
#colnames(Dat) &lt;- c("Tobs","d","V","Xc")


## Model estimation
fm &lt;- formula(Surv(Tobs,d) ~ V + Xc)
resMY &lt;- PTCMestimBF(fm, Dat, varCov=varCov, init=rnorm(3))
resMY
summary(resMY)
</code></pre>

<hr>
<h2 id='PTCMestimSIMEX'>
SIMEX approach
</h2><span id='topic+PTCMestimSIMEX'></span><span id='topic+PTCMestimSIMEX.default'></span><span id='topic+PTCMestimSIMEX.formula'></span><span id='topic+print.PTCMestimSIMEX'></span><span id='topic+summary.PTCMestimSIMEX'></span><span id='topic+print.summary.PTCMestimSIMEX'></span>

<h3>Description</h3>

<p>Fits a Semiparametric Promotion Time Cure Model with mismeasured covariates, using the SIMEX algorithm based on a backfitting procedure. This approach is introduced in Bertrand et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
PTCMestimSIMEX(x, y, errorDistEstim=c("normal","student","chiSquare","laplace"), 
paramDistEstim=NA, varCov=NA,  nBack=10000, eps=1e-8, Nu=c(0,.5,1,1.5,2), B=50, init, 
orderExtrap=2, multMaxTime=2,...)
## S3 method for class 'formula'
PTCMestimSIMEX(formula, data=list(),...)
## S3 method for class 'PTCMestimSIMEX'
print(x,...)
## S3 method for class 'PTCMestimSIMEX'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PTCMestimSIMEX_+3A_x">x</code></td>
<td>
<p> a numerical matrix containing the explanatory variables as columns (without a column of 1s for the intercept).</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_y">y</code></td>
<td>
<p> the response, a survival object returned by the <code>Surv</code> function. </p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_errordistestim">errorDistEstim</code></td>
<td>
<p> the distribution of the measurement error. See Details.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_paramdistestim">paramDistEstim</code></td>
<td>
<p> a scalar or a vector of length 2 containing the parameter(s) of the measurement error distribution, for non-Gaussian distributions. See Details.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_varcov">varCov</code></td>
<td>
<p> the square variance-covariance matrix of measurement error, with as many rows as regression parameters (including the intercept), for Gaussian errors.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_nback">nBack</code></td>
<td>
<p> an integer specifying the maximal number of iterations in the backfitting procedure. </p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_eps">eps</code></td>
<td>
<p> convergence criterion.  </p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_nu">Nu</code></td>
<td>
<p> a numerical vector containing the grid of lambda values, corresponding to the level of added noise.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_b">B</code></td>
<td>
<p> the number of replications for each value in <code>Nu</code>.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_init">init</code></td>
<td>
<p>a numerical vector of initial values for the regression parameters.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_orderextrap">orderExtrap</code></td>
<td>
<p> a scalar or a numerical vector containing the degrees of the polynomials used in the extrapolation step.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_multmaxtime">multMaxTime</code></td>
<td>
<p> a positive number controlling the time allowed, in one iteration of the backfitting procedure, to function <code>nleqslv</code> (used to solve the score equations) to converge.  </p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_formula">formula</code></td>
<td>
<p>a formula object, in which the response is a survival object returned by the <code>Surv</code> function.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_data">data</code></td>
<td>
<p>a dataframe containing the variables appearing in the model.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_object">object</code></td>
<td>
<p> an object of class <code>"PTCMestimBF"</code>, i.e., a fitted model.</p>
</td></tr>
<tr><td><code id="PTCMestimSIMEX_+3A_...">...</code></td>
<td>
<p> not used. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>More than one covariate can be subject to measurement error. However, in this implementation, all the errors must belong to the same family of distribution (specified with the argument <code>errorDistEstim</code>). Non-zero covariances are allowed between errors following a normal distribution. For the student, chi-squared and Laplace distributions, all variances are assumed to be equal (determined from <code>paramDistEstim</code>) and all covariances are assumed to be 0, even if the off-diagonal elements of <code>vcov</code> are not 0.
</p>
<p>When using the <code>laplace</code> distribution, only one element in <code>paramDistEstim</code> is needed (if a vector of two elements is given, only the first element will be considered). With the <code>student</code> and <code>chiSquare</code> distributions, two parameters are required, while none is required with the <code>normal</code> distribution. 
For the <code>laplace</code> distribution, the parameter is the inverse of the rate <code class="reqn">\gamma</code>, where <code class="reqn">\gamma</code> is such that <code class="reqn">f(x)=\frac{1}{2}\gamma e^{-\gamma |x|}</code>. The first parameter of the Student distribution corresponds to the degrees of freedom, while the second parameter is a multiplicative factor such that the variance is <code class="reqn">parameter_2^2*\frac{parameter_1}{parameter_1-2}</code>. Similarly, for the chi-squared distribution, the first parameter gives the degrees of freedom, and the second one is a multiplicative factor yielding a variance of <code class="reqn">2\cdot param_2^2 \cdot param_1</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>PTCMestimBF</code>, i.e. a list including the following elements:
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p>The estimated values of the regression parameters.</p>
</td></tr>
<tr><td><code>var</code></td>
<td>
<p>The estimated variances of the estimated regression parameters.</p>
</td></tr>
<tr><td><code>classObs</code></td>
<td>
<p>An integer vector of length 3: the number of censored individuals not considered as cured for the estimation, the number of events, and the number of individuals considered as cured for the estimation.</p>
</td></tr>
<tr><td><code>estimNuBF</code></td>
<td>
<p>A matrix with as many rows as elements in <code>Nu</code>, containing, in each row, the average of the <code>B</code> estimates, for each regression parameter (columns).</p>
</td></tr>
</table>


<h3>References</h3>

<p>Bertrand A., Legrand C., Carroll R.J., De Meester C., Van Keilegom I. (2015) Inference in a Survival Cure Model with Mismeasured Covariates using a SIMEX Approach. Submitted.
</p>
<p>Cook J.R., Stefanski L.A. (1994) Simulation-Extrapolation Estimation in Parametric Measurement Error Models. Journal of the American Statistical Association, 89, 1314-1328. DOI: 10.2307/2290994
</p>
<p>Ma, Y., Yin, G. (2008) Cure rate models with mismeasured covariates under transformation. Journal of the American Statistical Association, 103, 743-756. DOI: 10.1198/016214508000000319
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library("survival")
## Data generation
set.seed(123)
n &lt;- 200
varCov &lt;- matrix(nrow=3,ncol=3,0)
varCov[2,2] &lt;- 0.1^1
X1 &lt;- (runif(n)-.5)/sqrt(1/12) 
V &lt;- round(X1 + rnorm(n,rep(0,3),varCov[2,2]),7)# covariate with measurement error
Xc &lt;- round(as.numeric(runif(n)&lt;0.5),7) # covariate without measurement error

 # censoring times: truncated exponential distribution
C &lt;- round(rexp(n,1/5),5) 
Cbin &lt;- (C&gt;30)
while(sum(Cbin)&gt;0)
{
	C[Cbin] &lt;- round(rexp(sum(Cbin),1/5),5)
	Cbin &lt;- (C&gt;30)
}

expb &lt;- exp(0.5+X1-0.5*Xc) 
cure &lt;- exp(-expb) # cure probabilities

 # event times with baseline cdf of a truncated exponential 
U &lt;- runif(n)
d &lt;- rep(NA,n)
T &lt;- round(-6*log( 1+ (1-exp(-20/6))*log(1-(1-cure)*U)/expb ),5) 
T[(runif(n)&lt;cure)] &lt;- 99999 # cured subjects

Tobs &lt;- rep(NA,n)
Tobs &lt;- pmin(C,T) # observed times
Tmax &lt;- max(Tobs[Tobs==T])
d &lt;- (Tobs==T) # censoring indicator
	
Dat &lt;- data.frame(Tobs,d,V,Xc)

## Model estimation
fm &lt;- formula(Surv(Tobs,d) ~ V + Xc)
resSimex &lt;- PTCMestimSIMEX(fm, Dat, errorDistEstim="normal", 
varCov=varCov,  nBack=10000, eps=1e-8, 
Nu=c(0,.5,1,1.5,2), B=50, init=rnorm(3), orderExtrap=1:3, multMaxTime=2)
resSimex
summary(resSimex)
## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
