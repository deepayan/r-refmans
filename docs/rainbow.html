<!DOCTYPE html><html lang="en"><head><title>Help for package rainbow</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rainbow}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#rainbow-package'>
<p>Rainbow Plots, Bagplots and Boxplots for Functional Data</p></a></li>
<li><a href='#Australiafertility'>
<p>Australian age-specific fertility data</p></a></li>
<li><a href='#ElNino_ERSST_region_1and2'>
<p>Sea surface temperature data set from January 1950 to December 2018</p></a></li>
<li><a href='#ElNino_OISST_region_1and2'><p>Sea surface temperature data set from January 1982 to December 2018</p></a></li>
<li><a href='#fboxplot'><p>Functional bagplot and functional HDR boxplot</p></a></li>
<li><a href='#fdepth'><p>Compute functional depth.</p></a></li>
<li><a href='#fds'><p>Create functional objects</p></a></li>
<li><a href='#foutliers'><p>Functional outlier detection methods.</p></a></li>
<li><a href='#plot.fdepth'><p>Plot functional depth</p></a></li>
<li><a href='#plot.fds'><p>Plot functional objects</p></a></li>
<li><a href='#Simulationdata'>
<p>Simulated data</p></a></li>
<li><a href='#summaryfunction'>
<p>Summary statistics for functional data</p></a></li>
<li><a href='#SVDplot'>
<p>Singular value decomposition plot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bagplots, Boxplots and Rainbow Plots for Functional Data</td>
</tr>
<tr>
<td>Version:</td>
<td>3.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-23</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), MASS, pcaPP</td>
</tr>
<tr>
<td>Suggests:</td>
<td>forecast</td>
</tr>
<tr>
<td>Imports:</td>
<td>hdrcde, cluster, colorspace, ks, methods</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>TRUE</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Han Lin Shang &lt;hanlin.shang@mq.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Visualizing functional data and identifying functional outliers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-22 22:57:28 UTC; hanlinshang</td>
</tr>
<tr>
<td>Author:</td>
<td>Han Lin Shang <a href="https://orcid.org/0000-0003-1769-6430"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Rob Hyndman <a href="https://orcid.org/0000-0002-2140-5352"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 05:40:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='rainbow-package'>
Rainbow Plots, Bagplots and Boxplots for Functional Data
</h2><span id='topic+rainbow-package'></span><span id='topic+rainbow'></span>

<h3>Description</h3>

<p>This package presents the rainbow plots, bagplots and boxplots for functional data. The latter two can also be used to identify outliers, which have either the lowest depth or the lowest density, respectively. 
</p>


<h3>Author(s)</h3>

<p>Han Lin Shang and Rob J Hyndman
</p>
<p>Maintainer: Han Lin Shang &lt;hanlin.shang@anu.edu.au&gt;
</p>


<h3>References</h3>

<p>R. J. Hyndman and H. L. Shang. (2008) &quot;Bagplots, boxplots and outlier detection for functional data&quot;, in S. Dabo-Niang and F. Ferraty, eds, &lsquo;Functional and Operatorial Statistics&rsquo;, Springer, Heidelberg, pp. 201-207.
</p>
<p>R. J. Hyndman and H. L. Shang. (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>
<p>H. L. Shang (2011) &quot;rainbow: an R package for visualizing functional time series&quot;, <em>The R Journal</em>, <b>3</b>(2), 54-59.
</p>
<p>H. L. Shang and R. J. Hyndman (2011) &quot;Nonparametric time series forecasting with dynamic updating&quot;, Mathematics and Computers in Simulation, <b>81</b>(7), 1310-1324.
</p>
<p>H. L. Shang (2013) &quot;Functional time series approach for forecasting very short-term electricity demand&quot;, Journal of Applied Statistics, <b>40</b>(1), 153-168.
</p>
<p>H. L. Shang (2013) &quot;ftsa: An R package for analyzing functional time series&quot;, The R Journal, <b>5</b>(1), 64-72.
</p>
<p>H. L. Shang (2014) &quot;A survey of functional principal component analysis&quot;, Advances in Statistical Analysis, <b>98</b>(2), 121-142.
</p>
<p>H. L. Shang, P. Smith, J. Bijak and A. Wisniowski (2016) &quot;A multilevel functional data method for forecasting population, with an application to the United Kingdom&quot;, International Journal of Forecasting, <b>32</b>(3), 629-649.
</p>
<p>H. L. Shang (2016) &quot;Mortality and life expectancy forecasting for a group of populations in developed countries: A multilevel functional data method&quot;, Annals of Applied Statistics, <b>10</b>(3), 1639-1672.
</p>
<p>H. L. Shang (2017) &quot;Functional time series forecasting with dynamic updating: An application to intraday particulate matter concentration&quot;, Econometrics and Statistics, 1, 184-200.
</p>
<p>H. L. Shang (2017) &quot;Forecasting intraday S&amp;P 500 index returns: A functional time series approach&quot;, Journal of Forecasting, <b>36</b>(7), 741-755.
</p>
<p>H. L. Shang and S. Haberman (2017) &quot;Grouped multivariate and functional time series forecasting: An application to annuity pricing&quot;, Insurance: Mathematics and Economics, <b>75</b>, 166-179.
</p>
<p>H. L. Shang and R. J. Hyndman (2017) &quot;Grouped functional time series forecasting: An application to age-specific mortality rates&quot;, Journal of Computational and Graphical Statistics, <b>26</b>(2), 330-343.
</p>
<p>G. Rice and H. L. Shang (2017) &quot;A plug-in bandwidth selection procedure for long-run covariance estimation with stationary functional time series&quot;, Journal of Time Series Analysis, 38(4), 591-609.
</p>
<p>P. Reiss, J. Goldsmith, H. L. Shang and R. T. Ogden (2017) &quot;Methods for scalar-on-function regression&quot;, International Statistical Review, <b>85</b>(2), 228-249.
</p>
<p>P. Kokoszka, G. Rice and H. L. Shang (2017) &quot;Inference for the autocovariance of a functional time series under conditional heteroscedasticity&quot;, Journal of Multivariate Analysis, <b>162</b>, 32-50.
</p>
<p>Y. Gao and H. L. Shang (2017) &quot;Multivariate functional time series forecasting: An application to age-specific mortality rates&quot;, Risks, <b>5</b>(2), 21.
</p>
<p>H. L. Shang (2018) &quot;Visualizing rate of change: An application to age-specific fertility rates&quot;, Journal of the Royal Statistical Society: Series A (Statistics in Society), <b>182</b>(1), 249-262.
</p>
<p>H. L. Shang (2018) &quot;Bootstrap methods for stationary functional time series&quot;, Statistics and Computing, <b>28</b>(1), 1-10/
</p>
<p>Y. Gao, H. L. Shang and Y. Yang (2018) &quot;High-dimensional functional time series forecasting: An application to age-specific mortality rates&quot;, Journal of Multivariate Analysis, <b>forthcoming</b>.
</p>

<hr>
<h2 id='Australiafertility'>
Australian age-specific fertility data
</h2><span id='topic+Australiafertility'></span><span id='topic+Australiasmoothfertility'></span>

<h3>Description</h3>

<p>Age-specific fertility rates between ages 15 and 49 in Australia from 1921 to 2006. 
</p>
<p>The age-specific fertility rates can be smoothed using a weighted median smoothing B-splines, constrained to be concave. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Australiafertility)
data(Australiasmoothfertility)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>fts</code>.
</p>


<h3>Details</h3>

<p>Australian fertility rates and populations (1921-2006) for age groups (15-49) were obtained from the Australian
Bureau of Statistics (Cat.No.3105.0.65.001, Table 38). These are defined as the number of live births during 
the calendar year, according to the age of the mother, per 1000 of the female resident population of the same
age at 30 June. 
</p>
<p>Australiasmoothfertility is the smoothed version of Australiafertility data. The smoothing technique is the penalized regression spline with concave constraint, described in Hyndman and Ullah (2007). 
</p>


<h3>Author(s)</h3>

<p>Han Lin Shang</p>


<h3>Source</h3>

<p>The Australian Demographic Data Bank (courtesy of Len Smith). 
</p>


<h3>References</h3>

<p>R. J. Hyndman and M. S. Ullah (2007) &quot;Robust forecasting of mortality and fertility rates: A functional data approach&quot;, <em>Computational Statistics and Data Analysis</em>, <b>51</b>(10), 4942-4956.
</p>
<p>R. J. Hyndman and H. Booth (2008) &quot;Stochastic population forecasts using functional data models for mortality, fertility and migration&quot;, <em>International Journal of Forecasting</em>, <b>24</b>(3), 323-342.
</p>
<p>R. J. Hyndman and H. L. Shang (2009) &quot;Forecasting functional time series (with discussion)&quot;, <em>Journal of the Korean Statistical Society</em>, <b>38</b>(3), 199-221.
</p>
<p>H. L. Shang (2012) Point and interval forecasts of age-specific fertility rates: a comparison of functional principal component methods, <em>Journal of Population Research</em>, <b>29</b>(3), 249-267.
</p>
<p>H. L. Shang (2015) On the selection of optimal Box-Cox transformation parameter for modeling and forecasting age-specific fertility, <em>Journal of Population Research</em>, <b>32</b>(1), 69-79.
</p>
<p>H. L. Shang (2016) Visualising rate of change: application to age-specific fertility, <a href="https://arxiv.org/abs/1406.4386">https://arxiv.org/abs/1406.4386</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(Australiafertility)
plot(Australiasmoothfertility)
</code></pre>

<hr>
<h2 id='ElNino_ERSST_region_1and2'>
Sea surface temperature data set from January 1950 to December 2018
</h2><span id='topic+ElNino_ERSST_region_1and2'></span><span id='topic+ElNino_ERSST_region_3'></span><span id='topic+ElNino_ERSST_region_4'></span><span id='topic+ElNino_ERSST_region_3and4'></span>

<h3>Description</h3>

<p>Sea surface temperature data set from January 1950 to December 2018 observed by the extended reconstructed sea surface temperature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ElNino_ERSST_region_1and2)
data(ElNino_ERSST_region_3)
data(ElNino_ERSST_region_4)
data(ElNino_ERSST_region_3and4)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>sfts</code>.
</p>


<h3>Details</h3>

<p>These averaged monthly sea surface temperatures are measured by the different moored buoys in the &quot;Nino region&quot; defined by the coordinates 0-10 degree South and 90-80 degree West.
</p>


<h3>Source</h3>

<p>National Weather Service Climate Prediction Center website at <a href="http://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices">http://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices</a>. The data is the third column with the title NINO1+2.
</p>


<h3>References</h3>

<p>A. Antoniadis and T. Sapatinas (2003) &quot;Wavelet methods for continuous-time prediction using Hilbert-valued autoregressive processes&quot;, <em>Journal of Multivariate Analysis</em>, <b>87</b>(1), 133-158.
</p>
<p>P. C. Besse, H. Cardot and D. B. Stephenson (2000) &quot;Autoregressive forecasting of some functional climatic variations&quot;, <em>Scandinavian Journal of Statistics</em>, <b>27</b>(4), 673-687.
</p>
<p>F. Ferraty, A. Rabhi and P. Vieu (2005) &quot;Conditional quantiles for dependent functional data with application to the climate EL Nino Phenomenon&quot;, <em>Sankhya: The Indian Journal of Statistics</em>, <b>67</b>(2), 378-398.
</p>
<p>F. Ferraty and P. Vieu (2007) <em>Nonparametric functional data analysis</em>, New York: Springer.
</p>
<p>R. J. Hyndman and H. L. Shang (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>
<p>E. Moran, R. Adams, B. Bakoyema, S. Fiorini and B. Boucek (2006) &quot;Human strategies for coping with El Nino related drought in Amazonia&quot;, <em>Climatic Change</em>, <b>77</b>(3-4), 343-361.
</p>
<p>A. Timmermann, J. Oberhuber, A. Bacher, M. Esch, M. Latif and E. Roeckner (1999) &quot;Increased El Nino frequency in a climate model forced by future greenhouse warming&quot;, <em>Nature</em>, <b>398</b>(6729), 694-697.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ElNino_ERSST_region_1and2)
data(ElNino_ERSST_region_3)
data(ElNino_ERSST_region_4)
data(ElNino_ERSST_region_3and4)
</code></pre>

<hr>
<h2 id='ElNino_OISST_region_1and2'>Sea surface temperature data set from January 1982 to December 2018</h2><span id='topic+ElNino_OISST_region_1and2'></span><span id='topic+ElNino_OISST_region_3'></span><span id='topic+ElNino_OISST_region_4'></span><span id='topic+ElNino_OISST_region_3and4'></span>

<h3>Description</h3>

<p>Monthly sea surface temperatures from January 1982 to December 2018 observed by the optimum interpolation sea surface temperature. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ElNino_OISST_region_1and2)
data(ElNino_OISST_region_3)
data(ElNino_OISST_region_4)
data(ElNino_OISST_region_3and4)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>sfts</code>.
</p>


<h3>Details</h3>

<p>These averaged monthly sea surface temperatures are measured by the different moored buoys in the &quot;Nino region&quot; defined by the coordinates 0-10 degree South and 90-80 degree West.
</p>


<h3>Source</h3>

<p>National Weather Service Climate Prediction Center website at <a href="http://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices">http://www.cpc.ncep.noaa.gov/data/indices/sstoi.indices</a>. The data is the third column with the title NINO1+2.
</p>


<h3>References</h3>

<p>A. Antoniadis and T. Sapatinas (2003) &quot;Wavelet methods for continuous-time prediction using Hilbert-valued autoregressive processes&quot;, <em>Journal of Multivariate Analysis</em>, <b>87</b>(1), 133-158.
</p>
<p>P. C. Besse, H. Cardot and D. B. Stephenson (2000) &quot;Autoregressive forecasting of some functional climatic variations&quot;, <em>Scandinavian Journal of Statistics</em>, <b>27</b>(4), 673-687.
</p>
<p>F. Ferraty, A. Rabhi and P. Vieu (2005) &quot;Conditional quantiles for dependent functional data with application to the climate EL Nino Phenomenon&quot;, <em>Sankhya: The Indian Journal of Statistics</em>, <b>67</b>(2), 378-398.
</p>
<p>F. Ferraty and P. Vieu (2007) <em>Nonparametric functional data analysis</em>, New York: Springer.
</p>
<p>R. J. Hyndman and H. L. Shang (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>
<p>E. Moran, R. Adams, B. Bakoyema, S. Fiorini and B. Boucek (2006) &quot;Human strategies for coping with El Nino related drought in Amazonia&quot;, <em>Climatic Change</em>, <b>77</b>(3-4), 343-361.
</p>
<p>A. Timmermann, J. Oberhuber, A. Bacher, M. Esch, M. Latif and E. Roeckner (1999) &quot;Increased El Nino frequency in a climate model forced by future greenhouse warming&quot;, <em>Nature</em>, <b>398</b>(6729), 694-697.   
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(ElNino_OISST_region_1and2)
plot(ElNino_OISST_region_3)
plot(ElNino_OISST_region_4)
plot(ElNino_OISST_region_3and4)
</code></pre>

<hr>
<h2 id='fboxplot'>Functional bagplot and functional HDR boxplot</h2><span id='topic+fboxplot'></span>

<h3>Description</h3>

<p>Compute bivariate bagplot, functional bagplot and bivariate HDR boxplot, functional HDR boxplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fboxplot(data, plot.type = c("functional", "bivariate"),
	type = c("bag", "hdr"), alpha = c(0.05, 0.5), projmethod = c("PCAproj","rapca"),
	factor = 1.96, na.rm = TRUE, xlab = data$xname, ylab = data$yname, 
	shadecols = gray((9:1)/10), pointcol = 1, plotlegend = TRUE, 
	legendpos = "topright", ncol = 2, ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fboxplot_+3A_data">data</code></td>
<td>
<p>An object of class <code><a href="#topic+fds">fds</a></code> or <code>fts</code>.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_plot.type">plot.type</code></td>
<td>
<p>Version of boxplot. When <code>plot.type="functional"</code>, a functional plot is provided. When <code>plot.type="bivariate"</code>, a square bivariate plot is provided.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_type">type</code></td>
<td>
<p>Type of boxplot. When <code>type = "bag"</code>, a bagplot is provided. When <code>type = "hdr"</code>, a HDR boxplot is provided.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_alpha">alpha</code></td>
<td>
<p>Coverage probability for the functional HDR boxplot. <code class="reqn">\alpha</code> are the coverage percentages of the outliers and the central region.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_factor">factor</code></td>
<td>
<p>When <code>type = "bag"</code>, the outer region of a bagplot is the convex hull obtained by inflating the inner region by the bagplot factor.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove missing values.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_xlab">xlab</code></td>
<td>
<p>A title for the x axis.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_ylab">ylab</code></td>
<td>
<p>A title for the y axis.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_shadecols">shadecols</code></td>
<td>
<p>Colors for shaded regions.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_pointcol">pointcol</code></td>
<td>
<p>Color for outliers and mode.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_plotlegend">plotlegend</code></td>
<td>
<p>Add a legend to the graph.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_legendpos">legendpos</code></td>
<td>
<p>Legend position. By default, it is the top right corner.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_ncol">ncol</code></td>
<td>
<p>Number of columns in the legend.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_projmethod">projmethod</code></td>
<td>
<p>Method used for projection.</p>
</td></tr>
<tr><td><code id="fboxplot_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The functional curves are first projected into a finite dimensional subspace via functional principal component decomposition. 
For simiplicity, we choose the subspace as <code class="reqn">R^2</code>. Based on Tukey (1974)'s halfspace bagplot and Hyndman (1996)'s HDR boxplot, we order each data point in <code class="reqn">R^2</code> by data depth and data density. 
Outliers are those that have either lowest depth (distance from the centre) or lowest density.
</p>


<h3>Value</h3>

<p>Function produces a graphical plot.
</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman, Han Lin Shang. Please, report bugs and suggestions to hanlin.shang@anu.edu.au</p>


<h3>References</h3>

<p>J. W. Tukey (1974) &quot;Mathematics and the picturing of data&quot;, <em>Proceedings of the International Congress of Mathematicians</em>, <b>2</b>, 523-532, Canadian Mathematical Congress, Montreal.
</p>
<p>P. Rousseeuw, I. Ruts and J. Tukey (1999) &quot;The bagplot: A bivariate boxplot&quot;, <em>The American Statistician</em>, <b>53</b>(4), 382-387.
</p>
<p>R. J. Hyndman (1996) &quot;Computing and graphing highest density regions&quot;, <em>The American Statistician</em>, <b>50</b>(2), 120-126.
</p>
<p>R. J. Hyndman and H. L. Shang (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>
<p>Y. Sun and M. G. Genton (2011) &quot;Functional boxplots&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>20</b>(2), 316-334.
</p>
<p>Y. Sun and M. G. Genton (2012) &quot;Adjusted functional boxplots for spatio-temporal data visualization and outlier detection&quot;, <em>Environmetrics</em>, <b>23</b>, 54-64.
</p>
<p>Y. Sun and M. G. Genton (2012) &quot;Functional median polish&quot;, <em>Journal of Agricultural, Biological, and Environmental Statistics</em>, <b>17</b>, 354-376.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SVDplot">SVDplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fboxplot(data = ElNino_OISST_region_1and2, plot.type = "functional", 
	type = "bag", projmethod="PCAproj")
fboxplot(data = ElNino_OISST_region_1and2, plot.type = "bivariate", 
	type = "bag", projmethod="PCAproj")
</code></pre>

<hr>
<h2 id='fdepth'>Compute functional depth.</h2><span id='topic+fdepth'></span>

<h3>Description</h3>

<p>Compute functional depth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdepth(data, type = c("FM", "mode", "RP", "RPD", "radius"), trim = 0.25, alpha, weight)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fdepth_+3A_data">data</code></td>
<td>
<p>An object of class <code><a href="#topic+fds">fds</a></code> or <code>fts</code>.</p>
</td></tr>
<tr><td><code id="fdepth_+3A_type">type</code></td>
<td>
<p>Type of functional depth. See detail section below.</p>
</td></tr>
<tr><td><code id="fdepth_+3A_trim">trim</code></td>
<td>
<p>Percentage of trimming.</p>
</td></tr>
<tr><td><code id="fdepth_+3A_alpha">alpha</code></td>
<td>
<p>Tuning parameter used when <code>type = "radius"</code>.</p>
</td></tr>
<tr><td><code id="fdepth_+3A_weight">weight</code></td>
<td>
<p>Hard-thresholding or soft-thresholding when <code>type = "radius"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>type = "FM"</code>, it computes the functional depth of Fraiman and Muniz (2001), which is considered as the first functional depth.
</p>
<p>If <code>type = "mode"</code>, it computes the functional depth of Cuevas et al. (2006). A functional mode is defined as the curve most densely surrounded by the rest of curves of the dataset.
</p>
<p>If <code>type = "RP"</code> and <code>type = "RPD"</code>, it computes random projection functional depth of Cuevas et al. (2007). 
Cuevas et al. (2007) considered the random projection depth based on measuring the depth of the functional data 
under projections and taking additional information of their derivatives. The basic idea is to project each functional curve, along a random direction, defining a 
point in <code class="reqn">R^2</code>. A data depth in <code class="reqn">R^2</code> provides an order of the projected points.
</p>
<p>If <code>type = "radius"</code>, it ranks the curves according to alpha-radius. Then using the hard thresholding or soft thresholding, trimmed mean and median can be computed.
</p>
<p>The argument trim = 0.25 first order curves by depth, and then trim 25 percent curves that have comparably lower depth.
</p>


<h3>Value</h3>

<p>A list containing the following components is returned.
</p>
<table role = "presentation">
<tr><td><code>median</code></td>
<td>
<p>Median curve (highest depth).</p>
</td></tr>
<tr><td><code>lmed</code></td>
<td>
<p>Index of median curve.</p>
</td></tr>
<tr><td><code>ltrim</code></td>
<td>
<p>Indexes of the trimmed curves.</p>
</td></tr>
<tr><td><code>prof</code></td>
<td>
<p>Functional depth for each curve.</p>
</td></tr>
<tr><td><code>mtrim</code></td>
<td>
<p>Mean of trimmed curves.</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>Weight values for all observations, when <code>type = "radius"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Han Lin Shang</p>


<h3>References</h3>

<p>R. Fraiman and G. Muniz (2001) &quot;Trimmed means for functional data&quot;, <em>Test</em>, <b>10</b>(2), 419-440.
</p>
<p>A. Cuevas and M. Febrero and R. Fraiman (2001) &quot;Cluster Analysis:a further approach based on density estimation&quot;, <em>Computational Statistics and Data Analysis</em>, <b>36</b>(4), 441-456.
</p>
<p>A. Cuevas and M. Febrero and R. Fraiman (2006) &quot;On the use of bootstrap for estimating functions with functional data&quot;, <em>Computational Statistics and Data Analysis</em>, <b>51</b>(10), 1063-1074.
</p>
<p>A. Cuevas and M. Febrero and R. Fraiman (2007) &quot;Robust estimation and classification for functional data via projection-based depth notions&quot;, <em>Computational Statistics</em>, <b>22</b>(3), 481-496.
</p>
<p>M. Febrero and P. Galeano and W. Gonzalez-Manteiga (2007) &quot;A functional analysis of NOx levels: location and scale estimation and outlier detection&quot;, <em>Computational Statistics</em>, <b>22</b>(3), 411-427.
</p>
<p>M. Febrero and P. Galeano and W. Gonzalez-Manteiga (2008) &quot;Outlier detection in functional data by depth measures, with application to identify abnormal NOx levels&quot;, <em>Environmetrics</em>, <b>19</b>(4), 331-345.
</p>
<p>M. Febrero and P. Galeano and W. Gonzalez-Manteiga (2010) &quot;Measures of influence for the functional linear model with scalar response&quot;, <em>Journal of Multivariate Analysis</em>, <b>101</b>(2), 327-339. 
</p>
<p>J. A. Cuesta-Albertos and A. Nieto-Reyes (2010) &quot;Functional classification and the random Tukey depth. Practical issues&quot;, Combining Soft Computing and Statistical Methods in Data Analysis, Advances in Intelligent and Soft Computing, Volume 77, 123-130.
</p>
<p>D. Gervini (2012) &quot;Outlier detection and trimmed estimation in general functional spaces&quot;, <em>Statistica Sinica</em>, <b>22</b>(4), 1639-1660.
</p>
<p>P. Rana, G. Aneiros and J. M. Vilar (2015) &quot;Detection of outliers in functional time series&quot;, <em>Environmetrics</em>, <b>26</b>, 178-191. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fdepth(data = ElNino_OISST_region_1and2, type = "FM")
fdepth(data = ElNino_OISST_region_1and2, type = "mode")
fdepth(data = ElNino_OISST_region_1and2, type = "RP")
fdepth(data = ElNino_OISST_region_1and2, type = "RPD")
fdepth(data = ElNino_OISST_region_1and2, type = "radius", trim = 0.25, 
	alpha = 0.5, weight = "hard")
fdepth(data = ElNino_OISST_region_1and2, type = "radius", trim = 0.25, 
	alpha = 0.5, weight = "soft")
</code></pre>

<hr>
<h2 id='fds'>Create functional objects</h2><span id='topic+fds'></span><span id='topic+fts'></span><span id='topic+sfts'></span>

<h3>Description</h3>

<p>The function <code>fds</code> is used to create general independent and identically distributed (i.i.d.) functional objects that are not ordered by time.
The function <code>fts</code> is used to create functional time series objects.
The function <code>sfts</code> is used to create sliced functional time series objects, where the <code>x</code> variable is 
also a time variable.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fds(x, y, xname, yname)
fts(x, y, start = 1, frequency = 1, xname, yname)
sfts(data, period = frequency(data), start = tsp(data)[1], 
     frequency = 1, xname, yname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fds_+3A_x">x</code></td>
<td>
<p>Numeric vector of length <code class="reqn">p</code>.</p>
</td></tr>
<tr><td><code id="fds_+3A_y">y</code></td>
<td>
<p>Matrix of size <code class="reqn">p\times n</code> representing <code class="reqn">n</code>
functions of <code class="reqn">x</code> observed at points <code class="reqn">1,\dots,p</code>.</p>
</td></tr>
<tr><td><code id="fds_+3A_data">data</code></td>
<td>
<p>An object of class <code><a href="stats.html#topic+ts">ts</a></code>.</p>
</td></tr>
<tr><td><code id="fds_+3A_period">period</code></td>
<td>
<p>Time period of sliced functional data. For instance, <code>period = 12</code> is a monthly data.</p>
</td></tr>    
<tr><td><code id="fds_+3A_start">start</code></td>
<td>
<p>The time of the first observation. Either a single number or a vector
of two integers, which specify a natural time unit and a (1-based) number of
samples into the time unit. See <code><a href="stats.html#topic+ts">ts</a></code> for details.</p>
</td></tr>
<tr><td><code id="fds_+3A_frequency">frequency</code></td>
<td>
<p>The number of observations per unit of time.</p>
</td></tr>
<tr><td><code id="fds_+3A_xname">xname</code></td>
<td>
<p>Character string giving name of <code>x</code> vector. (optional)</p>
</td></tr>
<tr><td><code id="fds_+3A_yname">yname</code></td>
<td>
<p>Character string giving name of <code>y</code> vector. (optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>fds</code> or <code>fts</code> or <code>sfts</code>.</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman and Han Lin Shang</p>


<h3>Examples</h3>

<pre><code class='language-R'>fds(x = 1:20, y = Simulationdata$y, xname = "x", yname = "Simulated value")
fts(x = 15:49, y = Australiasmoothfertility$y, xname = "Age", 
    yname = "Fertility rate")
sfts(ts(as.numeric(ElNino_OISST_region_1and2$y), frequency = 12), xname = "Month", 
     yname = "Sea surface temperature")    
</code></pre>

<hr>
<h2 id='foutliers'>Functional outlier detection methods.</h2><span id='topic+foutliers'></span>

<h3>Description</h3>

<p>Functional outlier detection methods. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foutliers(data, method = c("robMah", "lrt", "depth.trim", "depth.pond", 
 "HUoutliers"), dfunc = depth.mode, nb = 200, suav = 0.05, trim = 0.1, 
  order = 2, lambda = 3.29,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="foutliers_+3A_data">data</code></td>
<td>
<p>An object of class <code><a href="#topic+fds">fds</a></code> or <code>fts</code>.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_method">method</code></td>
<td>
<p>Outlier detection method.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_dfunc">dfunc</code></td>
<td>
<p>When <code>method = "lrt"</code> or <code>method = "depth.trim"</code> or <code>method = "depth.pond"</code>,
users can specify the type of depth functions with possible choices of depth.FM, depth.mode, depth.RP, depth.RPD.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_nb">nb</code></td>
<td>
<p>When <code>method = "lrt"</code>, users can specify the number of bootstrap samples. </p>
</td></tr>
<tr><td><code id="foutliers_+3A_suav">suav</code></td>
<td>
<p>When <code>method = "lrt"</code>, users can specify the smoothing parameter used in the smoothed bootstrap samples to determine the cutoff value.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_trim">trim</code></td>
<td>
<p>When <code>method = "lrt"</code> or <code>method = "depth.trim"</code> or <code>method = "depth.pond"</code>, 
users can specify the trimming percentage.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_order">order</code></td>
<td>
<p>When <code>method = "HUoutliers"</code>, users can specify the number of principal components.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_lambda">lambda</code></td>
<td>
<p>When <code>method = "HUoutliers"</code>, users can specify the value of tuning parameter.</p>
</td></tr>
<tr><td><code id="foutliers_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>method = "lrt"</code>, the outlier detection method corresponds to the approach of Febrero et al. (2007) using the likelihood ratio test.
</p>
<p>When <code>method = "depth.trim"</code>, the outlier detection method corresponds to the approach of Febrero et al. (2008) using the functional depth with trimmed curves.
</p>
<p>When <code>method = "depth.pond"</code>, the outlier detection method corresponds to the approach of Febrero et al. (2008) using the functional depth with all curves.
</p>
<p>When <code>method = "HUoutliers"</code>, the outlier detection method corresponds to the approach of Hyndman and Ullah (2008) using the integrated square forecast errors.
</p>
<p>When <code>method = "robMah"</code>, the outlier detection method corresponds to the approach of Rousseeuw and Leroy (1987) using the robust Mahalanobis distance. 
</p>


<h3>Value</h3>

<p>A list containing the following components is returned.
</p>
<table role = "presentation">
<tr><td><code>outliers</code></td>
<td>
<p>Detected outliers.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>Threshold value to separate outliers from non-outliers, when <code>method = "lrt"</code>, <code>method = "depth.trim"</code>, and <code>method = "depth.pond"</code>.</p>
</td></tr> 
<tr><td><code>depth.total</code></td>
<td>
<p>Depth measure of each functional curve.</p>
</td></tr>
<tr><td><code>depth.out</code></td>
<td>
<p>Depth measure of functional outliers.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Han Lin Shang</p>


<h3>References</h3>

<p>P. Rousseeuw and A. Leroy (1987) <em>Robust regression and outlier detection</em>, John Wiley and Sons, New York.
</p>
<p>A. Atkinson (1994) &quot;Fast very robust methods for the detection of multiple outliers&quot;, <em>Journal of the American Statistical Association</em>, <b>89</b>(428), 1329-1339.
</p>
<p>R. J. Hyndman and M. S. Ullah (2007) &quot;Robust forecasting of mortality and fertility rates: A functional data approach&quot;, <em>Computational Statistics and Data Analysis</em>, <b>51</b>(10), 4942-4956.
</p>
<p>M. Febrero and P. Galeano and W. Gonzalez-Manteiga (2007) &quot;A functional analysis of NOx levels: location and scale estimation and outlier detection&quot;, <em>Computational Statistics</em>, <b>22</b>(3), 411-427.
</p>
<p>M. Febrero and P. Galeano and W. Gonzalez-Manteiga (2008) &quot;Outlier detection in functional data by depth measures, with application to identify abnormal NOx levels&quot;, <em>Environmetrics</em>, <b>19</b>(4), 331-345.
</p>
<p>R. J. Hyndman and H. L. Shang. (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>foutliers(data = ElNino_OISST_region_1and2, method = "depth.trim")
</code></pre>

<hr>
<h2 id='plot.fdepth'>Plot functional depth</h2><span id='topic+plot.fdepth'></span>

<h3>Description</h3>

<p>Plot functional depth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fdepth'
plot(x, show.legend = TRUE, pos.legend = "bottomleft", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fdepth_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+fdepth">fdepth</a></code>.</p>
</td></tr>
<tr><td><code id="plot.fdepth_+3A_show.legend">show.legend</code></td>
<td>
<p>Is legend required in the plot?</p>
</td></tr>
<tr><td><code id="plot.fdepth_+3A_pos.legend">pos.legend</code></td>
<td>
<p>When <code>show.legend = TRUE</code>, users can specify the position of the legend.</p>
</td></tr>
<tr><td><code id="plot.fdepth_+3A_...">...</code></td>
<td>
<p>Other plotting parameters passed to <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Function produces a plot.</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman, Han Lin Shang</p>


<h3>References</h3>

<p>R. J. Hyndman and H. L. Shang. (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fdepth">fdepth</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(fdepth(ElNino_OISST_region_1and2))
</code></pre>

<hr>
<h2 id='plot.fds'>Plot functional objects</h2><span id='topic+plot.fds'></span><span id='topic+lines.fds'></span><span id='topic+points.fds'></span>

<h3>Description</h3>

<p>Plot functional curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fds'
plot(x, plot.type = c("functions", "time", "depth", "density"),
  col = NULL, type = "l", lty = 1, xlab = x$xname, ylab = x$yname, 
  pch = c(1:9,0, letters, LETTERS), add = FALSE, index,     
  colorchoice = c("rainbow", "heat.colors", "terrain.colors", 
  "topo.colors", "cm.colors", "rainbow_hcl", "gray", "sequential_hcl", 
  "heat_hcl", "terrain_hcl", "diverge_hcl"), plotlegend = FALSE, 
  legendpos = "topright", ncol = 1, ...)
## S3 method for class 'fds'
lines(x, type = "l", index, ...)
## S3 method for class 'fds'
points(x, type = "p", index, ...)  
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.fds_+3A_x">x</code></td>
<td>
<p>An object of class <code><a href="#topic+fds">fds</a></code> or <code>fts</code>.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_plot.type">plot.type</code></td>
<td>
<p>Type of plot. See details for more explanations.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_col">col</code></td>
<td>
<p>Colors to use in plot. Default in <code>plot.fds</code> is to use a rainbow color palette with the number of colors equal to the number of functions.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_type">type</code></td>
<td>
<p>1-character string giving the type of plot desired.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_lty">lty</code></td>
<td>
<p>The line type.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_xlab">xlab</code></td>
<td>
<p>A title for x axis.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_ylab">ylab</code></td>
<td>
<p>A title for y axis.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_pch">pch</code></td>
<td>
<p>Either an integer specifying a symbol or a single character to be used as the default in plotting points.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_add">add</code></td>
<td>
<p>If <code>add = TRUE</code>, it plots a line or points.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_index">index</code></td>
<td>
<p>Index of a specific curve that is plotted as a line or points.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_colorchoice">colorchoice</code></td>
<td>
<p>Color palette used for drawing the rainbow plot.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_plotlegend">plotlegend</code></td>
<td>
<p>Add a legend to the graph.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_legendpos">legendpos</code></td>
<td>
<p>Position of legend.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_ncol">ncol</code></td>
<td>
<p>Number of column in the legend.</p>
</td></tr>
<tr><td><code id="plot.fds_+3A_...">...</code></td>
<td>
<p>Other plotting parameters passed to <code><a href="graphics.html#topic+par">par</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>plot.type = "functions"</code>, then functions are plotted using a rainbow color palette so the
first few functions are shown in red, followed by orange, yellow, green, blue
and indigo with the last few functions plotted in violet.
</p>
<p>If <code>plot.type = "time"</code>, then each value of x is shown as a separate time series in a time plot.
</p>
<p>If <code>plot.type = "depth"</code>, then functions are first ordered by depth and then plotted using a rainbow color palette.
</p>
<p>If <code>plot.type = "density"</code>, then functions are first ordered by density and then plotted using a rainbow color palette.
</p>


<h3>Value</h3>

<p>Function produces a plot.</p>


<h3>Author(s)</h3>

<p>Rob J Hyndman, Han Lin Shang. Please, report bugs and suggestions to hanlin.shang@anu.edu.au</p>


<h3>References</h3>

<p>R. J. Hyndman and H. L. Shang. (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fds">fds</a></code>, <code><a href="#topic+lines.fds">lines.fds</a></code>, <code><a href="#topic+points.fds">points.fds</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(x = ElNino_OISST_region_1and2, plot.type = "functions", legend = TRUE)
lines(x = ElNino_OISST_region_1and2, plot.type = "functions", index = 3)
points(x = ElNino_OISST_region_1and2, plot.type = "functions", index = 3)
</code></pre>

<hr>
<h2 id='Simulationdata'>
Simulated data
</h2><span id='topic+Simulationdata'></span>

<h3>Description</h3>

<p>Simulated data used in Hyndman and Shang (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Simulationdata)</code></pre>


<h3>Format</h3>

<p>An object of class <code><a href="#topic+fds">fds</a></code>.
</p>


<h3>References</h3>

<p>R. J. Hyndman and H. L. Shang. (2010) &quot;Rainbow plots, bagplots, and boxplots for functional data&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>19</b>(1), 29-45.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(Simulationdata, col = rainbow(100))
lines(Simulationdata, index = 991:1000, col = "black")
</code></pre>

<hr>
<h2 id='summaryfunction'>
Summary statistics for functional data
</h2><span id='topic+summaryfunction'></span>

<h3>Description</h3>

<p>Display summary statistics (minimum, 1st quantile, median, mean, 3rd quantile, maximum) and quantiles of functional data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryfunction(ftsdata, plot.type = c("summarystats", "quantilestats"),
 quantilepercent = seq(0.1, 0.9, by = 0.1), plot.legend = FALSE, 
  legendpos = "topright", cex = 0.9, lwd = 1, lty = 1, ncol = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summaryfunction_+3A_ftsdata">ftsdata</code></td>
<td>
<p>An object of class <code><a href="#topic+fds">fds</a></code>.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_plot.type">plot.type</code></td>
<td>
<p>Summary statistics or quantiles.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_quantilepercent">quantilepercent</code></td>
<td>
<p>Percentage of quantiles.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_plot.legend">plot.legend</code></td>
<td>
<p>Is the legend required in the plot?</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_legendpos">legendpos</code></td>
<td>
<p>When the <code>plot.legend = TRUE</code>, position of the legend.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_cex">cex</code></td>
<td>
<p>When the <code>plot.legend = TRUE</code>, point size.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_lwd">lwd</code></td>
<td>
<p>When the <code>plot.legend = TRUE</code>, width of line.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_lty">lty</code></td>
<td>
<p>When the <code>plot.legend = TRUE</code>, line type.</p>
</td></tr>
<tr><td><code id="summaryfunction_+3A_ncol">ncol</code></td>
<td>
<p>When the <code>plot.legend = TRUE</code>, number of columns in the legend.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A function for displaying summary statistics or quantiles of functional data.
</p>


<h3>Value</h3>

<p>Return a plot of summary statistics of functional data or a plot of quantiles of functional data.
</p>


<h3>Author(s)</h3>

<p>Han Lin Shang.  Please, report bugs and suggestions to hanlin.shang@anu.edu.au
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fds">fds</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>summaryfunction(Australiasmoothfertility, plot.type = "summarystats")
summaryfunction(Australiasmoothfertility, plot.type = "quantilestats", plot.legend = TRUE)
</code></pre>

<hr>
<h2 id='SVDplot'>
Singular value decomposition plot
</h2><span id='topic+SVDplot'></span>

<h3>Description</h3>

<p>The singular value decomposition (SVD) plot of Zhang et al. (2007) captures the changes in the 
singular columns as the number of curves gradually increases. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SVDplot(object, order = 3, plot = TRUE, plot.type = c("fts", "image"),
        mfrow = c(2, 3))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SVDplot_+3A_object">object</code></td>
<td>
<p>An object of <code><a href="#topic+fds">fds</a></code>.</p>
</td></tr>
<tr><td><code id="SVDplot_+3A_order">order</code></td>
<td>
<p>Number of Singular Value Decomposition (SVD) components. The maximum order is 4.</p>
</td></tr>
<tr><td><code id="SVDplot_+3A_plot">plot</code></td>
<td>
<p>Is graphical display required?</p>
</td></tr>
<tr><td><code id="SVDplot_+3A_plot.type">plot.type</code></td>
<td>
<p>Plot functional time series or images?</p>
</td></tr>
<tr><td><code id="SVDplot_+3A_mfrow">mfrow</code></td>
<td>
<p>Grid of graphics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>By using the SVD, Zhang et al. (2007) proposed a plot for visualizing patterns
of functional time series. They considered a set of curves as a two-way <code>(p * n)</code> data matrix, where <code>p</code>
is the total number of covariates and <code>n</code> is the total number of curves. 
</p>
<p>The main advantage of this dynamic plot is to visualize both column and row information of a two-way matrix
simultaneously, relate the matrix to the corresponding curves, show local variations, and highlight interactions
between columns and rows of a two-way matrix.
</p>


<h3>Value</h3>

<p>When <code>plot = TRUE</code>, it returns a plot.
</p>
<p>When <code>plot = FALSE</code>, it returns the following:
</p>
<table role = "presentation">
<tr><td><code>svds</code></td>
<td>
<p>A number of singular value decomposition ordered by the amount of explained variation.</p>
</td></tr>
<tr><td><code>reconstruction</code></td>
<td>
<p>Reconstruction of the original data using the SVD.</p>
</td></tr>
<tr><td><code>residual</code></td>
<td>
<p>Residual of the original data.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>MATLAB code is available at <a href="https://www.stat.purdue.edu/~lingsong/">https://www.stat.purdue.edu/~lingsong/</a>.
</p>
<p>Using the animate package of Grahn(2011), a set of dynamic movies can be created to visualize the changes in singular rows and singular columns. 
</p>


<h3>Author(s)</h3>

<p>Han Lin Shang.  Please, report bugs and suggestions to hanlin.shang@anu.edu.au
</p>


<h3>References</h3>

<p>L. Zhang, J. Marron, H. Shen and Z. Zhu (2007) &quot;Singular value decomposition and its visualization&quot;, <em>Journal of Computational and Graphical Statistics</em>, <b>16</b>(4), 833-854.
</p>
<p>A. Grahn (2011) &quot;The animate Package&quot;, <a href="https://ctan.org/pkg/animate?lang=en">https://ctan.org/pkg/animate?lang=en</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fboxplot">fboxplot</a></code>, <code><a href="base.html#topic+svd">svd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SVDplot(ElNino_OISST_region_1and2)
SVDplot(ElNino_OISST_region_1and2, plot.type = "image")
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
