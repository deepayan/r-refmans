<!DOCTYPE html><html lang="en"><head><title>Help for package xlr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xlr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_base_r'><p>Convert xlr types to their base R type</p></a></li>
<li><a href='#build_mtable'><p>Summarise a multiple response table</p></a></li>
<li><a href='#build_qtable'><p>Summarise a question block</p></a></li>
<li><a href='#build_table'><p>Create a one, two, three,..., n-way table</p></a></li>
<li><a href='#clothes_opinions'><p>Clothes opinions data</p></a></li>
<li><a href='#create_table_of_contents'><p>Adds a table of contents to an .xlsx (<code>Excel</code>) file</p></a></li>
<li><a href='#is_xlr_format'><p>Test if an object is a <code>xlr_format</code></p></a></li>
<li><a href='#is_xlr_type'><p>Check if a variable is an xlr type</p>
This function tests whether an R variable has a xlr type.</a></li>
<li><a href='#update_theme'><p>Update the <code>xlr_table</code> theme</p></a></li>
<li><a href='#write_xlsx'><p>Write a <code>xlr_table</code>, <code>data.frame</code>, or <code>tibble</code> to an .xlsx (<code>Excel</code>) file</p></a></li>
<li><a href='#xlr_and_dplyr'><p>xlr and dplyr</p></a></li>
<li><a href='#xlr_format'><p>Specify formatting options for <code style="white-space: pre;">&#8288;xlr_*&#8288;</code> types</p></a></li>
<li><a href='#xlr_integer'><p><code>xlr_integer</code> vector</p></a></li>
<li><a href='#xlr_numeric'><p><code>xlr_numeric</code> vector</p></a></li>
<li><a href='#xlr_percent'><p><code>xlr_percent</code> vector</p></a></li>
<li><a href='#xlr_table'><p><code>xlr_table</code> object</p></a></li>
<li><a href='#xlr_vector'><p><code>xlr_vector</code> vector</p></a></li>
<li><a href='#xlr-vctrs'><p>Internal vctrs methods</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Create Table Summaries and Export Neat Tables to 'Excel'</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>A high-level interface for creating and exporting summary tables to
  'Excel'. Built on 'dplyr' and 'openxlsx', it provides tools for generating
  one-way to n-way tables, and summarizing multiple response questions 
  and question blocks. Tables are exported with native 'Excel' formatting, 
  including titles, footnotes, and basic styling options.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Collate:</td>
<td>as_base_r.R xlr_table.R xlr_to_workbook.R
build_multiple_response_table.R build_table.R write_xlsx.R
xlr_numeric.R xlr_integer.R xlr_vector.R xlr_percent.R
xlr_format.R openxlsx_utils.R xlr_doc.R error_utils.R
create_table_of_contents.R build_question_block_table.R
table_utils.R data.R is_xlr_type.R</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0), data.table, lubridate</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Imports:</td>
<td>rlang, vctrs (&ge; 0.6.0), haven, openxlsx, methods, cli, dplyr,
tibble, pillar, tidyr, tidyselect</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://nhilder.github.io/xlr/">https://nhilder.github.io/xlr/</a>, <a href="https://github.com/NHilder/xlr">https://github.com/NHilder/xlr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/NHilder/xlr/issues">https://github.com/NHilder/xlr/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-05 21:40:22 UTC; nicholashilderson</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicholas Hilderson [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Hilderson &lt;nhilderson.code@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-07 11:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_base_r'>Convert xlr types to their base R type</h2><span id='topic+as_base_r'></span>

<h3>Description</h3>

<p><code>as_base_r</code> converts xlr objects, <a href="#topic+xlr_table">xlr_table</a>, <a href="#topic+xlr_numeric">xlr_numeric</a>, <a href="#topic+xlr_integer">xlr_integer</a>,
<a href="#topic+xlr_percent">xlr_percent</a>, and <a href="#topic+xlr_format">xlr_format</a> to their base R type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_base_r(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_base_r_+3A_x">x</code></td>
<td>
<p>a xlr object</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="#topic+as_base_r">as_base_r</a> is a generic. It is a wrapper around <a href="vctrs.html#topic+vec_data">vec_data</a> but will convert
every object to its base type.
</p>


<h3>Value</h3>

<p>The base type of the base R object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)

# We create a xlr objects
a &lt;- xlr_numeric(1:100)
b &lt;- xlr_percent(1:100/100)
tab &lt;- xlr_table(mtcars,"a title","a footnote")

# now lets convert them back to their base types
as_base_r(a)
as_base_r(b)
as_base_r(tab)
</code></pre>

<hr>
<h2 id='build_mtable'>Summarise a multiple response table</h2><span id='topic+build_mtable'></span>

<h3>Description</h3>

<p>This function can take one or two multiple response responses and generate
a summary table with them. You can also cut these columns by other categorical
columns by specify the cols parameter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_mtable(
  x,
  mcols,
  cols = NULL,
  table_title = "",
  use_questions = FALSE,
  use_NA = FALSE,
  wt = NULL,
  footnote = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_mtable_+3A_x">x</code></td>
<td>
<p>a data frame or tidy object.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_mcols">mcols</code></td>
<td>
<p>the column(s) that are multiple response questions. See
the <code>Details</code> for more details of how these columns should be structured.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_cols">cols</code></td>
<td>
<p>the column(s) that we want to calculate the sum/percentage of and
the multiple response question.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_table_title">table_title</code></td>
<td>
<p>the title of the table sheet</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_use_questions">use_questions</code></td>
<td>
<p>if the data has column labels (was a imported .sav)
file, convert the column label to a footnote with the question.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_use_na">use_NA</code></td>
<td>
<p>logical. whether to include <code>NA</code> values in the table. For more complicated
<code>NA</code> processing post creation, we recommend using filter.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_wt">wt</code></td>
<td>
<p>Specify a weighting variable, if <code>NULL</code> no weight is applied.</p>
</td></tr>
<tr><td><code id="build_mtable_+3A_footnote">footnote</code></td>
<td>
<p>optional parameter to pass a custom footnote to the question,
this parameter overwrites <code>use_questions</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A multiple response response is a series of columns with a single unique
response that stores survey data where a respondent may have chosen
multiple options. This function works if this data is stored in a <strong>wide</strong>
format. To have a valid multiple response column all the columns should
start with the same text, and each contain a unique value. That is it
has the form:
</p>
<div class="sourceCode r"><pre> data.frame(multi_col_1 = c(1,NA,1),
           multi_col_2 = c(1,1,1),
           multi_col_3 = c(NA,NA,1)
 )
#&gt;   multi_col_1 multi_col_2 multi_col_3
#&gt; 1           1           1          NA
#&gt; 2          NA           1          NA
#&gt; 3           1           1           1
</pre></div>
<p>This is how popular survey platforms such as Qualtrics output this data type. If
your data is long, you will need to pivot the data before hand, we recommend
using <a href="tidyr.html#topic+pivot_wider">pivot_wider</a>.
</p>
<p>By default this function converts <a href="haven.html#topic+labelled">labelled</a> to a <a href="#topic+xlr_vector">xlr_vector</a>
by default (and underlying it is a <code>character()</code> type).
</p>
<p>This function and its family (<a href="#topic+build_table">build_table</a>, <a href="#topic+build_qtable">build_qtable</a>) is designed to
work with data with columns of type <code>haven::labelled</code>,
which is the default format of data read with <code>haven::read_sav</code>/has the format
of <code>.sav</code>. <code>.sav</code> is the default file function type of data from <code>SPSS</code> and
can be exported from popular survey providers such as Qualtrics. When you
read in data with <code>haven::read_sav</code> it imports data with the questions,
labels for the response options etc.
</p>
<p>See <a href="haven.html#topic+labelled">labelled</a> and <a href="haven.html#topic+read_sav">read_sav</a> if you would like more
details on the importing type.
</p>


<h3>Value</h3>

<p>a <code>xlr_table</code> object. Use <a href="#topic+write_xlsx">write_xlsx</a> to write to an <code>Excel</code> file.
See <a href="#topic+xlr_table">xlr_table</a> for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
library(dplyr)

# You can use this function to calculate the number of people that have
# responded to the question `What is your favourite colour`
build_mtable(clothes_opinions,
             "Q2",
             table_title = "What is your favourite colour?")

# The function also lets you to see the number of NA questions (this is
# where someone doesn't answer any option)
build_mtable(clothes_opinions,
             "Q2",
             table_title = "What is your favourite colour?",
             use_NA = TRUE)

# You can also cut all questions in the multiple response functions by another
# column
build_mtable(clothes_opinions,
             "Q2",
             gender2,
             table_title = "Your favourite colour by gender")

# By setting `use_questions=TRUE` then the footnote will be the questions
# labels. This is useful to see what the question is.
# The function will try to pull out this based on the question label, and
# will manipulate try and get the correct label.
build_mtable(clothes_opinions,
             "Q2",
             gender2,
             table_title = "Your favourite colour by gender",
             use_questions = TRUE)

# It is common for your data to include 'other' responses in a multiple
# response column. You should remove the column before running build_mtable
clothes_opinions |&gt;
  select(-Q3_other) |&gt;
  build_mtable("Q3")

# You can also specify up to a maxium of two different multiple response
# columns.
clothes_opinions |&gt;
  select(-Q3_other) |&gt;
  build_mtable(c("Q2", "Q3"))

# These cam also be cut by other columns.
clothes_opinions |&gt;
  select(-Q3_other) |&gt;
  build_mtable(c("Q2", "Q3"),
               gender2)

# This function also supports weights and manual footnotes
clothes_opinions |&gt;
  select(-Q3_other) |&gt;
  build_mtable(c("Q2", "Q3"),
               gender2,
               wt = weight,
               footnote = "This is an example footnote.")
</code></pre>

<hr>
<h2 id='build_qtable'>Summarise a question block</h2><span id='topic+build_qtable'></span>

<h3>Description</h3>

<p>This function helps analyse a block of questions or matrix questions into a
single table. It also lets the user cut these questions by other questions in
the data. The block of questions mush have the same response options.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_qtable(
  x,
  block_cols,
  cols = NULL,
  table_title = "",
  use_questions = FALSE,
  use_NA = FALSE,
  wt = NULL,
  footnote = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_qtable_+3A_x">x</code></td>
<td>
<p>a data frame or tidy object</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_block_cols">block_cols</code></td>
<td>
<p>&lt;<a href="tidyr.html#topic+tidyr_tidy_select">tidyr_tidy_select</a>&gt; statement. These are the
columns that make up the question block, they must have the same response
option. Most question block columns start with the same piece of text, so
you should use <code>starts_with('column_text')</code>. See the Examples below.</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_cols">cols</code></td>
<td>
<p>&lt;<a href="tidyr.html#topic+tidyr_tidy_select">tidyr_tidy_select</a>&gt; statement. These are the column(s) that we
want to cut the questions in the question block by.</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_table_title">table_title</code></td>
<td>
<p>a string. The title of the table sheet</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_use_questions">use_questions</code></td>
<td>
<p>a logical. If the data has column labels (was a imported .sav)
file, convert the column label to a footnote with the question.</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_use_na">use_NA</code></td>
<td>
<p>a logical. Whether to include <code>NA</code> values in the table. For more complicated
<code>NA</code> processing post creation, we recommend using filter.</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_wt">wt</code></td>
<td>
<p>a quoted or unquote column name. Specify a weighting variable, if
<code>NULL</code> no weight is applied.</p>
</td></tr>
<tr><td><code id="build_qtable_+3A_footnote">footnote</code></td>
<td>
<p>a character vector. Optional parameter to pass a custom
footnote to the question, this parameter overwrites <code>use_questions</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function and its family (<a href="#topic+build_table">build_table</a>, <a href="#topic+build_qtable">build_qtable</a>) is designed to
work with data with columns of type <code>haven::labelled</code>,
which is the default format of data read with <code>haven::read_sav</code>/has the format
of <code>.sav</code>. <code>.sav</code> is the default file function type of data from <code>SPSS</code> and
can be exported from popular survey providers such as Qualtrics. When you
read in data with <code>haven::read_sav</code> it imports data with the questions,
labels for the response options etc.
</p>
<p>By default this function converts <a href="haven.html#topic+labelled">labelled</a> to a <a href="#topic+xlr_vector">xlr_vector</a>
by default (and underlying it is a <code>character()</code> type).
</p>
<p>See <a href="haven.html#topic+labelled">labelled</a> and <a href="haven.html#topic+read_sav">read_sav</a> if you would like more
details on the importing type.
</p>


<h3>Value</h3>

<p>a <code>xlr_table</code> object. Use <a href="#topic+write_xlsx">write_xlsx</a> to write to an <code>Excel</code> file.
See <a href="#topic+xlr_table">xlr_table</a> for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)

# You can use this function to get a block of questions
build_qtable(
  clothes_opinions,
  starts_with("Q1"),
  table_title = "This is an example table")

# Another way you could select the same columns
build_qtable(
  clothes_opinions,
  c(Q1_1,Q1_2,Q1_3,Q1_4),
  table_title = "This is an example table")

# Yet another way to select the same columns
build_qtable(
  clothes_opinions,
  all_of(c("Q1_1","Q1_2","Q1_3","Q1_4")),
  table_title = "This is an example table")
# You can also cut all questions in the block by a single column
build_qtable(
  clothes_opinions,
  starts_with("Q1"),
  gender2,
  table_title = "This is the second example table")

# You can also cut all questions in the block by a multiple columns
# By setting `use_questions=TRUE` then the footnote will be the questions
# labels, for the cut questions
build_qtable(
  clothes_opinions,
  starts_with("Q1"),
  c(gender2,age_group),
  table_title = "This is the third example table",
  use_questions = TRUE)

# You can also use weights, these weights can be either doubles or integers
# based weights
# You can also set a footnote
build_qtable(
  clothes_opinions,
  starts_with("Q1"),
  age_group,
  table_title = "This is the fourth example table",
  wt = weight,
  footnote = paste0("This is a footnote, you can use it if you want ",
                    "more detail in your table."))
</code></pre>

<hr>
<h2 id='build_table'>Create a one, two, three,..., n-way table</h2><span id='topic+build_table'></span>

<h3>Description</h3>

<p><code>build_table</code> creates a one, two, three, ..., n-way table. It should be used
to calculate the count and percentage of different categorical variables. It
gives the data back in a long format. The percentages calculated are the
'row' percentages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>build_table(
  x,
  cols,
  table_title = "",
  use_questions = FALSE,
  use_NA = FALSE,
  wt = NULL,
  footnote = ""
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="build_table_+3A_x">x</code></td>
<td>
<p>a data frame or tidy object.</p>
</td></tr>
<tr><td><code id="build_table_+3A_cols">cols</code></td>
<td>
<p>&lt;<a href="tidyr.html#topic+tidyr_tidy_select">tidyr_tidy_select</a>&gt; These are the column(s) that we
want to calculate the count and percentage of.</p>
</td></tr>
<tr><td><code id="build_table_+3A_table_title">table_title</code></td>
<td>
<p>a string. The title of the table sheet.</p>
</td></tr>
<tr><td><code id="build_table_+3A_use_questions">use_questions</code></td>
<td>
<p>a logical. If the data has column labels convert the
column label to a footnote with the question. See details for more information.</p>
</td></tr>
<tr><td><code id="build_table_+3A_use_na">use_NA</code></td>
<td>
<p>a logical. Whether to include <code>NA</code> values in the table. For more complicated
<code>NA</code> processing post creation, we recommend using filter.</p>
</td></tr>
<tr><td><code id="build_table_+3A_wt">wt</code></td>
<td>
<p>a quoted or unquote column name. Specify a weighting variable, if
<code>NULL</code> no weight is applied.</p>
</td></tr>
<tr><td><code id="build_table_+3A_footnote">footnote</code></td>
<td>
<p>a character vector. Optional parameter to pass a custom
footnote to the question, this parameter overwrites <code>use_questions</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function and its family (<a href="#topic+build_mtable">build_mtable</a>, <a href="#topic+build_qtable">build_qtable</a>) is designed to
work with data with columns of type <code>haven::labelled</code>,
which is the default format of data read with <code>haven::read_sav</code>/has the format
of <code>.sav</code>. <code>.sav</code> is the default file function type of data from <code>SPSS</code> and
can be exported from popular survey providers such as Qualtrics. When you
read in data with <code>haven::read_sav</code> it imports data with the questions,
labels for the response options etc.
</p>
<p>By default this function converts <a href="haven.html#topic+labelled">labelled</a> to a <a href="#topic+xlr_vector">xlr_vector</a>
by default (and underlying it is a <code>character()</code> type).
</p>
<p>See <a href="haven.html#topic+labelled">labelled</a> and <a href="haven.html#topic+read_sav">read_sav</a> if you would like more
details on the importing type.
</p>


<h3>Value</h3>

<p>a <code>xlr_table</code> object. Use <a href="#topic+write_xlsx">write_xlsx</a> to write to an <code>Excel</code> file.
See <a href="#topic+xlr_table">xlr_table</a> for more information.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)

# You can use this function to calculate the number count and percentage
# of a categorical variable
build_table(
  clothes_opinions,
  gender,
  table_title = "The count of the gender groups")

# You must use a `tidyselect` statement, to select the columns that you wish to
# calculate the count, and group percentage.
# This will calculate the number of observations in each group of age and
# gender.
# The percentage will be the percentage of each age_group in each gender
# group (the row percentage).
build_table(
  clothes_opinions,
  c(gender,age_group),
  table_title = "This is the second example table")

# You can use more complicated tidy select statements if you have a large number
# of columns, but this is probably not recommended
#
# Using use_questions, if you have labelled data, it will take the label and
# include it as a footnote.
# This is useful for when you have exported data from survey platforms
# as a .sav, use `haven::read_sav` to load it into your R environment.
build_table(
  clothes_opinions,
  c(group:gender,Q1_1),
  table_title = "This is the third example table",
  use_questions = TRUE)

# You can also use weights, these weights can be either doubles or integers
# based weights
# You can also set a footnote manually
build_table(
  clothes_opinions,
  age_group,
  table_title = "This is the fourth example table",
  wt = weight,
  footnote = paste0("This is a footnote, you can use it if you want",
                    "more detail in your table."))


</code></pre>

<hr>
<h2 id='clothes_opinions'>Clothes opinions data</h2><span id='topic+clothes_opinions'></span>

<h3>Description</h3>

<p>This is a fake data set used to show how to work with the xlr package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clothes_opinions
</code></pre>


<h3>Format</h3>



<h4><code>clothes_opinions</code></h4>

<p>A data frame with 1000 rows and 20 variables.
</p>

<dl>
<dt>weight</dt><dd><p>Fake survey weights</p>
</dd>
<dt>group</dt><dd><p>A grouping variable</p>
</dd>
<dt>gender</dt><dd><p>A character vector for gender</p>
</dd>
<dt>gender2</dt><dd><p>A haven labelled vector for gender</p>
</dd>
<dt>age</dt><dd><p>A continuous age variable</p>
</dd>
<dt>age_group</dt><dd><p>A character vector for grouped age, generated from <code>age</code></p>
</dd>
<dt>Q1_1</dt><dd><p>The first column in a question block asking whether pants are good to wear. Likert scale.</p>
</dd>
<dt>Q1_2</dt><dd><p>The second column in a question block asking whether shirts are good to wear. Likert scale.</p>
</dd>
<dt>Q1_3</dt><dd><p>The third column in a question block asking whether shoes are good to wear. Likert scale.</p>
</dd>
<dt>Q1_4</dt><dd><p>The forth column in a question block asking whether pants are good to wear. Likert scale.
This column is intentionally has no label.</p>
</dd>
<dt>Q2_1,2,3,4,5,6</dt><dd><p>Multiple response columns. Question asking what is your favourite colour to wear.</p>
</dd>
<dt>Q3_1,2,3</dt><dd><p>Multiple response columns. Question asking what is your favourite jewellery to wear.</p>
</dd>
<dt>Q3_other</dt><dd><p>The other column for question 3</p>
</dd>
</dl>



<hr>
<h2 id='create_table_of_contents'>Adds a table of contents to an .xlsx (<code>Excel</code>) file</h2><span id='topic+create_table_of_contents'></span>

<h3>Description</h3>

<p>This function adds a table of contents to an <code>Excel</code> file by reading the
information from the <code>Excel</code> sheet in, and then using that data to create
the table of contents. It guesses what the information is, see details below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_table_of_contents(
  file,
  title = NA_character_,
  overwrite = TRUE,
  pull_titles = TRUE,
  TOC_sheet_name = "Table of Contents"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_table_of_contents_+3A_file">file</code></td>
<td>
<p>the file name.</p>
</td></tr>
<tr><td><code id="create_table_of_contents_+3A_title">title</code></td>
<td>
<p>the title for the table.</p>
</td></tr>
<tr><td><code id="create_table_of_contents_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. When <code>TRUE</code> overwrite the file, if <code>FALSE</code> it will
not overwrite the file.</p>
</td></tr>
<tr><td><code id="create_table_of_contents_+3A_pull_titles">pull_titles</code></td>
<td>
<p>when <code>TRUE</code> take the titles from the <code>Excel</code> sheets, and add
them to the description in the TOC_sheet_name.</p>
</td></tr>
<tr><td><code id="create_table_of_contents_+3A_toc_sheet_name">TOC_sheet_name</code></td>
<td>
<p>string. the sheet name for the table of contents.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function uses the sheet names to create the table of contents. For the
titles it pulls the text that is the position A1 in each of the sheets. It
chooses this as this is the default location of titles when you write a
<a href="#topic+xlr_table">xlr_table</a> with <a href="#topic+write_xlsx">write_xlsx</a>.
</p>


<h3>Value</h3>

<p>Returns a logical or error if writing the file succeeded.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(xlr)
library(openxlsx)
table_list &lt;- list("Sheet name 1" = mtcars,
                   "Sheet name 2" = mtcars)

output_file &lt;- "example_file.xlsx"

# using write xlsx we create an `Excel` document
# You could use xlr::write_xlsx to create a table of
# contents automatically.
write.xlsx(table_list,
           output_file)

# Now add the table of contents to the existing file
create_table_of_contents(output_file,
                         "A workbook with example tables",
                         # it only makes sense to pull titles when
                         # the first cell has a text description
                         pull_titles = FALSE)

</code></pre>

<hr>
<h2 id='is_xlr_format'>Test if an object is a <code>xlr_format</code></h2><span id='topic+is_xlr_format'></span>

<h3>Description</h3>

<p>Test if an object is a <code>xlr_format</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_xlr_format(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_xlr_format_+3A_x">x</code></td>
<td>
<p>An object to test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Test if an object is a xlr_format
is_xlr_format(1)
bf &lt;- xlr_format(font_size = 14)
is_xlr_format(bf)
</code></pre>

<hr>
<h2 id='is_xlr_type'>Check if a variable is an xlr type
This function tests whether an R variable has a xlr type.</h2><span id='topic+is_xlr_type'></span>

<h3>Description</h3>

<p>Check if a variable is an xlr type
This function tests whether an R variable has a xlr type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_xlr_type(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is_xlr_type_+3A_x">x</code></td>
<td>
<p>a variable you wish to test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical.
</p>

<hr>
<h2 id='update_theme'>Update the <code>xlr_table</code> theme</h2><span id='topic+update_theme'></span>

<h3>Description</h3>

<p>This function allows you to update the underlying styling for your <a href="#topic+xlr_table">xlr_table</a>.
This changes how the titles, footnotes, columns, and body objects look when
you write you <code>xlr_table</code> to <code>Excel</code> with <code><a href="#topic+write_xlsx">write_xlsx()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_theme(
  x,
  title_format = xlr_format(font_size = 12, text_style = "bold"),
  footnote_format = xlr_format(font_size = 9, text_style = "italic"),
  column_heading_format = xlr_format(font_size = 11, text_style = "bold", border =
    c("top", "bottom"), halign = "center", wrap_text = TRUE),
  table_body_format = xlr_format(border = c("top", "left", "right", "bottom"))
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update_theme_+3A_x">x</code></td>
<td>
<p>a <code>xlr_table</code></p>
</td></tr>
<tr><td><code id="update_theme_+3A_title_format">title_format</code></td>
<td>
<p>a <code>xlr_format</code> object to format the title</p>
</td></tr>
<tr><td><code id="update_theme_+3A_footnote_format">footnote_format</code></td>
<td>
<p>a <code>xlr_format</code> object to format the footnote</p>
</td></tr>
<tr><td><code id="update_theme_+3A_column_heading_format">column_heading_format</code></td>
<td>
<p>a <code>xlr_format</code> object to format the column heading</p>
</td></tr>
<tr><td><code id="update_theme_+3A_table_body_format">table_body_format</code></td>
<td>
<p>a <code>xlr_format</code> object to format the body</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If you want to change the style of the <em>columns</em> in the data, you should convert them
to a <a href="#topic+xlr_vector">xlr_vector</a>, <a href="#topic+xlr_numeric">xlr_numeric</a>, <a href="#topic+xlr_integer">xlr_integer</a> or <a href="#topic+xlr_percent">xlr_percent</a> type if they are
not already, and then update the <a href="#topic+xlr_format">xlr_format</a> attribute, by setting
the <code>style</code> parameter.
</p>


<h3>Value</h3>

<p>Returns a <a href="#topic+xlr_table">xlr_table</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(xlr)
# set up a basic table
bt &lt;- xlr_table(mtcars,
                 "A title",
                 "A footnote")
# now we want to update the title
# This changes what it look likes when we print it to `Excel`
bt &lt;- update_theme(bt,
                   xlr_format(font_size = 12,
                               text_style = c("bold","underline")))
# To see the change you must write to an Excel file
write_xlsx(bt,
           "example.xlsx",
           "Test")


</code></pre>

<hr>
<h2 id='write_xlsx'>Write a <code>xlr_table</code>, <code>data.frame</code>, or <code>tibble</code> to an .xlsx (<code>Excel</code>) file</h2><span id='topic+write_xlsx'></span>

<h3>Description</h3>

<p>This function writes <code>xlr_table</code>, <code>data.frame</code>, or <code>tibble</code> to an .xlsx
(<code>Excel</code> file). Like <a href="openxlsx.html#topic+write.xlsx">write.xlsx</a> you can also write a <code>list</code> of
<code>xlr_table</code>'s, <code>data.frame</code>'s, and <code>tibbles</code>'s to the one file.
The main use of this function is that it uses the formatting in a <code>xlr_table</code>
when it writes to the <code>Excel</code> sheet. See <a href="#topic+xlr_table">xlr_table</a> for more information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_xlsx(
  x,
  file,
  sheet_name = NULL,
  overwrite = FALSE,
  append = TRUE,
  TOC = FALSE,
  TOC_title = NA_character_,
  overwrite_sheets = TRUE,
  excel_data_table = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_xlsx_+3A_x">x</code></td>
<td>
<p>a single or <code>list</code> of types <code>xlr_table</code>, <code>data.frame</code>, or <code>tibble</code>.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_file">file</code></td>
<td>
<p>character. A valid file path.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_sheet_name">sheet_name</code></td>
<td>
<p>a sheet name (optional). Only valid for when you pass a single
object to <code>x</code>.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_overwrite">overwrite</code></td>
<td>
<p>logical. Whether to overwrite the file/worksheet or not.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_append">append</code></td>
<td>
<p>logical. Whether or not to append a worksheet to an existing
file.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_toc">TOC</code></td>
<td>
<p>logical. Whether to create a table of contents with
the document. Works only when you pass a <code>list</code> to <code>x</code>. To add a table of
contents to an existing file, use <code><a href="#topic+create_table_of_contents">create_table_of_contents()</a></code>.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_toc_title">TOC_title</code></td>
<td>
<p>character. To specify the table of contents title (optional).</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_overwrite_sheets">overwrite_sheets</code></td>
<td>
<p>logical. Whether to overwrite existing sheets in a
file.</p>
</td></tr>
<tr><td><code id="write_xlsx_+3A_excel_data_table">excel_data_table</code></td>
<td>
<p>logical. Whether to save the data as an <code>Excel</code> table
in the worksheet. These are more accessible than data in the sheet.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(xlr)
library(tibble)
# we can write a data.frame or tibble with write_xlsx
example_tibble &lt;- tibble(example = c(1:100))

write_xlsx(mtcars,
           "example_file.xlsx",
           sheet_name = "Example sheet")

# you must specify a sheet name
write_xlsx(example_tibble,
           "example_file.xlsx",
           sheet_name = "Example sheet")

# You can write a xlr_table.
# When you write a xlr_table you can specify the formatting as well as titles
# and footnotes.
example_xlr_table &lt;- xlr_table(mtcars,
                                 "This is a title",
                                 "This is a footnote")

write_xlsx(example_xlr_table,
           "example_file.xlsx",
           "Example sheet")

# like openxlsx, you can also pass a list
table_list &lt;- list("Sheet name 1" = xlr_table(mtcars,
                                               "This is a title",
                                               "This is a footnote"),
                   "Sheet name 2" = xlr_table(mtcars,
                                              "This is a title too",
                                              "This is a footnote as well"))

write_xlsx(table_list,
           "example_file.xlsx")

</code></pre>

<hr>
<h2 id='xlr_and_dplyr'>xlr and dplyr</h2><span id='topic+xlr_and_dplyr'></span>

<h3>Description</h3>

<p><code>xlr_table()</code> is designed to work with dplyr verbs by default. This is so you
<code>mutate</code>, <code>summarise</code>, <code>arrange</code> etc. your data without losing your <code>xlr_table</code>
information. Particularly if you have used <code>build_table</code> first on your data,
which outputs data as a <code>xlr_table</code>.
</p>
<p>The list of currently supported dplyrs verbs are: <code>arrange</code>, <code>distinct</code>, <code>filter</code>,
<code>mutate</code>, <code>relocate</code>, <code>rename</code>, <code>rename_with</code>, <code>rowwise</code>, <code>select</code>, <code>slice</code>,
<code>slice_head</code>, <code>slice_max</code>, <code>slice_min</code>, <code>slice_sample</code>, <code>slice_tail</code>, <code>summarise</code>.
</p>

<hr>
<h2 id='xlr_format'>Specify formatting options for <code style="white-space: pre;">&#8288;xlr_*&#8288;</code> types</h2><span id='topic+xlr_format'></span><span id='topic+xlr_format_numeric'></span>

<h3>Description</h3>

<p>This function is a utility to work with <code>openxlxs</code>'s <a href="openxlsx.html#topic+createStyle">createStyle</a>, and work
with styles between them. <code><a href="#topic+xlr_format_numeric">xlr_format_numeric()</a></code> is an alias for <code><a href="#topic+xlr_format">xlr_format()</a></code> but with different
default values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_format(
  font_size = 11,
  font_colour = "black",
  font = "calibri",
  text_style = NULL,
  border = NULL,
  border_colour = "black",
  border_style = "thin",
  background_colour = NULL,
  halign = "left",
  valign = "top",
  wrap_text = FALSE,
  text_rotation = 0L,
  indent = 0L
)

xlr_format_numeric(
  font_size = 11,
  font_colour = "black",
  font = "calibri",
  text_style = NULL,
  border = NULL,
  border_colour = "black",
  border_style = "thin",
  background_colour = NULL,
  halign = "right",
  valign = "bottom",
  wrap_text = FALSE,
  text_rotation = 0L,
  indent = 0L
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_format_+3A_font_size">font_size</code></td>
<td>
<p>A numeric. The font size, must be greater than 0.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_font_colour">font_colour</code></td>
<td>
<p>String. The colour of text in the cell. Must be one of <code>colours()</code>
or a valid hex colour beginning with <code>"#"</code>.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_font">font</code></td>
<td>
<p>String. The name of a font. This is not validated.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_text_style">text_style</code></td>
<td>
<p>the text styling. You can pass a vector of text
decorations or a single string. The options for text style are <code>"bold"</code>, <code>"strikeout"</code>,
<code>"italic"</code>, <code>"underline"</code>,<code>"underline2"</code> (double underline), <code>"accounting"</code> (accounting
underline), <code>"accounting2"</code> (double accounting underline). See Details.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_border">border</code></td>
<td>
<p>the cell border. You can pass a vector of <code>"top"</code>, <code>"bottom"</code>, <code>"left"</code>,
<code>"right"</code> or a single string to set the borders that you want.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_border_colour">border_colour</code></td>
<td>
<p>Character. The colour of border. Must be the same length as the number of
sides specified in <code>border</code>. Each element must be one of <code>colours()</code>
or a valid hex colour beginning with <code>"#"</code>.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_border_style">border_style</code></td>
<td>
<p>Border line style vector the same length as the number of
sides specified in <code>border</code>. The list of styles are <code>"none"</code>, <code>"thin"</code>, <code>"medium"</code>,
<code>"dashed"</code>, <code>"dotted"</code>, <code>"thick"</code>, <code>"double"</code>, <code>"hair"</code>, &quot;<code style="white-space: pre;">&#8288;mediumDashed"&#8288;</code>, <code>"dashDot"</code>,
<code>"mediumDashDot"</code>, <code>"dashDotDot"</code>, <code>"mediumDashDot"</code>, <code>"dastDotDot"</code>, <code>"mediumDashDotDot"</code>,
<code>"slantDashDosh"</code>. See <a href="openxlsx.html#topic+createStyle">createStyle</a> for more details.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_background_colour">background_colour</code></td>
<td>
<p>Character. Set the background colour for the cell. Must be one of
<code>colours()</code> or a valid hex colour beginning with <code>"#"</code>.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_halign">halign</code></td>
<td>
<p>the horizontal alignment of cell contents. Must be either
<code>"left"</code>, <code>"right"</code>, <code>"center"</code> or &quot;<code style="white-space: pre;">&#8288;justify"&#8288;</code>.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_valign">valign</code></td>
<td>
<p>the vertical alignment of cell contents. Must be either
<code>"top"</code>, <code>"center"</code>, or <code>"bottom"</code>.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_wrap_text">wrap_text</code></td>
<td>
<p>Logical. If <code>TRUE</code> cell contents will rap to fit in the column.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_text_rotation">text_rotation</code></td>
<td>
<p>Integer. Rotation of text in degrees. Must be an integer between -90 and
90.</p>
</td></tr>
<tr><td><code id="xlr_format_+3A_indent">indent</code></td>
<td>
<p>Integer. The number of indent positions, must be an integer between 0 and 250.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Text styling</h4>

<p>For text styling you can pass either one of the options or options in a
vector. For example if you would like to have text that is <strong>bold</strong> and
<em>italised</em> then set:
</p>
<div class="sourceCode r"><pre>fmt &lt;- xlr_format(text_style = c("bold", "italic"))
</pre></div>
<p>If you would like to the text to be only <strong>bold</strong> then:
</p>
<div class="sourceCode r"><pre>fmt &lt;- xlr_format(text_style = "bold")
</pre></div>



<h4>Border styling</h4>

<p>The three arguments to create border styling are <code>border</code>, <code>border_colour</code>,
and <code>border_style</code>. They each take either a vector, where you specify to
change what borders to have in each cell and what they look like. To specify
that you want a border around a cell, use <code>border</code>, you need to pass a vector
of what sides you want to have a border (or a single element if it's only one
side). For example:
</p>

<ul>
<li> <p><code>"top"</code> the top border
</p>
</li>
<li> <p><code>"left"</code> the left border
</p>
</li>
<li> <p><code>c("bottom", "right")</code> the top and bottom border
</p>
</li>
<li> <p><code>c("left", "right", "bottom")</code> the left, right and bottom borders
</p>
</li>
<li> <p><code>c("top","right","bottom","left")</code> the borders for all sides of the cells
</p>
</li></ul>

<p>Based on this you can use <code>border_colour</code> to set the border colours. If you
want all the same border colour, just pass a character representing the colour
you want (e.g. set <code>border_colour = "blue"</code> if you'd like all borders to be
blue). Alternatively you can pass a vector the same length as the vector
that you passed to <code>border</code>, with the location specifying the colour. For example,
if you set:
</p>
<div class="sourceCode r"><pre>fmt &lt;- xlr_format(border = c("left", "top"),
                    border_colour = c("blue","red"))
</pre></div>
<p>the top border will be red, and the left border will be blue. You set the pattern
in the same way for <code>border_style</code>. Alternatively if you only wanted it to
be dashed with default colours. You'd set:
</p>
<div class="sourceCode r"><pre>fmt &lt;- xlr_format(border = c("left", "top"),
                  border_style = "dashed")
</pre></div>



<h3>Value</h3>

<p>a <code>xlr_format</code> S3 class.
</p>


<h3>See Also</h3>


<ul>
<li> <p><code><a href="#topic+is_xlr_format">is_xlr_format()</a></code> to test if an R object is a <code>xlr_format</code>
</p>
</li>
<li> <p><code><a href="#topic+xlr_table">xlr_table()</a></code> to use xlr formats
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
# You can initialise a xlr_format, it comes with a list of defaults
bf &lt;- xlr_format()
# It outputs what the style looks like
bf
# You can update the format by defining a new format
bf &lt;- xlr_format(font_size = 11,
                  # not that font is not validated
                  font = "helvetica")
# The main use of xlr_format is to change the format of a vector of
# a xlr type
bd &lt;- xlr_numeric(1:200,
                  dp = 1,
                  style = bf)
# You can also use it to change the styles of an xlr_table, this only
# affect the format in `Excel`
bt &lt;- xlr_table(mtcars, "A clever title", "A useful footnote")
bt &lt;- bt |&gt;
      update_theme(footnote_format = xlr_format(font_size = 7))
</code></pre>

<hr>
<h2 id='xlr_integer'><code>xlr_integer</code> vector</h2><span id='topic+xlr_integer'></span><span id='topic+is_xlr_integer'></span><span id='topic+as_xlr_integer'></span>

<h3>Description</h3>

<p>This creates an integer vector that will be printed neatly and can easily be
exported to <code>Excel</code> using it's native format.You can
convert a vector back to its base type with <code><a href="#topic+as_base_r">as_base_r()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_integer(x = integer(), style = xlr_format_numeric())

is_xlr_integer(x)

as_xlr_integer(x, style = xlr_format_numeric())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_integer_+3A_x">x</code></td>
<td>
<p>A numeric vector
</p>

<ul>
<li><p> For <code>xlr_integer()</code>: A numeric vector
</p>
</li>
<li><p> For <code>is_xlr_integer()</code>: An object to test
</p>
</li>
<li><p> For <code>as_xlr_integer()</code> : a vector
</p>
</li></ul>
</td></tr>
<tr><td><code id="xlr_integer_+3A_style">style</code></td>
<td>
<p>Additional styling options for the vector. See <a href="#topic+xlr_format_numeric">xlr_format_numeric</a> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, <code>xlr_integer</code> uses <code>vec_cast</code> to convert numeric types
to integers. Anything that <code>vec_cast</code> can handle so can <code>xlr_integer</code>. Read
more about casting at <a href="vctrs.html#topic+vec_cast">vec_cast</a>.
</p>


<h3>Value</h3>

<p>An S3 vector of class <code>xlr_integer</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlr_vector">xlr_vector()</a></code>, <code><a href="#topic+xlr_percent">xlr_percent()</a></code>, <code><a href="#topic+xlr_numeric">xlr_numeric()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
# Create a variable to represent an integer
x &lt;- xlr_integer(2)
# This will print nicely
x
# You can change the styling, which affects how it looks when we save it as an
# `Excel` document
x &lt;- xlr_integer(x, style = xlr_format(font_size = 9, font_colour = "red"))
x
# We can also define a vector of integers
y &lt;- xlr_integer(c(1,2,3))
y
# You can convert existing data to a integer using dplyr verbs
# It formats large numbers nicely
df &lt;- data.frame(col_1 = c(1:100*100))
df |&gt;
  dplyr::mutate(col_pct = as_xlr_integer(col_1))
# You can use as_xlr_integer to convert a string in a integer
df &lt;- data.frame(col_str = c("12","13","14"))
# now we can convert the string to a integer(), internally it uses the same
# logic as as.integer()
df |&gt;
  dplyr::mutate(col_percent = as_xlr_integer(col_str))
</code></pre>

<hr>
<h2 id='xlr_numeric'><code>xlr_numeric</code> vector</h2><span id='topic+xlr_numeric'></span><span id='topic+is_xlr_numeric'></span><span id='topic+as_xlr_numeric'></span>

<h3>Description</h3>

<p>This creates an numeric vector that will be printed neatly and can easily be
exported to <code>Excel</code> using it's native format. You can
convert a vector back to its base type with <code><a href="#topic+as_base_r">as_base_r()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_numeric(
  x = numeric(),
  dp = 2L,
  scientific = FALSE,
  style = xlr_format_numeric()
)

is_xlr_numeric(x)

as_xlr_numeric(x, dp = 0L, scientific = FALSE, style = xlr_format_numeric())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_numeric_+3A_x">x</code></td>
<td>

<ul>
<li><p> For <code>xlr_numeric()</code>: A numeric vector
</p>
</li>
<li><p> For <code>is_xlr_numeric()</code>: An object to test
</p>
</li>
<li><p> For <code>as_xlr_numeric()</code> : a vector
</p>
</li></ul>
</td></tr>
<tr><td><code id="xlr_numeric_+3A_dp">dp</code></td>
<td>
<p>the number of decimal places to print</p>
</td></tr>
<tr><td><code id="xlr_numeric_+3A_scientific">scientific</code></td>
<td>
<p>logical. Whether to format the numeric using scientific notation.</p>
</td></tr>
<tr><td><code id="xlr_numeric_+3A_style">style</code></td>
<td>
<p>Additional styling options for the vector. See <a href="#topic+xlr_format_numeric">xlr_format_numeric</a> for more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Internally, <code>xlr_numeric</code> uses <code>vec_cast</code> to convert numeric types
to integers. Anything that <code>vec_cast</code> can handle so can <code>xlr_numeric</code>. Read
more about casting at <a href="vctrs.html#topic+vec_cast">vec_cast</a>.
</p>


<h3>Value</h3>

<p>An S3 vector of class <code>xlr_numeric</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlr_percent">xlr_percent()</a></code>, <code><a href="#topic+xlr_integer">xlr_integer()</a></code>, <code><a href="#topic+xlr_vector">xlr_vector()</a></code>, <code><a href="#topic+as_base_r">as_base_r()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
# Create a variable to represent a double with two decimal places
# The decimal places must be a positive integer
x &lt;- xlr_numeric(2.1134,dp = 2)
# This will print nicely
x
# You can change the styling, which affects how it looks when we print it
x &lt;- xlr_numeric(x, dp = 3L, style = xlr_format(font_size = 9, font_colour = "red"))
x
# We can also define a vector of doubles
y &lt;- xlr_numeric(c(22.1055,1.3333333,3.1234567), dp = 2)
y
# You can convert existing data to a double using dplyr verbs
df &lt;- data.frame(col_1 = c(2,3.2,1.33,4.43251))
df |&gt;
  dplyr::mutate(col_pct = as_xlr_numeric(col_1))
# You can use as_xlr_numeric to convert a string in a double
df &lt;- data.frame(col_str = c("12.22","12.34567","100"))
# now we can convert the string to a double(), internally it uses the same
# logic as as.double()
df |&gt;
  dplyr::mutate(col_double = as_xlr_numeric(col_str,2))
</code></pre>

<hr>
<h2 id='xlr_percent'><code>xlr_percent</code> vector</h2><span id='topic+xlr_percent'></span><span id='topic+is_xlr_percent'></span><span id='topic+as_xlr_percent'></span>

<h3>Description</h3>

<p>This creates a numeric vector that will be printed as a percentage and
exported to <code>Excel</code> using it's native format.You can convert a vector back to
its base type with <code><a href="#topic+as_base_r">as_base_r()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_percent(x = double(), dp = 0L, style = xlr_format_numeric())

is_xlr_percent(x)

as_xlr_percent(x, dp = 0L, style = xlr_format_numeric())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_percent_+3A_x">x</code></td>
<td>

<ul>
<li><p> For <code>xlr_percent()</code>: A numeric vector
</p>
</li>
<li><p> For <code>is_xlr_percent()</code>: An object to test
</p>
</li>
<li><p> For <code>as_xlr_percent()</code> : a numeric or character vector. For a character
vector, the data must be in the format <code>"XXX.YYY...%"</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="xlr_percent_+3A_dp">dp</code></td>
<td>
<p>the number of decimal places to print</p>
</td></tr>
<tr><td><code id="xlr_percent_+3A_style">style</code></td>
<td>
<p>Additional styling options for the vector. See <a href="#topic+xlr_format_numeric">xlr_format_numeric</a> for more details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An S3 vector of class <code>xlr_percent</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlr_vector">xlr_vector()</a></code>, <code><a href="#topic+xlr_integer">xlr_integer()</a></code>, <code><a href="#topic+xlr_numeric">xlr_numeric()</a></code>, <code><a href="#topic+as_base_r">as_base_r()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
# lets define a xlr_percent, a xlr_percent is between a number between [0-1], not
# between 1-100
#
# Create a variable to represent 10%
x &lt;- xlr_percent(0.1)
# This will print nicely
x
# Now we can increase the number of decimal places to display
# The decimal places must be a positive integer
x &lt;- xlr_percent(x, dp = 3L)
x
# We can also define a vector of xlr_percents
y &lt;- xlr_percent(c(0.1055,0.3333333,0.1234567), dp = 2)
y
# You can convert existing data to a xlr_percentage using dplyr verbs
df &lt;- data.frame(col_1 = c(0,0.2,0.33,0.43251))
df |&gt;
  dplyr::mutate(col_pct = as_xlr_percent(col_1))
# You can also change the styling of a xlr_percent column, this is only relevant
# if you print it to `Excel` with write_xlsx
df |&gt;
  dplyr::mutate(col_pct = xlr_percent(col_1,
                                  dp = 2,
                                  style = xlr_format(font_size = 8)))
# You can use as_xlr_percent to convert a string in a xlr_percentage format to a
# xlr_percent
df &lt;- data.frame(col_str = c("12.22%","12.34567%","100%"))
# now we can convert the string to a xlr_xlr_percent()
df |&gt;
  dplyr::mutate(col_xlr_percent = as_xlr_percent(col_str,2))
</code></pre>

<hr>
<h2 id='xlr_table'><code>xlr_table</code> object</h2><span id='topic+xlr_table'></span><span id='topic+is_xlr_table'></span><span id='topic+as_xlr_table'></span>

<h3>Description</h3>

<p>Create a <code>xlr_table</code> S3 object. This is used to create an object that stores
formatting information, as well as a title and footnote. This objects makes it
easy to convert to an <code>Excel</code> sheet, using <code><a href="#topic+write_xlsx">write_xlsx()</a></code>.
To edit underlying formatting options use <code><a href="#topic+update_theme">update_theme()</a></code>.
</p>
<p>A number of <code>dplyr</code> methods have been implemented for <code>xlr_table</code>, these
include <code>mutate</code>, <code>summarise</code>, <code>select</code>, etc. This means you can use these
functions on a <code>xlr_table</code>, without losing the <code>xlr_table</code> attributes. You
can check if the <code>dplyr</code> function is supported by checking the documentation
of the function. Currently, it is not possible to use <code>group_by</code> and a <code>xlr_table</code>,
as this would require the implementation of a new class.
</p>
<p>You can convert a table back to a data.frame with base type with <code><a href="#topic+as_base_r">as_base_r()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_table(x, title = character(), footnote = character())

is_xlr_table(x)

as_xlr_table(x, title = character(), footnote = character())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_table_+3A_x">x</code></td>
<td>
<p>a data object
</p>

<ul>
<li><p> for <code>xlr_table()</code> : a <code>data.frame</code>, or <code>tibble</code>. See notes for further details.
</p>
</li>
<li><p> for <code>is_xlr_table()</code> : An object
</p>
</li>
<li><p> for <code>as_xlr_table()</code> a <code>data.frame</code>, or <code>tibble</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="xlr_table_+3A_title">title</code></td>
<td>
<p>a string that is the title</p>
</td></tr>
<tr><td><code id="xlr_table_+3A_footnote">footnote</code></td>
<td>
<p>a string that is the footnote</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>xlr_table</code> S3 class
</p>


<h3>See Also</h3>

<p><code><a href="#topic+update_theme">update_theme()</a></code>, <code><a href="#topic+as_base_r">as_base_r()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

library(xlr)
library(dplyr)
# Create a xlr_table, we set the footnotes and the title
# It converts to the xlr types by default
x &lt;- xlr_table(mtcars,
                title = "mtcars is a fun data set",
                footnote = "mtcars is a data set that comes with base R")
# The title and the footnote print to console
x
# You can use mutate and summarise with xlr_tables and they are preserved
x |&gt;
  summarise(mean_mpg = sum(mpg))
# Rename a column
x |&gt;
  rename(new_name = mpg)
# When you want to change how elements of the table look when written using
# write_xlsx, you can update it with update them
x &lt;- x |&gt;
  # make the font bigger
  update_theme(title_format = xlr_format(font_size = 14))
# you must write it in order to see the formatting changes
write_xlsx(x,
             "example.xlsx",
             "A example sheet",
             TOC = FALSE)


</code></pre>

<hr>
<h2 id='xlr_vector'><code>xlr_vector</code> vector</h2><span id='topic+xlr_vector'></span><span id='topic+is_xlr_vector'></span><span id='topic+as_xlr_vector'></span>

<h3>Description</h3>

<p>A general container for including additional styling options within a vector
so that it can easily be exported to <code>Excel</code>. This vector type should be used
for characters, factors, Booleans, complex numbers, etc. It does
not support dates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlr_vector(x = vector(), excel_format = "GENERAL", style = xlr_format())

is_xlr_vector(x)

as_xlr_vector(x, excel_format = "GENERAL", style = xlr_format())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xlr_vector_+3A_x">x</code></td>
<td>
<p>A vector
</p>

<ul>
<li><p> For <code>xlr_vector()</code>: A vector
</p>
</li>
<li><p> For <code>is_xlr_vector()</code>: An object to test
</p>
</li>
<li><p> For <code>as_xlr_vector()</code> : a vector
</p>
</li></ul>
</td></tr>
<tr><td><code id="xlr_vector_+3A_excel_format">excel_format</code></td>
<td>
<p>a character, the <code>Excel</code> cell format, not validated. See
<a href="openxlsx.html#topic+createStyle">createStyle</a> argument numFmt for more details on what
you can specify.</p>
</td></tr>
<tr><td><code id="xlr_vector_+3A_style">style</code></td>
<td>
<p>Additional styling options for the vector. See <a href="#topic+xlr_format">xlr_format</a> for
more details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While you can use it with <code>integer</code>, and <code>double</code> types and specifying the
associated <code>Excel</code> format, we recommend using <a href="#topic+xlr_integer">xlr_integer</a>, <a href="#topic+xlr_numeric">xlr_numeric</a>,
or <a href="#topic+xlr_percent">xlr_percent</a> types instead.
</p>
<p>You can convert a vector back to its base type with <code><a href="#topic+as_base_r">as_base_r()</a></code>.
</p>


<h3>Value</h3>

<p>An S3 vector of class <code>xlr_vector</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+xlr_percent">xlr_percent()</a></code>, <code><a href="#topic+xlr_integer">xlr_integer()</a></code>, <code><a href="#topic+xlr_numeric">xlr_numeric()</a></code>, <code><a href="#topic+as_base_r">as_base_r()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(xlr)
# Create a xlr_vector object, this is used so we can add styling to an existing
# vector so that it prints nicely in `Excel`
#
# Note currently the style will not change the style in the console
x &lt;- xlr_vector(1:100,
                 excel_format = "00.0##",
                 style = xlr_format(font_size = 8))

# You can also use it so that dates are nicely printed in `Excel`
dates &lt;- c("02/27/92", "02/27/92", "01/14/92", "02/28/92", "02/01/92")
dates &lt;- as.Date(dates, "%m/%d/%y")
x &lt;- xlr_vector(dates,
                 # Print it as a long date in `Excel`
                 excel_format = "LONGDATE")
# You can convert existing data to a xlr_vectors using dplyr verbs
iris |&gt;
  dplyr::mutate(iris_format = as_xlr_vector(Species,
                                             "TEXT",
                                             xlr_format(text_style = "italic")))
</code></pre>

<hr>
<h2 id='xlr-vctrs'>Internal vctrs methods</h2><span id='topic+xlr-vctrs'></span>

<h3>Description</h3>

<p>Internal vctrs methods
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
