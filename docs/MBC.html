<!DOCTYPE html><html lang="en"><head><title>Help for package MBC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MBC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MBC-package'>
<p>Multivariate Bias Correction of Climate Model Outputs</p></a></li>
<li><a href='#cccma'>
<p>Sample CanESM2 and CanRCM4 data</p></a></li>
<li><a href='#escore'>
<p>Energy distance score</p></a></li>
<li><a href='#MBCn'>
<p>Multivariate bias correction (N-pdft)</p></a></li>
<li><a href='#MBCp'>
<p>Multivariate bias correction (Pearson correlation)</p></a></li>
<li><a href='#MBCr'>
<p>Multivariate bias correction (Spearman rank correlation)</p></a></li>
<li><a href='#MRS'>
<p>Multivariate linear rescaling using Cholesky decomposition</p></a></li>
<li><a href='#QDM'>
<p>Univariate bias correction via quantile delta mapping</p></a></li>
<li><a href='#R2D2'>
<p>Multivariate bias correction (R2D2)</p></a></li>
<li><a href='#rot.random'>
<p>Random orthogonal rotation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.10-7</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Bias Correction of Climate Model Outputs</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alex J. Cannon &lt;alex.cannon@canada.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calibrate and apply multivariate bias correction algorithms
    for climate model simulations of multiple climate variables. Three methods
    described by Cannon (2016) &lt;<a href="https://doi.org/10.1175%2FJCLI-D-15-0679.1">doi:10.1175/JCLI-D-15-0679.1</a>&gt; and 
    Cannon (2018) &lt;<a href="https://doi.org/10.1007%2Fs00382-017-3580-6">doi:10.1007/s00382-017-3580-6</a>&gt; are implemented —
    (i) MBC Pearson correlation (MBCp), (ii) MBC rank correlation (MBCr),
    and (iii) MBC N-dimensional PDF transform (MBCn) — as is the Rank
    Resampling for Distributions and Dependences (R2D2) method.</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-11-12</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), Matrix, energy, FNN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Alex J. Cannon <a href="https://orcid.org/0000-0002-8025-3790"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-12 18:01:00 UTC; rac001</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-12 19:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='MBC-package'>
Multivariate Bias Correction of Climate Model Outputs
</h2><span id='topic+MBC-package'></span><span id='topic+MBC'></span>

<h3>Description</h3>

<p>Calibrate and apply multivariate bias correction algorithms for climate model
simulations of multiple climate variables. Three iterative methods are
supported: (i) MBC Pearson correlation (MBCp), (ii) MBC rank correlation (MBCr),
and (iii) MBC N-dimensional probability density function transform (MBCn). 
</p>
<p>The first two, MBCp and MBCr (Cannon, 2016), match marginal distributions
and inter-variable dependence structure. Dependence structure can be measured
either by the Pearson correlation (<code><a href="#topic+MBCp">MBCp</a></code>) or by the Spearman rank
correlation (<code><a href="#topic+MBCr">MBCr</a></code>). The energy distance score
(<code><a href="#topic+escore">escore</a></code>) is recommended for model selection.
</p>
<p>The third, <code><a href="#topic+MBCn">MBCn</a></code> (Cannon, 2018), which operates on the full
multivariate distribution, is more flexible and can be considered to be a
multivariate analogue of univariate quantile mapping. All aspects of the
observed distribution are transferred to the climate model simulations.
</p>
<p>In each of the three methods, marginal distributions are corrected by the
change-preserving quantile delta mapping (<code><a href="#topic+QDM">QDM</a></code>) algorithm
(Cannon et al., 2015). Finally, an implementation of the Rank Resampling for
Distributions and Dependences (R2D2) method introduced by Vrac (2018) is also
included.
</p>
<p>An example application of the three MBC methods using the <code>cccma</code> dataset
can be run via:
</p>
<p><code>example(MBC, run.dontrun=TRUE)</code>
</p>
<p>Note: these functions apply bias correction to the supplied data without
reference to other conditioning variables (e.g., time of year or season). The
user must partition their data in a way that makes sense for a particular
application. Furthermore, if <code><a href="#topic+MBCn">MBCn</a></code> is being applied to multiple
spatial locations or grid cells, it is recommended that the same sequence of
random rotations be used for each location. This can be achived by generating
the random rotations first and then passing the sequence using the
<code>rot.seq</code> argument:
</p>
<p><code>rot.seq &lt;- replicate(niterations, list(rot.random(nvars)))</code>
</p>
<p><code>bias_correction &lt;- MBCn(..., rot.seq=rot.seq)</code>
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> MBC</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>References</h3>

<p>Cannon, A.J., 2018. Multivariate quantile mapping bias correction: An 
N-dimensional probability density function transform for climate model
simulations of multiple variables. Climate Dynamics, 50(1-2):31-49.
doi:10.1007/s00382-017-3580-6
</p>
<p>Cannon, A.J., 2016. Multivariate bias correction of climate model output:
Matching marginal distributions and inter-variable dependence structure.
Journal of Climate, 29:7045-7064. doi:10.1175/JCLI-D-15-0679.1
</p>
<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>
<p>Francois, B., M. Vrac, A.J. Cannon, Y. Robin, and D. Allard, 2020.
Multivariate bias corrections of climate simulations: Which benefits
for which losses? Earth System Dynamics, 11:537-562.
doi:10.5194/esd-11-537-2020
</p>
<p>Vrac, M., 2018. Multivariate bias adjustment of high-dimensional
climate simulations: the Rank Resampling for Distributions and
Dependences (R2D2) bias correction. Hydrology and Earth System
Sciences, 22:3175-3196. doi:10.5194/hess-22-3175-2018
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QDM">QDM</a>, <a href="#topic+MBCp">MBCp</a>, <a href="#topic+MBCr">MBCr</a>, <a href="#topic+MBCn">MBCn</a>, <a href="#topic+R2D2">R2D2</a>, <a href="#topic+escore">escore</a>, <a href="#topic+rot.random">rot.random</a>, <a href="#topic+cccma">cccma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(cccma)
set.seed(1)

# Univariate quantile mapping
qdm.c &lt;- cccma$gcm.c*0
qdm.p &lt;- cccma$gcm.p*0
for(i in seq(ncol(cccma$gcm.c))){
    fit.qdm &lt;- QDM(o.c=cccma$rcm.c[,i], m.c=cccma$gcm.c[,i],
                   m.p=cccma$gcm.p[,i], ratio=cccma$ratio.seq[i],
                   trace=cccma$trace[i])
    qdm.c[,i] &lt;- fit.qdm$mhat.c
    qdm.p[,i] &lt;- fit.qdm$mhat.p
}

# Multivariate MBCp bias correction
fit.mbcp &lt;- MBCp(o.c=cccma$rcm.c, m.c=cccma$gcm.c,
                 m.p=cccma$gcm.p, ratio.seq=cccma$ratio.seq,
                 trace=cccma$trace)
mbcp.c &lt;- fit.mbcp$mhat.c
mbcp.p &lt;- fit.mbcp$mhat.p

# Multivariate MBCr bias correction
fit.mbcr &lt;- MBCr(o.c=cccma$rcm.c, m.c=cccma$gcm.c,
                 m.p=cccma$gcm.p, ratio.seq=cccma$ratio.seq,
                 trace=cccma$trace)
mbcr.c &lt;- fit.mbcr$mhat.c
mbcr.p &lt;- fit.mbcr$mhat.p

# Multivariate MBCn bias correction
fit.mbcn &lt;- MBCn(o.c=cccma$rcm.c, m.c=cccma$gcm.c,
                 m.p=cccma$gcm.p, ratio.seq=cccma$ratio.seq,
                 trace=cccma$trace)
mbcn.c &lt;- fit.mbcn$mhat.c
mbcn.p &lt;- fit.mbcn$mhat.p
colnames(mbcn.c) &lt;- colnames(mbcn.p) &lt;-
    colnames(cccma$rcm.c)

# Correlation matrices (Pearson and Spearman)
# MBCp
dev.new()
par(mfrow=c(2, 2))
plot(c(cor(cccma$rcm.c)), c(cor(qdm.c)), col='black',
     pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCp',
     main='Pearson correlation\nMBCp calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c)), c(cor(mbcp.c)), col='red')
plot(c(cor(cccma$rcm.p)), c(cor(qdm.p)),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCp',
     main='Pearson correlation\nMBCp evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p)), c(cor(mbcp.p)), col='red')
plot(c(cor(cccma$rcm.c, m='s')), c(cor(qdm.c, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCp',
     main='Spearman correlation\nMBCp calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c, m='s')), c(cor(mbcp.c, m='s')),
       col='red')
plot(c(cor(cccma$rcm.p, m='s')), c(cor(qdm.p, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCp',
     main='Spearman correlation\nMBCp evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p, m='s')), c(cor(mbcp.p, m='s')),
       col='red')

# MBCr
dev.new()
par(mfrow=c(2, 2))
plot(c(cor(cccma$rcm.c)), c(cor(qdm.c)), col='black',
     pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCr',
     main='Pearson correlation\nMBCr calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c)), c(cor(mbcr.c)), col='blue')
plot(c(cor(cccma$rcm.p)), c(cor(qdm.p)),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCr',
     main='Pearson correlation\nMBCr evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p)), c(cor(mbcr.p)), col='blue')
plot(c(cor(cccma$rcm.c, m='s')), c(cor(qdm.c, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCr',
     main='Spearman correlation\nMBCr calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c, m='s')), c(cor(mbcr.c, m='s')),
       col='blue')
plot(c(cor(cccma$rcm.p, m='s')), c(cor(qdm.p, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCr',
     main='Spearman correlation\nMBCr evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p, m='s')), c(cor(mbcr.p, m='s')),
       col='blue')

# MBCn
dev.new()
par(mfrow=c(2, 2))
plot(c(cor(cccma$rcm.c)), c(cor(qdm.c)), col='black',
     pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCn',
     main='Pearson correlation\nMBCn calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c)), c(cor(mbcn.c)), col='orange')
plot(c(cor(cccma$rcm.p)), c(cor(qdm.p)),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCn',
     main='Pearson correlation\nMBCn evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p)), c(cor(mbcn.p)), col='orange')
plot(c(cor(cccma$rcm.c, m='s')), c(cor(qdm.c, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCn',
     main='Spearman correlation\nMBCn calibration')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.c, m='s')), c(cor(mbcn.c, m='s')),
       col='orange')
plot(c(cor(cccma$rcm.p, m='s')), c(cor(qdm.p, m='s')),
     col='black', pch=19, xlim=c(-1, 1), ylim=c(-1, 1),
     xlab='CanRCM4', ylab='CanESM2 MBCn',
     main='Spearman correlation\nMBCn evaluation')
abline(0, 1)
grid()
points(c(cor(cccma$rcm.p, m='s')), c(cor(mbcn.p, m='s')),
       col='orange')

# Pairwise scatterplots
dev.new()
pairs(cccma$gcm.c, main='CanESM2 calibration', col='#0000001A')
dev.new()
pairs(cccma$rcm.c, main='CanRCM4 calibration', col='#0000001A')
dev.new()
pairs(qdm.c, main='QDM calibration', col='#0000001A')
dev.new()
pairs(mbcp.c, main='MBCp calibration', col='#FF00001A')
dev.new()
pairs(mbcr.c, main='MBCr calibration', col='#0000FF1A')
dev.new()
pairs(mbcn.c, main='MBCn calibration', col='#FFA5001A')

# Energy distance skill score relative to univariate QDM
escore.qdm &lt;- escore(cccma$rcm.p, qdm.p, scale.x=TRUE)
escore.mbcp &lt;- escore(cccma$rcm.p, mbcp.p, scale.x=TRUE)
escore.mbcr &lt;- escore(cccma$rcm.p, mbcr.p, scale.x=TRUE)
escore.mbcn &lt;- escore(cccma$rcm.p, mbcn.p, scale.x=TRUE)

cat('ESS (MBCp):', 1-escore.mbcp/escore.qdm, '\n')
cat('ESS (MBCr):', 1-escore.mbcr/escore.qdm, '\n')
cat('ESS (MBCn):', 1-escore.mbcn/escore.qdm, '\n')

## End(Not run)
</code></pre>

<hr>
<h2 id='cccma'>
Sample CanESM2 and CanRCM4 data
</h2><span id='topic+cccma'></span>

<h3>Description</h3>

<p>Sample CanESM2 (T63 grid) and CanRCM4 (0.22-deg grid) data
(122.5 deg W, 50 deg N).
</p>
<pre>pr: precipitation (mm day-1) 
tas: average surface temperature (deg. C)
dtr: diurnal temperature range (deg. C)
sfcWind: surface wind speed (m s-1)
ps: surface pressure (ps)
huss: surface specific humidity (kg kg-1)
rsds: surface downwelling shortwave radiation (W m-2)
rlds: surface downwelling longwave radiation (W m-2)</pre>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>gcm.c</code></td>
<td>
<p>matrix of CanESM2 variables for the calibration period.</p>
</td></tr>
<tr><td><code>gcm.p</code></td>
<td>
<p>matrix of CanESM2 variables for the validation period.</p>
</td></tr>
<tr><td><code>rcm.c</code></td>
<td>
<p>matrix of CanRCM4 variables for the calibration period.</p>
</td></tr>
<tr><td><code>rcm.p</code></td>
<td>
<p>matrix of CanRCM4 variables for the validation period.</p>
</td></tr>
<tr><td><code>ratio.seq</code></td>
<td>
<p>vector of logical values indicating if samples are of a ratio quantity.</p>
</td></tr>
<tr><td><code>trace</code></td>
<td>
<p>numeric values indicating trace thresholds for each ratio quantity.</p>
</td></tr>
</table>

<hr>
<h2 id='escore'>
Energy distance score
</h2><span id='topic+escore'></span>

<h3>Description</h3>

<p>Calculate the energy distance score measuring the statistical
discrepancy between samples <code>x</code> and <code>y</code> from two multivariate
distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>escore(x, y, scale.x=FALSE, n.cases=NULL, alpha=1, method='cluster')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="escore_+3A_x">x</code></td>
<td>

<p>numeric matrix.
</p>
</td></tr>
<tr><td><code id="escore_+3A_y">y</code></td>
<td>

<p>numeric matrix.
</p>
</td></tr>
<tr><td><code id="escore_+3A_scale.x">scale.x</code></td>
<td>

<p>logical indicating whether data should be standardized based on <code>x</code>.
</p>
</td></tr>
<tr><td><code id="escore_+3A_n.cases">n.cases</code></td>
<td>

<p>the number of sub-sampled cases; <code>NULL</code> uses all data.
</p>
</td></tr>
<tr><td><code id="escore_+3A_alpha">alpha</code></td>
<td>

<p>distance exponent in (0,2]
</p>
</td></tr>
<tr><td><code id="escore_+3A_method">method</code></td>
<td>

<p>method used to weight the statistics
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Székely, G.J. and M.L. Rizzo, 2004. Testing for equal
distributions in high dimension, InterStat, November (5).
</p>
<p>Székely, G.J. and M.L. Rizzo, 2013. Energy statistics: statistics
based on distances. Journal of Statistical Planning and Inference,
143(8):1249-1272. doi:10.1016/j.jspi.2013.03.018
</p>
<p>Rizzo, M.L. and G.L. Székely, 2016. Energy distance. Wiley
Interdisciplinary Reviews: Computational Statistics, 8(1):27-38.
</p>

<hr>
<h2 id='MBCn'>
Multivariate bias correction (N-pdft)
</h2><span id='topic+MBCn'></span>

<h3>Description</h3>

<p>Multivariate bias correction that matches the multivariate
distribution using <code><a href="#topic+QDM">QDM</a></code> and the N-dimensional
probability density function transform (N-pdft) following
Cannon (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBCn(o.c, m.c, m.p, iter=30, ratio.seq=rep(FALSE, ncol(o.c)),
     trace=0.05, trace.calc=0.5*trace, jitter.factor=0,
     n.tau=NULL, ratio.max=2, ratio.max.trace=10*trace,
     ties='first', qmap.precalc=FALSE, rot.seq=NULL,
     silent=FALSE, n.escore=0, return.all=FALSE, subsample=NULL,
     pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBCn_+3A_o.c">o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_m.c">m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_m.p">m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_iter">iter</code></td>
<td>

<p>maximum number of algorithm iterations.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_ratio.seq">ratio.seq</code></td>
<td>

<p>vector of logical values indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_trace">trace</code></td>
<td>

<p>numeric values indicating thresholds below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_trace.calc">trace.calc</code></td>
<td>

<p>numeric values of thresholds used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_jitter.factor">jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_n.tau">n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_ratio.max">ratio.max</code></td>
<td>

<p>numeric values indicating the maximum proportional changes allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_ratio.max.trace">ratio.max.trace</code></td>
<td>

<p>numeric values of trace thresholds used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_ties">ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_qmap.precalc">qmap.precalc</code></td>
<td>

<p>logical value indicating if <code>m.c</code> and <code>m.p</code> are outputs from <code>QDM</code>. 
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_rot.seq">rot.seq</code></td>
<td>

<p>use a supplied list of random rotation matrices. <code>NULL</code> generates on
the fly.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_silent">silent</code></td>
<td>

<p>logical value indicating if algorithm progress should be reported.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_n.escore">n.escore</code></td>
<td>

<p>number of cases used to calculate the energy distance when monitoring 
convergence.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_return.all">return.all</code></td>
<td>

<p>logical value indicating whether results from all iterations are returned.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_subsample">subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate initial
empirical quantiles; if <code>NULL</code>, calculate normally.
</p>
</td></tr>
<tr><td><code id="MBCn_+3A_pp.type">pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cannon, A.J., 2018. Multivariate quantile mapping bias correction: An 
N-dimensional probability density function transform for climate model
simulations of multiple variables. Climate Dynamics, 50(1-2):31-49.
doi:10.1007/s00382-017-3580-6
</p>
<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>
<p>Pitié, F., A.C. Kokaram, and R. Dahyot, 2005. N-dimensional probability
density function transfer and its application to color transfer.
In Tenth IEEE International Conference on Computer Vision, 2005.
ICCV 2005. (Vol. 2, pp. 1434-1439). IEEE.
</p>
<p>Pitié, F., A.C. Kokaram, and R. Dahyot, 2007. Automated colour grading
using colour distribution transfer. Computer Vision and Image
Understanding, 107(1):123-137.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QDM">QDM</a>, <a href="#topic+MBCp">MBCp</a>, <a href="#topic+MBCr">MBCr</a>, <a href="#topic+MRS">MRS</a>, <a href="#topic+escore">escore</a>, <a href="#topic+rot.random">rot.random</a></code>
</p>

<hr>
<h2 id='MBCp'>
Multivariate bias correction (Pearson correlation)
</h2><span id='topic+MBCp'></span>

<h3>Description</h3>

<p>Multivariate bias correction that matches marginal
distributions using <code><a href="#topic+QDM">QDM</a></code> and the Pearson correlation
dependence structure following Cannon (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBCp(o.c, m.c, m.p, iter=20, cor.thresh=1e-4,
     ratio.seq=rep(FALSE, ncol(o.c)), trace=0.05,
     trace.calc=0.5*trace, jitter.factor=0, n.tau=NULL,
     ratio.max=2, ratio.max.trace=10*trace, ties='first',
     qmap.precalc=FALSE, silent=FALSE, subsample=NULL,
     pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBCp_+3A_o.c">o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_m.c">m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_m.p">m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_iter">iter</code></td>
<td>

<p>maximum number of algorithm iterations.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_cor.thresh">cor.thresh</code></td>
<td>

<p>if greater than zero, a threshold indicating the change in magnitude of Pearson correlations required for convergence.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_ratio.seq">ratio.seq</code></td>
<td>

<p>vector of logical values indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_trace">trace</code></td>
<td>

<p>numeric values indicating thresholds below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_trace.calc">trace.calc</code></td>
<td>

<p>numeric values of thresholds used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_jitter.factor">jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_n.tau">n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_ratio.max">ratio.max</code></td>
<td>

<p>numeric values indicating the maximum proportional changes allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_ratio.max.trace">ratio.max.trace</code></td>
<td>

<p>numeric values of trace thresholds used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_ties">ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_qmap.precalc">qmap.precalc</code></td>
<td>

<p>logical value indicating if <code>m.c</code> and <code>m.p</code> are outputs from <code>QDM</code>. 
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_silent">silent</code></td>
<td>

<p>logical value indicating if algorithm progress should be reported.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_subsample">subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate initial
empirical quantiles; if <code>NULL</code>, calculate normally.
</p>
</td></tr>
<tr><td><code id="MBCp_+3A_pp.type">pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cannon, A.J., 2016. Multivariate bias correction of climate model output:
Matching marginal distributions and inter-variable dependence structure.
Journal of Climate, 29:7045-7064. doi:10.1175/JCLI-D-15-0679.1
</p>
<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QDM">QDM</a>, <a href="#topic+MBCr">MBCr</a>, <a href="#topic+MRS">MRS</a>, <a href="#topic+MBCn">MBCn</a> <a href="#topic+escore">escore</a></code>
</p>

<hr>
<h2 id='MBCr'>
Multivariate bias correction (Spearman rank correlation)
</h2><span id='topic+MBCr'></span>

<h3>Description</h3>

<p>Multivariate bias correction that matches marginal distributions
using <code><a href="#topic+QDM">QDM</a></code> and the Spearman rank correlation
dependence structure following Cannon (2016).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBCr(o.c, m.c, m.p, iter=20, cor.thresh=1e-4,
     ratio.seq=rep(FALSE, ncol(o.c)), trace=0.05,
     trace.calc=0.5*trace, jitter.factor=0, n.tau=NULL,
     ratio.max=2, ratio.max.trace=10*trace, ties='first',
     qmap.precalc=FALSE, silent=FALSE, subsample=NULL,
     pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBCr_+3A_o.c">o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_m.c">m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_m.p">m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_iter">iter</code></td>
<td>

<p>maximum number of algorithm iterations.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_cor.thresh">cor.thresh</code></td>
<td>

<p>if greater than zero, a threshold indicating the change in magnitude of Spearman rank correlations required for convergence.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_ratio.seq">ratio.seq</code></td>
<td>

<p>vector of logical values indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_trace">trace</code></td>
<td>

<p>numeric values indicating thresholds below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_trace.calc">trace.calc</code></td>
<td>

<p>numeric values of thresholds used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_jitter.factor">jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_n.tau">n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_ratio.max">ratio.max</code></td>
<td>

<p>numeric values indicating the maximum proportional changes allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_ratio.max.trace">ratio.max.trace</code></td>
<td>

<p>numeric values of trace thresholds used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_ties">ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_qmap.precalc">qmap.precalc</code></td>
<td>

<p>logical value indicating if <code>m.c</code> and <code>m.p</code> are outputs from <code>QDM</code>. 
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_silent">silent</code></td>
<td>

<p>logical value indicating if algorithm progress should be reported.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_subsample">subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate empirical
quantiles; if <code>NULL</code>, calculate normally.
</p>
</td></tr>
<tr><td><code id="MBCr_+3A_pp.type">pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cannon, A.J., 2016. Multivariate bias correction of climate model output:
Matching marginal distributions and inter-variable dependence structure.
Journal of Climate, 29:7045-7064. doi:10.1175/JCLI-D-15-0679.1
</p>
<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QDM">QDM</a>, <a href="#topic+MBCp">MBCp</a>, <a href="#topic+MRS">MRS</a>, <a href="#topic+MBCn">MBCn</a> <a href="#topic+escore">escore</a></code>
</p>

<hr>
<h2 id='MRS'>
Multivariate linear rescaling using Cholesky decomposition
</h2><span id='topic+MRS'></span>

<h3>Description</h3>

<p>Multivariate linear bias correction based on Cholesky decomposition of the
covariance matrix following Scheuer and Stoller (1962) and Bürger
et al. (2011). Bias correction matches the multivariate mean and covariance
structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MRS(o.c, m.c, m.p, o.c.chol=NULL, o.p.chol=NULL, m.c.chol=NULL,
    m.p.chol=NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MRS_+3A_o.c">o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_m.c">m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_m.p">m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_o.c.chol">o.c.chol</code></td>
<td>

<p>precalculated Cholesky decomposition of the <code>o.c</code> covariance matrix; <code>NULL</code> calculates internally.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_o.p.chol">o.p.chol</code></td>
<td>

<p>precalculated Cholesky decomposition of the target <code>o.p</code> covariance matrix; <code>NULL</code> defaults to <code>o.c.chol</code>.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_m.c.chol">m.c.chol</code></td>
<td>

<p>precalculated Cholesky decomposition of the <code>m.c</code> covariance matrix; <code>NULL</code> calculates internally.
</p>
</td></tr>
<tr><td><code id="MRS_+3A_m.p.chol">m.p.chol</code></td>
<td>

<p>precalculated Cholesky decomposition of the <code>m.p</code> covariance matrix; <code>NULL</code> calculates internally.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Scheuer, E.M. and D.S. Stoller, 1962. On the generation of normal random
vectors. Technometrics, 4(2):278-281.
</p>
<p>Bürger, G., J. Schulla, and A.T. Werner, 2011. Estimates of future flow,
including extremes, of the Columbia River headwaters. Water Resources
Research, 47(10):W10520. doi:10.1029/2010WR009716
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MBCp">MBCp</a>, <a href="#topic+MBCr">MBCr</a></code>
</p>

<hr>
<h2 id='QDM'>
Univariate bias correction via quantile delta mapping
</h2><span id='topic+QDM'></span>

<h3>Description</h3>

<p>Univariate bias correction based on the quantile delta mapping <code>QDM</code>
version of the quantile mapping algorithm from Cannon et al. (2015).
<code>QDM</code> constrains model-projected changes in quantiles to
be preserved following bias correction by quantile mapping.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>QDM(o.c, m.c, m.p, ratio=FALSE, trace=0.05, trace.calc=0.5*trace,
    jitter.factor=0, n.tau=NULL, ratio.max=2,
    ratio.max.trace=10*trace, ECBC=FALSE, ties='first',
    subsample=NULL, pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="QDM_+3A_o.c">o.c</code></td>
<td>

<p>vector of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_m.c">m.c</code></td>
<td>

<p>vector of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_m.p">m.p</code></td>
<td>

<p>vector of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_ratio">ratio</code></td>
<td>

<p>logical value indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td></tr>
<tr><td><code id="QDM_+3A_trace">trace</code></td>
<td>

<p>numeric value indicating the threshold below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_trace.calc">trace.calc</code></td>
<td>

<p>numeric value of a threshold used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_jitter.factor">jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_n.tau">n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_ratio.max">ratio.max</code></td>
<td>

<p>numeric value indicating the maximum proportional change allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_ratio.max.trace">ratio.max.trace</code></td>
<td>

<p>numeric value of a trace threshold used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_ecbc">ECBC</code></td>
<td>

<p>logical value indicating whether <code>mhat.p</code> outputs should be ordered according to <code>o.c</code> ranks, i.e., as in the empirical copula-bias correction (ECBC) algorithm.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_ties">ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_subsample">subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate empirical
quantiles; if <code>NULL</code>, calculate normally.
</p>
</td></tr>
<tr><td><code id="QDM_+3A_pp.type">pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>vector of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>vector of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>


<h3>See Also</h3>

<p><code><a href="#topic+MBCp">MBCp</a>, <a href="#topic+MBCr">MBCr</a>, <a href="#topic+MRS">MRS</a>, <a href="#topic+escore">escore</a></code>
</p>

<hr>
<h2 id='R2D2'>
Multivariate bias correction (R2D2)
</h2><span id='topic+R2D2'></span>

<h3>Description</h3>

<p>Multivariate bias correction that matches the multivariate
distribution using <code><a href="#topic+QDM">QDM</a></code> and the R2D2 
algorithm following Vrac (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>R2D2(o.c, m.c, m.p, ref.column=1, ratio.seq=rep(FALSE, ncol(o.c)),
     trace=0.05, trace.calc=0.5*trace, jitter.factor=0,
     n.tau=NULL, ratio.max=2, ratio.max.trace=10*trace,
     ties='first', qmap.precalc=FALSE, subsample=NULL, pp.type=7)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="R2D2_+3A_o.c">o.c</code></td>
<td>

<p>matrix of observed samples during the calibration period.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_m.c">m.c</code></td>
<td>

<p>matrix of model outputs during the calibration period.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_m.p">m.p</code></td>
<td>

<p>matrix of model outputs during the projected period.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_ref.column">ref.column</code></td>
<td>

<p>index of the reference column used for the 1D nearest neighbour matching
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_ratio.seq">ratio.seq</code></td>
<td>

<p>vector of logical values indicating if samples are of a ratio quantity (e.g., precipitation).
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_trace">trace</code></td>
<td>

<p>numeric values indicating thresholds below which values of a ratio quantity (e.g., <code>ratio=TRUE</code>) should be considered exact zeros.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_trace.calc">trace.calc</code></td>
<td>

<p>numeric values of thresholds used internally when handling of exact zeros; defaults to one half of <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_jitter.factor">jitter.factor</code></td>
<td>

<p>optional strength of jittering to be applied when quantities are quantized.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_n.tau">n.tau</code></td>
<td>

<p>number of quantiles used in the quantile mapping; <code>NULL</code> equals the length of the <code>m.p</code> series.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_ratio.max">ratio.max</code></td>
<td>

<p>numeric values indicating the maximum proportional changes allowed for ratio quantities below the <code>ratio.max.trace</code> threshold.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_ratio.max.trace">ratio.max.trace</code></td>
<td>

<p>numeric values of trace thresholds used to constrain the proportional change in ratio quantities to <code>ratio.max</code>; defaults to ten times <code>trace</code>.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_ties">ties</code></td>
<td>

<p>method used to handle ties when calculating ordinal ranks.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_qmap.precalc">qmap.precalc</code></td>
<td>

<p>logical value indicating if <code>m.c</code> and <code>m.p</code> are outputs from <code>QDM</code>. 
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_subsample">subsample</code></td>
<td>

<p>use <code>subsample</code> draws of size <code>n.tau</code> to calculate initial
empirical quantiles; if <code>NULL</code>, calculate normally.
</p>
</td></tr>
<tr><td><code id="R2D2_+3A_pp.type">pp.type</code></td>
<td>

<p>type of plotting position used in <code>quantile</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of with elements consisting of:
</p>
<table role = "presentation">
<tr><td><code>mhat.c</code></td>
<td>
<p>matrix of bias corrected <code>m.c</code> values for the calibration period.</p>
</td></tr>
<tr><td><code>mhat.p</code></td>
<td>
<p>matrix of bias corrected <code>m.p</code> values for the projection period.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cannon, A.J., S.R. Sobie, and T.Q. Murdock, 2015. Bias correction
of simulated precipitation by quantile mapping: How well do methods
preserve relative changes in quantiles and extremes? Journal of
Climate, 28:6938-6959. doi:10.1175/JCLI-D-14-00754.1
</p>
<p>Vrac, M., 2018. Multivariate bias adjustment of high-dimensional
climate simulations: the Rank Resampling for Distributions and
Dependences (R2D2) bias correction. Hydrology and Earth System
Sciences, 22:3175-3196. doi:10.5194/hess-22-3175-2018
</p>


<h3>See Also</h3>

<p><code><a href="#topic+QDM">QDM</a>, <a href="#topic+MBCp">MBCp</a>, <a href="#topic+MBCr">MBCr</a>, <a href="#topic+MRS">MRS</a>, <a href="#topic+MBCn">MBCn</a></code>
</p>

<hr>
<h2 id='rot.random'>
Random orthogonal rotation
</h2><span id='topic+rot.random'></span>

<h3>Description</h3>

<p>Generate a <code>k</code>-dimensional random orthogonal rotation matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rot.random(k)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rot.random_+3A_k">k</code></td>
<td>

<p>the number of dimensions.
</p>
</td></tr>
</table>


<h3>References</h3>

<p>Mezzadri, F. 2007. How to generate random matrices from the classical compact groups,
Notices of the American Mathematical Society, 54:592–604.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
