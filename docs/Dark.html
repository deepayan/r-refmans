<!DOCTYPE html><html><head><title>Help for package Dark</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Dark}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AICc'>
<p>Akaike information criterion</p>
</a></li>
<li><a href='#BestFit'>

<p>BestFit</p></a></li>
<li><a href='#BootDark'>

<p>BootDark</p></a></li>
<li><a href='#dark'>

<p>Dark adaptation data.</p></a></li>
<li><a href='#Dark-package'><p>Dark: A package to analyse dark adaptation data</p></a></li>
<li><a href='#Declutter'>

<p>Declutter</p></a></li>
<li><a href='#GetData'>

<p>GetData</p></a></li>
<li><a href='#H'>
<p>This is a simple switch function.</p></a></li>
<li><a href='#ModelSelect'>

<p>ModelSelect</p></a></li>
<li><a href='#MultiStart'>

<p>MultiStart</p></a></li>
<li><a href='#P3'>

<p>Three parameter model.</p></a></li>
<li><a href='#P5c'>
<p>Five parameter model.</p></a></li>
<li><a href='#P6c'>

<p>A six parameter model</p></a></li>
<li><a href='#P7c'>

<p>Seven parameter model</p></a></li>
<li><a href='#Start'>

<p>Start</p></a></li>
<li><a href='#TestData'>
<p>Data that can be used to test other scripts.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Analysis of Dark Adaptation Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.8</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-06-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Jeremiah MF Kelly</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jeremiah MF Kelly &lt;emkayoh@mac.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The recovery of visual sensitivity in a dark environment is known
    as dark adaptation. In a clinical or research setting the recovery is typically
    measured after a dazzling flash of light and can be described by the Mahroo,
    Lamb and Pugh (MLP) model of dark adaptation. The functions in this package take
    dark adaptation data and use nonlinear regression to find the parameters of the
    model that 'best' describe the data. They do this by firstly, generating rapid
    initial objective estimates of data adaptation parameters, then a multi-start
    algorithm is used to reduce the possibility of a local minimum. There is also a
    bootstrap method to calculate parameter confidence intervals. The functions rely
    upon a 'dark' list or object. This object is created as the first step in the
    workflow and parts of the object are updated as it is processed.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/emkayoh/Dark">https://github.com/emkayoh/Dark</a>, <a href="http://www.nihr.ac.uk">http://www.nihr.ac.uk</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/emkayoh/Dark/issues">https://github.com/emkayoh/Dark/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown,testthat</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, grDevices, graphics, utils</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>5.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-06-02 10:37:19 UTC; mqbxgjk2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-06-02 15:21:03</td>
</tr>
</table>
<hr>
<h2 id='AICc'>
Akaike information criterion 

</h2><span id='topic+AICc'></span>

<h3>Description</h3>

<p>The Akaike information criterion corrected for small sample size is a measure of the relative quality of a model.  The AICc is calculated from a 'dark' object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AICc(obj)
</code></pre>


<h3>Arguments</h3>

 <table>
<tr><td><code id="AICc_+3A_obj">obj</code></td>
<td>
<p>A dark object

This object must have at least the following elements:
</p>

<table>
<tr>
 <td style="text-align: left;">
obj$time </td><td style="text-align: left;"> to calculate the number of observations</td>
</tr>
<tr>
 <td style="text-align: left;">
obj$Pn </td><td style="text-align: left;"> the number of parameters in the model</td>
</tr>
<tr>
 <td style="text-align: left;">
obj$val </td><td style="text-align: left;"> the sum of squared residual error</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

</td></tr>
</table>


<h3>Value</h3>

<p>The value returned is an indication of the information lost by fitting a particular model to the data, and is only of merit when compared to the value from another model.
</p>





<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>See <a href="http://en.wikipedia.org/wiki/Akaike_information_criterion">http://en.wikipedia.org/wiki/Akaike_information_criterion</a>. 
</p>
<p>K. Burnham and D. Anderson. Model selection and multi-model inference: a practical information- theoretic approach. Springer, 2002.
</p>
<p>Sakamoto, Y., Ishiguro, M., and Kitagawa G. (1986). Akaike Information Criterion Statistics. D. Reidel Publishing Company.
</p>


<h3>See Also</h3>


<p><code><a href="stats.html#topic+AIC">AIC</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>AICc(dark)
</code></pre>

<hr>
<h2 id='BestFit'>

BestFit
</h2><span id='topic+BestFit'></span>

<h3>Description</h3>

<p>This script takes a dark object, a list of parameters and AICc scores from <code>ModelSelect</code> to chose a model and then return optimised values for the parameter estimates. Analysis of the data can be halted here if wished.
</p>
<p>However, a <code>MultiStart</code> check can be useful if it is suspected that a local minimum has been found. Furthermore, <code>BootDark</code> will provide confidence intervals for the parameter estimates. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>BestFit(obj, MSC, draw)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BestFit_+3A_obj">obj</code></td>
<td>
<p>A dark object

</p>
</td></tr>
<tr><td><code id="BestFit_+3A_msc">MSC</code></td>
<td>
<p>A list from the function <code>ModelSelect</code>

</p>
</td></tr>
<tr><td><code id="BestFit_+3A_draw">draw</code></td>
<td>
<p>A flag to indicate whether a figure should be drawn.

</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:





</p>
<table>
<tr><td><code>call</code></td>
<td>
<p> the last function call on the data</p>
</td></tr> 
<tr><td><code>time</code></td>
<td>
<p> time of observations</p>
</td></tr> 
<tr><td><code>thrs</code></td>
<td>
<p> thresholds</p>
</td></tr> 
<tr><td><code>resid</code></td>
<td>
<p>residuals of best model fit</p>
</td></tr> 
<tr><td><code>fit</code></td>
<td>
<p> fitted thresholds for the optimal model and parameters</p>
</td></tr> 
<tr><td><code>thet</code></td>
<td>
<p>seed parameters of TestData, null if not TestData</p>
</td></tr> 
<tr><td><code>sse</code></td>
<td>
<p>sum of squared error used in TestData</p>
</td></tr> 
<tr><td><code>val</code></td>
<td>
<p>calculated sum of squared errors</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>source of the data</p>
</td></tr> 
<tr><td><code>opt</code></td>
<td>
<p>optimal parameter estimates</p>
</td></tr>  
<tr><td><code>Mod</code></td>
<td>
<p>optimal model</p>
</td></tr> 
<tr><td><code>Pn</code></td>
<td>
<p>number of parameters required by the model to fit the data</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p>AICc scores for the three models fitted</p>
</td></tr> 
<tr><td><code>R2</code></td>
<td>
<p>an indication of the 'goodness' of fit</p>
</td></tr>
</table>


<h3>Note</h3>


<p>This function makes extensive use of <code>optim</code>.
</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>See Also</h3>


<p><code><a href="stats.html#topic+optim">optim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tmp &lt;- TestData(0:20)
P&lt;-Start(tmp,100)
MSC&lt;-ModelSelect(tmp, P)
BestFit(tmp, MSC)
</code></pre>

<hr>
<h2 id='BootDark'>

BootDark
</h2><span id='topic+BootDark'></span>

<h3>Description</h3>


<p>A script using bootstrap techniques to calculate confidence intervals for parameter estimates from a 'dark' object.</p>


<h3>Usage</h3>

<pre><code class='language-R'>BootDark(obj, R, graph, progress = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BootDark_+3A_obj">obj</code></td>
<td>
<p>A 'dark' object. 

</p>
</td></tr>
<tr><td><code id="BootDark_+3A_r">R</code></td>
<td>
<p>The number of repeats for the bootstrap calculations.

</p>
</td></tr>
<tr><td><code id="BootDark_+3A_graph">graph</code></td>
<td>
<p>A flag to indicate whether a figure should be drawn.

</p>
</td></tr>
<tr><td><code id="BootDark_+3A_progress">progress</code></td>
<td>
<p>A flag to indicate whether a progress bar should be drawn to the console. This might be preferred if using a large number of repeats. 

</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The script calculates bootstrap estimates of confidence intervals by sampling the residuals without replacement. The seven parameter model 'P7c' is always used. If 'P3' or 'P5c' have been found elsewhere to be a better fit then this will be confirmed by bootstrapping the 'P7c' model.  

</p>


<h3>Value</h3>

<p>Returns a list 'out'





</p>
<table>
<tr><td><code>out$time</code></td>
<td>
<p>times of observations</p>
</td></tr>
<tr><td><code>out$thrs</code></td>
<td>
<p>thresholds</p>
</td></tr> 
<tr><td><code>out$opt</code></td>
<td>
<p>optimised parameter estimates</p>
</td></tr>
<tr><td><code>out$Mod</code></td>
<td>
<p>the name of the optimal model</p>
</td></tr>
<tr><td><code>out$Pn</code></td>
<td>
<p>number of parameters needed to describe the data</p>
</td></tr>
<tr><td><code>out$AIC</code></td>
<td>
<p>the AICc scores for the three models</p>
</td></tr>
<tr><td><code>out$fit</code></td>
<td>
<p>fitted values for the optimal parameter estimates</p>
</td></tr>
<tr><td><code>out$resd</code></td>
<td>
<p>residuals of the best fits</p>
</td></tr>
<tr><td><code>out$R2</code></td>
<td>
<p>the coefficient of determination</p>
</td></tr>
<tr><td><code>out$Bootstrap</code></td>
<td>
<p>bootstrap parameter estimates, 2.5%, 50% and 97.5%</p>
</td></tr>
<tr><td><code>out$weight</code></td>
<td>
<p>the reciprocal of the CI</p>
</td></tr>
<tr><td><code>out$valid</code></td>
<td>
<p>nn indication whether the parameter estimate is valid</p>
</td></tr>
<tr><td><code>out$data</code></td>
<td>
<p>the source of the data</p>
</td></tr>
<tr><td><code>out$call</code></td>
<td>
<p>updates the call label on the object</p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>B. Efron. Bootstrap methods: another look at the jackknife. The Annals of Statistics, 7(1):1-26, 1979.
</p>
<p>B. Efron. Nonparametric estimates of standard error: The jackknife, the bootstrap and other methods. Biometrika, 68(3):589, 1981.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Time&lt;- seq(0,20)
tmp&lt;- TestData(Time)
P&lt;-Start(tmp,1000)
MSC&lt;-ModelSelect(tmp, P)
tmp2&lt;-BestFit(tmp, MSC)
tmp3&lt;-MultiStart(tmp2,10)
BootDark(tmp3,50)
</code></pre>

<hr>
<h2 id='dark'>

Dark adaptation data.
</h2><span id='topic+dark'></span>

<h3>Description</h3>


<p>This data was extracted from Figure 1 in Rushton's paradox: rod dark adaptation after flash photolysis, E.N.Pugh Jr. <em>The Journal of Physiology,</em> 1975. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dark")</code></pre>


<h3>Format</h3>

<p><code>dark</code> is a list of 15 items, that are used or created by the functions in this package.
</p>


<h3>Details</h3>



<p>The items are:
</p>
<ul>
<li><p> $time: the time of observations
</p>
</li>
<li><p> $thrs: the thresholds
</p>
</li>
<li><p> $fit: thresholds predicted by the model
</p>
</li>
<li><p> $resid: residuals between the fitted model and observed data
</p>
</li>
<li><p> $R2: the coefficient of determination
</p>
</li>
<li><p> $Bootstrap: a table of quantiles (2.5%, 50% and 97.5%) for the parameter estimates from bootstrap methods
</p>
</li>
<li><p> $weight: the parameter estimate divided by the 95% quantile range
</p>
</li>
<li><p> $valid: an integer array indicating whether the quantile range encloses zero. 
</p>
</li>
<li><p> $opt: parameter estimates of the optimal model 
</p>
</li>
<li><p> $Mod: a string describing the optimal model
</p>
</li>
<li><p> $Pn: the number of parameters in the optimal model
</p>
</li>
<li><p> $AIC: an array with the AICc scores for the three models
</p>
</li>
<li><p> $val: sum of residuals squared
</p>
</li>
<li><p> $call: the last function call that produced the object
</p>
</li>
<li><p> $data: the source of the data
</p>
</li></ul>


<h3>References</h3>


<p>E. Pugh. Rushton's paradox: rod dark adaptation after flash photolysis. The Journal of Physiology, 248(2):413, 1975.
</p>
<p><a href="http://onlinelibrary.wiley.com/doi/10.1113/jphysiol.1975.sp010982/abstract">http://onlinelibrary.wiley.com/doi/10.1113/jphysiol.1975.sp010982/abstract</a>
</p>
<p><a href="http://onlinelibrary.wiley.com/doi/10.1113/jphysiol.1975.sp010982/pdf">http://onlinelibrary.wiley.com/doi/10.1113/jphysiol.1975.sp010982/pdf</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dark)
## load(dark)
</code></pre>

<hr>
<h2 id='Dark-package'>Dark: A package to analyse dark adaptation data</h2><span id='topic+Dark-package'></span><span id='topic+Dark'></span>

<h3>Description</h3>

<p>A series of scripts to find the parameters of dark adaptation.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> Dark</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.9.6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2015-06-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 
<p>Dark adaptation is the recovery of visual sensitivity in a dark environment and can be described by a physiological model. This package contains a series of functions to analyse data collected during dark adaptation.  
</p>
<p>The functions use the Mahroo Lamb and Pugh (MLP) model of dark adaptation. The functions in this package take dark adaptation data and find the parameters of the model that 'best fit' the data. 
</p>
<p>The functions generate rapid initial objective estimates of data adaptation parameters, a multi-start algorithm to reduce possibility of a local minimum. There is a bootstrap method to calculate parameter confidence intervals. There are also ancillary functions to facilitate the analysis.
</p>
<p>The functions rely upon a *dark* list or object. This object is created by the first function and parts are added to the object as it is processed.
</p>


<h3>Author(s)</h3>

<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>
<p>Maintainer: Jeremiah MF Kelly &lt;emkayoh@mac.com&gt;
</p>


<h3>References</h3>

<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Time&lt;- seq(0,20)
tmp&lt;- TestData(Time)
P&lt;-Start(tmp,1000)
MSC&lt;-ModelSelect(tmp, P)
tmp2&lt;-BestFit(tmp, MSC)
tmp3&lt;-MultiStart(tmp2,10)
BootDark(tmp3,50) 
</code></pre>

<hr>
<h2 id='Declutter'>

Declutter
</h2><span id='topic+Declutter'></span>

<h3>Description</h3>


<p>A function to remove multiple button presses, i.e. data that has multiple values for the same threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Declutter(tmp, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Declutter_+3A_tmp">tmp</code></td>
<td>


<p>a 'dark' object with at least two elements; tmp$time and tmp$thrs. 
</p>
</td></tr>
<tr><td><code id="Declutter_+3A_delta">delta</code></td>
<td>


<p>The minimum time in seconds between responses. Thresholds set within two seconds of each other are discarded apart from the first threshold. </p>
</td></tr>
</table>


<h3>Details</h3>


<p>In early data collected with analogue equipment it was psossible for a subject to return multiple button presses when setting just one threshold. This data is characterised by clusters of points within a very short time. This function removes the exptra presses. It is rarely need for data collected from digital equipment. 
</p>


<h3>Value</h3>

<p>Returns an object with the same elements as 'tmp' but with object$time and object$thrs altered. 





</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
Time  &lt;-c(0, 0.02, 1, 2,  3, 3.02,  5, 6, 6.02, 7, 9, 9.02, 11, 
12, 12.02, 13, 15, 15.02, 16, 18, 18.02, 20) 
# with duplicated times
set.seed(1234)
tmp &lt;- TestData(Time, sse=0.05) 
## Not run: plot(tmp$time, tmp$thrs, ylim=c(-4,0))
tmp &lt;- Declutter(tmp)
## Not run: points(tmp$time, tmp$thrs, col='red', pch=16)

</code></pre>

<hr>
<h2 id='GetData'>

GetData  
</h2><span id='topic+GetData'></span>

<h3>Description</h3>


<p>A template function that gets the data from a file and converts it to a <em>dark</em> object for use by other scripts. The script can be modified to format the data. A <em>dark</em> object has time data in minutes and thresholds in log units. If the data have been collected in other units then the script should convert them. 
</p>
<p>The script defaults to returning data generated by <code>TestData</code>. </p>


<h3>Usage</h3>

<pre><code class='language-R'>GetData(path, .....)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GetData_+3A_path">path</code></td>
<td>


<p>This is the location of the data and will usually be a file path string.  </p>
</td></tr>
<tr><td><code id="GetData_+3A_.....">.....</code></td>
<td>


<p>This can be any other values that might be needed to identify the data, e.g. subject number or study reference. 
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This script can be altered in any way desired and then saved with a different name. I suggest  the format 'GetData....R', where the ellipsis describes the data in some way. 
</p>


<h3>Value</h3>


<p>A <em>dark</em> object with at least two elements
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>the time elapsed after measurements begin in minutes</p>
</td></tr>
<tr><td><code>thrs</code></td>
<td>
<p>the thresholds recorded in log units </p>
</td></tr>

</table>
<p>other possible values include 
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>the name of the data source</p>
</td></tr>
<tr><td><code>init</code></td>
<td>
<p>initial estimates of the optimal model parameters</p>
</td></tr>
<tr><td><code>opt</code></td>
<td>
<p>optimal estimates of the optimal model parameters</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>the residuals of the data for an optimal model</p>
</td></tr>
<tr><td><code>...</code></td>
<td>
<p> others to be added </p>
</td></tr>
</table>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>See Also</h3>


<p><code><a href="#topic+TestData">TestData</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
tmp &lt;- GetData()
</code></pre>

<hr>
<h2 id='H'>
This is a simple switch function.
</h2><span id='topic+H'></span>

<h3>Description</h3>

<p>This function is used to transition from 'off' to 'on'. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>H(x, k = 100, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="H_+3A_x">x</code></td>
<td>

<p>is the measured time.
</p>
</td></tr>
<tr><td><code id="H_+3A_k">k</code></td>
<td>

<p>is the transition constant, set arbitrarily high.
</p>
</td></tr>
<tr><td><code id="H_+3A_t">t</code></td>
<td>

<p>is the time at which the transition occurs.
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This helper function used in <code>P5c</code> and <code>P7c</code> enables the <code>optim</code> function to find parameters three times as quickly than if the transitions betwen the phases are modelled by a logical function e.g. a step function.  
</p>


<h3>Value</h3>

<p>For times before 't' the output is less than or equal to 0.5, after this time the the output is greater than 0.5. As 'k' grows larger the rate of transition from 0 to 1 increases.  





</p>


<h3>Note</h3>

<p>H is a logistic function that maps inputs to a values between zero and one
</p>


<h3>Author(s)</h3>

<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>The logistic function: <a href="http://en.wikipedia.org/wiki/Logistic_function">http://en.wikipedia.org/wiki/Logistic_function</a>
</p>
<p>The step function: <a href="http://en.wikipedia.org/wiki/Heaviside_step_function">http://en.wikipedia.org/wiki/Heaviside_step_function</a>
</p>


<h3>See Also</h3>


<p><code><a href="#topic+P5c">P5c</a></code>, <code><a href="#topic+P7c">P7c</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- seq(0, 20, by=0.1)
k &lt;- 10
t &lt;- 10
op &lt;- par(las=1, bty='n')
## Not run: plot(x,H(x,k,t), 'l')
par(op)
</code></pre>

<hr>
<h2 id='ModelSelect'>

ModelSelect
</h2><span id='topic+ModelSelect'></span>

<h3>Description</h3>

<p>Returns a list with two elements; an array of AICc scores indexed by the number of parameters in the model considered and a matrix of parameters with three rows, one for each model. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>ModelSelect(obj, P)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ModelSelect_+3A_obj">obj</code></td>
<td>


<p>A 'dark' object. 
</p>
</td></tr>
<tr><td><code id="ModelSelect_+3A_p">P</code></td>
<td>


<p>Is a matrix with seven columns and at least one row. The values of each element can be zero. 
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This is a <em>brute-force</em> method to make a first estimate of the optimal model parameters. 
</p>
<p>The matrix 'P' holds rows of possible parameter values.
Each row is passed to the 3, 5, and 7 parameter models and the sum of residuals squared is calculated for the given times (obj$time) and thresholds (obj$thrs).
So for each row in 'P' there is a score for each model. Then for each model the row which yields the lowest SSE is chosen as a starting point for optimisation. The optimised parameters are stored in 'param' and once the three parameter arrays have been found their AICc scores are found and returned as AIC.
</p>


<h3>Value</h3>

<p>Returns a list 


</p>
<table>
<tr><td><code>AIC</code></td>
<td>
<p>An array of seven values with AIC scores at the index of model parameter count.
</p>
</td></tr>
<tr><td><code>param</code></td>
<td>
<p>A three row by seven column matrix. Each row containing the optimised parameters for each model. </p>
</td></tr>

</table>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p><a href="http://en.wikipedia.org/wiki/Brute-force_search">http://en.wikipedia.org/wiki/Brute-force_search</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
tmp&lt;- TestData(0:20)
P&lt;-Start(tmp)
ModelSelect(tmp,P)
</code></pre>

<hr>
<h2 id='MultiStart'>

MultiStart
</h2><span id='topic+MultiStart'></span>

<h3>Description</h3>


<p>Given a <em>dark</em> object, <code>obj</code>, this function repeatedly optimises the parameters in the vicinity of the seed array. The width of the search is dependent upon the value of <code>spread</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultiStart(obj, repeats, draw, spread, debug)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultiStart_+3A_obj">obj</code></td>
<td>
<p>A <em>dark</em> object containing at least;</p>

<table>
<tr>
 <td style="text-align: left;">
obj$time </td><td style="text-align: left;"> time</td>
</tr>
<tr>
 <td style="text-align: left;">
obj$thrs </td><td style="text-align: left;"> thresholds</td>
</tr>
<tr>
 <td style="text-align: left;">
obj$init </td><td style="text-align: left;"> an initial estimate of the parameters of dark adaptation.</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 

</td></tr>
<tr><td><code id="MultiStart_+3A_repeats">repeats</code></td>
<td>
<p>The number of times the algorithm is repeated

</p>
</td></tr>
<tr><td><code id="MultiStart_+3A_draw">draw</code></td>
<td>
<p>A flag indicating whether a figure should be drawn.

</p>
</td></tr>
<tr><td><code id="MultiStart_+3A_spread">spread</code></td>
<td>
<p>The amount by which the seed array should be varied. A larger value gives a greater range of possible starting points. 

</p>
</td></tr>
<tr><td><code id="MultiStart_+3A_debug">debug</code></td>
<td>
<p>A flag used in debugging the software.

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>To reduce the possibility of selecting non-optimal parameter estimates, the optimisation is repeated in the region of initial estimates. The 
</p>


<h3>Value</h3>

<p>Returns a list;
</p>
<table>
<tr><td><code>time</code></td>
<td>
<p>times of threshold setting</p>
</td></tr>
<tr><td><code>out$thrs</code></td>
<td>
<p>observed thresholds</p>
</td></tr>
<tr><td><code>out$resid</code></td>
<td>
<p>residuals</p>
</td></tr>
<tr><td><code>out$fit</code></td>
<td>
<p>optimal fitted values</p>
</td></tr>
<tr><td><code>out$thet</code></td>
<td>
<p>seed parameters if test data</p>
</td></tr>
<tr><td><code>out$sse</code></td>
<td>
<p>sum of squared residuals if test data</p>
</td></tr>
<tr><td><code>out$data</code></td>
<td>
<p>source of the data</p>
</td></tr>
<tr><td><code>out$opt</code></td>
<td>
<p>optimal parameter estimates of the chosen model</p>
</td></tr>
<tr><td><code>out$Mod</code></td>
<td>
<p>name of the optimal model</p>
</td></tr>
<tr><td><code>out$Pn</code></td>
<td>
<p>the number of parameters needed to describe the data</p>
</td></tr>
<tr><td><code>out$AIC</code></td>
<td>
<p>array of AICc scores</p>
</td></tr>
<tr><td><code>out$val</code></td>
<td>
<p>calculated sum of squared residuals</p>
</td></tr>
<tr><td><code>out$R2</code></td>
<td>
<p>the coefficient of determination</p>
</td></tr>
<tr><td><code>out$warning</code></td>
<td>
<p>if none of the nearby values converge</p>
</td></tr>
<tr><td><code>out$call</code></td>
<td>
<p>updates the function call label</p>
</td></tr>





</table>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>Nelder, J.A.; Mead, R. 1965: A simplex for function minimization. Comput. J. 7, 308-313
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
Time&lt;- seq(0,20)
tmp&lt;- TestData(Time)
P&lt;-Start(tmp,1000)
MSC&lt;-ModelSelect(tmp, P)
tmp2&lt;-BestFit(tmp, MSC)
tmp3&lt;-MultiStart(tmp2,10)
</code></pre>

<hr>
<h2 id='P3'>

Three parameter model. 
</h2><span id='topic+P3'></span>

<h3>Description</h3>


<p>The three parameter model. A simple exponential decay. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P3(a, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P3_+3A_a">a</code></td>
<td>


<p>An array of parameters;

</p>

<table>
<tr>
 <td style="text-align: left;">
a: </td><td style="text-align: center;"> parameter  </td><td style="text-align: center;"> Units</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
a[1]: </td><td style="text-align: center;"> cone threshold </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[2]: </td><td style="text-align: center;"> cone coefficient </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[3]: </td><td style="text-align: center;"> cone time constant  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

</td></tr>
<tr><td><code id="P3_+3A_x">X</code></td>
<td>
<p> The times when the model predicts thresholds. 

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function has three roles, to calculate the thresholds for given parameters <code>a</code> and times <code>X</code>.  If missing <code>X</code>, then the function calls the values <code>x</code> and <code>y</code> from the <code>.Globalenv</code> and calculates the sum of residuals squared error (SSE) for <code>a</code>. If <code>a</code> is an array of length <code>1L</code> or <code>boolean</code> then a description of the model is returned.
</p>
<p>The use of the function <code>H</code> rather than an impulse function gives a three-fold increase is speed for the <code>optim</code> function.
</p>


<h3>Value</h3>


<p>The output depends upon the input. 
If the input is an array of length <code>1L</code> or a <code>boolean</code> then a list is returned 


</p>
<table>
<tr><td><code>Pn</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>Mod</code></td>
<td>
<p>name of the model</p>
</td></tr>
</table>
<p>If a parameter array is passed then the sum of residuals squared is calculated. This is used by <code>optim</code> to optimise the parameter estimates. 
</p>
<p>Passing a parameter array and a series of putative times causes the function to return predicted thresholds. 

</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+P5c">P5c</a></code>,<code><a href="#topic+P6c">P6c</a></code>,<code><a href="#topic+P7c">P7c</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x &lt;- 0:20
a &lt;- c(-1.00,  1.00,  1.00, -0.24,  6.00,  0.20, 13.00)
tmp &lt;- TestData(x, a)
y &lt;- tmp$resid

P3(TRUE)
# Describes the model

P3(a)
# The sum of squared residuals

P3(a,x)
# The fitted thresholds for given parameters 'theta' and times 'x'

</code></pre>

<hr>
<h2 id='P5c'>
Five parameter model.
</h2><span id='topic+P5c'></span>

<h3>Description</h3>


<p>The five parameter model. An exponential decay followed by a linear phase. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P5c(a,X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P5c_+3A_a">a</code></td>
<td>


<p>An array of parameters;

</p>

<table>
<tr>
 <td style="text-align: left;">
a: </td><td style="text-align: center;"> parameter  </td><td style="text-align: center;"> Units</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
a[1]: </td><td style="text-align: center;"> cone threshold </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[2]: </td><td style="text-align: center;"> cone coefficient </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[3]: </td><td style="text-align: center;"> cone time constant  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[4]: </td><td style="text-align: center;"> S2  </td><td style="text-align: center;"> (log lum / minute)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[5]: </td><td style="text-align: center;"> alpha point  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

</td></tr>
<tr><td><code id="P5c_+3A_x">X</code></td>
<td>
<p> The times when the model predicts thresholds. 

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function has three roles, to calculate the thresholds for given parameters <code>a</code> and times <code>X</code>.  If missing <code>X</code>, then the function calls the values <code>x</code> and <code>y</code> from the <code>.Globalenv</code> and calculates the sum of residuals squared error (SSE) for <code>a</code>. If <code>a</code> is an array of length <code>1L</code> or <code>boolean</code> then a description of the model is returned.
</p>
<p>The use of the function <code>H</code> rather than an impulse function gives a three-fold increase is speed for the <code>optim</code> function.
</p>


<h3>Value</h3>


<p>If the input is an array of length <code>1L</code> or a <code>boolean</code> then a list is returned 


</p>
<table>
<tr><td><code>Pn</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>Mod</code></td>
<td>
<p>name of the model</p>
</td></tr>
</table>
<p>If a parameter array is passed then the sum of residuals squared is calculated. This is used by <code>optim</code> to optimise the parameter estimates. 
</p>
<p>Passing a parameter array and a series of putative times causes the function to return predicted thresholds. 

</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+P3">P3</a></code>,<code><a href="#topic+P6c">P6c</a></code>,<code><a href="#topic+P7c">P7c</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x &lt;- 0:20
a &lt;- c(-1.00,  1.00,  1.00, -0.24,  6.00,  0.20, 13.00)
tmp &lt;- TestData(x, a)
y &lt;- tmp$resid

P5c(TRUE)
# Describes the model

P5c(a)
# The sum of squared residuals

P5c(a,x)
# The fitted thresholds for given parameters 'theta' and times 'x'

</code></pre>

<hr>
<h2 id='P6c'>

A six parameter model
</h2><span id='topic+P6c'></span>

<h3>Description</h3>


<p>An exponential decay followed by a second exponential decay.</p>


<h3>Usage</h3>

<pre><code class='language-R'>P6c(a, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P6c_+3A_a">a</code></td>
<td>


<p>An array of parameters;

</p>

<table>
<tr>
 <td style="text-align: left;">
a: </td><td style="text-align: left;"> parameter  </td><td style="text-align: center;"> Units</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
a[1]: </td><td style="text-align: left;"> absolute (rod) threshold  </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[2]: </td><td style="text-align: left;"> cone coefficient </td><td style="text-align: center;"> (log10 lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[3]: </td><td style="text-align: left;"> 1/cone time constant  </td><td style="text-align: center;"> (1/minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[4]: </td><td style="text-align: left;"> alpha point  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[5]: </td><td style="text-align: left;"> absolute threshold offset </td><td style="text-align: center;"> (log10 lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[6]: </td><td style="text-align: left;"> 1/rod time constant  </td><td style="text-align: center;"> (1/minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 
<p>note that the cone threshold is a[1] + a[5] log10(lum)</p>
</td></tr>
<tr><td><code id="P6c_+3A_x">X</code></td>
<td>
<p> The times in minutes when the model predicts thresholds. 

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function has three roles, to calculate the thresholds for given parameters <code>a</code> and times <code>X</code>.  If missing <code>X</code>, then the function calls the values <code>x</code> and <code>y</code> from the <code>.Globalenv</code> and calculates the sum of residuals squared error (SSE) for <code>a</code>. If <code>a</code> is an array of length <code>1L</code> or <code>boolean</code> then a description of the model is returned.
</p>
<p>The use of the function <code>H</code> rather than an impulse function gives a three-fold increase is speed for the <code>optim</code> function.
</p>


<h3>Value</h3>

<p>The output depends upon the input. 
If the input is an array of length <code>1L</code> or a <code>boolean</code> then a list is returned 


</p>
<table>
<tr><td><code>Pn</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>Mod</code></td>
<td>
<p>name of the model</p>
</td></tr>
</table>
<p>If a parameter array is passed then the sum of residuals squared is calculated. This is used by <code>optim</code> to optimise the parameter estimates. 
</p>
<p>Passing a parameter array and a series of putative times causes the function to return predicted thresholds. 

</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+P3">P3</a></code>,<code><a href="#topic+P5c">P5c</a></code>,<code><a href="#topic+P6c">P6c</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x &lt;- 0:20
a &lt;- c(-2, 2, 1/2, 10, 3, 1/8)

# P6c(TRUE)
# Describes the model

# P6c(a)
# The sum of squared residuals

# P6c(a,x)
# The fitted thresholds for given parameters 'a' and times 'x'

</code></pre>

<hr>
<h2 id='P7c'>

Seven parameter model
</h2><span id='topic+P7c'></span>

<h3>Description</h3>


<p>The seven parameter model. An exponential decay followed by two linear phases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>P7c(a, X)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="P7c_+3A_a">a</code></td>
<td>


<p>An array of parameters;

</p>

<table>
<tr>
 <td style="text-align: left;">
a: </td><td style="text-align: center;"> parameter  </td><td style="text-align: center;"> Units</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
a[1]: </td><td style="text-align: center;"> cone threshold </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[2]: </td><td style="text-align: center;"> cone coefficient </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[3]: </td><td style="text-align: center;"> cone time constant  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[4]: </td><td style="text-align: center;"> S2  </td><td style="text-align: center;"> (log lum/ minute)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[5]: </td><td style="text-align: center;"> alpha point  </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[6]: </td><td style="text-align: center;"> -(S2 + S3) </td><td style="text-align: center;"> (log luminance)</td>
</tr>
<tr>
 <td style="text-align: left;">
a[7]: </td><td style="text-align: center;"> beta point </td><td style="text-align: center;"> (log luminance)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 
</td></tr>
<tr><td><code id="P7c_+3A_x">X</code></td>
<td>
<p> The times when the model predicts thresholds. 

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>This function has three roles, to calculate the thresholds for given parameters <code>a</code> and times <code>X</code>.  If missing <code>X</code>, then the function calls the values <code>x</code> and <code>y</code> from the <code>.Globalenv</code> and calculates the sum of residuals squared error (SSE) for <code>a</code>. If <code>a</code> is an array of length <code>1L</code> or <code>boolean</code> then a description of the model is returned.
</p>
<p>The use of the function <code>H</code> rather than an impulse function gives a three-fold increase is speed for the <code>optim</code> function.
</p>


<h3>Value</h3>

<p>The output depends upon the input. 
If the input is an array of length <code>1L</code> or a <code>boolean</code> then a list is returned 


</p>
<table>
<tr><td><code>Pn</code></td>
<td>
<p>number of parameters</p>
</td></tr>
<tr><td><code>Mod</code></td>
<td>
<p>name of the model</p>
</td></tr>
</table>
<p>If a parameter array is passed then the sum of residuals squared is calculated. This is used by <code>optim</code> to optimise the parameter estimates. 
</p>
<p>Passing a parameter array and a series of putative times causes the function to return predicted thresholds. 

</p>


<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>O. Mahroo and T. Lamb. Recovery of the human photopic electroretinogram after bleaching exposures: estimation of pigment regeneration kinetics. The Journal of Physiology, 554(2):417, 2004.
</p>
<p>T. Lamb and E. Pugh. Dark adaptation and the retinoid cycle of vision. Progress in Retinal and Eye Research, 23(3):307-380, 2004.
</p>


<h3>See Also</h3>


<p><code><a href="#topic+P3">P3</a></code>,<code><a href="#topic+P5c">P5c</a></code>,<code><a href="#topic+P6c">P6c</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x &lt;- 0:20
a &lt;- c(-1.00,  1.00,  1.00, -0.24,  6.00,  0.20, 13.00)
tmp &lt;- TestData(x, a)
y &lt;- tmp$resid

# P7c(TRUE)
# Describes the model

# P7c(a)
# The sum of squared residuals

# P7c(a,x)
# The fitted thresholds for given parameters 'a' and times 'x'

</code></pre>

<hr>
<h2 id='Start'>

Start
</h2><span id='topic+Start'></span>

<h3>Description</h3>


<p>A function to build an array of starting parameters from a <em>dark</em> object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Start(obj, Reps)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Start_+3A_obj">obj</code></td>
<td>


<p>A <em>dark</em> object
</p>
</td></tr>
<tr><td><code id="Start_+3A_reps">Reps</code></td>
<td>
<p>The number of rows in the array.

</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The array of starting parameters is built from the time and threshold data in the object, <code>obj</code>. 
</p>
<p>Each parameter is assumed to have a possible range given the data.  
</p>
<p>Each range is constructed as follows; the time  points; <em>alpha</em> (cone-rod transition <code class="reqn">\alpha</code> minutes)  and <em>beta</em> (rod-rod transition <code class="reqn">\beta</code> minutes) are assumed to fall in the first and second halves of the time data respectively (<code>obj$time</code>). 
</p>
<p>The <em>cone threshold</em> is assumed to be in the upper half of the threshold data (<code>obj$thrs</code> log units). The <em>cone coefficient</em> (log units) or threshold at time zero is presumed to be positive and the same values are used for the <em>time constants</em> (<code class="reqn">tau</code> minutes).
</p>
<p>The rate of rod recovery <em>S2</em>, and the combined parameter <em>-(S2 + S3)</em> are ranged between -0.6 and 0 log units/minute.
</p>
<p>These ranges of possible values are complied into an array by sampling without replacement from each range for each parameter.
</p>


<h3>Value</h3>

<p>Output is an array of seven columns and number of rows = 'Reps'.
</p>







<h3>Author(s)</h3>


<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
tmp&lt;-TestData(0:20)
Start(tmp, 10)
</code></pre>

<hr>
<h2 id='TestData'>
Data that can be used to test other scripts.
</h2><span id='topic+TestData'></span>

<h3>Description</h3>

<p>This script creates data in the form of a <em>dark</em> object from specified times, parameters, and level of variability. It is used for testing and developing other scripts. Presently only the seven parameter model and its subsets are implemented. 

</p>


<h3>Usage</h3>

<pre><code class='language-R'>TestData(x, theta, sse, repeatable)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TestData_+3A_x">x</code></td>
<td>
 
<p>the times at which observations are made.
</p>
</td></tr>
<tr><td><code id="TestData_+3A_theta">theta</code></td>
<td>

<p>the parameters of the Mahroo Lamb Pugh model

</p>

<table>
<tr>
 <td style="text-align: left;">
theta : </td><td style="text-align: center;"> parameter </td><td style="text-align: center;"> default  </td><td style="text-align: center;"> Units</td>
</tr>
<tr>
 <td style="text-align: left;"></td>
</tr>
<tr>
 <td style="text-align: left;">
theta[1]: </td><td style="text-align: center;"> cone threshold </td><td style="text-align: center;"> -1 </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[2]: </td><td style="text-align: center;"> cone coefficient </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> (log lum)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[3]: </td><td style="text-align: center;"> cone time constant </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[4]: </td><td style="text-align: center;"> S2  </td><td style="text-align: center;"> -0.24 </td><td style="text-align: center;"> (log lum/ minute)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[5]: </td><td style="text-align: center;"> alpha point </td><td style="text-align: center;"> 6 </td><td style="text-align: center;"> (minutes)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[6]: </td><td style="text-align: center;"> -(S2 + S3) </td><td style="text-align: center;"> 0.20 </td><td style="text-align: center;"> (log luminance)</td>
</tr>
<tr>
 <td style="text-align: left;">
theta[7]: </td><td style="text-align: center;"> beta point </td><td style="text-align: center;"> 13 </td><td style="text-align: center;"> (log luminance)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>
 
</td></tr>
<tr><td><code id="TestData_+3A_sse">sse</code></td>
<td>

<p>the variability of the data
</p>
</td></tr>
<tr><td><code id="TestData_+3A_repeatable">repeatable</code></td>
<td>

<p>a boolean flag that ensures that the function can return the same values each time it is called. 
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>The parameters values chosen as defaults are entirely arbitrary. The sixth parameter is the negative sum of the rates of rod recovery called <em>S2</em> and <em>S3</em>
</p>


<h3>Value</h3>

<p>The function returns a <em>dark</em> object with the following components;

</p>
<table>
<tr><td><code>call</code></td>
<td>
<p>a label describing the last call the object was subject to</p>
</td></tr> 
<tr><td><code>time</code></td>
<td>
<p>the time observations</p>
</td></tr> 
<tr><td><code>thrs</code></td>
<td>
<p>thresholds</p>
</td></tr> 
<tr><td><code>resid</code></td>
<td>
<p>residuals</p>
</td></tr> 
<tr><td><code>fit</code></td>
<td>
<p>thresholds predicted in the absence of noise</p>
</td></tr> 
<tr><td><code>thet</code></td>
<td>
<p>parameters passed to the function</p>
</td></tr> 
<tr><td><code>sse</code></td>
<td>
<p>the sum of squared residuals value used to describe the variability in the data</p>
</td></tr> 
<tr><td><code>val</code></td>
<td>
<p>the actual sse of the generated data</p>
</td></tr> 
<tr><td><code>data</code></td>
<td>
<p>the name of the data source</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Jeremiah MF Kelly
</p>
<p>Faculty of Life Sciences, The University of Manchester, M13 9PL, UK
</p>


<h3>References</h3>


<p>L. Patryas, N. R. Parry, D. Carden, D. H. Baker, J. M. Kelly, T. Aslam, and I. J. Murray. Assessment of age changes and repeatability for computer-based rod dark adaptation. Graefe's Archive for Clinical and Experimental Ophthalmology, pages 1-7, 2013.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
x &lt;- seq(0,20)
tmp &lt;- TestData(x)
tmp

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
