<!DOCTYPE html><html lang="en"><head><title>Help for package eventTrack</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eventTrack}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#eventTrack-package'><p>Event Prediction for Time-to-Event Endpoints</p></a></li>
<li><a href='#bootstrapTimeToEvent'><p>Bootstrap the predicted time when a given number of events is reached, for hybrid Exponential model</p></a></li>
<li><a href='#bootSurvivalSample'><p>Bootstrap survival data</p></a></li>
<li><a href='#exactDatesFromMonths'><p>Compute exact timepoint when a certain number of events is reached, based on monthly number of events</p></a></li>
<li><a href='#hybrid_Exponential'><p>Estimate survival function, as hybrid between Kaplan-Meier and Exponential tail</p></a></li>
<li><a href='#kaplanMeier_at_t0'><p>Compute value of Kaplan-Meier estimate at a given time</p></a></li>
<li><a href='#lambda_j_Exp'><p>Compute lambda_j</p></a></li>
<li><a href='#piecewiseExp_MLE'><p>Estimate hazard function in piecewise Exponential survival model</p></a></li>
<li><a href='#piecewiseExp_profile_loglik_tau'><p>Profile maximum log-likelihood function for change points in piecewise Exponential survival model</p></a></li>
<li><a href='#piecewiseExp_test_changepoint'><p>Wald test to infer change point in piecewise Exponential survival model</p></a></li>
<li><a href='#predictEvents'><p>Compute timepoint when a certain number of events in a time-to-event study is reached</p></a></li>
<li><a href='#predictEventsUncond'><p>compute expected number of events based on a fixed survival function and with no recruited patients yet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Event Prediction for Time-to-Event Endpoints</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-02-21</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kaspar Rufibach &lt;kaspar.rufibach@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival, muhaz, R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, rpact (&ge; 3.3.1), fitdistrplus, gestate</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements the hybrid framework for event prediction described in Fang &amp; Zheng (2011, &lt;<a href="https://doi.org/10.1016%2Fj.cct.2011.05.013">doi:10.1016/j.cct.2011.05.013</a>&gt;). To estimate the survival function the event prediction is based on, a piecewise exponential hazard function is fit to the time-to-event data to infer the potential change points. Prior to the last identified change point, the survival function is estimated using Kaplan-Meier, and the tail after the change point is fit using piecewise exponential. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-21 19:15:00 UTC; kaspa</td>
</tr>
<tr>
<td>Author:</td>
<td>Kaspar Rufibach [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-22 11:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='eventTrack-package'>Event Prediction for Time-to-Event Endpoints</h2><span id='topic+eventTrack-package'></span><span id='topic+eventTrack'></span>

<h3>Description</h3>

<p>Implements the hybrid framework for event prediction described in Fang &amp; Zheng (2011). To estimate the survival function the event prediction is based on, a piecewise Exponential hazard function is fit to the time-to-event data to infer the potential change points. Prior to the last identified change point, the survival function is estimated using Kaplan-Meier, and the tail after the change point is fit using piecewise Exponential. The Weibull version described in Fang and Zheng (2011) is not implemented here.
</p>
<p>An example has been presented in this talk: <a href="https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf">https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf</a>.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package:  </td><td style="text-align: left;"> eventTrack  </td>
</tr>
<tr>
 <td style="text-align: left;">
Type:     </td><td style="text-align: left;"> Package    </td>
</tr>
<tr>
 <td style="text-align: left;">
Version:  </td><td style="text-align: left;"> 1.0.4      </td>
</tr>
<tr>
 <td style="text-align: left;">
Date:     </td><td style="text-align: left;"> 2025-02-21 </td>
</tr>
<tr>
 <td style="text-align: left;">
License:  </td><td style="text-align: left;"> GPL (&gt;=2)  </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes        </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Validation status</h3>

<p>The functions in this package have been written by Kaspar Rufibach and are generally to be considered experimental.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> 
<a href="mailto:kaspar.rufibach@gmail.com">kaspar.rufibach@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --------------------------------------------------
# simulate data 
# --------------------------------------------------
set.seed(2021)
n &lt;- 600
time0 &lt;- rexp(n, rate = log(2) / 20)
cens &lt;- rexp(n, rate = log(2) / 50)
time &lt;- pmin(time0, cens)
event &lt;- as.numeric(time0 &lt; cens)
accrual_after_ccod &lt;- 1:(n - length(time)) / 30

# --------------------------------------------------
# compute hybrid estimate and predict timepoint
# --------------------------------------------------
plot(survfit(Surv(time, event) ~ 1), mark = "", xlim = c(0, 200), 
     ylim = c(0, 1), conf.int = FALSE, xaxs = "i", yaxs = "i",
     main = "estimated survival functions", xlab = "time", 
     ylab = "survival probability", col = grey(0.75), lwd = 5)

# how far out should we predict monthly number of events?
future.units &lt;- 15
tab &lt;- matrix(NA, ncol = 2, nrow = future.units)
tab[, 1] &lt;- 1:nrow(tab)
ts &lt;- seq(0, 100, by = 0.01)

# --------------------------------------------------
# starting from a piecewise Exponential hazard with 
# K = 5 change points, infer the last "significant"
# change point
# --------------------------------------------------
pe5 &lt;- piecewiseExp_MLE(time = time, event = event, K = 5)
pe5.tab &lt;- piecewiseExp_test_changepoint(peMLE = pe5, alpha = 0.05)
cp.select &lt;- max(c(0, as.numeric(pe5.tab[, "established change point"])), na.rm = TRUE)

# the function predictEvents takes as an argument any survival function
# hybrid exponential with cp.select
St1 &lt;- function(t0, time, event, cp){
     return(hybrid_Exponential(t0 = t0, time = time, event = event, 
     changepoint = cp))}

pe1 &lt;- predictEvents(time = time, event = event, 
          St = function(t0){St1(t0, time = time, 
          event = event, cp.select)}, accrual_after_ccod, 
          future.units = future.units)
tab[, 2] &lt;- pe1[, 2]
lines(ts, St1(ts, time, event, cp.select), col = 2, lwd = 2)

# --------------------------------------------------
# compute exact date when we see targeted number of events
# for hybrid Exponential model, through linear interpolation
# --------------------------------------------------
exactDatesFromMonths(predicted = tab, 450)
</code></pre>

<hr>
<h2 id='bootstrapTimeToEvent'>Bootstrap the predicted time when a given number of events is reached, for hybrid Exponential model</h2><span id='topic+bootstrapTimeToEvent'></span>

<h3>Description</h3>

<p>Bootstrap the predicted time when a given number of events is reached, based on the hybrid Exponential model.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrapTimeToEvent(time, event, interim.gates, future.units, n, M0 = 1000, 
                            K0 = 5, alpha = 0.05, accrual, seed = 2014)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootstrapTimeToEvent_+3A_time">time</code></td>
<td>
<p>Event times.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 0 = censored, 1 = event.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_interim.gates">interim.gates</code></td>
<td>
<p>Number of events for which confidence intervals should be computed. May be a vector.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_future.units">future.units</code></td>
<td>
<p>Number of months for which predictions are to be made.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_n">n</code></td>
<td>
<p>Size of the bootstrap samples to be drawn from <code>surv.obj</code>.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_m0">M0</code></td>
<td>
<p>Number of bootstrap samples to be drawn.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_k0">K0</code></td>
<td>
<p>Number of changepoints for the piecewise constant hazard.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_alpha">alpha</code></td>
<td>
<p>Familywise error rate for the sequential test.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_accrual">accrual</code></td>
<td>
<p>Vector of dates when future patients enter the study. As for the specification, assume 50 pts are to be recruited in Dec 2013 and 20pts in Jan 2014, then use <code>accrual &lt;- c(rep(as.Date("2013-12-01"), 50), rep(as.Date("2014-01-01"), 20))</code>. Leave as <code>NULL</code> if accrual for the study is completed.</p>
</td></tr>
<tr><td><code id="bootstrapTimeToEvent_+3A_seed">seed</code></td>
<td>
<p>Seed for generation of bootstrap samples.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following objects:
</p>
<table role = "presentation">
<tr><td><code>pe.MLEs</code></td>
<td>
<p>Piecewise Exponential MLE object for each bootstrap sample, output of function <code><a href="#topic+piecewiseExp_MLE">piecewiseExp_MLE</a></code>.</p>
</td></tr>
<tr><td><code>pe.tabs</code></td>
<td>
<p>Result of sequential test for each bootstrap sample, output of function <code><a href="#topic+piecewiseExp_test_changepoint">piecewiseExp_test_changepoint</a></code>.</p>
</td></tr>
<tr><td><code>changepoints</code></td>
<td>
<p>For each bootstrap sample, changepoint as resulting from sequential test.</p>
</td></tr>
<tr><td><code>estS</code></td>
<td>
<p>Estimated survival function for each bootstrap sample.</p>
</td></tr>
<tr><td><code>event.dates</code></td>
<td>
<p>Event dates for each bootstrap sample, where columns relate to the number of events in <code>interim.gates</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Rufibach, K. (2016).
<em>Event projection: quantify uncertainty and manage expectations of broader teams.</em>
Slides for talk given in Basel Biometric Section Seminar on 28th April 2016.
<a href="https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf">https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
# --------------------------------------------------
# simulate data for illustration
# --------------------------------------------------
set.seed(2021)
n &lt;- 600
time &lt;- rexp(n, rate = log(2) / 20)
event &lt;- sample(round(runif(n, 0, 1)))
accrual_after_ccod &lt;- 1:(n - length(time)) / 30

# --------------------------------------------------
# run bootstrap, for M0 = 3 only, for illustration
# tune parameters for your own example
# --------------------------------------------------
boot1 &lt;- bootstrapTimeToEvent(time, event, 
          interim.gates = c(330, 350), future.units = 50, n = length(time), 
          M0 = 3, K0 = 5, alpha = 0.05, accrual = accrual_after_ccod, 
          seed = 2014)

# median of bootstrap samples:
apply(boot1$event.dates, 2, median)

## End(Not run)
</code></pre>

<hr>
<h2 id='bootSurvivalSample'>Bootstrap survival data</h2><span id='topic+bootSurvivalSample'></span>

<h3>Description</h3>

<p>Generate bootstrap samples from a survival object, for right-censored data. See Efron (1981) and Akritas (1986) for details.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootSurvivalSample(surv.obj, n, M = 1000)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bootSurvivalSample_+3A_surv.obj">surv.obj</code></td>
<td>
<p><code>Surv</code> object containing survival times and censoring indicator.</p>
</td></tr>
<tr><td><code id="bootSurvivalSample_+3A_n">n</code></td>
<td>
<p>Size of the bootstrap samples to be drawn from <code>surv.obj</code>.</p>
</td></tr>
<tr><td><code id="bootSurvivalSample_+3A_m">M</code></td>
<td>
<p>Number of bootstrap samples to be drawn.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with bootstrap samples as columns.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Akritas, M.G. (1986).
Bootstrapping the Kaplan-Meier Estimator.
<em>JASA</em>, <b>81</b>, 1032-1038
</p>
<p>Efron, B. (1981).
Censored Data and the Bootstrap.
<em>JASA</em>, <b>76</b>, 312-319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># --------------------------------------------------
# simulate data for illustration
# --------------------------------------------------
set.seed(2021)
n &lt;- 600
time &lt;- rexp(n, rate = log(2) / 20)
event &lt;- sample(round(runif(n, 0, 1)))

# --------------------------------------------------
# draw 20 bootstrap samples of size 10
# --------------------------------------------------
bootSurvivalSample(surv.obj = Surv(time, event), n = 10, M = 20)
</code></pre>

<hr>
<h2 id='exactDatesFromMonths'>Compute exact timepoint when a certain number of events is reached, based on monthly number of events</h2><span id='topic+exactDatesFromMonths'></span>

<h3>Description</h3>

<p>Based on monhtly number of events, compute exact day when the pre-specified number of events happens, using simple linear interpolation.</p>


<h3>Usage</h3>

<pre><code class='language-R'>exactDatesFromMonths(predicted, nevent)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exactDatesFromMonths_+3A_predicted">predicted</code></td>
<td>
<p><code>data.frame</code>, with first column monthly dates and second column the number of events in each month.</p>
</td></tr>
<tr><td><code id="exactDatesFromMonths_+3A_nevent">nevent</code></td>
<td>
<p>Number of targeted events.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The exact date.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a> 
</p>

<hr>
<h2 id='hybrid_Exponential'>Estimate survival function, as hybrid between Kaplan-Meier and Exponential tail</h2><span id='topic+hybrid_Exponential'></span>

<h3>Description</h3>

<p>This function estimates the values of the survival function as a hybrid of Kaplan-Meier for times smaller than the specified change point and an Exponential fit to the tail of the survival function. The Exponential tail fit is computed assuming a piecewise constant hazard with one change point.</p>


<h3>Usage</h3>

<pre><code class='language-R'>hybrid_Exponential(t0, time = time, event = event, changepoint)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hybrid_Exponential_+3A_t0">t0</code></td>
<td>
<p>Value at which to compute value of survival function. Can be a vector.</p>
</td></tr>
<tr><td><code id="hybrid_Exponential_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed, in months.</p>
</td></tr>
<tr><td><code id="hybrid_Exponential_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
<tr><td><code id="hybrid_Exponential_+3A_changepoint">changepoint</code></td>
<td>
<p>Pre-specified change point.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of the same dimension as <code>t0</code> containing the values of the estimated survival function at <code>t0</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a> 
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>
<p>Rufibach, K. (2016).
<em>Event projection: quantify uncertainty and manage expectations of broader teams.</em>
Slides for talk given in Basel Biometric Section Seminar on 28th April 2016.
<a href="https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf">https://baselbiometrics.github.io/home/docs/talks/20160428/1_Rufibach.pdf</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# --------------------------------------------------
# simulate data 
# --------------------------------------------------
set.seed(2021)
n &lt;- 600
time0 &lt;- rexp(n, rate = log(2) / 20)
cens &lt;- rexp(n, rate = log(2) / 50)
time &lt;- pmin(time0, cens)
event &lt;- as.numeric(time0 &lt; cens)
accrual_after_ccod &lt;- 1:(n - length(time)) / 30

# --------------------------------------------------
# compute hybrid estimate and predict timepoint
# --------------------------------------------------
plot(survfit(Surv(time, event) ~ 1), mark = "", xlim = c(0, 200), 
     ylim = c(0, 1), conf.int = FALSE, xaxs = "i", yaxs = "i",
     main = "estimated survival functions", xlab = "time", 
     ylab = "survival probability", col = grey(0.75), lwd = 5)

# how far out should we predict monthly number of events?
future.units &lt;- 15
tab &lt;- matrix(NA, ncol = 2, nrow = future.units)
tab[, 1] &lt;- 1:nrow(tab)
ts &lt;- seq(0, 100, by = 0.01)

# --------------------------------------------------
# starting from a piecewise Exponential hazard with 
# K = 5 change points, infer the last "significant"
# change point
# --------------------------------------------------
pe5 &lt;- piecewiseExp_MLE(time = time, event = event, K = 5)
pe5.tab &lt;- piecewiseExp_test_changepoint(peMLE = pe5, alpha = 0.05)
cp.select &lt;- max(c(0, as.numeric(pe5.tab[, "established change point"])), na.rm = TRUE)

# the function predictEvents takes as an argument any survival function
# hybrid exponential with cp.select
St1 &lt;- function(t0, time, event, cp){
     return(hybrid_Exponential(t0 = t0, time = time, event = event, 
     changepoint = cp))}

pe1 &lt;- predictEvents(time = time, event = event, 
          St = function(t0){St1(t0, time = time, 
          event = event, cp.select)}, accrual_after_ccod, 
          future.units = future.units)
tab[, 2] &lt;- pe1[, 2]
lines(ts, St1(ts, time, event, cp.select), col = 2, lwd = 2)

# --------------------------------------------------
# compute exact date when we see targeted number of events
# for hybrid Exponential model, through linear interpolation
# --------------------------------------------------
exactDatesFromMonths(predicted = tab, 450)
</code></pre>

<hr>
<h2 id='kaplanMeier_at_t0'>Compute value of Kaplan-Meier estimate at a given time</h2><span id='topic+kaplanMeier_at_t0'></span>

<h3>Description</h3>

<p>Compute value of Kaplan-Meier estimate at a given time <code class="reqn">t_0</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>kaplanMeier_at_t0(time, event, t0)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kaplanMeier_at_t0_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed.</p>
</td></tr>
<tr><td><code id="kaplanMeier_at_t0_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
<tr><td><code id="kaplanMeier_at_t0_+3A_t0">t0</code></td>
<td>
<p>Vector (or single number) of time points to compute confidence interval for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with values of Kaplan-Meier estimate at <code class="reqn">t_0</code>.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># use Acute Myelogenous Leukemia survival data contained in package 'survival'
time &lt;- leukemia[, 1]
status &lt;- leukemia[, 2]

tmp &lt;- Surv(time, status) ~ 1
plot(survfit(tmp, conf.type = "none"), mark = "/", col = 1:2)
kaplanMeier_at_t0(time, status, t0 = c(10, 25, 50))
</code></pre>

<hr>
<h2 id='lambda_j_Exp'>Compute lambda_j</h2><span id='topic+lambda_j_Exp'></span>

<h3>Description</h3>

<p>For given change points <code class="reqn">\tau_1, \ldots, \tau_k</code>, compute the profile maximum likelihood estimates <code class="reqn">\lambda_1, \ldots, \lambda_{k + 1}</code> for the values of the piecewise constant hazard function in a piecewise Exponential survival model. Standard errors for these estimates are provided as well, based on standard maximum (profile) maximum likelihood theory.</p>


<h3>Usage</h3>

<pre><code class='language-R'>lambda_j_Exp(tau, time, event)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lambda_j_Exp_+3A_tau">tau</code></td>
<td>
<p>Single number or vector with values of change points.</p>
</td></tr>
<tr><td><code id="lambda_j_Exp_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed, in months.</p>
</td></tr>
<tr><td><code id="lambda_j_Exp_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>aj</code></td>
<td>
<p>The esimtates of the <code class="reqn">\lambda_j</code>.</p>
</td></tr>
<tr><td><code>hess.diag</code></td>
<td>
<p>The diagonal of the corresponding Hessian matrix. Note that the off-diagonal elements of the Hessian are all equal to 0.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This function is not intended to be invoked by the end user.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>

<hr>
<h2 id='piecewiseExp_MLE'>Estimate hazard function in piecewise Exponential survival model</h2><span id='topic+piecewiseExp_MLE'></span>

<h3>Description</h3>

<p>This function estimates the values of the hazard function and the change points in a piecewise Exponential survival model. The number of change points <code class="reqn">K</code> needs to be pre-specified.</p>


<h3>Usage</h3>

<pre><code class='language-R'>piecewiseExp_MLE(time, event, K)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="piecewiseExp_MLE_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed, in months.</p>
</td></tr>
<tr><td><code id="piecewiseExp_MLE_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
<tr><td><code id="piecewiseExp_MLE_+3A_k">K</code></td>
<td>
<p>Number of change points to be used in the model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following objects:
</p>
<table role = "presentation">
<tr><td><code>tau</code></td>
<td>
<p>The maximum likelihood estimates of the change points.</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The maximum likelihood estimates of the value of the hazard function.</p>
</td></tr>
<tr><td><code>lambda.SE</code></td>
<td>
<p>The standard errors of <code>lambda</code>.</p>
</td></tr>
<tr><td><code>K</code></td>
<td>
<p>Number of change points to be used in the model.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see vignette</code></pre>

<hr>
<h2 id='piecewiseExp_profile_loglik_tau'>Profile maximum log-likelihood function for change points in piecewise Exponential survival model</h2><span id='topic+piecewiseExp_profile_loglik_tau'></span>

<h3>Description</h3>

<p>In a piecewise Exponential survival model, the estimates for the value of the hazard function can be given explicitly, see Fang and Su (2011), and can be computed using <code><a href="#topic+lambda_j_Exp">lambda_j_Exp</a></code>. The values of the change points can then be computed using the profile log-likelihood function. The function <code>piecewiseExp_profile_loglik_tau</code> computes the value of this profile log-likelihood function and can be used together with <code><a href="stats.html#topic+optim">optim</a></code> to compute the change points <code class="reqn">\tau_1, \ldots, \tau_{k}</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>piecewiseExp_profile_loglik_tau(tau, time, event)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="piecewiseExp_profile_loglik_tau_+3A_tau">tau</code></td>
<td>
<p>Single number or vector with values of change points.</p>
</td></tr>
<tr><td><code id="piecewiseExp_profile_loglik_tau_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed, in months.</p>
</td></tr>
<tr><td><code id="piecewiseExp_profile_loglik_tau_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the profile likelihood function.</p>


<h3>Note</h3>

<p>This function is not intended to be invoked by the end user.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>

<hr>
<h2 id='piecewiseExp_test_changepoint'>Wald test to infer change point in piecewise Exponential survival model</h2><span id='topic+piecewiseExp_test_changepoint'></span>

<h3>Description</h3>

<p>This function implements the Wald test described in Goodman et al (2011) and applied in Fang &amp; Zheng (2011) to infer a change point in an estimated piecewise Exponential hazard function. Adjusts for sequential testing.</p>


<h3>Usage</h3>

<pre><code class='language-R'>piecewiseExp_test_changepoint(peMLE, alpha = 0.05)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="piecewiseExp_test_changepoint_+3A_pemle">peMLE</code></td>
<td>
<p>Piecewise Exponential hazard function estimate, as generated by <code><a href="#topic+piecewiseExp_MLE">piecewiseExp_MLE</a></code>.</p>
</td></tr>
<tr><td><code id="piecewiseExp_test_changepoint_+3A_alpha">alpha</code></td>
<td>
<p>Overall significance level. Will be adjusted for sequential testing internally, see function output.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> containing the sequential test results.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a> 
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see vignette</code></pre>

<hr>
<h2 id='predictEvents'>Compute timepoint when a certain number of events in a time-to-event study is reached</h2><span id='topic+predictEvents'></span>

<h3>Description</h3>

<p>Based on a specified survival function and potential future accrual, compute for each month in the future the number of expected events reached by then.</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictEvents(time, event, St, accrual, future.units = 50)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictEvents_+3A_time">time</code></td>
<td>
<p>Event times, censored or observed, in months.</p>
</td></tr>
<tr><td><code id="predictEvents_+3A_event">event</code></td>
<td>
<p>Censoring indicator, 1 for event, 0 for censored.</p>
</td></tr>
<tr><td><code id="predictEvents_+3A_st">St</code></td>
<td>
<p>Function that specifies the survival function to be used.</p>
</td></tr>
<tr><td><code id="predictEvents_+3A_accrual">accrual</code></td>
<td>
<p><code>NULL</code> if trial is fully accrued. For potential future accural, see example in <code><a href="#topic+hybrid_Exponential">hybrid_Exponential</a></code> of how to specify it.</p>
</td></tr>
<tr><td><code id="predictEvents_+3A_future.units">future.units</code></td>
<td>
<p>Number of future months to compute prediction for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the months and corresponding expected events.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a> 
</p>


<h3>References</h3>

<p>Fang, L., Zheng, S. (2011).
A hybrid approach to predicting events in clinical trials with time-to-event outcomes.
<em>Contemp. Clin. Trials</em>, <b>32</b>, 755&ndash;759. 
</p>
<p>Goodman, M.S., Li, Y., Tiwari, R.C. (2011).
Detecting multiple change points in piecewise constant hazard functions.
<em>J. Appl. Stat</em>, <b>38(11)</b>, 2523&ndash;2532.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># see vignette</code></pre>

<hr>
<h2 id='predictEventsUncond'>compute expected number of events based on a fixed survival function and with no recruited patients yet</h2><span id='topic+predictEventsUncond'></span>

<h3>Description</h3>

<p>Based on a specified survival function and future accrual, compute for each month in the future the number of expected events reached by then, based on a fixed pre-specified survival function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictEventsUncond(St, accrual, future.units = 50)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predictEventsUncond_+3A_st">St</code></td>
<td>
<p>Function that specifies the survival function to be used.</p>
</td></tr>
<tr><td><code id="predictEventsUncond_+3A_accrual">accrual</code></td>
<td>
<p><code>NULL</code> if trial is fully accrued. For potential future accural, see the example below how to specify it.</p>
</td></tr>
<tr><td><code id="predictEventsUncond_+3A_future.units">future.units</code></td>
<td>
<p>Number of future months to compute prediction for.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>data.frame</code> with the months and corresponding expected events.</p>


<h3>Author(s)</h3>

<p>Kaspar Rufibach (maintainer) <br /> <a href="mailto:kaspar.rufibach@roche.com">kaspar.rufibach@roche.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# compute date when 380 events are reached:
nevent &lt;- 380
n &lt;- 800
accrual.month &lt;- 50
accrual &lt;- rep(seq(1, 16), each = accrual.month)
rate &lt;- log(2) / 12

St1 &lt;- function(t0){
      res &lt;- 1 - pexp(t0, rate = rate)
      return(res)
}
pred1 &lt;- predictEventsUncond(St = St1, accrual, future.units = 25)
pred1
exactDatesFromMonths(predicted = pred1, nevent)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
