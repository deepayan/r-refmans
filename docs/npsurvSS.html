<!DOCTYPE html><html><head><title>Help for package npsurvSS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {npsurvSS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#create_arm'><p>Create an 'arm' object</p></a></li>
<li><a href='#create_arm_lachin'><p>Create a 'lachin' object</p></a></li>
<li><a href='#daccr'><p>Accrual</p></a></li>
<li><a href='#dloss'><p>Loss to follow-up</p></a></li>
<li><a href='#dmaxU'><p>Maximum observed time</p></a></li>
<li><a href='#dminimaxU'><p>Minimax observed time</p></a></li>
<li><a href='#dsurv'><p>Survival</p></a></li>
<li><a href='#exp_duration'><p>Expected duration</p></a></li>
<li><a href='#exp_events'><p>Expected number of events</p></a></li>
<li><a href='#per2haz'><p>Convert exponential parameters</p></a></li>
<li><a href='#power_two_arm'><p>Power</p></a></li>
<li><a href='#simulate_arm'><p>Simulate complete data for a single arm</p></a></li>
<li><a href='#simulate_trial'><p>Simulate a clinical trial</p></a></li>
<li><a href='#size_two_arm'><p>Sample size</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sample Size and Power Calculation for Common Non-Parametric
Tests in Survival Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Godwin Yung [aut, cre],
  Yi Liu [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Godwin Yung &lt;godwin.y.yung@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A number of statistical tests have been proposed to compare two 
  survival curves, including the difference in (or ratio of) t-year 
  survival, difference in (or ratio of) p-th percentile survival, difference in
  (or ratio of) restricted mean survival time, and the weighted log-rank test. 
  Despite the multitude of options, the convention in survival studies is to assume
  proportional hazards and to use the unweighted log-rank test for design and 
  analysis. This package provides sample size and power 
  calculation for all of the above statistical tests with allowance for 
  flexible accrual, censoring, and survival (eg. Weibull, piecewise-exponential, 
  mixture cure). It is the companion R package to the paper by Yung and Liu (2019)
  &lt;<a href="https://doi.org/10.1111%2Fbiom.13196">doi:10.1111/biom.13196</a>&gt;. Specific to the weighted log-rank test, users may 
  specify which approximations they wish to use to estimate the large-sample mean 
  and variance. The default option has been shown to provide substantial
  improvement over the conventional sample size and power equations based on Schoenfeld 
  (1981) &lt;<a href="https://doi.org/10.1093%2Fbiomet%2F68.1.316">doi:10.1093/biomet/68.1.316</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, tidyverse, ggplot2</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://github.com/godwinyung/npsurvSS">http://github.com/godwinyung/npsurvSS</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="http://github.com/godwinyung/npsurvSS/issues">http://github.com/godwinyung/npsurvSS/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-12-16 00:14:44 UTC; goyung</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-12-18 15:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='create_arm'>Create an 'arm' object</h2><span id='topic+create_arm'></span>

<h3>Description</h3>

<p>Create an object of class 'arm' by specifying the trial parameters for
a single arm, including the sample size, accrual distribution,
survival distribution, loss to follow-up distribution, and study duration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_arm(size, accr_time, accr_dist = "pieceuni",
  accr_interval = c(0, accr_time), accr_param = NA, surv_cure = 0,
  surv_interval = c(0, Inf), surv_shape = 1, surv_scale,
  loss_shape = 1, loss_scale, follow_time = Inf, total_time = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_arm_+3A_size">size</code></td>
<td>
<p>sample size. If total sample size is unknown, provide
the integer sample size relative to the opposing arm, e.g. 1 for
1:2 randomization ratio or 2 for 2:3.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_accr_time">accr_time</code></td>
<td>
<p>accrual duration.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_accr_dist">accr_dist</code></td>
<td>
<p>accrual distribution. Default is piecewise uniform.
Alternatively, 'truncexp' allows for a truncated exponential distribution
as proposed by Lachin and Foulkes (1986). Depending on the value of
<code>accr_param</code>, this distribution can be either convex or concave.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_accr_interval">accr_interval</code></td>
<td>
<p>accrual intervals. Defaults to the single interval
spanning from 0 to <code>accr_time</code>. If a piecewise uniform accrual
with more than one interval is desired, specify <code>accr_interval</code>
as the vector of increasing changepoints (knots) starting from 0 and
ending with <code>accr_time</code>, e.g. c(0, 2, 4) defines a piecewise
uniform distribution with two intervals, [0, 2) and [2, 4].</p>
</td></tr>
<tr><td><code id="create_arm_+3A_accr_param">accr_param</code></td>
<td>
<p>additional accrual parameter(s). For a piecewise uniform accrual
with more than one interval, specify <code>accr_param</code> as the vector of probabilities
a patient is enrolled in each interval. The probabilities should naturally sum to 1.
For <code>accr_dist</code>='truncexp', specify <code>accr_param</code> as a single number.
&gt;0 results in a convex distribution and &lt;0 results in a concave distribution.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_surv_cure">surv_cure</code></td>
<td>
<p>proportion of patients that are cured.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_surv_interval">surv_interval</code></td>
<td>
<p>survival intervals. Defaults to the single interval
spanning from 0 to infinity. If a piecewise exponential survival is
desired for uncured patients, specify <code>surv_interval</code> as the vector
of increasing changepoints (knots) starting from 0 and ending with infinity,
e.g. c(0, 6, 10, Inf).</p>
</td></tr>
<tr><td><code id="create_arm_+3A_surv_shape">surv_shape</code></td>
<td>
<p>Weibull shape parameter for the survival distribution of
uncured patients.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_surv_scale">surv_scale</code></td>
<td>
<p>Weibull scale parameter for the survival distrubition of
uncured patients. Piecewise exponential survival may be defined by specifying
<code>surv_shape</code>=1 and <code>surv_scale</code> as the vector of piecewise hazard
rates.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_loss_shape">loss_shape</code></td>
<td>
<p>Weibull shape parameter for the loss to follow-up distribution.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_loss_scale">loss_scale</code></td>
<td>
<p>Weibull scale parameter for the loss to follow-up distribution.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_follow_time">follow_time</code></td>
<td>
<p>follow-up duration.</p>
</td></tr>
<tr><td><code id="create_arm_+3A_total_time">total_time</code></td>
<td>
<p>total study duration. Only 1 of the 2 parameters, <code>follow_time</code>
or <code>total_time</code>, need to be defined. If neither is defined, <code>total_time</code>
is defaulted to max value 1e6.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing assumptions of size, accrual, censoring, survival, and
follow-up for a single arm.
</p>


<h3>References</h3>

<p>Lachin, J. M. and Foulkes, M. A. (1986) Evaluation of sample size and power for analyses of
survival with allowance for nonuniform patient entry, losses to follow-up,
noncompliance, and stratification. <em>Biometrics</em>, <strong>42</strong>, 507-519.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code> for creating an object of subclass 'lachin'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1
example &lt;- create_arm(size=120,
  accr_time=6,                   # uniform accrual
  surv_scale=0.05,               # exponential survival
  loss_scale=0.005,              # exponential loss to follow-up
  follow_time=12)
class(example)                   # this example also satisfies properties of subclass 'lachin'

# Example 2
create_arm(size=120,
  accr_time=6,                   # truncated exponential accrual
  accr_dist="truncexp",
  accr_param=0.1,
  surv_shape=2,                  # weibull survival
  surv_scale=0.05,
  loss_shape=1.5,                # weilbull loss to follow-up
  loss_scale=0.005,
  total_time=18)

# Example 3
create_arm(size=120,
  accr_time=6,
  accr_interval=c(0,2,4,6),      # piecewise uniform accrual
  accr_param=c(0.2,0.3,0.5),
  surv_cure=0.1,                 # 10% cure fraction
  surv_interval=c(0,6,10,Inf),   # piecewise exponential survival for uncured patients
  surv_scale=c(0.05,0.04,0.03),
  loss_shape=0.7,                # weibull loss to follow-up
  loss_scale=0.005,
  total_time=18)
</code></pre>

<hr>
<h2 id='create_arm_lachin'>Create a 'lachin' object</h2><span id='topic+create_arm_lachin'></span>

<h3>Description</h3>

<p>Create an object of class 'lachin' by specifying the trial parameters for
a single arm, including the sample size, accrual distribution,
survival distribution, loss to follow-up distribution, and study duration.
'Lachin' objects are also 'arm' objects, but with accrual limited
to the uniform and truncated exponential distributions, and survival and
loss to follow-up limited to the exponential distribution. 'Lachin' objects
have the advantage that expectations for certain counting processes have
closed form equations and can therefore be calculated more efficiently
(Lachin and Foulkes, 1986).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_arm_lachin(size, accr_time, accr_dist = "pieceuni",
  accr_param = NA, surv_median = NA, surv_exphazard = NA,
  surv_milestone = NA, loss_median = NA, loss_exphazard = NA,
  loss_milestone = NA, follow_time = Inf, total_time = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_arm_lachin_+3A_size">size</code></td>
<td>
<p>sample size. If total sample size is unknown, provide
the integer sample size relative to the opposing arm, e.g. 1 for
1:2 randomization ratio or 2 for 2:3.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_accr_time">accr_time</code></td>
<td>
<p>accrual duration.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_accr_dist">accr_dist</code></td>
<td>
<p>accrual distribution. Default is uniform (piecewise uniform
with one interval). Alternatively, 'truncexp' allows for a truncated
exponential distribution as proposed by Lachin and Foulkes (1986).
Depending on the value of <code>accr_param</code>, this distribution can be
either convex or concave.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_accr_param">accr_param</code></td>
<td>
<p>additional accrual parameter for <code>accr_dist</code>='truncexp'.
<code>accr_param</code>&gt;0 specifies a convex distribution and <code>accr_param</code>&lt;0
specifies a concave distribution.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_surv_median">surv_median</code></td>
<td>
<p>median survival.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_surv_exphazard">surv_exphazard</code></td>
<td>
<p>exponential hazard rate for the survival distribution.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_surv_milestone">surv_milestone</code></td>
<td>
<p>a tuple c(milestone, probability) that uniquely defines the
exponential survival distribution, e.g. c(12, 0.8) corresponds to the exponential
distribution with 80% survival rate at 12 months.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_loss_median">loss_median</code></td>
<td>
<p>median loss to follow-up.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_loss_exphazard">loss_exphazard</code></td>
<td>
<p>exponential hazard rate for the loss to follow-up distribution.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_loss_milestone">loss_milestone</code></td>
<td>
<p>a tuple c(milestone, probability) that uniquely defines the
exponential loss to follow-up distribution, e.g. c(12, 0.99) corresponds to the
exponential distribution with 1% loss to follow-up at 12 months.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_follow_time">follow_time</code></td>
<td>
<p>Follow-up duration. Either <code>follow_time</code> or
<code>total_time</code> (below) should be specified.</p>
</td></tr>
<tr><td><code id="create_arm_lachin_+3A_total_time">total_time</code></td>
<td>
<p>Total study duration. Either <code>follow_time</code> (above) or
<code>total_time</code> should be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing assumptions of size, accrual, censoring, survival, and
follow-up for a single arm.
</p>


<h3>References</h3>

<p>Lachin, J. M. and Foulkes, M. A. (1986) Evaluation of sample size and power for analyses of
survival with allowance for nonuniform patient entry, losses to follow-up,
noncompliance, and stratification. <em>Biometrics</em>, <strong>42</strong>, 507-519.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3 arms with similar survival and loss to follow-up
create_arm_lachin(size=120, accr_time=6,
  surv_median=14,
  loss_median=140,
  follow_time=12)
create_arm_lachin(size=120, accr_time=6,
  surv_exphazard=0.05,
  loss_exphazard=0.005,
  follow_time=12)
create_arm_lachin(size=120, accr_time=6,
  accr_dist="truncexp",
  accr_param=0.1,
  surv_milestone=c(14, 0.5),
  loss_milestone=c(140, 0.5),
  total_time=18)
</code></pre>

<hr>
<h2 id='daccr'>Accrual</h2><span id='topic+daccr'></span><span id='topic+paccr'></span><span id='topic+qaccr'></span><span id='topic+raccr'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function,
and random generation for the accrual distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daccr(x, arm)

paccr(q, arm, lower.tail = T)

qaccr(p, arm)

raccr(n = 1, arm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="daccr_+3A_x">x</code>, <code id="daccr_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="daccr_+3A_arm">arm</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="daccr_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE, probabilities are <code class="reqn">P(X \le x)</code>;
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="daccr_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="daccr_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>daccr</code> gives the density, <code>paccr</code> gives the distribution
function, <code>qaccr</code> gives the quantile function, and <code>raccr</code> generates
random deviates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>

<hr>
<h2 id='dloss'>Loss to follow-up</h2><span id='topic+dloss'></span><span id='topic+ploss'></span><span id='topic+hloss'></span><span id='topic+qloss'></span><span id='topic+rloss'></span>

<h3>Description</h3>

<p>Density, distribution function, hazard function, quantile function,
and random generation for the loss to follow-up distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dloss(x, arm)

ploss(q, arm, lower.tail = T)

hloss(x, arm)

qloss(p, arm, lower.tail = T)

rloss(n = 1, arm)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dloss_+3A_x">x</code>, <code id="dloss_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dloss_+3A_arm">arm</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="dloss_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE, probabilities are <code class="reqn">P(X \le x)</code>;
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="dloss_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dloss_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dloss</code> gives the density, <code>ploss</code> gives the distribution
function, <code>hloss</code> gives the hazard function, <code>qloss</code> gives the
quantile function, and <code>rloss</code> generates random deviates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>

<hr>
<h2 id='dmaxU'>Maximum observed time</h2><span id='topic+dmaxU'></span><span id='topic+pmaxU'></span><span id='topic+emaxU'></span>

<h3>Description</h3>

<p>Density, distribution function, and expected value for the maximum observed
time in a single arm of patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmaxU(x, arm, include_cens = T)

pmaxU(q, arm, include_cens = T, lower.tail = T)

emaxU(arm, include_cens = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dmaxU_+3A_x">x</code>, <code id="dmaxU_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dmaxU_+3A_arm">arm</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="dmaxU_+3A_include_cens">include_cens</code></td>
<td>
<p>logical; if TRUE, include time-to-censoring as potential
observed time; otherwise, observed time equals time-to-event.</p>
</td></tr>
<tr><td><code id="dmaxU_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE, probabilities are <code class="reqn">P(X \le x)</code>;
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a patient's time-to-event <code class="reqn">T_i</code> and time-to-censoring
<code class="reqn">C_i</code>, <code class="reqn">U_i=\min(T_i, C_i)</code> defines the patient's observed time. The
maximum observed time over patients of a single arm is then <code class="reqn">\max_i U_i</code>.
</p>


<h3>Value</h3>

<p><code>dmaxU</code> gives the density, <code>pmaxU</code> gives the distribution
function, and <code>emaxU</code> gives the expected value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>

<hr>
<h2 id='dminimaxU'>Minimax observed time</h2><span id='topic+dminimaxU'></span><span id='topic+pminimaxU'></span><span id='topic+qminimaxU'></span><span id='topic+eminimaxU'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function, and expected value for the
minimum of the maximum observed time over two treatment arms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dminimaxU(x, arm0, arm1, include_cens = T)

pminimaxU(q, arm0, arm1, include_cens = T, lower.tail = T)

qminimaxU(p, arm0, arm1, include_cens = T, margin = 0.01)

eminimaxU(arm0, arm1, include_cens = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dminimaxU_+3A_x">x</code>, <code id="dminimaxU_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_include_cens">include_cens</code></td>
<td>
<p>logical; if TRUE, include time-to-censoring as potential
observed time; otherwise, observed time equals time-to-event.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE, probabilities are <code class="reqn">P(X \le x)</code>;
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dminimaxU_+3A_margin">margin</code></td>
<td>
<p>margin of accuracy.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a patient in arm <code class="reqn">X_i=j</code> with time-to-event <code class="reqn">T_i</code> and time-to-censoring
<code class="reqn">C_i</code>, <code class="reqn">U_i=\min(T_i, C_i)</code> defines the patient's observed time. The
maximum observed time over patients of arm <code class="reqn">j</code> is then <code class="reqn">\max_{i:X_i=j} U_i</code>,
and the minimax observed time over two arms is <code class="reqn">\min_j (\max_{i:X_i=j} U_i)</code>.
</p>


<h3>Value</h3>

<p><code>dminimaxU</code> gives the density, <code>pminimaxU</code> gives the distribution
function, <code>qminimaxU</code> gives the quantile function, and <code>eminimaxU</code>
gives the expected value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>

<hr>
<h2 id='dsurv'>Survival</h2><span id='topic+dsurv'></span><span id='topic+psurv'></span><span id='topic+hsurv'></span><span id='topic+qsurv'></span><span id='topic+rsurv'></span>

<h3>Description</h3>

<p>Density, distribution function, hazard function, quantile function,
and random generation for the survival distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dsurv(x, arm, include_cured = T)

psurv(q, arm, include_cured = T, lower.tail = T)

hsurv(x, arm, include_cured = T)

qsurv(p, arm, include_cured = T, lower.tail = T)

rsurv(n = 1, arm, include_cured = T)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dsurv_+3A_x">x</code>, <code id="dsurv_+3A_q">q</code></td>
<td>
<p>vector of quantiles.</p>
</td></tr>
<tr><td><code id="dsurv_+3A_arm">arm</code></td>
<td>
<p>object of class arm.</p>
</td></tr>
<tr><td><code id="dsurv_+3A_include_cured">include_cured</code></td>
<td>
<p>logical; if TRUE, mixture distribution of cured
and uncured patients is considered; otherwise, only the distribution
for uncured patients is considered.</p>
</td></tr>
<tr><td><code id="dsurv_+3A_lower.tail">lower.tail</code></td>
<td>
<p>logical; if TRUE, probabilities are <code class="reqn">P(X \le x)</code>;
otherwise, <code class="reqn">P(X &gt; x)</code>.</p>
</td></tr>
<tr><td><code id="dsurv_+3A_p">p</code></td>
<td>
<p>vector of probabilities.</p>
</td></tr>
<tr><td><code id="dsurv_+3A_n">n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dsurv</code> gives the density, <code>psurv</code> gives the distribution
function, <code>hsurv</code> gives the hazard function, <code>qsurv</code> gives the
quantile function, and <code>rsurv</code> generates random deviates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>

<hr>
<h2 id='exp_duration'>Expected duration</h2><span id='topic+exp_duration'></span>

<h3>Description</h3>

<p>Given one or two treatment arms, calculate the time <code class="reqn">\tau</code> at which
the expected number of events equals <code class="reqn">d</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exp_duration(arm0 = NA, arm1 = NA, d, search_start = 10,
  search_prec = 0.01, max_duration = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exp_duration_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="exp_duration_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="exp_duration_+3A_d">d</code></td>
<td>
<p>vector of number of events.</p>
</td></tr>
<tr><td><code id="exp_duration_+3A_search_start">search_start</code></td>
<td>
<p>value at which the search for duration tau starts.</p>
</td></tr>
<tr><td><code id="exp_duration_+3A_search_prec">search_prec</code></td>
<td>
<p>value controlling the desired precision before
terminating the search.</p>
</td></tr>
<tr><td><code id="exp_duration_+3A_max_duration">max_duration</code></td>
<td>
<p>maximum <code class="reqn">\tau</code> for consideration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>expected trial duration.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exp_events">exp_events</a></code> for calculating expected events d at time tau,
<code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
arm1 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.03, loss_scale=0.005, follow_time=12)
exp_duration(arm0, d=61)
exp_duration(arm0, arm1, d=103)
exp_duration(arm0, d=c(35,61))
exp_duration(arm0, arm1, d=c(57,103))
</code></pre>

<hr>
<h2 id='exp_events'>Expected number of events</h2><span id='topic+exp_events'></span>

<h3>Description</h3>

<p>Given one or two treatment arms, calculate the expected number
of events <code class="reqn">d</code> at time <code class="reqn">\tau</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exp_events(arm0 = NA, arm1 = NA, tau = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exp_events_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="exp_events_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="exp_events_+3A_tau">tau</code></td>
<td>
<p>vector of times. Defaults to total study duration.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>expected number of events.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+exp_duration">exp_duration</a></code> for calculating time to achieve expected
events d, <code><a href="#topic+create_arm">create_arm</a></code> and <code><a href="#topic+create_arm_lachin">create_arm_lachin</a></code>
for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
arm1 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.03, loss_scale=0.005, follow_time=12)
exp_events(arm0)
exp_events(arm0, arm1)
exp_events(arm0, tau=c(10,NA))
exp_events(arm0, arm1, tau=c(10,NA))
</code></pre>

<hr>
<h2 id='per2haz'>Convert exponential parameters</h2><span id='topic+per2haz'></span>

<h3>Description</h3>

<p>Convert exponential survival percentile or hazard rate to the other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>per2haz(x, per = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="per2haz_+3A_x">x</code></td>
<td>
<p>survival percentile or exponential hazard rate</p>
</td></tr>
<tr><td><code id="per2haz_+3A_per">per</code></td>
<td>
<p>(per)th percentile</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">y=-log(1-per)/x</code>
</p>



<h3>Value</h3>

<p>survival percentile or hazard rate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>per2haz(14)          # hazard rate for exponential with 14-month median
per2haz(0.05)        # median survival for exponential with hazard rate 0.05
per2haz(14, 0.8)     # hazard rate for exponential with 80th percentile survival at 14 months
per2haz(0.27, 0.8)   # 80th percentile survival for exponential with hazard rate 0.27
</code></pre>

<hr>
<h2 id='power_two_arm'>Power</h2><span id='topic+power_two_arm'></span>

<h3>Description</h3>

<p>Calculate power for a two-arm survival study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>power_two_arm(arm0, arm1, test = list(test = "weighted logrank"),
  alpha = 0.025, sides = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="power_two_arm_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="power_two_arm_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="power_two_arm_+3A_test">test</code></td>
<td>
<p>list or list of lists. Each list must contain at minimum
the key 'test' describing the type of statistical test. Default test
is the &quot;weighted logrank&quot;. Kaplan-Meier based tests (&quot;survival difference&quot;,
&quot;survival ratio&quot;, &quot;rmst difference&quot;, &quot;rmst ratio&quot;, &quot;percentile difference&quot;,
and &quot;percentile ratio&quot;) require the user to define an additional key,
either the desired 'milestone' or 'percentile'. The weighted log-rank test
does not require additional keys. However, user may choose which weight function
(&quot;1&quot;=unweighted, &quot;n&quot;=Gehan-Breslow, &quot;sqrtN&quot;=Tarone-Ware, &quot;FH_p[a]_q[b]&quot;=
Fleming-Harrington with p=a and q=b) and which approximation for the
large-sample mean (&quot;asymptotic&quot;, &quot;generalized schoenfeld&quot;, &quot;event driven&quot;)
and variance (&quot;1&quot;, &quot;block[ randomization]&quot;, &quot;simple[ randomization]&quot;) they
wish to use. Default choice is 'weight'=&quot;1&quot;, 'mean.approx'=&quot;asymptotic&quot;, and 'var.approx'=&quot;1&quot;.
For more details regarding the different mean and variance approximations
for the weight log-rank test, please see Yung and Liu (2019).</p>
</td></tr>
<tr><td><code id="power_two_arm_+3A_alpha">alpha</code></td>
<td>
<p>type 1 error rate</p>
</td></tr>
<tr><td><code id="power_two_arm_+3A_sides">sides</code></td>
<td>
<p>1=1-sided test, 2=2-sided test</p>
</td></tr>
</table>


<h3>Value</h3>

<p>power.
</p>


<h3>References</h3>

<p>Yung, G and Liu, Y. (2019). Sample size and power for the weighted
log-rank test and Kaplan-Meier based tests with allowance for non-proportional
hazards. <em>Biometrics</em>. &lt;doi:10.1111/biom.13196&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
arm1 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.03, loss_scale=0.005, follow_time=12)
power_two_arm(arm0, arm1)
power_two_arm(arm0, arm1, list(test="weighted logrank",
  weight="n",
  mean.approx="generalized schoenfeld",
  var.approx="block"))
power_two_arm(arm0, arm1, list(test="survival difference", milestone=12))
power_two_arm(arm0, arm1, list(test="rmst ratio", milestone=12))
power_two_arm(arm0, arm1, list(test="percentile difference", percentile=0.25))
power_two_arm(arm0, arm1, list(
  list(test="weighted logrank"),
  list(test="survival difference", milestone=12)))
</code></pre>

<hr>
<h2 id='simulate_arm'>Simulate complete data for a single arm</h2><span id='topic+simulate_arm'></span>

<h3>Description</h3>

<p>Simulate the complete data for a single arm, including time to accrual,
event, and loss of follow-up. No cutoff (by number of events or time) is
applied. Hence, no patients are administratively censored.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_arm(arm, label = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_arm_+3A_arm">arm</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="simulate_arm_+3A_label">label</code></td>
<td>
<p>numeric label for the simulated arm, e.g. 0 for control,
1 for treatment</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>arm</code></td>
<td>
<p>label</p>
</td></tr>
<tr><td><code>time.accr</code></td>
<td>
<p>time to accrual</p>
</td></tr>
<tr><td><code>time.obs</code></td>
<td>
<p>time to observation from accrual</p>
</td></tr>
<tr><td><code>time.total</code></td>
<td>
<p>time to observation from start of study</p>
</td></tr>
<tr><td><code>censor</code></td>
<td>
<p>0=censor, 1=event</p>
</td></tr>
<tr><td><code>reason</code></td>
<td>
<p>event description ('[experience ]event', '[loss to ]followup', 'administration[ censoring]')</p>
</td></tr>
<tr><td><code>time.surv</code></td>
<td>
<p>time to event</p>
</td></tr>
<tr><td><code>time.loss</code></td>
<td>
<p>time to loss of follow-up</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
simulate_arm(arm0, label=0)
</code></pre>

<hr>
<h2 id='simulate_trial'>Simulate a clinical trial</h2><span id='topic+simulate_trial'></span>

<h3>Description</h3>

<p>Simulate a single- or two-arm clinical trial, where end of study (EOS)
is triggered after a number of events has been observed or a certain time
has elapsed. Whereas <code>simulate_arm</code> provides complete data for patients,
including time to event and loss of follow-up, <code>simulate_trial</code> mimicks
an actual survival study by providing only the observed time (minimum of time
to event or censoring) and censoring indicator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_trial(arm0 = NA, arm1 = NA, events = NA, duration = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate_trial_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="simulate_trial_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="simulate_trial_+3A_events">events</code></td>
<td>
<p>number of required events to trigger end of study; overrides
study duration defined within <code>arm0</code> and <code>arm1</code>.</p>
</td></tr>
<tr><td><code id="simulate_trial_+3A_duration">duration</code></td>
<td>
<p>time from first-patient-in to trigger end of study; overrides
study duration defined within <code>arm0</code> and <code>arm1</code>. If both <code>events</code>
and <code>duration</code> are specified, end of study is triggered by either criteria,
whichever occurs first.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>arm</code></td>
<td>
<p>0=<code>arm0</code>, 1=<code>arm1</code></p>
</td></tr>
<tr><td><code>time.accr</code></td>
<td>
<p>time to accrual</p>
</td></tr>
<tr><td><code>time.obs</code></td>
<td>
<p>time to observation from accrual</p>
</td></tr>
<tr><td><code>time.total</code></td>
<td>
<p>time to observation from start of study</p>
</td></tr>
<tr><td><code>censor</code></td>
<td>
<p>0=censor, 1=event</p>
</td></tr>
<tr><td><code>reason</code></td>
<td>
<p>event description ('[experience ]event', '[loss to ]followup', 'administration[ censoring]')</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+simulate_arm">simulate_arm</a></code> for simulating complete data for a single
arm, <code><a href="#topic+create_arm">create_arm</a></code> for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
arm1 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.03, loss_scale=0.005, follow_time=12)
simulate_trial(arm0, duration=10)
simulate_trial(arm0, arm1, events=50)
</code></pre>

<hr>
<h2 id='size_two_arm'>Sample size</h2><span id='topic+size_two_arm'></span>

<h3>Description</h3>

<p>Calculate required sample size and expected number of events for a
two-arm survival study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>size_two_arm(arm0, arm1, test = list(test = "weighted logrank"),
  power = 0.8, alpha = 0.025, sides = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="size_two_arm_+3A_arm0">arm0</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="size_two_arm_+3A_arm1">arm1</code></td>
<td>
<p>object of class 'arm'.</p>
</td></tr>
<tr><td><code id="size_two_arm_+3A_test">test</code></td>
<td>
<p>list or list of lists. Each list must contain at minimum
the key 'test' describing the type of statistical test. Default test
is the &quot;weighted logrank&quot;. Kaplan-Meier based tests (&quot;survival difference&quot;,
&quot;survival ratio&quot;, &quot;rmst difference&quot;, &quot;rmst ratio&quot;, &quot;percentile difference&quot;,
and &quot;percentile ratio&quot;) require the user to define an additional key,
either the desired 'milestone' or 'percentile'. The weighted log-rank test
does not require additional keys. However, user may choose which weight function
(&quot;1&quot;=unweighted, &quot;n&quot;=Gehan-Breslow, &quot;sqrtN&quot;=Tarone-Ware, &quot;FH_[a]_[b]&quot;=
Fleming-Harrington with p=a and q=b) and which approximation for the
large-sample mean (&quot;asymptotic&quot;, &quot;generalized schoenfeld&quot;, &quot;event driven&quot;)
and variance (&quot;1&quot;, &quot;block[ randomization]&quot;, &quot;simple[ randomization]&quot;) they
wish to use. Default choice is 'weight'=&quot;1&quot;, 'mean.approx'=&quot;asymptotic&quot;, and 'var.approx'=&quot;1&quot;.
For more details regarding the different mean and variance approximations
for the weight log-rank test, please see Yung and Liu (in press).</p>
</td></tr>
<tr><td><code id="size_two_arm_+3A_power">power</code></td>
<td>
<p>1 - type 2 error rate</p>
</td></tr>
<tr><td><code id="size_two_arm_+3A_alpha">alpha</code></td>
<td>
<p>type 1 error rate</p>
</td></tr>
<tr><td><code id="size_two_arm_+3A_sides">sides</code></td>
<td>
<p>1=1-sided test, 2=2-sided test</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>n0</code></td>
<td>
<p>sample size for <code>arm0</code></p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>sample size for <code>arm1</code></p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>total sample size</p>
</td></tr>
<tr><td><code>d0</code></td>
<td>
<p>expected number of events for <code>arm0</code></p>
</td></tr>
<tr><td><code>d1</code></td>
<td>
<p>expected number of events for <code>arm1</code></p>
</td></tr>
<tr><td><code>d</code></td>
<td>
<p>total expected number of events; can be used to convert a time-driven
trial to an event-driven trial.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Yung, G and Liu, Y. (2019). Sample size and power for the weighted
log-rank test and Kaplan-Meier based tests with allowance for non-proportional
hazards. <em>Biometrics</em>. &lt;doi:10.1111/biom.13196&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_arm">create_arm</a></code> for creating an object of class 'arm'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm0 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.05, loss_scale=0.005, follow_time=12)
arm1 &lt;- create_arm(size=120, accr_time=6, surv_scale=0.03, loss_scale=0.005, follow_time=12)
size_two_arm(arm0, arm1)
size_two_arm(arm0, arm1, list(test="weighted logrank",
  weight="n",
  mean.approx="generalized schoenfeld",
  var.approx="block"))
size_two_arm(arm0, arm1, list(test="survival difference", milestone=12))
size_two_arm(arm0, arm1, list(test="rmst ratio", milestone=12))
size_two_arm(arm0, arm1, list(test="percentile difference", percentile=0.25))
size_two_arm(arm0, arm1, list(
  list(test="weighted logrank"),
  list(test="survival difference", milestone=12)))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
