<!DOCTYPE html><html lang="es"><head><title>Help for package NicheBarcoding</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NicheBarcoding}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bak.vir'><p>bak.vir data set, a class of matrix.</p></a></li>
<li><a href='#en.vir'><p>en.vir data set, a class of RasterBrick.</p></a></li>
<li><a href='#extractSpeInfo'><p>Extraction of taxon/species  and distribution information</p></a></li>
<li><a href='#LappetMoths'><p>LappetMoths data set, a list of 8 data frames.</p></a></li>
<li><a href='#monophyly.prop'><p>Calculate the proportion of monophyletic group on a tree</p></a></li>
<li><a href='#NBSI'><p>Niche-model-Based Species Identification (NBSI)</p></a></li>
<li><a href='#NBSI2'><p>Niche-model-Based Species Identification (NBSI) for a prior analysis</p></a></li>
<li><a href='#niche.Model.Build'><p>Ecological niche model building using the randomForest classifier</p></a></li>
<li><a href='#niche.PCA'><p>Principal component analysis of ecological niche among unknown species and</p>
the potential species to which they may belong</a></li>
<li><a href='#pseudo.absent.points'><p>Generation of pseudo absent points for niche model building</p></a></li>
<li><a href='#pseudo.present.points'><p>Generation of pseudo present points for niche model building</p></a></li>
<li><a href='#spe.mantel.test'><p>Mantel test between interspecific pairwise genetic distance and ecological</p>
distance</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Niche-model-Based Species Identification</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Species Identification using DNA Barcodes Integrated with 
             Environmental Niche Models.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>es</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>bzip2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>ape, dismo, e1071 (&ge; 1.7-7), maps, pROC, randomForest,
raster, rJava, spider, vegan</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Author:</td>
<td>Cai-qing YANG [aut, cre],
  Xin-hai Li [aut],
  Michael christopher ORR [aut],
  Ai-bing ZHANG [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Cai-qing YANG &lt;yangcq_ivy@163.com&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Yangcq-Ivy/NicheBarcoding">https://github.com/Yangcq-Ivy/NicheBarcoding</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Yangcq-Ivy/NicheBarcoding">https://github.com/Yangcq-Ivy/NicheBarcoding</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-20 14:33:38 UTC; zhang</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, covr, testthat (&ge; 3.0.0), knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-21 08:22:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='bak.vir'>bak.vir data set, a class of matrix.</h2><span id='topic+bak.vir'></span>

<h3>Description</h3>

<p>A dataset containing 5 of the 19 bioclimatic variables randomly genereated as
background points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bak.vir
</code></pre>


<h3>Format</h3>

<p>a class of matrix.
</p>

<dl>
<dt>bak.vir</dt><dd><p>5000*5 matrix.</p>
</dd>
</dl>


<hr>
<h2 id='en.vir'>en.vir data set, a class of RasterBrick.</h2><span id='topic+en.vir'></span>

<h3>Description</h3>

<p>A dataset containing 5 of the 19 bioclimatic variables downloaded from WorldClim
(version 1.4 with 10 arc minute resolution; Hijmans et al. 2005)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>en.vir
</code></pre>


<h3>Format</h3>

<p>a class of RasterBrick.
</p>

<dl>
<dt>en.vir</dt><dd><p>class: RasterBrick;
dimensions : 360, 720, 259200, 5  (nrow, ncol, ncell, nlayers);
resolution : 0.5, 0.5  (x, y);
extent: -180, 180, -90, 90  (xmin, xmax, ymin, ymax);
crs: +proj=longlat +datum=WGS84 +no_defs;
source: memory;
names: bio1,bio4,bio7,bio12,bio15.
</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.worldclim.org/">https://www.worldclim.org/</a>
</p>

<hr>
<h2 id='extractSpeInfo'>Extraction of taxon/species  and distribution information</h2><span id='topic+extractSpeInfo'></span>

<h3>Description</h3>

<p>Split comma-separated sample information into different columns
of a data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractSpeInfo(seqID.full)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extractSpeInfo_+3A_seqid.full">seqID.full</code></td>
<td>
<p>Character, sample ID, taxon information and longitude and
latitude data that splitted by comma in class character.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of splitted sample ID, taxon information and longitude
and latitude data for further analysis.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LappetMoths)
ref.seq&lt;-LappetMoths$ref.seq
seqID.full&lt;-rownames(ref.seq)

infor&lt;-extractSpeInfo(seqID.full)
head(infor)
</code></pre>

<hr>
<h2 id='LappetMoths'>LappetMoths data set, a list of 8 data frames.</h2><span id='topic+LappetMoths'></span>

<h3>Description</h3>

<p>A dataset containing the sequences IDs of species,
coordinates of species sampled, and other attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LappetMoths
</code></pre>


<h3>Format</h3>

<p>list of 8 data frames.
</p>

<dl>
<dt>barcode.identi.result</dt><dd><p>data frame,species identifications by other
methods or barocodes,containing query IDs, species identified,
and corresponding probablities.</p>
</dd>
<dt>que.env</dt><dd><p>data frame, containing query sampleIDs,and a set of
corresponding environmental variables collected by users.</p>
</dd>
<dt>que.infor</dt><dd><p>data frame, query samples,containing sample IDs,longitude
and latitude of each sample.</p>
</dd>
<dt>que.seq</dt><dd><p>query sequences in binary format stored in a matrix</p>
</dd>
<dt>ref.env</dt><dd><p>data frame, containing reference sampleIDs, species names,
and a set of environmental variables collected by users.</p>
</dd>
<dt>ref.infor</dt><dd><p>data frame, reference dataset containing sample IDs, taxon
information,longitude and latitude of each sample.</p>
</dd>
<dt>ref.seq</dt><dd><p>reference sequences in binary format stored in a matrix</p>
</dd>
<dt>ref.add</dt><dd><p>data frame, additional reference dataset containing taxon
information, longitude and latitude of each species.</p>
</dd>
</dl>


<hr>
<h2 id='monophyly.prop'>Calculate the proportion of monophyletic group on a tree</h2><span id='topic+monophyly.prop'></span>

<h3>Description</h3>

<p>Calculate the proportion of monophyletic group on a tree given
species vector and a tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monophyly.prop(phy, sppVector, singletonsMono = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="monophyly.prop_+3A_phy">phy</code></td>
<td>
<p>A tree of class phylo.</p>
</td></tr>
<tr><td><code id="monophyly.prop_+3A_sppvector">sppVector</code></td>
<td>
<p>Species vector.</p>
</td></tr>
<tr><td><code id="monophyly.prop_+3A_singletonsmono">singletonsMono</code></td>
<td>
<p>Logical. Should singletons (i.e. only a single
specimen representing that species) be treated as monophyletic?
Default of TRUE. Possible values of FALSE and NA.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing proportion and number of monophyly group.
</p>
<p>A set monophyly and of non-monophyly group names.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ape)
tree&lt;-ape::rtree(20)
tree$tip.label&lt;-sample(tree$tip.label[1:10],size=20,replace = TRUE)
plot(tree)
sppVector&lt;-tree$tip.label

MP&lt;-monophyly.prop(tree,sppVector,singletonsMono = TRUE)
MP
</code></pre>

<hr>
<h2 id='NBSI'>Niche-model-Based Species Identification (NBSI)</h2><span id='topic+NBSI'></span>

<h3>Description</h3>

<p>Species identification using DNA barcoding integrated with
niche model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NBSI(
  ref.seq,
  que.seq,
  model = "RF",
  independence = TRUE,
  ref.add = NULL,
  variables = "ALL",
  en.vir = NULL,
  bak.vir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NBSI_+3A_ref.seq">ref.seq</code></td>
<td>
<p>DNAbin, the reference dataset containing sample IDs,
taxon information,longitude and latitude, and barcode sequences of samples.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_que.seq">que.seq</code></td>
<td>
<p>DNAbin, the query dataset containing sample IDs, longitude
and latitude, and barcode sequences of samples.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_model">model</code></td>
<td>
<p>Character, string indicating which niche model will be used.
Must be one of &quot;RF&quot; (default) or &quot;MAXENT&quot;. &quot;MAXENT&quot; can only be applied when
the java program paste(system.file(package=&quot;dismo&quot;), &quot;/java/maxent.jar&quot;,
sep=&rdquo;) exists.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_independence">independence</code></td>
<td>
<p>Logical. Whether the barcode sequences are related to
the ecological variables?</p>
</td></tr>
<tr><td><code id="NBSI_+3A_ref.add">ref.add</code></td>
<td>
<p>Data.frame, the additional coordinates collected from GBIF
or literatures.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_variables">variables</code></td>
<td>
<p>Character, the identifier of selected bioclimate variables.
Default of &quot;ALL&quot; represents to use all the layers in en.vir; the alternative
option of &quot;SELECT&quot; represents to randomly remove the highly-correlated
variables (|r| larger than 0.9) with the exception of one layer.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the global bioclimate data output from
&quot;raster::getData&quot; function.</p>
</td></tr>
<tr><td><code id="NBSI_+3A_bak.vir">bak.vir</code></td>
<td>
<p>Matrix, bioclimate variables of random background points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of barcoding identification result for each query sample
and corresponding niche model-based probability.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>References</h3>

<p>Breiman, L. 2001. Random forests. Machine Learning 45(1):5-32.
</p>
<p>Liaw, A. and M. Wiener. 2002. Clasification and regression by
randomForest. R News, 2/3:18-22.
</p>
<p>Phillips, S.J., R.P. Anderson and R.E. Schapire. 2006. Maximum
entropy modeling of species geographic distributions. Ecological Modelling,
190:231-259.
</p>
<p>Zhang, A.B., M.D. Hao, C.Q. Yang and Z.Y. Shi. (2017). BarcodingR:
an integrated R package for species identification using DNA barcodes.
Methods in Ecology and Evolution, 8:627-634.
</p>
<p>Jin, Q., H.L. Han, X.M. Hu, X.H. Li, C.D. Zhu, S.Y.W. Ho, R.D. Ward
and A.B. Zhang. 2013. Quantifying species diversity with a DNA barcoding-based
method: Tibetan moth species (Noctuidae) on the Qinghai-Tibetan Plateau.
PloS One, 8:e644.
</p>
<p>Hijmans, R.J., S.E. Cameron, J.L. Parra, P.G. Jones and A. Jarvis.
2005. Very high resolution interpolated climate surfaces for global land areas.
International Journal of Climatology, 25(15):1965-1978.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
data(bak.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)
#back&lt;-dismo::randomPoints(mask=en.vir,n=5000,ext=NULL,extf=1.1,
#                          excludep=TRUE,prob=FALSE,
#                          cellnumbers=FALSE,tryf=3,warn=2,
#                          lonlatCorrection=TRUE)
#bak.vir&lt;-raster::extract(en.vir,back)

library(ape)
data(LappetMoths)
ref.seq&lt;-LappetMoths$ref.seq[1:50,]
que.seq&lt;-LappetMoths$que.seq[1:5,]
NBSI.out&lt;-NBSI(ref.seq,que.seq,ref.add=NULL,
               independence=TRUE,
               model="RF",variables="SELECT",
               en.vir=en.vir,bak.vir=bak.vir)
NBSI.out

### Add a parameter when additional reference coordinates are available ###
#ref.add&lt;-LappetMoths$ref.add
#NBSI.out2&lt;-NBSI(ref.seq,que.seq,ref.add=ref.add,
#                independence=TRUE,
#                model="RF",variables="SELECT",
#                en.vir=en.vir,bak.vir=bak.vir)
#NBSI.out2
</code></pre>

<hr>
<h2 id='NBSI2'>Niche-model-Based Species Identification (NBSI) for a prior analysis</h2><span id='topic+NBSI2'></span>

<h3>Description</h3>

<p>If users already have species identified by other barcodes or
methods, they can use this function given the identified species names
and corresponding probabilities to make further confirm by environmental
niche model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NBSI2(
  ref.infor = NULL,
  que.infor = NULL,
  ref.env = NULL,
  que.env = NULL,
  barcode.identi.result,
  model = "RF",
  variables = "ALL",
  en.vir = NULL,
  bak.vir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NBSI2_+3A_ref.infor">ref.infor</code></td>
<td>
<p>Data frame, reference dataset containing sample IDs, taxon
information,longitude and latitude of each sample.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_que.infor">que.infor</code></td>
<td>
<p>Data frame, query samples,containing sample IDs,longitude
and latitude of each sample.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_ref.env">ref.env</code></td>
<td>
<p>Data frame,containing reference sampleIDs, species names,
and a set of environmental variables collected by users.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_que.env">que.env</code></td>
<td>
<p>Data frame,containing query sampleIDs,and a set of
corresponding environmental variables collected by users.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_barcode.identi.result">barcode.identi.result</code></td>
<td>
<p>Data frame, species identifications by other
methods or barocodes, containing query IDs, species identified, and
corresponding probabilities.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_model">model</code></td>
<td>
<p>Character, string indicating which niche model will be used.
Must be one of &quot;RF&quot; (default) or &quot;MAXENT&quot;. &quot;MAXENT&quot; can only be applied when
the java program paste(system.file(package=&quot;dismo&quot;), &quot;/java/maxent.jar&quot;,
sep=&rdquo;) exists.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_variables">variables</code></td>
<td>
<p>Character, the identifier of selected bioclimate variables.
Default of &quot;ALL&quot; represents to use all the layers in en.vir; the alternative
option of &quot;SELECT&quot; represents to randomly remove the highly-correlated
variables (|r| larger than 0.9) with the exception of one layer.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the global bioclimate data output from
&quot;raster::getData&quot; function.</p>
</td></tr>
<tr><td><code id="NBSI2_+3A_bak.vir">bak.vir</code></td>
<td>
<p>Matrix, bioclimate variables of random background points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe of identifications for query samples and their
niche-based reliability.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>References</h3>

<p>Breiman, L. 2001. Random forests. Machine Learning 45(1):5-32.
</p>
<p>Liaw, A. and M. Wiener. 2002. Clasification and regression by
randomForest. R News, 2/3:18-22.
</p>
<p>Phillips, S.J., R.P. Anderson and R.E. Schapire. 2006. Maximum
entropy modeling of species geographic distributions. Ecological Modelling,
190:231-259.
</p>
<p>Hijmans, R.J., S.E. Cameron, J.L. Parra, P.G. Jones and A. Jarvis.
2005. Very high resolution interpolated climate surfaces for global land areas.
International Journal of Climatology, 25(15):1965-1978.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
data(bak.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)
#back&lt;-dismo::randomPoints(mask=en.vir,n=5000,ext=NULL,extf=1.1,
#                          excludep=TRUE,prob=FALSE,
#                          cellnumbers=FALSE,tryf=3,warn=2,
#                          lonlatCorrection=TRUE)
#bak.vir&lt;-raster::extract(en.vir,back)

data(LappetMoths)
barcode.identi.result&lt;-LappetMoths$barcode.identi.result
ref.infor&lt;-LappetMoths$ref.infor
que.infor&lt;-LappetMoths$que.infor

if(class(en.vir) == "NULL"){
 NBSI2.out&lt;-NBSI2(ref.infor=ref.infor,que.infor=que.infor,
                  barcode.identi.result=barcode.identi.result,
                  model="RF",variables="SELECT",
                  en.vir=NULL,bak.vir=NULL)
}else{
 NBSI2.out&lt;-NBSI2(ref.infor=ref.infor,que.infor=que.infor,
                  barcode.identi.result=barcode.identi.result,
                  model="RF",variables="SELECT",
                  en.vir=en.vir,bak.vir=bak.vir)
}
NBSI2.out

ref.env&lt;-LappetMoths$ref.env
que.env&lt;-LappetMoths$que.env

NBSI2.out2&lt;-NBSI2(ref.env=ref.env,que.env=que.env,
                  barcode.identi.result=barcode.identi.result,
                  model="RF",variables="ALL",
                  en.vir=en.vir,bak.vir=bak.vir)
NBSI2.out2
</code></pre>

<hr>
<h2 id='niche.Model.Build'>Ecological niche model building using the randomForest classifier</h2><span id='topic+niche.Model.Build'></span>

<h3>Description</h3>

<p>Build a niche model for a given species according to its
distribution data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche.Model.Build(
  prese = NULL,
  absen = NULL,
  prese.env = NULL,
  absen.env = NULL,
  model = "RF",
  en.vir = NULL,
  bak.vir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="niche.Model.Build_+3A_prese">prese</code></td>
<td>
<p>Data frame, longitude and latitude of the present data of a
species (can be absent when providing prese.env parameter).</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_absen">absen</code></td>
<td>
<p>Data frame, longitude and latitude of the absent data of a
species.(can be absent when providing absen.env or back parameter).</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_prese.env">prese.env</code></td>
<td>
<p>Data frame, bioclimate variables of present data.
(can be absent when providing prese parameter).</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_absen.env">absen.env</code></td>
<td>
<p>Data frame, bioclimate variables of absent data.
(can be absent when providing absen or back parameter).</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_model">model</code></td>
<td>
<p>Character, string indicating which niche model will be used.
Must be one of &quot;RF&quot; (default) or &quot;MAXENT&quot;. &quot;MAXENT&quot; can only be applied when
the java program paste(system.file(package=&quot;dismo&quot;), &quot;/java/maxent.jar&quot;,
sep=&rdquo;) exists.</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the global bioclimate data output from
&quot;raster::getData&quot; function.</p>
</td></tr>
<tr><td><code id="niche.Model.Build_+3A_bak.vir">bak.vir</code></td>
<td>
<p>Matrix, bioclimate variables of random background points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>randomForest/MaxEnt, a trained niche model object.
</p>
<p>A vector including the specificity, sensitivity and threshold of the
trained model.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>References</h3>

<p>Breiman, L. 2001. Random forests. Machine Learning 45(1):5-32.
</p>
<p>Liaw, A. and M. Wiener. 2002. Clasification and regression by
randomForest. R News, 2/3:18-22.
</p>
<p>Hijmans, R.J., S.E. Cameron, J.L. Parra, P.G. Jones and A. Jarvis.
2005. Very high resolution interpolated climate surfaces for global land areas.
International Journal of Climatology, 25(15):1965-1978.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
data(bak.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)
#back&lt;-dismo::randomPoints(mask=en.vir,n=5000,ext=NULL,extf=1.1,
#                          excludep=TRUE,prob=FALSE,
#                          cellnumbers=FALSE,tryf=3,warn=2,
#                          lonlatCorrection=TRUE)
#bak.vir&lt;-raster::extract(en.vir,back)

data&lt;-data.frame(species=rep("Acosmeryx anceus",3),
                 Lon=c(145.380,145.270,135.461),
                 Lat=c(-16.4800,-5.2500,-16.0810))
present.points&lt;-pseudo.present.points(data,10,2,1,en.vir)
NMB.out&lt;-niche.Model.Build(prese=present.points,absen=NULL,
                           prese.env=NULL,absen.env=NULL,
                           model="RF",
                           en.vir=en.vir,bak.vir=bak.vir)
NMB.out


prese.env&lt;-raster::extract(en.vir,present.points[,2:3])
prese.env&lt;-as.data.frame(prese.env)
NMB.out2&lt;-niche.Model.Build(prese=NULL,absen=NULL,
                            prese.env=prese.env,absen.env=NULL,
                            model="RF",
                            en.vir=en.vir,bak.vir=bak.vir)
NMB.out2
</code></pre>

<hr>
<h2 id='niche.PCA'>Principal component analysis of ecological niche among unknown species and
the potential species to which they may belong</h2><span id='topic+niche.PCA'></span>

<h3>Description</h3>

<p>Determine whether unknown species belong to a known species
through principal component analysis of ecological niche according to their
distribution information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>niche.PCA(ref.lonlat, que.lonlat, en.vir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="niche.PCA_+3A_ref.lonlat">ref.lonlat</code></td>
<td>
<p>Data frame, longitude and latitude of the known species.</p>
</td></tr>
<tr><td><code id="niche.PCA_+3A_que.lonlat">que.lonlat</code></td>
<td>
<p>Data frame, longitude and latitude of unknown species.</p>
</td></tr>
<tr><td><code id="niche.PCA_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the globle bioclimate data obtained from
&quot;raster::getData&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing inportance and loadings of the components.
</p>
<p>A dataframe of points that within the 95% confidence interval of
the reference dataset ecological space.
</p>
<p>A figure shows whether the query points (blue solid circles) are
located in the 95%CI range of the niche space of reference species.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)

data(LappetMoths)
ref.infor&lt;-LappetMoths$ref.infor
que.infor&lt;-LappetMoths$que.infor

#windows() # open a new plot window when the image format is abnormal
nPCA&lt;-niche.PCA(ref.lonlat=ref.infor[,3:5],
                que.lonlat=que.infor[,c(2,4:5)],
                en.vir=en.vir)
nPCA$summary
nPCA$que.CI


data&lt;-data.frame(species=rep("Acosmeryx anceus",3),
                 Lon=c(145.380,145.270,135.461),
                 Lat=c(-16.4800,-5.2500,-16.0810))
simuSites&lt;-pseudo.present.points(data,500,4,2,en.vir)
ref.lonlat&lt;-simuSites[1:480,]
que.lonlat&lt;-simuSites[481:500,]

#windows() # open a new plot window when the image format is abnormal
nPCA2&lt;-niche.PCA(ref.lonlat,que.lonlat,en.vir=en.vir)
nPCA2$summary
nPCA2$que.CI
</code></pre>

<hr>
<h2 id='pseudo.absent.points'>Generation of pseudo absent points for niche model building</h2><span id='topic+pseudo.absent.points'></span>

<h3>Description</h3>

<p>Randomly generate pseudo points outside the 95%CI of the
ecological space of the present data when there is no absent data for
building a niche model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.absent.points(data, outputNum = 500, en.vir = NULL, map = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo.absent.points_+3A_data">data</code></td>
<td>
<p>Data frame, longitude and latitude of a single species.</p>
</td></tr>
<tr><td><code id="pseudo.absent.points_+3A_outputnum">outputNum</code></td>
<td>
<p>Numeric, the expected number of points.</p>
</td></tr>
<tr><td><code id="pseudo.absent.points_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the globle bioclimate data obtained from
&quot;raster::getData&quot; function.</p>
</td></tr>
<tr><td><code id="pseudo.absent.points_+3A_map">map</code></td>
<td>
<p>Logical. Should a map be drawn?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of simulated pseudo points.
</p>
<p>A data frame of bioclimate variables of each pseudo points.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)

data&lt;-data.frame(species=rep("Acosmeryx anceus",3),
                 Lon=c(145.380,145.270,135.461),
                 Lat=c(-16.4800,-5.2500,-16.0810))

absent.points&lt;-pseudo.absent.points(data,en.vir=en.vir,outputNum=100)
head(absent.points$lonlat)
head(absent.points$envir)
</code></pre>

<hr>
<h2 id='pseudo.present.points'>Generation of pseudo present points for niche model building</h2><span id='topic+pseudo.present.points'></span>

<h3>Description</h3>

<p>Randomly generate pseudo points around actual present
distribution site when the number of present points is inadequate for
building a niche model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pseudo.present.points(
  data,
  outputNum = 50,
  lonRange = 2,
  latRange = 1,
  en.vir = NULL,
  map = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pseudo.present.points_+3A_data">data</code></td>
<td>
<p>Data frame, longitude and latitude of a single species.</p>
</td></tr>
<tr><td><code id="pseudo.present.points_+3A_outputnum">outputNum</code></td>
<td>
<p>Numeric, the expected number of points.</p>
</td></tr>
<tr><td><code id="pseudo.present.points_+3A_lonrange">lonRange</code></td>
<td>
<p>Range of the longitude of the points generated.</p>
</td></tr>
<tr><td><code id="pseudo.present.points_+3A_latrange">latRange</code></td>
<td>
<p>Range of the latitude of the points generated.</p>
</td></tr>
<tr><td><code id="pseudo.present.points_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the globle bioclimate data obtained from
&quot;raster::getData&quot; function.</p>
</td></tr>
<tr><td><code id="pseudo.present.points_+3A_map">map</code></td>
<td>
<p>Logical. Should a map be drawn?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame, containing actual present points and simulated pseudo
points.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)

data&lt;-data.frame(species=rep("Acosmeryx anceus",3),
                 Lon=c(145.380,145.270,135.461),
                 Lat=c(-16.4800,-5.2500,-16.0810))


present.points&lt;-pseudo.present.points(data,10,2,1,en.vir=en.vir)
present.points
</code></pre>

<hr>
<h2 id='spe.mantel.test'>Mantel test between interspecific pairwise genetic distance and ecological
distance</h2><span id='topic+spe.mantel.test'></span>

<h3>Description</h3>

<p>Determine the independence between genetic distance and
ecological distance for a reference dataset at the level of species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spe.mantel.test(
  fas,
  dna.model = "raw",
  ecol.dist.method = "euclidean",
  mantel.method = "spearman",
  permutations = 999,
  en.vir = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spe.mantel.test_+3A_fas">fas</code></td>
<td>
<p>DNAbin, reference dataset containing sample IDs, taxon information,
longitude and latitude, and barcode sequences of samples.</p>
</td></tr>
<tr><td><code id="spe.mantel.test_+3A_dna.model">dna.model</code></td>
<td>
<p>Character, specifying the evolutionary model to be used;
must be one of &quot;raw&quot; (default), &quot;N&quot;, &quot;TS&quot;, &quot;TV&quot;, &quot;JC69&quot;, &quot;K80&quot;, &quot;F81&quot;, &quot;K81&quot;,
&quot;F84&quot;, &quot;BH87&quot;, &quot;T92&quot;, &quot;TN93&quot;, &quot;GG95&quot;, &quot;logdet&quot;, &quot;paralin&quot;, &quot;indel&quot;, or
&quot;indelblock&quot;.</p>
</td></tr>
<tr><td><code id="spe.mantel.test_+3A_ecol.dist.method">ecol.dist.method</code></td>
<td>
<p>Character, distance measure to be used;
must be one of &quot;euclidean&quot; (default), &quot;maximum&quot;, &quot;manhattan&quot;, &quot;canberra&quot;,
&quot;binary&quot; or &quot;minkowski&quot;.</p>
</td></tr>
<tr><td><code id="spe.mantel.test_+3A_mantel.method">mantel.method</code></td>
<td>
<p>Character, correlation method, as accepted by cor:
&quot;pearson&quot;,&quot;spearman&quot; (default) or &quot;kendall&quot;.</p>
</td></tr>
<tr><td><code id="spe.mantel.test_+3A_permutations">permutations</code></td>
<td>
<p>Numeric, the number of permutations required.</p>
</td></tr>
<tr><td><code id="spe.mantel.test_+3A_en.vir">en.vir</code></td>
<td>
<p>RasterBrick, the global bioclimate data output from
&quot;raster::getData&quot; function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Mantel statistic.
</p>
<p>The empirical significance level from permutations.
</p>
<p>A matrix of interspecific pairwise genetic distance.
</p>
<p>A matrix of interspecific pairwise ecological distance.
</p>


<h3>Author(s)</h3>

<p>Cai-qing YANG (Email: yangcq_ivy(at)163.com) and Ai-bing ZHANG
(Email:zhangab2008(at)cnu.edu.cn), Capital Normal University (CNU), Beijing,
CHINA.
</p>


<h3>References</h3>

<p>Mantel N. 1967. The detection of disease clustering and a
generalized regression approach. Can. Res. 27:209-220.
</p>
<p>Oksanen J., F.G. Blanchet, M. Friendly, R. Kindt, P. Legendre,
D. McGlinn, P.R. Minchin, R.B. O'Hara, G.L. Simpson, P. Solymos,
M.H.H. Stevens, E. Szoecs and H Wagner. 2016. vegan: Community Ecology
Package <a href="https://CRAN.R-project.org/package=vegan">https://CRAN.R-project.org/package=vegan</a>. r package version 2.5-6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(en.vir)
#envir&lt;-raster::getData("worldclim",download=FALSE,var="bio",res=2.5)
#en.vir&lt;-raster::brick(envir)

library(ape)
data(LappetMoths)
ref.seq&lt;-LappetMoths$ref.seq

spe.mantel&lt;-spe.mantel.test(fas=ref.seq,en.vir=en.vir)
spe.mantel$MantelStat.r
spe.mantel$p.value
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
