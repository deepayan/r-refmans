<!DOCTYPE html><html><head><title>Help for package broman</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {broman}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%nin%'><p>Value matching</p></a></li>
<li><a href='#add_commas'><p>Add commas to a large number</p></a></li>
<li><a href='#align_vectors'><p>Align two vectors</p></a></li>
<li><a href='#arrowlocator'><p>Use the locator function to plot an arrow</p></a></li>
<li><a href='#attrnames'><p>Get names of attributes</p></a></li>
<li><a href='#brocolors'><p>Vectors of colors for figures</p></a></li>
<li><a href='#bromanversion'><p>Installed version of R/broman</p></a></li>
<li><a href='#cf'><p>Compare objects, including missing data pattern</p></a></li>
<li><a href='#chisq'><p>Chi-square test by simulation for a two-way table</p></a></li>
<li><a href='#ciplot'><p>Effect plot with multiple CIs for different groups</p></a></li>
<li><a href='#colwalpha'><p>Convert a color to use alpha transparency</p></a></li>
<li><a href='#compare_rows'><p>Compare rows in a matrix</p></a></li>
<li><a href='#convert2hex'><p>Convert decimal to hex</p></a></li>
<li><a href='#crayons'><p>Crayon colors</p></a></li>
<li><a href='#dotplot'><p>Dot chart with a gray background</p></a></li>
<li><a href='#excel_fig'><p>Excel-style figure displaying contents of a matrix</p></a></li>
<li><a href='#exit'><p>exit R without saving</p></a></li>
<li><a href='#fac2num'><p>Convert a factor to numeric</p></a></li>
<li><a href='#fisher'><p>Fisher's exact test for a two-way table</p></a></li>
<li><a href='#get_precision'><p>Determine the precision of a number</p></a></li>
<li><a href='#grayplot'><p>Scatterplot with a gray background</p></a></li>
<li><a href='#grayplot_na'><p>Scatterplot with missing values indicated</p></a></li>
<li><a href='#h'><p>View html version of help file</p></a></li>
<li><a href='#hex2dec'><p>Convert from hex to decimal</p></a></li>
<li><a href='#histlines'><p>Utility to create line-based histogram</p></a></li>
<li><a href='#jiggle'><p>Jiggle points horizontally</p></a></li>
<li><a href='#kbdate'><p>My little date facility</p></a></li>
<li><a href='#lenuniq'><p>Number of unique values</p></a></li>
<li><a href='#make'><p>Run make within a package directory</p></a></li>
<li><a href='#manyboxplot'><p>Boxplot-like figure for many groups</p></a></li>
<li><a href='#maxabs'><p>maximum of absolute value</p></a></li>
<li><a href='#mypairs'><p>My scatterplot matrix</p></a></li>
<li><a href='#myround'><p>Round a number, preserving extra 0's</p></a></li>
<li><a href='#normalize'><p>Quantile normalization</p></a></li>
<li><a href='#numbers'><p>Numbers spelled out in English</p></a></li>
<li><a href='#objectsizes'><p>Calculate sizes of all objects in workspace</p></a></li>
<li><a href='#openfile'><p>Open a file</p></a></li>
<li><a href='#paired.perm.test'><p>Paired permutation t-test</p></a></li>
<li><a href='#paste.'><p>paste with dot separator</p></a></li>
<li><a href='#paste00'><p>paste with null or dot as separator and with collapse</p></a></li>
<li><a href='#perm.test'><p>Permutation t-test</p></a></li>
<li><a href='#pick_more_precise'><p>Pick the more precise value for each element in two related vectors</p></a></li>
<li><a href='#plot_crayons'><p>Illustration of crayon colors</p></a></li>
<li><a href='#qqline2'><p>qqline for qqplot</p></a></li>
<li><a href='#qr2'><p>The QR decomposition of a matrix</p></a></li>
<li><a href='#quantileSE'><p>Sample quantiles and their standard errors</p></a></li>
<li><a href='#revgray'><p>Create vector of colors from white to black</p></a></li>
<li><a href='#revrainbow'><p>Create vector of colors from blue to red</p></a></li>
<li><a href='#rmvn'><p>Simulate multivariate normal</p></a></li>
<li><a href='#runningmean'><p>Running mean, sum, or median</p></a></li>
<li><a href='#runningratio'><p>Running ratio</p></a></li>
<li><a href='#setRNGparallel'><p>Set up random number generation for parallel calculations</p></a></li>
<li><a href='#simp'><p>Numerical integration</p></a></li>
<li><a href='#spell_out'><p>Spell out an integer</p></a></li>
<li><a href='#strwidth2lines'><p>Calculate width of a character string in number of lines</p></a></li>
<li><a href='#strwidth2xlim'><p>Calculate horizontal limit in user coordinates for adding labels</p></a></li>
<li><a href='#switchv'><p>Vectorized version of switch</p></a></li>
<li><a href='#theme_karl'><p>Karl's ggplot2 theme</p></a></li>
<li><a href='#triarrow'><p>Plot an arrow within a Holmans triangle</p></a></li>
<li><a href='#trigrid'><p>Add grid lines to triplot</p></a></li>
<li><a href='#trilines'><p>Plot lines within a Holmans triangle</p></a></li>
<li><a href='#triplot'><p>Plot Holmans triangle</p></a></li>
<li><a href='#tripoints'><p>Plot points within a Holmans triangle</p></a></li>
<li><a href='#tritext'><p>Plot text within a Holmans triangle</p></a></li>
<li><a href='#twocolorpal'><p>Create vector of colors from blue to white to red</p></a></li>
<li><a href='#vec2string'><p>Turn a vector into a single character string</p></a></li>
<li><a href='#venn'><p>Plot to-scale Venn diagram</p></a></li>
<li><a href='#winsorize'><p>Winsorize a vector</p></a></li>
<li><a href='#xlimlabel'><p>Calulate horizontal limit in user coordinates for adding labels</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.80</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-07-08</td>
</tr>
<tr>
<td>Title:</td>
<td>Karl Broman's R Code</td>
</tr>
<tr>
<td>Description:</td>
<td>Miscellaneous R functions, including functions related to
    graphics (mostly for base graphics), permutation tests, running
    mean/median, and general utilities.</td>
</tr>
<tr>
<td>Author:</td>
<td>Karl W Broman <a href="https://orcid.org/0000-0002-4914-6671"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Aimee Teo Broman <a href="https://orcid.org/0000-0003-3783-2807"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Karl W Broman &lt;broman@wisc.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, graphics, grDevices, stats, ggplot2, grid</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, devtools, roxygen2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/kbroman/broman">https://github.com/kbroman/broman</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kbroman/broman/issues">https://github.com/kbroman/broman/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-07-08 14:53:09 UTC; kbroman</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-07-08 15:30:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25nin+25'>Value matching</h2><span id='topic++25nin+25'></span><span id='topic++25win+25'></span><span id='topic++25wnin+25'></span>

<h3>Description</h3>

<p><code>%in%</code> returns logical vector indicating values that do not have a match.
<code style="white-space: pre;">&#8288;%win%&#8288;</code> returns a vector of the values that have a match.
<code style="white-space: pre;">&#8288;%wnin%&#8288;</code> returns a vector of the values that do not have a match.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %nin% table

x %win% table

x %wnin% table
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25nin+2B25_+3A_x">x</code></td>
<td>
<p>Vector of values to be matched.</p>
</td></tr>
<tr><td><code id="+2B25nin+2B25_+3A_table">table</code></td>
<td>
<p>Vector of values to be matched against.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code style="white-space: pre;">&#8288;%nin%&#8288;</code> returns a logical vector of the same length of <code>x</code>, indicating which values are not in <code>table</code>.
</p>
<p><code style="white-space: pre;">&#8288;%win%&#8288;</code> returns a sub-vector of <code>x</code> with the values that were found in <code>table</code>.
</p>
<p><code style="white-space: pre;">&#8288;%wnin%&#8288;</code> returns a sub-vector of <code>x</code> with the values that were not found in <code>table</code>.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+match">base::match()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vals &lt;- c("a", "xa", "b")
vals %nin% letters
vals %win% letters
vals %wnin% letters
</code></pre>

<hr>
<h2 id='add_commas'>Add commas to a large number</h2><span id='topic+add_commas'></span>

<h3>Description</h3>

<p>Convert a number to a string, with commas every 3rd digit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_commas(numbers)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_commas_+3A_numbers">numbers</code></td>
<td>
<p>Vector of non-negative numbers (will be rounded to integers)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string with numbers written like <code>"7,547,085"</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>add_commas(c(231, 91310, 2123, 9911001020, 999723285))
</code></pre>

<hr>
<h2 id='align_vectors'>Align two vectors</h2><span id='topic+align_vectors'></span>

<h3>Description</h3>

<p>Align two vectors using their names attributes, either expanding with NAs or reducing to the common values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>align_vectors(x, y, expand = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="align_vectors_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id="align_vectors_+3A_y">y</code></td>
<td>
<p>Another vector</p>
</td></tr>
<tr><td><code id="align_vectors_+3A_expand">expand</code></td>
<td>
<p>If TRUE, expand each to the same length using NAs. If FALSE, remove elements not in common.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two components, <code>x</code> and <code>y</code>
</p>

<hr>
<h2 id='arrowlocator'>Use the locator function to plot an arrow</h2><span id='topic+arrowlocator'></span>

<h3>Description</h3>

<p>Use the <code><a href="graphics.html#topic+locator">graphics::locator()</a></code> function to indicate the
endpoints of an arrow and then plot it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrowlocator(
  reverse = FALSE,
  horizontal = FALSE,
  vertical = FALSE,
  length = 0.1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrowlocator_+3A_reverse">reverse</code></td>
<td>
<p>If FALSE, first indicate the tail of the arrow and
then the head; if TRUE, first indicate the head of the arrow and then
the tail.</p>
</td></tr>
<tr><td><code id="arrowlocator_+3A_horizontal">horizontal</code></td>
<td>
<p>If TRUE, force the arrow to be horizontal.  (Use the
average y-axis value of the two clicks for the vertical placement.)</p>
</td></tr>
<tr><td><code id="arrowlocator_+3A_vertical">vertical</code></td>
<td>
<p>If TRUE, force the arrow to be vertical.  (Use the
average x-axis value of the two clicks for the horizontal placement.)</p>
</td></tr>
<tr><td><code id="arrowlocator_+3A_length">length</code></td>
<td>
<p>Length of the edges of the arrow head.</p>
</td></tr>
<tr><td><code id="arrowlocator_+3A_...">...</code></td>
<td>
<p>Additional graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use <code><a href="graphics.html#topic+locator">graphics::locator()</a></code> to indicate the two endpoints of
an arrow and then draw it.
</p>


<h3>Value</h3>

<p>The locations of the endpoints of the arrow, as a two-row
matrix.  The first row indicates the location of the tail of the
arrow; the second row indicates the location of the head of the
arrow.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+arrows">graphics::arrows()</a></code>, <code><a href="graphics.html#topic+locator">graphics::locator()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
plot(0,0,type="n", xlab="", ylab="", xlim=c(0,100), ylim=c(0,100))
arrowlocator(col="blue", lwd=2)

## End(Not run)

</code></pre>

<hr>
<h2 id='attrnames'>Get names of attributes</h2><span id='topic+attrnames'></span>

<h3>Description</h3>

<p>Get the names of the attributes of an object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>attrnames(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attrnames_+3A_object">object</code></td>
<td>
<p>Any object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It just does <code>names(attributes(object))</code>.
</p>


<h3>Value</h3>

<p>Vector of character strings with the names of the attributes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(1:100, ncol=5)
colnames(x) &lt;- LETTERS[1:5]
attrnames(x)
</code></pre>

<hr>
<h2 id='brocolors'>Vectors of colors for figures</h2><span id='topic+brocolors'></span>

<h3>Description</h3>

<p>Creates different vectors of related colors that may be useful for figures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brocolors(
  set = c("general", "general2", "bg", "bgpng", "CC", "CCalt", "f2", "sex", "main",
    "crayons", "web")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brocolors_+3A_set">set</code></td>
<td>
<p>Character string indicating a set of colors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of character strings representing the chosen set of colors, in RGB.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_crayons">plot_crayons()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mar=c(0.6,5.1,0.6,0.6))
plot(0, 0, type="n", xlab="", ylab="", xlim=c(0, 9), ylim=c(8.5, 0), yaxs="i",
     xaxt="n", yaxt="n", xaxs="i")
axis(side=2, at=1:8, c("general", "general2", "bg", "bgpng", "CC", "f2", "sex", "main"), las=1)

gen &lt;- brocolors("general")
points(seq(along=gen), rep(1,length(gen)), pch=21, bg=gen, cex=4)
text(seq(along=gen), rep(c(0.55, 0.7), length(gen))[seq(along=gen)], names(gen))

gen2 &lt;- brocolors("general2")
points(seq(along=gen2), rep(2,length(gen2)), pch=21, bg=gen2, cex=4)
text(seq(along=gen2), rep(1+c(0.55, 0.7), length(gen2))[seq(along=gen2)], names(gen2))

points(1, 3, pch=21, bg=brocolors("bg"), cex=4)
points(1, 4, pch=21, bg=brocolors("bgpng"), cex=4)

CC &lt;- brocolors("CC")
points(seq(along=CC), rep(5,length(CC)), pch=21, bg=CC, cex=4)
text(seq(along=CC), rep(4+c(0.55, 0.7), length(CC))[seq(along=CC)], names(CC))

f2 &lt;- brocolors("f2")
points(seq(along=f2), rep(6,length(f2)), pch=21, bg=f2, cex=4)
text(seq(along=f2), rep(5.7, length(f2)), names(f2))

sex &lt;- brocolors("sex")
points(seq(along=sex), rep(7,length(sex)), pch=21, bg=sex, cex=4)
text(seq(along=sex), rep(6.7, length(sex)), names(sex))

points(1, 8, pch=21, bg=brocolors("main"), cex=4)
</code></pre>

<hr>
<h2 id='bromanversion'>Installed version of R/broman</h2><span id='topic+bromanversion'></span>

<h3>Description</h3>

<p>Print the version number of the currently installed version of R/broman.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bromanversion()
</code></pre>


<h3>Value</h3>

<p>A character string with the version number of the currently installed
version of R/broman.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bromanversion()

</code></pre>

<hr>
<h2 id='cf'>Compare objects, including missing data pattern</h2><span id='topic+cf'></span><span id='topic+cf.default'></span><span id='topic+cf.list'></span>

<h3>Description</h3>

<p>Check whether two objects are the same, including their patterns of <code>NA</code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cf(a, b)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cf_+3A_a">a</code></td>
<td>
<p>Some object.</p>
</td></tr>
<tr><td><code id="cf_+3A_b">b</code></td>
<td>
<p>Another object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It's not very complicated: <code>((is.na(a) &amp; is.na(b)) | (!is.na(a) &amp; !is.na(b) &amp; a == b))</code>
</p>


<h3>Value</h3>

<p>Boolean object with <code>TRUE</code> indicating an element is the same.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(5, 8, 9, NA, 3, NA)
y &lt;- c(5, 2, 9, 4, NA, NA)
cf(x,y)

x &lt;- matrix(rnorm(1000), ncol=20)
x[sample(seq(along=x), 100)] &lt;- NA
all(cf(x,x))
dim(cf(x,x))

y &lt;- x
y[4,8] &lt;- NA
sum(!cf(x,y))
y[6,2] &lt;- 18
sum(!cf(x,y))
y[6,5] &lt;- 32
sum(!cf(x,y))

x &lt;- as.data.frame(x)
y &lt;- as.data.frame(y)
sum(!cf(x,y))

x &lt;- as.list(x)
y &lt;- as.list(y)
sapply(cf(x,y), function(a) sum(!a))

</code></pre>

<hr>
<h2 id='chisq'>Chi-square test by simulation for a two-way table</h2><span id='topic+chisq'></span>

<h3>Description</h3>

<p>Calculate a p-value for a chi-square test by Monte Carlo simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chisq(tab, n.sim = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chisq_+3A_tab">tab</code></td>
<td>
<p>A matrix of counts.</p>
</td></tr>
<tr><td><code id="chisq_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of samples of permuted tables to consider.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is like the function <code><a href="stats.html#topic+chisq.test">stats::chisq.test()</a></code>, but
calculates an approximate P-value rather than refering to
asymptotics.  This will be better for large, sparse tables.
</p>


<h3>Value</h3>

<p>A single number: the P-value testing independence of rows and columns
in the table.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+chisq.test">stats::chisq.test()</a></code>, <code><a href="stats.html#topic+fisher.test">stats::fisher.test()</a></code>, <code><a href="#topic+fisher">fisher()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TeaTasting &lt;- matrix(c(3,1,1,3),nrow=2)
chisq(TeaTasting,1000)

</code></pre>

<hr>
<h2 id='ciplot'>Effect plot with multiple CIs for different groups</h2><span id='topic+ciplot'></span>

<h3>Description</h3>

<p>Uses <code><a href="#topic+grayplot">grayplot()</a></code> to plot a set of confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciplot(
  est,
  se = NULL,
  lo = NULL,
  hi = NULL,
  SEmult = 2,
  labels = NULL,
  rotate = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciplot_+3A_est">est</code></td>
<td>
<p>Vector of estimates</p>
</td></tr>
<tr><td><code id="ciplot_+3A_se">se</code></td>
<td>
<p>Vector of standard errors</p>
</td></tr>
<tr><td><code id="ciplot_+3A_lo">lo</code></td>
<td>
<p>Vector of lower values for the intervals</p>
</td></tr>
<tr><td><code id="ciplot_+3A_hi">hi</code></td>
<td>
<p>Vector of upper values for the intervals</p>
</td></tr>
<tr><td><code id="ciplot_+3A_semult">SEmult</code></td>
<td>
<p>SE multiplier to create intervals</p>
</td></tr>
<tr><td><code id="ciplot_+3A_labels">labels</code></td>
<td>
<p>Labels for the groups (vector of character strings)</p>
</td></tr>
<tr><td><code id="ciplot_+3A_rotate">rotate</code></td>
<td>
<p>If TRUE, have group as y-axis; default (FALSE) has
group on x-axis.</p>
</td></tr>
<tr><td><code id="ciplot_+3A_...">...</code></td>
<td>
<p>Optional graphics arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code><a href="#topic+grayplot">grayplot()</a></code> with special choices of
graphics parameters, as in <code><a href="#topic+dotplot">dotplot()</a></code>.
</p>
<p>Provide either <code>se</code> or both <code>lo</code> and <code>hi</code>. In the case that <code>se</code> is
used, the intervals will be <code>est</code> +/- <code>SEmult * se</code>.
</p>
<p>If <code>labels</code> is not provided, group names are taken from the <code>names(est)</code>.
If that is also missing, we use capital letters.
</p>
<p>You can control the CI line widths with <code>ci_lwd</code> and the color of
the CI segments with <code>ci_col</code>. You can control the width of the
segments at the top and bottom with <code>ci_endseg</code>.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grayplot">grayplot()</a></code>, <code><a href="#topic+dotplot">dotplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(40, c(1,3))
g &lt;- rep(c("A", "B"), 20)
me &lt;- tapply(x, g, mean)
se &lt;- tapply(x, g, function(a) sd(a)/sqrt(sum(!is.na(a))))
ciplot(me, se) # default is +/- 2 SE
ciplot(me, se, SEmult=1)
ciplot(me, se, rotate=TRUE)
lo &lt;- me - 2*se
hi &lt;- me + 2*se
ciplot(me, lo=lo, hi=hi)

</code></pre>

<hr>
<h2 id='colwalpha'>Convert a color to use alpha transparency</h2><span id='topic+colwalpha'></span>

<h3>Description</h3>

<p>Convert a color to RGB and then to RGB with alpha transparency
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colwalpha(color, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colwalpha_+3A_color">color</code></td>
<td>
<p>A character string for a color</p>
</td></tr>
<tr><td><code id="colwalpha_+3A_alpha">alpha</code></td>
<td>
<p>Traparency value (between 0 and 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string representing a color
</p>


<h3>Examples</h3>

<pre><code class='language-R'>colwalpha(c("blue", "red"), 0.5)
</code></pre>

<hr>
<h2 id='compare_rows'>Compare rows in a matrix</h2><span id='topic+compare_rows'></span>

<h3>Description</h3>

<p>For all pairs of rows in a matrix, calculate the proportion of mismatches or the RMS difference.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compare_rows(mat, method = c("prop_mismatches", "rms_difference"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compare_rows_+3A_mat">mat</code></td>
<td>
<p>Numeric matrix. Should be integers in the case <code>method="prop_mismatches"</code>.</p>
</td></tr>
<tr><td><code id="compare_rows_+3A_method">method</code></td>
<td>
<p>Indicates whether to use proportion mismatches or the
RMS difference. Missing values are omitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A square matrix of dimension <code>nrow(mat)</code> with
<code>NA</code>s on the diagonal and the calculated statistic in the
body.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 10
p &lt;- 200
x &lt;- matrix(sample(1:4, n*p, replace=TRUE), ncol=p)
d &lt;- compare_rows(x)
</code></pre>

<hr>
<h2 id='convert2hex'>Convert decimal to hex</h2><span id='topic+convert2hex'></span><span id='topic+dec2hex'></span>

<h3>Description</h3>

<p>Convert a number to hexidecimal notation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert2hex(d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convert2hex_+3A_d">d</code></td>
<td>
<p>A vector of integers (must be &lt; 2^31).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input in hex, as character strings.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+hex2dec">hex2dec()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>convert2hex(333)
dec2hex(333)
dec2hex(0:30)

</code></pre>

<hr>
<h2 id='crayons'>Crayon colors</h2><span id='topic+crayons'></span>

<h3>Description</h3>

<p>Vector of colors corresponding to Crayola crayons
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crayons(color_names = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crayons_+3A_color_names">color_names</code></td>
<td>
<p>Optional vector of color names; can be partial matches.</p>
</td></tr>
<tr><td><code id="crayons_+3A_...">...</code></td>
<td>
<p>Additional optional color names</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of named RGB colors
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/List_of_Crayola_crayon_colors">https://en.wikipedia.org/wiki/List_of_Crayola_crayon_colors</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_crayons">plot_crayons()</a></code>, <code><a href="#topic+brocolors">brocolors()</a></code>
</p>

<hr>
<h2 id='dotplot'>Dot chart with a gray background</h2><span id='topic+dotplot'></span>

<h3>Description</h3>

<p>Like the <code><a href="#topic+grayplot">grayplot()</a></code> function, but with one axis assumed to be categorical.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dotplot(group, y, jiggle = NULL, max_jiggle = 0.45, rotate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dotplot_+3A_group">group</code></td>
<td>
<p>Categorical coordinates for the plot</p>
</td></tr>
<tr><td><code id="dotplot_+3A_y">y</code></td>
<td>
<p>Coordinates of points in the plot</p>
</td></tr>
<tr><td><code id="dotplot_+3A_jiggle">jiggle</code></td>
<td>
<p>Vector of amounts to jiggle the points horizontally,
or a character string (<code>"fixed"</code> or <code>"random"</code>)
indicating the jiggling method; see <code><a href="#topic+jiggle">jiggle()</a></code>.</p>
</td></tr>
<tr><td><code id="dotplot_+3A_max_jiggle">max_jiggle</code></td>
<td>
<p>Maximum jiggle value; passed to <code><a href="#topic+jiggle">jiggle()</a></code> as argument <code>maxvalue</code>.</p>
</td></tr>
<tr><td><code id="dotplot_+3A_rotate">rotate</code></td>
<td>
<p>If TRUE, have group as y-axis; default (FALSE) has
group on x-axis.</p>
</td></tr>
<tr><td><code id="dotplot_+3A_...">...</code></td>
<td>
<p>Optional graphics arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code><a href="#topic+grayplot">grayplot()</a></code> with special choices of
graphics parameters for the case of categorical x.
</p>
<p>If <code>group</code> is a factor, the order of the groups is as in the
levels. Otherwise, we take <code>sort(unique(group))</code>. So if you want to
control the order of the levels, make <code>group</code> a factor with the levels
in the desired order, for example <code>group &lt;- factor(group, levels=unique(group))</code>.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grayplot">grayplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(40, c(1,3))
g &lt;- rep(c("A", "B"), 20)
dotplot(g, x)
dotplot(g, x, "fixed")
dotplot(g, x, runif(length(g), -0.25, 0.25))

</code></pre>

<hr>
<h2 id='excel_fig'>Excel-style figure displaying contents of a matrix</h2><span id='topic+excel_fig'></span>

<h3>Description</h3>

<p>Turn a matrix of data into an SVG of how it might look in Excel
</p>


<h3>Usage</h3>

<pre><code class='language-R'>excel_fig(
  mat,
  file = NULL,
  cellwidth = 80,
  cellheight = 26,
  textsize = 16,
  fig_width = NULL,
  fig_height = NULL,
  border = "#CECECE",
  headcol = "#E9E9E9",
  headborder = "#969696",
  headtextcol = "#626262",
  textcol = "black",
  row_names = FALSE,
  col_names = TRUE,
  hilitcells = NULL,
  hilitcolor = "#F0DCDB",
  lwd = 1,
  direct2svg = FALSE,
  mar = rep(0.1, 4)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="excel_fig_+3A_mat">mat</code></td>
<td>
<p>A matrix</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_file">file</code></td>
<td>
<p>Optional file name (must have extension .svg, .png, .jpg, or .pdf)</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_cellwidth">cellwidth</code></td>
<td>
<p>Width of each cell, in pixels</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_cellheight">cellheight</code></td>
<td>
<p>Height of each cell, in pixels</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_textsize">textsize</code></td>
<td>
<p>Size for text (if <code>file</code> is provided or <code>direct2svg=TRUE</code>)</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_fig_width">fig_width</code></td>
<td>
<p>Width of figure, in pixels (if NULL, taken from <code>cellwidth</code>); ignored when <code>direct2svg=FALSE</code></p>
</td></tr>
<tr><td><code id="excel_fig_+3A_fig_height">fig_height</code></td>
<td>
<p>Height of figure, in pixels (if NULL, taken from <code>cellheight</code>); ignored when <code>direct2svg=FALSE</code></p>
</td></tr>
<tr><td><code id="excel_fig_+3A_border">border</code></td>
<td>
<p>Color of border of cells for the body of the matrix</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_headcol">headcol</code></td>
<td>
<p>Background color of cells on the top and left border</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_headborder">headborder</code></td>
<td>
<p>Color of border of cells on the top and left border</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_headtextcol">headtextcol</code></td>
<td>
<p>Color of text in cells on the top and left border</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_textcol">textcol</code></td>
<td>
<p>Color of text in cells in body of the matrix</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_row_names">row_names</code></td>
<td>
<p>If TRUE, and row names are present, include them as a first column</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_col_names">col_names</code></td>
<td>
<p>If TRUE, and column names are present, include them as a first row</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_hilitcells">hilitcells</code></td>
<td>
<p>Optional character vector of cells to highlight, like <code>"A1"</code> or <code>"D4"</code></p>
</td></tr>
<tr><td><code id="excel_fig_+3A_hilitcolor">hilitcolor</code></td>
<td>
<p>Color to highlight cells, a vector of length 1 or the same length as <code>hilitcells</code></p>
</td></tr>
<tr><td><code id="excel_fig_+3A_lwd">lwd</code></td>
<td>
<p>Line width for rectangles</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_direct2svg">direct2svg</code></td>
<td>
<p>If TRUE, rather than R graphics, just print an SVG directly with <code><a href="base.html#topic+cat">base::cat()</a></code>.</p>
</td></tr>
<tr><td><code id="excel_fig_+3A_mar">mar</code></td>
<td>
<p>Plot margins, passed to <code><a href="graphics.html#topic+par">graphics::par()</a></code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(id=    c(101,  102,  103),
                 sex=   c("M",  "F",  "M"),
                 weight=c(22.3, 15.8, 19.7),
                 stringsAsFactors=FALSE)
excel_fig(df, col_names=TRUE)
</code></pre>

<hr>
<h2 id='exit'>exit R without saving</h2><span id='topic+exit'></span>

<h3>Description</h3>

<p>exit R without saving workspace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exit()
</code></pre>


<h3>Details</h3>

<p>This just calls <code>q("no")</code>
</p>


<h3>Value</h3>

<p>None.
</p>

<hr>
<h2 id='fac2num'>Convert a factor to numeric</h2><span id='topic+fac2num'></span>

<h3>Description</h3>

<p>Convert a factor with numeric levels to a non-factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fac2num(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fac2num_+3A_x">x</code></td>
<td>
<p>A vector containing a factor with numeric levels</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input factor made a numeric vector
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- factor(c(3, 4, 9, 4, 9), levels=c(3,4,9))
fac2num(x)

</code></pre>

<hr>
<h2 id='fisher'>Fisher's exact test for a two-way table</h2><span id='topic+fisher'></span>

<h3>Description</h3>

<p>Performs a sampling version of Fisher's exact test for a two-way
contingency table.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisher(tab, n.sim = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fisher_+3A_tab">tab</code></td>
<td>
<p>A matrix of counts.</p>
</td></tr>
<tr><td><code id="fisher_+3A_n.sim">n.sim</code></td>
<td>
<p>Number of samples of permuted tables to consider.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is like the function <code><a href="stats.html#topic+fisher.test">stats::fisher.test()</a></code>, but
calculates an approximate P-value rather than performing a complete
enumeration.  This will be better for large, sparse tables.
</p>


<h3>Value</h3>

<p>A single number: the P-value testing independence of rows and columns
in the table.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+chisq.test">stats::chisq.test()</a></code>, <code><a href="stats.html#topic+fisher.test">stats::fisher.test()</a></code>, <code><a href="#topic+chisq">chisq()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TeaTasting &lt;- matrix(c(3,1,1,3),nrow=2)
fisher(TeaTasting,1000)

</code></pre>

<hr>
<h2 id='get_precision'>Determine the precision of a number</h2><span id='topic+get_precision'></span>

<h3>Description</h3>

<p>Determine the precision of a number, as the number of digits past
the decimal point.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_precision(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_precision_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="get_precision_+3A_...">...</code></td>
<td>
<p>Ignore this</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the number is expressed in scientific notation, we take the number of digits
</p>


<h3>Value</h3>

<p>A vector of integers, with the number of digits (to the last non-zero digit) past the decimal point.
</p>

<hr>
<h2 id='grayplot'>Scatterplot with a gray background</h2><span id='topic+grayplot'></span>

<h3>Description</h3>

<p>Like the plot function, but using a gray background just
for the plot region.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grayplot(
  x,
  y = NULL,
  ...,
  type = "p",
  hlines = NULL,
  hlines.col = "white",
  hlines.lty = 1,
  hlines.lwd = 1,
  vlines = NULL,
  vlines.col = "white",
  vlines.lty = 1,
  vlines.lwd = 1,
  xat = NULL,
  yat = NULL,
  bgcolor = "gray90",
  pch = 21,
  bg = "lightblue",
  col = "black",
  v_over_h = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grayplot_+3A_x">x</code></td>
<td>
<p>Coordinates of points in the plot</p>
</td></tr>
<tr><td><code id="grayplot_+3A_y">y</code></td>
<td>
<p>Coordinates of points in the plot (optional)</p>
</td></tr>
<tr><td><code id="grayplot_+3A_...">...</code></td>
<td>
<p>Optional graphics arguments</p>
</td></tr>
<tr><td><code id="grayplot_+3A_type">type</code></td>
<td>
<p>Plot type (points, lines, etc.)</p>
</td></tr>
<tr><td><code id="grayplot_+3A_hlines">hlines</code></td>
<td>
<p>Locations of horizontal grid lines; use <code>hlines=NA</code> to prevent horizontal grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_hlines.col">hlines.col</code></td>
<td>
<p>Colors of horizontal grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_hlines.lty">hlines.lty</code></td>
<td>
<p>Line type of horizontal grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_hlines.lwd">hlines.lwd</code></td>
<td>
<p>Line width of horizontal grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_vlines">vlines</code></td>
<td>
<p>Locations of vertical grid lines; use <code>vlines=NA</code> to prevent vertical grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_vlines.col">vlines.col</code></td>
<td>
<p>Colors of vertical grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_vlines.lty">vlines.lty</code></td>
<td>
<p>Line type of vertical grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_vlines.lwd">vlines.lwd</code></td>
<td>
<p>Line width of vertical grid lines</p>
</td></tr>
<tr><td><code id="grayplot_+3A_xat">xat</code></td>
<td>
<p>Locations for x-axis labels; <code>xat=NA</code> indicates no labels</p>
</td></tr>
<tr><td><code id="grayplot_+3A_yat">yat</code></td>
<td>
<p>Locations for y-axis labels; <code>yat=NA</code> indicates no labels</p>
</td></tr>
<tr><td><code id="grayplot_+3A_bgcolor">bgcolor</code></td>
<td>
<p>Background color</p>
</td></tr>
<tr><td><code id="grayplot_+3A_pch">pch</code></td>
<td>
<p>point type</p>
</td></tr>
<tr><td><code id="grayplot_+3A_bg">bg</code></td>
<td>
<p>Background color in points</p>
</td></tr>
<tr><td><code id="grayplot_+3A_col">col</code></td>
<td>
<p>Color of outer circle in points</p>
</td></tr>
<tr><td><code id="grayplot_+3A_v_over_h">v_over_h</code></td>
<td>
<p>If <code>TRUE</code>, place vertical grid lines on top of
the horizontal ones.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>plot()</code> with <code>type="n"</code>, then <code><a href="graphics.html#topic+rect">graphics::rect()</a></code> to
get the background, and then <code><a href="graphics.html#topic+points">graphics::points()</a></code>. Additional
arguments you can include: <code>mgp.x</code> and <code>mgp.y</code> (like <code>mgp</code>, for
controlling parameters of axis labels, but separate for x- and
y-axis).
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+par">graphics::par()</a></code>, <code><a href="graphics.html#topic+rect">graphics::rect()</a></code>, <code><a href="graphics.html#topic+points">graphics::points()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rnorm(100)
y &lt;- x+rnorm(100, 0, 0.7)
grayplot(x, y, col="slateblue", pch=16)
at &lt;- seq(-3, 3)
grayplot(x, y, col="violetred", pch=16, hlines=at, vlines=at)
grayplot(x, col="Orchid", pch=16, bgcolor="gray80",
         hlines=seq(-4, 4, by=0.5), hlines.lwd=c(3,1),
         vlines=seq(0, 100, by=5), vlines.lwd=c(3,1,1,1))

</code></pre>

<hr>
<h2 id='grayplot_na'>Scatterplot with missing values indicated</h2><span id='topic+grayplot_na'></span>

<h3>Description</h3>

<p>Scatterplot with a gray background and with points with missing
values shown in separate panels near the margins.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>grayplot_na(
  x,
  y = NULL,
  type = "p",
  bgcolor = "gray90",
  v_over_h = FALSE,
  pch = 21,
  bg = "lightblue",
  col = "black",
  force = c("none", "x", "y", "both"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="grayplot_na_+3A_x">x</code></td>
<td>
<p>Coordinates of points in the plot</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_y">y</code></td>
<td>
<p>Coordinates of points in the plot (optional)</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_type">type</code></td>
<td>
<p>Plot type (points, lines, etc.)</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_bgcolor">bgcolor</code></td>
<td>
<p>Background color</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_v_over_h">v_over_h</code></td>
<td>
<p>If <code>TRUE</code>, place vertical grid lines on top of
the horizontal ones.</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_pch">pch</code></td>
<td>
<p>point type</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_bg">bg</code></td>
<td>
<p>Background color in points</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_col">col</code></td>
<td>
<p>Color of outer circle in points</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_force">force</code></td>
<td>
<p>Indicates whether to force the NA box (on the x-axis,
y-axis, or both) even when there are no missing values.</p>
</td></tr>
<tr><td><code id="grayplot_na_+3A_...">...</code></td>
<td>
<p>Optional graphics arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code>plot()</code> with 'type=&quot;n&quot;, then
<code><a href="graphics.html#topic+rect">graphics::rect()</a></code> to get the background, and then
<code><a href="graphics.html#topic+points">graphics::points()</a></code>.
</p>
<p>There are a bunch of hidden graphical arguments you can include:
<code>na.width</code> controls the proportional width devoted to the NA boxes,
and <code>na.gap</code> the proportion for the gap between the NA boxes and
the main plot region. <code>mgp.x</code> and <code>mgp.y</code> (like <code>mgp</code>, for
controlling parameters of axis labels, but separate for x- and
y-axis). Also <code>hlines</code> to indicate locations of of horizontal
gridlines, and <code>hlines.col</code>, <code>hlines.lwd</code>, and <code>hlines.lty</code> to set
their color, width, and type. <code>hlines=NA</code> suppresses the grid
lines. Similarly <code>vlines</code>, <code>vlines.col</code>, <code>vlines.lwd</code>, and
<code>vlines.lty</code>. <code>xat</code> and <code>yat</code> are for specifying the locations of
x- and y-axis labels, respectively. <code>xat=NA</code> and <code>yat=NA</code> indicate
no labels.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grayplot">grayplot()</a></code>, <code><a href="#topic+dotplot">dotplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n &lt;- 100
x &lt;- rnorm(n)
y &lt;- x+rnorm(n, 0, 0.7)
x[sample(n, 10)] &lt;- NA

grayplot_na(x, y)

grayplot_na(x, y, force="y")

y[sample(n, 10)] &lt;- NA
grayplot_na(x, y)

</code></pre>

<hr>
<h2 id='h'>View html version of help file</h2><span id='topic+h'></span>

<h3>Description</h3>

<p>View the html version of a help file while running R via ESS within emacs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>h(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="h_+3A_...">...</code></td>
<td>
<p>Help topics.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This just calls the function <code><a href="utils.html#topic+help">utils::help()</a></code> using the
argument <code>htmlhelp=TRUE</code>.
</p>


<h3>Value</h3>

<p>No return value.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">utils::help()</a></code>, <code><a href="utils.html#topic+help.start">utils::help.start()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>h(read.cross)

</code></pre>

<hr>
<h2 id='hex2dec'>Convert from hex to decimal</h2><span id='topic+hex2dec'></span>

<h3>Description</h3>

<p>Convert a number from hexidecimal to decimal notation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hex2dec(h)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hex2dec_+3A_h">h</code></td>
<td>
<p>Vector of character strings with hexadecimal representation of integers
(values &gt;= 2^31 converted to missing, <code>NA</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The input converted from hexadecimal to decimal notation.
</p>


<h3>Author(s)</h3>

<p>Karl W Broman, <a href="mailto:broman@wisc.edu">broman@wisc.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dec2hex">dec2hex()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hex2dec("14D")
hex2dec(0:30)

</code></pre>

<hr>
<h2 id='histlines'>Utility to create line-based histogram</h2><span id='topic+histlines'></span>

<h3>Description</h3>

<p>Utility function to plot histogram with <code><a href="graphics.html#topic+lines">graphics::lines()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histlines(x, y = NULL, breaks, use = c("counts", "density"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="histlines_+3A_x">x</code></td>
<td>
<p>Either vector of breaks or the data itself.</p>
</td></tr>
<tr><td><code id="histlines_+3A_y">y</code></td>
<td>
<p>Optional vector of density/counts, with length = <code>length(x)-1</code>.</p>
</td></tr>
<tr><td><code id="histlines_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram, if <code>y</code> is not provided.</p>
</td></tr>
<tr><td><code id="histlines_+3A_use">use</code></td>
<td>
<p>Whether to use <code>counts</code> or <code>density</code>, if <code>y</code>
is not provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If <code>x</code> and <code>y</code> are both provided, <code>x</code> is interpreted to
be the breaks for a histogram, and <code>y</code> is a vector of counts or
density values for each interval.  These are then revised so that they
may be plotted with <code><a href="graphics.html#topic+lines">graphics::lines()</a></code>.
If <code>y</code> is NULL, <code>x</code> is taken to be the data.  In this
case <code><a href="graphics.html#topic+hist">graphics::hist()</a></code> is called with <code>breaks=breaks</code>, and
either the <code>counts</code> or <code>density</code> are used as <code>y</code>.
</p>


<h3>Value</h3>

<p>A data.frame with two columns: <code>x</code> and <code>y</code>.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">graphics::hist()</a></code>, <code><a href="graphics.html#topic+lines">graphics::lines()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rnorm(1000, mean=20, sd=5)
# basic use
out &lt;- hist(x, breaks=60, plot=FALSE)
plot(histlines(out$breaks, out$counts),
     type="l", lwd=2, xlab="x", ylab="counts", las=1)
# alternative use
plot(histlines(x, breaks=60, use="density"),
     type="l", lwd=2, xlab="x", ylab="Density", las=1)
# comparing two distributions
z &lt;- rnorm(1000, mean=25, sd=5)
br &lt;- seq(min(c(x,z)), max(c(x,z)), len=50)
xlines &lt;- histlines(x, breaks=br, use="density")
zlines &lt;- histlines(z, breaks=br, use="density")
ymx &lt;- max(c(xlines$y, zlines$y))*1.05
plot(xlines, ylim=c(0, ymx), yaxs="i", xaxs="i",
     type="l", lwd=2, xlab="x", ylab="Density", las=1,
     col="blue")
lines(zlines, lwd=2 , col="red")

</code></pre>

<hr>
<h2 id='jiggle'>Jiggle points horizontally</h2><span id='topic+jiggle'></span>

<h3>Description</h3>

<p>Spread points out horizontally so that, in dot plot of quantitative
response in multiple categories, the separate points can be seen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jiggle(
  group,
  y,
  method = c("random", "fixed"),
  hnum = 35,
  vnum = 40,
  maxvalue = 0.45
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jiggle_+3A_group">group</code></td>
<td>
<p>Categorical variable defining group; can be a factor,
character, or numeric vector</p>
</td></tr>
<tr><td><code id="jiggle_+3A_y">y</code></td>
<td>
<p>Vector of quantitative responses</p>
</td></tr>
<tr><td><code id="jiggle_+3A_method">method</code></td>
<td>
<p>What method to use for horizontal jiggling.</p>
</td></tr>
<tr><td><code id="jiggle_+3A_hnum">hnum</code></td>
<td>
<p>Number of horizontal bins for the jiggling.</p>
</td></tr>
<tr><td><code id="jiggle_+3A_vnum">vnum</code></td>
<td>
<p>Number of vertical bins for the jiggling.</p>
</td></tr>
<tr><td><code id="jiggle_+3A_maxvalue">maxvalue</code></td>
<td>
<p>Maximum value in the results; results will be scaled to this value.
Use <code>NULL</code> to not scale.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>"random"</code> method is similar to
<code><a href="base.html#topic+jitter">base::jitter()</a></code> but with amount of jiggling proportional
to the number of nearby points. The <code>"fixed"</code> method is
similar to the <a href="https://github.com/aroneklund/beeswarm">beeswarm package</a>
</p>


<h3>Value</h3>

<p>Numeric vector with amounts to jiggle the points horizontally
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+jitter">base::jitter()</a></code>, <code><a href="#topic+dotplot">dotplot()</a></code>
</p>

<hr>
<h2 id='kbdate'>My little date facility</h2><span id='topic+kbdate'></span>

<h3>Description</h3>

<p>Sys.Date as a string, in a few different formats
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kbdate(format = c("dateonly", "standard"), date = Sys.time())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kbdate_+3A_format">format</code></td>
<td>
<p>The format for the output</p>
</td></tr>
<tr><td><code id="kbdate_+3A_date">date</code></td>
<td>
<p>The date/time to convert</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character string representation of the date/time
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Sys.time">base::Sys.time()</a></code>, <code><a href="base.html#topic+date">base::date()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kbdate()
kbdate("standard")

</code></pre>

<hr>
<h2 id='lenuniq'>Number of unique values</h2><span id='topic+lenuniq'></span>

<h3>Description</h3>

<p>Get the number of unique values in a vector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lenuniq(vec, na.rm = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lenuniq_+3A_vec">vec</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id="lenuniq_+3A_na.rm">na.rm</code></td>
<td>
<p>If <code>TRUE</code>, remove any missing values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It just does <code>length(unique(vec))</code> or, if
<code>na.rm=TRUE</code> (the default)
<code>length(unique(vec[!is.na(vec)]))</code>
</p>


<h3>Value</h3>

<p>Number of unique values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(1, 2, 1, 3, 1, 1, 2, 2, 3, NA, NA, 1)
lenuniq(x)
lenuniq(x, na.rm=FALSE)
</code></pre>

<hr>
<h2 id='make'>Run make within a package directory</h2><span id='topic+make'></span>

<h3>Description</h3>

<p>Run make within a package directory
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make(pkg = ".", makefile = "Makefile", target = "", quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_+3A_pkg">pkg</code></td>
<td>
<p>Path to directory containing the GNU Make file, or an
Rpackage description, which can be a path or a package name. (See
<code><a href="devtools.html#topic+as.package">devtools::as.package()</a></code> for more information.)</p>
</td></tr>
<tr><td><code id="make_+3A_makefile">makefile</code></td>
<td>
<p>File name of makefile.</p>
</td></tr>
<tr><td><code id="make_+3A_target">target</code></td>
<td>
<p>Optional character string specifying the target.</p>
</td></tr>
<tr><td><code id="make_+3A_quiet">quiet</code></td>
<td>
<p>If TRUE suppresses output from this function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Exit value from <code><a href="base.html#topic+system">base::system()</a></code> with <code>intern=FALSE</code>
</p>


<h3>See Also</h3>

<p><code><a href="devtools.html#topic+load_all">devtools::load_all()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: make() # run make within working directory
make("/path/to/mypackage") # run make within /path/to/mypackage

## End(Not run)

</code></pre>

<hr>
<h2 id='manyboxplot'>Boxplot-like figure for many groups</h2><span id='topic+manyboxplot'></span>

<h3>Description</h3>

<p>Boxplot-like figure for many groups, with lines connecting
selected quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>manyboxplot(
  x,
  probs = c(0.05, 0.1, 0.25),
  dotcol = "blue",
  linecol = c("black", "red", "green", "orange"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="manyboxplot_+3A_x">x</code></td>
<td>
<p>Matrix of data, with columns indicating the groups.</p>
</td></tr>
<tr><td><code id="manyboxplot_+3A_probs">probs</code></td>
<td>
<p>Numeric vecotr of probabilities with values in [0,1).
Quantiles will be symmetric, and the median will always be included.</p>
</td></tr>
<tr><td><code id="manyboxplot_+3A_dotcol">dotcol</code></td>
<td>
<p>Color for median</p>
</td></tr>
<tr><td><code id="manyboxplot_+3A_linecol">linecol</code></td>
<td>
<p>Line colors, same length as <code>probs</code></p>
</td></tr>
<tr><td><code id="manyboxplot_+3A_...">...</code></td>
<td>
<p>Additional graphics parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates quantiles of the columns of <code>x</code> and then plots dots or
lines at median plus lines at a series of quantiles, using
<code><a href="#topic+grayplot">grayplot()</a></code> for the actual plot.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+grayplot">grayplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mu &lt;- c(rnorm(50, 0, 0.3), rnorm(50, 2, 0.3)) # vector of means
x &lt;- t(matrix(rnorm(1000*100, mu), ncol=1000))
manyboxplot(x, c(0.05, 0.25), ylim=range(x),
           dotcol=c("blue","green")[(1:100 &gt; 50) + 1],
           hlines=seq(-4, 6, by=2),
           vlines=c(1, seq(20, 100, by=20)))

</code></pre>

<hr>
<h2 id='maxabs'>maximum of absolute value</h2><span id='topic+maxabs'></span>

<h3>Description</h3>

<p>Take the maximum of the absolute values of the input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>maxabs(x, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="maxabs_+3A_x">x</code></td>
<td>
<p>a numeric vector or array</p>
</td></tr>
<tr><td><code id="maxabs_+3A_na.rm">na.rm</code></td>
<td>
<p>a logical indicating whether missing values should be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The maximum of the absolute value of the input
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(5, -2, 8, -20, 2.3)
maxabs(x)
</code></pre>

<hr>
<h2 id='mypairs'>My scatterplot matrix</h2><span id='topic+mypairs'></span>

<h3>Description</h3>

<p>A matrix of scatterplots is produced; it's similar to
<code><a href="graphics.html#topic+pairs">graphics::pairs()</a></code>, but with only the upper triangle is
made.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mypairs(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mypairs_+3A_x">x</code></td>
<td>
<p>A numeric matrix or data frame.</p>
</td></tr>
<tr><td><code id="mypairs_+3A_...">...</code></td>
<td>
<p>Passed to the <code>plot()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is like the function <code><a href="graphics.html#topic+pairs">graphics::pairs()</a></code>, but
only the upper triangle is produced.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+pairs">graphics::pairs()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>v &lt;- rbind(c(1,0.5,0.2),c(0.5,1,0.9),c(0.2,0.9,1))
x &lt;- rmvn(500, rep(5,3), v)
mypairs(x, col=sample(c("blue","red"), 500, repl=TRUE))

</code></pre>

<hr>
<h2 id='myround'>Round a number, preserving extra 0's</h2><span id='topic+myround'></span>

<h3>Description</h3>

<p>Round a number, preserving extra 0's.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myround(x, digits = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="myround_+3A_x">x</code></td>
<td>
<p>Number to round.</p>
</td></tr>
<tr><td><code id="myround_+3A_digits">digits</code></td>
<td>
<p>Number of digits past the decimal point to keep.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="base.html#topic+sprintf">base::sprintf()</a></code> to round a number, keeping extra 0's.
</p>


<h3>Value</h3>

<p>A vector of character strings.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+Round">base::round()</a></code>, <code><a href="base.html#topic+sprintf">base::sprintf()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>myround(51.01, 3)
myround(0.199, 2)

</code></pre>

<hr>
<h2 id='normalize'>Quantile normalization</h2><span id='topic+normalize'></span>

<h3>Description</h3>

<p>Quantile normalizes two vectors or a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalize(x, y = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalize_+3A_x">x</code></td>
<td>
<p>Numeric vector or matrix</p>
</td></tr>
<tr><td><code id="normalize_+3A_y">y</code></td>
<td>
<p>Optional second numeric vector</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We sort the columns, take averages across rows, and then plug the
averages back into the respective positions.  The marginal
distributions in the columns are thus forced to be the same.
Missing values, which can result in differing numbers of observed
values per column, are dealt with by linear interpolation.
</p>


<h3>Value</h3>

<p>If two vectors, <code>x</code> and <code>y</code>, are provided, the output is a
matrix with two columns, with the quantile normalized versions of
<code>x</code> and <code>y</code>.
If <code>y</code> is missing, <code>x</code> should be a matrix, in which case the
output is a matrix of the same dimensions with the columns quantile
normalized with respect to each other.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>z &lt;- rmvn(10000, mu=c(0,5,10), V = rbind(c(1,0.5,0.5),c(0.5,1,0.5),c(0.5,0.5,1)))
z[sample(prod(dim(z)), 1500)] &lt;- NA
pairs(z)
br &lt;- seq(min(z, na.rm=TRUE), max(z, na.rm=TRUE), length=200)
par(mfrow=c(3,1))
for(i in 1:3)
  hist(z[,i], xlab="z", main=i, breaks=br)
zn &lt;- normalize(z)
br &lt;- seq(min(zn, na.rm=TRUE), max(zn, na.rm=TRUE), length=200)
for(i in 1:3)
  hist(zn[,i], xlab="normalized z", main=i, breaks=br)
pairs(zn)

</code></pre>

<hr>
<h2 id='numbers'>Numbers spelled out in English</h2><span id='topic+numbers'></span><span id='topic+Numbers'></span>

<h3>Description</h3>

<p>The numbers 1-20 spelled out in English, for use in reports.
</p>


<h3>Format</h3>

<p>A vector of character strings
</p>


<h3>Details</h3>


<ul>
<li> <p><code>numbers</code> - lower case
</p>
</li>
<li> <p><code>Numbers</code> - Capitalized
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>numbers[5]
Numbers[5]
</code></pre>

<hr>
<h2 id='objectsizes'>Calculate sizes of all objects in workspace</h2><span id='topic+objectsizes'></span>

<h3>Description</h3>

<p>Calculate the sizes of all of the objects in one's workspace.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>objectsizes(obj = NULL, sortbysize = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="objectsizes_+3A_obj">obj</code></td>
<td>
<p>Vector of object names.  If missing, we pull out all object
names.</p>
</td></tr>
<tr><td><code id="objectsizes_+3A_sortbysize">sortbysize</code></td>
<td>
<p>If TRUE, sort the objects from smallest to largest.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls <code><a href="utils.html#topic+object.size">utils::object.size()</a></code> repeated to get the size of a
list of objects.
</p>


<h3>Value</h3>

<p>A data frame with the only column being the size of each object in
megabytes (Mb).  The row names are the names of the objects.
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+object.size">utils::object.size()</a></code>, <code><a href="base.html#topic+ls">base::objects()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>print(output &lt;- objectsizes())
## Not run: sum(output)

</code></pre>

<hr>
<h2 id='openfile'>Open a file</h2><span id='topic+openfile'></span>

<h3>Description</h3>

<p>Open a file using [base::system() and <code>"open"</code>
(well, actually <code>"start"</code> on Linux).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openfile(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="openfile_+3A_file">file</code></td>
<td>
<p>File name (character string)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>I'd thought that to open a file you'd use <code>open</code> in
MacOS and <code>start</code> in Windows, but
<code>system("start myfile.pdf")</code> doesn't work in Windows, and
rather <code>system("open myfile.pdf")</code> does, so here we're
just using <code>open</code>, except on Linux where at least on my
system, you can use <code>"start"</code>.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: openfile("myplot.pdf")

</code></pre>

<hr>
<h2 id='paired.perm.test'>Paired permutation t-test</h2><span id='topic+paired.perm.test'></span>

<h3>Description</h3>

<p>Calculates a p-value for a paired t-test via permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paired.perm.test(d, n.perm = NULL, pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paired.perm.test_+3A_d">d</code></td>
<td>
<p>A numeric vector (of differences).</p>
</td></tr>
<tr><td><code id="paired.perm.test_+3A_n.perm">n.perm</code></td>
<td>
<p>Number of permutations to perform.  If NULL, all
possible permutations are considered, and an exact p-value is
calculated.</p>
</td></tr>
<tr><td><code id="paired.perm.test_+3A_pval">pval</code></td>
<td>
<p>If TRUE, return just the p-value.  If FALSE, return the
actual permutation results (with the observed statistic as an
attribute, <code>"tobs"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls the function <code><a href="stats.html#topic+t.test">stats::t.test()</a></code> to calculate a
t-statistic comparing the mean of <code>d</code> to 0.  Permutations
are perfomed to give an exact or approximate conditional p-value.
</p>


<h3>Value</h3>

<p>If <code>pval=TRUE</code>, the output is a single number: the P-value
testing for the symmetry about 0 of the distribution of the population
from which <code>d</code> was drawn.
If <code>pval=FALSE</code>, the output is a vector of the t statistics from
the permutations.  An attributed <code>"tobs"</code> contains the t
statistic with the observed data.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+t.test">stats::t.test()</a></code>, <code><a href="#topic+perm.test">perm.test()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(43.3, 57.1, 35.0, 50.0, 38.2, 31.2)
y &lt;- c(51.9, 95.1, 90.0, 49.7, 101.5, 74.1)
paired.perm.test(x-y)

</code></pre>

<hr>
<h2 id='paste.'>paste with dot separator</h2><span id='topic+paste.'></span>

<h3>Description</h3>

<p>Calls <code><a href="base.html#topic+paste">base::paste()</a></code> with <code>sep="."</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paste.(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paste._+3A_...">...</code></td>
<td>
<p>Passed to paste.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There's not much to this function.  It just is
<code><a href="base.html#topic+paste">base::paste()</a></code> with <code>sep=""</code>, 'cause I'm lazy.
</p>


<h3>Value</h3>

<p>A character string or vector of character strings.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">base::paste()</a></code>,
<code><a href="base.html#topic+paste">base::paste0()</a></code>,
<code><a href="#topic+paste00">paste00()</a></code>,
<code><a href="#topic+paste..">paste..()</a></code>,
<code><a href="#topic+paste0.">paste0.()</a></code>,
<code><a href="#topic+paste.0">paste.0()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 3
y &lt;- 4
paste.(x, y)

</code></pre>

<hr>
<h2 id='paste00'>paste with null or dot as separator and with collapse</h2><span id='topic+paste00'></span><span id='topic+paste0.'></span><span id='topic+paste.0'></span><span id='topic+paste..'></span>

<h3>Description</h3>

<p>Call <code><a href="base.html#topic+paste">base::paste()</a></code> with <code>sep="."</code> or <code>sep=""</code>
and <code>collapse=""</code> or <code>collapse="."</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paste00(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paste00_+3A_...">...</code></td>
<td>
<p>Passed to paste.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There's not much to these functions.
<code>paste00(...)</code> is like <code>paste(..., sep="", collapse="")</code>
<code>paste..(...)</code> is like <code>paste(..., sep=".", collapse=".")</code>
<code>paste0.(...)</code> is like <code>paste(..., sep="", collapse=".")</code>
<code>paste.0(...)</code> is like <code>paste(..., sep=".", collapse="")</code>
</p>


<h3>Value</h3>

<p>A character string or vector of character strings.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">base::paste()</a></code>,
<code><a href="base.html#topic+paste">base::paste0()</a></code>,
<code><a href="#topic+paste.">paste.()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(3, 4)
y &lt;- c(5, 6)
paste00(x, y)
paste..(x, y)
paste0.(x, y)
paste.0(x, y)

</code></pre>

<hr>
<h2 id='perm.test'>Permutation t-test</h2><span id='topic+perm.test'></span>

<h3>Description</h3>

<p>Calculates a p-value for a t-test via permutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.test(x, y, n.perm = NULL, var.equal = TRUE, pval = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.test_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_y">y</code></td>
<td>
<p>A second numeric vector.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_n.perm">n.perm</code></td>
<td>
<p>Number of permutations to perform.  If NULL, all
possible permutations are considered, and an exact p-value is
calculated.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_var.equal">var.equal</code></td>
<td>
<p>A logical variable indicating whether to treat the two
population variances as being equal.</p>
</td></tr>
<tr><td><code id="perm.test_+3A_pval">pval</code></td>
<td>
<p>If TRUE, return just the p-value.  If FALSE, return the
actual permutation results (with the observed statistic as an
attribute, <code>"tobs"</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This calls the function <code><a href="stats.html#topic+t.test">stats::t.test()</a></code> to calculate a
t-statistic comparing the vectors <code>x</code> and <code>y</code>.  Permutations
are perfomed to give an exact or approximate conditional p-value.
</p>


<h3>Value</h3>

<p>If <code>pval=TRUE</code>, the output is a single number: the P-value
testing for a difference in the distributions of the populations from
which <code>x</code> and <code>y</code> were drawn.
If <code>pval=FALSE</code>, the output is a vector of the t statistics from
the permutations.  An attributed <code>"tobs"</code> contains the t
statistic with the observed data.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+t.test">stats::t.test()</a></code>, <code><a href="#topic+paired.perm.test">paired.perm.test()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(43.3, 57.1, 35.0, 50.0, 38.2, 61.2)
y &lt;- c(51.9, 95.1, 90.0, 49.7, 101.5, 74.1)
perm.test(x,y)

</code></pre>

<hr>
<h2 id='pick_more_precise'>Pick the more precise value for each element in two related vectors</h2><span id='topic+pick_more_precise'></span>

<h3>Description</h3>

<p>Align two vectors of numbers by their names and then pick a single
value from each, favoring the more precise one. If the two values
differ by more than round-off error, treat the value as missing.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pick_more_precise(x, y, tol = 0.000001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pick_more_precise_+3A_x">x</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
<tr><td><code id="pick_more_precise_+3A_y">y</code></td>
<td>
<p>A second numeric vector</p>
</td></tr>
<tr><td><code id="pick_more_precise_+3A_tol">tol</code></td>
<td>
<p>Tolerance for differences between the values</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Okay, this is a bit weird. But suppose you have two columns of
numbers that have been subjected to different quirky rounding
patterns. We align the vectors using their names and then for each
element we pick between the two choices, favoring the more-precise
one. If one is missing, choose the non-missing value. If the two
differ by more than the round-off error, treat it as missing.
</p>


<h3>Value</h3>

<p>A vector of combined values
</p>

<hr>
<h2 id='plot_crayons'>Illustration of crayon colors</h2><span id='topic+plot_crayons'></span>

<h3>Description</h3>

<p>Creates a plot of the crayon colors in <code><a href="#topic+brocolors">brocolors()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_crayons(
  method2order = c("hsv", "cluster"),
  cex = 0.6,
  mar = rep(0.1, 4),
  bg = "white",
  fg = "black",
  border = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_crayons_+3A_method2order">method2order</code></td>
<td>
<p>method to order colors (<code>"hsv"</code> or <code>"cluster"</code>)</p>
</td></tr>
<tr><td><code id="plot_crayons_+3A_cex">cex</code></td>
<td>
<p>character expansion for the text</p>
</td></tr>
<tr><td><code id="plot_crayons_+3A_mar">mar</code></td>
<td>
<p>margin paramaters; vector of length 4 (see <code><a href="graphics.html#topic+par">graphics::par()</a></code>)</p>
</td></tr>
<tr><td><code id="plot_crayons_+3A_bg">bg</code></td>
<td>
<p>Background color</p>
</td></tr>
<tr><td><code id="plot_crayons_+3A_fg">fg</code></td>
<td>
<p>Foreground color (for text and box outlines)</p>
</td></tr>
<tr><td><code id="plot_crayons_+3A_border">border</code></td>
<td>
<p>If TRUE, plot a border around each rectangle</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None
</p>


<h3>References</h3>

<p><a href="https://en.wikipedia.org/wiki/List_of_Crayola_crayon_colors">https://en.wikipedia.org/wiki/List_of_Crayola_crayon_colors</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+brocolors">brocolors()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_crayons()
</code></pre>

<hr>
<h2 id='qqline2'>qqline for qqplot</h2><span id='topic+qqline2'></span>

<h3>Description</h3>

<p>Adds a line to a quantile-quantile plot for two datasets, from <code><a href="stats.html#topic+qqnorm">stats::qqplot()</a></code>.
(The available <code><a href="stats.html#topic+qqnorm">stats::qqline()</a></code> function works mainly for
<code><a href="stats.html#topic+qqnorm">stats::qqnorm()</a></code>, with one sample being theoretical quantiles.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqline2(x, y, probs = c(0.25, 0.75), qtype = 7, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqline2_+3A_x">x</code></td>
<td>
<p>The first sample</p>
</td></tr>
<tr><td><code id="qqline2_+3A_y">y</code></td>
<td>
<p>The second sample.</p>
</td></tr>
<tr><td><code id="qqline2_+3A_probs">probs</code></td>
<td>
<p>numeric vector of length two, representing probabilities.
Corresponding quantile pairs define the line drawn.</p>
</td></tr>
<tr><td><code id="qqline2_+3A_qtype">qtype</code></td>
<td>
<p>the <code>type</code> of quantile computation used in <code><a href="stats.html#topic+quantile">stats::quantile()</a></code>.</p>
</td></tr>
<tr><td><code id="qqline2_+3A_...">...</code></td>
<td>
<p>graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Intercept and slope of the line.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqnorm">stats::qqline()</a></code>, <code><a href="stats.html#topic+qqnorm">stats::qqplot()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rchisq(500, 3)
y &lt;- rgamma(730, 3, 1/2)
qqplot(x, y)
qqline2(x, y)

</code></pre>

<hr>
<h2 id='qr2'>The QR decomposition of a matrix</h2><span id='topic+qr2'></span>

<h3>Description</h3>

<p>Computes the QR decomposition of a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qr2(x, tol = 0.0000001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qr2_+3A_x">x</code></td>
<td>
<p>A matrix whose QR decomposition is to be computed.</p>
</td></tr>
<tr><td><code id="qr2_+3A_tol">tol</code></td>
<td>
<p>The tolerance for detecting linear dependencies in the
columns of <code>x</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calls the function <code><a href="base.html#topic+qr">base::qr()</a></code> and returns
less compact but more understandable output.
</p>


<h3>Value</h3>

<p>A list of two matrices: Q and R.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+qr">base::qr()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hilbert &lt;- function(n) { i &lt;- 1:n; 1/outer(i-1,i,"+") }
h5 &lt;- hilbert(5);
qr2(h5)

</code></pre>

<hr>
<h2 id='quantileSE'>Sample quantiles and their standard errors</h2><span id='topic+quantileSE'></span>

<h3>Description</h3>

<p>Calculate sample quantiles and their estimated standard errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileSE(x, p = 0.95, bw = NULL, na.rm = TRUE, names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileSE_+3A_x">x</code></td>
<td>
<p>Numeric vector whose sample quantiles are wanted.</p>
</td></tr>
<tr><td><code id="quantileSE_+3A_p">p</code></td>
<td>
<p>Numeric vector with values in the interval [0,1]</p>
</td></tr>
<tr><td><code id="quantileSE_+3A_bw">bw</code></td>
<td>
<p>Bandwidth to use in the density estimation.</p>
</td></tr>
<tr><td><code id="quantileSE_+3A_na.rm">na.rm</code></td>
<td>
<p>Logical; if true, and <code>NA</code> and <code>NaN</code>'s are
removed from <code>x</code> before the quantiles are computed.</p>
</td></tr>
<tr><td><code id="quantileSE_+3A_names">names</code></td>
<td>
<p>Logical; if true, the column names of the result is set to
the values in <code>p</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample quantiles are calculated with the function
<code><a href="stats.html#topic+quantile">stats::quantile()</a></code>.
Standard errors are obtained by the asymptotic approximation described
in Cox and Hinkley (1974).  Density values are estimated using a
kernel density estimate with the function <code><a href="stats.html#topic+density">stats::density()</a></code>.
</p>


<h3>Value</h3>

<p>A matrix of size 2 x <code>length(p)</code>.  The first row contains the
estimated quantiles; the second row contains the corresponding
estimated standard errors.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">stats::quantile()</a></code>, <code><a href="stats.html#topic+density">stats::density()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>quantileSE(rchisq(1000,4), c(0.9,0.95))

</code></pre>

<hr>
<h2 id='revgray'>Create vector of colors from white to black</h2><span id='topic+revgray'></span>

<h3>Description</h3>

<p>Calls <code><a href="grDevices.html#topic+gray">grDevices::gray()</a></code> then <code><a href="base.html#topic+rev">base::rev()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revgray(n = 256, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revgray_+3A_n">n</code></td>
<td>
<p>Number of colors.</p>
</td></tr>
<tr><td><code id="revgray_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="grDevices.html#topic+gray">grDevices::gray()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There's not much to this. It's just <code style="white-space: pre;">&#8288;gray((n:0)/n))&#8288;</code>
</p>


<h3>Value</h3>

<p>Vector of colors, from white to black
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+gray">grDevices::gray()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rnorm(100), ncol=10)
image(x, col=revgray())

</code></pre>

<hr>
<h2 id='revrainbow'>Create vector of colors from blue to red</h2><span id='topic+revrainbow'></span>

<h3>Description</h3>

<p>Calls <code><a href="grDevices.html#topic+palettes">grDevices::rainbow()</a></code> then <code><a href="base.html#topic+rev">base::rev()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>revrainbow(n = 256, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="revrainbow_+3A_n">n</code></td>
<td>
<p>Number of colors.</p>
</td></tr>
<tr><td><code id="revrainbow_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="grDevices.html#topic+palettes">grDevices::rainbow()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There's not much to this. It's just <code>rev(rainbow(start=0, end=2/3, ...))</code>.
</p>


<h3>Value</h3>

<p>Vector of colors, from blue to red.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+rev">base::rev()</a></code>,
<code><a href="grDevices.html#topic+palettes">grDevices::rainbow()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rnorm(100), ncol=10)
image(x, col=revrainbow())

</code></pre>

<hr>
<h2 id='rmvn'>Simulate multivariate normal</h2><span id='topic+rmvn'></span>

<h3>Description</h3>

<p>Simulate from a multivariate normal distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rmvn(n, mu = 0, V = matrix(1))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rmvn_+3A_n">n</code></td>
<td>
<p>Number of simulation replicates.</p>
</td></tr>
<tr><td><code id="rmvn_+3A_mu">mu</code></td>
<td>
<p>Mean vector.</p>
</td></tr>
<tr><td><code id="rmvn_+3A_v">V</code></td>
<td>
<p>Variance-covariance matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses the Cholesky decomposition of the matrix <code>V</code>, obtained by
<code><a href="base.html#topic+chol">base::chol()</a></code>.
</p>


<h3>Value</h3>

<p>A matrix of size n x <code>length(mu)</code>.  Each row corresponds to a
separate replicate.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+Normal">stats::rnorm()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- rmvn(100, c(1,2),matrix(c(1,1,1,4),ncol=2))

</code></pre>

<hr>
<h2 id='runningmean'>Running mean, sum, or median</h2><span id='topic+runningmean'></span>

<h3>Description</h3>

<p>Calculates a running mean, sum or median with a specified window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runningmean(
  pos,
  value,
  at = NULL,
  window = 1000,
  what = c("mean", "sum", "median", "sd")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runningmean_+3A_pos">pos</code></td>
<td>
<p>Positions for the values.</p>
</td></tr>
<tr><td><code id="runningmean_+3A_value">value</code></td>
<td>
<p>Values for which the running mean/sum/median/sd is to be
applied.</p>
</td></tr>
<tr><td><code id="runningmean_+3A_at">at</code></td>
<td>
<p>Positions at which running mean (or sum or median or sd) is
calculated.  If NULL, <code>pos</code> is used.</p>
</td></tr>
<tr><td><code id="runningmean_+3A_window">window</code></td>
<td>
<p>Window width.</p>
</td></tr>
<tr><td><code id="runningmean_+3A_what">what</code></td>
<td>
<p>Statistic to use.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the same length as the input <code>at</code> (or <code>pos</code>,
if <code>at</code> is NULL), containing the running
statistic.
</p>


<h3>Author(s)</h3>

<p>Karl W Broman <a href="mailto:broman@wisc.edu">broman@wisc.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runningratio">runningratio()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:10000
y &lt;- rnorm(length(x))
plot(x,y, xaxs="i", yaxs="i")
lines(x, runningmean(x, y, window=100, what="mean"),
      col="blue", lwd=2)
lines(x, runningmean(x, y, window=100, what="median"),
      col="red", lwd=2)
lines(x, runningmean(x, y, window=100, what="sd"),
      col="green", lwd=2)

</code></pre>

<hr>
<h2 id='runningratio'>Running ratio</h2><span id='topic+runningratio'></span>

<h3>Description</h3>

<p>Calculates a running ratio; a ratio sum(top)/sum(bottom) in a sliding window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runningratio(pos, numerator, denominator, at = NULL, window = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runningratio_+3A_pos">pos</code></td>
<td>
<p>Positions for the values.</p>
</td></tr>
<tr><td><code id="runningratio_+3A_numerator">numerator</code></td>
<td>
<p>Values for numerator in ratio.</p>
</td></tr>
<tr><td><code id="runningratio_+3A_denominator">denominator</code></td>
<td>
<p>Values for denominator in ratio.</p>
</td></tr>
<tr><td><code id="runningratio_+3A_at">at</code></td>
<td>
<p>Positions at which running ratio is
calculated.  If NULL, <code>pos</code> is used.</p>
</td></tr>
<tr><td><code id="runningratio_+3A_window">window</code></td>
<td>
<p>Window width.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the same length as the input <code>at</code> (or <code>pos</code>,
if <code>at</code> is NULL), containing the running ratio.
</p>


<h3>Author(s)</h3>

<p>Karl W Broman <a href="mailto:broman@wisc.edu">broman@wisc.edu</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runningmean">runningmean()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- 1:1000
y &lt;- runif(1000, 1, 5)
z &lt;- runif(1000, 1, 5)
plot(x, runningratio(x, y, z, window=5), type="l", lwd=2)
lines(x, runningratio(x, y, z, window=50), lwd=2, col="blue")
lines(x, runningratio(x, y, z, window=100), lwd=2, col="red")

</code></pre>

<hr>
<h2 id='setRNGparallel'>Set up random number generation for parallel calculations</h2><span id='topic+setRNGparallel'></span><span id='topic+unsetRNGparallel'></span>

<h3>Description</h3>

<p>Set random number generation to L'Ecuyer-CMRG, for use in parallel calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setRNGparallel()

unsetRNGparallel()
</code></pre>


<h3>Details</h3>

<p>I can never remember the command <code>RNGkind("L'Ecuyer-CMRG")</code>; this is a shortcut.
<code>unsetRNG4parallel</code> sets the random number generator back to the default type.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind()
setRNGparallel()
RNGkind()
unsetRNGparallel()
RNGkind()
</code></pre>

<hr>
<h2 id='simp'>Numerical integration</h2><span id='topic+simp'></span><span id='topic+trap'></span>

<h3>Description</h3>

<p>Perform numerical integration by Simpson's rule or the trapezoidal
rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simp(f, a, b, tol = 0.00000001, max.step = 1000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simp_+3A_f">f</code></td>
<td>
<p>The integrand; must be a vectorized function.</p>
</td></tr>
<tr><td><code id="simp_+3A_a">a</code></td>
<td>
<p>Lower limit of integration.</p>
</td></tr>
<tr><td><code id="simp_+3A_b">b</code></td>
<td>
<p>Upper limit of integration.</p>
</td></tr>
<tr><td><code id="simp_+3A_tol">tol</code></td>
<td>
<p>Tolerance for choosing the number of grid points.</p>
</td></tr>
<tr><td><code id="simp_+3A_max.step">max.step</code></td>
<td>
<p>Log base 2 of the total number of grid points.</p>
</td></tr>
<tr><td><code id="simp_+3A_...">...</code></td>
<td>
<p>Other arguments passed to the integrand, <code>f</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Iterately doubles the number of grid points for the numerical
integral, stopping when the integral decreases by less than
<code>tol</code>.
</p>


<h3>Value</h3>

<p>The integral of <code>f</code> from <code>a</code> to <code>b</code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+integrate">stats::integrate()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>f &lt;- function(x) x*x*(1-x)*sin(x*x)
I1 &lt;- trap(f,0,2)
I2 &lt;- simp(f,0,2)

</code></pre>

<hr>
<h2 id='spell_out'>Spell out an integer</h2><span id='topic+spell_out'></span>

<h3>Description</h3>

<p>Spell out an integer as a word, for use in reports/papers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spell_out(number, capitalize = FALSE, max_value = 9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spell_out_+3A_number">number</code></td>
<td>
<p>A number that is to be spelled out (can be a vector).</p>
</td></tr>
<tr><td><code id="spell_out_+3A_capitalize">capitalize</code></td>
<td>
<p>If TRUE, capitalize the first letter.</p>
</td></tr>
<tr><td><code id="spell_out_+3A_max_value">max_value</code></td>
<td>
<p>Maximum value to use (generally 9); if larger than this, use numerals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string (or vector of character strings) with numbers spelled out, or as numerals if large.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spell_out(9)
spell_out(9, cap=TRUE)
spell_out(9, max_value=5)
</code></pre>

<hr>
<h2 id='strwidth2lines'>Calculate width of a character string in number of lines</h2><span id='topic+strwidth2lines'></span>

<h3>Description</h3>

<p>Convert <code>stringwidth</code> units to number of (margin) lines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strwidth2lines(s, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strwidth2lines_+3A_s">s</code></td>
<td>
<p>A character or expression vector whose length is to be calculated</p>
</td></tr>
<tr><td><code id="strwidth2lines_+3A_...">...</code></td>
<td>
<p>additional information used by <code>strwidth</code>, such as
<code>cex</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Maximum string width in units of margin lines
</p>


<h3>Author(s)</h3>

<p>Aimee Teo Broman
</p>


<h3>Examples</h3>

<pre><code class='language-R'>p &lt;- par(TRUE)
string &lt;- sapply(sample(1:20,15,replace=TRUE),
         function(a) paste(LETTERS[1:a], collapse=""))
nlines &lt;- strwidth2lines(string)
mar &lt;- par("mar")
par(mar=c(mar[1],nlines+0.1,mar[3:4]))
  plot(1:length(string),1:length(string),yaxt="n", ylab="")
  axis(side=2, at=seq_along(string), lab=string, las=1)
par(p)
nlines &lt;- strwidth2lines(string,cex=1.5)
par(mar=c(mar[1:3],nlines+0.1))
  plot(1:length(string),1:length(string),ylab="")
  mgp &lt;- par("mgp")
  axis(side = 4, at=seq_along(string),
    labels = string ,las=1, hadj=1,
       mgp=c(mgp[1],nlines,mgp[3]),cex.axis=1.5)
par(p)
</code></pre>

<hr>
<h2 id='strwidth2xlim'>Calculate horizontal limit in user coordinates for adding labels</h2><span id='topic+strwidth2xlim'></span>

<h3>Description</h3>

<p>Calculates the x-axis limits when adding (long) labels to a plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>strwidth2xlim(x, xstring, pos = 4, offset = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="strwidth2xlim_+3A_x">x</code></td>
<td>
<p>numeric vector of horizontal coordinates</p>
</td></tr>
<tr><td><code id="strwidth2xlim_+3A_xstring">xstring</code></td>
<td>
<p>character vector, specifying text to be written</p>
</td></tr>
<tr><td><code id="strwidth2xlim_+3A_pos">pos</code></td>
<td>
<p>position specifier for text; values of <code>1</code>, <code>2</code>,
<code>3</code>, and <code>4</code>, respectively, indicate positions below, to
the left of, above, and to the right of the coordinates</p>
</td></tr>
<tr><td><code id="strwidth2xlim_+3A_offset">offset</code></td>
<td>
<p>offset of the label from the coordinate in fractions of
a character width</p>
</td></tr>
<tr><td><code id="strwidth2xlim_+3A_...">...</code></td>
<td>
<p>additional text parameters from <code>par</code>, such as <code>cex</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code>text</code> for details on <code>pos</code> and <code>offset</code>.
</p>


<h3>Value</h3>

<p>Minimum and maximum x-axis limits for adding horizontal text
</p>


<h3>Author(s)</h3>

<p>Aimee Teo Broman
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+text">graphics::text()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- runif(15,-1,1)*10
xlabs &lt;- sapply(sample(1:20,15,replace=TRUE),
         function(a) paste(LETTERS[1:a], collapse=""))
## Labels to the left ##
xlims &lt;- strwidth2xlim(x,xlabs,pos=2)
plot(x,1:length(x),xlim=xlims)
text(x,1:length(x),xlabs,pos=2)
## Labels to the right ##
xlims &lt;- strwidth2xlim(x,xlabs,pos=4,cex=0.7)
plot(x,1:length(x),xlim=xlims)
text(x,1:length(x),xlabs,pos=4,cex=0.7)

</code></pre>

<hr>
<h2 id='switchv'>Vectorized version of switch</h2><span id='topic+switchv'></span>

<h3>Description</h3>

<p>Vectorized version of <code><a href="base.html#topic+switch">base::switch()</a></code>: just loops over
input and calls <code><a href="base.html#topic+switch">base::switch()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>switchv(EXPR, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="switchv_+3A_expr">EXPR</code></td>
<td>
<p>An expression evaluating to a vector of numbers of strings</p>
</td></tr>
<tr><td><code id="switchv_+3A_...">...</code></td>
<td>
<p>List of alternatives</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of returned values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>switchv(c("horse", "fish", "cat", "bug"),
        horse="fast",
        cat="cute",
        "what?")

</code></pre>

<hr>
<h2 id='theme_karl'>Karl's ggplot2 theme</h2><span id='topic+theme_karl'></span><span id='topic+karl_theme'></span>

<h3>Description</h3>

<p>Karl's ggplot2 theme: black border and no ticks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_karl(base_size = 12, base_family = "", ...)

karl_theme(base_size = 12, base_family = "", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_karl_+3A_base_size">base_size</code></td>
<td>
<p>Base font size</p>
</td></tr>
<tr><td><code id="theme_karl_+3A_base_family">base_family</code></td>
<td>
<p>Base font family</p>
</td></tr>
<tr><td><code id="theme_karl_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object as returned by <code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+theme">ggplot2::theme()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
mtcars$cyl &lt;- factor(mtcars$cyl)
ggplot(mtcars, aes(y=mpg, x=disp, color=cyl)) +
    geom_point() + theme_karl()

</code></pre>

<hr>
<h2 id='triarrow'>Plot an arrow within a Holmans triangle</h2><span id='topic+triarrow'></span>

<h3>Description</h3>

<p>Plot an arrow within a Holmans triangle (an equilateral triangle used to depict
trinomial distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triarrow(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triarrow_+3A_x">x</code></td>
<td>
<p>A matrix with three rows and two columns, each column being a trinomial
distribution.  An arrow between the two points is plotted.</p>
</td></tr>
<tr><td><code id="triarrow_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="graphics.html#topic+arrows">graphics::arrows()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of an equilateral triangle, in order to depict trinomial
distributions.  A trinomial distribution (that is, a trio of
non-negative numbers that add to 1) is equated to a point in the
triangle through the distances to the three sides.  This makes use of
the fact that for any point in an equilateral triangle, the sum of the
distances to the three sides is constant.
First use <code><a href="#topic+triplot">triplot()</a></code> to first plot the equilateral triangle.
</p>


<h3>Value</h3>

<p>The (x,y) coordinates of the endpoints of the arrows plotted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+triplot">triplot()</a></code>, <code><a href="#topic+tripoints">tripoints()</a></code>,
<code><a href="#topic+trilines">trilines()</a></code>, <code><a href="#topic+tritext">tritext()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot()
x &lt;- cbind(c(0.9, 0.05, 0.05), c(0.8, 0.1, 0.1), c(0.1, 0.9, 0), c(0, 0.9, 0.1))
tripoints(x, lwd=2, col=c("black","blue","red","green"), pch=16)
trilines(x, lwd=2, col="orange")
y &lt;- cbind(c(0.05, 0.05, 0.9), c(0.25, 0.25, 0.5))
triarrow(y, col="blue", lwd=2, len=0.1)

</code></pre>

<hr>
<h2 id='trigrid'>Add grid lines to triplot</h2><span id='topic+trigrid'></span>

<h3>Description</h3>

<p>Add grid lines to a ternary plot with <code><a href="#topic+triplot">triplot()</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trigrid(
  n = 1,
  col = "white",
  lty = 1,
  lwd = 1,
  outer_col = "black",
  outer_lwd = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trigrid_+3A_n">n</code></td>
<td>
<p>Number of grid lines</p>
</td></tr>
<tr><td><code id="trigrid_+3A_col">col</code></td>
<td>
<p>Color of grid lines</p>
</td></tr>
<tr><td><code id="trigrid_+3A_lty">lty</code></td>
<td>
<p>Line type for grid lines</p>
</td></tr>
<tr><td><code id="trigrid_+3A_lwd">lwd</code></td>
<td>
<p>Line width of grid lines</p>
</td></tr>
<tr><td><code id="trigrid_+3A_outer_col">outer_col</code></td>
<td>
<p>Color of outer triangle (If NULL, not plotted)</p>
</td></tr>
<tr><td><code id="trigrid_+3A_outer_lwd">outer_lwd</code></td>
<td>
<p>Line width of outer triangle</p>
</td></tr>
<tr><td><code id="trigrid_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+trilines">trilines()</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+triplot">triplot()</a></code>, <code><a href="#topic+trilines">trilines()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot(c("A","H","B"), gridlines=1, grid_lwd=2)
trigrid(3, lty=2, lwd=2)
</code></pre>

<hr>
<h2 id='trilines'>Plot lines within a Holmans triangle</h2><span id='topic+trilines'></span>

<h3>Description</h3>

<p>Plot lines within a Holmans triangle (an equilateral triangle used to depict
trinomial distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trilines(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trilines_+3A_x">x</code></td>
<td>
<p>A matrix with three rows, each column being a trinomial
distribution.  Lines between these points are plotted.</p>
</td></tr>
<tr><td><code id="trilines_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="graphics.html#topic+lines">graphics::lines()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of an equilateral triangle, in order to depict trinomial
distributions.  A trinomial distribution (that is, a trio of
non-negative numbers that add to 1) is equated to a point in the
triangle through the distances to the three sides.  This makes use of
the fact that for any point in an equilateral triangle, the sum of the
distances to the three sides is constant.
First use <code><a href="#topic+triplot">triplot()</a></code> to first plot the equilateral triangle.
</p>


<h3>Value</h3>

<p>The (x,y) coordinates of the endpoints of the lines plotted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+triplot">triplot()</a></code>, <code><a href="#topic+tripoints">tripoints()</a></code>,
<code><a href="#topic+triarrow">triarrow()</a></code>, <code><a href="#topic+tritext">tritext()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot()
x &lt;- cbind(c(0.9, 0.05, 0.05), c(0.8, 0.1, 0.1), c(0.1, 0.9, 0), c(0, 0.9, 0.1))
tripoints(x, lwd=2, col=c("black","blue","red","green"), pch=16)
trilines(x, lwd=2, col="orange")
y &lt;- cbind(c(0.05, 0.05, 0.9), c(0.25, 0.25, 0.5))
triarrow(y, col="blue", lwd=2, len=0.1)

</code></pre>

<hr>
<h2 id='triplot'>Plot Holmans triangle</h2><span id='topic+triplot'></span>

<h3>Description</h3>

<p>Plot Holmans triangle (an equilateral triangle used to depict
trinomial distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>triplot(
  labels = c("(1,0,0)", "(0,1,0)", "(0,0,1)"),
  col = "black",
  lwd = 2,
  bgcolor = "gray90",
  gridlines = 0,
  grid_col = "white",
  grid_lty = 1,
  grid_lwd = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="triplot_+3A_labels">labels</code></td>
<td>
<p>Labels for the three corners (lower-right, top, lower-left).</p>
</td></tr>
<tr><td><code id="triplot_+3A_col">col</code></td>
<td>
<p>Color of edges of triangle</p>
</td></tr>
<tr><td><code id="triplot_+3A_lwd">lwd</code></td>
<td>
<p>Line width for edges of triangle</p>
</td></tr>
<tr><td><code id="triplot_+3A_bgcolor">bgcolor</code></td>
<td>
<p>Background color for triangle</p>
</td></tr>
<tr><td><code id="triplot_+3A_gridlines">gridlines</code></td>
<td>
<p>Number of grid lines (if 0, no grid lines will be plotted)</p>
</td></tr>
<tr><td><code id="triplot_+3A_grid_col">grid_col</code></td>
<td>
<p>Color of grid lines</p>
</td></tr>
<tr><td><code id="triplot_+3A_grid_lty">grid_lty</code></td>
<td>
<p>Line type of grid lines</p>
</td></tr>
<tr><td><code id="triplot_+3A_grid_lwd">grid_lwd</code></td>
<td>
<p>Line width of grid lines</p>
</td></tr>
<tr><td><code id="triplot_+3A_...">...</code></td>
<td>
<p>Passed to <code>plot()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of an equilateral triangle, in order to depict trinomial
distributions.  A trinomial distribution (that is, a trio of
non-negative numbers that add to 1) is equated to a point in the
triangle through the distances to the three sides.  This makes use of
the fact that for any point in an equilateral triangle, the sum of the
distances to the three sides is constant.
The <code>triplot</code> function creates an empty triangle for use with the
related functions <code><a href="#topic+tripoints">tripoints()</a></code>, <code><a href="#topic+trilines">trilines()</a></code>,
<code><a href="#topic+triarrow">triarrow()</a></code>.
</p>


<h3>Value</h3>

<p>The (x,y) coordinates of the points plotted, if any.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tripoints">tripoints()</a></code>, <code><a href="#topic+trilines">trilines()</a></code>,
<code><a href="#topic+triarrow">triarrow()</a></code>, <code><a href="#topic+tritext">tritext()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot()
x &lt;- cbind(c(0.9, 0.05, 0.05), c(0.8, 0.1, 0.1), c(0.1, 0.9, 0), c(0, 0.9, 0.1))
tripoints(x, lwd=2, col=c("black","blue","red","green"), pch=16)
trilines(x, lwd=2, col="orange")
y &lt;- cbind(c(0.05, 0.05, 0.9), c(0.25, 0.25, 0.5))
triarrow(y, col="blue", lwd=2, len=0.1)

</code></pre>

<hr>
<h2 id='tripoints'>Plot points within a Holmans triangle</h2><span id='topic+tripoints'></span>

<h3>Description</h3>

<p>Plot points within a Holmans triangle (an equilateral triangle used to depict
trinomial distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tripoints(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tripoints_+3A_x">x</code></td>
<td>
<p>A matrix with three rows, each column being a trinomial distribution.</p>
</td></tr>
<tr><td><code id="tripoints_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="graphics.html#topic+points">graphics::points()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of an equilateral triangle, in order to depict trinomial
distributions.  A trinomial distribution (that is, a trio of
non-negative numbers that add to 1) is equated to a point in the
triangle through the distances to the three sides.  This makes use of
the fact that for any point in an equilateral triangle, the sum of the
distances to the three sides is constant.
First use <code><a href="#topic+triplot">triplot()</a></code> to first plot the equilateral triangle.
</p>


<h3>Value</h3>

<p>The (x,y) coordinates of the points plotted.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+triplot">triplot()</a></code>, <code><a href="#topic+trilines">trilines()</a></code>,
<code><a href="#topic+triarrow">triarrow()</a></code>, <code><a href="#topic+tritext">tritext()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot()
x &lt;- cbind(c(0.9, 0.05, 0.05), c(0.8, 0.1, 0.1), c(0.1, 0.9, 0), c(0, 0.9, 0.1))
tripoints(x, lwd=2, col=c("black","blue","red","green"), pch=16)
trilines(x, lwd=2, col="orange")
y &lt;- cbind(c(0.05, 0.05, 0.9), c(0.25, 0.25, 0.5))
triarrow(y, col="blue", lwd=2, len=0.1)

</code></pre>

<hr>
<h2 id='tritext'>Plot text within a Holmans triangle</h2><span id='topic+tritext'></span>

<h3>Description</h3>

<p>Plot text within a Holmans triangle (an equilateral triangle used to depict
trinomial distributions).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tritext(x, labels, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tritext_+3A_x">x</code></td>
<td>
<p>A matrix with three rows, each column being a trinomial distribution.</p>
</td></tr>
<tr><td><code id="tritext_+3A_labels">labels</code></td>
<td>
<p>A vector of character strings, with length equal to the number of columns of <code>x</code>.</p>
</td></tr>
<tr><td><code id="tritext_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="graphics.html#topic+text">graphics::text()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plot of an equilateral triangle, in order to depict trinomial
distributions.  A trinomial distribution (that is, a trio of
non-negative numbers that add to 1) is equated to a point in the
triangle through the distances to the three sides.  This makes use of
the fact that for any point in an equilateral triangle, the sum of the
distances to the three sides is constant.
First use <code><a href="#topic+triplot">triplot()</a></code> to first plot the equilateral triangle.
</p>


<h3>Value</h3>

<p>Text is plotted at the (x,y) coordinates of the points.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+triplot">triplot()</a></code>, <code><a href="#topic+trilines">trilines()</a></code>,
<code><a href="#topic+triarrow">triarrow()</a></code>, <code><a href="#topic+tripoints">tripoints()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>triplot()
x &lt;- cbind(c(0.25, 0.5, 0.25), c(1/3, 1/3, 1/3))
tripoints(x, lwd=2, pch=21, bg="lightblue")
xp &lt;- x + c(0.02, 0, -0.02)
tritext(xp, c("(1/4,1/2,1/4)", "(1/3,1/3,1/3)"), adj=c(0, 0.5))

</code></pre>

<hr>
<h2 id='twocolorpal'>Create vector of colors from blue to white to red</h2><span id='topic+twocolorpal'></span>

<h3>Description</h3>

<p>Create a two-color palette from one color to another through some third color
</p>


<h3>Usage</h3>

<pre><code class='language-R'>twocolorpal(colors = c("slateblue", "white", "violetred"), n = 256, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="twocolorpal_+3A_colors">colors</code></td>
<td>
<p>Vector of three colors</p>
</td></tr>
<tr><td><code id="twocolorpal_+3A_n">n</code></td>
<td>
<p>Number of colors in output.</p>
</td></tr>
<tr><td><code id="twocolorpal_+3A_...">...</code></td>
<td>
<p>Passed to <code><a href="grDevices.html#topic+colorRamp">grDevices::colorRampPalette()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of colors, from blue to white to red
</p>


<h3>See Also</h3>

<p><code><a href="#topic+revgray">revgray()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- matrix(rnorm(100, 0.5), ncol=10)
mxabs &lt;- max(abs(x))
image(x, col=twocolorpal(), zlim=c(-mxabs, mxabs))

</code></pre>

<hr>
<h2 id='vec2string'>Turn a vector into a single character string</h2><span id='topic+vec2string'></span>

<h3>Description</h3>

<p>Turn a vector into a single character string with the items separated by commas and an &quot;and&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vec2string(x, conjunction = "and")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vec2string_+3A_x">x</code></td>
<td>
<p>A vector</p>
</td></tr>
<tr><td><code id="vec2string_+3A_conjunction">conjunction</code></td>
<td>
<p>Word used to combine the strings</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>vec2string(letters[1:2])
vec2string(letters[1:4])
vec2string(letters[1:4], "or")
</code></pre>

<hr>
<h2 id='venn'>Plot to-scale Venn diagram</h2><span id='topic+venn'></span>

<h3>Description</h3>

<p>Plot a Venn diagram (with two groups), to scale, either with circles
or with squares.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>venn(
  setA = 50,
  setB = 50,
  both = 25,
  method = c("circle", "square"),
  labels = c("A", "B"),
  col = c("blue", "red")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="venn_+3A_seta">setA</code></td>
<td>
<p>Total area of set A.</p>
</td></tr>
<tr><td><code id="venn_+3A_setb">setB</code></td>
<td>
<p>Total area of set B.</p>
</td></tr>
<tr><td><code id="venn_+3A_both">both</code></td>
<td>
<p>Area of intersection of sets A and B.</p>
</td></tr>
<tr><td><code id="venn_+3A_method">method</code></td>
<td>
<p>Indicates whether to plot circles or squares.</p>
</td></tr>
<tr><td><code id="venn_+3A_labels">labels</code></td>
<td>
<p>Labels for the two sets.  (<code>NULL</code> for no labels.)</p>
</td></tr>
<tr><td><code id="venn_+3A_col">col</code></td>
<td>
<p>Colors of the two sets.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Plots a to-scale Venn diagram with two sets, so that the relative
areas of the two sets and their intersection are exact.
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>venn(setA=86, setB=1622, both=10)
venn(setA=86, setB=1622, both=10, method="square")

</code></pre>

<hr>
<h2 id='winsorize'>Winsorize a vector</h2><span id='topic+winsorize'></span>

<h3>Description</h3>

<p>For a numeric vector, move values below and above the q and 1-q
quantiles to those quantiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>winsorize(x, q = 0.006)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="winsorize_+3A_x">x</code></td>
<td>
<p>Numeric vector</p>
</td></tr>
<tr><td><code id="winsorize_+3A_q">q</code></td>
<td>
<p>Lower quantile to use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector like the input <code>x</code>, but with extreme values moved in to
the <code>q</code> and <code>1-q</code> quantiles.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- sample(c(1:10, rep(NA, 10), 21:30))
winsorize(x, 0.2)

</code></pre>

<hr>
<h2 id='xlimlabel'>Calulate horizontal limit in user coordinates for adding labels</h2><span id='topic+xlimlabel'></span>

<h3>Description</h3>

<p>Calculates the x-axis limits when adding (long) labels to a plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xlimlabel(x, xlabels, pos = 4, offset = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="xlimlabel_+3A_x">x</code></td>
<td>
<p>numeric vector of horizontal coordinates</p>
</td></tr>
<tr><td><code id="xlimlabel_+3A_xlabels">xlabels</code></td>
<td>
<p>character vector, specifying text to be written</p>
</td></tr>
<tr><td><code id="xlimlabel_+3A_pos">pos</code></td>
<td>
<p>position specifier for text; values of <code>1</code>, <code>2</code>,
<code>3</code>, and <code>4</code>, respectively, indicate positions below, to
the left of, above, and to the right of the coordinates</p>
</td></tr>
<tr><td><code id="xlimlabel_+3A_offset">offset</code></td>
<td>
<p>offset of the label from the coordinate in fractions of
a character width</p>
</td></tr>
<tr><td><code id="xlimlabel_+3A_...">...</code></td>
<td>
<p>Additional par arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="graphics.html#topic+text">graphics::text()</a></code> for details on <code>pos</code> and <code>offset</code>.
</p>


<h3>Value</h3>

<p>Minimum and maximum x-axis limits for adding horizontal text
</p>


<h3>Author(s)</h3>

<p>Aimee Teo Broman
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+text">graphics::text()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- runif(15, -1, 1)*10
xlabs &lt;- sapply(sample(1:20, 15, replace=TRUE),
                function(a) paste(LETTERS[1:a], collapse=""))
par(mfrow=c(2,1), las=1)
## Labels to the left ##
xlims &lt;- xlimlabel(x, xlabs, pos=2)
plot(x, 1:length(x), xlim=xlims, ylab="Index")
text(x, 1:length(x), xlabs, pos=2)
## Labels to the right ##
xlims &lt;- xlimlabel(x, xlabs, pos=4, cex=0.7)
plot(x, 1:length(x), xlim=xlims, ylab="Index")
text(x, 1:length(x), xlabs, pos=4, cex=0.7)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
