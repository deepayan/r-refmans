<!DOCTYPE html><html lang="en"><head><title>Help for package marlod</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {marlod}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Fillin'><p>Fill-in or Substitution Methods</p></a></li>
<li><a href='#MGEE'><p>Function of a Generalized Estimating Equation (GEE) Model</p></a></li>
<li><a href='#Modified.GEE'><p>Function of a Generalized Estimating Equation (GEE) Model</p></a></li>
<li><a href='#Modified.GMM'><p>Function of a Generalized Method of Moments Model</p></a></li>
<li><a href='#Modified.QIF'><p>Function of a Quadratic Inference Function (QIF) Model</p></a></li>
<li><a href='#MQIF'><p>Function of a Quadratic Inference Function (QIF) Model</p></a></li>
<li><a href='#Quantile.FWZ'><p>Function of a Quantile Regression Model</p></a></li>
<li><a href='#Quantile.select.FWZ'><p>Function to Select a Type of Time-Dependent Covaraite Through a Quantile Regression Model</p></a></li>
<li><a href='#Selected.GEE'><p>Function to Select a Type of Time-Dependent Covaraite Through a Generalized Estimating Equation Model</p></a></li>
<li><a href='#Selected.QIF'><p>Function to Select a Type of Time-Dependent Covaraite Through a Quadratic Inference Function Model</p></a></li>
<li><a href='#simdata15'><p>Simulated Dataset 15</p></a></li>
<li><a href='#simdata58'><p>Simulated Dataset 58</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Marginal Modeling for Exposure Data with Values Below the LOD</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, miWQS, quantreg, stats, knitr</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>I-Chen Chen &lt;okv0@cdc.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions of marginal mean and quantile regression models are used to analyze environmental exposure and biomonitoring data with repeated measurements and non-detects (i.e., values below the limit of detection (LOD)), as well as longitudinal exposure data that include non-detects and time-dependent covariates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-29 21:24:43 UTC; okv0</td>
</tr>
<tr>
<td>Author:</td>
<td>I-Chen Chen <a href="https://orcid.org/0000-0001-6764-8395"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre,
    aut],
  Philip Westgate [ctb],
  Liya Fu [ctb]</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-29 21:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Fillin'>Fill-in or Substitution Methods</h2><span id='topic+Fillin'></span>

<h3>Description</h3>

<p>Uses substitution methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Fillin(y, lod, substitue)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Fillin_+3A_y">y</code></td>
<td>
<p>A list of numeric values or a vector of the observed values.</p>
</td></tr>
<tr><td><code id="Fillin_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Fillin_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Single value imputation techniques, such as LOD/2 or LOD/<code class="reqn">\sqrt2</code> (&quot;LOD2&quot; or &quot;LODS2&quot;) (Hornung and Reed, 1990; Burstyn and Teschke, 1999), and <code class="reqn">\beta</code>-substitution method (&quot;BetaMean&quot; and &quot;BetaGM&quot;) (Ganser and Hewett, 2010), are used to assign a value to a range between 0 and the LOD. &quot;QQplot&quot; represents the multiple order value imputation technique that depicts the natural logarithm of the uncensored or detected observed values versus the Z-scores and fits a linear regression presented in a quantile-quantile (QQ) plot (Pleil, 2016).</p>


<h3>Value</h3>

<p>A list of numeric values or a vector with imputed values that are assigned to non-detects.</p>


<h3>Author(s)</h3>

<p>I-Chen Chen</p>


<h3>References</h3>

<p>Burstyn, I., Teschke, K. (1999). Studying the determinants of exposure: a review of methods. <em>American Industrial Hygiene Association Journal</em>, 60, 57&ndash;72.
</p>
<p>Ganser, G. H., Hewett, P. (2010). An accurate substitution method for analyzing censored data. <em>Journal of Occupational and Environmental Hygiene</em>, 7, 233&ndash;44.
</p>
<p>Hornung, R. W., Reed, L. D. (1990). Estimation of average concentration in the presence of nondetectable values. <em>Applied Occupational and Environmental Hygiene</em>, 5, 46&ndash;51.
</p>
<p>Pleil, J. D. (2016). QQ-plots for assessing distributions of biomarker measurements and generating defensible summary statistics. <em>Journal of Breath Research</em>, 10, 035001.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses an example from Ganser and Hewett (2010).
library(marlod)

y &lt;- c(0,0,0,3.06,4.41,7.23,8.29,9.52,19.94,20.25) #LOD=3
lod &lt;- 3

Fillin(y, lod, "None")

Fillin(y, lod, "LOD")

Fillin(y, lod, "LOD2")

Fillin(y, lod, "LODS2")

Fillin(y, lod, "BetaMean")

Fillin(y, lod, "BetaGM")

Fillin(y, lod, "QQplot")
</code></pre>

<hr>
<h2 id='MGEE'>Function of a Generalized Estimating Equation (GEE) Model</h2><span id='topic+MGEE'></span>

<h3>Description</h3>

<p>The function is used to calculate a empirical MSE minimization criterion (EMMC) value in the &quot;Selected.GEE&quot; function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MGEE(id, y, x, lod, substitue, corstr, typetd, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MGEE_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="MGEE_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_typetd">typetd</code></td>
<td>
<p>An atomic vector specifying the types of time-dependent covaraites. The length of this vector is the number of regression paramenters, including the intercept. &quot;1&quot; is assigned to any time-indepednet covariates or covariates in a cluster study.</p>
</td></tr>
<tr><td><code id="MGEE_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;MGEE&quot;.</p>

<hr>
<h2 id='Modified.GEE'>Function of a Generalized Estimating Equation (GEE) Model</h2><span id='topic+Modified.GEE'></span>

<h3>Description</h3>

<p>Runs a marginal mean regression model using generalized estimating equation (GEE) estimation method for repeated measures data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Modified.GEE(id, y, x, lod, substitue, corstr, typetd, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Modified.GEE_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_typetd">typetd</code></td>
<td>
<p>An atomic vector specifies the types of time-dependent covaraites, with the length of the vector equal to the number of regression parameters, excluding the intercept. For time-independent covariates or those in a cluster study, &quot;1&quot; is assigned.</p>
</td></tr>
<tr><td><code id="Modified.GEE_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function modifies the supplementary R function for GEE in Westgate (2014a), in whcih small-sample standard error corrections are applied (Kauermann and Carroll, 2001; Mancl and DeRouen, 2001; Westgate, 2013). More discussions about the use of covariance corrections can be found in Westgate (2016), and Ford and Westgate (2017, 2018). With the marginal modeling, Chen <em>et al.</em> (2024) incorporate the fill-in methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD) are assigned values. This function also presents the results of the &quot;trace of the empirical covariance matrix&quot; (TECM) (Westgate, 2014b) and the &quot;correlation information criterion&quot; (CIC) (Hin and Wang, 2009). Both criteria have been shown to be preferable to other criteria in choosing an analysis method and corresponding structure (Westgate, 2014a).
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available fill-in or substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata15&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata15&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Modified.GEE&quot; representing the fit.</p>


<h3>Note</h3>

<p>The function is capable of analyzing one measurement or more than one repeated measurements per subject. Unbalanced repeated measurements are also permittable.</p>


<h3>Author(s)</h3>

<p>Philip M. Westgate and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Estill, C. F. (2024). Compare the Marginal Effects for Environmental Exposure and Biomonitoring Data with Repeated Measurements and Values Below the Limit of Detection. <em>Journal of Exposure Science and Environmental Epidemiology</em>. <a href="https://doi.org/10.1038/s41370-024-00640-7">doi:10.1038/s41370-024-00640-7</a>
</p>
<p>Ford, W. P., Westgate, P. M. (2017). Improved standard error estimator for maintaining the validity of inference in cluster randomized trials with a small number of clusters. <em>Biometrical Journal</em>, 59, 478&ndash;95.
</p>
<p>Ford, W. P., Westgate, P. M. (2018). A comparison of bias-corrected empirical covariance
estimators with generalized estimating equations in small-sample longitudinal study settings. <em>Statistics in Medicine</em>, 37, 4318&ndash;29.
</p>
<p>Hin, L. Y., Wang, Y.-G. (2009). Working-correlation-structure identification in generalized estimating equations. <em>Statistics in Medicine</em>, 28, 642&ndash;658.
</p>
<p>Kauermann, G., Carroll, R. J. (2001). A note on the efficiency of sandwich covariance matrix
estimation. <em>Journal of the American Statistical Association</em>, 96, 1387&ndash;96.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>
<p>Mancl, L. A., DeRouen, T. A. (2001). A covariance estimator for GEE with improved small-sample properties. <em>Biometrics</em>, 57, 126&ndash;134.
</p>
<p>Westgate, P. M. (2013). A bias correction for covariance estimators to improve inference with generalized estimating equations that use an unstructured correlation matrix. <em>Statistics in Medicine</em>, 32, 2850&ndash;2858.
</p>
<p>Westgate, P. M. (2014a). Criterion for the simultaneous selection of a working correlation structure and either generalized estimating equations or the quadratic inference function approach. <em>Biometrical Journal</em>, 56, 461&ndash;476.
</p>
<p>Westgate, P. M. (2014b). Improving the correlation structure selection approach for generalized estimating equations and balanced longitudinal data. <em>Statistics in Medicine</em>, 33, 2222&ndash;2237.
</p>
<p>Westgate, P. M. (2016). A covariance correction that accounts for correlation estimation to improve finite-sample inference with generalized estimating equations: a study on its applicability with structured correlation matrices. <em>Journal of Statistical Computation and Simulation</em>, 86, 1891&ndash;1900.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Selected.GEE">Selected.GEE</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata15 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)

data(simdata15)

id=as.matrix(as.vector(t(simdata15$id)))
y=as.matrix(as.vector(t(simdata15$y)))
x1=as.matrix(as.vector(t(simdata15$x1)))
x2=as.matrix(as.vector(t(simdata15$x2)))
x=cbind(x1,x2)

## LOD=2 is equivalent to detection proportion=56.3% (censoring proportion=43.7%).
lod=2

## Intercept is not included in the "x"
Modified.GEE(id, y, x, lod, "None", "exchangeable", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "LOD", "AR-1", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "LOD2", "exchangeable", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "LODS2", "AR-1", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "BetaMean", "exchangeable", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "BetaGM", "AR-1", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "MIWithID", "exchangeable", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "MIWithIDRM", "AR-1", c(1,1), 1000)

Modified.GEE(id, y, x, lod, "QQplot", "exchangeable", c(1,1), 1000)
</code></pre>

<hr>
<h2 id='Modified.GMM'>Function of a Generalized Method of Moments Model</h2><span id='topic+Modified.GMM'></span>

<h3>Description</h3>

<p>Runs a marginal mean regression model using generalized method of moments (GMM) estimation method for repeated measures data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Modified.GMM(id, y, x, lod, substitue, beta, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Modified.GMM_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_beta">beta</code></td>
<td>
<p>A matrix of initial parameter estimates, e.g., these estimates could be from general linear model or generalized estimating equation (GEE) using independence working structure.</p>
</td></tr>
<tr><td><code id="Modified.GMM_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The modified GMM approach was originally proposed by Chen and Westgate (2017), in whcih a linear shrinkage method of Han and Song (2011) was incorporated to resolve potential singularity problems. The method should be utilized when the Mooreâ€“Penrose generalized inverse fails to solve the weighting matrix. Small-sample standard error corrections were also applied to the modified GMM (Mancl and DeRouen, 2001; Westgate, 2012). With the marginal modeling, Chen <em>et al.</em> (2024) incorporate the fill-in methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD) are assigned values. This function also presents the results of the &quot;trace of the empirical covariance matrix&quot; (TECM) (Westgate, 2014a) and the &quot;correlation information criterion&quot; (CIC) (Hin and Wang, 2009). Both criteria have been shown to be preferable to other criteria in choosing an analysis method and corresponding structure (Westgate, 2014b).
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available fill-in or substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata15&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata15&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Modified.GMM&quot; representing the fit.</p>


<h3>Author(s)</h3>

<p>I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Estill, C. F. (2024). Compare the Marginal Effects for Environmental Exposure and Biomonitoring Data with Repeated Measurements and Values Below the Limit of Detection. <em>Journal of Exposure Science and Environmental Epidemiology</em>. <a href="https://doi.org/10.1038/s41370-024-00640-7">doi:10.1038/s41370-024-00640-7</a>
</p>
<p>Chen, I-C., Westgate, P. M. (2017). Improved methods for the marginal analysis of longitudinal data in the presence of timedependent covariates. <em>Statistics in Medicine</em>, 36, 2533&ndash;2546.
</p>
<p>Han, P., Song, P. X. K. (2011). A note on improving quadratic inference functions using a linear shrinkage approach. <em>Statistics and Probability Letters</em>, 81, 438&ndash;445.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>
<p>Mancl, L. A., DeRouen, T. A. (2001). A covariance estimator for GEE with improved small-sample properties. <em>Biometrics</em>, 57, 126&ndash;134.
</p>
<p>Westgate, P. M. (2012). A bias-corrected covariance estimate for improved inference with quadratic inference functions. <em>Statistics in Medicine</em>, 31, 4003&ndash;4022.
</p>
<p>Westgate, P. M. (2014a). Improving the correlation structure selection approach for generalized estimating equations and balanced longitudinal data. <em>Statistics in Medicine</em>, 33, 2222&ndash;2237.
</p>
<p>Westgate, P. M. (2014b). Criterion for the simultaneous selection of a working correlation structure and either generalized estimating equations or the quadratic inference function approach. <em>Biometrical Journal</em>, 56, 461&ndash;476.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata15 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)

data(simdata15)

id=as.matrix(as.vector(t(simdata15$id)))
y=as.matrix(as.vector(t(simdata15$y)))
x1=as.matrix(as.vector(t(simdata15$x1)))
x2=as.matrix(as.vector(t(simdata15$x2)))
x=cbind(x1,x2)

## LOD=2 is equivalent to detection proportion=56.3% (censoring proportion=43.7%).
lod=2

## Gets initial estimates for the GMM approach through independence structure
initial=glm(y ~ x1 + x2, data=simdata15, family=gaussian)
beta_initial=as.matrix(initial$coefficients)

## Intercept is not included in the "x"
Modified.GMM(id, y, x, lod, "None", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "LOD", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "LOD2", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "LODS2", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "BetaMean", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "BetaGM", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "MIWithID", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "MIWithIDRM", beta_initial, 1000)

Modified.GMM(id, y, x, lod, "QQplot", beta_initial, 1000)
</code></pre>

<hr>
<h2 id='Modified.QIF'>Function of a Quadratic Inference Function (QIF) Model</h2><span id='topic+Modified.QIF'></span>

<h3>Description</h3>

<p>Runs a marginal mean regression model using quadratic inference function (QIF) estimation method for repeated measures data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Modified.QIF(id, y, x, lod, substitue, corstr, beta, typetd, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Modified.QIF_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_beta">beta</code></td>
<td>
<p>A matrix of initial parameter estimates, e.g., these estimates could be from general linear model or generalized estimating equation (GEE) using independence working structure.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_typetd">typetd</code></td>
<td>
<p>An atomic vector specifies the types of time-dependent covaraites, with the length of the vector equal to the number of regression parameters, excluding the intercept. For time-independent covariates or those in a cluster study, &quot;1&quot; is assigned.</p>
</td></tr>
<tr><td><code id="Modified.QIF_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function modifies the supplementary R function for GEE in Westgate (2014a), in whcih small-sample standard error corrections are applied (Kauermann and Carroll, 2001; Mancl and DeRouen, 2001; Westgate and Braun, 2012; Westgate, 2012, 2014b). With the marginal modeling, Chen <em>et al.</em> (2024) incorporate the fill-in methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD) are assigned values. This function also presents the results of the &quot;trace of the empirical covariance matrix&quot; (TECM) (Westgate, 2014c) and the &quot;correlation information criterion&quot; (CIC) (Hin and Wang, 2009). Both criteria have been shown to be preferable to other criteria in choosing an analysis method and corresponding structure (Westgate, 2014a).
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available fill-in or substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata15&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata15&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Modified.QIF&quot; representing the fit.</p>


<h3>Note</h3>

<p>The function is capable of analyzing one measurement or more than one repeated measurements per subject. Unbalanced repeated measurements are also permittable.</p>


<h3>Author(s)</h3>

<p>Philip M. Westgate and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Estill, C. F. (2024). Compare the Marginal Effects for Environmental Exposure and Biomonitoring Data with Repeated Measurements and Values Below the Limit of Detection. <em>Journal of Exposure Science and Environmental Epidemiology</em>. <a href="https://doi.org/10.1038/s41370-024-00640-7">doi:10.1038/s41370-024-00640-7</a>
</p>
<p>Kauermann, G., Carroll, R. J. (2001). A note on the efficiency of sandwich covariance matrix
estimation. <em>Journal of the American Statistical Association</em>, 96, 1387&ndash;96.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>
<p>Mancl, L. A., DeRouen, T. A. (2001). A covariance estimator for GEE with improved small-sample properties. <em>Biometrics</em>, 57, 126&ndash;134.
</p>
<p>Westgate, P. M., Braun, T. M. (2012). The effect of cluster size imbalance and covariates on the estimation performance of quadratic inference functions. <em>Statistics in Medicine</em>, 31, 2209&ndash;2222.
</p>
<p>Westgate, P. M. (2012). A bias-corrected covariance estimate for improved inference with quadratic inference functions. <em>Statistics in Medicine</em>, 31, 4003&ndash;4022.
</p>
<p>Westgate, P. M. (2014a). Criterion for the simultaneous selection of a working correlation structure and either generalized estimating equations or the quadratic inference function approach. <em>Biometrical Journal</em>, 56, 461&ndash;476.
</p>
<p>Westgate, P. M. (2014b). A comparison of utilized and theoretical covariance weighting matrices on the estimation performance of quadratic inference functions. <em>Communications in Statistics &ndash; Simulation and Computation</em>, 43, 2432&ndash;2443.
</p>
<p>Westgate, P. M. (2014c). Improving the correlation structure selection approach for generalized estimating equations and balanced longitudinal data. <em>Statistics in Medicine</em>, 33, 2222&ndash;2237.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Selected.QIF">Selected.QIF</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata15 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)

data(simdata15)

id=as.matrix(as.vector(t(simdata15$id)))
y=as.matrix(as.vector(t(simdata15$y)))
x1=as.matrix(as.vector(t(simdata15$x1)))
x2=as.matrix(as.vector(t(simdata15$x2)))
x=cbind(x1,x2)

## LOD=2 is equivalent to detection proportion=56.3% (censoring proportion=43.7%).
lod=2

## Gets initial estimates for the QIF approach through independence structure
initial=glm(y ~ x1 + x2, data=simdata15, family=gaussian)
beta_initial=as.matrix(initial$coefficients)

## Intercept is not included in the "x"
Modified.QIF(id, y, x, lod, "None", "exchangeable", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "LOD", "AR-1", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "LOD2", "exchangeable", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "LODS2", "AR-1", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "BetaMean", "exchangeable", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "BetaGM", "AR-1", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "MIWithID", "exchangeable", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "MIWithIDRM", "AR-1", beta_initial, c(1,1), 1000)

Modified.QIF(id, y, x, lod, "QQplot", "exchangeable", beta_initial, c(1,1), 1000)
</code></pre>

<hr>
<h2 id='MQIF'>Function of a Quadratic Inference Function (QIF) Model</h2><span id='topic+MQIF'></span>

<h3>Description</h3>

<p>The function is used to calculate a empirical MSE minimization criterion (EMMC) value in the &quot;Selected.QIF&quot; function.</p>


<h3>Usage</h3>

<pre><code class='language-R'>MQIF(id, y, x, lod, substitue, corstr, beta, typetd, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MQIF_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="MQIF_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_beta">beta</code></td>
<td>
<p>A matrix of initial parameter estimates, e.g., these estimates could be from general linear model or generalized estimating equation (GEE) using independence working structure.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_typetd">typetd</code></td>
<td>
<p>An atomic vector specifying the types of time-dependent covaraites. The length of this vector is the number of regression paramenters, including the intercept. &quot;1&quot; is assigned to any time-indepednet covariates or covariates in a cluster study.</p>
</td></tr>
<tr><td><code id="MQIF_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;MQIF&quot;.</p>

<hr>
<h2 id='Quantile.FWZ'>Function of a Quantile Regression Model</h2><span id='topic+Quantile.FWZ'></span>

<h3>Description</h3>

<p>Runs a marginal quantile regression model for repeated measures data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quantile.FWZ(y, x, lod, substitue, tau, corstr, typetd, data)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Quantile.FWZ_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_tau">tau</code></td>
<td>
<p>A numeric value of quantile level, e.g., tau=0.25 for 25th quantile and tau=0.5 for median.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_typetd">typetd</code></td>
<td>
<p>An atomic vector specifies the types of time-dependent covaraites, with the length of the vector equal to the number of regression parameters, excluding the intercept. For time-independent covariates or those in a cluster study, &quot;1&quot; is assigned.</p>
</td></tr>
<tr><td><code id="Quantile.FWZ_+3A_data">data</code></td>
<td>
<p>A data frame that originazes the given data into two-dimensional structure of rows and columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function modifies the R functions provided by Dr. Liya Fu and based on the manuscript of Fu <em>et al.</em> (2015). Chen <em>et al.</em> (2021) further applied the Gaussian pseudolikelihood approach for quantile regression to environmental exposure and biomonitoring repeated measures data with values less than the limit of detection (LOD). Fill-in or substitution methods, including single and multiple value imputation techniques, were used to assign values for non-detects.
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata15&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata15&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Quantile.FWZ&quot; representing the fit.</p>


<h3>Author(s)</h3>

<p>Liya Fu and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Curwin, B. D. (2021). Quantile regression for exposure data with repeated measures in the presence of non-detects. <em>Journal of Exposure Science and Environmental Epidemiology</em>, 31, 1057&ndash;1066.
</p>
<p>Fu, L., Wang, Y.-G., Zhu, M. (2015). A Gaussian pseudolikelihood approach for quantile regression with repeated measurements. <em>Computational Statistics and Data Analysis</em>, 84, 41&ndash;53.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Quantile.select.FWZ">Quantile.select.FWZ</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata15 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)
library(quantreg)

data(simdata15)

y=as.matrix(as.vector(t(simdata15$y)))
x1=as.matrix(as.vector(t(simdata15$x1)))
x2=as.matrix(as.vector(t(simdata15$x2)))
x=cbind(matrix(1,length(x1),1),x1,x2)

## LOD=2 is equivalent to detection proportion=50% (censoring proportion=50%).
lod=2

## Median or 50th quantile is given.
tau=0.5

## Examples to perform the function
Quantile.FWZ(y, x, lod, "BetaGM", tau, "AR-1", c(1,1), simdata15)

Quantile.FWZ(y, x, lod, "QQplot", tau, "exchangeable", c(1,1), simdata15)

Quantile.FWZ(y, x, lod, "MIWithID", tau, "exchangeable", c(1,1), simdata15)
</code></pre>

<hr>
<h2 id='Quantile.select.FWZ'>Function to Select a Type of Time-Dependent Covaraite Through a Quantile Regression Model</h2><span id='topic+Quantile.select.FWZ'></span>

<h3>Description</h3>

<p>Selects a type of time-dependent covaraite through a marginal quantile regression model for longitudinal exposure data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Quantile.select.FWZ(y, x, lod, substitue, tau, data)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Quantile.select.FWZ_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Quantile.select.FWZ_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Quantile.select.FWZ_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Quantile.select.FWZ_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Quantile.select.FWZ_+3A_tau">tau</code></td>
<td>
<p>A numeric value of quantile level, e.g., tau=0.25 for 25th quantile and tau=0.5 for median.</p>
</td></tr>
<tr><td><code id="Quantile.select.FWZ_+3A_data">data</code></td>
<td>
<p>A data frame that originazes the given data into two-dimensional structure of rows and columns.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function modifies the R functions provided by Dr. Liya Fu and based on the manuscript of Fu <em>et al.</em> (2015). Chen <em>et al.</em> (2024) further applied the Gaussian pseudolikelihood approach for quantile regression to environmental exposure and biomonitoring longitudinal data with values less than the limit of detection (LOD) and time-dependent covaraites. The work to select a working type of time-dependent covaraite is based on the manuscript of Chen and Westgate (2021).
</p>
<p>Fill-in or substitution methods, including single and multiple value imputation techniques, were used to assign values for non-detects. See the Details of the &quot;Fillin&quot; function for introduction of the available substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata58&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata58&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Quantile.select.FWZ&quot; representing the fit.</p>


<h3>Author(s)</h3>

<p>Liya Fu and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Dahm, M. M. (2024). Quantile regression for longitudinal data with values below the limit of detection and time-dependent covariates &ndash; application to modeling carbon nanotube and nanofiber exposures. <em>Annals of Work Exposures and Health</em>. <a href="https://doi.org/10.1093/annweh/wxae068">doi:10.1093/annweh/wxae068</a>
</p>
<p>Chen, I-C., Westgate, P. M. (2021). Marginal quantile regression for longitudinal data analysis in the presence of time-dependent covariates. <em>The International Journal of Biostatistics</em>, 17, 267&ndash;282.
</p>
<p>Fu, L., Wang, Y.-G., Zhu, M. (2015). A Gaussian pseudolikelihood approach for quantile regression with repeated measurements. <em>Computational Statistics and Data Analysis</em>, 84, 41&ndash;53.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Quantile.FWZ">Quantile.FWZ</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata58 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)
library(quantreg)

data(simdata58)

y=as.matrix(as.vector(t(simdata58$y)))
x1=as.matrix(as.vector(t(simdata58$x1)))
x=cbind(matrix(1,length(x1),1),x1)

## LOD=0.5 is equivalent to detection proportion=50.7% (censoring proportion=49.3%).
lod=0.5

## Median or 50th quantile is given.
tau=0.5

## Examples to perform the function
Quantile.select.FWZ(y, x, lod, "BetaMean", tau, simdata58)

Quantile.select.FWZ(y, x, lod, "QQplot", tau, simdata58)

Quantile.select.FWZ(y, x, lod, "MIWithID", tau, simdata58)
</code></pre>

<hr>
<h2 id='Selected.GEE'>Function to Select a Type of Time-Dependent Covaraite Through a Generalized Estimating Equation Model</h2><span id='topic+Selected.GEE'></span>

<h3>Description</h3>

<p>Selects a type of time-dependent covaraite through a marginal mean regression model using generalized estimating equation (GEE) estimation method for longitudinal exposure data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Selected.GEE(id, y, x, lod, substitue, corstr, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Selected.GEE_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="Selected.GEE_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function modifies the supplementary R function for GEE in Westgate (2014). With the marginal modeling, Chen <em>et al.</em> (2024) incorporate the fill-in methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD) are assigned values. Based on the manuscripts of Chen and Westgate (2017, 2019), this function also enable to use a empirical MSE minimization criterion (EMMC) to select a working type of time-dependent covaraite.
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available fill-in or substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata58&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata58&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Selected.GEE&quot; representing the fit.</p>


<h3>Note</h3>

<p>The function is capable of analyzing one measurement or more than one repeated measurements per subject. Unbalanced repeated measurements are also permittable.</p>


<h3>Author(s)</h3>

<p>Philip M. Westgate and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Estill, C. F. (2024). Compare the Marginal Effects for Environmental Exposure and Biomonitoring Data with Repeated Measurements and Values Below the Limit of Detection. <em>Journal of Exposure Science and Environmental Epidemiology</em>. <a href="https://doi.org/10.1038/s41370-024-00640-7">doi:10.1038/s41370-024-00640-7</a>
</p>
<p>Chen, I-C., Westgate, P. M. (2017). Improved methods for the marginal analysis of longitudinal data in the presence of time-dependent
covariates. <em>Statistics in Medicine</em>, 36, 2533&ndash;46.
</p>
<p>Chen, I-C., Westgate, P. M. (2019). A novel approach to selecting classification types for time-dependent covariates in the marginal
analysis of longitudinal data. <em>Statistical Methods in Medical Research</em>, 28, 3176&ndash;86.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>
<p>Westgate, P. M. (2014). Criterion for the simultaneous selection of a working correlation structure and either generalized estimating equations or the quadratic inference function approach. <em>Biometrical Journal</em>, 56, 461&ndash;476.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Modified.GEE">Modified.GEE</a></code>, <code><a href="#topic+MGEE">MGEE</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata58 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)

data(simdata58)

id=as.matrix(as.vector(t(simdata58$id)))
y=as.matrix(as.vector(t(simdata58$y)))
x1=as.matrix(as.vector(t(simdata58$x1)))

## LOD=0.5 is equivalent to detection proportion=50.7% (censoring proportion=49.3%).
lod=0.5

## Intercept is not included in the "x1"
Selected.GEE(id, y, x1, lod, "None", "exchangeable", 1000)

Selected.GEE(id, y, x1, lod, "LOD", "AR-1", 1000)

Selected.GEE(id, y, x1, lod, "LOD2", "exchangeable", 1000)

Selected.GEE(id, y, x1, lod, "LODS2", "AR-1", 1000)

Selected.GEE(id, y, x1, lod, "BetaMean", "exchangeable", 1000)

Selected.GEE(id, y, x1, lod, "BetaGM", "AR-1", 1000)

Selected.GEE(id, y, x1, lod, "MIWithID", "exchangeable", 1000)

Selected.GEE(id, y, x1, lod, "MIWithIDRM", "AR-1", 1000)

Selected.GEE(id, y, x1, lod, "QQplot", "exchangeable", 1000)
</code></pre>

<hr>
<h2 id='Selected.QIF'>Function to Select a Type of Time-Dependent Covaraite Through a Quadratic Inference Function Model</h2><span id='topic+Selected.QIF'></span>

<h3>Description</h3>

<p>Selects a type of time-dependent covaraite through a marginal quantile regression model using quadratic inference function (QIF) estimation method for longitudinal exposure data with values less than the limit of detection (LOD).</p>


<h3>Usage</h3>

<pre><code class='language-R'>Selected.QIF(id, y, x, lod, substitue, corstr, beta, maxiter)</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Selected.QIF_+3A_id">id</code></td>
<td>
<p>A column matrix of subject IDs. The number of rows is the total number of observations. Data must be sorted by IDs.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_y">y</code></td>
<td>
<p>A column matrix of the observed outcome values or responses.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_x">x</code></td>
<td>
<p>A matrix of covariate values, for which the number of columns is the number of covariates.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_lod">lod</code></td>
<td>
<p>A numeric value of limit of detection (LOD).</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_substitue">substitue</code></td>
<td>
<p>A character string specifying the substitution approach, including &quot;None&quot;, &quot;LOD&quot;, &quot;LOD2&quot;, &quot;LODS2&quot;, &quot;BetaMean&quot;, &quot;BetaGM&quot;, &quot;MIWithID&quot;, &quot;MIWithIDRM&quot;, and &quot;QQplot&quot;.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_corstr">corstr</code></td>
<td>
<p>A character string specifying the working correlation structure, given by either &quot;exchangeable&quot; or &quot;AR-1&quot;.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_beta">beta</code></td>
<td>
<p>A matrix of initial parameter estimates, e.g., these estimates could be from general linear model or generalized estimating equation (GEE) using independence working structure.</p>
</td></tr>
<tr><td><code id="Selected.QIF_+3A_maxiter">maxiter</code></td>
<td>
<p>The maximum number of iterations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function modifies the supplementary R function for QIF in Westgate (2014). With the marginal modeling, Chen <em>et al.</em> (2024) incorporate the fill-in methods, including single and multiple value imputation techniques, such that any measurements less than the limit of detection (LOD) are assigned values. Based on the manuscripts of Chen and Westgate (2017, 2019), this function also enable to use a empirical MSE minimization criterion (EMMC) to select a working type of time-dependent covaraite.
</p>
<p>See the Details of the &quot;Fillin&quot; function for introduction of the available fill-in or substitution methods. For a multiple random value imputation technique, it provides an alternative for environmental exposure and biomonitoring data with non-detects, in which the imputed values can be generated using a regression of an exposure measurement on covariate(s) (&quot;MIWithID&quot; and &quot;MIWithIDRM&quot;) (Lubin <em>et al.</em>, 2004). Information of identification (ID) would be included in &quot;MIWithID&quot; as the covariate, e.g., &quot;id in &quot;simdata58&quot;, while ID and order of cluster size or time points would be treated as the covariates in &quot;MIWithIDRM&quot;, e.g. &quot;id&quot; and &quot;visit&quot; in &quot;simdata58&quot;.</p>


<h3>Value</h3>

<p>An object of class &quot;Selected.QIF&quot; representing the fit.</p>


<h3>Note</h3>

<p>The function is capable of analyzing one measurement or more than one repeated measurements per subject. Unbalanced repeated measurements are also permittable.</p>


<h3>Author(s)</h3>

<p>Philip M. Westgate and I-Chen Chen</p>


<h3>References</h3>

<p>Chen, I-C., Bertke, S. J., Estill, C. F. (2024). Compare the Marginal Effects for Environmental Exposure and Biomonitoring Data with Repeated Measurements and Values Below the Limit of Detection. <em>Journal of Exposure Science and Environmental Epidemiology</em>. <a href="https://doi.org/10.1038/s41370-024-00640-7">doi:10.1038/s41370-024-00640-7</a>
</p>
<p>Chen, I-C., Westgate, P. M. (2017). Improved methods for the marginal analysis of longitudinal data in the presence of time-dependent
covariates. <em>Statistics in Medicine</em>, 36, 2533&ndash;46.
</p>
<p>Chen, I-C., Westgate, P. M. (2019). A novel approach to selecting classification types for time-dependent covariates in the marginal
analysis of longitudinal data. <em>Statistical Methods in Medical Research</em>, 28, 3176&ndash;86.
</p>
<p>Lubin, J. H., Colt, J. S., Camann, D., <em>et al.</em> (2004). Epidemiologic evaluation of measurement data in the presence of detection limits. <em>Environmental Health Perspectives</em>, 112, 1691&ndash;6.
</p>
<p>Westgate, P. M. (2014). Criterion for the simultaneous selection of a working correlation structure and either generalized estimating equations or the quadratic inference function approach. <em>Biometrical Journal</em>, 56, 461&ndash;476.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Modified.QIF">Modified.QIF</a></code>, <code><a href="#topic+MQIF">MQIF</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Uses the simdata58 to run the marginal models.
library(marlod)
library(MASS)
library(miWQS)

data(simdata58)

id=as.matrix(as.vector(t(simdata58$id)))
y=as.matrix(as.vector(t(simdata58$y)))
x1=as.matrix(as.vector(t(simdata58$x1)))

## LOD=0.5 is equivalent to detection proportion=50.7% (censoring proportion=49.3%).
lod=0.5

## Gets initial estimates for the QIF approach through independence structure
initial=glm(y ~ x1, data=simdata58, family=gaussian)
beta_initial=as.matrix(initial$coefficients)

## Intercept is not included in the "x1"
Selected.QIF(id, y, x1, lod, "None", "exchangeable", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "LOD", "AR-1", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "LOD2", "exchangeable", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "LODS2", "AR-1", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "BetaMean", "exchangeable", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "BetaGM", "AR-1", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "MIWithID", "exchangeable", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "MIWithIDRM", "AR-1", beta_initial, 1000)

Selected.QIF(id, y, x1, lod, "QQplot", "exchangeable", beta_initial, 1000)
</code></pre>

<hr>
<h2 id='simdata15'>Simulated Dataset 15</h2><span id='topic+simdata15'></span>

<h3>Description</h3>

<p>The 15th dataset from the simulation study has 100 subjects (sample size is 30). Each subject has three repeated measurements. The independent variables or covariates are simulated from a Bernoulli distribution with a parameter value of <code class="reqn">p</code> = 0.5 and a uniform distribution <code class="reqn">U</code>(0, 1), respectively. Correlated errors for models with repeated measures are accounted for and assumed to follow a multivariate normal distribution, <code class="reqn">MVN</code>(0, <code class="reqn">R(\alpha</code>)). A first-order autoregressive (AR-1) correlation structure with a correlation parameter of <code class="reqn">\alpha</code> = 0.7 is incorporated into the multivariate normal distribution. The true values of 1, 1, and 1 are corresponded to the marginal intercept and two slopes, accordingly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simdata15")</code></pre>


<h3>Format</h3>

<p>A data frame with 30 subjects and each subject has three repeated measurements, i.e., number of cluster size or time points. A list that contains two variables:
</p>

<dl>
<dt><code>y</code></dt><dd><p>A column matrix of the continuous outcome values.</p>
</dd>
<dt><code>int</code></dt><dd><p>A column matrix of the intercept values of one.</p>
</dd>
<dt><code>x1</code></dt><dd><p>A column matrix of the binary covariate values that follow a Bernoulli distribution.</p>
</dd>
<dt><code>x2</code></dt><dd><p>A column matrix of the continuous covariate values that follow a uniform distribution.</p>
</dd>
<dt><code>id</code></dt><dd><p>A column matrix of the numbers of identification.</p>
</dd>
<dt><code>visit</code></dt><dd><p>A column matrix of the order of cluster size or time points.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>library(marlod)
data(simdata15)
</code></pre>

<hr>
<h2 id='simdata58'>Simulated Dataset 58</h2><span id='topic+simdata58'></span>

<h3>Description</h3>

<p>The 58th dataset from the simulation study has 100 subjects (sample size is 100). Each subject has three repeated measurements. Detailed model mechanism can be found in the setting II for type III time-dependent covariate on page 90 of Lai and Small (2007). The two random effects in the mechanism are mutually independent and normally distributed with mean 0 and variances 1. The true values of 0 and 0.69 are corresponded to the marginal intercept and slope, accordingly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("simdata58")</code></pre>


<h3>Format</h3>

<p>A data frame with 100 subjects and each subject has three repeated measurements, i.e., number of cluster size or time points. A list that contains one variable:
</p>

<dl>
<dt><code>y</code></dt><dd><p>A column matrix of the continuous outcome values.</p>
</dd>
<dt><code>int</code></dt><dd><p>A column matrix of the intercept values of one.</p>
</dd>
<dt><code>x1</code></dt><dd><p>A column matrix of the continuous covariate values.</p>
</dd>
<dt><code>id</code></dt><dd><p>A column matrix of the numbers of identification.</p>
</dd>
<dt><code>visit</code></dt><dd><p>A column matrix of the order of cluster size or time points.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lai, T.L., Small, D. (2007). Marginal regression analysis of longitudinal data with time-dependent covariates: a generalized method-of-moments approach. <em>Journal of the Royal Statistical Society: Series B</em>, 69, 79&ndash;99.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(marlod)
data(simdata58)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
