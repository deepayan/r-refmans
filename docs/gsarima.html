<!DOCTYPE html><html><head><title>Help for package gsarima</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gsarima}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gsarima-package'>
<p>Two Functions for Generalized SARIMA Time Series Simulation</p></a></li>
<li><a href='#arrep'><p> Compute the Autoregressive Representation of a SARIMA Model</p></a></li>
<li><a href='#garsim'><p> Simulate a Generalized Autoregressive Time Series</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1-5</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-09-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Two Functions for Generalized SARIMA Time Series Simulation</td>
</tr>
<tr>
<td>Author:</td>
<td>Olivier Briet &lt;o.briet@gmail.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Olivier Briet &lt;o.briet@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Write SARIMA models in (finite) AR representation and simulate 
	generalized multiplicative seasonal autoregressive moving average (time) series 
	with Normal / Gaussian, Poisson or negative binomial distribution. 
	The methodology of this method is described in Briet OJT, Amerasinghe PH, and 
	Vounatsou P (2013) &lt;<a href="https://doi.org/10.1371%2Fjournal.pone.0065761">doi:10.1371/journal.pone.0065761</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-03 08:56:24 UTC; Briet</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-03 22:22:27 UTC</td>
</tr>
</table>
<hr>
<h2 id='gsarima-package'>
Two Functions for Generalized SARIMA Time Series Simulation
</h2><span id='topic+gsarima-package'></span><span id='topic+gsarima'></span>

<h3>Description</h3>

<p>Write SARIMA models in (finite) AR representation and simulate generalized multiplicative seasonal autoregressive moving average (time) series The methodology of this method is described in Briet OJT, Amerasinghe PH, and Vounatsou P (2013) &lt;doi:10.1371/journal.pone.0065761&gt;.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gsarima</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1-5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2020-09-03</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Use arrep() for converting the SARIMA function into AR representation, and use garsim() to simulate.
</p>


<h3>Author(s)</h3>

<p>Olivier Briet &lt;o.briet@gmail.com&gt;
</p>
<p>Maintainer: Olivier Briet &lt;o.briet@gmail.com&gt;
</p>


<h3>References</h3>

<p>Briet OJT, Amerasinghe PH, Vounatsou P: Generalized seasonal autoregressive integrated moving average
models for count data with application to malaria time series with low case numbers.
PLoS ONE, 2013, 8(6): e65761. doi:10.1371/journal.pone.0065761  <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761</a> If you use the gsarima package, please cite the above reference.
</p>
<p>Brandt PT, Williams JT: A linear Poisson autoregressive model: The PAR(p). Political Analysis 2001, 9.
</p>
<p>Benjamin MA, Rigby RA, Stasinopoulos DM: Generalized Autoregressive Moving Average Models. Journal of the American Statistical Association 2003, 98:214-223.
</p>
<p>Zeger SL, Qaqish B: Markov regression models for time series: a quasi-likelihood approach. Biometrics 1988, 44:1019-1031
</p>
<p>Grunwald G, Hyndman R, Tedesco L, Tweedie R: Non-Gaussian conditional linear AR(1) models. Australian &amp; New Zealand Journal of Statistics 2000, 42:479-495. 
</p>

<hr>
<h2 id='arrep'> Compute the Autoregressive Representation of a SARIMA Model </h2><span id='topic+arrep'></span>

<h3>Description</h3>

<p>Invert (invertible) SARIMA(p, d, q, P, D, Q) models to ar representation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrep(notation = "arima", phi = c(rep(0, 10)), d = 0, theta = c(rep(0, 10)),
 Phi = c(rep(0, 10)), D = 0, Theta = c(rep(0, 10)), frequency = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrep_+3A_notation">notation</code></td>
<td>
<p> &quot;arima&quot; for notation of the type used by the function arima(stats), &quot;dse1&quot; for type  notation used by the package dse1. </p>
</td></tr>
<tr><td><code id="arrep_+3A_phi">phi</code></td>
<td>
<p> p vector of autoregressive coefficient. </p>
</td></tr>
<tr><td><code id="arrep_+3A_d">d</code></td>
<td>
<p> difference operator, implemented: d element of (0,1,2). </p>
</td></tr>
<tr><td><code id="arrep_+3A_theta">theta</code></td>
<td>
<p> q vector of moving average coefficients. </p>
</td></tr>
<tr><td><code id="arrep_+3A_phi">Phi</code></td>
<td>
<p> P vector of seasonal autoregressive coefficients. </p>
</td></tr>
<tr><td><code id="arrep_+3A_d">D</code></td>
<td>
<p> Seasonal difference operator, implemented: D element of (0,1,2). </p>
</td></tr>
<tr><td><code id="arrep_+3A_theta">Theta</code></td>
<td>
<p> Q vector of seasonal moving average coefficients. </p>
</td></tr>
<tr><td><code id="arrep_+3A_frequency">frequency</code></td>
<td>
<p> The frequency of the seasonality (e.g. frequency = 12 for monthly series with annual periodicity). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>For input, positive values of phi, theta, Phi and Theta indicate positive dependence. 
Implemented for p,q,P,Q element of c(0,1,2,3,4,5,6,7,8,9,10). The ar representation is truncated at coefficients less than 1.0e-10. Values of theta, Theta near non invertibility (-1 or 1) will not be practical and will cause near infinite lags, especially for Theta and large frequency.
</p>


<h3>Value</h3>

<p>A vector containing a truncated autoregressive representation of a SARIMA model. This can be used as input for the function gar.sim.
</p>


<h3>Author(s)</h3>

<p> Olivier Briet <a href="mailto:o.briet@gmail.com">o.briet@gmail.com</a> </p>


<h3>References</h3>

<p> Briet OJT, Amerasinghe PH, Vounatsou P: Generalized seasonal autoregressive integrated moving average
models for count data with application to malaria time series with low case numbers.
PLoS ONE, 2013, 8(6): e65761. doi:10.1371/journal.pone.0065761  <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761</a> If you use the gsarima package, please cite the above reference.</p>


<h3>See Also</h3>

<p> 'garsim'. </p>


<h3>Examples</h3>

<pre><code class='language-R'>phi&lt;-c(0.5, 0.3, 0.1)
theta&lt;-c(0.6, 0.2, 0.2)
ar&lt;-arrep(phi=phi, theta=theta, frequency=12)
check&lt;-(acf2AR(ARMAacf(ar=phi, ma=theta, lag.max = 100, pacf = FALSE))[100,1:length(ar)])
as.data.frame(cbind(ar,check))

phi&lt;-c(0.2,0.5)
theta&lt;-c(0.4)
Phi&lt;-c(0.6)
Theta&lt;-c(0.3)
d&lt;-2
D&lt;-1
frequency&lt;-12
ar&lt;-arrep(phi=phi, theta=theta, Phi=Phi, Theta=Theta, frequency= frequency, d=d, D=D)
N&lt;-500
intercept&lt;-10
data.sim &lt;- garsim(n=(N+length(ar)),phi=ar, X=matrix(rep(intercept,(N+ length(ar)))),
beta=1, sd=1) 
y&lt;-data.sim[1+length(ar): (N+length(ar))]
tsy&lt;-ts(y, freq= frequency)
plot(tsy)
arima(tsy, order=c(2,2,1), seasonal=list(order=c(1,1,1)))
</code></pre>

<hr>
<h2 id='garsim'> Simulate a Generalized Autoregressive Time Series </h2><span id='topic+garsim'></span>

<h3>Description</h3>

<p>Simulate a time series using a general autoregressive model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>garsim(n, phi, X = matrix(0, nrow = n), beta = as.matrix(0), sd = 1, 
	family = "gaussian", transform.Xbeta = "identity", link = "identity", 
	minimum = 0, zero.correction = "zq1", c = 1, theta = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="garsim_+3A_n">n</code></td>
<td>
<p> The number of simulated values. </p>
</td></tr>
<tr><td><code id="garsim_+3A_phi">phi</code></td>
<td>
<p> A vector of autoregressive parameters of length p. </p>
</td></tr>
<tr><td><code id="garsim_+3A_x">X</code></td>
<td>
<p> An n by m optional matrix of external covariates, optionally including an intercept (recommended for family = &quot;poisson&quot;). </p>
</td></tr>
<tr><td><code id="garsim_+3A_beta">beta</code></td>
<td>
<p> An m vector of coefficients. </p>
</td></tr>
<tr><td><code id="garsim_+3A_sd">sd</code></td>
<td>
<p> Standard deviation for Gaussian family. </p>
</td></tr>
<tr><td><code id="garsim_+3A_family">family</code></td>
<td>
<p> Distribution family, defaults to &quot;gaussian&quot;. </p>
</td></tr>
<tr><td><code id="garsim_+3A_transform.xbeta">transform.Xbeta</code></td>
<td>
<p> Optional transformation for the product of covariates and coefficients, see Details. </p>
</td></tr>
<tr><td><code id="garsim_+3A_link">link</code></td>
<td>
<p> The link function, defaults to &quot;identity&quot;. </p>
</td></tr>
<tr><td><code id="garsim_+3A_minimum">minimum</code></td>
<td>
<p> A minimum value for the mean parameter of the Poisson and Negative Binomialdistributions 
(only applicable for link= &quot;identity&quot; and family = c(&quot;poisson&quot;,&quot;negative.binomial&quot;)). 
Defaults to 0. A small positive value will allow non-stationary series to &quot;grow&quot; 
after encountering a simulated value of 0. </p>
</td></tr>
<tr><td><code id="garsim_+3A_zero.correction">zero.correction</code></td>
<td>
<p> Method for transformation for dealing with zero values (only applicable when link = &quot;log&quot;), see Details. </p>
</td></tr>
<tr><td><code id="garsim_+3A_c">c</code></td>
<td>
<p> The constant used for transformation before taking the logarithm (only applicable when link = &quot;log&quot;). A value between 0 and 1 is recommended. </p>
</td></tr>
<tr><td><code id="garsim_+3A_theta">theta</code></td>
<td>
<p> Parameter theta (for family = &quot;negative.binomial&quot;). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implemented are the following models:
1) family = &quot;gaussian&quot;, link = &quot;identity&quot;
2) family = &quot;poisson&quot;, link = &quot;identity&quot;
3) family = &quot;poisson&quot;, link = &quot;identity&quot;, transform.Xbeta = &quot;exponential&quot;
4) family = &quot;poisson&quot;, link = &quot;log&quot;, zero.correction = &quot;zq1&quot;
5) family = &quot;poisson&quot;, link = &quot;log&quot;, zero.correction = &quot;zq2&quot;
6) family = &quot;negative.binomial&quot;, link = &quot;identity&quot;
7) family = &quot;negative.binomial&quot;, link = &quot;identity&quot;, transform.Xbeta = &quot;exponential&quot;
8) family = &quot;negative.binomial&quot;, link = &quot;log&quot;, zero.correction = &quot;zq1&quot;
9) family = &quot;negative.binomial&quot;, link = &quot;log&quot;, zero.correction = &quot;zq2&quot;
</p>
<p>Models 1 to 4 are within the family of GARMA models of Benjamin and colleagues 2003
Model 2 is the extension to higher order p of a Poisson CLAR(1) model proposed by Grunwald and  colleagues (2000).
Model 3 is a modification of the PAR(p) data generating process (<a href="https://personal.utdallas.edu/~pxb054000/code/pests.r">https://personal.utdallas.edu/~pxb054000/code/pests.r</a>) of Brandt and Williams (2001). Note that for psi = 0, the model reduces to a standard Poisson model with log-link function. For a model without external variables (only an intercept), the transformation of Xbeta has no consequence and then model 3 is the same as model 2.
Model 4 corresponds to model 2.2 of Zeger and Qaqish (1988). The value c is only added to values of zero prior to taking the log.
Models 6 to 9 are similar but with negative binomial distribution
</p>


<h3>Value</h3>

<p>  An autoregressive series of length n. Note that the first p data do not have autoregressive structure.
</p>


<h3>Note</h3>

<p>Version 0.1-2: bug corrected and garmaFit example given, Version 0.1-5: garmaFit example removed due to archiving of package gamlss.util</p>


<h3>Author(s)</h3>

<p> Olivier Briet <a href="mailto:o.briet@gmail.com">o.briet@gmail.com</a> </p>


<h3>References</h3>

<p>Briet OJT, Amerasinghe PH, Vounatsou P: Generalized seasonal autoregressive integrated moving average
models for count data with application to malaria time series with low case numbers.
PLoS ONE, 2013, 8(6): e65761. doi:10.1371/journal.pone.0065761  <a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761">https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0065761</a> If you use the gsarima package, please cite the above reference.
</p>
<p>Brandt PT, Williams JT: A linear Poisson autoregressive model: The PAR(p). Political Analysis 2001, 9.
</p>
<p>Benjamin MA, Rigby RA, Stasinopoulos DM: Generalized Autoregressive Moving Average Models. Journal of the American Statistical Association 2003, 98:214-223.
</p>
<p>Zeger SL, Qaqish B: Markov regression models for time series: a quasi-likelihood approach. Biometrics 1988, 44:1019-1031
</p>
<p>Grunwald G, Hyndman R, Tedesco L, Tweedie R: Non-Gaussian conditional linear AR(1) models. Australian &amp; New Zealand Journal of Statistics 2000, 42:479-495. 
</p>


<h3>See Also</h3>

<p> 'rnegbin(MASS)', 'arrep'. </p>


<h3>Examples</h3>

<pre><code class='language-R'>  N&lt;-1000
  ar&lt;-c(0.8)
  intercept&lt;-2
  frequency&lt;-1
  x&lt;- rnorm(N)
  beta.x&lt;-0.7
  #Gaussian simulation with covariate
  X=matrix(c(rep(intercept, N+length(ar)), rep(0, length(ar)), x), ncol=2)
  y.sim &lt;- garsim(n=(N+length(ar)),phi=ar, X=X, beta=c(1,beta.x), sd=sqrt(1)) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  arima(tsy, order=c(1,0,0), xreg=x)

  #Gaussian simulation with covariate and deterministic seasonality through first order harmonic
  ar&lt;-c(1.4,-0.4)
  frequency&lt;-12
  beta.x&lt;-c(0.7,4,4)
  X&lt;-matrix(nrow= (N+ length(ar)), ncol=3)
  for (t in 1: length(ar)){
	X[t,1]&lt;-0
	X[t,2]&lt;-sin(2*pi*(t- length(ar))/frequency)
	X[t,3]&lt;- cos(2*pi*(t- length(ar))/frequency)
  }
  for (t in (1+ length(ar)): (N+ length(ar))){
	X[t,1]&lt;-x[t- length(ar)]
	X[t,2]&lt;-sin(2*pi*(t- length(ar))/frequency)
	X[t,3]&lt;- cos(2*pi*(t- length(ar))/frequency)
  }
  y.sim &lt;- garsim(n=(N+length(ar)),phi=ar, X=X, beta= beta.x, sd=sqrt(1)) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  Xreg&lt;-matrix(nrow= N, ncol=3)
  for (t in 1: N){
	Xreg[t,1]&lt;-x[t]
	Xreg[t,2]&lt;-sin(2*pi*t/frequency)
	Xreg[t,3]&lt;- cos(2*pi*t/frequency)
  }
  arimares&lt;-arima(tsy, order=c(1,1,0), xreg=Xreg)
  tsdiag(arimares)
  arimares

  #Negative binomial simulation with covariate
  ar&lt;-c(0.8)
  frequency&lt;-1
  beta.x&lt;-0.7
  X=matrix(c(rep(log(intercept), N+length(ar)), rep(0, length(ar)), x), ncol=2)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1,beta.x), link= "log", 
  	family= "negative.binomial", zero.correction = "zq1", c=1, theta=5, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
    
  #Poisson ARMA(1,1) with identity link and negative auto correlation
  N&lt;-500
  phi&lt;-c(-0.8)
  theta&lt;-c(0.6)
  ar&lt;-arrep(phi=phi, theta=theta)
  check&lt;-(acf2AR(ARMAacf(ar=phi, ma=theta, lag.max = 100, pacf = FALSE))[100,1:length(ar)])
  as.data.frame(cbind(ar,check))
  intercept&lt;-100
  frequency&lt;-1
  X=matrix(c(rep(intercept, N+length(ar))), ncol=1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1), link= "identity", 
  	family= "poisson", minimum = -100, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
  #Poisson AR(1) with identity link and negative auto correlation
  N&lt;-1000
  ar&lt;-c(-0.8)
  intercept&lt;-100
  frequency&lt;-1
  X=matrix(c(rep(intercept, N+length(ar))), ncol=1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1), link= "identity", 
  	family= "poisson", minimum = -100, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  
  #Example of negative binomial GSARIMA(2,1,0,0,0,1)x
  phi&lt;-c(0.5,0.2)
  theta&lt;-c(0)
  Theta&lt;-c(0.5)
  Phi&lt;-c(0)
  d&lt;-c(1)
  D&lt;-c(0)
  frequency&lt;-12
  ar&lt;-arrep(phi=phi, theta=theta, Phi=Phi, Theta=Theta, frequency= frequency, d=d, D=D)
  N&lt;-c(1000)
  intercept&lt;-c(10)
  x&lt;- rnorm(N)
  beta.x&lt;-c(0.7)
  X&lt;-matrix(c(rep(log(intercept), N+length(ar)), rep(0, length(ar)), x), ncol=2)
  c&lt;-c(1)
  y.sim &lt;- garsim(n=(N+length(ar)), phi=ar, beta=c(1,beta.x), link= "log", 
  	family= "negative.binomial", zero.correction = "zq1", c=c, theta=5, X=X) 
  y&lt;-y.sim[(1+length(ar)):(N+length(ar))]
  tsy&lt;-ts(y, freq=frequency)
  plot(tsy)
  plot(log(tsy))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
