<!DOCTYPE html><html lang="en"><head><title>Help for package tidymodlr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {tidymodlr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#tidymodlr-package'><p><code>tidymodlr</code>: Modelling with tidy long data</p></a></li>
<li><a href='#make_key_value'><p>Generate a key value table with unique key for a set of text</p></a></li>
<li><a href='#tidymodl'><p>Creates a model matrix style R6 class for modelling with long tidy</p>
data</a></li>
<li><a href='#wb'><p>Dummy Long Tidy Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>An R6 Class to Perform Analysis on Long Tidy Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>David Hammond [aut, cre]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/david-hammond/tidymodlr">https://github.com/david-hammond/tidymodlr</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/david-hammond/tidymodlr/issues">https://github.com/david-hammond/tidymodlr/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Hammond &lt;anotherdavidhammond@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Transforms long data into a matrix form to allow for ease of input into modelling packages for regression, principal components, imputation or machine learning. It does this by pivoting on user defined columns, generating a key-value table for variable names to ensure one-to-one mappings are preserved. It is particularly useful when the indicator names in the columns are long descriptive strings, for example "Energy imports, net (% of energy use)". High level analysis wrapper functions for correlation and principal components analysis are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>R6, dplyr, tidyr, tm, corrr, FactoMineR</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-08-20 07:05:39 UTC; DavidHammond</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-08-26 12:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='tidymodlr-package'><code>tidymodlr</code>: Modelling with tidy long data</h2><span id='topic+tidymodlr'></span><span id='topic+tidymodlr-package'></span>

<h3>Description</h3>

<p><code>tidymodlr</code> transforms long data into a matrix form to allow for ease
of input into modelling packages for regression, principal components,
imputation or machine learning.
</p>


<h3>Details</h3>

<p>In many fields it is common to have data in tidy long data, with
the rows representing many variables, but only <strong>one</strong>
column representing the values (see <code>?wb</code> for an example).
</p>
<p><code>tidymodlr</code> is particularly useful when the indicator names in the
columns are long descriptive strings, for example
'Energy imports, net (% of energy use)'.
In such cases a straight <code style="white-space: pre;">&#8288;pivot wider&#8288;</code> generates column names that are
not only cumbersome, but also generate errors in many standard
modelling packages that require <code>base</code> column names.
</p>
<p>High level analysis functions for correlation, imputation and principals
components analysis are provided.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: David Hammond <a href="mailto:anotherdavidhammond@gmail.com">anotherdavidhammond@gmail.com</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/david-hammond/tidymodlr">https://github.com/david-hammond/tidymodlr</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/david-hammond/tidymodlr/issues">https://github.com/david-hammond/tidymodlr/issues</a>
</p>
</li></ul>


<hr>
<h2 id='make_key_value'>Generate a key value table with unique key for a set of text</h2><span id='topic+make_key_value'></span>

<h3>Description</h3>

<p>Given a vector of characters, this will return a data frame of
a unique <code>key</code> column (of, where possible, 3 characters) and <code>value</code>
column listing the unique elements of the original <code>text</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_key_value(text)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="make_key_value_+3A_text">text</code></td>
<td>
<p>The text to abbreviate and create a key value table for</p>
</td></tr>
</table>


<h3>Value</h3>

<p>df A <code style="white-space: pre;">&#8288;Key Value&#8288;</code> table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wb)
make_key_value(wb$indicator)
</code></pre>

<hr>
<h2 id='tidymodl'>Creates a model matrix style R6 class for modelling with long tidy
data</h2><span id='topic+tidymodl'></span>

<h3>Description</h3>

<p>Creates a model matrix style R6 class for modelling with long tidy data
</p>


<h3>Public fields</h3>

<div class="r6-fields">

<dl>
<dt><code>data</code></dt><dd><p>(<code>data.frame()</code>)<br />
The original tidy long data frame</p>
</dd>
<dt><code>parent</code></dt><dd><p>(<code>data.frame()</code>)<br />
The parent identifiers of the original data</p>
</dd>
<dt><code>child</code></dt><dd><p>(<code>data.frame()</code>)<br />
The model matrix version of the data</p>
</dd>
<dt><code>key</code></dt><dd><p>(<code>data.frame()</code>)<br />
A <code style="white-space: pre;">&#8288;key value&#8288;</code> table that links the parent
and child data.frames.</p>
</dd>
</dl>

</div>


<h3>Methods</h3>



<h4>Public methods</h4>


<ul>
<li> <p><a href="#method-tidymodl-new"><code>tidymodl$new()</code></a>
</p>
</li>
<li> <p><a href="#method-tidymodl-assemble"><code>tidymodl$assemble()</code></a>
</p>
</li>
<li> <p><a href="#method-tidymodl-print"><code>tidymodl$print()</code></a>
</p>
</li>
<li> <p><a href="#method-tidymodl-correlate"><code>tidymodl$correlate()</code></a>
</p>
</li>
<li> <p><a href="#method-tidymodl-pca"><code>tidymodl$pca()</code></a>
</p>
</li>
<li> <p><a href="#method-tidymodl-clone"><code>tidymodl$clone()</code></a>
</p>
</li></ul>


<hr>
<a id="method-tidymodl-new"></a>



<h4>Method <code>new()</code></h4>

<p>Creates a new instance of this <a href="R6.html#topic+R6Class">R6</a> class.
</p>
<p>Create a new tidymodl object.
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$new(df, pivot_column, pivot_value)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>df</code></dt><dd><p>A tidy long data frame</p>
</dd>
<dt><code>pivot_column</code></dt><dd><p>The column name on which the pivot will occur</p>
</dd>
<dt><code>pivot_value</code></dt><dd><p>The column name of the values to be pivotted</p>
</dd>
</dl>

</div>



<h5>Returns</h5>

<p>A new <code>tidymodl</code> object.
</p>


<hr>
<a id="method-tidymodl-assemble"></a>



<h4>Method <code>assemble()</code></h4>

<p>Adds a results matrix
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$assemble(newdata, format = "long")</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>newdata</code></dt><dd><p>A new data set to append. Needs to be either:
</p>

<ul>
<li><p> A vector of length equal to the number of rows in the model matrix.
For example, the output of <code>predict()</code> of a <code>lm</code> model.
In this case the function returns a data.frame of dimensions
<code>c(nrow(parent), ncol(parent) + 1)</code>
</p>
</li>
<li><p> A data.frame/matrix of equal dimensions of the model matrix.
For example, the output of <code>xgb_impute()</code>.
In this case the function returns a data.frame of dimensions
<code>c(nrow(data), ncol(data) + 1)</code>
</p>
</li></ul>
</dd>
<dt><code>format</code></dt><dd><p>The desired format of the returned data frame, can either
be &quot;long&quot; or &quot;wide&quot;.</p>
</dd>
</dl>

</div>



<h5>Details</h5>

<p>This returns a completed data.frame for four use cases based on user
preference of the desired format.
</p>

<ul>
<li> <p><strong>Format &quot;long&quot;:</strong>
</p>

<ul>
<li> <p><strong>Use Case 1 - &quot;newdata&quot; is a vector of length nrow(child):</strong>
The function returns a combined data frame of the parent data and the
&quot;newdata&quot; in a new column. Useful when the user wants to append an
output of, for example, <code>predict</code> for a <code>lm</code> regression model.
</p>
</li>
<li> <p><strong>Use Case 2 - &quot;newdata&quot; is a matrix of dimensions
dim(child):</strong> The function returns a data.frame of the original data in
long format with the &quot;newdata&quot; in a new column. Useful when the user
wants to append an output of, for example, <code>xgb_impute</code> for all original
data.
</p>
</li></ul>

</li>
<li> <p><strong>Format &quot;wide&quot;:</strong>
</p>

<ul>
<li> <p><strong>Use Case 3 - &quot;newdata&quot; is a vector of length nrow(child):</strong>
The function returns a combined data frame of the parent data and the
&quot;newdata&quot; in a new column. Useful when the user wants to append an
output of, for example, <code>predict</code> for a <code>lm</code> regression model.
</p>
</li>
<li> <p><strong>Use Case 4 - &quot;newdata&quot; is a matrix of dimensions
dim(child):</strong> The function returns a data.frame of the original data in
wide format with the &quot;newdata&quot; as replacing the child matrix of the
original data. Useful when the user <em>is only</em> interested in using
the output of, for example, <code>xgb_impute</code> for all original data.
</p>
</li></ul>

</li></ul>




<h5>Returns</h5>

<p>df A Data Frame
</p>


<hr>
<a id="method-tidymodl-print"></a>



<h4>Method <code>print()</code></h4>

<p>Prints the key and the head matrix
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$print()</pre></div>


<hr>
<a id="method-tidymodl-correlate"></a>



<h4>Method <code>correlate()</code></h4>

<p>Correlates and reutrns pearson values
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$correlate()</pre></div>



<h5>Returns</h5>

<p>df A Correlation Matrix of class <code>cor_df</code> (see
<a href="https://CRAN.R-project.org/package=corrr">corrr</a>)
</p>


<hr>
<a id="method-tidymodl-pca"></a>



<h4>Method <code>pca()</code></h4>

<p>Provides high level principal components analysis
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$pca()</pre></div>



<h5>Returns</h5>

<p>df A principle components of class <code>PCA</code> (see
<a href="https://CRAN.R-project.org/package=FactoMineR">FactoMineR</a>
</p>


<hr>
<a id="method-tidymodl-clone"></a>



<h4>Method <code>clone()</code></h4>

<p>The objects of this class are cloneable with this method.
</p>


<h5>Usage</h5>

<div class="r"><pre>tidymodl$clone(deep = FALSE)</pre></div>



<h5>Arguments</h5>

<div class="arguments">

<dl>
<dt><code>deep</code></dt><dd><p>Whether to make a deep clone.</p>
</dd>
</dl>

</div>




<h3>Note</h3>

<p>Use Cases 1 and 3 return identical results.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wb)
mdl &lt;- tidymodl$new(wb,
                   pivot_column = "indicator",
                  pivot_value = "value")
### Use mdl$child for modelling
fit &lt;- lm(data = mdl$child, gni ~ gcu + ppt)

### Can be used to add a yhat value for processed data

nc &lt;- ncol(mdl$child)
nr &lt;- nrow(mdl$child)
dm &lt;- nc * nr
dummy &lt;- matrix(runif(dm),
                ncol = nc) |&gt;
                data.frame()
names(dummy) = names(mdl$child)
tmp &lt;- mdl$assemble(dummy)

# In built correlation function
mdl$correlate()

tmp &lt;- mdl$pca()
plot(tmp, choix = "var")

</code></pre>

<hr>
<h2 id='wb'>Dummy Long Tidy Data</h2><span id='topic+wb'></span>

<h3>Description</h3>

<p>A dataset from the World Bank of a dummy data. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wb)
</code></pre>


<h3>Format</h3>

<p>A data frame with 975 rows and 4 variables
</p>

<ul>
<li> <p><strong>iso3c:</strong> isocode of a country.
</p>
</li>
<li> <p><strong>indicator:</strong> World Bank indicator.
</p>
</li>
<li> <p><strong>year:</strong> Year of observation
</p>
</li>
<li> <p><strong>value:</strong> Value of observation
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
