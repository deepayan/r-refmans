<!DOCTYPE html><html><head><title>Help for package rocbc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rocbc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#checkboxcox'>
<p>Tests whether Box-Cox is appropriate for the given dataset (one-marker version)</p></a></li>
<li><a href='#checkboxcox2'>
<p>Tests whether Box-Cox is appropriate for the given dataset (two-marker version)</p></a></li>
<li><a href='#comparebcAUC'>
<p>Performs inference to compare the AUCs of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given nominal level</p></a></li>
<li><a href='#comparebcJ'>
<p>Performs inference to compare the Youden Indices of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given nominal level</p></a></li>
<li><a href='#comparebcSens'>
<p>Performs inference to compare the sensitivities of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given specificty and a given nominal level</p></a></li>
<li><a href='#comparebcSpec'>
<p>Performs inference to compare the specificities of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given sensitivity and a given nominal level</p></a></li>
<li><a href='#rocboxcox'>
<p>Comprehensive Box-Cox ROC analysis for a single marker</p></a></li>
<li><a href='#rocboxcoxCI'>
<p>Inference around the sensitivity at a given specificity (and vice versa) for a single Box-Cox transformed biomarker</p></a></li>
<li><a href='#threerocs'>
<p>Provides visual comparison of three ROC estimation methods (one-marker version)</p></a></li>
<li><a href='#threerocs2'>
<p>Provides visual comparison of three ROC estimation methods (two-marker version)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Statistical Inference for Box-Cox Based Receiver Operating
Characteristic Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Benjamin Brewer &lt;tennisbenj@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Generation of Box-Cox based ROC curves and several aspects of inferences and hypothesis testing. Can be used when inferences for one biomarker (Bantis LE, Nakas CT, Reiser B. (2018)&lt;<a href="https://doi.org/10.1002%2Fbimj.201700107">doi:10.1002/bimj.201700107</a>&gt;) are of interest or when comparisons of two correlated biomarkers (Bantis LE, Nakas CT, Reiser B. (2021)&lt;<a href="https://doi.org/10.1002%2Fbimj.202000128">doi:10.1002/bimj.202000128</a>&gt;) are of interest. Provides inferences and comparisons around the AUC, the Youden index, the sensitivity at a given specificity level (and vice versa), the optimal operating point of the ROC curve (in the Youden sense), and the Youden based cutoff.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>pracma, clinfun, splancs, mvtnorm, formattable, MRMCaov, pROC</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, markdown, matlab</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Author:</td>
<td>Leonidas Bantis [aut],
  Benjamin Brewer [cre, ctb],
  Christos Nakas [ctb],
  Benjamin Reiser [ctb]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-22 15:36:01 UTC; benbrewer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-22 15:52:41 UTC</td>
</tr>
</table>
<hr>
<h2 id='checkboxcox'>
Tests whether Box-Cox is appropriate for the given dataset (one-marker version)
</h2><span id='topic+checkboxcox'></span>

<h3>Description</h3>

<p>This function tests whether the Box-Cox transformation is able to achieve approximate normality for your data. That is, it will allow the user to know whether it is appropriate to use all the methods discussed later on in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkboxcox(marker, D, plots, printShapiro = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkboxcox_+3A_marker">marker</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals.</p>
</td></tr>
<tr><td><code id="checkboxcox_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="checkboxcox_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, the user gets the histograms of the biomarker for both the healthy and the diseased group before and after the Box-Cox transformation. In addition, all four corresponding qq-plots are provided.</p>
</td></tr>
<tr><td><code id="checkboxcox_+3A_printshapiro">printShapiro</code></td>
<td>
<p>Boolean. When set to TRUE, the results of the Shapiro-Wilk test will be printed to the console. When set to FALSE, the results are suppressed. Default value is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>res_shapiro</code></td>
<td>
<p>A results table that contains the results of four Shapiro-Wilk tests for normality testing. Two of these refer to normality testing of the healthy and the diseased groups before the Box-Cox transformation, and the remaining two refer to the Box-Cox transformed biomarkers scores for the healthy and the diseased groups. Thus, this testing process produces four p-values. In addition, if the plots are set to 'on', then the output provides (1) the histograms of the biomarker for both the healthy and the diseased groups before and after the Box-Cox transformation, (2) all four corresponding qq-plots, and (3) a plot with the empirical ROC curve overplotted with the Box-Cox based ROC curve for visual comparison purposes.</p>
</td></tr>
<tr><td><code>transformation.parameter</code></td>
<td>
<p>The single transformation parameter, lambda, that is applied for both groups simultaneously.</p>
</td></tr>
<tr><td><code>transx</code></td>
<td>
<p>The Box-Cox transformed scores for the healthy.</p>
</td></tr>
<tr><td><code>transy</code></td>
<td>
<p>The Box-Cox transformed scores for the diseased.</p>
</td></tr>
<tr><td><code>pval_x</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the healthy group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_y</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the diseased group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transx</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the healthy group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transy</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the diseased group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>roc</code></td>
<td>
<p>A function of the estimated Box-Cox ROC curve. You can use this to simply request TPR values for given FPR values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Nakas CT, Reiser B. (2021). Statistical inference for the difference between two maximized Youden indices obtained from correlated biomarkers. Biometrical Journal, 63(6):1241-1253. https://doi.org/10.1002/bimj.202000128
</p>
<p>Bantis LE, Nakas CT, Reiser B. (2018). Construction of confidence intervals for the maximum of the Youden index and the corresponding cutoff point of a continuous biomarker. Biometrical Journal, 61(1):138-156. https://doi.org/10.1002/bimj.201700107
</p>
<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>
<p>Bantis LE, Nakas CT, Reiser B. (2014). Construction of confidence regions in the ROC space after the estimation of the optimal Youden index-based cut-off point. Biometrics, 70(1):212-223. https://doi.org/10.1111/biom.12107
</p>
<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x &lt;- rgamma(100, shape=2, rate = 8) # generates biomarker data from a gamma
                                 # distribution for the healthy group.
y &lt;- rgamma(100, shape=2, rate = 4) # generates biomarker data from a gamma
                                 # distribution for the diseased group.
scores &lt;- c(x,y)
D=c(pracma::zeros(1,100), pracma::ones(1,100))
out=checkboxcox(marker=scores, D, plots="on")
summary(out)
</code></pre>

<hr>
<h2 id='checkboxcox2'>
Tests whether Box-Cox is appropriate for the given dataset (two-marker version)
</h2><span id='topic+checkboxcox2'></span>

<h3>Description</h3>

<p>This function tests whether the Box-Cox transformation is able to achieve approximate normality for your data. That is, it will allow the user to know whether it is appropriate to use all the methods discussed later on in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkboxcox2(marker1, marker2, D, plots, printShapiro = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkboxcox2_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="checkboxcox2_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="checkboxcox2_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="checkboxcox2_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, the user gets the histograms of the biomarker for both the healthy and the diseased group before and after the Box-Cox transformation for both marker1 and marker2. In addition, all eight corresponding qq-plots are provided.</p>
</td></tr>
<tr><td><code id="checkboxcox2_+3A_printshapiro">printShapiro</code></td>
<td>
<p>Boolean. When set to TRUE, the results of the Shapiro-Wilk test will be printed to the console. When set to FALSE, the results are suppressed. Default value is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>res_shapiro</code></td>
<td>
<p>A results table that contains the results of eight Shapiro-Wilk tests for normality testing. Four of these refer to normality testing of the healthy and the diseased groups before the Box-Cox transformation, and the remaining four refer to the Box-Cox transformed biomarkers scores for the healthy and the diseased groups. Thus, this testing process produces eight p-values. In addition, if the plots are set to 'on', then the output provides (1) the histograms of the biomarker for both the healthy and the diseased groups before and after the Box-Cox transformation for both marker1 and marker2, (2) all eight corresponding qq-plots, and (3) two plots (one for marker1, one for marker2) with the empirical ROC curve overplotted with the Box-Cox based ROC curve for visual comparison purposes.</p>
</td></tr>
<tr><td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td></tr>
<tr><td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td></tr>
<tr><td><code>pval_x_marker1</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker1 healthy group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_y_marker1</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker1 diseased group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transx_marker1</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker1 healthy group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transy_marker1</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker1 diseased group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_x_marker2</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker2 healthy group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_y_marker2</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker2 diseased group (before the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transx_marker2</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker2 healthy group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>pval_transy_marker2</code></td>
<td>
<p>The p-value of the Shapiro Wilk test of normality for the marker2 diseased group (after the Box-Cox transformation).</p>
</td></tr>
<tr><td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Nakas CT, Reiser B. (2021). Statistical inference for the difference between two maximized Youden indices obtained from correlated biomarkers. Biometrical Journal, 63(6):1241-1253. https://doi.org/10.1002/bimj.202000128
</p>
<p>Bantis LE, Nakas CT, Reiser B. (2018). Construction of confidence intervals for the maximum of the Youden index and the corresponding cutoff point of a continuous biomarker. Biometrical Journal, 61(1):138-156. https://doi.org/10.1002/bimj.201700107
</p>
<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>
<p>Bantis LE, Nakas CT, Reiser B. (2014). Construction of confidence regions in the ROC space after the estimation of the optimal Youden index-based cut-off point. Biometrics, 70(1):212-223. https://doi.org/10.1111/biom.12107
</p>
<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X = mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1, 0.6, 0.6, 1.1), nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y = mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx = pracma::zeros(nx,1)
dy = pracma::ones(ny,1)

markers = rbind(X,Y);
marker1 = markers[,1]
marker2 = markers[,2]
D = c(rbind(dx,dy))

out=checkboxcox2(marker1, marker2, D, plots = "on")
summary(out)
</code></pre>

<hr>
<h2 id='comparebcAUC'>
Performs inference to compare the AUCs of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given nominal level
</h2><span id='topic+comparebcAUC'></span>

<h3>Description</h3>

<p>This function provides a comparison of two correlated markers in terms of their AUCs (areas under the Box-Cox based ROC curves). Markers measurements are assumed to be taken on the same individuals for both markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparebcAUC(marker1, marker2, D, alpha, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparebcAUC_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="comparebcAUC_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="comparebcAUC_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="comparebcAUC_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="comparebcAUC_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot; it returns the Box-Cox based ROC along with informative information about the two AUCs in the legend of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>resultstable</code></td>
<td>
<p>A summary table of the comparison that contains the AUC of each marker, the p-value of the difference using the probit transformation, the p-value of the difference, and the confidence interval of the difference.</p>
</td></tr>
<tr><td><code>AUCmarker1</code></td>
<td>
<p>The AUC of the first marker.</p>
</td></tr>
<tr><td><code>AUCmarker2</code></td>
<td>
<p>The AUC of the second marker.</p>
</td></tr>
<tr><td><code>pvalue_probit_difference</code></td>
<td>
<p>The p-value for the comparison of the AUCs. It employs the probit transformation that has greater power than when not using it (as in pvalue_difference).</p>
</td></tr>
<tr><td><code>pvalue_difference</code></td>
<td>
<p>The p-value for the comparisons of the AUC (without the probit transformation). Simulations have shown that this is inferior to the ‘pvalue_probit_difference’.</p>
</td></tr>
<tr><td><code>CI_difference</code></td>
<td>
<p>The confidence interval for the difference of the AUCs.</p>
</td></tr>
<tr><td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td></tr>
<tr><td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE SOME BIVARIATE DATA===

set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1,   0.5,
               0.5,  1),
             nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X=mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1,   0.6,
               0.6,  1.1),
             nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y=mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx=pracma::zeros(nx,1)
dy=pracma::ones(ny,1)

markers=rbind(X,Y);
marker1=markers[,1]
marker2=markers[,2]
D=c(rbind(dx,dy))

#===COMPARE THE AUCs of Marker 1 vs Marker 2

out=comparebcAUC(marker1, marker2, D, alpha=0.05,  plots="on")
</code></pre>

<hr>
<h2 id='comparebcJ'>
Performs inference to compare the Youden Indices of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given nominal level
</h2><span id='topic+comparebcJ'></span>

<h3>Description</h3>

<p>This function provides a comparison of two correlated markers in terms of their J (Youden indices for Box-Cox based ROC curves). Marker measurements are assumed to be taken on the same individuals for both markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparebcJ(marker1, marker2, D, alpha,  plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparebcJ_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="comparebcJ_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="comparebcJ_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual, where 0 denotes a healthy/control individual, and 1 denotes a diseased individual.</p>
</td></tr>
<tr><td><code id="comparebcJ_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="comparebcJ_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot; it returns the Box-Cox based ROC along with informative information about the two AUCs in the legend of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>resultstable</code></td>
<td>
<p>A summary table of the comparison that contains the maximized Youden Index of each marker, the p-value of the difference using the probit transformation, the p-value of the difference, and the confidence interval of the difference.</p>
</td></tr>
<tr><td><code>J1</code></td>
<td>
<p>The maximized Youden Index of the first marker.</p>
</td></tr>
<tr><td><code>J2</code></td>
<td>
<p>The maximized Youden Index of the second marker.</p>
</td></tr>
<tr><td><code>pvalue_probit_difference</code></td>
<td>
<p>The p-value for the comparison of the Js. It employs the probit transformation that has greater power than when not using it (as in pvalue_difference).</p>
</td></tr>
<tr><td><code>pvalue_difference</code></td>
<td>
<p>The p-value for the comparisons of the Js (without the probit transformation). Simulations have shown that this is inferior to the ‘pvalue_probit_difference’.</p>
</td></tr>
<tr><td><code>CI_difference</code></td>
<td>
<p>The confidence interval for the difference of the Js.</p>
</td></tr>
<tr><td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td></tr>
<tr><td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Nakas CT, Reiser B. (2021). Statistical inference for the difference between two maximized Youden indices obtained from correlated biomarkers. Biometrical Journal, 63(6):1241-1253. https://doi.org/10.1002/bimj.202000128
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE SOME BIVARIATE DATA===

set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1,   0.5,
               0.5,  1),
             nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X=mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1,   0.6,
               0.6,  1.1),
             nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y=mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx=pracma::zeros(nx,1)
dy=pracma::ones(ny,1)

markers=rbind(X,Y);
marker1=markers[,1]
marker2=markers[,2]
D=c(rbind(dx,dy))

#===COMPARE THE Js of Marker 1 vs Marker 2

out=comparebcJ(marker1, marker2, D, alpha=0.05,  plots="on")
</code></pre>

<hr>
<h2 id='comparebcSens'>
Performs inference to compare the sensitivities of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given specificty and a given nominal level
</h2><span id='topic+comparebcSens'></span>

<h3>Description</h3>

<p>This function provides a comparison of two correlated markers in terms of their sensitivities at a given specificity (for Box-Cox based ROC curves). Markers measurements are assumed to be taken on the same individuals for both markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparebcSens(marker1, marker2, D, atSpec, alpha, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparebcSens_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="comparebcSens_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="comparebcSens_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual, where 0 denotes a healthy/control individual, and 1 denotes a diseased individual.</p>
</td></tr>
<tr><td><code id="comparebcSens_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="comparebcSens_+3A_atspec">atSpec</code></td>
<td>
<p>The value of specificity at which the comparison of sensitivities will take place.</p>
</td></tr>
<tr><td><code id="comparebcSens_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot; it returns the Box-Cox based ROC along with informative information about the two AUCs in the legend of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>resultstable</code></td>
<td>
<p>A summary table of the comparison that contains the sensitivity of each marker at the given specificity, the p-value of the difference using the probit transformation, the p-value of the difference, and the confidence interval of the difference.</p>
</td></tr>
<tr><td><code>Sens1</code></td>
<td>
<p>The sensitivity at the selected specificity for the first marker.</p>
</td></tr>
<tr><td><code>Sens2</code></td>
<td>
<p>The sensitivity at the selected specificity for the second marker.</p>
</td></tr>
<tr><td><code>pvalue_probit_difference</code></td>
<td>
<p>The p-value for the comparison of the sensitivities. It employs the probit transformation that has greater power than when not using it (as in pvalue_difference).</p>
</td></tr>
<tr><td><code>pvalue_difference</code></td>
<td>
<p>The p-value for the comparisons of the sensitivities (without the probit transformation). Simulations have shown that this is inferior to the ‘pvalue_probit_difference’.</p>
</td></tr>
<tr><td><code>CI_difference</code></td>
<td>
<p>The confidence interval for the difference of the sensitivities.</p>
</td></tr>
<tr><td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td></tr>
<tr><td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE SOME BIVARIATE DATA===

set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1,   0.5,
               0.5,  1),
             nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X=mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1,   0.6,
               0.6,  1.1),
             nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y=mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx=pracma::zeros(nx,1)
dy=pracma::ones(ny,1)

markers=rbind(X,Y);
marker1=markers[,1]
marker2=markers[,2]
D=c(rbind(dx,dy))

#===COMPARE THE Sensitivities of Marker 1 vs Marker 2

out=comparebcSens(marker1=marker1, marker2=marker2, D=D, alpha =0.05, atSpec=0.8, plots="on")
summary(out)
</code></pre>

<hr>
<h2 id='comparebcSpec'>
Performs inference to compare the specificities of two correlated (or uncorrelated) Box-Cox transformed biomarkers at a given sensitivity and a given nominal level
</h2><span id='topic+comparebcSpec'></span>

<h3>Description</h3>

<p>This function provides a comparison of two correlated markers in terms of their specificity at a given sensitivity (for Box-Cox based ROC curves). Marker measurements are assumed to be taken on the same individuals for both markers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comparebcSpec(marker1, marker2, D, atSens, alpha, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comparebcSpec_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="comparebcSpec_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="comparebcSpec_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual, where 0 denotes a healthy/control individual, and 1 denotes a diseased individual.</p>
</td></tr>
<tr><td><code id="comparebcSpec_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="comparebcSpec_+3A_atsens">atSens</code></td>
<td>
<p>The value of sensitivity at which the comparison of specificities will take place.</p>
</td></tr>
<tr><td><code id="comparebcSpec_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot; it returns the Box-Cox based ROC along with informative information about the two AUCs in the legend of the plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>resultstable</code></td>
<td>
<p>A summary table of the comparison that contains the FPR of each marker at the given sensitivity, the p-value of the difference using the probit transformation, the p-value of the difference, and the confidence interval of the difference.</p>
</td></tr>
<tr><td><code>Spec1</code></td>
<td>
<p>The specificity at the selected sensitivity for the first marker.</p>
</td></tr>
<tr><td><code>Spec2</code></td>
<td>
<p>The specificity at the selected sensitivity for the second marker.</p>
</td></tr>
<tr><td><code>pvalue_probit_difference</code></td>
<td>
<p>The p-value for the comparison of the specificities. It employs the probit transformation that has greater power than when not using it (as in pvalue_difference).</p>
</td></tr>
<tr><td><code>pvalue_difference</code></td>
<td>
<p>The p-value for the comparisons of the specificities (without the probit transformation). Simulations have shown that this is inferior to the ‘pvalue_probit_difference’.</p>
</td></tr>
<tr><td><code>CI_difference</code></td>
<td>
<p>The confidence interval for the difference of the specificities.</p>
</td></tr>
<tr><td><code>roc1</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>roc2</code></td>
<td>
<p>A function that refers to the ROC of the first marker. It allows the user to feed in FPR values and the corresponding TPR values.</p>
</td></tr>
<tr><td><code>transx1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy1</code></td>
<td>
<p>The Box-Cox transformed scores for the first marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.1</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 1.</p>
</td></tr>
<tr><td><code>transx2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the healthy group.</p>
</td></tr>
<tr><td><code>transy2</code></td>
<td>
<p>The Box-Cox transformed scores for the second marker and the diseased group.</p>
</td></tr>
<tr><td><code>transformation.parameter.2</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda) for marker 2.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#GENERATE SOME BIVARIATE DATA===

set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1,   0.5,
               0.5,  1),
             nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X=mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1,   0.6,
               0.6,  1.1),
             nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y=mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx=pracma::zeros(nx,1)
dy=pracma::ones(ny,1)

markers=rbind(X,Y);
marker1=markers[,1]
marker2=markers[,2]
D=c(rbind(dx,dy))

#===COMPARE THE Specificities of Marker 1 vs Marker 2

out=comparebcSpec(marker1=marker1, marker2=marker2, D=D, alpha =0.05, atSens=0.8, plots="on")
summary(out)
</code></pre>

<hr>
<h2 id='rocboxcox'>
Comprehensive Box-Cox ROC analysis for a single marker
</h2><span id='topic+rocboxcox'></span>

<h3>Description</h3>

<p>This function applies the Box-Cox transformation to provide a comprehensive ROC analysis that involves the AUC (and its CI), the maximized Youden index (and its CI), the optimized Youden based cutoff (and its CI), and joint confidence regions for the optimized pair of sensitivity and specificity. Cutoffs are back-transformed so that they lie on the original scale of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rocboxcox(marker, D, alpha, plots, printProgress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rocboxcox_+3A_marker">marker</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals.</p>
</td></tr>
<tr><td><code id="rocboxcox_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="rocboxcox_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="rocboxcox_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, the function returns a comprehensive figure with the ROC estimate and several point estimates: AUC, Youden index, optimized Youden cutoff, and the Youden based sensitivty and specificity along with the corresponding marginal confidence intervals and the joint confidence region of the estimated sensitivity and specificity.</p>
</td></tr>
<tr><td><code id="rocboxcox_+3A_printprogress">printProgress</code></td>
<td>
<p>Boolean. When set to TRUE, messages describing the progress of the bootstrapping will be printed to the console window. When set to FALSE, these messages are suppressed. Default value is FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>transx</code></td>
<td>
<p>The Box-Cox transformed scores for the healthy.</p>
</td></tr>
<tr><td><code>transy</code></td>
<td>
<p>The Box-Cox transformed scores for the diseased.</p>
</td></tr>
<tr><td><code>transformation.parameter</code></td>
<td>
<p>The estimated Box-Cox transformation parameter (lambda).</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>The estimated area under the Box-Cox based ROC curve.</p>
</td></tr>
<tr><td><code>AUCCI</code></td>
<td>
<p>The (1-a)100% CI for the AUC. This CI is based on probit transforming the AUC estimate, finding the CI on the real line, and then back-transforming its endpoints to the ROC space.</p>
</td></tr>
<tr><td><code>pvalueAUC</code></td>
<td>
<p>The corresponding p-value for the AUC estimate.</p>
</td></tr>
<tr><td><code>J</code></td>
<td>
<p>The maximized Youden index.</p>
</td></tr>
<tr><td><code>JCI</code></td>
<td>
<p>The corresponding CI for maximized Youden index. For this CI consider we consider the probit transformation and then back-transform its endpoints to derive a 95% CI for the Youden index itself.</p>
</td></tr>
<tr><td><code>pvalueJ</code></td>
<td>
<p>The corresponding two-tailed p-value for the maximized Youden index.</p>
</td></tr>
<tr><td><code>Sens</code></td>
<td>
<p>The sensitivity that corresponds to the Youden based optimized cutoff.</p>
</td></tr>
<tr><td><code>CImarginalSens</code></td>
<td>
<p>the marginal (1-a)100% CI for the sensitivity that corresponds to the Youden based optimized cutoff. This is derived by first employing the probit transformation, finding a CI on the real line, and then back-transforming its endpoints to the ROC space.</p>
</td></tr>
<tr><td><code>Spec</code></td>
<td>
<p>The Specificity that corresponds to the Youden based optimized cutoff.</p>
</td></tr>
<tr><td><code>CImarginalSpec</code></td>
<td>
<p>The marginal (1-a)100% CI for the specificity that corresponds to the Youden based optimized cutoff. This is derived by first employing the probit transformation, finding a CI on the real line, and then backtransforming its endpoints to the ROC space.</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p>The Youden-based optimized cutoff.</p>
</td></tr>
<tr><td><code>CIcutoff</code></td>
<td>
<p>The (1-a)100% CI for the Youden-based optimized cutoff. This is based on the bootstrap. It involves using the Box-Cox transformation for every bootstrap iteration and then using the inverse Box-Cox transformation to obtain the cutoff on its original scale.</p>
</td></tr>
<tr><td><code>areaegg</code></td>
<td>
<p>The area of the (1-a)100% egg-shaped joint confidence region that refers to the optimized pair of sensitivity and specificity. This takes into account the fact that the estimated sensitivity and specificity are correlated as opposed to the corresponding rectangular area that ignores this.</p>
</td></tr>
<tr><td><code>arearect</code></td>
<td>
<p>The area of the (1-a)100% rectangular joint confidence region that refers to the optimized pair of sensitivity and specificity. This ignores the correlation of the optimized sensitivity and specificity and tends to yield a larger area compared to the one of the egg-shaped region.</p>
</td></tr>
<tr><td><code>mxlam</code></td>
<td>
<p>The mean of the marker scores of the healthy group after the Box-Cox transformation.</p>
</td></tr>
<tr><td><code>sxlam</code></td>
<td>
<p>The standard deviation of the marker scores of the healthy group after the Box-Cox transformation.</p>
</td></tr>
<tr><td><code>mylam</code></td>
<td>
<p>The mean of the marker scores of the diseased group after the Box-Cox transformation.</p>
</td></tr>
<tr><td><code>sylam</code></td>
<td>
<p>The standard deviation of the marker scores of the diseased group after the Box-Cox transformation.</p>
</td></tr>
<tr><td><code>results</code></td>
<td>
<p>A table that provides some indicative results: the AUC, the J (maximized Youden index), the estimated cutoff, the sensitivity, and the specificity along with their marginal CIs.</p>
</td></tr>
<tr><td><code>roc</code></td>
<td>
<p>A function of the estimated Box-Cox ROC curve. You can use this to simply request TPR values for given FPR values.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Nakas CT, Reiser B. (2014). Construction of confidence regions in the ROC space after the estimation of the optimal Youden index-based cut-off point. Biometrics, 70(1):212-223. doi: https://doi.org/10.1111/biom.12107
</p>
<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x=rgamma(100, shape=2, rate = 8)
y=rgamma(100, shape=2, rate = 4)
scores=c(x,y)
D=c(pracma::zeros(1,100), pracma::ones(1,100))
out=rocboxcox(marker=scores,D, 0.05, plots="on")
</code></pre>

<hr>
<h2 id='rocboxcoxCI'>
Inference around the sensitivity at a given specificity (and vice versa) for a single Box-Cox transformed biomarker
</h2><span id='topic+rocboxcoxCI'></span>

<h3>Description</h3>

<p>This function applies the Box-Cox transformation and provides the ability to do inferences for the sensitivity at a given specificity (and vice versa).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rocboxcoxCI(marker, D, givenSP, givenSE, alpha, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rocboxcoxCI_+3A_marker">marker</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals.</p>
</td></tr>
<tr><td><code id="rocboxcoxCI_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual, where 0 denotes a healthy/control individual, and 1 denotes a diseased individual.</p>
</td></tr>
<tr><td><code id="rocboxcoxCI_+3A_givensp">givenSP</code></td>
<td>
<p>A vector of specificity values that the user wants to fix/set, at which the sensitivity is to be estimated. In this case, the ‘givenSE’ argument needs to be set to NA.</p>
</td></tr>
<tr><td><code id="rocboxcoxCI_+3A_givense">givenSE</code></td>
<td>
<p>A vector of sensitivity values that the user want to fix/set, at which the specificity is to be estimated. In this case, the ‘givenSP’ argument needs to be set to NA.</p>
</td></tr>
<tr><td><code id="rocboxcoxCI_+3A_alpha">alpha</code></td>
<td>
<p>Nominal level used to calculate the confidence intervals. A common choice is 0.05.</p>
</td></tr>
<tr><td><code id="rocboxcoxCI_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, it returns both (1) the Box-Cox based ROC plot along with pointwise 95% confidence intervals for the full spectrum of FPRs and (2) a second plot that visualizes the confidence intervals at the given sensitivities or specificities.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>SPandCIs</code></td>
<td>
<p>The specificity values and the CIs around them.</p>
</td></tr>
<tr><td><code>SEandCIs</code></td>
<td>
<p>The sensitivity values and the CIs around them.</p>
</td></tr>
<tr><td><code>SEvalues</code></td>
<td>
<p>The sensitivity values provided by the user at which the specificity was calculated. If the user did not provide any sensitivity values, this argument should be set to NA.</p>
</td></tr>
<tr><td><code>SPvalues</code></td>
<td>
<p>The specificity values provided by the user at which the sensitivity was calculated. If the user did not provide any specificity values, this argument should be set to NA.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Bantis LE, Feng Z. (2016). Comparison of two correlated ROC curves at a given specificity or sensitivity level. Statistics in Medicine, 35(24):4352-4367. https://doi.org/10.1002/sim.7008
</p>
<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x &lt;- rgamma(100, shape=2, rate = 8)
y &lt;- rgamma(100, shape=2, rate = 4)
scores &lt;- c(x,y)
D=c(pracma::zeros(1,100), pracma::ones(1,100))
givenSP=c(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9)
givenSE=NA
out=rocboxcoxCI(marker=scores, D, givenSP=givenSP, givenSE=NA, alpha=0.05, plots="on")
</code></pre>

<hr>
<h2 id='threerocs'>
Provides visual comparison of three ROC estimation methods (one-marker version)
</h2><span id='topic+threerocs'></span>

<h3>Description</h3>

<p>This function provides a visual comparison of the Empirical ROC, the Box-Cox ROC, and the Metz binormal semi-parametric estimator of the ROC curve. It also computes the AUC for the curve corresponding to each method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threerocs(marker, D, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="threerocs_+3A_marker">marker</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals.</p>
</td></tr>
<tr><td><code id="threerocs_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="threerocs_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, the user gets a single plot containing the estimated ROC curves using the Empirical, Box-Cox, and Metz methods for each of the two provided markers.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>AUC_Empirical</code></td>
<td>
<p>The AUC of the empirical ROC curve.</p>
</td></tr>
<tr><td><code>AUC_Metz</code></td>
<td>
<p>The AUC of the Metz binormal curve (as calculated by MRMCaov package using the &quot;binormal&quot; option).</p>
</td></tr>
<tr><td><code>AUC_BoxCox</code></td>
<td>
<p>The AUC of the Box-Cox based ROC curve.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>
<p>Smith BJ, Hillis SL, Pesce LL (2023). MCMCaov: Multi-Reader Multi-Case Analysis of Variance. R package version 0.3.0, https://github.com/brian-j-smith/MRMCaov.
</p>
<p>Smith BJ, Hillis SL (2020). “Multi-reader multi-case analysis of variance software for diagnostic performance comparison of imaging modalities.” In Samuelson F, Taylor-Phillips S (eds.), Proceedings of SPIE 11316, Medical Imaging 2020: Image Perception, Observer Performance, and Technology Assessment, 113160K. doi:10.1117/12.2549075, https://pubmed.ncbi.nlm.nih.gov/32351258.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)
x &lt;- rgamma(100, shape=2, rate = 8) # generates biomarker data from a gamma
                                 # distribution for the healthy group.
y &lt;- rgamma(100, shape=2, rate = 4) # generates biomarker data from a gamma
                                 # distribution for the diseased group.
scores &lt;- c(x,y)
D=c(pracma::zeros(1,100), pracma::ones(1,100))
out=threerocs(marker=scores, D, plots="on")
summary(out)
</code></pre>

<hr>
<h2 id='threerocs2'>
Provides visual comparison of three ROC estimation methods (two-marker version)
</h2><span id='topic+threerocs2'></span>

<h3>Description</h3>

<p>This function provides a visual comparison of the Empirical ROC, the Box-Cox ROC, and the Metz binormal semi-parametric estimator of the ROC curve. It also computes the AUC for the curve corresponding to each method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>threerocs2(marker1, marker2, D, plots)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="threerocs2_+3A_marker1">marker1</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the first marker.</p>
</td></tr>
<tr><td><code id="threerocs2_+3A_marker2">marker2</code></td>
<td>
<p>A vector of length n that contains the biomarker scores of all individuals for the second marker.</p>
</td></tr>
<tr><td><code id="threerocs2_+3A_d">D</code></td>
<td>
<p>A vector of length n that contains the true disease status of an individual. It is a binary vector containing 0 for the healthy/control individuals and 1 for the diseased individuals.</p>
</td></tr>
<tr><td><code id="threerocs2_+3A_plots">plots</code></td>
<td>
<p>Valid inputs are &quot;on&quot; and &quot;off&quot;. When set to &quot;on&quot;, the user gets a single plot containing the estimated ROC curves using the Empirical, Box-Cox, and Metz methods for each of the two provided markers.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>AUC_Empirical1</code></td>
<td>
<p>The AUC of the empirical ROC curve for the first marker.</p>
</td></tr>
<tr><td><code>AUC_Empirical2</code></td>
<td>
<p>The AUC of the empirical ROC curve for the second marker.</p>
</td></tr>
<tr><td><code>AUC_Metz1</code></td>
<td>
<p>The AUC of the Metz binormal curve (as calculated by MRMCaov package using the &quot;binormal&quot; option) for the first marker.</p>
</td></tr>
<tr><td><code>AUC_Metz2</code></td>
<td>
<p>The AUC of the Metz binormal curve (as calculated by MRMCaov package using the &quot;binormal&quot; option) for the second marker.</p>
</td></tr>
<tr><td><code>AUC_BoxCox1</code></td>
<td>
<p>The AUC of the Box-Cox based ROC curve for the first marker.</p>
</td></tr>
<tr><td><code>AUC_BoxCox2</code></td>
<td>
<p>The AUC of the Box-Cox based ROC curve for the second marker.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Leonidas Bantis
</p>


<h3>References</h3>

<p>Box GEP, Cox DR. (1964). An Analysis of Transformations. Journal of the Royal Statistical Society. 26(2):211-252. https://www.jstor.org/stable/2984418
</p>
<p>Smith BJ, Hillis SL, Pesce LL (2023). MCMCaov: Multi-Reader Multi-Case Analysis of Variance. R package version 0.3.0, https://github.com/brian-j-smith/MRMCaov.
</p>
<p>Smith BJ, Hillis SL (2020). “Multi-reader multi-case analysis of variance software for diagnostic performance comparison of imaging modalities.” In Samuelson F, Taylor-Phillips S (eds.), Proceedings of SPIE 11316, Medical Imaging 2020: Image Perception, Observer Performance, and Technology Assessment, 113160K. doi:10.1117/12.2549075, https://pubmed.ncbi.nlm.nih.gov/32351258.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(123)

nx &lt;- 100
Sx &lt;- matrix(c(1, 0.5, 0.5, 1), nrow = 2, ncol = 2)

mux &lt;- c(X = 10, Y = 12)
X = mvtnorm::rmvnorm(nx, mean = mux, sigma = Sx)

ny &lt;- 100
Sy &lt;- matrix(c(1.1, 0.6, 0.6, 1.1), nrow = 2, ncol = 2)

muy &lt;- c(X = 11, Y = 13.7)
Y = mvtnorm::rmvnorm(ny, mean = muy, sigma = Sy)

dx = pracma::zeros(nx,1)
dy = pracma::ones(ny,1)

markers = rbind(X,Y);
marker1 = markers[,1]
marker2 = markers[,2]
D = c(rbind(dx,dy))

out=threerocs2(marker1, marker2, D, plots = "on")
summary(out)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
