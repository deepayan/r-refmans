<!DOCTYPE html><html><head><title>Help for package mr.pivw</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mr.pivw}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BF_distr'><p>Generate bootstrap samples for the bootstrapping Fieller's confidence interval</p></a></li>
<li><a href='#example'><p>Data example</p></a></li>
<li><a href='#mr.pivw'><p>The penalized inverse-variance weighted estimator for Mendelian randomization</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Penalized Inverse-Variance Weighted Estimator for Mendelian
Randomization</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Siqi Xu</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Siqi Xu &lt;sqxu@hku.hk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The penalized inverse-variance weighted (pIVW) estimator is a Mendelian randomization method for estimating the causal effect of an exposure variable on an outcome of interest based on summary-level GWAS data. The pIVW estimator accounts for weak instruments and balanced horizontal pleiotropy simultaneously. See Xu S., Wang P., Fung W.K. and Liu Z. (2022) &lt;<a href="https://doi.org/10.1111%2Fbiom.13732">doi:10.1111/biom.13732</a>&gt;.  </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-09 09:10:24 UTC; ckhsu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-09 09:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BF_distr'>Generate bootstrap samples for the bootstrapping Fieller's confidence interval</h2><span id='topic+BF_distr'></span>

<h3>Description</h3>

<p>This function is used to generate bootstrap samples for the bootstrapping Fieller's confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  BF_distr(data,beta_hat,tau2,lambda,n_boot=1000,seed_boot=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BF_distr_+3A_data">data</code></td>
<td>
<p>A matrix or data frame consists of four columns: the 1st (2nd) column contains the estimated genetic effects on the outcome (exposure); the 3rd (4th) column contains the estimated standard errors of the estimated genetic effects on the outcome (exposure).</p>
</td></tr>
<tr><td><code id="BF_distr_+3A_beta_hat">beta_hat</code></td>
<td>
<p>The estimated causal effect.</p>
</td></tr>
<tr><td><code id="BF_distr_+3A_tau2">tau2</code></td>
<td>
<p>The estimated variance of the horizontal pleiotropy.</p>
</td></tr>
<tr><td><code id="BF_distr_+3A_lambda">lambda</code></td>
<td>
<p>The penalty parameter in the pIVW estimator. The penalty parameter plays a role in the bias-variance trade-off of the estimator.</p>
</td></tr>
<tr><td><code id="BF_distr_+3A_n_boot">n_boot</code></td>
<td>
<p>The sample size of the bootstrap samples. By default, n_boot=1000.</p>
</td></tr>
<tr><td><code id="BF_distr_+3A_seed_boot">seed_boot</code></td>
<td>
<p>The seed for random sampling in the bootstrap method. By default, seed_boot=1.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>z_b</code></td>
<td>
<p>A vector containing the bootstrap samples for the bootstrapping Fieller's confidence interval.</p>
</td></tr>
</table>

<hr>
<h2 id='example'>Data example</h2><span id='topic+example'></span>

<h3>Description</h3>

<p>A matrix contains four columns: the 1st (2nd) column contains the estimated genetic effects on the outcome (exposure); the 3rd (4th) column contains the estimated standard errors of the estimated genetic effects on the outcome (exposure).
</p>

<hr>
<h2 id='mr.pivw'>The penalized inverse-variance weighted estimator for Mendelian randomization</h2><span id='topic+mr.pivw'></span>

<h3>Description</h3>

<p>The penalized inverse-variance weighted (pIVW) estimator is a Mendelian randomization method for estimating the causal effect of an exposure variable on an outcome of interest based on summary-level GWAS data. The pIVW estimator accounts for weak instruments and balanced horizontal pleiotropy simultaneously.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  mr.pivw(data,lambda=1,plei=TRUE,sel.pval=NULL,delta=0,Boot.Fieller=TRUE,sig=0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mr.pivw_+3A_data">data</code></td>
<td>
<p>A matrix or data frame consists of four columns. The 1st and 2nd columns contain the SNP effects on the outcome and the exposure, respectively. The 3rd and 4th columns contain the standard errors of the SNP effects on the outcome and the exposure, respectively.</p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_lambda">lambda</code></td>
<td>
<p>The penalty parameter in the pIVW estimator. The penalty parameter plays a role in the bias-variance trade-off of the estimator. It is recommended to choose lambda=1 to achieve smallest bias and valid inference. By default, lambda=1.</p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_plei">plei</code></td>
<td>
<p>If plei=TRUE, then the horizontal pleiotropy will be taken into account in the pIVW estimator. By default, plei=TRUE.</p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_sel.pval">sel.pval</code></td>
<td>
<p>A vector containing the P values of the SNP effects on the exposure, which will be used for the IV selection. &quot;sel.pval&quot; should be provided when &quot;delta&quot; is not zero.</p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_delta">delta</code></td>
<td>
<p>The z-score threshold for IV selection. By default, delta=0 (i.e., no IV selection will be conducted).</p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_boot.fieller">Boot.Fieller</code></td>
<td>
<p>If Boot.Fieller=TRUE, then the P value and the confidence interval of the causal effect based on the bootstrapping Fieller method will be calculated. By default, Boot.Fieller=TRUE. </p>
</td></tr>
<tr><td><code id="mr.pivw_+3A_sig">sig</code></td>
<td>
<p>The 100(1-sig)% confidence interval of the causal effect is calculated. By default, sig=0.05.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>beta.hat</code></td>
<td>
<p>The estimated causal effect of the exposure on the outcome</p>
</td></tr>
<tr><td><code>beta.se</code></td>
<td>
<p>The estimated standard error of beta.hat</p>
</td></tr>
<tr><td><code>pval (Normal)</code></td>
<td>
<p>The P value for testing whether the causal effect is zero, which is based on the normal approximation.</p>
</td></tr>
<tr><td><code>CI (Normal)</code></td>
<td>
<p>The confidence interval of the causal effect based on the normal approximation.</p>
</td></tr>
<tr><td><code>pval (Bootstrap Fieller)</code></td>
<td>
<p>The P value for testing whether the causal effect is zero, which is based on the bootstrapping Fieller method.</p>
</td></tr>
<tr><td><code>CI (Bootstrap Fieller)</code></td>
<td>
<p>The confidence interval of the causal effect based on the bootstrapping Fieller method.</p>
</td></tr>
<tr><td><code>tau2</code></td>
<td>
<p>The variance of the horizontal pleiotropy. tau2 is calculated by using all IVs in the data before conducting the IV selection.</p>
</td></tr>
<tr><td><code>eta</code></td>
<td>
<p>The estimated effective sample size. It is recommended to be greater than 5 for pIVW to achieve reliable asymptotic properties.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Xu S., Wang P., Fung W.K. and Liu Z. (2022). A Novel Penalized Inverse-Variance Weighted Estimator for Mendelian Randomization with Applications to COVID-19 Outcomes. Biometrics. &lt;doi:10.1111/biom.13732&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  mr.pivw(data=example)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
