<!DOCTYPE html><html lang="en"><head><title>Help for package clc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as_raster'><p>Convert a 'clc' Object to Raster Format</p></a></li>
<li><a href='#clc'><p>'clc' S3 Class</p></a></li>
<li><a href='#clc_codes'><p>CLC Codes</p></a></li>
<li><a href='#copy_to'><p>Copy a Style to a GeoPackage or PostGIS Database</p></a></li>
<li><a href='#cut_to_extent'><p>Clip the Layer with a Polygon</p></a></li>
<li><a href='#get_colors.clc'><p>Retrieve Colors from a CLC Style Definition</p></a></li>
<li><a href='#get_levels.clc'><p>Retrieve Levels from a CLC Style Definition</p></a></li>
<li><a href='#get_raster'><p>Retrieve a Raster Representation of CLC</p></a></li>
<li><a href='#plot_clc'><p>Plot CLC Layer</p></a></li>
<li><a href='#prepare_plot'><p>Prepare a Plot for CLC Vectorial Data</p></a></li>
<li><a href='#safe_clip_multipoligon'><p>Safely Clip a Multipolygon Vector Layer</p></a></li>
<li><a href='#save_to'><p>Save a Layer and its Style to a GeoPackage or PostGIS Database</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>CORINE Land Cover Data and Styles</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Streamline the management, analysis, and visualization of
    CORINE Land Cover data. Addresses challenges associated with its
    classification system and related styles, such as color mappings and
    descriptive labels.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://josesamos.github.io/clc/">https://josesamos.github.io/clc/</a>, <a href="https://github.com/josesamos/clc">https://github.com/josesamos/clc</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/josesamos/clc/issues">https://github.com/josesamos/clc/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>gdalUtilities, ggplot2, rlang, RPostgres, sf, stats, terra,
xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, mockery, purrr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-09 05:41:34 UTC; jsamos</td>
</tr>
<tr>
<td>Author:</td>
<td>Jose Samos <a href="https://orcid.org/0000-0002-4457-3439"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre],
  Universidad de Granada [cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jose Samos &lt;jsamos@ugr.es&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-10 21:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='as_raster'>Convert a 'clc' Object to Raster Format</h2><span id='topic+as_raster'></span><span id='topic+as_raster.clc'></span>

<h3>Description</h3>

<p>Returns an object of class 'clc_raster' that contains a 'terra::SpatRaster' raster
object representing the converted vector layer into raster format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_raster(clo, base_raster, resolution)

## S3 method for class 'clc'
as_raster(clo, base_raster = NULL, resolution = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_raster_+3A_clo">clo</code></td>
<td>
<p>A 'clc' object.</p>
</td></tr>
<tr><td><code id="as_raster_+3A_base_raster">base_raster</code></td>
<td>
<p>(Optional) A raster object to use as the base for rasterization.</p>
</td></tr>
<tr><td><code id="as_raster_+3A_resolution">resolution</code></td>
<td>
<p>(Optional) Numeric resolution to define the raster grid.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function requires either 'base_raster' or 'resolution' to be provided.
If both are missing, an error is raised.
</p>


<h3>Value</h3>

<p>An object of class 'clc_raster'.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

raster_path &lt;- system.file("extdata", "mdt.tif", package = "clc")
base_raster &lt;- terra::rast(raster_path)

# ex1
r &lt;- clo |&gt;
     as_raster(base_raster = base_raster)

# ex2
r &lt;- clo |&gt;
     as_raster(resolution = 50)

</code></pre>

<hr>
<h2 id='clc'>'clc' S3 Class</h2><span id='topic+clc'></span>

<h3>Description</h3>

<p>Create an object of class 'clc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clc(source, layer_name, field = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clc_+3A_source">source</code></td>
<td>
<p>The source of the vector layer. This can be:
- A string representing the path to a GeoPackage file.
- A 'DBI' database connection object to a PostGIS database, created using [RPostgres::dbConnect()].</p>
</td></tr>
<tr><td><code id="clc_+3A_layer_name">layer_name</code></td>
<td>
<p>The name of the layer in the source to be used.</p>
</td></tr>
<tr><td><code id="clc_+3A_field">field</code></td>
<td>
<p>(Optional) A string, the layer field that contains CLC codes. If NULL,
the function will attempt to locate the column containing the CLC codes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates an object of class 'clc' from a vector layer in either
a GeoPackage or a PostGIS database.
</p>
<p>The layer must have a style defined in the source.
</p>


<h3>Value</h3>

<p>An object of class 'clc'.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># ex1
source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

## Not run: 
# ex2
conn &lt;- RPostgres::dbConnect(
  RPostgres::Postgres(),
  dbname = 'exampledb',
  host = 'localhost',
  port = '5432',
  user = 'user',
  password = 'password'
)
clo &lt;- clc(source = conn, layer_name = "clc")

## End(Not run)
</code></pre>

<hr>
<h2 id='clc_codes'>CLC Codes</h2><span id='topic+clc_codes'></span>

<h3>Description</h3>

<p>Each code represents a specific category at the most detailed level (Level 3)
of the CLC system.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clc_codes
</code></pre>


<h3>Format</h3>

<p>A vector of strings.
</p>

<hr>
<h2 id='copy_to'>Copy a Style to a GeoPackage or PostGIS Database</h2><span id='topic+copy_to'></span><span id='topic+copy_to.clc'></span>

<h3>Description</h3>

<p>This function copies a style to the specified layers in a GeoPackage file or
a PostGIS database. The destination is determined by the 'to' argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>copy_to(clo, to, database, schema, layers)

## S3 method for class 'clc'
copy_to(clo, to, database = NULL, schema = "public", layers = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="copy_to_+3A_clo">clo</code></td>
<td>
<p>A 'clc' object.</p>
</td></tr>
<tr><td><code id="copy_to_+3A_to">to</code></td>
<td>
<p>A data destination for the output. This can be:
- A string representing the path to a GeoPackage file.
- A 'DBI' database connection object to a PostGIS database, created using [RPostgres::dbConnect()].</p>
</td></tr>
<tr><td><code id="copy_to_+3A_database">database</code></td>
<td>
<p>A string, database name, only in case the destination is in PostGIS.</p>
</td></tr>
<tr><td><code id="copy_to_+3A_schema">schema</code></td>
<td>
<p>A string, schema name, only in case the destination is in PostGIS.
Defaults to ''public''.</p>
</td></tr>
<tr><td><code id="copy_to_+3A_layers">layers</code></td>
<td>
<p>An optional character vector specifying the names of layers in the
destination to which the styles should be applied. If 'NULL' (default), applies
the style to all layers.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>clo A 'clc' object.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

out_gpkg &lt;- tempfile(fileext = ".gpkg")
clo &lt;- clo |&gt;
  save_to(out_gpkg)

# ex1
clo &lt;- clo |&gt;
  copy_to(out_gpkg, layers = 'clc')

## Not run: 
conn &lt;- RPostgres::dbConnect(
  RPostgres::Postgres(),
  dbname = 'exampledb',
  host = 'localhost',
  port = '5432',
  user = 'user',
  password = 'password'
)
clo &lt;- clo |&gt;
  save_to(conn, 'exampledb')

# ex2
clo &lt;- clo |&gt;
  copy_to(conn, 'exampledb', layers = 'clc')

## End(Not run)
</code></pre>

<hr>
<h2 id='cut_to_extent'>Clip the Layer with a Polygon</h2><span id='topic+cut_to_extent'></span><span id='topic+cut_to_extent.clc'></span>

<h3>Description</h3>

<p>This function clips the object layer using a polygon layer. It handles CRS
transformations automatically if necessary, ensuring the output is in the same
CRS as the input polygon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cut_to_extent(clo, polygon)

## S3 method for class 'clc'
cut_to_extent(clo, polygon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cut_to_extent_+3A_clo">clo</code></td>
<td>
<p>A 'clc' object.</p>
</td></tr>
<tr><td><code id="cut_to_extent_+3A_polygon">polygon</code></td>
<td>
<p>An 'sf' object representing the polygon layer used for clipping.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'clc' object.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

polygon &lt;- sf::st_read(source_gpkg, layer = 'lanjaron', quiet = TRUE)

clo2 &lt;- clo |&gt;
        cut_to_extent(polygon)

</code></pre>

<hr>
<h2 id='get_colors.clc'>Retrieve Colors from a CLC Style Definition</h2><span id='topic+get_colors.clc'></span><span id='topic+get_colors'></span><span id='topic+get_colors.clc_category'></span><span id='topic+get_colors.clc_raster'></span>

<h3>Description</h3>

<p>This function extracts the color values associated with a CLC style definition.
It returns a character vector containing the 'color' field from the CLC style definition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clc'
get_colors(clo)

get_colors(clo)

## S3 method for class 'clc_category'
get_colors(clo)

## S3 method for class 'clc_raster'
get_colors(clo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_colors.clc_+3A_clo">clo</code></td>
<td>
<p>A 'clc_category' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of colors.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

levels &lt;- clo |&gt;
  get_colors()

</code></pre>

<hr>
<h2 id='get_levels.clc'>Retrieve Levels from a CLC Style Definition</h2><span id='topic+get_levels.clc'></span><span id='topic+get_levels'></span><span id='topic+get_levels.clc_category'></span><span id='topic+get_levels.clc_raster'></span>

<h3>Description</h3>

<p>This function extracts the levels values associated with a CLC style definition.
It returns a data frame that contains the fields 'id', 'description', and 'color'
from the CLC style definition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clc'
get_levels(clo)

get_levels(clo)

## S3 method for class 'clc_category'
get_levels(clo)

## S3 method for class 'clc_raster'
get_levels(clo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_levels.clc_+3A_clo">clo</code></td>
<td>
<p>A CLC object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with columns:
- 'id': The identifier of the category.
- 'description': A textual description of the category.
- 'color': The color associated with the category.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

levels &lt;- clo |&gt;
  get_levels()

</code></pre>

<hr>
<h2 id='get_raster'>Retrieve a Raster Representation of CLC</h2><span id='topic+get_raster'></span><span id='topic+get_raster.clc_raster'></span>

<h3>Description</h3>

<p>Retrieve a raster representation ('terra::SpatRaster') from a CLC object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_raster(clo)

## S3 method for class 'clc_raster'
get_raster(clo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_raster_+3A_clo">clo</code></td>
<td>
<p>A 'clc_raster' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'terra::SpatRaster' object.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

r &lt;- clo |&gt;
     as_raster(resolution = 50)

clc_r &lt;- r |&gt;
         get_raster()

</code></pre>

<hr>
<h2 id='plot_clc'>Plot CLC Layer</h2><span id='topic+plot_clc'></span><span id='topic+plot_clc.clc'></span><span id='topic+plot_clc.clc_raster'></span>

<h3>Description</h3>

<p>Plot CLC data stored in objects of supported classes. The function adapts the plot
based on the class of the input data (vectorial or raster format).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_clc(clo, ...)

## S3 method for class 'clc'
plot_clc(clo, ...)

## S3 method for class 'clc_raster'
plot_clc(clo, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_clc_+3A_clo">clo</code></td>
<td>
<p>An object containing CLC data. This must be an instance of a supported class, such as:
- A vectorial CLC data object (e.g., 'clc' object).
- A raster CLC data object (e.g., 'clc_raster').</p>
</td></tr>
<tr><td><code id="plot_clc_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 'terra::plot' function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the raster version, the 'terra::plot' function is used with the 'col' parameter
configured, while all other parameters supported by the function can also be defined (using '...').
</p>
<p>For the vector version, 'ggplot2::ggplot' is used, and by using the 'prepare_plot' function
instead of this one ('plot_clc'), further customization can be applied as needed.
</p>


<h3>Value</h3>

<p>A 'ggplot2' object or a 'terra' plot.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+prepare_plot">prepare_plot</a></code>
</p>
<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

temp_file &lt;- tempfile(fileext = ".png")
png(filename = temp_file, width = 800, height = 600)

clo |&gt;
  plot_clc()

dev.off()

</code></pre>

<hr>
<h2 id='prepare_plot'>Prepare a Plot for CLC Vectorial Data</h2><span id='topic+prepare_plot'></span><span id='topic+prepare_plot.clc'></span>

<h3>Description</h3>

<p>Generates a 'ggplot2' object to visualize CLC Vectorial data. The function
processes the data stored in a 'clc' object, ensuring that the codes field is
mapped correctly to the categories and their associated styles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prepare_plot(clo)

## S3 method for class 'clc'
prepare_plot(clo)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prepare_plot_+3A_clo">clo</code></td>
<td>
<p>A 'clc' object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A 'ggplot2' object ready for rendering.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_clc">plot_clc</a></code>
</p>
<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+save_to">save_to</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

p &lt;- clo |&gt;
  prepare_plot()

levels &lt;- clo |&gt;
  get_levels()

p &lt;- p +
  ggplot2::scale_fill_manual(
    values = stats::setNames(levels$color, levels$id),
    labels = stats::setNames(levels$description, levels$id),
    name = ""
  ) +
  ggplot2::theme(
    legend.position = "right",
    legend.key.height = ggplot2::unit(2, "cm"),
    legend.title = ggplot2::element_text(size = 12),
    legend.text = ggplot2::element_text(size = 10)
  ) +
  ggplot2::theme_minimal()

temp_file &lt;- tempfile(fileext = ".png")
png(filename = temp_file, width = 800, height = 600)

p

dev.off()

</code></pre>

<hr>
<h2 id='safe_clip_multipoligon'>Safely Clip a Multipolygon Vector Layer</h2><span id='topic+safe_clip_multipoligon'></span>

<h3>Description</h3>

<p>This function clips a 'MULTIPOLYGON' vector layer using a polygon layer, handling specific
issues that might arise with geometries encoded incorrectly or containing unknown WKB types.
It serves as a fallback when the 'clip_vector()' function fails due to errors like
'ParseException: Unknown WKB type 12', which is associated with *MULTIPOLYGON* types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>safe_clip_multipoligon(vector, polygon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="safe_clip_multipoligon_+3A_vector">vector</code></td>
<td>
<p>A 'sf' multipolygon vector layer to be clipped.</p>
</td></tr>
<tr><td><code id="safe_clip_multipoligon_+3A_polygon">polygon</code></td>
<td>
<p>A 'sf' polygon layer used as the clipping geometry.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function ensures that the input layer is correctly encoded as 'MULTIPOLYGON' and
uses GDAL utilities for re-encoding if necessary. The output is projected to the CRS
of the clipping polygon.
</p>
<p>This solution is inspired by a discussion on handling WKB type errors in R:
&lt;https://gis.stackexchange.com/questions/389814/r-st-centroid-geos-error-unknown-wkb-type-12&gt;.
</p>


<h3>Value</h3>

<p>A 'sf' vector layer with the clipped geometries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gpkg_path &lt;- system.file("extdata", "clc.gpkg", package = "clc")

clc &lt;- sf::st_read(gpkg_path, layer = "clc")
lanjaron &lt;- sf::st_read(gpkg_path, layer = "lanjaron")

clc_clipped &lt;- safe_clip_multipoligon(clc, lanjaron)

</code></pre>

<hr>
<h2 id='save_to'>Save a Layer and its Style to a GeoPackage or PostGIS Database</h2><span id='topic+save_to'></span><span id='topic+save_to.clc'></span>

<h3>Description</h3>

<p>This function saves a layer and its style to a GeoPackage file or a PostGIS database.
The destination is determined by the 'to' argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_to(clo, to, database, schema, layer_name)

## S3 method for class 'clc'
save_to(clo, to, database = NULL, schema = "public", layer_name = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="save_to_+3A_clo">clo</code></td>
<td>
<p>A 'clc' object.</p>
</td></tr>
<tr><td><code id="save_to_+3A_to">to</code></td>
<td>
<p>A data destination for the output. This can be:
- A string representing the path to a GeoPackage file.
- A 'DBI' database connection object to a PostGIS database, created using [RPostgres::dbConnect()].</p>
</td></tr>
<tr><td><code id="save_to_+3A_database">database</code></td>
<td>
<p>A string, database name, only in case the destination is in PostGIS.</p>
</td></tr>
<tr><td><code id="save_to_+3A_schema">schema</code></td>
<td>
<p>A string, schema name, only in case the destination is in PostGIS.
Defaults to ''public''.</p>
</td></tr>
<tr><td><code id="save_to_+3A_layer_name">layer_name</code></td>
<td>
<p>A character string specifying the name of the layer in the output.
If 'NULL', the name of the input 'layer' is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function overwrites the table if it already exists.
</p>


<h3>Value</h3>

<p>clo A 'clc' object.
</p>


<h3>See Also</h3>

<p>Other CLC class functions: 
<code><a href="#topic+as_raster">as_raster</a>()</code>,
<code><a href="#topic+clc">clc</a>()</code>,
<code><a href="#topic+copy_to">copy_to</a>()</code>,
<code><a href="#topic+cut_to_extent">cut_to_extent</a>()</code>,
<code><a href="#topic+get_colors.clc">get_colors.clc</a>()</code>,
<code><a href="#topic+get_levels.clc">get_levels.clc</a>()</code>,
<code><a href="#topic+get_raster">get_raster</a>()</code>,
<code><a href="#topic+plot_clc">plot_clc</a>()</code>,
<code><a href="#topic+prepare_plot">prepare_plot</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>source_gpkg &lt;- system.file("extdata", "clc.gpkg", package = "clc")
clo &lt;- clc(source = source_gpkg, layer_name = "clc")

# ex1
out_gpkg &lt;- tempfile(fileext = ".gpkg")

sink(tempfile())
clo &lt;- clo |&gt;
  save_to(out_gpkg)
sink()

## Not run: 
# ex2
conn &lt;- RPostgres::dbConnect(
  RPostgres::Postgres(),
  dbname = 'exampledb',
  host = 'localhost',
  port = '5432',
  user = 'user',
  password = 'password'
)
clo &lt;- clo |&gt;
  save_to(conn, 'exampledb')

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
