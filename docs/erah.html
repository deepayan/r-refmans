<!DOCTYPE html><html><head><title>Help for package erah</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {erah}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alignComp'><p>Alignment of compounds</p></a></li>
<li><a href='#alignList'><p>Alignment list</p></a></li>
<li><a href='#compInfo'><p>Information of a Compound</p></a></li>
<li><a href='#computeRIerror'><p>computeRIerror</p></a></li>
<li><a href='#createdt'><p>Creating Experiment Tables</p></a></li>
<li><a href='#createInstrumentalTable'><p>Create Instrumental Table</p></a></li>
<li><a href='#createPhenoTable'><p>Create Phenotype Table</p></a></li>
<li><a href='#dataList'><p>Data list</p></a></li>
<li><a href='#deconvolveComp'><p>Deconvolution of compounds in samples</p></a></li>
<li><a href='#eRah_DB-class'><p>Class <code>"eRah_DB"</code></p></a></li>
<li><a href='#expClasses'><p>expClasses-method</p></a></li>
<li><a href='#export2CEF'><p>Export spectra to CEF</p></a></li>
<li><a href='#export2MSP'><p>Export spectra to MSP</p></a></li>
<li><a href='#findComp'><p>Find a compound</p></a></li>
<li><a href='#identifyComp'><p>Identification of compounds</p></a></li>
<li><a href='#idList'><p>Identification list</p></a></li>
<li><a href='#importGMD'><p>Import MSP files from GMD to R</p></a></li>
<li><a href='#importMSP'><p>Import MSP files to R</p></a></li>
<li><a href='#MetaboSet-class'><p>Class <code>"MetaboSet"</code></p></a></li>
<li><a href='#metaData'><p>metaData-method</p></a></li>
<li><a href='#mslib'><p>MassBank Spectral Library</p></a></li>
<li><a href='#newExp'><p>New Experiment</p></a></li>
<li><a href='#phenoData'><p>phenoData-method</p></a></li>
<li><a href='#plotAlign'><p>Plotting chromatographic profile with and without alignment</p></a></li>
<li><a href='#plotChr'><p>Plotting sample chromatogram</p></a></li>
<li><a href='#plotProfile'><p>Plotting chromatographic profile</p></a></li>
<li><a href='#plotSpectra'><p>Plotting Spectra</p></a></li>
<li><a href='#RawDataParameters-class'><p>Class <code>"RawDataParameters"</code></p></a></li>
<li><a href='#recMissComp'><p>Missing compound recovery</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#sampleInfo'><p>Information of the samples</p></a></li>
<li><a href='#setAlPar'><p>Set Alignment Parameters</p></a></li>
<li><a href='#setDecPar'><p>Set Software Parameters</p></a></li>
<li><a href='#show,MetaboSet-method'><p>Show MetaboSet object</p></a></li>
<li><a href='#showRTRICurve'><p>Show RT-RI curve</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Xavier Domingo-Almenara [aut, cre, cph], Jasen P. Finch [ctb], Adria Olomi [ctb], Sara Samino [aut], Maria Vinaixa [aut], Alexandre Perera [aut, ths], Jesus Brezmes [aut, ths], Oscar Yanes [aut, ths]</td>
</tr>
<tr>
<td>Title:</td>
<td>Automated Spectral Deconvolution, Alignment, and Metabolite
Identification in GC/MS-Based Untargeted Metabolomics</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4)</td>
</tr>
<tr>
<td>Imports:</td>
<td>osd, HiClimR, igraph, signal, quantreg, methods, tibble,
progress, future, furrr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ncdf4, mzR, knitr, rmarkdown, prettydoc, covr, gcspikelite,
testthat</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xavier Domingo-Almenara &lt;xavier.domingoa@eurecat.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Automated compound deconvolution, alignment across samples, and identification of metabolites by spectral library matching in Gas Chromatography - Mass spectrometry (GC-MS) untargeted metabolomics. Outputs a table with compound names, matching scores and the integrated area of the compound for each sample. Package implementation is described in Domingo-Almenara et al. (2016) &lt;<a href="https://doi.org/10.1021%2Facs.analchem.6b02927">doi:10.1021/acs.analchem.6b02927</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://metsyslab.com/">http://metsyslab.com/</a>, <a href="http://xdomingoal.github.io/erah-devel/">http://xdomingoal.github.io/erah-devel/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/xdomingoal/erah-devel/issues">https://github.com/xdomingoal/erah-devel/issues</a></td>
</tr>
<tr>
<td>biocViews:</td>
<td>MassSpectrometry, Metabolomics</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-19 21:00:45 UTC; xavidomingo</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='alignComp'>Alignment of compounds</h2><span id='topic+alignComp'></span><span id='topic+alignComp+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Alignment of GC-MS deconvolved compounds
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignComp(Experiment, alParameters, blocks.size=NULL)

## S4 method for signature 'MetaboSet'
alignComp(Experiment, alParameters, blocks.size = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alignComp_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data previously created by newExp and deconvolved by deconvolveComp.</p>
</td></tr>
<tr><td><code id="alignComp_+3A_alparameters">alParameters</code></td>
<td>
<p>The software alignment parameters object previously created by setAlPar</p>
</td></tr>
<tr><td><code id="alignComp_+3A_blocks.size">blocks.size</code></td>
<td>
<p>For experiment of more than 1000 samples, and depending on the computer, alignment can be conducted by block segmentation. See details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>
<p>For experiments containing more than 100 (Windows) or 1000 (Mac or Linux) samples (numbers depending on the computer resoures and sample type). In those cases alignment can be conducted by block segmentation. For an experiment of e.g. 1000 samples, the block.size can be set to 100, so the alignment will perform as multiple (ten) 100-samples experiments, to later align them into a single experiment.
</p>
<p>This parameter is designed to solve the typical problem that appear when aligning under Windows operating system: &quot;Error: cannot allocate vector of size XX Gb&quot;. Such a problem will not appear with Mac or Linux, but several hours of computation are expected when aligning a large number of samples. Using block segmentation provides a greatly improved run-time performance.
</p>


<h3>Value</h3>

<p>The function returns an updated S4 'MetaboSet' class, where the GC-MS samples have been now aligned.
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+setDecPar">setDecPar</a></code> <code><a href="#topic+deconvolveComp">deconvolveComp</a></code>
</p>

<hr>
<h2 id='alignList'>Alignment list</h2><span id='topic+alignList'></span><span id='topic+alignList+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>The list of aligned metabolites and their relative quantification for each sample in a given experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alignList(object, by.area = TRUE)

## S4 method for signature 'MetaboSet'
alignList(object, by.area = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alignList_+3A_object">object</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data. The experiment has to be previously deconvolved, aligned and (optionally) identified.</p>
</td></tr>
<tr><td><code id="alignList_+3A_by.area">by.area</code></td>
<td>
<p>if TRUE (default), eRah outputs quantification by the area of the deconvolved chromatographic peak of each compound. If FALSE, eRah outputs the intensity of the deconvolved chromatographic peak.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an alignment table containing the list of aligned metabolites and their relative quantification for each sample in a given experiment.
</p>


<h3>Value</h3>

<p><code>alignList</code> returns a data frame object:
</p>
<table>
<tr><td><code>AlignID</code></td>
<td>
<p>The unique Tag for found metabolite by eRah. Each metabolite found by eRah for a given experiment has an unique AlignID tag number.</p>
</td></tr>
<tr><td><code>Factor</code></td>
<td>
<p>the Factor tag name. Each metabolite has an unique 'Factor' name to enhance visual interpretation.</p>
</td></tr>
<tr><td><code>tmean</code></td>
<td>
<p>The mean compound retention time.</p>
</td></tr>
<tr><td><code>FoundIn</code></td>
<td>
<p>The number of samples in which the compound has been detected (the number of samples where the compound area is non-zero).</p>
</td></tr>	
<tr><td><code>Quantification</code></td>
<td>
<p>As many columns as samples and as many rows as metabolites, where each column name has the name of each sample.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+idList">idList</a></code> <code><a href="#topic+dataList">dataList</a></code>
</p>

<hr>
<h2 id='compInfo'>Information of a Compound</h2><span id='topic+compInfo'></span>

<h3>Description</h3>

<p>Displays basic information of a compound in the MS library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compInfo(comp.id, id.database = mslib)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compInfo_+3A_comp.id">comp.id</code></td>
<td>
<p>The DB.Id number of the compound.</p>
</td></tr>
<tr><td><code id="compInfo_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank - Mass Bank of North America (MoNa) database are employed (mslib object).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns details on a given compound such as the synonyms, CAS, KEGG, retention index, among others.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+findComp">findComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># finding proline
findComp("proline")

# we see that proline 2TMS has the DB.Id number 42, then:
compInfo(42)
</code></pre>

<hr>
<h2 id='computeRIerror'>computeRIerror</h2><span id='topic+computeRIerror'></span>

<h3>Description</h3>

<p>This function uses RI of mslib database and RT of the identified compounds to discrimine proper compound identification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computeRIerror(
  Experiment,
  id.database = mslib,
  reference.list,
  ri.error.type = c("relative", "absolute"),
  plot.results = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computeRIerror_+3A_experiment">Experiment</code></td>
<td>
<p>S4 object with experiment Data, Metadata and Results. Results of experiment are used to extract RT and Compound DB Id.</p>
</td></tr>
<tr><td><code id="computeRIerror_+3A_id.database">id.database</code></td>
<td>
<p>Name of the preloaded database, in this case the regular db used by erah mslib</p>
</td></tr>
<tr><td><code id="computeRIerror_+3A_reference.list">reference.list</code></td>
<td>
<p>List with the compounds and their attributes (AlignId...)</p>
</td></tr>
<tr><td><code id="computeRIerror_+3A_ri.error.type">ri.error.type</code></td>
<td>
<p>Specify wether absolute or relative RI error is to be computed.</p>
</td></tr>
<tr><td><code id="computeRIerror_+3A_plot.results">plot.results</code></td>
<td>
<p>Shows the RI/RT graphic (True by default)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+showRTRICurve">showRTRICurve</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
ex &lt;- computeRIerror(
  ex, 
  mslib, 
  reference.list=list(AlignID = c(45,67,92,120)), 
  ri.error.type = "relative"
)

## End(Not run)
</code></pre>

<hr>
<h2 id='createdt'>Creating Experiment Tables</h2><span id='topic+createdt'></span>

<h3>Description</h3>

<p>eRah requires an instrumental and (optionally) phenotype .csv file for starting/creating a new eRah project/experiment. This function automatically creates the Phenoytpe and Instrumental data .csv files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createdt(path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createdt_+3A_path">path</code></td>
<td>
<p>the path where the experiment-folder is (where the experiment samples are stored).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The experiment has to been organized as follows: all the samples related to each class have to be stored in the same folder (one folder = one class), and all the class-folders in one folder, which is the experiment folder. 
</p>
<p>Two things have to be considered at this step: .csv files are different when created by American and European computers, so errors may raise due to that fact. Also, the folder containing the samples, must contain only folders. If the folder contains files (for example, already created .csv files), eRah will prompt an error.
</p>
<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Store all the raw data files in one different folder per class,
# and all the class-folders in one folder, which is the experiment
# folder. Then execute

createdt(path)

# where path is the experiment folder path.
# The experiment can be now startd by:

ex &lt;- newExp(instrumental="path/DEMO_inst.csv", 
phenotype="path/DEMO_pheno.csv", info="DEMO Experiment")

## End(Not run)
</code></pre>

<hr>
<h2 id='createInstrumentalTable'>Create Instrumental Table</h2><span id='topic+createInstrumentalTable'></span>

<h3>Description</h3>

<p>Create table containing instrumental information such as sample IDs and file names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createInstrumentalTable(files)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createInstrumentalTable_+3A_files">files</code></td>
<td>
<p>File paths to experiment samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates instrumental information table based on experiment sample file paths. Columns containing further information can also be added to this.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+createPhenoTable">createPhenoTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(gcspikelite)

files &lt;- list.files(system.file('data',package = 'gcspikelite'),full.names = TRUE)
files &lt;- files[sapply(files,grepl,pattern = 'CDF')]

instrumental &lt;- createInstrumentalTable(files)

## End(Not run)
</code></pre>

<hr>
<h2 id='createPhenoTable'>Create Phenotype Table</h2><span id='topic+createPhenoTable'></span>

<h3>Description</h3>

<p>Create table containing sample meta information such as as sample ID and class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createPhenoTable(files, cls)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createPhenoTable_+3A_files">files</code></td>
<td>
<p>File paths to experiment samples.</p>
</td></tr>
<tr><td><code id="createPhenoTable_+3A_cls">cls</code></td>
<td>
<p>Character vector containing sample classes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Creates phenotype information table based on experiment sample file paths and sample classes. Columns containing further information can also be added to this.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+createInstrumentalTable">createInstrumentalTable</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(gcspikelite)
data(targets)

files &lt;- list.files(system.file('data',package = 'gcspikelite'),full.names = TRUE)
files &lt;- files[sapply(files,grepl,pattern = 'CDF')]

phenotype &lt;- createPhenoTable(files,as.character(targets$Group[order(targets$FileName)]))

## End(Not run)
</code></pre>

<hr>
<h2 id='dataList'>Data list</h2><span id='topic+dataList'></span><span id='topic+dataList+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>The final eRah list of aligned and identified metabolites and their relative quantification for each sample in a given experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataList(Experiment, id.database = mslib, by.area = TRUE)

## S4 method for signature 'MetaboSet'
dataList(Experiment, id.database = mslib, by.area = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataList_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data. The experiment has to be previously deconvolved, aligned and identified.</p>
</td></tr>
<tr><td><code id="dataList_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank - Mass Bank of North America (MoNa) database are employed (mslib object).</p>
</td></tr>
<tr><td><code id="dataList_+3A_by.area">by.area</code></td>
<td>
<p>if TRUE (default), eRah outputs quantification by the area of the deconvolved chromatographic peak of each compound. If FALSE, eRah outputs the intensity of the deconvolved chromatographic peak.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an identification and alignment table containing the list of aligned and identifed metabolites (names) and their relative quantification for each sample in a given experiment.
</p>


<h3>Value</h3>

<p><code>alignList</code> returns an S3 object:
</p>
<table>
<tr><td><code>AlignID</code></td>
<td>
<p>The unique Tag for found metabolite by eRah. Each metabolite found by eRah for a given experiment has an unique AlignID tag number.</p>
</td></tr>
<tr><td><code>tmean</code></td>
<td>
<p>The mean compound retention time.</p>
</td></tr>
<tr><td><code>FoundIn</code></td>
<td>
<p>The number of samples in which the compound has been detected (the number of samples where the compound area is non-zero).</p>
</td></tr>
<tr><td><code>Name.X</code></td>
<td>
<p>the name of the Xst/nd/rd... hit. idList return as many X (hits) as n.putative selected with <code><a href="#topic+identifyComp">identifyComp</a></code>.</p>
</td></tr>
<tr><td><code>MatchFactor.X</code></td>
<td>
<p>The match factor/score of spectral similarity (spectral correlation).</p>
</td></tr>
<tr><td><code>DB.Id.X</code></td>
<td>
<p>The identification number of the library. Each metbolite in the reference library has a different DB.Id number.</p>
</td></tr>
<tr><td><code>CAS.X</code></td>
<td>
<p>the CAS number of each identified metabolite.</p>
</td></tr>
<tr><td><code>Quantification</code></td>
<td>
<p>As many columns as samples and as many rows as metabolites, where each column name has the name of each sample.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+idList">idList</a></code> <code><a href="#topic+alignList">alignList</a></code>
</p>

<hr>
<h2 id='deconvolveComp'>Deconvolution of compounds in samples</h2><span id='topic+deconvolveComp'></span><span id='topic+deconvolveComp+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Deconvolution of GC-MS data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>deconvolveComp(
  Experiment,
  decParameters,
  samples.to.process = NULL,
  down.sample = FALSE,
  virtualScansPerSecond = NULL
)

## S4 method for signature 'MetaboSet'
deconvolveComp(
  Experiment,
  decParameters,
  samples.to.process = NULL,
  down.sample = FALSE,
  virtualScansPerSecond = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="deconvolveComp_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data previously created by newExp.</p>
</td></tr>
<tr><td><code id="deconvolveComp_+3A_decparameters">decParameters</code></td>
<td>
<p>The software deconvolution parameters object previously created by setDecPar</p>
</td></tr>
<tr><td><code id="deconvolveComp_+3A_samples.to.process">samples.to.process</code></td>
<td>
<p>Vector indicating which samples are to be processed.</p>
</td></tr>
<tr><td><code id="deconvolveComp_+3A_down.sample">down.sample</code></td>
<td>
<p>If TRUE, chromatograms are down sampled to define one peak with 10 scan points (according to the minimum peak width). This is to process longer chromatograms with wider peak widths (more than 20 seconds peak width and small scans per second values). See details.</p>
</td></tr>
<tr><td><code id="deconvolveComp_+3A_virtualscanspersecond">virtualScansPerSecond</code></td>
<td>
<p>A virtual scans per second. If chromatograms are downsampled (for example, for a 1 mean peak width a 1 scans per second sampling frequency was used), eRah could not perform as expected. In these cases, the BEST solution is to re-acquire the samples. However, by selecting a different (virtual) scans per second frequency, eRah can upsample the data and process it more effectively.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>
<p>eRah uses multivariate methods which run-time performance depend on the amount of data to be analyzed. When peaks are wider and the #' scans per second is also a small value, the number of points (scans) that define a peak might be too many, leading eRah to a poor run#'-time performance. To solve that, use down.sample=TRUE to allow eRah to define a peak with 10 seconds, and analyze the data more #' efficiently.
</p>


<h3>Value</h3>

<p>The function returns an updated S4 'MetaboSet' class, where the GC-MS samples have been now deconvolved.
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+setAlPar">setAlPar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Deconvolve data from a created experiment by \code{\link{newExp}}.
# ex &lt;- newExp(instrumental="path")

# The following will set eRah for analyzing the chromatograms
# from minutes 5 to 15, and withouth taking into account the masses
# 35:69,73:75,147:149, with a minimum peak width of 0.7 seconds.

ex.dec.par &lt;- setDecPar(min.peak.width=0.7, min.peak.height=5000, 
                       noise.threshold=500, avoid.processing.mz=c(35:69,73:75,147:149), 
                       analysis.time=c(5,15))

# An now deconvolve the compounds in the samples:
# ex &lt;- deconvolveComp(ex, decParameters=ex.dec.par)

## End(Not run)
</code></pre>

<hr>
<h2 id='eRah_DB-class'>Class <code>"eRah_DB"</code></h2><span id='topic+eRah_DB-class'></span>

<h3>Description</h3>

<p>The eRah_DB class contains the slots for storing and accessing a MS library.
</p>


<h3>Slots</h3>


<dl>
<dt><code>name</code></dt><dd><p>The name of the stored library</p>
</dd>
<dt><code>version</code></dt><dd><p>The version of the stored library (and which is the database identifier, should be unique and used to check if is the database used in other experiments)</p>
</dd>
<dt><code>info</code></dt><dd><p>Character vector containing complementary information about the library.</p>
</dd>
<dt><code>database</code></dt><dd><p>A list of S3 objects, which each object contains the information on a different compound.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara.
</p>

<hr>
<h2 id='expClasses'>expClasses-method</h2><span id='topic+expClasses'></span><span id='topic+expClasses+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>The classes of a given experiment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expClasses(object)

## S4 method for signature 'MetaboSet'
expClasses(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expClasses_+3A_object">object</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns the classes details of the experiment.
</p>


<h3>See Also</h3>

<p>metaData phenoData
</p>

<hr>
<h2 id='export2CEF'>Export spectra to CEF</h2><span id='topic+export2CEF'></span>

<h3>Description</h3>

<p>Export spectra to CEF format for comparison with the NIST library through MassHunter interface.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export2CEF(Experiment, export.id = NULL, 
id.database = mslib, store.path = getwd())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export2CEF_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
<tr><td><code id="export2CEF_+3A_export.id">export.id</code></td>
<td>
<p>If NULL, all the spectra in the experiment will be exported. Otherwise, only the AlignID in export.id will be exported</p>
</td></tr>
<tr><td><code id="export2CEF_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library used in the experiment.</p>
</td></tr>
<tr><td><code id="export2CEF_+3A_store.path">store.path</code></td>
<td>
<p>The path where the converted files are to be exported.</p>
</td></tr>
</table>

<hr>
<h2 id='export2MSP'>Export spectra to MSP</h2><span id='topic+export2MSP'></span>

<h3>Description</h3>

<p>Export spectra to MSP format for comparison with the NIST library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export2MSP(
  Experiment,
  export.id = NULL,
  id.database = mslib,
  store.path = getwd(),
  alg.version = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export2MSP_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
<tr><td><code id="export2MSP_+3A_export.id">export.id</code></td>
<td>
<p>If NULL, all the spectra in the experiment will be exported. Otherwise, only the AlignID in export.id will be exported</p>
</td></tr>
<tr><td><code id="export2MSP_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library used in the experiment.</p>
</td></tr>
<tr><td><code id="export2MSP_+3A_store.path">store.path</code></td>
<td>
<p>The path where the converted files are to be exported.</p>
</td></tr>
<tr><td><code id="export2MSP_+3A_alg.version">alg.version</code></td>
<td>
<p>Different algorithm implementations. Users have to chose what version works with their NIST MSearch or other software version. By default, alg.version is set to 1. If it not works, try setting alg.version to 2 ;).</p>
</td></tr>
</table>

<hr>
<h2 id='findComp'>Find a compound</h2><span id='topic+findComp'></span>

<h3>Description</h3>

<p>Finds compounds in the MS library by Name, CAS or chemical formula.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findComp(name = NULL, id.database = mslib, CAS = NULL, chem.form = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="findComp_+3A_name">name</code></td>
<td>
<p>The name of the compound to be found.</p>
</td></tr>
<tr><td><code id="findComp_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank - Mass Bank of North America (MoNa) database are employed (mslib object).</p>
</td></tr>
<tr><td><code id="findComp_+3A_cas">CAS</code></td>
<td>
<p>The CAS number of the compound to be found.</p>
</td></tr>
<tr><td><code id="findComp_+3A_chem.form">chem.form</code></td>
<td>
<p>The chemical formula of the compound to be found.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>findComp</code> returns an S3 object:
</p>
<table>
<tr><td><code>DB.Id</code></td>
<td>
<p>The identification number of the library. Each metbolite in the reference library has a different DB.Id number.</p>
</td></tr>
<tr><td><code>Compound Name</code></td>
<td>
<p>Compound Name.</p>
</td></tr>
<tr><td><code>CAS</code></td>
<td>
<p>CAS number</p>
</td></tr>
<tr><td><code>Formula</code></td>
<td>
<p>Chemical Formula.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+compInfo">compInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># finding proline

findComp("proline")

# be careful, exact matches are not supported, 
# as well as different names like these cases:

findComp("L-proline (2TMS)")


findComp("proline 2")
</code></pre>

<hr>
<h2 id='identifyComp'>Identification of compounds</h2><span id='topic+identifyComp'></span><span id='topic+identifyComp+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Identification of compounds. Each empirical spectrum is compared against a ms library.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>identifyComp(Experiment, id.database = mslib,mz.range = NULL, n.putative = 3)

## S4 method for signature 'MetaboSet'
identifyComp(Experiment, id.database = mslib, mz.range = NULL, n.putative = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="identifyComp_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data previously created by newExp, deconvolved by deconvolveComp and optionally aligned by alignComp.</p>
</td></tr>
<tr><td><code id="identifyComp_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank-[2] - Mass Bank of North America (MoNa) database are employed.</p>
</td></tr>
<tr><td><code id="identifyComp_+3A_mz.range">mz.range</code></td>
<td>
<p>The same as in alignComp. If specified already in alignComp, then there is no need to especify it again. If not, it has to be specified.</p>
</td></tr>
<tr><td><code id="identifyComp_+3A_n.putative">n.putative</code></td>
<td>
<p>The number of hits (compound candidate names) to be returned for each spectrum found.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns an updated S4 'MetaboSet' class, where the GC-MS samples have been now aligned.
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927 
</p>
<p>[2] MassBank: A public repository for sharing mass spectral data for life sciences, H. Horai, M. Arita, S. Kanaya, Y. Nihei, T. Ikeda, K. Suwa. Y. Ojima, K. Tanaka, S. Tanaka, K. Aoshima, Y. Oda, Y. Kakazu, M. Kusano, T. Tohge, F. Matsuda, Y. Sawada, M. Yokota Hirai, H. Nakanishi, K. Ikeda, N. Akimoto, T. Maoka, H. Takahashi, T. Ara, N. Sakurai, H. Suzuki, D. Shibata, S. Neumann, T. Iida, K. Tanaka, K. Funatsu, F. Matsuura, T. Soga, R. Taguchi, K. Saito and T. Nishioka, J. Mass Spectrom., 45 (2010) 703-714.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+alignComp">alignComp</a></code> <code><a href="#topic+setAlPar">setAlPar</a></code> <code><a href="#topic+setDecPar">setDecPar</a></code>
</p>

<hr>
<h2 id='idList'>Identification list</h2><span id='topic+idList'></span><span id='topic+idList+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>The list of identified metabolites in a given experiment
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idList(object, id.database = mslib)

## S4 method for signature 'MetaboSet'
idList(object, id.database = mslib)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="idList_+3A_object">object</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data. The experiment has to be previously deconvolved, aligned and identified.</p>
</td></tr>
<tr><td><code id="idList_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank - Mass Bank of North America (MoNa) database are employed (mslib object).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an identification table containing the names, match scores, and other variables for a given experiment.
</p>


<h3>Value</h3>

<p><code>idList</code> returns an S3 object:
</p>
<table>
<tr><td><code>AlignID</code></td>
<td>
<p>The unique Tag for found metabolite by eRah. Each metabolite found by eRah for a given experiment has an unique AlignID tag number.</p>
</td></tr>
<tr><td><code>tmean</code></td>
<td>
<p>The mean compound retention time.</p>
</td></tr>
<tr><td><code>Name.X</code></td>
<td>
<p>the name of the Xst/nd/rd... hit. idList return as many X (hits) as n.putative selected with <code><a href="#topic+identifyComp">identifyComp</a></code>.</p>
</td></tr>
<tr><td><code>FoundIn</code></td>
<td>
<p>The number of samples in which the compound has been detected (the number of samples where the compound area is non-zero).</p>
</td></tr>
<tr><td><code>MatchFactor.X</code></td>
<td>
<p>The match factor/score of spectral similarity (spectral correlation).</p>
</td></tr>
<tr><td><code>DB.Id.X</code></td>
<td>
<p>The identification number of the library. Each metbolite in the reference library has a different DB.Id number.</p>
</td></tr>
<tr><td><code>CAS.X</code></td>
<td>
<p>the CAS number of each identified metabolite.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+alignList">alignList</a></code> <code><a href="#topic+dataList">dataList</a></code>
</p>

<hr>
<h2 id='importGMD'>Import MSP files from GMD to R</h2><span id='topic+importGMD'></span>

<h3>Description</h3>

<p>Import the Golm Metabolome Database.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importGMD(filename, DB.name, DB.version, DB.info, 
type = c("VAR5.ALK","VAR5.FAME","MDN35.ALK", "MDN35.FAME"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importGMD_+3A_filename">filename</code></td>
<td>
<p>The filepath containing the GMD database file.</p>
</td></tr>
<tr><td><code id="importGMD_+3A_db.name">DB.name</code></td>
<td>
<p>The name of the database (each user may chose its own name</p>
</td></tr>
<tr><td><code id="importGMD_+3A_db.version">DB.version</code></td>
<td>
<p>The version of the database (each user may chose its own version)</p>
</td></tr>
<tr><td><code id="importGMD_+3A_db.info">DB.info</code></td>
<td>
<p>Some info about the database for further reference</p>
</td></tr>
<tr><td><code id="importGMD_+3A_type">type</code></td>
<td>
<p>The type of RI to be imported from the database</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For more details, please see the eRah manual
</p>

<hr>
<h2 id='importMSP'>Import MSP files to R</h2><span id='topic+importMSP'></span>

<h3>Description</h3>

<p>Import MS libraries in MSP format to eRah DB format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>importMSP(filename, DB.name, DB.version, DB.info)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="importMSP_+3A_filename">filename</code></td>
<td>
<p>The filepath containing the MSP library file.</p>
</td></tr>
<tr><td><code id="importMSP_+3A_db.name">DB.name</code></td>
<td>
<p>The name of the database (each user may chose its own name)</p>
</td></tr>
<tr><td><code id="importMSP_+3A_db.version">DB.version</code></td>
<td>
<p>The version of the database (each user may chose its own version)</p>
</td></tr>
<tr><td><code id="importMSP_+3A_db.info">DB.info</code></td>
<td>
<p>Some info about the database for further reference</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The MSP input file should look like:
</p>
<p>&mdash;&ndash;
</p>
<p>Name: Metabolite_name 
</p>
<p>Formula: H2O 
</p>
<p>MW: 666
</p>
<p>ExactMass: 666.266106 
</p>
<p>CAS#: 11-22-3 
</p>
<p>DB#: 1 
</p>
<p>Comments: Metabolite_name reference standard
</p>
<p>Num Peaks: XX
</p>
<p>53 1; 54 2; 55 5; 56 2; 57 2; 
</p>
<p>58 14; 59 18; 60 1000; 61 2; 67 1; 
</p>
<p>Name: Metabolite_name_2
</p>
<p>Formula: H2O2
</p>
<p>MW: 999
</p>
<p>ExactMass: 999.266106
</p>
<p>CAS#: 22-33-4
</p>
<p>DB#: 2
</p>
<p>Comments: Metabolite_name_&quot;&quot; reference standard
</p>
<p>Num Peaks: XX
</p>
<p>66 10; 67 1000; 155 560; 156 800; 157 2; 
</p>
<p>158 14; 159 1; 160 100; 161 2; 167 1; 
</p>
<p>&mdash;&mdash;-	
</p>
<p>OR
</p>
<p>&mdash;&ndash;
</p>
<p>Name: Metabolite_name 
</p>
<p>Formula: H2O 
</p>
<p>MW: 666
</p>
<p>ExactMass: 666.266106 
</p>
<p>CASNO: 11-22-3 
</p>
<p>DB#: 1 
</p>
<p>Comment: Metabolite_name reference standard
</p>
<p>Num peaks: XX
</p>
<p>53 1
</p>
<p>54 2
</p>
<p>55 5 
</p>
<p>Name: Metabolite_name_2
</p>
<p>Formula: H2O2
</p>
<p>MW: 999
</p>
<p>ExactMass: 999.266106
</p>
<p>CASNO: 22-33-4
</p>
<p>DB#: 2
</p>
<p>Comment: Metabolite_name_&quot;&quot; reference standard
</p>
<p>Num Peaks: XX
</p>
<p>66 10
</p>
<p>67 1000
</p>
<p>155 560
</p>
<p>&mdash;&mdash;-	
</p>
<p>Or combinations of both.
</p>
<p>For more details, please see the eRah manual.
</p>

<hr>
<h2 id='MetaboSet-class'>Class <code>"MetaboSet"</code></h2><span id='topic+MetaboSet-class'></span>

<h3>Description</h3>

<p>The MetaboSet class is a single generic class valid for all sorts of metabolomic studies regardless of the experimental platform, the statistical processing and the annotation stage. It is the core operation class of eRah.
</p>


<h3>Details</h3>

<p>MetaboSet
</p>


<h3>Slots</h3>


<dl>
<dt><code>Info</code></dt><dd><p>Slot Info stores the general information of the experiment and the experimental platform used in the analysis of the biological samples.</p>
</dd>
<dt><code>Data</code></dt><dd><p>Slot Data contains either the raw data or the path of the files. It also contains the list of the selected features (deconvolved compounds). In the subslot Parameters it is saved the information regarding the feature selector algorithm (type, parameters, version...) and the experimental platform used.</p>
</dd>
<dt><code>MetaData</code></dt><dd><p>Slot MetaData has two slots. In the Instrumental slot it is saved a data frame with some mandatory fields (filename, date, time, sampleID) and optional fields related to the experimental platform (Column ID, Column Type, Ioniser,...). Slot Phenotypic contains a data frame with the sample and experimental information (phenotypes, longitudinal data,...).</p>
</dd>
<dt><code>Results</code></dt><dd><p>In the Results slot it is saved the information related to the statistical and identification results. The slot Parameters contains all the values of the parameters used in the identification and statistical functions. Slot Identification has the results of the identification process as well as the identification or/and annotation steps. The results of the statistical functions are saved in the Statistics slot.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara, Arnald Alonso and Francesc Fernandez-Albert.
</p>

<hr>
<h2 id='metaData'>metaData-method</h2><span id='topic+metaData'></span><span id='topic+metaData+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Displays the Experiment metadata
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metaData(object)

## S4 method for signature 'MetaboSet'
metaData(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metaData_+3A_object">object</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+phenoData">phenoData</a></code>
</p>

<hr>
<h2 id='mslib'>MassBank Spectral Library</h2><span id='topic+mslib'></span>

<h3>Description</h3>

<p>The default mass spectral library of eRah, which is the MassBank repository.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mslib)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>eRah_DB</code> of length 1.
</p>


<h3>Details</h3>

<p>This is the eRah default MS library, and automatically loaded with the eRah package. It contains almost 500 MS spectra. For details, see reference below.
</p>


<h3>Author(s)</h3>

<p>The TOF-MS spectra were contributted by Kazusa DNA Research Institute, the Engineering Department of Osaka University and Plant Science Center of RIKEN.
</p>
<p>MassBank (http://www.massbank.jp/)
</p>


<h3>References</h3>

<p>[1] MassBank: A public repository for sharing mass spectral data for life sciences, H. Horai, M. Arita, S. Kanaya, Y. Nihei, T. Ikeda, K. Suwa. Y. Ojima, K. Tanaka, S. Tanaka, K. Aoshima, Y. Oda, Y. Kakazu, M. Kusano, T. Tohge, F. Matsuda, Y. Sawada, M. Yokota Hirai, H. Nakanishi, K. Ikeda, N. Akimoto, T. Maoka, H. Takahashi, T. Ara, N. Sakurai, H. Suzuki, D. Shibata, S. Neumann, T. Iida, K. Tanaka, K. Funatsu, F. Matsuura, T. Soga, R. Taguchi, K. Saito and T. Nishioka, J. Mass Spectrom., 45, 703-714 (2010)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compInfo">compInfo</a></code>
</p>

<hr>
<h2 id='newExp'>New Experiment</h2><span id='topic+newExp'></span>

<h3>Description</h3>

<p>Sets a new experiment for eRah
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newExp(instrumental, phenotype = NULL, info = character())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newExp_+3A_instrumental">instrumental</code></td>
<td>
<p>A data.frame containing the sample instrumental information.</p>
</td></tr>
<tr><td><code id="newExp_+3A_phenotype">phenotype</code></td>
<td>
<p>(optional) A data.frame containing sample phenotype information.</p>
</td></tr>
<tr><td><code id="newExp_+3A_info">info</code></td>
<td>
<p>Experiment description</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>


<h3>Value</h3>

<p><code>newExp</code> returns an S4 object of the class 'MetaboSet'.
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createInstrumentalTable">createInstrumentalTable</a></code> <code><a href="#topic+createPhenoTable">createPhenoTable</a></code> <code><a href="#topic+setDecPar">setDecPar</a></code> <code><a href="#topic+setAlPar">setAlPar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
library(gcspikelite)
data(targets)

files &lt;- list.files(system.file('data',package = 'gcspikelite'),full.names = TRUE)
files &lt;- files[sapply(files,grepl,pattern = 'CDF')]

instrumental &lt;- createInstrumentalTable(files)
phenotype &lt;- createPhenoTable(files,as.character(targets$Group[order(targets$FileName)]))

ex &lt;- newExp(instrumental = instrumental, 
phenotype = phenotype, info = "DEMO Experiment")

## End(Not run)
</code></pre>

<hr>
<h2 id='phenoData'>phenoData-method</h2><span id='topic+phenoData'></span><span id='topic+phenoData+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Displays the Experiment phenotypic data (if included).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phenoData(object)

## S4 method for signature 'MetaboSet'
phenoData(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phenoData_+3A_object">object</code></td>
<td>
<p>A 'MetaboSet' S4 object ciontaining the experiment.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+metaData">metaData</a></code>
</p>

<hr>
<h2 id='plotAlign'>Plotting chromatographic profile with and without alignment</h2><span id='topic+plotAlign'></span><span id='topic+plotAlign+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Plots the chromatophic profiles of the compounds found by eRah. Similarly to plotProfile, but with two sub-windows, showing the chromatophic profiles before and after alignment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotAlign(Experiment,AlignId, per.class = T, xlim = NULL)

## S4 method for signature 'MetaboSet'
plotAlign(Experiment, AlignId, per.class = T, xlim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotAlign_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment after being deconolved, aligned and (optionally) identified.</p>
</td></tr>
<tr><td><code id="plotAlign_+3A_alignid">AlignId</code></td>
<td>
<p>the Id identificator for the compound to be shown.</p>
</td></tr>
<tr><td><code id="plotAlign_+3A_per.class">per.class</code></td>
<td>
<p>logical. if TRUE the profiles are shown one color per class, if FALSE one color per sample.</p>
</td></tr>
<tr><td><code id="plotAlign_+3A_xlim">xlim</code></td>
<td>
<p>x axsis (retention time) limits (see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSpectra">plotSpectra</a></code> <code><a href="#topic+plotProfile">plotProfile</a></code>
</p>

<hr>
<h2 id='plotChr'>Plotting sample chromatogram</h2><span id='topic+plotChr'></span><span id='topic+plotChr+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Plot the sample chromatogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotChr(
  Experiment,
  N.sample = 1,
  type = c("BIC", "TIC", "EIC"),
  xlim = NULL,
  mz = NULL
)

## S4 method for signature 'MetaboSet'
plotChr(
  Experiment,
  N.sample = 1,
  type = c("BIC", "TIC", "EIC"),
  xlim = NULL,
  mz = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotChr_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
<tr><td><code id="plotChr_+3A_n.sample">N.sample</code></td>
<td>
<p>Integer. The number of the sample to query.</p>
</td></tr>
<tr><td><code id="plotChr_+3A_type">type</code></td>
<td>
<p>The type of plotting, Base Ion Chromatogram (BIC), Total Ion Chromatogram (TIC), or Extracted Ion Chromatogram (EIC).</p>
</td></tr>
<tr><td><code id="plotChr_+3A_xlim">xlim</code></td>
<td>
<p>The range in minutes, separated by comas: c(rt.min, rt.max) of the limits of plotting. By default, all the chromatogram is plotted.</p>
</td></tr>
<tr><td><code id="plotChr_+3A_mz">mz</code></td>
<td>
<p>Just when EIC is selected. The range separated by comas: c(mz.min, mz.max) or a vector of numbers: c(50,67,80), of the masses to be ploted.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+sampleInfo">sampleInfo</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
plotChr(Experiment, 1, "BIC")

# Plots from minute 5 to 7.
plotChr(Experiment, 1, "TIC", xlim=c(5,7))  

# Plots from minute 5 to 7, and only the masses from 50 to 70.
plotChr(Experiment, 1, "EIC", mz=50:70 xlim=c(5,7))  

# Plots the EIC from minute 7 to 7.5, and only the masses 50, 54 and 70.
plotChr(Experiment, 1, "EIC", xlim=c(7,7.5), mz=c(50,54,70))

## End(Not run)
</code></pre>

<hr>
<h2 id='plotProfile'>Plotting chromatographic profile</h2><span id='topic+plotProfile'></span><span id='topic+plotProfile+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Plots the chromatophic profiles of the compounds found by eRah.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotProfile(Experiment,AlignId, per.class = T, xlim = NULL, cols=NULL)

## S4 method for signature 'MetaboSet'
plotProfile(Experiment, AlignId, per.class = T, xlim = NULL, cols = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotProfile_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment after being deconolved, aligned and (optionally) identified.</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_alignid">AlignId</code></td>
<td>
<p>the Id identificator for the compound to be shown.</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_per.class">per.class</code></td>
<td>
<p>logical. if TRUE (by default) the profiles are shown one color per class, if FALSE one color per sample.</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_xlim">xlim</code></td>
<td>
<p>x axsis (retention time) limits (see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>).</p>
</td></tr>
<tr><td><code id="plotProfile_+3A_cols">cols</code></td>
<td>
<p>vector of colors. Colors are used cyclically.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotSpectra">plotSpectra</a></code> <code><a href="#topic+plotAlign">plotAlign</a></code>
</p>

<hr>
<h2 id='plotSpectra'>Plotting Spectra</h2><span id='topic+plotSpectra'></span><span id='topic+plotSpectra+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Plots the empirical spectra found by eRah, and allows comparing it with the reference spectra.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotSpectra(Experiment, AlignId, n.putative = 1,
compare = T, id.database = mslib, comp.db = NULL, 
return.spectra = F, draw.color = "purple", xlim = NULL)

## S4 method for signature 'MetaboSet'
plotSpectra(
  Experiment,
  AlignId,
  n.putative = 1,
  compare = T,
  id.database = mslib,
  comp.db = NULL,
  return.spectra = F,
  draw.color = "purple",
  xlim = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotSpectra_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment after being deconolved, aligned and (optionally) identified.</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_alignid">AlignId</code></td>
<td>
<p>the Id identificator for the compound to be shown.</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_n.putative">n.putative</code></td>
<td>
<p>The hit number (position) to be returned when comparing the empirical spectrum with the reference. See details</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_compare">compare</code></td>
<td>
<p>logical. If TRUE, then the reference spectrum from the library is shown for comparison.</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_id.database">id.database</code></td>
<td>
<p>The mass-spectra library to be compared with the empirical spectra. By default, the MassBank-[2] - Mass Bank of North America (MoNa) database are employed.</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_comp.db">comp.db</code></td>
<td>
<p>If you want to compare the empirical spectrum with another spectrum from the database, select the comp.db number from the database.</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_return.spectra">return.spectra</code></td>
<td>
<p>logical. If TRUE, the function returns the empirical spectrum for the selected compound</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_draw.color">draw.color</code></td>
<td>
<p>Selects the color for the reference spectrum (see <code><a href="grDevices.html#topic+colors">colors</a></code>).</p>
</td></tr>
<tr><td><code id="plotSpectra_+3A_xlim">xlim</code></td>
<td>
<p>x axsis (mass - m/z) limits (see <code><a href="graphics.html#topic+plot.default">plot.default</a></code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When identification is applied (see <code><a href="#topic+identifyComp">identifyComp</a></code>), the number of hits to be returned (n.putative) has to be selected. Therefore, here you can compare the empirical spectrum (found by eRah) with each n.putative hit returned (1, 2, ...) by (see <code><a href="#topic+identifyComp">identifyComp</a></code>).
</p>


<h3>Value</h3>

<p><code>plotSpectra</code> returns an vector when return.spectra=TRUE.
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>vector. Containts the empirical spectrum.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] eRah: an R package for spectral deconvolution, alignment, and metabolite identification in GC/MS-based untargeted metabolomics. Xavier Domingo-Almenara, Alexandre Perera, Maria Vinaixa, Sara Samino, Xavier Correig, Jesus Brezmes, Oscar Yanes. (2016) Article in Press.
</p>
<p>[2] MassBank: A public repository for sharing mass spectral data for life sciences, H. Horai, M. Arita, S. Kanaya, Y. Nihei, T. Ikeda, K. Suwa. Y. Ojima, K. Tanaka, S. Tanaka, K. Aoshima, Y. Oda, Y. Kakazu, M. Kusano, T. Tohge, F. Matsuda, Y. Sawada, M. Yokota Hirai, H. Nakanishi, K. Ikeda, N. Akimoto, T. Maoka, H. Takahashi, T. Ara, N. Sakurai, H. Suzuki, D. Shibata, S. Neumann, T. Iida, K. Tanaka, K. Funatsu, F. Matsuura, T. Soga, R. Taguchi, K. Saito and T. Nishioka, J. Mass Spectrom., 45, 703-714 (2010)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotProfile">plotProfile</a></code> <code><a href="#topic+plotAlign">plotAlign</a></code>
</p>

<hr>
<h2 id='RawDataParameters-class'>Class <code>"RawDataParameters"</code></h2><span id='topic+RawDataParameters-class'></span>

<h3>Description</h3>

<p>The RawDataParameters class contains the slots for storing and accessing into a MS sample, and the essential parameters for performing its processing (deconvolution).
</p>


<h3>Slots</h3>


<dl>
<dt><code>data</code></dt><dd><p>The data matrix of the sample to be processed</p>
</dd>
<dt><code>min.mz</code></dt><dd><p>The minimum adquired mz number</p>
</dd>
<dt><code>max.mz</code></dt><dd><p>The maximum adquired mz number</p>
</dd>
<dt><code>start.time</code></dt><dd><p>Starting time of adquisition</p>
</dd>
<dt><code>mz.resolution</code></dt><dd><p>Mz resolution</p>
</dd>
<dt><code>scans.per.second</code></dt><dd><p>Scans per second</p>
</dd>
<dt><code>avoid.processing.mz</code></dt><dd><p>Which mz do not have to be processed</p>
</dd>
<dt><code>min.peak.width</code></dt><dd><p>Minimum peak width (stored in scans)</p>
</dd>
<dt><code>min.peak.height</code></dt><dd><p>Minimum peak height</p>
</dd>
<dt><code>noise.threshold</code></dt><dd><p>The noise threshold</p>
</dd>
<dt><code>compression.coef</code></dt><dd><p>Compression coefficient (parameter for Orthogonal Signal Deconvolution)</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara.
</p>

<hr>
<h2 id='recMissComp'>Missing compound recovery</h2><span id='topic+recMissComp'></span><span id='topic+recMissComp+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Missing compounds recovery: fits a general model (all the compounds above a certain minimum number of samples) to all the samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>recMissComp(Experiment, min.samples, free.model = F)

## S4 method for signature 'MetaboSet'
recMissComp(Experiment, min.samples, free.model = F)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="recMissComp_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment data previously created by newExp, deconvolved by deconvolveComp and aligned by alignComp.</p>
</td></tr>
<tr><td><code id="recMissComp_+3A_min.samples">min.samples</code></td>
<td>
<p>The minimum number of samples in which a compound has to appear to be considered for searching into the rest of the samples where this compound missing.</p>
</td></tr>
<tr><td><code id="recMissComp_+3A_free.model">free.model</code></td>
<td>
<p>If TRUE, the spectra found in the samples where the compound is missing is used to get the final average spectra. (See details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>WARNING: If compounds were previously identified, they have to be identified again after applying the &quot;recMissComp&quot; function. This means that &quot;identifyComp&quot; function has to be executed always after &quot;recMissComp&quot; for identification of compounds, even if &quot;identifyComp&quot; has been previously applied before.
</p>
<p>The free.model parameter is recomended to be always FALSE (except for carbon tracking applications). This is because the spectra of the samples where the compound is missing is usually affected by noise, and this could decrease the matching score for a certain compound.
</p>


<h3>Value</h3>

<p>The function returns an updated S4 'MetaboSet' class, where the GC-MS samples have been now aligned.
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Domingo-Almenara X, et al. Compound deconvolution in GC-MS-based metabolomics by blind source separation. Journal of Chromatography A (2015). Vol. 1409: 226-233. DOI: 10.1016/j.chroma.2015.07.044
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+alignComp">alignComp</a></code> <code><a href="#topic+setAlPar">setAlPar</a></code> <code><a href="#topic+setDecPar">setDecPar</a></code>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+plan'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>future</dt><dd><p><code><a href="future.html#topic+plan">plan</a></code></p>
</dd>
</dl>

<hr>
<h2 id='sampleInfo'>Information of the samples</h2><span id='topic+sampleInfo'></span><span id='topic+sampleInfo+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Returns basic information on the samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleInfo(Experiment, N.sample = 1)

## S4 method for signature 'MetaboSet'
sampleInfo(Experiment, N.sample = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleInfo_+3A_experiment">Experiment</code></td>
<td>
<p>A 'MetaboSet' S4 object containing the experiment.</p>
</td></tr>
<tr><td><code id="sampleInfo_+3A_n.sample">N.sample</code></td>
<td>
<p>Integer. The number of the sample to query.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns details on a given sample of the experiment, such as name, start time, end time, minium and maximum adquired m/z and scans per second.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotChr">plotChr</a></code>
</p>

<hr>
<h2 id='setAlPar'>Set Alignment Parameters</h2><span id='topic+setAlPar'></span>

<h3>Description</h3>

<p>Setting alignment parameters for eRah.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setAlPar(min.spectra.cor, max.time.dist,mz.range = c(70:600))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setAlPar_+3A_min.spectra.cor">min.spectra.cor</code></td>
<td>
<p>Minimum spectral correlation value. From 0 (non similar) to 1 (very similar). This value sets how similar two or more compounds have be to be considered for alignment between them.</p>
</td></tr>
<tr><td><code id="setAlPar_+3A_max.time.dist">max.time.dist</code></td>
<td>
<p>Maximum retention time distance. This value (in seconds) sets how far two or more compounds can be to be considered for alignment between them.</p>
</td></tr>
<tr><td><code id="setAlPar_+3A_mz.range">mz.range</code></td>
<td>
<p>The range of masses that is considered when comparing spectra.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+setDecPar">setDecPar</a></code> <code><a href="#topic+alignComp">alignComp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# The following will set eRah for aligning compounds which are
# at least 90 (per cent) similar, and which peaks are at a 
# maximum distance of 2 seconds. All the masses are considered when
# computing the spectral similarity.

ex.al.par &lt;- setAlPar(min.spectra.cor=0.90, max.time.dist=2,
mz.range=1:600)

## End(Not run)
</code></pre>

<hr>
<h2 id='setDecPar'>Set Software Parameters</h2><span id='topic+setDecPar'></span>

<h3>Description</h3>

<p>Sets Software Parameters for eRah.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setDecPar(
  min.peak.width,
  min.peak.height = 2500,
  noise.threshold = 500,
  avoid.processing.mz = c(73:75, 147:149),
  compression.coef = 2,
  analysis.time = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setDecPar_+3A_min.peak.width">min.peak.width</code></td>
<td>
<p>Minimum compound peak width (in seconds). This is a critical parameter that conditions the efficiency of eRah. Typically, this should be the half of the mean compound width.</p>
</td></tr>
<tr><td><code id="setDecPar_+3A_min.peak.height">min.peak.height</code></td>
<td>
<p>Minimum compound peak height</p>
</td></tr>
<tr><td><code id="setDecPar_+3A_noise.threshold">noise.threshold</code></td>
<td>
<p>Data above this threshold will be considered as noise</p>
</td></tr>
<tr><td><code id="setDecPar_+3A_avoid.processing.mz">avoid.processing.mz</code></td>
<td>
<p>The masses that do not want to be considered for processing. Typically, in GC-MS those masses are 73,74,75,147,148 and 149, since they are they are ubiquitous mass fragments typically generated from compounds carrying a trimethylsilyl moiety.</p>
</td></tr>
<tr><td><code id="setDecPar_+3A_compression.coef">compression.coef</code></td>
<td>
<p>Data is compressed when using the orthogonal signal deconvolution (OSD) algorithm according to this value. A level 2 of compression is recomended.</p>
</td></tr>
<tr><td><code id="setDecPar_+3A_analysis.time">analysis.time</code></td>
<td>
<p>The chromatographic retention time window to process. If 0, all the chromatogram is processed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+newExp">newExp</a></code> <code><a href="#topic+deconvolveComp">deconvolveComp</a></code> <code><a href="#topic+alignComp">alignComp</a></code> <code><a href="#topic+setAlPar">setAlPar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# The following will set eRah for analyzing the chromatograms
#from minutes 5 to 15, and withouth taking into account the masses
#35:69,73:75,147:149, widht a minimum peak widht of 0.7 seconds.
ex.dec.par &lt;- setDecPar(min.peak.width = 0.7, 
                        min.peak.height = 5000, 
                        noise.threshold = 500, 
                        avoid.processing.mz = c(35:69,73:75,147:149), 
                        analysis.time = c(5,15))

## End(Not run)
</code></pre>

<hr>
<h2 id='show+2CMetaboSet-method'>Show MetaboSet object</h2><span id='topic+show+2CMetaboSet-method'></span>

<h3>Description</h3>

<p>Show MetaboSet object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'MetaboSet'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show+2B2CMetaboSet-method_+3A_object">object</code></td>
<td>
<p>S4 object of class MetaboSet</p>
</td></tr>
</table>


<h3>Details</h3>

<p>show-MetaboSet
</p>

<hr>
<h2 id='showRTRICurve'>Show RT-RI curve</h2><span id='topic+showRTRICurve'></span>

<h3>Description</h3>

<p>This function uses RI of mslib database and RT of the identified compounds to discrimine proper compound identification.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showRTRICurve(
  Experiment,
  reference.list,
  nAnchors = 4,
  ri.thrs = "1R",
  id.database = mslib
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showRTRICurve_+3A_experiment">Experiment</code></td>
<td>
<p>S4 object with experiment Data, Metadata and Results. Results of experiment are used to extract RT and Compound DB Id.</p>
</td></tr>
<tr><td><code id="showRTRICurve_+3A_reference.list">reference.list</code></td>
<td>
<p>List with the compounds and their attributes (AlignId...)</p>
</td></tr>
<tr><td><code id="showRTRICurve_+3A_nanchors">nAnchors</code></td>
<td>
<p>The desired equivalent number of degrees of freedom for the smooth.spline function</p>
</td></tr>
<tr><td><code id="showRTRICurve_+3A_ri.thrs">ri.thrs</code></td>
<td>
<p>Retention Index treshold given by the user to discrimine bewteen identification results</p>
</td></tr>
<tr><td><code id="showRTRICurve_+3A_id.database">id.database</code></td>
<td>
<p>Name of the preloaded database (mslib by default, the regular db used by erah)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See eRah vignette for more details. To open the vignette, execute the following code in R:
vignette(&quot;eRahManual&quot;, package=&quot;erah&quot;)
</p>


<h3>Author(s)</h3>

<p>Xavier Domingo-Almenara. xavier.domingo@urv.cat
</p>


<h3>References</h3>

<p>[1] Xavier Domingo-Almenara, et al., eRah: A Computational Tool Integrating Spectral Deconvolution and Alignment with Quantification and Identification of Metabolites in GC-MS-Based Metabolomics. Analytical Chemistry (2016). DOI: 10.1021/acs.analchem.6b02927
</p>


<h3>See Also</h3>

<p><code><a href="#topic+computeRIerror">computeRIerror</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# The following set erah to determine which indetified compounds are in RI treshold
RTRICurve &lt;- showRTRICurve(ex, list, nAnchors=4, ri.thrs='1R')

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
