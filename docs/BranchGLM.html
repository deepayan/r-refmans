<!DOCTYPE html><html><head><title>Help for package BranchGLM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BranchGLM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BranchGLM-package'><p>BranchGLM: Efficient Best Subset Selection for GLMs via Branch and Bound Algorithms</p></a></li>
<li><a href='#BranchGLM'><p>Fits GLMs</p></a></li>
<li><a href='#BranchGLM-defunct'><p>Defunct functions in BranchGLM</p></a></li>
<li><a href='#BranchGLM-internal'><p>Internal BranchGLM Functions</p></a></li>
<li><a href='#Cindex'><p>Cindex/AUC</p></a></li>
<li><a href='#coef.BranchGLM'><p>Extract Coefficients from BranchGLM Objects</p></a></li>
<li><a href='#coef.BranchGLMVS'><p>Extract Coefficients from BranchGLMVS or summary.BranchGLMVS Objects</p></a></li>
<li><a href='#confint.BranchGLM'><p>Likelihood Ratio Confidence Intervals for Beta Coefficients for BranchGLM Objects</p></a></li>
<li><a href='#formula.BranchGLM'><p>Extract Model Formula from BranchGLM Objects</p></a></li>
<li><a href='#logLik.BranchGLM'><p>Extract Log-Likelihood from BranchGLM Objects</p></a></li>
<li><a href='#MultipleROCCurves'><p>Plotting Multiple ROC Curves</p></a></li>
<li><a href='#nobs.BranchGLM'><p>Extract Number of Observations from BranchGLM Objects</p></a></li>
<li><a href='#plot.BranchGLMCIs'><p>Plot Method for BranchGLMCIs Objects</p></a></li>
<li><a href='#plot.BranchGLMROC'><p>Plot Method for BranchGLMROC Objects</p></a></li>
<li><a href='#plot.BranchGLMVS'><p>Plot Method for summary.BranchGLMVS and BranchGLMVS Objects</p></a></li>
<li><a href='#plotCI'><p>Plot Confidence Intervals</p></a></li>
<li><a href='#predict.BranchGLM'><p>Predict Method for BranchGLM Objects</p></a></li>
<li><a href='#predict.BranchGLMVS'><p>Predict Method for BranchGLMVS or summary.BranchGLMVS Objects</p></a></li>
<li><a href='#print.BranchGLM'><p>Print Method for BranchGLM Objects</p></a></li>
<li><a href='#print.BranchGLMCIs'><p>Print Method for BranchGLMCIs Objects</p></a></li>
<li><a href='#print.BranchGLMROC'><p>Print Method for BranchGLMROC Objects</p></a></li>
<li><a href='#print.BranchGLMTable'><p>Print Method for BranchGLMTable Objects</p></a></li>
<li><a href='#print.BranchGLMVS'><p>Print Method for BranchGLMVS Objects</p></a></li>
<li><a href='#print.summary.BranchGLMVS'><p>Print Method for summary.BranchGLMVS Objects</p></a></li>
<li><a href='#ROC'><p>ROC Curve</p></a></li>
<li><a href='#summary.BranchGLMVS'><p>Summary Method for BranchGLMVS Objects</p></a></li>
<li><a href='#Table'><p>Confusion Matrix</p></a></li>
<li><a href='#VariableSelection'><p>Variable Selection for GLMs</p></a></li>
<li><a href='#vcov.BranchGLM'><p>Extract covariance matrix from BranchGLM Objects</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Efficient Best Subset Selection for GLMs via Branch and Bound
Algorithms</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-4-7</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jacob Seedorff &lt;jacob-seedorff@uiowa.edu&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/JacobSeedorff21/BranchGLM">https://github.com/JacobSeedorff21/BranchGLM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/JacobSeedorff21/BranchGLM/issues">https://github.com/JacobSeedorff21/BranchGLM/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Performs efficient and scalable glm best 
	subset selection using a novel implementation of a branch and bound algorithm.
	To speed up the model fitting process, a range of optimization
	methods are implemented in 'RcppArmadillo'. Parallel computation 
	is available using 'OpenMP'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.apache.org/licenses/LICENSE-2.0">Apache License (&ge; 2)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7), methods, stats, graphics</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, BH</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-08 02:11:10 UTC; Jacob</td>
</tr>
<tr>
<td>Author:</td>
<td>Jacob Seedorff [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-08 03:53:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BranchGLM-package'>BranchGLM: Efficient Best Subset Selection for GLMs via Branch and Bound Algorithms</h2><span id='topic+BranchGLM-package'></span>

<h3>Description</h3>

<p>Performs efficient and scalable glm best subset selection using a novel implementation of a branch and bound algorithm. To speed up the model fitting process, a range of optimization methods are implemented in 'RcppArmadillo'. Parallel computation is available using 'OpenMP'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Jacob Seedorff <a href="mailto:jacob-seedorff@uiowa.edu">jacob-seedorff@uiowa.edu</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/JacobSeedorff21/BranchGLM">https://github.com/JacobSeedorff21/BranchGLM</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/JacobSeedorff21/BranchGLM/issues">https://github.com/JacobSeedorff21/BranchGLM/issues</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># Using iris data to demonstrate package usage
Data &lt;- iris

# Fitting linear regression model
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")
Fit

# Doing branch and bound best subset selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", 
showprogress = FALSE, bestmodels = 10)
VS

## Plotting results
plot(VS, ptype = "variables")

</code></pre>

<hr>
<h2 id='BranchGLM'>Fits GLMs</h2><span id='topic+BranchGLM'></span><span id='topic+BranchGLM.fit'></span>

<h3>Description</h3>

<p>Fits generalized linear models (GLMs) via RcppArmadillo with the
ability to perform some computation in parallel with OpenMP.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BranchGLM(
  formula,
  data,
  family,
  link,
  offset = NULL,
  method = "Fisher",
  grads = 10,
  parallel = FALSE,
  nthreads = 8,
  tol = 1e-06,
  maxit = NULL,
  init = NULL,
  fit = TRUE,
  contrasts = NULL,
  keepData = TRUE,
  keepY = TRUE
)

BranchGLM.fit(
  x,
  y,
  family,
  link,
  offset = NULL,
  method = "Fisher",
  grads = 10,
  parallel = FALSE,
  nthreads = 8,
  init = NULL,
  maxit = NULL,
  tol = 1e-06
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BranchGLM_+3A_formula">formula</code></td>
<td>
<p>a formula for the model.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_data">data</code></td>
<td>
<p>a data.frame, list or environment (or object coercible by
<a href="base.html#topic+as.data.frame">as.data.frame</a> to a data.frame), containing the variables in formula.
Neither a matrix nor an array will be accepted.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_family">family</code></td>
<td>
<p>the distribution used to model the data, one of &quot;gaussian&quot;,
&quot;gamma&quot;, &quot;binomial&quot;, or &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_link">link</code></td>
<td>
<p>the link used to link the mean structure to the linear predictors. One of
&quot;identity&quot;, &quot;logit&quot;, &quot;probit&quot;, &quot;cloglog&quot;, &quot;sqrt&quot;, &quot;inverse&quot;, or &quot;log&quot;. The accepted
links depend on the specified family, see more in details.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_offset">offset</code></td>
<td>
<p>the offset vector, by default the zero vector is used.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_method">method</code></td>
<td>
<p>one of &quot;Fisher&quot;, &quot;BFGS&quot;, or &quot;LBFGS&quot;. BFGS and L-BFGS are
quasi-newton methods which are typically faster than Fisher's scoring when
there are many covariates (at least 50).</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_grads">grads</code></td>
<td>
<p>a positive integer to denote the number of gradients used to
approximate the inverse information with, only for <code>method = "LBFGS"</code>.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_parallel">parallel</code></td>
<td>
<p>a logical value to indicate if parallelization should be used.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_nthreads">nthreads</code></td>
<td>
<p>a positive integer to denote the number of threads used with OpenMP,
only used if <code>parallel = TRUE</code>.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_tol">tol</code></td>
<td>
<p>a positive number to denote the tolerance used to determine model convergence.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_maxit">maxit</code></td>
<td>
<p>a positive integer to denote the maximum number of iterations performed.
The default for Fisher's scoring is 50 and for the other methods the default is 200.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_init">init</code></td>
<td>
<p>a numeric vector of initial values for the betas, if not specified
then they are automatically selected via linear regression with the transformation
specified by the link function. This is ignored for linear regression models.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_fit">fit</code></td>
<td>
<p>a logical value to indicate whether to fit the model or not.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_contrasts">contrasts</code></td>
<td>
<p>see <code>contrasts.arg</code> of <code>model.matrix.default</code>.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_keepdata">keepData</code></td>
<td>
<p>a logical value to indicate whether or not to store a copy of
data and the design matrix, the default is TRUE. If this is FALSE, then the
results from this cannot be used inside of <code>VariableSelection</code>.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_keepy">keepY</code></td>
<td>
<p>a logical value to indicate whether or not to store a copy of y,
the default is TRUE. If this is FALSE, then the binomial GLM helper functions
may not work and this cannot be used inside of <code>VariableSelection</code>.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_x">x</code></td>
<td>
<p>design matrix used for the fit, must be numeric.</p>
</td></tr>
<tr><td><code id="BranchGLM_+3A_y">y</code></td>
<td>
<p>outcome vector, must be numeric.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Fitting</h4>

<p>Can use BFGS, L-BFGS, or Fisher's scoring to fit the GLM. BFGS and L-BFGS are
typically faster than Fisher's scoring when there are at least 50 covariates
and Fisher's scoring is typically best when there are fewer than 50 covariates.
This function does not currently support the use of weights. In the special
case of gaussian regression with identity link the <code>method</code> argument is ignored
and the normal equations are solved directly.
</p>
<p>The models are fit in C++ by using Rcpp and RcppArmadillo. In order to help
convergence, each of the methods makes use of a backtracking line-search using
the strong Wolfe conditions to find an adequate step size. There are
three conditions used to determine convergence, the first is whether there is a
sufficient decrease in the negative log-likelihood, the second is whether
the l2-norm of the score is sufficiently small, and the last condition is
whether the change in each of the beta coefficients is sufficiently
small. The <code>tol</code> argument controls all of these criteria. If the algorithm fails to
converge, then <code>iterations</code> will be -1.
</p>
<p>All observations with any missing values are removed before model fitting.
</p>
<p><code>BranchGLM.fit</code> can be faster than calling <code>BranchGLM</code> if the
x matrix and y vector are already available, but doesn't return as much information.
The object returned by <code>BranchGLM.fit</code> is not of class <code>BranchGLM</code>, so
all of the methods for <code>BranchGLM</code> objects such as <code>predict</code> or
<code>VariableSelection</code> cannot be used.
</p>



<h4>Dispersion Parameter</h4>

<p>The dispersion parameter for gamma regression is estimated via maximum likelihood,
very similar to the <code>gamma.dispersion</code> function from the MASS package. The
dispersion parameter for gaussian regression is also estimated via maximum
likelihood estimation.
</p>



<h4>Families and Links</h4>

<p>The binomial family accepts &quot;cloglog&quot;, &quot;log&quot;, &quot;logit&quot;, and &quot;probit&quot; as possible
link functions. The gamma and gaussian families accept &quot;identity&quot;, &quot;inverse&quot;,
&quot;log&quot;, and &quot;sqrt&quot; as possible link functions. The Poisson family accepts &quot;identity&quot;,
&quot;log&quot;, and &quot;sqrt&quot; as possible link functions.
</p>



<h3>Value</h3>

<p><code>BranchGLM</code> returns a <code>BranchGLM</code> object which is a list with the following components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a matrix with the coefficient estimates, SEs, Wald test statistics, and p-values</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p> number of iterations it took the algorithm to converge, if the algorithm failed to converge then this is -1</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p> the value of the dispersion parameter</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p> the log-likelihood of the fitted model</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the variance-covariance matrix of the fitted model</p>
</td></tr>
<tr><td><code>resDev</code></td>
<td>
<p> the residual deviance of the fitted model</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> the AIC of the fitted model</p>
</td></tr>
<tr><td><code>preds</code></td>
<td>
<p> predictions from the fitted model</p>
</td></tr>
<tr><td><code>linpreds</code></td>
<td>
<p> linear predictors from the fitted model</p>
</td></tr>
<tr><td><code>tol</code></td>
<td>
<p> tolerance used to fit the model</p>
</td></tr>
<tr><td><code>maxit</code></td>
<td>
<p> maximum number of iterations used to fit the model</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p> formula used to fit the model</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p> iterative method used to fit the model</p>
</td></tr>
<tr><td><code>grads</code></td>
<td>
<p> number of gradients used to approximate inverse information for L-BFGS</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p> y vector used in the model, not included if <code>keepY = FALSE</code></p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p> design matrix used to fit the model, not included if <code>keepData = FALSE</code></p>
</td></tr>
<tr><td><code>offset</code></td>
<td>
<p> offset vector in the model, not included if <code>keepData = FALSE</code></p>
</td></tr>
<tr><td><code>fulloffset</code></td>
<td>
<p> supplied offset vector, not included if <code>keepData = FALSE</code></p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p> original <code>data</code> argument supplied to the function, not included if <code>keepData = FALSE</code></p>
</td></tr>
<tr><td><code>mf</code></td>
<td>
<p> the model frame, not included if <code>keepData = FALSE</code></p>
</td></tr>
<tr><td><code>numobs</code></td>
<td>
<p> number of observations in the design matrix</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p> names of the predictor variables</p>
</td></tr>
<tr><td><code>yname</code></td>
<td>
<p> name of y variable</p>
</td></tr>
<tr><td><code>parallel</code></td>
<td>
<p> whether parallelization was employed to speed up model fitting process</p>
</td></tr>
<tr><td><code>missing</code></td>
<td>
<p> number of missing values removed from the original dataset</p>
</td></tr>
<tr><td><code>link</code></td>
<td>
<p> link function used to model the data</p>
</td></tr>
<tr><td><code>family</code></td>
<td>
<p> family used to model the data</p>
</td></tr>
<tr><td><code>ylevel</code></td>
<td>
<p> the levels of y, only included for binomial glms</p>
</td></tr>
<tr><td><code>xlev</code></td>
<td>
<p> the levels of the factors in the dataset</p>
</td></tr>
<tr><td><code>terms</code></td>
<td>
<p>the terms object used</p>
</td></tr>
</table>
<p><code>BranchGLM.fit</code> returns a list with the following components
</p>
<table>
<tr><td><code>coefficients</code></td>
<td>
<p> a matrix with the coefficients estimates, SEs, Wald test statistics, and p-values</p>
</td></tr>
<tr><td><code>iterations</code></td>
<td>
<p> number of iterations it took the algorithm to converge, if the algorithm failed to converge then this is -1</p>
</td></tr>
<tr><td><code>dispersion</code></td>
<td>
<p> the value of the dispersion parameter</p>
</td></tr>
<tr><td><code>logLik</code></td>
<td>
<p> the log-likelihood of the fitted model</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p> the variance-covariance matrix of the fitted model</p>
</td></tr>
<tr><td><code>resDev</code></td>
<td>
<p> the residual deviance of the fitted model</p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> the AIC of the fitted model</p>
</td></tr>
<tr><td><code>preds</code></td>
<td>
<p> predictions from the fitted model</p>
</td></tr>
<tr><td><code>linpreds</code></td>
<td>
<p> linear predictors from the fitted model</p>
</td></tr>
<tr><td><code>tol</code></td>
<td>
<p> tolerance used to fit the model</p>
</td></tr>
<tr><td><code>maxit</code></td>
<td>
<p> maximum number of iterations used to fit the model</p>
</td></tr>
</table>


<h3>References</h3>

<p>McCullagh, P., &amp; Nelder, J. A. (1989). Generalized Linear Models (2nd ed.).
Chapman &amp; Hall.
</p>


<h3>See Also</h3>

<p><a href="#topic+predict.BranchGLM">predict.BranchGLM</a>, <a href="#topic+coef.BranchGLM">coef.BranchGLM</a>, <a href="#topic+VariableSelection">VariableSelection</a>, <a href="#topic+confint.BranchGLM">confint.BranchGLM</a>, <a href="#topic+logLik.BranchGLM">logLik.BranchGLM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris

# Linear regression
## Using BranchGLM
BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

## Using BranchGLM.fit
x &lt;- model.matrix(Sepal.Length ~ ., data = Data)
y &lt;- Data$Sepal.Length
BranchGLM.fit(x, y, family = "gaussian", link = "identity")

# Gamma regression
## Using BranchGLM
BranchGLM(Sepal.Length ~ ., data = Data, family = "gamma", link = "log")

### init
BranchGLM(Sepal.Length ~ ., data = Data, family = "gamma", link = "log", 
init = rep(0, 6), maxit = 50, tol = 1e-6, contrasts = NULL)

### method
BranchGLM(Sepal.Length ~ ., data = Data, family = "gamma", link = "log", 
init = rep(0, 6), maxit = 50, tol = 1e-6, contrasts = NULL, method = "LBFGS")

### offset
BranchGLM(Sepal.Length ~ ., data = Data, family = "gamma", link = "log", 
init = rep(0, 6), maxit = 50, tol = 1e-6, contrasts = NULL, 
offset = Data$Sepal.Width)

## Using BranchGLM.fit
x &lt;- model.matrix(Sepal.Length ~ ., data = Data)
y &lt;- Data$Sepal.Length
BranchGLM.fit(x, y, family = "gamma", link = "log", init = rep(0, 6), 
maxit = 50, tol = 1e-6, offset = Data$Sepal.Width)


</code></pre>

<hr>
<h2 id='BranchGLM-defunct'>Defunct functions in BranchGLM</h2><span id='topic+BranchGLM-defunct'></span><span id='topic+fit.summary.BranchGLMVS'></span><span id='topic+fit.BranchGLMVS'></span>

<h3>Description</h3>

<p>These functions are defunct and no longer available.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.summary.BranchGLMVS(...)

fit.BranchGLMVS(...)
</code></pre>


<h3>Details</h3>

<p>Defunct functions are: <a href="#topic+fit.BranchGLMVS">fit.BranchGLMVS</a> and <a href="#topic+fit.summary.BranchGLMVS">fit.summary.BranchGLMVS</a>
</p>

<hr>
<h2 id='BranchGLM-internal'>Internal BranchGLM Functions</h2><span id='topic+BranchGLM-internal'></span><span id='topic+BranchGLMFit'></span><span id='topic+MetricIntervalCpp'></span><span id='topic+SwitchBranchAndBoundCpp'></span><span id='topic+BranchAndBoundCpp'></span><span id='topic+BackwardBranchAndBoundCpp'></span><span id='topic+ForwardCpp'></span><span id='topic+BackwardCpp'></span><span id='topic+MakeTable'></span><span id='topic+MakeTableFactor2'></span><span id='topic+CindexCpp'></span><span id='topic+CindexTrap'></span><span id='topic+ROCCpp'></span>

<h3>Description</h3>

<p>Internal BranchGLM Functions.
</p>


<h3>Details</h3>

<p>These are not intended for use by users, these are Rcpp functions
that do not check the arguments, so improper usage may result in R crashing.
</p>

<hr>
<h2 id='Cindex'>Cindex/AUC</h2><span id='topic+Cindex'></span><span id='topic+AUC'></span><span id='topic+Cindex.numeric'></span><span id='topic+Cindex.BranchGLM'></span><span id='topic+Cindex.BranchGLMROC'></span>

<h3>Description</h3>

<p>Calculates the c-index/AUC.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Cindex(object, ...)

AUC(object, ...)

## S3 method for class 'numeric'
Cindex(object, y, ...)

## S3 method for class 'BranchGLM'
Cindex(object, ...)

## S3 method for class 'BranchGLMROC'
Cindex(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Cindex_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object, a <code>BranchGLMROC</code> object, or a numeric vector.</p>
</td></tr>
<tr><td><code id="Cindex_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="Cindex_+3A_y">y</code></td>
<td>
<p>Observed values, can be a numeric vector of 0s and 1s, a two-level
factor vector, or a logical vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses trapezoidal rule to calculate AUC when given a BranchGLMROC object and
uses Mann-Whitney U to calculate it otherwise. The trapezoidal rule method is less accurate,
so the two methods may give different results.
</p>


<h3>Value</h3>

<p>A number corresponding to the c-index/AUC.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- ToothGrowth
Fit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "logit")
Cindex(Fit)
AUC(Fit)
</code></pre>

<hr>
<h2 id='coef.BranchGLM'>Extract Coefficients from BranchGLM Objects</h2><span id='topic+coef.BranchGLM'></span>

<h3>Description</h3>

<p>Extracts beta coefficients from BranchGLM objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="coef.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A named vector with the corresponding coefficient estimates.
</p>

<hr>
<h2 id='coef.BranchGLMVS'>Extract Coefficients from BranchGLMVS or summary.BranchGLMVS Objects</h2><span id='topic+coef.BranchGLMVS'></span><span id='topic+coef.summary.BranchGLMVS'></span>

<h3>Description</h3>

<p>Extracts beta coefficients from BranchGLMVS or summary.BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMVS'
coef(object, which = 1, ...)

## S3 method for class 'summary.BranchGLMVS'
coef(object, which = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.BranchGLMVS_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLMVS</code> or <code>summary.BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="coef.BranchGLMVS_+3A_which">which</code></td>
<td>
<p>a numeric vector of indices or &quot;all&quot; to indicate which models to
get coefficients from, the default is 1 which is used for the best model. For
the branch and bound algorithms the number k is used for the kth best model
and for the stepwise algorithms the number k is used for the model that is k - 1 steps
away from the final model.</p>
</td></tr>
<tr><td><code id="coef.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix with the corresponding coefficient estimates.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, 
family = "gaussian", link = "identity")

# Doing branch and bound selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", 
bestmodels = 10, showprogress = FALSE)

## Getting coefficients from best model
coef(VS, which = 1)

## Getting coefficients from all best models
coef(VS, which = "all")

</code></pre>

<hr>
<h2 id='confint.BranchGLM'>Likelihood Ratio Confidence Intervals for Beta Coefficients for BranchGLM Objects</h2><span id='topic+confint.BranchGLM'></span>

<h3>Description</h3>

<p>Finds profile likelihood ratio confidence intervals for beta
coefficients with the ability to calculate the intervals in parallel.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
confint(object, parm, level = 0.95, parallel = FALSE, nthreads = 8, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="confint.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="confint.BranchGLM_+3A_parm">parm</code></td>
<td>
<p>a specification of which parameters are to be given confidence intervals,
either a vector of numbers or a vector of names. If missing, all parameters are considered.</p>
</td></tr>
<tr><td><code id="confint.BranchGLM_+3A_level">level</code></td>
<td>
<p>the confidence level required.</p>
</td></tr>
<tr><td><code id="confint.BranchGLM_+3A_parallel">parallel</code></td>
<td>
<p>a logical value to indicate if parallelization should be used.</p>
</td></tr>
<tr><td><code id="confint.BranchGLM_+3A_nthreads">nthreads</code></td>
<td>
<p>a positive integer to denote the number of threads used with OpenMP,
only used if <code>parallel = TRUE</code>.</p>
</td></tr>
<tr><td><code id="confint.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Endpoints of the confidence intervals that couldn't be found by the algorithm
are filled in with NA. When there is a lot of multicollinearity in the data
the algorithm may have problems finding many of the intervals.
</p>


<h3>Value</h3>

<p>An object of class <code>BranchGLMCIs</code> which is a list with the following components.
</p>
<table>
<tr><td><code>CIs</code></td>
<td>
<p> a numeric matrix with the confidence intervals</p>
</td></tr>
<tr><td><code>level</code></td>
<td>
<p> the supplied level</p>
</td></tr>
<tr><td><code>MLE</code></td>
<td>
<p> a numeric vector of the MLEs of the coefficients</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+plot.BranchGLMCIs">plot.BranchGLMCIs</a>, <a href="#topic+plotCI">plotCI</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
### Fitting linear regression model
mymodel &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

### Getting confidence intervals
CIs &lt;- confint(mymodel, level = 0.95)
CIs

### Plotting CIs
plot(CIs, mary = 7, cex.y = 0.9)

</code></pre>

<hr>
<h2 id='formula.BranchGLM'>Extract Model Formula from BranchGLM Objects</h2><span id='topic+formula.BranchGLM'></span>

<h3>Description</h3>

<p>Extracts model formula from BranchGLM objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
formula(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formula.BranchGLM_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="formula.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a formula representing the model used to obtain <code>object</code>.
</p>

<hr>
<h2 id='logLik.BranchGLM'>Extract Log-Likelihood from BranchGLM Objects</h2><span id='topic+logLik.BranchGLM'></span>

<h3>Description</h3>

<p>Extracts log-likelihood from BranchGLM objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="logLik.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>logLik</code> which is a number corresponding to
the log-likelihood with the following attributes: &quot;df&quot; (degrees of freedom)
and &quot;nobs&quot; (number of observations).
</p>

<hr>
<h2 id='MultipleROCCurves'>Plotting Multiple ROC Curves</h2><span id='topic+MultipleROCCurves'></span>

<h3>Description</h3>

<p>Plotting Multiple ROC Curves
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MultipleROCCurves(
  ...,
  legendpos = "bottomright",
  title = "ROC Curves",
  colors = NULL,
  names = NULL,
  lty = 1,
  lwd = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MultipleROCCurves_+3A_...">...</code></td>
<td>
<p>any number of <code>BranchGLMROC</code> objects.</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_legendpos">legendpos</code></td>
<td>
<p>a keyword to describe where to place the legend, such as &quot;bottomright&quot;.
The default is &quot;bottomright&quot;</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_title">title</code></td>
<td>
<p>title for the plot.</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_colors">colors</code></td>
<td>
<p>vector of colors to be used on the ROC curves.</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_names">names</code></td>
<td>
<p>vector of names used to create a legend for the ROC curves.</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_lty">lty</code></td>
<td>
<p>vector of linetypes used to create the ROC curves or a
single linetype to be used for all ROC curves.</p>
</td></tr>
<tr><td><code id="MultipleROCCurves_+3A_lwd">lwd</code></td>
<td>
<p>vector of linewidths used to create the ROC curves or a
single linewidth to be used for all ROC curves.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This only produces a plot, nothing is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- ToothGrowth

### Logistic ROC
LogisticFit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "logit")
LogisticROC &lt;- ROC(LogisticFit)

### Probit ROC
ProbitFit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "probit")
ProbitROC &lt;- ROC(ProbitFit)

### Cloglog ROC
CloglogFit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "cloglog")
CloglogROC &lt;- ROC(CloglogFit)

### Plotting ROC curves

MultipleROCCurves(LogisticROC, ProbitROC, CloglogROC, 
                  names = c("Logistic ROC", "Probit ROC", "Cloglog ROC"))

</code></pre>

<hr>
<h2 id='nobs.BranchGLM'>Extract Number of Observations from BranchGLM Objects</h2><span id='topic+nobs.BranchGLM'></span>

<h3>Description</h3>

<p>Extracts number of observations from BranchGLM objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
nobs(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nobs.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="nobs.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A single number indicating the number of observations used to fit the model.
</p>

<hr>
<h2 id='plot.BranchGLMCIs'>Plot Method for BranchGLMCIs Objects</h2><span id='topic+plot.BranchGLMCIs'></span>

<h3>Description</h3>

<p>Creates a plot to visualize confidence intervals from BranchGLMCIs objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMCIs'
plot(x, which = "all", mary = 5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BranchGLMCIs_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMCIs</code> object.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMCIs_+3A_which">which</code></td>
<td>
<p>which intervals to plot, can use a numeric vector of indices, a
character vector of names of desired variables, or &quot;all&quot; to plot all intervals.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMCIs_+3A_mary">mary</code></td>
<td>
<p>a numeric value used to determine how large to make margin of y-axis. If variable
names are cut-off, consider increasing this from the default value of 5.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMCIs_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="#topic+plotCI">plotCI</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This only produces a plot, nothing is returned.
</p>


<h3>See Also</h3>

<p><a href="#topic+plotCI">plotCI</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
### Fitting linear regression model
mymodel &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

### Getting confidence intervals
CIs &lt;- confint(mymodel, level = 0.95)
CIs

### Plotting CIs
plot(CIs, mary = 7, cex.y = 0.9)

</code></pre>

<hr>
<h2 id='plot.BranchGLMROC'>Plot Method for BranchGLMROC Objects</h2><span id='topic+plot.BranchGLMROC'></span>

<h3>Description</h3>

<p>This plots a ROC curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMROC'
plot(x, xlab = "1 - Specificity", ylab = "Sensitivity", type = "l", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BranchGLMROC_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMROC</code> object.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMROC_+3A_xlab">xlab</code></td>
<td>
<p>label for the x-axis.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMROC_+3A_ylab">ylab</code></td>
<td>
<p>label for the y-axis.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMROC_+3A_type">type</code></td>
<td>
<p>what type of plot to draw, see more details at <a href="graphics.html#topic+plot.default">plot.default</a>.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMROC_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="graphics.html#topic+plot.default">plot.default</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This only produces a plot, nothing is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- ToothGrowth
Fit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "logit")
MyROC &lt;- ROC(Fit)
plot(MyROC)
</code></pre>

<hr>
<h2 id='plot.BranchGLMVS'>Plot Method for summary.BranchGLMVS and BranchGLMVS Objects</h2><span id='topic+plot.BranchGLMVS'></span><span id='topic+plot.summary.BranchGLMVS'></span>

<h3>Description</h3>

<p>Creates plots to help visualize variable selection results from
BranchGLMVS or summary.BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMVS'
plot(
  x,
  ptype = "both",
  marnames = 7,
  addLines = TRUE,
  type = "b",
  horiz = FALSE,
  cex.names = 1,
  cex.lab = 1,
  cex.axis = 1,
  cex.legend = 1,
  cols = c("deepskyblue", "indianred", "forestgreen"),
  ...
)

## S3 method for class 'summary.BranchGLMVS'
plot(
  x,
  ptype = "both",
  marnames = 7,
  addLines = TRUE,
  type = "b",
  horiz = FALSE,
  cex.names = 1,
  cex.lab = 1,
  cex.axis = 1,
  cex.legend = 1,
  cols = c("deepskyblue", "indianred", "forestgreen"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.BranchGLMVS_+3A_x">x</code></td>
<td>
<p>a <code>summary.BranchGLMVS</code> or <code>BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_ptype">ptype</code></td>
<td>
<p>the type of plot to produce, look at details for more explanation.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_marnames">marnames</code></td>
<td>
<p>a numeric value used to determine how large to make margin of axis with variable
names, this is only for the &quot;variables&quot; plot. If variable names are cut-off,
consider increasing this from the default value of 7.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_addlines">addLines</code></td>
<td>
<p>a logical value to indicate whether or not to add black lines to
separate the models for the &quot;variables&quot; plot. This is typically useful for smaller
amounts of models, but can be annoying if there are many models.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_type">type</code></td>
<td>
<p>what type of plot to draw for the &quot;metrics&quot; plot, see more details at <a href="graphics.html#topic+plot.default">plot.default</a>.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_horiz">horiz</code></td>
<td>
<p>a logical value to indicate whether models should be displayed horizontally for the &quot;variables&quot; plot.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_cex.names">cex.names</code></td>
<td>
<p>how big to make variable names in the &quot;variables&quot; plot.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_cex.lab">cex.lab</code></td>
<td>
<p>how big to make axis labels.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_cex.axis">cex.axis</code></td>
<td>
<p>how big to make axis annotation.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_cex.legend">cex.legend</code></td>
<td>
<p>how big to make legend labels.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_cols">cols</code></td>
<td>
<p>the colors used to create the &quot;variables&quot; plot. Should be a character
vector of length 3, the first color will be used for included variables,
the second color will be used for excluded variables, and the third color will
be used for kept variables.</p>
</td></tr>
<tr><td><code id="plot.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="graphics.html#topic+plot.default">plot.default</a> for the &quot;metrics&quot; plot
and <a href="graphics.html#topic+image.default">image.default</a> for the &quot;variables&quot; plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The different values for ptype are as follows
</p>

<ul>
<li><p> &quot;metrics&quot; for a plot that displays the metric values ordered by rank for the branch and bound algorithms
or a plot which displays the metric values in the path taken by the stepwise algorithms
</p>
</li>
<li><p> &quot;variables&quot; for a plot that displays which variables are in each of the top models for the branch and bound algorithms
or a plot which displays the path taken by the stepwise algorithms
</p>
</li>
<li><p> &quot;both&quot; for both plots
</p>
</li></ul>

<p>If there are so many models that the &quot;variables&quot; plot appears to be
entirely black, then set addLines to FALSE.
</p>


<h3>Value</h3>

<p>This only produces plots, nothing is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

# Doing branch and bound selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", bestmodels = 10, 
showprogress = FALSE)
VS

## Getting summary of the process
Summ &lt;- summary(VS)
Summ

## Plotting the BIC of best models
plot(Summ, type = "b", ptype = "metrics")

## Plotting the BIC of the best models 
plot(Summ, ptype = "variables")

### Alternative colors
plot(Summ, ptype = "variables", 
cols = c("yellowgreen", "purple1", "grey50"))

### Smaller text size for names
plot(Summ, ptype = "variables", cex.names = 0.75)

</code></pre>

<hr>
<h2 id='plotCI'>Plot Confidence Intervals</h2><span id='topic+plotCI'></span>

<h3>Description</h3>

<p>Creates a plot to display confidence intervals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotCI(
  CIs,
  points = NULL,
  ylab = "",
  ylas = 2,
  cex.y = 1,
  decreasing = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotCI_+3A_cis">CIs</code></td>
<td>
<p>a numeric matrix of confidence intervals, must have exactly 2 columns.
The variable names displayed in the plot are taken from the column names.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_points">points</code></td>
<td>
<p>points to be plotted in the middle of the CIs, typically means or medians.
The default is to plot the midpoints of the intervals.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_ylab">ylab</code></td>
<td>
<p>a label for the y-axis.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_ylas">ylas</code></td>
<td>
<p>the style of the y-axis label, see more about this at <code>las</code> in <a href="graphics.html#topic+par">par</a>.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_cex.y">cex.y</code></td>
<td>
<p>font size used for variable names on y-axis.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_decreasing">decreasing</code></td>
<td>
<p>a logical value indicating if confidence intervals should be
displayed in decreasing or increasing order according to points. Can use NA
if no ordering is desired.</p>
</td></tr>
<tr><td><code id="plotCI_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="graphics.html#topic+plot.default">plot.default</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This only produces a plot, nothing is returned.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
### Fitting linear regression model
mymodel &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

### Getting confidence intervals
CIs &lt;- confint.default(mymodel, level = 0.95)
xlim &lt;- c(min(CIs), max(CIs))

### Plotting CIs
par(mar = c(5, 7, 3, 1) + 0.1)
plotCI(CIs, main = "95% Confidence Intervals", xlim = xlim, cex.y = 0.9, 
xlab = "Beta Coefficients")
abline(v = 0)

</code></pre>

<hr>
<h2 id='predict.BranchGLM'>Predict Method for BranchGLM Objects</h2><span id='topic+predict.BranchGLM'></span>

<h3>Description</h3>

<p>Obtains predictions from <code>BranchGLM</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
predict(
  object,
  newdata = NULL,
  offset = NULL,
  type = "response",
  na.action = na.pass,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="predict.BranchGLM_+3A_newdata">newdata</code></td>
<td>
<p>a data.frame, if not specified then the data the model was fit on is used.</p>
</td></tr>
<tr><td><code id="predict.BranchGLM_+3A_offset">offset</code></td>
<td>
<p>a numeric vector containing the offset variable, this is ignored if
newdata is not supplied.</p>
</td></tr>
<tr><td><code id="predict.BranchGLM_+3A_type">type</code></td>
<td>
<p>one of &quot;linpreds&quot; which is on the scale of the linear predictors or
&quot;response&quot; which is on the scale of the response variable. If not specified,
then &quot;response&quot; is used.</p>
</td></tr>
<tr><td><code id="predict.BranchGLM_+3A_na.action">na.action</code></td>
<td>
<p>a function which indicates what should happen when the data
contains NAs. The default is <code>na.pass</code>. This is ignored if newdata is not
supplied and data isn't included in the supplied <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="predict.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of predictions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- airquality

# Example without offset
Fit &lt;- BranchGLM(Temp ~ ., data = Data, family = "gaussian", link = "identity")

## Using default na.action
predict(Fit)

## Using na.omit
predict(Fit, na.action = na.omit)

## Using new data
predict(Fit, newdata = Data[1:20, ], na.action = na.pass)

# Using offset
FitOffset &lt;- BranchGLM(Temp ~ . - Day, data = Data, family = "gaussian", 
link = "identity", offset = Data$Day * -0.1)

## Getting predictions for data used to fit model
### Don't need to supply offset vector
predict(FitOffset)

## Getting predictions for new dataset
### Need to include new offset vector since we are 
### getting predictions for new dataset
predict(FitOffset, newdata = Data[1:20, ], offset = Data$Day[1:20] * -0.1)

</code></pre>

<hr>
<h2 id='predict.BranchGLMVS'>Predict Method for BranchGLMVS or summary.BranchGLMVS Objects</h2><span id='topic+predict.BranchGLMVS'></span><span id='topic+predict.summary.BranchGLMVS'></span>

<h3>Description</h3>

<p>Obtains predictions from BranchGLMVS or summary.BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMVS'
predict(object, which = 1, ...)

## S3 method for class 'summary.BranchGLMVS'
predict(object, which = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.BranchGLMVS_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLMVS</code> or <code>summary.BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="predict.BranchGLMVS_+3A_which">which</code></td>
<td>
<p>a positive integer to indicate which model to get predictions from,
the default is 1 which is used for the best model. For the branch and bound
algorithms the number k is used for the kth best model and for the stepwise algorithms
the number k is used for the model that is k - 1 steps away from the final model.</p>
</td></tr>
<tr><td><code id="predict.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>further arguments passed to <a href="#topic+predict.BranchGLM">predict.BranchGLM</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector of predictions.
</p>


<h3>See Also</h3>

<p><a href="#topic+predict.BranchGLM">predict.BranchGLM</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, 
family = "gamma", link = "log")

# Doing branch and bound selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", 
bestmodels = 10, showprogress = FALSE)

## Getting predictions from best model
predict(VS, which = 1)

## Getting linear predictors from 5th best model
predict(VS, which = 5, type = "linpreds")

</code></pre>

<hr>
<h2 id='print.BranchGLM'>Print Method for BranchGLM Objects</h2><span id='topic+print.BranchGLM'></span>

<h3>Description</h3>

<p>Print method for <code>BranchGLM</code> objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
print(x, coefdigits = 4, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BranchGLM_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="print.BranchGLM_+3A_coefdigits">coefdigits</code></td>
<td>
<p>number of digits to display for coefficients table.</p>
</td></tr>
<tr><td><code id="print.BranchGLM_+3A_digits">digits</code></td>
<td>
<p>number of digits to display for information after table.</p>
</td></tr>
<tr><td><code id="print.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>BranchGLM</code> object.
</p>

<hr>
<h2 id='print.BranchGLMCIs'>Print Method for BranchGLMCIs Objects</h2><span id='topic+print.BranchGLMCIs'></span>

<h3>Description</h3>

<p>Print method for BranchGLMCIs objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMCIs'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BranchGLMCIs_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMCIs</code> object.</p>
</td></tr>
<tr><td><code id="print.BranchGLMCIs_+3A_digits">digits</code></td>
<td>
<p>number of significant digits to display.</p>
</td></tr>
<tr><td><code id="print.BranchGLMCIs_+3A_...">...</code></td>
<td>
<p>further arguments passed from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>BranchGLMCIs</code> object.
</p>

<hr>
<h2 id='print.BranchGLMROC'>Print Method for BranchGLMROC Objects</h2><span id='topic+print.BranchGLMROC'></span>

<h3>Description</h3>

<p>Print method for BranchGLMROC objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMROC'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BranchGLMROC_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMROC</code> object.</p>
</td></tr>
<tr><td><code id="print.BranchGLMROC_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>BranchGLMROC</code> object.
</p>

<hr>
<h2 id='print.BranchGLMTable'>Print Method for BranchGLMTable Objects</h2><span id='topic+print.BranchGLMTable'></span>

<h3>Description</h3>

<p>Print method for BranchGLMTable objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMTable'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BranchGLMTable_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMTable</code> object.</p>
</td></tr>
<tr><td><code id="print.BranchGLMTable_+3A_digits">digits</code></td>
<td>
<p>number of digits to display.</p>
</td></tr>
<tr><td><code id="print.BranchGLMTable_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>BranchGLMTable</code> object.
</p>

<hr>
<h2 id='print.BranchGLMVS'>Print Method for BranchGLMVS Objects</h2><span id='topic+print.BranchGLMVS'></span>

<h3>Description</h3>

<p>Print method for BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMVS'
print(x, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BranchGLMVS_+3A_x">x</code></td>
<td>
<p>a <code>BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="print.BranchGLMVS_+3A_digits">digits</code></td>
<td>
<p>number of digits to display.</p>
</td></tr>
<tr><td><code id="print.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>BranchGLMVS</code> object.
</p>

<hr>
<h2 id='print.summary.BranchGLMVS'>Print Method for summary.BranchGLMVS Objects</h2><span id='topic+print.summary.BranchGLMVS'></span>

<h3>Description</h3>

<p>Print method for summary.BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.BranchGLMVS'
print(x, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.BranchGLMVS_+3A_x">x</code></td>
<td>
<p>a <code>summary.BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="print.summary.BranchGLMVS_+3A_digits">digits</code></td>
<td>
<p>number of digits to display.</p>
</td></tr>
<tr><td><code id="print.summary.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The supplied <code>summary.BranchGLMVS</code> object.
</p>

<hr>
<h2 id='ROC'>ROC Curve</h2><span id='topic+ROC'></span><span id='topic+ROC.numeric'></span><span id='topic+ROC.BranchGLM'></span>

<h3>Description</h3>

<p>Creates an ROC curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ROC(object, ...)

## S3 method for class 'numeric'
ROC(object, y, ...)

## S3 method for class 'BranchGLM'
ROC(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ROC_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object or a numeric vector.</p>
</td></tr>
<tr><td><code id="ROC_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="ROC_+3A_y">y</code></td>
<td>
<p>observed values, can be a numeric vector of 0s and 1s, a two-level
factor vector, or a logical vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>BranchGLMROC</code> object which can be plotted with <code>plot()</code>. The AUC can also
be calculated using <code>AUC()</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- ToothGrowth
Fit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "logit")
MyROC &lt;- ROC(Fit)
plot(MyROC)
</code></pre>

<hr>
<h2 id='summary.BranchGLMVS'>Summary Method for BranchGLMVS Objects</h2><span id='topic+summary.BranchGLMVS'></span>

<h3>Description</h3>

<p>Summary method for BranchGLMVS objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLMVS'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.BranchGLMVS_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLMVS</code> object.</p>
</td></tr>
<tr><td><code id="summary.BranchGLMVS_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>summary.BranchGLMVS</code> which is a list with the
following components
</p>
<table>
<tr><td><code>results</code></td>
<td>
<p> a data.frame which has the metric values for the best models along
with the sets of variables included in each model</p>
</td></tr>
<tr><td><code>VS</code></td>
<td>
<p> the supplied <code>BranchGLMVS</code> object</p>
</td></tr>
<tr><td><code>formulas</code></td>
<td>
<p> a list containing the formulas of the best models</p>
</td></tr>
<tr><td><code>metric</code></td>
<td>
<p> the metric used to perform variable selection</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+plot.summary.BranchGLMVS">plot.summary.BranchGLMVS</a>, <a href="#topic+coef.summary.BranchGLMVS">coef.summary.BranchGLMVS</a>, <a href="#topic+predict.summary.BranchGLMVS">predict.summary.BranchGLMVS</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Data &lt;- iris
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", link = "identity")

# Doing branch and bound selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", 
bestmodels = 10, showprogress = FALSE)
VS

## Getting summary of the process
Summ &lt;- summary(VS)
Summ

## Plotting the BIC of the best models
plot(Summ, type = "b")

## Plotting the variables in the best models
plot(Summ, ptype = "variables")

## Getting coefficients
coef(Summ)
 
</code></pre>

<hr>
<h2 id='Table'>Confusion Matrix</h2><span id='topic+Table'></span><span id='topic+Table.numeric'></span><span id='topic+Table.BranchGLM'></span>

<h3>Description</h3>

<p>Creates a confusion matrix and calculates related measures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Table(object, ...)

## S3 method for class 'numeric'
Table(object, y, cutoff = 0.5, ...)

## S3 method for class 'BranchGLM'
Table(object, cutoff = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Table_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object or a numeric vector.</p>
</td></tr>
<tr><td><code id="Table_+3A_...">...</code></td>
<td>
<p>further arguments passed to other methods.</p>
</td></tr>
<tr><td><code id="Table_+3A_y">y</code></td>
<td>
<p>observed values, can be a numeric vector of 0s and 1s, a two-level factor vector, or
a logical vector.</p>
</td></tr>
<tr><td><code id="Table_+3A_cutoff">cutoff</code></td>
<td>
<p>cutoff for predicted values, the default is 0.5.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>BranchGLMTable</code> object which is a list with the following components
</p>
<table>
<tr><td><code>table</code></td>
<td>
<p> a matrix corresponding to the confusion matrix</p>
</td></tr>
<tr><td><code>accuracy</code></td>
<td>
<p> a number corresponding to the accuracy</p>
</td></tr>
<tr><td><code>sensitivity</code></td>
<td>
<p> a number corresponding to the sensitivity</p>
</td></tr>
<tr><td><code>specificity</code></td>
<td>
<p> a number corresponding to the specificity</p>
</td></tr>
<tr><td><code>PPV</code></td>
<td>
<p> a number corresponding to the positive predictive value</p>
</td></tr>
<tr><td><code>levels</code></td>
<td>
<p> a vector corresponding to the levels of the response variable</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- ToothGrowth
Fit &lt;- BranchGLM(supp ~ ., data = Data, family = "binomial", link = "logit")
Table(Fit)
</code></pre>

<hr>
<h2 id='VariableSelection'>Variable Selection for GLMs</h2><span id='topic+VariableSelection'></span><span id='topic+VariableSelection.formula'></span><span id='topic+VariableSelection.BranchGLM'></span>

<h3>Description</h3>

<p>Performs forward selection, backward elimination, and efficient
best subset variable selection with information criterion for generalized linear
models (GLMs). Best subset selection is performed with branch and bound algorithms
to greatly speed up the process.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VariableSelection(object, ...)

## S3 method for class 'formula'
VariableSelection(
  object,
  data,
  family,
  link,
  offset = NULL,
  method = "Fisher",
  type = "switch branch and bound",
  metric = "AIC",
  bestmodels = NULL,
  cutoff = NULL,
  keep = NULL,
  keepintercept = TRUE,
  maxsize = NULL,
  grads = 10,
  parallel = FALSE,
  nthreads = 8,
  tol = 1e-06,
  maxit = NULL,
  contrasts = NULL,
  showprogress = TRUE,
  ...
)

## S3 method for class 'BranchGLM'
VariableSelection(
  object,
  type = "switch branch and bound",
  metric = "AIC",
  bestmodels = NULL,
  cutoff = NULL,
  keep = NULL,
  keepintercept = TRUE,
  maxsize = NULL,
  parallel = FALSE,
  nthreads = 8,
  showprogress = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="VariableSelection_+3A_object">object</code></td>
<td>
<p>a formula or a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_...">...</code></td>
<td>
<p>further arguments.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_data">data</code></td>
<td>
<p>a data.frame, list or environment (or object coercible by
<a href="base.html#topic+as.data.frame">as.data.frame</a> to a data.frame), containing the variables in formula.
Neither a matrix nor an array will be accepted.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_family">family</code></td>
<td>
<p>the distribution used to model the data, one of &quot;gaussian&quot;, &quot;gamma&quot;,
&quot;binomial&quot;, or &quot;poisson&quot;.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_link">link</code></td>
<td>
<p>the link used to link the mean structure to the linear predictors. One of
&quot;identity&quot;, &quot;logit&quot;, &quot;probit&quot;, &quot;cloglog&quot;, &quot;sqrt&quot;, &quot;inverse&quot;, or &quot;log&quot;.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_offset">offset</code></td>
<td>
<p>the offset vector, by default the zero vector is used.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_method">method</code></td>
<td>
<p>one of &quot;Fisher&quot;, &quot;BFGS&quot;, or &quot;LBFGS&quot;. Fisher's scoring is recommended
for forward selection and the branch and bound algorithms since they will typically
fit many models with a small number of covariates.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_type">type</code></td>
<td>
<p>one of &quot;forward&quot;, &quot;backward&quot;, &quot;branch and bound&quot;, &quot;backward branch and bound&quot;, or &quot;switch branch and bound&quot;
to indicate the type of variable selection to perform. The default value is
&quot;switch branch and bound&quot;. See more about these algorithms in details</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_metric">metric</code></td>
<td>
<p>the metric used to choose the best models, the default is &quot;AIC&quot;,
but &quot;BIC&quot; and &quot;HQIC&quot; are also available. AIC is the Akaike information criterion,
BIC is the Bayesian information criterion, and HQIC is the Hannan-Quinn information
criterion.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_bestmodels">bestmodels</code></td>
<td>
<p>a positive integer to indicate the number of the best models to
find according to the chosen metric or NULL. If this is NULL, then cutoff is
used instead. This is only used for the branch and bound algorithms.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_cutoff">cutoff</code></td>
<td>
<p>a non-negative number which indicates that the function
should return all models that have a metric value within cutoff of the
best metric value or NULL. Only one of this or bestmodels should be specified and
when both are NULL a cutoff of 0 is used. This is only used for the branch
and bound algorithms.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_keep">keep</code></td>
<td>
<p>a character vector of names to denote variables that must be in the models.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_keepintercept">keepintercept</code></td>
<td>
<p>a logical value to indicate whether to keep the intercept in
all models, only used if an intercept is included in the formula.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_maxsize">maxsize</code></td>
<td>
<p>a positive integer to denote the maximum number of variables to
consider in a single model, the default is the total number of variables.
This number adds onto any variables specified in keep. This argument only works
for <code>type = "forward"</code> and <code>type = "branch and bound"</code>. This argument is now
deprecated.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_grads">grads</code></td>
<td>
<p>a positive integer to denote the number of gradients used to
approximate the inverse information with, only for <code>method = "LBFGS"</code>..</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_parallel">parallel</code></td>
<td>
<p>a logical value to indicate if parallelization should be used.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_nthreads">nthreads</code></td>
<td>
<p>a positive integer to denote the number of threads used with OpenMP,
only used if <code>parallel = TRUE</code>.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_tol">tol</code></td>
<td>
<p>a positive number to denote the tolerance used to determine model convergence.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_maxit">maxit</code></td>
<td>
<p>a positive integer to denote the maximum number of iterations performed.
The default for Fisher's scoring is 50 and for the other methods the default is 200.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_contrasts">contrasts</code></td>
<td>
<p>see <code>contrasts.arg</code> of <code>model.matrix.default</code>.</p>
</td></tr>
<tr><td><code id="VariableSelection_+3A_showprogress">showprogress</code></td>
<td>
<p>a logical value to indicate whether to show progress updates
for branch and bound algorithms.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Variable Selection Details</h4>

<p>The supplied formula or the formula from the fitted model is
treated as the upper model. The variables specified in keep along with an
intercept (if included in formula and keepintercept = TRUE) is the lower model.
Factor variables are either kept in their entirety or entirely removed and
interaction terms are properly handled. All observations that have any missing
values in the upper model are removed.
</p>



<h4>Branch and Bound Algorithms</h4>

<p>The branch and bound algorithm is an efficient algorithm used to find the optimal
models. The backward branch and bound algorithm is very similar to
the branch and bound algorithm, except it tends to be faster when the best models
contain most of the variables. The switch branch and bound algorithm is a
combination of the two algorithms and is typically the fastest of the 3 branch and
bound algorithms. All of the branch and bound algorithms are guaranteed to find
the optimal models (up to numerical precision).
</p>



<h4>GLM Fitting</h4>

<p>Fisher's scoring is recommended for branch and bound selection and forward selection.
L-BFGS may be faster for backward elimination especially when there are many variables.
</p>



<h3>Value</h3>

<p>A <code>BranchGLMVS</code> object which is a list with the following components
</p>
<table>
<tr><td><code>initmodel</code></td>
<td>
<p> the <code>BranchGLM</code> object corresponding to the upper model</p>
</td></tr>
<tr><td><code>numchecked</code></td>
<td>
<p> number of models fit</p>
</td></tr>
<tr><td><code>names</code></td>
<td>
<p> character vector of the names of the predictor variables</p>
</td></tr>
<tr><td><code>order</code></td>
<td>
<p> the order the variables were added to the model or removed from the model, this is only included for the stepwise algorithms</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p> type of variable selection employed</p>
</td></tr>
<tr><td><code>optType</code></td>
<td>
<p> whether the type specified used a heuristic or exact algorithm</p>
</td></tr>
<tr><td><code>metric</code></td>
<td>
<p> metric used to select best models</p>
</td></tr>
<tr><td><code>bestmodels</code></td>
<td>
<p> numeric matrix used to describe the best models for the branch and bound algorithms
or a numeric matrix describing the models along the path taken for stepwise algorithms</p>
</td></tr>
<tr><td><code>bestmetrics</code></td>
<td>
<p> numeric vector with the best metrics found in the search for the branch and bound algorithms
or a numeric vector with the metric values along the path taken for stepwise algorithms</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p> numeric matrix of beta coefficients for the models in bestmodels</p>
</td></tr>
<tr><td><code>cutoff</code></td>
<td>
<p> the cutoff that was used, this is set to -1 if bestmodels was used instead or if
a stepwise algorithm was used</p>
</td></tr>
<tr><td><code>keep</code></td>
<td>
<p> vector of which variables were kept through the selection process</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><a href="#topic+plot.BranchGLMVS">plot.BranchGLMVS</a>, <a href="#topic+coef.BranchGLMVS">coef.BranchGLMVS</a>, <a href="#topic+predict.BranchGLMVS">predict.BranchGLMVS</a>,
<a href="#topic+summary.BranchGLMVS">summary.BranchGLMVS</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Data &lt;- iris
Fit &lt;- BranchGLM(Sepal.Length ~ ., data = Data, family = "gaussian", 
link = "identity")

# Doing branch and bound selection 
VS &lt;- VariableSelection(Fit, type = "branch and bound", metric = "BIC", 
bestmodels = 10, showprogress = FALSE)
VS

## Plotting the BIC of the best models
plot(VS, type = "b")

## Getting the coefficients of the best model according to BIC
FinalModel &lt;- coef(VS, which = 1)
FinalModel

# Now doing it in parallel (although it isn't necessary for this dataset)
parVS &lt;- VariableSelection(Fit, type = "branch and bound", parallel = TRUE, 
metric = "BIC", bestmodels = 10, showprogress = FALSE)

## Getting the coefficients of the best model according to BIC
FinalModel &lt;- coef(parVS, which = 1)
FinalModel

# Using a formula
formVS &lt;- VariableSelection(Sepal.Length ~ ., data = Data, family = "gaussian", 
link = "identity", metric = "BIC", type = "branch and bound", bestmodels = 10, 
showprogress = FALSE)

## Getting the coefficients of the best model according to BIC
FinalModel &lt;- coef(formVS, which = 1)
FinalModel

# Using the keep argument
keepVS &lt;- VariableSelection(Fit, type = "branch and bound", 
keep = c("Species", "Petal.Width"), metric = "BIC", bestmodels = 4, 
showprogress = FALSE)
keepVS

## Getting the coefficients from the fourth best model according to BIC when 
## keeping Petal.Width and Species in every model
FinalModel &lt;- coef(keepVS, which = 4)
FinalModel

# Treating categorical variable beta parameters separately
## This function automatically groups together parameters from a categorical variable
## to avoid this, you need to create the indicator variables yourself
x &lt;- model.matrix(Sepal.Length ~ ., data = iris)
Sepal.Length &lt;- iris$Sepal.Length
Data &lt;- cbind.data.frame(Sepal.Length, x[, -1])
VSCat &lt;- VariableSelection(Sepal.Length ~ ., data = Data, family = "gaussian", 
link = "identity", metric = "BIC", bestmodels = 10, showprogress = FALSE)
VSCat

## Plotting results
plot(VSCat, cex.names = 0.75)

</code></pre>

<hr>
<h2 id='vcov.BranchGLM'>Extract covariance matrix from BranchGLM Objects</h2><span id='topic+vcov.BranchGLM'></span>

<h3>Description</h3>

<p>Extracts covariance matrix of beta coefficients from BranchGLM objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BranchGLM'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.BranchGLM_+3A_object">object</code></td>
<td>
<p>a <code>BranchGLM</code> object.</p>
</td></tr>
<tr><td><code id="vcov.BranchGLM_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric matrix which is the covariance matrix of the beta coefficients.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
