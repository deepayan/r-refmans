<!DOCTYPE html><html><head><title>Help for package ggseg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggseg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adapt_scales'><p>Scale ggseg plot axes.</p></a></li>
<li><a href='#as_brain_atlas'><p>Create brain atlas</p></a></li>
<li><a href='#as_ggseg_atlas'><p>Create ggseg atlas</p></a></li>
<li><a href='#aseg'><p>Freesurfer automatic subcortical segmentation of a brain volume</p></a></li>
<li><a href='#brain_atlas'><p>Constructor for brain atlas</p></a></li>
<li><a href='#brain_join'><p>Join atlas and data</p></a></li>
<li><a href='#brain_labels'><p>Extract unique labels of brain regions</p></a></li>
<li><a href='#brain_pal'><p>Generate palettes from the ggseg atlases</p></a></li>
<li><a href='#brain_pals_info'><p>Get info on brain palettes</p></a></li>
<li><a href='#brain_regions'><p>Extract unique names of brain regions</p></a></li>
<li><a href='#dk'><p>Desikan-Killiany Cortical Atlas</p></a></li>
<li><a href='#geom_brain'><p>Brain geom</p></a></li>
<li><a href='#ggseg'><p>ggseg: Plot brain segmentations with ggplot</p></a></li>
<li><a href='#ggseg_atlas'><p>'ggseg_atlas' class</p></a></li>
<li><a href='#is_brain_atlas'><p>Validate brain atlas</p></a></li>
<li><a href='#is_ggseg_atlas'><p>Validate ggseg_atlas</p></a></li>
<li><a href='#position_brain'><p>Alter brain atlas position</p></a></li>
<li><a href='#read_atlas_files'><p>Read in atlas data from all subjects</p></a></li>
<li><a href='#read_freesurfer_stats'><p>Read in raw FreeSurfer stats file</p></a></li>
<li><a href='#read_freesurfer_table'><p>Read in stats table from FreeSurfer</p></a></li>
<li><a href='#reposition_brain'><p>Reposition brain slices</p></a></li>
<li><a href='#scale_brain'><p>Colour and fill scales from the ggseg atlases</p></a></li>
<li><a href='#scale_brain2'><p>Colour and fill scales from the ggseg atlases</p></a></li>
<li><a href='#scale_continous_brain'><p>Axis and label scales from the ggseg atlases</p></a></li>
<li><a href='#theme_brain'><p>ggseg plot theme</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Plotting Tool for Brain Atlases</td>
</tr>
<tr>
<td>Version:</td>
<td>1.6.5</td>
</tr>
<tr>
<td>Description:</td>
<td>Contains 'ggplot2' geom for plotting brain atlases using 
    simple features. The largest component of the package is the data 
    for the two built-in atlases. Mowinckel &amp; Vidal-Piñeiro (2020)
    &lt;<a href="https://doi.org/10.1177%2F2515245920928009">doi:10.1177/2515245920928009</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.3)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LazyDataCompression:</td>
<td>xz</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2 (&ge; 3.3), dplyr (&ge; 1.0.0), tidyr (&ge; 1.0.0), sf (&ge;
0.9-2), stats, grid, utils, vctrs</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, here, rmarkdown, covr, vdiffr, devtools, testthat (&ge;
2.1.0), spelling</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ggseg/ggseg">https://github.com/ggseg/ggseg</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ggseg/ggseg/issues">https://github.com/ggseg/ggseg/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11, GDAL (&gt;= 2.0.1), GEOS (&gt;= 3.4.0), PROJ (&gt;=
4.8.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-13 10:19:42 UTC; athanasm</td>
</tr>
<tr>
<td>Author:</td>
<td>Athanasia Mo Mowinckel
    <a href="https://orcid.org/0000-0002-5756-0223"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Didac Vidal-Piñeiro
    <a href="https://orcid.org/0000-0001-9997-9156"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Athanasia Mo Mowinckel &lt;a.m.mowinckel@psykologi.uio.no&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-13 11:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adapt_scales'>Scale ggseg plot axes.</h2><span id='topic+adapt_scales'></span>

<h3>Description</h3>

<p><code>adapt_scales</code> returns a list of coordinate breaks and labels
for axes or axes label manipulation of the ggseg brain atlases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adapt_scales(geobrain, position = "dispersed", aesthetics = "labs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="adapt_scales_+3A_geobrain">geobrain</code></td>
<td>
<p>a data.frame containing atlas information.</p>
</td></tr>
<tr><td><code id="adapt_scales_+3A_position">position</code></td>
<td>
<p>String choosing how to view the data. Either &quot;dispersed&quot;[default] or &quot;stacked&quot;.</p>
</td></tr>
<tr><td><code id="adapt_scales_+3A_aesthetics">aesthetics</code></td>
<td>
<p>String of which aesthetics to adapt scale of, either &quot;x&quot;,&quot;y&quot;, or &quot;labs&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nested list with coordinates for labels
</p>

<hr>
<h2 id='as_brain_atlas'>Create brain atlas</h2><span id='topic+as_brain_atlas'></span>

<h3>Description</h3>

<p>Coerce object into an object of class
'brain_atlas'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_brain_atlas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_brain_atlas_+3A_x">x</code></td>
<td>
<p>object to make into a brain_atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'brain_atlas'.
</p>

<hr>
<h2 id='as_ggseg_atlas'>Create ggseg atlas</h2><span id='topic+as_ggseg_atlas'></span><span id='topic+as_ggseg_atlas.default'></span><span id='topic+as_ggseg_atlas.data.frame'></span><span id='topic+as_ggseg_atlas.ggseg_atlas'></span><span id='topic+as_ggseg_atlas.brain_atlas'></span>

<h3>Description</h3>

<p>Create ggseg atlas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_ggseg_atlas(x)

## Default S3 method:
as_ggseg_atlas(x)

## S3 method for class 'data.frame'
as_ggseg_atlas(x)

## S3 method for class 'ggseg_atlas'
as_ggseg_atlas(x)

## S3 method for class 'brain_atlas'
as_ggseg_atlas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as_ggseg_atlas_+3A_x">x</code></td>
<td>
<p>object to make into a ggseg_atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class 'ggseg_atlas'
</p>

<hr>
<h2 id='aseg'>Freesurfer automatic subcortical segmentation of a brain volume</h2><span id='topic+aseg'></span>

<h3>Description</h3>

<p>Coordinate data for the subcortical parcellations implemented
in Freesurfer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aseg)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>brain_atlas</code> of length 4.
</p>


<h3>Value</h3>

<p>An object of class 'brain_atlas' for plotting with ggseg
</p>


<h3>References</h3>

<p>Fischl et al., (2002). Neuron, 33:341-355
(<a href="https://www.pubmed.ncbi.nlm.nih.gov/11832223">PubMed</a>)
</p>


<h3>See Also</h3>

<p>Other ggseg_atlases: 
<code><a href="#topic+dk">dk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aseg)
</code></pre>

<hr>
<h2 id='brain_atlas'>Constructor for brain atlas</h2><span id='topic+brain_atlas'></span>

<h3>Description</h3>

<p>Creates an object of class 'brain_atlas'
that is compatible for plotting using the
ggseg-package plot functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_atlas(atlas, type, data, palette = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_atlas_+3A_atlas">atlas</code></td>
<td>
<p>atlas short name, length one</p>
</td></tr>
<tr><td><code id="brain_atlas_+3A_type">type</code></td>
<td>
<p>atlas type, cortical or subcortical, length one</p>
</td></tr>
<tr><td><code id="brain_atlas_+3A_data">data</code></td>
<td>
<p>data.frame with atlas data</p>
</td></tr>
<tr><td><code id="brain_atlas_+3A_palette">palette</code></td>
<td>
<p>named character vector of colours</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class 'brain_atlas' containing information
on atlas name, type, data and palette. To be used in plotting
with <code><a href="#topic+geom_brain">geom_brain</a></code>.
</p>

<hr>
<h2 id='brain_join'>Join atlas and data</h2><span id='topic+brain_join'></span>

<h3>Description</h3>

<p>Joins data frame with a brain-atlas
object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_join(data, atlas, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_join_+3A_data">data</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="brain_join_+3A_atlas">atlas</code></td>
<td>
<p>atlas data</p>
</td></tr>
<tr><td><code id="brain_join_+3A_by">by</code></td>
<td>
<p>optional character vector of column to join by</p>
</td></tr>
</table>


<h3>Value</h3>

<p>either an sf-object (if brain atlas) or a tibble (if ggseg-atlas)
with merged atlas and data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>someData = data.frame(
    region = c("transverse temporal", "insula",
                "precentral","superior parietal"),
    p = sample(seq(0,.5,.001), 4),
    stringsAsFactors = FALSE)

brain_join(someData, dk)
brain_join(someData, dk, "region")

</code></pre>

<hr>
<h2 id='brain_labels'>Extract unique labels of brain regions</h2><span id='topic+brain_labels'></span><span id='topic+brain_labels.ggseg_atlas'></span><span id='topic+brain_labels.brain_atlas'></span>

<h3>Description</h3>

<p>Convenience function to extract names of
brain labels from a <code><a href="#topic+brain_atlas">brain_atlas</a></code>.
Brain labels are usually default naming obtained
from the original atlas data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_labels(x)

## S3 method for class 'ggseg_atlas'
brain_labels(x)

## S3 method for class 'brain_atlas'
brain_labels(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_labels_+3A_x">x</code></td>
<td>
<p>brain atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of atlas region labels
</p>

<hr>
<h2 id='brain_pal'>Generate palettes from the ggseg atlases</h2><span id='topic+brain_pal'></span>

<h3>Description</h3>

<p><code>brain_pal</code> return HEX colours for the different ggseg atlases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_pal(name, n = "all", direction = 1, unname = FALSE, package = "ggseg")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_pal_+3A_name">name</code></td>
<td>
<p>String name of atlas</p>
</td></tr>
<tr><td><code id="brain_pal_+3A_n">n</code></td>
<td>
<p>Number of colours to return (or &quot;all&quot; [default])</p>
</td></tr>
<tr><td><code id="brain_pal_+3A_direction">direction</code></td>
<td>
<p>Direction of  HEX, -1 reverses order
Necessary if applying palette to other data than the brain atlas it comes from.</p>
</td></tr>
<tr><td><code id="brain_pal_+3A_unname">unname</code></td>
<td>
<p>return unnamed vector (default = FALSE)</p>
</td></tr>
<tr><td><code id="brain_pal_+3A_package">package</code></td>
<td>
<p>package to get brain_pals data from (ggseg or ggsegExtra)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of colours
</p>


<h3>Examples</h3>

<pre><code class='language-R'>brain_pal("dk")
brain_pal("aseg")
</code></pre>

<hr>
<h2 id='brain_pals_info'>Get info on brain palettes</h2><span id='topic+brain_pals_info'></span>

<h3>Description</h3>

<p>Get info on brain palettes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_pals_info(package = "ggseg")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_pals_info_+3A_package">package</code></td>
<td>
<p>package to get brain_pals data from (ggseg or ggsegExtra)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame with palette information
</p>


<h3>Examples</h3>

<pre><code class='language-R'>brain_pals_info()
</code></pre>

<hr>
<h2 id='brain_regions'>Extract unique names of brain regions</h2><span id='topic+brain_regions'></span><span id='topic+brain_regions.ggseg_atlas'></span><span id='topic+brain_regions.brain_atlas'></span><span id='topic+brain_regions.data.frame'></span>

<h3>Description</h3>

<p>Convenience function to extract names of
brain regions from a <code><a href="#topic+brain_atlas">brain_atlas</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>brain_regions(x)

## S3 method for class 'ggseg_atlas'
brain_regions(x)

## S3 method for class 'brain_atlas'
brain_regions(x)

## S3 method for class 'data.frame'
brain_regions(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="brain_regions_+3A_x">x</code></td>
<td>
<p>brain atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of brain region names
</p>

<hr>
<h2 id='dk'>Desikan-Killiany Cortical Atlas</h2><span id='topic+dk'></span>

<h3>Description</h3>

<p>Coordinate data for the Desikan-Killiany Cortical atlas,
with 40 regions in on the cortical surface of the brain.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(dk)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>brain_atlas</code> of length 4.
</p>


<h3>Value</h3>

<p>An object of class 'brain_atlas' for plotting with ggseg
</p>


<h3>References</h3>

<p>Fischl et al. (2004) Cerebral Cortex 14:11-22
(<a href="https://academic.oup.com/cercor/article/14/1/11/433466">PubMed</a>)
</p>


<h3>See Also</h3>

<p>Other ggseg_atlases: 
<code><a href="#topic+aseg">aseg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dk)
</code></pre>

<hr>
<h2 id='geom_brain'>Brain geom</h2><span id='topic+geom_brain'></span><span id='topic+GeomBrain'></span>

<h3>Description</h3>

<p>call to <code><a href="ggplot2.html#topic+geom_sf">geom_sf</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_brain(
  mapping = aes(),
  data = NULL,
  atlas,
  hemi = NULL,
  side = NULL,
  position = position_brain(),
  show.legend = NA,
  inherit.aes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="geom_brain_+3A_mapping">mapping</code></td>
<td>
<p>argument to pass to <code><a href="ggplot2.html#topic+aes">aes</a></code> to map
variables from the supplied data to the plot</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_data">data</code></td>
<td>
<p>data.frame with data to plot</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_atlas">atlas</code></td>
<td>
<p>object of type brain_atlas to plot</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_hemi">hemi</code></td>
<td>
<p>hemisphere to plot. Defaults to everything in the atlas.</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_side">side</code></td>
<td>
<p>slice to plot, as recorded in the &quot;side&quot; column in the atlas data. Defaults to all.</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_position">position</code></td>
<td>
<p>position of the data. Default is &quot;identity&quot; but can be
changed by <code><a href="#topic+position_brain">position_brain</a></code>.</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_show.legend">show.legend</code></td>
<td>
<p>logical. Should legend be added or not.</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>logical. if aes should be inherited from the
main ggplot call or not</p>
</td></tr>
<tr><td><code id="geom_brain_+3A_...">...</code></td>
<td>
<p>arguments to <code><a href="ggplot2.html#topic+geom_sf">geom_sf</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot() +
 geom_brain(atlas = dk)
</code></pre>

<hr>
<h2 id='ggseg'>ggseg: Plot brain segmentations with ggplot</h2><span id='topic+ggseg'></span><span id='topic+ggseg-package'></span>

<h3>Description</h3>

<p>Plotting results from analyses done on data derived from brain
segmentations is a common need, but may be quite laborious.
Results from such analyses are usually easier to interpret if
the plot can mimic the shape and position in the brain it
represents.
</p>
<p><code>ggseg</code> plots and returns a ggplot object of plotted
aparc regions. Is superseded by the new <code><a href="#topic+geom_brain">geom_brain</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggseg(
  .data = NULL,
  atlas = "dk",
  position = "dispersed",
  view = NULL,
  hemisphere = NULL,
  adapt_scales = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggseg_+3A_.data">.data</code></td>
<td>
<p>A .data.frame to use for plot aesthetics. Should include a
column called &quot;region&quot; corresponding to aparc regions.</p>
</td></tr>
<tr><td><code id="ggseg_+3A_atlas">atlas</code></td>
<td>
<p>Either a string with the name of atlas to use,
or a .data.frame containing atlas information (i.e. pre-loaded atlas).</p>
</td></tr>
<tr><td><code id="ggseg_+3A_position">position</code></td>
<td>
<p>String choosing how to view the .data. Either &quot;dispersed&quot;[default] or &quot;stacked&quot;.</p>
</td></tr>
<tr><td><code id="ggseg_+3A_view">view</code></td>
<td>
<p>String to choose view of the .data. Any of c(&quot;lateral&quot;,&quot;medial&quot;)[default].</p>
</td></tr>
<tr><td><code id="ggseg_+3A_hemisphere">hemisphere</code></td>
<td>
<p>String to choose hemisphere to plot. Any of c(&quot;left&quot;,&quot;right&quot;)[default].</p>
</td></tr>
<tr><td><code id="ggseg_+3A_adapt_scales">adapt_scales</code></td>
<td>
<p>if <code>TRUE</code>, then the axes will
be hemisphere without ticks.  If <code>FALSE</code>, then will be latitude
longitude values.  Also affected by <code>position</code> argument</p>
</td></tr>
<tr><td><code id="ggseg_+3A_...">...</code></td>
<td>
<p>other options sent to geom_polygon for plotting, including
mapping aes (cannot include x, y, and group aesthetics).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This package contains data from various brain parcellations,
with convenient functions to inspect the results directly on
a brain-plot wither with ggplot (2D polygons).
</p>

<dl>
<dt>'dk'</dt><dd>
<p>The Desikan-Killiany Cortical Atlas [default], FreeSurfer cortical segmentations.</p>
</dd>
<dt>'aseg'</dt><dd>
<p>FreeSurfer automatic subcortical segmentation of a brain volume</p>
</dd>
</dl>



<h3>Value</h3>

<p>a ggplot object
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Athanasia Mo Mowinckel <a href="mailto:a.m.mowinckel@psykologi.uio.no">a.m.mowinckel@psykologi.uio.no</a> (<a href="https://orcid.org/0000-0002-5756-0223">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Didac Vidal-Piñeiro <a href="mailto:d.v.pineiro@psykologi.uio.no">d.v.pineiro@psykologi.uio.no</a> (<a href="https://orcid.org/0000-0001-9997-9156">ORCID</a>)
</p>
</li></ul>

<p>Athanasia Mo Mowinckel and Didac Vidal-Piñeiro
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ggseg/ggseg">https://github.com/ggseg/ggseg</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ggseg/ggseg/issues">https://github.com/ggseg/ggseg/issues</a>
</p>
</li></ul>

<p>[ggplot2][ggplot], [aes][aes],
[geom_polygon][geom_polygon], [coord_fixed][coord_fixed]
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
ggseg()
ggseg(mapping=aes(fill=region))
ggseg(colour="black", size=.7, mapping=aes(fill=region)) + theme_void()
ggseg(position = "stacked")
ggseg(adapt_scales = FALSE)

</code></pre>

<hr>
<h2 id='ggseg_atlas'>'ggseg_atlas' class</h2><span id='topic+ggseg_atlas'></span>

<h3>Description</h3>

<p>The 'ggseg_atlas' class is a subclass of ['data.frame'][data.frame()],
created in order to have different default behaviour. It heavily relies on
the &quot;tibble&quot; ['tbl_df'][tibble()].
[tidyverse](https://www.tidyverse.org/packages/), including
[dplyr](http://dplyr.tidyverse.org/),
[ggplot2](http://ggplot2.tidyverse.org/),
[tidyr](http://tidyr.tidyverse.org/), and
[readr](http://readr.tidyverse.org/).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ggseg_atlas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ggseg_atlas_+3A_x">x</code></td>
<td>
<p>data.frame to be made a ggseg-atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a tibble with polygon coordinates for plotting brain regions
</p>


<h3>Properties of 'ggseg_atlas'</h3>

<p>Objects of class 'ggseg_atlas' have:
* A 'class' attribute of 'c(&quot;ggseg_atlas&quot;, &quot;tbl_df&quot;, &quot;tbl&quot;, &quot;data.frame&quot;)'.
* A base type of '&quot;list&quot;', where each element of the list has the same
[NROW()].
* A lot of this script and its functions are taken from the
['tibble'][tibble()]-package
</p>

<hr>
<h2 id='is_brain_atlas'>Validate brain atlas</h2><span id='topic+is_brain_atlas'></span>

<h3>Description</h3>

<p>Validate brain atlas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_brain_atlas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_brain_atlas_+3A_x">x</code></td>
<td>
<p>an object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical if object is of class 'brain_atlas'
</p>

<hr>
<h2 id='is_ggseg_atlas'>Validate ggseg_atlas</h2><span id='topic+is_ggseg_atlas'></span>

<h3>Description</h3>

<p>Validate ggseg_atlas
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_ggseg_atlas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_ggseg_atlas_+3A_x">x</code></td>
<td>
<p>an object</p>
</td></tr>
</table>


<h3>Value</h3>

<p>logical if object is of class 'ggseg_atlas'
</p>

<hr>
<h2 id='position_brain'>Alter brain atlas position</h2><span id='topic+position_brain'></span>

<h3>Description</h3>

<p>Function to be used in the position argument in geom_brain
to alter the position of the brain slice/views.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>position_brain(position = "horizontal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="position_brain_+3A_position">position</code></td>
<td>
<p>formula describing the rows ~ columns organisation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a ggproto object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)
ggplot() +
  geom_brain(atlas = dk, aes(fill = region),
             position = position_brain(. ~ side + hemi ),
             show.legend = FALSE)

ggplot() +
  geom_brain(atlas = dk, aes(fill = region),
             position = position_brain(side ~ hemi ),
             show.legend = FALSE)
</code></pre>

<hr>
<h2 id='read_atlas_files'>Read in atlas data from all subjects</h2><span id='topic+read_atlas_files'></span>

<h3>Description</h3>

<p>Recursively reads in all stats files for
an atlas (given a unique character string),
for all subjects in the subjects directory.
Will add hemisphere and subject id to the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_atlas_files(subjects_dir, atlas)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_atlas_files_+3A_subjects_dir">subjects_dir</code></td>
<td>
<p>FreeSurfer subject directory</p>
</td></tr>
<tr><td><code id="read_atlas_files_+3A_atlas">atlas</code></td>
<td>
<p>unique character combination identifying the atlas</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with stats information for subjects from FreeSurfer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
subj_dir &lt;- "/path/to/freesurfer/7.2.0/subjects/"
read_atlas_files(subj_dir, "aseg.stats")

read_atlas_files(subj_dir, "lh.aparc.stats")

## End(Not run)
</code></pre>

<hr>
<h2 id='read_freesurfer_stats'>Read in raw FreeSurfer stats file</h2><span id='topic+read_freesurfer_stats'></span>

<h3>Description</h3>

<p>FreeSurfer atlas stats files have a format
that can be difficult to easily read in to R.
This function takes a raw stats-file from the
subjects directory and reads it in as a
data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_freesurfer_stats(path, rename = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_freesurfer_stats_+3A_path">path</code></td>
<td>
<p>path to stats file</p>
</td></tr>
<tr><td><code id="read_freesurfer_stats_+3A_rename">rename</code></td>
<td>
<p>logical. rename headers for ggseg compatibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with stats information for subjects from FreeSurfer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
subj_dir &lt;- "/path/to/freesurfer/7.2.0/subjects/"
aseg_stats &lt;- file.path(subj_dir, "bert/stats/aseg.stats")
read_freesurfer_stats(aseg_stats)

## End(Not run)
</code></pre>

<hr>
<h2 id='read_freesurfer_table'>Read in stats table from FreeSurfer</h2><span id='topic+read_freesurfer_table'></span>

<h3>Description</h3>

<p>FreeSurfer has functions to create
tables from raw stats files. If you have
data already merged using the <code>aparcstats2table</code>
or <code>asegstats2table</code> from FreeSurfer,
this function will read in the data and prepare it
for ggseg.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_freesurfer_table(path, measure = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_freesurfer_table_+3A_path">path</code></td>
<td>
<p>path to the table file</p>
</td></tr>
<tr><td><code id="read_freesurfer_table_+3A_measure">measure</code></td>
<td>
<p>which measure is the table of</p>
</td></tr>
<tr><td><code id="read_freesurfer_table_+3A_...">...</code></td>
<td>
<p>additional arguments to <code>read.table</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>tibble with stats information for subjects from FreeSurfer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
file_path &lt;- "all_subj_aseg.txt"
read_freesurfer_table(file_path)

## End(Not run)
</code></pre>

<hr>
<h2 id='reposition_brain'>Reposition brain slices</h2><span id='topic+reposition_brain'></span>

<h3>Description</h3>

<p>Function for repositioning
pre-joined atlas data (i.e. data and atlas
already joined to a single data frame).
This makes it possible for users to
reposition the geometry data for the atlas
for control over final plot layout. For even
more detailed control over the positioning,
the &quot;hemi&quot; and &quot;side&quot; columns should be
converted into factors and ordered by wanted
order of appearance.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reposition_brain(data, position = "horizontal")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reposition_brain_+3A_data">data</code></td>
<td>
<p>sf-data.frame of joined brain atlas and data</p>
</td></tr>
<tr><td><code id="reposition_brain_+3A_position">position</code></td>
<td>
<p>position formula for slices</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sf-data.frame with repositioned slices
</p>


<h3>Examples</h3>

<pre><code class='language-R'>reposition_brain(dk, hemi ~ side)
reposition_brain(dk, side ~ hemi)
reposition_brain(dk, hemi + side ~ .)
reposition_brain(dk, . ~ hemi + side)
</code></pre>

<hr>
<h2 id='scale_brain'>Colour and fill scales from the ggseg atlases</h2><span id='topic+scale_brain'></span><span id='topic+scale_colour_brain'></span><span id='topic+scale_color_brain'></span><span id='topic+scale_fill_brain'></span>

<h3>Description</h3>

<p>The 'brain' palette scales provides scales for the different atlases in the
package. Colours are according to the colours used in the papers where the
atlases where first introduced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_brain(
  name = "dk",
  na.value = "grey",
  ...,
  aesthetics = c("fill", "colour", "color")
)

scale_colour_brain(...)

scale_color_brain(...)

scale_fill_brain(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_brain_+3A_name">name</code></td>
<td>
<p>String name of atlas</p>
</td></tr>
<tr><td><code id="scale_brain_+3A_na.value">na.value</code></td>
<td>
<p>String name or hex for the colour of NA entries</p>
</td></tr>
<tr><td><code id="scale_brain_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code><a href="#topic+brain_pal">brain_pal</a></code></p>
</td></tr>
<tr><td><code id="scale_brain_+3A_aesthetics">aesthetics</code></td>
<td>
<p>String vector of which aesthetics to scale c(&quot;colour&quot;, &quot;color&quot;, &quot;fill&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scaling function for altering colour of ggplot aesthetics
</p>


<h3>Palettes</h3>

<p>The following palettes are available for use with these scales:
</p>

<dl>
<dt>ggseg - </dt><dd><p>dk, aseg</p>
</dd>
<dt>ggsegExtra - </dt><dd><p>tracula, jhu, yeo7, yeo17, glasser, chenAr, chenTh,</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>scale_brain()
scale_colour_brain()
scale_fill_brain()

</code></pre>

<hr>
<h2 id='scale_brain2'>Colour and fill scales from the ggseg atlases</h2><span id='topic+scale_brain2'></span><span id='topic+scale_colour_brain2'></span><span id='topic+scale_color_brain2'></span><span id='topic+scale_fill_brain2'></span>

<h3>Description</h3>

<p>The 'brain' palette scales provides scales for the different atlases in the
package. Colours are according to the colours used in the papers where the
atlases where first introduced.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_brain2(
  palette,
  na.value = "grey",
  ...,
  aesthetics = c("fill", "colour", "color")
)

scale_colour_brain2(...)

scale_color_brain2(...)

scale_fill_brain2(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_brain2_+3A_palette">palette</code></td>
<td>
<p>named character vector of regions and colours</p>
</td></tr>
<tr><td><code id="scale_brain2_+3A_na.value">na.value</code></td>
<td>
<p>String name or hex for the colour of NA entries</p>
</td></tr>
<tr><td><code id="scale_brain2_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code><a href="#topic+brain_pal">brain_pal</a></code></p>
</td></tr>
<tr><td><code id="scale_brain2_+3A_aesthetics">aesthetics</code></td>
<td>
<p>String vector of which aesthetics to scale c(&quot;colour&quot;, &quot;color&quot;, &quot;fill&quot;).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>scaling function for altering colour of ggplot aesthetics
</p>


<h3>Palettes</h3>

<p>The following palettes are available for use with these scales:
</p>

<dl>
<dt>ggseg - </dt><dd><p>dk, aseg</p>
</dd>
<dt>ggsegExtra - </dt><dd><p>tracula, jhu, yeo7, yeo17, glasser, chenAr, chenTh,</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>scale_brain()
scale_colour_brain()
scale_fill_brain()

</code></pre>

<hr>
<h2 id='scale_continous_brain'>Axis and label scales from the ggseg atlases</h2><span id='topic+scale_continous_brain'></span><span id='topic+scale_x_brain'></span><span id='topic+scale_y_brain'></span><span id='topic+scale_labs_brain'></span>

<h3>Description</h3>

<p>The 'brain' axis and label scales provides scales for the different atlases in the
package. These add axis labels and tick labels corresponding to the different atlases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scale_continous_brain(
  atlas = dk,
  position = "dispersed",
  aesthetics = c("y", "x")
)

scale_x_brain(...)

scale_y_brain(...)

scale_labs_brain(atlas = dk, position = "dispersed", aesthetics = "labs")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="scale_continous_brain_+3A_atlas">atlas</code></td>
<td>
<p>data.frame containing the atlas</p>
</td></tr>
<tr><td><code id="scale_continous_brain_+3A_position">position</code></td>
<td>
<p>Character of either &quot;dispersed&quot; or &quot;stacked&quot;.</p>
</td></tr>
<tr><td><code id="scale_continous_brain_+3A_aesthetics">aesthetics</code></td>
<td>
<p>String vector of which aesthetics to scale &quot;x&quot;, &quot;y&quot;, or &quot;labs&quot;.</p>
</td></tr>
<tr><td><code id="scale_continous_brain_+3A_...">...</code></td>
<td>
<p>additional arguments to pass to <code><a href="#topic+adapt_scales">adapt_scales</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a scaling function to alter continuous axes labels in ggplot2
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
scale_x_brain()
scale_y_brain()
scale_labs_brain()

## End(Not run)

</code></pre>

<hr>
<h2 id='theme_brain'>ggseg plot theme</h2><span id='topic+theme_brain'></span><span id='topic+theme_darkbrain'></span><span id='topic+theme_custombrain'></span><span id='topic+theme_brain2'></span>

<h3>Description</h3>

<p>a set of themes created for the ggseg plots. Use theme() to tweak.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>theme_brain(text.size = 12, text.family = "mono")

theme_darkbrain(text.size = 12, text.family = "mono")

theme_custombrain(
  plot.background = "white",
  text.colour = "darkgrey",
  text.size = 12,
  text.family = "mono"
)

theme_brain2(
  plot.background = "white",
  text.colour = "darkgrey",
  text.size = 12,
  text.family = "mono"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="theme_brain_+3A_text.size">text.size</code></td>
<td>
<p>Specify size of plot text</p>
</td></tr>
<tr><td><code id="theme_brain_+3A_text.family">text.family</code></td>
<td>
<p>Specify font family</p>
</td></tr>
<tr><td><code id="theme_brain_+3A_plot.background">plot.background</code></td>
<td>
<p>Specify fill of plot background ('theme_custombrain' only)</p>
</td></tr>
<tr><td><code id="theme_brain_+3A_text.colour">text.colour</code></td>
<td>
<p>Specify colour of plot text</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt>'theme_brain'</dt><dd>
<p>Default theme for ggseg. Transparent background, no axis lines, and no grid.</p>
</dd>
<dt>'theme_darkbrain'</dt><dd>
<p>Dark equivalent to theme_brain, with black background, and light text.</p>
</dd>
<dt>'theme_custombrain'</dt><dd>
<p>Theme for easy customisation of the brain themes.</p>
</dd>
</dl>



<h3>Value</h3>

<p>function that alters the themeing of a ggplot object
</p>


<h3>Author(s)</h3>

<p>Athanasia Mo Mowinckel
</p>


<h3>See Also</h3>

<p>[ggplot()], [aes()], [geom_polygon()], [coord_fixed()] from the ggplot2 package
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ggplot2)

ggplot() +
  geom_brain(atlas = dk) +
  theme_brain()

  geom_brain(atlas = dk) +
  theme_darkbrain()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
