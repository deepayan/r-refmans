<!DOCTYPE html><html><head><title>Help for package CIARA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CIARA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CIARA'><p>CIARA</p></a></li>
<li><a href='#CIARA_gene'><p>CIARA_gene</p></a></li>
<li><a href='#cluster_analysis_integrate_rare'><p>cluster_analysis_integrate_rare</p></a></li>
<li><a href='#cluster_analysis_sub'><p>cluster_analysis_sub</p></a></li>
<li><a href='#find_resolution'><p>find_resolution</p></a></li>
<li><a href='#get_background_full'><p>get_background_full</p></a></li>
<li><a href='#markers_cluster_seurat'><p>markers_cluster_seurat</p></a></li>
<li><a href='#merge_cluster'><p>merge_cluster</p></a></li>
<li><a href='#plot_balloon_marker'><p>plot_balloon_marker</p></a></li>
<li><a href='#plot_gene'><p>plot_gene</p></a></li>
<li><a href='#plot_genes_sum'><p>plot_genes_sum</p></a></li>
<li><a href='#plot_heatmap_marker'><p>plot_heatmap_marker</p></a></li>
<li><a href='#plot_interactive'><p>plot_interactive</p></a></li>
<li><a href='#plot_umap'><p>plot_umap</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#selection_localized_genes'><p>selection_localized_genes</p></a></li>
<li><a href='#test_hvg'><p>test_hvg</p></a></li>
<li><a href='#white_black_markers'><p>white_black_markers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cluster Independent Algorithm for Rare Cell Types Identification</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Gabriele Lubatti</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gabriele Lubatti
&lt;gabriele.lubatti@helmholtz-muenchen.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Identification of markers of rare cell types by looking at genes whose expression is confined in small regions of the expression space <a href="https://github.com/ScialdoneLab">https://github.com/ScialdoneLab</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Biobase, ggplot2, ggraph, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>circlize, clustree, ComplexHeatmap, plotly, Seurat (&ge; 4.0),
testthat, knitr, rmarkdown</td>
</tr>
<tr>
<td>biocViews:</td>
<td>software</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-22 11:07:19 UTC; gabriele.lubatti</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-22 20:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='CIARA'>CIARA</h2><span id='topic+CIARA'></span>

<h3>Description</h3>

<p>It selects highly localized genes as specified in <em>CIARA_gene</em>,
starting from genes in <em>background</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARA(
  norm_matrix,
  knn_matrix,
  background,
  cores_number = 1,
  p_value = 0.001,
  odds_ratio = 2,
  local_region = 1,
  approximation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARA_+3A_norm_matrix">norm_matrix</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="CIARA_+3A_knn_matrix">knn_matrix</code></td>
<td>
<p>K-nearest neighbors matrix (n_cells X n_cells).</p>
</td></tr>
<tr><td><code id="CIARA_+3A_background">background</code></td>
<td>
<p>Vector of genes for which the function <em>CIARA_gene</em>
is run.</p>
</td></tr>
<tr><td><code id="CIARA_+3A_cores_number">cores_number</code></td>
<td>
<p>Integer.Number of cores to use.</p>
</td></tr>
<tr><td><code id="CIARA_+3A_p_value">p_value</code></td>
<td>
<p>p value returned by the function <em>fisher.test</em> with
parameter alternative = &quot;g&quot;</p>
</td></tr>
<tr><td><code id="CIARA_+3A_odds_ratio">odds_ratio</code></td>
<td>
<p>odds_ratio returned by the function <em>fisher.test</em>
with parameter alternative = &quot;g&quot;</p>
</td></tr>
<tr><td><code id="CIARA_+3A_local_region">local_region</code></td>
<td>
<p>Integer. Minimum number of local regions (cell with its
knn neighbours) where the binarized gene expression is enriched in 1.</p>
</td></tr>
<tr><td><code id="CIARA_+3A_approximation">approximation</code></td>
<td>
<p>Logical.For a given gene, the fisher test is run in the
local regions of only the cells where the binarized gene expression is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Dataframe with n_rows equal to the length of
<em>background</em> . Each row is the output from <em>CIARA_gene</em>.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='CIARA_gene'>CIARA_gene</h2><span id='topic+CIARA_gene'></span>

<h3>Description</h3>

<p>The gene expression is binarized (1/0) if the value in a given cell is
above/below the median. Each of cell with its first K nearest neighbors
defined a local region. If there are at least <em>local_region</em> enriched
in 1 according to <em>fisher.test</em>, then the gene is defined as highly
localized and a final p value is assigned to it. The final p value is the
minimum of the p values from all the enriched local regions. If there are no
enriched local regions, then the p value by default is set to 1
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARA_gene(
  norm_matrix,
  knn_matrix,
  gene_expression,
  p_value = 0.001,
  odds_ratio = 2,
  local_region = 1,
  approximation = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARA_gene_+3A_norm_matrix">norm_matrix</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_knn_matrix">knn_matrix</code></td>
<td>
<p>K-nearest neighbors matrix (n_cells X n_cells).</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_gene_expression">gene_expression</code></td>
<td>
<p>numeric vector with the gene expression (length equal
to n_cells). The gene expression is binarized (equal to 0/1 in the cells
where the value is below/above the median)</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_p_value">p_value</code></td>
<td>
<p>p value returned by the function <em>fisher.test</em> with
parameter alternative = &quot;g&quot;</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_odds_ratio">odds_ratio</code></td>
<td>
<p>odds_ratio returned by the function <em>fisher.test</em>
with parameter alternative = &quot;g&quot;</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_local_region">local_region</code></td>
<td>
<p>Integer. Minimum number of local regions (cell with its
knn neighbours) where the binarized gene expression is enriched in 1.</p>
</td></tr>
<tr><td><code id="CIARA_gene_+3A_approximation">approximation</code></td>
<td>
<p>Logical.For a given gene, the fisher test is run in the
local regions of only the cells where the binarized gene expression is 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with one element corresponding to the p value of the gene.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test</a>
</p>

<hr>
<h2 id='cluster_analysis_integrate_rare'>cluster_analysis_integrate_rare</h2><span id='topic+cluster_analysis_integrate_rare'></span>

<h3>Description</h3>

<p>cluster_analysis_integrate_rare
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_analysis_integrate_rare(
  raw_counts,
  project_name,
  resolution,
  neighbors,
  max_dimension,
  feature_genes = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_raw_counts">raw_counts</code></td>
<td>
<p>Raw count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_project_name">project_name</code></td>
<td>
<p>Character name of the Seurat project.</p>
</td></tr>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_resolution">resolution</code></td>
<td>
<p>Numeric value specifying the parameter <em>resolution</em>
used in the Seurat function <em>FindClusters</em>.</p>
</td></tr>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_neighbors">neighbors</code></td>
<td>
<p>Numeric value specifying the parameter <em>k.param</em> in
the Seurat function <em>FindNeighbors</em></p>
</td></tr>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_max_dimension">max_dimension</code></td>
<td>
<p>Numeric value specifying the maximum number of the PCA
dimensions used in the parameter <em>dims</em> for the Seurat function
<em>FindNeighbors</em></p>
</td></tr>
<tr><td><code id="cluster_analysis_integrate_rare_+3A_feature_genes">feature_genes</code></td>
<td>
<p>vector of features specifying the argument
<em>features</em> in the Seurat function <em>RunPCA</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Seurat object including raw and normalized counts matrices, UMAP coordinates and cluster result.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindClusters">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindClusters</a>
<a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindNeighbors">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindNeighbors</a>
<a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/RunPCA">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/RunPCA</a>
</p>

<hr>
<h2 id='cluster_analysis_sub'>cluster_analysis_sub</h2><span id='topic+cluster_analysis_sub'></span>

<h3>Description</h3>

<p>cluster_analysis_sub
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cluster_analysis_sub(
  raw_counts,
  resolution,
  neighbors,
  max_dimension,
  name_cluster
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cluster_analysis_sub_+3A_raw_counts">raw_counts</code></td>
<td>
<p>Raw count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="cluster_analysis_sub_+3A_resolution">resolution</code></td>
<td>
<p>Numeric value specifying the parameter <em>resolution</em>
used in the Seurat function <em>FindClusters</em>.</p>
</td></tr>
<tr><td><code id="cluster_analysis_sub_+3A_neighbors">neighbors</code></td>
<td>
<p>Numeric value specifying the parameter <em>k.param</em> in
the Seurat function <em>FindNeighbors</em></p>
</td></tr>
<tr><td><code id="cluster_analysis_sub_+3A_max_dimension">max_dimension</code></td>
<td>
<p>Numeric value specifying the maximum number of the PCA
dimensions used in the parameter <em>dims</em> for the Seurat function
<em>FindNeighbors</em></p>
</td></tr>
<tr><td><code id="cluster_analysis_sub_+3A_name_cluster">name_cluster</code></td>
<td>
<p>Character.Name of the original cluster for which the sub
clustering is done.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Seurat object including raw and normalized counts matrices and cluster result.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/RunPCA">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/RunPCA</a>
<a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindVariableFeatures">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindVariableFeatures</a>
</p>

<hr>
<h2 id='find_resolution'>find_resolution</h2><span id='topic+find_resolution'></span>

<h3>Description</h3>

<p>find_resolution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_resolution(seurat_object, resolution_vector)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_resolution_+3A_seurat_object">seurat_object</code></td>
<td>
<p>Seurat object as returned by
<em>cluster_analysis_integrate_rare</em></p>
</td></tr>
<tr><td><code id="find_resolution_+3A_resolution_vector">resolution_vector</code></td>
<td>
<p>vector with all values of resolution for which the
Seurat function <em>FindClusters</em> is run</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Clustree object showing the connection between clusters obtained at different level of resolution as specified in <em>resolution_vector</em>.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=clustree">https://CRAN.R-project.org/package=clustree</a>
</p>

<hr>
<h2 id='get_background_full'>get_background_full</h2><span id='topic+get_background_full'></span>

<h3>Description</h3>

<p>get_background_full
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_background_full(
  norm_matrix,
  threshold = 1,
  n_cells_low = 3,
  n_cells_high = 20
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_background_full_+3A_norm_matrix">norm_matrix</code></td>
<td>
<p>Norm count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="get_background_full_+3A_threshold">threshold</code></td>
<td>
<p>threshold in expression for a given gene</p>
</td></tr>
<tr><td><code id="get_background_full_+3A_n_cells_low">n_cells_low</code></td>
<td>
<p>minimum number of cells where a gene is expressed at a
level above threshold</p>
</td></tr>
<tr><td><code id="get_background_full_+3A_n_cells_high">n_cells_high</code></td>
<td>
<p>maximum number of cells where a gene is expressed at a
level above threshold</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector with all genes expressed at a level higher than
<em>threshold</em> in a number of cells between <em>n_cells</em> and
<em>n_cells_high</em>.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='markers_cluster_seurat'>markers_cluster_seurat</h2><span id='topic+markers_cluster_seurat'></span>

<h3>Description</h3>

<p>The Seurat function <em>FindMarkers</em> is used to identify general marker
for each cluster (specific cluster vs all other cluster). This list of
markers is then filtered keeping only the genes that appear as markers in a
unique cluster.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>markers_cluster_seurat(seurat_object, cluster, cell_names, number_top)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="markers_cluster_seurat_+3A_seurat_object">seurat_object</code></td>
<td>
<p>Seurat object as returned by
<em>cluster_analysis_sub</em> or by <em>cluster_analysis_integrate_rare</em>.</p>
</td></tr>
<tr><td><code id="markers_cluster_seurat_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
<tr><td><code id="markers_cluster_seurat_+3A_cell_names">cell_names</code></td>
<td>
<p>Vector of length equal to the number of cells, with cell
names.</p>
</td></tr>
<tr><td><code id="markers_cluster_seurat_+3A_number_top">number_top</code></td>
<td>
<p>Integer. Number of top marker genes to keep for each
cluster.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of three elements. The first is a vector with <em>number_top</em>
marker genes for each cluster. The second is a vector with <em>number_top</em>
marker genes and corresponding cluster. The third element is a vector with
all marker genes for each cluster.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindMarkers">https://www.rdocumentation.org/packages/Seurat/versions/4.0.1/topics/FindMarkers</a>
</p>

<hr>
<h2 id='merge_cluster'>merge_cluster</h2><span id='topic+merge_cluster'></span>

<h3>Description</h3>

<p>merge_cluster
</p>


<h3>Usage</h3>

<pre><code class='language-R'>merge_cluster(old_cluster, new_cluster, max_number = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="merge_cluster_+3A_old_cluster">old_cluster</code></td>
<td>
<p>original cluster assignment that need to be updated</p>
</td></tr>
<tr><td><code id="merge_cluster_+3A_new_cluster">new_cluster</code></td>
<td>
<p>new cluster assignment that need to be integrated with
<em>old_cluster</em>.</p>
</td></tr>
<tr><td><code id="merge_cluster_+3A_max_number">max_number</code></td>
<td>
<p>Threshold in size for clusters in <em>new_cluster</em>. Only
cluster with number of cells smaller than <em>max_number</em> will be
integrated in <em>old cluster</em>. If <em>max_number</em> is NULL, then all the clusters in <em>new_cluster</em> are integrated in <em>old cluster</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of length equal to <em>old_cluster</em> showing the merged cluster assignment between <em>old cluster</em> and <em>new_cluster</em>.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='plot_balloon_marker'>plot_balloon_marker</h2><span id='topic+plot_balloon_marker'></span>

<h3>Description</h3>

<p>plot_balloon_marker
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_balloon_marker(
  norm_counts,
  cluster,
  marker_complete,
  max_number,
  max_size = 5,
  text_size = 7
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_balloon_marker_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="plot_balloon_marker_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
<tr><td><code id="plot_balloon_marker_+3A_marker_complete">marker_complete</code></td>
<td>
<p>Third element of the output list as
returned by the function <em>markers_cluster_seurat</em></p>
</td></tr>
<tr><td><code id="plot_balloon_marker_+3A_max_number">max_number</code></td>
<td>
<p>Integer. Maximum number of markers for each cluster for
which we want to plot the expression.</p>
</td></tr>
<tr><td><code id="plot_balloon_marker_+3A_max_size">max_size</code></td>
<td>
<p>Integer. Size of the dots to be plotted.</p>
</td></tr>
<tr><td><code id="plot_balloon_marker_+3A_text_size">text_size</code></td>
<td>
<p>Size of the text in the heatmap plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object showing balloon plot.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='plot_gene'>plot_gene</h2><span id='topic+plot_gene'></span>

<h3>Description</h3>

<p>Cells are coloured according to the expression of <em>gene_id</em> and plotted
according to <em>coordinate_umap</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_gene(norm_counts, coordinate_umap, gene_id, title_name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_gene_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="plot_gene_+3A_coordinate_umap">coordinate_umap</code></td>
<td>
<p>Data frame with dimensionality reduction coordinates.
Number of rows must be equal to the number of cells</p>
</td></tr>
<tr><td><code id="plot_gene_+3A_gene_id">gene_id</code></td>
<td>
<p>Character name of the gene.</p>
</td></tr>
<tr><td><code id="plot_gene_+3A_title_name">title_name</code></td>
<td>
<p>Character name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>
</p>

<hr>
<h2 id='plot_genes_sum'>plot_genes_sum</h2><span id='topic+plot_genes_sum'></span>

<h3>Description</h3>

<p>The sum of each gene in <em>genes_relevant</em> across all cells is first
normalized to 1. Then for each cell, the sum from the (normalized) genes
expression is computed and shown in the output plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_genes_sum(coordinate_umap, norm_counts, genes_relevant, name_title)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_genes_sum_+3A_coordinate_umap">coordinate_umap</code></td>
<td>
<p>Data frame with dimensionality reduction coordinates.
Number of rows must be equal to the number of cells</p>
</td></tr>
<tr><td><code id="plot_genes_sum_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="plot_genes_sum_+3A_genes_relevant">genes_relevant</code></td>
<td>
<p>Vector with gene names for which we want to visualize
the sum in each cell.</p>
</td></tr>
<tr><td><code id="plot_genes_sum_+3A_name_title">name_title</code></td>
<td>
<p>Character value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>
</p>

<hr>
<h2 id='plot_heatmap_marker'>plot_heatmap_marker</h2><span id='topic+plot_heatmap_marker'></span>

<h3>Description</h3>

<p>plot_heatmap_marker
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_heatmap_marker(
  marker_top,
  marker_all_cluster,
  cluster,
  condition,
  norm_counts,
  text_size
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_heatmap_marker_+3A_marker_top">marker_top</code></td>
<td>
<p>First element returned by <em>markers_cluster_seurat</em></p>
</td></tr>
<tr><td><code id="plot_heatmap_marker_+3A_marker_all_cluster">marker_all_cluster</code></td>
<td>
<p>Second element returned by
<em>markers_cluster_seurat</em></p>
</td></tr>
<tr><td><code id="plot_heatmap_marker_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
<tr><td><code id="plot_heatmap_marker_+3A_condition">condition</code></td>
<td>
<p>Vector or length equal to the number of cells, specifying
the condition of the cells (i.e. batch, dataset of origin..)</p>
</td></tr>
<tr><td><code id="plot_heatmap_marker_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="plot_heatmap_marker_+3A_text_size">text_size</code></td>
<td>
<p>Size of the text in the heatmap plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Heatmap class object.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/ComplexHeatmap/versions/1.10.2/topics/Heatmap">https://www.rdocumentation.org/packages/ComplexHeatmap/versions/1.10.2/topics/Heatmap</a>
</p>

<hr>
<h2 id='plot_interactive'>plot_interactive</h2><span id='topic+plot_interactive'></span>

<h3>Description</h3>

<p>It shows in an interactive plot which are the highly localized genes in each
cell. It is based on plotly library
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_interactive(
  coordinate_umap,
  color,
  text,
  min_x = NULL,
  max_x = NULL,
  min_y = NULL,
  max_y = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_interactive_+3A_coordinate_umap">coordinate_umap</code></td>
<td>
<p>Data frame with dimensionality reduction coordinates.
Number of rows must be equal to the number of cells</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_color">color</code></td>
<td>
<p>vector of length equal to n_rows in coordinate_umap.Each cell
will be coloured following a gradient according to the corresponding value
of this vector.</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_text">text</code></td>
<td>
<p>Character vector specifying the highly localized genes in each
cell. It is the output from <em>selection_localized_genes</em>.</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_min_x">min_x</code></td>
<td>
<p>Set the min limit on the x axis.</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_max_x">max_x</code></td>
<td>
<p>Set the max limit on the x axis.</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_min_y">min_y</code></td>
<td>
<p>Set the min limit on the y axis.</p>
</td></tr>
<tr><td><code id="plot_interactive_+3A_max_y">max_y</code></td>
<td>
<p>Set the min limit on the y axis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plotly object given by <em>plot_ly function</em> (from library <em>plotly</em>).
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://plotly.com/r/">https://plotly.com/r/</a>
</p>

<hr>
<h2 id='plot_umap'>plot_umap</h2><span id='topic+plot_umap'></span>

<h3>Description</h3>

<p>plot_umap
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_umap(coordinate_umap, cluster)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_umap_+3A_coordinate_umap">coordinate_umap</code></td>
<td>
<p>Data frame with dimensionality reduction coordinates.
Number of rows must be equal to the number of cells</p>
</td></tr>
<tr><td><code id="plot_umap_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot2 object.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://CRAN.R-project.org/package=ggplot2">https://CRAN.R-project.org/package=ggplot2</a>
</p>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+guide_edge_colourbar'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggraph</dt><dd><p><code><a href="ggraph.html#topic+guide_edge_colourbar">guide_edge_colourbar</a></code></p>
</dd>
</dl>

<hr>
<h2 id='selection_localized_genes'>selection_localized_genes</h2><span id='topic+selection_localized_genes'></span>

<h3>Description</h3>

<p>selection_localized_genes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selection_localized_genes(
  norm_counts,
  localized_genes,
  min_number_cells = 4,
  max_number_genes = 10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selection_localized_genes_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="selection_localized_genes_+3A_localized_genes">localized_genes</code></td>
<td>
<p>vector of highly localized genes as provided by the
last element of the list given as output from <em>CIARA_mixing_final</em>.</p>
</td></tr>
<tr><td><code id="selection_localized_genes_+3A_min_number_cells">min_number_cells</code></td>
<td>
<p>Minimum number of cells where a genes must be
expressed (&gt; 0).</p>
</td></tr>
<tr><td><code id="selection_localized_genes_+3A_max_number_genes">max_number_genes</code></td>
<td>
<p>Maximum number of genes to show for each cell in the
interactive plot from <em>plot_interactive</em>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector where each entry contains the name of the top
<em>max_number_genes</em> for the corresponding cell.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

<hr>
<h2 id='test_hvg'>test_hvg</h2><span id='topic+test_hvg'></span>

<h3>Description</h3>

<p>For each cluster in <em>cluster</em>, HVGs are defined with
Seurat function <em>FindVariableFeatures</em>. A Fisher test is performed to
see if there is a statistically significant enrichment between the top
<em>number_hvg</em> and the <em>localized_genes</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test_hvg(
  raw_counts,
  cluster,
  localized_genes,
  background,
  number_hvg,
  min_p_value
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test_hvg_+3A_raw_counts">raw_counts</code></td>
<td>
<p>Raw count matrix (n_genes X n_cells).</p>
</td></tr>
<tr><td><code id="test_hvg_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
<tr><td><code id="test_hvg_+3A_localized_genes">localized_genes</code></td>
<td>
<p>Character vector with localized genes detected by CIARA.</p>
</td></tr>
<tr><td><code id="test_hvg_+3A_background">background</code></td>
<td>
<p>Character vector with all the genes names to use as
background for the Fisher test.</p>
</td></tr>
<tr><td><code id="test_hvg_+3A_number_hvg">number_hvg</code></td>
<td>
<p>Integer value. Number of top HVGs provided by the Seurat
function <em>FindVariableFeatures</em>.</p>
</td></tr>
<tr><td><code id="test_hvg_+3A_min_p_value">min_p_value</code></td>
<td>
<p>Threshold on p values provided by Fisher test.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two elements. </p>
<table>
<tr><td><code>first element</code></td>
<td>
<p>The first one is a
list with length equal to the number of clusters. Each entry is list of
three elements. The first two elements contain the p value and the odds
ration given by the Fisher test The third is a vector with genes names that
are present both in <em>localized_genes</em> and in top <em>number_hvg</em> HVGs
.</p>
</td></tr> <tr><td><code>second element</code></td>
<td>
<p>a character vector with the name of the cluster that
have a p value smaller than <em>min_p_value</em>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>


<h3>See Also</h3>

<p><a href="https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test">https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fisher.test</a>
</p>

<hr>
<h2 id='white_black_markers'>white_black_markers</h2><span id='topic+white_black_markers'></span>

<h3>Description</h3>

<p>A white-marker is a gene whose median expression across cells belong to
<em>single_cluster</em> is greater than <em>threshold</em> and in all the other
clusters is equal to zero.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>white_black_markers(
  cluster,
  single_cluster,
  norm_counts,
  marker_list,
  threshold = 0
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="white_black_markers_+3A_cluster">cluster</code></td>
<td>
<p>Vector of length equal to the number of cells, with cluster
assignment.</p>
</td></tr>
<tr><td><code id="white_black_markers_+3A_single_cluster">single_cluster</code></td>
<td>
<p>Character. Label of one specify cluster</p>
</td></tr>
<tr><td><code id="white_black_markers_+3A_norm_counts">norm_counts</code></td>
<td>
<p>Norm count matrix (genes X cells).</p>
</td></tr>
<tr><td><code id="white_black_markers_+3A_marker_list">marker_list</code></td>
<td>
<p>Third element of the output list as returned by the
function <em>markers_cluster_seurat</em></p>
</td></tr>
<tr><td><code id="white_black_markers_+3A_threshold">threshold</code></td>
<td>
<p>Numeric. The median of the genes across cells belong to
<em>single_cluster</em> has to be greater than <em>threshold</em> in order to be
consider as a white-black marker for <em>single_cluster</em></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical vector of length equal to <em>marker_list</em>, with
TRUE/FALSE if the gene is/is not a white-black marker for
<em>single_cluster</em>.
</p>


<h3>Author(s)</h3>

<p>Gabriele Lubatti <a href="mailto:gabriele.lubatti@helmholtz-muenchen.de">gabriele.lubatti@helmholtz-muenchen.de</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
