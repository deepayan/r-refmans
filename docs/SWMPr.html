<!DOCTYPE html><html><head><title>Help for package SWMPr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SWMPr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aggremetab'><p>Aggregate metabolism data</p></a></li>
<li><a href='#aggreswmp'><p>Aggregate swmpr data</p></a></li>
<li><a href='#all_params'><p>Import current station records from the CDMO</p></a></li>
<li><a href='#all_params_dtrng'><p>Get CDMO records within a date range</p></a></li>
<li><a href='#apacpnut'><p>Example nutrient data for Apalachicola Bay Cat Point station.</p></a></li>
<li><a href='#apacpwq'><p>Example water quality data for Apalachicola Bay Cat Point station.</p></a></li>
<li><a href='#apadbwq'><p>Example water quality data for Apalachicola Bay Dry Bar station.</p></a></li>
<li><a href='#apaebmet'><p>Example weather data for Apalachicola Bay East Bay station.</p></a></li>
<li><a href='#calckl'><p>Calculate oxygen mass transfer coefficient</p></a></li>
<li><a href='#cens_id'><p>Flag observations above/below detection limits</p></a></li>
<li><a href='#comb'><p>Combine swmpr data</p></a></li>
<li><a href='#decomp'><p>Simple trend decomposition</p></a></li>
<li><a href='#decomp_cj'><p>Simple trend decomposition of monthly swmpr data</p></a></li>
<li><a href='#decompTs'><p>Decompose a time series</p></a></li>
<li><a href='#ecometab'><p>Ecosystem metabolism</p></a></li>
<li><a href='#gradcols'><p>Get colors for plots</p></a></li>
<li><a href='#hist.swmpr'><p>Plot swmpr using a histogram</p></a></li>
<li><a href='#import_local'><p>Import local CDMO data</p></a></li>
<li><a href='#map_reserve'><p>Map a reserve</p></a></li>
<li><a href='#metab_day'><p>Identify metabolic days in a time series</p></a></li>
<li><a href='#na.approx.swmpr'><p>Linearly interpolate gaps</p></a></li>
<li><a href='#overplot'><p>Plot multiple SWMP time series on the same y-axis</p></a></li>
<li><a href='#oxySol'><p>Dissolved oxygen at saturation</p></a></li>
<li><a href='#param_names'><p>Get parameters of a given type</p></a></li>
<li><a href='#parser'><p>Parse web results for swmpr</p></a></li>
<li><a href='#plot_metab'><p>Plot ecosystem metabolism for a swmpr object</p></a></li>
<li><a href='#plot_quants'><p>Create a plot of data for a single year overlaid on historical data.</p></a></li>
<li><a href='#plot_summary'><p>Plot graphical summaries of SWMP data</p></a></li>
<li><a href='#plot_wind'><p>Create a wind rose</p></a></li>
<li><a href='#plot.swmpr'><p>Plot swmpr data</p></a></li>
<li><a href='#qaqc'><p>QAQC filtering for SWMP data</p></a></li>
<li><a href='#qaqcchk'><p>Summary of QAQC flags in SWMP data</p></a></li>
<li><a href='#rem_reps'><p>Remove replicates in nutrient data</p></a></li>
<li><a href='#setstep'><p>Format a swmpr time vector</p></a></li>
<li><a href='#single_param'><p>Get CDMO records for a single parameter</p></a></li>
<li><a href='#site_codes'><p>Obtain metadata for all stations</p></a></li>
<li><a href='#site_codes_ind'><p>Obtain metadata for a single reserve</p></a></li>
<li><a href='#smoother'><p>Smooth swmpr data</p></a></li>
<li><a href='#stat_locs'><p>Locations of NERRS sites</p></a></li>
<li><a href='#subset.swmpr'><p>Subset a swmpr object</p></a></li>
<li><a href='#swmpr'><p>Create a swmpr object</p></a></li>
<li><a href='#time_vec'><p>Format SWMP datetimestamp</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Retrieving, Organizing, and Analyzing Estuary Monitoring Data</td>
</tr>
<tr>
<td>Version:</td>
<td>2.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-24</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcus W. Beck [aut, cre],
  Kimberly Cressman [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcus W. Beck &lt;mbeck@tbep.org&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for retrieving, organizing, and analyzing environmental
    data from the System Wide Monitoring Program of the National Estuarine
    Research Reserve System <a href="https://cdmo.baruch.sc.edu/">https://cdmo.baruch.sc.edu/</a>. These tools
    address common challenges associated with continuous time series data
    for environmental decision making.</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/fawda123/SWMPr/issues">https://github.com/fawda123/SWMPr/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>data.table, httr, gridExtra, oce, dplyr, lattice, openair,
RColorBrewer, reshape2, suncalc, tictoc, tidyr, XML</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), ggplot2, zoo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>colorspace, covr, ggmap, knitr, rmarkdown, testthat (&ge;
3.0.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://fawda123.github.io/SWMPr/">http://fawda123.github.io/SWMPr/</a></td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-24 13:13:28 UTC; MarcusBeck</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-24 13:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='aggremetab'>Aggregate metabolism data</h2><span id='topic+aggremetab'></span><span id='topic+aggremetab.swmpr'></span>

<h3>Description</h3>

<p>Aggregate a metabolism attribute from swmpr data by a specified time period and method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggremetab(swmpr_in, ...)

## S3 method for class 'swmpr'
aggremetab(swmpr_in, by = "weeks", na.action = na.pass, alpha = 0.05, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggremetab_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="aggremetab_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods</p>
</td></tr>
<tr><td><code id="aggremetab_+3A_by">by</code></td>
<td>
<p>chr string or numeric value specifying aggregation period.  If chr string, must be <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, <code>'weeks'</code>, <code>'days'</code>, or <code>'hours'</code>. A numeric value indicates the number of days for a moving window average.  Additional arguments passed to <code><a href="#topic+smoother">smoother</a></code> can be used if <code>by</code> is numeric.</p>
</td></tr>
<tr><td><code id="aggremetab_+3A_na.action">na.action</code></td>
<td>
<p>function for treating missing data, default <code>na.pass</code></p>
</td></tr>
<tr><td><code id="aggremetab_+3A_alpha">alpha</code></td>
<td>
<p>numeric indicating alpha level of confidence interval for aggregated data</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function summarizes metabolism data by averaging across set periods of observation. Confidence intervals are also returned based on the specified alpha level.  It is used within <code><a href="#topic+plot_metab">plot_metab</a></code> function to view summarized metabolism results.  Data can be aggregated by <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, or <code>'weeks'</code> for the supplied function, which defaults to the <code><a href="base.html#topic+mean">mean</a></code>. The method of treating NA values for the user-supplied function should be noted since this may greatly affect the quantity of data that are returned.
</p>


<h3>Value</h3>

<p>Returns an aggregated metabolism <code><a href="base.html#topic+data.frame">data.frame</a></code> if the <code>metabolism</code> attribute of the swmpr object is not <code>NULL</code>.  Upper and lower confidence limits are also provided if the aggregation period was specified as a character string.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+aggregate">aggregate</a></code>, <code><a href="#topic+aggreswmp">aggreswmp</a></code>, <code><a href="#topic+ecometab">ecometab</a></code>, <code><a href="#topic+plot_metab">plot_metab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## import water quality and weather data
data(apadbwq)
data(apaebmet)

## qaqc, combine
wq &lt;- qaqc(apadbwq)
met &lt;- qaqc(apaebmet)
dat &lt;- comb(wq, met)

## estimate metabolism
res &lt;- ecometab(dat)

## change aggregation period and alpha
aggremetab(res, by = 'months', alpha = 0.1)

## use a moving window average of 30 days
aggremetab(res, by = 30)

## use a left-centered window instead
aggremetab(res, by = 30, sides = 1)

## End(Not run)
</code></pre>

<hr>
<h2 id='aggreswmp'>Aggregate swmpr data</h2><span id='topic+aggreswmp'></span><span id='topic+aggreswmp.swmpr'></span>

<h3>Description</h3>

<p>Aggregate swmpr data by specified time period and method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aggreswmp(swmpr_in, ...)

## S3 method for class 'swmpr'
aggreswmp(
  swmpr_in,
  by,
  FUN = function(x) mean(x, na.rm = TRUE),
  params = NULL,
  aggs_out = FALSE,
  plot = FALSE,
  na.action = na.pass,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aggreswmp_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods</p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_by">by</code></td>
<td>
<p>chr string of time period for aggregation one of <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, <code>'weeks'</code>, <code>'days'</code>, or <code>'hours'</code></p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_fun">FUN</code></td>
<td>
<p>aggregation function, default <code>mean</code> with <code>na.rm = TRUE</code></p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_params">params</code></td>
<td>
<p>names of parameters to aggregate, default all</p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_aggs_out">aggs_out</code></td>
<td>
<p>logical indicating if <code><a href="base.html#topic+data.frame">data.frame</a></code> is returned of raw data with datetimestamp formatted as aggregation period, default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_plot">plot</code></td>
<td>
<p>logical to return a plot of the summarized data, default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="aggreswmp_+3A_na.action">na.action</code></td>
<td>
<p>function for treating missing data, default <code>na.pass</code>.  See the documentation for <code><a href="stats.html#topic+aggregate">aggregate</a></code> for options.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function aggregates parameter data for a swmpr object by set periods of observation and a user-supplied function. It is most useful for aggregating noisy data to evaluate trends on longer time scales, or to simply reduce the size of a dataset. Data can be aggregated by <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, <code>'weeks'</code>, <code>'days'</code>, or <code>'hours'</code> for the supplied function, which defaults to the <code><a href="base.html#topic+mean">mean</a></code>. A swmpr object is returned for the aggregated data, although the datetimestamp vector will be converted to a date object if the aggregation period is a day or longer. Days are assigned to the date vector if the aggregation period is a week or longer based on the round method for <code><a href="data.table.html#topic+IDate">IDate</a></code> objects. This approach was used to facilitate plotting using predefined methods for Date and POSIX objects.
</p>
<p>The method of treating NA values for the user-supplied function should be noted since this may greatly affect the quantity of data that are returned (see the examples). Finally, the default argument for <code>na.action</code> is set to <code>na.pass</code> for swmpr objects to preserve the time series of the input data.
</p>


<h3>Value</h3>

<p>Returns an aggregated swmpr object. QAQC columns are removed if included with input object.  If <code>aggs_out = TRUE</code>, the original <code>swmpr</code> object is returned with the <code>datetimestamp</code> column formatted for the first day of the aggregation period from <code>by</code>.  A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object of boxplot summaries is returned if <code>plot = TRUE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+aggregate">aggregate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get data, prep
data(apacpwq)
dat &lt;- apacpwq
swmpr_in &lt;- subset(qaqc(dat), rem_cols = TRUE)

## get mean DO by quarters
aggreswmp(swmpr_in, 'quarters', params = c('do_mgl'))

## get a plot instead
aggreswmp(swmpr_in, 'quarters', params = c('do_mgl'), plot = T)

## plots with other variables
p &lt;- aggreswmp(swmpr_in, 'months', params = c('do_mgl', 'temp', 'sal'), plot = T)
p
library(ggplot2)
p + geom_boxplot(aes(fill = var)) + theme(legend.position = 'none')

## get variance of DO by years, remove NA when calculating variance
## omit NA data in output
fun_in &lt;- function(x)  var(x, na.rm = TRUE)
aggreswmp(swmpr_in, FUN = fun_in, 'years') 

## End(Not run)
</code></pre>

<hr>
<h2 id='all_params'>Import current station records from the CDMO</h2><span id='topic+all_params'></span>

<h3>Description</h3>

<p>Import current station records from the CDMO starting with the most current date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_params(station_code, Max = 100, param = NULL, trace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all_params_+3A_station_code">station_code</code></td>
<td>
<p>chr string of station, 7 or 8 characters</p>
</td></tr>
<tr><td><code id="all_params_+3A_max">Max</code></td>
<td>
<p>numeric value for number of records to obtain from the current date</p>
</td></tr>
<tr><td><code id="all_params_+3A_param">param</code></td>
<td>
<p>chr string for a single parameter to return, defaults to all parameters for a station type.</p>
</td></tr>
<tr><td><code id="all_params_+3A_trace">trace</code></td>
<td>
<p>logical indicating if import progress is printed in console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function retrieves data from the CDMO through the web services URL.  The computer making the request must have a registered IP address.  Visit the CDMO web services page for more information: <a href="https://cdmo.baruch.sc.edu/webservices.cfm">https://cdmo.baruch.sc.edu/webservices.cfm</a>.  Function is the CDMO equivalent of <code>exportAllParamsXMLNew</code> but actually uses <code><a href="#topic+all_params_dtrng">all_params_dtrng</a></code>, which is a direct call to <code>exportAllParamsDateRangeXMLNew</code>.
</p>


<h3>Value</h3>

<p>Returns a swmpr object, all available parameters including QAQC columns
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all_params_dtrng">all_params_dtrng</a></code>, <code><a href="#topic+single_param">single_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## all parameters for a station, most recent
all_params('hudscwq')


## End(Not run)
</code></pre>

<hr>
<h2 id='all_params_dtrng'>Get CDMO records within a date range</h2><span id='topic+all_params_dtrng'></span>

<h3>Description</h3>

<p>Get station records from the CDMO within a date range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_params_dtrng(station_code, dtrng, param = NULL, trace = TRUE, Max = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="all_params_dtrng_+3A_station_code">station_code</code></td>
<td>
<p>chr string of station, 7 or 8 characters</p>
</td></tr>
<tr><td><code id="all_params_dtrng_+3A_dtrng">dtrng</code></td>
<td>
<p>two element chr string, each of format MM/DD/YYYY</p>
</td></tr>
<tr><td><code id="all_params_dtrng_+3A_param">param</code></td>
<td>
<p>chr string for a single parameter to return, defaults to all parameters for a station type.</p>
</td></tr>
<tr><td><code id="all_params_dtrng_+3A_trace">trace</code></td>
<td>
<p>logical indicating if import progress is printed in console</p>
</td></tr>
<tr><td><code id="all_params_dtrng_+3A_max">Max</code></td>
<td>
<p>numeric indicating maximum number of records to return</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function retrieves data from the CDMO through the web services URL.  The computer making the request must have a registered IP address.  Visit the CDMO web services page for more information: <a href="https://cdmo.baruch.sc.edu/webservices.cfm">https://cdmo.baruch.sc.edu/webservices.cfm</a>.  This function is the CDMO equivalent of <code>exportAllParamsDateRangeXMLNew</code>.
Download time may be excessive for large requests.
</p>


<h3>Value</h3>

<p>Returns a swmpr object, all parameters for a station type (nutrients, water quality, or meteorological) or a single parameter if specified.  QAQC columns are not provided for single parameters.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all_params">all_params</a></code>, <code><a href="#topic+single_param">single_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## get all parameters within a date range
all_params_dtrng('apaebwq', c('01/01/2013', '02/01/2013'))

## get single parameter within a date range
all_params_dtrng('apaebwq', c('01/01/2013', '02/01/2013'), 
   param = 'do_mgl')


## End(Not run)
</code></pre>

<hr>
<h2 id='apacpnut'>Example nutrient data for Apalachicola Bay Cat Point station.</h2><span id='topic+apacpnut'></span>

<h3>Description</h3>

<p>An example nutrient dataset for Apalachicola Bay Cat Point station.  The data are a <code><a href="#topic+swmpr">swmpr</a></code> object that have been imported into R from csv files using the <code><a href="#topic+import_local">import_local</a></code> function.  The raw data were obtained from the CDMO data portal but can also be accessed from a zip file created for this package.  See the source below.  The help file for the <code><a href="#topic+import_local">import_local</a></code> function describes how the data can be imported from the zip file.  Attributes of the dataset include <code>names</code>, <code>row.names</code>, <code>class</code>, <code>station</code>, <code>parameters</code>, <code>qaqc_cols</code>, <code>date_rng</code>, <code>timezone</code>, and <code>stamp_class</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apacpnut
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+swmpr">swmpr</a></code> object and <code><a href="base.html#topic+data.frame">data.frame</a></code> with 215 rows and 13 variables:
</p>

<dl>
<dt><code>datetimestamp</code></dt><dd><p>POSIXct</p>
</dd>
<dt><code>po4f</code></dt><dd><p>num</p>
</dd>
<dt><code>f_po4f</code></dt><dd><p>chr</p>
</dd>
<dt><code>nh4f</code></dt><dd><p>num</p>
</dd>
<dt><code>f_nh4f</code></dt><dd><p>chr</p>
</dd>
<dt><code>no2f</code></dt><dd><p>num</p>
</dd>
<dt><code>f_no2f</code></dt><dd><p>chr</p>
</dd>
<dt><code>no3f</code></dt><dd><p>num</p>
</dd>
<dt><code>f_no3f</code></dt><dd><p>chr</p>
</dd>
<dt><code>no23f</code></dt><dd><p>num</p>
</dd>
<dt><code>f_no23f</code></dt><dd><p>chr</p>
</dd>
<dt><code>chla_n</code></dt><dd><p>num</p>
</dd>
<dt><code>f_chla_n</code></dt><dd><p>chr</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://s3.amazonaws.com/swmpexdata/zip_ex.zip">https://s3.amazonaws.com/swmpexdata/zip_ex.zip</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apacpnut)
</code></pre>

<hr>
<h2 id='apacpwq'>Example water quality data for Apalachicola Bay Cat Point station.</h2><span id='topic+apacpwq'></span>

<h3>Description</h3>

<p>An example water quality dataset for Apalachicola Bay Cat Point station.  The data are a <code><a href="#topic+swmpr">swmpr</a></code> object that have been imported into R from csv files using the <code><a href="#topic+import_local">import_local</a></code> function.  The raw data were obtained from the CDMO data portal but can also be accessed from a zip file created for this package.  See the source below.  The help file for the <code><a href="#topic+import_local">import_local</a></code> function describes how the data can be imported from the zip file.  Attributes of the dataset include <code>names</code>, <code>row.names</code>, <code>class</code>, <code>station</code>, <code>parameters</code>, <code>qaqc_cols</code>, <code>date_rng</code>, <code>timezone</code>, and <code>stamp_class</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apacpwq
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+swmpr">swmpr</a></code> object and <code><a href="base.html#topic+data.frame">data.frame</a></code> with 70176 rows and 25 variables:
</p>

<dl>
<dt><code>datetimestamp</code></dt><dd><p>POSIXct</p>
</dd>
<dt><code>temp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_temp</code></dt><dd><p>chr</p>
</dd>
<dt><code>spcond</code></dt><dd><p>num</p>
</dd>
<dt><code>f_spcond</code></dt><dd><p>chr</p>
</dd>
<dt><code>sal</code></dt><dd><p>num</p>
</dd>
<dt><code>f_sal</code></dt><dd><p>chr</p>
</dd>
<dt><code>do_pct</code></dt><dd><p>num</p>
</dd>
<dt><code>f_do_pct</code></dt><dd><p>chr</p>
</dd>
<dt><code>do_mgl</code></dt><dd><p>num</p>
</dd>
<dt><code>f_do_mgl</code></dt><dd><p>chr</p>
</dd>
<dt><code>depth</code></dt><dd><p>num</p>
</dd>
<dt><code>f_depth</code></dt><dd><p>chr</p>
</dd>
<dt><code>cdepth</code></dt><dd><p>num</p>
</dd>
<dt><code>f_cdepth</code></dt><dd><p>chr</p>
</dd>
<dt><code>level</code></dt><dd><p>num</p>
</dd>
<dt><code>f_level</code></dt><dd><p>chr</p>
</dd>
<dt><code>clevel</code></dt><dd><p>num</p>
</dd>
<dt><code>f_clevel</code></dt><dd><p>chr</p>
</dd>
<dt><code>ph</code></dt><dd><p>num</p>
</dd>
<dt><code>f_ph</code></dt><dd><p>chr</p>
</dd>
<dt><code>turb</code></dt><dd><p>num</p>
</dd>
<dt><code>f_turb</code></dt><dd><p>chr</p>
</dd>
<dt><code>chlfluor</code></dt><dd><p>num</p>
</dd>
<dt><code>f_chlfluor</code></dt><dd><p>chr</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://s3.amazonaws.com/swmpexdata/zip_ex.zip">https://s3.amazonaws.com/swmpexdata/zip_ex.zip</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apacpwq)
</code></pre>

<hr>
<h2 id='apadbwq'>Example water quality data for Apalachicola Bay Dry Bar station.</h2><span id='topic+apadbwq'></span>

<h3>Description</h3>

<p>An example water quality dataset for Apalachicola Bay Dry Bar station.  The data are a <code><a href="#topic+swmpr">swmpr</a></code> object that have been imported into R from csv files using the <code><a href="#topic+import_local">import_local</a></code> function.  The raw data were obtained from the CDMO data portal but can also be accessed from a zip file created for this package.  See the source below.  The help file for the <code><a href="#topic+import_local">import_local</a></code> function describes how the data can be imported from the zip file.  Attributes of the dataset include <code>names</code>, <code>row.names</code>, <code>class</code>, <code>station</code>, <code>parameters</code>, <code>qaqc_cols</code>, <code>date_rng</code>, <code>timezone</code>, and <code>stamp_class</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apadbwq
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+swmpr">swmpr</a></code> object and <code><a href="base.html#topic+data.frame">data.frame</a></code> with 70176 rows and 25 variables:
</p>

<dl>
<dt><code>datetimestamp</code></dt><dd><p>POSIXct</p>
</dd>
<dt><code>temp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_temp</code></dt><dd><p>chr</p>
</dd>
<dt><code>spcond</code></dt><dd><p>num</p>
</dd>
<dt><code>f_spcond</code></dt><dd><p>chr</p>
</dd>
<dt><code>sal</code></dt><dd><p>num</p>
</dd>
<dt><code>f_sal</code></dt><dd><p>chr</p>
</dd>
<dt><code>do_pct</code></dt><dd><p>num</p>
</dd>
<dt><code>f_do_pct</code></dt><dd><p>chr</p>
</dd>
<dt><code>do_mgl</code></dt><dd><p>num</p>
</dd>
<dt><code>f_do_mgl</code></dt><dd><p>chr</p>
</dd>
<dt><code>depth</code></dt><dd><p>num</p>
</dd>
<dt><code>f_depth</code></dt><dd><p>chr</p>
</dd>
<dt><code>cdepth</code></dt><dd><p>num</p>
</dd>
<dt><code>f_cdepth</code></dt><dd><p>chr</p>
</dd>
<dt><code>level</code></dt><dd><p>num</p>
</dd>
<dt><code>f_level</code></dt><dd><p>chr</p>
</dd>
<dt><code>clevel</code></dt><dd><p>num</p>
</dd>
<dt><code>f_clevel</code></dt><dd><p>chr</p>
</dd>
<dt><code>ph</code></dt><dd><p>num</p>
</dd>
<dt><code>f_ph</code></dt><dd><p>chr</p>
</dd>
<dt><code>turb</code></dt><dd><p>num</p>
</dd>
<dt><code>f_turb</code></dt><dd><p>chr</p>
</dd>
<dt><code>chlfluor</code></dt><dd><p>num</p>
</dd>
<dt><code>f_chlfluor</code></dt><dd><p>chr</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://s3.amazonaws.com/swmpexdata/zip_ex.zip">https://s3.amazonaws.com/swmpexdata/zip_ex.zip</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apadbwq)
</code></pre>

<hr>
<h2 id='apaebmet'>Example weather data for Apalachicola Bay East Bay station.</h2><span id='topic+apaebmet'></span>

<h3>Description</h3>

<p>An example weather dataset for Apalachicola Bay East Bay station.  The data are a <code><a href="#topic+swmpr">swmpr</a></code> object that have been imported into R from csv files using the <code><a href="#topic+import_local">import_local</a></code> function.  The raw data were obtained from the CDMO data portal but can also be accessed from a zip file created for this package.  See the source below.  The help file for the <code><a href="#topic+import_local">import_local</a></code> function describes how the data can be imported from the zip file.  Attributes of the dataset include <code>names</code>, <code>row.names</code>, <code>class</code>, <code>station</code>, <code>parameters</code>, <code>qaqc_cols</code>, <code>date_rng</code>, <code>timezone</code>, and <code>stamp_class</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apaebmet
</code></pre>


<h3>Format</h3>

<p>A <code><a href="#topic+swmpr">swmpr</a></code> object and <code><a href="base.html#topic+data.frame">data.frame</a></code> with 70176 rows and 23 variables:
</p>

<dl>
<dt><code>datetimestamp</code></dt><dd><p>POSIXct</p>
</dd>
<dt><code>atemp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_atemp</code></dt><dd><p>chr</p>
</dd>
<dt><code>rh</code></dt><dd><p>num</p>
</dd>
<dt><code>f_rh</code></dt><dd><p>chr</p>
</dd>
<dt><code>bp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_bp</code></dt><dd><p>chr</p>
</dd>
<dt><code>wspd</code></dt><dd><p>num</p>
</dd>
<dt><code>f_wspd</code></dt><dd><p>chr</p>
</dd>
<dt><code>maxwspd</code></dt><dd><p>num</p>
</dd>
<dt><code>f_maxwspd</code></dt><dd><p>chr</p>
</dd>
<dt><code>wdir</code></dt><dd><p>num</p>
</dd>
<dt><code>f_wdir</code></dt><dd><p>chr</p>
</dd>
<dt><code>sdwdir</code></dt><dd><p>num</p>
</dd>
<dt><code>f_sdwdir</code></dt><dd><p>chr</p>
</dd>
<dt><code>totpar</code></dt><dd><p>num</p>
</dd>
<dt><code>f_totpar</code></dt><dd><p>chr</p>
</dd>
<dt><code>totprcp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_totprcp</code></dt><dd><p>chr</p>
</dd>
<dt><code>cumprcp</code></dt><dd><p>num</p>
</dd>
<dt><code>f_cumprcp</code></dt><dd><p>chr</p>
</dd>
<dt><code>totsorad</code></dt><dd><p>num</p>
</dd>
<dt><code>f_totsorad</code></dt><dd><p>chr</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://s3.amazonaws.com/swmpexdata/zip_ex.zip">https://s3.amazonaws.com/swmpexdata/zip_ex.zip</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apaebmet)
</code></pre>

<hr>
<h2 id='calckl'>Calculate oxygen mass transfer coefficient</h2><span id='topic+calckl'></span>

<h3>Description</h3>

<p>Calculate oxygen mass transfer coefficient using equations in Thiebault et al. 2008.  Output is used to estimate the volumetric reaeration coefficient for ecosystem metabolism.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calckl(temp, sal, atemp, wspd, bp, height = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calckl_+3A_temp">temp</code></td>
<td>
<p>numeric for water temperature (C)</p>
</td></tr>
<tr><td><code id="calckl_+3A_sal">sal</code></td>
<td>
<p>numeric for salinity (ppt)</p>
</td></tr>
<tr><td><code id="calckl_+3A_atemp">atemp</code></td>
<td>
<p>numeric for air temperature (C)</p>
</td></tr>
<tr><td><code id="calckl_+3A_wspd">wspd</code></td>
<td>
<p>numeric for wind speed (m/s)</p>
</td></tr>
<tr><td><code id="calckl_+3A_bp">bp</code></td>
<td>
<p>numeric for barometric pressure (mb)</p>
</td></tr>
<tr><td><code id="calckl_+3A_height">height</code></td>
<td>
<p>numeric for height of anemometer (meters)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used within the <code><a href="#topic+ecometab">ecometab</a></code> function and should not be used explicitly.
</p>


<h3>Value</h3>

<p>Returns numeric value for oxygen mass transfer coefficient (m d-1).
</p>


<h3>References</h3>

<p>Ro KS, Hunt PG. 2006. A new unified equation for wind-driven surficial oxygen transfer into stationary water bodies. Transactions of the American Society of Agricultural and Biological Engineers. 49(5):1615-1622.
</p>
<p>Thebault J, Schraga TS, Cloern JE, Dunlavey EG. 2008. Primary production and carrying capacity of former salt ponds after reconnection to San Francisco Bay. Wetlands. 28(3):841-851.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecometab">ecometab</a></code>
</p>

<hr>
<h2 id='cens_id'>Flag observations above/below detection limits</h2><span id='topic+cens_id'></span><span id='topic+cens_id.swmpr'></span>

<h3>Description</h3>

<p>Flag observations above/below detection limits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cens_id(swmpr_in, ...)

## S3 method for class 'swmpr'
cens_id(swmpr_in, flag_type = "both", select = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cens_id_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="cens_id_+3A_...">...</code></td>
<td>
<p>optional arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="cens_id_+3A_flag_type">flag_type</code></td>
<td>
<p>chr string indicating the flag type to return, must be one of <code>'below'</code>, <code>'above'</code>, or <code>'both'</code>, see details</p>
</td></tr>
<tr><td><code id="cens_id_+3A_select">select</code></td>
<td>
<p>chr string of parameters to keep, defaults to all, <code>'datetimestamp'</code> will always be kept</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Censored observations are identified in swmpr objects using the CDMO flags -4 or -5, indicating outside the low or high sensor range, respectively.  Additional codes are identified including A (-2007) or SUL (2007-) for above and B (-2007), SBL (2007-), SCB (2007-, calculated) for below detection limits.   The QAQC columns are searched for all parameters and replaced with the appropriate value indicating the detection limit as defined by <code>flag_type</code>.  The default argument <code>flag_type = 'both'</code> will recode the QAQC columns as -1, 0, or 1 indicating below, within, or above the detection limit.  Setting <code>flag_type = 'below'</code> or <code>'above'</code> will convert the columns to <code>TRUE</code>/<code>FALSE</code> values indicating observations beyond the detection limit (either above or below, <code>TRUE</code>) or within the normal detection range <code>FALSE</code>. 
The output includes additional columns similar to those for QAQC flags, such that the column names for censored flags include a <code>c_</code> prefix before the parameter name.  Note that the function will of course not work if already processed with <code><a href="#topic+qaqc">qaqc</a></code>.  QAQC columns are retained for additional processing.
</p>
<p>The user should refer to the metadata or visually examine the observed data to identify the actual limit, which may change over time.
</p>


<h3>Value</h3>

<p>Returns a swmpr object with additional columns for censored flag values and the appropriate flag type based on the input arguments.  Censored flag columns are named with a <code>c_</code> prefix.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qaqc">qaqc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apacpnut)
dat &lt;- apacpnut

## convert all qaqc columns to censored flags, -1 below, 0 within, 1 above
cens_id(dat)

## T/F for above or within, note that none are above
cens_id(dat, flag_type = 'above')

## T/F for below or within
cens_id(dat, flag_type = 'below')
</code></pre>

<hr>
<h2 id='comb'>Combine swmpr data</h2><span id='topic+comb'></span><span id='topic+comb.swmpr'></span><span id='topic+comb.default'></span>

<h3>Description</h3>

<p>Combine swmpr data types for a station by common time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comb(...)

## S3 method for class 'swmpr'
comb(..., timestep = 15, differ = NULL, method = "union")

## Default S3 method:
comb(..., date_col, timestep = 15, differ = NULL, method = "union")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comb_+3A_...">...</code></td>
<td>
<p>input time series data objects, from one to many</p>
</td></tr>
<tr><td><code id="comb_+3A_timestep">timestep</code></td>
<td>
<p>numeric value of time step to use in minutes, passed to <code>setstep</code></p>
</td></tr>
<tr><td><code id="comb_+3A_differ">differ</code></td>
<td>
<p>numeric value defining buffer for merging time stamps to standardized time series, passed to <code>setstep</code></p>
</td></tr>
<tr><td><code id="comb_+3A_method">method</code></td>
<td>
<p>chr string indicating method of combining data.  Use <code>'union'</code> for all dates as continuous time series or <code>'intersect'</code> for only areas of overlap. If input is a  <code>swmpr</code> object, a <code>'station'</code> name can be used to combine by the date range of a given station, assuming there is overlap with the second station.  A numeric value can be supplied for the default method that specifies which data object to use for the date range based on order of execution in the function call.</p>
</td></tr>
<tr><td><code id="comb_+3A_date_col">date_col</code></td>
<td>
<p>chr string indicating name of the date column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>comb</code> function is used to combine multiple swmpr objects into a single object with a continuous time series at a given step. The <code>timestep</code> function is used internally such that <code>timestep</code> and <code>differ</code> are accepted arguments for <code>comb</code>. 
</p>
<p>The function requires one or more swmpr objects as input as separate, undefined arguments. The remaining arguments must be called explicitly since an arbitrary number of objects can be used as input. In general, the function combines data by creating a master time series that is used to iteratively merge all swmpr objects. The time series for merging depends on the value passed to the <code>method</code> argument. Passing <code>'union'</code> to <code>method</code> will create a time series that is continuous starting from the earliest date and the latest date for all input objects. Passing <code>'intersect'</code> to <code>method</code> will create a time series that is continuous from the set of dates that are shared between all input objects. Finally, a seven or eight character station name passed to <code>method</code> will merge all input objects based on a continuous time series for the given station. The specified station must be present in the input data. Currently, combining data types from different stations is not possible, excluding weather data which are typically at a single, dedicated station.
</p>


<h3>Value</h3>

<p>Returns a combined swmpr object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+setstep">setstep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get wq and met data as separate objects for the same station
swmp1 &lt;- apacpnut
swmp2 &lt;- apaebmet

## combine nuts and wq data by union, set timestep to 120 minutes
## Not run: 
comb(swmp1, swmp2, timestep = 120, method = 'union')

## End(Not run)
</code></pre>

<hr>
<h2 id='decomp'>Simple trend decomposition</h2><span id='topic+decomp'></span><span id='topic+decomp.swmpr'></span><span id='topic+decomp.default'></span>

<h3>Description</h3>

<p>Decompose data into trend, cyclical (e.g., daily, annual), and random components using <code><a href="stats.html#topic+decompose">decompose</a></code> and <code><a href="stats.html#topic+ts">ts</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decomp(dat_in, ...)

## S3 method for class 'swmpr'
decomp(
  dat_in,
  param,
  type = "additive",
  frequency = "daily",
  start = NULL,
  ...
)

## Default S3 method:
decomp(
  dat_in,
  param,
  date_col,
  type = "additive",
  frequency = "daily",
  start = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decomp_+3A_dat_in">dat_in</code></td>
<td>
<p>input data object</p>
</td></tr>
<tr><td><code id="decomp_+3A_...">...</code></td>
<td>
<p>arguments passed to <code>decompose</code>, <code>ts</code>, and other methods</p>
</td></tr>
<tr><td><code id="decomp_+3A_param">param</code></td>
<td>
<p>chr string of swmpr parameter to decompose</p>
</td></tr>
<tr><td><code id="decomp_+3A_type">type</code></td>
<td>
<p>chr string of <code>'additive'</code> or <code>'multiplicative'</code> indicating the type of decomposition, default <code>'additive'</code>.</p>
</td></tr>
<tr><td><code id="decomp_+3A_frequency">frequency</code></td>
<td>
<p>chr string or numeric vector indicating the periodic component of the input parameter.  Only <code>'daily'</code> or <code>'annual'</code> are accepted as chr strings.  Otherwise a numeric vector specifies the number of observations required for a full cycle of the input parameter.  Defaults to <code>'daily'</code> for a diurnal parameter.</p>
</td></tr>
<tr><td><code id="decomp_+3A_start">start</code></td>
<td>
<p>numeric vector indicating the starting value for the time series given the frequency.  Only required if <code>frequency</code> is numeric. See <code><a href="stats.html#topic+ts">ts</a></code>.</p>
</td></tr>
<tr><td><code id="decomp_+3A_date_col">date_col</code></td>
<td>
<p>chr string of the name of the date column</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a simple wrapper to the <code><a href="stats.html#topic+decompose">decompose</a></code> function.  The <code>decompose</code> function separates a time series into additive or multiplicative components describing a trend, cyclical variation (e.g., daily or annual), and the remainder.  The additive decomposition assumes that the cyclical component of the time series is stationary (i.e., the variance is constant), whereas a multiplicative decomposition accounts for non-stationarity.  By default, a moving average with a symmetric window is used to filter the cyclical component.  Alternatively, a vector of filter coefficients in reverse time order can be supplied (see <code><a href="stats.html#topic+decompose">decompose</a></code>).  
</p>
<p>The <code>decompose</code> function requires a ts object with a specified frequency.  The <code>decomp</code> function converts the input swmpr vector to a ts object prior to <code>decompose</code>.  This requires an explicit input defining the frequency in the time series required to complete a full period of the parameter.  For example, the frequency of a parameter with diurnal periodicity would be 96 if the time step is 15 minutes (24 hours * 60 minutes / 15 minutes).  The frequency of a parameter with annual periodicity at a 15 minute time step would be 35040 (365 days * 24 hours * 60 minutes / 15 minutes).  For simplicity, chr strings of <code>'daily'</code> or <code>'annual'</code> can be supplied in place of numeric values.  A starting value of the time series must be supplied in the latter case.  Use of the <code><a href="#topic+setstep">setstep</a></code> function is required to standardize the time step prior to decomposition.  
</p>
<p>Note that the <code>decompose</code> function is a relatively simple approach and alternative methods should be investigated if a more sophisticated decomposition is desired.
</p>


<h3>Value</h3>

<p>Returns a decomposed.ts object
</p>


<h3>References</h3>

<p>M. Kendall and A. Stuart (1983) The Advanced Theory of Statistics, Vol. 3, Griffin. pp. 410-414.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+decompose">decompose</a></code>, <code><a href="stats.html#topic+ts">ts</a></code>, <code><a href="stats.html#topic+stl">stl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## get data
data(apadbwq)
swmp1 &lt;- apadbwq

## subset for daily decomposition
dat &lt;- subset(swmp1, subset = c('2013-07-01 00:00', '2013-07-31 00:00'))

## decomposition and plot
test &lt;- decomp(dat, param = 'do_mgl', frequency = 'daily')
plot(test)

## dealing with missing values
dat &lt;- subset(swmp1, subset = c('2013-06-01 00:00', '2013-07-31 00:00'))

## this returns an error
## Not run: 
test &lt;- decomp(dat, param = 'do_mgl', frequency = 'daily')

## End(Not run)

## how many missing values?
sum(is.na(dat$do_mgl))

## use na.approx to interpolate missing data
dat &lt;- na.approx(dat, params = 'do_mgl', maxgap = 10)

## decomposition and plot
test &lt;- decomp(dat, param = 'do_mgl', frequency = 'daily')
plot(test)
</code></pre>

<hr>
<h2 id='decomp_cj'>Simple trend decomposition of monthly swmpr data</h2><span id='topic+decomp_cj'></span><span id='topic+decomp_cj.swmpr'></span><span id='topic+decomp_cj.default'></span>

<h3>Description</h3>

<p>Decompose monthly SWMP time series into grandmean, annual, seasonal, and event series as described in Cloern and Jassby 2010.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decomp_cj(dat_in, ...)

## S3 method for class 'swmpr'
decomp_cj(
  dat_in,
  param,
  vals_out = FALSE,
  event = TRUE,
  type = c("add", "mult"),
  center = c("mean", "median"),
  ...
)

## Default S3 method:
decomp_cj(
  dat_in,
  param,
  date_col,
  vals_out = FALSE,
  event = TRUE,
  type = c("add", "mult"),
  center = c("mean", "median"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decomp_cj_+3A_dat_in">dat_in</code></td>
<td>
<p>input data object</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_...">...</code></td>
<td>
<p>additional arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_param">param</code></td>
<td>
<p>chr string of variable to decompose</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_vals_out">vals_out</code></td>
<td>
<p>logical indicating of numeric output is returned, default is <code>FALSE</code> to return a plot.</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_event">event</code></td>
<td>
<p>logical indicating if an 'events' component should be determined</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_type">type</code></td>
<td>
<p>chr string indicating the type of decomposition, either additive (<code>'add'</code>) or multiplicative (<code>'mult'</code>)</p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_center">center</code></td>
<td>
<p>chr string indicating the method of centering, either <code>'mean'</code> or <code>'median'</code></p>
</td></tr>
<tr><td><code id="decomp_cj_+3A_date_col">date_col</code></td>
<td>
<p>chr string indicating the name of the date column which should be a date or POSIX object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a simple wrapper to the <code>decompTs</code> function in the archived wq package, also described in Cloern and Jassby (2010).  The function is similar to <code><a href="#topic+decomp.swmpr">decomp.swmpr</a></code> (which is a wrapper to <code><a href="stats.html#topic+decompose">decompose</a></code>) with a few key differences.  The <code><a href="#topic+decomp.swmpr">decomp.swmpr</a></code> function decomposes the time series into a trend, seasonal, and random components, whereas the current function decomposes into the grandmean, annual, seasonal, and events components.  For both functions, the random or events components, respectively, can be considered anomalies that don't follow the trends in the remaining categories.  
</p>
<p>The <code>decomp_cj</code> function provides only a monthly decomposition, which is appropriate for characterizing relatively long-term trends.  This approach is meant for nutrient data that are obtained on a monthly cycle.  The function will also work with continuous water quality or weather data but note that the data are first aggregated on the monthly scale before decomposition.  Use the <code><a href="#topic+decomp.swmpr">decomp.swmpr</a></code> function to decompose daily variation.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object if <code>vals_out = FALSE</code> (default), otherwise a monthly time series matrix of class <code><a href="stats.html#topic+ts">ts</a></code>.
</p>


<h3>References</h3>

<p>Cloern, J.E., Jassby, A.D. 2010. Patterns and scales of phytoplankton variability in estuarine-coastal ecosystems. Estuaries and Coasts. 33:230-241.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ts">ts</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apacpnut)
dat &lt;- apacpnut
dat &lt;- qaqc(dat, qaqc_keep = NULL)

## decomposition of chl, values as data.frame
decomp_cj(dat, param = 'chla_n', vals_out = TRUE)

## decomposition of chl, ggplot
decomp_cj(dat, param = 'chla_n')

## decomposition changing arguments passed to decompTs
decomp_cj(dat, param = 'chla_n', type = 'mult')

## Not run: 
## monthly decomposition of continuous data
data(apacpwq)
dat2 &lt;- qaqc(apacpwq)

decomp_cj(dat2, param = 'do_mgl')

## using the default method with a data frame
dat &lt;- data.frame(dat)
decomp_cj(dat, param = 'chla_n', date_col = 'datetimestamp')

## End(Not run)
</code></pre>

<hr>
<h2 id='decompTs'>Decompose a time series</h2><span id='topic+decompTs'></span>

<h3>Description</h3>

<p>The function decomposes a time series into a long-term mean, annual, seasonal and &quot;events&quot; component. The decomposition can be multiplicative or additive, and based on median or mean centering. Function and documentation herein are from archived wq package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decompTs(
  x,
  event = TRUE,
  type = c("add", "mult"),
  center = c("mean", "median")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decompTs_+3A_x">x</code></td>
<td>
<p>a monthly time series vector</p>
</td></tr>
<tr><td><code id="decompTs_+3A_event">event</code></td>
<td>
<p>whether or not an &quot;events&quot; component should be determined</p>
</td></tr>
<tr><td><code id="decompTs_+3A_type">type</code></td>
<td>
<p>the type of decomposition, either multiplicative (&quot;mult&quot;) or additive (&quot;add&quot;)</p>
</td></tr>
<tr><td><code id="decompTs_+3A_center">center</code></td>
<td>
<p>the method of centering, either median or mean</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The rationale for this simple approach to decomposing a time series, with examples of its application, is given by Cloern and Jassby (2010). It is motivated by the observation that many important events for estuaries (e.g., persistent dry periods, species invasions) start or stop suddenly. Smoothing to extract the annualized term, which can disguise the timing of these events and make analysis of them unnecessarily difficult, is not used.
</p>
<p>A multiplicative decomposition will typically be useful for a biological community- or population-related variable (e.g., chlorophyll-a) that experiences exponential changes in time and is approximately lognormal, whereas an additive decomposition is more suitable for a normal variable. The default centering method is the median, especially appropriate for series that have large, infrequent events.
</p>
<p>If <code>event = TRUE</code>, the seasonal component represents a recurring monthly pattern and the events component a residual series. Otherwise, the seasonal component becomes the residual series. The latter is appropriate when seasonal patterns change systematically over time.
</p>


<h3>Value</h3>

<p>A monthly time series matrix with the following individual time series:
</p>
<table>
<tr><td><code>original</code></td>
<td>
<p>original time series</p>
</td></tr>
<tr><td><code>annual</code></td>
<td>
<p>annual mean series</p>
</td></tr>
<tr><td><code>seasonal</code></td>
<td>
<p>repeating seasonal component</p>
</td></tr>
<tr><td><code>events</code></td>
<td>
<p>optionally, the residual or &quot;events&quot; series</p>
</td></tr>
</table>


<h3>References</h3>

<p>Cloern, J.E. and Jassby, A.D. (2010) Patterns and scales of phytoplankton variability in estuarine-coastal ecosystems. <em>Estuaries and Coasts</em> <b>33,</b> 230&ndash;241.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+decomp_cj">decomp_cj</a></code>
</p>

<hr>
<h2 id='ecometab'>Ecosystem metabolism</h2><span id='topic+ecometab'></span><span id='topic+ecometab.swmpr'></span><span id='topic+ecometab.default'></span>

<h3>Description</h3>

<p>Estimate ecosystem metabolism using the Odum open-water method.  Estimates of daily integrated gross production, total respiration, and net ecosystem metabolism are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecometab(dat_in, ...)

## S3 method for class 'swmpr'
ecometab(dat_in, depth_val = NULL, metab_units = "mmol", trace = FALSE, ...)

## Default S3 method:
ecometab(
  dat_in,
  tz,
  lat,
  long,
  depth_val = NULL,
  metab_units = "mmol",
  trace = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ecometab_+3A_dat_in">dat_in</code></td>
<td>
<p>Input data object, see details for required time series</p>
</td></tr>
<tr><td><code id="ecometab_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
<tr><td><code id="ecometab_+3A_depth_val">depth_val</code></td>
<td>
<p>numeric value for station depth (m) if time series is not available</p>
</td></tr>
<tr><td><code id="ecometab_+3A_metab_units">metab_units</code></td>
<td>
<p>chr indicating desired units of output for oxygen, either as mmol or grams</p>
</td></tr>
<tr><td><code id="ecometab_+3A_trace">trace</code></td>
<td>
<p>logical indicating if progress is shown in the console</p>
</td></tr>
<tr><td><code id="ecometab_+3A_tz">tz</code></td>
<td>
<p>chr string for timezone, e.g., 'America/Chicago'</p>
</td></tr>
<tr><td><code id="ecometab_+3A_lat">lat</code></td>
<td>
<p>numeric for latitude</p>
</td></tr>
<tr><td><code id="ecometab_+3A_long">long</code></td>
<td>
<p>numeric for longitude (negative west of prime meridian)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Input data include both water quality and weather time series, which are typically collected with independent instrument systems.  For SWMP data, this requires merging water quality and meteorology <code>swmpr</code> data objects using the <code><a href="#topic+comb">comb</a></code> function (see examples).  For the default method not using SWMP data, the input <code>data.frame</code> must have columns named <code>datetimestamp</code> (date/time column, as <code><a href="base.html#topic+POSIXct">POSIXct</a></code> object), <code>do_mgl</code> (dissolved oxygen, mg/L), <code>depth</code> (depth, m), <code>atemp</code> (air temperature, C), <code>sal</code> (salinity, psu), <code>temp</code> (water temperature, C), <code>wspd</code> (wind speed, m/s), and <code>bp</code> (barometric pressure, mb). 
</p>
<p>The open-water method is a common approach to quantify net ecosystem metabolism using a mass balance equation that describes the change in dissolved oxygen over time from the balance between photosynthetic and respiration processes, corrected using an empirically constrained air-sea gas diffusion model (see Ro and Hunt 2006, Thebault et al. 2008).  The diffusion-corrected DO flux estimates are averaged separately over each day and night of the time series. The nighttime average DO flux is used to estimate respiration rates, while the daytime DO flux is used to estimate net primary production. To generate daily integrated rates, respiration rates are assumed constant such that hourly night time DO flux rates are multiplied by 24. Similarly, the daytime DO flux rates are multiplied by the number of daylight hours, which varies with location and time of year, to yield net daytime primary production. Respiration rates are subtracted from daily net production estimates to yield gross production rates.  The metabolic day is considered the 24 hour period between sunsets on two adjacent calendar days.
</p>
<p>Areal rates for gross production and total respiration are based on volumetric rates normalized to the depth of the water column at the sampling location, which is assumed to be well-mixed, such that the DO sensor is reflecting the integrated processes in the entire water column (including the benthos).  Water column depth is calculated as the mean value of the depth variable across the time series in the <code><a href="#topic+swmpr">swmpr</a></code> object.  Depth values are floored at one meter for very shallow stations and 0.5 meters is also added to reflect the practice of placing sensors slightly off of the bottom. A user-supplied depth value can also be passed to the <code>depth_val</code> argument, either as a single value that is repeated or as a vector equal in length to the number of rows in the input data.  An accurate depth value should be used as this acts as a direct scalar on metabolism estimates.
</p>
<p>The air-sea gas exchange model is calibrated with wind data either collected at, or adjusted to, wind speed at 10 m above the surface. The metadata should be consulted for exact height.  The value can be changed manually using a <code>height</code> argument, which is passed to <code><a href="#topic+calckl">calckl</a></code>.
</p>
<p>A minimum of three records are required for both day and night periods to calculate daily metabolism estimates.  Occasional missing values for air temperature, barometric pressure, and wind speed are replaced with the climatological means (hourly means by month) for the period of record using adjacent data within the same month as the missing data.
</p>
<p>All DO calculations within the function are done using molar units (e.g., mmol O2 m-3).  The output can be returned as mass units by setting <code>metab_units = 'grams'</code> (i.e., 1mol = 32 g O2, which multiplies all estimates by 32 g mol-1/1000 mg/g).  Input data must be in standard mass units for DO (mg L-1).
</p>
<p>The specific approach for estimating metabolism with the open-water method is described in Caffrey et al. 2013 and references cited therein.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> of daily integrated metabolism estimates is returned. If a <code><a href="#topic+swmpr">swmpr</a></code> object is passed to the function, this <code>data.frame</code> is added to the <code>metab</code> attribute and the original object is returned.  See the examples for retrieval from a <code>swmpr</code> object.  The metabolism <code>data.frame</code> contains the following:  
</p>

<dl>
<dt><code>date</code></dt><dd><p>The metabolic day, defined as the 24 hour period starting at sunrise (calculated using <code><a href="#topic+metab_day">metab_day</a></code>)</p>
</dd>
<dt><code>DOF_d</code></dt><dd><p>Mean DO flux during day hours, mmol m-2 hr-1. Day hours are calculated using the <code><a href="#topic+metab_day">metab_day</a></code> function.</p>
</dd>
<dt><code>D_d</code></dt><dd><p>Mean air-sea gas exchange of DO during day hours, mmol m-2 hr-1</p>
</dd>
<dt><code>DOF_n</code></dt><dd><p>Mean DO flux during night hours, mmol m-2 hr-1</p>
</dd>
<dt><code>D_n</code></dt><dd><p>Mean air-sea gas exchange of DO during night hours, mmol m-2 hr-1</p>
</dd>
<dt><code>Pg</code></dt><dd><p>Gross production, mmol m-2 d-1, calculated as ((DOF_d - D_d) - (DOF_n - D_n)) * day hours</p>
</dd>
<dt><code>Rt</code></dt><dd><p>Total respiration, mmol m-2 d-1, calculated as (DOF_n - D_n) * 24</p>
</dd>
<dt><code>NEM</code></dt><dd><p>Net ecosytem metabolism, mmol m-2 d-1, calculated as Pg + Rt</p>
</dd>
</dl>



<h3>References</h3>

<p>Caffrey JM, Murrell MC, Amacker KS, Harper J, Phipps S, Woodrey M. 2013. Seasonal and inter-annual patterns in primary production, respiration and net ecosystem metabolism in 3 estuaries in the northeast Gulf of Mexico. Estuaries and Coasts. 37(1):222-241.
</p>
<p>Odum HT. 1956. Primary production in flowing waters. Limnology and Oceanography. 1(2):102-117.
</p>
<p>Ro KS, Hunt PG. 2006. A new unified equation for wind-driven surficial oxygen transfer into stationary water bodies. Transactions of the American Society of Agricultural and Biological Engineers. 49(5):1615-1622.
</p>
<p>Thebault J, Schraga TS, Cloern JE, Dunlavey EG. 2008. Primary production and carrying capacity of former salt ponds after reconnection to San Francisco Bay. Wetlands. 28(3):841-851.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+calckl">calckl</a></code> for estimating the oxygen mass transfer coefficient used with the air-sea gas exchange model, <code><a href="#topic+comb">comb</a></code> for combining <code>swmpr</code> objects, <code><a href="#topic+metab_day">metab_day</a></code> for identifying the metabolic day for each observation in the time series, <code><a href="#topic+plot_metab">plot_metab</a></code> for plotting the results, and <code><a href="#topic+aggremetab">aggremetab</a></code> for aggregating the metabolism attribute.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## import water quality and weather data, qaqc
data(apadbwq)
data(apaebmet)
wq &lt;- qaqc(apadbwq)
met &lt;- qaqc(apaebmet)

## combine
dat &lt;- comb(wq, met)

## output units in grams of oxygen
res &lt;- ecometab(dat, metab_units = 'grams')
attr(res, 'metabolism')

## manual input of integration depth
## NA values must be filled
dat_fill &lt;- na.approx(dat, params = 'depth', maxgap = 1e6)
depth &lt;- dat_fill$depth
res &lt;- ecometab(dat, metab_units = 'grams', depth_val = depth)
attr(res, 'metabolism')

## use the default method for ecometab with a generic data frame
## first recreate a generic object from the sample data
cols &lt;- c('datetimestamp', 'do_mgl', 'depth', 'atemp', 'sal', 'temp', 'wspd', 'bp')
dat &lt;- data.frame(dat)
dat &lt;- dat[, cols]
res &lt;- ecometab(dat, tz = 'America/Jamaica', lat = 29.67, long = -85.06)
res

## End(Not run)
</code></pre>

<hr>
<h2 id='gradcols'>Get colors for plots</h2><span id='topic+gradcols'></span>

<h3>Description</h3>

<p>Get gradient default colors for plots
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gradcols(col_vec = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gradcols_+3A_col_vec">col_vec</code></td>
<td>
<p>chr string of plot colors to use. Any color palette from RColorBrewer can be used as a named input. Palettes from grDevices must be supplied as the returned string of colors for each palette.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a convenience function for retrieving a color palette.  Palettes from RColorBrewer will use the maximum number of colors.  The default palette is 'Spectral'.
</p>


<h3>Value</h3>

<p>A character vector of colors in hexidecimal notation.
</p>

<hr>
<h2 id='hist.swmpr'>Plot swmpr using a histogram</h2><span id='topic+hist.swmpr'></span>

<h3>Description</h3>

<p>Plot a histogram showing the distribution of a swmpr parameter
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'swmpr'
hist(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hist.swmpr_+3A_x">x</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="hist.swmpr_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The swmpr method for histograms is a convenience function for the default histogram function.  Conventional histogram methods also work well since swmpr objects are also data frames.  The input data must contain only one parameter.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apadbwq)
dat &lt;- subset(apadbwq, select = 'do_mgl')

## histogram using swmpr method
hist(dat)

## change axis labels, plot title
hist(dat, xlab = 'Dissolved oxygen', main = 'Histogram of DO')

## plot using default method
hist(dat$do_mgl)
</code></pre>

<hr>
<h2 id='import_local'>Import local CDMO data</h2><span id='topic+import_local'></span>

<h3>Description</h3>

<p>Import local data that were obtained from the CDMO through the zip downloads feature
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_local(
  path,
  station_code,
  trace = FALSE,
  collMethd = c("1", "2"),
  keep_qaqcstatus = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import_local_+3A_path">path</code></td>
<td>
<p>chr string of full path to .csv files with raw data, can be a zipped or unzipped directory where the former must include the .zip extension</p>
</td></tr>
<tr><td><code id="import_local_+3A_station_code">station_code</code></td>
<td>
<p>chr string of station to import, typically 7 or 8 characters including wq, nut, or met extensions, may include full name with year, excluding file extension</p>
</td></tr>
<tr><td><code id="import_local_+3A_trace">trace</code></td>
<td>
<p>logical indicating if progress is sent to console, default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="import_local_+3A_collmethd">collMethd</code></td>
<td>
<p>chr string of nutrient data to subset. 1 indicates monthly, 2 indicates diel. Default is both diel and monthly data.</p>
</td></tr>
<tr><td><code id="import_local_+3A_keep_qaqcstatus">keep_qaqcstatus</code></td>
<td>
<p>logical indicating if the <code>historical</code> and <code>provisionalplus</code> columns are retained in the output (default <code>FALSE</code>), see details</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is designed to import local data that were downloaded from the CDMO outside of R. This approach works best for larger data requests, specifically those from the zip downloads feature in the advanced query section of the CDMO. The function may also work using data from the data export system, but this feature has not been extensively tested. The downloaded data will be in a compressed folder that includes multiple .csv files by year for a given data type (e.g., apacpwq2002.csv, apacpwq2003.csv, apacpnut2002.csv, etc.). The import_local function can be used to import files directly from the compressed folder or after the folder is decompressed.  In the former case, the requested files are extracted to a temporary directory and then deleted after they are loaded into the current session.  An example dataset is available online to illustrate the format of the data provided through the zip downloads feature.  See the link below to access these data.  All example datasets included with the package were derived from these raw data.
</p>
<p>Occasionally, duplicate time stamps are present in the raw data.  The function handles duplicate entries differently depending on the data type (water quality,  weather, or nutrients).  For water quality and nutrient data, duplicate time stamps are simply removed.  Note that nutrient data often contain replicate samples with similar but not duplicated time stamps within a few minutes of each other.  Replicates with unique time stamps are not removed but can be further processed using <code><a href="#topic+rem_reps">rem_reps</a></code>.  Weather data prior to 2007 may contain duplicate time stamps at frequencies for 60 (hourly) and 144 (daily) averages, in addition to 15 minute frequencies.  Duplicate values that correspond to the smallest value in the frequency column (15 minutes) are retained.  
</p>
<p>If <code>keep_qaqcstatus = TRUE</code>, the <code>historical</code> and <code>provisionalplus</code> columns are retained in the output.  These two columns include integer values as 0 or 1.  From the CDMO web page, a value of 0 in the <code>historical</code> column indicates that the data have not been through final QAQC by the CDMO. A value of 1 indicates that the data have been through final tertiary review at the CDMO and posted as the final authoritative data. A value of 0 in the <code>provisionalplus</code> column indicates that the data have been through the automated flagging process (primary QAQC) only and have not been checked by the Reserve. A value of 1 in the <code>provisionalplus</code> column indicates that the data have been through secondary QAQC at the Reserve using Excel macros (provided by the CDMO) to further QAQC the data.
</p>
<p>Zip download request through CDMO: <a href="https://cdmo.baruch.sc.edu/aqs/zips.cfm">https://cdmo.baruch.sc.edu/aqs/zips.cfm</a>
</p>
<p>Example dataset: <a href="https://s3.amazonaws.com/swmpexdata/zip_ex.zip">https://s3.amazonaws.com/swmpexdata/zip_ex.zip</a>
</p>


<h3>Value</h3>

<p>Returns a swmpr object with all parameters and QAQC columns for the station.  The full date range in the raw data are also imported.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all_params">all_params</a></code>, <code><a href="#topic+all_params_dtrng">all_params_dtrng</a></code>, <code><a href="#topic+rem_reps">rem_reps</a></code>, <code><a href="#topic+single_param">single_param</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## this is the path for csv example files, decompressed
path &lt;- 'C:/this/is/my/data/path'

## import, do not include file extension
import_local(path, 'apaebmet') 

## this is the path for csv example files, zipped folder
path &lt;- 'C:/this/is/my/data/path.zip'

## import, do not include file extension
import_local(path, 'apaebmet') 

## End(Not run)
</code></pre>

<hr>
<h2 id='map_reserve'>Map a reserve</h2><span id='topic+map_reserve'></span>

<h3>Description</h3>

<p>Create a map of all the stations in a reserve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_reserve(nerr_site_id, text_sz = 6, text_col = "black", f = 0.2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="map_reserve_+3A_nerr_site_id">nerr_site_id</code></td>
<td>
<p>chr string of the reserve to map, first three characters used by NERRS or vector of stations to map using the first five characters</p>
</td></tr>
<tr><td><code id="map_reserve_+3A_text_sz">text_sz</code></td>
<td>
<p>numeric value for text size of station names, passed to <code><a href="ggplot2.html#topic+geom_text">geom_text</a></code></p>
</td></tr>
<tr><td><code id="map_reserve_+3A_text_col">text_col</code></td>
<td>
<p>chr string for text color of station names, passed to <code><a href="ggplot2.html#topic+geom_text">geom_text</a></code></p>
</td></tr>
<tr><td><code id="map_reserve_+3A_f">f</code></td>
<td>
<p>numeric passed to <code><a href="ggmap.html#topic+make_bbox">make_bbox</a></code> as expansion around the bounding box for stations at a NERR site, increase to expand map zoom chr</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a simple wrapper to functions in the ggmap package which returns a map of all of the stations at a NERRS reserve.  The <code>f</code> argument may have to be chosen through trial and error depending on the spatial extent of the reserve.  A local data file included with the package is used to get the latitude and longitude values of each station.  The files includes only active stations as of January 2015.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object for plotting.
</p>


<h3>See Also</h3>

<p><code><a href="ggmap.html#topic+get_map">get_map</a></code>, <code><a href="ggmap.html#topic+ggmap">ggmap</a></code>, <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
map_reserve('jac')

## End(Not run)
</code></pre>

<hr>
<h2 id='metab_day'>Identify metabolic days in a time series</h2><span id='topic+metab_day'></span><span id='topic+metab_day.default'></span>

<h3>Description</h3>

<p>Identify metabolic days in a time series based on sunrise and sunset times for a location and date.  The metabolic day is considered the 24 hour period between sunsets for two adjacent calendar days.  The function calls the <code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code> function from the suncalc package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metab_day(dat_in, ...)

## Default S3 method:
metab_day(dat_in, tz, lat, long, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="metab_day_+3A_dat_in">dat_in</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="metab_day_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="metab_day_+3A_tz">tz</code></td>
<td>
<p>chr string for timezone, e.g., 'America/Chicago'</p>
</td></tr>
<tr><td><code id="metab_day_+3A_lat">lat</code></td>
<td>
<p>numeric for latitude</p>
</td></tr>
<tr><td><code id="metab_day_+3A_long">long</code></td>
<td>
<p>numeric for longitude (negative west of prime meridian)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is only used within <code><a href="#topic+ecometab">ecometab</a></code> and should not be called explicitly.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ecometab">ecometab</a></code>, <code><a href="suncalc.html#topic+getSunlightTimes">getSunlightTimes</a></code>
</p>

<hr>
<h2 id='na.approx.swmpr'>Linearly interpolate gaps</h2><span id='topic+na.approx.swmpr'></span>

<h3>Description</h3>

<p>Linearly interpolate gaps in swmpr data within a maximum size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'swmpr'
na.approx(object, params = NULL, maxgap, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na.approx.swmpr_+3A_object">object</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="na.approx.swmpr_+3A_params">params</code></td>
<td>
<p>is chr string of swmpr parameters to smooth, default all</p>
</td></tr>
<tr><td><code id="na.approx.swmpr_+3A_maxgap">maxgap</code></td>
<td>
<p>numeric vector indicating maximum gap size to interpolate where size is numer of records, must be explicit</p>
</td></tr>
<tr><td><code id="na.approx.swmpr_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A common approach for handling missing data in time series analysis is linear interpolation.  A simple curve fitting method is used to create a continuous set of records between observations separated by missing data.  A required argument for the function is <code>maxgap</code> which defines the maximum gap size  for interpolation. The ability of the interpolated data to approximate actual, unobserved trends is a function of the gap size.  Interpolation between larger gaps are less likely to resemble patterns of an actual parameter, whereas interpolation between smaller gaps may be more likely to resemble actual patterns.  An appropriate gap size limit depends on the unique characteristics of specific datasets or parameters.
</p>


<h3>Value</h3>

<p>Returns a swmpr object. QAQC columns are removed if included with input object.
</p>


<h3>See Also</h3>

<p><code><a href="zoo.html#topic+na.approx">na.approx</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(apadbwq)
dat &lt;- qaqc(apadbwq)
dat &lt;- subset(dat, select = 'do_mgl', 
 subset = c('2013-01-22 00:00', '2013-01-26 00:00'))

# interpolate, maxgap of 10 records
fill1 &lt;- na.approx(dat, params = 'do_mgl', maxgap = 10)

# interpolate maxgap of 30 records
fill2 &lt;- na.approx(dat, params = 'do_mgl', maxgap = 30)

# plot for comparison
par(mfrow = c(3, 1))
plot(fill1, col = 'red', main = 'Interpolation - maximum gap of 10 records')
lines(dat)
plot(fill2, col = 'red', main = 'Interpolation - maximum gap of 30 records')
lines(dat)
</code></pre>

<hr>
<h2 id='overplot'>Plot multiple SWMP time series on the same y-axis</h2><span id='topic+overplot'></span><span id='topic+overplot.swmpr'></span><span id='topic+overplot.default'></span>

<h3>Description</h3>

<p>Plot multiple SWMP time series on the same y-axis, aka overplotting
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overplot(dat_in, ...)

## S3 method for class 'swmpr'
overplot(
  dat_in,
  select = NULL,
  subset = NULL,
  operator = NULL,
  ylabs = NULL,
  xlab = NULL,
  cols = NULL,
  lty = NULL,
  lwd = NULL,
  pch = NULL,
  type = NULL,
  ...
)

## Default S3 method:
overplot(
  dat_in,
  date_var,
  select = NULL,
  ylabs = NULL,
  xlab = NULL,
  cols = NULL,
  lty = NULL,
  lwd = NULL,
  inset = -0.15,
  cex = 1,
  xloc = "top",
  yloc = NULL,
  pch = NULL,
  type = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overplot_+3A_dat_in">dat_in</code></td>
<td>
<p>input data object</p>
</td></tr>
<tr><td><code id="overplot_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
<tr><td><code id="overplot_+3A_select">select</code></td>
<td>
<p>chr string of variable(s) to plot, passed to <code><a href="base.html#topic+subset">subset</a></code>.  This is a required argument for the default method.</p>
</td></tr>
<tr><td><code id="overplot_+3A_subset">subset</code></td>
<td>
<p>chr string of form 'YYYY-mm-dd HH:MM' to subset a date range. Input can be one (requires operator) or two values (a range).  Passed to <code><a href="base.html#topic+subset">subset</a></code>.</p>
</td></tr>
<tr><td><code id="overplot_+3A_operator">operator</code></td>
<td>
<p>chr string specifiying binary operator (e.g., '&gt;', '&lt;=') if subset is one date value, passed to <code><a href="base.html#topic+subset">subset</a></code></p>
</td></tr>
<tr><td><code id="overplot_+3A_ylabs">ylabs</code></td>
<td>
<p>chr string of labels for y-axes, default taken from <code>select</code> argument</p>
</td></tr>
<tr><td><code id="overplot_+3A_xlab">xlab</code></td>
<td>
<p>chr string of label for x-axis</p>
</td></tr>
<tr><td><code id="overplot_+3A_cols">cols</code></td>
<td>
<p>chr string of colors to use for lines</p>
</td></tr>
<tr><td><code id="overplot_+3A_lty">lty</code></td>
<td>
<p>numeric indicating line types, one value for all or values for each parameter</p>
</td></tr>
<tr><td><code id="overplot_+3A_lwd">lwd</code></td>
<td>
<p>numeric indicating line widths, one value for all or values for each parameter, used as <code>cex</code> for point size if <code>type = 'p'</code></p>
</td></tr>
<tr><td><code id="overplot_+3A_pch">pch</code></td>
<td>
<p>numeric for point type of points are used</p>
</td></tr>
<tr><td><code id="overplot_+3A_type">type</code></td>
<td>
<p>character string indicating <code>'p'</code> or <code>'l'</code> for points or lines, as a single value for all parameters or a combined vector equal in length to the number of parameters</p>
</td></tr>
<tr><td><code id="overplot_+3A_date_var">date_var</code></td>
<td>
<p>chr string of the name for the datetimestamp column, not required for <code><a href="#topic+swmpr">swmpr</a></code> objects</p>
</td></tr>
<tr><td><code id="overplot_+3A_inset">inset</code></td>
<td>
<p>numeric of relative location of legend, passed to <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="overplot_+3A_cex">cex</code></td>
<td>
<p>numeric of scale factor for legend, passed to <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="overplot_+3A_xloc">xloc</code></td>
<td>
<p>x location of legend, passed to <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="overplot_+3A_yloc">yloc</code></td>
<td>
<p>y location of legend, passed to <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>One to many SWMP parameters can be plotted on the same y-axis to facilitate visual comparison.  This is commonly known as overplotting.  The building blocks of this function include <code><a href="graphics.html#topic+plot">plot</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>, and <code><a href="graphics.html#topic+mtext">mtext</a></code>.
</p>


<h3>Value</h3>

<p>An R plot created using base graphics
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+subset">subset</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import data
data(apacpwq)
dat &lt;- qaqc(apacpwq)

## plot
overplot(dat)

## a truly heinous plot
overplot(dat, select = c('depth', 'do_mgl', 'ph', 'turb'), 
 subset = c('2013-01-01 0:0', '2013-02-01 0:0'), lwd = 2)
 
## Not run: 
## change the type argument if plotting discrete and continuous data
swmp1 &lt;- apacpnut
swmp2 &lt;- apaebmet
dat &lt;- comb(swmp1, swmp2, timestep = 120, method = 'union')
overplot(dat, select = c('chla_n', 'atemp'), subset = c('2012-01-01 0:0', '2013-01-01 0:0'), 
 type = c('p', 'l'))

## End(Not run)
</code></pre>

<hr>
<h2 id='oxySol'>Dissolved oxygen at saturation</h2><span id='topic+oxySol'></span>

<h3>Description</h3>

<p>Finds dissolved oxygen concentration in equilibrium with water-saturated air. Function and documentation herein are from archived wq package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oxySol(t, S, P = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="oxySol_+3A_t">t</code></td>
<td>
<p>numeric for temperature, degrees C</p>
</td></tr>
<tr><td><code id="oxySol_+3A_s">S</code></td>
<td>
<p>numeric for salinity, on the Practical Salinity Scale</p>
</td></tr>
<tr><td><code id="oxySol_+3A_p">P</code></td>
<td>
<p>numeric for pressure, atm</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculations are based on the approach of Benson and Krause (1984), using Green and Carritt's (1967) equation for dependence of water vapor partial pressure on <code>t</code> and <code>S</code>. Equations are valid for temperature in the range 0-40 C and salinity in the range 0-40.
</p>


<h3>Value</h3>

<p>Dissolved oxygen concentration in mg/L at 100% saturation. If <code>P = NULL</code>, saturation values at 1 atm are calculated.
</p>


<h3>References</h3>

<p>Benson, B.B. and Krause, D. (1984) The concentration and isotopic fractionation of oxygen dissolved in fresh-water and seawater in equilibrium with the atmosphere. <em>Limnology and Oceanography</em> <b>29,</b> 620-632.
</p>
<p>Green, E.J. and Carritt, D.E. (1967) New tables for oxygen saturation of seawater. <em>Journal of Marine Research</em> <b>25,</b> 140-147.
</p>

<hr>
<h2 id='param_names'>Get parameters of a given type</h2><span id='topic+param_names'></span>

<h3>Description</h3>

<p>Get parameter column names for each parameter type
</p>


<h3>Usage</h3>

<pre><code class='language-R'>param_names(param_type = c("nut", "wq", "met"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="param_names_+3A_param_type">param_type</code></td>
<td>
<p>chr string specifying <code>'nut'</code>, <code>'wq'</code>, or <code>'met'</code>.  Input can be one to three types.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used internally within several functions to return a list of the expected parameters for a given parameter type: nutrients, water quality, or meteorological.  It does not need to be called explicitly.
</p>


<h3>Value</h3>

<p>Returns a named list of parameters for the <code>param_type</code>.  The parameter names are lower-case strings of SWMP parameters and corresponding qaqc names (<code>'f_'</code> prefix)
</p>

<hr>
<h2 id='parser'>Parse web results for swmpr</h2><span id='topic+parser'></span>

<h3>Description</h3>

<p>Parsing function for objects returned from CDMO web services
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parser(resp_in, parent_in = "data")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parser_+3A_resp_in">resp_in</code></td>
<td>
<p>web object returned from CDMO server, response class from httr package</p>
</td></tr>
<tr><td><code id="parser_+3A_parent_in">parent_in</code></td>
<td>
<p>chr string of parent nodes to parse</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function parses XML objects returned from the CDMO server, which are further passed to <code><a href="#topic+swmpr">swmpr</a></code>.  It is used internally by the data retrieval functions, excluding <code><a href="#topic+import_local">import_local</a></code>.  The function does not need to be called explicitly.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> of parsed XML nodes
</p>

<hr>
<h2 id='plot_metab'>Plot ecosystem metabolism for a swmpr object</h2><span id='topic+plot_metab'></span><span id='topic+plot_metab.swmpr'></span>

<h3>Description</h3>

<p>Plot gross production, total respiration, and net ecosystem metabolism for a swmpr object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_metab(swmpr_in, ...)

## S3 method for class 'swmpr'
plot_metab(
  swmpr_in,
  by = "months",
  alpha = 0.05,
  width = 10,
  pretty = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_metab_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="plot_metab_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="plot_metab_+3A_by">by</code></td>
<td>
<p>chr string describing aggregation period, passed to <code><a href="#topic+aggremetab">aggremetab</a></code>. See details for accepted values.</p>
</td></tr>
<tr><td><code id="plot_metab_+3A_alpha">alpha</code></td>
<td>
<p>numeric indicating alpha level for confidence intervals in aggregated data. Use <code>NULL</code> to remove from the plot.</p>
</td></tr>
<tr><td><code id="plot_metab_+3A_width">width</code></td>
<td>
<p>numeric indicating width of top and bottom segments on error bars</p>
</td></tr>
<tr><td><code id="plot_metab_+3A_pretty">pretty</code></td>
<td>
<p>logical indicating use of predefined plot aesthetics</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A plot will only be returned if the <code>metabolism</code> attribute for the <code><a href="#topic+swmpr">swmpr</a></code> object is not <code>NULL</code>.  Daily metabolism estimates are also aggregated into weekly averages.  Accepted aggregation periods are <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, <code>'weeks'</code>, and <code>'days'</code> (if no aggregation is preferred).
</p>
<p>By default, <code>pretty = TRUE</code> will return a <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object with predefined aesthetics.  Setting <code>pretty = FALSE</code> will return the plot with minimal modifications to the <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object.  Use the latter approach for easier customization of the plot.
</p>


<h3>Value</h3>

<p>A <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> object which can be further modified.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+aggremetab">aggremetab</a></code>, <code><a href="#topic+ecometab">ecometab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## import water quality and weather data
data(apadbwq)
data(apaebmet)

## qaqc, combine
wq &lt;- qaqc(apadbwq)
met &lt;- qaqc(apaebmet)
dat &lt;- comb(wq, met)

## estimate metabolism
res &lt;- ecometab(dat)

## plot
plot_metab(res)

## change alpha, aggregation period, widths
plot_metab(res, by = 'quarters', alpha = 0.1, widths = 0)

## plot daily raw, no aesthetics
plot_metab(res, by = 'days', pretty = FALSE)

## note the difference if aggregating with a moving window average
plot_metab(res, by = 30)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot_quants'>Create a plot of data for a single year overlaid on historical data.</h2><span id='topic+plot_quants'></span><span id='topic+plot_quants.swmpr'></span>

<h3>Description</h3>

<p>A line for a single year is plotted over ribbons ofquantiles for historical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_quants(swmpr_in, ...)

## S3 method for class 'swmpr'
plot_quants(
  swmpr_in,
  paramtoplot,
  yr,
  yrstart,
  yrend,
  yaxislab = NULL,
  yrcolor = "red3",
  bgcolor1 = "lightgray",
  bgcolor2 = "gray65",
  maintitle = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_quants_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object.</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_...">...</code></td>
<td>
<p>additional arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_paramtoplot">paramtoplot</code></td>
<td>
<p>chr string of parameter to plot</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_yr">yr</code></td>
<td>
<p>numeric of year to feature as a line on the plot</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_yrstart">yrstart</code></td>
<td>
<p>numeric of year to begin range of comparison data</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_yrend">yrend</code></td>
<td>
<p>numeric of year to end range of comparison data</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_yaxislab">yaxislab</code></td>
<td>
<p>chr string for y-axis albel. Default is <code>paramtoplot</code>.</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_yrcolor">yrcolor</code></td>
<td>
<p>chr string of line color for year of interest</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_bgcolor1">bgcolor1</code></td>
<td>
<p>chr string of color for outer 50% of data range</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_bgcolor2">bgcolor2</code></td>
<td>
<p>chr string of color for middle 50% of data range.</p>
</td></tr>
<tr><td><code id="plot_quants_+3A_maintitle">maintitle</code></td>
<td>
<p>chr string of plot title. Default pastes together site name, parameter name, year to feature, and range of years to use for comparison, e.g. 'GNDBHWQ 2017 Daily Average Temp overlaid on 2006-2016 daily averages'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot is based on aggregates of daily average values for the entire time series. Quantiles (min, 25%, 75%, max) for each individual calendar day (01/01, 01/02, ... 12/31) are used to generate a ribbon plot of historical data and the selected year in <code>yr</code> is plotted as a line over the ribbon for historical context.
</p>
<p>required packages: dplyr, lubridate, ggplot2, tibble
</p>


<h3>Value</h3>

<p>A a <code><a href="ggplot2.html#topic+ggplot2">ggplot2</a></code> object.
</p>


<h3>Author(s)</h3>

<p>Kimberly Cressman, Marcus Beck
</p>


<h3>Examples</h3>

<pre><code class='language-R'># qaqc
dat &lt;- qaqc(apacpwq)

# generate a plot of salinity for 2013 overlaid on 2012-2013 data
plot_quants(dat, 'sal', yr = 2013, yrstart = 2012, yrend = 2013)

# change some of the defaults
plot_quants(dat, 'sal', yr = 2013, yrstart = 2012, yrend = 2013, 
 bgcolor1 = 'lightsteelblue2', bgcolor2 = 'lightsteelblue4', 
 yaxislab = 'Salinity (psu)')
</code></pre>

<hr>
<h2 id='plot_summary'>Plot graphical summaries of SWMP data</h2><span id='topic+plot_summary'></span><span id='topic+plot_summary.swmpr'></span>

<h3>Description</h3>

<p>Plot graphical summaries of SWMP data for individual parameters, including seasonal/annual trends and anomalies
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_summary(swmpr_in, ...)

## S3 method for class 'swmpr'
plot_summary(
  swmpr_in,
  param,
  colsleft = c("lightblue", "lightgreen"),
  colsmid = "lightblue",
  colsright = c("lightblue", "lightgreen", "tomato1"),
  base_size = 11,
  years = NULL,
  plt_sep = FALSE,
  sum_out = FALSE,
  fill = c("none", "monoclim", "interp"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_summary_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_...">...</code></td>
<td>
<p>additional arguments passed to other methods</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_param">param</code></td>
<td>
<p>chr string of variable to plot</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_colsleft">colsleft</code></td>
<td>
<p>chr string vector of length two indicating colors for left plots</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_colsmid">colsmid</code></td>
<td>
<p>chr string vector of length one indicating colors for middle plots</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_colsright">colsright</code></td>
<td>
<p>chr string vector of length three indicating colors for right plots</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_base_size">base_size</code></td>
<td>
<p>numeric for text size</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_years">years</code></td>
<td>
<p>numeric vector of starting and ending years to plot, default all</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_plt_sep">plt_sep</code></td>
<td>
<p>logical if a list is returned with separate plot elements</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_sum_out">sum_out</code></td>
<td>
<p>logical if summary data for the plots is returned</p>
</td></tr>
<tr><td><code id="plot_summary_+3A_fill">fill</code></td>
<td>
<p>chr string indicating if missing monthly values are left as is (<code>'none'</code>, default), replaced by long term monthly averages (<code>'monoclim'</code>), or linearly interpolated using <code><a href="zoo.html#topic+na.approx">na.approx</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates several graphics showing seasonal and annual trends for a given swmp parameter.  Plots include monthly distributions, monthly anomalies, and annual anomalies in multiple formats.  Anomalies are defined as the difference between the monthly or annual average from the grand mean.  Monthly anomalies are in relation to the grand mean for the same month across all years.  All data are aggregated for quicker plotting.  Nutrient data are based on monthly averages, wheras weather and water quality data are based on daily averages.  Cumulative precipitation data are based on the daily maximum.
</p>
<p>Individual plots can be obtained if <code>plt_sep = TRUE</code>.  Individual plots for elements one through six in the list correspond to those from top left to bottom right in the combined plot.
</p>
<p>Summary data for the plots can be obtained if <code>sum_out = TRUE</code>.  This returns a list with three data frames with names <code>sum_mo</code>, <code>sum_moyr</code>, and <code>sum_mo</code>.  The data frames match the plots as follows: <code>sum_mo</code> for the top left, bottom left, and center plots, <code>sum_moyr</code> for the top right and middle right plots, and <code>sum_yr</code> for the bottom right plot. 
</p>
<p>Missing values can be filled using the long-term average across years for each month (<code>fill = 'monoclim'</code>) or as a linear interpolation between missing values using <code><a href="zoo.html#topic+na.approx">na.approx</a></code> (<code>fill = 'interp'</code>).  The monthly average works well for long gaps, but may not be an accurate representation of long-term trends, i.e., real averages may differ early vs late in the time series if a trend exists. The linear interpolation option is preferred for small gaps.
</p>


<h3>Value</h3>

<p>A graphics object (Grob) of multiple <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> objects, otherwise a list of  individual <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code> objects if <code>plt_sep = TRUE</code> or a list with data frames of the summarized data if <code>sum_out = TRUE</code>.
</p>


<h3>See Also</h3>

<p><code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import data
data(apacpnut)
dat &lt;- qaqc(apacpnut)

## plot
plot_summary(dat, param = 'chla_n', years = c(2007, 2013))

## get individaul plots
plots &lt;- plot_summary(dat, param = 'chla_n', years = c(2007, 2013), plt_sep = TRUE)

plots[[1]] # top left
plots[[3]] # middle
plots[[6]] # bottom right

## get summary data
plot_summary(dat, param = 'chla_n', year = c(2007, 2013), sum_out = TRUE)

</code></pre>

<hr>
<h2 id='plot_wind'>Create a wind rose</h2><span id='topic+plot_wind'></span><span id='topic+plot_wind.swmpr'></span>

<h3>Description</h3>

<p>Create a wind rose from met data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_wind(swmpr_in, ...)

## S3 method for class 'swmpr'
plot_wind(
  swmpr_in,
  years = NULL,
  angle = 45,
  width = 1.5,
  breaks = 5,
  paddle = FALSE,
  grid.line = 10,
  max.freq = 30,
  cols = "GnBu",
  annotate = FALSE,
  main = NULL,
  type = "default",
  between = list(x = 1, y = 1),
  par.settings = NULL,
  strip = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_wind_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_years">years</code></td>
<td>
<p>numeric of years to plot, defaults to most recent</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_angle">angle</code></td>
<td>
<p>numeric for the number of degrees occupied by each spoke</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_width">width</code></td>
<td>
<p>numeric for width of paddles if <code>paddle = TRUE</code></p>
</td></tr>
<tr><td><code id="plot_wind_+3A_breaks">breaks</code></td>
<td>
<p>numeric for the number of break points in the wind speed</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_paddle">paddle</code></td>
<td>
<p>logical for paddles at the ends of the spokes</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_grid.line">grid.line</code></td>
<td>
<p>numeric for grid line interval to use</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_max.freq">max.freq</code></td>
<td>
<p>numeric for the scaling used to set the maximum value of the radial limits (like zoom)</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_cols">cols</code></td>
<td>
<p>chr string for colors to use for plotting, can be any palette R recognizes or a collection of colors as a vector</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_annotate">annotate</code></td>
<td>
<p>logical indicating if text is shown on the bottom of the plot for the percentage of observations as 'calm' and mean values</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_main">main</code></td>
<td>
<p>chr string for plot title, defaults to station name and year plotted</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_type">type</code></td>
<td>
<p>chr string for temporal divisions of the plot, defaults to whole year.  See details.</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_between">between</code></td>
<td>
<p>list for lattice plot options, defines spacing between plots</p>
</td></tr>
<tr><td><code id="plot_wind_+3A_par.settings">par.settings</code></td>
<td>
<p>list for optional plot formatting passed to <code><a href="lattice.html#topic+lattice.options">lattice.options</a></code></p>
</td></tr>
<tr><td><code id="plot_wind_+3A_strip">strip</code></td>
<td>
<p>list for optional strip formatting passed to <code><a href="lattice.html#topic+strip.custom">strip.custom</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a convenience wrapper to <code><a href="openair.html#topic+windRose">windRose</a></code>.  Most of the arguments are taken directly from this function.
</p>
<p>The <code>type</code> argument can be used for temporal divisions of the plot.  Options include the entire year (<code>type = "default"</code>), seasons (<code>type = "season"</code>), months (<code>type = "month"</code>), or weekdays (<code>type = "weekday"</code>).  Combinations are also possible (see <code><a href="openair.html#topic+windRose">windRose</a></code>).
</p>


<h3>Value</h3>

<p>A wind rose plot
</p>


<h3>Author(s)</h3>

<p>Kimberly Cressman, Marcus Beck
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot_wind(apaebmet)
</code></pre>

<hr>
<h2 id='plot.swmpr'>Plot swmpr data</h2><span id='topic+plot.swmpr'></span><span id='topic+lines.swmpr'></span>

<h3>Description</h3>

<p>Plot a time series of parameters in a swmpr object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'swmpr'
plot(x, type = "l", ...)

## S3 method for class 'swmpr'
lines(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.swmpr_+3A_x">x</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="plot.swmpr_+3A_type">type</code></td>
<td>
<p>chr string for type of plot, default <code>'l'</code>.  See <code><a href="graphics.html#topic+plot">plot</a></code>.</p>
</td></tr>
<tr><td><code id="plot.swmpr_+3A_...">...</code></td>
<td>
<p>other arguments passed to <code>par</code>, <code>plot.default</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The swmpr method for plotting is a convenience function for plotting a univariate time series.  Conventional plotting methods also work well since swmpr objects are also data frames.  See the examples for use with different methods.
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+plot">plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apadbwq)
swmp1 &lt;- apadbwq

## subset
dat &lt;- subset(swmp1, select = 'do_mgl', 
 subset = c('2013-07-01 00:00', '2013-07-31 00:00'))

## plot using swmpr method, note default line plot
plot(dat)

## plot using formula method
plot(do_mgl ~ datetimestamp, dat)

## plot using default, add lines
plot(dat, type = 'n')
lines(dat, col = 'red')
</code></pre>

<hr>
<h2 id='qaqc'>QAQC filtering for SWMP data</h2><span id='topic+qaqc'></span><span id='topic+qaqc.swmpr'></span>

<h3>Description</h3>

<p>QAQC filtering for SWMP data obtained from retrieval functions, local and remote
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qaqc(swmpr_in, ...)

## S3 method for class 'swmpr'
qaqc(swmpr_in, qaqc_keep = "0", trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qaqc_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="qaqc_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="qaqc_+3A_qaqc_keep">qaqc_keep</code></td>
<td>
<p>character string of qaqc flags to keep, default <code>'0'</code>, any number of flag codes can be supplied including three character error codes (see examples)</p>
</td></tr>
<tr><td><code id="qaqc_+3A_trace">trace</code></td>
<td>
<p>logical for progress output on console, default <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The qaqc function is a simple screen to retain values from the data with specified QAQC flags, described online: <a href="https://cdmo.baruch.sc.edu/data/qaqc.cfm">https://cdmo.baruch.sc.edu/data/qaqc.cfm</a>. Each parameter in the swmpr data typically has a corresponding QAQC column of the same name with the added prefix 'f_'. Values in the QAQC column specify a flag from -5 to 5. Generally, only data with the '0' QAQC flag should be used, which is the default option for the function. Data that do not satisfy QAQC criteria are converted to <code>NA</code> values. Additionally, simple filters are used to remove obviously bad values, e.g., wind speed values less than zero or pH values greater than 12. Erroneous data entered as -99 are also removed. Processed data will have QAQC columns removed, in addition to removal of values in the actual parameter columns that do not meet the criteria.
</p>
<p>The data are filtered by matching the flag columns with the character string provided by <code>qaqc_keep</code>.  A single combined string is created by pasting each element together using the '|' operator, then using partial string matching with <code><a href="base.html#topic+grepl">grepl</a></code> to compare the actual flags in the QAQC columns.  Values that can be passed to the function are those described online: <a href="https://cdmo.baruch.sc.edu/data/qaqc.cfm">https://cdmo.baruch.sc.edu/data/qaqc.cfm</a>.
</p>


<h3>Value</h3>

<p>Returns a swmpr object with <code>NA</code> values for records that did not match <code>qaqc_keep</code>.  QAQC columns are also removed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qaqcchk">qaqcchk</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## get data
data(apadbwq)
dat &lt;- apadbwq

## retain only '0' and '-1' flags
qaqc(dat, qaqc_keep = c('0', '-1'))

## retain observations with the 'CSM' error code
qaqc(dat, qaqc_keep = 'CSM')

## End(Not run)
</code></pre>

<hr>
<h2 id='qaqcchk'>Summary of QAQC flags in SWMP data</h2><span id='topic+qaqcchk'></span><span id='topic+qaqcchk.swmpr'></span>

<h3>Description</h3>

<p>Summary of the number of observations with a given QAQC flag for each parameter column of a swmpr object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qaqcchk(swmpr_in)

## S3 method for class 'swmpr'
qaqcchk(swmpr_in)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qaqcchk_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Viewing the number of observations for each parameter that are assigned to a QAQC flag may be useful for deciding how to process the data qith qaqc. The <code>qaqcchk</code> function can be used to view this information. Consult the online documentation for a description of each QAQC flag: <a href="https://cdmo.baruch.sc.edu/data/qaqc.cfm">https://cdmo.baruch.sc.edu/data/qaqc.cfm</a>
</p>


<h3>Value</h3>

<p>Returns a <code><a href="base.html#topic+data.frame">data.frame</a></code> with columns for swmpr parameters and row counts indicating the number of observations in each parameter assigned to a flag value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qaqc">qaqc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apadbwq)
dat &lt;- apadbwq

## view the number observations in each QAQC flag
qaqcchk(dat)

</code></pre>

<hr>
<h2 id='rem_reps'>Remove replicates in nutrient data</h2><span id='topic+rem_reps'></span><span id='topic+rem_reps.swmpr'></span>

<h3>Description</h3>

<p>Remove replicates in SWMP nutrient data to keep approximate monthly time step
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rem_reps(swmpr_in, ...)

## S3 method for class 'swmpr'
rem_reps(swmpr_in, FUN = function(x) mean(x, na.rm = TRUE), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rem_reps_+3A_swmpr_in">swmpr_in</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="rem_reps_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
<tr><td><code id="rem_reps_+3A_fun">FUN</code></td>
<td>
<p>function to combine values, defaults to mean</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Raw nutrient data obtained from the CDMO will usually include replicate samples that are taken within a few minutes of each other.  This function combines nutrient data that occur on the same day.  The <code>datetimestamp</code> column will always be averaged for replicates, but the actual observations will be combined based on the user-supplied function which defauls to the mean.  Other suggested functions include the <code><a href="stats.html#topic+median">median</a></code>, <code><a href="base.html#topic+min">min</a></code>, or <code><a href="base.html#topic+max">max</a></code>.  The entire function call including treatment of <code>NA</code> values should be passed to the <code>FUN</code> argument (see the examples).  The function is meant to be used after <code><a href="#topic+qaqc">qaqc</a></code> processing, although it works with a warning if QAQC columns are present.
</p>


<h3>Value</h3>

<p>Returns a swmpr object for nutrient data with no replicates.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qaqc">qaqc</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get nutrient data
data(apacpnut)
swmp1 &lt;- apacpnut

# remove replicate nutrient data
rem_reps(swmp1)

# use different function to aggregate replicates
func &lt;- function(x) max(x, na.rm = TRUE)
rem_reps(swmp1, FUN = func)
</code></pre>

<hr>
<h2 id='setstep'>Format a swmpr time vector</h2><span id='topic+setstep'></span><span id='topic+setstep.swmpr'></span><span id='topic+setstep.default'></span>

<h3>Description</h3>

<p>Create a continuous time vector at set time step for a swmpr object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setstep(dat_in, ...)

## S3 method for class 'swmpr'
setstep(dat_in, timestep = 15, differ = NULL, ...)

## Default S3 method:
setstep(dat_in, date_col, timestep = 15, differ = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="setstep_+3A_dat_in">dat_in</code></td>
<td>
<p>input data object</p>
</td></tr>
<tr><td><code id="setstep_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="setstep_+3A_timestep">timestep</code></td>
<td>
<p>numeric value of time step to use in minutes.  Alternatively, a chr string indicating <code>'years'</code>, <code>'quarters'</code>, <code>'months'</code>, <code>'days'</code>, or <code>'hours'</code> can also be used. A character input assumes 365 days in a year and 31 days in a month.</p>
</td></tr>
<tr><td><code id="setstep_+3A_differ">differ</code></td>
<td>
<p>numeric value defining buffer for merging time stamps to standardized time series, defaults to one half of the timestep</p>
</td></tr>
<tr><td><code id="setstep_+3A_date_col">date_col</code></td>
<td>
<p>chr string for the name of the date/time column, e.g., <code>"POSIXct"</code> or <code>"POSIXlt"</code> objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The setstep function formats a swmpr object to a continuous time series at a given time step. This function is not necessary for most stations but can be useful for combining data or converting an existing time series to a set interval.  The first argument of the function, <code>timestep</code>, specifies the desired time step in minutes starting from the nearest hour of the first observation. The second argument, <code>differ</code>, specifies the allowable tolerance in minutes for matching existing observations to user-defined time steps in cases where the two are dissimilar. Values for <code>differ</code> that are greater than one half the value of timestep are not allowed to prevent duplication of existing data. Likewise, the default value for differ is one half the time step. Rows that do not match any existing data within the limits of the differ argument are not discarded. Output from the function can be used with <code>subset</code> and to create a time series at a set interval with empty data removed.
</p>


<h3>Value</h3>

<p>Returns a data object for the specified time step
</p>


<h3>See Also</h3>

<p><code><a href="#topic+comb">comb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## import data
data(apaebmet)
dat &lt;- apaebmet

## convert time series to two hour invervals
## tolerance of +/- 30 minutes for matching existing data
setstep(dat, timestep = 120, differ = 30)

## convert a nutrient time series to a continuous time series
## then remove empty rows and columns
data(apacpnut)
dat_nut &lt;- apacpnut
dat_nut &lt;- setstep(dat_nut, timestep = 60)
subset(dat_nut, rem_rows = TRUE, rem_cols = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='single_param'>Get CDMO records for a single parameter</h2><span id='topic+single_param'></span>

<h3>Description</h3>

<p>Get stations records from the CDMO for a single parameter starting with the most current date
</p>


<h3>Usage</h3>

<pre><code class='language-R'>single_param(station_code, param, Max = 100, trace = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="single_param_+3A_station_code">station_code</code></td>
<td>
<p>chr string of station, 7 or 8 characters</p>
</td></tr>
<tr><td><code id="single_param_+3A_param">param</code></td>
<td>
<p>chr string for a single parameter to return.</p>
</td></tr>
<tr><td><code id="single_param_+3A_max">Max</code></td>
<td>
<p>numeric value for number of records to obtain from the current date</p>
</td></tr>
<tr><td><code id="single_param_+3A_trace">trace</code></td>
<td>
<p>logical indicating if import progress is printed in console</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function retrieves data from the CDMO through the web services URL. The computer making the request must have a registered IP address.  Visit the CDMO web services page for more information: <a href="https://cdmo.baruch.sc.edu/webservices.cfm">https://cdmo.baruch.sc.edu/webservices.cfm</a>.  This function is the CDMO equivalent of <code>exportSingleParamXML</code>.
</p>


<h3>Value</h3>

<p>Returns a swmpr object with one parameter.  QAQC columns are not provided.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+all_params">all_params</a></code>, <code><a href="#topic+all_params_dtrng">all_params_dtrng</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 

## single parameter for a station, most recent
single_param('hudscwq', 'do_mgl')


## End(Not run)
</code></pre>

<hr>
<h2 id='site_codes'>Obtain metadata for all stations</h2><span id='topic+site_codes'></span>

<h3>Description</h3>

<p>Obtain a <code><a href="base.html#topic+data.frame">data.frame</a></code> of metadata for all SWMP stations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>site_codes()
</code></pre>


<h3>Details</h3>

<p>This function retrieves data from the CDMO web services.  The computer making the request must have a registered IP address.  Visit the CDMO web services page for more information: <a href="https://cdmo.baruch.sc.edu/webservices.cfm">https://cdmo.baruch.sc.edu/webservices.cfm</a>. This is the CDMO equivalent of <code>exportStationCodesXML</code>.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> of SWMP metadata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## retrieve metadata for all sites
site_codes()


## End(Not run)
</code></pre>

<hr>
<h2 id='site_codes_ind'>Obtain metadata for a single reserve</h2><span id='topic+site_codes_ind'></span>

<h3>Description</h3>

<p>Get metadata for all the stations at a single SWMP reserve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>site_codes_ind(nerr_site_id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="site_codes_ind_+3A_nerr_site_id">nerr_site_id</code></td>
<td>
<p>chr string of site, three letters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function retrieves data from the CDMO web services.  The computer making the request must have a registered IP address.  Visit the CDMO web services page for more information: <a href="https://cdmo.baruch.sc.edu/webservices.cfm">https://cdmo.baruch.sc.edu/webservices.cfm</a>. This function is the CDMO equivalent of <code>NERRFilterStationCodesXMLNew</code>.
</p>


<h3>Value</h3>

<p>An abbreviated <code>data.frame</code> of the SWMP metadata for the requested site
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

## retrieve metadata for all stations at a site
site_codes_ind('apa')


## End(Not run)
</code></pre>

<hr>
<h2 id='smoother'>Smooth swmpr data</h2><span id='topic+smoother'></span><span id='topic+smoother.default'></span><span id='topic+smoother.swmpr'></span>

<h3>Description</h3>

<p>Smooth swmpr data with a moving window average
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoother(x, ...)

## Default S3 method:
smoother(x, window = 5, sides = 2, ...)

## S3 method for class 'swmpr'
smoother(x, params = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoother_+3A_x">x</code></td>
<td>
<p>input object</p>
</td></tr>
<tr><td><code id="smoother_+3A_...">...</code></td>
<td>
<p>arguments passed to or from other methods</p>
</td></tr>
<tr><td><code id="smoother_+3A_window">window</code></td>
<td>
<p>numeric vector defining size of the smoothing window, passed to <code>filter</code></p>
</td></tr>
<tr><td><code id="smoother_+3A_sides">sides</code></td>
<td>
<p>numeric vector defining method of averaging, passed to <code>filter</code></p>
</td></tr>
<tr><td><code id="smoother_+3A_params">params</code></td>
<td>
<p>is chr string of swmpr parameters to smooth, default all</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>smoother</code> function can be used to smooth parameters in a swmpr object using a specified window size. This method is a simple wrapper to <code><a href="stats.html#topic+filter">filter</a></code>. The window argument specifies the number of observations included in the moving average. The sides argument specifies how the average is calculated for each observation (see the documentation for <code><a href="stats.html#topic+filter">filter</a></code>). A value of 1 will filter observations within the window that are previous to the current observation, whereas a value of 2 will filter all observations within the window centered at zero lag from the current observation. The params argument specifies which parameters to smooth.
</p>


<h3>Value</h3>

<p>Returns a filtered swmpr object. QAQC columns are removed if included with input object.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+filter">filter</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## import data
data(apadbwq)
swmp1 &lt;- apadbwq

## qaqc and subset imported data
dat &lt;- qaqc(swmp1)
dat &lt;- subset(dat, subset = c('2012-07-09 00:00', '2012-07-24 00:00'))

## filter
test &lt;- smoother(dat, window = 50, params = 'do_mgl')

## plot to see the difference
plot(do_mgl ~ datetimestamp, data = dat, type = 'l')
lines(test, select = 'do_mgl', col = 'red', lwd = 2)
</code></pre>

<hr>
<h2 id='stat_locs'>Locations of NERRS sites</h2><span id='topic+stat_locs'></span>

<h3>Description</h3>

<p>Location of NERRS sites in decimal degrees and time offset from Greenwich mean time.  Only active sites are included.  Sites are identified by five letters indexing the reserve and site names.  The dataset is used to plot locations with the <code><a href="#topic+map_reserve">map_reserve</a></code> function and to identify metabolic days with the <code><a href="#topic+ecometab">ecometab</a></code> function.  Created from sampling_locations.csv provided by CDMO.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_locs
</code></pre>


<h3>Format</h3>

<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> object with 161 rows and 4 variables:
</p>

<dl>
<dt><code>station_code</code></dt><dd><p>chr</p>
</dd>
<dt><code>latitude</code></dt><dd><p>numeric</p>
</dd>
<dt><code>longitude</code></dt><dd><p>numeric</p>
</dd>
<dt><code>gmt_off</code></dt><dd><p>int</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+ecometab">ecometab</a></code>, <code><a href="#topic+map_reserve">map_reserve</a></code>
</p>

<hr>
<h2 id='subset.swmpr'>Subset a swmpr object</h2><span id='topic+subset.swmpr'></span>

<h3>Description</h3>

<p>Subset a swmpr object by a date range, parameters, or non-empty values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'swmpr'
subset(
  x,
  subset = NULL,
  select = NULL,
  operator = NULL,
  rem_rows = FALSE,
  rem_cols = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="subset.swmpr_+3A_x">x</code></td>
<td>
<p>input swmpr object</p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_subset">subset</code></td>
<td>
<p>chr string of form 'YYYY-mm-dd HH:MM' to subset a date range.  Input can be one (requires <code>operator</code> or two values (a range).</p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_select">select</code></td>
<td>
<p>chr string of parameters to keep, <code>'datetimestamp'</code> will always be kept</p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_operator">operator</code></td>
<td>
<p>chr string specifiying binary operator (e.g., <code>'&gt;'</code>, <code>'&lt;='</code>) if subset is one date value</p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_rem_rows">rem_rows</code></td>
<td>
<p>logical indicating if rows with no data are removed, default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_rem_cols">rem_cols</code></td>
<td>
<p>is logical indicating if cols with no data are removed, default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="subset.swmpr_+3A_...">...</code></td>
<td>
<p>arguments passed to other methods</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is used to subset swmpr data by date and/or a selected parameter. The date can be a single value or as two dates to select records within the range. The former case requires a binary operator input as a character string passed to the argument, such as <code>&gt;</code> or <code>&lt;</code>. The subset argument for the date(s) must also be a character string of the format YYYY-mm-dd HH:MM for each element (i.e., <code>%Y-%m-%d %H:%M</code> in POSIX standards). Be aware that an error may be returned using this function if the subset argument is in the correct format but the calendar date does not exist, e.g. <code>'2012-11-31 12:00'</code>.  The function can also be used to remove rows and columns that do not contain data, which may be useful after processing with other functions.
</p>


<h3>Value</h3>

<p>Returns a swmpr object as a subset of the input.  The original object will be returned if no arguments are specified.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+subset">subset</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## get data
data(apaebmet)
dat &lt;- apaebmet

## subset records greater than or equal to a date
subset(dat, subset = '2013-01-01 0:00', operator = '&gt;=')

## subset records within a date range, select two parameters
subset(dat, subset = c('2012-07-01 6:00', '2012-08-01 18:15'),
   select = c('atemp', 'totsorad'))
</code></pre>

<hr>
<h2 id='swmpr'>Create a swmpr object</h2><span id='topic+swmpr'></span>

<h3>Description</h3>

<p>Wrapper for creating a swmpr object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>swmpr(stat_in, meta_in)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="swmpr_+3A_stat_in">stat_in</code></td>
<td>
<p><code>data.frame</code> of swmp data</p>
</td></tr>
<tr><td><code id="swmpr_+3A_meta_in">meta_in</code></td>
<td>
<p>chr string for station code (7 or 8 characters), can be multiple stations if data are combined</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a simple wrapper to <code><a href="base.html#topic+structure">structure</a></code> that is used internally within other functions to create a swmpr object.  The function does not have to be used explicitly.  Attributes of a swmpr object include <code>names</code>, <code>row.names</code>, <code>class</code>, <code>station</code>, <code>parameters</code>, <code>qaqc_cols</code>, <code>cens_cols</code>, <code>date_rng</code>, <code>timezone</code>, <code>stamp_class</code>, <code>metabolism</code> (if present), and <code>metab_units</code> (if present).
</p>


<h3>Value</h3>

<p>Returns a swmpr object to be used with S3 methods
</p>

<hr>
<h2 id='time_vec'>Format SWMP datetimestamp</h2><span id='topic+time_vec'></span>

<h3>Description</h3>

<p>Format the datetimestamp column of SWMP data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>time_vec(chr_in = NULL, station_code, tz_only = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="time_vec_+3A_chr_in">chr_in</code></td>
<td>
<p>chr string of datetimestamp vector</p>
</td></tr>
<tr><td><code id="time_vec_+3A_station_code">station_code</code></td>
<td>
<p>is chr string for station (three or more characters)</p>
</td></tr>
<tr><td><code id="time_vec_+3A_tz_only">tz_only</code></td>
<td>
<p>logical that returns only the timezone, default <code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function formats the datetimestamp column of SWMP data to the <code><a href="base.html#topic+POSIXct">POSIXct</a></code> format and the correct timezone for a station.  Note that SWMP data do not include daylight savings and the appropriate location based on GMT offsets is used for formatting.  This function is used internally within data retrieval functions and does not need to be called explicitly.
</p>


<h3>Value</h3>

<p>Returns a POSIX vector if <code>tz_only</code> is true, otherwise the timezone for a station is returned as a chr string
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
