<!DOCTYPE html><html><head><title>Help for package iAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {iAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agn'><p>Active Galactic Nuclei</p></a></li>
<li><a href='#BIARfit'><p>Fitted Values of BIAR model</p></a></li>
<li><a href='#BIARforecast'><p>Forecast from BIAR model</p></a></li>
<li><a href='#BIARinterpolation'><p>Interpolation from BIAR model</p></a></li>
<li><a href='#BIARkalman'><p>Maximum Likelihood Estimation of the BIAR Model via Kalman Recursions</p></a></li>
<li><a href='#BIARphikalman'><p>Minus Log Likelihood of the BIAR Model</p></a></li>
<li><a href='#BIARsample'><p>Simulate from a BIAR Model</p></a></li>
<li><a href='#CIARfit'><p>Fitted Values of CIAR model</p></a></li>
<li><a href='#CIARforecast'><p>Forecast from CIAR model</p></a></li>
<li><a href='#CIARinterpolation'><p>Interpolation from CIAR model</p></a></li>
<li><a href='#CIARkalman'><p>Maximum Likelihood Estimation of the CIAR Model via Kalman Recursions</p></a></li>
<li><a href='#CIARphikalman'><p>Minus Log Likelihood of the CIAR Model</p></a></li>
<li><a href='#CIARsample'><p>Simulate from a CIAR Model</p></a></li>
<li><a href='#clcep'><p>Classical Cepheid</p></a></li>
<li><a href='#cvnovag'><p>ZTF g-band Cataclysmic Variable/Nova</p></a></li>
<li><a href='#cvnovar'><p>ZTF r-band Cataclysmic Variable/Nova</p></a></li>
<li><a href='#dmcep'><p>Double Mode Cepheid.</p></a></li>
<li><a href='#dscut'><p>Delta Scuti</p></a></li>
<li><a href='#eb'><p>Eclipsing Binaries (Beta Lyrae)</p></a></li>
<li><a href='#foldlc'><p>Plotting folded light curves</p></a></li>
<li><a href='#Forecast_iARModels'><p>Forecast from iAR package model's</p></a></li>
<li><a href='#gentime'><p>Generating Irregularly spaced times</p></a></li>
<li><a href='#harmonicfit'><p>Harmonic Fit to Time Series</p></a></li>
<li><a href='#iAR'><p>iAR: Irregularly Observed Autoregressive Models</p></a></li>
<li><a href='#IARfit'><p>Fitted Values of IAR model</p></a></li>
<li><a href='#IARforecast'><p>Forecast from IAR model</p></a></li>
<li><a href='#IARgamma'><p>Maximum Likelihood Estimation of the IAR-Gamma model</p></a></li>
<li><a href='#IARgfit'><p>Fitted Values of IAR-Gamma model</p></a></li>
<li><a href='#IARgforecast'><p>Forecast from IAR-Gamma model</p></a></li>
<li><a href='#IARginterpolation'><p>Interpolation from IAR-Gamma model</p></a></li>
<li><a href='#IARgsample'><p>Simulate from an IAR-Gamma Model</p></a></li>
<li><a href='#IARinterpolation'><p>Interpolation from IAR model</p></a></li>
<li><a href='#IARkalman'><p>Maximum Likelihood Estimation of the IAR Model via Kalman Recursions</p></a></li>
<li><a href='#IARloglik'><p>Maximum Likelihood Estimation of the IAR Model</p></a></li>
<li><a href='#IARPermutation'><p>Test for the significance of the autocorrelation estimated by the iAR package models</p></a></li>
<li><a href='#IARphigamma'><p>Minus Log Likelihood IAR-Gamma Model</p></a></li>
<li><a href='#IARphikalman'><p>Minus Log Likelihood of the IAR Model estimated via Kalman Recursions</p></a></li>
<li><a href='#IARphiloglik'><p>Minus Log Likelihood of the IAR Model</p></a></li>
<li><a href='#IARphit'><p>Minus Log Likelihood IAR-T Model</p></a></li>
<li><a href='#IARsample'><p>Simulate from an IAR Model</p></a></li>
<li><a href='#IARt'><p>Maximum Likelihood Estimation of the IAR-T model</p></a></li>
<li><a href='#IARTest'><p>Test for the significance of the autocorrelation estimated by the iAR package models in periodic irregularly observed time series</p></a></li>
<li><a href='#IARtinterpolation'><p>Interpolation from IAR-T model</p></a></li>
<li><a href='#IARtsample'><p>Simulate from an IAR-T Model</p></a></li>
<li><a href='#pairingits'><p>Pairing two irregularly observed time series</p></a></li>
<li><a href='#Planets'><p>Transit of an extrasolar planet</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Irregularly Observed Autoregressive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Elorrieta Felipe &lt;felipe.elorrieta@usach.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Data sets, functions and scripts with examples to implement autoregressive models for irregularly observed time series. The models available in this package are the irregular autoregressive model (Eyheramendy et al.(2018) &lt;<a href="https://doi.org/10.1093%2Fmnras%2Fsty2487">doi:10.1093/mnras/sty2487</a>&gt;), the complex irregular autoregressive model (Elorrieta et al.(2019) &lt;<a href="https://doi.org/10.1051%2F0004-6361%2F201935560">doi:10.1051/0004-6361/201935560</a>&gt;) and the bivariate irregular autoregressive model (Elorrieta et al.(2021) &lt;<a href="https://doi.org/10.1093%2Fmnras%2Fstab1216">doi:10.1093/mnras/stab1216</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7),ggplot2,stats, Rdpack</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>arfima</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/felipeelorrieta">https://github.com/felipeelorrieta</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp,RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-24 18:16:12 UTC; felo</td>
</tr>
<tr>
<td>Author:</td>
<td>Elorrieta Felipe [aut, cre],
  Ojeda Cesar [aut],
  Eyheramendy Susana [aut],
  Palma Wilfredo [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-24 23:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='agn'>Active Galactic Nuclei</h2><span id='topic+agn'></span>

<h3>Description</h3>

<p>Time series of the AGN MCG-6-30-15 measured in the K-band between 2006 August and 2011 July with the ANDICAM camera mounted on the 1.3 m telescope at Cerro Tololo Inter-American Observatory (CTIO)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agn
</code></pre>


<h3>Format</h3>

<p>A data frame with 237 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2450000</p>
</dd>
<dt>m</dt><dd><p>Flux $(10^(-15) ergs/s/cm^2 /A)$</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lira P, Ar√©valo P, Uttley P, McHardy IMM, Videla L (2015).
&ldquo;Long-term monitoring of the archetype Seyfert galaxy MCG-6-30-15: X-ray, optical and near-IR variability of the corona, disc and torus.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>454</b>(1), 368&ndash;379.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stv1945">10.1093/mnras/stv1945</a>, <a href="https://doi.org/10.1093/mnras/stv1945">https://doi.org/10.1093/mnras/stv1945</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agn)
plot(agn$t,agn$m,type="l",ylab="",xlab="")
</code></pre>

<hr>
<h2 id='BIARfit'>Fitted Values of BIAR model</h2><span id='topic+BIARfit'></span>

<h3>Description</h3>

<p>Fit a BIAR model to a bivariate irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARfit(phiValues, y1, y2, t, yerr1, yerr2, zeroMean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARfit_+3A_phivalues">phiValues</code></td>
<td>
<p>An array with the parameters of the BIAR model. The elements of the array are, in order, the autocorrelation and the cross correlation parameter of the BIAR model.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_y1">y1</code></td>
<td>
<p>Array with the observations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_y2">y2</code></td>
<td>
<p>Array with the observations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_yerr1">yerr1</code></td>
<td>
<p>Array with the measurements error standard deviations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_yerr2">yerr2</code></td>
<td>
<p>Array with the measurements error standard deviations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARfit_+3A_zeromean">zeroMean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>rho Estimated value of the contemporary correlation coefficient.
</p>
</li>
<li><p>innov.var Estimated value of the innovation variance.
</p>
</li>
<li><p>fitted Fitted values of the BIAR model.
</p>
</li>
<li><p>fitted.state Fitted state values of the BIAR model.
</p>
</li>
<li><p>Lambda Lambda value estimated by the BIAR model at the last time point.
</p>
</li>
<li><p>Theta Theta array estimated by the BIAR model at the last time point.
</p>
</li>
<li><p>Sighat Covariance matrix estimated by the BIAR model at the last time point.
</p>
</li>
<li><p>Qt Covariance matrix of the state equation estimated by the BIAR model at the last time point.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+BIARsample">BIARsample</a></code>, <code><a href="#topic+BIARphikalman">BIARphikalman</a></code>, <code><a href="#topic+BIARkalman">BIARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=80
set.seed(6714)
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0.3,st=st,rho=0.9)
y=x$y
y1=y/apply(y,1,sd)
yerr1=rep(0,n)
yerr2=rep(0,n)
biar=BIARkalman(y1=y1[1,],y2=y1[2,],t=st,delta1 = yerr1,delta2=yerr2)
biar
predbiar=BIARfit(phiValues=c(biar$phiR,biar$phiI),y1=y1[1,],y2=y1[2,],t=st,yerr1
 = rep(0,length(y[1,])),yerr2=rep(0,length(y[1,])))
rho=predbiar$rho
print(rho)
yhat=predbiar$fitted

</code></pre>

<hr>
<h2 id='BIARforecast'>Forecast from BIAR model</h2><span id='topic+BIARforecast'></span>

<h3>Description</h3>

<p>Forecast from models fitted by <code><a href="#topic+BIARkalman">BIARkalman</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARforecast(phiR, phiI, y1, y2, t, tAhead)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARforecast_+3A_phir">phiR</code></td>
<td>
<p>Autocorrelation coefficient of BIAR model.</p>
</td></tr>
<tr><td><code id="BIARforecast_+3A_phii">phiI</code></td>
<td>
<p>Cross-correlation coefficient of BIAR model.</p>
</td></tr>
<tr><td><code id="BIARforecast_+3A_y1">y1</code></td>
<td>
<p>Array with the observations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARforecast_+3A_y2">y2</code></td>
<td>
<p>Array with the observations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARforecast_+3A_t">t</code></td>
<td>
<p>Array with the observational times.</p>
</td></tr>
<tr><td><code id="BIARforecast_+3A_tahead">tAhead</code></td>
<td>
<p>The time ahead for which the forecast is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Fitted values by the BIAR model.
</p>
</li>
<li><p>forecast Point forecast in the time ahead required.
</p>
</li>
<li><p>Lambda Lambda value estimated by the BIAR model at the last time point.
</p>
</li>
<li><p>Sighat Covariance matrix estimated by the BIAR model at the last time point.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+BIARsample">BIARsample</a></code>, <code><a href="#topic+BIARkalman">BIARkalman</a></code>, <code><a href="#topic+BIARfit">BIARfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulated Data
n=100
set.seed(6714)
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0.3,st=st)
biar=iAR::BIARkalman(y1=x$y[1,],y2=x$y[2,],t=st)
forBIAR&lt;-BIARforecast(phiR=biar$phiR,phiI=biar$phiI,y1=x$y[1,],y2=x$y[2,],t=st,tAhead=c(1.3))
</code></pre>

<hr>
<h2 id='BIARinterpolation'>Interpolation from BIAR model</h2><span id='topic+BIARinterpolation'></span>

<h3>Description</h3>

<p>Interpolation of missing values from models fitted by <code><a href="#topic+BIARkalman">BIARkalman</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARinterpolation(
  x,
  y1,
  y2,
  t,
  delta1 = 0,
  delta2 = 0,
  yini1 = 0,
  yini2 = 0,
  zero.mean = TRUE,
  niter = 10,
  seed = 1234,
  nsmooth = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARinterpolation_+3A_x">x</code></td>
<td>
<p>An array with the parameters of the BIAR model. The elements of the array are, in order, the real (phiR) and the imaginary (phiI) part of the coefficient of BIAR model.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_y1">y1</code></td>
<td>
<p>Array with the observations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_y2">y2</code></td>
<td>
<p>Array with the observations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_delta1">delta1</code></td>
<td>
<p>Array with the measurements error standard deviations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_delta2">delta2</code></td>
<td>
<p>Array with the measurements error standard deviations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_yini1">yini1</code></td>
<td>
<p>a single value, initial value of the estimation of the missing value of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_yini2">yini2</code></td>
<td>
<p>a single value, initial value of the estimation of the missing value of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_niter">niter</code></td>
<td>
<p>Number of iterations in which the function nlminb will be repeated.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as the seed of the random process.</p>
</td></tr>
<tr><td><code id="BIARinterpolation_+3A_nsmooth">nsmooth</code></td>
<td>
<p>a single value; If 1, only one time series of the BIAR process has a missing value. If 2, both time series of the BIAR process have a missing value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Estimation of the missing values of the BIAR process.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in the fitted missing values.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+BIARsample">BIARsample</a></code>, <code><a href="#topic+BIARphikalman">BIARphikalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(6713)
n=100
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0.3,st=st,rho=0.9)
y=x$y
y1=y/apply(y,1,sd)
yerr1=rep(0,n)
yerr2=rep(0,n)
biar=BIARkalman(y1=y1[1,],y2=y1[2,],t=st,delta1 = yerr1,delta2=yerr2)
biar
napos=10
y0=y1
y1[1,napos]=NA
xest=c(biar$phiR,biar$phiI)
yest=BIARinterpolation(xest,y1=y1[1,],y2=y1[2,],t=st,delta1=yerr1,
delta2=yerr2,nsmooth=1)
yest$fitted
mse=(y0[1,napos]-yest$fitted)^2
print(mse)
par(mfrow=c(2,1))
plot(st,x$y[1,],type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,x$y[1,],pch=20)
points(st[napos],yest$fitted*apply(y,1,sd)[1],col="red",pch=20)
plot(st,x$y[2,],type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,x$y[2,],pch=20)

</code></pre>

<hr>
<h2 id='BIARkalman'>Maximum Likelihood Estimation of the BIAR Model via Kalman Recursions</h2><span id='topic+BIARkalman'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the BIAR model parameters phiR and phiI. The estimation procedure uses the Kalman Filter to find the maximum of the likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARkalman(
  y1,
  y2,
  t,
  delta1 = 0,
  delta2 = 0,
  zero.mean = "TRUE",
  niter = 10,
  seed = 1234
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARkalman_+3A_y1">y1</code></td>
<td>
<p>Array with the observations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_y2">y2</code></td>
<td>
<p>Array with the observations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_delta1">delta1</code></td>
<td>
<p>Array with the measurements error standard deviations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_delta2">delta2</code></td>
<td>
<p>Array with the measurements error standard deviations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if true, the array y has zero mean; if false, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_niter">niter</code></td>
<td>
<p>Number of iterations in which the function nlminb will be repeated.</p>
</td></tr>
<tr><td><code id="BIARkalman_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as the seed of the random process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phiR MLE of the autocorrelation coefficient of BIAR model (phiR).
</p>
</li>
<li><p>phiI MLE of the cross-correlation coefficient of the BIAR model (phiI).
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phiR and phiI.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+BIARsample">BIARsample</a></code>, <code><a href="#topic+BIARphikalman">BIARphikalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
n=80
set.seed(6714)
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0,st=st,rho=0)
y=x$y
y1=y/apply(y,1,sd)
biar=BIARkalman(y1=y1[1,],y2=y1[2,],t=st,delta1 = rep(0,length(y[1,])),
delta2=rep(0,length(y[1,])))
biar

</code></pre>

<hr>
<h2 id='BIARphikalman'>Minus Log Likelihood of the BIAR Model</h2><span id='topic+BIARphikalman'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the BIAR process given specific values of phiR and phiI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARphikalman(yest, phiValues, y1, y2, t, yerr1, yerr2, zeroMean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARphikalman_+3A_yest">yest</code></td>
<td>
<p>An array with the estimate of a missing value in one or both time series of the bivariate process. This function recognizes a missing value with a NA. If the bivariate time series does not have a missing value, this value does not affect the computation of the likelihood.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_phivalues">phiValues</code></td>
<td>
<p>An array with the parameters of the BIAR model. The elements of the array are, in order, the real (phiR) and the imaginary (phiI) part of the coefficient of BIAR model.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_y1">y1</code></td>
<td>
<p>Array with the observations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_y2">y2</code></td>
<td>
<p>Array with the observations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_yerr1">yerr1</code></td>
<td>
<p>Array with the measurements error standard deviations of the first time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_yerr2">yerr2</code></td>
<td>
<p>Array with the measurements error standard deviations of the second time series of the BIAR process.</p>
</td></tr>
<tr><td><code id="BIARphikalman_+3A_zeromean">zeroMean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phiR and phiI.
</p>


<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+BIARsample">BIARsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0.3,st=st)
y=x$y
y1=y[1,]
y2=y[2,]
yerr1=rep(0,n)
yerr2=rep(0,n)
BIARphikalman(phiValues=c(0.8,0.2),y1=y1,y2=y2,t=st,yerr1=yerr1,yerr2=yerr2,yest=c(0,0))
</code></pre>

<hr>
<h2 id='BIARsample'>Simulate from a BIAR Model</h2><span id='topic+BIARsample'></span>

<h3>Description</h3>

<p>Simulates a BIAR Time Series Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BIARsample(n, st, phiR, phiI, delta1 = 0, delta2 = 0, rho = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BIARsample_+3A_n">n</code></td>
<td>
<p>Length of the output bivariate time series. A strictly positive integer.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_st">st</code></td>
<td>
<p>Array with observational times.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_phir">phiR</code></td>
<td>
<p>Autocorrelation coefficient of BIAR model. A value between -1 and 1.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_phii">phiI</code></td>
<td>
<p>Crosscorrelation coefficient of BIAR model. A value between -1 and 1.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_delta1">delta1</code></td>
<td>
<p>Array with the measurements error standard deviations of the first time series of the bivariate process.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_delta2">delta2</code></td>
<td>
<p>Array with the measurements error standard deviations of the second time series of the bivariate process.</p>
</td></tr>
<tr><td><code id="BIARsample_+3A_rho">rho</code></td>
<td>
<p>Contemporary correlation coefficient of BIAR model. A value between -1 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The chosen phiR and phiI values must satisfy the condition $|phiR + i phiI| &lt; 1$.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>y Matrix with the simulated BIAR process.
</p>
</li>
<li><p>t Array with observation times.
</p>
</li>
<li><p>Sigma Covariance matrix of the process.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
x=BIARsample(n=n,phiR=0.9,phiI=0.3,st=st)
plot(st,x$y[1,],type='l')
plot(st,x$y[2,],type='l')
x=BIARsample(n=n,phiR=-0.9,phiI=-0.3,st=st)
plot(st,x$y[1,],type='l')
plot(st,x$y[2,],type='l')
</code></pre>

<hr>
<h2 id='CIARfit'>Fitted Values of CIAR model</h2><span id='topic+CIARfit'></span>

<h3>Description</h3>

<p>Fit a CIAR model to an irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARfit(phiValues, y, t, standardized = TRUE, c = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARfit_+3A_phivalues">phiValues</code></td>
<td>
<p>An array with the parameters of the CIAR model. The elements of the array are, in order, the real and the imaginary part of the phi parameter of the CIAR model.</p>
</td></tr>
<tr><td><code id="CIARfit_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CIARfit_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="CIARfit_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series</p>
</td></tr>
<tr><td><code id="CIARfit_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>yhat Fitted values of the observable part of CIAR model.
</p>
</li>
<li><p>xhat Fitted values of both observable part and imaginary part of CIAR model.
</p>
</li>
<li><p>Lambda Lambda value estimated by the CIAR model at the last time point.
</p>
</li>
<li><p>Theta Theta array estimated by the CIAR model at the last time point.
</p>
</li>
<li><p>Sighat Covariance matrix estimated by the CIAR model at the last time point.
</p>
</li>
<li><p>Qt Covariance matrix of the state equation estimated by the CIAR model at the last time point.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+CIARsample">CIARsample</a></code>, <code><a href="#topic+CIARphikalman">CIARphikalman</a></code>,<code><a href="#topic+CIARkalman">CIARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
y=x$y
y1=y/sd(y)
ciar=CIARkalman(y=y1,t=st)
ciar
yhat=CIARfit(phiValues=c(ciar$phiR,ciar$phiI),y=y1,t=st)
</code></pre>

<hr>
<h2 id='CIARforecast'>Forecast from CIAR model</h2><span id='topic+CIARforecast'></span>

<h3>Description</h3>

<p>Forecast from models fitted by <code><a href="#topic+CIARkalman">CIARkalman</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARforecast(phiR, phiI, y1, st, tAhead)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARforecast_+3A_phir">phiR</code></td>
<td>
<p>Real part of the phi coefficient of CIAR model.</p>
</td></tr>
<tr><td><code id="CIARforecast_+3A_phii">phiI</code></td>
<td>
<p>Imaginary part of the phi coefficient of CIAR model.</p>
</td></tr>
<tr><td><code id="CIARforecast_+3A_y1">y1</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CIARforecast_+3A_st">st</code></td>
<td>
<p>Array with the observational times.</p>
</td></tr>
<tr><td><code id="CIARforecast_+3A_tahead">tAhead</code></td>
<td>
<p>The time ahead for which the forecast is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Fitted values by the CIAR model.
</p>
</li>
<li><p>forecast Point forecast in the time ahead required.
</p>
</li>
<li><p>Lambda Lambda value estimated by the CIAR model at the last time point.
</p>
</li>
<li><p>Sighat Covariance matrix estimated by the CIAR model at the last time point.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+CIARsample">CIARsample</a></code>, <code><a href="#topic+CIARkalman">CIARkalman</a></code>, <code><a href="#topic+CIARfit">CIARfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Simulated Data
n=100
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
y=x$y
y1=y/sd(y)
n=length(y1)
p=trunc(n*0.99)
ytr=y1[1:p]
yte=y1[(p+1):n]
str=st[1:p]
ste=st[(p+1):n]
tahead=ste-str[p]

ciar=CIARkalman(y=ytr,t=str)
forCIAR&lt;-CIARforecast(ciar$phiR,ciar$phiI,ytr,str,tAhead=tahead)
</code></pre>

<hr>
<h2 id='CIARinterpolation'>Interpolation from CIAR model</h2><span id='topic+CIARinterpolation'></span>

<h3>Description</h3>

<p>Interpolation of missing values from models fitted by <code><a href="#topic+CIARkalman">CIARkalman</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARinterpolation(
  x,
  y,
  t,
  delta = 0,
  yini = 0,
  zero.mean = TRUE,
  standardized = TRUE,
  c = 1,
  seed = 1234
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARinterpolation_+3A_x">x</code></td>
<td>
<p>An array with the parameters of the CIAR model. The elements of the array are, in order, the real (phiR) and the imaginary (phiI) part of the coefficient of CIAR model.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_delta">delta</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_yini">yini</code></td>
<td>
<p>a single value, initial value for the estimation of the missing value of the time series.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
<tr><td><code id="CIARinterpolation_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as the seed of the random process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Estimation of a missing value of the CIAR process.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in the fitted missing values.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+CIARsample">CIARsample</a></code>, <code><a href="#topic+CIARkalman">CIARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
y=x$y
y1=y/sd(y)
ciar=CIARkalman(y=y1,t=st)
ciar
napos=10
y0=y1
y1[napos]=NA
xest=c(ciar$phiR,ciar$phiI)
yest=CIARinterpolation(xest,y=y1,t=st)
yest$fitted
mse=(y0[napos]-yest$fitted)^2
print(mse)
plot(st,y,type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,y,pch=20)
points(st[napos],yest$fitted*sd(y),col="red",pch=20)
</code></pre>

<hr>
<h2 id='CIARkalman'>Maximum Likelihood Estimation of the CIAR Model via Kalman Recursions</h2><span id='topic+CIARkalman'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the CIAR model parameters phiR and phiI. The estimation procedure uses the Kalman Filter to find the maximum of the likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARkalman(
  y,
  t,
  delta = 0,
  zero.mean = TRUE,
  standardized = TRUE,
  c = 1,
  niter = 10,
  seed = 1234
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARkalman_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_delta">delta</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_niter">niter</code></td>
<td>
<p>Number of iterations in which the function nlminb will be repeated.</p>
</td></tr>
<tr><td><code id="CIARkalman_+3A_seed">seed</code></td>
<td>
<p>a single value, interpreted as the seed of the random process.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phiR MLE of the Real part of the coefficient of CIAR model (phiR).
</p>
</li>
<li><p>phiI MLE of the Imaginary part of the coefficient of the CIAR model (phiI).
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phiR and phiI.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+CIARsample">CIARsample</a></code>, <code><a href="#topic+CIARphikalman">CIARphikalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
y=x$y
y1=y/sd(y)
ciar=CIARkalman(y=y1,t=st)
ciar
Mod(complex(real=ciar$phiR,imaginary=ciar$phiI))
</code></pre>

<hr>
<h2 id='CIARphikalman'>Minus Log Likelihood of the CIAR Model</h2><span id='topic+CIARphikalman'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the CIAR process given specific values of phiR and phiI
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARphikalman(yest, x, y, t, yerr, zeroMean = TRUE, standardized = TRUE, c = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARphikalman_+3A_yest">yest</code></td>
<td>
<p>The estimate of a missing value in the time series. This function recognizes a missing value with a NA. If the time series does not have a missing value, this value does not affect the computation of the likelihood.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_x">x</code></td>
<td>
<p>An array with the parameters of the CIAR model. The elements of the array are, in order, the real (phiR) and the imaginary (phiI) part of the coefficient of CIAR model.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_t">t</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_yerr">yerr</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_zeromean">zeroMean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
<tr><td><code id="CIARphikalman_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phiR and phiI.
</p>


<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+CIARsample">CIARsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
y=x$y
yerr=rep(0,n)
CIARphikalman(x=c(0.8,0),y=y,t=st,yerr=yerr,yest=0)
</code></pre>

<hr>
<h2 id='CIARsample'>Simulate from a CIAR Model</h2><span id='topic+CIARsample'></span>

<h3>Description</h3>

<p>Simulates a CIAR Time Series Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIARsample(n, phiR, phiI, st, rho = 0L, c = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIARsample_+3A_n">n</code></td>
<td>
<p>Length of the output time series. A strictly positive integer.</p>
</td></tr>
<tr><td><code id="CIARsample_+3A_phir">phiR</code></td>
<td>
<p>Real part of the coefficient of CIAR model. A value between -1 and 1.</p>
</td></tr>
<tr><td><code id="CIARsample_+3A_phii">phiI</code></td>
<td>
<p>Imaginary part of the coefficient of CIAR model. A value between -1 and 1.</p>
</td></tr>
<tr><td><code id="CIARsample_+3A_st">st</code></td>
<td>
<p>Array with observational times.</p>
</td></tr>
<tr><td><code id="CIARsample_+3A_rho">rho</code></td>
<td>
<p>Correlation between the real and the imaginary part of the process. A value between -1 and 1.</p>
</td></tr>
<tr><td><code id="CIARsample_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The chosen phiR and phiI values must satisfy the condition $|phiR + i phiI| &lt; 1$.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>yArray with the simulated real part of the CIAR process.
</p>
</li>
<li><p>t Array with observation times.
</p>
</li>
<li><p>Sigma Covariance matrix of the process.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
doi: <a href="https://doi.org/10.1051/0004-6361/201935560">10.1051/0004-6361/201935560</a>, <a href="https://doi.org/10.1051/0004-6361/201935560">https://doi.org/10.1051/0004-6361/201935560</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
x=CIARsample(n=n,phiR=0.9,phiI=0,st=st,c=1)
plot(st,x$y,type='l')
x=CIARsample(n=n,phiR=-0.9,phiI=0,st=st,c=1)
plot(st,x$y,type='l')
</code></pre>

<hr>
<h2 id='clcep'>Classical Cepheid</h2><span id='topic+clcep'></span>

<h3>Description</h3>

<p>Time series of a classical cepheid variable star obtained from HIPPARCOS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clcep
</code></pre>


<h3>Format</h3>

<p>A data frame with 109 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 0.060033386.
Catalogs and designations of this star:
HD 1989: HD 305996
TYCHO-2 2000:TYC 8958-2333-1
USNO-A2.0:USNO-A2 0225-10347916
HIP: HIP-54101
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
foldlc(clcep,f1)
</code></pre>

<hr>
<h2 id='cvnovag'>ZTF g-band Cataclysmic Variable/Nova</h2><span id='topic+cvnovag'></span>

<h3>Description</h3>

<p>Time series of a cataclysmic variable/nova object observed in the g-band of the ZTF survey and processed by the ALeRCE broker.ZTF Object code: ZTF18aayzpbr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvnovag
</code></pre>


<h3>Format</h3>

<p>A data frame with 67 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2400000</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>F√∂rster F, Cabrera-Vives G, Castillo-Navarrete E, Est√©vez PA, S√°nchez-S√°ez P, Arredondo J, Bauer FE, Carrasco-Davis R, Catelan M, Elorrieta F, Eyheramendy S, Huijse P, Pignata G, Reyes E, Reyes I, Rodr√≠guez-Mancini D, Ruz-Mieres D, Valenzuela C, √Ålvarez-Maldonado I, Astorga N, Borissova J, Clocchiatti A, Cicco DD, Donoso-Oliva C, Hern√°ndez-Garc√≠a L, Graham MJ, Jord√°n A, Kurtev R, Mahabal A, Maureira JC, Mu√±oz-Arancibia A, Molina-Ferreiro R, Moya A, Palma W, P√©rez-Carrasco M, Protopapas P, Romero M, Sabatini-Gacitua L, S√°nchez A, Mart√≠n JS, Sep√∫lveda-Cobo C, Vera E, Vergara JR (2021).
&ldquo;The Automatic Learning for the Rapid Classification of Events (ALeRCE) Alert Broker.&rdquo;
<em>The Astronomical Journal</em>, <b>161</b>(5), 242.
doi: <a href="https://doi.org/10.3847/1538-3881/abe9bc">10.3847/1538-3881/abe9bc</a>, <a href="https://doi.org/10.3847/1538-3881/abe9bc">https://doi.org/10.3847/1538-3881/abe9bc</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovag)
plot(cvnovag$t,cvnovag$m,type="l",ylab="",xlab="",col="green")
</code></pre>

<hr>
<h2 id='cvnovar'>ZTF r-band Cataclysmic Variable/Nova</h2><span id='topic+cvnovar'></span>

<h3>Description</h3>

<p>Time series of a cataclysmic variable/nova object observed in the r-band of the ZTF survey and processed by the ALeRCE broker.ZTF Object code: ZTF18aayzpbr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvnovar
</code></pre>


<h3>Format</h3>

<p>A data frame with 65 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2400000</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>F√∂rster F, Cabrera-Vives G, Castillo-Navarrete E, Est√©vez PA, S√°nchez-S√°ez P, Arredondo J, Bauer FE, Carrasco-Davis R, Catelan M, Elorrieta F, Eyheramendy S, Huijse P, Pignata G, Reyes E, Reyes I, Rodr√≠guez-Mancini D, Ruz-Mieres D, Valenzuela C, √Ålvarez-Maldonado I, Astorga N, Borissova J, Clocchiatti A, Cicco DD, Donoso-Oliva C, Hern√°ndez-Garc√≠a L, Graham MJ, Jord√°n A, Kurtev R, Mahabal A, Maureira JC, Mu√±oz-Arancibia A, Molina-Ferreiro R, Moya A, Palma W, P√©rez-Carrasco M, Protopapas P, Romero M, Sabatini-Gacitua L, S√°nchez A, Mart√≠n JS, Sep√∫lveda-Cobo C, Vera E, Vergara JR (2021).
&ldquo;The Automatic Learning for the Rapid Classification of Events (ALeRCE) Alert Broker.&rdquo;
<em>The Astronomical Journal</em>, <b>161</b>(5), 242.
doi: <a href="https://doi.org/10.3847/1538-3881/abe9bc">10.3847/1538-3881/abe9bc</a>, <a href="https://doi.org/10.3847/1538-3881/abe9bc">https://doi.org/10.3847/1538-3881/abe9bc</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovar)
plot(cvnovar$t,cvnovar$m,type="l",ylab="",xlab="",col="red")
</code></pre>

<hr>
<h2 id='dmcep'>Double Mode Cepheid.</h2><span id='topic+dmcep'></span>

<h3>Description</h3>

<p>Time series of a double mode cepheid variable star obtained from OGLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmcep
</code></pre>


<h3>Format</h3>

<p>A data frame with 191 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dominant frequency computed by GLS for this light curve is 0.7410152.
The second frequency computed by GLS for this light curve is 0.5433353.
OGLE-ID:175210
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmcep)
f1=0.7410152
foldlc(dmcep,f1)
fit=harmonicfit(dmcep,f1)
f2=0.5433353
foldlc(cbind(dmcep$t,fit$res,dmcep$merr),f2)
</code></pre>

<hr>
<h2 id='dscut'>Delta Scuti</h2><span id='topic+dscut'></span>

<h3>Description</h3>

<p>Time series of a Delta Scuti variable star obtained from HIPPARCOS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dscut
</code></pre>


<h3>Format</h3>

<p>A data frame with 116 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 14.88558646.
Catalogs and designations of this star:
HD 1989: HD 199757
TYCHO-2 2000: TYC 7973-401-1
USNO-A2.0: USNO-A2 0450-39390397
HIP: HIP 103684
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dscut)
f1=14.88558646
foldlc(dscut,f1)
</code></pre>

<hr>
<h2 id='eb'>Eclipsing Binaries (Beta Lyrae)</h2><span id='topic+eb'></span>

<h3>Description</h3>

<p>Time series of a Beta Lyrae variable star obtained from OGLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eb
</code></pre>


<h3>Format</h3>

<p>A data frame with 470 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 1.510571586.
Catalogs and designations of this star:OGLE051951.22-694002.7
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eb)
f1=1.510571586
foldlc(eb,f1)
</code></pre>

<hr>
<h2 id='foldlc'>Plotting folded light curves</h2><span id='topic+foldlc'></span>

<h3>Description</h3>

<p>This function plots a time series folded on its period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foldlc(file, f1, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="foldlc_+3A_file">file</code></td>
<td>
<p>Matrix with the light curve observations. The first column must have the irregular times, the second column must have the brightness magnitudes and the third column must have the measurement errors.</p>
</td></tr>
<tr><td><code id="foldlc_+3A_f1">f1</code></td>
<td>
<p>Frequency (1/Period) of the light curve.</p>
</td></tr>
<tr><td><code id="foldlc_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE, the function returns the plot of folded time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix whose first column has the folded (phased) observational times.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
foldlc(clcep,f1)
</code></pre>

<hr>
<h2 id='Forecast_iARModels'>Forecast from iAR package model's</h2><span id='topic+Forecast_iARModels'></span>

<h3>Description</h3>

<p>Forecast with any of the models available in the iAR package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Forecast_iARModels(
  phi,
  y,
  st,
  tAhead,
  model = "iAR",
  mu = NULL,
  phiI = NULL,
  nu = NULL,
  level = 95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Forecast_iARModels_+3A_phi">phi</code></td>
<td>
<p>Autocorrelation coefficient estimated by the method specified.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_st">st</code></td>
<td>
<p>Array with the observational times.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_tahead">tAhead</code></td>
<td>
<p>The time ahead for which the forecast is required.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_model">model</code></td>
<td>
<p>model to be used for the forecast. The default is to use the iAR model. Other models available are &quot;iAR-T&quot;, &quot;iAR-Gamma&quot;, &quot;CiAR&quot; and &quot;BiAR&quot;.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_mu">mu</code></td>
<td>
<p>Level parameter of the IAR-Gamma process. A positive value.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_phii">phiI</code></td>
<td>
<p>Imaginary parameter of CIAR model or Cross-correlation parameter of BIAR model.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom parameter of iAR-T model.</p>
</td></tr>
<tr><td><code id="Forecast_iARModels_+3A_level">level</code></td>
<td>
<p>significance level for the confidence interval. The default value is 95.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with the following columns:
</p>

<ul>
<li><p>tAhead The time ahead used for the forecast.
</p>
</li>
<li><p>forecast Point forecast in the time ahead required.
</p>
</li>
<li><p>stderror Standard error of the forecast.
</p>
</li>
<li><p>lowerCI Lower limit of the confidence interval.
</p>
</li>
<li><p>upperCI Upper limit of the confidence interval.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARforecast">IARforecast</a></code>, <code><a href="#topic+IARgforecast">IARgforecast</a></code>, <code><a href="#topic+IARforecast">IARforecast</a></code>, <code><a href="#topic+BIARforecast">BIARforecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>st &lt;- gentime(n=200,lambda1=15,lambda2=2)
y  &lt;- IARsample(phi=0.9,n=200,st=st)
model&lt;-IARloglik(y=y$series,st=st)
phi=model$phi
forIAR&lt;-IARforecast(phi=phi,y$series,st=st,tAhead=c(1.3),standardized=FALSE,zero.mean=FALSE)
forIAR
forIAR&lt;-Forecast_iARModels(phi=phi,y=y$series,st=st,tAhead=c(1.3,2.6))
forIAR
</code></pre>

<hr>
<h2 id='gentime'>Generating Irregularly spaced times</h2><span id='topic+gentime'></span>

<h3>Description</h3>

<p>Function to generate irregularly spaced times from a mixture of exponential distributions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gentime(
  n,
  distribution = "expmixture",
  lambda1 = 130,
  lambda2 = 6.5,
  p1 = 0.15,
  p2 = 0.85,
  a = 0,
  b = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gentime_+3A_n">n</code></td>
<td>
<p>A positive integer. Length of observation times.</p>
</td></tr>
<tr><td><code id="gentime_+3A_distribution">distribution</code></td>
<td>
<p>Distribution of the observation times that will be generated. Default value is &quot;expmixture&quot; for a mixture of exponential distributions. Alternative distributions are &quot;uniform&quot;, &quot;exponential&quot; and &quot;gamma&quot;.</p>
</td></tr>
<tr><td><code id="gentime_+3A_lambda1">lambda1</code></td>
<td>
<p>Mean (1/rate) of the exponential distribution or the first exponential distribution in a mixture of exponential distributions.</p>
</td></tr>
<tr><td><code id="gentime_+3A_lambda2">lambda2</code></td>
<td>
<p>Mean (1/rate) of the second exponential distribution in a mixture of exponential distributions.</p>
</td></tr>
<tr><td><code id="gentime_+3A_p1">p1</code></td>
<td>
<p>Weight of the first exponential distribution in a mixture of exponential distributions.</p>
</td></tr>
<tr><td><code id="gentime_+3A_p2">p2</code></td>
<td>
<p>Weight of the second exponential distribution in a mixture of exponential distributions.</p>
</td></tr>
<tr><td><code id="gentime_+3A_a">a</code></td>
<td>
<p>Shape parameter of a gamma distribution or lower limit of the uniform distribution.</p>
</td></tr>
<tr><td><code id="gentime_+3A_b">b</code></td>
<td>
<p>Scale parameter of a gamma distribution or upper limit of the uniform distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Array with irregularly spaced observations times
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+IARsample">IARsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>st&lt;-gentime(n=100)
st&lt;-gentime(n=100,distribution="uniform")
st&lt;-gentime(n=100,distribution="gamma",a=1,b=1)
st&lt;-gentime(n=100,distribution="exponential",lambda1=1)
</code></pre>

<hr>
<h2 id='harmonicfit'>Harmonic Fit to Time Series</h2><span id='topic+harmonicfit'></span>

<h3>Description</h3>

<p>This function fit an k-harmonic function to time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harmonicfit(
  file,
  f1,
  nham = 4,
  weights = NULL,
  print = FALSE,
  remove_trend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="harmonicfit_+3A_file">file</code></td>
<td>
<p>A matrix with two columns. The first column corresponds to the observations times, and the second column corresponds to the measures.</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_f1">f1</code></td>
<td>
<p>Frequency (1/Period) of the time series</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_nham">nham</code></td>
<td>
<p>Number of harmonic components in the model</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_weights">weights</code></td>
<td>
<p>An array with the weights of each observation</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_print">print</code></td>
<td>
<p>logical; if true, the summary of the harmonic fitted model will be printed. The default value is false.</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_remove_trend">remove_trend</code></td>
<td>
<p>logical; if true, the linear trend of time series will be removed before the the harmonic model is fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>res Residuals to the harmonic fit of the time series.
</p>
</li>
<li><p>t Observations times.
</p>
</li>
<li><p>R2 Adjusted R-Squared.
</p>
</li>
<li><p>MSE Mean Squared Error.
</p>
</li>
<li><p>coef Summary of the coefficients estimated by the harmonic model.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
results=harmonicfit(file=clcep[,1:2],f1=f1)
results$R2
results$MSE
results=harmonicfit(file=clcep[,1:2],f1=f1,nham=3)
results$R2
results$MSE
results=harmonicfit(file=clcep[,1:2],f1=f1,weights=clcep[,3])
results$R2
results$MSE
</code></pre>

<hr>
<h2 id='iAR'>iAR: Irregularly Observed Autoregressive Models</h2><span id='topic+iAR'></span>

<h3>Description</h3>

<p>Description: Data sets, functions and scripts with examples to implement autoregressive
models for irregularly observed time series. The models available in this package
are the irregular autoregressive model (Eyheramendy et al.(2018) &lt;doi:10.1093/mnras/sty2487&gt;),
the complex irregular autoregressive model (Elorrieta et al.(2019) &lt;doi:10.1051/0004-6361/201935560&gt;)
and the bivariate irregular autoregressive model (Elorrieta et al.(2021) &lt;doi:10.1093/mnras/stab1216&gt;)
</p>


<h3>BIAR functions</h3>

<p>The foo functions ...
</p>


<h3>CIAR functions</h3>

<p>The foo functions ...
</p>


<h3>IAR functions</h3>

<p>heloo
</p>

<hr>
<h2 id='IARfit'>Fitted Values of IAR model</h2><span id='topic+IARfit'></span>

<h3>Description</h3>

<p>Fit an IAR model to an irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARfit(phi, y, st, standardized = TRUE, zero.mean = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARfit_+3A_phi">phi</code></td>
<td>
<p>Estimated phi parameter by the iAR model.</p>
</td></tr>
<tr><td><code id="IARfit_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARfit_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARfit_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series</p>
</td></tr>
<tr><td><code id="IARfit_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted values of the iAR model
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>, <code><a href="#topic+IARloglik">IARloglik</a></code>, <code><a href="#topic+IARkalman">IARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
phi=IARloglik(y=y,st=st)$phi
fit=IARfit(phi=phi,y=y,st=st)
</code></pre>

<hr>
<h2 id='IARforecast'>Forecast from IAR model</h2><span id='topic+IARforecast'></span>

<h3>Description</h3>

<p>Forecast from models fitted by <code><a href="#topic+IARloglik">IARloglik</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARforecast(phi, y, st, standardized = TRUE, zero.mean = TRUE, tAhead)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARforecast_+3A_phi">phi</code></td>
<td>
<p>Estimated phi parameter by the iAR model.</p>
</td></tr>
<tr><td><code id="IARforecast_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARforecast_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARforecast_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series</p>
</td></tr>
<tr><td><code id="IARforecast_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARforecast_+3A_tahead">tAhead</code></td>
<td>
<p>The time ahead for forecast is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forecasted value from the iAR model
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>, <code><a href="#topic+IARloglik">IARloglik</a></code>, <code><a href="#topic+IARkalman">IARkalman</a></code>, <code><a href="#topic+IARfit">IARfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
n=length(y)
p=trunc(n*0.99)
ytr=y[1:p]
yte=y[(p+1):n]
str=st[1:p]
ste=st[(p+1):n]
tahead=ste-str[p]
phi=IARloglik(y=ytr,st=str)$phi
forIAR=IARforecast(phi=phi,y=ytr,st=str,tAhead=tahead)
</code></pre>

<hr>
<h2 id='IARgamma'>Maximum Likelihood Estimation of the IAR-Gamma model</h2><span id='topic+IARgamma'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the IAR-Gamma model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARgamma(y, st)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARgamma_+3A_y">y</code></td>
<td>
<p>Array with the time series observations</p>
</td></tr>
<tr><td><code id="IARgamma_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the phi parameter of the IAR-Gamma model.
</p>
</li>
<li><p>mu MLE of the mu parameter of the IAR-Gamma model.
</p>
</li>
<li><p>sigma MLE of the sigma parameter of the IAR-Gamma model.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phi, mu and sigma.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARgsample">IARgsample</a></code>, <code><a href="#topic+IARphigamma">IARphigamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
model&lt;-IARgamma(y$y, st=st)
phi=model$phi
muest=model$mu
sigmaest=model$sigma
</code></pre>

<hr>
<h2 id='IARgfit'>Fitted Values of IAR-Gamma model</h2><span id='topic+IARgfit'></span>

<h3>Description</h3>

<p>Fit an IAR-Gamma model to an irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARgfit(phi, mu, y, st)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARgfit_+3A_phi">phi</code></td>
<td>
<p>Estimated phi parameter by the iAR-Gamma model.</p>
</td></tr>
<tr><td><code id="IARgfit_+3A_mu">mu</code></td>
<td>
<p>Estimated mu parameter by the iAR-Gamma model.</p>
</td></tr>
<tr><td><code id="IARgfit_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARgfit_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted values of the iAR-Gamma model
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARgsample">IARgsample</a></code>, <code><a href="#topic+IARgamma">IARgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
model&lt;-IARgamma(y$y, st=st)
phi=model$phi
muest=model$mu
sigmaest=model$sigma
fit=IARgfit(phi=phi,mu=muest,y=y$y,st=st)
</code></pre>

<hr>
<h2 id='IARgforecast'>Forecast from IAR-Gamma model</h2><span id='topic+IARgforecast'></span>

<h3>Description</h3>

<p>Forecast from models fitted by <code><a href="#topic+IARgamma">IARgamma</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARgforecast(phi, mu, y, st, tAhead)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARgforecast_+3A_phi">phi</code></td>
<td>
<p>Estimated phi parameter by the iAR-Gamma model.</p>
</td></tr>
<tr><td><code id="IARgforecast_+3A_mu">mu</code></td>
<td>
<p>Estimated mu parameter by the iAR-Gamma model.</p>
</td></tr>
<tr><td><code id="IARgforecast_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARgforecast_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARgforecast_+3A_tahead">tAhead</code></td>
<td>
<p>The time ahead for forecast is required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Forecasted value from the iAR-Gamma model
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARgsample">IARgsample</a></code>, <code><a href="#topic+IARgamma">IARgamma</a></code>, <code><a href="#topic+IARgfit">IARgfit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
y&lt;-y$y
n=length(y)
p=trunc(n*0.99)
ytr=y[1:p]
yte=y[(p+1):n]
str=st[1:p]
ste=st[(p+1):n]
tahead=ste-str[p]
model&lt;-IARgamma(ytr, st=str)
phi=model$phi
muest=model$mu
sigmaest=model$sigma
fit=IARgforecast(phi=phi,mu=muest,y=ytr,st=str,tAhead=tahead)
</code></pre>

<hr>
<h2 id='IARginterpolation'>Interpolation from IAR-Gamma model</h2><span id='topic+IARginterpolation'></span>

<h3>Description</h3>

<p>Interpolation of missing values from models fitted by <code><a href="#topic+IARgamma">IARgamma</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARginterpolation(x, y, st, yini = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARginterpolation_+3A_x">x</code></td>
<td>
<p>A given array with the parameters of the IAR-Gamma model. The first element of the array corresponding to the phi parameter, the second to the level parameter mu, and the last one to the scale parameter sigma.</p>
</td></tr>
<tr><td><code id="IARginterpolation_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARginterpolation_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARginterpolation_+3A_yini">yini</code></td>
<td>
<p>a single value, initial value for the estimation of the missing value of the time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Estimation of a missing value of the IAR-Gamma process.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in the fitted missing values.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARgsample">IARgsample</a></code>, <code><a href="#topic+IARgamma">IARgamma</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(6714)
n&lt;-100
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
model&lt;-IARgamma(y$y, st=st)
y&lt;-y$y
napos=10
y0=y
y[napos]=NA
xest=c(model$phi,model$mu,model$sigma)
yest=IARginterpolation(x=xest,y=y,st=st)
yest$fitted
mse=(y0[napos]-yest$fitted)^2
print(mse)
plot(st,y,type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,y,pch=20)
points(st[napos],yest$fitted,col="red",pch=20)
</code></pre>

<hr>
<h2 id='IARgsample'>Simulate from an IAR-Gamma Model</h2><span id='topic+IARgsample'></span>

<h3>Description</h3>

<p>Simulates an IAR-Gamma Time Series Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARgsample(phi, st, n = 100L, sigma2 = 1L, mu = 1L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARgsample_+3A_phi">phi</code></td>
<td>
<p>A coefficient of IAR-Gamma model. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="IARgsample_+3A_st">st</code></td>
<td>
<p>Array with observational times.</p>
</td></tr>
<tr><td><code id="IARgsample_+3A_n">n</code></td>
<td>
<p>Length of the output time series. A strictly positive integer.</p>
</td></tr>
<tr><td><code id="IARgsample_+3A_sigma2">sigma2</code></td>
<td>
<p>Scale parameter of the IAR-Gamma process. A positive value.</p>
</td></tr>
<tr><td><code id="IARgsample_+3A_mu">mu</code></td>
<td>
<p>Level parameter of the IAR-Gamma process. A positive value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>y Array with simulated IAR-Gamma process.
</p>
</li>
<li><p>st Array with observation times.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
plot(st,y$y,type='l')
hist(y$y,breaks=20)
</code></pre>

<hr>
<h2 id='IARinterpolation'>Interpolation from IAR model</h2><span id='topic+IARinterpolation'></span>

<h3>Description</h3>

<p>Interpolation of missing values from models fitted by <code><a href="#topic+IARkalman">IARkalman</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARinterpolation(
  x,
  y,
  st,
  delta = 0,
  yini = 0,
  zero.mean = TRUE,
  standardized = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARinterpolation_+3A_x">x</code></td>
<td>
<p>A given phi coefficient of the IAR model.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_delta">delta</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_yini">yini</code></td>
<td>
<p>a single value, initial value for the estimation of the missing value of the time series.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARinterpolation_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Estimation of a missing value of the IAR process.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in the fitted missing values.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>, <code><a href="#topic+IARkalman">IARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
phi=IARkalman(y=y,st=st)$phi
print(phi)
napos=10
y0=y
y[napos]=NA
xest=phi
yest=IARinterpolation(xest,y=y,st=st)
yest$fitted
mse=(y0[napos]-yest$fitted)^2
print(mse)
plot(st,y,type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,y,pch=20)
points(st[napos],yest$fitted,col="red",pch=20)
</code></pre>

<hr>
<h2 id='IARkalman'>Maximum Likelihood Estimation of the IAR Model via Kalman Recursions</h2><span id='topic+IARkalman'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the IAR model parameter phi. The estimation procedure uses the Kalman Filter to find the maximum of the likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARkalman(y, st, delta = 0, zero.mean = TRUE, standardized = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARkalman_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARkalman_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARkalman_+3A_delta">delta</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="IARkalman_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARkalman_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the phi parameter of the IAR model.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phi.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>, <code><a href="stats.html#topic+arima">arima</a></code>,<code><a href="#topic+IARphikalman">IARphikalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
phi=IARkalman(y=y,st=st)$phi
print(phi)
</code></pre>

<hr>
<h2 id='IARloglik'>Maximum Likelihood Estimation of the IAR Model</h2><span id='topic+IARloglik'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the IAR Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARloglik(y, st, delta = 0, zero.mean = TRUE, standardized = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARloglik_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARloglik_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARloglik_+3A_delta">delta</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="IARloglik_+3A_zero.mean">zero.mean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARloglik_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the phi parameter of the IAR model.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phi.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>, <code><a href="stats.html#topic+arima">arima</a></code>, <code><a href="#topic+IARphiloglik">IARphiloglik</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Generating IAR sample
set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
#Compute Phi
phi=IARloglik(y=y,st=st)$phi
print(phi)
#Compute the standard deviation of innovations
n=length(y)
d=c(0,diff(st))
phi1=phi**d
yhat=phi1*as.vector(c(0,y[1:(n-1)]))
plot(st,y,type='l')
lines(st,yhat,col='red')
sigma=var(y)
nu=c(sigma,sigma*(1-phi1**(2))[-1])
tau&lt;-nu/sigma
sigmahat&lt;-mean(c((y-yhat)**2/tau))
nuhat&lt;-sigmahat*(1-phi1**(2))
nuhat2&lt;-sqrt(nuhat)
#Equally spaced models
require(arfima)
fit2&lt;-arfima(y,order=c(1,0,0))
fit&lt;-arima(y,order=c(1,0,0),include.mean=FALSE)
syarf&lt;-tacvfARFIMA(phi=fit2$modes[[1]]$phi,dfrac=fit2$modes[[1]]$dfrac,
sigma2=fit2$modes[[1]]$sigma,maxlag=20)[1]
syar&lt;-fit$sigma/(1-fit$coef[1]**2)
print(sigmahat)
print(syar)
print(syarf)
carf&lt;-fit2$modes[[1]]$sigma/syarf
car&lt;-(1-fit$coef[1]**2)
ciar&lt;-(1-phi1**(2))
#Compute the standard deviation of innovations (regular case)
sigma=var(y)
nuhat3=sqrt(sigma*ciar)
searf&lt;-sqrt(sigma*carf)
sear&lt;-sqrt(sigma*car)
#Plot the standard deviation of innovations
plot(st[-1], nuhat3[-1], t="n", axes=FALSE,xlab='Time',ylab='Standard Deviation of Innovations')
axis(1)
axis(2)
segments(x0=st[-1], y0=nuhat3[-1], y1=0, col=8)
points(st, nuhat3, pch=20, col=1, bg=1)
abline(h=sd(y),col='red',lwd=2)
abline(h=sear,col='blue',lwd=2)
abline(h=searf,col='green',lwd=2)
abline(h=mean(nuhat3[-1]),col='black',lwd=2)
</code></pre>

<hr>
<h2 id='IARPermutation'>Test for the significance of the autocorrelation estimated by the iAR package models</h2><span id='topic+IARPermutation'></span>

<h3>Description</h3>

<p>This function perform a test for the significance of the autocorrelation estimated by the iAR package models. This test is based in to take N disordered samples of the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARPermutation(
  y,
  st,
  merr = 0,
  iter = 100,
  phi,
  model = "iAR",
  plot = TRUE,
  xlim = c(-1, 0),
  nu = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARPermutation_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_merr">merr</code></td>
<td>
<p>Array with the variance of the measurement errors.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_iter">iter</code></td>
<td>
<p>Number of disordered samples of the original data (N).</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_phi">phi</code></td>
<td>
<p>autocorrelation estimated by one of the iAR package models.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_model">model</code></td>
<td>
<p>model used to estimate the autocorrelation parameter (&quot;iAR&quot;, &quot;iAR-Gamma&quot;, &quot;iAR-T&quot;, &quot;CiAR&quot; or &quot;BiAR&quot;).</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_plot">plot</code></td>
<td>
<p>logical; if true, the function return a density plot of the distribution of the bad fitted examples; if false, this function does not return a plot.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_xlim">xlim</code></td>
<td>
<p>The x-axis limits (x1, x2) of the plot. Only works if plot='TRUE'. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for more details.</p>
</td></tr>
<tr><td><code id="IARPermutation_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom parameter of the iAR-T model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis of the test is: The autocorrelation coefficient estimated for the time series belongs to the distribution of the coefficients estimated on the disordered data, which are assumed to be uncorrelated. Therefore, if the hypothesis is accepted, it can be concluded that the observations of the time series are uncorrelated.The statistic of the test is log(phi) which was contrasted with a normal distribution with parameters corresponding to the log of the mean and the variance of the phi computed for the N samples of the disordered data. This test differs for <code><a href="#topic+IARTest">IARTest</a></code> in that to perform this test it is not necessary to know the period of the time series.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the autocorrelation parameter of the model.
</p>
</li>
<li><p>bad MLEs of the autocorrelation parameters of the models that has been fitted to the disordered samples.
</p>
</li>
<li><p>norm Mean and variance of the normal distribution of the disordered data.
</p>
</li>
<li><p>z0 Statistic of the test (log(abs(phi))).
</p>
</li>
<li><p>pvalue P-value computed for the test.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Planets">Planets</a></code>,<code><a href="#topic+IARloglik">IARloglik</a></code>, <code><a href="#topic+IARTest">IARTest</a></code>, <code><a href="#topic+CIARkalman">CIARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Planets)
t&lt;-Planets[,1]
res&lt;-Planets[,2]
y=res/sqrt(var(res))
res3=IARloglik(y,t,standardized=TRUE)[1]
res3$phi
set.seed(6713)
require(ggplot2)
test&lt;-IARPermutation(y=y,st=t,phi=res3$phi,model="iAR",plot=TRUE,xlim=c(-9.6,-9.45))
</code></pre>

<hr>
<h2 id='IARphigamma'>Minus Log Likelihood IAR-Gamma Model</h2><span id='topic+IARphigamma'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the IAR-Gamma given specific values of phi, mu and sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARphigamma(yest, x_input, y, st)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARphigamma_+3A_yest">yest</code></td>
<td>
<p>The estimate of a missing value in the time series. This function recognizes a missing value with a NA. If the time series does not have a missing value, this value does not affect the computation of the likelihood.</p>
</td></tr>
<tr><td><code id="IARphigamma_+3A_x_input">x_input</code></td>
<td>
<p>An array with the parameters of the IAR-Gamma model. The first element of the array corresponding to the phi parameter, the second to the level parameter mu, and the last one to the scale parameter sigma.</p>
</td></tr>
<tr><td><code id="IARphigamma_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARphigamma_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phi, mu and sigma.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARgsample">IARgsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=100
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARgsample(phi=0.9,st=st,n=n,sigma2=1,mu=1)
IARphigamma(x_input=c(0.9,1,1),y=y$y,st=st,yest=0)
</code></pre>

<hr>
<h2 id='IARphikalman'>Minus Log Likelihood of the IAR Model estimated via Kalman Recursions</h2><span id='topic+IARphikalman'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the IAR process given a specific value of phi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARphikalman(yest, x, y, yerr, st, zeroMean = TRUE, standardized = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARphikalman_+3A_yest">yest</code></td>
<td>
<p>The estimate of a missing value in the time series. This function recognizes a missing value with a NA. If the time series does not have a missing value, this value does not affect the computation of the likelihood.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_x">x</code></td>
<td>
<p>A given phi coefficient of the IAR model.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_yerr">yerr</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_zeromean">zeroMean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARphikalman_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y is standardized; if FALSE, y contains the raw time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phi.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
yerr=rep(0,100)
IARphikalman(x=0.8,y=y,yerr=yerr,st=st,yest=0)
</code></pre>

<hr>
<h2 id='IARphiloglik'>Minus Log Likelihood of the IAR Model</h2><span id='topic+IARphiloglik'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the IAR Model for a specific value of phi.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARphiloglik(x, y, st, delta_input, zeroMean = TRUE, standardized = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARphiloglik_+3A_x">x</code></td>
<td>
<p>A given phi coefficient of the IAR model.</p>
</td></tr>
<tr><td><code id="IARphiloglik_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARphiloglik_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARphiloglik_+3A_delta_input">delta_input</code></td>
<td>
<p>Array with the measurements error standard deviations.</p>
</td></tr>
<tr><td><code id="IARphiloglik_+3A_zeromean">zeroMean</code></td>
<td>
<p>logical; if TRUE, the array y has zero mean; if FALSE, y has a mean different from zero.</p>
</td></tr>
<tr><td><code id="IARphiloglik_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array y was standardized; if FALSE, y contains the raw data</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phi.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARsample">IARsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st,n=100)
y&lt;-y$series
IARphiloglik(x=0.8,y=y,st=st,delta_input=c(0))
</code></pre>

<hr>
<h2 id='IARphit'>Minus Log Likelihood IAR-T Model</h2><span id='topic+IARphit'></span>

<h3>Description</h3>

<p>This function return the negative log likelihood of the IAR-T given specific values of phi and sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARphit(yest, x, y, st, nu = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARphit_+3A_yest">yest</code></td>
<td>
<p>The estimate of a missing value in the time series. This function recognizes a missing value with a NA. If the time series does not have a missing value, this value does not affect the computation of the likelihood.</p>
</td></tr>
<tr><td><code id="IARphit_+3A_x">x</code></td>
<td>
<p>An array with the parameters of the IAR-T model. The first element of the array corresponding to the phi parameter and the second element to the scale parameter sigma</p>
</td></tr>
<tr><td><code id="IARphit_+3A_y">y</code></td>
<td>
<p>Array with the time series observations</p>
</td></tr>
<tr><td><code id="IARphit_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times</p>
</td></tr>
<tr><td><code id="IARphit_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of the negative log likelihood evaluated in phi,sigma and nu.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARtsample">IARtsample</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARtsample(n,0.9,st,sigma2=1,nu=3)
IARphit(x=c(0.9,1),y=y$y,st=st,yest=0)
</code></pre>

<hr>
<h2 id='IARsample'>Simulate from an IAR Model</h2><span id='topic+IARsample'></span>

<h3>Description</h3>

<p>Simulates an IAR Time Series Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARsample(phi, st, n = 100L)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARsample_+3A_phi">phi</code></td>
<td>
<p>A coefficient of IAR model. A value between 0 and 1</p>
</td></tr>
<tr><td><code id="IARsample_+3A_st">st</code></td>
<td>
<p>Array with observational times.</p>
</td></tr>
<tr><td><code id="IARsample_+3A_n">n</code></td>
<td>
<p>Length of the output time series. A strictly positive integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>times Array with observation times.
</p>
</li>
<li><p>series Array with simulated IAR data.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(6714)
st&lt;-gentime(n=100)
y&lt;-IARsample(phi=0.99,st=st, n=100)
y&lt;-y$series
plot(st,y,type='l')
</code></pre>

<hr>
<h2 id='IARt'>Maximum Likelihood Estimation of the IAR-T model</h2><span id='topic+IARt'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation of the IAR-T model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARt(y, st, nu = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARt_+3A_y">y</code></td>
<td>
<p>Array with the time series observations</p>
</td></tr>
<tr><td><code id="IARt_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times</p>
</td></tr>
<tr><td><code id="IARt_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the phi parameter of the IAR-T model.
</p>
</li>
<li><p>sigma MLE of the sigma parameter of the IAR-T model.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in phi and sigma.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARtsample">IARtsample</a></code>, <code><a href="#topic+IARphit">IARphit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARtsample(n,0.9,st,sigma2=1,nu=3)
model&lt;-IARt(y$y, st=st)
phi=model$phi
sigmaest=model$sigma
</code></pre>

<hr>
<h2 id='IARTest'>Test for the significance of the autocorrelation estimated by the iAR package models in periodic irregularly observed time series</h2><span id='topic+IARTest'></span>

<h3>Description</h3>

<p>This function perform a test for the significance of the autocorrelation estimated by the iAR package models. This test is based on the residuals of the periodical time series fitted with an harmonic model using an incorrect period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARTest(
  y,
  st,
  merr = 0,
  f,
  phi,
  model = "iAR",
  plot = TRUE,
  xlim = c(-1, 0),
  nu = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARTest_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_merr">merr</code></td>
<td>
<p>Array with the variance of the measurement errors.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_f">f</code></td>
<td>
<p>Frequency (1/Period) of the raw time series.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_phi">phi</code></td>
<td>
<p>autocorrelation estimated by one of the iAR package models.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_model">model</code></td>
<td>
<p>model used to estimate the autocorrelation parameter (&quot;iAR&quot;, &quot;iAR-Gamma&quot;, &quot;iAR-T&quot;, &quot;CiAR&quot; or &quot;BiAR&quot;).</p>
</td></tr>
<tr><td><code id="IARTest_+3A_plot">plot</code></td>
<td>
<p>logical; if true, the function return a density plot of the distribution of the bad fitted examples; if false, this function does not return a plot.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_xlim">xlim</code></td>
<td>
<p>The x-axis limits (x1, x2) of the plot. Only works if plot='TRUE'. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for more details.</p>
</td></tr>
<tr><td><code id="IARTest_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom parameter of the iAR-T model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis of the test is: The autocorrelation estimated in the time series belongs to the distribution of the coefficients estimated for the residuals of the data fitted using wrong periods. Therefore, if the hypothesis is rejected, it can be concluded that the residuals of the harmonic model do not remain a time dependency structure.The statistic of the test is log(phi) which was contrasted with a normal distribution with parameters corresponding to the log of the mean and the variance of the phi computed for the residuals of the bad fitted light curves.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>phi MLE of the autocorrelation parameter of the IAR/CIAR model.
</p>
</li>
<li><p>bad A matrix with two columns. The first column contains the incorrect frequencies used to fit each harmonic model. The second column has the MLEs of the autocorrelation parameters of the IAR/CIAR model that has been fitted to the residuals of the harmonic model fitted using the frequencies of the first column.
</p>
</li>
<li><p>norm Mean and variance of the normal distribution of the bad fitted examples.
</p>
</li>
<li><p>z0 Statistic of the test (log(abs(phi))).
</p>
</li>
<li><p>pvalue P-value computed for the test.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clcep">clcep</a></code>, <code><a href="#topic+harmonicfit">harmonicfit</a></code>, <code><a href="#topic+IARloglik">IARloglik</a></code>, <code><a href="#topic+CIARkalman">CIARkalman</a></code>,<code><a href="#topic+IARPermutation">IARPermutation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
results=harmonicfit(file=clcep,f1=f1)
y=results$res/sqrt(var(results$res))
st=results$t
res3=IARloglik(y,st,standardized=TRUE)[1]
res3$phi
require(ggplot2)
test&lt;-IARTest(y=clcep[,2],st=clcep[,1],f=f1,phi=res3$phi,model="iAR",plot=TRUE,xlim=c(-10,0.5))
test
</code></pre>

<hr>
<h2 id='IARtinterpolation'>Interpolation from IAR-T model</h2><span id='topic+IARtinterpolation'></span>

<h3>Description</h3>

<p>Interpolation of missing values from models fitted by <code><a href="#topic+IARt">IARt</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARtinterpolation(x, y, st, nu = 3, yini = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARtinterpolation_+3A_x">x</code></td>
<td>
<p>A given array with the parameters of the IAR-T model. The first element of the array corresponding to the phi parameter and the second element to the scale parameter sigma</p>
</td></tr>
<tr><td><code id="IARtinterpolation_+3A_y">y</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="IARtinterpolation_+3A_st">st</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="IARtinterpolation_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom</p>
</td></tr>
<tr><td><code id="IARtinterpolation_+3A_yini">yini</code></td>
<td>
<p>a single value, initial value for the estimation of the missing value of the time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>fitted Estimation of a missing value of the IAR-T process.
</p>
</li>
<li><p>ll Value of the negative log likelihood evaluated in the fitted missing values.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>, <code><a href="#topic+IARtsample">IARtsample</a></code>, <code><a href="#topic+IARt">IARt</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(6714)
n&lt;-100
st&lt;-gentime(n)
y&lt;-IARtsample(n,0.9,st,sigma2=1,nu=3)
model&lt;-IARt(y$y, st=st)
napos=10
y0=y$y
y=y$y
y[napos]=NA
xest=c(model$phi,model$sigma)
yest=IARtinterpolation(x=xest,y=y,st=st)
yest$fitted
mse=(y0[napos]-yest$fitted)^2
print(mse)
plot(st,y,type='l',xlim=c(st[napos-5],st[napos+5]))
points(st,y,pch=20)
points(st[napos],yest$fitted,col="red",pch=20)
</code></pre>

<hr>
<h2 id='IARtsample'>Simulate from an IAR-T Model</h2><span id='topic+IARtsample'></span>

<h3>Description</h3>

<p>Simulates an IAR-T Time Series Model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IARtsample(n, phi, st, sigma2 = 1, nu = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IARtsample_+3A_n">n</code></td>
<td>
<p>Length of the output time series. A strictly positive integer.</p>
</td></tr>
<tr><td><code id="IARtsample_+3A_phi">phi</code></td>
<td>
<p>A coefficient of IAR-T model. A value between 0 and 1.</p>
</td></tr>
<tr><td><code id="IARtsample_+3A_st">st</code></td>
<td>
<p>Array with observational times.</p>
</td></tr>
<tr><td><code id="IARtsample_+3A_sigma2">sigma2</code></td>
<td>
<p>Scale parameter of the IAR-T process. A positive value.</p>
</td></tr>
<tr><td><code id="IARtsample_+3A_nu">nu</code></td>
<td>
<p>degrees of freedom.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>y Array with simulated IAR-t process.
</p>
</li>
<li><p>st Array with observation times.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311&ndash;4322.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/sty2487">10.1093/mnras/sty2487</a>, <a href="https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf">https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gentime">gentime</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n=300
set.seed(6714)
st&lt;-gentime(n)
y&lt;-IARtsample(n,0.9,st,sigma2=1,nu=3)
plot(st,y$y,type='l')
hist(y$y,breaks=20)
</code></pre>

<hr>
<h2 id='pairingits'>Pairing two irregularly observed time series</h2><span id='topic+pairingits'></span>

<h3>Description</h3>

<p>Pairing the observational times of two irregularly observed time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairingits(lc1, lc2, tol = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairingits_+3A_lc1">lc1</code></td>
<td>
<p>data frame with three columns corresponding to the first irregularly observed time series. The columns must be ordered as follow: First the observational times, second the measures of each time, and third the measurement errors.</p>
</td></tr>
<tr><td><code id="pairingits_+3A_lc2">lc2</code></td>
<td>
<p>data frame with three columns corresponding to the second irregularly observed time series. The columns must be ordered as follow: First the observational times, second the measures of each time, and third the measurement errors.</p>
</td></tr>
<tr><td><code id="pairingits_+3A_tol">tol</code></td>
<td>
<p>tolerance parameter. Minimum time gap to consider that two observations have measured at different times.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>

<ul>
<li><p>n Number of observations paired by their observational times.
</p>
</li>
<li><p>parData Frame with the paired datasets.
</p>
</li></ul>



<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105&ndash;1116.
ISSN 0035-8711, doi: <a href="https://doi.org/10.1093/mnras/stab1216">10.1093/mnras/stab1216</a>, <a href="https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf">https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cvnovag">cvnovag</a></code>, <code><a href="#topic+cvnovar">cvnovar</a></code>, <code><a href="#topic+BIARkalman">BIARkalman</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovag)
data(cvnovar)
pargr=pairingits(cvnovag,cvnovar,tol=0.1)
</code></pre>

<hr>
<h2 id='Planets'>Transit of an extrasolar planet</h2><span id='topic+Planets'></span>

<h3>Description</h3>

<p>Time series corresponding to the residuals of the parametric model fitted by Jordan et al (2013) for a transit of an extrasolar planet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Planets
</code></pre>


<h3>Format</h3>

<p>A data frame with 91 observations on the following 2 variables:
</p>

<dl>
<dt>t</dt><dd><p>Time from mid-transit (hours).</p>
</dd>
<dt>r</dt><dd><p>Residuals of the parametric model fitted by Jordan et al (2013).</p>
</dd>
</dl>



<h3>References</h3>

<p>Jord√°n A, Espinoza N, Rabus M, Eyheramendy S, Sing DK, D√©sert J, Bakos G√Å, Fortney JJ, L√≥pez-Morales M, Maxted PFL, Triaud AHMJ, Szentgyorgyi A (2013).
&ldquo;A Ground-based Optical Transmission Spectrum of WASP-6b.&rdquo;
<em>The Astrophysical Journal</em>, <b>778</b>, 184.
doi: <a href="https://doi.org/10.1088/0004-637X/778/2/184">10.1088/0004-637X/778/2/184</a>, 1310.6048, <a href="https://doi.org/10.1088/0004-637X/778/2/184">https://doi.org/10.1088/0004-637X/778/2/184</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Planets)
plot(Planets[,1],Planets[,2],xlab='Time from mid-transit (hours)',ylab='Noise',pch=20)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
