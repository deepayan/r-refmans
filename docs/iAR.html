<!DOCTYPE html><html lang="en"><head><title>Help for package iAR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {iAR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#agn'><p>Active Galactic Nuclei</p></a></li>
<li><a href='#BiAR'><p>'BiAR' Class</p></a></li>
<li><a href='#CiAR'><p>'CiAR' Class</p></a></li>
<li><a href='#CiARfit'><p>Fitted Values of CiAR model</p></a></li>
<li><a href='#clcep'><p>Classical Cepheid</p></a></li>
<li><a href='#cvnovag'><p>ZTF g-band Cataclysmic Variable/Nova</p></a></li>
<li><a href='#cvnovar'><p>ZTF r-band Cataclysmic Variable/Nova</p></a></li>
<li><a href='#dmcep'><p>Double Mode Cepheid.</p></a></li>
<li><a href='#dscut'><p>Delta Scuti</p></a></li>
<li><a href='#eb'><p>Eclipsing Binaries (Beta Lyrae)</p></a></li>
<li><a href='#fit'><p>Fitted Values for iAR, CiAR, and BiAR Classes</p></a></li>
<li><a href='#foldlc'><p>Plotting folded light curves</p></a></li>
<li><a href='#forecast'><p>Forecast for iAR, CiAR, and BiAR Classes</p></a></li>
<li><a href='#gentime'><p>Generating Irregularly spaced times</p></a></li>
<li><a href='#harmonicfit'><p>Harmonic Fit to Time Series</p></a></li>
<li><a href='#iAR'><p>'iAR' Class</p></a></li>
<li><a href='#iARPermutation'><p>Test for the significance of the autocorrelation estimated by the iAR package models</p></a></li>
<li><a href='#iARTest'><p>Test for the significance of the autocorrelation estimated by the iAR package models in periodic irregularly observed time series</p></a></li>
<li><a href='#interpolation'><p>Interpolation for iAR, CiAR, and BiAR Classes</p></a></li>
<li><a href='#kalman'><p>Maximum Likelihood Estimation of Parameters for iAR, CiAR, and BiAR Models using the Kalman Filter</p></a></li>
<li><a href='#loglik'><p>Maximum Likelihood Estimation for iAR Models</p></a></li>
<li><a href='#multidata'><p>Multidata Class</p></a></li>
<li><a href='#pairingits'><p>Pairing two irregularly observed time series</p></a></li>
<li><a href='#Planets'><p>Transit of an extrasolar planet</p></a></li>
<li><a href='#plot'><p>Plot Method for unidata Objects</p></a></li>
<li><a href='#plot_fit'><p>Plot Fit Method for unidata Objects</p></a></li>
<li><a href='#plot_forecast'><p>Plot Forecast Method for unidata Objects</p></a></li>
<li><a href='#sim'><p>Simulate Time Series for Multiple iAR Models</p></a></li>
<li><a href='#summary'><p>Summary Method for unidata Objects</p></a></li>
<li><a href='#unidata'><p>Unidata Class</p></a></li>
<li><a href='#utilities'><p>Utilities Class</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Irregularly Observed Autoregressive Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-03-10</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Elorrieta Felipe &lt;felipe.elorrieta@usach.cl&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Data sets, functions and scripts with examples to implement autoregressive models for irregularly observed time series. The models available in this package are the irregular autoregressive model (Eyheramendy et al.(2018) &lt;<a href="https://doi.org/10.1093%2Fmnras%2Fsty2487">doi:10.1093/mnras/sty2487</a>&gt;), the complex irregular autoregressive model (Elorrieta et al.(2019) &lt;<a href="https://doi.org/10.1051%2F0004-6361%2F201935560">doi:10.1051/0004-6361/201935560</a>&gt;) and the bivariate irregular autoregressive model (Elorrieta et al.(2021) &lt;<a href="https://doi.org/10.1093%2Fmnras%2Fstab1216">doi:10.1093/mnras/stab1216</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.7),ggplot2,stats, Rdpack, S7, zoo</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>Suggests:</td>
<td>arfima</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/felipeelorrieta">https://github.com/felipeelorrieta</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp,RcppArmadillo</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-03-10 16:33:00 UTC; felocarril</td>
</tr>
<tr>
<td>Author:</td>
<td>Elorrieta Felipe [aut, cre],
  Ojeda Cesar [aut],
  Eyheramendy Susana [aut],
  Palma Wilfredo [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-03-10 16:50:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='agn'>Active Galactic Nuclei</h2><span id='topic+agn'></span>

<h3>Description</h3>

<p>Time series of the AGN MCG-6-30-15 measured in the K-band between 2006 August and 2011 July with the ANDICAM camera mounted on the 1.3 m telescope at Cerro Tololo Inter-American Observatory (CTIO)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>agn
</code></pre>


<h3>Format</h3>

<p>A data frame with 237 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2450000</p>
</dd>
<dt>m</dt><dd><p>Flux $(10^(-15) ergs/s/cm^2 /A)$</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lira P, Ar√©valo P, Uttley P, McHardy IMM, Videla L (2015).
&ldquo;Long-term monitoring of the archetype Seyfert galaxy MCG-6-30-15: X-ray, optical and near-IR variability of the corona, disc and torus.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>454</b>(1), 368-379.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stv1945">doi:10.1093/mnras/stv1945</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(agn)
#plot(agn$t,agn$m,type="l",ylab="",xlab="")
</code></pre>

<hr>
<h2 id='BiAR'>'BiAR' Class</h2><span id='topic+BiAR'></span>

<h3>Description</h3>

<p>Represents a bivariate irregular autoregressive (BiAR) time series model.
This class extends the 'multidata' class and provides additional properties
for modeling, forecasting, and interpolation of bivariate time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BiAR(
  times = integer(0),
  series = integer(0),
  series_esd = integer(0),
  fitted_values = integer(0),
  loglik = integer(0),
  kalmanlik = integer(0),
  coef = integer(0),
  rho = 0,
  tAhead = 1,
  forecast = integer(0),
  interpolated_values = integer(0),
  interpolated_times = integer(0),
  interpolated_series = integer(0),
  zero_mean = TRUE,
  standardized = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="BiAR_+3A_times">times</code></td>
<td>
<p>A numeric vector representing the time points.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_series">series</code></td>
<td>
<p>A numeric matrix or vector representing the values of the time series.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric matrix or vector representing the error standard deviations of the time series.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_fitted_values">fitted_values</code></td>
<td>
<p>A numeric vector containing the fitted values from the model.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_loglik">loglik</code></td>
<td>
<p>A numeric value representing the log-likelihood of the model.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_kalmanlik">kalmanlik</code></td>
<td>
<p>A numeric value representing the Kalman likelihood of the model.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_coef">coef</code></td>
<td>
<p>A numeric vector containing the estimated coefficients of the model.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_rho">rho</code></td>
<td>
<p>A numeric vector containing the estimated coefficients of the model.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_tahead">tAhead</code></td>
<td>
<p>A numeric value specifying the forecast horizon (default: 1).</p>
</td></tr>
<tr><td><code id="BiAR_+3A_forecast">forecast</code></td>
<td>
<p>A numeric vector containing the forecasted values.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_interpolated_values">interpolated_values</code></td>
<td>
<p>A numeric vector containing the interpolated values.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_interpolated_times">interpolated_times</code></td>
<td>
<p>A numeric vector containing the times of the interpolated data points.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_interpolated_series">interpolated_series</code></td>
<td>
<p>A numeric vector containing the interpolated series.</p>
</td></tr>
<tr><td><code id="BiAR_+3A_zero_mean">zero_mean</code></td>
<td>
<p>A logical value indicating if the model assumes a zero-mean process (default: TRUE).</p>
</td></tr>
<tr><td><code id="BiAR_+3A_standardized">standardized</code></td>
<td>
<p>A logical value indicating if the model assumes a standardized process (default: TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'BiAR' class is designed to handle bivariate irregularly observed time series data
using an autoregressive approach. It extends the 'multidata' class to include 
additional properties for modeling bivariate time series.
</p>
<p>Key features of the 'BiAR' class include:
- Support for bivariate time series data.
- Forecasting and interpolation functionalities for irregular time points.
- Assumptions of zero-mean and standardized processes, configurable by the user.
- Estimation of model parameters and likelihoods, including Kalman likelihood.
</p>


<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>o=iAR::utilities()
o&lt;-gentime(o, n=200, distribution = "expmixture", lambda1 = 130, lambda2 = 6.5,p1 = 0.15, p2 = 0.85)
times=o@times
my_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)

# Access properties
my_BiAR@coef

</code></pre>

<hr>
<h2 id='CiAR'>'CiAR' Class</h2><span id='topic+CiAR'></span>

<h3>Description</h3>

<p>Represents a complex irregular autoregressive (CiAR) time series model.
This class extends the 'unidata' class and provides additional properties
for modeling, forecasting, and interpolation of complex-valued time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CiAR(
  times = integer(0),
  series = integer(0),
  series_esd = integer(0),
  fitted_values = integer(0),
  kalmanlik = integer(0),
  coef = integer(0),
  tAhead = 1,
  forecast = integer(0),
  interpolated_values = integer(0),
  interpolated_times = integer(0),
  interpolated_series = integer(0),
  zero_mean = TRUE,
  standardized = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CiAR_+3A_times">times</code></td>
<td>
<p>A numeric vector representing the time points.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_series">series</code></td>
<td>
<p>A complex vector representing the values of the time series.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric vector representing the error standard deviations of the time series.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_fitted_values">fitted_values</code></td>
<td>
<p>A numeric vector containing the fitted values from the model.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_kalmanlik">kalmanlik</code></td>
<td>
<p>A numeric value representing the Kalman likelihood of the model.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_coef">coef</code></td>
<td>
<p>A numeric vector containing the estimated coefficients of the model.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_tahead">tAhead</code></td>
<td>
<p>A numeric value specifying the forecast horizon (default: 1).</p>
</td></tr>
<tr><td><code id="CiAR_+3A_forecast">forecast</code></td>
<td>
<p>A numeric vector containing the forecasted values.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_interpolated_values">interpolated_values</code></td>
<td>
<p>A numeric vector containing the interpolated values.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_interpolated_times">interpolated_times</code></td>
<td>
<p>A numeric vector containing the times of the interpolated data points.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_interpolated_series">interpolated_series</code></td>
<td>
<p>A numeric vector containing the interpolated series.</p>
</td></tr>
<tr><td><code id="CiAR_+3A_zero_mean">zero_mean</code></td>
<td>
<p>A logical value indicating if the model assumes a zero-mean process (default: TRUE).</p>
</td></tr>
<tr><td><code id="CiAR_+3A_standardized">standardized</code></td>
<td>
<p>A logical value indicating if the model assumes a standardized process (default: TRUE).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'CiAR' class is designed to handle irregularly observed, complex-valued
time series data using an autoregressive approach. It extends the 'unidata'
class to include functionalities specific to complex-valued data.
</p>
<p>Key features of the 'CiAR' class include:
- Support for complex-valued time series data.
- Forecasting and interpolation functionalities for irregular time points.
- Assumptions of zero-mean and standardized processes, configurable by the user.
</p>


<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>o=iAR::utilities()
o&lt;-gentime(o, n=200, distribution = "expmixture", lambda1 = 130, lambda2 = 6.5,p1 = 0.15, p2 = 0.85)
times=o@times
my_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))

# Access properties
my_CiAR@coef

</code></pre>

<hr>
<h2 id='CiARfit'>Fitted Values of CiAR model</h2><span id='topic+CiARfit'></span>

<h3>Description</h3>

<p>Fit a CiAR model to an irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CiARfit(coef, series, times, zero_mean = TRUE, standardized = TRUE, c = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CiARfit_+3A_coef">coef</code></td>
<td>
<p>An array with the parameters of the CiAR model. The elements of the array are, in order, the real and the imaginary part of the phi parameter of the CiAR model.</p>
</td></tr>
<tr><td><code id="CiARfit_+3A_series">series</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="CiARfit_+3A_times">times</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="CiARfit_+3A_zero_mean">zero_mean</code></td>
<td>
<p>logical; if TRUE, the array series has zero mean; if FALSE, series has a mean different from zero.</p>
</td></tr>
<tr><td><code id="CiARfit_+3A_standardized">standardized</code></td>
<td>
<p>logical; if TRUE, the array series is standardized; if FALSE, series contains the raw time series</p>
</td></tr>
<tr><td><code id="CiARfit_+3A_c">c</code></td>
<td>
<p>Nuisance parameter corresponding to the variance of the imaginary part.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>fitted</code></td>
<td>
<p> Fitted values of the observable part of CiAR model.</p>
</td></tr>
<tr><td><code>xhat</code></td>
<td>
<p> Fitted values of both observable part and imaginary part of CiAR model.</p>
</td></tr>
<tr><td><code>Lambda</code></td>
<td>
<p> Lambda value estimated by the CiAR model at the last time point.</p>
</td></tr>
<tr><td><code>Theta</code></td>
<td>
<p> Theta array estimated by the CiAR model at the last time point.</p>
</td></tr>
<tr><td><code>Sighat</code></td>
<td>
<p> Covariance matrix estimated by the CiAR model at the last time point.</p>
</td></tr>
<tr><td><code>Qt</code></td>
<td>
<p> Covariance matrix of the state equation estimated by the CiAR model at the last time point.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
</code></pre>

<hr>
<h2 id='clcep'>Classical Cepheid</h2><span id='topic+clcep'></span>

<h3>Description</h3>

<p>Time series of a classical cepheid variable star obtained from HIPPARCOS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clcep
</code></pre>


<h3>Format</h3>

<p>A data frame with 109 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 0.060033386.
Catalogs and designations of this star:
HD 1989: HD 305996
TYCHO-2 2000:TYC 8958-2333-1
USNO-A2.0:USNO-A2 0225-10347916
HIP: HIP-54101
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
foldlc(clcep,f1)
</code></pre>

<hr>
<h2 id='cvnovag'>ZTF g-band Cataclysmic Variable/Nova</h2><span id='topic+cvnovag'></span>

<h3>Description</h3>

<p>Time series of a cataclysmic variable/nova object observed in the g-band of the ZTF survey and processed by the ALeRCE broker.ZTF Object code: ZTF18aayzpbr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvnovag
</code></pre>


<h3>Format</h3>

<p>A data frame with 67 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2400000</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>F√∂rster F, Cabrera-Vives G, Castillo-Navarrete E, Est√©vez PA, S√°nchez-S√°ez P, Arredondo J, Bauer FE, Carrasco-Davis R, Catelan M, Elorrieta F, Eyheramendy S, Huijse P, Pignata G, Reyes E, Reyes I, Rodr√≠guez-Mancini D, Ruz-Mieres D, Valenzuela C, √Ålvarez-Maldonado I, Astorga N, Borissova J, Clocchiatti A, Cicco DD, Donoso-Oliva C, Hern√°ndez-Garc√≠a L, Graham MJ, Jord√°n A, Kurtev R, Mahabal A, Maureira JC, Mu√±oz-Arancibia A, Molina-Ferreiro R, Moya A, Palma W, P√©rez-Carrasco M, Protopapas P, Romero M, Sabatini-Gacitua L, S√°nchez A, Mart√≠n JS, Sep√∫lveda-Cobo C, Vera E, Vergara JR (2021).
&ldquo;The Automatic Learning for the Rapid Classification of Events (ALeRCE) Alert Broker.&rdquo;
<em>The Astronomical Journal</em>, <b>161</b>(5), 242.
<a href="https://doi.org/10.3847/1538-3881/abe9bc">doi:10.3847/1538-3881/abe9bc</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovag)
#plot(cvnovag$t,cvnovag$m,type="l",ylab="",xlab="",col="green")
</code></pre>

<hr>
<h2 id='cvnovar'>ZTF r-band Cataclysmic Variable/Nova</h2><span id='topic+cvnovar'></span>

<h3>Description</h3>

<p>Time series of a cataclysmic variable/nova object observed in the r-band of the ZTF survey and processed by the ALeRCE broker.ZTF Object code: ZTF18aayzpbr
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cvnovar
</code></pre>


<h3>Format</h3>

<p>A data frame with 65 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day - 2400000</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error standard deviations.</p>
</dd>
</dl>



<h3>References</h3>

<p>F√∂rster F, Cabrera-Vives G, Castillo-Navarrete E, Est√©vez PA, S√°nchez-S√°ez P, Arredondo J, Bauer FE, Carrasco-Davis R, Catelan M, Elorrieta F, Eyheramendy S, Huijse P, Pignata G, Reyes E, Reyes I, Rodr√≠guez-Mancini D, Ruz-Mieres D, Valenzuela C, √Ålvarez-Maldonado I, Astorga N, Borissova J, Clocchiatti A, Cicco DD, Donoso-Oliva C, Hern√°ndez-Garc√≠a L, Graham MJ, Jord√°n A, Kurtev R, Mahabal A, Maureira JC, Mu√±oz-Arancibia A, Molina-Ferreiro R, Moya A, Palma W, P√©rez-Carrasco M, Protopapas P, Romero M, Sabatini-Gacitua L, S√°nchez A, Mart√≠n JS, Sep√∫lveda-Cobo C, Vera E, Vergara JR (2021).
&ldquo;The Automatic Learning for the Rapid Classification of Events (ALeRCE) Alert Broker.&rdquo;
<em>The Astronomical Journal</em>, <b>161</b>(5), 242.
<a href="https://doi.org/10.3847/1538-3881/abe9bc">doi:10.3847/1538-3881/abe9bc</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovar)
#plot(cvnovar$t,cvnovar$m,type="l",ylab="",xlab="",col="red")
</code></pre>

<hr>
<h2 id='dmcep'>Double Mode Cepheid.</h2><span id='topic+dmcep'></span>

<h3>Description</h3>

<p>Time series of a double mode cepheid variable star obtained from OGLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmcep
</code></pre>


<h3>Format</h3>

<p>A data frame with 191 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The dominant frequency computed by GLS for this light curve is 0.7410152.
The second frequency computed by GLS for this light curve is 0.5433353.
OGLE-ID:175210
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dmcep)
f1=0.7410152
foldlc(dmcep,f1)
#fit=harmonicfit(dmcep,f1)
#f2=0.5433353
#foldlc(cbind(dmcep$t,fit$res,dmcep$merr),f2)
</code></pre>

<hr>
<h2 id='dscut'>Delta Scuti</h2><span id='topic+dscut'></span>

<h3>Description</h3>

<p>Time series of a Delta Scuti variable star obtained from HIPPARCOS.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dscut
</code></pre>


<h3>Format</h3>

<p>A data frame with 116 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 14.88558646.
Catalogs and designations of this star:
HD 1989: HD 199757
TYCHO-2 2000: TYC 7973-401-1
USNO-A2.0: USNO-A2 0450-39390397
HIP: HIP 103684
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dscut)
f1=14.88558646
foldlc(dscut,f1)
</code></pre>

<hr>
<h2 id='eb'>Eclipsing Binaries (Beta Lyrae)</h2><span id='topic+eb'></span>

<h3>Description</h3>

<p>Time series of a Beta Lyrae variable star obtained from OGLE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eb
</code></pre>


<h3>Format</h3>

<p>A data frame with 470 observations on the following 3 variables:
</p>

<dl>
<dt>t</dt><dd><p>heliocentric Julian Day</p>
</dd>
<dt>m</dt><dd><p>magnitude</p>
</dd>
<dt>merr</dt><dd><p>measurement error of the magnitude (in mag).</p>
</dd>
</dl>



<h3>Details</h3>

<p>The frequency computed by GLS for this light curve is 1.510571586.
Catalogs and designations of this star:OGLE051951.22-694002.7
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eb)
f1=1.510571586
foldlc(eb,f1)
</code></pre>

<hr>
<h2 id='fit'>Fitted Values for iAR, CiAR, and BiAR Classes</h2><span id='topic+fit'></span>

<h3>Description</h3>

<p>Fitted Values for the provided data. This method is implemented for:
1. Irregular Autoregressive models ('iAR')
2. Complex Irregular Autoregressive models ('CiAR')
3. Bivariate Autoregressive models ('BiAR')
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, containing the model specification and parameters:
</p>

<ul>
<li><p> For <code>iAR</code>:
</p>

<ul>
<li> <p><code>family</code>: The distribution family of the iAR model (one of &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;).
</p>
</li>
<li> <p><code>series</code>: A numeric vector representing the time series to be fitted.
</p>
</li>
<li> <p><code>coef</code>: The coefficient(s) of the iAR model.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether to fit a zero-mean model.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model output should be standardized (for &quot;norm&quot; family).
</p>
</li>
<li> <p><code>mean</code>: The mean parameter (only for &quot;gamma&quot; family).
</p>
</li></ul>

</li>
<li><p> For <code>CiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The real and imaginary parts of the CiAR model's coefficients.
</p>
</li>
<li> <p><code>series</code>: A numeric vector representing the time series to be fitted.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether to fit a zero-mean model.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model output should be standardized.
</p>
</li>
<li> <p><code>c</code>: A scaling parameter for the CiAR model.
</p>
</li></ul>

</li>
<li><p> For <code>BiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The coefficients of the BiAR model (real and imaginary parts).
</p>
</li>
<li> <p><code>series</code>: A numeric matrix with two columns representing the bivariate time series to be fitted.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>series_esd</code>: A numeric matrix for the error structure (optional, used internally).
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether to fit a zero-mean model.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="fit_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method fits the specified time series model to the data contained in the object. Depending on the class of the input object:
</p>

<ul>
<li><p> For <code>iAR</code>, the function supports three distribution families:
</p>
</li>
<li><p> &quot;norm&quot; for normal distribution.
</p>
</li>
<li><p> &quot;t&quot; for t-distribution.
</p>
</li>
<li><p> &quot;gamma&quot; for gamma distribution.
</p>
</li>
<li><p> For <code>CiAR</code>, the function uses complex autoregressive processes.
</p>
</li>
<li><p> For <code>BiAR</code>, the function fits a bivariate autoregressive process.
</p>
</li></ul>

<p>All required parameters (e.g., coefficients, time points) must be set before calling this method.
</p>


<h3>Value</h3>

<p>An updated object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, where the <code>fitted_values</code> property contains the fitted time series values.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Fitting a normal iAR model
library(iAR)
n=100
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_norm &lt;- iAR(family = "norm", times = times, coef = 0.9)  
model_norm &lt;- sim(model_norm)
model_norm &lt;- kalman(model_norm) 
model_norm &lt;- fit(model_norm)
plot(model_norm@times, model_norm@series, type = "l", main = "Original Series")
lines(model_norm@times, model_norm@fitted_values, col = "red", lwd = 2)
plot_fit(model_norm)

# Example 2: Fitting a CiAR model
set.seed(6714)
model_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))
model_CiAR &lt;- sim(model_CiAR)
y=model_CiAR@series
y1=y/sd(y)
model_CiAR@series=y1
model_CiAR@series_esd=rep(0,n)
model_CiAR &lt;- kalman(model_CiAR)
print(model_CiAR@coef)
model_CiAR &lt;- fit(model_CiAR)
yhat=model_CiAR@fitted_values

# Example 3: Fitting a BiAR model
n=80
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)
model_BiAR &lt;- sim(model_BiAR)
y=model_BiAR@series
y1=y/apply(y,2,sd)
model_BiAR@series=y1
model_BiAR@series_esd=matrix(0,n,2)
model_BiAR &lt;- kalman(model_BiAR)
print(model_BiAR@coef) 
model_BiAR &lt;- fit(model_BiAR)
print(model_BiAR@rho)
yhat=model_BiAR@fitted_values

</code></pre>

<hr>
<h2 id='foldlc'>Plotting folded light curves</h2><span id='topic+foldlc'></span>

<h3>Description</h3>

<p>This function plots a time series folded on its period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>foldlc(file, f1, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="foldlc_+3A_file">file</code></td>
<td>
<p>Matrix with the light curve observations. The first column must have the irregular times, the second column must have the brightness magnitudes and the third column must have the measurement errors.</p>
</td></tr>
<tr><td><code id="foldlc_+3A_f1">f1</code></td>
<td>
<p>Frequency (1/Period) of the light curve.</p>
</td></tr>
<tr><td><code id="foldlc_+3A_plot">plot</code></td>
<td>
<p>logical; if TRUE, the function returns the plot of folded time series.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix whose first column has the folded (phased) observational times.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
foldlc(clcep,f1)
</code></pre>

<hr>
<h2 id='forecast'>Forecast for iAR, CiAR, and BiAR Classes</h2><span id='topic+forecast'></span>

<h3>Description</h3>

<p>Generates forecasts for the specified time series model. This method is implemented for:
1. Irregular Autoregressive models ('iAR')
2. Complex Irregular Autoregressive models ('CiAR')
3. Bivariate Autoregressive models ('BiAR')
</p>


<h3>Usage</h3>

<pre><code class='language-R'>forecast(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="forecast_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, containing the model specification and parameters:
</p>

<ul>
<li><p> For <code>iAR</code>:
</p>

<ul>
<li> <p><code>family</code>: The distribution family of the iAR model (one of &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;).
</p>
</li>
<li> <p><code>series</code>: A numeric vector representing the time series to forecast.
</p>
</li>
<li> <p><code>coef</code>: The coefficient(s) of the iAR model.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether the model assumes a zero-mean series.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model uses standardized data (only for &quot;norm&quot; family).
</p>
</li>
<li> <p><code>mean</code>: The mean parameter (only for &quot;gamma&quot; family).
</p>
</li>
<li> <p><code>tAhead</code>: Integer, the number of steps ahead to forecast.
</p>
</li></ul>

</li>
<li><p> For <code>CiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The real and imaginary parts of the CiAR model's coefficients.
</p>
</li>
<li> <p><code>series</code>: A numeric vector representing the time series to forecast.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether the model assumes a zero-mean series.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model output should be standardized.
</p>
</li>
<li> <p><code>tAhead</code>: Integer, the number of steps ahead to forecast.
</p>
</li></ul>

</li>
<li><p> For <code>BiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The coefficients of the BiAR model (real and imaginary parts).
</p>
</li>
<li> <p><code>series</code>: A numeric matrix with two columns representing the bivariate time series to forecast.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>tAhead</code>: Integer, the number of steps ahead to forecast.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="forecast_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method generates forecasts for the specified time series model. Depending on the class of the input object:
</p>

<ul>
<li><p> For <code>iAR</code>, the function supports three distribution families:
</p>
</li>
<li><p> &quot;norm&quot; for normal distribution.
</p>
</li>
<li><p> &quot;t&quot; for t-distribution.
</p>
</li>
<li><p> &quot;gamma&quot; for gamma distribution.
</p>
</li>
<li><p> For <code>CiAR</code>, the function uses complex autoregressive processes.
</p>
</li>
<li><p> For <code>BiAR</code>, the function generates forecasts for a bivariate autoregressive process.
</p>
</li></ul>

<p>All required parameters (e.g., coefficients, time points) must be set before calling this method.
</p>


<h3>Value</h3>

<p>An updated object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, where the <code>forecast</code> property contains the forecasted values.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Forecasting with a normal iAR model
library(iAR)
n=100
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_norm &lt;- iAR(family = "norm", times = times, coef = 0.9)  
model_norm &lt;- sim(model_norm)
model_norm &lt;- kalman(model_norm) 
model_norm@tAhead=1.3
model_norm &lt;- forecast(model_norm)
plot(times, model_norm@series, type = "l", main = "Original Series with Forecast")
points(max(times)+ model_norm@tAhead, model_norm@forecast, col = "blue", pch = 16)
plot_forecast(model_norm)

# Example 2: Forecasting with a CiAR model
set.seed(6714)
model_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))
model_CiAR &lt;- sim(model_CiAR)
y=model_CiAR@series
y1=y/sd(y)
model_CiAR@series=y1
model_CiAR@series_esd=rep(0,n)
model_CiAR &lt;- kalman(model_CiAR)
print(model_CiAR@coef)
model_CiAR@tAhead=1.3
model_CiAR &lt;-forecast(model_CiAR)
model_CiAR@forecast

# Example 3: Forecasting with a BiAR model
n=80
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)
model_BiAR &lt;- sim(model_BiAR)
y=model_BiAR@series
y1=y/apply(y,2,sd)
model_BiAR@series=y1
model_BiAR@series_esd=matrix(0,n,2)
model_BiAR &lt;- kalman(model_BiAR)
print(model_BiAR@coef)
model_BiAR@tAhead=1.3
model_BiAR &lt;-forecast(model_BiAR)
model_BiAR@forecast

</code></pre>

<hr>
<h2 id='gentime'>Generating Irregularly spaced times</h2><span id='topic+gentime'></span>

<h3>Description</h3>

<p>A method for generating time points based on a statistical distribution.
The results are stored in the 'times' slot of the 'utilities' object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gentime(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gentime_+3A_x">x</code></td>
<td>
<p>An object of class 'utilities'.</p>
</td></tr>
<tr><td><code id="gentime_+3A_...">...</code></td>
<td>
<p>Additional arguments for generating time points: 
</p>

<dl>
<dt>n</dt><dd><p>A positive integer. Length of observation times.</p>
</dd>
<dt>distribution</dt><dd><p>A character string specifying the distribution of the observation times. Default is '&quot;expmixture&quot;'.
Available options are:
- '&quot;expmixture&quot;': A mixture of two exponential distributions.
- '&quot;uniform&quot;': A uniform distribution.
- '&quot;exponential&quot;': A single exponential distribution.
- '&quot;gamma&quot;': A gamma distribution.</p>
</dd>
<dt>lambda1</dt><dd><p>Mean (1/rate) of the exponential distribution or the first exponential distribution in a mixture of exponential distributions. Default is '130'.</p>
</dd>
<dt>lambda2</dt><dd><p>Mean (1/rate) of the second exponential distribution in a mixture of exponential distributions. Default is '6.5'.</p>
</dd>
<dt>p1</dt><dd><p>Weight of the first exponential distribution in a mixture of exponential distributions. Default is '0.15'.</p>
</dd>
<dt>p2</dt><dd><p>Weight of the second exponential distribution in a mixture of exponential distributions. Default is '0.85'.</p>
</dd>
<dt>a</dt><dd><p>Shape parameter of a gamma distribution or lower limit of the uniform distribution. Default is '0'.</p>
</dd>
<dt>b</dt><dd><p>Scale parameter of a gamma distribution or upper limit of the uniform distribution. Default is '1'.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Value</h3>

<p>An updated 'utilities' object with the generated observation times stored in the 'times' slot.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12917)
o1=iAR::utilities()
o1&lt;-gentime(o1, n=200, distribution = "expmixture", lambda1 = 130, 
lambda2 = 6.5,p1 = 0.15, p2 = 0.85)
st=o1@times
mean(diff(st))

o1=iAR::utilities()
o1&lt;-gentime(o1, n=200, distribution = "expmixture", lambda1 = 15, 
lambda2 = 2.5,p1 = 0.15, p2 = 0.85)
st=o1@times
mean(diff(st))

</code></pre>

<hr>
<h2 id='harmonicfit'>Harmonic Fit to Time Series</h2><span id='topic+harmonicfit'></span>

<h3>Description</h3>

<p>This function fit an k-harmonic function to time series data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>harmonicfit(
  file,
  f1,
  nham = 4,
  weights = NULL,
  print = FALSE,
  remove_trend = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="harmonicfit_+3A_file">file</code></td>
<td>
<p>A matrix with two columns. The first column corresponds to the observations times, and the second column corresponds to the measures.</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_f1">f1</code></td>
<td>
<p>Frequency (1/Period) of the time series</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_nham">nham</code></td>
<td>
<p>Number of harmonic components in the model</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_weights">weights</code></td>
<td>
<p>An array with the weights of each observation</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_print">print</code></td>
<td>
<p>logical; if true, the summary of the harmonic fitted model will be printed. The default value is false.</p>
</td></tr>
<tr><td><code id="harmonicfit_+3A_remove_trend">remove_trend</code></td>
<td>
<p>logical; if true, the linear trend of time series will be removed before the the harmonic model is fitted.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>res</code></td>
<td>
<p> Residuals to the harmonic fit of the time series.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p> Observations times.</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p> Adjusted R-Squared.</p>
</td></tr>
<tr><td><code>MSE</code></td>
<td>
<p> Mean Squared Error.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p> Summary of the coefficients estimated by the harmonic model.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
#results=harmonicfit(file=clcep[,1:2],f1=f1)
#results$R2
#results$MSE
#results=harmonicfit(file=clcep[,1:2],f1=f1,nham=3)
#results$R2
#results$MSE
#results=harmonicfit(file=clcep[,1:2],f1=f1,weights=clcep[,3])
#results$R2
#results$MSE
</code></pre>

<hr>
<h2 id='iAR'>'iAR' Class</h2><span id='topic+iAR'></span>

<h3>Description</h3>

<p>Represents a univariate irregular autoregressive (iAR) time series model. 
This class extends the &quot;unidata&quot; class and includes additional properties 
for modeling, forecasting, and interpolation.
</p>
<p>Description: Data sets, functions and scripts with examples to implement autoregressive
models for irregularly observed time series. The models available in this package
are the irregular autoregressive model (Eyheramendy et al.(2018) &lt;doi:10.1093/mnras/sty2487&gt;),
the complex irregular autoregressive model (Elorrieta et al.(2019) &lt;doi:10.1051/0004-6361/201935560&gt;)
and the bivariate irregular autoregressive model (Elorrieta et al.(2021) &lt;doi:10.1093/mnras/stab1216&gt;)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iAR(
  times = integer(0),
  series = integer(0),
  series_esd = integer(0),
  family = "norm",
  fitted_values = integer(0),
  loglik = integer(0),
  kalmanlik = integer(0),
  coef = integer(0),
  df = integer(0),
  sigma = integer(0),
  mean = integer(0),
  variance = integer(0),
  tAhead = 1,
  forecast = integer(0),
  interpolated_values = integer(0),
  interpolated_times = integer(0),
  interpolated_series = integer(0),
  zero_mean = TRUE,
  standardized = TRUE,
  hessian = FALSE,
  summary = list()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iAR_+3A_times">times</code></td>
<td>
<p>A numeric vector representing the time points.</p>
</td></tr>
<tr><td><code id="iAR_+3A_series">series</code></td>
<td>
<p>A numeric vector representing the values of the time series.</p>
</td></tr>
<tr><td><code id="iAR_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric vector representing the error standard deviations of the time series.</p>
</td></tr>
<tr><td><code id="iAR_+3A_family">family</code></td>
<td>
<p>A character string indicating the distribution family of the model (default: &quot;norm&quot;).</p>
</td></tr>
<tr><td><code id="iAR_+3A_fitted_values">fitted_values</code></td>
<td>
<p>A numeric vector containing the fitted values from the model.</p>
</td></tr>
<tr><td><code id="iAR_+3A_loglik">loglik</code></td>
<td>
<p>A numeric value representing the log-likelihood of the model.</p>
</td></tr>
<tr><td><code id="iAR_+3A_kalmanlik">kalmanlik</code></td>
<td>
<p>A numeric value representing the Kalman likelihood of the model.</p>
</td></tr>
<tr><td><code id="iAR_+3A_coef">coef</code></td>
<td>
<p>A numeric vector containing the estimated coefficients of the model.</p>
</td></tr>
<tr><td><code id="iAR_+3A_df">df</code></td>
<td>
<p>A numeric value representing the degrees of freedom ('t' distribution).</p>
</td></tr>
<tr><td><code id="iAR_+3A_sigma">sigma</code></td>
<td>
<p>A numeric value representing the scale parameter ('t' distribution).</p>
</td></tr>
<tr><td><code id="iAR_+3A_mean">mean</code></td>
<td>
<p>A numeric value representing the estimated mean of the model ('gamma' parameter).</p>
</td></tr>
<tr><td><code id="iAR_+3A_variance">variance</code></td>
<td>
<p>A numeric value representing the estimated variance of the model ('gamma' parameter).</p>
</td></tr>
<tr><td><code id="iAR_+3A_tahead">tAhead</code></td>
<td>
<p>A numeric value specifying the forecast horizon (default: 1).</p>
</td></tr>
<tr><td><code id="iAR_+3A_forecast">forecast</code></td>
<td>
<p>A numeric vector containing the forecasted values.</p>
</td></tr>
<tr><td><code id="iAR_+3A_interpolated_values">interpolated_values</code></td>
<td>
<p>A numeric vector containing the interpolated values.</p>
</td></tr>
<tr><td><code id="iAR_+3A_interpolated_times">interpolated_times</code></td>
<td>
<p>A numeric vector containing the times of the interpolated data points.</p>
</td></tr>
<tr><td><code id="iAR_+3A_interpolated_series">interpolated_series</code></td>
<td>
<p>A numeric vector containing the interpolated series.</p>
</td></tr>
<tr><td><code id="iAR_+3A_zero_mean">zero_mean</code></td>
<td>
<p>A logical value indicating if the model assumes a zero-mean process (default: TRUE).</p>
</td></tr>
<tr><td><code id="iAR_+3A_standardized">standardized</code></td>
<td>
<p>A logical value indicating if the model assumes a standardized process (default: TRUE).</p>
</td></tr>
<tr><td><code id="iAR_+3A_hessian">hessian</code></td>
<td>
<p>A logical value indicating whether the Hessian matrix is computed during estimation (default: FALSE).</p>
</td></tr>
<tr><td><code id="iAR_+3A_summary">summary</code></td>
<td>
<p>A list containing the summary of the model fit, including diagnostics and statistical results.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The 'iAR' class is designed to handle irregularly observed time series data using an 
autoregressive approach. It extends the &quot;unidata&quot; class to include additional 
modeling and diagnostic capabilities. Key functionalities include forecasting, 
interpolation, and model fitting.
</p>
<p>The class also supports advanced modeling features, such as:
- Different distribution families for the data (e.g., Gaussian, 't'-distribution).
- Optional computation of the Hessian matrix for parameter estimation.
- Standardized or zero-mean process assumptions.
</p>


<h3>BIAR functions</h3>

<p>The foo functions ...
</p>


<h3>CIAR functions</h3>

<p>The foo functions ...
</p>


<h3>IAR functions</h3>

<p>heloo
</p>
<p>&quot;_PACKAGE&quot;
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create an `iAR` object
o=iAR::utilities()
o&lt;-gentime(o, n=200, distribution = "expmixture", lambda1 = 130, lambda2 = 6.5,p1 = 0.15, p2 = 0.85)
times=o@times
my_iAR &lt;- iAR(family = "norm", times = times, coef = 0.9,hessian=TRUE)

my_iAR@family
my_iAR@coef

</code></pre>

<hr>
<h2 id='iARPermutation'>Test for the significance of the autocorrelation estimated by the iAR package models</h2><span id='topic+iARPermutation'></span>

<h3>Description</h3>

<p>This function perform a test for the significance of the autocorrelation estimated by the iAR package models. This test is based in to take N disordered samples of the original data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iARPermutation(
  series,
  times,
  series_esd = 0,
  iter = 100,
  coef,
  model = "iAR",
  plot = TRUE,
  xlim = c(-1, 0),
  df = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iARPermutation_+3A_series">series</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_times">times</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_series_esd">series_esd</code></td>
<td>
<p>Array with the variance of the measurement errors.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_iter">iter</code></td>
<td>
<p>Number of disordered samples of the original data (N).</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_coef">coef</code></td>
<td>
<p>autocorrelation estimated by one of the iAR package models.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_model">model</code></td>
<td>
<p>model used to estimate the autocorrelation parameter (&quot;iAR&quot;, &quot;iAR-Gamma&quot;, &quot;iAR-T&quot;, &quot;CiAR&quot; or &quot;BiAR&quot;).</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_plot">plot</code></td>
<td>
<p>logical; if true, the function return a density plot of the distribution of the bad fitted examples; if false, this function does not return a plot.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_xlim">xlim</code></td>
<td>
<p>The x-axis limits (x1, x2) of the plot. Only works if plot='TRUE'. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for more details.</p>
</td></tr>
<tr><td><code id="iARPermutation_+3A_df">df</code></td>
<td>
<p>degrees of freedom parameter of the iAR-T model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis of the test is: The autocorrelation coefficient estimated for the time series belongs to the distribution of the coefficients estimated on the disordered data, which are assumed to be uncorrelated. Therefore, if the hypothesis is accepted, it can be concluded that the observations of the time series are uncorrelated.The statistic of the test is log(phi) which was contrasted with a normal distribution with parameters corresponding to the log of the mean and the variance of the phi computed for the N samples of the disordered data. This test differs for <code><a href="#topic+iARTest">iARTest</a></code> in that to perform this test it is not necessary to know the period of the time series.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>coef</code></td>
<td>
<p> MLE of the autocorrelation parameter of the model.</p>
</td></tr>
<tr><td><code>bad</code></td>
<td>
<p> MLEs of the autocorrelation parameters of the models that has been fitted to the disordered samples.</p>
</td></tr>
<tr><td><code>norm</code></td>
<td>
<p> Mean and variance of the normal distribution of the disordered data.</p>
</td></tr>
<tr><td><code>z0</code></td>
<td>
<p> Statistic of the test (log(abs(phi))).</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p> P-value computed for the test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Planets">Planets</a></code>,<code><a href="#topic+iARTest">iARTest</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Planets)
t&lt;-Planets[,1]
res&lt;-Planets[,2]
y=res/sqrt(var(res))
#res3=iARloglik(y,t,standardized=TRUE)[1]
#res3$coef
#set.seed(6713)
#require(ggplot2)
#test&lt;-iARPermutation(series=y,times=t,coef=res3$coef,model="iAR",plot=TRUE,xlim=c(-9.6,-9.45))
</code></pre>

<hr>
<h2 id='iARTest'>Test for the significance of the autocorrelation estimated by the iAR package models in periodic irregularly observed time series</h2><span id='topic+iARTest'></span>

<h3>Description</h3>

<p>This function perform a test for the significance of the autocorrelation estimated by the iAR package models. This test is based on the residuals of the periodical time series fitted with an harmonic model using an incorrect period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iARTest(
  series,
  times,
  series_esd = 0,
  f,
  coef,
  model = "iAR",
  plot = TRUE,
  xlim = c(-1, 0),
  df = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="iARTest_+3A_series">series</code></td>
<td>
<p>Array with the time series observations.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_times">times</code></td>
<td>
<p>Array with the irregular observational times.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_series_esd">series_esd</code></td>
<td>
<p>Array with the variance of the measurement errors.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_f">f</code></td>
<td>
<p>Frequency (1/Period) of the raw time series.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_coef">coef</code></td>
<td>
<p>autocorrelation estimated by one of the iAR package models.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_model">model</code></td>
<td>
<p>model used to estimate the autocorrelation parameter (&quot;iAR&quot;, &quot;iAR-Gamma&quot;, &quot;iAR-T&quot;, &quot;CiAR&quot; or &quot;BiAR&quot;).</p>
</td></tr>
<tr><td><code id="iARTest_+3A_plot">plot</code></td>
<td>
<p>logical; if true, the function return a density plot of the distribution of the bad fitted examples; if false, this function does not return a plot.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_xlim">xlim</code></td>
<td>
<p>The x-axis limits (x1, x2) of the plot. Only works if plot='TRUE'. See <code><a href="graphics.html#topic+plot.default">plot.default</a></code> for more details.</p>
</td></tr>
<tr><td><code id="iARTest_+3A_df">df</code></td>
<td>
<p>degrees of freedom parameter of the iAR-T model.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The null hypothesis of the test is: The autocorrelation estimated in the time series belongs to the distribution of the coefficients estimated for the residuals of the data fitted using wrong periods. Therefore, if the hypothesis is rejected, it can be concluded that the residuals of the harmonic model do not remain a time dependency structure.The statistic of the test is log(phi) which was contrasted with a normal distribution with parameters corresponding to the log of the mean and the variance of the phi computed for the residuals of the bad fitted light curves.
</p>


<h3>Value</h3>

<p>A list with the following components:
</p>
<table role = "presentation">
<tr><td><code>phi</code></td>
<td>
<p> MLE of the autocorrelation parameter of the iAR/CiAR model.</p>
</td></tr>
<tr><td><code>bad</code></td>
<td>
<p> A matrix with two columns. The first column contains the incorrect frequencies used to fit each harmonic model. The second column has the MLEs of the autocorrelation parameters of the iAR/CiAR model that has been fitted to the residuals of the harmonic model fitted using the frequencies of the first column.</p>
</td></tr>
<tr><td><code>norm</code></td>
<td>
<p> Mean and variance of the normal distribution of the bad fitted examples.</p>
</td></tr>
<tr><td><code>z0</code></td>
<td>
<p> Statistic of the test (log(abs(phi))).</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p> P-value computed for the test.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+clcep">clcep</a></code>, <code><a href="#topic+harmonicfit">harmonicfit</a></code>,<code><a href="#topic+iARPermutation">iARPermutation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(clcep)
f1=0.060033386
#results=harmonicfit(file=clcep,f1=f1)
#y=results$res/sqrt(var(results$res))
#st=results$t
#res3=iARloglik(y,st,standardized=TRUE)[1]
#res3$coef
#require(ggplot2)
#test&lt;-iARTest(series=clcep[,2],times=clcep[,1],f=f1,coef=res3$coef,
#model="iAR",plot=TRUE,xlim=c(-10,0.5))
#test
</code></pre>

<hr>
<h2 id='interpolation'>Interpolation for iAR, CiAR, and BiAR Classes</h2><span id='topic+interpolation'></span>

<h3>Description</h3>

<p>This method performs imputation of missing values in a time series using an autoregressive model.
The imputation is done iteratively for each missing value, utilizing available data and model coefficients.
Depending on the model family, the interpolation is performed differently:
- For <code>norm</code>: A standard autoregressive model for normally distributed data.
- For <code>t</code>: A model for time series with t-distributed errors.
- For <code>gamma</code>: A model for time series with gamma-distributed errors.
- For <code>CiAR</code>: A complex irregular autoregressive model.
- For <code>BiAR</code>: A bivariate autoregressive model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interpolation(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interpolation_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, containing the model specification and parameters:
</p>

<ul>
<li><p> For <code>iAR</code>:
</p>

<ul>
<li> <p><code>family</code>: The distribution family of the iAR model (one of &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;).
</p>
</li>
<li> <p><code>series</code>: A numeric vector representing the time series to interpolate.
</p>
</li>
<li> <p><code>coef</code>: The coefficients of the iAR model.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether the model assumes a zero-mean series.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model uses standardized data (only for &quot;norm&quot; family).
</p>
</li>
<li> <p><code>mean</code>: The mean parameter (only for &quot;gamma&quot; family).
</p>
</li></ul>

</li>
<li><p> For <code>CiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The coefficients of the CiAR model.
</p>
</li>
<li> <p><code>series_esd</code>: The series of error standard deviations for the CiAR model.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether the model assumes a zero-mean series.
</p>
</li>
<li> <p><code>standardized</code>: Logical, whether the model uses standardized data.
</p>
</li>
<li> <p><code>seed</code>: Optional seed for random number generation.
</p>
</li></ul>

</li>
<li><p> For <code>BiAR</code>:
</p>

<ul>
<li> <p><code>coef</code>: The coefficients of the BiAR model.
</p>
</li>
<li> <p><code>series_esd</code>: The series of error standard deviations for the BiAR model.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical, whether the model assumes a zero-mean series.
</p>
</li>
<li> <p><code>yini1</code>: Initial value for the first time series (for BiAR models).
</p>
</li>
<li> <p><code>yini2</code>: Initial value for the second time series (for BiAR models).
</p>
</li>
<li> <p><code>seed</code>: Optional seed for random number generation.
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="interpolation_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Performs interpolation on time series with missing values. This method is implemented for:
1. Irregular Autoregressive models (iAR)
2. Complex Irregular Autoregressive models (CiAR)
3. Bivariate Autoregressive models (BiAR)
</p>
<p>The method handles missing values (NA) in the time series by imputing them iteratively. 
For each missing value, the available data is used to fit the autoregressive model, and the missing value is imputed based on the model's output.
For the <code>CiAR</code> and <code>BiAR</code> models, the error standard deviations and initial values are also considered during imputation.
</p>


<h3>Value</h3>

<p>An object of the same class as <code>x</code> with interpolated time series.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+forecast">forecast</a></code> for forecasting methods for these models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Interpolation for iAR model
library(iAR)
n=100
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_norm &lt;- iAR(family = "norm", times = times, coef = 0.9)  
model_norm &lt;- sim(model_norm)
y=model_norm@series
y1=y/sd(y)
model_norm@series=y1
model_norm@series_esd=rep(0,n)
model_norm &lt;- kalman(model_norm) 
print(model_norm@coef)
napos=10
model_norm@series[napos]=NA
model_norm &lt;- interpolation(model_norm)
interpolation=na.omit(model_norm@interpolated_values)
mse=as.numeric(y1[napos]-interpolation)^2
print(mse)
plot(times,y,type='l',xlim=c(times[napos-5],times[napos+5]))
points(times,y,pch=20)
points(times[napos],interpolation*sd(y),col="red",pch=20)

# Interpolation for CiAR model
model_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))
model_CiAR &lt;- sim(model_CiAR)
y=model_CiAR@series
y1=y/sd(y)
model_CiAR@series=y1
model_CiAR@series_esd=rep(0,n)
model_CiAR &lt;- kalman(model_CiAR)
print(model_CiAR@coef)
napos=10
model_CiAR@series[napos]=NA
model_CiAR &lt;- interpolation(model_CiAR)
interpolation=na.omit(model_CiAR@interpolated_values)
mse=as.numeric(y1[napos]-interpolation)^2
print(mse)
plot(times,y,type='l',xlim=c(times[napos-5],times[napos+5]))
points(times,y,pch=20)
points(times[napos],interpolation*sd(y),col="red",pch=20)
# Interpolation for BiAR model
model_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)
model_BiAR &lt;- sim(model_BiAR)
y=model_BiAR@series
y1=y/apply(y,2,sd)
model_BiAR@series=y1
model_BiAR@series_esd=matrix(0,n,2)
model_BiAR &lt;- kalman(model_BiAR)
print(model_BiAR@coef) 
napos=10
model_BiAR@series[napos,1]=NA
model_BiAR &lt;- interpolation(model_BiAR)
interpolation=na.omit(model_BiAR@interpolated_values[,1])
mse=as.numeric(y1[napos,1]-interpolation)^2
print(mse)
par(mfrow=c(2,1))
plot(times,y[,1],type='l',xlim=c(times[napos-5],times[napos+5]))
points(times,y[,1],pch=20)
points(times[napos],interpolation*apply(y,1,sd)[1],col="red",pch=20)
plot(times,y[,2],type='l',xlim=c(times[napos-5],times[napos+5]))
points(times,y[,2],pch=20)
</code></pre>

<hr>
<h2 id='kalman'>Maximum Likelihood Estimation of Parameters for iAR, CiAR, and BiAR Models using the Kalman Filter</h2><span id='topic+kalman'></span>

<h3>Description</h3>

<p>Performs Maximum Likelihood Estimation (MLE) of the parameters of the iAR, CiAR, and BiAR models by maximizing the likelihood function using the Kalman filter.
This method applies the Kalman filter to compute the likelihood and estimate the model parameters that maximize the likelihood for each model type.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kalman(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="kalman_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code> containing the model specification and parameters:
</p>

<ul>
<li><p> For <code>iAR</code> models, the object should contain:
</p>

<ul>
<li> <p><code>series</code>: A numeric vector of the time series data.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>series_esd</code>: A numeric vector specifying the error structure.
</p>
</li>
<li> <p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.
</p>
</li>
<li> <p><code>standardized</code>: A logical value indicating if the series should be standardized.
</p>
</li></ul>

</li>
<li><p> For <code>CiAR</code> models, the object should contain:
</p>

<ul>
<li> <p><code>series</code>: A numeric vector of the time series data.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>series_esd</code>: A numeric vector specifying the error structure.
</p>
</li>
<li> <p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.
</p>
</li>
<li> <p><code>standardized</code>: A logical value indicating if the series should be standardized.
</p>
</li>
<li> <p><code>c</code>: A numeric value specifying the scale parameter for the CiAR model.
</p>
</li>
<li> <p><code>niter</code>: An integer specifying the number of iterations for the Kalman filter.
</p>
</li>
<li> <p><code>seed</code>: An integer seed for random number generation (optional).
</p>
</li></ul>

</li>
<li><p> For <code>BiAR</code> models, the object should contain:
</p>

<ul>
<li> <p><code>series</code>: A numeric matrix containing two columns for bivariate time series data.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>series_esd</code>: A numeric matrix specifying the error structure for both series.
</p>
</li>
<li> <p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.
</p>
</li>
<li> <p><code>niter</code>: An integer specifying the number of iterations for the Kalman filter.
</p>
</li>
<li> <p><code>seed</code>: An integer seed for random number generation (optional).
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="kalman_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function applies the Kalman filter to perform Maximum Likelihood Estimation (MLE) of the parameters of the autoregressive models (iAR, CiAR, BiAR). The Kalman filter is used to maximize the likelihood function based on the given time series data, and the parameters that maximize the likelihood are estimated.
</p>
<p>- For <code>iAR</code>, the Kalman filter is applied to estimate the model parameters by maximizing the likelihood.
- For <code>CiAR</code>, the Kalman filter is applied to estimate the parameters of the complex autoregressive model by maximizing the likelihood.
- For <code>BiAR</code>, the Kalman filter is applied to estimate the parameters of the bivariate autoregressive model by maximizing the likelihood.
</p>
<p>The method returns the updated model object, including the estimated parameters and the log-likelihood value.
</p>


<h3>Value</h3>

<p>An updated object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, where the <code>coef</code> property is updated with the estimated model parameters (using MLE) and the <code>kalmanlik</code> property contains the log-likelihood value of the model.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Applying Kalman filter for MLE of iAR model parameters
library(iAR)
n=100
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_norm &lt;- iAR(family = "norm", times = times, coef = 0.9,hessian=TRUE)
model_norm &lt;- sim(model_norm)
model_norm &lt;- kalman(model_norm)  
print(model_norm@coef)  # Access the estimated coefficients
print(model_norm@kalmanlik)  # Access the Kalman likelihood value

# Example 2: Applying Kalman filter for MLE of CiAR model parameters
set.seed(6714)
model_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))
model_CiAR &lt;- sim(model_CiAR)
y=model_CiAR@series
y1=y/sd(y)
model_CiAR@series=y1
model_CiAR@series_esd=rep(0,n)
model_CiAR &lt;- kalman(model_CiAR)
print(model_CiAR@coef)
print(model_CiAR@kalmanlik)  

# Example 3: Applying Kalman filter for MLE of BiAR model parameters
set.seed(6714)
model_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)
model_BiAR &lt;- sim(model_BiAR)
y=model_BiAR@series
y1=y/apply(y,2,sd)
model_BiAR@series=y1
model_BiAR@series_esd=matrix(0,n,2)
model_BiAR &lt;- kalman(model_BiAR)
print(model_BiAR@coef) 
print(model_BiAR@kalmanlik)  

</code></pre>

<hr>
<h2 id='loglik'>Maximum Likelihood Estimation for iAR Models</h2><span id='topic+loglik'></span>

<h3>Description</h3>

<p>Maximum Likelihood Estimation for irregular autoregressive (iAR) models, supporting different distribution families:
normal ('iAR'), t ('iAR-T'), and gamma ('iAR-Gamma').
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loglik(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loglik_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, containing the model specification, parameters, and the time series to be evaluated:
</p>

<ul>
<li> <p><code>series</code>: The observed time series.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>series_esd</code>: (Optional) A standardized version of the series.
</p>
</li>
<li> <p><code>zero_mean</code>: Logical. Indicates whether the series should be mean-centered.
</p>
</li>
<li> <p><code>standardized</code>: Logical. Indicates whether the series is standardized.
</p>
</li>
<li> <p><code>hessian</code>: Logical. If <code>TRUE</code>, the function computes the Hessian matrix for parameter estimation.
</p>
</li>
<li> <p><code>family</code>: The distribution family of the iAR model (one of &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;).
</p>
</li>
<li> <p><code>df</code>: Degrees of freedom for the t-distribution (only for <code>family = "t"</code>).
</p>
</li>
<li> <p><code>sigma</code>: The scale parameter for the t-distribution (only for <code>family = "t"</code>).
</p>
</li>
<li> <p><code>mean</code>: The mean parameter for the gamma distribution (only for <code>family = "gamma"</code>).
</p>
</li>
<li> <p><code>variance</code>: The variance parameter for the gamma distribution (only for <code>family = "gamma"</code>).
</p>
</li></ul>
</td></tr>
<tr><td><code id="loglik_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method estimates the parameters of an iAR model using the Maximum Likelihood Estimation (MLE) approach. 
Depending on the chosen distribution family, the corresponding likelihood function is maximized:
</p>

<ul>
<li><p> &quot;norm&quot; maximizes the likelihood for a normally-distributed series.
</p>
</li>
<li><p> &quot;t&quot; maximizes the likelihood for a t-distributed series.
</p>
</li>
<li><p> &quot;gamma&quot; maximizes the likelihood for a gamma-distributed series.
</p>
</li></ul>

<p>The function updates the <code>iAR</code> object with the estimated parameters, the log-likelihood value, and a summary 
table that includes standard errors and p-values.
</p>


<h3>Value</h3>

<p>An updated <code>iAR</code> object with the following additional attributes:
</p>

<ul>
<li> <p><code>coef</code>: Estimated model coefficients.
</p>
</li>
<li> <p><code>loglik</code>: Log-likelihood value of the model.
</p>
</li>
<li> <p><code>summary</code>: A summary table containing parameter estimates, standard errors, and p-values.
</p>
</li>
<li> <p><code>sigma</code>: For t and gamma families, the estimated scale parameter.
</p>
</li>
<li> <p><code>mean</code>: For the gamma family, the estimated mean parameter.
</p>
</li>
<li> <p><code>variance</code>: For the gamma family, the estimated variance parameter.
</p>
</li></ul>



<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example: Estimating parameters for a normal iAR model
library(iAR)
times &lt;- 1:100
model &lt;- iAR(family = "norm", times = times, coef = 0.9, hessian = TRUE)
model &lt;- sim(model)  # Simulate the series
model &lt;- loglik(model)  # Estimate parameters using MLE
print(model@coef)  # Access the estimated coefficients
print(model@loglik)  # Access the computed log-likelihood

</code></pre>

<hr>
<h2 id='multidata'>Multidata Class</h2><span id='topic+multidata'></span>

<h3>Description</h3>

<p>The 'multidata' class is an S7 class designed to represent multidimensional time series models, including the main time series and additional series (e.g., error standard deviations or related variables).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multidata(times = integer(0), series = integer(0), series_esd = integer(0))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multidata_+3A_times">times</code></td>
<td>
<p>A numeric vector representing the time points of the time series.</p>
</td></tr>
<tr><td><code id="multidata_+3A_series">series</code></td>
<td>
<p>A numeric vector or matrix representing the main time series.</p>
</td></tr>
<tr><td><code id="multidata_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric vector or matrix representing the additional series, such as error standard deviations or other related data.</p>
</td></tr>
</table>


<h3>Validation Rules</h3>

<p>- '@times' and '@series' must be vectors or matrices (but not arrays).
- The lengths of '@times' and '@series' must be the same.
- If '@series_esd' is provided, it must be a vector or matrix with the same length as '@series'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a multidata object
multidata_instance &lt;- multidata(
  times = c(1, 2, 3, 4),
  series = c(10, 20, 15, 25),
  series_esd = c(1, 1.5, 1.2, 1.8)
)

</code></pre>

<hr>
<h2 id='pairingits'>Pairing two irregularly observed time series</h2><span id='topic+pairingits'></span>

<h3>Description</h3>

<p>This method pairs the observational times of two irregularly observed time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairingits(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pairingits_+3A_x">x</code></td>
<td>
<p>An object of class 'utilities'.</p>
</td></tr>
<tr><td><code id="pairingits_+3A_...">...</code></td>
<td>
<p>Additional arguments for pairing time series: 
</p>

<dl>
<dt>lc1</dt><dd><p>A data frame with three columns corresponding to the first irregularly observed time series.</p>
</dd>
<dt>lc2</dt><dd><p>A data frame with three columns corresponding to the second irregularly observed time series.</p>
</dd>
<dt>tol</dt><dd><p>A numeric value indicating the tolerance parameter.</p>
</dd>
</dl>
</td></tr>
</table>


<h3>Details</h3>

<p>The method checks the observational times in both input time series and pairs the measurements if they fall within the specified tolerance ('tol'). If a measurement in one series cannot be paired, it is filled with 'NA' values for the corresponding columns of the other series.
</p>


<h3>Value</h3>

<p>An object of class 'utilities' with two slots:
</p>
<table role = "presentation">
<tr><td><code>series</code></td>
<td>
<p>A matrix containing the paired time series, where unmatched measurements are filled with 'NA'.</p>
</td></tr>
<tr><td><code>series_esd</code></td>
<td>
<p>A matrix containing the paired error standard deviations of the time series, where unmatched measurements are filled with 'NA'.</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>A numeric vector with the paired observational times.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cvnovag)
data(cvnovar)
datag=cvnovag
datar=cvnovar
o1=iAR::utilities()
o1&lt;-pairingits(o1, datag,datar,tol=0.1)
pargr1=na.omit(o1@paired)
st=apply(pargr1[,c(1,4)],1,mean)
model_BiAR &lt;- BiAR(times = st,series=pargr1[,c(2,5)],series_esd=pargr1[,c(3,6)])
model_BiAR &lt;- kalman(model_BiAR)

</code></pre>

<hr>
<h2 id='Planets'>Transit of an extrasolar planet</h2><span id='topic+Planets'></span>

<h3>Description</h3>

<p>Time series corresponding to the residuals of the parametric model fitted by Jordan et al (2013) for a transit of an extrasolar planet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Planets
</code></pre>


<h3>Format</h3>

<p>A data frame with 91 observations on the following 2 variables:
</p>

<dl>
<dt>t</dt><dd><p>Time from mid-transit (hours).</p>
</dd>
<dt>r</dt><dd><p>Residuals of the parametric model fitted by Jordan et al (2013).</p>
</dd>
</dl>



<h3>References</h3>

<p>Jord√°n A, Espinoza N, Rabus M, Eyheramendy S, Sing D~K, D√©sert J, Bakos G~√Å, Fortney J~J, L√≥pez-Morales M, Maxted P~F~L, Triaud A~H~M~J, Szentgyorgyi A (2013).
&ldquo;A Ground-based Optical Transmission Spectrum of WASP-6b.&rdquo;
<em>The Astrophysical Journal</em>, <b>778</b>, 184.
<a href="https://doi.org/10.1088/0004-637X/778/2/184">doi:10.1088/0004-637X/778/2/184</a>, 1310.6048.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Planets)
#plot(Planets[,1],Planets[,2],xlab='Time from mid-transit (hours)',ylab='Noise',pch=20)
</code></pre>

<hr>
<h2 id='plot'>Plot Method for unidata Objects</h2><span id='topic+plot'></span>

<h3>Description</h3>

<p>This method allows visualizing 'unidata' and 'multidata' objects using the 'plot.zoo' 
function from the 'zoo' package. It converts the 'unidata' ('multidata') object into 
a 'zoo' object and then applies the plotting function to the time series 
contained in the object.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_+3A_x">x</code></td>
<td>
<p>An object of class 'unidata' or 'multidata'. This object must contain the time 
series in the 'series' slot and the associated time points in the 
'times' slot.</p>
</td></tr>
<tr><td><code id="plot_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 'plot.zoo' function for 
customizing the plot (e.g., titles, colors, etc.).</p>
</td></tr>
</table>

<hr>
<h2 id='plot_fit'>Plot Fit Method for unidata Objects</h2><span id='topic+plot_fit'></span>

<h3>Description</h3>

<p>This method visualizes the 'unidata' and 'multidata' objects by plotting both the 
original time series and the fitted values. The 'unidata' ('multidata') object is 
converted into a 'zoo' object for plotting, and the fitted values are 
added as a secondary line with a different style and color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_fit(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_fit_+3A_x">x</code></td>
<td>
<p>An object of class 'unidata' or 'multidata'. This object must contain the 
time series in the 'series' slot, the associated time points in the 
'times' slot, and the fitted values in the 'fitted_values' slot.</p>
</td></tr>
<tr><td><code id="plot_fit_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 'plot.zoo' function for 
customizing the plot (e.g., titles, colors, etc.).</p>
</td></tr>
</table>

<hr>
<h2 id='plot_forecast'>Plot Forecast Method for unidata Objects</h2><span id='topic+plot_forecast'></span>

<h3>Description</h3>

<p>This method visualizes the 'unidata' and 'multidata' objects by plotting both the 
original time series and the forecasted values. The 'unidata' ('multidata') object 
is converted into a 'zoo' object for plotting, and the forecasted 
values are added as points with a different color.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_forecast(x,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_forecast_+3A_x">x</code></td>
<td>
<p>An object of class 'unidata' or 'multidata'. This object must contain the 
time series in the 'series' slot, the associated time points in the 
'times' slot, the forecasted values in the 'forecast' slot, and the 
forecast horizon in the 'tAhead' slot.</p>
</td></tr>
<tr><td><code id="plot_forecast_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to the 'plot.zoo' function for 
customizing the plot (e.g., titles, colors, etc.).</p>
</td></tr>
</table>

<hr>
<h2 id='sim'>Simulate Time Series for Multiple iAR Models</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>Simulates a time series for irregular autoregressive (iAR) models, including:
1. Normal iAR model ('iAR')
2. T-distribution iAR model ('iAR-T')
3. Gamma-distribution iAR model ('iAR-Gamma')
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sim_+3A_x">x</code></td>
<td>
<p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, containing the model specification and parameters:
</p>

<ul>
<li><p> For <code>iAR</code> (irregular AR models), the model family could be &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;, where:
</p>

<ul>
<li> <p><code>family</code>: The distribution family of the iAR model (one of &quot;norm&quot;, &quot;t&quot;, or &quot;gamma&quot;).
</p>
</li>
<li> <p><code>coef</code>: The coefficient(s) of the iAR model.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>df</code>: Degrees of freedom for the t-distribution (only for <code>family = "t"</code>).
</p>
</li>
<li> <p><code>sigma</code>: The scale parameter for the t-distribution (only for <code>family = "t"</code>).
</p>
</li>
<li> <p><code>mean</code>: The mean parameter for the gamma distribution (only for <code>family = "gamma"</code>).
</p>
</li>
<li> <p><code>variance</code>: The variance parameter for the gamma distribution (only for <code>family = "gamma"</code>).
</p>
</li></ul>

</li>
<li><p> For <code>CiAR</code> (complex irregular autoregressive models):
</p>

<ul>
<li> <p><code>coef</code>: The real and imaginary parts of the CiAR model's coefficients.
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>rho</code>: The correlation parameter for the CiAR model.
</p>
</li>
<li> <p><code>c</code>: The scale parameter for the CiAR model.
</p>
</li></ul>

</li>
<li><p> For <code>BiAR</code> (bi-AR models):
</p>

<ul>
<li> <p><code>coef</code>: The coefficients of the BiAR model (real and imaginary).
</p>
</li>
<li> <p><code>times</code>: A numeric vector specifying the time points of the series.
</p>
</li>
<li> <p><code>rho</code>: The correlation parameter for the BiAR model.
</p>
</li>
<li> <p><code>series_esd</code>: The series for the error structure (optional, used internally).
</p>
</li></ul>

</li></ul>
</td></tr>
<tr><td><code id="sim_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function simulates time series based on the specified model and its parameters. Depending on the class of the input object:
</p>

<ul>
<li><p> For <code>iAR</code> models, it supports three distribution families:
</p>
</li>
<li><p> &quot;norm&quot; for normal distribution.
</p>
</li>
<li><p> &quot;t&quot; for t-distribution.
</p>
</li>
<li><p> &quot;gamma&quot; for gamma distribution.
</p>
</li>
<li><p> For <code>CiAR</code> models, it uses complex autoregressive processes to generate the time series.
</p>
</li>
<li><p> For <code>BiAR</code> models, it simulates a bi-AR process using specified coefficients and correlation.
</p>
</li></ul>

<p>The coefficients and any family-specific parameters must be set before calling this function.
</p>


<h3>Value</h3>

<p>An updated object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, where the <code>series</code> property contains the simulated time series.
</p>


<h3>References</h3>

<p>Eyheramendy S, Elorrieta F, Palma W (2018).
&ldquo;An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487">doi:10.1093/mnras/sty2487</a>, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
&ldquo;Discrete-time autoregressive model for unequally spaced time-series observations.&rdquo;
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560">doi:10.1051/0004-6361/201935560</a>.,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
&ldquo;A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.&rdquo;
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216">doi:10.1093/mnras/stab1216</a>, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1: Simulating a normal iAR model
library(iAR)
n=100
set.seed(6714)
o=iAR::utilities()
o&lt;-gentime(o, n=n)
times=o@times
model_norm &lt;- iAR(family = "norm", times = times, coef = 0.9,hessian=TRUE)
model_norm &lt;- sim(model_norm)
plot(model_norm, type = "l", main = "Simulated iAR-Norm Series")

# Example 2: Simulating a CiAR model
set.seed(6714)
model_CiAR &lt;- CiAR(times = times,coef = c(0.9, 0))
model_CiAR &lt;- sim(model_CiAR)
plot(model_CiAR , type = "l", main = "Simulated CiAR Series")

# Example 3: Simulating a BiAR model
set.seed(6714)
model_BiAR &lt;- BiAR(times = times,coef = c(0.9, 0.3), rho = 0.9)
model_BiAR &lt;- sim(model_BiAR)
plot(times, model_BiAR@series[,1], type = "l", main = "Simulated BiAR Series")

</code></pre>

<hr>
<h2 id='summary'>Summary Method for unidata Objects</h2><span id='topic+summary'></span>

<h3>Description</h3>

<p>This method provides a summary of the 'unidata' object, which represents 
an iAR (irregular autoregressive) model. The summary includes information 
about the model family (e.g., &quot;normal&quot;, &quot;t&quot;, &quot;gamma&quot;), the coefficients, 
standard errors, t-values, and p-values. The output is formatted to display 
the relevant statistics based on the model family.
</p>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary_+3A_object">object</code></td>
<td>
<p>An object of class 'unidata'. This object contains the fitted 
iAR model, including parameters such as coefficients ('coef'), 
standard errors ('stderr'), t-values ('tvalue'), p-values ('pvalue'), 
family type ('family'), and other model-specific parameters.</p>
</td></tr>
<tr><td><code id="summary_+3A_...">...</code></td>
<td>
<p>Additional arguments (unused).</p>
</td></tr>
</table>

<hr>
<h2 id='unidata'>Unidata Class</h2><span id='topic+unidata'></span>

<h3>Description</h3>

<p>The 'unidata' class is an S7 class designed to represent univariate irregularly observed time series models
with associated times, values, and optional error standard deviations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unidata(times = integer(0), series = integer(0), series_esd = integer(0))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="unidata_+3A_times">times</code></td>
<td>
<p>A numeric vector representing the time points.</p>
</td></tr>
<tr><td><code id="unidata_+3A_series">series</code></td>
<td>
<p>A numeric vector representing the values of the time series.</p>
</td></tr>
<tr><td><code id="unidata_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric vector representing the error standard deviations of the time series.</p>
</td></tr>
</table>


<h3>Validation Rules</h3>

<p>- '@times', '@series', and '@series_esd' must be vectors (not matrices or arrays).
- The lengths of '@times' and '@series' must be the same.
- If '@series_esd' is provided, it must be a vector with the same length as '@series'.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a unidata object
unidata_instance &lt;- unidata(
  times = c(1, 2, 3, 4),
  series = c(10, 20, 15, 25),
  series_esd = c(1, 1.5, 1.2, 1.8)
)

</code></pre>

<hr>
<h2 id='utilities'>Utilities Class</h2><span id='topic+utilities'></span>

<h3>Description</h3>

<p>The 'utilities' class is an S7 class designed to group utility functions 
that are not directly tied to other specific objects in the package. 
These include the functions 'gentime', 'paringits', 'harmonicfit', and 'foldlc'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utilities(
  times = integer(0),
  series = integer(0),
  series_esd = integer(0),
  paired = integer(0)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="utilities_+3A_times">times</code></td>
<td>
<p>A numeric vector storing the time points.</p>
</td></tr>
<tr><td><code id="utilities_+3A_series">series</code></td>
<td>
<p>A numeric vector representing the values of the time series.</p>
</td></tr>
<tr><td><code id="utilities_+3A_series_esd">series_esd</code></td>
<td>
<p>A numeric vector representing the error standard deviations of the time series.</p>
</td></tr>
<tr><td><code id="utilities_+3A_paired">paired</code></td>
<td>
<p>Data Frame with the paired datasets.</p>
</td></tr>
</table>


<h3>Description</h3>

<p>This class acts as a container for standalone methods that perform independent 
operations within the package. By grouping them under a single class, the package 
achieves better modularity and organization, facilitating maintenance and extensibility.
</p>


<h3>Available Methods</h3>

<p>- 'gentime': Generates time points based on a specified statistical distribution.
- 'paringits': A method for pairing irregular time series.
- 'harmonicfit': A method for fitting harmonic models to data.
- 'foldlc': A method for folding light curves in time series analysis.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create a utilities object

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
