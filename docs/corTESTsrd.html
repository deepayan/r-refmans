<!DOCTYPE html><html><head><title>Help for package corTESTsrd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {corTESTsrd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#corTESTsrd'><p>Significance test of rank cross-correlations</p></a></li>
<li><a href='#kendall_var_independent'><p>Asymptotic variance of estimator of Kendall's Tau between independent iid random variables</p></a></li>
<li><a href='#long_run_var_est_kendall_H0'><p>Estimator of long-run variance for Kendall's Tau</p></a></li>
<li><a href='#long_run_var_est_spearman_H0'><p>Estimator of long-run variance for Spearman's Rho</p></a></li>
<li><a href='#rankacf'><p>Estimator of Spearman autocorrelations</p></a></li>
<li><a href='#spearman_var_independent'><p>Asymptotic variance of estimator of Spearman's Rho between independent iid random variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Significance Testing of Rank Cross-Correlations under SRD</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-17</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Significance test of Spearman's Rho or Kendall's Tau 
             between short-range dependent random variables.</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-17 15:39:35 UTC; derro</td>
</tr>
<tr>
<td>Author:</td>
<td>David Lun [aut, cre],
  Svenja Fischer [aut],
  Alberto Viglione [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Lun &lt;lun@hydro.tuwien.ac.at&gt;</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-17 16:00:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='corTESTsrd'>Significance test of rank cross-correlations</h2><span id='topic+corTESTsrd'></span>

<h3>Description</h3>

<p>Significance test of Spearman's Rho or Kendall's Tau between time series of short-range dependent random variables.
The test is based on the asymptotic normal distributions of the estimators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corTESTsrd(x, y,
           iid=TRUE, method="spearman",
           alternative="two.sided",
           kernelf=function(z){return(ifelse(abs(z) &lt;= 1, (1 - z^2)^2, 0))},
           bwf=function(n){3*n^(1/4)})
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corTESTsrd_+3A_x">x</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_y">y</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_iid">iid</code></td>
<td>
<p>logical, if TRUE, observations are assumed to be iid, if FALSE observations are assumed to be short-range dependent and the long-run variance of the estimator is estimated from the observations.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_method">method</code></td>
<td>
<p>a character string, indicating which correlation coefficient should be used for the test. One of &quot;spearman&quot; or &quot;kendall&quot;, cannot be abbreviated.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_alternative">alternative</code></td>
<td>
<p>a character string indicating the alternative hypothesis. Must be one of &quot;two.sided&quot;, &quot;greater&quot; or &quot;less&quot;, cannot be abbreviated.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_kernelf">kernelf</code></td>
<td>
<p>a function that is used in the estimation procedure. The default kernel-function is a quartic kernel. Should be a vectorized function.</p>
</td></tr>
<tr><td><code id="corTESTsrd_+3A_bwf">bwf</code></td>
<td>
<p>a function for choosing the bandwidth, based on the sample size <code class="reqn">n</code>, that should be used in the estimation procedure. Default is <code class="reqn">3n^{1/4}</code>, <code class="reqn">b_n=o(n^{1/2})</code> must hold.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates an estimate of the rank correlation coefficient between the inputs x and y, which are assumed to be evenly spaced time series with equal time-increments,
and performs a significance test for the rank correlation coefficient with <code class="reqn">\mathcal{H}_0: \rho_S/\tau=0</code> against an alternative specified by the user. The function returns the estimate of the rank correlation coefficient
and a p-value. Missing observations (<code>NA</code>) are allowed, but will prompt a warning. Ties are not allowed. <br /> <br />
The test statistic and the corresponding p-value are based on the distribution of the respective estimator under the assumption of independence between the inputs x and y, and an additional assumption regarding
the dependence structure of the inputs on their own past. The distribution of the test statistic is modelled as a normal distribution. <br /> <br />
If the option iid is TRUE, the inputs are assumed to be realizations of independent and identically distributed random variables. In this case the asymptotic variance of the test statistic is given by <code class="reqn">\frac{1}{n-1}</code>
for Spearman's Rho and as <code class="reqn">\frac{2(2n+5)}{9n(n-1)}</code> for Kendall's Tau, see Gibbons and Chakraborti (2003), equations 3.13 and 2.29 in chapter 11, respectively. <br /> <br />
If the option iid is FALSE, the inputs are assumed to be realizations of short-range dependent random variables (see Corollary 1 in Lun et al., 2022). The asymptotic variance of the test statistic is modelled as
<code class="reqn">\frac{1}{n}(1+2\sum_{h=1}^{\infty} \rho_S^X(h) \rho_S^Y(h))</code> for Spearman's Rho and as <code class="reqn">\frac{4}{9n}(1+2\sum_{h=1}^{\infty} \rho_S^X(h) \rho_S^Y(h))</code> for Kendall's Tau.
Here <code class="reqn">\rho_S^X(h)</code> refers to the Spearman autocorrelation of the first input x for lag <code class="reqn">h</code>, and the analogue applies to <code class="reqn">\rho_S^X(h)</code>. In this case the asymptotic variance of the test statistic is estimated
(see Corollary 2 in Lun et al., 2022). For this estimation procedure a kernel-function together with a bandwidth is used, which can be specified by the user.
</p>


<h3>Value</h3>

<p>Estimate of rank correlation coefficient and p-value of corresponding hypothesis test.
</p>


<h3>References</h3>

<p>J. D. Gibbons, and S. Chakraborti, Nonparametric statistical inference (4th Edition). CRC press, 2003. <br /> <br />
D. Lun, S. Fischer, A. Viglione, and G. Blöschl, Significance testing of rank cross-correlations between autocorrelated time series with short-range dependence, Journal of Applied Statistics, 2022, 1-17. doi: <a href="https://doi.org/10.1080/02664763.2022.2137115">10.1080/02664763.2022.2137115</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Demonstration
sam_size = 50
nsim = 1000

pval_iid &lt;- rep(NA, nsim)
pval_srd &lt;- rep(NA, nsim)
#iid-simulation: if we have iid observations the modified test
#is able to maintain the desired significance level
for(j in c(1:nsim)) {
  x &lt;- rnorm(n=sam_size)
  y &lt;- rnorm(n=sam_size)
  pval_iid[j] &lt;- corTESTsrd(x, y, iid=TRUE, method="spearman")[2]
  pval_srd[j] &lt;- corTESTsrd(x, y, iid=FALSE, method="spearman")[2]
}
sum(pval_iid &lt;= 0.05)/nsim
sum(pval_srd &lt;= 0.05)/nsim

#ar(1)-simulation: if we have srd-observations the modified test
#counteracts the inflation of type-I-errors
for(j in c(1:nsim)) {
  x &lt;- as.numeric(arima.sim(model=list(ar=c(0.8)), n=sam_size))
  y &lt;- as.numeric(arima.sim(model=list(ar=c(0.8)), n=sam_size))
  pval_iid[j] &lt;- corTESTsrd(x, y, iid=TRUE, method="spearman")[2]
  pval_srd[j] &lt;- corTESTsrd(x, y, iid=FALSE, method="spearman")[2]
}
sum(pval_iid &lt;= 0.05)/nsim
sum(pval_srd &lt;= 0.05)/nsim

#the test can be made more conservative be choosing a bigger bandwidth,
#but this decreases the power
bwfbig &lt;- function(n) {10*(n^(1/4))}
#ar(1)-simulation: if we have srd-observations the modified test
#counteracts the inflation of type-I-errors
for(j in c(1:nsim)) {
  x &lt;- as.numeric(arima.sim(model=list(ar=c(0.8)), n=sam_size))
  y &lt;- as.numeric(arima.sim(model=list(ar=c(0.8)), n=sam_size))
  pval_iid[j] &lt;- corTESTsrd(x, y, iid=TRUE, method="spearman")[2]
  pval_srd[j] &lt;- corTESTsrd(x, y, iid=FALSE, method="spearman", bwf=bwfbig)[2]
}
sum(pval_iid&lt;=0.05)/nsim
sum(pval_srd&lt;=0.05)/nsim

</code></pre>

<hr>
<h2 id='kendall_var_independent'>Asymptotic variance of estimator of Kendall's Tau between independent iid random variables</h2><span id='topic+kendall_var_independent'></span>

<h3>Description</h3>

<p>Calculates the asymptotic variance of the estimator of Kendall's Tau between iid observations
of independent random variables. The expression comes from the asymptotic normal distribution of the estimator,
see e.g. equation 2.30 in chapter 11 of Gibbons and Chakraborti (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kendall_var_independent(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kendall_var_independent_+3A_n">n</code></td>
<td>
<p>number of observations, should be integer bigger than 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Asymptotic variance of estimator.
</p>


<h3>References</h3>

<p>J. D. Gibbons, and S. Chakraborti, Nonparametric statistical inference (4th Edition). CRC press, 2003.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>kendall_var_independent(n=50)
</code></pre>

<hr>
<h2 id='long_run_var_est_kendall_H0'>Estimator of long-run variance for Kendall's Tau</h2><span id='topic+long_run_var_est_kendall_H0'></span>

<h3>Description</h3>

<p>Estimates the long-run variance of the estimator of Kendall's Tau between short-range dependent observations
of independent random variables. The expression comes from the asymptotic normal distribution of estimator, see Corollary 2 in Lun et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_run_var_est_kendall_H0(x, y,
           kernelf=function(z) {return(ifelse(abs(z) &lt;= 1,(1 - z^2)^2, 0))},
           bwf=function(nnn){3*nnn^(1/4)})
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="long_run_var_est_kendall_H0_+3A_x">x</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="long_run_var_est_kendall_H0_+3A_y">y</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="long_run_var_est_kendall_H0_+3A_kernelf">kernelf</code></td>
<td>
<p>kernel-function that should be used in the estimation procedure.</p>
</td></tr>
<tr><td><code id="long_run_var_est_kendall_H0_+3A_bwf">bwf</code></td>
<td>
<p>function for choosing the bandwidth based on the sample size that is used in the estimation procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimate of long-run variance of estimator.
</p>


<h3>References</h3>

<p>D. Lun, S. Fischer, A. Viglione, and G. Blöschl, Significance testing of rank cross-correlations between autocorrelated time series with short-range dependence, Journal of Applied Statistics, 2022, 1-17. doi: <a href="https://doi.org/10.1080/02664763.2022.2137115">10.1080/02664763.2022.2137115</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>long_run_var_est_kendall_H0(x=rnorm(50),y=rnorm(50))
</code></pre>

<hr>
<h2 id='long_run_var_est_spearman_H0'>Estimator of long-run variance for Spearman's Rho</h2><span id='topic+long_run_var_est_spearman_H0'></span>

<h3>Description</h3>

<p>Estimates the long-run variance of the estimator of Spearman's Rho between short-range dependent observations
of independent random variables. The expression comes from the asymptotic normal distribution of the estimator, see Corollary 2 in Lun et al. (2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_run_var_est_spearman_H0(x, y,
           kernelf=function(z) {return(ifelse(abs(z) &lt;= 1,(1 - z^2)^2, 0))},
           bwf=function(nnn){3*nnn^(1/4)})
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="long_run_var_est_spearman_H0_+3A_x">x</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="long_run_var_est_spearman_H0_+3A_y">y</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="long_run_var_est_spearman_H0_+3A_kernelf">kernelf</code></td>
<td>
<p>kernel-function that should be used in the estimation procedure.</p>
</td></tr>
<tr><td><code id="long_run_var_est_spearman_H0_+3A_bwf">bwf</code></td>
<td>
<p>function for choosing the bandwidth based on the sample size that is used in the estimation procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimate of long-run variance of estimator.
</p>


<h3>References</h3>

<p>D. Lun, S. Fischer, A. Viglione, and G. Blöschl, Significance testing of rank cross-correlations between autocorrelated time series with short-range dependence, Journal of Applied Statistics, 2022, 1-17. doi: <a href="https://doi.org/10.1080/02664763.2022.2137115">10.1080/02664763.2022.2137115</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>long_run_var_est_spearman_H0(x=rnorm(50),y=rnorm(50))
</code></pre>

<hr>
<h2 id='rankacf'>Estimator of Spearman autocorrelations</h2><span id='topic+rankacf'></span>

<h3>Description</h3>

<p>Computes Spearman-autocorrelations when the observations contain <code>NA</code>s.
If the observations do not contain <code>NA</code>s, the function is consistent with the function acf applied to ranks.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rankacf(x,lag.max=length(x)-2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rankacf_+3A_x">x</code></td>
<td>
<p>numeric input vector.</p>
</td></tr>
<tr><td><code id="rankacf_+3A_lag.max">lag.max</code></td>
<td>
<p>maximum lag for which acf is estimated, automatically limited to one less than number of observations, should be positive integer.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Estimated spearman autocorrelation up to lag.max.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = rnorm(10)
rankacf(x)
acf(rank(x),plot=FALSE,lag.max = length(x)-2)$acf[-1,,1]
</code></pre>

<hr>
<h2 id='spearman_var_independent'>Asymptotic variance of estimator of Spearman's Rho between independent iid random variables</h2><span id='topic+spearman_var_independent'></span>

<h3>Description</h3>

<p>Calculates the asymptotic variance of the estimator of Spearman's Rho between iid observations
of independent random variables. The expression comes from the asymptotic normal distribution of the estimator,
see e.g. equation 3.13 in chapter 11 of Gibbons and Chakraborti (2003).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spearman_var_independent(n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spearman_var_independent_+3A_n">n</code></td>
<td>
<p>number of observations, should be integer bigger than 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Asymptotic variance of estimator.
</p>


<h3>References</h3>

<p>J. D. Gibbons, and S. Chakraborti, Nonparametric statistical inference (4th Edition). CRC press, 2003.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>spearman_var_independent(n=50)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
