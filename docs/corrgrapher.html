<!DOCTYPE html><html><head><title>Help for package corrgrapher</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {corrgrapher}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calculate_cors'><p>Calculate correlation coefficients</p></a></li>
<li><a href='#corrgrapher'><p>Create a <code>corrgrapher</code> object</p></a></li>
<li><a href='#knit_print.corrgrapher'><p>Knitr S3 method</p></a></li>
<li><a href='#plot.corrgrapher'><p>Visualize correlations in a corrgrapher object</p></a></li>
<li><a href='#print.corrgrapher'><p>Print S3 method</p></a></li>
<li><a href='#save_to_html'><p>Generate and save HTML report</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Explore Correlations Between Variables in a Machine Learning
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Pawel Morgen &lt;seriousmorgen@protonmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>When exploring data or models we often examine variables one by one. 
  This analysis is incomplete if the relationship between these variables is 
  not taken into account. The 'corrgrapher' package facilitates simultaneous 
  exploration of the Partial Dependence Profiles and the correlation between 
  variables in the model.
  The package 'corrgrapher' is a part of the 'DrWhy.AI' universe.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>visNetwork, ingredients, htmltools, ggplot2, knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat, DALEX, gbm, ranger, spelling, covr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://modeloriented.github.io/corrgrapher/">https://modeloriented.github.io/corrgrapher/</a>,
<a href="https://github.com/ModelOriented/corrgrapher">https://github.com/ModelOriented/corrgrapher</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ModelOriented/corrgrapher/issues">https://github.com/ModelOriented/corrgrapher/issues</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-10-13 16:18:54 UTC; mrdomani</td>
</tr>
<tr>
<td>Author:</td>
<td>Pawel Morgen [aut, cre],
  Przemyslaw Biecek [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-10-13 23:50:27 UTC</td>
</tr>
</table>
<hr>
<h2 id='calculate_cors'>Calculate correlation coefficients</h2><span id='topic+calculate_cors'></span><span id='topic+calculate_cors.explainer'></span><span id='topic+calculate_cors.matrix'></span><span id='topic+calculate_cors.table'></span><span id='topic+calculate_cors.default'></span>

<h3>Description</h3>

<p>Calculate correlation coefficients between variables in a <code>data.frame</code>, <code>matrix</code> or <code>table</code> 
using 3 different functions for 3 different possible pairs of vairables:
</p>

<ul>
<li><p>numeric - numeric
</p>
</li>
<li><p>numeric - categorical
</p>
</li>
<li><p>categorical - categorical</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>calculate_cors(
  x,
  num_num_f = NULL,
  num_cat_f = NULL,
  cat_cat_f = NULL,
  max_cor = NULL
)

## S3 method for class 'explainer'
calculate_cors(
  x,
  num_num_f = NULL,
  num_cat_f = NULL,
  cat_cat_f = NULL,
  max_cor = NULL
)

## S3 method for class 'matrix'
calculate_cors(
  x,
  num_num_f = NULL,
  num_cat_f = NULL,
  cat_cat_f = NULL,
  max_cor = NULL
)

## S3 method for class 'table'
calculate_cors(
  x,
  num_num_f = NULL,
  num_cat_f = NULL,
  cat_cat_f = NULL,
  max_cor = NULL
)

## Default S3 method:
calculate_cors(
  x,
  num_num_f = NULL,
  num_cat_f = NULL,
  cat_cat_f = NULL,
  max_cor = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="calculate_cors_+3A_x">x</code></td>
<td>
<p>object used to select method. See more below.</p>
</td></tr>
<tr><td><code id="calculate_cors_+3A_num_num_f">num_num_f</code></td>
<td>
<p>A <code>function</code> used to determine correlation coefficient between a pair of numeric variables</p>
</td></tr>
<tr><td><code id="calculate_cors_+3A_num_cat_f">num_cat_f</code></td>
<td>
<p>A <code>function</code> used to determine correlation coefficient between a pair of numeric and categorical variable</p>
</td></tr>
<tr><td><code id="calculate_cors_+3A_cat_cat_f">cat_cat_f</code></td>
<td>
<p>A <code>function</code> used to determine correlation coefficient between a pair of categorical variables</p>
</td></tr>
<tr><td><code id="calculate_cors_+3A_max_cor">max_cor</code></td>
<td>
<p>A number used to indicate absolute correlation (like 1 in <code>cor</code>). Must be supplied if any of <code>*_f</code> arguments is supplied.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A symmetrical <code>matrix</code> A of size n x n, where n - amount of columns in <code>x</code> (or dimensions for <code>table</code>).
The value at A(i,j) is the correlation coefficient between ith and jth variable.
On the diagonal, values from <code>max_cor</code> are set.
</p>


<h3>X argument</h3>

<p>When <code>x</code> is a <code>data.frame</code>, all columns of <code>numeric</code> type are treated as numeric variables and all columns of <code>factor</code> type are treated as categorical variables. Columns of other types are ignored.
</p>
<p>When <code>x</code> is a <code>matrix</code>, it is converted to <code>data.frame</code> using <code><a href="base.html#topic+as.data.frame.matrix">as.data.frame.matrix</a></code>.
</p>
<p>When <code>x</code> is a <code>explainer</code>, the tests are performed on its <code>data</code> element.
</p>
<p>When <code>x</code> is a <code>table</code>, it is treated as contingency table. Its dimensions must be named, but none of them may be named <code>Frequency</code>.
</p>


<h3>Default functions</h3>

<p>By default, the function calculates p_value of statistical tests ( <code><a href="stats.html#topic+cor.test">cor.test</a></code> for 2 <code>numeric</code>, <code><a href="stats.html#topic+chisq.test">chisq.test</a></code> for <code>factor</code> and <code><a href="stats.html#topic+kruskal.test">kruskal.test</a></code> for mixed).
</p>
<p>Then, the correlation coefficients are calculated as <code>-log10(p_value)</code>. Any results above 100 are treated as absolute correlation and cut to 100. 
</p>
<p>The results are then divided by 100 to fit inside [0,1].
</p>
<p>If only <code>numeric</code> data was supplied, the function used is <code><a href="stats.html#topic+cor.test">cor.test</a></code>.
</p>


<h3>Custom functions</h3>

<p>Creating consistent measures for correlation coefficients, which are comparable for different kinds of variables, is a non-trivial task.
Therefore, if user wishes to use custom function for calculating correlation coefficients, he must provide <strong>all</strong> necessary functions.
Using a custom function for one case and a default for the other is consciously not supported. 
Naturally, user may supply copies of default functions at his own responsibility.
</p>
<p>Function <code>calculate_cors</code> chooses, which parameters of <code>*_f</code> are required based on data supported. 
For example, for a <code>matrix</code> with <code>numeric</code> data only <code>num_num_f</code> is required. 
On the other hand, for a <code>table</code> only <code>cat_cat_f</code> is required.
</p>
<p>All <code>*_f</code> parameters must be functions, which accept 2 parameters (<code>numeric</code> or <code>factor</code> vectors respectively)
and return a single number from [0,max_num]. The <code>num_cat_f</code> must accept <code>numeric</code> argument as first and <code>factor</code> argument as second.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor.test">cor.test</a></code>, <code><a href="stats.html#topic+chisq.test">chisq.test</a></code>, <code><a href="stats.html#topic+kruskal.test">kruskal.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(mtcars)
# Make sure, that categorical variables are factors
mtcars$vs &lt;- factor(mtcars$vs, labels = c('V-shaped', 'straight'))
mtcars$am &lt;- factor(mtcars$am, labels = c('automatic', 'manual'))
calculate_cors(mtcars)

# For a table:
data(HairEyeColor)
calculate_cors(HairEyeColor)

# Custom functions:
num_mtcars &lt;- mtcars[,-which(colnames(mtcars) %in% c('vs', 'am'))]
my_f &lt;- function(x,y) cor.test(x, y, method = 'spearman', exact=FALSE)$estimate
calculate_cors(num_mtcars, num_num_f = my_f, max_cor = 1)

</code></pre>

<hr>
<h2 id='corrgrapher'>Create a <code>corrgrapher</code> object</h2><span id='topic+corrgrapher'></span><span id='topic+corrgrapher.explainer'></span><span id='topic+corrgrapher.matrix'></span><span id='topic+corrgrapher.default'></span>

<h3>Description</h3>

<p>This is the main function of <code>corrgrapher</code> package. It does necessary calculations and creates a <code>corrgrapher</code> object. 
Feel free to pass it into <code>plot</code>, include it in knitr report or generate a simple HTML.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrgrapher(x, ...)

## S3 method for class 'explainer'
corrgrapher(
  x,
  cutoff = 0.2,
  values = NULL,
  cor_functions = list(),
  ...,
  feature_importance = NULL,
  partial_dependence = NULL
)

## S3 method for class 'matrix'
corrgrapher(x, cutoff = 0.2, values = NULL, cor_functions = list(), ...)

## Default S3 method:
corrgrapher(x, cutoff = 0.2, values = NULL, cor_functions = list(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="corrgrapher_+3A_x">x</code></td>
<td>
<p>an object to be used to select the method, which must satisfy conditions:
</p>

<ul>
<li><p>if <code>data.frame</code> (default), columns of <code>numeric</code> type must contain numerical variables and columns of <code>factor</code> class must contain categorical variables. Columns of other types will be ignored.
</p>
</li>
<li><p>if <code>explainer</code>, methods <code><a href="ingredients.html#topic+feature_importance">feature_importance</a></code> and <code><a href="ingredients.html#topic+partial_dependence">partial_dependence</a></code> must not return an error. 
See also arguments <code>feature_importance</code> and <code>partial_dependence</code>.
</p>
</li>
<li><p>if <code>matrix</code>, it will be converted with <code><a href="base.html#topic+as.data.frame">as.data.frame</a></code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="corrgrapher_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
<tr><td><code id="corrgrapher_+3A_cutoff">cutoff</code></td>
<td>
<p>a number. Correlations below this are treated as <strong>no</strong> correlation. Edges corresponding to them will <strong>not</strong> be included in the graph.</p>
</td></tr>
<tr><td><code id="corrgrapher_+3A_values">values</code></td>
<td>
<p>a <code>data.frame</code> with information about size of the nodes, containing columns <code>value</code> and <code>label</code> (consistent with colnames of <code>x</code>). Default set to equal for all nodes, or (for <code>explainer</code>) importance of variables.</p>
</td></tr>
<tr><td><code id="corrgrapher_+3A_cor_functions">cor_functions</code></td>
<td>
<p>a named <code>list</code> of functions to pass to <code><a href="#topic+calculate_cors">calculate_cors</a></code>. Must contain necessary functions from <code>num_num_f</code>, <code>num_cat_f</code> or <code>cat_cat_f</code>. Must contain also <code>max_cor</code></p>
</td></tr>
<tr><td><code id="corrgrapher_+3A_feature_importance">feature_importance</code></td>
<td>
<p>Either: </p>

<ul>
<li><p>an object of <code>feature importance_explainer</code> class, created by <code><a href="ingredients.html#topic+feature_importance">feature_importance</a></code> function, or
</p>
</li>
<li><p>a named <code>list</code> of parameters to pass to <code><a href="ingredients.html#topic+feature_importance">feature_importance</a></code> function.
</p>
</li></ul>
</td></tr>
<tr><td><code id="corrgrapher_+3A_partial_dependence">partial_dependence</code></td>
<td>
<p>a named <code>list</code> with 2 elements: <code>numerical</code> and <code>categorical</code>. Both of them should be either: </p>

<ul>
<li><p>an object of <code>aggregated_profile_explainer</code> class, created by <code><a href="ingredients.html#topic+partial_dependence">partial_dependence</a></code> function, or
</p>
</li>
<li><p>a named <code>list</code> of parameters to pass to <code><a href="ingredients.html#topic+partial_dependence">partial_dependence</a></code>. 
</p>
</li></ul>

<p>If only one kind of data was used, use a list with 1 object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Data analysis (and creating ML models) involves many stages. For early exploration, 
it is useful to have a grip not only on individual series (AKA variables) available, 
but also on relations between them. Unfortunately, 
the task of understanding correlations between variables proves to be difficult. 
corrgrapher package aims to plot correlations between variables in form of a graph. 
Each node on it is associated with single variable. Variables correlated with each other 
(positively and negatively alike) shall be close, and weakly correlated  - far from each other.
</p>


<h3>Value</h3>

<p>A <code>corrgrapher</code> object. Essentially a <code>list</code>, consisting of following fields:
</p>

<ul>
<li><p><code>nodes</code> - a <code>data.frame</code> to pass as argument <code>nodes</code> to <code>visNetwork</code> function
</p>
</li>
<li><p><code>edges</code> - a <code>data.frame</code> to pass as argument <code>edges</code> to <code>visNetwork</code> function
</p>
</li>
<li><p><code>pds</code> (if x was of <code>explainer</code> class) - a <code>list</code> with 2 elements: <code>numerical</code> and <code>categorical</code>. Each of them contains an object of <code>aggregated_profiles_explainer</code> used to create partial dependency plots.
</p>
</li>
<li><p><code>data</code> - data used to create the object.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+plot.corrgrapher">plot.corrgrapher</a></code>, <code><a href="#topic+knit_print.corrgrapher">knit_print.corrgrapher</a></code>, <code><a href="#topic+save_to_html">save_to_html</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># convert the category variable
df &lt;- as.data.frame(datasets::Seatbelts)
df$law &lt;- factor(df$law) 
cgr &lt;- corrgrapher(df)
</code></pre>

<hr>
<h2 id='knit_print.corrgrapher'>Knitr S3 method</h2><span id='topic+knit_print.corrgrapher'></span>

<h3>Description</h3>

<p>This method allows <code>corrgrapher</code> objects to be displayed nicely in knitr/rmarkdown documents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'corrgrapher'
knit_print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="knit_print.corrgrapher_+3A_x">x</code></td>
<td>
<p>An object of <code>corrgrapher</code> class. See <code><a href="#topic+corrgrapher">corrgrapher</a></code> function.</p>
</td></tr>
<tr><td><code id="knit_print.corrgrapher_+3A_...">...</code></td>
<td>
<p>Other parameters, passed directly to <code><a href="htmltools.html#topic+knit_print.shiny.tag">knit_print.shiny.tag</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>2 objects will be displayed: graph of correlations on the left and a plot on the right. 
If <code>x</code> was created from <code>explainer</code>, the plot will visualize partial dependency
of the currently selected variable.
In other case, the plot will visualize distribution of the variable.
</p>

<hr>
<h2 id='plot.corrgrapher'>Visualize correlations in a corrgrapher object</h2><span id='topic+plot.corrgrapher'></span>

<h3>Description</h3>

<p>Visualize correlations between variables, using previously created <code>corrgrapher</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'corrgrapher'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.corrgrapher_+3A_x">x</code></td>
<td>
<p>a <code>corrgrapher</code> object. See <code><a href="#topic+corrgrapher">corrgrapher</a></code>.</p>
</td></tr>
<tr><td><code id="plot.corrgrapher_+3A_...">...</code></td>
<td>
<p>other parameters, passed directly to <code>visNetwork</code> function (such as <code>main</code>, <code>submain</code>, <code>width</code>, <code>height</code> etc.)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>visNetwork</code> object; graph. On this graph, the edges are treated as springs. 
The variables correlated <strong>strongly</strong> (positively or negatively) are <strong>close</strong> to each other, 
and those not (or weakly) correlated - <strong>far</strong> from each other.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+corrgrapher">corrgrapher</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- as.data.frame(datasets::Seatbelts)[,1:7] # drop the binary target variable
cgr &lt;- corrgrapher(df)
plot(cgr)
</code></pre>

<hr>
<h2 id='print.corrgrapher'>Print S3 method</h2><span id='topic+print.corrgrapher'></span>

<h3>Description</h3>

<p>This method allows <code>corrgrapher</code> objects to be displayed nicely in RStudio viewer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'corrgrapher'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.corrgrapher_+3A_x">x</code></td>
<td>
<p>An object of <code>corrgrapher</code> class. See <code><a href="#topic+corrgrapher">corrgrapher</a></code> function.</p>
</td></tr>
<tr><td><code id="print.corrgrapher_+3A_...">...</code></td>
<td>
<p>Other parameters, passed directly to <code>save_to_html</code> function.
If <code>x</code> was created from <code>explainer</code>, the plot will visualize partial dependency
of the currently selected variable.
In other case, the plot will visualize distribution of the variable.</p>
</td></tr>
</table>

<hr>
<h2 id='save_to_html'>Generate and save HTML report</h2><span id='topic+save_to_html'></span>

<h3>Description</h3>

<p>Create an interactive document in HTML based on <code>corrgrapher</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>save_to_html(cgr, file = "report.html", overwrite = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="save_to_html_+3A_cgr">cgr</code></td>
<td>
<p>An object of <code>corrgrapher</code> class. See <code><a href="#topic+corrgrapher">corrgrapher</a></code> function.</p>
</td></tr>
<tr><td><code id="save_to_html_+3A_file">file</code></td>
<td>
<p>File to write content to; passed directly to <code><a href="htmltools.html#topic+save_html">save_html</a></code>.</p>
</td></tr>
<tr><td><code id="save_to_html_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>file</code> exists, should it be overwritten?</p>
</td></tr>
<tr><td><code id="save_to_html_+3A_...">...</code></td>
<td>
<p>Other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A file of <code>file</code> name will be generated with 2 elements: graph of correlations in the middle and a plot on the right. 
If <code>x</code> was created from <code>explainer</code>, the plot will visualize partial dependency
of the currently selected variable.
In other case, the plot will visualize distribution of the variable.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
