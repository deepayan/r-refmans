<!DOCTYPE html><html lang="en"><head><title>Help for package logKDE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {logKDE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bw.logCV'><p>Optimal CV BW estimation for strictly positive distributions.</p></a></li>
<li><a href='#bw.logG'><p>Bandwidth estimation for strictly positive distributions.</p></a></li>
<li><a href='#logdensity'><p>Kernel Density Estimates of strictly positive distributions.</p></a></li>
<li><a href='#logdensity_fft'><p>Kernel Density Estimates of strictly positive distributions using FFT.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Computing Log-Transformed Kernel Density Estimates for Positive
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-08-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Hien D. Nguyen, Andrew T. Jones, and Geoffrey J. McLachlan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Thomas Jones &lt;andrewthomasjones@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes log-transformed kernel density estimates for positive data using a variety of kernels. It follows the methods described in Jones, Nguyen and McLachlan (2018) &lt;<a href="https://doi.org/10.21105%2Fjoss.00870">doi:10.21105/joss.00870</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp, pracma</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>R.rsp, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-09 07:02:52 UTC; andrewjones</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-09 07:20:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='bw.logCV'>Optimal CV BW estimation for strictly positive distributions.</h2><span id='topic+bw.logCV'></span>

<h3>Description</h3>

<p>Computes least squares cross-validation (CV) bandwidth (BW) for log domain KDE.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.logCV(x, grid = 21, NB = 512)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw.logCV_+3A_x">x</code></td>
<td>
<p>numeric vector of the data. Must be strictly positive, will be log transformed during estimation.</p>
</td></tr>
<tr><td><code id="bw.logCV_+3A_grid">grid</code></td>
<td>
<p>number of points used for BW selection CV grid.</p>
</td></tr>
<tr><td><code id="bw.logCV_+3A_nb">NB</code></td>
<td>
<p>number of points at which to estimate the KDE at during the CV loop.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bw the optimal least squares CV bandwidth.
</p>


<h3>References</h3>

<p>Silverman, B. W. (1986). Density estimation for statistics and data analysis. Monographs on Statistics and Applied Probability. 26.
</p>
<p>Stone, C. J. (1984). An asymptotically optimal window selection rule for kernel density estimates. The Annals of Statistics, 12(4), 1285-1297.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bw.logCV(rchisq(100,10), grid=21, NB=512)

</code></pre>

<hr>
<h2 id='bw.logG'>Bandwidth estimation for strictly positive distributions.</h2><span id='topic+bw.logG'></span>

<h3>Description</h3>

<p>Computes bandwidth for log domain KDE using the Silverman rule.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bw.logG(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bw.logG_+3A_x">x</code></td>
<td>
<p>numeric vector of the data. Must be strictly positive, will be log transformed during estimation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>bw the optimal bandwidth.
</p>


<h3>References</h3>

<p>Silverman, B. W. (1986). Density estimation for statistics and data analysis. Monographs on Statistics and Applied Probability. 26.
</p>
<p>Wand, M. P., Marron, J. S., &amp; Ruppert, D. (1991). Transformations in density estimation. Journal of the American Statistical Association, 86(414), 343-353.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>bw.logG(rchisq(100,10))

</code></pre>

<hr>
<h2 id='logdensity'>Kernel Density Estimates of strictly positive distributions.</h2><span id='topic+logdensity'></span>

<h3>Description</h3>

<p>The function <code>logdensity</code> computes kernel density estimates (KDE) of strictly positive distributions by performing the KDE in the log domain and then transforming the result back again. The syntax and function structure is largely borrowed from the function <code>density</code> in package stats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logdensity(x, bw = "nrd0", adjust = 1, kernel = "gaussian",
  weights = NULL, n = 512, from, to, cut = 3, na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logdensity_+3A_x">x</code></td>
<td>
<p>the data from which the estimate is to be computed.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_bw">bw</code></td>
<td>
<p>the smoothing bandwidth to be used. Can also be can also be a character string giving a rule to choose the bandwidth. Like <code>density</code> defaults to &quot;nrd0&quot;. All options in  <code>help(bw.nrd)</code> are available as well as <code>"bw.logCV"</code> and <code>"bw.logG"</code>.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_adjust">adjust</code></td>
<td>
<p>the bandwidth used is actually <code>adjust*bw</code>.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_kernel">kernel</code></td>
<td>
<p>a character string giving the smoothing kernel to be used. Choose from &quot;gaussian&quot;, &quot;epanechnikov&quot;, &quot;triangular&quot;, &quot;uniform&quot;, &quot;laplace&quot; and &quot;logistic&quot;. Default value is &quot;gaussian&quot;.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights of the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which the density is to be estimated. Note that these are equally spaced in the original domain.</p>
</td></tr>
<tr><td><code id="logdensity_+3A_from">from</code>, <code id="logdensity_+3A_to">to</code></td>
<td>
<p>the left and right-most points of the grid at which the density is to be estimated; the defaults are cut * bw outside of range(x).</p>
</td></tr>
<tr><td><code id="logdensity_+3A_cut">cut</code></td>
<td>
<p>by default, the values of from and to are cut bandwidths beyond the extremes of the data</p>
</td></tr>
<tr><td><code id="logdensity_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; if TRUE, missing values are removed from x. If FALSE any missing values cause an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with class &quot;density&quot;. See <code>help(density)</code> for details.
</p>


<h3>References</h3>

<p>Charpentier, A., &amp; Flachaire, E. (2015). Log-transform kernel density estimation of income distribution. L'Actualite economique, 91(1-2), 141-159.
</p>
<p>Wand, M. P., Marron, J. S., &amp; Ruppert, D. (1991). Transformations in density estimation. Journal of the American Statistical Association, 86(414), 343-353.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+density">density</a></code>, <code><a href="stats.html#topic+plot.density">plot.density</a></code>, <code><a href="#topic+logdensity_fft">logdensity_fft</a></code>, <code><a href="stats.html#topic+bw.nrd">bw.nrd</a></code>, <code><a href="#topic+bw.logCV">bw.logCV</a></code>,  <code><a href="#topic+bw.logG">bw.logG</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logdensity(abs(rnorm(100)), from =.1, to=2, kernel='triangular')

</code></pre>

<hr>
<h2 id='logdensity_fft'>Kernel Density Estimates of strictly positive distributions using FFT.</h2><span id='topic+logdensity_fft'></span>

<h3>Description</h3>

<p>The function <code>logdensity_fft</code> computes kernel density estimates (KDE) of strictly positive distributions by performing the KDE via fast fourier transform utilizing the <code>fft</code> function. The syntax and function structure is largely borrowed from the function <code>density</code> in package stats.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logdensity_fft(x, bw = "nrd0", adjust = 1, kernel = "gaussian",
  weights = NULL, n = 512, from, to, cut = log(3), na.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="logdensity_fft_+3A_x">x</code></td>
<td>
<p>the data from which the estimate is to be computed.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_bw">bw</code></td>
<td>
<p>the smoothing bandwidth to be used. Can also be can also be a character string giving a rule to choose the bandwidth. Like <code>density</code> defaults to &quot;nrd0&quot;. All options in  <code>help(bw.nrd)</code> are available as well as <code>"bw.logCV"</code> and <code>"bw.logG"</code>.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_adjust">adjust</code></td>
<td>
<p>the bandwidth used is actually <code>adjust*bw</code>.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_kernel">kernel</code></td>
<td>
<p>a character string giving the smoothing kernel to be used. Choose from &quot;gaussian&quot;, &quot;epanechnikov&quot;, &quot;triangular&quot;, &quot;uniform&quot;, &quot;laplace&quot; and &quot;logistic&quot;. Default value is &quot;gaussian&quot;.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_weights">weights</code></td>
<td>
<p>numeric vector of non-negative observation weights of the same length as <code>x</code>.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_n">n</code></td>
<td>
<p>the number of equally spaced points at which the density is to be estimated. Note that these are equally spaced in the log domain for <code>logdensity_fft</code>, and thus on a log scale when transformed back to the original domain.</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_from">from</code>, <code id="logdensity_fft_+3A_to">to</code></td>
<td>
<p>the left and right-most points of the grid at which the density is to be estimated; the defaults are cut * bw outside of range(x).</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_cut">cut</code></td>
<td>
<p>by default, the values of from and to are cut bandwidths beyond the extremes of the data</p>
</td></tr>
<tr><td><code id="logdensity_fft_+3A_na.rm">na.rm</code></td>
<td>
<p>logical; if TRUE, missing values are removed from x. If FALSE any missing values cause an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object with class &quot;density&quot;. See <code>help(density)</code> for details.
</p>


<h3>References</h3>

<p>Charpentier, A., &amp; Flachaire, E. (2015). Log-transform kernel density estimation of income distribution. L'Actualite economique, 91(1-2), 141-159.
</p>
<p>Cooley, J. W., &amp; Tukey, J. W. (1965). An algorithm for the machine calculation of complex Fourier series. Mathematics of computation, 19(90), 297-301.
</p>
<p>Wand, M. P., Marron, J. S., &amp; Ruppert, D. (1991). Transformations in density estimation. Journal of the American Statistical Association, 86(414), 343-353.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+density">density</a></code>, <code><a href="stats.html#topic+plot.density">plot.density</a></code>, <code><a href="#topic+logdensity">logdensity</a></code>, <code><a href="stats.html#topic+bw.nrd">bw.nrd</a></code>, <code><a href="#topic+bw.logCV">bw.logCV</a></code>,  <code><a href="#topic+bw.logG">bw.logG</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>logdensity_fft(abs(rnorm(100)), from =0.01, to= 2.5, kernel = 'logistic')

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
