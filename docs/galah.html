<!DOCTYPE html><html><head><title>Help for package galah</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {galah}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#galah'><p>Biodiversity Data from the GBIF Node Network</p></a></li>
<li><a href='#arrange.data_request'><p>Arrange rows of a query</p></a></li>
<li><a href='#atlas_citation'><p>Generate a citation for occurrence data</p></a></li>
<li><a href='#atlas_counts'><p>Return a count of records</p></a></li>
<li><a href='#atlas_media'><p>Get metadata on images, sounds and videos</p></a></li>
<li><a href='#atlas_occurrences'><p>Collect a set of occurrences</p></a></li>
<li><a href='#atlas_species'><p>Collect the set of species observed within the specified filters</p></a></li>
<li><a href='#atlas_taxonomy'><p>Search taxonomic trees</p></a></li>
<li><a href='#collapse_galah'><p>Generate a query</p></a></li>
<li><a href='#collect_galah'><p>Retrieve a database query</p></a></li>
<li><a href='#collect_media'><p>Collect media files</p></a></li>
<li><a href='#compute_galah'><p>Compute a query</p></a></li>
<li><a href='#galah_apply_profile'><p>Apply a data quality profile</p></a></li>
<li><a href='#galah_call'><p>Start building a query</p></a></li>
<li><a href='#galah_config'><p>Get or set configuration options that control galah behaviour</p></a></li>
<li><a href='#galah_down_to'><p>Deprecated functions</p></a></li>
<li><a href='#galah_filter'><p>Narrow a query by specifying filters</p></a></li>
<li><a href='#galah_geolocate'><p>Narrow a query to within a specified area</p></a></li>
<li><a href='#galah_group_by'><p>Specify fields to group when downloading record counts</p></a></li>
<li><a href='#galah_identify'><p>Narrow a query by passing taxonomic identifiers</p></a></li>
<li><a href='#galah_select'><p>Specify fields for occurrence download</p></a></li>
<li><a href='#print_galah_objects'><p>Print galah objects</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#search_all'><p>Search for record information</p></a></li>
<li><a href='#show_all'><p>Show valid record information</p></a></li>
<li><a href='#show_values'><p>Show or search for values within a specified field</p></a></li>
<li><a href='#slice_head.data_request'><p>Subset first rows of <code>data_request</code></p></a></li>
<li><a href='#tidyverse_functions'><p>Non-generic tidyverse functions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Biodiversity Data from the GBIF Node Network</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.2</td>
</tr>
<tr>
<td>Description:</td>
<td>The Global Biodiversity Information Facility 
    ('GBIF', <a href="https://www.gbif.org">https://www.gbif.org</a>) sources data from an international network
    of data providers, known as 'nodes'. Several of these nodes - the "living 
    atlases" (<a href="https://living-atlases.gbif.org">https://living-atlases.gbif.org</a>) - maintain their own web 
    services using software originally developed by the Atlas of Living 
    Australia ('ALA', <a href="https://www.ala.org.au">https://www.ala.org.au</a>). 'galah' enables the R community 
    to directly access data and resources hosted by 'GBIF' and its partner nodes.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cli, crayon, dplyr, glue (&ge; 1.3.2), httr2, jsonlite (&ge;
0.9.8), lifecycle (&ge; 1.0.0), potions (&ge; 0.2.0), purrr, readr,
rlang, sf, stringr, tibble, tidyr, tidyselect, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, gt, kableExtra, knitr, magrittr, pkgdown, reactable,
rmarkdown, testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.mozilla.org/en-US/MPL/2.0/">MPL-2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://galah.ala.org.au/R/">https://galah.ala.org.au/R/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AtlasOfLivingAustralia/galah-R/issues">https://github.com/AtlasOfLivingAustralia/galah-R/issues</a></td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Martin Westgate &lt;martin.westgate@csiro.au&gt;</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-04-12 05:32:09 UTC; wes186</td>
</tr>
<tr>
<td>Author:</td>
<td>Martin Westgate [aut, cre],
  Matilda Stevenson [aut],
  Dax Kellie [aut],
  Peggy Newman [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-04-12 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='galah'>Biodiversity Data from the GBIF Node Network</h2><span id='topic+galah'></span><span id='topic+galah-package'></span>

<h3>Description</h3>

<p>The Global Biodiversity Information Facility (GBIF; <a href="https://www.gbif.org">https://www.gbif.org</a>)
provides tools to enable users to find, access, combine and visualise
biodiversity data. <code>galah</code> enables the R community to directly access data and
resources hosted by GBIF and several of it's subsidiary organisations, known
as 'nodes'. The basic unit of observation stored by these infrastructures is
an <strong>occurrence</strong> record, based on the Darwin Core' data standard
(<a href="https://dwc.tdwg.org">https://dwc.tdwg.org</a>); however <code>galah</code> also enables users to locate and
download taxonomic information, or associated media such images or sounds,
all while restricting their queries to particular taxa or locations. Users
can specify which columns are returned by a query, or restrict their results
to observations that meet particular quality-control criteria.
</p>
<p>For those outside Australia, 'galah' is the common name of
<em>Eolophus roseicapilla</em>, a widely-distributed Australian bird species.
</p>


<h3>Functions</h3>

<p><strong>Piping functions</strong>
</p>

<ul>
<li> <p><code><a href="#topic+galah_call">galah_call()</a></code> or <code><a href="#topic+request_data">request_()</a></code> et al.  Start to build a data query
</p>
</li>
<li> <p><code><a href="#topic+collapse_galah">collapse()</a></code> Generate a query
</p>
</li>
<li> <p><code><a href="#topic+compute_galah">compute()</a></code> Compute a query
</p>
</li>
<li> <p><code><a href="#topic+collect_galah">collect()</a></code> Retrieve a database query
</p>
</li></ul>

<p><strong>Lazy data manipulation</strong>
</p>

<ul>
<li> <p><code><a href="#topic+identify.data_request">identify()</a></code> or <code><a href="#topic+galah_identify">galah_identify()</a></code> Search for taxonomic identifiers
</p>
</li>
<li> <p><code><a href="#topic+filter.data_request">filter()</a></code> or <code><a href="#topic+galah_filter">galah_filter()</a></code>Filter records
</p>
</li>
<li> <p><code><a href="#topic+select.data_request">select()</a></code> or <code><a href="#topic+galah_select">galah_select()</a></code>Fields to report information for
</p>
</li>
<li> <p><code><a href="#topic+group_by.data_request">group_by()</a></code> or <code><a href="#topic+galah_group_by">galah_group_by()</a></code> Fields to group counts by
</p>
</li>
<li> <p><code><a href="#topic+st_crop.data_request">st_crop()</a></code> or <code><a href="#topic+galah_geolocate">galah_geolocate()</a></code> Specify a location
</p>
</li>
<li> <p><code><a href="#topic+apply_profile">apply_profile()</a></code> or <code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code> Restrict to data that pass predefined checks (ALA only)
</p>
</li>
<li> <p><code><a href="#topic+slice_head.data_request">slice_head()</a></code> Choose the first n rows of a download
</p>
</li>
<li> <p><code><a href="#topic+arrange.data_request">arrange()</a></code> Arrange rows of a query on the server side
</p>
</li></ul>

<p><strong>Download data</strong>
</p>

<ul>
<li> <p><code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code> Download occurrence records
</p>
</li>
<li> <p><code><a href="#topic+atlas_counts">atlas_counts()</a></code> or <code><a href="#topic+count.data_request">count()</a></code> Count the number of records or species returned by a query
</p>
</li>
<li> <p><code><a href="#topic+atlas_species">atlas_species()</a></code> Download species lists
</p>
</li>
<li> <p><code><a href="#topic+atlas_taxonomy">atlas_taxonomy()</a></code> Return a section of the ALA taxonomic tree
</p>
</li>
<li> <p><code><a href="#topic+atlas_media">atlas_media()</a></code> View images and sounds available to download
</p>
</li>
<li> <p><code><a href="#topic+collect_media">collect_media()</a></code> Download images and sounds
</p>
</li></ul>

<p><strong>Look up information</strong>
</p>

<ul>
<li> <p><code><a href="#topic+search_taxa">search_taxa()</a></code> Search for taxa using a text-search
</p>
</li>
<li> <p><code><a href="#topic+search_identifiers">search_identifiers()</a></code> Search for taxa using taxonomic identifiers
</p>
</li>
<li> <p><code><a href="#topic+show_all">show_all()</a></code> &amp; <code><a href="#topic+search_all">search_all()</a></code> Data for generating filter queries
</p>
</li>
<li> <p><code><a href="#topic+show_values">show_values()</a></code> &amp; <code><a href="#topic+search_values">search_values()</a></code> Show or search for values <em>within</em>
<code>fields</code>, <code>profiles</code>, <code>lists</code>, <code>collections</code>, <code>datasets</code> or <code>providers</code>
</p>
</li></ul>

<p><strong>Configure session</strong>
</p>

<ul>
<li> <p><code><a href="#topic+galah_config">galah_config()</a></code> Package configuration options
</p>
</li></ul>

<p><strong>Cite</strong>
</p>

<ul>
<li> <p><code><a href="#topic+atlas_citation">atlas_citation()</a></code> Citation for a dataset
</p>
</li></ul>



<h3>Terminology</h3>

<p>To get the most value from <code>galah</code>, it is helpful to understand some
terminology. Each occurrence record contains taxonomic
information, and usually some information about the observation itself, such
as its location. In addition to this record-specific information, the living
atlases append contextual information to each record, particularly data from
spatial <strong>layers</strong> reflecting climate gradients or political boundaries. They
also run a number of quality checks against each record, resulting in
<strong>assertions</strong> attached to the record. Each piece of information
associated with a given occurrence record is stored in a <strong>field</strong>,
which corresponds to a <strong>column</strong> when imported to an
<code style="white-space: pre;">&#8288;R data.frame&#8288;</code>. See <code>show_all(fields)</code> to view valid fields,
layers and assertions, or conduct a search using <code>search_all(fields)</code>.
</p>
<p>Data fields are important because they provide a means to <strong>filter</strong>
occurrence records;  i.e. to return only the information that you need, and
no more. Consequently, much of the architecture of <code>galah</code> has been
designed to make filtering as simple as possible. The easiest way to do this
is to start a pipe with <code>galah_call()</code> and follow it with the relevant
<code>dplyr</code> function; starting with <code>filter()</code>, but also including <code>select()</code>,
<code>group_by()</code> or others. Functions without a relevant <code>dplyr</code> synonym include
<code><a href="#topic+galah_identify">galah_identify()</a></code>/<code>identify()</code> for choosing a taxon, or <code><a href="#topic+galah_geolocate">galah_geolocate()</a></code>/
<code>st_crop()</code> for choosing a specific location. By combining different filters,
it is possible to build complex queries to return only the most valuable
information for a given problem.
</p>
<p>A notable extension of the filtering approach is to remove records with low
'quality'. All living atlases perform quality control checks on all records
that they store. These checks are used to generate new fields, that can then
be used to filter out records that are unsuitable for particular applications.
However, there are many possible data quality checks, and it is not always
clear which are most appropriate in a given instance. Therefore, <code>galah</code>
supports data quality <strong>profiles</strong>, which can be passed to
<code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code> to quickly remove undesirable records. A full list of
data quality profiles is returned by <code>show_all(profiles)</code>. Note this service
is currently only available for the Australian atlas (ALA).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Martin Westgate <a href="mailto:martin.westgate@csiro.au">martin.westgate@csiro.au</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Matilda Stevenson
</p>
</li>
<li><p> Dax Kellie <a href="mailto:dax.kellie@csiro.au">dax.kellie@csiro.au</a>
</p>
</li>
<li><p> Peggy Newman <a href="mailto:peggy.newman@csiro.au">peggy.newman@csiro.au</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://galah.ala.org.au/R/">https://galah.ala.org.au/R/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/AtlasOfLivingAustralia/galah-R/issues">https://github.com/AtlasOfLivingAustralia/galah-R/issues</a>
</p>
</li></ul>


<hr>
<h2 id='arrange.data_request'>Arrange rows of a query</h2><span id='topic+arrange.data_request'></span><span id='topic+arrange.metadata_request'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p><code>arrange.data_request()</code> arranges rows of a query on the server side, meaning
that prior to sending a query, the query is constructed in such a way that
information will be arranged when the query is processed. Any data that is
then returned by the query will have rows already pre-arranged.
</p>
<p>The benefit of using <code>arrange()</code> within a <code>galah_call()</code> is that it is faster
to process arranging rows on the server side than arranging rows locally on
downloaded data,
especially if the dataset is large or complex.
</p>
<p><code>arrange()</code> can be used within a <code>galah_call()</code> pipe, but only
for queries of  <code>type = "occurrences-count"</code>. The <code>galah_call()</code> pipe must
include <code>count()</code> and finish with <code>collect()</code> (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
arrange(.data, ...)

## S3 method for class 'metadata_request'
arrange(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrange.data_request_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>data_request</code></p>
</td></tr>
<tr><td><code id="arrange.data_request_+3A_...">...</code></td>
<td>
<p>Either <code>count</code> or <code>index</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 

# Arrange grouped counts by ascending year
galah_call() |&gt;
  identify("Crinia") |&gt;
  filter(year &gt;= 2020) |&gt;
  group_by(year) |&gt;
  arrange(year) |&gt;
  count() |&gt;
  collect()
  
# Arrange grouped counts by ascending record count
galah_call() |&gt;
  identify("Crinia") |&gt;
  filter(year &gt;= 2020) |&gt;
  group_by(year) |&gt;
  arrange(count) |&gt;
  count() |&gt;
  collect()

# Arrange grouped counts by descending year
galah_call() |&gt;
  identify("Crinia") |&gt;
  filter(year &gt;= 2020) |&gt;
  group_by(year) |&gt;
  arrange(desc(year)) |&gt;
  count() |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_citation'>Generate a citation for occurrence data</h2><span id='topic+atlas_citation'></span>

<h3>Description</h3>

<p>If a <code>data.frame</code> was generated using <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>,
and the <code>mint_doi</code> argument was set to <code>TRUE</code>, the DOI associated
with that dataset is appended to the resulting <code>data.frame</code> as an
attribute. This function simply formats that DOI as a citation that can be
included in a scientific publication. Please also consider citing this
package, using the information in <code>citation("galah")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_citation(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_citation_+3A_data">data</code></td>
<td>
<p>data.frame: occurrence data generated by
<code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string containing the citation for that dataset.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
atlas_citation(doi)

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_counts'>Return a count of records</h2><span id='topic+atlas_counts'></span><span id='topic+count.data_request'></span>

<h3>Description</h3>

<p>Prior to downloading data it is often valuable to have some estimate of how
many records are available, both for deciding if the query is feasible,
and for estimating how long it will take to download. Alternatively, for some kinds
of reporting, the count of observations may be all that is required, for example
for understanding how observations are growing or shrinking in particular
locations, or for particular taxa. To this end, <code>atlas_counts()</code> takes
arguments in the same format as <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>, and
provides either a total count of records matching the criteria, or a
<code>data.frame</code> of counts matching the criteria supplied to the <code>group_by</code>
argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_counts(
  request = NULL,
  identify = NULL,
  filter = NULL,
  geolocate = NULL,
  data_profile = NULL,
  group_by = NULL,
  limit = NULL,
  type = c("occurrences", "species")
)

## S3 method for class 'data_request'
count(x, ..., wt, sort, name)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_counts_+3A_request">request</code></td>
<td>
<p>optional <code>data_request</code> object: generated by a call to
<code><a href="#topic+galah_call">galah_call()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_identify">identify</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_identify">galah_identify()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_filter">filter</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_filter">galah_filter()</a></code></p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_geolocate">geolocate</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code></p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_data_profile">data_profile</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code></p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_group_by">group_by</code></td>
<td>
<p><code>data.frame</code>: An object of class <code>galah_group_by</code>,
as returned by <code><a href="#topic+galah_group_by">galah_group_by()</a></code>. Alternatively a vector of field
names (see <code>search_all(fields)</code> and <code>show_all(fields)</code>.</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_limit">limit</code></td>
<td>
<p><code>numeric</code>: maximum number of categories to return, defaulting to 100.
If limit is NULL, all results are returned. For some categories this will
take a while.</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_type">type</code></td>
<td>
<p><code>string</code>: one of <code>c("occurrences-count", "species-count")</code>.
Defaults to <code>"occurrences-count"</code>, which returns the number of records
that match the selected criteria; alternatively returns the number of
species. Formerly accepted arguments (<code>"records"</code> or <code>"species"</code>) are
deprecated but remain functional.</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_x">x</code></td>
<td>
<p>An object of class <code>data_request</code>, created using <code><a href="#topic+galah_call">galah_call()</a></code></p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_...">...</code></td>
<td>
<p>currently ignored</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_wt">wt</code></td>
<td>
<p>currently ignored</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_sort">sort</code></td>
<td>
<p>currently ignored</p>
</td></tr>
<tr><td><code id="atlas_counts_+3A_name">name</code></td>
<td>
<p>currently ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble) returning:
</p>

<ul>
<li><p> A single number, if <code>group_by</code> is not specified or,
</p>
</li>
<li><p> A summary of counts grouped by field(s), if <code>group_by</code> is specified
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# classic syntax:
galah_call() |&gt;
  galah_filter(year == 2015) |&gt;
  atlas_counts()

# synonymous with:
request_data() |&gt;
  filter(year == 2015) |&gt;
  count() |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_media'>Get metadata on images, sounds and videos</h2><span id='topic+atlas_media'></span>

<h3>Description</h3>

<p>In addition to text data describing individual occurrences and their
attributes, ALA stores images, sounds and videos associated with a given
record. <code>atlas_media</code> displays metadata for any and all of the media types.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_media(
  request = NULL,
  identify = NULL,
  filter = NULL,
  select = NULL,
  geolocate = NULL,
  data_profile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_media_+3A_request">request</code></td>
<td>
<p>optional <code>data_request</code> object: generated by a call to
<code><a href="#topic+galah_call">galah_call()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_media_+3A_identify">identify</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_identify">galah_identify()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_media_+3A_filter">filter</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_filter">galah_filter()</a></code></p>
</td></tr>
<tr><td><code id="atlas_media_+3A_select">select</code></td>
<td>
<p><code>list</code>: generated by a call to <code><a href="#topic+galah_select">galah_select()</a></code></p>
</td></tr>
<tr><td><code id="atlas_media_+3A_geolocate">geolocate</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code></p>
</td></tr>
<tr><td><code id="atlas_media_+3A_data_profile">data_profile</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code><a href="#topic+atlas_media">atlas_media()</a></code> works by first finding all occurrence records
matching the filter which contain media, then downloading the metadata for the
media. To actually download the files themselves, use <code><a href="#topic+collect_media">collect_media()</a></code>.
It may be beneficial when requesting a large number of records to show a progress
bar by setting <code>verbose = TRUE</code> in <code><a href="#topic+galah_config">galah_config()</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble)
of metadata of the requested media.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+atlas_counts">atlas_counts()</a></code> to find the number of records with media; but note this
is not necessarily the same as the number of media files, as each record can have
more than one media file associated with it (see examples section for how to do this).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Download Regent Honeyeater records with multimedia attached
galah_call() |&gt;
  galah_identify("Regent Honeyeater") |&gt;
  galah_filter(year == 2011) |&gt;
  atlas_media()

# Download multimedia
galah_call() |&gt;
  galah_identify("Regent Honeyeater") |&gt;
  galah_filter(year == 2011) |&gt;
  atlas_media() |&gt;
  collect_media(path = "folder/your-directory")

# Specify a single media type to download
galah_call() |&gt;
  galah_identify("Eolophus Roseicapilla") |&gt;
  galah_filter(multimedia == "Sound") |&gt;
  atlas_media()

# It's good to check how many records have media files before downloading
galah_call() |&gt;
  galah_filter(multimedia == c("Image", "Sound", "Video")) |&gt;
  galah_group_by(multimedia) |&gt;
  atlas_counts()
  
  
# post version 2.0, it is possible to run all steps in sequence
# first, get occurrences, making sure to include media fields:
occurrences_df &lt;- request_data() |&gt;
  identify("Regent Honeyeater") |&gt;
  filter(!is.na(images), year == 2011) |&gt;
  select(group = "media") |&gt;
  collect()
 
# second, get media metadata
media_info &lt;- request_metadata() |&gt;
  filter(media == occurrences_df) |&gt;
  collect()
  
# the two steps above + `right_join()` are synonmous with `atlas_media()`
# third, get images
request_files() |&gt;
  filter(media == media_df) |&gt;
  collect(thumbnail = TRUE)
  
# step three is synonymous with `collect_media()`

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_occurrences'>Collect a set of occurrences</h2><span id='topic+atlas_occurrences'></span>

<h3>Description</h3>

<p>The most common form of data stored by living atlases are observations of
individual life forms, known as 'occurrences'. This function allows the
user to search for occurrence records that match their specific criteria,
and return them as a <code>tibble</code> for analysis. Optionally,
the user can also request a DOI for a given download to facilitate citation
and re-use of specific data resources.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_occurrences(
  request = NULL,
  identify = NULL,
  filter = NULL,
  geolocate = NULL,
  data_profile = NULL,
  select = NULL,
  mint_doi = FALSE,
  doi = NULL,
  file = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_occurrences_+3A_request">request</code></td>
<td>
<p>optional <code>data_request</code> object: generated by a call to
<code><a href="#topic+galah_call">galah_call()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_identify">identify</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_identify">galah_identify()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_filter">filter</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_filter">galah_filter()</a></code></p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_geolocate">geolocate</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code></p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_data_profile">data_profile</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code></p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_select">select</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_select">galah_select()</a></code></p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_mint_doi">mint_doi</code></td>
<td>
<p><code>logical</code>: by default no DOI will be generated. Set to
<code>TRUE</code> if you intend to use the data in a publication or similar.</p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_doi">doi</code></td>
<td>
<p><code>string</code>: (optional) DOI to download. If provided overrides
all other arguments. Only available for the ALA.</p>
</td></tr>
<tr><td><code id="atlas_occurrences_+3A_file">file</code></td>
<td>
<p><code>string</code>: (Optional) file name. If not given, will be set to
<code>data</code> with date and time added. The file path (directory) is always given by
<code>galah_config()$package$directory</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that unless care is taken, some queries can be particularly large.
While most cases this will simply take a long time to process, if the number
of requested records is &gt;50 million, the call will not return any data. Users
can test whether this threshold will be reached by first calling
<code><a href="#topic+atlas_counts">atlas_counts()</a></code> using the same arguments that they intend to pass to
<code>atlas_occurrences()</code>. It may also be beneficial when requesting a large
number of records to show a progress bar by setting <code>verbose = TRUE</code> in
<code><a href="#topic+galah_config">galah_config()</a></code>, or to use <code>compute()</code> to run the call before collecting
it later with <code>collect()</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble) of
occurrences, containing columns as specified by <code><a href="#topic+galah_select">galah_select()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Download occurrence records for a specific taxon
galah_config(email = "your_email_here")
galah_call() |&gt;
  galah_identify("Reptilia") |&gt;
  atlas_occurrences()

# Download occurrence records in a year range
galah_call() |&gt;
  galah_identify("Litoria") |&gt;
  galah_filter(year &gt;= 2010 &amp; year &lt;= 2020) |&gt;
  atlas_occurrences()
  
# Or identically with alternative syntax
request_data() |&gt;
  identify("Litoria") |&gt;
  filter(year &gt;= 2010 &amp; year &lt;= 2020) |&gt;
  collect()
  
# Download occurrences records in a WKT-specified area
polygon &lt;- "POLYGON((146.24960 -34.05930,
                     146.37045 -34.05930,
                     146.37045 -34.152549,
                     146.24960 -34.15254,
                     146.24960 -34.05930))"
galah_call() |&gt; 
  galah_identify("Reptilia") |&gt;
  galah_filter(year &gt;= 2010, year &lt;= 2020) |&gt;
  galah_geolocate(polygon) |&gt;
  atlas_occurrences()
  

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_species'>Collect the set of species observed within the specified filters</h2><span id='topic+atlas_species'></span>

<h3>Description</h3>

<p>While there are reasons why users may need to check every record meeting their
search criteria (i.e. using <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>), a common use case
is to simply identify which species occur in a specified region, time period,
or taxonomic group. This function returns a <code>data.frame</code> with one row
per species, and columns giving associated taxonomic information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_species(
  request = NULL,
  identify = NULL,
  filter = NULL,
  geolocate = NULL,
  data_profile = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_species_+3A_request">request</code></td>
<td>
<p>optional <code>data_request</code> object: generated by a call to
<code><a href="#topic+galah_call">galah_call()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_species_+3A_identify">identify</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_identify">galah_identify()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_species_+3A_filter">filter</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_filter">galah_filter()</a></code></p>
</td></tr>
<tr><td><code id="atlas_species_+3A_geolocate">geolocate</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code></p>
</td></tr>
<tr><td><code id="atlas_species_+3A_data_profile">data_profile</code></td>
<td>
<p><code>string</code>: generated by a call to
<code><a href="#topic+galah_apply_profile">galah_apply_profile()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The primary use case of this function is to extract species-level information
given a set of criteria defined by <code><a href="#topic+search_taxa">search_taxa()</a></code>,
<code><a href="#topic+galah_filter">galah_filter()</a></code> or <code><a href="#topic+galah_geolocate">galah_geolocate()</a></code>. If the purpose
is simply to get taxonomic information that is not restricted by filtering,
then <code><a href="#topic+search_taxa">search_taxa()</a></code> is more efficient. Similarly, if counts are
required that include filter but without returning taxonomic detail, then
<code><a href="#topic+atlas_counts">atlas_counts()</a></code> is more efficient (see examples).
</p>


<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble),
returning matching species The <code>data.frame</code> object has attributes listing of
the user-supplied arguments of the <code>data_request</code>
(i.e., identify, filter, geolocate, columns)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# First register a valid email address
galah_config(email = "ala4r@ala.org.au")

# Get a list of species within genus "Heleioporus"
# (every row is a species with associated taxonomic data)
galah_call() |&gt;
  galah_identify("Heleioporus") |&gt;
  atlas_species()

# Get a list of species within family "Peramelidae"
galah_call() |&gt;
  galah_identify("peramelidae") |&gt;
  atlas_species()
  
# Or alternatively
request_data(type = "species") |&gt;
  identify("peramelidae") |&gt;
  collect()

# It's good idea to find how many species there are before downloading
galah_call() |&gt;
  galah_identify("Heleioporus") |&gt;
  atlas_counts(type = "species")
# Or alternatively
request_data(type = "species") |&gt;
  identify("Heleioporus") |&gt;
  count() |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='atlas_taxonomy'>Search taxonomic trees</h2><span id='topic+atlas_taxonomy'></span>

<h3>Description</h3>

<p>The ALA has its' own internal taxonomy that is derived from authoritative
sources. <code>atlas_taxonomy</code> provides a means to query
that taxonomy, returning a <code>tibble</code> showing all child nodes and which parent
they are derived from.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>atlas_taxonomy(
  request = NULL,
  identify = NULL,
  filter = NULL,
  constrain_ids = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="atlas_taxonomy_+3A_request">request</code></td>
<td>
<p>optional <code>data_request</code> object: generated by a call to
<code><a href="#topic+galah_call">galah_call()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_taxonomy_+3A_identify">identify</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code><a href="#topic+galah_identify">galah_identify()</a></code>.</p>
</td></tr>
<tr><td><code id="atlas_taxonomy_+3A_filter">filter</code></td>
<td>
<p><code>data.frame</code>: generated by a call to
<code>galah_filter(rank == "chosen_rank")</code>. The
identity of the clade at which the downwards search should stop.</p>
</td></tr>
<tr><td><code id="atlas_taxonomy_+3A_constrain_ids">constrain_ids</code></td>
<td>
<p><code>string</code>: Optional string to limit which <code>taxon_concept_id</code>'s
are returned. This is useful for restricting taxonomy to particular
authoritative sources. Default is <code>"biodiversity.org.au"</code> for Australia
(this can be overridded by setting <code>constrain_ids = NULL</code>) and NULL otherwise.
Powered by <code>grepl()</code> meaning it supports regular expressions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The approach used by this function is recursive, meaning that it
becomes slow for large queries such as
<code>atlas_taxonomy(search_taxa("Plantae"), down_to = galah_down_to(species))</code>.
Although the inputs to <code>search_taxa</code> and <code>down_to</code> are
case-insensitive, node names are always returned in title case.
</p>


<h3>Value</h3>

<p>A <code>tibble</code> containing taxon names, ranks and parent/child IDs
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_taxa">search_taxa()</a></code> to search for an individual taxon;
<code>show_all(ranks)</code> for valid ranks used to specify the <code>down_to</code>
argument.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Get a taxonomic tree of *Chordata* down to the class level
galah_call() |&gt; 
  galah_identify("chordata") |&gt;
  galah_filter(rank == class) |&gt;
  atlas_taxonomy()

## End(Not run)

</code></pre>

<hr>
<h2 id='collapse_galah'>Generate a query</h2><span id='topic+collapse_galah'></span><span id='topic+collapse.data_request'></span><span id='topic+collapse.metadata_request'></span><span id='topic+collapse.files_request'></span>

<h3>Description</h3>

<p><code>collapse()</code> constructs a valid query so it can be
inspected before being sent. It typically occurs at the end of a pipe,
traditionally begun with <code>galah_call()</code>, that is used to define a query.
As of version 2.0, objects of class <code>data_request</code> (created using
<code>request_data()</code>), <code>metadata_request</code> (from <code>request_metadata()</code>) or
<code>files_request</code> (from <code>request_files()</code>) are all supported by <code>collapse()</code>.
Any of these objects can be created using <code>galah_call()</code> via the <code>method</code>
argument.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
collapse(x, ..., mint_doi, .expand = FALSE)

## S3 method for class 'metadata_request'
collapse(x, .expand = FALSE, ...)

## S3 method for class 'files_request'
collapse(x, thumbnail = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collapse_galah_+3A_x">x</code></td>
<td>
<p>An object of class <code>data_request</code>, <code>metadata_request</code> or
<code>files_request</code></p>
</td></tr>
<tr><td><code id="collapse_galah_+3A_...">...</code></td>
<td>
<p>Arguments passed on to other methods</p>
</td></tr>
<tr><td><code id="collapse_galah_+3A_mint_doi">mint_doi</code></td>
<td>
<p>Logical: should a DOI be minted for this download? Only
applies to <code>type = "occurrences"</code> when atlas chosen is &quot;ALA&quot;.</p>
</td></tr>
<tr><td><code id="collapse_galah_+3A_.expand">.expand</code></td>
<td>
<p>Logical: should the <code>query_set</code> be returned? This object
shows all the requisite data needed to process the supplied query. Defaults
to <code>FALSE</code>; if <code>TRUE</code> will append the <code>query_set</code> to an extra slot in the
<code>query</code> object.</p>
</td></tr>
<tr><td><code id="collapse_galah_+3A_thumbnail">thumbnail</code></td>
<td>
<p>Logical: should thumbnail-size images be returned? Defaults
to <code>FALSE</code>, indicating full-size images are required.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>query</code>, which is a list-like object containing at
least the slots <code>type</code> and <code>url</code>.
</p>

<hr>
<h2 id='collect_galah'>Retrieve a database query</h2><span id='topic+collect_galah'></span><span id='topic+collect.data_request'></span><span id='topic+collect.metadata_request'></span><span id='topic+collect.files_request'></span><span id='topic+collect.query'></span><span id='topic+collect.computed_query'></span>

<h3>Description</h3>

<p><code>collect()</code> attempts to retrieve the result of a query from the
selected API.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
collect(x, ..., wait = TRUE, file = NULL)

## S3 method for class 'metadata_request'
collect(x, ...)

## S3 method for class 'files_request'
collect(x, ...)

## S3 method for class 'query'
collect(x, ..., wait = TRUE, file = NULL)

## S3 method for class 'computed_query'
collect(x, ..., wait = TRUE, file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collect_galah_+3A_x">x</code></td>
<td>
<p>An object of class <code>data_request</code>, <code>metadata_request</code> or
<code>files_request</code> (from <code>galah_call()</code>); or an object of class <code>query_set</code> or
<code>query</code> (from <code>collapse()</code> or <code>compute()</code>)</p>
</td></tr>
<tr><td><code id="collect_galah_+3A_...">...</code></td>
<td>
<p>Arguments passed on to other methods</p>
</td></tr>
<tr><td><code id="collect_galah_+3A_wait">wait</code></td>
<td>
<p>logical; should <code>galah</code> wait for a response? Defaults to FALSE.
Only applies for <code>type = "occurrences"</code> or <code>"species"</code>.</p>
</td></tr>
<tr><td><code id="collect_galah_+3A_file">file</code></td>
<td>
<p>(Optional) file name. If not given, will be set to <code>data</code> with
date and time added. The file path (directory) is always given by
<code>galah_config()$package$directory</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>In most cases, <code>collect()</code> returns a <code>tibble</code> containing requested
data. Where the requested data are not yet ready (i.e. for occurrences when
<code>wait</code> is set to <code>FALSE</code>), this function returns an object of class <code>query</code>
that can be used to recheck the download at a later time.
</p>

<hr>
<h2 id='collect_media'>Collect media files</h2><span id='topic+collect_media'></span>

<h3>Description</h3>

<p>This function downloads full-sized or thumbnail images and media files using
information from <code>atlas_media</code> to a local directory.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>collect_media(df, thumbnail = FALSE, path)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="collect_media_+3A_df">df</code></td>
<td>
<p><code>tibble</code>: returned by <code>atlas_media()</code> or a pipe starting with
<code>request_data(type = "media")</code>.</p>
</td></tr>
<tr><td><code id="collect_media_+3A_thumbnail">thumbnail</code></td>
<td>
<p><code>logical</code>: If <code>TRUE</code> will download small thumbnail-sized
images, rather than full size images (default).</p>
</td></tr>
<tr><td><code id="collect_media_+3A_path">path</code></td>
<td>
<p><code>string</code>:
<a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
Use <code style="white-space: pre;">&#8288;galah_config(directory = "path-to-directory)"&#8288;</code> instead. Supply a path
to a local folder/directory where downloaded media will be saved to.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisibly returns a <code>tibble</code> listing the number of files downloaded,
grouped by their HTML status codes. Primarily called for the side effect of
downloading available image &amp; media files to a user local directory.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Use `atlas_media()` to return a `tibble` of records that contain media
x &lt;- galah_call() |&gt; 
  galah_identify("perameles") |&gt;
  galah_filter(year == 2015) |&gt;
  atlas_media()

# To download media files, add `collect_media()` to the end of a query 
galah_config(directory = "media_files")
collect_media(x)

## End(Not run)
</code></pre>

<hr>
<h2 id='compute_galah'>Compute a query</h2><span id='topic+compute_galah'></span><span id='topic+compute.data_request'></span><span id='topic+compute.metadata_request'></span><span id='topic+compute.files_request'></span><span id='topic+compute.query'></span>

<h3>Description</h3>

<p><code>compute()</code> is useful for several purposes. It's original
purpose is to send a request for data, which can then be processed by the
server and retrieved at a later time (via <code>collect()</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
compute(x, ...)

## S3 method for class 'metadata_request'
compute(x, ...)

## S3 method for class 'files_request'
compute(x, ...)

## S3 method for class 'query'
compute(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_galah_+3A_x">x</code></td>
<td>
<p>An object of class <code>data_request</code>, <code>metadata_request</code> or
<code>files_request</code> (i.e. constructed using a pipe) or <code>query</code>
(i.e. constructed by <code>collapse()</code>)</p>
</td></tr>
<tr><td><code id="compute_galah_+3A_...">...</code></td>
<td>
<p>Arguments passed on to other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>computed_query</code>, which is identical to class
<code>query</code> except for occurrence data, where it also contains information on the
status of the request.
</p>

<hr>
<h2 id='galah_apply_profile'>Apply a data quality profile</h2><span id='topic+galah_apply_profile'></span><span id='topic+apply_profile'></span>

<h3>Description</h3>

<p>A 'profile' is a group of filters that are pre-applied by the ALA. Using a
data profile allows a query to be filtered quickly to the most relevant or
quality-assured data that is fit-for-purpose. For example, the &quot;ALA&quot; profile
is designed to exclude lower quality records, whereas other profiles apply
filters specific to species distribution modelling (e.g. CDSM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_apply_profile(...)

apply_profile(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_apply_profile_+3A_...">...</code></td>
<td>
<p>a profile name. Should be a <code>string</code> - the name or abbreviation
of a data quality profile to apply to the query. Valid values can be seen
using <code>show_all(profiles)</code></p>
</td></tr>
<tr><td><code id="galah_apply_profile_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>data_request</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that only one profile can be loaded at a time; if multiple profiles are
given, the first valid profile is used.
</p>
<p>For more bespoke editing of filters within a profile, use <code><a href="#topic+galah_filter">galah_filter()</a></code>
</p>


<h3>Value</h3>

<p>A tibble containing a valid data profile value.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+show_all">show_all()</a></code> and <code><a href="#topic+search_all">search_all()</a></code> to look up available data profiles.
<code><a href="#topic+galah_filter">galah_filter()</a></code> can be used for more bespoke editing of individual data
profile filters.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Apply a data quality profile to a query
galah_call() |&gt; 
  galah_identify("reptilia") |&gt;
  galah_filter(year == 2021) |&gt;
  galah_apply_profile(ALA) |&gt;
  atlas_counts()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_call'>Start building a query</h2><span id='topic+galah_call'></span><span id='topic+request_data'></span><span id='topic+request_metadata'></span><span id='topic+request_files'></span>

<h3>Description</h3>

<p>To download data from the selected atlas, one must construct a query. This
query tells the atlas API what data to download and return, as well as how it
should be filtered. Using <code>galah_call()</code> allows you to build a piped query to
download data, in the same way that you would wrangle data with <code>dplyr</code> and
the <code>tidyverse</code>.
</p>
<p>Since version 2.0, <code>galah_call()</code> is a wrapper to a group of underlying
<code>request_</code> functions. Each of these functions can begin a piped query and end
with <code>collapse()</code>, <code>compute()</code> or <code>collect()</code>.
</p>
<p>The underlying <code>request_</code> #' functions are useful because they allow <code>galah</code>
to separate different types of requests to perform better. For example,
<code>filter.data_request</code> translates filters in R to <code>solr</code>, whereas
<code>filter.metadata_request</code> searches using a search term.
</p>
<p>For more details see the object-oriented programming vignette:
<code>vignette("object_oriented_programming", package = "galah")</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_call(method = c("data", "metadata", "files"), type, ...)

request_data(
  type = c("occurrences", "occurrences-count", "occurrences-doi", "species",
    "species-count"),
  ...
)

request_metadata(type)

request_files(type = "media")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_call_+3A_method">method</code></td>
<td>
<p>string: what <code>request</code> function should be called. Should be one
of <code>"data"</code> (default), <code>"metadata"</code> or <code>"files"</code></p>
</td></tr>
<tr><td><code id="galah_call_+3A_type">type</code></td>
<td>
<p>string: what form of data should be returned? Acceptable values
are specified by the corresponding <code>request</code> function</p>
</td></tr>
<tr><td><code id="galah_call_+3A_...">...</code></td>
<td>
<p>Zero or more arguments to alter a query. See 'details'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each atlas has several types of data that can be chosen. Currently supported
are <code>"occurrences"</code> (the default), <code>"species"</code> and <code>"media"</code> (the latter
currently only for ALA). It is also possible to use
<code>type = "occurrences-count"</code> and <code>type = "species-count"</code>; but in practice
this is synonymous with <code>galah_call() |&gt; count()</code>, and is
therefore only practically useful for debugging (via <code>collapse()</code> and
<code>compute()</code>).
</p>
<p>Other named arguments are supported via <code>...</code>. In practice, functions
with a <code>galah_</code> prefix and S3 methods ported from <code>dplyr</code> assign
information to the correct slots internally. Overwriting these with
user-defined alternatives is possible, but not advised. Accepted
arguments are:
</p>

<ul>
<li> <p><code>filter</code> (accepts <code>galah_filter()</code> or <code><a href="#topic+filter.data_request">filter()</a></code>)
</p>
</li>
<li> <p><code>select</code> (accepts <code>galah_select()</code> or <code><a href="#topic+filter.data_request">select</a></code>)
</p>
</li>
<li> <p><code>group_by</code> (accepts <code>galah_group_by()</code> or <code><a href="#topic+group_by.data_request">group_by()</a></code>)
</p>
</li>
<li> <p><code>identify</code> (accepts <code>galah_identify()</code> or <code><a href="#topic+identify.data_request">identify()</a></code>)
</p>
</li>
<li> <p><code>geolocate</code> (accepts <code>galah_geolocate()</code>, <code>galah_polygon()</code> <code>galah_bbox()</code> or
<code><a href="#topic+st_crop.data_request">st_crop()</a></code>)
</p>
</li>
<li> <p><code>limit</code> (accepts <code><a href="#topic+slice_head.data_request">slice_head()</a></code>)
</p>
</li>
<li> <p><code>doi</code> (accepts a sting listing a valid DOI, specific to <code>collect()</code> when <code>type = "doi"</code>)
</p>
</li></ul>

<p>Unrecognised names are ignored by <code>collect()</code> and related functions.
</p>


<h3>Value</h3>

<p>Each sub-function returns a different object class: <code>request_data()</code>
returns <code>data_request</code>. <code>request_metadata</code> returns <code>metadata_request</code>,
<code>request_files()</code> returns <code>files_request</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+collapse.data_request">collapse.data_request()</a></code>, <code><a href="#topic+compute.data_request">compute.data_request()</a></code>, <code><a href="#topic+collect.data_request">collect.data_request()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  
# Begin your query with `galah_call()`, then pipe using `%&gt;%` or `|&gt;`

# Get number of records of *Aves* from 2001 to 2004 by year
galah_call() |&gt;
  galah_identify("Aves") |&gt;
  galah_filter(year &gt; 2000 &amp; year &lt; 2005) |&gt;
  galah_group_by(year) |&gt;
  atlas_counts()
  
# Get information for all species in *Cacatuidae* family
galah_call() |&gt;
  galah_identify("Cacatuidae") |&gt;
  atlas_species()
  
# Download records of genus *Eolophus* from 2001 to 2004
galah_config(email = "your-email@email.com")

galah_call() |&gt;
  galah_identify("Eolophus") |&gt;
  galah_filter(year &gt; 2000 &amp; year &lt; 2005) |&gt;
  atlas_occurrences()


# ----------
# Since galah 2.0.0, a pipe can start with a `request_` function.
# This allows users to use `collapse()`, `compute()` and `collect()`.

# Get number of records of *Aves* from 2001 to 2004 by year
request_data(type = "occurrences-count") |&gt;
  galah_identify("Aves") |&gt;
  galah_filter(year &gt; 2000 &amp; year &lt; 2005) |&gt;
  galah_group_by(year) |&gt;
  collect()

# Get information for all species in *Cacatuidae* family
request_data(type = "species") |&gt;
  galah_identify("Cacatuidae") |&gt;
  collect()
  
# Get metadata information about supported atlases in galah
request_metadata(type = "atlases") |&gt;
  collect()


## End(Not run)
</code></pre>

<hr>
<h2 id='galah_config'>Get or set configuration options that control galah behaviour</h2><span id='topic+galah_config'></span>

<h3>Description</h3>

<p>The <code>galah</code> package supports large data downloads, and also
interfaces with the ALA which requires that users of some services
provide a registered email address and reason for downloading data. The
<code>galah_config</code> function provides a way to manage these issues as simply
as possible.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_config(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_config_+3A_...">...</code></td>
<td>
<p>Options can be defined using the form <code>name = "value"</code>.
Valid arguments are:
</p>

<ul>
<li> <p><code>api-key</code> string: A registered API key (currently unused).
</p>
</li>
<li> <p><code>atlas</code> string: Living Atlas to point to, Australia by default. Can be
an organisation name, acronym, or region (see <code><a href="#topic+show_all_atlases">show_all_atlases()</a></code> for
admissible values)
</p>
</li>
<li> <p><code>directory</code> string: the directory to use for the cache.
By default this is a temporary directory, which means that results will
only be cached
within an R session and cleared automatically when the user exits R.
The user may wish to set this to a non-temporary directory for
caching across sessions. The directory must exist on the file system.
</p>
</li>
<li> <p><code>download_reason_id</code> numeric or string: the &quot;download reason&quot; required.
by some ALA services, either as a numeric ID (currently 0&ndash;13)
or a string (see <code>show_all(reasons)</code> for a list of valid ID codes and
names). By default this is NA. Some ALA services require a valid
download_reason_id code, either specified here or directly to the
associated R function.
</p>
</li>
<li> <p><code>email</code> string: An email address that has been registered with the chosen
atlas. For the ALA, you can register at
<a href="https://auth.ala.org.au/userdetails/registration/createAccount">this address</a>.
</p>
</li>
<li> <p><code>password</code> string: A registered password (GBIF only)
</p>
</li>
<li> <p><code>run_checks</code> logical: should <code>galah</code> run checks for filters
and columns. If making lots of requests sequentially, checks can slow down
the process and lead to HTTP 500 errors, so should be turned off. Defaults
to TRUE.
</p>
</li>
<li> <p><code>send_email</code> logical: should you receive an email for each query to
<code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>? Defaults to <code>FALSE</code>; but can be
useful in some instances, for example for tracking DOIs assigned to
specific downloads for later citation.
</p>
</li>
<li> <p><code>username</code> string: A registered username (GBIF only)
</p>
</li>
<li> <p><code>verbose</code> logical: should <code>galah</code> give verbose such as progress bars?
Defaults to FALSE.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>galah_config()</code>, a <code>list</code> of all options.
When <code>galah_config(...)</code> is called with arguments, nothing is returned
but the configuration is set.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# To download occurrence records, enter your email in `galah_config()`. 
# This email should be registered with the atlas in question. 
galah_config(email = "your-email@email.com")
 
# Turn on caching in your session
galah_config(caching = TRUE)
 
# Some ALA services require that you add a reason for downloading data. 
# Add your selected reason using the option `download_reason_id`
galah_config(download_reason_id = 0)

# To look up all valid reasons to enter, use `show_all(reasons)`
show_all(reasons)

# Make debugging in your session easier by setting `verbose = TRUE`
galah_config(verbose = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_down_to'>Deprecated functions</h2><span id='topic+galah_down_to'></span>

<h3>Description</h3>

<p>These include:
</p>

<ul>
<li> <p><code>galah_down_to()</code> in favour of <code>galah_filter()</code>
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>galah_down_to(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_down_to_+3A_...">...</code></td>
<td>
<p>the name of a single taxonomic rank</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A string with the named rank
</p>


<h3>See Also</h3>

<p><code><a href="#topic+galah_select">galah_select()</a></code>, <code><a href="#topic+galah_filter">galah_filter()</a></code> and
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code> for related methods.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Return a taxonomic tree of *Chordata* down to the class level
galah_call() |&gt;
    galah_identify("Vertebrata") |&gt;
    galah_down_to(class) |&gt;
    atlas_taxonomy()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_filter'>Narrow a query by specifying filters</h2><span id='topic+galah_filter'></span><span id='topic+filter.data_request'></span><span id='topic+filter.metadata_request'></span><span id='topic+filter.files_request'></span>

<h3>Description</h3>

<p>&quot;Filters&quot; are arguments of the form <code>field</code> <code>logical</code> <code>value</code> that are used
to narrow down the number of records returned by a specific query.
For example, it is common for users to request records from a particular year
(<code>year == 2020</code>), or to return all records except for fossils
(<code>basisOfRecord != "FossilSpecimen"</code>).
</p>
<p>The result of <code>galah_filter()</code> can be passed to the <code>filter</code>
argument in <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>, <code><a href="#topic+atlas_species">atlas_species()</a></code>,
<code><a href="#topic+atlas_counts">atlas_counts()</a></code> or <code><a href="#topic+atlas_media">atlas_media()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_filter(..., profile = NULL)

## S3 method for class 'data_request'
filter(.data, ...)

## S3 method for class 'metadata_request'
filter(.data, ...)

## S3 method for class 'files_request'
filter(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_filter_+3A_...">...</code></td>
<td>
<p>filters, in the form <code style="white-space: pre;">&#8288;field logical value&#8288;</code></p>
</td></tr>
<tr><td><code id="galah_filter_+3A_profile">profile</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
Use <code>galah_apply_profile</code> instead.</p>
</td></tr>
<tr><td><code id="galah_filter_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>files_request</code>, created using <code><a href="#topic+request_files">request_files()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>galah_filter</code> uses non-standard evaluation (NSE),
and is designed to be as compatible as possible with <code>dplyr::filter()</code>
syntax.
</p>
<p>All statements passed to <code>galah_filter()</code> (except the <code>profile</code>
argument) take the form of field - logical - value. Permissible examples include:
</p>

<ul>
<li> <p><code>=</code> or <code>==</code> (e.g. <code>year = 2020</code>)
</p>
</li>
<li> <p><code>!=</code>, e.g. <code>year != 2020</code>)
</p>
</li>
<li> <p><code>&gt;</code> or <code>&gt;=</code> (e.g. <code>year &gt;= 2020</code>)
</p>
</li>
<li> <p><code>&lt;</code> or <code>&lt;=</code> (e.g. <code>year &lt;= 2020</code>)
</p>
</li>
<li> <p><code>OR</code> statements (e.g. <code>year == 2018 | year == 2020</code>)
</p>
</li>
<li> <p><code>AND</code> statements (e.g. <code>year &gt;= 2000 &amp; year &lt;= 2020</code>)
</p>
</li></ul>

<p>In some cases <code>R</code> will fail to parse inputs with a single equals sign
(<code>=</code>), particularly where statements are separated by <code>&amp;</code> or
<code>|</code>. This problem can be avoided by using a double-equals (<code>==</code>) instead.
</p>
<p><em>Notes on behaviour</em>
</p>
<p>Separating statements with a comma is equivalent to an <code>AND</code> statement;
Ergo <code>galah_filter(year &gt;= 2010 &amp; year &lt; 2020)</code> is the same as
<code>galah_filter(year &gt;= 2010, year &lt; 2020)</code>.
</p>
<p>All statements must include the field name; so
<code>galah_filter(year == 2010 | year == 2021)</code> works, as does
<code>galah_filter(year == c(2010, 2021))</code>, but <code>galah_filter(year == 2010 | 2021)</code>
fails.
</p>
<p>It is possible to use an object to specify required values, e.g.
<code style="white-space: pre;">&#8288;year_value &lt;- 2010; galah_filter(year &gt; year_value)&#8288;</code>
</p>
<p><code>solr</code> supports range queries on text as well as numbers; so this is valid:
<code>galah_filter(cl22 &gt;= "Tasmania")</code>
</p>
<p>It is possible to filter by 'assertions', which are statements about data
validity, e.g. to remove those lacking critical spatial or taxonomic data:
<code style="white-space: pre;">&#8288;galah_filter(assertions != c("INVALID_SCIENTIFIC_NAME", "COORDINATE_INVALID")&#8288;</code>
Valid assertions can be found using <code>show_all(assertions)</code>.
</p>


<h3>Value</h3>

<p>A tibble containing filter values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_taxa">search_taxa()</a></code> and <code><a href="#topic+galah_geolocate">galah_geolocate()</a></code> for other ways to restrict
the information returned by <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code> and related functions. Use
<code>search_all(fields)</code> to find fields that
you can filter by, and <code><a href="#topic+show_values">show_values()</a></code> to find what values
of those filters are available.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Filter query results to return records of interest
galah_call() |&gt;
  galah_filter(year &gt;= 2019,
               basisOfRecord == "HumanObservation") |&gt;
  atlas_counts()

# Alternatively, the same call using `dplyr` functions:
request_data() |&gt;
  filter(year &gt;= 2019,
               basisOfRecord == "HumanObservation") |&gt;
  count() |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_geolocate'>Narrow a query to within a specified area</h2><span id='topic+galah_geolocate'></span><span id='topic+galah_bbox'></span><span id='topic+galah_polygon'></span><span id='topic+galah_radius'></span><span id='topic+st_crop.data_request'></span>

<h3>Description</h3>

<p>Restrict results to those from a specified area using <code>galah_geolocate()</code>.
Areas can be specified as either polygons or bounding boxes, depending on
<code>type</code>. Alternatively, users can call the underlying functions directly via
<code>galah_polygon()</code>, <code>galah_bbox()</code> or <code>galah_radius()</code>. It is possible to use <code>sf</code>
syntax by calling <code>st_crop()</code>, which is synonymous with <code>galah_polygon()</code>.
</p>
<p><strong>Use a polygon</strong>
If calling <code>galah_geolocate()</code>, the default <code>type</code> is <code>"polygon"</code>, which
narrows queries to within an area supplied as a <code>POLYGON</code> or <code>MULTIPOLYGON</code>.
Polygons must be
specified as either an <code>sf</code> object, a 'well-known text' (WKT) string, or a
shapefile. Shapefiles must be simple to be accepted by the ALA.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_geolocate(..., type = c("polygon", "bbox", "radius"))

galah_bbox(...)

galah_polygon(...)

galah_radius(...)

## S3 method for class 'data_request'
st_crop(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_geolocate_+3A_...">...</code></td>
<td>
<p>a single <code>sf</code> object, WKT string or shapefile. Bounding boxes can
be supplied as a <code>tibble</code>/<code>data.frame</code> or a <code>bbox</code></p>
</td></tr>
<tr><td><code id="galah_geolocate_+3A_type">type</code></td>
<td>
<p><code>string</code>: one of <code>c("polygon", "bbox")</code>. Defaults to
<code>"polygon"</code>. If <code>type = "polygon"</code>, a multipolygon will be built via
<code><a href="#topic+galah_polygon">galah_polygon()</a></code>. If <code>type = "bbox"</code>, a multipolygon will be built via
<code><a href="#topic+galah_bbox">galah_bbox()</a></code>. The multipolygon is used to narrow a query to the ALA.</p>
</td></tr>
<tr><td><code id="galah_geolocate_+3A_x">x</code></td>
<td>
<p>An object of class <code>data_request</code>, created using <code><a href="#topic+galah_call">galah_call()</a></code></p>
</td></tr>
<tr><td><code id="galah_geolocate_+3A_y">y</code></td>
<td>
<p>A valid Well-Known Text string (wkt), a <code>POLYGON</code> or a <code>MULTIPOLYGON</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Use a bounding box</strong>
Alternatively, set <code>type = "bbox"</code> to narrow queries to within a bounding
box. Bounding boxes can be extracted from a supplied <code>sf</code> object or
a shapefile. A bounding box can also be supplied as a <code>bbox</code> object
(via <code>sf::st_bbox()</code>) or a <code>tibble</code>/<code>data.frame</code>.
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
<strong>Use a point radius</strong>
Alternatively, set <code>type = "radius"</code> to narrow queries to within a circular
area around a specific point location. Point coordinates can be supplied as
latitude/longitude coordinate numbers or as an <code>sf</code> object (<code>sfc_POINT</code>).
Area is supplied as a <code>radius</code> in kilometres. Default radius is 10 km.
</p>
<p>If <code>type = "polygon"</code>, WKT strings longer than 10000 characters and
<code>sf</code> objects with more than 500 vertices will not be
accepted by the ALA. Some polygons  may need to be simplified.
If <code>type = "bbox"</code>, sf objects and shapefiles will be converted to a bounding
box to query the ALA.
If <code style="white-space: pre;">&#8288;type = "radius&#8288;</code>, <code>sfc_POINT</code> objects will be converted to lon/lat
coordinate numbers to query the ALA. Default radius is 10 km.
</p>


<h3>Value</h3>

<p>If <code>type = "polygon"</code> or <code>type = "bbox"</code>,
length-1 string (class <code>character</code>) containing a multipolygon WKT
string representing the area provided.
If <code>type = "radius"</code>,
<code>list</code> of <code>lat</code>, <code>long</code> and <code>radius</code> values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Search for records within a polygon using a shapefile
location &lt;- sf::st_read("path/to/shapefile.shp")
galah_call() |&gt;
  galah_identify("vulpes") |&gt;
  galah_geolocate(location) |&gt;
  atlas_counts()
  
# Search for records within the bounding box of a shapefile
location &lt;- sf::st_read("path/to/shapefile.shp")
galah_call() |&gt;
  galah_identify("vulpes") |&gt;
  galah_geolocate(location, type = "bbox") |&gt;
  atlas_counts()

# Search for records within a polygon using an `sf` object
location &lt;- "POLYGON((142.3 -29.0,142.7 -29.1,142.7 -29.4,142.3 -29.0))" |&gt;
 sf::st_as_sfc()
galah_call() |&gt;
  galah_identify("reptilia") |&gt;
  galah_polygon(location) |&gt;
  atlas_counts()
  
# Alternatively, we can use `st_crop()` as a synonym for `galah_polygon()`. 
# Hence the above example can be rewritten as:
request_data() |&gt;
  identify("reptilia") |&gt;
  st_crop(location) |&gt;
  count() |&gt;
  collect()
   
# Search for records using a Well-known Text string (WKT)
wkt &lt;- "POLYGON((142.3 -29.0,142.7 -29.1,142.7 -29.4,142.3 -29.0))"
galah_call() |&gt;
  galah_identify("vulpes") |&gt;
  galah_geolocate(wkt) |&gt;
  atlas_counts()

# Search for records within the bounding box extracted from an `sf` object
location &lt;- "POLYGON((142.3 -29.0,142.7 -29.1,142.7 -29.4,142.3 -29.0))" |&gt;
  sf::st_as_sfc()
galah_call() |&gt;
  galah_identify("vulpes") |&gt;
  galah_geolocate(location, type = "bbox") |&gt;
  atlas_counts()

# Search for records using a bounding box of coordinates
b_box &lt;- sf::st_bbox(c(xmin = 143, xmax = 148, ymin = -29, ymax = -28), 
                     crs = sf::st_crs("WGS84"))
galah_call() |&gt;
  galah_identify("reptilia") |&gt;
  galah_geolocate(b_box, type = "bbox") |&gt;
  atlas_counts()

# Search for records using a bounding box in a `tibble` or `data.frame`
b_box &lt;- tibble::tibble(xmin = 148, ymin = -29, xmax = 143, ymax = -21)
galah_call() |&gt;
  galah_identify("vulpes") |&gt;
  galah_geolocate(b_box, type = "bbox") |&gt;
  atlas_counts()

# Search for records within a radius around a point's coordinates
galah_call() |&gt;
  galah_identify("manorina melanocephala") |&gt;
  galah_geolocate(lat = -33.7,
                  lon = 151.3,
                  radius = 5,
                  type = "radius") |&gt;
  atlas_counts()

# Search for records with a radius around an `sf_POINT` object
point &lt;- sf::st_sfc(sf::st_point(c(-33.66741, 151.3174)), crs = 4326)
galah_call() |&gt;
  galah_identify("manorina melanocephala") |&gt;
  galah_geolocate(point,
                  radius = 5,
                  type = "radius") |&gt;
  atlas_counts()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_group_by'>Specify fields to group when downloading record counts</h2><span id='topic+galah_group_by'></span><span id='topic+group_by.data_request'></span>

<h3>Description</h3>

<p><code>count.data_request()</code> and <code>atlas_counts()</code> support server-side grouping of
data. Grouping can be used to return record counts grouped by multiple, valid
fields (found by <code>search_all(fields)</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_group_by(...)

## S3 method for class 'data_request'
group_by(.data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_group_by_+3A_...">...</code></td>
<td>
<p>zero or more individual column names to include</p>
</td></tr>
<tr><td><code id="galah_group_by_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>data_request</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>If any arguments are provided, returns a <code>data.frame</code> with
columns <code>name</code> and <code>type</code>, as per <code><a href="#topic+select.data_request">select.data_request()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
galah_call() |&gt; 
  galah_group_by(basisOfRecord) |&gt;
  atlas_counts()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_identify'>Narrow a query by passing taxonomic identifiers</h2><span id='topic+galah_identify'></span><span id='topic+identify.data_request'></span><span id='topic+identify.metadata_request'></span>

<h3>Description</h3>

<p>When conducting a search or creating a data query, it is common to identify
a known taxon or group of taxa to narrow down the records or results returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_identify(..., search = NULL)

## S3 method for class 'data_request'
identify(x, ...)

## S3 method for class 'metadata_request'
identify(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_identify_+3A_...">...</code></td>
<td>
<p>One or more scientific names.</p>
</td></tr>
<tr><td><code id="galah_identify_+3A_search">search</code></td>
<td>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#deprecated"><img src="../help/figures/lifecycle-deprecated.svg" alt='[Deprecated]' /></a>
<code>galah_identify()</code> now always does a search to verify search terms; ergo
this argument is ignored.</p>
</td></tr>
<tr><td><code id="galah_identify_+3A_x">x</code></td>
<td>
<p>An object of class <code>metadata_request</code>, created using <code><a href="#topic+request_metadata">request_metadata()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>galah_identify()</code> is used to identify taxa you want returned in a search or
a data query. Users to pass scientific names or taxonomic identifiers
with pipes to provide data only for the biological group of interest.
</p>
<p>It is good to use <code><a href="#topic+search_taxa">search_taxa()</a></code> and <code><a href="#topic+search_identifiers">search_identifiers()</a></code>
first to check that the taxa you provide to <code>galah_identify()</code> return the
correct results.
</p>


<h3>Value</h3>

<p>A tibble containing identified taxa.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_taxa">search_taxa()</a></code> to find identifiers from scientific names;
<code><a href="#topic+search_identifiers">search_identifiers()</a></code> for how to get names if taxonomic identifiers
are already known.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Specify a taxon. A valid taxon will return an identifier.
galah_identify("reptilia")

# Specify more than one taxon at a time.
galah_identify("reptilia", "mammalia", "aves", "pisces")

# Use `galah_identify()` to narrow your queries
galah_call() |&gt; 
  galah_identify("Eolophus") |&gt;
  atlas_counts()

# Within a pipe, `identify()` and `galah_identify()` are synonymous.
# hence the following is identical to the previous example:
request_data() |&gt;
  identify("Eolophus") |&gt;
  count() |&gt;
  collect()

# If you know a valid taxon identifier, use `galah_filter()` instead.
# (This was formerly supported by `galah_identify()` with `search = FALSE`)
id &lt;- "https://biodiversity.org.au/afd/taxa/009169a9-a916-40ee-866c-669ae0a21c5c"
galah_call() |&gt; 
  galah_filter(lsid == id) |&gt;
  atlas_counts()

## End(Not run)
</code></pre>

<hr>
<h2 id='galah_select'>Specify fields for occurrence download</h2><span id='topic+galah_select'></span><span id='topic+select.data_request'></span>

<h3>Description</h3>

<p>GBIF nodes store content in hundreds of
different fields, and users often require thousands or millions of records at
a time. To reduce time taken to download data, and limit complexity of the
resulting <code>tibble</code>, it is sensible to restrict the fields returned by
<code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code>. This function allows easy selection of fields, or
commonly-requested groups of columns, following syntax shared with
<code>dplyr::select()</code>.
</p>
<p>The full list of available fields can be viewed with <code>show_all(fields)</code>. Note
that <code>select()</code> and <code>galah_select()</code> are supported for all atlases that allow
downloads, with the exception of GBIF, for which all columns are returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>galah_select(..., group)

## S3 method for class 'data_request'
select(.data, ..., group)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="galah_select_+3A_...">...</code></td>
<td>
<p>zero or more individual column names to include</p>
</td></tr>
<tr><td><code id="galah_select_+3A_group">group</code></td>
<td>
<p><code>string</code>: (optional) name of one or more column groups to
include. Valid options are <code>"basic"</code>, <code>"event"</code> <code>"taxonomy"</code>, <code>"media"</code> and
<code>"assertions"</code>.</p>
</td></tr>
<tr><td><code id="galah_select_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>data_request</code>, created using <code><a href="#topic+galah_call">galah_call()</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calling the argument <code>group = "basic"</code> returns the following columns:
</p>

<ul>
<li> <p><code>decimalLatitude</code>
</p>
</li>
<li> <p><code>decimalLongitude</code>
</p>
</li>
<li> <p><code>eventDate</code>
</p>
</li>
<li> <p><code>scientificName</code>
</p>
</li>
<li> <p><code>taxonConceptID</code>
</p>
</li>
<li> <p><code>recordID</code>
</p>
</li>
<li> <p><code>dataResourceName</code>
</p>
</li>
<li> <p><code>occurrenceStatus</code>
</p>
</li></ul>

<p>Using <code>group = "event"</code> returns the following columns:
</p>

<ul>
<li> <p><code>eventRemarks</code>
</p>
</li>
<li> <p><code>eventTime</code>
</p>
</li>
<li> <p><code>eventID</code>
</p>
</li>
<li> <p><code>eventDate</code>
</p>
</li>
<li> <p><code>samplingEffort</code>
</p>
</li>
<li> <p><code>samplingProtocol</code>
</p>
</li></ul>

<p>Using <code>group = "media"</code> returns the following columns:
</p>

<ul>
<li> <p><code>multimedia</code>
</p>
</li>
<li> <p><code>multimediaLicence</code>
</p>
</li>
<li> <p><code>images</code>
</p>
</li>
<li> <p><code>videos</code>
</p>
</li>
<li> <p><code>sounds</code>
</p>
</li></ul>

<p>Using <code>group = "taxonomy"</code> returns higher taxonomic information for a given
query. It is the only <code>group</code> that is accepted by <code>atlas_species()</code> as well
as <code>atlas_occurrences()</code>.
</p>
<p>Using <code>group = "assertions"</code> returns all quality assertion-related
columns. The list of assertions is shown by <code>show_all_assertions()</code>.
</p>
<p>For <code>atlas_occurrences()</code>, arguments passed to <code>...</code> should be valid field
names, which you can check using <code>show_all(fields)</code>. For <code>atlas_species()</code>,
it should be one or more of:
</p>

<ul>
<li> <p><code>counts</code> to include counts of occurrences per species.
</p>
</li>
<li> <p><code>synonyms</code> to include any synonymous names.
</p>
</li>
<li> <p><code>lists</code> to include authoritiative lists that each species is included on.
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble
specifying the name and type of each column to include in the
call to <code>atlas_counts()</code> or <code>atlas_occurrences()</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+search_taxa">search_taxa()</a></code>, <code><a href="#topic+galah_filter">galah_filter()</a></code> and
<code><a href="#topic+galah_geolocate">galah_geolocate()</a></code> for other ways to restrict the information returned
by <code><a href="#topic+atlas_occurrences">atlas_occurrences()</a></code> and related functions; <code><a href="#topic+atlas_counts">atlas_counts()</a></code>
for how to get counts by levels of variables returned by <code>galah_select</code>;
<code>show_all(fields)</code> to list available fields.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Download occurrence records of *Perameles*, 
# Only return scientificName and eventDate columns
galah_config(email = "your-email@email.com")
galah_call() |&gt;
  galah_identify("perameles")|&gt;
  galah_select(scientificName, eventDate) |&gt;
  atlas_occurrences()

# Only return the "basic" group of columns and the basisOfRecord column
galah_call() |&gt;
  galah_identify("perameles") |&gt;
  galah_select(basisOfRecord, group = "basic") |&gt;
  atlas_occurrences()
  
# When used in a pipe, `galah_select()` and `select()` are synonymous.
# Hence the previous example can be rewritten as:
request_data() |&gt;
  identify("perameles") |&gt;
  select(basisOfRecord, group = "basic") |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='print_galah_objects'>Print galah objects</h2><span id='topic+print_galah_objects'></span><span id='topic+print.data_request'></span><span id='topic+print.files_request'></span><span id='topic+print.metadata_request'></span><span id='topic+print.query'></span><span id='topic+print.computed_query'></span><span id='topic+print.query_set'></span><span id='topic+print.galah_config'></span>

<h3>Description</h3>

<p>As of version 2.0, <code>galah</code> supports several bespoke object types. Classes
<code>data_request</code>, <code>metadata_request</code> and <code>files_request</code> are for starting pipes
to download different types of information. These objects are parsed using
<code>collapse()</code> into a <code>query</code> object, which contains one or more URLs necessary
to return the requested information. This object is then passed to
<code>compute()</code> and/or <code>collect()</code>. Finally, <code>galah_config()</code> creates an object
of class <code>galah_config</code> which (unsurprisingly) stores configuration
information.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
print(x, ...)

## S3 method for class 'files_request'
print(x, ...)

## S3 method for class 'metadata_request'
print(x, ...)

## S3 method for class 'query'
print(x, ...)

## S3 method for class 'computed_query'
print(x, ...)

## S3 method for class 'query_set'
print(x, ...)

## S3 method for class 'galah_config'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print_galah_objects_+3A_x">x</code></td>
<td>
<p>an object of the appropriate <code>class</code></p>
</td></tr>
<tr><td><code id="print_galah_objects_+3A_...">...</code></td>
<td>
<p>Arguments to be passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print does not return an object; instead it prints a description
of the object to the console
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The most common way to start a pipe is with `galah_call()`
# later functions update the `data_request` object
galah_call() |&gt; # same as calling `request_data()`
  filter(year &gt;= 2020) |&gt;
  group_by(year) |&gt;
  count()

# Metadata requests are formatted in a similar way
request_metadata() |&gt;
  filter(field == basisOfRecord) |&gt;
  unnest()

# Queries are converted into a `query_set` by `collapse()`
x &lt;- galah_call() |&gt; # same as calling `request_data()`
  filter(year &gt;= 2020) |&gt;
  count() |&gt;
  collapse()
print(x)
  
# Each `query_set` contains one or more `query` objects
x[[3]]
</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+arrange'></span><span id='topic+collect'></span><span id='topic+compute'></span><span id='topic+collapse'></span><span id='topic+identify'></span><span id='topic+filter'></span><span id='topic+select'></span><span id='topic+group_by'></span><span id='topic+slice_head'></span><span id='topic+count'></span><span id='topic+st_crop'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>dplyr</dt><dd><p><code><a href="dplyr.html#topic+arrange">arrange</a></code>, <code><a href="dplyr.html#topic+compute">collapse</a></code>, <code><a href="dplyr.html#topic+compute">collect</a></code>, <code><a href="dplyr.html#topic+compute">compute</a></code>, <code><a href="dplyr.html#topic+count">count</a></code>, <code><a href="dplyr.html#topic+filter">filter</a></code>, <code><a href="dplyr.html#topic+group_by">group_by</a></code>, <code><a href="dplyr.html#topic+select">select</a></code>, <code><a href="dplyr.html#topic+slice">slice_head</a></code></p>
</dd>
<dt>graphics</dt><dd><p><code><a href="graphics.html#topic+identify">identify</a></code></p>
</dd>
<dt>sf</dt><dd><p><code><a href="sf.html#topic+st_crop">st_crop</a></code></p>
</dd>
</dl>

<hr>
<h2 id='search_all'>Search for record information</h2><span id='topic+search_all'></span><span id='topic+search_atlases'></span><span id='topic+search_reasons'></span><span id='topic+search_ranks'></span><span id='topic+search_fields'></span><span id='topic+search_assertions'></span><span id='topic+search_profiles'></span><span id='topic+search_providers'></span><span id='topic+search_collections'></span><span id='topic+search_datasets'></span><span id='topic+search_licences'></span><span id='topic+search_apis'></span><span id='topic+search_identifiers'></span><span id='topic+search_lists'></span><span id='topic+search_taxa'></span>

<h3>Description</h3>

<p>The living atlases store a huge amount of information, above and beyond the
occurrence records that are their main output. In <code>galah</code>, one way that
users can investigate this information is by searching for a specific option
or category for the type of information they are interested in.
Functions prefixed with <code>search_</code> do this, displaying any matches to a
search term within the valid options for the information specified by the
suffix.
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>search_all()</code> is a helper function that can do searches within multiple
types of information from <code>search_</code> sub-functions.
See <code>Details</code> (below) for accepted values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search_all(type, query)

search_assertions(query)

search_apis(query)

search_atlases(query)

search_collections(query)

search_datasets(query)

search_fields(query)

search_identifiers(...)

search_licences(query)

search_lists(query)

search_profiles(query)

search_providers(query)

search_ranks(query)

search_reasons(query)

search_taxa(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="search_all_+3A_type">type</code></td>
<td>
<p>A string to specify what type of parameters should be searched.</p>
</td></tr>
<tr><td><code id="search_all_+3A_query">query</code></td>
<td>
<p>A string specifying a search term. Searches are not
case-sensitive.</p>
</td></tr>
<tr><td><code id="search_all_+3A_...">...</code></td>
<td>
<p>A set of strings or a tibble to be queried</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are five categories of information, each with their own
specific sub-functions to look-up each type of information.
The available types of information for <code>search_all()</code> are:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Category</strong> </td><td style="text-align: left;"> <strong>Type</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td><td style="text-align: left;"> <strong>Sub-functions</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   configuration </td><td style="text-align: left;"> <code>atlases</code> </td><td style="text-align: left;"> Search for what atlases are available </td><td style="text-align: left;"> <code>search_atlases()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>apis</code> </td><td style="text-align: left;"> Search for what APIs &amp; functions are available for each atlas </td><td style="text-align: left;"> <code>search_apis()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>reasons</code> </td><td style="text-align: left;"> Search for what values are acceptable as 'download reasons' for a specified atlas </td><td style="text-align: left;"> <code>search_reasons()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   taxonomy </td><td style="text-align: left;"> <code>taxa</code> </td><td style="text-align: left;"> Search for one or more taxonomic names </td><td style="text-align: left;"> <code>search_taxa()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>identifiers</code> </td><td style="text-align: left;"> Take a universal identifier and return taxonomic information </td><td style="text-align: left;"> <code>search_identifiers()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>ranks</code> </td><td style="text-align: left;"> Search for valid taxonomic ranks (e.g. Kingdom, Class, Order, etc.) </td><td style="text-align: left;"> <code>search_ranks()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   filters </td><td style="text-align: left;"> <code>fields</code> </td><td style="text-align: left;"> Search for fields that are stored in an atlas </td><td style="text-align: left;"> <code>search_fields()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>assertions</code> </td><td style="text-align: left;"> Search for results of data quality checks run by each atlas </td><td style="text-align: left;"> <code>search_assertions()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>licenses</code> </td><td style="text-align: left;"> Search for copyright licences applied to media </td><td style="text-align: left;"> <code>search_licenses()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   group filters </td><td style="text-align: left;"> <code>profiles</code> </td><td style="text-align: left;"> Search for what data profiles are available </td><td style="text-align: left;"> <code>search_profiles()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>lists</code> </td><td style="text-align: left;"> Search for what species lists are available </td><td style="text-align: left;"> <code>search_lists()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   data providers </td><td style="text-align: left;"> <code>providers</code> </td><td style="text-align: left;"> Search for which institutions have provided data </td><td style="text-align: left;"> <code>search_providers()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>collections</code> </td><td style="text-align: left;"> Search for the specific collections within those institutions </td><td style="text-align: left;"> <code>search_collections()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>datasets</code> </td><td style="text-align: left;"> Search for the data groupings within those collections </td><td style="text-align: left;"> <code>search_datasets()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble)
containing all data that match the search query.
</p>


<h3>References</h3>


<ul>
<li><p> Darwin Core terms <a href="https://dwc.tdwg.org/terms/">https://dwc.tdwg.org/terms/</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>See <code><a href="#topic+search_taxa">search_taxa()</a></code> and <code><a href="#topic+search_identifiers">search_identifiers()</a></code> for more information
on taxonomic searches.
Use the <code><a href="#topic+show_all">show_all()</a></code> function and <code>show_all_()</code> sub-functions to
show available options of information. These functions are used to pass valid
arguments to <code><a href="#topic+galah_select">galah_select()</a></code>, <code><a href="#topic+galah_filter">galah_filter()</a></code>, and related functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Search for fields that include the word "date"
search_all(fields, "date")

# Search for fields that include the word "marine"
search_all(fields, "marine")

# Search using a single taxonomic term
# (see `?search_taxa()` for more information)
search_all(taxa, "Reptilia") # equivalent

# Look up a unique taxon identifier
# (see `?search_identifiers()` for more information)
search_all(identifiers, 
           "https://id.biodiversity.org.au/node/apni/2914510")

# Search for species lists that match "endangered"
search_all(lists, "endangered") # equivalent

# Search for a valid taxonomic rank, "subphylum"
search_all(ranks, "subphylum")

# An alternative is to download the data and then `filter` it. This is 
# largely synonymous, and allows greater control over which fields are searched.
request_metadata(type = "fields") |&gt;
 collect() |&gt;
 dplyr::filter(grepl("date", id))

## End(Not run)
</code></pre>

<hr>
<h2 id='show_all'>Show valid record information</h2><span id='topic+show_all'></span><span id='topic+show_all_apis'></span><span id='topic+show_all_assertions'></span><span id='topic+show_all_atlases'></span><span id='topic+show_all_collections'></span><span id='topic+show_all_datasets'></span><span id='topic+show_all_fields'></span><span id='topic+show_all_licences'></span><span id='topic+show_all_lists'></span><span id='topic+show_all_profiles'></span><span id='topic+show_all_providers'></span><span id='topic+show_all_ranks'></span><span id='topic+show_all_reasons'></span>

<h3>Description</h3>

<p>The living atlases store a huge amount of information, above and beyond the
occurrence records that are their main output. In <code>galah</code>, one way that
users can investigate this information is by showing all the available
options or categories for the type of information they are interested in.
Functions prefixed with <code>show_all_</code> do this, displaying all valid options
for the information specified by the suffix.
</p>
<p><a href="https://lifecycle.r-lib.org/articles/stages.html#stable"><img src="../help/figures/lifecycle-stable.svg" alt='[Stable]' /></a>
<code>show_all()</code> is a helper function that can display multiple types of
information from <code>show_all_</code> sub-functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_all(..., limit = NULL)

show_all_apis(limit = NULL)

show_all_assertions(limit = NULL)

show_all_atlases(limit = NULL)

show_all_collections(limit = NULL)

show_all_datasets(limit = NULL)

show_all_fields(limit = NULL)

show_all_licences(limit = NULL)

show_all_lists(limit = NULL)

show_all_profiles(limit = NULL)

show_all_providers(limit = NULL)

show_all_ranks(limit = NULL)

show_all_reasons(limit = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_all_+3A_...">...</code></td>
<td>
<p>String showing what type of information is to be requested. See
<code>Details</code> (below) for accepted values.</p>
</td></tr>
<tr><td><code id="show_all_+3A_limit">limit</code></td>
<td>
<p>Optional number of values to return. Defaults to NULL, i.e. all records</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are five categories of information, each with their own
specific sub-functions to look-up each type of information.
The available types of information for <code>show_all_</code> are:</p>

<table>
<tr>
 <td style="text-align: left;">
   <strong>Category</strong> </td><td style="text-align: left;"> <strong>Type</strong> </td><td style="text-align: left;"> <strong>Description</strong> </td><td style="text-align: left;"> <strong>Sub-functions</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Configuration </td><td style="text-align: left;"> <code>atlases</code> </td><td style="text-align: left;"> Show what atlases are available </td><td style="text-align: left;"> <code>show_all_atlases()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>apis</code> </td><td style="text-align: left;"> Show what APIs &amp; functions are available for each atlas </td><td style="text-align: left;"> <code>show_all_apis()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>reasons</code> </td><td style="text-align: left;"> Show what values are acceptable as 'download reasons' for a specified atlas </td><td style="text-align: left;"> <code>show_all_reasons()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Data providers </td><td style="text-align: left;"> <code>providers</code> </td><td style="text-align: left;"> Show which institutions have provided data </td><td style="text-align: left;"> <code>show_all_providers()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>collections</code> </td><td style="text-align: left;"> Show the specific collections within those institutions </td><td style="text-align: left;"> <code>show_all_collections()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>datasets</code> </td><td style="text-align: left;"> Shows all the data groupings within those collections </td><td style="text-align: left;"> <code>show_all_datasets()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Filters </td><td style="text-align: left;"> <code>assertions</code> </td><td style="text-align: left;"> Show results of data quality checks run by each atlas </td><td style="text-align: left;"> <code>show_all_assertions()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>fields</code> </td><td style="text-align: left;"> Show fields that are stored in an atlas </td><td style="text-align: left;"> <code>show_all_fields()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>licenses</code> </td><td style="text-align: left;"> Show what copyright licenses are applied to media </td><td style="text-align: left;"> <code>show_all_licenses()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>profiles</code> </td><td style="text-align: left;"> Show what data profiles are available </td><td style="text-align: left;"> <code>show_all_profiles()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
   Taxonomy </td><td style="text-align: left;"> <code>lists</code> </td><td style="text-align: left;"> Show what species lists are available </td><td style="text-align: left;"> <code>show_all_lists()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
    </td><td style="text-align: left;"> <code>ranks</code> </td><td style="text-align: left;"> Show valid taxonomic ranks (e.g. Kingdom, Class, Order, etc.) </td><td style="text-align: left;"> <code>show_all_ranks()</code> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>An object of class <code>tbl_df</code> and <code>data.frame</code> (aka a tibble)
containing all data of interest.
</p>


<h3>References</h3>


<ul>
<li><p> Darwin Core terms <a href="https://dwc.tdwg.org/terms/">https://dwc.tdwg.org/terms/</a>
</p>
</li></ul>



<h3>See Also</h3>

<p>Use the <code><a href="#topic+search_all">search_all()</a></code> function and <code>search_()</code> sub-functions to
search for information. These functions are used to pass valid arguments to
<code><a href="#topic+galah_select">galah_select()</a></code>, <code><a href="#topic+galah_filter">galah_filter()</a></code>, and related functions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# See all supported atlases
show_all(atlases)

# Show a list of all available data quality profiles
show_all(profiles)

# Show a listing of all accepted reasons for downloading occurrence data
show_all(reasons)

# Show a listing of all taxonomic ranks
show_all(ranks)

# `show_all()` is synonymous with `request_metadata() |&gt; collect()`
request_metadata(type = "fields") |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='show_values'>Show or search for values within a specified field</h2><span id='topic+show_values'></span><span id='topic+search_values'></span>

<h3>Description</h3>

<p>Users may wish to see the specific values <em>within</em> a chosen field, profile
or list to narrow queries or understand more about the information of
interest. <code>show_values()</code> provides users with these values. <code>search_values()</code>
allows users for search for specific values within a specified field.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show_values(df)

search_values(df, query)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show_values_+3A_df">df</code></td>
<td>
<p>A search result from <code><a href="#topic+search_fields">search_fields()</a></code>, <code><a href="#topic+search_profiles">search_profiles()</a></code> or
<code><a href="#topic+search_lists">search_lists()</a></code>.</p>
</td></tr>
<tr><td><code id="show_values_+3A_query">query</code></td>
<td>
<p>A string specifying a search term. Not case sensitive.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Each <strong>Field</strong> contains categorical or numeric values.
For example:
</p>

<ul>
<li><p> The <code>field</code> &quot;year&quot; contains values 2021, 2020, 2019, etc.
</p>
</li>
<li><p> The <code>field</code> &quot;stateProvince&quot; contains values New South Wales, Victoria, Queensland, etc.
These are used to narrow queries with <code><a href="#topic+galah_filter">galah_filter()</a></code>.
</p>
</li></ul>

<p>Each <strong>Profile</strong> consists of many individual quality filters.
For example, the &quot;ALA&quot; profile consists of values:
</p>

<ul>
<li><p> Exclude all records where spatial validity is FALSE
</p>
</li>
<li><p> Exclude all records with a latitude value of zero
</p>
</li>
<li><p> Exclude all records with a longitude value of zero
</p>
</li></ul>

<p>Each <strong>List</strong> contains a list of species, usually by taxonomic name.
For example, the Endangered Plant species list contains values:
</p>

<ul>
<li><p> Acacia curranii (Curly-bark Wattle)
</p>
</li>
<li><p> Brachyscome papillosa (Mossgiel Daisy)
</p>
</li>
<li><p> Solanum karsense (Menindee Nightshade)
</p>
</li></ul>



<h3>Value</h3>

<p>A <code>tibble</code> of values for a specified field, profile or list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Show values in field 'cl22'
search_fields("cl22") |&gt; 
  show_values()

# This is synonymous with `request_metadata() |&gt; unnest()`.
# For example, the previous example can be run using:
request_metadata() |&gt;
  filter(field == "cl22") |&gt;
  unnest() |&gt;
  collect() 

# Search for any values in field 'cl22' that match 'tas'
search_fields("cl22") |&gt; 
  search_values("tas")

# See items within species list "dr19257"
search_lists("dr19257") |&gt; 
  show_values()

## End(Not run)
</code></pre>

<hr>
<h2 id='slice_head.data_request'>Subset first rows of <code>data_request</code></h2><span id='topic+slice_head.data_request'></span><span id='topic+slice_head.metadata_request'></span>

<h3>Description</h3>

<p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental"><img src="../help/figures/lifecycle-experimental.svg" alt='[Experimental]' /></a>
</p>
<p>This is a simple function to set the <code>limit</code> argument in <code><a href="#topic+atlas_counts">atlas_counts()</a></code>
using <code>dplyr</code> syntax. As of galah 2.0.0, <code>slice_head()</code> is only supported in
queries of type <code>occurrences-count()</code>, or metadata requests. Note also that
<code>slice_head()</code> is lazily evaluated; it only affects a query once it is run by
<code>compute()</code> or (more likely) <code>collect()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'data_request'
slice_head(.data, ..., n, prop, by = NULL)

## S3 method for class 'metadata_request'
slice_head(.data, ..., n, prop, by = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="slice_head.data_request_+3A_.data">.data</code></td>
<td>
<p>An object of class <code>data_request</code>, created using <code><a href="#topic+galah_call">galah_call()</a></code></p>
</td></tr>
<tr><td><code id="slice_head.data_request_+3A_...">...</code></td>
<td>
<p>currently ignored</p>
</td></tr>
<tr><td><code id="slice_head.data_request_+3A_n">n</code></td>
<td>
<p>The number of rows to be returned. If data are grouped
(using <a href="#topic+group_by">group_by</a>), this operation will be performed on each group.</p>
</td></tr>
<tr><td><code id="slice_head.data_request_+3A_prop">prop</code></td>
<td>
<p>currently ignored, but could be added later</p>
</td></tr>
<tr><td><code id="slice_head.data_request_+3A_by">by</code></td>
<td>
<p>currently ignored</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Limit number of rows returned to 3.
# In this case, our query returns the top 3 years with most records.
galah_call() |&gt;
  identify("perameles") |&gt;
  filter(year &gt; 2010) |&gt;
  group_by(year) |&gt;
  count() |&gt;
  slice_head(n = 3) |&gt;
  collect()

## End(Not run)
</code></pre>

<hr>
<h2 id='tidyverse_functions'>Non-generic tidyverse functions</h2><span id='topic+tidyverse_functions'></span><span id='topic+desc'></span><span id='topic+unnest'></span>

<h3>Description</h3>

<p>Several useful functions from tidyverse packages are <code>generic</code>, meaning
that we can define class-specific versions of those functions and implement
them in galah; examples include <code>filter()</code>, <code>select()</code> and <code>group_by()</code>.
However, there are also functions that are only defined within tidyverse
packages and are not generic. In a few cases we have re-implemented these
functions in galah. This has the consequence of supporting consistent
syntax with tidyverse, at the cost of potentially introducing conflicts.
This can be avoided by using the <code>::</code> operator where required (see examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>desc(...)

unnest(.query)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidyverse_functions_+3A_...">...</code></td>
<td>
<p>column to order by</p>
</td></tr>
<tr><td><code id="tidyverse_functions_+3A_.query">.query</code></td>
<td>
<p>An object of class <code>metadata_request</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The following functions are included:
</p>

<ul>
<li> <p><code>desc()</code> (<code>dplyr</code>): Use within <code>arrange()</code> to specify arrangement should be descending
</p>
</li>
<li> <p><code>unnest()</code> (<code>tidyr</code>): Use to 'drill down' into nested information on <code>fields</code>, <code>lists</code>, <code>profiles</code>, or <code>taxa</code>
</p>
</li></ul>

<p>These galah versions all use lazy evaluation.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>galah::desc()</code> returns a <code>tibble</code> used by <code>arrange.data_request()</code> to arrange rows of a query.
</p>
</li>
<li> <p><code>galah::unnest()</code> returns an object of class <code>metadata_request</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+arrange.data_request">arrange.data_request()</a></code>, <code><a href="#topic+galah_call">galah_call()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Arrange grouped record counts by descending year
galah_call() |&gt;
  identify("perameles") |&gt;
  filter(year &gt; 2019) |&gt;
  count() |&gt;
  arrange(galah::desc(year)) |&gt;
  collect()

# Return values of field `basisOfRecord`
request_metadata() |&gt; 
  galah::unnest() |&gt; 
  filter(field == basisOfRecord) |&gt; 
  collect()
  
# Using `galah::unnest()` in this way is equivalent to:
show_all(fields, "basisOfRecord") |&gt; 
  show_values()

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
