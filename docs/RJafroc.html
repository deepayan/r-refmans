<!DOCTYPE html><html lang="en"><head><title>Help for package RJafroc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RJafroc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#RJafroc-package'>
<p>Artificial Intelligence Systems and Observer Performance</p></a></li>
<li><a href='#ChisqrGoodnessOfFit'><p>Compute the chisquare goodness of fit statistic for ROC fitting model</p></a></li>
<li><a href='#dataset01'><p>TONY FROC dataset</p></a></li>
<li><a href='#dataset02'><p>Van Dyke ROC dataset</p></a></li>
<li><a href='#dataset03'><p>Franken ROC dataset</p></a></li>
<li><a href='#dataset04'><p>Federica Zanca FROC dataset</p></a></li>
<li><a href='#dataset05'><p>John Thompson FROC dataset</p></a></li>
<li><a href='#dataset06'><p>Magnus FROC dataset</p></a></li>
<li><a href='#dataset07'><p>Lucy Warren FROC dataset</p></a></li>
<li><a href='#dataset08'><p>Monica Penedo ROC dataset</p></a></li>
<li><a href='#dataset09'><p>Nico Karssemeijer ROC dataset (CAD vs. radiologists)</p></a></li>
<li><a href='#dataset10'><p>Mark Ruschin ROC dataset</p></a></li>
<li><a href='#dataset11'><p>Dobbins 1 FROC dataset</p></a></li>
<li><a href='#dataset12'><p>Dobbins 2 ROC dataset</p></a></li>
<li><a href='#dataset13'><p>Dobbins 3 FROC dataset</p></a></li>
<li><a href='#dataset14'><p>Federica Zanca real (as opposed to inferred) ROC dataset</p></a></li>
<li><a href='#datasetBinned123'><p>Binned dataset suitable for checking <code>FitCorCbm</code>; seed = 123</p></a></li>
<li><a href='#datasetBinned124'><p>Binned dataset suitable for checking <code>FitCorCbm</code>; seed = 124</p></a></li>
<li><a href='#datasetBinned125'><p>Binned dataset suitable for checking <code>FitCorCbm</code>; seed = 125</p></a></li>
<li><a href='#datasetCadLroc'><p>Nico Karssemeijer LROC dataset (CAD vs. radiologists)</p></a></li>
<li><a href='#datasetCadSimuFroc'><p>Simulated FROC CAD vs. RAD dataset</p></a></li>
<li><a href='#datasetCrossedModality'><p>John Thompson crossed treatment FROC dataset</p></a></li>
<li><a href='#datasetDegenerate'><p>Simulated degenerate ROC dataset (for testing purposes)</p></a></li>
<li><a href='#datasetFROCSpC'><p>Simulated FROC SPLIT-PLOT-C dataset</p></a></li>
<li><a href='#datasetROI'><p>Simulated ROI dataset</p></a></li>
<li><a href='#Df2RJafrocDataset'><p>Convert ratings arrays to an RJafroc dataset</p></a></li>
<li><a href='#DfBinDataset'><p>Returns a binned dataset</p></a></li>
<li><a href='#DfCreateCorCbmDataset'><p>Create paired dataset for testing <code>FitCorCbm</code></p></a></li>
<li><a href='#DfExtractCorCbmDataset'><p>Extract two arms of a pairing from an MRMC ROC dataset</p></a></li>
<li><a href='#DfExtractDataset'><p>Extract a subset of treatments and readers from a dataset</p></a></li>
<li><a href='#DfFroc2Lroc'><p>Simulates an &quot;AUC-equivalent&quot; LROC dataset from an FROC dataset</p></a></li>
<li><a href='#DfFroc2Roc'><p>Convert an FROC dataset to an ROC dataset</p></a></li>
<li><a href='#DfLroc2Froc'><p>Simulates an &quot;AUC-equivalent&quot; FROC dataset from an LROC dataset</p></a></li>
<li><a href='#DfLroc2Roc'><p>Convert an LROC dataset to a ROC dataset</p></a></li>
<li><a href='#DfReadCrossedModalities'><p>Read a crossed-treatment data file</p></a></li>
<li><a href='#DfReadDataFile'><p>Read a data file</p></a></li>
<li><a href='#DfSaveDataFile'><p>Save ROC dataset in different formats</p></a></li>
<li><a href='#DfWriteExcelDataFile'><p>Save dataset object as a JAFROC format Excel file</p></a></li>
<li><a href='#FitBinormalRoc'><p>Fit the binormal model to selected treatment and reader in an ROC dataset</p></a></li>
<li><a href='#FitCbmRoc'><p>Fit the contaminated binormal model (CBM) to selected treatment and</p>
reader in an ROC dataset</a></li>
<li><a href='#FitCorCbm'><p>Fit CORCBM to a paired ROC dataset</p></a></li>
<li><a href='#FitRsmRoc'><p>Fit the radiological search model (RSM) to an ROC dataset</p></a></li>
<li><a href='#isBinnedDataset'><p>Determine if a dataset is binned</p></a></li>
<li><a href='#isValidDataset'><p>Check the validity of a dataset</p></a></li>
<li><a href='#PlotBinormalFit'><p>Plot binormal fit</p></a></li>
<li><a href='#PlotCbmFit'><p>Plot CBM fitted curve</p></a></li>
<li><a href='#PlotEmpiricalOperatingCharacteristics'><p>Plot empirical operating characteristics, ROC, FROC or LROC</p></a></li>
<li><a href='#PlotRsmOperatingCharacteristics'><p>RSM predicted operating characteristics, ROC pdfs and AUCs</p></a></li>
<li><a href='#RSM_LLF'><p>RSM predicted FROC ordinate</p></a></li>
<li><a href='#RSM_NLF'><p>RSM predicted FROC abscissa</p></a></li>
<li><a href='#RSM_pdfD'><p>RSM predicted ROC-rating pdf for diseased cases</p></a></li>
<li><a href='#RSM_pdfN'><p>RSM predicted ROC-rating pdf for non-diseased cases</p></a></li>
<li><a href='#RSM_wLLF'><p>RSM predicted wAFROC ordinate</p></a></li>
<li><a href='#RSM_xROC'><p>RSM predicted ROC-abscissa as function of z</p></a></li>
<li><a href='#RSM_yROC'><p>RSM predicted ROC-ordinate as function of z</p></a></li>
<li><a href='#SimulateCorCbmDataset'><p>Simulate paired binned data for testing FitCorCbm</p></a></li>
<li><a href='#SimulateFrocDataset'><p>Simulates an MRMC uncorrelated FROC dataset using the RSM</p></a></li>
<li><a href='#SimulateFrocFromLrocDataset'><p>Simulates an &quot;AUC-equivalent&quot; FROC dataset from an LROC dataset</p></a></li>
<li><a href='#SimulateLrocDataset'><p>Simulates an uncorrelated FLROC FrocDataset using the RSM</p></a></li>
<li><a href='#SimulateRocDataset'><p>Simulates a binormal model ROC dataset</p></a></li>
<li><a href='#SsFrocNhRsmModel'><p>RSM fitted model for FROC sample size</p></a></li>
<li><a href='#SsPowerGivenJK'><p>Statistical power for specified numbers of readers and cases</p></a></li>
<li><a href='#SsPowerGivenJKDbmVarCom'><p>Power given J, K and Dorfman-Berbaum-Metz variance components</p></a></li>
<li><a href='#SsPowerGivenJKOrVarCom'><p>Power given J, K and Obuchowski-Rockette variance components</p></a></li>
<li><a href='#SsPowerTable'><p>Generate a power table using the OR method</p></a></li>
<li><a href='#SsSampleSizeKGivenJ'><p>Number of cases, for specified number of readers, to achieve desired power</p></a></li>
<li><a href='#StSignificanceTesting'><p>Performs DBM or OR significance testing for factorial or split-plot A,C datasets</p></a></li>
<li><a href='#StSignificanceTestingCadVsRad'><p>Significance testing: standalone CAD vs. radiologists</p></a></li>
<li><a href='#StSignificanceTestingCrossedModalities'><p>Perform significance testing using crossed treatments analysis</p></a></li>
<li><a href='#UtilAnalyticalAucsRSM'><p>RSM ROC/AFROC/wAFROC AUC calculator</p></a></li>
<li><a href='#UtilAucBinormal'><p>Binormal model AUC function</p></a></li>
<li><a href='#UtilAucCBM'><p>CBM AUC function</p></a></li>
<li><a href='#UtilAucPROPROC'><p>PROPROC AUC function</p></a></li>
<li><a href='#UtilDBM2ORVarCom'><p>Convert from DBM to OR variance components</p></a></li>
<li><a href='#UtilFigureOfMerit'><p>Calculate empirical figures of merit (FOMs) for specified dataset</p></a></li>
<li><a href='#UtilIntrinsic2RSM'><p>Convert from intrinsic to physical RSM parameters</p></a></li>
<li><a href='#UtilLesionDistrVector'><p>Get the lesion distribution vector of a dataset</p></a></li>
<li><a href='#UtilLesionWeightsMatrix'><p>Determine lesion weights distribution 2D matrix</p></a></li>
<li><a href='#UtilMeanSquares'><p>Calculate mean squares for factorial dataset</p></a></li>
<li><a href='#UtilOR2DBMVarCom'><p>Convert from OR to DBM variance components</p></a></li>
<li><a href='#UtilORVarComponentsFactorial'><p>Utility for estimating Obuchowski-Rockette variance components for factorial datasets</p></a></li>
<li><a href='#UtilOutputReport'><p>Generate a text formatted report file or an Excel file</p></a></li>
<li><a href='#UtilPseudoValues'><p>Pseudovalues for given dataset and FOM</p></a></li>
<li><a href='#UtilRSM2Intrinsic'><p>Convert from physical to intrinsic RSM parameters</p></a></li>
<li><a href='#UtilVarComponentsDBM'><p>Utility for Dorfman-Berbaum-Metz variance components</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Artificial Intelligence Systems and Observer Performance</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-11-08</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>bbmle, binom, dplyr, ggplot2, mvtnorm, numDeriv, openxlsx,
readxl, Rcpp, stats, stringr, tools, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, knitr, kableExtra, rmarkdown</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzing the performance of artificial intelligence
 (AI) systems/algorithms characterized by a 'search-and-report'
 strategy. Historically observer performance has dealt with
 measuring radiologists' performances in search tasks, e.g., searching
 for lesions in medical images and reporting them, but the implicit
 location information has been ignored. The implemented methods apply
 to analyzing the absolute and relative performances of AI systems,
 comparing AI performance to a group of human readers or optimizing the
 reporting threshold of an AI system. In addition to performing historical
 receiver operating receiver operating characteristic (ROC) analysis
 (localization information ignored), the software also performs
 free-response receiver operating characteristic (FROC)
 analysis, where lesion localization information is used. A book
 using the software has been published: Chakraborty DP: Observer
 Performance Methods for Diagnostic Imaging - Foundations, Modeling,
 and Applications with R-Based Examples, Taylor-Francis LLC; 2017:
 <a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>.
 Online updates to this book, which use the software, are at
 <a href="https://dpc10ster.github.io/RJafrocQuickStart/">https://dpc10ster.github.io/RJafrocQuickStart/</a>,
 <a href="https://dpc10ster.github.io/RJafrocRocBook/">https://dpc10ster.github.io/RJafrocRocBook/</a> and at
 <a href="https://dpc10ster.github.io/RJafrocFrocBook/">https://dpc10ster.github.io/RJafrocFrocBook/</a>. Supported data
 collection paradigms are the ROC, FROC and the location ROC (LROC).
 ROC data consists of single ratings per images, where a rating is
 the perceived confidence level that the image is that of a diseased
 patient. An ROC curve is a plot of true positive fraction vs. false
 positive fraction. FROC data consists of a variable number (zero or
 more) of mark-rating pairs per image, where a mark is the location
 of a reported suspicious region and the rating is the confidence
 level that it is a real lesion. LROC data consists of a rating and a
 location of the most suspicious region, for every image. Four models
 of observer performance, and curve-fitting software, are implemented:
 the binormal model (BM), the contaminated binormal model (CBM), the
 correlated contaminated binormal model (CORCBM), and the radiological
 search model (RSM). Unlike the binormal model, CBM, CORCBM and RSM
 predict 'proper' ROC curves that do not inappropriately cross the
 chance diagonal. Additionally, RSM parameters are related to search
 performance (not measured in conventional ROC analysis) and
 classification performance. Search performance refers to finding
 lesions, i.e., true positives, while simultaneously not finding false
 positive locations. Classification performance measures the ability to
 distinguish between true and false positive locations. Knowing these
 separate performances allows principled optimization of reader or AI
 system performance. This package supersedes Windows JAFROC (jackknife
 alternative FROC) software V4.2.1,
 <a href="https://github.com/dpc10ster/WindowsJafroc">https://github.com/dpc10ster/WindowsJafroc</a>. Package functions are
 organized as follows. Data file related function names are preceded
 by 'Df', curve fitting functions by 'Fit', included data sets by 'dataset',
 plotting functions by 'Plot', significance testing functions by 'St',
 sample size related functions by 'Ss', data simulation functions by
 'Simulate' and utility functions by 'Util'. Implemented are figures of
 merit (FOMs) for quantifying performance and functions for visualizing
 empirical or fitted operating characteristics: e.g., ROC, FROC, alternative
 FROC (AFROC) and weighted AFROC (wAFROC) curves. For fully crossed study
 designs significance testing of reader-averaged FOM differences between
 modalities is implemented via either Dorfman-Berbaum-Metz or the
 Obuchowski-Rockette methods. Also implemented is single treatment analysis,
 which allows comparison of performance of a group of radiologists to a
 specified value, or comparison of AI to a group of radiologists interpreting
 the same cases. Crossed-modality analysis is implemented wherein there are
 two crossed treatment factors and the aim is to determined performance in
 each treatment factor averaged over all levels of the second factor. Sample
 size estimation tools are provided for ROC and FROC studies; these use
 estimates of the relevant variances from a pilot study to predict required
 numbers of readers and cases in a pivotal study to achieve the desired power.
 Utility and data file manipulation functions allow data to be read in any of
 the currently used input formats, including Excel, and the results of the
 analysis can be viewed in text or Excel output files. The methods are
 illustrated with several included datasets from the author's collaborations.
 This update includes improvements to the code, some as a result of
 user-reported bugs and new feature requests, and others discovered during
 ongoing testing and code simplification.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://dpc10ster.github.io/RJafroc/">https://dpc10ster.github.io/RJafroc/</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-08 18:38:08 UTC; Dev</td>
</tr>
<tr>
<td>Author:</td>
<td>Dev Chakraborty [cre, aut, cph],
  Peter Phillips [ctb],
  Xuetong Zhai [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dev Chakraborty &lt;dpc10ster@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-08 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='RJafroc-package'>
Artificial Intelligence Systems and Observer Performance
</h2><span id='topic+RJafroc-package'></span>

<h3>Description</h3>

<p><code>RJafroc</code> analyzes the performance of artificial intelligence (AI) systems/algorithms characterized
by a <em>search-and-report</em> strategy. Historically observer performance has dealt with measuring radiologists'
performances in search tasks, e.g., searching for lesions in medical images and reporting them, but the implicit
location information has been ignored. The methods here apply to <em>any</em> task involving searching for
and reporting arbitrary targets in images. The implemented methods apply
to analyzing the absolute and relative performances of AI systems, comparing AI performance to a group of human
readers or optimizing the reporting threshold of an AI system. In addition to performing historical receiver operating
characteristic (ROC) analysis (localization information ignored), the software also performs free-response receiver operating
characteristic (FROC) analysis, where the implicit lesion localization information is used. A book describing the
underlying methodology and which uses the software has been
published: <strong>Chakraborty DP: Observer Performance Methods for Diagnostic Imaging - Foundations, Modeling, and Applications
with R-Based Examples, Taylor-Francis LLC; 2017</strong>: <a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>.
Online updates to this book, which use the software, are at
<a href="https://dpc10ster.github.io/RJafrocQuickStart/">https://dpc10ster.github.io/RJafrocQuickStart/</a>, <a href="https://dpc10ster.github.io/RJafrocRocBook/">https://dpc10ster.github.io/RJafrocRocBook/</a> and at
<a href="https://dpc10ster.github.io/RJafrocFrocBook/">https://dpc10ster.github.io/RJafrocFrocBook/</a>. Supported data collection paradigms are the ROC, FROC and the location ROC (LROC).
ROC data consists of single ratings per images, where a rating is the perceived confidence level that the image is that of a
diseased patient. An ROC curve is a plot of true positive fraction vs. false
positive fraction. FROC data consists of a variable number (zero or more) of mark-rating pairs per image, where a mark is the
location of a reported suspicious region and the rating is the confidence level that it is a real lesion. LROC data
consists of a rating and a location of the most suspicious region, for every image. Four models of observer performance,
and curve-fitting software, are implemented: the binormal model (BM), the contaminated binormal model (CBM), the
correlated contaminated binormal model (CORCBM), and the radiological search model (RSM). Unlike the binormal model, CBM,
CORCBM and RSM predict &quot;proper&quot; ROC curves that do not inappropriately cross the chance diagonal. Additionally, RSM
parameters are related to search performance (not measured in conventional ROC analysis) and classification performance.
Search performance refers to finding lesions, i.e., true positives, while simultaneously not finding false positive
locations. Classification performance measures the ability to distinguish between true and false positive locations. Knowing
these separate performances allows principled optimization of reader or AI system performance. This package supersedes Windows
<strong>JAFROC</strong> (jackknife alternative FROC) software V4.2.1, <a href="https://github.com/dpc10ster/WindowsJafroc">https://github.com/dpc10ster/WindowsJafroc</a>. Package functions
are organized as follows. Data file related function names are preceded by <em>Df</em>, curve fitting functions by <em>Fit</em>, included
data sets by <em>dataset</em>, plotting functions by <em>Plot</em>, significance testing functions by <em>St</em>, sample size related functions
by <em>Ss</em>, data simulation functions by <em>Simulate</em> and utility functions by <em>Util</em>. Implemented are figures of merit (FOMs)
for quantifying performance, functions for visualizing empirical operating characteristics: e.g., ROC, FROC, alternative FROC
(AFROC) and weighted AFROC (wAFROC) curves. For fully crossed study designs significance testing of reader-averaged FOM
differences between modalities is implemented via both Dorfman-Berbaum-Metz and the Obuchowski-Rockette methods. Also
implemented are single treatment analyses, allowing comparison of performance of a group of radiologists to a specified
value, or comparison of AI to a group of radiologists/algorithms interpreting the same cases. Crossed-modality analysis is implemented
wherein there are two crossed treatment factors and the aim is to determined performance in each treatment factor averaged
over all levels of the second factor. Sample size estimation tools are provided for ROC and FROC studies; these use estimates
of the relevant variances from a pilot study to predict required numbers of readers and cases in a pivotal study to achieve the
desired power. Utility and data file manipulation functions allow data to be read in any of the currently used input
formats, including Excel, and the results of the analysis can be viewed in text or Excel output files. The methods are
illustrated with several included datasets from the author's collaborations. This update includes improvements to the code,
some as a result of user-reported bugs and new feature requests, and others discovered during ongoing testing and code simplification.
All changes are noted in <strong>NEWS.md</strong>.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
    Package: </td><td style="text-align: left;"> RJafroc</td>
</tr>
<tr>
 <td style="text-align: left;">
    Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
    Version: </td><td style="text-align: left;"> 2.1.2</td>
</tr>
<tr>
 <td style="text-align: left;">
    Date: </td><td style="text-align: left;"> 2022-11-08</td>
</tr>
<tr>
 <td style="text-align: left;">
    License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
    URL: </td><td style="text-align: left;"> <a href="https://dpc10ster.github.io/RJafroc/">https://dpc10ster.github.io/RJafroc/</a></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td>
</tr>

</table>



<h3>Definitions and abbreviations</h3>


<ul>
<li> <p><em>a</em>: The separation or &quot;a&quot; parameter of the binormal model
</p>
</li>
<li><p> AFROC curve: plot of LLF (ordinate) vs. FPF, where FPF is inferred using
highest rating of NL marks on <strong>non-diseased cases</strong>
</p>
</li>
<li><p> AFROC: alternative FROC, see Chakraborty 1989
</p>
</li>
<li><p> AFROC1 curve: plot of LLF (ordinate) vs. FPF1, where FPF1 is inferred using
highest rating of NL marks on <strong>ALL cases</strong>
</p>
</li>
<li> <p><code class="reqn">alpha</code>: The significance level <code class="reqn">\alpha</code> of the test of the null
hypothesis of no treatment effect
</p>
</li>
<li><p> AUC: area under curve; e.g., ROC-AUC = area under ROC curve, an
example of a FOM
</p>
</li>
<li> <p><em>b</em>: The width or &quot;b&quot; parameter of the conventional binormal
model
</p>
</li>
<li><p> Binormal model: two unequal variance normal distributions, one at zero
and one at <code class="reqn">mu</code>, for modeling ROC ratings, <code class="reqn">sigma</code> is the
std. dev. ratio of diseased to non-diseased distributions
</p>
</li>
<li><p> CAD: computer aided detection algorithm
</p>
</li>
<li><p> CBM: contaminated binormal model (CBM): two equal variance normal
distributions for modeling ROC ratings, the diseased distribution is
bimodal, with a peak at zero and one at <code class="reqn">\mu</code>, the integrated fraction
at <code class="reqn">\mu</code> is <code class="reqn">\alpha</code> (not to be confused with <code class="reqn">\alpha</code> of NH testing)
</p>
</li>
<li><p> CI: The (1-<code class="reqn">\alpha</code>) confidence interval for the stated statistic
</p>
</li>
<li><p> Crossed modality: a dataset containing two modality (treatment) factors, with
the levels of the two factors crossed, see paper by Thompson et al
</p>
</li>
<li><p> DBM: Dorfman-Berbaum-Metz, a significance testing method for
detecting a treatment effect in MRMC studies
</p>
</li>
<li><p> DBMH: Hillis' modification of the DBM method
</p>
</li>
<li><p> ddf: Denominator degrees of freedom of appropriate <code class="reqn">F</code>-test;
the corresponding ndf is <code>I</code> - 1
</p>
</li>
<li><p> Empirical AUC: trapezoidal area under curve, same as the Wilcoxon
statistic for ROC paradigm
</p>
</li>
<li><p> FN: false negative, a diseased case classified as non-diseased
</p>
</li>
<li><p> FOM: figure of merit, a quantitative measure of performance,
performance metric
</p>
</li>
<li><p> FP: false positive, a non-diseased case classified as diseased
</p>
</li>
<li><p> FPF: number of FPs divided by number of non-diseased cases
</p>
</li>
<li><p> FROC curve: plot of LLF (ordinate) vs. NLF
</p>
</li>
<li><p> FROC: free-response ROC (a data collection paradigm where each image
yields a random number, 0, 1, 2,..., of mark-rating pairs)
</p>
</li>
<li><p> FRRC: Analysis that treats readers as fixed and cases as random factors
</p>
</li>
<li><p> I: total number of modalities, indexed by <code class="reqn">i</code>
</p>
</li>
<li><p> image/case: used interchangeably; a case can consist of several images
of the same patient in the same treatment
</p>
</li>
<li><p> iMRMC: A text file format used for ROC data by FDA/CDRH researchers
</p>
</li>
<li><p> individual: A single-treatment single-reader dataset.
</p>
</li>
<li><p> Intrinsic: Used in connection with RSM; a parameter that is independent of
the RSM <code class="reqn">\mu</code> parameter, but whose meaning may not be as transparent as
the corresponding physical parameter
</p>
</li>
<li><p> J: number of readers, indexed by <code>j</code>
</p>
</li>
<li><p> JAFROC file format: A .xlsx format file, applicable to ROC, ROI, FROC and
LROC paradigms
</p>
</li>
<li><p> JAFROC: jackknife AFROC: Windows software for analyzing observer performance
data: no longer updated, replaced by current package; the name is a misnomer
as the jackknife is used only for significance testing; alternatively,
the bootstrap could be used; what distinguishes FROC from ROC analysis is the
use of the AFROC-AUC as the FOM. With this change, the DBM or the OR method
can be used for significance testing
</p>
</li>
<li> <p><code>K</code>: total number of cases, <code>K</code> = <code>K1</code> + <code>K2</code>, indexed by <code class="reqn">k</code>
</p>
</li>
<li> <p><code>K1</code>: total number of non-diseased cases, indexed by <code class="reqn">k1</code>
</p>
</li>
<li> <p><code>K2</code>: total number of diseased cases, indexed by <code class="reqn">k2</code>
</p>
</li>
<li><p> LL: lesion localization i.e., a mark that correctly locates an existing
localized lesion; TP is a special case, when the proximity criterion is
lax  (i.e., &quot;acceptance radius&quot; is large)
</p>
</li>
<li><p> LLF: number of LLs divided by the total number of lesions
</p>
</li>
<li><p> LROC: location receiver operating characteristic, a data collection paradigm
where each image yields a single rating and one location
</p>
</li>
<li><p> lrc/MRMC: A text file format used for ROC data by University of Iowa
researchers
</p>
</li>
<li><p> mark: the location of a suspected diseased region
</p>
</li>
<li><p> maxLL: maximum number of lesions per case in dataset
</p>
</li>
<li><p> maxNL: maximum number of NL marks per case in dataset
</p>
</li>
<li><p> MRMC: multiple reader multiple case (each reader interprets each case in
each treatment, i.e. fully crossed study design)
</p>
</li>
<li><p> ndf: Numerator degrees of freedom of appropriate <code class="reqn">F</code>-test, usually
number of treatments minus one
</p>
</li>
<li><p> NH: The null hypothesis that all treatment effects are zero; rejected
if the <code class="reqn">p</code>-value is smaller than <code class="reqn">\alpha</code>
</p>
</li>
<li><p> NL: non-lesion localization, of which FP is a special case, i.e., a
mark that does not correctly locate any existing localized lesion(s)
</p>
</li>
<li><p> NLF: number of NLs divided by the total number of cases
</p>
</li>
<li><p> Operating characteristic: A plot of normalized correct decisions on
diseased cases along ordinate vs. normalized incorrect decisions on
non-diseased cases
</p>
</li>
<li><p> Operating point: A point on an operating characteristic, e.g.,
(FPF, TPF) represents an operating point on an ROC
</p>
</li>
<li><p> OR: Obuchowski-Rockette, a significance testing method for detecting
a treatment effect in MRMC studies
</p>
</li>
<li><p> ORH: Hillis' modification of the OR method
</p>
</li>
<li><p> Physical parameter: Used in connection with RSM; a parameter whose
meaning is more transparent than the corresponding intrinsic parameter,
but which depends on the RSM <code class="reqn">\mu</code> parameter
</p>
</li>
<li><p> Proximity criterion / acceptance radius: Used in connection with FROC
(or LROC data); the &quot;nearness&quot; criterion is used to determine if a mark
is close enough to a lesion to be counted as a LL (or correct localization);
otherwise it is counted as a NL (or incorrect localization)
</p>
</li>
<li><p> p-value: the probability, under the null hypothesis, that the observed
treatment effects, or larger, could occur by chance
</p>
</li>
<li><p> Proper: a proper fit does not inappropriately fall below the chance
diagonal, does not display a &quot;hook&quot; near the upper right corner
</p>
</li>
<li><p> PROPROC: Metz's binormal model based fitting of proper ROC curves
</p>
</li>
<li><p> RSM, Radiological Search Model: two unit variance normal distributions
for modeling NL and LL ratings; four parameters, <code class="reqn">\mu</code>, <code class="reqn">\nu</code>',
<code class="reqn">\lambda</code>' and <code class="reqn">\zeta</code>1
</p>
</li>
<li><p> Rating: Confidence level assigned to a case; higher values indicate greater
confidence in presence of disease; <code>-Inf</code> is allowed but <code>NA</code> is
not allowed
</p>
</li>
<li><p> Reader/observer/radiologist/CAD: used interchangeably
</p>
</li>
<li><p> RJafroc: the current software
</p>
</li>
<li><p> ROC: receiver operating characteristic, a data collection paradigm where
each image yields a single rating and location information is ignored
</p>
</li>
<li><p> ROC curve: plot of TPF (ordinate) vs. FPF, as threshold is varied;
an example of an operating characteristic
</p>
</li>
<li><p> ROCFIT: Metz software for binormal model based fitting of ROC data
</p>
</li>
<li><p> ROI: region-of-interest (each case is divided into a number of ROIs and
the reader assigns an ROC rating to each ROI)
</p>
</li>
<li><p> FRRC: Analysis that treats readers as fixed and cases as random factors
</p>
</li>
<li><p> RRFC: Analysis that treats readers as random and cases as fixed factors
</p>
</li>
<li><p> RRRC: Analysis that treats both readers and cases as random factors
</p>
</li>
<li><p> RSCORE-II: original software for binormal model based fitting of ROC data
</p>
</li>
<li><p> RSM: Radiological search model, also method for fitting a proper ROC
curve to ROC data
</p>
</li>
<li><p> RSM-<code class="reqn">\zeta</code>1: Lowest reporting threshold, determines if suspicious
region is actually marked
</p>
</li>
<li><p> RSM-<code class="reqn">\lambda</code>: Intrinsic parameter of RSM corresponding to
<code class="reqn">\lambda</code>', independent of <code class="reqn">\mu</code>
</p>
</li>
<li><p> RSM-<code class="reqn">\lambda</code>': Physical Poisson parameter of RSM, average number of
latent NLs per case; depends on <code class="reqn">\mu</code>
</p>
</li>
<li><p> RSM-<code class="reqn">\mu</code>: separation of the unit variance distributions of RSM
</p>
</li>
<li><p> RSM-<code class="reqn">\nu</code>: Intrinsic parameter of RSM, corresponding to <code class="reqn">\nu</code>',
independent of <code class="reqn">\mu</code>
</p>
</li>
<li><p> RSM-<code class="reqn">\nu</code>': binomial parameter of RSM, probability that lesion is found
</p>
</li>
<li><p> SE: sensitivity, same as <code class="reqn">TPF</code>
</p>
</li>
<li><p> Significance testing: determining the p-value of a statistical test
</p>
</li>
<li><p> SP: specificity, same as <code class="reqn">1-FPF</code>
</p>
</li>
<li><p> Threshold: Reporting criteria: if confidence exceeds a threshold value,
report case as diseased, otherwise report non-diseased
</p>
</li>
<li><p> TN: true negative, a non-diseased case classified as non-diseased
</p>
</li>
<li><p> TP: true positive, a diseased case classified as diseased
</p>
</li>
<li><p> TPF: number of TPs divided by number of diseased cases
</p>
</li>
<li><p> Treatment/modality: used interchangeably, for example, computed tomography
(CT) images vs. magnetic resonance imaging (MRI) images
</p>
</li>
<li><p> wAFROC curve: plot of weighted LLF (ordinate) vs. FPF, where FPF is
inferred using highest rating of NL marks on <strong>non-diseased cases ONLY</strong>
</p>
</li>
<li><p> wAFROC1 curve: plot of weighted LLF (ordinate) vs. FPF1, where FPF1 is
inferred using highest rating of NL marks on <strong>ALL cases</strong>
</p>
</li>
<li><p> wAFROC1 FOM: weighted trapezoidal area under AFROC1 curve: only use
if there are zero non-diseased cases is always number of treatments minus one
</p>
</li></ul>



<h3>Dataset</h3>

<p>The <code>dataset</code> object has 3 <code>list</code> elements: <code>$ratings</code>, <code>$lesions</code>
and <code>$descriptions</code>, where:
</p>

<ul>
<li> <p><code>dataset$ratings</code>: contains 3 elements as sub-lists: <code>$NL</code>,
<code>$LL</code> and <code>$LL_IL</code>; these describe the structure of the ratings;
</p>
</li>
<li> <p><code>dataset$lesions</code>: contains 3 elements as sub-lists: <code>$perCase</code>,
<code>$IDs</code> and <code>$weights</code>; these describe the structure of the lesions;
</p>
</li>
<li> <p><code>dataset$descriptions</code>: contains 7 elements as sub-lists: <code>$fileName</code>,
<code>$type</code>, <code>$name</code>, <code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code>
and <code>$readerID</code>; these describe other characteristics of the dataset as
detailed next.
</p>
</li></ul>

<p><strong>Note: <code>-Inf</code> is used to indicate the ratings of unmarked lesions
and/or missing values.</strong> As an example of the latter, if the maximum
number of NLs in a dataset is 4, but some images have fewer than 4 NL marks,
the corresponding &quot;empty&quot; positions would be filled with
<code>-Inf</code>s. <strong>Do not use <code>NA</code> to denote a missing rating.</strong>
</p>
<p><strong>Note</strong>: <b>&quot;dataset&quot; in this package always represents
<code>R</code> object(s) with the following structure(s):</b>
</p>


<h4>General data structure, e.g., <code>dataset02</code>, an ROC dataset, and
<code>dataset05</code>, an FROC dataset.</h4>


<ul>
<li> <p><code>ratings$NL</code>: a float array with dimensions
<code>c(I, J, K, maxNL)</code>, containing the ratings of NL marks. The first
<code>K1</code> locations of the third index corresponds to NL marks on non-diseased
cases and the remaining locations correspond to NL marks on diseased
cases. The 4th dimension allows for multiple NL marks
on a case: the first index holds the first NL rating on the image,
the second holds the second NL rating on the image, etc. The value of
<code>maxNL</code> is determined by the case with the maximum number of lesions
per case in the dataset. For <b>FROC</b> datasets missing NL ratings are assigned the
<code>-Inf</code> rating. For <b>ROC</b> datasets, FP ratings are assigned
to the first <code>K1</code> elements of <code>NL[,,1:K1,1]</code> and the remaining
<code>K2</code> elements of <code>NL[,,(K1+1):K,1]</code> are set to <code>-Inf</code>.
</p>
</li>
<li> <p><code>ratings$LL</code>: for non-LROC datasets a float array with dimensions
<code>c(I, J, K2, maxLL)</code> containing the ratings of LL marks. The value of
<code>maxLL</code> is determined by the maximum number of lesions per case in the
dataset. Unmarked lesions are assigned the <code>-Inf</code> rating.
For ROC datasets <code>TP</code> ratings are assigned to <code>LL[,,1:K2,1]</code>.
For <b>LROC</b> datasets it is a float array with dimensions
<code>c(I, J, K2, 1)</code> containing the ratings of correct localizations,
otherwise the rating is recorded in the incorrect localization array
described next.
</p>
</li>
<li> <p><code>ratings$LL_IL</code>: for LROC datasets the ratings
of incorrect localization marks on abnormal cases. It is a float array
with dimensions <code>c(I, J, K2, 1)</code>. For non-LROC datasets this array
is filled with NAs.
</p>
</li>
<li> <p><code>lesions$perCase</code>: an integer array with length <code>K2</code>,
the number of lesions on each diseased case. The
maximum value of this array equals <code>maxLL</code>. For example,
<code>dataset05$lesions$perCase[4</code> is 2, meaning the
4th diseased case has two lesions.
</p>
</li>
<li> <p><code>lesions$IDs</code>: an integer array with dimensions [<code>K2</code>, <code>maxLL</code>],
labeling (or naming) the lesions on the diseased cases. For example,
<code>dataset05$lesions$IDs[4,]</code> is <code>c(1,2,-Inf)</code>, meaning the
4th diseased case has two lesions, labeled 1 and 2.
</p>
</li>
<li> <p><code>lesions$weights</code>: a floating point array with dimensions
<code>c(K2, maxLL)</code>, representing the relative importance of detecting
each lesion. The weights for an abnormal case must sum to unity.
For example, <code>dataset05$lesions$weights[4,]</code> is <code>c(0.5,0.5, -Inf)</code>,
corresponding to equal weights (0.5) assigned to of the two lesions in the
case.
</p>
</li>
<li> <p><code>descriptions$fileName</code>: a <code>character</code> variable containing the file
name of the source data for this dataset. This is generated automatically
by the <a href="#topic+DfReadDataFile">DfReadDataFile</a> function used to read the file. For a simulalated
dataset it is set to &quot;NA&quot; (i.e., a character vector, not the variable <code>NA</code>).
</p>
</li>
<li> <p><code>descriptions$type</code>: a <code>character</code> variable describing the data type:
&quot;<code>ROC</code>&quot;, &quot;<code>LROC</code>&quot;, &quot;<code>ROI</code>&quot; or &quot;<code>FROC</code>&quot;.
</p>
</li>
<li> <p><code>descriptions$name</code>: a <code>character</code> variable containing the name of
the dataset: e.g., &quot;dataset02&quot; or &quot;dataset05&quot;. This is generated automatically
by the <a href="#topic+DfReadDataFile">DfReadDataFile</a> function used to read the file.
</p>
</li>
<li> <p><code>descriptions$truthTableStr</code>: a <code>c(I, J, L, maxLL+1)</code> object. For
normal cases elements <code>c(I, J, L, 1)</code> are filled with 1s if the corresponding
interpretations occurred or NAs otherwise. For abnormal cases elements
<code>c(I, J, L, 2:(maxLL+1))</code> are filled with 1s if the corresponding
interpretations occurred or NAs otherwise. This object is necessary for analyzing
more complex designs, e.g., split-plot, as described next.
</p>
</li>
<li> <p><code>descriptions$design</code>: a <code>character</code> variable: &quot;<code>FCTRL</code>&quot;,
&quot;<code>SPLIT-PLOT-A</code>&quot; or &quot;<code>SPLIT-PLOT-A</code>&quot;, corresponding to factorial,
split-plot-A or split-plot-C designs. The A and C refer to subparts of Table VII
in a Hillis 2014 publication.
</p>
</li>
<li> <p><code>descriptions$modalityID</code>: a <code>character</code> vector of length <code class="reqn">I</code>,
which labels/names the modalities in the dataset. For non-JAFROC data file formats,
they must be unique integers.
</p>
</li>
<li> <p><code>descriptions$readerID</code>: a <code>character</code> vector of length <code class="reqn">J</code>,
which labels/names the readers in the dataset. For non-JAFROC data file formats,
they must be unique integers.
</p>
</li></ul>




<h4>ROI data structure, example <code>datasetROI</code></h4>

<p>Only changes from the previously described structure are described below:
</p>

<ul>
<li> <p><code>ratings$NL</code>: a float array with dimensions <code>c(I, J, K, Q)</code>
containing the ratings of each of Q quadrants for each non-diseased case.
</p>
</li>
<li> <p><code>ratings$LL</code>: a float array with dimensions
<code>c(I, J, K2, Q)</code> containing the ratings of quadrants for each
diseased case.
</p>
</li>
<li> <p><code>lesions$perCase</code>: this contains the locations, on abnormal cases,
containing at least one lesion.
</p>
</li></ul>




<h4>Crossed modality data structure, example <code>datasetCrossedModality</code></h4>

<p>Only changes from the previously described structure are described below:
</p>

<ul>
<li> <p><code>ratings$NL</code>: a float array with dimension <code>c(I1, I2, J, K, maxNL)</code>
containing the ratings of NL marks. Note the existence of two modality indices.
</p>
</li>
<li> <p><code>LL</code>: a float array with dimension <code>c(I1, I2, J, K2, maxLL)</code>
containing the ratings of all LL marks. Note the existence of two modality indices.
</p>
</li>
<li> <p><code>modalityID1</code>: corresponding to first modality factor.
</p>
</li>
<li> <p><code>modalityID2</code>: corresponding to second modality factor.
</p>
</li></ul>




<h3>Df: Datafile Related Functions</h3>


<ul>
<li> <p><code><a href="#topic+Df2RJafrocDataset">Df2RJafrocDataset</a></code>: Convert a ratings array to a
dataset object.
</p>
</li>
<li> <p><code><a href="#topic+DfBinDataset">DfBinDataset</a></code>: Return a binned dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfCreateCorCbmDataset">DfCreateCorCbmDataset</a></code>:Create paired dataset for
testing <a href="#topic+FitCorCbm">FitCorCbm</a>.
</p>
</li>
<li> <p><code><a href="#topic+DfExtractDataset">DfExtractDataset</a></code>: Extract a subset of modalities
and readers from a dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfFroc2Roc">DfFroc2Roc</a></code>: Convert an FROC dataset to a highest
rating inferred ROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfLroc2Roc">DfLroc2Roc</a></code>: Convert an LROC dataset to a highest
rating inferred ROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfLroc2Froc">DfLroc2Froc</a></code>: Simulates an
&quot;AUC-equivalent&quot; FROC dataset from a supplied LROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfFroc2Lroc">DfFroc2Lroc</a></code>: Simulates an
&quot;AUC-equivalent&quot; LROC dataset from a supplied FROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+DfReadCrossedModalities">DfReadCrossedModalities</a></code>: Read a crossed-modalities
data file.
</p>
</li>
<li> <p><code><a href="#topic+DfReadDataFile">DfReadDataFile</a></code>: Read a general data file.
</p>
</li>
<li> <p><code><a href="#topic+DfSaveDataFile">DfSaveDataFile</a></code>: Save ROC data file in a different format.
</p>
</li>
<li> <p><code><a href="#topic+DfExtractCorCbmDataset">DfExtractCorCbmDataset</a></code>: Extract two arms of a pairing
from an MRMC ROC dataset suitable for using <a href="#topic+FitCorCbm">FitCorCbm</a>.
</p>
</li></ul>



<h3>Fitting Functions</h3>


<ul>
<li> <p><code><a href="#topic+FitBinormalRoc">FitBinormalRoc</a></code>: Fit the binormal model to ROC data
(R equivalent of ROCFIT or RSCORE).
</p>
</li>
<li> <p><code><a href="#topic+FitCbmRoc">FitCbmRoc</a></code>: Fit the contaminated binormal model (CBM)
to ROC data.
</p>
</li>
<li> <p><code><a href="#topic+FitRsmRoc">FitRsmRoc</a></code>: Fit the radiological search model (RSM)
to ROC data.
</p>
</li>
<li> <p><code><a href="#topic+FitCorCbm">FitCorCbm</a></code>: Fit the correlated contaminated binormal model
(CORCBM) to paired ROC data.
</p>
</li>
<li> <p><code><a href="#topic+FitRsmRoc">FitRsmRoc</a></code>: Fit the radiological search model (RSM)
to ROC data.
</p>
</li></ul>



<h3>Plotting Functions</h3>


<ul>
<li> <p><code><a href="#topic+PlotBinormalFit">PlotBinormalFit</a></code>: Plot binormal-predicted ROC curve with
provided BM parameters.
</p>
</li>
<li> <p><code><a href="#topic+PlotEmpiricalOperatingCharacteristics">PlotEmpiricalOperatingCharacteristics</a></code>: Plot empirical
operating characteristics for specified dataset.
</p>
</li>
<li> <p><code><a href="#topic+PlotRsmOperatingCharacteristics">PlotRsmOperatingCharacteristics</a></code>: Plot RSM-fitted ROC curves.
</p>
</li></ul>



<h3>Simulation Functions</h3>


<ul>
<li> <p><code><a href="#topic+SimulateFrocDataset">SimulateFrocDataset</a></code>: Simulates an uncorrelated FROC dataset
using the RSM.
</p>
</li>
<li> <p><code><a href="#topic+SimulateRocDataset">SimulateRocDataset</a></code>: Simulates an uncorrelated binormal
model ROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+SimulateCorCbmDataset">SimulateCorCbmDataset</a></code>: Simulates an uncorrelated binormal
model ROC dataset.
</p>
</li>
<li> <p><code><a href="#topic+SimulateLrocDataset">SimulateLrocDataset</a></code>: Simulates an uncorrelated LROC dataset.
</p>
</li></ul>



<h3>Sample size Functions</h3>


<ul>
<li> <p><code><a href="#topic+SsPowerGivenJK">SsPowerGivenJK</a></code>: Calculate statistical power given
numbers of readers J and cases <code>K</code>.
</p>
</li>
<li> <p><code><a href="#topic+SsPowerTable">SsPowerTable</a></code>: Generate a power table.
</p>
</li>
<li> <p><code><a href="#topic+SsSampleSizeKGivenJ">SsSampleSizeKGivenJ</a></code>: Calculate number of cases <code>K</code>, for
specified number of readers J, to achieve desired power for an ROC study.
</p>
</li></ul>



<h3>Significance Testing Functions</h3>


<ul>
<li> <p><code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>: Perform significance testing,
DBM or OR.
</p>
</li>
<li> <p><code><a href="#topic+StSignificanceTestingCadVsRad">StSignificanceTestingCadVsRad</a></code>: Perform
significance testing, CAD vs. radiologists.
</p>
</li>
<li> <p><code><a href="#topic+StSignificanceTestingCrossedModalities">StSignificanceTestingCrossedModalities</a></code>: Perform
significance testing using crossed modalities analysis.
</p>
</li></ul>



<h3>Miscellaneous and Utility Functions</h3>


<ul>
<li> <p><code><a href="#topic+UtilAucBinormal">UtilAucBinormal</a></code>: Binormal model AUC function.
</p>
</li>
<li> <p><code><a href="#topic+UtilAucCBM">UtilAucCBM</a></code>: CBM AUC function.
</p>
</li>
<li> <p><code><a href="#topic+UtilAucPROPROC">UtilAucPROPROC</a></code>: PROPROC AUC function.
</p>
</li>
<li> <p><code><a href="#topic+UtilAnalyticalAucsRSM">UtilAnalyticalAucsRSM</a></code>: RSM ROC/AFROC AUC calculator.
</p>
</li>
<li> <p><code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code>: Calculate empirical figures of merit
(FOMs) for specified dataset.
</p>
</li>
<li> <p><code><a href="#topic+UtilIntrinsic2RSM">UtilIntrinsic2RSM</a></code>: Convert from intrinsic to
physical RSM parameters.
</p>
</li>
<li> <p><code><a href="#topic+UtilLesionWeightsMatrix">UtilLesionWeightsMatrix</a></code>: Calculates the lesion weights  matrix.
</p>
</li>
<li> <p><code><a href="#topic+UtilMeanSquares">UtilMeanSquares</a></code>: Calculates the mean squares used in the
DBMH and ORH methods.
</p>
</li>
<li> <p><code><a href="#topic+UtilOutputReport">UtilOutputReport</a></code>: Generate a formatted report file.
</p>
</li>
<li> <p><code><a href="#topic+UtilRSM2Intrinsic">UtilRSM2Intrinsic</a></code>: Convert from RSM parameters to
intrinsic RSM parameters.
</p>
</li>
<li> <p><code><a href="#topic+UtilPseudoValues">UtilPseudoValues</a></code>: Return jackknife pseudovalues.
</p>
</li>
<li> <p><code><a href="#topic+UtilVarComponentsDBM">UtilVarComponentsDBM</a></code>: Utility for Dorfman-Berbaum-Metz
variance components.
</p>
</li>
<li> <p><code><a href="#topic+UtilORVarComponentsFactorial">UtilORVarComponentsFactorial</a></code>: Utility for Obuchowski-Rockette
variance components.
</p>
</li></ul>



<h3>Author(s)</h3>


<ul>
<li><p> Author: Dev Chakraborty <a href="mailto:dpc10ster@gmail.com">dpc10ster@gmail.com</a>.
</p>
</li>
<li><p> Author: Xuetong Zhai <a href="mailto:xuetong.zhai@gmail.com">xuetong.zhai@gmail.com</a>.
</p>
</li>
<li><p> Contributor: Peter Phillips <a href="mailto:peter.phillips@cumbria.ac.uk">peter.phillips@cumbria.ac.uk</a>.
</p>
</li></ul>



<h3>References</h3>

<p><b>Basics of ROC</b>
</p>
<p>Metz, CE (1978). Basic principles of ROC analysis. In Seminars in nuclear medicine
(Vol. 8, pp. 283&ndash;298). Elsevier.
</p>
<p>Metz, CE (1986). ROC Methodology in Radiologic Imaging. Investigative Radiology,
21(9), 720.
</p>
<p>Metz, CE (1989). Some practical issues of experimental design and data analysis in
radiological ROC studies. Investigative Radiology, 24(3), 234.
</p>
<p>Metz, CE (2008). ROC analysis in medical imaging: a tutorial review of the
literature. Radiological Physics and Technology, 1(1), 2&ndash;12.
</p>
<p>Wagner, R. F., Beiden, S. V, Campbell, G., Metz, CE, &amp; Sacks, W. M. (2002).
Assessment of medical imaging and computer-assist systems: lessons from recent experience. Academic Radiology, 9(11), 1264&ndash;77.
</p>
<p>Wagner, R. F., Metz, CE, &amp; Campbell, G. (2007). Assessment of medical imaging
systems and computer aids: a tutorial review. Academic Radiology, 14(6), 723&ndash;48.
</p>
<p><b>DBM/OR methods and extensions</b>
</p>
<p>DORFMAN, D. D., BERBAUM, KS, &amp; Metz, CE (1992). Receiver operating characteristic
rating analysis: generalization to the population of readers and patients with
the jackknife method. Investigative Radiology, 27(9), 723.
</p>
<p>Obuchowski, NA, &amp; Rockette, HE (1994). HYPOTHESIS TESTING OF DIAGNOSTIC ACCURACY
FOR MULTIPLE READERS AND MULTIPLE TESTS: AN ANOVA APPROACH WITH DEPENDENT
OBSERVATIONS. Communications in Statistics-Simulation and Computation,
24(2), 285&ndash;308.
</p>
<p>Hillis, SL, Berbaum, KS, &amp; Metz, CE (2008). Recent developments in the
Dorfman-Berbaum-Metz procedure for multireader ROC study analysis.
Academic Radiology, 15(5), 647&ndash;61.
</p>
<p>Hillis, SL, Obuchowski, NA, &amp; Berbaum, KS (2011). Power Estimation for
Multireader ROC Methods: An Updated and Unified Approach. Acad Radiol, 18, 129&ndash;142.
</p>
<p>Hillis, SL SL (2007). A comparison of denominator degrees of freedom methods for
multiple observer ROC analysis. Statistics in Medicine, 26(3), 596&ndash;619.
</p>
<p><b>FROC paradigm</b>
</p>
<p>Chakraborty DP. Maximum Likelihood analysis of free-response receiver operating
characteristic (FROC) data. Med Phys. 1989;16(4):561&ndash;568.
</p>
<p>Chakraborty, DP, &amp; Berbaum, KS (2004). Observer studies involving detection and
localization: modeling, analysis, and validation. Medical Physics, 31(8), 1&ndash;18.
</p>
<p>Chakraborty, DP (2006). A search model and figure of merit for observer data acquired
according to the free-response paradigm. Physics in Medicine and Biology,
51(14), 3449&ndash;62.
</p>
<p>Chakraborty, DP (2006). ROC curves predicted by a model of visual search. Physics in
Medicine and Biology, 51(14), 3463&ndash;82.
</p>
<p>Chakraborty, DP (2011). New Developments in Observer Performance Methodology in
Medical Imaging. Seminars in Nuclear Medicine, 41(6), 401&ndash;418.
</p>
<p>Chakraborty, DP (2013). A Brief History of Free-Response Receiver Operating
Characteristic Paradigm Data Analysis. Academic Radiology, 20(7), 915&ndash;919.
</p>
<p>Chakraborty, DP, &amp; Yoon, H.-J. (2008). Operating characteristics predicted
by models for diagnostic tasks involving lesion localization. Medical
Physics, 35(2), 435.
</p>
<p>Thompson JD, Chakraborty DP, Szczepura <code>K</code>, et al. (2016) Effect of reconstruction methods
and x-ray tube current-time product  on nodule detection in an anthropomorphic
thorax phantom: a crossed-modality JAFROC observer study. Medical Physics.
43(3):1265-1274.
</p>
<p>Zhai X, Chakraborty DP. (2017) A bivariate contaminated binormal model for robust
fitting of proper ROC curves to a pair of correlated, possibly degenerate,
ROC datasets. Medical Physics. doi: 10.1002/mp.12263:2207&ndash;2222.
</p>
<p>Hillis SL, Chakraborty DP, Orton CG. ROC or FROC? It depends on the research
question. Medical Physics. 2017.
</p>
<p>Chakraborty DP, Nishikawa RM, Orton CG. Due to potential concerns of bias and
conflicts of interest, regulatory bodies should not do evaluation methodology
research related to their regulatory missions. Medical Physics. 2017.
</p>
<p>Dobbins III JT, McAdams HP, Sabol JM, Chakraborty DP, et al. (2016) Multi-Institutional
Evaluation of Digital Tomosynthesis, Dual-Energy Radiography, and Conventional
Chest Radiography for the Detection and Management of Pulmonary Nodules. Radiology. 282(1):236-250.
</p>
<p>Warren LM, Mackenzie A, Cooke J, et al. Effect of image quality on calcification
detection in digital mammography. Medical Physics. 2012;39(6):3202-3213.
</p>
<p>Chakraborty DP, Zhai X. On the meaning of the weighted alternative free-response
operating characteristic figure of merit. Medical physics. 2016;43(5):2548-2557.
</p>
<p>Chakraborty DP. (2017) Observer Performance Methods for Diagnostic Imaging -
Foundations, Modeling, and Applications with R-Based Examples.
Taylor-Francis, LLC.
</p>

<hr>
<h2 id='ChisqrGoodnessOfFit'>Compute the chisquare goodness of fit statistic for ROC fitting model</h2><span id='topic+ChisqrGoodnessOfFit'></span>

<h3>Description</h3>

<p>Compute the chisquare goodness of fit statistic for specified ROC data fitting model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ChisqrGoodnessOfFit(fpCounts, tpCounts, parameters, model, lesDistr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ChisqrGoodnessOfFit_+3A_fpcounts">fpCounts</code></td>
<td>
<p>The FP counts table</p>
</td></tr>
<tr><td><code id="ChisqrGoodnessOfFit_+3A_tpcounts">tpCounts</code></td>
<td>
<p>The TP counts table</p>
</td></tr>
<tr><td><code id="ChisqrGoodnessOfFit_+3A_parameters">parameters</code></td>
<td>
<p>The parameters of the model including cutoffs, see details</p>
</td></tr>
<tr><td><code id="ChisqrGoodnessOfFit_+3A_model">model</code></td>
<td>
<p>The fitting model: &quot;BINORMAL&quot;, &quot;CBM&quot; or &quot;RSM</p>
</td></tr>
<tr><td><code id="ChisqrGoodnessOfFit_+3A_lesdistr">lesDistr</code></td>
<td>
<p>The lesion distribution matrix; not needed for &quot;BINORMAL&quot; 
or &quot;CBM&quot; models. Array [1:maxLL,1:2]. The probability mass function of the 
lesion distribution for diseased cases. The first column contains the 
actual numbers of lesions per case. 
The second column contains the fraction of diseased cases with the number 
of lesions specified in the first column. 
The second column must sum to unity.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For model = &quot;BINORMAL&quot; the parameters are c(a,b,zetas).
For model = &quot;CBM&quot; the parameters are c(mu,alpha,zetas).
For model = &quot;RSM&quot; the parameters are c(mu,lambda,nu,zetas).
Due to the sparsity of the data, in most cases the goodness of fit statistic 
cannot be calculated as the criterion of at least 5 counts in each
cell (TP and FP) is usually not met. An exception dataset is shown below.
</p>


<h3>Value</h3>

<p>The return value is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>chisq</code></td>
<td>
<p>The chi-square statistic</p>
</td></tr>
<tr><td><code>pVal</code></td>
<td>
<p>The p-value of the fit</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The degrees of freedom</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Test with TONY data for which chisqr can be calculated
ds &lt;- DfFroc2Roc(dataset01)
fit &lt;- FitBinormalRoc(ds, 2, 3) # trt 2 and rdr 3
## fitted a,b and zeta parameters from preceding line were used to call the
## function as shown below:
fpCounts = c(119,  30,   9,  19,   7,   1)
tpCounts = c(10, 11,  7, 16, 29, 16)
gfit = ChisqrGoodnessOfFit(fpCounts, tpCounts, 
parameters = c(fit$a, fit$b, fit$zetas), model="BINORMAL") 
gfit



</code></pre>

<hr>
<h2 id='dataset01'>TONY FROC dataset</h2><span id='topic+dataset01'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;TONY&quot; dataset. It consists of 185 cases, 
89 of which are diseased, interpreted in two treatments
(&quot;BT&quot; = breast tomosynthesis and &quot;DM&quot; = digital mammography) by five radiologists using the FROC paradigm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset01
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:5, 1:185, 1:3], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:5, 1:89, 1:2], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:89], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:89, 1:2], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:89, 1:2], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset01&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;TONY&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:5, 1:185, 1:4] 1 1 1 1 ..., truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;BT&quot; &quot;DM&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Chakraborty DP, Svahn T (2011) Estimating the parameters of a model 
of visual search from ROC data: an alternate method for fitting proper ROC curves. 
PROC SPIE 7966.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset01)
PlotEmpiricalOperatingCharacteristics(dataset = dataset01, opChType = "wAFROC")$Plot

</code></pre>

<hr>
<h2 id='dataset02'>Van Dyke ROC dataset</h2><span id='topic+dataset02'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;VD&quot; dataset. It consists of 114 cases,
45 of which are diseased, interpreted in two treatments (&quot;0&quot; = single spin echo 
MRI, &quot;1&quot; = cine-MRI) by five radiologists using the ROC 
paradigm. Each diseased cases had an aortic dissection; the ROC paradigm 
generates one rating per case.  Often referred to in the ROC literature as the 
Van Dyke dataset, which, along with the Franken dataset, has been widely 
used to illustrate advances in ROC methodology. The example below displays 
the ROC plot for the first treatment and first reader.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset02
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:5, 1:114, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:5, 1:45, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:45], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:45, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:45, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset02&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;VAN-DYKE&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:5, 1:114, 1:2] 1 1 1 1 ..., truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;0&quot; &quot;1&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Van Dyke CW, et al. Cine MRI in the diagnosis of thoracic 
aortic dissection. 79th RSNA Meetings. 1993.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset02)
PlotEmpiricalOperatingCharacteristics(dataset = dataset02, opChType = "ROC")$Plot



</code></pre>

<hr>
<h2 id='dataset03'>Franken ROC dataset</h2><span id='topic+dataset03'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;FR&quot; dataset. It consists of 100 cases, 
67 of which are diseased, interpreted in two treatments,
&quot;0&quot; = conventional film radiographs, &quot;1&quot; = digitized  images viewed on monitors, by four 
radiologists using the ROC paradigm. Often referred to in the ROC literature as the 
Franken-dataset, which, along the the Van Dyke dataset, has been widely used to illustrate
advances in ROC methodology.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset03
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:4, 1:100, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:4, 1:67, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:67], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:67, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:67, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset03&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;FRANKEN&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:4, 1:100, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;TREAT1&quot; &quot;TREAT2&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr chr [1:4] &quot;READER_1&quot; &quot;READER_2&quot; &quot;READER_3&quot; &quot;READER_4&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Franken EA, et al. Evaluation of a Digital Workstation for Interpreting 
Neonatal Examinations: A Receiver Operating Characteristic Study. Investigative Radiology. 
1992;27(9):732-737.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset03)
PlotEmpiricalOperatingCharacteristics(dataset = dataset03, opChType = "ROC")$Plot


</code></pre>

<hr>
<h2 id='dataset04'>Federica Zanca FROC dataset</h2><span id='topic+dataset04'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;FED&quot; dataset. It consists of 200 mammograms, 
100 of which contained one to 3 simulated microcalcifications,
interpreted in five treatments (basically different image processing algorithms) by four 
radiologists using the FROC paradigm and a 5-point rating scale. The maximum number of NLs 
per case, over the entire dataset was 7 and the dataset contained at least one diseased 
mammogram with 3 lesions. The Excel file containing this dataset is 
/inst/extdata/datasets/FZ_ALL.xlsx. The normal cases are labeled 100:199 while the normal 
cases are labeled 0:99.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset04
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:5, 1:4, 1:200, 1:7], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:5, 1:4, 1:100, 1:3], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:100], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:100, 1:3], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:100, 1:3], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset04&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;FEDERICA&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:5, 1:4, 1:200, 1:4], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;1&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Zanca F et al. Evaluation of clinical image processing algorithms used 
in digital mammography. Medical Physics. 2009;36(3):765-775.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset04)
PlotEmpiricalOperatingCharacteristics(dataset = dataset04, opChType = "wAFROC")$Plot


</code></pre>

<hr>
<h2 id='dataset05'>John Thompson FROC dataset</h2><span id='topic+dataset05'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;JT&quot; dataset. It consists of 92 cases, 47 of 
which are diseased, interpreted in two treatments 
(&quot;1&quot; = CT images acquired for attenuation correction, &quot;2&quot; = diagnostic CT images), by nine 
radiographers using the FROC paradigm. Each case was a slice of an anthropomorphic phantom
47 with inserted nodular lesions (max 3 per slice). The maximum number of NLs per case, over the entire 
dataset was 7.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset05
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:9, 1:92, 1:7], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:9, 1:47, 1:3], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:47], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:47, 1:3], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:47, 1:3], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset05&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;THOMPSON&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:9, 1:92, 1:4], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Thompson JD  Hogg P, et al. (2014) A Free-Response Evaluation Determining Value in 
the Computed Tomography Attenuation Correction Image for Revealing Pulmonary 
Incidental Findings: A Phantom Study. Academic Radiology, 21 (4): 538-545.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset05)
PlotEmpiricalOperatingCharacteristics(dataset = dataset05, opChType = "wAFROC")$Plot


</code></pre>

<hr>
<h2 id='dataset06'>Magnus FROC dataset</h2><span id='topic+dataset06'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;MAG&quot; dataset (after Magnus Bath, 
who conducted the JAFROC analysis). It consists of 100 cases, 69 of which are diseased, 
interpreted in two treatments (&quot;1&quot; = conventional chest, &quot;1&quot; = chest tomosynthesis) by four 
radiologists using the FROC paradigm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset06
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:4, 1:89, 1:17], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:4, 1:42, 1:15], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:42], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:42, 1:15], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:42, 1:15], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset06&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;MAGNUS&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:4, 1:89, 1:16], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Vikgren J  et al. Comparison of Chest Tomosynthesis and Chest Radiography 
for Detection of Pulmonary Nodules: Human Observer Study of Clinical Cases. 
Radiology. 2008;249(3):1034-1041.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset06)
PlotEmpiricalOperatingCharacteristics(dataset = dataset06, opChType = "wAFROC")$Plot


</code></pre>

<hr>
<h2 id='dataset07'>Lucy Warren FROC dataset</h2><span id='topic+dataset07'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;OPT&quot; dataset (for OptiMam). It consists of 162 cases, 
81 of which are diseased, interpreted in five treatments (see reference, basically different ways
of acquiring the images) by seven radiologists using the FROC paradigm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset07
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:5, 1:7, 1:162, 1:4], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:5, 1:7, 1:81, 1:3], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:81], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:81, 1:3], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:81, 1:3], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset07&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;LUCY-WARREN&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:5, 1:7, 1:162, 1:4], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:7] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Warren LM, Mackenzie A, Cooke J, et al. Effect of image quality on 
calcification detection in digital mammography. 
Medical Physics. 2012;39(6):3202-3213.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset07)
PlotEmpiricalOperatingCharacteristics(dataset = dataset07, opChType = "wAFROC")$Plot


</code></pre>

<hr>
<h2 id='dataset08'>Monica Penedo ROC dataset</h2><span id='topic+dataset08'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;PEN&quot; dataset. It consists of 112 cases, 
64 of which are diseased, interpreted in five treatments (basically different image compression
algorithms) by five 
radiologists using the FROC paradigm (the inferred ROC dataset is included; the original FROC data
is lost).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset08
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:5, 1:5, 1:112, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:5, 1:5, 1:64, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:64], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:64, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:64, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset08&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;PENEDO&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:5, 1:5, 1:112, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ..., treatment labels
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Penedo et al. Free-Response Receiver Operating Characteristic 
Evaluation of Lossy JPEG2000 and Object-based Set Partitioning in 
Hierarchical Trees Compression of Digitized Mammograms. 
Radiology. 2005;237(2):450-457.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset08)
PlotEmpiricalOperatingCharacteristics(dataset = dataset08, opChType = "ROC")$Plot


</code></pre>

<hr>
<h2 id='dataset09'>Nico Karssemeijer ROC dataset (CAD vs. radiologists)</h2><span id='topic+dataset09'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;NICO&quot; dataset. It consists of 200 mammograms, 
80 of which contain one malignant mass, 
interpreted by a CAD system and nine radiologists using the 
LROC paradigm. The first reader is CAD. The highest rating was used to convert this to an ROC 
dataset. The original LROC data is <code>datasetCadLroc</code>. Analyzing this 
data requires methods described in the book, implemented in the function  
<code><a href="#topic+StSignificanceTestingCadVsRad">StSignificanceTestingCadVsRad</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset09
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:10, 1:200, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:10, 1:80, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:80], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:80, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:80, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset09&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;NICO-CAD-ROC&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1, 1:10, 1:200, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Hupse R  et al. Standalone computer-aided detection compared to radiologists' 
performance for the detection of mammographic masses. Eur Radiol. 2013;23(1):93-100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset09)
PlotEmpiricalOperatingCharacteristics(dataset = dataset09, rdrs = 1:10, opChType = "ROC")$Plot


</code></pre>

<hr>
<h2 id='dataset10'>Mark Ruschin ROC dataset</h2><span id='topic+dataset10'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;RUS&quot; dataset. It consists of 90 cases, 
40 of which are diseased, the images were
acquired at three dose levels, which can be regarded as treatments.
&quot;0&quot; = conventional film radiographs, &quot;1&quot; = digitized  images viewed on monitors, Eight 
radiologists interpreted the cases using the FROC paradigm. These have been reduced to 
ROC data by using the highest ratings (the original FROC data is lost).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset10
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:3, 1:8, 1:90, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:3, 1:8, 1:40, 1] , ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:40], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:40, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:40, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset10&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;RUSCHIN&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:3, 1:8, 1:90, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:3] &quot;1&quot; &quot;2&quot; &quot;3&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:8] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Ruschin M, et al. Dose dependence of mass and microcalcification 
detection in digital mammography: free response human observer studies. 
Med Phys. 2007;34:400 - 407.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset10)
PlotEmpiricalOperatingCharacteristics(dataset = dataset10, opChType = "ROC")$Plot


</code></pre>

<hr>
<h2 id='dataset11'>Dobbins 1 FROC dataset</h2><span id='topic+dataset11'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;DOB1&quot; dataset. Dobbins et al conducted a 
multi-institutional, MRMC study to compare the performance of digital tomosynthesis 
(GE's VolumeRad device), dual-energy (DE) imaging, and conventional chest 
radiography for pulmonary nodule detection and management. 
All study images were obtained with a flat-panel detector developed by GE. 
The case set consisted of 158 subjects, of which 43 were non-diseased and 
the rest had 1 - 20 pulmonary nodules independently verified, using with CT 
images, by 3 experts who did not participate in the observer study. The 
study used FROC paradigm data collection. There are 
4 treatments labeled 1 - 4 (conventional chest x-ray, CXR, CXR augmented
with dual-energy (CXR+DE), VolumeRad digital tomosynthesis images and 
VolumeRad augmented with DE (VolumeRad+DE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset11
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:4, 1:5, 1:158, 1:4], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:4, 1:5, 1:115, 1:20], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:115], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:115, 1:20], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:115, 1:20], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset11&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;DOBBINS-1&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:4, 1:5, 1:158, 1:21], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Dobbins III JT et al. Multi-Institutional Evaluation of Digital 
Tomosynthesis, Dual-Energy Radiography, and Conventional Chest Radiography 
for the Detection and Management of Pulmonary Nodules. Radiology. 2016;282(1):236-250.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset11)


</code></pre>

<hr>
<h2 id='dataset12'>Dobbins 2 ROC dataset</h2><span id='topic+dataset12'></span>

<h3>Description</h3>

<p>This is referred to in the code as the &quot;DOB2&quot; dataset. It contains actionability
ratings, i.e., do you recommend further follow up on the patient, one a 1 (definitely not)
to 5 (definitely yes), effectively an ROC dataset using a 5-point rating scale.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset12
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:4, 1:5, 1:152, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:4, 1:5, 1:88, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:88], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:88, 1], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:88, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset12&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;DOBBINS-2&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:4, 1:5, 1:152, 1:2] , truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Dobbins III JT et al. Multi-Institutional Evaluation of Digital 
Tomosynthesis, Dual-Energy Radiography, and Conventional Chest Radiography 
for the Detection and Management of Pulmonary Nodules. Radiology. 2016;282(1):236-250.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset12)


</code></pre>

<hr>
<h2 id='dataset13'>Dobbins 3 FROC dataset</h2><span id='topic+dataset13'></span>

<h3>Description</h3>

<p>This is referred to in the code as the &quot;DOB3&quot; dataset. This is a subset of DOB1 which includes
data for lesions not-visible on CXR, but visible to truth panel on all treatments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset13
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:4, 1:5, 1:158, 1:4], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:4, 1:5, 1:106, 1:15], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:106], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:106, 1:15], numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:106, 1:15], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset13&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;DOBBINS-3&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:4, 1:5, 1:158, 1:16], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Dobbins III JT et al. Multi-Institutional Evaluation of Digital 
Tomosynthesis, Dual-Energy Radiography, and Conventional Chest Radiography 
for the Detection and Management of Pulmonary Nodules. Radiology. 2016;282(1):236-250.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset13)


</code></pre>

<hr>
<h2 id='dataset14'>Federica Zanca real (as opposed to inferred) ROC dataset</h2><span id='topic+dataset14'></span>

<h3>Description</h3>

<p>This is referred to in the book as the &quot;FZR&quot; dataset. It is a real ROC study, 
conducted on the same images and using the same radiologists, on treatments
&quot;4&quot; and &quot;5&quot; of dataset04. This was compared to highest rating inferred ROC
data from dataset04 to conclude, erroneously, that the highest rating assumption
is invalid. See book Section 13.6.2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataset14
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:4, 1:200, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:4, 1:100, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:100], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:100, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:100, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;dataset14&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;FEDERICA-REAL-ROC&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:4, 1:200, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;4&quot; &quot;5&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Zanca F, Hillis SL, Claus F, et al (2012) Correlation of free-response and 
receiver-operating-characteristic area-under-the-curve estimates: Results from 
independently conducted FROC/ROC studies in mammography. 
Med Phys. 39(10):5917-5929.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(dataset14)


</code></pre>

<hr>
<h2 id='datasetBinned123'>Binned dataset suitable for checking <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>; seed = 123</h2><span id='topic+datasetBinned123'></span>

<h3>Description</h3>

<p>A binned dataset suitable for analysis by <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>. It was generated by
<a href="#topic+DfCreateCorCbmDataset">DfCreateCorCbmDataset</a> by setting the <code>seed</code> variable to 123. Note
the formatting of the data as a single treatment two reader dataset, even though
the actual pairing might be different, see <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>. The dataset is 
intentionally large so as to demonstrate the asymptotic convergence of ML estimates, 
produced by <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>, to the population values. The data was generated
by the following argument values to <code><a href="#topic+DfCreateCorCbmDataset">DfCreateCorCbmDataset</a></code>: seed = 123, 
K1 = 5000, K2 = 5000, desiredNumBins = 5, muX = 1.5, muY = 3, alphaX = 0.4, 
alphaY = 0.7, rhoNor = 0.3, rhoAbn2 = 0.8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetBinned123
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:2, 1:10000, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:2, 1:5000, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:5000], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:5000, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:5000, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetBinned123&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-CORCBM-SEED-123&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017). A bivariate contaminated binormal model for robust 
fitting of proper ROC curves to a pair of correlated, possibly degenerate, 
ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(datasetBinned123)

</code></pre>

<hr>
<h2 id='datasetBinned124'>Binned dataset suitable for checking <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>; seed = 124</h2><span id='topic+datasetBinned124'></span>

<h3>Description</h3>

<p>A binned dataset suitable for analysis by <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>. It was generated by
<code><a href="#topic+DfCreateCorCbmDataset">DfCreateCorCbmDataset</a></code> by setting the <code>seed</code> variable to 124. 
Otherwise similar to <code><a href="#topic+datasetBinned123">datasetBinned123</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetBinned124
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:2, 1:10000, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:2, 1:5000, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:5000], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:5000, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:5000, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetBinned124&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-CORCBM-SEED-124&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017). A bivariate contaminated binormal model for robust 
fitting of proper ROC curves to a pair of correlated, possibly degenerate, 
ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(datasetBinned124)

</code></pre>

<hr>
<h2 id='datasetBinned125'>Binned dataset suitable for checking <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>; seed = 125</h2><span id='topic+datasetBinned125'></span>

<h3>Description</h3>

<p>A binned dataset suitable for analysis by <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>. It was generated by
<code><a href="#topic+DfCreateCorCbmDataset">DfCreateCorCbmDataset</a></code> by setting the <code>seed</code> variable to 125. 
Otherwise similar to <code><a href="#topic+datasetBinned123">datasetBinned123</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetBinned125
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:2, 1:10000, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:2, 1:5000, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:5000], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:5000, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:5000, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetBinned125&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-CORCBM-SEED-125&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017). A bivariate contaminated binormal model for robust 
fitting of proper ROC curves to a pair of correlated, possibly degenerate, 
ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(datasetBinned125)

</code></pre>

<hr>
<h2 id='datasetCadLroc'>Nico Karssemeijer LROC dataset (CAD vs. radiologists)</h2><span id='topic+datasetCadLroc'></span>

<h3>Description</h3>

<p>This is the actual LROC data corresponding to <code>dataset09</code>, which was the inferred
ROC data. Note that the <code>LL</code> field is split into two, <code>LL</code>, representing true 
positives where the lesions were correctly localized, and <code>LL_IL</code>, representing true 
positives where the lesions were incorrectly localized. The first reader is CAD
and the remaining readers are radiologists.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetCadLroc
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:10, 1:200, 1], ratings of localizations on normal cases
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:10, 1:80, 1], ratings of correct localizations on abnormal cases
</p>
</li>
<li><p><code>rating$LL_IL</code>num [1, 1:10, 1:80, 1], ratings of incorrect localizations on abnormal cases
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:80], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:80, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:80, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetCadLroc&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;LROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;NICO-CAD-LROC&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:4, 1:200, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Hupse R  et al. Standalone computer-aided detection compared to radiologists' 
performance for the detection of mammographic masses. Eur Radiol. 2013;23(1):93-100.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(datasetCadLroc)


</code></pre>

<hr>
<h2 id='datasetCadSimuFroc'>Simulated FROC CAD vs. RAD dataset</h2><span id='topic+datasetCadSimuFroc'></span>

<h3>Description</h3>

<p>Simulated FROC CAD vs. RAD dataset suitable for checking code. It was generated 
from datasetCadLroc using SimulateFrocFromLrocData.R. The LROC paradigm always 
yields a single mark per case. Therefore 
the equivalent FROC will also have only one mark per case. The NL arrays 
of the two datasets are identical. The LL array is created by copying the
LL (correct localiztion) array of the LROC dataset to the LL array of the FROC 
dataset, from 
diseased case index k2 = 1 to k2 = K2. Additionally, the LL_IL array of the 
LROC dataset is copied to the NL array of the FROC dataset, starting at case 
index k1 = K1+1 to k1 = K1+K2. Any zero ratings are replace by -Infs. The 
equivalent FROC dataset has the same HrAuc as the original LROC dataset. 
See example. The main use of this dataset &amp; function is to test the CAD significance
testing functions using CAD FROC datasets, which I currently don't have.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetCadSimuFroc
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1:10, 1:200, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1:10, 1:80, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:80], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:80, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:80, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetCadSimuFroc&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;LROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;NICO-CAD-LROC&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, num [1:2, 1:4, 1:200, 1:2], truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:10] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>


<hr>
<h2 id='datasetCrossedModality'>John Thompson crossed treatment FROC dataset</h2><span id='topic+datasetCrossedModality'></span>

<h3>Description</h3>

<p>This is a crossed treatment dataset, see book Section 18.5. There are two treatment factors. 
The first treatment factor <code>modalityID1</code> can be &quot;F&quot; or &quot;I&quot;, which represent two CT reconstruction
algorithms. The second treatment factor <code>modalityID2</code> can be &quot;20&quot; &quot;40&quot;  &quot;60&quot;  &quot;80&quot;, which 
represent the mAs values of the image acquisition. The factors are fully crossed. The function 
<code><a href="#topic+StSignificanceTestingCrossedModalities">StSignificanceTestingCrossedModalities</a></code> analyzes such datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetCrossedModality
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:4, 1:11, 1:68, 1:5], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:4, 1:11, 1:34, 1:3], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:34], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:34, 1:3] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:34, 1:3], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetCrossedModality&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;THOMPSON-X-MOD&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;F&quot; &quot;I&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;20&quot; &quot;40&quot; &quot;60&quot; &quot;80&quot;, reader labels
</p>
</li></ul>



<h3>References</h3>

<p>Thompson JD, Chakraborty DP, et al. (2016) Effect of reconstruction 
methods and x-ray tube current-time product  on nodule detection in an 
anthropomorphic thorax phantom: a crossed-treatment JAFROC observer study. 
Medical Physics. 43(3):1265-1274.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>str(datasetCrossedModality)


</code></pre>

<hr>
<h2 id='datasetDegenerate'>Simulated degenerate ROC dataset (for testing purposes)</h2><span id='topic+datasetDegenerate'></span>

<h3>Description</h3>

<p>A simulated degenerated dataset. A degenerate dataset is defined as one with
no interior operating points on the ROC plot. Such data tend to be observed with expert level 
radiologists. This dataset is used to illustrate the robustness of two fitting models, namely
CBM and RSM. The widely used binormal model and PROPROC fail on such datasets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetDegenerate
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1, 1, 1:15, 1], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1, 1, 1:10, 1], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:10], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:10, 1] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:10, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetDegenerate&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-DEGENERATE&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr &quot;1&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr &quot;1&quot;, reader labels
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>str(datasetDegenerate)


</code></pre>

<hr>
<h2 id='datasetFROCSpC'>Simulated FROC SPLIT-PLOT-C dataset</h2><span id='topic+datasetFROCSpC'></span>

<h3>Description</h3>

<p>Simulated from FED Excel dataset by successively ignoring readers 3:4, c(1,3:4), 
c(1:2,4), etc.
created simulated split plot Excel dataset from Fed dataset: 
confirmed it is read without error
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetFROCSpC
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:4, 1:200, 1:7], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:4, 1:100, 1:3], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:100], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:100, 1:3] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:100, 1:3], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetFROCSpC&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;FROC&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-FROC-SPLIT-PLOT-C&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;4&quot; &quot;5&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:4] &quot;1&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;, reader labels
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>str(datasetFROCSpC)

</code></pre>

<hr>
<h2 id='datasetROI'>Simulated ROI dataset</h2><span id='topic+datasetROI'></span>

<h3>Description</h3>

<p>TBA Simulated ROI dataset: assumed are 4 ROIs per case, 5 readers, 50 non-dieased and 40 diseased cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>datasetROI
</code></pre>


<h3>Format</h3>

<p>A list with 3 elements: <code>$ratings</code>, <code>$lesions</code> and <code>$descriptions</code>; <code>$ratings</code>
contain 3 elements, <code>$NL</code>, <code>$LL</code> and <code>$LL_IL</code> as sub-lists; <code>$lesions</code>
contain 3 elements, <code>$perCase</code>, <code>$IDs</code> and <code>$weights</code> as sub-lists; <code>$descriptions</code>
contain 7 elements, <code>$fileName</code>, <code>$type</code>, <code>$name</code>,
<code>$truthTableStr</code>, <code>$design</code>, <code>$modalityID</code> and <code>$readerID</code> as sub-lists;
</p>

<ul>
<li><p><code>rating$NL</code>, num [1:2, 1:5, 1:90, 1:4], ratings of non-lesion localizations, NLs
</p>
</li>
<li><p><code>rating$LL</code>, num [1:2, 1:5, 1:40, 1:4], ratings of lesion localizations, LLs
</p>
</li>
<li><p><code>rating$LL_IL</code>NA, this placeholder is used only for LROC data
</p>
</li>
<li><p><code>lesions$perCase</code>, int [1:40], number of lesions per diseased case
</p>
</li>
<li><p><code>lesions$IDs</code>, num [1:40, 1:4] , numeric labels of lesions on diseased cases
</p>
</li>
<li><p><code>lesions$weights</code>, num [1:40, 1:4], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>descriptions$fileName</code>, chr, &quot;datasetROI&quot;, base name of dataset in 'data' folder
</p>
</li>
<li><p><code>descriptions$type</code>, chr &quot;ROI&quot;, the data type
</p>
</li>
<li><p><code>descriptions$name</code>, chr &quot;SIM-ROI&quot;, the name of the dataset
</p>
</li>
<li><p><code>descriptions$truthTableStr</code>, NA, truth table structure
</p>
</li>
<li><p><code>descriptions$design</code>, chr &quot;FCTRL-X-MOD&quot;, study design, factorial dataset
</p>
</li>
<li><p><code>descriptions$modalityID</code>, chr [1:2] &quot;1&quot; &quot;2&quot;, treatment label(s)
</p>
</li>
<li><p><code>descriptions$readerID</code>, chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ..., reader labels
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>str(datasetROI)


</code></pre>

<hr>
<h2 id='Df2RJafrocDataset'>Convert ratings arrays to an RJafroc dataset</h2><span id='topic+Df2RJafrocDataset'></span>

<h3>Description</h3>

<p>Converts ratings arrays, ROC or FROC, <em>but not LROC</em>, to an <span class="pkg">RJafroc</span> dataset, thereby allowing the 
user to leverage the file I/O, plotting and analyses capabilities of <span class="pkg">RJafroc</span>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Df2RJafrocDataset(NL, LL, InputIsCountsTable = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Df2RJafrocDataset_+3A_nl">NL</code></td>
<td>
<p>Non-lesion localizations array (or FP array for ROC data).</p>
</td></tr>
<tr><td><code id="Df2RJafrocDataset_+3A_ll">LL</code></td>
<td>
<p>Lesion localizations array (or TP array for ROC data).</p>
</td></tr>
<tr><td><code id="Df2RJafrocDataset_+3A_inputiscountstable">InputIsCountsTable</code></td>
<td>
<p>If <code>TRUE</code>, the <code>NL</code> and <code>LL</code> 
arrays are rating-counts tables, with common lengths equal to the 
number of ratings <code>R</code>, if <code>FALSE</code>, the default, these are arrays 
of lengths <code>K1</code>, the number of non-diseased cases, and <code>K2</code>, 
the number of diseased cases, respectively.</p>
</td></tr>
<tr><td><code id="Df2RJafrocDataset_+3A_...">...</code></td>
<td>
<p>Other elements of <span class="pkg">RJafroc</span> dataset that may, depending on the 
context, need to be specified. <code>perCase</code> <strong>must</strong> be specified 
if an FROC dataset is to be returned. It is a <code>K2</code>-length array 
specifying the numbers of lesions in each diseased case in the dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function &quot;senses&quot; the data type (ROC or FROC) from the the absence 
or presence of <code>perCase</code>.
</p>

<ul>
<li><p>ROC data can be <code>NL[1:K1]</code> and <code>LL[1:K2]</code> or <code>NL[1:I,1:J,1:K1]</code> 
and <code>LL[1:I,1:J,1:K2]</code>.
</p>
</li>
<li><p>FROC data can be <code>NL[1:K1,1:maxNL]</code> and <code>LL[1:K2, 1:maxLL]</code> or 
<code>NL[1:I,1:J,1:K1,1:maxNL]</code> and  <code>LL[1:I,1:J,1:K2,1:maxLL]</code>.
</p>
</li></ul>
 
<p>Here <code>maxNL/maxLL</code> = maximum numbers of NLs/LLs, per case, over entire dataset.  
Equal weights are assigned to every lesion (FROC data). 
Consecutive characters/integers starting with &quot;1&quot; are assigned to <code>IDs</code>, <code>modalityID</code> and <code>readerID</code>.
</p>


<h3>Value</h3>

<p>A dataset with the structure described in <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Input as ratings arrays
set.seed(1);NL &lt;- rnorm(5);LL &lt;- rnorm(7)*1.5 + 2
dataset &lt;- Df2RJafrocDataset(NL, LL)

## Input as counts tables
K1t &lt;- c(30, 19, 8, 2, 1)
K2t &lt;- c(5,  6, 5, 12, 22)
dataset &lt;- Df2RJafrocDataset(K1t, K2t, InputIsCountsTable = TRUE)


</code></pre>

<hr>
<h2 id='DfBinDataset'>Returns a binned dataset</h2><span id='topic+DfBinDataset'></span>

<h3>Description</h3>

<p>Bins continuous (i.e. floating point) or quasi-continuous (e.g. integers 0-100)
ratings in a dataset and returns the corresponding binned dataset in which the ratings are integers
1, 2,...., with higher values representing greater confidence in presence of disease
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfBinDataset(dataset, desiredNumBins = 7, opChType)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfBinDataset_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be binned, with structure as in <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
<tr><td><code id="DfBinDataset_+3A_desirednumbins">desiredNumBins</code></td>
<td>
<p>The desired number of bins. The default is 7.</p>
</td></tr>
<tr><td><code id="DfBinDataset_+3A_opchtype">opChType</code></td>
<td>
<p>The operating characteristic relevant to the binning operation: 
<code>"ROC"</code>, <code>"FROC"</code>, <code>"AFROC"</code>, or <code>"wAFROC"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For small datasets the number of bins may be smaller than <code>desiredNumBins</code>.
<strong>The algorithm needs to know the type of operating characteristic 
relevant to the binning operation.</strong> For ROC the bins are FP and TP counts, for 
FROC the bins are NL and LL counts, for AFROC the bins are FP and LL counts, 
and for wAFROC the bins are FP and wLL counts. Binning is generally
employed prior to fitting a statistical model, e.g., maximum likelihood, to the data.
This version chooses ctffs so as to maximize empirical AUC (this yields a 
unique choice of ctffs which gives the reader the maximum deserved credit).
</p>


<h3>Value</h3>

<p>The binned dataset
</p>


<h3>References</h3>

<p>Miller GA (1956) The Magical Number Seven, Plus or Minus Two:
Some limits on our capacity for processing information, The Psychological Review 63, 81-97
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
binned &lt;- DfBinDataset(dataset02, desiredNumBins = 3, opChType = "ROC")
binned &lt;- DfBinDataset(dataset05, desiredNumBins = 4, opChType = "ROC")
binned &lt;- DfBinDataset(dataset05, desiredNumBins = 4, opChType = "AFROC")
binned &lt;- DfBinDataset(dataset05, desiredNumBins = 4, opChType = "wAFROC")
binned &lt;- DfBinDataset(dataset05, opChType = "wAFROC", desiredNumBins = 1)
binned &lt;- DfBinDataset(dataset05, opChType = "wAFROC", desiredNumBins = 2)
binned &lt;- DfBinDataset(dataset05, opChType = "wAFROC", desiredNumBins = 3)
## etc.

 

## takes longer than 5 sec on OSX
dataset &lt;- SimulateRocDataset(I = 2, J = 5, K1 = 50, K2 = 70, a = 1, b = 0.5, seed = 123)
datasetB &lt;- DfBinDataset(dataset, desiredNumBins = 7, opChType = "ROC")
fomOrg &lt;- as.matrix(UtilFigureOfMerit(dataset, FOM = "Wilcoxon"))
print(fomOrg)
fomBinned &lt;- as.matrix(UtilFigureOfMerit(datasetB, FOM = "Wilcoxon"))
print(fomBinned)
cat("mean, sd = ", mean(fomOrg), sd(fomOrg), "\n")
cat("mean, sd = ", mean(fomBinned), sd(fomBinned), "\n")



</code></pre>

<hr>
<h2 id='DfCreateCorCbmDataset'>Create paired dataset for testing <code><a href="#topic+FitCorCbm">FitCorCbm</a></code></h2><span id='topic+DfCreateCorCbmDataset'></span>

<h3>Description</h3>

<p>The paired dataset is generated using bivariate sampling; 
details are in referenced publication
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfCreateCorCbmDataset(
  seed = 123,
  K1 = 50,
  K2 = 50,
  desiredNumBins = 5,
  muX = 1.5,
  muY = 3,
  alphaX = 0.4,
  alphaY = 0.7,
  rhoNor = 0.3,
  rhoAbn2 = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfCreateCorCbmDataset_+3A_seed">seed</code></td>
<td>
<p>The seed variable, default is 123; set to NULL for truly random seed</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_k1">K1</code></td>
<td>
<p>The number of non-diseased cases, default is 50</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_k2">K2</code></td>
<td>
<p>The number of diseased cases, default is 50</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_desirednumbins">desiredNumBins</code></td>
<td>
<p>The desired number of bins; default is 5</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_mux">muX</code></td>
<td>
<p>The CBM <code class="reqn">\mu</code> parameter in condition X</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_muy">muY</code></td>
<td>
<p>The CBM <code class="reqn">\mu</code> parameter in condition Y</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_alphax">alphaX</code></td>
<td>
<p>The CBM <code class="reqn">\alpha</code> parameter in condition X</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_alphay">alphaY</code></td>
<td>
<p>The CBM &lsquo;<span class="samp">&#8288;alpha&#8288;</span>&rsquo; parameter in condition Y</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_rhonor">rhoNor</code></td>
<td>
<p>The correlation of non-diseased case z-samples</p>
</td></tr>
<tr><td><code id="DfCreateCorCbmDataset_+3A_rhoabn2">rhoAbn2</code></td>
<td>
<p>The correlation of diseased case z-samples, when disease is
visible in both conditions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The ROC data is bined to 5 bins in each condition.
</p>


<h3>Value</h3>

<p>The return value is the desired dataset, suitable for testing <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>.
</p>


<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017) A bivariate contaminated binormal model for robust fitting of proper ROC
curves to a pair of correlated, possibly degenerate, ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## seed &lt;- 1 
## this gives unequal numbers of bins in X and Y conditions for 50/50 dataset
dataset &lt;- DfCreateCorCbmDataset()


## this takes very long time!! used to show asymptotic convergence of ML estimates 
## dataset &lt;- DfCreateCorCbmDataset(K1 = 5000, K2 = 5000)



</code></pre>

<hr>
<h2 id='DfExtractCorCbmDataset'>Extract two arms of a pairing from an MRMC ROC dataset</h2><span id='topic+DfExtractCorCbmDataset'></span>

<h3>Description</h3>

<p>Extract a paired dataset from a larger dataset. The pairing could be
two readers in the same
treatment, or different readers in different treatments, or the same reader
in different treatments. If necessary
The data is binned to 5 bins in each condition.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfExtractCorCbmDataset(dataset, trts = 1, rdrs = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfExtractCorCbmDataset_+3A_dataset">dataset</code></td>
<td>
<p>The original dataset from which the pairing is to be extracted</p>
</td></tr>
<tr><td><code id="DfExtractCorCbmDataset_+3A_trts">trts</code></td>
<td>
<p>A vector, maximum length 2, contains the indices of the treatment
or treatments to be extracted</p>
</td></tr>
<tr><td><code id="DfExtractCorCbmDataset_+3A_rdrs">rdrs</code></td>
<td>
<p>A vector, maximum length 2, contains the indices of the reader or
readers to be extracted</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The desired pairing is contained in the vectors <code>trts</code> and <code>rdrs</code>.
If either has length one, the other must
have length two and the pairing is implicit. If both are length two, then the pairing
is that implied by the first treatement
and the second reader, which is one arm, and the other arm is that implied by the second
treatment paired with the first
reader. Using this method any allowed pairing can be extracted and analyzed by <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>.
The utility of this software is
in designing a ratings simulator that is statistically matched to a real dataset.
</p>


<h3>Value</h3>

<p>A new dataset in which the number of treatments is one and the number of readers is two
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Extract the paired data corresponding to the second and third readers in the first treatment
## from the included ROC dataset
dataset11_23 &lt;- DfExtractCorCbmDataset(dataset05, trts = 1, rdrs = c(2,3))

## Extract the paired data corresponding to the third reader in the first and second treatments
dataset12_33 &lt;- DfExtractCorCbmDataset(dataset05, trts = c(1,2), rdrs = 3)

## Extract the data corresponding to the first reader in the first
## treatment paired with the data
## from the third reader in the second treatment
## (the bin indices are at different positions in the two arrays)
dataset12_13 &lt;- DfExtractCorCbmDataset(dataset05,
trts = c(1,2), rdrs = c(1,3))

</code></pre>

<hr>
<h2 id='DfExtractDataset'>Extract a subset of treatments and readers from a dataset</h2><span id='topic+DfExtractDataset'></span>

<h3>Description</h3>

<p>Extract a dataset consisting of a subset of treatments/readers from a larger dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfExtractDataset(dataset, trts, rdrs)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfExtractDataset_+3A_dataset">dataset</code></td>
<td>
<p>The original dataset from which the subset is to be extracted</p>
</td></tr>
<tr><td><code id="DfExtractDataset_+3A_trts">trts</code></td>
<td>
<p>A vector contains the indices of the treatments to be extracted. 
<strong>If this parameter is not supplied, all treatments are extracted.</strong></p>
</td></tr>
<tr><td><code id="DfExtractDataset_+3A_rdrs">rdrs</code></td>
<td>
<p>A vector contains the indices of the readers to be extracted. 
<strong>If this parameter is not supplied, all readers are extracted.</strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Note</strong> that <code>trts</code> and <code>rdrs</code> are the vectors of <strong>indices</strong> 
not <strong>IDs</strong>. For example, if the ID of the first reader is &quot;0&quot;, the 
corresponding value in <code>trts</code> should be <strong>1</strong>  not <strong>0</strong>.
</p>


<h3>Value</h3>

<p>A new dataset containing only the specified treatments and readers that were
extracted from the original dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Extract the data corresponding to the second reader in the 
## first treatment from an included ROC dataset
ds1 &lt;- DfExtractDataset(dataset05, trts = 1, rdrs = 2)

## Extract the data of the first and third reader in all 
## treatment from the included ROC dataset
ds2 &lt;- DfExtractDataset(dataset05, rdrs = c(1, 3))

</code></pre>

<hr>
<h2 id='DfFroc2Lroc'>Simulates an &quot;AUC-equivalent&quot; LROC dataset from an FROC dataset</h2><span id='topic+DfFroc2Lroc'></span>

<h3>Description</h3>

<p>Simulates a multiple-treatment multiple-reader &quot;AUC-equivalent&quot; 
LROC dataset from a supplied FROC dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfFroc2Lroc(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfFroc2Lroc_+3A_dataset">dataset</code></td>
<td>
<p>The FROC dataset to be converted to LROC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The FROC paradigm can have 0 or more marks per case. However, 
LROC is restricted to <b>exactly one mark per case</b>. For the NL array 
of the LROC data, for non-disesed cases, the <b>highest</b> rating of the 
FROC marks, or -Inf if there are no marks, is copied to case index 
k1 = 1 to k1 = K1 of the LROC dataset. For each diseased case, if the 
max LL rating exceeds the max NL rating, then the max LL rating is copied 
to the LL array, otherwise the max NL rating is copied to the LL_IL array. 
The max NL rating on each diseased case is then set to -Inf (since the LROC
paradigm only allows one mark. The equivalent FROC dataset has the same 
HrAuc as the original LROC dataset. See example. The main use of this 
function is to test the Significance testing functions using MRMC LROC 
datasets, which I currently don't have.
</p>


<h3>Value</h3>

<p>The equivalent LROC dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
lrocDataset &lt;- DfFroc2Lroc(dataset05)
frocHrAuc &lt;- UtilFigureOfMerit(dataset05, FOM = "HrAuc")   
lrocWilcoxonAuc &lt;- UtilFigureOfMerit(lrocDataset, FOM = "Wilcoxon")
## expect_equal(frocHrAuc, lrocWilcoxonAuc)

</code></pre>

<hr>
<h2 id='DfFroc2Roc'>Convert an FROC dataset to an ROC dataset</h2><span id='topic+DfFroc2Roc'></span>

<h3>Description</h3>

<p>Convert an FROC dataset to a highest rating inferred ROC dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfFroc2Roc(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfFroc2Roc_+3A_dataset">dataset</code></td>
<td>
<p>The FROC dataset to be converted, <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first member of the ROC dataset is <code>NL</code>, whose 3rd dimension has
length <code>(K1 + K2)</code>, the total number of cases. Ratings of cases <code>(K1 + 1)</code> 
through <code>(K1 + K2)</code> are <code>-Inf</code>. <strong>This is because in an ROC dataset 
FPs are only possible on non-diseased cases.</strong>The second member of the list is <code>LL</code>. 
Its 3rd dimension has length K2, the number of diseased cases.  <strong>This is 
because TPs are only possible on diseased cases</strong>. For each case the  
inferred ROC rating is the highest of all FROC ratings on that case. If a case has 
no marks, a <strong>finite ROC rating, guaranteed to be smaller than the rating on 
any marked case</strong>, is assigned to it. The dataset structure is shown below:
</p>

<ul>
<li><p><code>NL</code> Ratings array [1:I, 1:J, 1:(K1+K2), 1], of false positives, FPs
</p>
</li>
<li><p><code>LL</code> Ratings array [1:I, 1:J, 1:K2, 1], of true positives, TPs
</p>
</li>
<li><p><code>perCase</code> array [1:K2], number of lesions per diseased case
</p>
</li>
<li><p><code>IDs</code> array [1:K2, 1], labels of lesions on diseased cases
</p>
</li>
<li><p><code>weights</code> array [1:K2, 1], weights (or clinical importances) of lesions
</p>
</li>
<li><p><code>dataType</code> &quot;ROC&quot;, the data type
</p>
</li>
<li><p><code>modalityID</code> [1:I] inherited modality labels
</p>
</li>
<li><p><code>readerID</code> [1:J] inherited reader labels
</p>
</li></ul>



<h3>Value</h3>

<p>An ROC dataset with <strong>finite ratings</strong> in NL[,,1:K1,1] and LL[,,1:K2,1].
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rocDataSet &lt;- DfFroc2Roc(dataset05)
rocSpDataSet &lt;- DfFroc2Roc(datasetFROCSpC)

## in the following example, because of the smaller number of cases, 
## it is easy to see the process at work:

set.seed(1);K1 &lt;- 3;K2 &lt;- 5
mu &lt;- 1;nu &lt;- 0.5;lambda &lt;- 2;zeta1 &lt;- 0
lambda_i &lt;- UtilRSM2Intrinsic(mu,lambda,nu)$lambda_i
nu_i &lt;- UtilRSM2Intrinsic(mu,lambda,nu)$nu_i
Lmax &lt;- 2;Lk2 &lt;- floor(runif(K2, 1, Lmax + 1))
frocDataRaw &lt;- SimulateFrocDataset(mu, lambda_i, nu_i, zeta1, I = 1, J = 1, 
K1, K2, perCase = Lk2)
hrData &lt;- DfFroc2Roc(frocDataRaw)

## print("frocDataRaw$ratings$NL[1,1,,] = ")
## print("hrData$ratings$NL[1,1,1:K1,] = ")
## print("frocDataRaw$ratings$LL[1,1,,] = ")
## print("hrData$ratings$LL[1,1,,] = ")

## following is the output

## [1] "frocDataRaw$ratings$NL[1,1,,] = "
## [,1]      [,2]      [,3] [,4]
## [1,] 2.4046534 0.7635935      -Inf -Inf
## [2,]      -Inf      -Inf      -Inf -Inf
## [3,] 0.2522234      -Inf      -Inf -Inf
## [4,] 0.4356833      -Inf      -Inf -Inf
## [5,]      -Inf      -Inf      -Inf -Inf
## [6,]      -Inf      -Inf      -Inf -Inf
## [7,]      -Inf      -Inf      -Inf -Inf
## [8,] 0.8041895 0.3773956 0.1333364 -Inf

## &gt; ## print("hrData$ratings$NL[1,1,1:K1,] = ")
## [1] "hrData$ratings$NL[1,1,1:K1,] = "
## [1] 2.4046534      -Inf 0.2522234
## &gt; ## print("frocDataRaw$ratings$LL[1,1,,] = ")
## [1] "frocDataRaw$ratings$LL[1,1,,] = "
## [,1] [,2]
## [1,]      -Inf -Inf
## [2,] 1.5036080 -Inf
## [3,] 0.8442045 -Inf
## [4,] 1.0467262 -Inf
## [5,]      -Inf -Inf
## &gt; ## print("hrData$ratings$LL[1,1,,] = ")
## [1] "hrData$ratings$LL[1,1,,] = "
## [1] 0.4356833 1.5036080 0.8442045 1.0467262 0.8041895
## Note that rating of the first and the last diseased case came from NL marks


</code></pre>

<hr>
<h2 id='DfLroc2Froc'>Simulates an &quot;AUC-equivalent&quot; FROC dataset from an LROC dataset</h2><span id='topic+DfLroc2Froc'></span>

<h3>Description</h3>

<p>Simulates a multiple-treatment multiple-reader 
&quot;AUC-equivalent&quot; FROC dataset from a supplied LROC dataset,
e.g., <a href="#topic+datasetCadLroc">datasetCadLroc</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfLroc2Froc(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfLroc2Froc_+3A_dataset">dataset</code></td>
<td>
<p>The LROC dataset to be converted to FROC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LROC paradigm always yields a single mark per case. Therefore 
the equivalent FROC will also have only one mark per case. The NL arrays 
of the two datasets are identical. The LL array is created by copying the
LLCl array of the LROC dataset to the LL array of the FROC dataset, from 
diseased case index k2 = 1 to k2 = K2. Additionally, the LLIl array of the 
LROC dataset is copied to the NL array of the FROC dataset, starting at case 
index k1 = K1+1 to k1 = K1+K2. Any zero ratings are replace by -Infs. The 
equivalent FROC dataset has the same HrAuc as the original LROC dataset. 
See example. The main use of this function is to test the CAD significance
testing functions using CAD FROC datasets, which I currently don't have.
</p>


<h3>Value</h3>

<p>The equivalent FROC dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
frocDataset &lt;- DfLroc2Froc(datasetCadLroc)
lrocAuc &lt;- UtilFigureOfMerit(datasetCadLroc, FOM = "Wilcoxon")
frocHrAuc &lt;- UtilFigureOfMerit(frocDataset, FOM = "HrAuc")   

</code></pre>

<hr>
<h2 id='DfLroc2Roc'>Convert an LROC dataset to a ROC dataset</h2><span id='topic+DfLroc2Roc'></span>

<h3>Description</h3>

<p>Converts an LROC dataset to an ROC dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfLroc2Roc(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfLroc2Roc_+3A_dataset">dataset</code></td>
<td>
<p>The <strong>LROC</strong> dataset to be converted.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For the diseased cases one takes the maximum rating on each diseased case, 
which could be a LL (&quot;true positive&quot; correct localization) or a LL_IL 
(&quot;true positive&quot; incorrect localization) rating, whichever has the higher rating.
For non-diseased cases the NL arrays are identical.
</p>


<h3>Value</h3>

<p>An ROC dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rocDataSet &lt;- DfLroc2Roc(datasetCadLroc)


</code></pre>

<hr>
<h2 id='DfReadCrossedModalities'>Read a crossed-treatment data file</h2><span id='topic+DfReadCrossedModalities'></span>

<h3>Description</h3>

<p>Read an crossed-treatment data file, in which the 
two treatment factors are crossed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfReadCrossedModalities(fileName, sequentialNames = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfReadCrossedModalities_+3A_filename">fileName</code></td>
<td>
<p>A string specifying the name of the file that contains the dataset, 
which must be an extended-JAFROC format data file containing an 
additional treatment factor.</p>
</td></tr>
<tr><td><code id="DfReadCrossedModalities_+3A_sequentialnames">sequentialNames</code></td>
<td>
<p>If <code>TRUE</code>, consecutive integers (starting from 1) will be used 
as the treatment and reader IDs. Otherwise, treatment and reader IDs in the 
original data file will be used. The default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data format is  similar to the JAFROC format (see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>). 
The difference is that there are two treatment factors. TBA For an example see ... add
reference to FROC book chapter <a href="https://dpc10ster.github.io/RJafrocFrocBook/">https://dpc10ster.github.io/RJafrocFrocBook/</a>
</p>


<h3>Value</h3>

<p>A dataset with the specified structure, similar to a standard 
<span class="pkg">RJafroc</span> dataset (see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>). Because of the extra treatment factor, 
<code>NL</code> and <code>LL</code> are each five dimensional arrays. There are also two 
treatment IDS: <code>modalityID1</code> and <code>modalityID2</code>.
</p>


<h3>References</h3>

<p>Thompson JD, Chakraborty DP, Szczepura K, et al. (2016) Effect of reconstruction 
methods and x-ray tube current-time product  on nodule detection in an 
anthropomorphic thorax phantom: a crossed-treatment JAFROC observer study. 
Medical Physics. 43(3):1265-1274.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>

<hr>
<h2 id='DfReadDataFile'>Read a data file</h2><span id='topic+DfReadDataFile'></span>

<h3>Description</h3>

<p>Read a disk file and create a ROC, FROC or LROC dataset object 
from it.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfReadDataFile(
  fileName,
  format = "JAFROC",
  newExcelFileFormat = FALSE,
  lrocForcedMark = NA,
  delimiter = ",",
  sequentialNames = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfReadDataFile_+3A_filename">fileName</code></td>
<td>
<p>A string specifying the name of the file. 
The file-extension must match the format specified below.</p>
</td></tr>
<tr><td><code id="DfReadDataFile_+3A_format">format</code></td>
<td>
<p>A string specifying the format of the data file. 
It can be <code>"JAFROC"</code>, the default, which requires a <code>.xlsx</code> Excel file
(<b>not <code>.xls</code></b>), <code>"MRMC"</code> or <code>"iMRMC"</code>. 
For <code>"MRMC"</code> the format is determined by the data file extension 
(<code>.csv</code> or <code>.txt</code> or <code>.lrc</code>) 
as specified in <a href="https://perception.lab.uiowa.edu/">https://perception.lab.uiowa.edu/</a>. For <code>"iMRMC"</code> the 
file extension is <code>.imrmc</code> and the format is described in 
<a href="https://code.google.com/archive/p/imrmc/">https://code.google.com/archive/p/imrmc/</a>. <b>See following note for
important information about deprecation of the <code>"MRMC"</code> format</b>.</p>
</td></tr>
<tr><td><code id="DfReadDataFile_+3A_newexcelfileformat">newExcelFileFormat</code></td>
<td>
<p>Logical. Must be true to read LROC data. 
This argument only applies to the <code>"JAFROC"</code> format. 
The default is <code>FALSE</code>. If <code>TRUE</code> the function accommodates 3 
additional columns
in the <code>Truth</code> worksheet. If <code>FALSE</code>, the original function (as in version 
1.2.0) is used and the three extra columns, if present, throws an error.</p>
</td></tr>
<tr><td><code id="DfReadDataFile_+3A_lrocforcedmark">lrocForcedMark</code></td>
<td>
<p>Logical: For LROC dataset only: is a forced mark required 
on every image? The default is <code>NA</code>. If a mark is not required, set 
it to <code>FALSE</code> otherwise to <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="DfReadDataFile_+3A_delimiter">delimiter</code></td>
<td>
<p>The string delimiter to be used for the <code>"MRMC"</code> 
format (&quot;,&quot; is the default), see <a href="https://perception.lab.uiowa.edu/">https://perception.lab.uiowa.edu/</a>.
This parameter is not used when reading <code>"JAFROC"</code> 
or <code>"iMRMC"</code> data files.</p>
</td></tr>
<tr><td><code id="DfReadDataFile_+3A_sequentialnames">sequentialNames</code></td>
<td>
<p>A logical variable: if <code>TRUE</code>, consecutive integers 
(starting from 1) will be used as the 
treatment and reader IDs (i.e., names). Otherwise, treatment 
and reader IDs in the original data file will be used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataset with the structure specified in <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.
</p>


<h3>Note</h3>

<p>The <code>"MRMC"</code> format is deprecated. For non-JAFROC formats four file 
extensions (<code>.csv</code>, <code>.txt</code>, <code>.lrc</code> and <code>.imrmc</code>) are possible, 
all of which are restricted to ROC data. Only the <code>iMRMC</code> format is actively 
supported, i.e, files with extension <code>.imrmc</code>. Other formats (<code>.csv</code>, 
<code>.txt</code>, <code>.lrc</code>) are deprecated. Such files can still be read by this 
function and then saved to a JAFROC format file for further analysis within this 
package. <b>For non-JAFROC data file formats, the <code>readerID</code> and 
<code>modalityID</code> fields  must be unique integers</b>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fileName &lt;- system.file("extdata", "toyFiles/ROC/rocCr.xlsx", 
package = "RJafroc", mustWork = TRUE)
rdrArr1D &lt;- DfReadDataFile(fileName, newExcelFileFormat = TRUE)



fileName &lt;- system.file("extdata", "Roc.xlsx", 
package = "RJafroc", mustWork = TRUE)
RocDataXlsx &lt;- DfReadDataFile(fileName)

fileName &lt;- system.file("extdata", "RocData.csv", 
package = "RJafroc", mustWork = TRUE)
RocDataCsv&lt;- DfReadDataFile(fileName, format = "MRMC")

fileName &lt;- system.file("extdata", "RocData.imrmc", 
package = "RJafroc", mustWork = TRUE)
RocDataImrmc&lt;- DfReadDataFile(fileName, format = "iMRMC")

fileName &lt;- system.file("extdata", "Froc.xlsx", 
package = "RJafroc", mustWork = TRUE)
FrocDataXlsx &lt;- DfReadDataFile(fileName, sequentialNames = TRUE)


</code></pre>

<hr>
<h2 id='DfSaveDataFile'>Save ROC dataset in different formats</h2><span id='topic+DfSaveDataFile'></span>

<h3>Description</h3>

<p>Save ROC dataset in other formats so it can be analyzed 
with alternate software
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfSaveDataFile(
  dataset,
  fileName,
  format = "MRMC",
  dataDescription = "RJafroc dataset converted to imrmc format"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfSaveDataFile_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be saved.</p>
</td></tr>
<tr><td><code id="DfSaveDataFile_+3A_filename">fileName</code></td>
<td>
<p>The file name of the output data file. The extension 
of the data file must match the corresponding format, see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code></p>
</td></tr>
<tr><td><code id="DfSaveDataFile_+3A_format">format</code></td>
<td>
<p>The format of the data file, which can be <code>"MRMC"</code> or <code>"iMRMC"</code>, 
see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
<tr><td><code id="DfSaveDataFile_+3A_datadescription">dataDescription</code></td>
<td>
<p>An optional string variable describing the data file, the 
default value is the variable name of <code>dataset</code> The description appears on 
the first line of *.lrc or *imrmc data file. This parameter is not used 
when saving dataset in other formats.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
## DfSaveDataFile(dataset = dataset02, 
##    fileName = "rocData2.csv", format = "MRMC")
## DfSaveDataFile(dataset = dataset02, 
##    fileName = "rocData2.lrc", format = "MRMC", 
##     dataDescription = "ExampleROCdata1")
## DfSaveDataFile(dataset = dataset02, 
##    fileName = "rocData2.txt", format = "MRMC", 
##     dataDescription = "ExampleROCdata2")
##  DfSaveDataFile(dataset = dataset02, 
##    fileName = "dataset05.imrmc", format = "iMRMC", 
##    dataDescription = "ExampleROCdata3") 


</code></pre>

<hr>
<h2 id='DfWriteExcelDataFile'>Save dataset object as a JAFROC format Excel file</h2><span id='topic+DfWriteExcelDataFile'></span>

<h3>Description</h3>

<p>Save a dataset object as a JAFROC format Excel file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DfWriteExcelDataFile(dataset, fileName)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DfWriteExcelDataFile_+3A_dataset">dataset</code></td>
<td>
<p>The dataset object, see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
<tr><td><code id="DfWriteExcelDataFile_+3A_filename">fileName</code></td>
<td>
<p>The file name to save to; the extension of the data file must be .xlsx</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
##DfWriteExcelDataFile(dataset = dataset05, fileName = "rocData2.xlsx")


</code></pre>

<hr>
<h2 id='FitBinormalRoc'>Fit the binormal model to selected treatment and reader in an ROC dataset</h2><span id='topic+FitBinormalRoc'></span>

<h3>Description</h3>

<p>Fit the binormal model-predicted ROC curve for a dataset. 
This is the R equivalent of ROCFIT or RSCORE
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitBinormalRoc(dataset, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitBinormalRoc_+3A_dataset">dataset</code></td>
<td>
<p>The ROC dataset</p>
</td></tr>
<tr><td><code id="FitBinormalRoc_+3A_trt">trt</code></td>
<td>
<p>The desired treatment, default is 1</p>
</td></tr>
<tr><td><code id="FitBinormalRoc_+3A_rdr">rdr</code></td>
<td>
<p>The desired reader, default is 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In the binormal model ratings (more accurately the latent decision variables) 
from diseased cases are sampled from <code class="reqn">N(a,1)</code> while ratings for 
non-diseased cases are sampled from <code class="reqn">N(0,b^2)</code>. To avoid clutter error 
bars are only shown for the lowest and uppermost operating points. An FROC
dataset is internally converted to a highest rating inferred ROC dataset. To
many bins containing zero counts will cause the algorithm to fail; so be sure
to bin the data appropriately to fewer bins, where each bin has at least one
count.
</p>


<h3>Value</h3>

<p>The returned value is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>a</code></td>
<td>
<p>The mean of the diseased distribution; 
the non-diseased distribution is assumed to have zero mean</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>The standard deviation of the non-diseased 
distribution. The diseased distribution is assumed to have 
unit standard deviation</p>
</td></tr>
<tr><td><code>zetas</code></td>
<td>
<p>The binormal model cutoffs, zetas or thresholds</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>The binormal model fitted ROC-AUC</p>
</td></tr>
<tr><td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td></tr>
<tr><td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td></tr>
<tr><td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td></tr>
<tr><td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td></tr>
<tr><td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td></tr>
<tr><td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the 
fitted operating characteristic along with the empirical operating 
points. Use <code>print()</code> to display the object</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dorfman DD, Alf E (1969) Maximum-Likelihood Estimation of Parameters of Signal-Detection Theory and Determination of Confidence Intervals - 
Rating-Method Data, Journal of Mathematical Psychology 6, 487-496.
</p>
<p>Grey D, Morgan B (1972) Some aspects of ROC curve-fitting: normal and logistic models. Journal of Mathematical Psychology 9, 128-139.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Test with an included ROC dataset
retFit &lt;- FitBinormalRoc(dataset02);## print(retFit$fittedPlot)


## Test with an included FROC dataset; it needs to be binned
## as there are more than 5 discrete ratings levels
binned &lt;- DfBinDataset(dataset05, desiredNumBins = 5, opChType = "ROC")
retFit &lt;- FitBinormalRoc(binned);## print(retFit$fittedPlot)


## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitBinormalRoc(dataset);## print(retFit$fittedPlot)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitBinormalRoc(dataset);## print(retFit$fittedPlot)

## Test with TONY data for which chisqr can be calculated
ds &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitBinormalRoc(ds, 2, 3);## print(retFit$fittedPlot)
retFit$ChisqrFitStats
 
## Test with included degenerate ROC data
retFit &lt;- FitBinormalRoc(datasetDegenerate);## print(retFit$fittedPlot)


 

</code></pre>

<hr>
<h2 id='FitCbmRoc'>Fit the contaminated binormal model (CBM) to selected treatment and 
reader in an ROC dataset</h2><span id='topic+FitCbmRoc'></span>

<h3>Description</h3>

<p>Fit the CBM-predicted ROC curve for specified treatment and reader
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitCbmRoc(dataset, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitCbmRoc_+3A_dataset">dataset</code></td>
<td>
<p>The dataset containing the data</p>
</td></tr>
<tr><td><code id="FitCbmRoc_+3A_trt">trt</code></td>
<td>
<p>The desired treatment, default is 1</p>
</td></tr>
<tr><td><code id="FitCbmRoc_+3A_rdr">rdr</code></td>
<td>
<p>The desired reader, default is 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In  CBM ratings from diseased cases are sampled from a mixture distribution 
with two components: (1) distributed normal with mean <code class="reqn">mu</code> and unit 
variance with integrated area <code class="reqn">alpha</code>, and (2) from a unit-normal 
distribution with integrated area <code class="reqn">1-alpha</code>. Ratings for non-diseased 
cases are sampled from a unit-normal distribution. The 
<code>ChisqrFitStats</code> consists of a list containing the chi-square value, 
the p-value and the degrees of freedom.
</p>


<h3>Value</h3>

<p>The return value is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>The mean of the visible diseased distribution (the non-diseased)
has zero mean</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>The proportion of diseased cases where the disease is visible</p>
</td></tr>
<tr><td><code>zetas</code></td>
<td>
<p>The cutoffs, zetas or thresholds</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>The AUC of the fitted ROC curve</p>
</td></tr>
<tr><td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td></tr>
<tr><td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td></tr>
<tr><td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td></tr>
<tr><td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td></tr>
<tr><td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td></tr>
<tr><td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the fitted 
operating characteristic along with the empirical operating points. 
Use <code>print()</code> to display the object</p>
</td></tr>
</table>


<h3>Note</h3>

<p>This algorithm is very robust, much more so than the binormal model.
</p>


<h3>References</h3>

<p>Dorfman DD, Berbaum KS (2000) A contaminated binormal model for ROC data: Part II. A formal model,
Acad Radiol, 7:6, 427&ndash;437.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## CPU time 8.7 sec on Ubuntu (#13)
## Test with included ROC data
retFit &lt;- FitCbmRoc(dataset02);## print(retFit$fittedPlot)

## Test with included degenerate ROC data (yes! CBM can fit such data)
retFit &lt;- FitCbmRoc(datasetDegenerate);## print(retFit$fittedPlot)

## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitCbmRoc(dataset);## print(retFit$fittedPlot)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
dataset &lt;- Df2RJafrocDataset(fp, tp)
retFit &lt;- FitCbmRoc(dataset);
## print(retFit$fittedPlot)

## Test with included ROC data (some bins have zero counts)
retFit &lt;- FitCbmRoc(dataset02, 2, 1);## print(retFit$fittedPlot)

## Test with TONY data for which chisqr can be calculated
ds &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitCbmRoc(ds, 2, 3);## print(retFit$fittedPlot)
retFit$ChisqrFitStats


</code></pre>

<hr>
<h2 id='FitCorCbm'>Fit CORCBM to a paired ROC dataset</h2><span id='topic+FitCorCbm'></span>

<h3>Description</h3>

<p>Fit the Correlated Contaminated Binormal Model (CORCBM) 
to a paired ROC dataset.
The <strong>ROC</strong> dataset has to be formatted as a 
<strong>single treatment</strong>, <strong>two-reader</strong> dataset, even though the actual 
pairing may be different, see details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitCorCbm(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitCorCbm_+3A_dataset">dataset</code></td>
<td>
<p>A <strong>paired ROC</strong> dataset</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The conditions (X, Y) can be two readers interpreting images in the same 
treatment, the same reader interpreting images in different treatments, or 
different readers interpreting images in 2 different treatments. Function 
<code><a href="#topic+DfExtractCorCbmDataset">DfExtractCorCbmDataset</a></code> can be used to construct a dataset suitable for 
<code>FitCorCbm</code>. With reference to the returned values, and assuming R bins 
in condition X and L bins in conditon Y, 
<code>FPCounts</code> is the R x L matrix containing the counts for non-diseased cases, 
<code>TPCounts</code> is the R x L matrix containing the counts for diseased cases; 
<code>muX</code>,<code>muY</code>,<code>alphaX</code>,<code>alphaY</code>,<code>rhoNor</code>,<code>rhoAbn2</code> are 
the CORCBM parameters; <code>aucX</code>,<code>aucX</code> are the AUCs in the two conditions; 
<code>stdAucX</code>,<code>stdAucY</code> are the corresponding standard errors;<code>stdErr</code> 
contains the standard errors of the parameters of the model; <code>areaStat</code>, 
<code>areaPval</code>,<code>covMat</code> are the area-statistic, the p-value and the covariance 
matrix of the parameters. If a parameter approaches a limit, e.g., <code>rhoNor</code> 
= 0.9999, it is held constant at near the limiting value and the covariance matrix 
has one less dimension (along each edge) for each parameter that is held constant.
The indices of the parameters held fixed are in <code>fitCorCbmRet$fixParam</code>.
</p>


<h3>Value</h3>

<p>The return value is a list containing three objects:
</p>
<table role = "presentation">
<tr><td><code>fitCorCbmRet</code></td>
<td>
<p>list(<code>FPCounts</code>,<code>TPCounts</code>,
<code>muX</code>,<code>muY</code>,<code>alphaX</code>,<code>alphaY</code>,<code>rhoNor</code>,
<code>rhoAbn2</code>,<code>zetaX</code>,<code>zetaY</code>,<code>covMat</code>,<code>fixParam</code>)</p>
</td></tr>
<tr><td><code>stats</code></td>
<td>
<p>list(<code>aucX</code>,<code>aucX</code>,<code>stdAucX</code>,
<code>stdAucY</code>,<code>stdErr</code>,<code>areaStat</code>,<code>areaPval</code>)</p>
</td></tr>
<tr><td><code>fittedPlot</code></td>
<td>
<p>The fitted plot with operating points, error bars, 
for both conditions</p>
</td></tr>
</table>


<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017) A bivariate contaminated binormal model for robust fitting of proper ROC
curves to a pair of correlated, possibly degenerate, ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>

<hr>
<h2 id='FitRsmRoc'>Fit the radiological search model (RSM) to an ROC dataset</h2><span id='topic+FitRsmRoc'></span>

<h3>Description</h3>

<p>Fit an RSM-predicted ROC curve to a <strong>binned single-treatment single-reader ROC dataset</strong>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FitRsmRoc(binnedRocData, lesDistr, trt = 1, rdr = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FitRsmRoc_+3A_binnedrocdata">binnedRocData</code></td>
<td>
<p>The <strong>binned ROC</strong> dataset containing the data</p>
</td></tr>
<tr><td><code id="FitRsmRoc_+3A_lesdistr">lesDistr</code></td>
<td>
<p>The lesion distribution 1D array.</p>
</td></tr>
<tr><td><code id="FitRsmRoc_+3A_trt">trt</code></td>
<td>
<p>The selected treatment, default is 1</p>
</td></tr>
<tr><td><code id="FitRsmRoc_+3A_rdr">rdr</code></td>
<td>
<p>The selected reader, default is 1</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If dataset is FROC, first convert it to ROC, using <code><a href="#topic+DfFroc2Roc">DfFroc2Roc</a></code>. MLE ROC algorithms 
require binned datasets. Use <code><a href="#topic+DfBinDataset">DfBinDataset</a></code> to perform the binning prior to calling 
this function. 
In the RSM: (1) The (random) number of latent NLs per case is Poisson distributed 
with mean parameter lambda, and the corresponding ratings are sampled from 
<code class="reqn">N(0,1)</code>. The (2) The (random) number of latent LLs per diseased case is 
binomial distributed with success probability nu and trial size equal to 
the number of lesions in the case, and the corresponding ratings are sampled from 
N(<code class="reqn">mu</code>,1). (3) A latent NL or LL is actually marked if its rating exceeds 
the lowest threshold zeta1. To avoid clutter error bars are only shown for the 
lowest and uppermost operating points. Because of the extra parameter, and the 
requirement to have five counts, the chi-square statistic often cannot be calculated.
</p>


<h3>Value</h3>

<p>The return value is a list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>mu</code></td>
<td>
<p>The mean of the diseased distribution relative 
to the non-diseased one</p>
</td></tr>
<tr><td><code>lambda</code></td>
<td>
<p>The Poisson parameter describing the distribution 
of latent NLs per case</p>
</td></tr>
<tr><td><code>nu</code></td>
<td>
<p>The binomial success probability describing the distribution
of latent LLs per diseased case</p>
</td></tr>
<tr><td><code>zetas</code></td>
<td>
<p>The RSM cutoffs, zetas or thresholds</p>
</td></tr>
<tr><td><code>AUC</code></td>
<td>
<p>The RSM fitted ROC-AUC</p>
</td></tr>
<tr><td><code>StdAUC</code></td>
<td>
<p>The standard deviation of AUC</p>
</td></tr>
<tr><td><code>NLLIni</code></td>
<td>
<p>The initial value of negative LL</p>
</td></tr>
<tr><td><code>NLLFin</code></td>
<td>
<p>The final value of negative LL</p>
</td></tr>
<tr><td><code>ChisqrFitStats</code></td>
<td>
<p>The chisquare goodness of fit results</p>
</td></tr>
<tr><td><code>covMat</code></td>
<td>
<p>The covariance matrix of the parameters</p>
</td></tr>
<tr><td><code>fittedPlot</code></td>
<td>
<p>A <span class="pkg">ggplot2</span> object containing the fitted 
operating characteristic along with the empirical operating points. 
Use <code>print</code> to display the object</p>
</td></tr>
</table>


<h3>References</h3>

<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm. Phys Med Biol 51, 3449-3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search. Phys Med Biol 51, 3463&ndash;3482.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Test with included ROC data (some bins have zero counts)
lesDistr &lt;- UtilLesionDistrVector(dataset02)
retFit &lt;- FitRsmRoc(dataset02, lesDistr)
## print(retFit$fittedPlot)

## Test with included degenerate ROC data
lesDistr &lt;- UtilLesionDistrVector(datasetDegenerate)
retFit &lt;- FitRsmRoc(datasetDegenerate, lesDistr)

## Test with single interior point data
fp &lt;- c(rep(1,7), rep(2, 3))
tp &lt;- c(rep(1,5), rep(2, 5))
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)

## Test with two interior data points
fp &lt;- c(rep(1,7), rep(2, 5), rep(3, 3))
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7))
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)


## Test with three interior data points
fp &lt;- c(rep(1,12), rep(2, 5), rep(3, 3), rep(4, 5)) #25
tp &lt;- c(rep(1,3), rep(2, 5), rep(3, 7), rep(4, 10)) #25
binnedRocData &lt;- Df2RJafrocDataset(fp, tp)
lesDistr &lt;- UtilLesionDistrVector(binnedRocData)
retFit &lt;- FitRsmRoc(binnedRocData, lesDistr)

## test for TONY data, i = 2 and j = 3 
## only case permitting chisqure calculation
lesDistr &lt;- UtilLesionDistrVector(dataset01)
rocData &lt;- DfFroc2Roc(dataset01)
retFit &lt;- FitRsmRoc(rocData, lesDistr, trt = 2, rdr = 3)
## print(retFit$fittedPlot)
retFit$ChisqrFitStats


</code></pre>

<hr>
<h2 id='isBinnedDataset'>Determine if a dataset is binned</h2><span id='topic+isBinnedDataset'></span>

<h3>Description</h3>

<p>Determine if a dataset is binned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isBinnedDataset(dataset, maxUniqeRatings = 6)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isBinnedDataset_+3A_dataset">dataset</code></td>
<td>
<p>The dataset</p>
</td></tr>
<tr><td><code id="isBinnedDataset_+3A_maxuniqeratings">maxUniqeRatings</code></td>
<td>
<p>For each treatment-reader combination, the max number of unique ratings in order to be classified as binned,  the default value for <code>maxUniqeRatings</code> is 6; if there are more unique ratings the treatment-reader combination is classified as not binned.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a logical <code>[I x J]</code> array, TRUE if the corresponding treatment-reader combination is binned, i.e., has at most <code>maxUniqeRatings</code> unique ratings, FALSE otherwise.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>isBinnedDataset(dataset01)

</code></pre>

<hr>
<h2 id='isValidDataset'>Check the validity of a dataset</h2><span id='topic+isValidDataset'></span>

<h3>Description</h3>

<p>Checks the validity of the dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isValidDataset(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isValidDataset_+3A_dataset">dataset</code></td>
<td>
<p>The dataseet object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if dataset is valid, <code>FALSE</code> otherwise.
</p>

<hr>
<h2 id='PlotBinormalFit'>Plot binormal fit</h2><span id='topic+PlotBinormalFit'></span>

<h3>Description</h3>

<p>Plot the binormal-predicted ROC curve with provided parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotBinormalFit(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotBinormalFit_+3A_a">a</code></td>
<td>
<p>vector: the mean(s) of the diseased distribution(s).</p>
</td></tr>
<tr><td><code id="PlotBinormalFit_+3A_b">b</code></td>
<td>
<p>vector: the standard deviations(s) of the diseased distribution(s).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>a</code> and <code>b</code> must have the same length. The predicted ROC curve 
for each <code>a</code> and <code>b</code> pair will be plotted.
</p>


<h3>Value</h3>

<p>A <span class="pkg">ggplot2</span> object of the plotted ROC curve(s) are returned. 
Use <code>print</code> function to display the saved object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>binormalPlot &lt;- PlotBinormalFit(c(1, 2), c(0.5, 0.5))
## print(binormalPlot)

</code></pre>

<hr>
<h2 id='PlotCbmFit'>Plot CBM fitted curve</h2><span id='topic+PlotCbmFit'></span>

<h3>Description</h3>

<p>Plot the CBM-predicted ROC curve with provided CBM parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotCbmFit(mu, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotCbmFit_+3A_mu">mu</code></td>
<td>
<p>vector: the mean(s) of the z-samples of the diseased distribution(s) where the disease is visible</p>
</td></tr>
<tr><td><code id="PlotCbmFit_+3A_alpha">alpha</code></td>
<td>
<p>vector: the proportion(s) of the diseased distribution(s) where the disease is visible</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>mu</code> and <code>alpha</code> must have equal length. 
The predicted ROC curve for each <code>mu</code> and <code>alpha</code> pair will be plotted.
</p>


<h3>Value</h3>

<p>A <span class="pkg">ggplot2</span> object of the plotted ROC curve(s)
</p>


<h3>References</h3>

<p>Dorfman DD, Berbaum KS (2000) A contaminated binormal model for ROC data: Part II. 
A formal model, Acad Radiol 7, 427&ndash;437.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>cbmPlot &lt;- PlotCbmFit(c(1, 2), c(0.5, 0.5))
## print(cbmPlot)


</code></pre>

<hr>
<h2 id='PlotEmpiricalOperatingCharacteristics'>Plot empirical operating characteristics, ROC, FROC or LROC</h2><span id='topic+PlotEmpiricalOperatingCharacteristics'></span>

<h3>Description</h3>

<p>Plot empirical operating characteristics (operating points connected by straight 
lines) for specified modalities and readers, or, if desired, plots 
(no operating points) averaged over specified modalities and / or readers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotEmpiricalOperatingCharacteristics(
  dataset,
  trts = 1,
  rdrs = 1,
  opChType,
  legend.position = c(0.8, 0.3),
  maxDiscrete = 10
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_dataset">dataset</code></td>
<td>
<p>Dataset object.</p>
</td></tr>
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_trts">trts</code></td>
<td>
<p>List or vector: <strong>integer</strong> indices of modalities to be plotted.
Default is 1.</p>
</td></tr>
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_rdrs">rdrs</code></td>
<td>
<p>List or vector: <strong>integer</strong> indices of readers to be plotted.
Default is 1.</p>
</td></tr>
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_opchtype">opChType</code></td>
<td>
<p>Type of operating characteristic to be plotted:
<code>"ROC"</code>, <code>"FROC"</code>, <code>"AFROC"</code>,  <code>"wAFROC"</code>,
<code>"AFROC1"</code>, <code>"wAFROC1"</code>, or <code>"LROC"</code>.</p>
</td></tr>
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_legend.position">legend.position</code></td>
<td>
<p>Where to position the legend. The default is c(0.8, 0.2), 
i.e., 0.8 rightward and 0.2 upward (the plot is a unit square).</p>
</td></tr>
<tr><td><code id="PlotEmpiricalOperatingCharacteristics_+3A_maxdiscrete">maxDiscrete</code></td>
<td>
<p>maximum number of op. points in order to be considered 
discrete and to be displayed by symbols and connecting lines; 
any more points will be regarded as continuous and only connected by lines; 
default is 10.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>trts</code> and <code>rdrs</code> are vectors or lists of <strong>integer</strong>  
indices, not the corresponding <strong>string</strong> IDs. For example, if the string 
ID of the first reader is &quot;0&quot;, the value in <code>rdrs</code> should be 
<strong>1</strong> not <strong>0</strong>. The legend will display the string IDs. 
</p>
<p>If both of <code>trts</code> and <code>rdrs</code> are vectors, all combinations of modalities 
and readers are plotted. See Example 1.
</p>
<p>If both <code>trts</code> and <code>rdrs</code> are <code>lists</code>, they must have the same length. 
Only the combination of modality and reader at the same position in their 
respective lists are plotted. If some elements of the modalities and / or 
readers lists are vectors, the average operating characteristic over the 
implied modalities and / or readers are plotted. See Example 2.
</p>
<p>For <code>LROC</code> datasets, <code>opChType</code> can be &quot;ROC&quot; or &quot;LROC&quot;.
</p>


<h3>Value</h3>

<p>A <span class="pkg">ggplot2</span> object containing the operating characteristic plot(s) 
and a data frame containing the points defining the operating characteristics.
</p>
<table role = "presentation">
<tr><td><code>Plot</code></td>
<td>
<p><span class="pkg">ggplot2</span> object. 
For continuous or averaged data, operating characteristics curves are plotted 
<strong>without</strong> showing operating points. For binned (individual) data, both operating 
points and connecting lines are shown. To avoid clutter, if there are more than 20 
operating points, they are not shown.</p>
</td></tr>
<tr><td><code>Points</code></td>
<td>
<p>Data frame with four columns: abscissa, ordinate, 
<code>class</code> (which codes modality and reader names) and <code>type</code>, which 
can be <code>"D"</code> for discrete ratings, <code>"C"</code> for continuous ratings, 
i.e., more than 20 operating points, or <code>"A"</code>, for reader averaged.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Example 1
## Plot individual empirical ROC plots for all combinations of modalities
## 1 and 2 and readers 1, 2 and 3. Six operating characteristics are plotted.

ret &lt;- PlotEmpiricalOperatingCharacteristics(dataset = 
dataset02, trts = c(1:2), rdrs = c(1:3), opChType = "ROC")
## print(ret$Plot)

## Example 2
## Empirical wAFROC plots, consisting of
## three sub-plots:
## (1) sub-plot, red, with operating points, for the 1st modality (string ID "1") and the 2nd 
## reader (string ID "3"), labeled "M:1 R:3" 
## (2) sub-plot, green, no operating points, for the 2nd modality (string ID "2") AVERAGED 
## over the 2nd and 3rd readers (string IDs "3" and "4"), labeled "M:2  R: 3 4" 
## (3) sub-plot, blue, no operating points, AVERAGED over the first two modalities 
## (string IDs "1" and "2") AND over the 1st, 2nd and 3rd readers 
## (string IDs "1", "3" and "4"), labeled "M: 1 2  R: 1  3 4" 

plotT &lt;- list(1, 2, c(1:2))
plotR &lt;- list(2, c(2:3), c(1:3))

ret &lt;- PlotEmpiricalOperatingCharacteristics(dataset = dataset04, trts = plotT, 
   rdrs = plotR, opChType = "wAFROC")                  
## print(ret$Plot)

## Example 3
## Correspondences between indices and string identifiers for modalities and 
## readers in this dataset (apparently reader "2" did not complete the study).

## names(dataset04$descriptions$readerID)
## [1] "1" "3" "4" "5"

</code></pre>

<hr>
<h2 id='PlotRsmOperatingCharacteristics'>RSM predicted operating characteristics, ROC pdfs and AUCs</h2><span id='topic+PlotRsmOperatingCharacteristics'></span>

<h3>Description</h3>

<p>Visualize RSM predicted ROC, AFROC, wAFROC and FROC curves, and ROC pdfs, 
given <b>equal-length arrays</b> of search model parameters: mu, lambda, nu and 
zeta1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PlotRsmOperatingCharacteristics(
  mu,
  lambda,
  nu,
  zeta1,
  lesDistr = 1,
  relWeights = 0,
  OpChType = "ALL",
  legendPosition = c(1, 0),
  legendDirection = "horizontal",
  legendJustification = c(0, 1),
  nlfRange = NULL,
  llfRange = NULL,
  nlfAlpha = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_mu">mu</code></td>
<td>
<p>Array: the RSM mu parameter.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_lambda">lambda</code></td>
<td>
<p>Array: the RSM lambda parameter.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_nu">nu</code></td>
<td>
<p>Array: the RSM nu parameter.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_zeta1">zeta1</code></td>
<td>
<p>Array, the lowest reporting threshold; if missing the default 
is an array of -3s.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_lesdistr">lesDistr</code></td>
<td>
<p>Array: the probability mass function of the 
lesion distribution for diseased cases. The default is 1. See <a href="#topic+UtilLesionDistrVector">UtilLesionDistrVector</a>.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_relweights">relWeights</code></td>
<td>
<p>The relative weights of the lesions; a vector of 
length equal to <code>length(maxLL)</code>. The default is zero, in which case
equal weights are assumed.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_opchtype">OpChType</code></td>
<td>
<p>The type of operating characteristic desired: can be &quot;<code>ROC</code>&quot;, 
&quot;<code>AFROC</code>&quot;, &quot;<code>wAFROC</code>&quot;, &quot;<code>FROC</code>&quot; or &quot;<code>pdfs</code>&quot; or &quot;<code>ALL</code>&quot;. 
The default is &quot;<code>ALL</code>&quot;.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_legendposition">legendPosition</code></td>
<td>
<p>The positioning of the legend: &quot;<code>right</code>&quot;, &quot;<code>left</code>&quot;, 
&quot;<code>top</code>&quot; or &quot;<code>bottom</code>&quot;. Use &quot;<code>none</code>&quot; to suppress the legend.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_legenddirection">legendDirection</code></td>
<td>
<p>Allows control on the direction of the legend; 
<code>"horizontal"</code>, the default, or <code>"vertical"</code></p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_legendjustification">legendJustification</code></td>
<td>
<p>Where to position the legend, default 
is bottom right corner c(0,1)</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_nlfrange">nlfRange</code></td>
<td>
<p><b>This applies to FROC plot only</b>. The x-axis range, e.g., c(0,2), 
for FROC plot. Default is &quot;<code>NULL</code>&quot;, which means the maximum NLF range, 
as determined by the data.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_llfrange">llfRange</code></td>
<td>
<p><b>This applies to FROC plot only</b>. The y-axis range, e.g., c(0,1), 
for FROC plot. Default is &quot;<code>NULL</code>&quot;, which means the maximum LLF range,
as determined by the data.</p>
</td></tr>
<tr><td><code id="PlotRsmOperatingCharacteristics_+3A_nlfalpha">nlfAlpha</code></td>
<td>
<p>Upper limit of the integrated area under the FROC plot. 
Default is &quot;<code>NULL</code>&quot;, which means the maximum NLF range is used 
(i.e., lambda). Attempt to integrate outside the maximum NLF will 
generate an error.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RSM is the Radiological Search Model described in the book. This 
function is vectorized with respect to the first 4 arguments. For 
<code>lesDistr</code> the sum must be one. To indicate that all dis. cases
contain 4 lesions, set lesDistr = c(0,0,0,1).
</p>


<h3>Value</h3>

<p>A list of elements containing five <span class="pkg">ggplot2</span> objects 
(ROCPlot, AFROCPlot wAFROCPlot, FROCPlot and PDFPlot) and two area measures 
(each of which can have up to two elements), the area under the search 
model predicted ROC curves in up to two treatments, the area under the search 
model predicted AFROC curves in up to two treatments, the area under the 
search model predicted wAFROC curves in up to two treatments, the area under 
the search model predicted FROC curves in up to two treatments.
</p>

<ul>
<li><p><code>ROCPlot</code>   The predicted ROC plots
</p>
</li>
<li><p><code>AFROCPlot</code>     The predicted AFROC plots
</p>
</li>
<li><p><code>wAFROCPlot</code>    The predicted wAFROC plots
</p>
</li>
<li><p><code>FROCPlot</code>  The predicted FROC plots
</p>
</li>
<li><p><code>PDFPlot</code>   The predicted ROC pdf plots, highest rating generated
</p>
</li>
<li><p><code>aucROC</code>    The predicted ROC AUCs, highest rating generated
</p>
</li>
<li><p><code>aucAFROC</code>  The predicted AFROC AUCs
</p>
</li>
<li><p><code>aucwAFROC</code> The predicted wAFROC AUCs
</p>
</li>
<li><p><code>aucFROC</code>   The predicted FROC AUCs
</p>
</li></ul>



<h3>References</h3>

<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm, Phys Med Biol 51, 3449-3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search, Phys Med Biol 51, 3463&ndash;3482.
</p>
<p>Chakraborty, DP, Yoon, HJ (2008) Operating characteristics predicted by models for diagnostic tasks involving lesion localization, Med Phys, 35:2, 435.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em> (CRC Press, Boca Raton, FL). 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Following example is for mu = 2, lambda = 1, nu = 0.6, in one treatment and   
## mu = 3, lambda = 1.5, nu = 0.8, in the other treatment. 20% of the diseased 
## cases have a single lesion, 40% have two lesions, 10% have 3 lesions, 
## and 30% have 4 lesions.  

PlotRsmOperatingCharacteristics(mu = c(2, 3), lambda = c(1, 1.5), nu = c(0.6, 0.8),
   lesDistr = c(0.2, 0.4, 0.1, 0.3), legendPosition = "bottom")

</code></pre>

<hr>
<h2 id='RSM_LLF'>RSM predicted FROC ordinate</h2><span id='topic+RSM_LLF'></span>

<h3>Description</h3>

<p>RSM predicted FROC ordinate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_LLF(z, mu, nu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_LLF_+3A_z">z</code></td>
<td>
<p>The z-sample value at which to evaluate the FROC ordinate.</p>
</td></tr>
<tr><td><code id="RSM_LLF_+3A_mu">mu</code></td>
<td>
<p>The RSM mu parameter.</p>
</td></tr>
<tr><td><code id="RSM_LLF_+3A_nu">nu</code></td>
<td>
<p>The RSM nu prime parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>yFROC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RSM_LLF(1,1,0.5)

</code></pre>

<hr>
<h2 id='RSM_NLF'>RSM predicted FROC abscissa</h2><span id='topic+RSM_NLF'></span>

<h3>Description</h3>

<p>RSM predicted FROC abscissa
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_NLF(z, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_NLF_+3A_z">z</code></td>
<td>
<p>The z-sample value at which to evaluate the FROC abscissa.</p>
</td></tr>
<tr><td><code id="RSM_NLF_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xFROC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RSM_NLF(1,1)

</code></pre>

<hr>
<h2 id='RSM_pdfD'>RSM predicted ROC-rating pdf for diseased cases</h2><span id='topic+RSM_pdfD'></span>

<h3>Description</h3>

<p>RSM predicted ROC-rating pdf for diseased cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_pdfD(z, mu, lambda, nu, lesDistr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_pdfD_+3A_z">z</code></td>
<td>
<p>The z-sample value at which to evaluate the pdf.</p>
</td></tr>
<tr><td><code id="RSM_pdfD_+3A_mu">mu</code></td>
<td>
<p>The mu parameter of the RSM.</p>
</td></tr>
<tr><td><code id="RSM_pdfD_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter.</p>
</td></tr>
<tr><td><code id="RSM_pdfD_+3A_nu">nu</code></td>
<td>
<p>The RSM nu parameter.</p>
</td></tr>
<tr><td><code id="RSM_pdfD_+3A_lesdistr">lesDistr</code></td>
<td>
<p>The lesion distribution 1D vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lesDistr &lt;- c(0.5, 0.5)
RSM_pdfD(1,1,1,0.9, lesDistr)
lesDistr &lt;- c(0.2, 0.3, 0.5)
RSM_pdfD(1,1,1,0.5, lesDistr)

</code></pre>

<hr>
<h2 id='RSM_pdfN'>RSM predicted ROC-rating pdf for non-diseased cases</h2><span id='topic+RSM_pdfN'></span>

<h3>Description</h3>

<p>RSM predicted ROC-rating pdf for non-diseased cases
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_pdfN(z, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_pdfN_+3A_z">z</code></td>
<td>
<p>The z-sample value at which to evaluate the pdf.</p>
</td></tr>
<tr><td><code id="RSM_pdfN_+3A_lambda">lambda</code></td>
<td>
<p>The (physical) lambda parameter of the RSM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>pdf
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RSM_pdfN(1,1)

</code></pre>

<hr>
<h2 id='RSM_wLLF'>RSM predicted wAFROC ordinate</h2><span id='topic+RSM_wLLF'></span>

<h3>Description</h3>

<p>RSM predicted wAFROC ordinate
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_wLLF(zeta, mu, nu, lesDistr, relWeights)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_wLLF_+3A_zeta">zeta</code></td>
<td>
<p>The zeta value at which to evaluate the FROC ordinate.</p>
</td></tr>
<tr><td><code id="RSM_wLLF_+3A_mu">mu</code></td>
<td>
<p>The RSM mu parameter.</p>
</td></tr>
<tr><td><code id="RSM_wLLF_+3A_nu">nu</code></td>
<td>
<p>The RSM nu prime parameter.</p>
</td></tr>
<tr><td><code id="RSM_wLLF_+3A_lesdistr">lesDistr</code></td>
<td>
<p>Lesion distribution vector.</p>
</td></tr>
<tr><td><code id="RSM_wLLF_+3A_relweights">relWeights</code></td>
<td>
<p>Relative lesion weights vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>wLLF
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RSM_wLLF(1,1,0.5, lesDistr = c(0.5, 0.4, 0.1), relWeights = c(0.7, 0.2, 0.1)) 


</code></pre>

<hr>
<h2 id='RSM_xROC'>RSM predicted ROC-abscissa as function of z</h2><span id='topic+RSM_xROC'></span>

<h3>Description</h3>

<p>RSM predicted ROC-abscissa as function of z
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_xROC(z, lambda)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_xROC_+3A_z">z</code></td>
<td>
<p>The z-sample at which to evaluate the ROC-abscissa.</p>
</td></tr>
<tr><td><code id="RSM_xROC_+3A_lambda">lambda</code></td>
<td>
<p>The (physical) lambda parameter of the RSM.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>xROC, the abscissa of the ROC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RSM_xROC(c(-Inf,0.1,0.2,0.3),1)

</code></pre>

<hr>
<h2 id='RSM_yROC'>RSM predicted ROC-ordinate as function of z</h2><span id='topic+RSM_yROC'></span>

<h3>Description</h3>

<p>RSM predicted ROC-ordinate as function of z
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RSM_yROC(z, mu, lambda, nu, lesDistr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="RSM_yROC_+3A_z">z</code></td>
<td>
<p>The z-sample value at which to evaluate the pdf.</p>
</td></tr>
<tr><td><code id="RSM_yROC_+3A_mu">mu</code></td>
<td>
<p>The mu parameter (of the RSM).</p>
</td></tr>
<tr><td><code id="RSM_yROC_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter.</p>
</td></tr>
<tr><td><code id="RSM_yROC_+3A_nu">nu</code></td>
<td>
<p>The RSM nu parameter.</p>
</td></tr>
<tr><td><code id="RSM_yROC_+3A_lesdistr">lesDistr</code></td>
<td>
<p>The 1D lesion distribution vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>yROC, the ordinate of the ROC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lesDistr &lt;- c(0.1,0.3,0.6)
RSM_yROC(c(-Inf,0.1,0.2,0.3), 1, 1, 0.9, lesDistr)

</code></pre>

<hr>
<h2 id='SimulateCorCbmDataset'>Simulate paired binned data for testing FitCorCbm</h2><span id='topic+SimulateCorCbmDataset'></span>

<h3>Description</h3>

<p>Simulates single treatment 2-reader binned ROC dataset, simulated according to the CORCBM model,
for the purpose of testing the fitting program <code><a href="#topic+FitCorCbm">FitCorCbm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateCorCbmDataset(
  seed = 123,
  K1 = 50,
  K2 = 50,
  desiredNumBins = 5,
  muX = 1.5,
  muY = 3,
  alphaX = 0.4,
  alphaY = 0.7,
  rhoNor = 0.3,
  rhoAbn2 = 0.8
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimulateCorCbmDataset_+3A_seed">seed</code></td>
<td>
<p>The seed variable, default is 123; set to NULL for truly random seed</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_k1">K1</code></td>
<td>
<p>The number of non-diseased cases, default is 50</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_k2">K2</code></td>
<td>
<p>The number of diseased cases, default is 50</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_desirednumbins">desiredNumBins</code></td>
<td>
<p>The desired number of bins; default is 5</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_mux">muX</code></td>
<td>
<p>The CBM mu parameter in condition X</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_muy">muY</code></td>
<td>
<p>The CBM mu parameter in condition Y</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_alphax">alphaX</code></td>
<td>
<p>The CBM alpha parameter in condition X</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_alphay">alphaY</code></td>
<td>
<p>The CBM alpha parameter in condition Y</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_rhonor">rhoNor</code></td>
<td>
<p>The correlation of non-diseased case z-samples</p>
</td></tr>
<tr><td><code id="SimulateCorCbmDataset_+3A_rhoabn2">rhoAbn2</code></td>
<td>
<p>The correlation of diseased case z-samples, when disease is visible in both conditions</p>
</td></tr>
</table>


<h3>Details</h3>

<p>X and Y refer to the two arms of the pairing. <code>muX</code> and <code>alphaX</code> refer to the univariate CBM parameters
in condition X, <code>rhoNor</code> is the correlation of ratings of non-diseased cases and <code>rhoAbn2</code> is the correlation of ratings of
diseased cases when disease is visible in both conditions. The ROC data is bined to 5 bins in each condition.
See referenced publication.
</p>


<h3>Value</h3>

<p>The return value is the desired dataset, suitable for testing FitCorCbm
</p>


<h3>References</h3>

<p>Zhai X, Chakraborty DP (2017) A bivariate contaminated binormal model for robust fitting of proper ROC
curves to a pair of correlated, possibly degenerate, ROC datasets. Medical Physics. 44(6):2207&ndash;2222.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dataset &lt;- SimulateCorCbmDataset()


## this takes very long
## dataset &lt;- SimulateCorCbmDataset(K1 = 5000, K2 = 5000)



</code></pre>

<hr>
<h2 id='SimulateFrocDataset'>Simulates an MRMC uncorrelated FROC dataset using the RSM</h2><span id='topic+SimulateFrocDataset'></span>

<h3>Description</h3>

<p>Simulates an uncorrelated MRMC FROC dataset for specified numbers of
readers and treatments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateFrocDataset(mu, lambda, nu, zeta1, I, J, K1, K2, perCase, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimulateFrocDataset_+3A_mu">mu</code></td>
<td>
<p>The mu parameter of the RSM</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_nu">nu</code></td>
<td>
<p>The RSM nu parameter</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_zeta1">zeta1</code></td>
<td>
<p>The lowest reporting threshold</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_i">I</code></td>
<td>
<p>The number of treatments</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_j">J</code></td>
<td>
<p>The number of readers</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_k1">K1</code></td>
<td>
<p>The number of non-diseased cases</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_k2">K2</code></td>
<td>
<p>The number of diseased cases</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_percase">perCase</code></td>
<td>
<p>A K2 length array containing the numbers of lesions per diseased case</p>
</td></tr>
<tr><td><code id="SimulateFrocDataset_+3A_seed">seed</code></td>
<td>
<p>The initial seed for the random number generator, the default 
is <code>NULL</code>, as if no seed has been specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See book chapters on the Radiological Search Model (RSM) for details. 
In this code correlations between ratings on the same case are assumed to be zero.
</p>


<h3>Value</h3>

<p>The return value is an FROC dataset.
</p>


<h3>References</h3>

<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1) 
K1 &lt;- 5;K2 &lt;- 7;
maxLL &lt;- 2;perCase &lt;- floor(runif(K2, 1, maxLL + 1))
mu &lt;- 1;lambda &lt;- 1;nu &lt;- 0.99 ;zeta1 &lt;- -1
I &lt;- 2; J &lt;- 5

frocDataRaw &lt;- SimulateFrocDataset(
  mu = mu, lambda = lambda, nu = nu, zeta1 = zeta1,
  I = I, J = J, K1 = K1, K2 = K2, perCase = perCase )
  
## plot the data
ret &lt;- PlotEmpiricalOperatingCharacteristics(frocDataRaw, opChType = "FROC")
## print(ret$Plot)

</code></pre>

<hr>
<h2 id='SimulateFrocFromLrocDataset'>Simulates an &quot;AUC-equivalent&quot; FROC dataset from an LROC dataset</h2><span id='topic+SimulateFrocFromLrocDataset'></span>

<h3>Description</h3>

<p>Simulates a multiple-treatment multiple-reader 
&quot;AUC-equivalent&quot; FROC dataset from a supplied LROC dataset,
e.g., <a href="#topic+datasetCadLroc">datasetCadLroc</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateFrocFromLrocDataset(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimulateFrocFromLrocDataset_+3A_dataset">dataset</code></td>
<td>
<p>The LROC dataset to be converted to FROC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The LROC paradigm always yields a single mark per case. Therefore 
the equivalent FROC will also have only one mark per case. The NL arrays 
of the two datasets are identical. The LL array is created by copying the
LLCl array of the LROC dataset to the LL array of the FROC dataset, from 
diseased case index k2 = 1 to k2 = K2. Additionally, the LLIl array of the 
LROC dataset is copied to the NL array of the FROC dataset, starting at case 
index k1 = K1+1 to k1 = K1+K2. Any zero ratings are replace by -Infs. The 
equivalent FROC dataset has the same HrAuc as the original LROC dataset. 
See example. The main use of this function is to test the CAD significance
testing functions using CAD FROC datasets, which I currently don't have.
</p>


<h3>Value</h3>

<p>The equivalent FROC dataset
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
frocDataset &lt;- SimulateFrocFromLrocDataset(datasetCadLroc)
lrocAuc &lt;- UtilFigureOfMerit(datasetCadLroc, FOM = "Wilcoxon")
frocHrAuc &lt;- UtilFigureOfMerit(frocDataset, FOM = "HrAuc")   
testthat::expect_equal(lrocAuc, frocHrAuc)

</code></pre>

<hr>
<h2 id='SimulateLrocDataset'>Simulates an uncorrelated FLROC FrocDataset using the RSM</h2><span id='topic+SimulateLrocDataset'></span>

<h3>Description</h3>

<p>Simulates an uncorrelated LROC dataset for specified numbers of
readers and treatments
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateLrocDataset(mu, lambda, nu, zeta1, I, J, K1, K2, lesionVector)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimulateLrocDataset_+3A_mu">mu</code></td>
<td>
<p>The mu parameter of the RSM</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_nu">nu</code></td>
<td>
<p>The RSM nu parameter</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_zeta1">zeta1</code></td>
<td>
<p>The lowest reporting threshold</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_i">I</code></td>
<td>
<p>The number of treatments</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_j">J</code></td>
<td>
<p>The number of readers</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_k1">K1</code></td>
<td>
<p>The number of non-diseased cases</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_k2">K2</code></td>
<td>
<p>The number of diseased cases</p>
</td></tr>
<tr><td><code id="SimulateLrocDataset_+3A_lesionvector">lesionVector</code></td>
<td>
<p>A K2 length array containing the numbers of lesions per diseased case</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See book chapters on the Radiological Search Model (RSM) for details.
The approach is to first simulate an FROC dataset and then convert it to an Lroc
dataset. The correlations between FROC ratings on the same case are assumed to be zero.
</p>


<h3>Value</h3>

<p>The return value is an LROC dataset.
</p>


<h3>References</h3>

<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  set.seed(1)
  K1 &lt;- 5
  K2 &lt;- 5
  mu &lt;- 2
  lambda &lt;- 1
  lesionVector &lt;- rep(1, 5)
  nu &lt;- 0.8
  zeta1 &lt;- -3
  frocData &lt;- SimulateFrocDataset(mu, lambda, nu, zeta1, I = 2, J = 5, K1, K2, lesionVector)
  lrocData &lt;- DfFroc2Lroc(frocData)

</code></pre>

<hr>
<h2 id='SimulateRocDataset'>Simulates a binormal model ROC dataset</h2><span id='topic+SimulateRocDataset'></span>

<h3>Description</h3>

<p>Simulates an uncorrelated binormal model ROC factorial dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SimulateRocDataset(I = 1, J = 1, K1, K2, a, b, seed = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SimulateRocDataset_+3A_i">I</code></td>
<td>
<p>The number of modalities, default is 1</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_j">J</code></td>
<td>
<p>The number of readers, default is 1</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_k1">K1</code></td>
<td>
<p>The number of non-diseased cases</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_k2">K2</code></td>
<td>
<p>The number of diseased cases</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_a">a</code></td>
<td>
<p>The <code class="reqn">a</code> parameter of the binormal model</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_b">b</code></td>
<td>
<p>The <code class="reqn">b</code> parameter of the binormal model</p>
</td></tr>
<tr><td><code id="SimulateRocDataset_+3A_seed">seed</code></td>
<td>
<p>The initial seed, default is NULL, which results in a random seed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See book Chapter 6 for details
</p>


<h3>Value</h3>

<p>An ROC dataset
</p>


<h3>References</h3>

<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>K1 &lt;- 5;K2 &lt;- 7;a &lt;- 1.5;b &lt;- 0.5
rocDataRaw &lt;- SimulateRocDataset(K1 = K1, K2 = K2, a = a, b = b)
  
</code></pre>

<hr>
<h2 id='SsFrocNhRsmModel'>RSM fitted model for FROC sample size</h2><span id='topic+SsFrocNhRsmModel'></span>

<h3>Description</h3>

<p>RSM fitted model for FROC sample size
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsFrocNhRsmModel(dataset, lesDistr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsFrocNhRsmModel_+3A_dataset">dataset</code></td>
<td>
<p>The <strong>pilot</strong> dataset object representing a NH
(ROC or FROC) dataset.</p>
</td></tr>
<tr><td><code id="SsFrocNhRsmModel_+3A_lesdistr">lesDistr</code></td>
<td>
<p>A 1D array containing the probability mass function of
number of lesions per diseased case in the <strong>pivotal FROC</strong>
study.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If dataset is FROC, it is converted to an ROC dataset. The dataset
is automatically binned. The search model is used to fit each
treatment-reader combination. The median  value for each parameter is
computed and returned by the function (3 values). These are used
to compute predicted wAFROC and ROC FOMS over a range of values of deltaMu,
which are fitted by a straight line constrained to pass through the origin.
The scale factor and R2 are returned. The scaling factor is the value
by which the ROC effect size must be multiplied to get the wAFROC effect size.
See <a href="https://dpc10ster.github.io/RJafrocQuickStart/froc-sample-size.html">https://dpc10ster.github.io/RJafrocQuickStart/froc-sample-size.html</a>
for vignettes explaining the FROC sample size estimation procedure.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li> <p><code>mu</code>, the mu parameter of the NH model.
</p>
</li>
<li> <p><code>lambda</code>, the lambda parameter of the NH model.
</p>
</li>
<li> <p><code>nu</code>, the nu parameter of the NH model.
</p>
</li>
<li> <p><code>scaleFactor</code>, the scaling factor that multiplies
the ROC effect size to get wAFROC effect size.
</p>
</li>
<li> <p><code>R2</code>, the R2 of the fit.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>

## Examples with CPU or elapsed time &gt; 5s
## user system elapsed
## SsFrocNhRsmModel 8.102  0.023   8.135

## SsFrocNhRsmModel(DfExtractDataset(dataset04, trts = c(1,2)), c(0.69, 0.2, 0.11))


</code></pre>

<hr>
<h2 id='SsPowerGivenJK'>Statistical power for specified numbers of readers and cases</h2><span id='topic+SsPowerGivenJK'></span>

<h3>Description</h3>

<p>Calculate the statistical power for specified numbers of readers J, 
cases K, analysis method and DBM or OR variances components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsPowerGivenJK(
  dataset,
  ...,
  FOM,
  J,
  K,
  effectSize = NULL,
  method = "OR",
  analysisOption = "RRRC",
  LegacyCode = FALSE,
  alpha = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsPowerGivenJK_+3A_dataset">dataset</code></td>
<td>
<p>The <b>pilot</b> dataset. If set to NULL 
then variance components must be supplied.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_...">...</code></td>
<td>
<p>Optional variance components. These are needed if <code>dataset</code> 
is not supplied.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_j">J</code></td>
<td>
<p>The number of readers in the pivotal study.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_k">K</code></td>
<td>
<p>The number of cases in the pivotal study.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_effectsize">effectSize</code></td>
<td>
<p>The effect size to be used in the <strong>pivotal</strong> study.
Default is NULL, which uses the observed effect size in the pilot dataset. 
Must be supplied if dataset is set to NULL and variance 
components are supplied.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_method">method</code></td>
<td>
<p>&quot;OR&quot; (the default) or &quot;DBM&quot; (but see <code>LegacyCode</code> option
below).</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_analysisoption">analysisOption</code></td>
<td>
<p>Desired generalization, &quot;RRRC&quot; (the default), &quot;FRRC&quot;, 
&quot;RRFC&quot; or &quot;ALL&quot;. RRFC = random reader fixed case, etc.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_legacycode">LegacyCode</code></td>
<td>
<p>Logical, defaults to <code>FALSE</code>, which results in OR 
sample size method being used, even if DBM method is specified, as in 
Hillis 2011 &amp; 2018 papers. If <code>TRUE</code> the method based on 
Hillis-Berbaum 2004 sample size paper is used.</p>
</td></tr>
<tr><td><code id="SsPowerGivenJK_+3A_alpha">alpha</code></td>
<td>
<p>The significance level, default is 0.05.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default <code>effectSize</code> uses the observed effect size in the 
pilot study. A numeric value over-rides the default value. This argument 
must be supplied if dataset = NULL and variance compenents 
(the ... arguments) are supplied.
</p>


<h3>Value</h3>

<p>The expected statistical power.
</p>


<h3>Note</h3>

<p>The procedure is valid for ROC studies only; for FROC studies see 
Vignettes 19.
</p>


<h3>References</h3>

<p>Hillis SL, Berbaum KS (2004). Power Estimation for the Dorfman-Berbaum-Metz Method. 
Acad Radiol, 11, 1260&ndash;1273.
</p>
<p>Hillis SL, Obuchowski NA, Berbaum KS (2011). Power Estimation for Multireader ROC Methods: 
An Updated and Unified Approach. Acad Radiol, 18, 129&ndash;142.
</p>
<p>Hillis SL, Schartz KM (2018). Multireader sample size program for 
diagnostic studies: demonstration and methodology. Journal of 
Medical Imaging, 5(04).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## EXAMPLE 1: RRRC power 
## specify 2-treatment ROC dataset and force DBM alg.
SsPowerGivenJK(dataset = dataset02, FOM = "Wilcoxon", effectSize = 0.05, 
J = 6, K = 251, method = "DBM", LegacyCode = TRUE) # RRRC is default  

## EXAMPLE 1A: FRRC power 
SsPowerGivenJK(dataset = dataset02, FOM = "Wilcoxon", effectSize = 0.05, 
J = 6, K = 251, method = "DBM", LegacyCode = TRUE, analysisOption = "FRRC") 

## EXAMPLE 1B: RRFC power 
SsPowerGivenJK(dataset = dataset02, FOM = "Wilcoxon", effectSize = 0.05, 
J = 6, K = 251, method = "DBM", LegacyCode = TRUE, analysisOption = "RRFC") 

## EXAMPLE 2: specify NULL dataset &amp; DBM var. comp. &amp; force DBM-based alg.
vcDBM &lt;- UtilVarComponentsDBM(dataset02, FOM = "Wilcoxon")$VarCom
SsPowerGivenJK(dataset = NULL, FOM = "Wilcoxon", J = 6, K = 251, 
effectSize = 0.05, method = "DBM", LegacyCode = TRUE, 
list( 
VarTR = vcDBM["VarTR","Estimates"], # replace rhs with actual values as in 4A
VarTC = vcDBM["VarTC","Estimates"], # do:
VarErr = vcDBM["VarErr","Estimates"])) # do:
                     
## EXAMPLE 3: specify 2-treatment ROC dataset and use OR-based alg.
SsPowerGivenJK(dataset = dataset02, FOM = "Wilcoxon", effectSize = 0.05, 
J = 6, K = 251)

## EXAMPLE 4: specify NULL dataset &amp; OR var. comp. &amp; use OR-based alg.
JStar &lt;- length(dataset02$ratings$NL[1,,1,1])
KStar &lt;- length(dataset02$ratings$NL[1,1,,1])
vcOR &lt;- UtilORVarComponentsFactorial(dataset02, FOM = "Wilcoxon")$VarCom
SsPowerGivenJK(dataset = NULL, FOM = "Wilcoxon", effectSize = 0.05, J = 6, 
K = 251, list(JStar = JStar, KStar = KStar, 
   VarTR = vcOR["VarTR","Estimates"], # replace rhs with actual values as in 4A
   Cov1 = vcOR["Cov1","Estimates"],   # do:
   Cov2 = vcOR["Cov2","Estimates"],   # do:
   Cov3 = vcOR["Cov3","Estimates"],   # do:
   Var = vcOR["Var","Estimates"]))
   
## EXAMPLE 4A: specify NULL dataset &amp; OR var. comp. &amp; use OR-based alg.
SsPowerGivenJK(dataset = NULL, FOM = "Wilcoxon", effectSize = 0.05, J = 6, 
K = 251, list(JStar = 5, KStar = 114, 
   VarTR = 0.00020040252,
   Cov1 = 0.00034661371,
   Cov2 = 0.00034407483,
   Cov3 = 0.00023902837,
   Var = 0.00080228827))
   
## EXAMPLE 5: specify NULL dataset &amp; DBM var. comp. &amp; use OR-based alg.
## The DBM var. comp. are converted internally to OR var. comp.
vcDBM &lt;- UtilVarComponentsDBM(dataset02, FOM = "Wilcoxon")$VarCom
KStar &lt;- length(dataset02$ratings$NL[1,1,,1])
SsPowerGivenJK(dataset = NULL, J = 6, K = 251, effectSize = 0.05, 
method = "DBM", FOM = "Wilcoxon",
list(KStar = KStar,                # replace rhs with actual values as in 5A 
VarR = vcDBM["VarR","Estimates"], # do:
VarC = vcDBM["VarC","Estimates"], # do:
VarTR = vcDBM["VarTR","Estimates"], # do:
VarTC = vcDBM["VarTC","Estimates"], # do:
VarRC = vcDBM["VarRC","Estimates"], # do:
VarErr = vcDBM["VarErr","Estimates"]))

## EXAMPLE 5A: specify NULL dataset &amp; DBM var. comp. &amp; use OR-based alg.
SsPowerGivenJK(dataset = NULL, J = 6, K = 251, effectSize = 0.05, 
method = "DBM", FOM = "Wilcoxon",
list(KStar = 114,
VarR = 0.00153499935,
VarC = 0.02724923428,
VarTR = 0.00020040252,
VarTC = 0.01197529621,
VarRC = 0.01226472859,
VarErr = 0.03997160319))


</code></pre>

<hr>
<h2 id='SsPowerGivenJKDbmVarCom'>Power given J, K and Dorfman-Berbaum-Metz variance components</h2><span id='topic+SsPowerGivenJKDbmVarCom'></span>

<h3>Description</h3>

<p>Power given J, K and Dorfman-Berbaum-Metz variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsPowerGivenJKDbmVarCom(
  J,
  K,
  effectSize,
  VarTR,
  VarTC,
  VarErr,
  alpha = 0.05,
  analysisOption = "RRRC"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_j">J</code></td>
<td>
<p>The number of readers</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_k">K</code></td>
<td>
<p>The number of cases</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_effectsize">effectSize</code></td>
<td>
<p>The effect size</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_vartr">VarTR</code></td>
<td>
<p>The treatment-reader DBM variance component</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_vartc">VarTC</code></td>
<td>
<p>The treatment-case DBM variance component</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_varerr">VarErr</code></td>
<td>
<p>The error-term DBM variance component</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_alpha">alpha</code></td>
<td>
<p>The size of the test (default = 0.05)</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKDbmVarCom_+3A_analysisoption">analysisOption</code></td>
<td>
<p>The desired generalization (&quot;RRRC&quot;, &quot;FRRC&quot;, &quot;RRFC&quot;, &quot;ALL&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance components are obtained using <a href="#topic+StSignificanceTesting">StSignificanceTesting</a>
with <code>method = "DBM"</code>.
</p>


<h3>Value</h3>

<p>A list object containing the estimated power and associated statistics
for each desired generalization.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>VarCom &lt;- StSignificanceTesting(dataset02, FOM = "Wilcoxon", method = "DBM", 
   analysisOption = "RRRC")$ANOVA$VarCom
VarTR &lt;- VarCom["VarTR",1]
VarTC &lt;- VarCom["VarTC",1]
VarErr &lt;- VarCom["VarErr",1]
ret &lt;- SsPowerGivenJKDbmVarCom (J = 5, K = 100, effectSize = 0.05, VarTR, 
   VarTC, VarErr, analysisOption = "RRRC")
cat("RRRC power = ", ret$powerRRRC)
  
</code></pre>

<hr>
<h2 id='SsPowerGivenJKOrVarCom'>Power given J, K and Obuchowski-Rockette variance components</h2><span id='topic+SsPowerGivenJKOrVarCom'></span>

<h3>Description</h3>

<p>Power given J, K and Obuchowski-Rockette variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsPowerGivenJKOrVarCom(
  J,
  K,
  KStar,
  effectSize,
  VarTR,
  Cov1,
  Cov2,
  Cov3,
  Var,
  alpha = 0.05,
  analysisOption = "RRRC"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_j">J</code></td>
<td>
<p>The number of readers in the <strong>pivotal</strong> study</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_k">K</code></td>
<td>
<p>The number of cases in the <strong>pivotal</strong> study</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_kstar">KStar</code></td>
<td>
<p>The number of cases in the <strong>pilot</strong> study</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_effectsize">effectSize</code></td>
<td>
<p>The effect size</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_vartr">VarTR</code></td>
<td>
<p>The treatment-reader OR variance component</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_cov1">Cov1</code></td>
<td>
<p>The OR Cov1 covariance</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_cov2">Cov2</code></td>
<td>
<p>The OR Cov2 covariance</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_cov3">Cov3</code></td>
<td>
<p>The OR Cov3 covariance</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_var">Var</code></td>
<td>
<p>The OR pure variance term</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_alpha">alpha</code></td>
<td>
<p>The size of the test (default = 0.05)</p>
</td></tr>
<tr><td><code id="SsPowerGivenJKOrVarCom_+3A_analysisoption">analysisOption</code></td>
<td>
<p>The desired generalization (&quot;RRRC&quot;, &quot;FRRC&quot;, &quot;RRFC&quot;, &quot;ALL&quot;)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance components are obtained using <a href="#topic+StSignificanceTesting">StSignificanceTesting</a> 
with <code>method = "OR"</code>.
</p>


<h3>Value</h3>

<p>A list object containing the estimated power and associated statistics
for each desired generalization.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dataset &lt;- dataset02 ## the pilot study
KStar &lt;- length(dataset$ratings$NL[1,1,,1])
VarCom &lt;- StSignificanceTesting(dataset, FOM = "Wilcoxon", 
method = "OR", analysisOption = "RRRC")$ANOVA$VarCom
VarTR &lt;- VarCom["VarTR",1]
Cov1 &lt;- VarCom["Cov1",1]
Cov2 &lt;- VarCom["Cov2",1]
Cov3 &lt;- VarCom["Cov3",1]
Var &lt;- VarCom["Var",1]
ret &lt;- SsPowerGivenJKOrVarCom (J = 5, K = 100, KStar = KStar,  
   effectSize = 0.05, VarTR, Cov1, Cov2, Cov3, Var, analysisOption = "RRRC")
    
cat("RRRC power = ", ret$powerRRRC)

</code></pre>

<hr>
<h2 id='SsPowerTable'>Generate a power table using the OR method</h2><span id='topic+SsPowerTable'></span>

<h3>Description</h3>

<p>Generate combinations of numbers of readers J and numbers of 
cases K for desired power and specified generalization(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsPowerTable(
  dataset,
  FOM,
  effectSize = NULL,
  alpha = 0.05,
  desiredPower = 0.8,
  analysisOption = "RRRC"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsPowerTable_+3A_dataset">dataset</code></td>
<td>
<p>The <b>pilot</b> ROC dataset to be used to extrapolate 
to the <b>pivotal</b> study.</p>
</td></tr>
<tr><td><code id="SsPowerTable_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit.</p>
</td></tr>
<tr><td><code id="SsPowerTable_+3A_effectsize">effectSize</code></td>
<td>
<p>The effect size to be used in the <b>pivotal</b> study, 
default value is <code>NULL</code>. See Details.</p>
</td></tr>
<tr><td><code id="SsPowerTable_+3A_alpha">alpha</code></td>
<td>
<p>The The size of the test, default is 0.05.</p>
</td></tr>
<tr><td><code id="SsPowerTable_+3A_desiredpower">desiredPower</code></td>
<td>
<p>The desired statistical power, default is 0.8.</p>
</td></tr>
<tr><td><code id="SsPowerTable_+3A_analysisoption">analysisOption</code></td>
<td>
<p>Desired generalization, &quot;RRRC&quot;  (the default), &quot;FRRC&quot;, 
&quot;RRFC&quot; or &quot;ALL&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default <code>effectSize</code> uses the observed effect size in the 
pilot study. A supplied numeric value over-rides the default value.
</p>


<h3>Value</h3>

<p>A list containing up to 3 (depending on <code>analysisOption</code>) dataframes. 
Each dataframe contains 3 arrays:
</p>
<table role = "presentation">
<tr><td><code>numReaders</code></td>
<td>
<p>The numbers of readers in the pivotal study.</p>
</td></tr>
<tr><td><code>numCases</code></td>
<td>
<p>The numbers of cases in the pivotal study.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>The estimated statistical powers.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The procedure is valid for ROC studies only; for FROC studies see 
Vignettes 19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Examples with CPU or elapsed time &gt; 5s
##              user    system elapsed
## SsPowerTable 20.033  0.037  20.077    

## Example of sample size calculation with OR method
## SsPowerTable(dataset02, FOM = "Wilcoxon", method = "OR")

 
</code></pre>

<hr>
<h2 id='SsSampleSizeKGivenJ'>Number of cases, for specified number of readers, to achieve desired power</h2><span id='topic+SsSampleSizeKGivenJ'></span>

<h3>Description</h3>

<p>Number of cases to achieve the desired power, for 
specified number of readers J, and specified DBM or ORH analysis method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SsSampleSizeKGivenJ(
  dataset,
  ...,
  J,
  FOM,
  effectSize = NULL,
  method = "OR",
  alpha = 0.05,
  desiredPower = 0.8,
  analysisOption = "RRRC",
  LegacyCode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SsSampleSizeKGivenJ_+3A_dataset">dataset</code></td>
<td>
<p>The <b>pilot</b> dataset. If set to NULL 
then variance components must be supplied.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_...">...</code></td>
<td>
<p>Optional variance components, VarTR, VarTC and VarErr. These are
needed if dataset is not supplied.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_j">J</code></td>
<td>
<p>The number of readers in the <strong>pivotal</strong> study.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit. Not needed if variance components are supplied.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_effectsize">effectSize</code></td>
<td>
<p>The effect size to be used in the <strong>pivotal</strong> study.
Default is NULL. Must be supplied if dataset is set to NULL and variance 
components are supplied.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_method">method</code></td>
<td>
<p>&quot;OR&quot; (default) or &quot;DBM&quot;.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the study, default is 0.05.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_desiredpower">desiredPower</code></td>
<td>
<p>The desired statistical power, default is 0.8.</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_analysisoption">analysisOption</code></td>
<td>
<p>Desired generalization, &quot;RRRC&quot;, &quot;FRRC&quot;, &quot;RRFC&quot; or &quot;ALL&quot; 
(the default).</p>
</td></tr>
<tr><td><code id="SsSampleSizeKGivenJ_+3A_legacycode">LegacyCode</code></td>
<td>
<p>Logical, default is <code>FALSE</code>, if <code>TRUE</code> the DBM
method is used. Otherwise the OR method is used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>effectSize</code> = NULL uses the <strong>observed</strong> effect size in 
the pilot study. A numeric value over-rides the default value. This 
argument must be supplied if dataset = NULL and variance compenents 
(the optional ... arguments) are supplied.
</p>


<h3>Value</h3>

<p>A list of two elements:
</p>
<table role = "presentation">
<tr><td><code>K</code></td>
<td>
<p>The minimum number of cases K in the pivotal study 
to just achieve the desired statistical power, calculated 
for each value of <code>analysisOption</code>.</p>
</td></tr>
<tr><td><code>power</code></td>
<td>
<p>The predicted statistical power.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The procedure is valid for ROC studies only; for FROC studies see 
Vignettes 19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## the following two should give identical results
SsSampleSizeKGivenJ(dataset02, FOM = "Wilcoxon", effectSize = 0.05, J = 6, method = "DBM")

a &lt;- UtilVarComponentsDBM(dataset02, FOM = "Wilcoxon")$VarCom
SsSampleSizeKGivenJ(dataset = NULL, J = 6, effectSize = 0.05, method = "DBM", LegacyCode = TRUE,
   list(VarTR = a["VarTR",1], 
   VarTC = a["VarTC",1], 
   VarErr = a["VarErr",1]))

## the following two should give identical results
SsSampleSizeKGivenJ(dataset02, FOM = "Wilcoxon", effectSize = 0.05, J = 6, method = "OR")

a &lt;- UtilORVarComponentsFactorial(dataset02, FOM = "Wilcoxon")$VarCom
KStar &lt;- length(dataset02$ratings$NL[1,1,,1])
SsSampleSizeKGivenJ(dataset = NULL, J = 6, effectSize = 0.05, method = "OR", 
   list(KStar = KStar, 
   VarTR = a["VarTR",1], 
   Cov1 = a["Cov1",1], 
   Cov2 = a["Cov2",1], 
   Cov3 = a["Cov3",1], 
   Var = a["Var",1]))

 
for (J in 6:10) {
 ret &lt;- SsSampleSizeKGivenJ(dataset02, FOM = "Wilcoxon", J = J, analysisOption = "RRRC") 
 message("# of readers = ", J, " estimated # of cases = ", ret$K, 
 ", predicted power = ", signif(ret$powerRRRC,3), "\n")
}


</code></pre>

<hr>
<h2 id='StSignificanceTesting'>Performs DBM or OR significance testing for factorial or split-plot A,C datasets</h2><span id='topic+StSignificanceTesting'></span>

<h3>Description</h3>

<p>Performs Dorfman-Berbaum-Metz (DBM) or Obuchowski-Rockette (OR) 
significance testing, for specified dataset; 
significance testing refers to analysis designed to assign a P-value, 
and other statistics, for 
rejecting the null hypothesis (NH) that the reader-averaged 
figure of merit (FOM) differences between treatments is zero. The results of 
the analysis are best visualized in the text or  
Excel-formatted files produced by <code><a href="#topic+UtilOutputReport">UtilOutputReport</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StSignificanceTesting(
  dataset,
  FOM,
  FPFValue = 0.2,
  alpha = 0.05,
  method = "DBM",
  covEstMethod = "jackknife",
  nBoots = 200,
  analysisOption = "ALL",
  tempOrgCode = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StSignificanceTesting_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be analyzed, see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>. 
Must have two or more treatments and two or more readers. The dataset design
can be &quot;FCTRL&quot;, &quot;SPLIT-PLOT-A&quot; or &quot;SPLIT-PLOT-C&quot;.</p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit, see <code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code></p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_alpha">alpha</code></td>
<td>
<p>The significance level of the test of the null hypothesis that all 
treatment effects are zero; the default is 0.05</p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_method">method</code></td>
<td>
<p>The significance testing method to be used:
<code>"DBM"</code> (the default), representing the 
Dorfman-Berbaum-Metz method or <code>"OR"</code>, representing the 
Obuchowski-Rockette method.
and the Obuchowski-Rockette significance testing methods, respectively.</p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_covestmethod">covEstMethod</code></td>
<td>
<p>The covariance matrix estimation method
in <code>ORH</code> analysis (for <code>method = "DBM"</code> the jackknife is always used).
</p>
 
<ul>
<li> <p><code>"Jackknife"</code>, the default, 
</p>
</li>
<li> <p><code>"Bootstrap"</code>, in which case <code>nBoots</code> (above) is relevant, 
</p>
</li>
<li> <p><code>"DeLong"</code>; requires <code>FOM = "Wilcoxon" or "ROI" or "HrAuc"</code>, 
otherwise an error results.
</p>
</li></ul>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_nboots">nBoots</code></td>
<td>
<p>The number of bootstraps (defaults to 200), relevant only if 
<code>covEstMethod = "bootstrap"</code> and <code>method = "OR"</code></p>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_analysisoption">analysisOption</code></td>
<td>
<p>Determines which factors are regarded as random vs. fixed:
</p>
 
<ul>
<li> <p><code>"RRRC"</code> = random-reader random case, 
</p>
</li>
<li> <p><code>"FRRC"</code> = fixed-reader random case, 
</p>
</li>
<li> <p><code>"RRFC"</code> = random-reader fixed case, 
</p>
</li>
<li> <p><code>"ALL"</code> =  outputs results of <code>"RRRC"</code>, <code>"FRRC"</code> 
and <code>"RRFC"</code> analyses - this is the default.
</p>
</li></ul>
</td></tr>
<tr><td><code id="StSignificanceTesting_+3A_temporgcode">tempOrgCode</code></td>
<td>
<p>default FALSE; if TRUE, then code from version 0.0.1 of RJafroc
is used (see RJafroc_0.0.1.tar). This is intended to check against errors 
that crept in subsequent to the original version as I attempted to improve 
the organization of the code and the output. As implicit in the name of this 
temporary flag, it will eventually be removed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><strong>For <code>method = "DBM"</code> the returned list contains 4 dataframes:</strong>
</p>
<table role = "presentation">
<tr><td><code>FOMs</code></td>
<td>
<p>Contains <code>foms</code>, <code>trtMeans</code> and <code>trtMeanDiffs</code>: 
see return of <code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code></p>
</td></tr>
<tr><td><code>ANOVA</code></td>
<td>
<p>Contains <code>TRCAnova</code>, <code>VarCom</code>, <code>IndividualTrt</code> 
and <code>IndividualRdr</code> ANOVA tables of pseudovalues</p>
</td></tr>
<tr><td><code>RRRC</code></td>
<td>
<p>Contains results of <code>"RRRC"</code> analyses: <code>FTests</code>, 
<code>ciDiffTrt</code>, <code>ciAvgRdrEachTrt</code></p>
</td></tr>
<tr><td><code>FRRC</code></td>
<td>
<p>Contains results of <code>"FRRC"</code> analyses: <code>FTests</code>, 
<code>ciDiffTrt</code>, <code>ciAvgRdrEachTrt</code>, <code>ciDiffTrtEachRdr</code></p>
</td></tr>
<tr><td><code>RRFC</code></td>
<td>
<p>Contains results of <code>"RRFC"</code> analyses: <code>FTests</code>, 
<code>ciDiffTrt</code>, <code>ciAvgRdrEachTrt</code></p>
</td></tr>
</table>
<p><strong>For <code>method = "OR"</code> the return list contains 4 dataframes:</strong>
</p>
<table role = "presentation">
<tr><td><code>FOMs</code></td>
<td>
<p>Contains <code>foms</code>, <code>trtMeans</code> and <code>trtMeanDiffs</code>: 
<code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code></p>
</td></tr>
<tr><td><code>ANOVA</code></td>
<td>
<p>Contains <code>TRAnova</code>, <code>VarCom</code>, <code>IndividualTrt</code> 
and <code>IndividualRdr</code> ANOVA tables of FOM values</p>
</td></tr>
<tr><td><code>RRRC</code></td>
<td>
<p>Contains results of <code>"RRRC"</code> analyses - same 
organization as DBM, see above</p>
</td></tr>
<tr><td><code>FRRC</code></td>
<td>
<p>Contains results of <code>"FRRC"</code> analyses - ditto</p>
</td></tr>
<tr><td><code>RRFC</code></td>
<td>
<p>Contains results of <code>"RRFC"</code> analyses- ditto</p>
</td></tr>
</table>


<h3>References</h3>

<p>Dorfman DD, Berbaum KS, Metz CE (1992) ROC characteristic rating analysis: 
Generalization to the Population of Readers and Patients with the Jackknife method, Invest. Radiol. 27, 723-731.
</p>
<p>Obuchowski NA, Rockette HE (1995) Hypothesis Testing of the Diagnostic Accuracy for Multiple Diagnostic Tests:  
An ANOVA Approach with Dependent Observations, Communications in Statistics: Simulation and Computation 24, 285-308.
</p>
<p>Hillis SL (2014) A marginal-mean ANOVA approach for analyzing multireader multicase radiological imaging data, 
Statistics in medicine 33, 330-360.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>StSignificanceTesting(dataset02,FOM = "Wilcoxon", method = "DBM") 
StSignificanceTesting(dataset02,FOM = "Wilcoxon", method = "OR")
## following is split-plot-c analysis using a simulated split-plot-c dataset
StSignificanceTesting(datasetFROCSpC, FOM = "wAFROC", method = "OR")


StSignificanceTesting(dataset05, FOM = "wAFROC")
StSignificanceTesting(dataset05, FOM = "HrAuc", method = "DBM") 
StSignificanceTesting(dataset05, FOM = "SongA1", method = "DBM") 
StSignificanceTesting(dataset05, FOM = "SongA2", method = "DBM") 
StSignificanceTesting(dataset05, FOM = "wAFROC1", method = "DBM")
StSignificanceTesting(dataset05, FOM = "AFROC1", method = "DBM")
StSignificanceTesting(dataset05, FOM = "AFROC", method = "DBM")
 


</code></pre>

<hr>
<h2 id='StSignificanceTestingCadVsRad'>Significance testing: standalone CAD vs. radiologists</h2><span id='topic+StSignificanceTestingCadVsRad'></span>

<h3>Description</h3>

<p>Comparing standalone CAD vs. at least two radiologists interpreting 
the same cases; <strong>standalone CAD</strong> means that <b>all</b> the 
<b>designer-level</b> mark-rating pairs generated by the CAD algorithm 
are available to the analyst, not just the one or two marks per case
displayed to the radiologist (the latter are marks whose ratings exceed a 
pre-selected threshold). At the very minimum, location-level information, 
such as in
the LROC paradigm, should be used. Ideally, the FROC paradigm should be used.
A severe statistical power penalty is paid if one uses the ROC paradigm. 
See Standalone CAD vs Radiologists chapter, available via <em>download</em> 
link at site 
<a href="https://github.com/dpc10ster/RJafrocBook/blob/gh-pages/RJafrocBook.pdf">https://github.com/dpc10ster/RJafrocBook/blob/gh-pages/RJafrocBook.pdf</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StSignificanceTestingCadVsRad(
  dataset,
  FOM,
  FPFValue = 0.2,
  method = "1T-RRRC",
  alpha = 0.05,
  plots = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_dataset">dataset</code></td>
<td>
<p><strong>The dataset to be analyzed; must be single-treatment
at least three readers, where the first reader is CAD. </strong></p>
</td></tr>
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_fom">FOM</code></td>
<td>
<p>The desired FOM; for ROC data it must be <code>"Wilcoxon"</code>, for FROC data 
it can be any valid FOM, e.g., <code>"HrAuc"</code>, <code>"wAFROC"</code>, etc; 
for LROC data it must be <code>"Wilcoxon"</code>, or <code>"PCL"</code> or <code>"ALROC"</code>.</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_method">method</code></td>
<td>
<p>The desired analysis: &quot;1T-RRFC&quot;,&quot;1T-RRRC&quot; (the default) or &quot;2T-RRRC&quot;,
see manuscript for details.</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_alpha">alpha</code></td>
<td>
<p>Significance level of the test, defaults to 0.05.</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCadVsRad_+3A_plots">plots</code></td>
<td>
<p>Flag, default is FALSE, i.e., a plot is not displayed. 
If TRUE, it displays the appropriate operating characteristic for all 
readers and CAD.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p><strong>PCL</strong> is the probability of a correct localization. 
</p>
</li>
<li><p>The LROC is the plot of PCL (ordinate) vs. FPF. 
</p>
</li>
<li><p>For LROC data, FOM = &quot;PCL&quot; means the interpolated PCL value 
at the specified <code>FPFValue</code>.
</p>
</li>
<li><p>For FOM = &quot;ALROC&quot; the trapezoidal area under the LROC
from FPF = 0 to FPF = <code>FPFValue</code> is used. 
</p>
</li>
<li><p>If <code>method = "1T-RRRC"</code> the first <strong>reader</strong> is assumed to be CAD. 
</p>
</li>
<li><p>If <code>method = "2T-RRRC"</code> the first <strong>treatment</strong> is assumed to be CAD. 
</p>
</li>
<li><p>The NH is that the FOM of CAD equals the average of the readers. 
</p>
</li>
<li><p>The <code>method = "1T-RRRC"</code> analysis uses an adaptation of the 
single-treatment multiple-reader Obuchowski Rockette (OR) model described in a 
paper by Hillis (2007), section 5.3. It is characterized by 3 parameters
<code>VarR</code>, <code>Var</code> and <code>Cov2</code>, where the latter two are estimated 
using the jackknife. 
</p>
</li>
<li><p>For <code>method = "2T-RRRC"</code> the analysis replicates the CAD data as many times as
necessary so as to form one &quot;treatment&quot; of an MRMC pairing, the other 
&quot;treatment&quot; being the radiologists. Then standard ORH analysis is applied. The 
method is described in Kooi et al. It gives exactly the same final results 
(F-statistic, ddf and p-value) as <code>"1T-RRRC"</code> but the intermediate quantities 
are meaningless.
</p>
</li></ul>



<h3>Value</h3>

<p>If <code>method = "1T-RRRC"</code> the return value is a 
list with the following elements:
</p>
<table role = "presentation">
<tr><td><code>fomCAD</code></td>
<td>
<p>The observed FOM for CAD.</p>
</td></tr>
<tr><td><code>fomRAD</code></td>
<td>
<p>The observed FOM array for the readers.</p>
</td></tr>
<tr><td><code>avgRadFom</code></td>
<td>
<p>The average FOM of the readers.</p>
</td></tr>
<tr><td><code>avgDiffFom</code></td>
<td>
<p>The mean of the difference FOM, RAD - CAD.</p>
</td></tr>
<tr><td><code>ciAvgDiffFom</code></td>
<td>
<p>The 95-percent CI of the average difference, RAD - CAD.</p>
</td></tr>
<tr><td><code>varR</code></td>
<td>
<p>The variance of the radiologists.</p>
</td></tr>
<tr><td><code>varError</code></td>
<td>
<p>The variance of the error term in the single-treatment 
multiple-reader OR model.</p>
</td></tr>
<tr><td><code>cov2</code></td>
<td>
<p>The covariance of the error term.</p>
</td></tr>
<tr><td><code>tstat</code></td>
<td>
<p>The observed value of the t-statistic; it's square is 
equivalent to an F-statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The degrees of freedom of the t-statistic.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The p-value for rejecting the NH.</p>
</td></tr>
<tr><td><code>Plots</code></td>
<td>
<p>If argument plots = TRUE, a <span class="pkg">ggplot</span> object 
containing empirical operating characteristics  
corresponding to specified FOM. For example, if <code>FOM</code> = 
<code>"Wilcoxon"</code> an ROC plot object
is produced where reader 1 is CAD. If an LROC FOM is selected, an LROC
plot is displayed.</p>
</td></tr>
</table>
<p>If <code>method = "2T-RRRC"</code> the return value is a list 
with the following elements:
</p>
<table role = "presentation">
<tr><td><code>fomCAD</code></td>
<td>
<p>The observed FOM for CAD.</p>
</td></tr>
<tr><td><code>fomRAD</code></td>
<td>
<p>The observed FOM array for the readers.</p>
</td></tr>
<tr><td><code>avgRadFom</code></td>
<td>
<p>The average FOM of the readers.</p>
</td></tr>
<tr><td><code>avgDiffFom</code></td>
<td>
<p>The mean of the difference FOM, RAD - CAD.</p>
</td></tr>
<tr><td><code>ciDiffFom</code></td>
<td>
<p>A data frame containing the statistics associated 
with the average difference, RAD - CAD.</p>
</td></tr>
<tr><td><code>ciAvgRdrEachTrt</code></td>
<td>
<p>A data frame containing the statistics 
associated with the average FOM in each &quot;treatment&quot;.</p>
</td></tr>
<tr><td><code>varR</code></td>
<td>
<p>The variance of the pure reader term in the OR model.</p>
</td></tr>
<tr><td><code>varTR</code></td>
<td>
<p>The variance of the treatment-reader term error 
term in the OR model.</p>
</td></tr>
<tr><td><code>cov1</code></td>
<td>
<p>The covariance1 of the error term - same reader, 
different treatments.</p>
</td></tr>
<tr><td><code>cov2</code></td>
<td>
<p>The covariance2 of the error term  - 
different readers, same treatment.</p>
</td></tr>
<tr><td><code>cov3</code></td>
<td>
<p>The covariance3 of the error term  - different readers, 
different treatments.</p>
</td></tr>
<tr><td><code>varError</code></td>
<td>
<p>The variance of the pure error term in the OR model.</p>
</td></tr>
<tr><td><code>FStat</code></td>
<td>
<p>The observed value of the F-statistic.</p>
</td></tr>
<tr><td><code>ndf</code></td>
<td>
<p>The numerator degrees of freedom of the F-statistic.</p>
</td></tr>
<tr><td><code>df</code></td>
<td>
<p>The denominator degrees of freedom of the F-statistic.</p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p>The p-value for rejecting the NH.</p>
</td></tr>
<tr><td><code>Plots</code></td>
<td>
<p>see above.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hillis SL (2007) A comparison of denominator degrees of freedom methods 
for multiple observer ROC studies, Statistics in Medicine. 26:596-619.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>
<p>Hupse R, Samulski M, Lobbes M, et al (2013) Standalone computer-aided detection compared to radiologists 
performance for the detection of mammographic masses, Eur Radiol. 23(1):93-100.
</p>
<p>Kooi T, Gubern-Merida A, et al. (2016) A comparison between a deep convolutional 
neural network and radiologists for classifying regions of interest in mammography. 
Paper presented at: International Workshop on Digital Mammography, Malmo, Sweden.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ret1M &lt;- StSignificanceTestingCadVsRad (dataset09, 
FOM = "Wilcoxon", method = "1T-RRRC")

StSignificanceTestingCadVsRad(datasetCadLroc, 
FOM = "Wilcoxon", method = "1T-RRFC")

retLroc1M &lt;- StSignificanceTestingCadVsRad (datasetCadLroc, 
FOM = "PCL", method = "1T-RRRC", FPFValue = 0.05)

## test with fewer readers
dataset09a &lt;- DfExtractDataset(dataset09, rdrs = seq(1:7))
ret1M7 &lt;- StSignificanceTestingCadVsRad (dataset09a, 
FOM = "Wilcoxon", method = "1T-RRRC")

datasetCadLroc7 &lt;- DfExtractDataset(datasetCadLroc, rdrs = seq(1:7))
ret1MLroc7 &lt;- StSignificanceTestingCadVsRad (datasetCadLroc7, 
FOM = "PCL", method = "1T-RRRC", FPFValue = 0.05)


## takes longer than 5 sec on OSX
## retLroc2M &lt;- StSignificanceTestingCadVsRad (datasetCadLroc, 
## FOM = "PCL", method = "2T-RRRC", FPFValue = 0.05)

## ret2MLroc7 &lt;- StSignificanceTestingCadVsRad (datasetCadLroc7, 
## FOM = "PCL", method = "2T-RRRC", FPFValue = 0.05)


</code></pre>

<hr>
<h2 id='StSignificanceTestingCrossedModalities'>Perform significance testing using crossed treatments analysis</h2><span id='topic+StSignificanceTestingCrossedModalities'></span>

<h3>Description</h3>

<p>Performs ORH analysis for specified crossed treatments dataset 
averaged over specified treatment factor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>StSignificanceTestingCrossedModalities(
  ds,
  avgIndx,
  FOM = "wAFROC",
  alpha = 0.05,
  analysisOption = "ALL"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="StSignificanceTestingCrossedModalities_+3A_ds">ds</code></td>
<td>
<p>The crossed treatments dataset</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCrossedModalities_+3A_avgindx">avgIndx</code></td>
<td>
<p>The index of the treatment to be averaged over</p>
</td></tr>
<tr><td><code id="StSignificanceTestingCrossedModalities_+3A_fom">FOM</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code></p>
</td></tr>
<tr><td><code id="StSignificanceTestingCrossedModalities_+3A_alpha">alpha</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code></p>
</td></tr>
<tr><td><code id="StSignificanceTestingCrossedModalities_+3A_analysisoption">analysisOption</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The return list contains the same items with <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## read the built in dataset
retCrossed2 &lt;- StSignificanceTestingCrossedModalities(datasetCrossedModality, 1)


</code></pre>

<hr>
<h2 id='UtilAnalyticalAucsRSM'>RSM ROC/AFROC/wAFROC AUC calculator</h2><span id='topic+UtilAnalyticalAucsRSM'></span>

<h3>Description</h3>

<p>Returns the ROC, AFROC and wAFROC AUCs corresponding to 
specified RSM parameters. See also <code><a href="#topic+UtilAucPROPROC">UtilAucPROPROC</a></code>, 
<code><a href="#topic+UtilAucBinormal">UtilAucBinormal</a></code> and <code><a href="#topic+UtilAucCBM">UtilAucCBM</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilAnalyticalAucsRSM(mu, lambda, nu, zeta1 = -Inf, lesDistr, relWeights = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_mu">mu</code></td>
<td>
<p>The mean of the Gaussian distribution for the 
ratings of latent LLs (continuous ratings of lesions that 
are found by the search mechanism). The NLs are assumed to be distributed
as N(0,1).</p>
</td></tr>
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_lambda">lambda</code></td>
<td>
<p>The RSM lambda parameter.</p>
</td></tr>
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_nu">nu</code></td>
<td>
<p>The RSM nu parameters.</p>
</td></tr>
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_zeta1">zeta1</code></td>
<td>
<p>The lowest reporting threshold, the default is <code>-Inf</code>.</p>
</td></tr>
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_lesdistr">lesDistr</code></td>
<td>
<p>The lesion distribution 1D array, i.e., the probability
mass function (pmf) of the numbers of lesions for diseased cases.</p>
</td></tr>
<tr><td><code id="UtilAnalyticalAucsRSM_+3A_relweights">relWeights</code></td>
<td>
<p>The relative weights of the lesions; a vector of 
length <code>maxLL</code>; if zero, the default, equal weights are assumed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the ROC, AFROC and wAFROC AUCs corresponding to the 
specified parameters
</p>


<h3>References</h3>

<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>
<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm, Phys Med Biol 51, 3449-3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search, Phys Med Biol 51, 3463&ndash;3482.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 1;lambda &lt;- 1;nu &lt;- 0.9
lesDistr &lt;- c(0.9, 0.1) 
## i.e., 90% of dis. cases have one lesion, and 10% have two lesions
relWeights &lt;- c(0.05, 0.95)
## i.e., lesion 1 has weight 5 percent while lesion two has weight 95 percent

UtilAnalyticalAucsRSM(mu, lambda, nu, zeta1 = -Inf, lesDistr)
UtilAnalyticalAucsRSM(mu, lambda, nu, zeta1 = -Inf, lesDistr, relWeights)


</code></pre>

<hr>
<h2 id='UtilAucBinormal'>Binormal model AUC function</h2><span id='topic+UtilAucBinormal'></span>

<h3>Description</h3>

<p>Returns the Binormal model ROC-AUC corresponding to 
specified parameters. See also <code><a href="#topic+UtilAnalyticalAucsRSM">UtilAnalyticalAucsRSM</a></code>, <code><a href="#topic+UtilAucPROPROC">UtilAucPROPROC</a></code> 
and <code><a href="#topic+UtilAucCBM">UtilAucCBM</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilAucBinormal(a, b)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilAucBinormal_+3A_a">a</code></td>
<td>
<p>The <code>a</code> parameter of the binormal model (separation of 
non-diseased and diseased pdfs)</p>
</td></tr>
<tr><td><code id="UtilAucBinormal_+3A_b">b</code></td>
<td>
<p>The <code>b</code> parameter of the binormal model (std. dev. of 
non-diseased diseased pdf; diseased pdf has unit std. dev)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Binormal model-predicted ROC-AUC
</p>


<h3>References</h3>

<p>Dorfman DD, Alf E (1969) Maximum-Likelihood Estimation of Parameters of Signal-Detection Theory and 
Determination of Confidence Intervals - Rating-Method Data, Journal of Mathematical Psychology. 6:487-496.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- 2;b &lt;- 0.7
UtilAucBinormal(a,b)

</code></pre>

<hr>
<h2 id='UtilAucCBM'>CBM AUC function</h2><span id='topic+UtilAucCBM'></span>

<h3>Description</h3>

<p>Returns the CBM ROC-AUC
See also <code><a href="#topic+UtilAnalyticalAucsRSM">UtilAnalyticalAucsRSM</a></code>, <code><a href="#topic+UtilAucPROPROC">UtilAucPROPROC</a></code> and <code><a href="#topic+UtilAucBinormal">UtilAucBinormal</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilAucCBM(mu, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilAucCBM_+3A_mu">mu</code></td>
<td>
<p>The <code>mu</code> parameter of CBM (separation of non-diseased 
and diseased pdfs)</p>
</td></tr>
<tr><td><code id="UtilAucCBM_+3A_alpha">alpha</code></td>
<td>
<p>The <code>alpha</code> parameter of CBM, i.e., the fraction 
of diseased cases on which the disease is visible</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CBM-predicted ROC-AUC for the specified parameters
</p>


<h3>References</h3>

<p>Dorfman DD, Berbaum KS (2000) A contaminated binormal model for ROC data: Part II. 
A formal model, Acad Radiol 7:6 427&ndash;437.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 2;alpha &lt;- 0.8
UtilAucCBM(mu,alpha)


</code></pre>

<hr>
<h2 id='UtilAucPROPROC'>PROPROC AUC function</h2><span id='topic+UtilAucPROPROC'></span>

<h3>Description</h3>

<p>Returns the PROPROC ROC-AUC corresponding to specified 
parameters. See also <code><a href="#topic+UtilAnalyticalAucsRSM">UtilAnalyticalAucsRSM</a></code>, <code><a href="#topic+UtilAucBinormal">UtilAucBinormal</a></code> 
and <code><a href="#topic+UtilAucCBM">UtilAucCBM</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilAucPROPROC(c1, da)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilAucPROPROC_+3A_c1">c1</code></td>
<td>
<p>The c-parameter of the PROPROC model, since <strong>c is a reserved 
function in R</strong>.</p>
</td></tr>
<tr><td><code id="UtilAucPROPROC_+3A_da">da</code></td>
<td>
<p>The da-parameter of the PROPROC model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>PROPROC model-predicted ROC-AUC for the specified parameters
</p>


<h3>References</h3>

<p>Metz CE, Pan X (1999) Proper Binormal ROC Curves: Theory and Maximum-Likelihood Estimation, J Math Psychol 43(1):1-33.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>c1 &lt;- .2;da &lt;- 1.5
UtilAucPROPROC(c1,da)


</code></pre>

<hr>
<h2 id='UtilDBM2ORVarCom'>Convert from DBM to OR variance components</h2><span id='topic+UtilDBM2ORVarCom'></span>

<h3>Description</h3>

<p><code>UtilDBM2ORVarCom</code> converts from DBM variance components to OR 
variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilDBM2ORVarCom(K, DBMVarCom)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilDBM2ORVarCom_+3A_k">K</code></td>
<td>
<p>Total number of cases</p>
</td></tr>
<tr><td><code id="UtilDBM2ORVarCom_+3A_dbmvarcom">DBMVarCom</code></td>
<td>
<p>DBM variance components, a data.frame 
containing VarR, VarC, VarTR, VarTC, VarRC and VarErr</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>UtilDBM2ORVarCom</code> returns the equivalent OR Variance components
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DBMVarCom &lt;- StSignificanceTesting(dataset02, FOM = "Wilcoxon", method = "DBM")$ANOVA$VarCom
UtilDBM2ORVarCom(114, DBMVarCom)

ORVarCom &lt;- StSignificanceTesting(dataset02, FOM = "Wilcoxon", method = "OR")$ANOVA$VarCom
UtilOR2DBMVarCom(114, ORVarCom)


</code></pre>

<hr>
<h2 id='UtilFigureOfMerit'>Calculate empirical figures of merit (FOMs) for specified dataset</h2><span id='topic+UtilFigureOfMerit'></span>

<h3>Description</h3>

<p>Calculate the specified empirical figure of merit
for each treatment-reader combination in the 
ROC, FROC, ROI or LROC dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilFigureOfMerit(dataset, FOM = "wAFROC", FPFValue = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilFigureOfMerit_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be analyzed, <code><a href="#topic+RJafroc-package">RJafroc-package</a></code></p>
</td></tr>
<tr><td><code id="UtilFigureOfMerit_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit; the default is <code>"wAFROC"</code></p>
</td></tr>
<tr><td><code id="UtilFigureOfMerit_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The allowed FOMs depend on the <code>dataType</code> field of the 
<code>dataset</code> object.  
</p>
<p><strong>For <code>dataset$descriptions$design = "SPLIT-PLOT-C"</code>, end-point based 
FOMs (e.g., &quot;MaxLLF&quot;) are not allowed</strong>.
<strong>For <code>dataset$descriptions$type = "ROC"</code> only <code>FOM = "Wilcoxon"</code> is allowed</strong>.
<strong>For <code>dataset$descriptions$type = "FROC"</code> the following FOMs are allowed</strong>:
</p>
 
<ul>
<li> <p><code>FOM = "AFROC1"</code> (use only if zero normal cases)
</p>
</li>
<li> <p><code>FOM = "AFROC"</code> 
</p>
</li>
<li> <p><code>FOM = "wAFROC1"</code> (use only if zero normal cases)
</p>
</li>
<li> <p><code>FOM = "wAFROC"</code> (the default) 
</p>
</li>
<li> <p><code>FOM = "HrAuc"</code> 
</p>
</li>
<li> <p><code>FOM = "SongA1"</code> 
</p>
</li>
<li> <p><code>FOM = "SongA2"</code>  
</p>
</li>
<li> <p><code>FOM = "HrSe"</code> (an example of an end-point based FOM)
</p>
</li>
<li> <p><code>FOM = "HrSp"</code> (another example)
</p>
</li>
<li> <p><code>FOM = "MaxLLF"</code> (do:)
</p>
</li>
<li> <p><code>FOM = "MaxNLF"</code> (do:)
</p>
</li>
<li> <p><code>FOM = "MaxNLFAllCases"</code> (do:) 
</p>
</li>
<li> <p><code>FOM = "ExpTrnsfmSp"</code>  
</p>
</li></ul>
 
<p><code>"MaxLLF"</code>, <code>"MaxNLF"</code> and <code>"MaxNLFAllCases"</code>
correspond to ordinate, and abscissa, respectively, of the highest point 
on the FROC operating characteristic obtained by counting all the marks. 
The <code>"ExpTrnsfmSp"</code> FOM is described in the paper by Popescu. 
Given the large number of FOMs possible with FROC data, it is appropriate 
to make a recommendation: <strong>it is recommended that one use the wAFROC FOM
whenever possible.</strong>
</p>
<p>For <strong><code>dataType = "ROI"</code> dataset only <code>FOM = "ROI"</code> is allowed</strong>.
</p>
<p>For <strong><code>dataType = "LROC"</code></strong> dataset the following FOMs are allowed:
</p>

<ul>
<li> <p><code>FOM = "Wilcoxon"</code> for ROC data inferred from LROC data 
</p>
</li>
<li> <p><code>FOM = "PCL"</code> the probability of correct localization at specified <code>FPFValue</code>
</p>
</li>
<li> <p><code>FOM = "ALROC"</code> the area under the LROC from zero to specified <code>FPFValue</code> 
</p>
</li></ul>

<p><code>FPFValue</code> The FPF at which to evaluate <code>PCL</code> or <code>ALROC</code>; 
the default is 0.2; only needed for LROC data.
</p>


<h3>Value</h3>

<p>An <code>c(I, J)</code> dataframe, where the row names are <code>modalityID</code>'s of the 
treatments and column names are the <code>readerID</code>'s of the readers.
</p>


<h3>References</h3>

<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>
<p>Chakraborty DP, Berbaum KS (2004) Observer studies involving detection and localization: modeling, analysis, and validation, 
Medical Physics, 31(8), 1&ndash;18.
</p>
<p>Song T, Bandos AI, Rockette HE, Gur D (2008) On comparing methods for discriminating between actually negative and actually positive subjects 
with FROC type data, Medical Physics 35 1547&ndash;1558.
</p>
<p>Popescu LM (2011) Nonparametric signal detectability evaluation using an exponential transformation of the FROC curve, 
Medical Physics, 38(10), 5690. 
</p>
<p>Obuchowski NA, Lieber ML, Powell KA (2000) Data Analysis for Detection and Localization of Multiple Abnormalities 
with Application to Mammography, Acad Radiol, 7:7 553&ndash;554.
</p>
<p>Swensson RG (1996) Unified measurement of observer performance in detecting and localizing target objects on images, 
Med Phys 23:10, 1709&ndash;1725.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilFigureOfMerit(dataset02, FOM = "Wilcoxon") # ROC data
UtilFigureOfMerit(DfFroc2Roc(dataset01), FOM = "Wilcoxon") # FROC dataset, converted to ROC
UtilFigureOfMerit(dataset01) # FROC dataset, default wAFROC FOM
UtilFigureOfMerit(datasetCadLroc, FOM = "Wilcoxon") #LROC data
UtilFigureOfMerit(datasetCadLroc, FOM = "PCL") #LROC data
UtilFigureOfMerit(datasetCadLroc, FOM = "ALROC") #LROC data
UtilFigureOfMerit(datasetROI, FOM = "ROI") #ROI data
 # these are meant to illustrate conditions which will throw an error
## UtilFigureOfMerit(dataset02, FOM = "wAFROC") #error
## UtilFigureOfMerit(dataset01, FOM = "Wilcoxon") #error


</code></pre>

<hr>
<h2 id='UtilIntrinsic2RSM'>Convert from intrinsic to physical RSM parameters</h2><span id='topic+UtilIntrinsic2RSM'></span>

<h3>Description</h3>

<p>Convert <strong>intrinsic</strong> RSM parameters <code class="reqn">lambda_i</code> and <code class="reqn">nu_i</code> 
correspond to the <strong>physical</strong> RSM parameters <code class="reqn">lambda_i'</code> 
and <code class="reqn">nu_i'</code>. The physical parameters are more meaningful but they 
depend on <code class="reqn">mu</code>. The intrinsic parameters are independent of 
<code class="reqn">mu</code>. See book for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilIntrinsic2RSM(mu, lambda_i, nu_i)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilIntrinsic2RSM_+3A_mu">mu</code></td>
<td>
<p>The mean of the Gaussian distribution for the ratings of latent 
LLs, i.e. continuous ratings of lesions that were found by the search 
mechanism ~ N(<code class="reqn">\mu</code>,1). The corresponding distribution for the 
ratings of latent NLs is N(0,1).</p>
</td></tr>
<tr><td><code id="UtilIntrinsic2RSM_+3A_lambda_i">lambda_i</code></td>
<td>
<p>The <em>intrinsic</em> Poisson lambda_i parameter.</p>
</td></tr>
<tr><td><code id="UtilIntrinsic2RSM_+3A_nu_i">nu_i</code></td>
<td>
<p>The <em>intrinsic</em> Binomial nu_i parameter.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RSM is the Radiological Search Model described in the book. 
See also <code><a href="#topic+UtilRSM2Intrinsic">UtilRSM2Intrinsic</a></code>.
</p>


<h3>Value</h3>

<p>A list containing <code class="reqn">\lambda</code> and <code class="reqn">\nu</code>
</p>


<h3>References</h3>

<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm, Phys Med Biol 51, 3449&ndash;3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search, Phys Med Biol 51, 3463&ndash;3482.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 2;lambda_i &lt;- 20;nu_i &lt;- 1.1512925 
lambda &lt;- UtilIntrinsic2RSM(mu, lambda_i, nu_i)$lambda 
nu &lt;- UtilIntrinsic2RSM(mu, lambda_i, nu_i)$nu 
## note that the physical values are only constrained to be positive, but the physical variable nu
## must obey 0 &lt;= nu &lt;= 1


</code></pre>

<hr>
<h2 id='UtilLesionDistrVector'>Get the lesion distribution vector of a dataset</h2><span id='topic+UtilLesionDistrVector'></span>

<h3>Description</h3>

<p>The lesion distribution vector for a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilLesionDistrVector(dataset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilLesionDistrVector_+3A_dataset">dataset</code></td>
<td>
<p>A dataset object.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two characteristics of an FROC dataset, apart from ratings, 
affect the FOM: the distribution of lesions per case and the distribution 
of lesion weights. This function addresses the distribution of lesions per 
case. The distribution of weights is addressed in <a href="#topic+UtilLesionWeightsMatrix">UtilLesionWeightsMatrix</a>. 
<code>lesDistr</code> is a 1D-array containing the fraction of <b>unique</b> 
values of lesions per diseased case in the dataset. For ROC or LROC data 
this vector is <code>c(1)</code>, since all diseased cases contain one lesion. 
For FROC data the length of the vector equals the maximum number of lesions 
per diseased case. The first entry is the fraction of dis. cases containing 
one lesion, the second entry is the fraction of dis. cases containing two lesions, etc. 
See <a href="#topic+PlotRsmOperatingCharacteristics">PlotRsmOperatingCharacteristics</a> for a function that depends on 
<code>lesDistr</code>.
</p>


<h3>Value</h3>

<p>lesDistr The 1D lesion distribution array.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilLesionDistrVector (dataset01) # FROC dataset ## [1] 0.93258427 0.06741573
UtilLesionDistrVector (dataset02) # ROC dataset  ## 1

</code></pre>

<hr>
<h2 id='UtilLesionWeightsMatrix'>Determine lesion weights distribution 2D matrix</h2><span id='topic+UtilLesionWeightsMatrix'></span><span id='topic+UtilLesionWeightsMatrixDataset'></span><span id='topic+UtilLesionWeightsMatrixLesDistr'></span>

<h3>Description</h3>

<p>Determine the lesion weights distribution 2D matrix of a dataset or 
manually specify the lesion weights distribution 2D matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilLesionWeightsMatrixDataset(dataset, relWeights = 0)

UtilLesionWeightsMatrixLesDistr(lesDistr, relWeights = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilLesionWeightsMatrix_+3A_dataset">dataset</code></td>
<td>
<p>A dataset object.</p>
</td></tr>
<tr><td><code id="UtilLesionWeightsMatrix_+3A_relweights">relWeights</code></td>
<td>
<p>The relative weights of the lesions: a unit sum vector of 
length equal to the maximum number of lesions per dis. case. For example, 
<code>c(0.2, 0.4, 0.1, 0.3)</code> means that on cases with one lesion 
the weight of the lesion is unity, on cases with two 
lesions the ratio of the weight of the first lesion to that of the second 
lesion is 0.2:0.4, i.e., lesion 2 is twice as important as lesion 1. 
On cases with 4 lesions the weights are in the ratio 0.2:0.4:0.1:0.3.
The default is zero, in which case equal lesion weights are assumed.</p>
</td></tr>
<tr><td><code id="UtilLesionWeightsMatrix_+3A_lesdistr">lesDistr</code></td>
<td>
<p>A unit sum vector of length equal to the maximum number of 
lesions per diseased case, specifying the relative frequency of lesions
per dis. case in the dataset. For example, <code>c(0.8, 0.15, 0.05)</code> specifies
a dataset in which 80 percent of the dis. cases have one lesion per dis. case,
15 percent have two lesions per dis. case and 5 percent have three lesions per
dis. case. As another example, <code>c(0.8, 0.15, 0, 0.05)</code> specifies
a dataset in which 80 percent of the dis. cases have one lesion per dis. case,
15 percent have two lesions per dis. case, there are no cases with three 
lesions per dis. case and 5 percent have four lesions per dis. case.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Two characteristics of an FROC dataset, apart from the 
ratings, affect the FOM: the distribution of lesion per case and the 
distribution of lesion weights. This function addresses the weights. 
The distribution of lesions is addressed in <a href="#topic+UtilLesionDistrVector">UtilLesionDistrVector</a>. 
See 
<a href="#topic+PlotRsmOperatingCharacteristics">PlotRsmOperatingCharacteristics</a> for a function that depends on 
<code>lesWghtDistr</code>. 
The underlying assumption is that lesion 1 is the same type across all 
diseased cases, lesion 2 is the same type across all diseased cases, 
..., etc. This allows assignment of weights independent of the case index.
</p>


<h3>Value</h3>

<p>lesWghtDistr The 2D lesion weights distribution matrix. The first 
column enumerates the number of lesions per case, while the remaining 
columns contain the weights. 
Missing values are filled with <code>-Inf</code>. Not to be 
confused with the <code>lesionWeight</code> list member in an FROC dataset, 
which enumerates the weights of lesions on <b>individual</b> cases.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilLesionWeightsMatrixDataset (dataset01) # FROC data

##      [,1] [,2] [,3]
##[1,]    1  1.0 -Inf
##[2,]    2  0.5  0.5

UtilLesionWeightsMatrixDataset (dataset02) # ROC data

##      [,1] [,2]
##[1,]    1  1

## Example 1: dataset with 1 to 4 lesions per case, with frequency as per first argument
UtilLesionWeightsMatrixLesDistr (c(0.6, 0.2, 0.1, 0.1), c(0.2, 0.4, 0.1, 0.3))

##       [,1]  [,2]      [,3]      [,4]   [,5]
##[1,]    1 1.0000000      -Inf      -Inf -Inf 
##[2,]    2 0.3333333 0.6666667      -Inf -Inf
##[3,]    3 0.2857143 0.5714286 0.1428571 -Inf
##[4,]    4 0.2000000 0.4000000 0.1000000  0.3

## Explanation 
##&gt; c(0.2)/sum(c(0.2))
##[1] 1 ## (weights for cases with 1 lesion)
##&gt; c(0.2, 0.4)/sum(c(0.2, 0.4))
##[1] 0.3333333 0.6666667 ## (weights for cases with 2 lesions)
##&gt; c(0.2, 0.4, 0.1)/sum(c(0.2, 0.4, 0.1))
##[1] 0.2857143 0.5714286 0.1428571 ## (weights for cases with 3 lesions)
##&gt; c(0.2, 0.4, 0.1, 0.3)/sum(c(0.2, 0.4, 0.1, 0.3))
##[1] 0.2000000 0.4000000 0.1000000  0.3 ## (weights for cases with 4 lesions)


## Example2 : dataset with *no* cases with 3 lesions per case
UtilLesionWeightsMatrixLesDistr (c(0.1, 0.7, 0.0, 0.2), c(0.4, 0.3, 0.2, 0.1))

##       [,1]  [,2]      [,3]    [,4]
##[1,]    1 1.0000000      -Inf  -Inf
##[2,]    2 0.5714286 0.4285714  -Inf
##[3,]    4 0.5000000 0.3750000 0.125

## Explanation: note that row with 3 lesions per case does not occur 
##&gt; c(0.4)/sum(c(0.4))
##[1] 1 ## (weights for cases with 1 lesion)
##&gt; c(0.4, 0.3)/sum(c(0.4, 0.3))
##[1] 0.5714286 0.4285714 ## (weights for cases with 2 lesions)
##&gt; c(0.4, 0.3, 0.1)/sum(c(0.4, 0.3, 0.1))
##[1] 0.500 0.375 0.125 ## (weights for cases with 4 lesions)

</code></pre>

<hr>
<h2 id='UtilMeanSquares'>Calculate mean squares for factorial dataset</h2><span id='topic+UtilMeanSquares'></span>

<h3>Description</h3>

<p>Calculates the mean squares used in the DBM and ORH methods for factorial dataset
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilMeanSquares(dataset, FOM = "Wilcoxon", FPFValue = 0.2, method = "DBM")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilMeanSquares_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be analyzed, see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
<tr><td><code id="UtilMeanSquares_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit to be used in the calculation. The default 
is <code>"FOM_wAFROC"</code>. See <code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code>.</p>
</td></tr>
<tr><td><code id="UtilMeanSquares_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
<tr><td><code id="UtilMeanSquares_+3A_method">method</code></td>
<td>
<p>The method, in which the mean squares are calculated. The two 
valid choices are <code>"DBM"</code> (default) and <code>"OR"</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For <code>DBM</code> method, <code>msT, msTR, msTC, msTRC</code> will not be available 
if the dataset contains only one treatment. Similarly, 
<code>msR, msTR, msRC, msTRC</code> will not be returned for single reader dataset. 
For <code>ORH</code> method, <code>msT, msR, msTR</code> will be returned for multiple 
reader multiple treatment dataset. <code>msT</code> is not available for single 
treatment dataset, and <code>msR</code> is not available for single reader dataset.
</p>


<h3>Value</h3>

<p>A list containing all possible mean squares
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilMeanSquares(dataset02, FOM = "Wilcoxon")
UtilMeanSquares(dataset05, FOM = "wAFROC", method = "OR")

</code></pre>

<hr>
<h2 id='UtilOR2DBMVarCom'>Convert from OR to DBM variance components</h2><span id='topic+UtilOR2DBMVarCom'></span>

<h3>Description</h3>

<p><code>UtilOR2DBMVarCom</code> converts from OR to DBM variance components.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilOR2DBMVarCom(K, ORVarCom)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilOR2DBMVarCom_+3A_k">K</code></td>
<td>
<p>Total number of cases</p>
</td></tr>
<tr><td><code id="UtilOR2DBMVarCom_+3A_orvarcom">ORVarCom</code></td>
<td>
<p>OR variance components, a data.frame 
containing VarR, VarTR, Cov1, Cov2, Cov3 and Var</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>UtilOR2DBMVarCom</code> returns the equivalent DBM variance components
</p>


<h3>Examples</h3>

<pre><code class='language-R'>DBMVarCom &lt;- StSignificanceTesting(dataset02, FOM = "Wilcoxon", method = "DBM")$ANOVA$VarCom
UtilDBM2ORVarCom(114, DBMVarCom)

ORVarCom &lt;- StSignificanceTesting(dataset02, FOM = "Wilcoxon", method = "OR")$ANOVA$VarCom
UtilOR2DBMVarCom(114, ORVarCom)



</code></pre>

<hr>
<h2 id='UtilORVarComponentsFactorial'>Utility for estimating Obuchowski-Rockette variance components for factorial datasets</h2><span id='topic+UtilORVarComponentsFactorial'></span>

<h3>Description</h3>

<p>Utility for estimating Obuchowski-Rockette variance components for factorial datasets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilORVarComponentsFactorial(
  dataset,
  FOM,
  FPFValue = 0.2,
  covEstMethod = "jackknife",
  nBoots = 200,
  seed = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilORVarComponentsFactorial_+3A_dataset">dataset</code></td>
<td>
<p>The factorial dataset object</p>
</td></tr>
<tr><td><code id="UtilORVarComponentsFactorial_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit</p>
</td></tr>
<tr><td><code id="UtilORVarComponentsFactorial_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
<tr><td><code id="UtilORVarComponentsFactorial_+3A_covestmethod">covEstMethod</code></td>
<td>
<p>The covariance estimation method, &quot;jackknife&quot; 
(the default) or &quot;bootstrap&quot; or &quot;DeLong&quot; (DeLongt is applicable only for 
FOM = Wilcoxon).</p>
</td></tr>
<tr><td><code id="UtilORVarComponentsFactorial_+3A_nboots">nBoots</code></td>
<td>
<p>Only needed for bootstrap covariance estimation method. The number 
of bootstraps, defaults to 200.</p>
</td></tr>
<tr><td><code id="UtilORVarComponentsFactorial_+3A_seed">seed</code></td>
<td>
<p>Only needed for the bootstrap covariance estimation method. The initial 
seed for the random number generator, the default is <code>NULL</code>, as if no seed 
has been specified.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variance components are obtained using <a href="#topic+StSignificanceTesting">StSignificanceTesting</a> 
with <code>method = "OR"</code>.
</p>


<h3>Value</h3>

<p>A list object containing the following <code>data.frames</code>: 
</p>

<ul>
<li><p><code>foms</code>: the figures of merit for different treatment-reader combinations 
</p>
</li>
<li><p><code>TRanova</code>: the OR treatment-reader ANOVA table 
</p>
</li>
<li><p><code>VarCom</code>: the OR variance-components <code>Cov1</code>, <code>Cov2</code>, 
<code>Cov3</code>, <code>Var</code> and correlations <code>rho1</code>, <code>rho2</code> and <code>rho3</code> 
</p>
</li>
<li><p><code>IndividualTrt</code>: the individual treatment mean-squares, <code>Var</code> and <code>Cov2</code> values
</p>
</li>
<li><p><code>IndividualRdr</code>: the individual reader mean-squares, <code>Var</code> and <code>Cov1</code> values
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>## use the default jackknife for covEstMethod
vc &lt;- UtilORVarComponentsFactorial(dataset02, FOM = "Wilcoxon")
str(vc) 

UtilORVarComponentsFactorial(dataset02, FOM = "Wilcoxon", 
   covEstMethod = "bootstrap", nBoots = 2000, seed = 100)$VarCom 

UtilORVarComponentsFactorial(dataset02, FOM = "Wilcoxon", covEstMethod = "DeLong")$VarCom 
  
</code></pre>

<hr>
<h2 id='UtilOutputReport'>Generate a text formatted report file or an Excel file</h2><span id='topic+UtilOutputReport'></span>

<h3>Description</h3>

<p>Generates a formatted report of the analysis 
and saves it to a text or an Excel file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilOutputReport(
  dataset,
  ReportFileBaseName = NULL,
  ReportFileExt = "txt",
  method = "DBM",
  FOM,
  alpha = 0.05,
  covEstMethod = "jackknife",
  nBoots = 200,
  sequentialNames = FALSE,
  overWrite = FALSE,
  analysisOption = "ALL"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilOutputReport_+3A_dataset">dataset</code></td>
<td>
<p>The dataset object to be analyzed (<em>not the file name</em>), 
see <code>Dataset</code> in <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_reportfilebasename">ReportFileBaseName</code></td>
<td>
<p>The report file (with extension <code>"txt"</code> or <code>"xlsx"</code>, 
as specified by option 
<code>ReportFileExt</code>) 
is created <b>in the user's directory</b>. 
This argument specifies the 
report file base name (i.e., without the extension) for the 
desired report; the default is NULL, in which case the system generates 
a temporary text file, whose very long name is displayed. However, the 
file
is very hard to locate. This is so that the software passes CRAN checks, 
as writing to the project directory, or any of its sub-directories, is 
frowned upon.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_reportfileext">ReportFileExt</code></td>
<td>
<p>The report file extension determines the type of output. 
<code>"txt"</code>, the default, for 
a text file, <code>"xlsx"</code> for an Excel file.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_method">method</code></td>
<td>
<p>The significance testing method, <code>"OR"</code> or 
(the default) <code>"DBM"</code>.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit; see <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_alpha">alpha</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>; the default is 0.05.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_covestmethod">covEstMethod</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>; only needed 
for method = <code>"OR"</code>; the default is &quot;Jackknife&quot;.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_nboots">nBoots</code></td>
<td>
<p>See <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>; only needed for 
<code>"OR"</code> analysis; the default is 200.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_sequentialnames">sequentialNames</code></td>
<td>
<p>A logical variable: if <code>TRUE</code>, consecutive integers 
(starting from 1) will be used as the treatment and reader IDs in the 
output report. Otherwise, treatment and reader IDs in the original dataset 
are used. This option is needed for aesthetics, as long names can mess
up the output. The default is <code>FALSE.</code></p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_overwrite">overWrite</code></td>
<td>
<p>A <code>logical</code> variable: if <code>FALSE</code>, a warning will 
be issued if the report file already exists and the program will wait 
until the user inputs &quot;y&quot; or &quot;n&quot; to determine whether to overwrite the 
existing file. If <code>TRUE</code>, the existing file will be silently overwritten. 
The default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="UtilOutputReport_+3A_analysisoption">analysisOption</code></td>
<td>
<p>&quot;RRRC&quot;, &quot;FRRC&quot;, &quot;RRFC or &quot;ALL&quot;; see <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A formatted report of the data analysis is written to the output file in 
either text or Excel format.
</p>


<h3>Value</h3>

<p>StResult The object returned by <code><a href="#topic+StSignificanceTesting">StSignificanceTesting</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

 # text output is created in a temporary file
UtilOutputReport(dataset03, FOM = "Wilcoxon")
# Excel output is created in a temporary file
UtilOutputReport(dataset03, FOM = "Wilcoxon", ReportFileExt = "xlsx") 


       
</code></pre>

<hr>
<h2 id='UtilPseudoValues'>Pseudovalues for given dataset and FOM</h2><span id='topic+UtilPseudoValues'></span>

<h3>Description</h3>

<p>Returns <strong>centered</strong> jackknife pseudovalues AND jackknife FOM values, 
for factorial OR split-plot-a OR split-plot-c study designs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilPseudoValues(dataset, FOM, FPFValue = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilPseudoValues_+3A_dataset">dataset</code></td>
<td>
<p>The dataset to be analyzed, see <code><a href="#topic+RJafroc-package">RJafroc-package</a></code>;
must be factorial, or split-plot-a or split-plot-c.</p>
</td></tr>
<tr><td><code id="UtilPseudoValues_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit to be used in the calculation. 
The default is <code>"FOM_wAFROC"</code>. See <code><a href="#topic+UtilFigureOfMerit">UtilFigureOfMerit</a></code>.</p>
</td></tr>
<tr><td><code id="UtilPseudoValues_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing two arrays containing the pseudovalues
and the jackknife FOM values of the datasets (a third returned value 
is for internal use).
</p>


<h3>Note</h3>

<p>Each returned array has dimension <code>c(I,J,K)</code>, where <code>K</code> depends on the
FOM: <code>K1</code> for FOMs that are based on normal cases only, <code>K2</code> for FOMs that are 
based on abnormal cases only, and <code>K</code> for FOMs that are based on normal and 
abnormal cases.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilPseudoValues(dataset05, FOM = "wAFROC")$jkFomValues[1,1,1:10]

</code></pre>

<hr>
<h2 id='UtilRSM2Intrinsic'>Convert from physical to intrinsic RSM parameters</h2><span id='topic+UtilRSM2Intrinsic'></span>

<h3>Description</h3>

<p>Convert <strong>physical</strong> RSM parameters <code class="reqn">\lambda_i</code>' and <code class="reqn">\nu_i</code>' to the 
<strong>intrinsic</strong> RSM parameters <code class="reqn">\lambda_i</code> and <code class="reqn">\nu_i</code>. The physical 
parameters are more meaningful but they depend on <code class="reqn">\mu</code>. The intrinsic 
parameters are independent of <code class="reqn">\mu</code>. See book for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilRSM2Intrinsic(mu, lambda, nu)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilRSM2Intrinsic_+3A_mu">mu</code></td>
<td>
<p>The mean of the Gaussian distribution for the ratings of latent LLs, 
i.e. continuous ratings of lesions that were found by the search mechanism 
~ N(<code class="reqn">\mu</code>,1). The corresponding distribution for the ratings of 
latent NLs is N(0,1)</p>
</td></tr>
<tr><td><code id="UtilRSM2Intrinsic_+3A_lambda">lambda</code></td>
<td>
<p>The Poisson <code class="reqn">\lambda_i</code> parameter, which describes the 
distribution of random numbers of latent NLs (suspicious regions that do
not correspond to actual lesions) per case; the mean of these random 
numbers asymptotically approaches lambda</p>
</td></tr>
<tr><td><code id="UtilRSM2Intrinsic_+3A_nu">nu</code></td>
<td>
<p>The <code class="reqn">\nu_i</code> parameter; it is the success probability
of the binomial distribution describing the random number of latent LLs 
(suspicious regions that correspond to actual lesions) per diseased case</p>
</td></tr>
</table>


<h3>Details</h3>

<p>RSM is the Radiological Search Model described in the book. A latent mark 
becomes an actual mark if the corresponding rating exceeds the lowest reporting 
threshold zeta1. See also <code><a href="#topic+UtilIntrinsic2RSM">UtilIntrinsic2RSM</a></code>.
</p>


<h3>Value</h3>

<p>A list containing <code class="reqn">\lambda_i</code> and <code class="reqn">\nu_i</code>, the RSM search parameters
</p>


<h3>References</h3>

<p>Chakraborty DP (2006) A search model and figure of merit for observer data acquired according to the free-response 
paradigm, Phys Med Biol 51, 3449-3462.
</p>
<p>Chakraborty DP (2006) ROC Curves predicted by a model of visual search, Phys Med Biol 51, 3463&ndash;3482.
</p>
<p>Chakraborty DP (2017) <em>Observer Performance Methods for Diagnostic Imaging - Foundations, 
Modeling, and Applications with R-Based Examples</em>, CRC Press, Boca Raton, FL. 
<a href="https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840">https://www.routledge.com/Observer-Performance-Methods-for-Diagnostic-Imaging-Foundations-Modeling/Chakraborty/p/book/9781482214840</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mu &lt;- 2;lambda &lt;- 10;nu &lt;- 0.9
lambda_i &lt;- UtilRSM2Intrinsic(mu, lambda, nu)$lambda_i 
nu_i &lt;- UtilRSM2Intrinsic(mu, lambda, nu)$nu_i 
## note that the physical values are only constrained to be positive, e.g., nu_i is not constrained
## to be between 0 and one.

</code></pre>

<hr>
<h2 id='UtilVarComponentsDBM'>Utility for Dorfman-Berbaum-Metz variance components</h2><span id='topic+UtilVarComponentsDBM'></span>

<h3>Description</h3>

<p>Utility for Dorfman-Berbaum-Metz variance components
</p>


<h3>Usage</h3>

<pre><code class='language-R'>UtilVarComponentsDBM(dataset, FOM, FPFValue = 0.2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="UtilVarComponentsDBM_+3A_dataset">dataset</code></td>
<td>
<p>The dataset object</p>
</td></tr>
<tr><td><code id="UtilVarComponentsDBM_+3A_fom">FOM</code></td>
<td>
<p>The figure of merit</p>
</td></tr>
<tr><td><code id="UtilVarComponentsDBM_+3A_fpfvalue">FPFValue</code></td>
<td>
<p>Only needed for <code>LROC</code> data <strong>and</strong> FOM = &quot;PCL&quot; or &quot;ALROC&quot;;
where to evaluate a partial curve based figure of merit. The default is 0.2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing the variance components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>UtilVarComponentsDBM(dataset02, FOM = "Wilcoxon")

  
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
