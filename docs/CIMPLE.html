<!DOCTYPE html><html lang="en"><head><title>Help for package CIMPLE</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CIMPLE}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CIMPLE-package'><p>CIMPLE: Analysis of Longitudinal Electronic Health Record (EHR) Data with Possibly Informative Observational Time</p></a></li>
<li><a href='#long_data'><p>long_data</p></a></li>
<li><a href='#long_est'><p>Coefficient estimation in the longitudinal model</p></a></li>
<li><a href='#surv_data'><p>long_data</p></a></li>
<li><a href='#surv_est'><p>Coefficient estimation in the survival model with longitudinal measurements.</p></a></li>
<li><a href='#train_data'><p>long_data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analysis of Longitudinal Electronic Health Record (EHR) Data
with Possibly Informative Observational Time</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzes longitudinal Electronic Health Record (EHR) data with possibly informative observational time. These methods are grouped into two classes depending on the inferential task. One group focuses on estimating the effect of an exposure on a longitudinal biomarker while the other group assesses the impact of a longitudinal biomarker on time-to-diagnosis outcomes. The accompanying paper is Du et al (2024) &lt;<a href="https://doi.org/10.48550%2FarXiv.2410.13113">doi:10.48550/arXiv.2410.13113</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, JMbayes2, lme4, mice, nleqslv, nlme, statmod, stats,
survival, utils</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-11-09 05:45:29 UTC; hb636</td>
</tr>
<tr>
<td>Author:</td>
<td>Jiacong Du <a href="https://orcid.org/0000-0002-7768-9083"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Howard Baik <a href="https://orcid.org/0009-0000-8942-1618"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Howard Baik &lt;howard.baik@yale.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-11-12 13:20:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='CIMPLE-package'>CIMPLE: Analysis of Longitudinal Electronic Health Record (EHR) Data with Possibly Informative Observational Time</h2><span id='topic+CIMPLE'></span><span id='topic+CIMPLE-package'></span>

<h3>Description</h3>

<p>Analyzes longitudinal Electronic Health Record (EHR) data with possibly informative observational time. These methods are grouped into two classes depending on the inferential task. One group focuses on estimating the effect of an exposure on a longitudinal biomarker while the other group assesses the impact of a longitudinal biomarker on time-to-diagnosis outcomes. The accompanying paper is Du et al (2024) <a href="https://doi.org/10.48550/arXiv.2410.13113">doi:10.48550/arXiv.2410.13113</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Howard Baik <a href="mailto:howard.baik@yale.edu">howard.baik@yale.edu</a> (<a href="https://orcid.org/0009-0000-8942-1618">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Jiacong Du <a href="mailto:jiacong@umich.edu">jiacong@umich.edu</a> (<a href="https://orcid.org/0000-0002-7768-9083">ORCID</a>)
</p>
</li></ul>


<hr>
<h2 id='long_data'>long_data</h2><span id='topic+long_data'></span>

<h3>Description</h3>

<p>A subset of data from the World Health Organization Global Tuberculosis
Report ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_data
</code></pre>


<h3>Format</h3>



<h4><code>who</code></h4>

<p>A data frame with 7,240 rows and 60 columns:
</p>

<dl>
<dt>country</dt><dd><p>Country name</p>
</dd>
<dt>iso2, iso3</dt><dd><p>2 &amp; 3 letter ISO country codes</p>
</dd>
<dt>year</dt><dd><p>Year</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://www.who.int/teams/global-tuberculosis-programme/data">https://www.who.int/teams/global-tuberculosis-programme/data</a>
</p>

<hr>
<h2 id='long_est'>Coefficient estimation in the longitudinal model</h2><span id='topic+long_est'></span>

<h3>Description</h3>

<p>This function offers a collection of methods of coefficient estimation in a
longitudinal model with possibly informative observation time.
These methods include Standard linear mixed-effect model (<code>standard_LME</code>),
Linear mixed-effect model adjusted for the historical number of visits (<code>VA_LME</code>),
Joint model of the visiting process and the longitudinal process accounting for measured confounders (<code>JMVL_LY</code>),
Inverse-intensity-rate-ratio weighting approach (<code>IIRR_weighting</code>),
Joint model of the visiting process and the longitudinal process with dependent latent variables (<code>JMVL_Liang</code>),
Imputation-based approach with linear mixed-effect model (<code>imputation_LME</code>), and
Joint model of the visiting process and the longitudinal process with a shared random intercept (<code>JMVL_G</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>long_est(
  long_data,
  method,
  id_var,
  outcome_var,
  LM_fixedEffect_variables = NULL,
  time = NULL,
  LM_randomEffect_variables = NULL,
  VPM_variables = NULL,
  imp_time_factor = NULL,
  optCtrl = list(method = "nlminb", kkt = FALSE, tol = 0.2, maxit = 20000),
  control = list(verbose = FALSE, tol = 0.001, GHk = 10, maxiter = 150),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="long_est_+3A_long_data">long_data</code></td>
<td>
<p>Longitudinal dataset</p>
</td></tr>
<tr><td><code id="long_est_+3A_method">method</code></td>
<td>
<p>The following methods are available:
</p>

<ul>
<li> <p><code>standard_LME</code>: Standard linear mixed-effect model.
</p>
</li>
<li> <p><code>VA_LME</code>: Linear mixed-effect model adjusted for the historical number of visits.
</p>
</li>
<li> <p><code>JMVL_LY</code>: Joint model of the visiting process and the longitudinal process accounting for measured confounders.
</p>
</li>
<li> <p><code>IIRR_weighting</code>: Inverse-intensity-rate-ratio weighting approach.
</p>
</li>
<li> <p><code>JMVL_Liang</code>: Joint model of the visiting process and the longitudinal process with dependent latent variables.
</p>
</li>
<li> <p><code>imputation_LME</code>: Imputation-based approach with linear mixed-effect model.
</p>
</li>
<li> <p><code>JMVL_G</code>: Joint model of the visiting process and the longitudinal process with a shared random intercept.
</p>
</li></ul>
</td></tr>
<tr><td><code id="long_est_+3A_id_var">id_var</code></td>
<td>
<p>Variable for the subject ID to indicate the grouping
structure.</p>
</td></tr>
<tr><td><code id="long_est_+3A_outcome_var">outcome_var</code></td>
<td>
<p>Variable name for the longitudinal outcome variable.</p>
</td></tr>
<tr><td><code id="long_est_+3A_lm_fixedeffect_variables">LM_fixedEffect_variables</code></td>
<td>
<p>Vector input of variable names with fixed
effects in the longitudinal model. Variables should not contain <code>time</code>.</p>
</td></tr>
<tr><td><code id="long_est_+3A_time">time</code></td>
<td>
<p>Variable for the observational time.</p>
</td></tr>
<tr><td><code id="long_est_+3A_lm_randomeffect_variables">LM_randomEffect_variables</code></td>
<td>
<p>Vector input of variable names with random
effects in the longitudinal model. This argument is <code>NULL</code> for methods
including <code>JMVL_LY</code>, <code>JMVL_G</code> and <code>IIRR_weighting</code>.</p>
</td></tr>
<tr><td><code id="long_est_+3A_vpm_variables">VPM_variables</code></td>
<td>
<p>Vector input of variable names in the visiting process
model.</p>
</td></tr>
<tr><td><code id="long_est_+3A_imp_time_factor">imp_time_factor</code></td>
<td>
<p>Scale factor for the time variable. This argument is
only needed in the imputation-based methods i.e., <code>imputation_LME</code>.</p>
</td></tr>
<tr><td><code id="long_est_+3A_optctrl">optCtrl</code></td>
<td>
<p>Control parameters for running the mixed-effect model. See
the <code>control</code> argument in <code><a href="lme4.html#topic+lmer">lme4::lmer()</a></code>.</p>
</td></tr>
<tr><td><code id="long_est_+3A_control">control</code></td>
<td>
<p>Control parameters for the <code>JMVL_G</code> method:
</p>

<ul>
<li> <p><code>verbose</code>: <code>TRUE</code> or <code>FALSE</code> for outputting checkpoint after each iteration. Default is <code>FALSE</code>.
</p>
</li>
<li> <p><code>tol</code>: Tolerance for convergence.
</p>
</li>
<li> <p><code>GHk</code>: Number of gaussian-hermite quadrature points. Default is <code>10</code>.
</p>
</li>
<li> <p><code>maxiter</code>: Maximum number of iteration. Default is <code>150</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="long_est_+3A_...">...</code></td>
<td>
<p>Additional arguments to <code><a href="nleqslv.html#topic+nleqslv">nleqslv::nleqslv()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>beta_hat</code>: Estimated coefficients in the longitudinal model.
</p>
<p>Other output in each method:
</p>

<ul>
<li> <p><code>standard_LME</code>:
</p>

<ul>
<li> <p><code>beta_sd</code>: Standard deviation of the estimated coefficients.
</p>
</li></ul>

</li>
<li> <p><code>VA_LME</code>:
</p>

<ul>
<li> <p><code>beta_sd</code>: Standard deviation of the estimated coefficients.
</p>
</li></ul>

</li>
<li> <p><code>JMVL_LY</code>:
</p>

<ul>
<li> <p><code>gamma_hat</code>: Estimated coefficients in the visiting process model.
</p>
</li></ul>

</li>
<li> <p><code>IIRR_weighting</code>:
</p>

<ul>
<li> <p><code>gamma_hat</code>: Estimated coefficients in the visiting process model.
</p>
</li></ul>

</li>
<li> <p><code>JMVL_Liang</code>:
</p>

<ul>
<li> <p><code>gamma_hat</code>: Estimated coefficients in the visiting process model.
</p>
</li></ul>

</li></ul>



<h3>References</h3>

<p>Buzkova, P. and Lumley, T. (2007). Longitudinal data analysis for generalized linear models with follow-up dependent
on outcome-related variables. Canadian Journal of Statistics, 35(4):485–500.
</p>
<p>Gasparini, A., Abrams, K. R., Barrett, J. K., Major, R. W., Sweeting, M. J., Brunskill, N. J., and Crowther, M. J. (2020).
Mixed-effects models for health care longitudinal data with an informative visiting process: A monte carlo simulation
study. Statistica Neerlandica, 74(1):5–23.
</p>
<p>Liang, Y., Lu, W., and Ying, Z. (2009). Joint modeling and analysis of longitudinal data with informative observation
times. Biometrics, 65(2):377–384.
</p>
<p>Lin, D. Y. and Ying, Z. (2001). Semiparametric and nonparametric regression analysis of longitudinal data. Journal of
the American Statistical Association, 96(453):103–126.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup arguments
train_data

time_var = "time"
id_var = "id"
outcome_var = "Y"
VPM_variables = c("Z", "X")
LM_fixedEffect_variables = c("Z", "X")
LM_randomEffect_variables = "Z"

# Run the standard LME model
fit_standardLME = long_est(long_data=train_data,
                           method="standard_LME",
                           id_var=id_var,
                           outcome_var=outcome_var,
                           LM_fixedEffect_variables = LM_fixedEffect_variables,
                           time = time_var,
                           LM_randomEffect_variables = LM_randomEffect_variables,
                           VPM_variables = VPM_variables)
# Return the coefficient estimates
fit_standardLME$beta_hat

# Run the VA_LME model
fit_VALME = long_est(long_data=train_data,
                     method="VA_LME",
                     id_var=id_var,
                     outcome_var=outcome_var,
                     LM_fixedEffect_variables = LM_fixedEffect_variables,
                     time = time_var,
                     LM_randomEffect_variables = LM_randomEffect_variables,
                     VPM_variables = VPM_variables)
# Return the coefficient estimates
fit_VALME$beta_hat
</code></pre>

<hr>
<h2 id='surv_data'>long_data</h2><span id='topic+surv_data'></span>

<h3>Description</h3>

<p>A subset of data from the World Health Organization Global Tuberculosis
Report ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surv_data
</code></pre>


<h3>Format</h3>



<h4><code>who</code></h4>

<p>A data frame with 7,240 rows and 60 columns:
</p>

<dl>
<dt>country</dt><dd><p>Country name</p>
</dd>
<dt>iso2, iso3</dt><dd><p>2 &amp; 3 letter ISO country codes</p>
</dd>
<dt>year</dt><dd><p>Year</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://www.who.int/teams/global-tuberculosis-programme/data">https://www.who.int/teams/global-tuberculosis-programme/data</a>
</p>

<hr>
<h2 id='surv_est'>Coefficient estimation in the survival model with longitudinal measurements.</h2><span id='topic+surv_est'></span>

<h3>Description</h3>

<p>This function offers a collection of methods of coefficient estimation in a
survival model with a longitudinally measured predictor. These methods
include Cox proportional hazard model with time-varying covariates (<code>cox</code>),
Joint modeling the longitudinal and disease diagnosis processes (<code>JMLD</code>), Joint
modeling the longitudinal and disease diagnosis processes with an adjustment
for the historical number of visits in the longitudinal model (<code>VA_JMLD</code>), Cox
proportional hazard model with time-varying covariates after imputation
(<code>Imputation_Cox</code>), Cox proportional hazard model with time-varying covariates
after imputation with an adjustment for the historical number of visits in
the longitudinal model (<code>VAImputation_Cox</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>surv_est(
  long_data,
  surv_data,
  method,
  id_var,
  time = NULL,
  survTime = NULL,
  survEvent = NULL,
  LM_fixedEffect_variables = NULL,
  LM_randomEffect_variables = NULL,
  SM_timeVarying_variables = NULL,
  SM_timeInvariant_variables = NULL,
  imp_time_factor = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="surv_est_+3A_long_data">long_data</code></td>
<td>
<p>Longitudinal dataset.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_surv_data">surv_data</code></td>
<td>
<p>Survival dataset.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_method">method</code></td>
<td>
<p>The following methods are available:
</p>

<ul>
<li> <p><code>cox</code>: Cox proportional hazard model with time-varying covariates.
</p>
</li>
<li> <p><code>JMLD</code>: Joint modeling the longitudinal and disease diagnosis processes.
</p>
</li>
<li> <p><code>VA_JMLD</code>: Joint modeling the longitudinal and disease diagnosis processes with an adjustment for the historical number of visits in the longitudinal model.
</p>
</li>
<li> <p><code>Imputation_Cox</code>: Cox proportional hazard model with time-varying covariates after imputation.
</p>
</li>
<li> <p><code>VAImputation_Cox</code>: Cox proportional hazard model with time-varying covariates after imputation with an adjustment for the historical number of visits in the longitudinal model.
</p>
</li></ul>
</td></tr>
<tr><td><code id="surv_est_+3A_id_var">id_var</code></td>
<td>
<p>Variable for the subject ID to indicate the grouping
structure.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_time">time</code></td>
<td>
<p>Variable for the observational time.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_survtime">survTime</code></td>
<td>
<p>Variable for the survival time.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_survevent">survEvent</code></td>
<td>
<p>Variable for the survival event.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_lm_fixedeffect_variables">LM_fixedEffect_variables</code></td>
<td>
<p>Vector input of variable names with fixed
effects in the longitudinal model. Variables should not contain time.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_lm_randomeffect_variables">LM_randomEffect_variables</code></td>
<td>
<p>Vector input of variable names with random
effects in the longitudinal model.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_sm_timevarying_variables">SM_timeVarying_variables</code></td>
<td>
<p>Vector input of variable names for
time-varying variables in the survival model.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_sm_timeinvariant_variables">SM_timeInvariant_variables</code></td>
<td>
<p>Vector input of variable names for
time-invariant variables in the survival model.</p>
</td></tr>
<tr><td><code id="surv_est_+3A_imp_time_factor">imp_time_factor</code></td>
<td>
<p>Scale factor for the time variable. This argument is
only needed in the imputation-based methods, e.g., <code>Imputation_Cox</code> and
<code>VAImputation_Cox</code>. The default is <code>NULL</code> (no scale).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>alpha_hat</code>: Estimated coefficients for the survival model.
</p>
<p>Other output in each method:
</p>

<ul>
<li> <p><code>JMLD</code>:
</p>

<ul>
<li> <p><code>beta_hat</code>: Estimated coefficients for the longitudinal model.
</p>
</li></ul>

</li>
<li> <p><code>VA_JMLD</code>:
</p>

<ul>
<li> <p><code>beta_hat</code>: Estimated coefficients for the longitudinal model.
</p>
</li></ul>

</li></ul>



<h3>References</h3>

<p>Rizopoulos, D. (2010). Jm: An r package for the joint modelling of longitudinal and time-to-event data. Journal of
statistical software, 35:1–33.
</p>
<p>Rizopoulos, D. (2012b). Joint models for longitudinal and time-to-event data: With applications in R. CRC press.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Setup arguments

id_var = "id"
time = "time"
survTime = "D"
survEvent = "d"
LM_fixedEffect_variables = c("Age","Sex","SNP")
LM_randomEffect_variables = c("SNP")
SM_timeVarying_variables = c("Y")
SM_timeInvariant_variables = c("Age","Sex","SNP")
imp_time_factor = 1

# Run the cox model
fit_cox = surv_est(surv_data = surv_data,
                   long_data = long_data,
                   method = "cox",
                   id_var = id_var,
                   time = time,
                   survTime = survTime,
                   survEvent = survEvent,
                   LM_fixedEffect_variables = LM_fixedEffect_variables,
                   LM_randomEffect_variables = LM_randomEffect_variables,
                   SM_timeVarying_variables = SM_timeVarying_variables,
                   SM_timeInvariant_variables = SM_timeInvariant_variables,
                   imp_time_factor = imp_time_factor)
# Return the coefficient estimates
fit_cox$alpha_hat
</code></pre>

<hr>
<h2 id='train_data'>long_data</h2><span id='topic+train_data'></span>

<h3>Description</h3>

<p>A subset of data from the World Health Organization Global Tuberculosis
Report ...
</p>


<h3>Usage</h3>

<pre><code class='language-R'>train_data
</code></pre>


<h3>Format</h3>



<h4><code>who</code></h4>

<p>A data frame with 7,240 rows and 60 columns:
</p>

<dl>
<dt>country</dt><dd><p>Country name</p>
</dd>
<dt>iso2, iso3</dt><dd><p>2 &amp; 3 letter ISO country codes</p>
</dd>
<dt>year</dt><dd><p>Year</p>
</dd>
</dl>
<p>...

</p>



<h3>Source</h3>

<p><a href="https://www.who.int/teams/global-tuberculosis-programme/data">https://www.who.int/teams/global-tuberculosis-programme/data</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
