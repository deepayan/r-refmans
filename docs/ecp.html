<!DOCTYPE html><html><head><title>Help for package ecp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ACGH'>

<p>Bladder Tumor Micro-Array Data</p></a></li>
<li><a href='#DJIA'>

<p>Dow Jones Industrial Average Index</p></a></li>
<li><a href='#e.agglo'>
<p>ENERGY AGGLOMERATIVE</p></a></li>
<li><a href='#e.cp3o'>
<p>CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA E-STATISTIC)</p></a></li>
<li><a href='#e.cp3o_delta'>
<p>CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA E-STATISTIC)</p></a></li>
<li><a href='#e.divisive'>
<p>ENERGY DIVISIVE</p></a></li>
<li><a href='#e.split'>
<p>ENERGY SPLIT</p></a></li>
<li><a href='#ecp-internal'><p>Internal Energy Change Point Functions</p></a></li>
<li><a href='#find.closest'>
<p>FIND CLOSEST CLUSTERS</p></a></li>
<li><a href='#getBetween'>
<p>GET BETWEEN DISTANCE</p></a></li>
<li><a href='#getWithin'>
<p>GET WITHIN DISTANCE</p></a></li>
<li><a href='#gof.update'>
<p>GOODNESS OF FIT UPDATE</p></a></li>
<li><a href='#kcpa'>
<p>Kernel Change Point Analysis</p></a></li>
<li><a href='#ks.cp3o'>
<p>CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA KOLMOGOROV-SMIRNOV STATISTIC)</p></a></li>
<li><a href='#ks.cp3o_delta'>
<p>CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA KOLMOGOROV-SMIRNOV STATISTIC)</p></a></li>
<li><a href='#perm.cluster'>
<p>PERMUTE CLUSTERS</p></a></li>
<li><a href='#process.data'>
<p>PROCESS DATA</p></a></li>
<li><a href='#sig.test'>
<p>SIGNIFICANCE TEST</p></a></li>
<li><a href='#splitPoint'>
<p>SPLIT POINT</p></a></li>
<li><a href='#splitPointC'>
<p>SPLIT POINT-C</p></a></li>
<li><a href='#updateDistance'>
<p>UPDATE DISTANCE</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Non-Parametric Multiple Change-Point Analysis of Multivariate
Data</td>
</tr>
<tr>
<td>Version:</td>
<td>3.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-7-1</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicholas A. James, Wenyu Zhang and David S. Matteson</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenyu Zhang &lt;wz258@cornell.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements various procedures for finding 
	     multiple change-points from Matteson D. et al (2013)
	     &lt;<a href="https://doi.org/10.1080%2F01621459.2013.849605">doi:10.1080/01621459.2013.849605</a>&gt;, Zhang W. et al (2017) 
	     &lt;<a href="https://doi.org/10.1109%2FICDMW.2017.44">doi:10.1109/ICDMW.2017.44</a>&gt;, Arlot S. et al (2019).
	     Two methods make use of dynamic  
	     programming and pruning, with no distributional 
	     assumptions other than the existence of certain absolute 
	     moments in one method. Hierarchical and exact search methods 
	     are included. All methods return the set of estimated change-
	     points as well as other summary information.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.00), Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>mvtnorm, MASS, combinat, R.rsp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-01 10:58:00 UTC; wenyuzhang</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-01 12:10:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='ACGH'>

Bladder Tumor Micro-Array Data
</h2><span id='topic+ACGH'></span>

<h3>Description</h3>

<p>Micro-array data for 43 different individuals with a bladder tumor.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ACGH)</code></pre>


<h3>Format</h3>

<p>A list with the following components.
</p>
<p>data: The micro-array data for 43 individuals. This information is stored in a 2215 by 43 matrix.
</p>
<p>individual: A numeric vector indicating which individuals' mico-array data are present.
</p>


<h3>Source</h3>

<p>Bleakley K., Vert J.-P. (2011), The group fused Lasso for multiple change-point detection
</p>
<p>N. Stransky, C. Vallot, F. Reyal, I. Bernard-Pierrot, S.G. Diez de Mediana, R. Segraves, Y. de Rycke,
P. Elvin, A. Cassidy, C. Sparaggon, A. Graham, j. Southgate, B. Asselain, Y. Allory, C. C. Addou, D. G.
Albertson, J.-P. Thiery, D. K. Chopin, D. Pinkel, and F. Radvanyi. Regional copy number-independent 
deregulation of transcription in cancer. Nat. Genet., 38(12):1386-1396, Dec 2006
</p>


<h3>References</h3>

<p>Bleakley K., Vert J.-P. (2011), The group fused Lasso for multiple change-point detection
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ACGH, package="ecp")
</code></pre>

<hr>
<h2 id='DJIA'>

Dow Jones Industrial Average Index
</h2><span id='topic+DJIA'></span>

<h3>Description</h3>

<p>The weekly log returns for the Dow Jones Industrial Average index from April 1990 to January 2012.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(DJIA)</code></pre>


<h3>Format</h3>

<p>A list with the following components.
</p>
<p>dates: A character vector of dates associated with each observation in the returns series.
</p>
<p>index: Weekly log returns from April 1990 to January 2012 of the DOW 30 index.
</p>
<p>market: Weekly log returns from April 1990 to January 2012, for the companies in the DOW 30 apart from Kraft.
</p>


<h3>Source</h3>

<p>http://research.stlouisfed.org/fred2/series/DJIA/downloaddata
</p>


<h3>References</h3>

<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DJIA, package="ecp")
</code></pre>

<hr>
<h2 id='e.agglo'>
ENERGY AGGLOMERATIVE
</h2><span id='topic+e.agglo'></span>

<h3>Description</h3>

<p>An agglomerative hierarchical estimation algorithm for multiple change point analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e.agglo(X, member=1:nrow(X), alpha=1, penalty=function(cps){0})
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.agglo_+3A_x">X</code></td>
<td>
<p>A T x d matrix containing the length T time series with d-dimensional observations.</p>
</td></tr>
<tr><td><code id="e.agglo_+3A_member">member</code></td>
<td>
<p>Initial membership vector for the time series.</p>
</td></tr>
<tr><td><code id="e.agglo_+3A_alpha">alpha</code></td>
<td>
<p>Moment index used for determining the distance between and
within clusters.</p>
</td></tr>
<tr><td><code id="e.agglo_+3A_penalty">penalty</code></td>
<td>
<p>Function used to penalize the obtained goodness-of-fit statistics. This function 
takes as its input a vector of change point locations (cps).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Homogeneous clusters are created based on the initial clustering provided by the <em>member</em> 
argument. In each iteration, clusters are merged so as to maximize a goodness-of-fit 
statistic. The computational complexity of this method is <em>O(T^2)</em>, where <em>T</em> is the 
number of observations.

</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<table>
<tr><td><code>merged</code></td>
<td>
<p>A (T-1) x 2 matrix indicating which segments were merged at each 
step of the agglomerative procedure.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p>Vector showing the progression of the penalized goodness-of-fit 
statistic.</p>
</td></tr>
<tr><td><code>progression</code></td>
<td>
<p>A T x (T+1) matrix showing the progression of the set of change points.</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>
<p>The estimated cluster membership vector.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>The location of the estimated change points.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Matteson D.S., James N.A. (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>


<h3>See Also</h3>


<p><code><a href="#topic+e.divisive">e.divisive</a></code>
</p>

<p>Rizzo M.L., Szekely G.L. (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
mem = rep(c(1,2,3,4),times=c(10,10,10,10))
x = as.matrix(c(rnorm(10,0,1),rnorm(20,2,1),rnorm(10,-1,1)))
y = e.agglo(X=x,member=mem,alpha=1,penalty=function(cp,Xts) 0)
y$estimates


## Not run: 
# Multivariate spatio-temporal example
# You will need the following packages:
#	mvtnorm, combinat, and MASS
library(mvtnorm); library(combinat); library(MASS)
set.seed(2013)
lambda = 1500 #overall arrival rate per unit time
muA = c(-7,-7) ; muB = c(0,0) ; muC = c(5.5,0)
covA = 25*diag(2)
covB = matrix(c(9,0,0,1),2)
covC = matrix(c(9,.9,.9,9),2)
time.interval = matrix(c(0,1,3,4.5,1,3,4.5,7),4,2)
#mixing coefficents
mixing.coef = rbind(c(1/3,1/3,1/3),c(.2,.5,.3), c(.35,.3,.35), 
	c(.2,.3,.5))
stppData = NULL
for(i in 1:4){
	count = rpois(1, lambda* diff(time.interval[i,]))
	Z = rmultz2(n = count, p = mixing.coef[i,])
	S = rbind(rmvnorm(Z[1],muA,covA), rmvnorm(Z[2],muB,covB),
		rmvnorm(Z[3],muC,covC))
	X = cbind(rep(i,count), runif(n = count, time.interval[i,1],
		time.interval[i,2]), S)
	stppData = rbind(stppData, X[order(X[,2]),])
}
member = as.numeric(cut(stppData[,2], breaks = seq(0,7,by=1/12)))
output = e.agglo(X=stppData[,3:4],member=member,alpha=1,
	penalty=function(cp,Xts) 0)

## End(Not run)
</code></pre>

<hr>
<h2 id='e.cp3o'>
CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA E-STATISTIC)
</h2><span id='topic+e.cp3o'></span>

<h3>Description</h3>

<p>An algorithm for multiple change point analysis that uses dynamic programming and 
pruning. The E-statistic is used as the goodness-of-fit measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e.cp3o(Z, K=1, minsize=30, alpha=1, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.cp3o_+3A_z">Z</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="e.cp3o_+3A_k">K</code></td>
<td>

<p>The maximum number of change points.
</p>
</td></tr>
<tr><td><code id="e.cp3o_+3A_minsize">minsize</code></td>
<td>

<p>The minimum segment size.
</p>
</td></tr>
<tr><td><code id="e.cp3o_+3A_alpha">alpha</code></td>
<td>

<p>The moment index used for determining the distance between and within 
segments.
</p>
</td></tr>
<tr><td><code id="e.cp3o_+3A_verbose">verbose</code></td>
<td>

<p>A flag indicating if status updates should be printed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segmentations are found through the use of dynamic programming and 
pruning. For long time series, consider using e.cp3o_delta.

</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>number</code></td>
<td>
<p>The estimated number of change points.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>The location of the change points estimated by the procedure.</p>
</td></tr>
<tr><td><code>gofM</code></td>
<td>
<p>A vector of goodness of fit values for differing number of 
change points. The first entry corresponds to when there is only 
a single change point, the second for when there are two, and 
so on.</p>
</td></tr>
<tr><td><code>cpLoc</code></td>
<td>
<p>The list of locations of change points estimated by the procedure for 
different numbers of change points up to K.</p>
</td></tr>
<tr><td><code>time</code></td>
<td>
<p>The total amount to time take to estimate the change point locations.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James, Wenyu Zhang
</p>


<h3>References</h3>


<p>W. Zhang, N. A. James and D. S. Matteson, &quot;Pruning and Nonparametric Multiple Change Point Detection,&quot; 2017 IEEE International Conference on Data Mining Workshops (ICDMW), New Orleans, LA, 2017, pp. 288-295.
</p>


<h3>See Also</h3>



<p>Rizzo M.L., Szekely G.L (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(400)
x1 = matrix(c(rnorm(50),rnorm(50,3)))
y1 = e.cp3o(Z=x1, K=2, minsize=30, alpha=1, verbose=FALSE)
#View estimated change point locations
y1$estimates
</code></pre>

<hr>
<h2 id='e.cp3o_delta'>
CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA E-STATISTIC)
</h2><span id='topic+e.cp3o_delta'></span>

<h3>Description</h3>

<p>An algorithm for multiple change point analysis that uses dynamic programming and 
pruning. The E-statistic is used as the goodness-of-fit measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e.cp3o_delta(Z, K=1, delta=29, alpha=1, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.cp3o_delta_+3A_z">Z</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="e.cp3o_delta_+3A_k">K</code></td>
<td>

<p>The maximum number of change points.
</p>
</td></tr>
<tr><td><code id="e.cp3o_delta_+3A_delta">delta</code></td>
<td>

<p>The window size used to calculate the calculate the complete portion of our 
approximate test statistic. This also corresponds to one less than the minimum 
segment size.
</p>
</td></tr>
<tr><td><code id="e.cp3o_delta_+3A_alpha">alpha</code></td>
<td>

<p>The moment index used for determining the distance between and within 
segments.
</p>
</td></tr>
<tr><td><code id="e.cp3o_delta_+3A_verbose">verbose</code></td>
<td>

<p>A flag indicating if status updates should be printed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segmentations are found through the use of dynamic programming and 
pruning. Between-segment distances are calculated only using points within
a window of the segmentation point.
The computational complexity of this method is <em>O(KT^2)</em>, where 
<em>K</em> is the maximum number of change points, and <em>T</em> is the number of 
observations.

</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>number</code></td>
<td>
<p>The estimated number of change points.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>The location of the change points estimated by the procedure.</p>
</td></tr>
<tr><td><code>gofM</code></td>
<td>
<p>A vector of goodness of fit values for differing number of 
change points. The first entry corresponds to when there is only 
a single change point, the second for when there are two, and 
so on.</p>
</td></tr>
<tr><td><code>cpLoc</code></td>
<td>
<p>The list of locations of change points estimated by the procedure for 
different numbers of change points up to K.</p>
</td></tr>		
<tr><td><code>time</code></td>
<td>
<p>The total amount to time take to estimate the change point locations.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James, Wenyu Zhang
</p>


<h3>References</h3>


<p>W. Zhang, N. A. James and D. S. Matteson, &quot;Pruning and Nonparametric Multiple Change Point Detection,&quot; 2017 IEEE International Conference on Data Mining Workshops (ICDMW), New Orleans, LA, 2017, pp. 288-295.
</p>


<h3>See Also</h3>



<p>Rizzo M.L., Szekely G.L (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(400)
x1 = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y1 = e.cp3o_delta(Z=x1, K=7, delta=29, alpha=1, verbose=FALSE)
#View estimated change point locations
y1$estimates
</code></pre>

<hr>
<h2 id='e.divisive'>
ENERGY DIVISIVE
</h2><span id='topic+e.divisive'></span>

<h3>Description</h3>

<p>A divisive hierarchical estimation algorithm for multiple change point analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e.divisive(X, sig.lvl=.05, R=199, k=NULL, min.size=30, alpha=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.divisive_+3A_x">X</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="e.divisive_+3A_sig.lvl">sig.lvl</code></td>
<td>

<p>The level at which to sequentially test if a proposed change point is 
statistically significant.
</p>
</td></tr>
<tr><td><code id="e.divisive_+3A_r">R</code></td>
<td>

<p>The maximum number of random permutations to use in each iteration of the permutation test. The 
permutation test p-value is calculated using the method outlined in Gandy (2009).
</p>
</td></tr>
<tr><td><code id="e.divisive_+3A_k">k</code></td>
<td>

<p>Number of change point locations to estimate, suppressing permutation based testing. 
If k=NULL then only the statistically significant estimated change points are returned.
</p>
</td></tr>
<tr><td><code id="e.divisive_+3A_min.size">min.size</code></td>
<td>

<p>Minimum number of observations between change points.
</p>
</td></tr>
<tr><td><code id="e.divisive_+3A_alpha">alpha</code></td>
<td>

<p>The moment index used for determining the distance between and within 
segments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segments are found through the use of a binary bisection method and a permutation 
test. The computational complexity of this method is <em>O(kT^2)</em>, where <em>k</em> is the 
number of estimated change points, and <em>T</em> is the number of observations.

</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>k.hat</code></td>
<td>
<p>The number of clusters within the data created 
by the change points.</p>
</td></tr>
<tr><td><code>order.found</code></td>
<td>
<p>The order in which the change points were estimated.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>Locations of the statistically significant change points.</p>
</td></tr>
<tr><td><code>considered.last</code></td>
<td>
<p>Location of the last change point, that 
was not found to be statistically significant at the given significance level.</p>
</td></tr>
<tr><td><code>permutations</code></td>
<td>
<p>The number of permutations performed by each of the sequential permutation test.</p>
</td></tr>
<tr><td><code>cluster</code></td>
<td>
<p>The estimated cluster membership vector.</p>
</td></tr>
<tr><td><code>p.values</code></td>
<td>
<p>Approximate p-values estimated from each permutation test.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Matteson D.S., James N.A. (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>


<h3>See Also</h3>


<p><code><a href="#topic+e.agglo">e.agglo</a></code>
</p>

<p>Gandy, A. (2009) &quot;Sequential implementation of Monte Carlo tests with uniformly bounded resampling risk.&quot; Journal of the American Statistical Association.
</p>
<p>Rizzo M.L., Szekely G.L (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
x1 = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y1 = e.divisive(X=x1,sig.lvl=0.05,R=199,k=NULL,min.size=30,alpha=1)
x2 = rbind(MASS::mvrnorm(100,c(0,0),diag(2)),
	MASS::mvrnorm(100,c(2,2),diag(2)))
y2 = e.divisive(X=x2,sig.lvl=0.05,R=499,k=NULL,min.size=30,alpha=1)
</code></pre>

<hr>
<h2 id='e.split'>
ENERGY SPLIT
</h2><span id='topic+e.split'></span>

<h3>Description</h3>

<p>Finds the most likely location for a change point across all current 
clusters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	e.split(changes, D, min.size, for.sim=FALSE, env=emptyenv())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e.split_+3A_changes">changes</code></td>
<td>

<p>A vector containing the current set of change points.
</p>
</td></tr>
<tr><td><code id="e.split_+3A_d">D</code></td>
<td>

<p>An n by n distance matrix.
</p>
</td></tr>
<tr><td><code id="e.split_+3A_min.size">min.size</code></td>
<td>

<p>Minimum number of observations between change points.
</p>
</td></tr>
<tr><td><code id="e.split_+3A_for.sim">for.sim</code></td>
<td>

<p>Boolean value indicating if the function is to be run on permuted 
data for significance testing.
</p>
</td></tr>
<tr><td><code id="e.split_+3A_env">env</code></td>
<td>

<p>Environment that contains information to help reduce computational
time.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is called by the e.divisive method, and should not be called by 
the user.

</p>


<h3>Value</h3>

<p>A list with the following components is returned.
</p>
<table>
<tr><td><code>first</code></td>
<td>
<p>The index of the first element of the cluster to be divided.</p>
</td></tr>
<tr><td><code>second</code></td>
<td>
<p>The index of the last element of the cluster to be divided.</p>
</td></tr>
<tr><td><code>third</code></td>
<td>
<p>The new set of change points.</p>
</td></tr>
<tr><td><code>fourth</code></td>
<td>
<p>The distance between the clusters created by the newly 
proposed change point.
</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Matteson D.S., James N.A. (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo M.L., Szekely G.L. (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.divisive">e.divisive</a></code>

</p>

<hr>
<h2 id='ecp-internal'>Internal Energy Change Point Functions</h2><span id='topic+ecp-internal'></span>

<h3>Description</h3>

<p>Internal Energy Change Point functions.
</p>


<h3>Details</h3>

<p>These are not to be called by the user.
</p>

<hr>
<h2 id='find.closest'>
FIND CLOSEST CLUSTERS
</h2><span id='topic+find.closest'></span>

<h3>Description</h3>

<p>Determines which two segments to merge.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find.closest(K, ret)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find.closest_+3A_k">K</code></td>
<td>
<p>Integer indicating the progress of the agglomerative process.</p>
</td></tr>
<tr><td><code id="find.closest_+3A_ret">ret</code></td>
<td>
<p>A list with 'open', 'N', and 'right' components</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is called by the e.agglomerative method, and should not be called 
by the user.

</p>


<h3>Value</h3>

<p>Returns a vector with 3 components. The first two indicate which segments 
are to be merged. The third is the new goodness of fit statistics.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>

</p>

<hr>
<h2 id='getBetween'>
GET BETWEEN DISTANCE
</h2><span id='topic+getBetween'></span>

<h3>Description</h3>

<p>Returns the energy distance between two sets of numerical data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getBetween(alpha_, X_, Y_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getBetween_+3A_alpha_">alpha_</code></td>
<td>

<p>A weighting parameter used for calculating the energy distance. This 
value should be in (0,2].
</p>
</td></tr>
<tr><td><code id="getBetween_+3A_x_">X_</code></td>
<td>

<p>A n by d matrix of the n d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="getBetween_+3A_y_">Y_</code></td>
<td>

<p>A m by d matrix of the m d-dimensional observations.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrices X_ and Y_ do not need to have the same number of rows, but 
they do require the same number of columns.
</p>


<h3>Value</h3>

<p>The returned value is a real number indicating the energy distance between 
the two data sets.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo ML, Szekely GL (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>
<code><a href="#topic+e.divisive">e.divisive</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
X = matrix(rnorm(100),ncol=2)
Y = matrix(rnorm(126,1),ncol=2)
alpha = 1
between.distance = getBetween(alpha,X,Y)
</code></pre>

<hr>
<h2 id='getWithin'>
GET WITHIN DISTANCE
</h2><span id='topic+getWithin'></span>

<h3>Description</h3>

<p>Calculate the energy distance within a data set.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getWithin(alpha_, X_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getWithin_+3A_alpha_">alpha_</code></td>
<td>

<p>A weighting parameter used for calculating the energy distance. This 
value should be in (0,2].
</p>
</td></tr>
<tr><td><code id="getWithin_+3A_x_">X_</code></td>
<td>

<p>A n by d matrix of the n d-dimensional observations.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The returned value is a real number indicating the energy distance within 
the given data set.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo ML, Szekely GL (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>
<code><a href="#topic+e.divisive">e.divisive</a></code>

</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(100)
X = matrix(rnorm(150),ncol=2)
alpha = 1
distance = getWithin(alpha,X)
</code></pre>

<hr>
<h2 id='gof.update'>
GOODNESS OF FIT UPDATE
</h2><span id='topic+gof.update'></span>

<h3>Description</h3>

<p>Updates the goodness of fit statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gof.update(i,ret)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof.update_+3A_i">i</code></td>
<td>
<p>segments which is to be merged with the segment that is adjacent 
to its right.</p>
</td></tr>
<tr><td><code id="gof.update_+3A_ret">ret</code></td>
<td>
<p>A list with 'gof', 'right', 'left', 'D', and 'size' comonents.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by the e.agglo method, and should not be called by the user.

</p>


<h3>Value</h3>

<p>Returns a real number. This is the updated goodness of fit statistic.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>

</p>

<hr>
<h2 id='kcpa'>
Kernel Change Point Analysis
</h2><span id='topic+kcpa'></span>

<h3>Description</h3>

<p>An algorithm for multiple change point analysis that uses the 'kernel trick' and dynamic programming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>kcpa(X, L, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kcpa_+3A_x">X</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="kcpa_+3A_l">L</code></td>
<td>

<p>The maximum number of change points.
</p>
</td></tr>
<tr><td><code id="kcpa_+3A_c">C</code></td>
<td>

<p>The constant used to penalize the inclusion of additional change points in the fitted model.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segments are found through the use of dynamic programming and the kernel trick.

</p>


<h3>Value</h3>

<p>If the algorithm determines that the best fit is obtained through using k change points then the returned value is an array of length k, containing the change point locations.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Arlot S., Celisse A., Harchaoui Z. (2019). A Kernel Multiple Change-point Algorithm via Model Selection. J. Mach. Learn. Res., 20, 162:1-162:56.
</p>

<hr>
<h2 id='ks.cp3o'>
CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA KOLMOGOROV-SMIRNOV STATISTIC)
</h2><span id='topic+ks.cp3o'></span>

<h3>Description</h3>

<p>An algorithm for multiple change point analysis that uses dynamic programming and 
pruning. The Kolmogorov-Smirnov statistic is used as the goodness-of-fit measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ks.cp3o(Z, K=1, minsize=30, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ks.cp3o_+3A_z">Z</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_+3A_k">K</code></td>
<td>

<p>The maximum number of change points.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_+3A_minsize">minsize</code></td>
<td>

<p>The minimum segment size.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_+3A_verbose">verbose</code></td>
<td>

<p>A flag indicating if status updates should be printed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segmentations are found through the use of dynamic programming and 
pruning. For long time series, consider using ks.cp3o_delta.

</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>number</code></td>
<td>
<p>The estimated number of change points.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>The location of the change points estimated by the procedure.</p>
</td></tr>
<tr><td><code>gofM</code></td>
<td>
<p>A vector of goodness of fit values for differing number of 
change points. The first entry corresponds to when there is only 
a single change point, the second for when there are two, and 
so on.</p>
</td></tr>
<tr><td><code>cpLoc</code></td>
<td>
<p>The list of locations of change points estimated by the procedure for 
different numbers of change points up to K.</p>
</td></tr>		
<tr><td><code>time</code></td>
<td>
<p>The total amount to time take to estimate the change point locations.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Wenyu Zhang
</p>


<h3>References</h3>


<p>W. Zhang, N. A. James and D. S. Matteson, &quot;Pruning and Nonparametric Multiple Change Point Detection,&quot; 2017 IEEE International Conference on Data Mining Workshops (ICDMW), New Orleans, LA, 2017, pp. 288-295.
</p>


<h3>See Also</h3>



<p>Kifer D., Ben-David S., Gehrke J. (2004). Detecting change in data streams. International Conference on Very Large Data Bases.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(400)
x = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y = ks.cp3o(Z=x, K=7, minsize=30, verbose=FALSE)
#View estimated change point locations
y$estimates
</code></pre>

<hr>
<h2 id='ks.cp3o_delta'>
CHANGE POINTS ESTIMATION BY PRUNED OBJECTIVE (VIA KOLMOGOROV-SMIRNOV STATISTIC)
</h2><span id='topic+ks.cp3o_delta'></span>

<h3>Description</h3>

<p>An algorithm for multiple change point analysis that uses dynamic programming and 
pruning. The Kolmogorov-Smirnov statistic is used as the goodness-of-fit measure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ks.cp3o_delta(Z, K=1, minsize=30, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ks.cp3o_delta_+3A_z">Z</code></td>
<td>

<p>A T x d matrix containing the length T time series with d-dimensional observations.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_delta_+3A_k">K</code></td>
<td>

<p>The maximum number of change points.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_delta_+3A_minsize">minsize</code></td>
<td>

<p>The minimum segment size. This is also the window size used to calculate between-segment
distances.
</p>
</td></tr>
<tr><td><code id="ks.cp3o_delta_+3A_verbose">verbose</code></td>
<td>

<p>A flag indicating if status updates should be printed.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Segmentations are found through the use of dynamic programming and 
pruning. Between-segment distances are calculated only using points within
a window of the segmentation point.

</p>


<h3>Value</h3>

<p>The returned value is a list with the following components.
</p>
<table>
<tr><td><code>number</code></td>
<td>
<p>The estimated number of change points.</p>
</td></tr>
<tr><td><code>estimates</code></td>
<td>
<p>The location of the change points estimated by the procedure.</p>
</td></tr>
<tr><td><code>gofM</code></td>
<td>
<p>A vector of goodness of fit values for differing number of 
change points. The first entry corresponds to when there is only 
a single change point, the second for when there are two, and 
so on.</p>
</td></tr>
<tr><td><code>cpLoc</code></td>
<td>
<p>The list of locations of change points estimated by the procedure for 
different numbers of change points up to K.</p>
</td></tr>		
<tr><td><code>time</code></td>
<td>
<p>The total amount to time take to estimate the change point locations.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Wenyu Zhang
</p>


<h3>References</h3>


<p>W. Zhang, N. A. James and D. S. Matteson, &quot;Pruning and Nonparametric Multiple Change Point Detection,&quot; 2017 IEEE International Conference on Data Mining Workshops (ICDMW), New Orleans, LA, 2017, pp. 288-295.
</p>


<h3>See Also</h3>



<p>Kifer D., Ben-David S., Gehrke J. (2004). Detecting change in data streams. International Conference on Very Large Data Bases.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(400)
x = matrix(c(rnorm(100),rnorm(100,3),rnorm(100,0,2)))
y = ks.cp3o_delta(Z=x, K=7, minsize=30, verbose=FALSE)
#View estimated change point locations
y$estimates
</code></pre>

<hr>
<h2 id='perm.cluster'>
PERMUTE CLUSTERS
</h2><span id='topic+perm.cluster'></span>

<h3>Description</h3>

<p>Permutes time series observations within specified segments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perm.cluster(D, points)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perm.cluster_+3A_d">D</code></td>
<td>
<p>A n by n distance matrix.</p>
</td></tr>
<tr><td><code id="perm.cluster_+3A_points">points</code></td>
<td>
<p>The set of current change points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by the e.divisive method, and should not be called by the user.

</p>


<h3>Value</h3>

<p>Returns the n by n distance matrix for the permuted data.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.divisive">e.divisive</a></code>

</p>

<hr>
<h2 id='process.data'>
PROCESS DATA
</h2><span id='topic+process.data'></span>

<h3>Description</h3>

<p>Initializes components necessary to perform agglomerative analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>process.data(member, X, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="process.data_+3A_member">member</code></td>
<td>
<p>Segment membership vector for the time series.</p>
</td></tr>
<tr><td><code id="process.data_+3A_x">X</code></td>
<td>
<p>A matrix containing the time series with observations in R^d.</p>
</td></tr>
<tr><td><code id="process.data_+3A_alpha">alpha</code></td>
<td>
<p>Index used for determining the distance between and
within segments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by the e.agglo method, and should not be called by the user.

</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<table>
<tr><td><code>gof</code></td>
<td>
<p>Vector showing the progression of the goodness of fit statistic.</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>Matrix showing the progression of the set of change points.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of initial segments.</p>
</td></tr>
<tr><td><code>sizes</code></td>
<td>
<p>Sizes of each segment during the agglomerative process.</p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p>Vector containing indices of the right adjacent segments.</p>
</td></tr>
<tr><td><code>left</code></td>
<td>
<p>Vector containing indices of the left adjacent segments.</p>
</td></tr>
<tr><td><code>open</code></td>
<td>
<p>Vector indicating if a segment has been merged.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>Matrix of distances between segments.</p>
</td></tr>
<tr><td><code>lm</code></td>
<td>
<p>Vector containing indices of the starting point of a segment.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>

</p>

<hr>
<h2 id='sig.test'>
SIGNIFICANCE TEST
</h2><span id='topic+sig.test'></span>

<h3>Description</h3>

<p>Performs a permutation test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sig.test(D, R, changes, min.size, obs, env=emptyenv())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sig.test_+3A_d">D</code></td>
<td>
<p>A n by n distnace matrix.</p>
</td></tr>
<tr><td><code id="sig.test_+3A_r">R</code></td>
<td>
<p>The number of permutations to use in the permutation test.</p>
</td></tr>
<tr><td><code id="sig.test_+3A_changes">changes</code></td>
<td>
<p>The set of current change points.</p>
</td></tr>
<tr><td><code id="sig.test_+3A_min.size">min.size</code></td>
<td>
<p>Minimum number of observations between change points.</p>
</td></tr>
<tr><td><code id="sig.test_+3A_obs">obs</code></td>
<td>
<p>Test statistic value for non-permuted data.</p>
</td></tr>
<tr><td><code id="sig.test_+3A_env">env</code></td>
<td>
<p>Environment with information used to reduce computational time.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by the e.divisive method, and should not be called by the user.

</p>


<h3>Value</h3>

<p>The returned value is the approximate p-value obtained by the permutation 
test. The permutaiton test is performed using the method outlined in 
Gandy (2009).





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Matteson D.S., James N.A. (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Gandy, A. (2009) &quot;Sequential implementation of Monte Carlo tests with uniformly bounded resampling risk.&quot; Journal of the American Statistical Association.
</p>
<p>Rizzo M.L., Szekely G.L. (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.divisive">e.divisive</a></code>

</p>

<hr>
<h2 id='splitPoint'>
SPLIT POINT
</h2><span id='topic+splitPoint'></span>

<h3>Description</h3>

<p>Finds the most likely location of a change point within a given 
segment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitPoint(start, end, D, min.size)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitPoint_+3A_start">start</code></td>
<td>
<p>the index of the first observation in a segment.</p>
</td></tr>
<tr><td><code id="splitPoint_+3A_end">end</code></td>
<td>
<p>The index of the last observation in a segment.</p>
</td></tr>
<tr><td><code id="splitPoint_+3A_d">D</code></td>
<td>
<p>A n by n distance matrix.</p>
</td></tr>
<tr><td><code id="splitPoint_+3A_min.size">min.size</code></td>
<td>
<p>Minimum number of observations between change points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Called by the e.divisive method, and should not be called by the user.

</p>


<h3>Value</h3>

<p>The returned value is a vector. The first component is the most likely 
position of a change point. The second component is the distance between 
the segments created by this proposed change point.





</p>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>Matteson D.S., James N.A. (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo M.L., Szekely G.L. (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo M.L., Szekely G.L. (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.divisive">e.divisive</a></code>

</p>

<hr>
<h2 id='splitPointC'>
SPLIT POINT-C
</h2><span id='topic+splitPointC'></span>

<h3>Description</h3>

<p>C++ function that is called by splitPoint() to perform calculations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>splitPointC(s_, e_, D_, min_size_)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="splitPointC_+3A_s_">s_</code></td>
<td>

<p>Index of the first obervation in a segment.
</p>
</td></tr>
<tr><td><code id="splitPointC_+3A_e_">e_</code></td>
<td>

<p>Index of the last observation in a segment.
</p>
</td></tr>
<tr><td><code id="splitPointC_+3A_d_">D_</code></td>
<td>

<p>A distance matrix.
</p>
</td></tr>
<tr><td><code id="splitPointC_+3A_min_size_">min_size_</code></td>
<td>

<p>The minimum segment size.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As with the splitPoint method, this method should not be calle by the user.

</p>


<h3>Value</h3>

<p>Returns a vector. The first component is the most likely position of 
a change point. The second component is the distance between the 
segments created by this proposed change point.
</p>







<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>
<p>Rizzo ML, Szekely GL (2010). Disco analysis: A nonparametric extension of analysis of variance. The Annals of Applied Statistics. pp. 1034 - 1055.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+splitPoint">splitPoint</a></code>

</p>

<hr>
<h2 id='updateDistance'>
UPDATE DISTANCE
</h2><span id='topic+updateDistance'></span>

<h3>Description</h3>

<p>Update the distance between the newly created segment and the other 
segments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>updateDistance(i,j,K,ret)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="updateDistance_+3A_i">i</code></td>
<td>
<p>The segment that makes up the left portion of the new segment.</p>
</td></tr>
<tr><td><code id="updateDistance_+3A_j">j</code></td>
<td>
<p>The segment that makes up the right portion of the new segment.</p>
</td></tr>
<tr><td><code id="updateDistance_+3A_k">K</code></td>
<td>
<p>Integer indicating the progress of the agglomerative process.</p>
</td></tr>
<tr><td><code id="updateDistance_+3A_ret">ret</code></td>
<td>
<p>A list with 'gof', 'list', 'N', 'sizes', 'right', 'left', 
'open', 'D', and 'lm' components.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This method is called by the e.agglomerative method, and should not be called 
by the user.

</p>


<h3>Value</h3>

<p>Returns a list with the following components.
</p>
<table>
<tr><td><code>gof</code></td>
<td>
<p>Vector showing the progression of the goodness of fit statistic.</p>
</td></tr>
<tr><td><code>list</code></td>
<td>
<p>Matrix showing the progression of the set of change points.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>Number of initial segments.</p>
</td></tr>
<tr><td><code>sizes</code></td>
<td>
<p>Sizes of each segment during the agglomerative process.</p>
</td></tr>
<tr><td><code>right</code></td>
<td>
<p>Vector containing indices of the right adjacent segments.</p>
</td></tr>
<tr><td><code>left</code></td>
<td>
<p>Vector containing indices of the left adjacent segments.</p>
</td></tr>
<tr><td><code>open</code></td>
<td>
<p>Vector indicating if a segment has been merged.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>Matrix of distances between segments.</p>
</td></tr>
<tr><td><code>lm</code></td>
<td>
<p>Vector containing indices of the starting point of a segment.</p>
</td></tr>





</table>


<h3>Author(s)</h3>

<p>Nicholas A. James
</p>


<h3>References</h3>


<p>James NA, Matteson DS (2013). A Nonparametric Approach for Multiple Change Point Analysis of Multivariate Data.
</p>
<p>Nicholas A. James, David S. Matteson (2014). &quot;ecp: An R Package for Nonparametric 
Multiple Change Point Analysis of Multivariate Data.&quot;, &quot;Journal of Statistical Software, 
62(7), 1-25&quot;, URL &quot;http://www.jstatsoft.org/v62/i07/&quot;
</p>
<p>Rizzo ML, Szekely GL (2005). Hierarchical clustering via joint between-within distances: Extending ward's minimum variance method. Journal of Classification. pp. 151 - 183.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e.agglo">e.agglo</a></code>

</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
