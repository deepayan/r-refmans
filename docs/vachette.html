<!DOCTYPE html><html lang="en"><head><title>Help for package vachette</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {vachette}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apply_transformations'><p>Apply vachette transformations</p></a></li>
<li><a href='#p.add.distances'><p>Plot Distances Before and After <code>vachette</code> Transformation Assuming Additive Error Model</p></a></li>
<li><a href='#p.obs.cov'><p>Plot Observations and Typical Curves Faceted by Covariate</p></a></li>
<li><a href='#p.obs.excluded'><p>Plot Excluded Observations with Reasons for Exclusion</p></a></li>
<li><a href='#p.obs.ref.query'><p>Plot Observations and Typical Curves for Query and Reference Data</p></a></li>
<li><a href='#p.prop.distances'><p>Plot Distances Before and After <code>vachette</code> Transformation Assuming Proportional Error Model</p></a></li>
<li><a href='#p.scaled.observation.curves'><p>Plot <code>vachette</code> Transformed Observation Curves</p></a></li>
<li><a href='#p.scaled.observation.curves.by.id'><p>Plot <code>vachette</code> Transformed Observation Curves by Individual</p></a></li>
<li><a href='#p.scaled.typical.curves'><p>Plot <code>vachette</code> Transformed Typical Curves</p></a></li>
<li><a href='#p.scaled.typical.curves.landmarks'><p>Plot <code>vachette</code> Transformed Typical Curves with Landmarks</p></a></li>
<li><a href='#p.scaled.typical.full.curves.landmarks'><p>Plot Full <code>vachette</code> Transformed Typical Curves with Landmarks</p></a></li>
<li><a href='#p.scaling.factor'><p>Plot Scaling Factors for Typical Curves</p></a></li>
<li><a href='#p.vachette'><p>Main Vachette Plot</p></a></li>
<li><a href='#p.vachette.arrow'><p>Plot Observations and <code>vachette</code> Transformed Observations with Connecting Arrows</p></a></li>
<li><a href='#print.vachette_data'><p>Print <code>vachette_data</code></p></a></li>
<li><a href='#summary.vachette_data'><p>Summarise <code>vachette_data</code></p></a></li>
<li><a href='#vachette_data'><p>Initialize vachette object with required data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>A Method for Visualization of Pharmacometric Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.40.1</td>
</tr>
<tr>
<td>Description:</td>
<td>A method to visualize pharmacometric analyses which are impacted by
    covariate effects. Variability-aligned covariate harmonized-effects
    and time-transformation equivalent ('vachette') facilitates intuitive
    overlays of data and model predictions, allowing for comprehensive
    comparison without dilution effects. 'vachette' improves upon previous
    methods Lommerse et al. (2021) &lt;<a href="https://doi.org/10.1002%2Fpsp4.12679">doi:10.1002/psp4.12679</a>&gt;, enabling its
    application to all pharmacometric models and enhancing Visual Predictive
    Checks (VPC) by integrating data into cohesive plots that can highlight
    model misspecification.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/certara/vachette">https://github.com/certara/vachette</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/certara/vachette/issues">https://github.com/certara/vachette/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, mrgsolve, tidyvpc, testthat (&ge; 3.0.0),
learnr</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, tidyr, dplyr, magrittr, prospectr, Hmisc, purrr,
minpack.lm, progress, rlang, utils, photobiology</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-18 16:54:29 UTC; jcraig</td>
</tr>
<tr>
<td>Author:</td>
<td>Jos Lommerse [aut],
  Anna Largajolli [aut],
  James Craig [aut, cre],
  Nele Mueller-Plock [ctb],
  Jeff Sachs [ctb],
  Amy Cheung [ctb],
  Certara USA, Inc. [cph, fnd]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>James Craig &lt;james.craig@certara.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-19 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='apply_transformations'>Apply vachette transformations</h2><span id='topic+apply_transformations'></span><span id='topic+apply_transformations.vachette_data'></span>

<h3>Description</h3>

<p>Apply vachette transformations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apply_transformations(vachette_data, ...)

## S3 method for class 'vachette_data'
apply_transformations(
  vachette_data,
  tol.end = 0.001,
  tol.noise = 1e-08,
  step.x.factor = 1.5,
  ngrid.fit = 100,
  window = 17,
  log_file = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="apply_transformations_+3A_vachette_data">vachette_data</code></td>
<td>
<p>object of class <code>vachette_data</code></p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_...">...</code></td>
<td>
<p>Additional arguments</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_tol.end">tol.end</code></td>
<td>
<p>numeric; Relative tolerance to determine last x open end reference</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_tol.noise">tol.noise</code></td>
<td>
<p>numeric; Relative tolerance for landmark determination typical curves</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_step.x.factor">step.x.factor</code></td>
<td>
<p>numeric; x-axis extension factor to search for last x, i.e., to determine where close enough to asymptote</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_ngrid.fit">ngrid.fit</code></td>
<td>
<p>numeric; number of grid points in last query segment for matching last reference segment</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_window">window</code></td>
<td>
<p>integer; size (gridpoints) of Savitzky Golay smoothing window for landmark position determination</p>
</td></tr>
<tr><td><code id="apply_transformations_+3A_log_file">log_file</code></td>
<td>
<p>character; File path to direct console output e.g., <code>"log.txt"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>vachette_data</code> object containing a list of vachette-transformed <code>data.frame</code>s
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- read.csv(system.file(package = "vachette", "examples", "iv-obs.csv"))
typ &lt;- read.csv(system.file(package = "vachette", "examples", "iv-typ-minmax.csv"))

vd &lt;- vachette_data(
  obs.data = obs,
  typ.data = typ,
  covariates = c(WT = 70),
  mappings = c(OBS = "DV", x = "time"),
  model.name  = "IV"
 )

 vd &lt;- apply_transformations(vd)

</code></pre>

<hr>
<h2 id='p.add.distances'>Plot Distances Before and After <code>vachette</code> Transformation Assuming Additive Error Model</h2><span id='topic+p.add.distances'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the distances
before and after a <code>vachette</code> transformation between observations and the
relative typical curves.
It is useful for assessing the impact of additive error
model assumption on the distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.add.distances(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.add.distances_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function starts by setting the x-axis range based on the minimum
and maximum values of the original and scaled distances. It then plots the
distances before and after transformation, with a reference line
indicating where the original and transformed distances are equal.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the plot of distances.
The plot compares the original distances to the transformed distances, with
segments color-coded.
</p>

<hr>
<h2 id='p.obs.cov'>Plot Observations and Typical Curves Faceted by Covariate</h2><span id='topic+p.obs.cov'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of observations and typical
curves within a pharmacometric model, faceted by unique covariate values (ucov).
The plot compares the observed data against the typical reference and query curves,
with each facet representing a different covariate value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.obs.cov(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.obs.cov_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function begins by ensuring that the input <code>vachette_data</code>
is of the correct class. It then constructs a plot that displays the reference
and query data, differentiating them using distinct colors, and faceting the
plot by unique covariate values. Observations are represented by points,
while the typical curves are depicted as lines.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
If the x-axis is logarithmic, the axis label is adjusted accordingly.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the observations and typical curves,
faceted by covariate. The plot displays both the reference and query curves
and their corresponding observations, color-coded for easy comparison.
</p>

<hr>
<h2 id='p.obs.excluded'>Plot Excluded Observations with Reasons for Exclusion</h2><span id='topic+p.obs.excluded'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of observations that were
excluded from the transformation process within a pharmacometric model.
The plot includes both the included and excluded observations, with the
excluded ones color-coded by reason for exclusion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.obs.excluded(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.obs.excluded_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function  plots the reference and query curves along
with the observations. Observations that were excluded from the transformation
process are highlighted and labeled with the reason for exclusion, while
included observations are shown in light grey.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values from the original observations.
If the x-axis is logarithmic, the axis label is adjusted accordingly.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the excluded observations and
their corresponding reasons for exclusion. The plot also displays the typical
reference and query curves for comparison.
</p>

<hr>
<h2 id='p.obs.ref.query'>Plot Observations and Typical Curves for Query and Reference Data</h2><span id='topic+p.obs.ref.query'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the observations and typical curves
for both query and reference data within a pharmacometric model. It is designed to
compare the observed data against the typical reference and query curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.obs.ref.query(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.obs.ref.query_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the query and reference data,
differentiating them using distinct colors. Observations are represented
by points, while the typical curves are depicted as lines.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
If the x-axis is logarithmic, the axis label is adjusted accordingly.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the observations and typical curves.
The plot displays the query and reference curves and their corresponding observations,
color-coded for easy comparison.
</p>

<hr>
<h2 id='p.prop.distances'>Plot Distances Before and After <code>vachette</code> Transformation Assuming Proportional Error Model</h2><span id='topic+p.prop.distances'></span>

<h3>Description</h3>

<p>This function creates a ggplot2 visualization of the distances
before and after the <code>vachette</code> transformation between observations
and the relative typical curves. It is useful for assessing the impact of
proportional error model assumption on the distances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.prop.distances(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.prop.distances_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The plot includes a reference line with a slope of 1, indicating where
the original and transformed distances are equal. The title of the plot is
dynamically generated based on the model name provided in the <code>vachette_data</code> object.
</p>
<p>The subtitle of the plot indicates whether an additive or proportional error
transformation was applied. The caption provides the reference covariate(s)
used in the model.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the plot of distances.
The plot compares the log of the original distances to the log of the distances
after transformation, color-coded by segment.
</p>

<hr>
<h2 id='p.scaled.observation.curves'>Plot <code>vachette</code> Transformed Observation Curves</h2><span id='topic+p.scaled.observation.curves'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of transformed observation curves,
including their transformations and overlays with reference curves. The plot is
useful for comparing the original and the <code>vachette</code>
transformed observation data against typical reference curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaled.observation.curves(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaled.observation.curves_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs a plot that overlays
observation curves with the corresponding reference curves. Query observations
and their transformed curves are highlighted, and if applicable, an extrapolated
segment of the reference curve is shown as a dashed line.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the <code>vachette</code> transformed observation curves. The plot
includes different layers for query observations, their transformed counterparts,
and the reference curves, with appropriate color coding and line styles.
</p>

<hr>
<h2 id='p.scaled.observation.curves.by.id'>Plot <code>vachette</code> Transformed Observation Curves by Individual</h2><span id='topic+p.scaled.observation.curves.by.id'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of transformed observation curves
facetted by individual, including their transformations and overlays
with reference curves. The plot is useful for comparing the original and the <code>vachette</code>
transformed observation data against typical reference curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaled.observation.curves.by.id(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaled.observation.curves.by.id_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function constructs a plot that overlays individual
observation curves with the corresponding reference curves. Query observations
and their transformed curves are highlighted, and if applicable, an extrapolated
segment of the reference curve is shown as a dashed line.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the <code>vachette</code> transformed observation curves. The plot
includes different layers for query observations, their transformed counterparts,
and the reference curves, with appropriate color coding and line styles.
</p>

<hr>
<h2 id='p.scaled.typical.curves'>Plot <code>vachette</code> Transformed Typical Curves</h2><span id='topic+p.scaled.typical.curves'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the <code>vachette</code> transformed typical curves
for a given pharmacometric model. It distinguishes between reference curves
and query curves, showing how the curves transform.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaled.typical.curves(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaled.typical.curves_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a plot that distinguishes between
reference curves (in red) and query curves (in blue). The dashed
lines represent the curves after the vachette transformation.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the <code>vachette</code> transformed typical curves. The plot
shows both the reference and query curves, and the curves after
the vachette transformation.
</p>

<hr>
<h2 id='p.scaled.typical.curves.landmarks'>Plot <code>vachette</code> Transformed Typical Curves with Landmarks</h2><span id='topic+p.scaled.typical.curves.landmarks'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the <code>vachette</code> transformed
typical curves and their corresponding landmarks for a given pharmacometric model.
The plot highlights the segments of the reference and query curves, with a special emphasis
on the landmark positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaled.typical.curves.landmarks(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaled.typical.curves.landmarks_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the typical curves along with their
segments and marking the landmarks. If the x-axis is
logarithmic, it adjusts the axis label accordingly.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the <code>vachette</code> transformed typical curves with
their landmarks. The plot displays different segments of the curves in different color,
and landmarks marked with black crosses.
</p>

<hr>
<h2 id='p.scaled.typical.full.curves.landmarks'>Plot Full <code>vachette</code> Transformed Typical Curves with Landmarks</h2><span id='topic+p.scaled.typical.full.curves.landmarks'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the full <code>vachette</code> transformed typical
curves and their corresponding landmarks for a given pharmacometric model.
The plot highlights the segments of the reference and query curves, with a special emphasis on
specific landmark positions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaled.typical.full.curves.landmarks(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaled.typical.full.curves.landmarks_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the full typical curves along with
their segments, applying specific styling to the reference curve and marking
the landmarks. If the x-axis is logarithmic, it adjusts the axis label accordingly.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the full <code>vachette</code> transformed typical curves
with their landmarks. The plot displays different segments of the curves in different colors,
and landmarks marked with black crosses.
</p>

<hr>
<h2 id='p.scaling.factor'>Plot Scaling Factors for Typical Curves</h2><span id='topic+p.scaling.factor'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of the scaling factors applied
to the typical curves within a pharmacometric model. The plot differentiates between
reference and query curves and illustrates how scaling factors vary across
segments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.scaling.factor(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.scaling.factor_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function creates a plot that displays
the x-scaling factors for the curves, with different segments color-coded.
The plot is faceted by curve type (reference or query).
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the minimum and maximum x values, before and after scaling.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the scaling factors for the curves.
The plot includes facets for each curve type (reference or query),
and it shows the scaling factors as a function of the x-axis values.
</p>

<hr>
<h2 id='p.vachette'>Main Vachette Plot</h2><span id='topic+p.vachette'></span>

<h3>Description</h3>

<p>This function generates the main Vachette plot, which visualizes all transformed
data points within a pharmacometric model. The plot makes a clear distinction
between reference data points (those that were not moved, shown in red) and
transformed query data points (those that were moved, shown in purple).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.vachette(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.vachette_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots all the data points, highlighting
reference points in red and transformed query points in purple. The plot
also overlays reference curves, with extrapolated segments displayed as
dashed lines if available. The subtitle provides information about the
error model used (additive or proportional) and the number of excluded
observations.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the scaled x values. If the x-axis is logarithmic, the axis label
is adjusted accordingly.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing, which
includes all observations, with reference data points shown in red, and
transformed query data points shown in purple. The plot also includes
reference curves and, if applicable, extrapolated reference curves as dashed lines.
</p>

<hr>
<h2 id='p.vachette.arrow'>Plot Observations and <code>vachette</code> Transformed Observations with Connecting Arrows</h2><span id='topic+p.vachette.arrow'></span>

<h3>Description</h3>

<p>This function generates a ggplot2 visualization of observations and their transformations
within a pharmacometric model. The plot superimposes the observed query and reference data
from original to <code>vachette</code> transformed values, showing direction of transformation.
Reference and query curves are additionally overlaid for comparison.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.vachette.arrow(vachette_data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="p.vachette.arrow_+3A_vachette_data">vachette_data</code></td>
<td>
<p>An object of class <code>vachette_data</code>, which contains
the necessary data for plotting.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function plots the original and <code>vachette</code> transformed observations,
with arrows showing the transformation path. Reference and query curves are
also plotted, with extrapolated reference curves displayed as dashed lines
if available. The subtitle provides information about the error model used
(additive or proportional) and the number of excluded observations.
</p>
<p>The plot's title includes the model name, and the caption provides details
about the reference covariate(s) used. The x-axis range is dynamically set
based on the scaled x values. If the x-axis is logarithmic, the axis label
is adjusted accordingly.
</p>


<h3>Value</h3>

<p>A <code>ggplot2</code> object representing the observations, their transformations,
and the corresponding reference and query curves. The plot also indicates if any
extrapolated reference curves are present and how many observations were excluded
from the transformation.
</p>

<hr>
<h2 id='print.vachette_data'>Print <code>vachette_data</code></h2><span id='topic+print.vachette_data'></span>

<h3>Description</h3>

<p>Print generic used to return information about <code>vachette_data</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vachette_data'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.vachette_data_+3A_x">x</code></td>
<td>
<p><code>vachette_data</code> object.</p>
</td></tr>
<tr><td><code id="print.vachette_data_+3A_...">...</code></td>
<td>
<p>additional args.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>x</code> invisibly.
</p>

<hr>
<h2 id='summary.vachette_data'>Summarise <code>vachette_data</code></h2><span id='topic+summary.vachette_data'></span>

<h3>Description</h3>

<p>Summary generic used to return information about <code>vachette_data</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vachette_data'
summary(object, verbose = FALSE, trim = TRUE, log_file = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.vachette_data_+3A_object">object</code></td>
<td>
<p><code>vachette_data</code> object.</p>
</td></tr>
<tr><td><code id="summary.vachette_data_+3A_verbose">verbose</code></td>
<td>
<p>logical; Set to <code>TRUE</code> to view additional warnings output</p>
</td></tr>
<tr><td><code id="summary.vachette_data_+3A_trim">trim</code></td>
<td>
<p>logical; If <code>TRUE</code>, only the first 20 rows are printed for <code>data.frame</code> output. Set to <code>FALSE</code> to display all rows</p>
</td></tr>
<tr><td><code id="summary.vachette_data_+3A_log_file">log_file</code></td>
<td>
<p>character; File path to direct console output e.g., <code>"log.txt"</code></p>
</td></tr>
<tr><td><code id="summary.vachette_data_+3A_...">...</code></td>
<td>
<p>additional args.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>object</code> invisibly.
</p>

<hr>
<h2 id='vachette_data'>Initialize vachette object with required data</h2><span id='topic+vachette_data'></span>

<h3>Description</h3>

<p>Initialize vachette object with required data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vachette_data(
  obs.data,
  typ.data,
  sim.data = NULL,
  covariates,
  ref.dosenr,
  log.x = FALSE,
  iiv.correction = FALSE,
  error.model = c("proportional", "additive"),
  model.name = NULL,
  mappings = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vachette_data_+3A_obs.data">obs.data</code></td>
<td>
<p>data.frame; Observed data</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_typ.data">typ.data</code></td>
<td>
<p>data.frame; Typical (population) curves</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_sim.data">sim.data</code></td>
<td>
<p>data.frame; Simulated (VPC) data</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_covariates">covariates</code></td>
<td>
<p>named character vector; Covariate names with reference values in vachette transformation</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_ref.dosenr">ref.dosenr</code></td>
<td>
<p>integer; Dose number to use as the reference dose, corresponding to value in &quot;dosenr&quot; column in input data</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_log.x">log.x</code></td>
<td>
<p>logical; Apply log(x) conversion. Default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="vachette_data_+3A_iiv.correction">iiv.correction</code></td>
<td>
<p>logical; Apply inter-individual variability correction. Default <code>FALSE</code></p>
</td></tr>
<tr><td><code id="vachette_data_+3A_error.model">error.model</code></td>
<td>
<p>character; Applied error model, <code>"proportional"</code> or <code>"additive"</code>. Default <code>"proportional"</code></p>
</td></tr>
<tr><td><code id="vachette_data_+3A_model.name">model.name</code></td>
<td>
<p>character; Optional model name for plot output</p>
</td></tr>
<tr><td><code id="vachette_data_+3A_mappings">mappings</code></td>
<td>
<p>named character vector;  Optional mappings to be included if column names in input <code>data.frame</code> differ from required column names.
See Required Columns section:</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If &quot;dosenr&quot; column is missing it will be automatically calculated using the priority of available columns:
</p>

<ul>
<li><p> &quot;EVID&quot;: If available in data, &quot;dosenr&quot; will be calculated using <code>cumsum(EVID==1)</code>
</p>
</li>
<li><p> &quot;ADDL&quot;/&quot;II&quot;: If &quot;ADDL&quot; and &quot;II&quot; are available in data, &quot;dosenr&quot; will be calculated given additional dose number and interval
</p>
</li>
<li><p> &quot;AMT&quot;: If only &quot;AMT&quot; column exists in data, &quot;dosenr&quot; will be calculated using <code>cumsum(AMT!=0)</code>
</p>
</li></ul>



<h3>Value</h3>

<p><code>vachette_data</code>
</p>


<h3>Required columns <code>obs.data</code></h3>


<ul>
<li> <p><code>"ID"</code> - Subject ID
</p>
</li>
<li> <p><code>"x"</code> - Typically time
</p>
</li>
<li> <p><code>"PRED"</code> - Population prediction, required if <code>iiv.correction = TRUE</code>
</p>
</li>
<li> <p><code>"IPRED"</code> - Individual prediction, required if <code>iiv.correction = TRUE</code>
</p>
</li>
<li> <p><code>"OBS"</code> - DV
</p>
</li>
<li> <p><code>"dosenr"</code> - Dose number; unique dose number for ID/time point
</p>
</li></ul>



<h3>Required columns <code>typ.data</code></h3>


<ul>
<li> <p><code>"ID"</code> - Subject ID
</p>
</li>
<li> <p><code>"x"</code> - Typically time
</p>
</li>
<li> <p><code>"PRED"</code> - Population prediction
</p>
</li>
<li> <p><code>"dosenr"</code> - Dose number; unique dose number for ID/time point
</p>
</li></ul>



<h3>Required columns <code>sim.data</code></h3>


<ul>
<li> <p><code>"ID"</code> - Subject ID
</p>
</li>
<li> <p><code>"x"</code> - Typically time
</p>
</li>
<li> <p><code>"PRED"</code> - Population prediction, required if <code>iiv.correction = TRUE</code>
</p>
</li>
<li> <p><code>"IPRED"</code> - Individual prediction, required if <code>iiv.correction = TRUE</code>
</p>
</li>
<li> <p><code>"REP"</code> - Replicate number
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>obs &lt;- read.csv(system.file(package = "vachette", "examples", "iv-obs.csv"))
typ &lt;- read.csv(system.file(package = "vachette", "examples", "iv-typ-minmax.csv"))

vd &lt;- vachette_data(
  obs.data = obs,
  typ.data = typ,
  covariates = c(WT = 70),
  mappings = c(OBS = "DV", x = "time"),
  model.name  = "IV"
  )


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
