<!DOCTYPE html><html><head><title>Help for package satin</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {satin}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anomaly'>
<p>Anomalies of a satin object</p></a></li>
<li><a href='#climatology'>
<p>Climatology of a satin object</p></a></li>
<li><a href='#crop'>
<p>Cut a satin object</p></a></li>
<li><a href='#dchl'>
<p>Chlorophyll concentration sample data - Aqua Modis sensor</p></a></li>
<li><a href='#dcmems'>
<p>Copernicus Marine Service sample data</p></a></li>
<li><a href='#dmap'><p>Map of northwest Mexico</p></a></li>
<li><a href='#dnpp'>
<p>Ocean Net Primary Production sample data</p></a></li>
<li><a href='#dsst'>
<p>SST sample data - Aqua Modis sensor</p></a></li>
<li><a href='#extractPts'>
<p>Extract ocean data values from a satin object</p></a></li>
<li><a href='#fmainPos'>
<p>Calculate coordinates for title in plots</p></a></li>
<li><a href='#imageScale'><p>Make a color scale to accompany an image or other plot</p></a></li>
<li><a href='#isolines'><p> Interpolate isolines from ocean data</p></a></li>
<li><a href='#pixelate'><p> Spatial re-scaling of ocean data</p></a></li>
<li><a href='#plot.satin'>
<p>Visualise ocean data</p></a></li>
<li><a href='#quiver'>
<p>Vectors of ocean currents velocities</p></a></li>
<li><a href='#read.cmems'>
<p>Read ocean products data from CMEMS</p></a></li>
<li><a href='#read.ghrsst'>
<p>Read sea surface temperature data from JPL Multi-scale Ultra-high Resolution (MUR) SST Project</p></a></li>
<li><a href='#read.nasaoc'>
<p>Read ocean data from NASA's Oceancolor web files</p></a></li>
<li><a href='#read.osunpp'>
<p>Read ocean productivity data from Oregon State University files</p></a></li>
<li><a href='#satin-class'><p>Class &quot;satin&quot;</p></a></li>
<li><a href='#satinDataframe'>
<p>Reshape a satin object into a data frame</p></a></li>
<li><a href='#satinMean'>
<p>Averaging ocean data by time period</p></a></li>
<li><a href='#satinPalette'>
<p>Define custom color palettes for echograms</p></a></li>
<li><a href='#velocity'>
<p>Ocean currents velocities</p></a></li>
<li><a href='#verticalProfiles'>
<p>CTD-like vertical profiles for Copernicus variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Visualisation and Analysis of Ocean Data Derived from Satellites</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-09-22</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Author:</td>
<td>Héctor Villalobos and Eduardo González-Rodríguez &lt;egonzale@cicese.mx&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Héctor Villalobos &lt;hvillalo@ipn.mx&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>With 'satin' functions, visualisation, data extraction and further analysis like producing climatologies from several images, and anomalies of satellite derived ocean data can be easily done.  Reading functions can import a user defined geographical extent of data stored in netCDF files.  Currently supported ocean data sources include NASA's Oceancolor web page <a href="https://oceancolor.gsfc.nasa.gov/">https://oceancolor.gsfc.nasa.gov/</a>, sensors VIIRS-SNPP; MODIS-Terra; MODIS-Aqua; and SeaWiFS.  Available variables from this source includes chlorophyll concentration, sea surface temperature (SST), and several others.  Data sources specific for SST that can be imported too includes Pathfinder AVHRR <a href="https://www.ncei.noaa.gov/products/avhrr-pathfinder-sst">https://www.ncei.noaa.gov/products/avhrr-pathfinder-sst</a> and GHRSST <a href="https://www.ghrsst.org/">https://www.ghrsst.org/</a>.  In addition, ocean productivity data produced by Oregon State University <a href="http://sites.science.oregonstate.edu/ocean.productivity/">http://sites.science.oregonstate.edu/ocean.productivity/</a> can also be handled previous conversion from HDF4 to HDF5 format.  Many other ocean variables can be processed by importing netCDF data files from two European Union's Copernicus Marine Service databases <a href="https://marine.copernicus.eu/">https://marine.copernicus.eu/</a>, namely Global Ocean Physical Reanalysis and Global Ocean Biogeochemistry Hindcast.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/hvillalo/satin">https://github.com/hvillalo/satin</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/hvillalo/satin/issues">https://github.com/hvillalo/satin/issues</a></td>
</tr>
<tr>
<td>Collate:</td>
<td>satin-class.R read.cmems.R read.ghrsst.R read.nasaoc.R
read.osunpp.R fmainPos.R imageScale.R plot.satin.R
satinPalette.R quiver.R verticalProfiles.R satinDataframe.R
pixelate.R climatology.R crop.R extractPts.R isolines.R
satinMean.R anomaly.R velocity.R</td>
</tr>
<tr>
<td>Imports:</td>
<td>ncdf4, maps, PBSmapping, grDevices, splancs, sp, geosphere,
graphics, methods</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-22 20:43:43 UTC; Usuario</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-22 21:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anomaly'>
Anomalies of a satin object
</h2><span id='topic+anomaly'></span>

<h3>Description</h3>

<p>This function returns ocean data anomalies of a satin object.  Anomalies are calculated subtracting a conforming average satin object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anomaly(X, Y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anomaly_+3A_x">X</code></td>
<td>

<p>a satin object obtained with <code><a href="#topic+satinMean">satinMean</a></code> for which anomalies are to be calculated. It must have identifying <code>labels</code> in the slot <code>attribs</code>.
</p>
</td></tr>
<tr><td><code id="anomaly_+3A_y">Y</code></td>
<td>

<p>also a satin object returned by <code><a href="#topic+satinMean">satinMean</a></code> with the means to be subtracted from <code>X</code>. It must have the same <code>labels</code> as <code>X</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The anomalies of a satin object represent, for every pixel, the values above and below a reference average.  A typical example can be monthly sea surface temperature anomalies for various years.  These are calculated subtracting the corresponding average month for the whole period (see example below).
</p>
<p>In principle, anomalies can be calculated for other ocean variables and time periods, but is up to the user to determine if that makes sense.  For example, let say that <code>Z</code> is a satin object with daily chlorophyll-a concentration data for several years.  In order to calculate quarterly anomalies, we will need first to obtain <code>X &lt;- satinMean(Z, "%Y-%qtr")</code> and <code>Y &lt;- satinMean(Z, "%qtr")</code>.
</p>


<h3>Value</h3>

<p>An object of  class <code>"satin"</code> (see <code><a href="#topic+satin-class">satin-class</a></code> for details) where the third dimension in the data array accomodates the calculated anomalies.  An extra element (<code>labels</code>) is included in the slot <code>attribs</code> to identify the time period of the anomalies.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>See Also</h3>

<p><code><a href="#topic+satinMean">satinMean</a></code> for calculating ocean data averages needed, and <code><a href="#topic+climatology">climatology</a></code> for climatologies.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
# Calculate monthly sea surface temperature from weekly data.
# sst contains 240 weekly images for five years.

# This will produce the 12 average months for the five years
sst.m &lt;- satinMean(sst, by="%m") 

# and here we have 60 monthly periods, 12 for each one of the five years
sst.ym &lt;- satinMean(sst, by="%Y-%m") 

# monthly sea surface temperature anomalies
anom &lt;- anomaly(X = sst.ym, Y = sst.m)

# the dimensions of the data slots in sst.ym and anom are the same.
dim(sst.ym@data); dim(anom@data)

# plots of the first 24 months
lab &lt;- paste(month.name, rep(2014:2018, each=12))
for (m in 1:24){
  plot(anom, period = m, zlim=c(-10, 10), col.sep = 0.2, main = lab[m],
       scheme = c("blue", "cyan", "white", "yellow", "red"))
}
}
</code></pre>

<hr>
<h2 id='climatology'>
Climatology of a satin object
</h2><span id='topic+climatology'></span>

<h3>Description</h3>

<p>This function calculates the percent coverage, mean, standard deviation, minimum and maximum for every pixel in a set of images stored in a single satin data object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climatology(X, depth = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climatology_+3A_x">X</code></td>
<td>

<p>a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>. </p>
</td></tr>
<tr><td><code id="climatology_+3A_depth">depth</code></td>
<td>

<p>an integer referring to a given  depth level. Only meaningful for Copernicus data that includes variables at different depths.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For Copernicus data files containing more than one variable, the <code><a href="#topic+read.cmems">read.cmems</a></code> function returns a named list, with elements corresponding to each variable.  In order to use these objects with <code>climatology</code> the appropriate indexing should be applied (see examples below).
</p>


<h3>Value</h3>

<p>An object of  class <code>"satin"</code> (see <code><a href="#topic+satin-class">satin-class</a></code> for details) where the third dimension in the data array accomodates coverage, mean, standard deviation, minimum and maximum.  Also, an extra element (<code>label</code>) is included in the slot <code>attribs</code> to summarize the start and end times used for the climatology.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
csst &lt;- climatology(sst) # sst is a satin object with 12 monthly images 
                         # of sea surface temperature

# -- plots --

# coverage
plot(csst, period = 1)

# mean
plot(csst, period = 2)

# standard deviation
plot(csst, period = 3)

# minimum
plot(csst, period = 4)

# maximum
plot(csst, period = 5)
}
# For Copernicus data

data(dcmems) # load sample data
names(dcmems) # available variables 

# mean potential temperature (thetao) at 0.49 m
# using labels stored in slot period
cthetao1 &lt;- climatology(dcmems$thetao, depth = 1)
plot(cthetao1, period = 2, main = cthetao1@period$label[2])

# standard deviation of thetao at 318 m
cthetao2 &lt;- climatology(dcmems$thetao, depth = 5)
plot(cthetao2, period = 3, main = cthetao1@period$label[3])

</code></pre>

<hr>
<h2 id='crop'>
Cut a satin object
</h2><span id='topic+crop'></span>

<h3>Description</h3>

<p>Select and cut a polygon shaped area of interest from a satin object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>crop(X, polygon = NULL, return.poly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="crop_+3A_x">X</code></td>
<td>

<p>a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>.  
</p>
</td></tr>
<tr><td><code id="crop_+3A_polygon">polygon</code></td>
<td>

<p>a polygon defining the area of interest (aoi) to be cutted.
</p>
</td></tr>
<tr><td><code id="crop_+3A_return.poly">return.poly</code></td>
<td>

<p>if TRUE, <code>crop</code> returns a list with the cutted satin object and the polygon drawn (a data frame).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If provided, the polygon defining the aoi must have two columns with x and y coordinates.  The function verifies that the last point is exactly the same as the first one.  When not specified, the user can draw a polygon by clicking on a previously displayed image.  Note that for drawing the polygon in this manner, the plot of the satin object has to be created using <code>colbar = FALSE</code>.  The result is a satin object where the pixels outside the aoi are set to NA.  In order to cut Copernicus data returned from <code><a href="#topic+read.cmems">read.cmems</a></code>, the appropriate indexing should be previously done.
</p>


<h3>Value</h3>

<p>A cutted satin object.
</p>
<p>When <code>return.poly = TRUE</code>, a list with two components:
</p>
<table>
<tr><td><code>aoi</code></td>
<td>
<p>cutted satin object.</p>
</td></tr>
<tr><td><code>polygon</code></td>
<td>
<p>polygon coordinates defining the aoi.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>See Also</h3>

<p><code><a href="splancs.html#topic+getpoly">getpoly</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load and display sample data
data(dsst)
plot(dsst)
  
# define polygon, cut the image and display the aoi
polyg &lt;- data.frame(x = c(-110, -105, -113, -116, -110), y = c(23, 23, 32, 32, 23))
dsst.clip &lt;- crop(dsst, polygon = polyg)
plot(dsst.clip)

if(interactive()){ 
# the same, but polygon is defined by clicking on the image
plot(dsst, colbar = FALSE)
dsst.clip2 &lt;- crop(dsst, return.poly = TRUE) # *** draw the aoi polygon ***
dsst.clip2$polygon # show polygon coordinates
plot(dsst.clip2$aoi) # plot the selected aoi
}
</code></pre>

<hr>
<h2 id='dchl'>
Chlorophyll concentration sample data - Aqua Modis sensor
</h2><span id='topic+dchl'></span>

<h3>Description</h3>

<p>Chlorophyll-a concentration (8-day average; 4 km resolution) from March 30 to April 7 2013 off northwest Mexico.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dchl")</code></pre>


<h3>Format</h3>

<p>Formal class 'satin' [package &quot;satin&quot;] with 6 slots
</p>

<table>
<tr>
 <td style="text-align: left;">
  ..@ lon   </td><td style="text-align: left;"> : num [1:360] -119 -119 -119 -119 -119 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ lat   </td><td style="text-align: left;"> : num [1:360] 20 20.1 20.1 20.1 20.2 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ data  </td><td style="text-align: left;"> : num [1:360, 1:360, 1] 0.0631 0.0696 0.0724 0.0723 0.0705 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ attribs: List of 6 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ title     </td><td style="text-align: left;">        : chr "HMODISA Level-3 Standard Mapped Image"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ longname  </td><td style="text-align: left;">         : chr "Chlorophyll Concentration, OCI Algorithm"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ name     </td><td style="text-align: left;">         : chr "chlor_a"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ units    </td><td style="text-align: left;">         : chr "mg m^-3"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ temporal_range </td><td style="text-align: left;">   : chr "8-day"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ spatial_resolution </td><td style="text-align: left;"> : chr "4.64 km"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ period: List of 2 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmStart </td><td style="text-align: left;"> : POSIXct[1:1], format: "2013-03-30 00:25:01"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmEnd </td><td style="text-align: left;">  : POSIXct[1:1], format: "2013-04-07 02:59:59"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ depth </td><td style="text-align: left;"> : num(0)
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Source data file (A20130892013096.L3m_8D_CHL_chlor_a_4km.nc) was downloaded from the link below, then imported with the <code><a href="#topic+read.nasaoc">read.nasaoc</a></code> function.  The selected area covers from 20 to 35 degrees of latitude North and from 119 to 104 degrees of longitude West.
</p>


<h3>Source</h3>

<p><a href="https://oceancolor.gsfc.nasa.gov/cgi/l3">https://oceancolor.gsfc.nasa.gov/cgi/l3</a>
</p>


<h3>References</h3>

<p><a href="https://oceancolor.gsfc.nasa.gov/docs/technical/">https://oceancolor.gsfc.nasa.gov/docs/technical/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dchl)
dchl
str(dchl)

plot(dchl)

# plot with logarithmic scale
plot(dchl, log = TRUE)
</code></pre>

<hr>
<h2 id='dcmems'>
Copernicus Marine Service sample data
</h2><span id='topic+dcmems'></span>

<h3>Description</h3>

<p>This sample data contains monthly values (November and December 2010) of sea water potential temperature (thetao, degrees C) and sea surface height (zos, m) off northwest Mexico, 1/12 degree horizontal resolution (aprox. 9.26 km).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dcmems")</code></pre>


<h3>Format</h3>

<p>List of 2<br />
$ thetao:Formal class 'satin' [package &quot;satin&quot;] with 6 slots
</p>

<table>
<tr>
 <td style="text-align: left;"> 
  .. ..@ lon </td><td style="text-align: left;">   : num [1:181] -119 -119 -119 -119 -119 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ lat </td><td style="text-align: left;">   : num [1:169] 20 20.1 20.2 20.2 20.3 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ data </td><td style="text-align: left;">  : num [1:169, 1:181, 1:2, 1:5] 23.5 23.5 23.5 23.4 23.4 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ attribs:List of 6 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ title     </td><td style="text-align: left;">        : chr "thetao"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ longname  </td><td style="text-align: left;">        : chr "Temperature"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ name      </td><td style="text-align: left;">        : chr "thetao"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ units     </td><td style="text-align: left;">        : chr "degrees_C"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ temporal_range  </td><td style="text-align: left;">  : chr "monthly"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ spatial_resolution </td><td style="text-align: left;"> : chr "9.2 km"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ period :List of 2 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ tmStart </td><td style="text-align: left;"> : POSIXct[1:2], format: "2010-11-16 00:00:00" ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ tmEnd  </td><td style="text-align: left;"> : POSIXct[1:2], format: "2010-11-16 00:00:00" ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ depth  </td><td style="text-align: left;">  : num [1:5] 0.494 9.573 29.445 92.326 318.127
  </td>
</tr>

</table>

<p>$ zos   :Formal class 'satin' [package &quot;satin&quot;] with 6 slots
</p>

<table>
<tr>
 <td style="text-align: left;">  
  .. ..@ lon  </td><td style="text-align: left;">  : num [1:181] -119 -119 -119 -119 -119 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ lat  </td><td style="text-align: left;">  : num [1:169] 20 20.1 20.2 20.2 20.3 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ data </td><td style="text-align: left;">   : num [1:169, 1:181, 1:2, 1] 0.336 0.34 0.343 0.345 0.347 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ attribs:List of 6 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ title     </td><td style="text-align: left;">        : chr "zos"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ longname  </td><td style="text-align: left;">        : chr "Sea surface height"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ name      </td><td style="text-align: left;">        : chr "zos"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ units     </td><td style="text-align: left;">        : chr "m"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ temporal_range  </td><td style="text-align: left;">  : chr "monthly"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ spatial_resolution </td><td style="text-align: left;"> : chr "9.2 km"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ period :List of 2 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ tmStart </td><td style="text-align: left;"> : POSIXct[1:2], format: "2010-11-16 00:00:00" ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. .. ..$ tmEnd </td><td style="text-align: left;"> : POSIXct[1:2], format: "2010-11-16 00:00:00" ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..@ depth  </td><td style="text-align: left;"> : num 0.494
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Source data corresponds to Global Ocean Physical Reanalysis database (GLOBAL_REANALYSIS_PHY_001_030), and was downloaded from the link below, then imported with the <code><a href="#topic+read.cmems">read.cmems</a></code> function.  The selected area covers from 20 to 35 degrees of latitude North and from 119 to 104 degrees of longitude West.  Potential temperature includes five depth levels (0.494, 9.573, 29.445, 92.326, 318.127).
</p>


<h3>Source</h3>

<p><a href="https://marine.copernicus.eu/">https://marine.copernicus.eu/</a>
</p>


<h3>References</h3>

<p>Fernandez, E. and Lellouche, J. M. 2018 <em>Product Manual for the Global Ocean Physical Reanalysis product, issue 1.1</em>. EU Copernicus Marine Service.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dcmems)
dcmems

plot(dcmems$thetao)

# potential temperature at 318 m
plot(dcmems$thetao, depth = 5) 

# sea surface height
plot(dcmems$zos) 
</code></pre>

<hr>
<h2 id='dmap'>Map of northwest Mexico</h2><span id='topic+dmap'></span>

<h3>Description</h3>

<p>Map of northwest Mexico obtained from GSHHG database (v2.3.7).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dmap")</code></pre>


<h3>Details</h3>

<p>This intermediate resolution map was imported from the Global Self-consistent, Hierarchical, High-resolution Geography Database by means of <code>Rgshhs</code> function from <span class="pkg">maptools</span> package.
</p>


<h3>Source</h3>

<p><a href="https://www.soest.hawaii.edu/pwessel/gshhg/gshhg-bin-2.3.7.zip">https://www.soest.hawaii.edu/pwessel/gshhg/gshhg-bin-2.3.7.zip</a>
</p>


<h3>References</h3>

<p>Wessel, P. and Smith, W. H. F. 1996 A Global Self-consistent, Hierarchical, High-resolution Shoreline Database, <em>Journal of Geophysical Research</em>, <b>101</b>, 8741&ndash;8743.
</p>


<h3>See Also</h3>

 <p><code>Rgshhs</code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(sp)
data(dmap)
plot(dmap, xlim=c(-120, -105) , ylim=c(20, 35), xaxs="i", yaxs="i", 
     axes=TRUE, col="beige", lty=1, border="grey70"); box()
</code></pre>

<hr>
<h2 id='dnpp'>
Ocean Net Primary Production sample data
</h2><span id='topic+dnpp'></span>

<h3>Description</h3>

<p>Ocean Net Primary Production (8-day average; 9.26 km resolution) from March 30 to April 6 2013 off northwest Mexico.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dnpp")</code></pre>


<h3>Format</h3>

<p>Formal class 'satin' [package &quot;satin&quot;] with 6 slots
</p>

<table>
<tr>
 <td style="text-align: left;">
  ..@ lon  </td><td style="text-align: left;">  : num [1:180] -119 -119 -119 -119 -119 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ lat  </td><td style="text-align: left;">  : num [1:180] 20.1 20.1 20.2 20.3 20.4 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ data  </td><td style="text-align: left;"> : num [1:180, 1:180, 1] 285 292 270 279 262 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ attribs:List of 6 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ title    </td><td style="text-align: left;">         : chr "Ocean Productivity"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ longname </td><td style="text-align: left;">         : chr "Ocean Net Primary Production"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ name     </td><td style="text-align: left;">         : chr "npp"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ units    </td><td style="text-align: left;">         : chr "mgC m-2 day-1"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ temporal_range </td><td style="text-align: left;">   : chr "8 day"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ spatial_resolution </td><td style="text-align: left;"> : chr "9.26 km"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ period :List of 2 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmStart </td><td style="text-align: left;"> : POSIXct[1:1], format: "2013-03-30"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmEnd </td><td style="text-align: left;">  : POSIXct[1:1], format: "2013-04-06 23:59:59"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ depth </td><td style="text-align: left;"> : num(0)
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Source data file (vgpm.2013089.hdf.gz) was downloaded from the link below, decompressed with <code>gunzip</code> function from <span class="pkg">R.utils</span> package, then converted to hdf v5 with h4toh5 Conversion Software (<a href="https://support.hdfgroup.org/products/hdf5_tools/h4toh5/download.html">https://support.hdfgroup.org/products/hdf5_tools/h4toh5/download.html</a>) before being imported with the <code><a href="#topic+read.osunpp">read.osunpp</a></code> function.  The selected area covers from 20 to 35 degrees of latitude North and from 119 to 104 degrees of longitude West.
</p>


<h3>Source</h3>

<p><a href="http://sites.science.oregonstate.edu/ocean.productivity/standard.product.php">http://sites.science.oregonstate.edu/ocean.productivity/standard.product.php</a>
</p>


<h3>References</h3>

<p>Behrenfeld, M. J. and Falkowski, P. G. 1997 Photosynthetic rates derived from satellite-based chlorophyll concentration, <em>Limnology and Oceanography</em>, <b>42</b>, 1&ndash;20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dnpp)
dnpp
str(dnpp)
plot(dnpp, col.sep = 100)
</code></pre>

<hr>
<h2 id='dsst'>
SST sample data - Aqua Modis sensor
</h2><span id='topic+dsst'></span>

<h3>Description</h3>

<p>Sea Surface Temperature (4 um nighttime; 8-day average; 4 km resolution) from March 29 to April 6 2013 off northwest Mexico.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("dsst")</code></pre>


<h3>Format</h3>

<p>Formal class 'satin' [package &quot;satin&quot;] with 6 slots
</p>

<table>
<tr>
 <td style="text-align: left;">
  ..@ lon </td><td style="text-align: left;">   : num [1:360] -119 -119 -119 -119 -119 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ lat </td><td style="text-align: left;">   : num [1:360] 20 20.1 20.1 20.1 20.2 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ data </td><td style="text-align: left;">   : num [1:360, 1:360, 1] NA NA NA NA 18.2 ...</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ attribs :List of 6 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ title    </td><td style="text-align: left;">    : chr "HMODISA Level-3 Standard Mapped Image"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ longname </td><td style="text-align: left;">    : chr "4um Sea Surface Temperature"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ name     </td><td style="text-align: left;">    : chr "sst4"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ units    </td><td style="text-align: left;">    : chr "degree_C"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ temporal_range </td><td style="text-align: left;">   : chr "8-day"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ spatial_resolution </td><td style="text-align: left;"> : chr "4.64 km"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ period :List of 2 </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmStart </td><td style="text-align: left;"> : POSIXct[1:1], format: "2013-03-29 12:05:08"</td>
</tr>
<tr>
 <td style="text-align: left;">
  .. ..$ tmEnd </td><td style="text-align: left;">  : POSIXct[1:1], format: "2013-04-06 14:50:08"</td>
</tr>
<tr>
 <td style="text-align: left;">
  ..@ depth </td><td style="text-align: left;"> : num(0) 
  </td>
</tr>

</table>



<h3>Details</h3>

<p>Source data file (A20130892013096.L3m_8D_SST4_sst4_4km.nc) was downloaded from the link below, then imported with the <code><a href="#topic+read.nasaoc">read.nasaoc</a></code> function.  The selected area covers from 20 to 35 degrees of latitude North and from 119 to 104 degrees of longitude West.
</p>


<h3>Source</h3>

<p><a href="https://oceancolor.gsfc.nasa.gov/cgi/l3">https://oceancolor.gsfc.nasa.gov/cgi/l3</a>
</p>


<h3>References</h3>

<p><a href="https://oceancolor.gsfc.nasa.gov/docs/technical/">https://oceancolor.gsfc.nasa.gov/docs/technical/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dsst)
dsst
str(dsst)
plot(dsst)
</code></pre>

<hr>
<h2 id='extractPts'>
Extract ocean data values from a satin object
</h2><span id='topic+extractPts'></span>

<h3>Description</h3>

<p>Extract data values for pixels selected from an image of a satin object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractPts(X, points = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractPts_+3A_x">X</code></td>
<td>
<p>a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>.
</p>
</td></tr>
<tr><td><code id="extractPts_+3A_points">points</code></td>
<td>
<p> a data frame with point(s) longitude and latitude coordinates where to extract data values. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>If provided, <code>points</code> must have two columns with x and y coordinates.  When not specified, <code>points</code> can be  selected by clicking on the image.  Note that for selecting the points in this manner, the plot of the satin object has to be created using <code>colbar = FALSE</code>.
</p>


<h3>Value</h3>

<p>A data frame with at least 7 columns: For each point, a sequential <code>id</code> number; (<code>x, y</code>) coordinates, either specified via the <code>points</code> argument or selected by clicking on the image; (<code>lon</code> and <code>lat</code>) coordinates of pixels closer to the desired points; and for quality control purposes, the distance between them (<code>d</code>, km).  The remaining column(s) are the parameter values for every image in the satin object.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data, define coordinates and extract values
data(dsst)

plot(dsst)
coord &lt;- data.frame(x = seq(-130, -114, 2), y = seq(20, 36, 2))
values &lt;- extractPts(dsst, points = coord)
values

# if no points are given the user can select them by clicking on the image
if (interactive()){
plot(dsst, colbar = FALSE)
values2 &lt;- extractPts(dsst) # *** click on the image ***
values2
}
</code></pre>

<hr>
<h2 id='fmainPos'>
Calculate coordinates for title in plots
</h2><span id='topic+fmainPos'></span>

<h3>Description</h3>

<p>Internal function called by <code>plot.satin</code> and <code>quiver</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fmainPos(pu, main.pos)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fmainPos_+3A_pu">pu</code></td>
<td>

<p>Obtained by par(&quot;usr&quot;).
</p>
</td></tr>
<tr><td><code id="fmainPos_+3A_main.pos">main.pos</code></td>
<td>
<p> Desired position, one among &quot;topright&quot;, &quot;topleft&quot;, 
&quot;bottomright&quot;, &quot;bottomleft&quot;).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>

<hr>
<h2 id='imageScale'>Make a color scale to accompany an image or other plot</h2><span id='topic+imageScale'></span>

<h3>Description</h3>

<p>The <code>imageScale</code> function is wrapper for <code>imageScale</code> and accepts the same arguments.  It converts a vector of values (<code>z</code>) to a vector of color levels.  One must define the number of colors.  The limits of the color scale (&quot;zlim&quot;) or the break points for the color changes(&quot;breaks&quot;) can also be defined.  When breaks and zlim are defined, breaks overrides zlim. All arguments are similar to those in the <code>image</code> function.  Appearance is best when incorporated with <code><a href="graphics.html#topic+layout">layout</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imageScale(z, zlim, col = heat.colors(12), breaks, axis.pos = 1,
  add.axis = TRUE, xlim = NULL, ylim = NULL, log, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="imageScale_+3A_z">z</code></td>
<td>
<p>A vector or matrix of values.</p>
</td></tr>
<tr><td><code id="imageScale_+3A_zlim">zlim</code></td>
<td>
<p>Limits of the color scale values.</p>
</td></tr>
<tr><td><code id="imageScale_+3A_col">col</code></td>
<td>
<p>Vector of color values (default is 12 colors 
from the <code><a href="grDevices.html#topic+heat.colors">heat.colors</a></code> palette).</p>
</td></tr>
<tr><td><code id="imageScale_+3A_breaks">breaks</code></td>
<td>
<p>Break points for color changes. If breaks is specified then <code>zlim</code> 
is unused and the algorithm used follows <code><a href="base.html#topic+cut">cut</a></code>, so intervals are 
closed on the right and open on the left except for the lowest interval 
which is closed at both ends.</p>
</td></tr>
<tr><td><code id="imageScale_+3A_axis.pos">axis.pos</code></td>
<td>
<p>Position of the axis (1=bottom, 2=left, 3=top, 4=right) (default = 1).</p>
</td></tr>
<tr><td><code id="imageScale_+3A_add.axis">add.axis</code></td>
<td>
<p>Logical (TRUE/FALSE). Defines whether the axis is added (default: TRUE).</p>
</td></tr>
<tr><td><code id="imageScale_+3A_xlim">xlim</code></td>
<td>
<p>Limits for the x-axis.</p>
</td></tr>
<tr><td><code id="imageScale_+3A_ylim">ylim</code></td>
<td>
<p>Limits for the y-axis.</p>
</td></tr>
<tr><td><code id="imageScale_+3A_log">log</code></td>
<td>
<p>logical. If <code>TRUE</code>, z is log transformed (base 10).</p>
</td></tr>
<tr><td><code id="imageScale_+3A_...">...</code></td>
<td>
<p>Additional graphical parameters to pass to the <code><a href="graphics.html#topic+image">image</a></code> function.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Taylor, modified for log scale by Héctor Villalobos
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Make color palettes
pal.1=colorRampPalette(c("green4", "orange", "red", "white"), space="rgb", bias=0.5)
pal.2=colorRampPalette(c("blue", "cyan", "yellow", "red", "pink"), space="rgb")

# Make images with corresponding scales
op &lt;- par(no.readonly = TRUE)
layout(matrix(c(1,2,3,0,4,0), nrow=2, ncol=3), widths=c(4,4,1), heights=c(4,1))
#layout.show(4)
#1st image
breaks &lt;- seq(min(volcano), max(volcano),length.out=100)
par(mar=c(1,1,1,1))
image(seq(dim(volcano)[1]), seq(dim(volcano)[2]), volcano, 
col=pal.1(length(breaks)-1), breaks=breaks-1e-8, xaxt="n", yaxt="n", ylab="", xlab="")
#Add additional graphics
levs &lt;- pretty(range(volcano), 5)
contour(seq(dim(volcano)[1]), seq(dim(volcano)[2]), volcano, levels=levs, add=TRUE)
#Add scale
par(mar=c(3,1,0,1))
imageScale(volcano, col=pal.1(length(breaks)-1), breaks=breaks-1e-8,axis.pos=1)
abline(v=levs)
box()

#2nd image
breaks &lt;- c(0,100, 150, 170, 190, 200)
par(mar=c(1,1,1,1))
image(seq(dim(volcano)[1]), seq(dim(volcano)[2]), volcano, 
col=pal.2(length(breaks)-1), breaks=breaks-1e-8, xaxt="n", yaxt="n", ylab="", xlab="")
#Add additional graphics
levs=breaks
contour(seq(dim(volcano)[1]), seq(dim(volcano)[2]), volcano, levels=levs, add=TRUE)
#Add scale
par(mar=c(1,0,1,3))
imageScale(volcano, col=pal.2(length(breaks)-1), breaks=breaks-1e-8, 
axis.pos=4, add.axis=FALSE)
axis(4,at=breaks, las=2)
box()
abline(h=levs)
par(op)
</code></pre>

<hr>
<h2 id='isolines'> Interpolate isolines from ocean data </h2><span id='topic+isolines'></span>

<h3>Description</h3>

<p>User defined isolines are interpolated from ocean data stored in a satin object and returned as polylines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isolines(X, levels, period = 1, depth = 1, plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isolines_+3A_x">X</code></td>
<td>
<p>a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>. </p>
</td></tr>
<tr><td><code id="isolines_+3A_levels">levels</code></td>
<td>
<p>a vector of desired isolines in data units. </p>
</td></tr>
<tr><td><code id="isolines_+3A_period">period</code></td>
<td>
<p> an integer referring to the image number to process. </p>
</td></tr>
<tr><td><code id="isolines_+3A_depth">depth</code></td>
<td>
<p> an integer referring to a depth level. Only for Copernicus data that includes variables at different depths. </p>
</td></tr>
<tr><td><code id="isolines_+3A_plot">plot</code></td>
<td>
<p> logical, if <code>TRUE</code> a plot is produced (the default). </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Polyline coordinates of desired isolines are calculated via <code>contourLines</code> and <code>convCP</code> (from <span class="pkg">PBSMapping</span> package).  Perhaps only interesting with sea surface temperatures (isotherms).  For smoother isolines, the function <code><a href="#topic+pixelate">pixelate</a></code> can be used to spatialy re-scale the data.  In order to use this function with Copernicus data returned from <code><a href="#topic+read.cmems">read.cmems</a></code>, the appropriate indexing should be previously done.
</p>


<h3>Value</h3>

<p>A list with two data frames of class <code>"PolySet"</code> and <code>"PolyData"</code>. See <code>help(PolySet)</code> and <code>help(PolyData)</code> for a complete description.
</p>


<h3>Author(s)</h3>

<p> Héctor Villalobos, from code in examples of <span class="pkg">PBSMapping</span> package</p>


<h3>References</h3>

<p>Schnute, J. T., Boers, N. M., Haigh, R. and Couture-Beil, A. 2011 PBS Mapping 2.62: user's guide revised from Canadian Technical Report of Fisheries and Aquatic Sciences 2549:vi + 112 p. Last updated Feb 29, 2011.
</p>


<h3>See Also</h3>

 <p><code><a href="grDevices.html#topic+contourLines">contourLines</a></code>, <code><a href="PBSmapping.html#topic+convCP">convCP</a></code>, <code><a href="PBSmapping.html#topic+PolySet">PolySet</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>library(PBSmapping)
data(dsst)

# spatial re-scaling of the sst data for smoother isotherms
sst &lt;- pixelate(dsst, extent = 0.2) 
isotherms &lt;- isolines(sst, levels = c(13, 17, 21))
plot(dsst, colbar = FALSE)
addLines(isotherms$PolySet, col = "black", lwd = 1.5)
</code></pre>

<hr>
<h2 id='pixelate'> Spatial re-scaling of ocean data </h2><span id='topic+pixelate'></span>

<h3>Description</h3>

<p>This function down-scales ocean data by quadrants of user defined size (in degrees) according to a given function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pixelate(X, extent = 0.25, FUN = mean)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pixelate_+3A_x">X</code></td>
<td>
<p> a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>. </p>
</td></tr>
<tr><td><code id="pixelate_+3A_extent">extent</code></td>
<td>
<p> size in degrees of the squared quadrant for the new spatial scale.</p>
</td></tr>
<tr><td><code id="pixelate_+3A_fun">FUN</code></td>
<td>
<p> function to be applied for obtaining the quadrants' values, defaults to <code>mean</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main interest of this function is to obtain smooth isolines for ocean data (e.g. isotherms).  In order to use this function with Copernicus data returned from <code><a href="#topic+read.cmems">read.cmems</a></code>, the appropriate indexing should be done.
</p>


<h3>Value</h3>

<p>An object of class <code>"satin"</code>. See <code><a href="#topic+satin-class">satin-class</a></code> for details.
</p>


<h3>Author(s)</h3>

<p> Héctor Villalobos </p>


<h3>See Also</h3>

 <p><code><a href="#topic+isolines">isolines</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'># load and plot sample SST data 
data(dsst)
plot(dsst)

# change spatial resolution to 0.5 degrees
sst0.5 &lt;- pixelate(dsst, extent = 0.5) 
plot(sst0.5)
</code></pre>

<hr>
<h2 id='plot.satin'>
Visualise ocean data
</h2><span id='topic+plot.satin'></span><span id='topic+plot+2Csatin+2Cmissing-method'></span>

<h3>Description</h3>

<p>Visual representation of ocean data from satellite images (MODIS, AVHRR, etc.) or derived from models (ocean productivity; CMEMS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'satin'
plot(x, period = 1, depth = 1, xlim = NULL, ylim = NULL, zlim = NULL, 
           map = NULL, map.col = "grey", map.outline = "black", scheme = "default",
           col.sep = 0.1, colbar = TRUE, main = NULL, main.pos = "topright",
           log = FALSE, units = NULL,  xaxt = "s", yaxt = "s", atx = NULL, aty = NULL,
		   restore.par = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.satin_+3A_x">x</code></td>
<td>
<p> a satin object as returned by  <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_period">period</code></td>
<td>
<p> an integer referring to the image number to plot. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_depth">depth</code></td>
<td>
<p> an integer referring to a depth level. Only for Copernicus data that includes variables at different depths. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_xlim">xlim</code></td>
<td>
<p> minimum and maximum longitude values for the map. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_ylim">ylim</code></td>
<td>
<p> minimum and maximum latitude values for the map. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_zlim">zlim</code></td>
<td>
<p> minimum and maximum ocean data  values. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_map">map</code></td>
<td>
<p> a user defined map of class &quot;SpatialPolygons&quot;. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_map.col">map.col</code></td>
<td>
<p> color for the map. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_map.outline">map.outline</code></td>
<td>
<p> color for the map outline. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_scheme">scheme</code></td>
<td>
<p> color scheme for the ocean data, either: &quot;default&quot; or a vector of valid color names.</p>
</td></tr>
<tr><td><code id="plot.satin_+3A_col.sep">col.sep</code></td>
<td>
<p> separation between colors in data units. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_colbar">colbar</code></td>
<td>
<p> logical. If <code>TRUE</code> a color bar is added to the map.  </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_main">main</code></td>
<td>
<p> title for the map, defaults to the corresponding selected image <code>period$tmStart</code> in <code>x</code>. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_main.pos">main.pos</code></td>
<td>
<p> position for the title: &quot;topright&quot;, &quot;topleft&quot;, &quot;bottomright&quot; or &quot;bottomleft&quot;.  </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_log">log</code></td>
<td>
<p> logical. If <code>TRUE</code>, the ocean variable is log transformed (base 10). This is useful for chlorophyll concentration data.</p>
</td></tr>
<tr><td><code id="plot.satin_+3A_units">units</code></td>
<td>
<p> color bar label, defaults to <code>units</code> in <code>x</code>. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_xaxt">xaxt</code>, <code id="plot.satin_+3A_yaxt">yaxt</code></td>
<td>
<p> &quot;n&quot; to supress axis. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_atx">atx</code>, <code id="plot.satin_+3A_aty">aty</code></td>
<td>
<p> specify tick-mark locations for fine tuning axes annotations. </p>
</td></tr>
<tr><td><code id="plot.satin_+3A_restore.par">restore.par</code></td>
<td>
<p> logical. If <code>TRUE</code> (the default), the graphical device is restored to its original state. </p>
</td></tr>  
<tr><td><code id="plot.satin_+3A_...">...</code></td>
<td>
<p> further arguments to pass to <code><a href="base.html#topic+plot">plot</a></code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The only mandatory argument for this function to produce a map is an object of class &quot;satin&quot; (<code>x</code> in this case).  All the other arguments are optional and can be used to customize the plot.  For chlorophyll concentration data, when <code>log = TRUE</code>, the color scale is fixed to a maximum value of 20, which implies that values above it are set to this maximum before applying logarithms. Using <code>restore.par = FALSE</code> to annotate plot, e.g. add isolines.
</p>


<h3>Value</h3>

<p>A plot including a map, of the corresponding parameter is produced.
</p>


<h3>Author(s)</h3>

<p> Héctor Villalobos </p>


<h3>See Also</h3>

<p><code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, and <code><a href="#topic+read.cmems">read.cmems</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># SST data (Aqua Modis)
library(sp)
data(dsst, dmap) #load sample data and map

# default plot
plot(dsst)

# adding a custom map
plot(dsst, map = dmap)

# Chl-a concentration data (Aqua Modis) in actual units and in logarithmic scale
data(dchl)
plot(dchl, map = dmap, xlim = c(-120, -105), ylim = c(20, 35))
dev.new()
plot(dchl, map = dmap, xlim = c(-120, -105), ylim = c(20, 35), log = TRUE)  

# Copernicus data
data(dcmems)
plot(dcmems$thetao, map = dmap, period = 2, depth = 5)
</code></pre>

<hr>
<h2 id='quiver'>
Vectors of ocean currents velocities 
</h2><span id='topic+quiver'></span>

<h3>Description</h3>

<p>Plot vectors of ocean current velocities of varying size or color for Copernicus data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quiver(u, v, period = 1, depth = 1, xlim = NULL, ylim = NULL, scale = 1, 
       length = 0.05, colarrow = NULL, scheme = "default", ra.pos = NULL, 
       ra.speed = NULL, map = NULL, map.col = "grey", map.outline = "black", 
       colbar = FALSE, main = NULL, main.pos = "topright", add2map = FALSE, ...) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quiver_+3A_u">u</code></td>
<td>
<p> a satin object with eastward ocean current velocities (in m/s). </p>
</td></tr>
<tr><td><code id="quiver_+3A_v">v</code></td>
<td>
<p> a satin object with northward ocean current velocities (in m/s). </p>
</td></tr>
<tr><td><code id="quiver_+3A_period">period</code></td>
<td>
<p> an integer referring to the image number to plot. </p>
</td></tr>
<tr><td><code id="quiver_+3A_depth">depth</code></td>
<td>
<p> an integer referring to a depth level. </p>
</td></tr>
<tr><td><code id="quiver_+3A_xlim">xlim</code></td>
<td>
<p> minimum and maximum longitude values for the map. </p>
</td></tr>
<tr><td><code id="quiver_+3A_ylim">ylim</code></td>
<td>
<p> minimum and maximum latitude values for the map. </p>
</td></tr>
<tr><td><code id="quiver_+3A_scale">scale</code></td>
<td>
<p> this argument controls the arrow length. </p>
</td></tr>
<tr><td><code id="quiver_+3A_length">length</code></td>
<td>
<p> this value controls the size of the arrow head. </p>
</td></tr>
<tr><td><code id="quiver_+3A_colarrow">colarrow</code></td>
<td>
<p> color(s) for the arrows; see details. </p>
</td></tr>
<tr><td><code id="quiver_+3A_scheme">scheme</code></td>
<td>
<p> color scheme for the arrows. Either: &quot;default&quot; or a vector of valid color names.</p>
</td></tr>
<tr><td><code id="quiver_+3A_ra.pos">ra.pos</code></td>
<td>
<p> position (lon, lat) for a reference arrow. </p>
</td></tr>
<tr><td><code id="quiver_+3A_ra.speed">ra.speed</code></td>
<td>
<p> speed (in m/s) of the reference arrow. The mean is used by default.</p>
</td></tr>
<tr><td><code id="quiver_+3A_map">map</code></td>
<td>
<p> a user defined map of class &quot;SpatialPolygons&quot;. </p>
</td></tr>
<tr><td><code id="quiver_+3A_map.col">map.col</code></td>
<td>
<p> color for the map. </p>
</td></tr>
<tr><td><code id="quiver_+3A_map.outline">map.outline</code></td>
<td>
<p> color for the map outline. </p>
</td></tr>
<tr><td><code id="quiver_+3A_colbar">colbar</code></td>
<td>
<p> logical. If <code>TRUE</code> a color bar is added to the plot.  </p>
</td></tr>
<tr><td><code id="quiver_+3A_main">main</code></td>
<td>
<p> title for the map, defaults to the corresponding selected image <code>period</code>. </p>
</td></tr>
<tr><td><code id="quiver_+3A_main.pos">main.pos</code></td>
<td>
<p> position for the title: &quot;topright&quot;, &quot;topleft&quot;, &quot;bottomright&quot; or &quot;bottomleft&quot;.  </p>
</td></tr>
<tr><td><code id="quiver_+3A_add2map">add2map</code></td>
<td>
<p> a logical value. If <code>FALSE</code> an entire new plot is created. If <code>TRUE</code> ocean current velocity arrows are added to an existing plot. </p>
</td></tr>
<tr><td><code id="quiver_+3A_...">...</code></td>
<td>
<p> further arguments to pass to <code>arrows</code>. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Usage and behavior of this function closely resembles that of <code>plot.satin</code>.  It differs in that two different satin objects are needed, one for each component of ocean current velocities.  Also, the ocean current vectors can be overlayed to an existing plot of another variable, as the temperature, for instance.
</p>


<h3>Value</h3>

<p>A map of the ocean current velocities is produced.
</p>


<h3>Author(s)</h3>

<p> Héctor Villalobos </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
# import copernicus data with potential temperatures and ocean current velocities
oc &lt;- read.cmems("global-reanalysis-phy-001-030-daily_1560792767602_GC_2013-14.nc")

# Default plot
quiver(u = oc$uo, v = oc$vo)

# Using default colors for the arrows, color bar and reference arrow
quiver(u = oc$uo, v = oc$vo, colarrow = TRUE, colbar = TRUE,
       ra.pos = c(-108, 30))

# Adding custom map and colors, and plotting another period and depth level
quiver(u = oc$uo, v = oc$vo, image = 4, depth = 10, colbar = TRUE,
       colarrow = TRUE, scheme = c("mediumblue", "lightcyan", "red"), 
       map = dmap, ra.pos = c(-108, 30), ra.speed = 0.2)


# Overlay arrows to an existing plot of the potential temperature
plot(oc$thetao, map = dmap, xlim = c(-112, -108), ylim = c(24, 28), 
     colbar = FALSE)
quiver(u = oc$uo, v = oc$vo, colarrow = TRUE, ra.pos = c(-108.5, 27), 
       ra.speed = 0.15, main = "", length=0.02, scale = 0.7, add2map = TRUE)	   
}
</code></pre>

<hr>
<h2 id='read.cmems'>
Read ocean products data from CMEMS
</h2><span id='topic+read.cmems'></span>

<h3>Description</h3>

<p>Read data from netCDF files downloaded from Copernicus Marine Service (CMEMS).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.cmems(nc)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.cmems_+3A_nc">nc</code></td>
<td>
<p> name of the netCDF file to be read.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function can read data from netCDF files downloaded from CMEMS web page (<a href="https://marine.copernicus.eu/">https://marine.copernicus.eu/</a>).  It has been tested with Global Ocean Physical Reanalysis, and Global Ocean Biogeochemistry Hindcast databases.  When downloading Copernicus data files, the user can select one or several variables (see references below), depth levels, daily or monthly means, time and spatial coverage.  This makes every Copernicus netCDF file unique.  The <code>read.cmems</code> function attempts to read all the variables and depth levels at once.  When only one variable is included in the file, a <code>"satin"</code> object with one additional dimension in the data array to accommodate the different depth levels, is produced.  On the other hand, when several variables are present, the function returns a named list, with every element being a <code>"satin"</code> object corresponding to each variable. 
</p>


<h3>Value</h3>

<p>A named list, with elements corresponding to each variable included in the netCDF file.  Each list element (or when only one variable is present) is an object of class <code>"satin"</code>. See <code><a href="#topic+satin-class">satin-class</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>References</h3>

<p><a href="https://resources.marine.copernicus.eu/?option=com_csw&amp;task=results">https://resources.marine.copernicus.eu/?option=com_csw&amp;task=results</a>
</p>
<p>Fernandez, E. and Lellouche, J. M. 2018 Product User Manual for the Global Ocean Physical Reanalysis product, issue 1.1. EU Copernicus Marine Service.
</p>
<p>Garric, G. and Parent, L. 2018 Product User Manual for the Global Ocean Reanalysis Products, issue 3.4. EU Copernicus Marine Service.
</p>
<p>Perruche, C. 2019 Product User Manual for the Global Ocean Biogeochemistry Hindcast, issue 1.1. EU Copernicus Marine Service.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.nasaoc">read.nasaoc</a></code> for reading NASA's oceancolor web page data,  <code><a href="#topic+read.ghrsst">read.ghrsst</a></code> for JPL MUR SST data, and <code><a href="#topic+read.osunpp">read.osunpp</a></code> for reading ocean productivity data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
 # read Copernicus netcdf file with one variable
 cmems &lt;- read.cmems("global-reanalysis-phy-001-030-monthly_1553098099635.nc")
 cmems
 str(cmems)
 
 # plotting the first period
 plot(cmems) 

 # plotting the second period 
 plot(cmems, period = 2)

 # read Copernicus netCDF file with several variables and depth levels
 cmems2 &lt;- read.cmems("global-reanalysis-phy-001-030-monthly_1553051256930.nc")      
 cmems2 # it is a list
 
 # readed variables
 names(cmems2)
 
 # example plots for potential temperature
 thetao &lt;- cmems2$thetao
 thetao
 thetao$depth # depth levels
 plot(thetao) # potential temperature at first depth level (0.49 m) and first month 
 plot(thetao, period = 2, depth = 5) # for fifth depth level (5.078 m), second month
}
</code></pre>

<hr>
<h2 id='read.ghrsst'>
Read sea surface temperature data from JPL Multi-scale Ultra-high Resolution (MUR) SST Project
</h2><span id='topic+read.ghrsst'></span>

<h3>Description</h3>

<p>Read, for a user defined area, SST data from netCDF files downloaded from JPL's Physical Oceanography Distributed Active Archive Center (podaac) web page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.ghrsst(nc, lons, lats)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.ghrsst_+3A_nc">nc</code></td>
<td>
<p> name of the netCDF file(s) to be read.</p>
</td></tr>
<tr><td><code id="read.ghrsst_+3A_lons">lons</code></td>
<td>
<p> a vector with western- and eastern-most longitudes. </p>
</td></tr>
<tr><td><code id="read.ghrsst_+3A_lats">lats</code></td>
<td>
<p> a vector with southern- and northern-most  latitudes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can read SST data from one or multiple netCDF files downloaded from Caltech Jet Propulsion Laboratory web page (<a href="https://podaac-opendap.jpl.nasa.gov/opendap/allData/ghrsst/data/GDS2/L4/GLOB/JPL/MUR/v4.1/">https://podaac-opendap.jpl.nasa.gov/opendap/allData/ghrsst/data/GDS2/L4/GLOB/JPL/MUR/v4.1/</a>).  The user must specify the minimum and maximum latitude and longitude limits within the interval (-90,  90) and (-180, 180) respectively. 
</p>


<h3>Value</h3>

<p>An object of class <code>"satin"</code>. See <code><a href="#topic+satin-class">satin-class</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>References</h3>

<p><a href="https://www.ghrsst.org/">https://www.ghrsst.org/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.nasaoc">read.nasaoc</a></code> for reading NASA's oceancolor web page data, <code><a href="#topic+read.osunpp">read.osunpp</a></code> for reading ocean productivity data, and <code><a href="#topic+read.cmems">read.cmems</a></code> for data from Copernicus Marine Service.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
 # read a single file, look at its structure and plot
 sst1km &lt;- read.nasaoc("20130101090000-JPL-L4_GHRSST-SSTfnd-MUR-GLOB-v02.0-fv04.1.nc", 
                        lats=c(20, 30), lons=c(-130, -105))
 sst1km
 str(sst1km)
 plot(sst1km)
 
 # read several files residing in the working directory 
 files &lt;- list.files(pattern = glob2rx("*.nc"))
 lats &lt;- c(20, 30)
 lons &lt;- c(-130, -105)
 mSST &lt;- read.ghrsst(files, lats, lons)      

 # plotting the first processed file
 plot(mSST) 

 # plotting the second processed file
 plot(mSST, period = 2)
}
</code></pre>

<hr>
<h2 id='read.nasaoc'>
Read ocean data from NASA's Oceancolor web files
</h2><span id='topic+read.nasaoc'></span>

<h3>Description</h3>

<p>Read, for a user defined area, data from netCDF files downloaded from NASA's Oceancolor web page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.nasaoc(nc, lons, lats)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.nasaoc_+3A_nc">nc</code></td>
<td>
<p> name of the netCDF file(s) to be read.</p>
</td></tr>
<tr><td><code id="read.nasaoc_+3A_lons">lons</code></td>
<td>
<p> a vector with western- and eastern-most longitudes. </p>
</td></tr>
<tr><td><code id="read.nasaoc_+3A_lats">lats</code></td>
<td>
<p> a vector with southern- and northern-most  latitudes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can read data from one or multiple netCDF files downloaded from NASA's oceancolor web page (<a href="https://oceancolor.gsfc.nasa.gov/l3/">https://oceancolor.gsfc.nasa.gov/l3/</a>).  It has been tested mainly with sea surface temperature and chlorophyll concentration data from MODIS-Aqua and SeaWiFS sensors.  It also works with Pathfinder AVHRR files v 5.2 and 5.3 (<a href="https://www.ncei.noaa.gov/products/avhrr-pathfinder-sst">https://www.ncei.noaa.gov/products/avhrr-pathfinder-sst</a>).  The user must specify the minimum and maximum longitude and latitude limits within the interval (-180, 180) and (-90,  90) respectively. 
</p>


<h3>Value</h3>

<p>An object of class <code>"satin"</code>. See <code><a href="#topic+satin-class">satin-class</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.ghrsst">read.ghrsst</a></code> for JPL MUR SST data, <code><a href="#topic+read.osunpp">read.osunpp</a></code> for reading ocean productivity data, and <code><a href="#topic+read.cmems">read.cmems</a></code> for data from Copernicus Marine Service.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
 # read a single file, look at it and plot
 sst &lt;- read.nasaoc("A20130892013096.L3m_8D_SST4_sst4_4km.nc", 
                        lats=c(20, 30), lons=c(-130, -105))
 sst
 str(sst)
 plot(sst)

 # read several files residing in the working directory 
 files &lt;- list.files(pattern = glob2rx("*.nc"))
 lats &lt;- c(20, 30)
 lons &lt;- c(-130, -105)
 mSST &lt;- read.nasaoc(files, lats, lons)      

 # plotting the first processed file
 plot(mSST) 

 # plotting the second processed file
 plot(mSST, period = 2)
}
</code></pre>

<hr>
<h2 id='read.osunpp'>
Read ocean productivity data from Oregon State University files
</h2><span id='topic+read.osunpp'></span>

<h3>Description</h3>

<p>Read, for a user defined area, net primary production data from hdf files downloaded from OSU's Ocean Productivity home page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.osunpp(h5, lons, lats)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.osunpp_+3A_h5">h5</code></td>
<td>
<p> name of the hdf file(s) to be read.</p>
</td></tr>
<tr><td><code id="read.osunpp_+3A_lons">lons</code></td>
<td>
<p> a vector with western- and eastern-most longitudes. </p>
</td></tr>
<tr><td><code id="read.osunpp_+3A_lats">lats</code></td>
<td>
<p> a vector with southern- and northern-most  latitudes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function reads Oregon State University ocean productivity data files (<a href="http://sites.science.oregonstate.edu/ocean.productivity/standard.product.php">http://sites.science.oregonstate.edu/ocean.productivity/standard.product.php</a>).  However, downloaded files should be first converted from hdf version 4 to version 5 with h4h5tools (<a href="https://portal.hdfgroup.org/display/support/Download+h4h5tools">https://portal.hdfgroup.org/display/support/Download+h4h5tools</a>).  The user must specify the minimum and maximum latitude and longitude limits within the interval (-90,  90) and (-180, 180) respectively.  
</p>


<h3>Value</h3>

<p>An object of class <code>"satin"</code>. See <code><a href="#topic+satin-class">satin-class</a></code> for details.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read.nasaoc">read.nasaoc</a></code> for reading NASA's oceancolor web page data, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code> for JPL MUR SST data, and <code><a href="#topic+read.cmems">read.cmems</a></code> for data from Copernicus Marine Service.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
 # read a single file, look at its structure and plot
 npp &lt;- read.osunpp("vgpm.2013089.h5", 
                        lats=c(20, 30), lons=c(-130, -105))
 npp
 str(npp)
 plot(npp)

 # read several files residing in the working directory 
 files &lt;- list.files(pattern = glob2rx("*.h5"))
 lats &lt;- c(20, 30)
 lons &lt;- c(-130, -105)
 mNPP &lt;- read.osunpp(files, lats, lons)      

 # plotting the first processed file
 plot(mNPP) 

 # plotting the second processed file
 plot(mNPP, period = 2)
}
</code></pre>

<hr>
<h2 id='satin-class'>Class &quot;satin&quot;</h2><span id='topic+satin-class'></span><span id='topic+satin'></span><span id='topic+print.satin'></span><span id='topic+show+2Csatin-method'></span>

<h3>Description</h3>

<p>class for ocean data derived from satellites, imported from netCDF files.
</p>


<h3>Objects from the Class</h3>

<p>Objects of class <code>"satin"</code> are created by importing functions: <code>read.nasaoc</code>, <code>read.ghrsst</code>, <code>read.cmems</code>, and <code>read.osunpp</code>.  They can also be created, though not recommended, by direct calls to <code>satin</code>.
</p>


<h3>Slots</h3>


<dl>
<dt>lon</dt><dd><p>Object of class <code>"numeric"</code>; vector of longitudes of the area of interest (aoi).</p>
</dd>
<dt>lat</dt><dd><p>Object of class <code>"numeric"</code>; vector of latitudes of the aoi.</p>
</dd>
<dt>data</dt><dd><p>Object of class <code>"array"</code>; three or four dimensions array of ocean data corresponding to the lengths of <code>lat</code>, <code>lon</code>, <code>period$tmStart</code>, and <code>depth</code> vectors. The fourth dimension associated to depth levels will only be present in <code>"satin"</code> objects derived from Copernicus data files.</p>
</dd>
<dt>attribs</dt><dd><p>Object of class <code>"list"</code>; attributes of the data stored in the netCDF file:   <code>title</code>: title attribute from netCDF file; <code>longname</code>: long name of ocean data variable; <code>name</code>: short name of ocean data variable; <code>units</code>: ocean data variable measurement units; <code>temporal_range</code>: averaging period length, i.e. daily, monthly, etc.; <code>spatial_resolution</code>: spatial resolution of the ocean data variable.</p>
</dd>
<dt>period</dt><dd><p>Object of class <code>"list"</code>; a vector with start time (<code>tmStart</code>) and a vector with end time (<code>tmEnd</code>) of the averaging period of the data. Both vectors are of class <code>"POSIXct"</code>.</p>
</dd>
<dt>depth</dt><dd><p>Object of class <code>"numeric"</code>; vector of depth levels in the data. Only meaningful for <code>"satin"</code> objects derived from Copernicus data files.</p>
</dd>
</dl>



<h3>Methods</h3>


<dl>
<dt>plot</dt><dd><p><code>signature(x = "satin", y = "missing")</code>: plot method for <code>"satin"</code> objects. See details in <code>plot.satin</code></p>
</dd>
<dt>show</dt><dd><p><code>signature(object = "satin")</code>: display a summary of the object. See example below</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>; <code><a href="#topic+read.osunpp">read.osunpp</a></code>; <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>; and <code><a href="#topic+read.cmems">read.cmems</a></code> for functions producing <code>"satin"</code> objects, and <code>plot.satin</code> for a complete description of plotting arguments.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(dsst)
class(dsst)
dsst
str(dsst)
</code></pre>

<hr>
<h2 id='satinDataframe'>
Reshape a satin object into a data frame
</h2><span id='topic+satinDataframe'></span>

<h3>Description</h3>

<p>A satin object is reshaped as a data frame with longitude, latitude and remote sensed data column(s).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satinDataframe(X, reverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satinDataframe_+3A_x">X</code></td>
<td>
<p> a satin object as returned by  <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, <code><a href="#topic+read.cmems">read.cmems</a></code>, or a data frame produced with this function. </p>
</td></tr>
<tr><td><code id="satinDataframe_+3A_reverse">reverse</code></td>
<td>
<p>logical, <code>TRUE</code> is used to create a satin object from a data frame previously created with this function (see details).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is  mainly an utility function called by <code><a href="#topic+crop">crop</a></code>, <code><a href="#topic+extractPts">extractPts</a></code>, and <code><a href="#topic+pixelate">pixelate</a></code> functions.  However, it may be useful when the user wants to arrange the ocean data variables stored in a satin object as a data frame, with rows representing pixels whose longitude and latitude coordinates are in the  first two columns and their data values in the remaining column(s).  The attributes describing the data (name, units, period, etc.) are preserved.  Specifying <code>reverse = TRUE</code> reverses the operation.
</p>


<h3>Value</h3>

<p>When <code>reverse = FALSE</code>, a data frame with at least three columns: &quot;x&quot;, &quot;y&quot; for longitude and latitude coordinates, and data for the variable(s).  When <code>reverse = TRUE</code> a satin object as produced.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load sample SST data
data(dsst)

# reshape into a data frame
X &lt;- satinDataframe(dsst)
head(X)

# reverse the operation
Y &lt;- satinDataframe(X, reverse = TRUE)
Y
plot(Y)
</code></pre>

<hr>
<h2 id='satinMean'>
Averaging ocean data by time period
</h2><span id='topic+satinMean'></span>

<h3>Description</h3>

<p>This function allows to average ocean data by a selected time period.  For example, from daily data, the user may want to obtain weekly, monthly, quarterly or even yearly averages. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satinMean(X, by = "%m", depth = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satinMean_+3A_x">X</code></td>
<td>

<p>a satin object as returned by <code><a href="#topic+read.nasaoc">read.nasaoc</a></code>, <code><a href="#topic+read.ghrsst">read.ghrsst</a></code>, <code><a href="#topic+read.osunpp">read.osunpp</a></code>, or <code><a href="#topic+read.cmems">read.cmems</a></code>. 
</p>
</td></tr>
<tr><td><code id="satinMean_+3A_by">by</code></td>
<td>

<p>a character string specifying the averaging time period, see details. 
</p>
</td></tr>
<tr><td><code id="satinMean_+3A_depth">depth</code></td>
<td>

<p>an integer referring to a given  depth level (defaults to 1). Only meaningful for Copernicus data that includes variables at different depths.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Accepted strings in <code>by</code> follow the notation of conversion specifications described in <code><a href="base.html#topic+strptime">strptime</a></code>.  Currently implemented:  <code>"%Y"</code>, <code>"%m"</code>, <code>"%Y-%m"</code>, <code>"%j"</code>, <code>"%qtr"</code>, <code>"%Y-%qtr"</code>, <code>"%sem"</code>, <code>"%Y-%sem"</code>, <code>"%U"</code>, <code>"%V"</code>, <code>"%W"</code>, <code>"%Y-%U"</code>, <code>"%Y-%V"</code>,  <code>"%Y-%W"</code>.  This includes two non-standard strings and their combinations with year: <code>"%qtr"</code>, and <code>"%sem"</code>, for quarter and semester, respectively, which are passed to lubridate's functions of the same names.  This function is meant to be used in combination with <code><a href="#topic+anomaly">anomaly</a></code> to obtain anomalies with respect to an average period.
</p>


<h3>Value</h3>

<p>An object of  class <code>"satin"</code> (see <code><a href="#topic+satin-class">satin-class</a></code> for details) where the third dimension in the data array accomodates averages by time period.  An extra element (<code>labels</code>) is included in the slot <code>attribs</code> to identify the time period used for the averages.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos and Eduardo González-Rodríguez
</p>


<h3>See Also</h3>

<p><code><a href="#topic+anomaly">anomaly</a></code> for calculating anomalies of ocean data, and <code><a href="#topic+climatology">climatology</a></code> for climatologies.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
sst.ym &lt;- satinMean(sst, by = "%Y-%m") # sst is a satin object with 240 weekly
                                         # images, totalling five years of data.

sst.ym # this will have 60 time periods, one for every month and year.

sst.m &lt;- satinMean(sst, by = "%m") # this will produce 12 monthly periods
}
</code></pre>

<hr>
<h2 id='satinPalette'>
Define custom color palettes for echograms
</h2><span id='topic+satinPalette'></span>

<h3>Description</h3>

<p>This function allows to design and visualise color palettes to be used in ocean data plots. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>satinPalette(zmin, zmax, col.sep = 0.1, scheme = "default", visu = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="satinPalette_+3A_zmin">zmin</code></td>
<td>
<p>lower limit in data units.</p>
</td></tr>
<tr><td><code id="satinPalette_+3A_zmax">zmax</code></td>
<td>
<p>upper limit in data units.</p>
</td></tr>
<tr><td><code id="satinPalette_+3A_col.sep">col.sep</code></td>
<td>
<p>separation between colors in data units.</p>
</td></tr>
<tr><td><code id="satinPalette_+3A_scheme">scheme</code></td>
<td>
<p>color scheme, either: &quot;default&quot; or a vector of valid color names.</p>
</td></tr>
<tr><td><code id="satinPalette_+3A_visu">visu</code></td>
<td>
<p>logical. If <code>TRUE</code>, a visual representation of the palette is displayed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is mainly intended to be called by <code>plot.satin</code>, however it is possible to use it directly in order to have a first impression of a custom color palette.</p>


<h3>Value</h3>

<p>A list with two elements
</p>
<table>
<tr><td><code>palette</code></td>
<td>
<p>a vector of colors.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>a vector of color breaks.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>See Also</h3>

<p><code>plot.satin</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>satinPalette(zmin = 10, zmax = 35, visu = TRUE)
satinPalette(zmin = 10, zmax = 35, col.sep = 0.2, scheme = c("white", "blue", "black"), visu = TRUE)
</code></pre>

<hr>
<h2 id='velocity'>
Ocean currents velocities 
</h2><span id='topic+velocity'></span>

<h3>Description</h3>

<p>Calculate ocean current speed and direction from eastward and northward components (Copernicus data).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>velocity(u, v, depth = 1) 
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="velocity_+3A_u">u</code></td>
<td>
<p> a satin object with eastward ocean current velocities (in m/s). </p>
</td></tr>
<tr><td><code id="velocity_+3A_v">v</code></td>
<td>
<p> a satin object with northward ocean current velocities (in m/s). </p>
</td></tr>
<tr><td><code id="velocity_+3A_depth">depth</code></td>
<td>
<p> an integer referring to a depth level. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function calculates the resulting velocity vectors in the same way as the <code>"quiver"</code> function. In addition, these values are returned togheter with their direction in degrees.
</p>


<h3>Value</h3>

<p>A list with 2 elements, &ldquo;speed&rdquo; and &ldquo;rhumb&rdquo;, both of class <code>"satin"</code>. The former contains the resulting velocity vectors as drawn by <code>"quiver"</code>, while the second their direction in degrees.
</p>


<h3>Author(s)</h3>

<p> Héctor Villalobos </p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
# import copernicus data with potential temperatures and ocean current velocities
oc &lt;- read.cmems("global-reanalysis-phy-001-030-daily_1560792767602_GC_2013-14.nc")

vel &lt;- velocity(u = oc$uo, v = oc$vo)

# Plots overlaying velocity vectors 
plot(vel$speed)
quiver(u = oc$uo, v = oc$vo, main = "", length=0.02, scale = 0.7, add2map = TRUE)	   

plot(vel$rhumb, col.sep = 90, scheme = c('#d7301f', '#fc8d59','#fdcc8a', '#fef0d9'))
quiver(u = oc$uo, v = oc$vo, main = "", add2map = TRUE)
}
</code></pre>

<hr>
<h2 id='verticalProfiles'>
CTD-like vertical profiles for Copernicus variables
</h2><span id='topic+verticalProfiles'></span>

<h3>Description</h3>

<p>Extract ocean data available at different depth levels (Copernicus data) and plot CTD-like vertical profiles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>verticalProfiles(X, point = NULL, xlim = NULL, ylim = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="verticalProfiles_+3A_x">X</code></td>
<td>
<p> a satin object with Copernicus data registered at different depths (i.e. potential temperature (thetao), salinity (so), etc.).</p>
</td></tr>
<tr><td><code id="verticalProfiles_+3A_point">point</code></td>
<td>
<p>a data frame with point longitude and latitude coordinates where to extract data values.</p>
</td></tr> 
<tr><td><code id="verticalProfiles_+3A_xlim">xlim</code></td>
<td>
<p> limits for data variable. </p>
</td></tr>
<tr><td><code id="verticalProfiles_+3A_ylim">ylim</code></td>
<td>
<p> vertical depth limits. </p>
</td></tr>  
</table>


<h3>Details</h3>

<p>Selected Copernicus data should be available at several depths, otherwise is meaningless.  Also, if more than one point is selected, only the first will be processed.
</p>


<h3>Author(s)</h3>

<p>Héctor Villalobos
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load sample Copernicus data
data(dcmems)
# available variables
names(dcmems)

# plot potential temperature
plot(dcmems$thetao)

# define point for extracting and plotting vertical profile
pt &lt;- data.frame(lon = -108.5, lat = 23.33)
vp &lt;- verticalProfiles(dcmems$thetao, point = pt)
# inspect extracted data
vp
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
