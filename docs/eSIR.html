<!DOCTYPE html><html><head><title>Help for package eSIR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {eSIR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#confirmed'><p>Confirmed COVID-19 cases</p></a></li>
<li><a href='#death'><p>Confirmed COVID-19 deaths</p></a></li>
<li><a href='#eSAIR'><p>Extended state-space SIR with a subset of the population showing antibody positivity</p></a></li>
<li><a href='#qh.eSIR'><p>Extended state-space SIR with quarantine</p></a></li>
<li><a href='#recovered'><p>Confirmed COVID-19 recovered</p></a></li>
<li><a href='#tvt.eSIR'><p>Fit extended state-space SIR model with time-varying transmission rates</p></a></li>
<li><a href='#tvt.eSIR2'><p>Fit extended state-space SIR model with time-varying transmission rates</p></a></li>
<li><a href='#USA_state_N'><p>Population of US states</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Extended State-Space SIR Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of extended state-space SIR models developed by
    Song Lab at UM school of Public Health. There are several functions available
    by 1) including a time-varying transmission modifier, 2) adding a time-dependent
    quarantine compartment, 3) adding a time-dependent antibody-immunization compartment.
    Wang L. (2020) &lt;<a href="https://doi.org/10.6339%2FJDS.202007_18%283%29.0003">doi:10.6339/JDS.202007_18(3).0003</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/licenses/by/4.0">CC BY 4.0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda (&ge; 0.19.3), chron (&ge; 2.3.54), data.table (&ge; 1.12.0),
ggplot2 (&ge; 3.2.1), grDevices (&ge; 3.5.2), graphics (&ge; 3.5.2),
gtools (&ge; 3.8.1), scales (&ge; 1.1.0), stats (&ge; 3.5.2),
reshape2 (&ge; 1.4.3), rjags (&ge; 4.10), utils (&ge; 3.5.2)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.2)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-12-06 14:32:50 UTC; mjkle</td>
</tr>
<tr>
<td>Author:</td>
<td>Lili Wang [aut],
  Song Lab [aut] (&lt;http://websites.umich.edu/~songlab/&gt;),
  Paul Egeler [ctb] (Spectrum Health Office of Research and Education),
  Michael Kleinsasser [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael Kleinsasser &lt;biostat-cran-manager@umich.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-12-10 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='confirmed'>Confirmed COVID-19 cases</h2><span id='topic+confirmed'></span>

<h3>Description</h3>

<p>Confirmed COVID-19 cases in US states
</p>


<h3>Format</h3>

<p>a list with
</p>

<ul>
<li><p>Province_State name of the US state
</p>
</li>
<li><p>date ... a column for each date
</p>
</li></ul>


<hr>
<h2 id='death'>Confirmed COVID-19 deaths</h2><span id='topic+death'></span>

<h3>Description</h3>

<p>Confirmed COVID-19 deaths in US states
</p>


<h3>Format</h3>

<p>a list with
</p>

<ul>
<li><p>Province_State name of the US state
</p>
</li>
<li><p>date ... a column for each date
</p>
</li></ul>


<hr>
<h2 id='eSAIR'>Extended state-space SIR with a subset of the population showing antibody positivity</h2><span id='topic+eSAIR'></span>

<h3>Description</h3>

<p>In this function we allow it to characterize time-varying immunization among a subset of the population that have been tested positive in an antibody assessment. We expanded the SIR model by adding a time-varying antibody-positive proportion <code class="reqn">\alpha_t</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eSAIR(
  Y,
  R,
  alpha0 = NULL,
  change_time = NULL,
  begin_str = "01/13/2020",
  T_fin = 200,
  nchain = 4,
  nadapt = 10000,
  M = 500,
  thn = 10,
  nburnin = 200,
  dic = FALSE,
  death_in_R = 0.02,
  casename = "eSAIR",
  beta0 = 0.2586,
  gamma0 = 0.0821,
  R0 = beta0/gamma0,
  gamma0_sd = 0.1,
  R0_sd = 1,
  file_add = character(0),
  add_death = FALSE,
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  eps = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eSAIR_+3A_y">Y</code></td>
<td>
<p>the time series of daily observed infected compartment proportions.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_r">R</code></td>
<td>
<p>the time series of daily observed removed compartment proportions, including death and recovered.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_alpha0">alpha0</code></td>
<td>
<p>a vector of values of the dirac delta function <code class="reqn">\alpha_t</code>. Each entry denotes the proportion that will be immunized at each change time point. Note that all the entries lie between 0 and 1, its default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_change_time">change_time</code></td>
<td>
<p>the change points over time corresponding to <code>alpha0</code>, to formulate the dirac delta function <code class="reqn">\alpha_t</code>; its defalt value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_begin_str">begin_str</code></td>
<td>
<p>the character of starting time, the default is &quot;01/13/2020&quot;.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_t_fin">T_fin</code></td>
<td>
<p>the end of follow-up time after the beginning date <code>begin_str</code>, the default is 200.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_nchain">nchain</code></td>
<td>
<p>the number of MCMC chains generated by <code><a href="rjags.html#topic+rjags">rjags</a></code>, the default is 4.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_nadapt">nadapt</code></td>
<td>
<p>the iteration number of adaptation in the MCMC. We recommend using at least the default value 1e4 to obtained fully adapted chains.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_m">M</code></td>
<td>
<p>the number of draws in each chain, with no thinning. The default is M=5e2 but suggest using 5e5.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_thn">thn</code></td>
<td>
<p>the thinning interval between mixing. The total number of draws thus would become <code>round(M/thn)*nchain</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_nburnin">nburnin</code></td>
<td>
<p>the burn-in period. The default is 2e2 but suggest 2e5.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_dic">dic</code></td>
<td>
<p>logical, whether compute the DIC (deviance information criterion) for model selection.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_death_in_r">death_in_R</code></td>
<td>
<p>the numeric value of average of cumulative deaths in the removed compartments. The default is 0.4 within Hubei and 0.02 outside Hubei.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_casename">casename</code></td>
<td>
<p>the string of the job's name. The default is &quot;eSAIR&quot;.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_beta0">beta0</code></td>
<td>
<p>the hyperparameter of average transmission rate, the default is the one estimated from the SARS first-month outbreak (0.2586).</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_gamma0">gamma0</code></td>
<td>
<p>the hyperparameter of average removed rate, the default is the one estimated from the SARS first-month outbreak (0.0821).</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_r0">R0</code></td>
<td>
<p>the hyperparameter of the mean reproduction number R0. The default is thus the ratio of <code>beta0/gamma0</code>, which can be specified directly.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_gamma0_sd">gamma0_sd</code></td>
<td>
<p>the standard deviation for the prior distrbution of the removed rate <code class="reqn">\gamma</code>, the default is 0.1.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_r0_sd">R0_sd</code></td>
<td>
<p>the standard deviation for the prior disbution of R0, the default is 1.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_file_add">file_add</code></td>
<td>
<p>the string to denote the location of saving output files and tables.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_add_death">add_death</code></td>
<td>
<p>logical, whether add the approximate death curve to the plot, default is false.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_save_files">save_files</code></td>
<td>
<p>logical, whether to save plots to file.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_save_mcmc">save_mcmc</code></td>
<td>
<p>logical, whether save (<code>TRUE</code>) all the MCMC outputs or not (<code>FALSE</code>).The output file will be an <code>.RData</code> file named by the <code class="reqn">casename</code>. We include arrays of prevalence values of the three compartments with their matrices of posterior draws up to the last date of the collected data as <code>theta_p[,,1]</code> and afterwards as <code>theta_pp[,,1]</code> for <code class="reqn">\theta_t^S</code>, <code>theta_p[,,2]</code> and <code>theta_pp[,,2]</code> for <code class="reqn">\theta_t^I</code>, and <code>theta_p[,,3]</code> and <code>theta_pp[,,3]</code> for <code class="reqn">\theta_t^R</code>. The posterior draws of the prevalence process of the antibody-immunized compartment can be obtained via <code>thetaA_p</code> and <code>thetaA_pp</code>. Moreover, the input and predicted proportions <code>Y</code>, <code>Y_pp</code>, <code>R</code> and <code>R_pp</code> can also be retrieved. The prevalence and prediceted proportion matrices have rows for MCMC replicates, and columns for days. The MCMC posterior draws of other parameters including <code>beta</code>, <code>gamma</code>, <code>R0</code>, and variance controllers <code>k_p</code>, <code>lambdaY_p</code>, <code>lambdaR_p</code> are also available.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_save_plot_data">save_plot_data</code></td>
<td>
<p>logical, whether save the plotting data or not.</p>
</td></tr>
<tr><td><code id="eSAIR_+3A_eps">eps</code></td>
<td>
<p>a non-zero controller so that all the input <code>Y</code> and <code>R</code> values would be bounded above 0 (at least <code>eps</code>). Its default value is 1e-10</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>casename</code></td>
<td>
<p>the predefined <code>casename</code>.</p>
</td></tr>
<tr><td><code>incidence_mean</code></td>
<td>
<p>mean cumulative incidence, the mean prevalence of cumulative confirmed cases at the end of the study.</p>
</td></tr>
<tr><td><code>incidence_ci</code></td>
<td>
<p>2.5%, 50%, and 97.5% quantiles of the incidences.</p>
</td></tr>
<tr><td><code>out_table</code></td>
<td>
<p>summary tables including the posterior mean of the prevalance processes of the 3 states compartments (<code class="reqn">\theta_t^S,\theta_t^I,\theta_t^R,\theta_t^H</code>) at last date of data collected ((<code class="reqn">t^\prime</code>) decided by the lengths of your input data <code>Y</code> and <code>R</code>), and their respective credible inctervals (ci); the respective means and ci's of the reporduction number (R0), removed rate (<code class="reqn">\gamma</code>), transmission rate  (<code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code>plot_infection</code></td>
<td>
<p>plot of summarizing and forecasting for the infection compartment, in which the vertial blue line denotes the last date of data collected (<code class="reqn">t^\prime</code>), the vertial darkgray line denotes the deacceleration point (first turning point) that the posterior mean first-derivative of infection prevalence <code class="reqn">\dot{\theta}_t^I</code> achieves the  maximum, the vertical purple line denotes the second turning point that the posterior mean first-derivative infection proportion <code class="reqn">\dot{\theta}_t^I</code> equals zero, the darkgray line denotes the posterior mean of the infection prevalence <code class="reqn">\theta_t^I</code> and the red line denotes its posterior median. </p>
</td></tr>
<tr><td><code>plot_removed</code></td>
<td>
<p>plot of summarizing and forecasting for the removed compartment with lines similar to those in the <code>plot_infection</code>. The vertical lines are identical, but the horizontal mean and median correspond to the posterior mean and median of the removed process <code class="reqn">\theta_t^R</code>. An additional line indicates the estimated death prevalence from the input <code>death_in_R</code>.</p>
</td></tr>
<tr><td><code>spaghetti_plot</code></td>
<td>
<p>20 randomly selected MCMC draws of the first-order derivative of the posterior prevalence of infection, namely <code class="reqn">\dot{\theta}_t^I</code>. The black curve is the posterior mean of the derivative, and the vertical lines mark times of turning points corresponding respectively to those shown in <code>plot_infection</code> and <code>plot_removed</code>. Moreover, the 95% credible intervals of these turning points are also highlighted by semi-transparent rectangles. </p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>, calculated as the average of the time points with maximum posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;darkgreen&quot; lines in the two plots <code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary point such that the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>, calculated as the average of the time points with maximum posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;darkgreen&quot; lines in the two plots <code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary point such that the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_ci</code></td>
<td>
<p>fwith <code>first_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>second_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\theta_t^I=0</code>, calculated as the average of the stationary points of all of posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;pruple&quot; lines in the plots of <code>plot_infection</code> and <code>plot_removed</code>. The latter indicate stationary t at which the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> equals zero.</p>
</td></tr>
<tr><td><code>second_tp_ci</code></td>
<td>
<p>with <code>second_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>dic_val</code></td>
<td>
<p>the output of <code>dic.samples()</code> in <code><a href="rjags.html#topic+dic.samples">dic.samples</a></code>, computing deviance information criterion for model comparison.</p>
</td></tr>
<tr><td><code>gelman_diag_list</code></td>
<td>
<p> Since version 0.3.3, we incorporated Gelman And Rubin's Convergence Diagnostic using <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>. We included both the statistics and their upper C.I. limits. Values substantially above 1 indicate lack of convergence. Error messages would be printed as they are. This would be only valid for multiple chains (e.g. nchain &gt; 1). Note that for time dependent processes, we only compute the convergence of the last observation data (<code>T_prime</code>), though it shows to be <code>T_prime+1</code>, which is due to the day 0 for initialization.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
NI_complete &lt;- c(
  41, 41, 41, 45, 62, 131, 200, 270, 375, 444, 549, 729,
  1052, 1423, 2714, 3554, 4903, 5806, 7153, 9074, 11177,
  13522, 16678, 19665, 22112, 24953, 27100, 29631, 31728, 33366
)
RI_complete &lt;- c(
  1, 1, 7, 10, 14, 20, 25, 31, 34, 45, 55, 71, 94,
  121, 152, 213, 252, 345, 417, 561, 650, 811, 1017,
  1261, 1485, 1917, 2260, 2725, 3284, 3754
)
N &lt;- 58.5e6
R &lt;- RI_complete / N
Y &lt;- NI_complete / N - R # Jan13-&gt;Feb 11
change_time &lt;- c("02/08/2020")
alpha0 &lt;- c(0.2) # 20% of the susceptible population were found immunized
res.antibody &lt;- eSAIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  alpha0 = alpha0, change_time = change_time,
  casename = "Hubei_antibody", save_files = TRUE, save_mcmc = FALSE,
  M = 5e2, nburnin = 2e2
)
res.antibody$plot_infection


change_time &lt;- c("01/16/2020")
alpha0 &lt;- c(0.2)
NI_complete2 &lt;- c(41, 45)
RI_complete2 &lt;- c(1, 1)
N2 &lt;- 1E3
res3 &lt;- eSAIR(
  RI_complete2 / N2,
  NI_complete2 / N2,
  begin_str = "01/13/2020",
  T_fin = 4,
  alpha0 = alpha0,
  change_time = change_time,
  dic = FALSE,
  casename = "Hubei_q",
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  M = 50,
  nburnin = 1
)
closeAllConnections()

</code></pre>

<hr>
<h2 id='qh.eSIR'>Extended state-space SIR with quarantine</h2><span id='topic+qh.eSIR'></span>

<h3>Description</h3>

<p>Fit an extended state-space SIR model being reduced by in-home hospitalization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qh.eSIR(
  Y,
  R,
  phi0 = NULL,
  change_time = NULL,
  begin_str = "01/13/2020",
  T_fin = 200,
  nchain = 4,
  nadapt = 10000,
  M = 500,
  thn = 10,
  nburnin = 200,
  dic = FALSE,
  death_in_R = 0.02,
  casename = "qh.eSIR",
  beta0 = 0.2586,
  gamma0 = 0.0821,
  R0 = beta0/gamma0,
  gamma0_sd = 0.1,
  R0_sd = 1,
  file_add = character(0),
  add_death = FALSE,
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  eps = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qh.eSIR_+3A_y">Y</code></td>
<td>
<p>the time series of daily observed infected compartment proportions.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_r">R</code></td>
<td>
<p>the time series of daily observed removed compartment proportions, including death and recovered.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_phi0">phi0</code></td>
<td>
<p>a vector of values of the dirac delta function <code class="reqn">\phi_t</code>. Each entry denotes the proportion that will be qurantined at each change time point. Note that all the entries lie between 0 and 1, its default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_change_time">change_time</code></td>
<td>
<p>the change points over time corresponding to <code>phi0</code>, to formulate the dirac delta function <code class="reqn">\phi_t</code>; its defalt value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_begin_str">begin_str</code></td>
<td>
<p>the character of starting time, the default is &quot;01/13/2020&quot;.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_t_fin">T_fin</code></td>
<td>
<p>the end of follow-up time after the beginning date <code>begin_str</code>, the default is 200.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_nchain">nchain</code></td>
<td>
<p>the number of MCMC chains generated by <code><a href="rjags.html#topic+rjags">rjags</a></code>, the default is 4.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_nadapt">nadapt</code></td>
<td>
<p>the iteration number of adaptation in the MCMC. We recommend using at least the default value 1e4 to obtained fully adapted chains.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_m">M</code></td>
<td>
<p>the number of draws in each chain, with no thinning. The default is M=5e2 but suggest using 5e5.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_thn">thn</code></td>
<td>
<p>the thinning interval between mixing. The total number of draws thus would become <code>round(M/thn)*nchain</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_nburnin">nburnin</code></td>
<td>
<p>the burn-in period. The default is 2e2 but suggest 2e5.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_dic">dic</code></td>
<td>
<p>logical, whether compute the DIC (deviance information criterion) for model selection.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_death_in_r">death_in_R</code></td>
<td>
<p>the numeric value of average of cumulative deaths in the removed compartments. The default is 0.4 within Hubei and 0.02 outside Hubei.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_casename">casename</code></td>
<td>
<p>the string of the job's name. The default is &quot;qh.eSIR&quot;.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_beta0">beta0</code></td>
<td>
<p>the hyperparameter of average transmission rate, the default is the one estimated from the SARS first-month outbreak (0.2586).</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_gamma0">gamma0</code></td>
<td>
<p>the hyperparameter of average removed rate, the default is the one estimated from the SARS first-month outbreak (0.0821).</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_r0">R0</code></td>
<td>
<p>the hyperparameter of the mean reproduction number R0. The default is thus the ratio of <code>beta0/gamma0</code>, which can be specified directly.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_gamma0_sd">gamma0_sd</code></td>
<td>
<p>the standard deviation for the prior distrbution of the removed rate <code class="reqn">\gamma</code>, the default is 0.1.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_r0_sd">R0_sd</code></td>
<td>
<p>the standard deviation for the prior disbution of R0, the default is 1.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_file_add">file_add</code></td>
<td>
<p>the string to denote the location of saving output files and tables.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_add_death">add_death</code></td>
<td>
<p>logical, whether add the approximate death curve to the plot, default is false.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_save_files">save_files</code></td>
<td>
<p>logical, whether to save plots to file.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_save_mcmc">save_mcmc</code></td>
<td>
<p>logical, whether save (<code>TRUE</code>) all the MCMC outputs or not (<code>FALSE</code>).The output file will be an <code>.RData</code> file named by the <code class="reqn">casename</code>. We include arrays of prevalence values of the three compartments with their matrices of posterior draws up to the last date of the collected data as <code>theta_p[,,1]</code> and afterwards as <code>theta_pp[,,1]</code> for <code class="reqn">\theta_t^S</code>, <code>theta_p[,,2]</code> and <code>theta_pp[,,2]</code> for <code class="reqn">\theta_t^I</code>, and <code>theta_p[,,3]</code> and <code>theta_pp[,,3]</code> for <code class="reqn">\theta_t^R</code>. The posterior draws of the prevalence process of the quarantine compartment can be obtained via <code>thetaQ_p</code> and <code>thetaQ_pp</code>. Moreover, the input and predicted proportions <code>Y</code>, <code>Y_pp</code>, <code>R</code> and <code>R_pp</code> can also be retrieved. The prevalence and prediceted proportion matrices have rows for MCMC replicates, and columns for days. The MCMC posterior draws of other parameters including <code>beta</code>, <code>gamma</code>, <code>R0</code>, and variance controllers <code>k_p</code>, <code>lambdaY_p</code>, <code>lambdaR_p</code> are also available.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_save_plot_data">save_plot_data</code></td>
<td>
<p>logical, whether save the plotting data or not.</p>
</td></tr>
<tr><td><code id="qh.eSIR_+3A_eps">eps</code></td>
<td>
<p>a non-zero controller so that all the input <code>Y</code> and <code>R</code> values would be bounded above 0 (at least <code>eps</code>). Its default value is 1e-10</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In this function we allow it to characterize time-varying proportions of susceptible due to government-enforced stringent in-home isolation. We expanded the SIR model by adding a quarantine compartment with a time-varying rate of quarantine <code class="reqn">\phi_t</code>, the chance of a susceptible person  being willing to take in-home isolation at time t.
</p>


<h3>Value</h3>

<table>
<tr><td><code>casename</code></td>
<td>
<p>the predefined <code>casename</code>.</p>
</td></tr>
<tr><td><code>incidence_mean</code></td>
<td>
<p>mean cumulative incidence, the mean prevalence of cumulative confirmed cases at the end of the study.</p>
</td></tr>
<tr><td><code>incidence_ci</code></td>
<td>
<p>2.5%, 50%, and 97.5% quantiles of the incidences.</p>
</td></tr>
<tr><td><code>out_table</code></td>
<td>
<p>summary tables including the posterior mean of the prevalence processes of the 3 states compartments (<code class="reqn">\theta_t^S,\theta_t^I,\theta_t^R,\theta_t^H</code>) at last date of data collected ((<code class="reqn">t^\prime</code>) decided by the lengths of your input data <code>Y</code> and <code>R</code>), and their respective credible intervals (ci); the respective means and ci's of the reproduction number (R0), removed rate (<code class="reqn">\gamma</code>), transmission rate  (<code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code>plot_infection</code></td>
<td>
<p>plot of summarizing and forecasting for the infection compartment, in which the vertical blue line denotes the last date of data collected (<code class="reqn">t^\prime</code>), the vertical darkgray line denotes the deacceleration point (first turning point) that the posterior mean first-derivative of infection prevalence <code class="reqn">\dot{\theta}_t^I</code> achieves the  maximum, the vertical purple line denotes the second turning point that the posterior mean first-derivative infection proportion <code class="reqn">\dot{\theta}_t^I</code> equals zero, the darkgray line denotes the posterior mean of the infection prevalence <code class="reqn">\theta_t^I</code> and the red line denotes its posterior median. </p>
</td></tr>
<tr><td><code>plot_removed</code></td>
<td>
<p>plot of summarizing and forecasting for the removed compartment with lines similar to those in the <code>plot_infection</code>. The vertical lines are identical, but the horizontal mean and median correspond to the posterior mean and median of the removed process <code class="reqn">\theta_t^R</code>. An additional line indicates the estimated death prevalence from the input <code>death_in_R</code>.</p>
</td></tr>
<tr><td><code>spaghetti_plot</code></td>
<td>
<p>20 randomly selected MCMC draws of the first-order derivative of the posterior prevalence of infection, namely <code class="reqn">\dot{\theta}_t^I</code>. The black curve is the posterior mean of the derivative, and the vertical lines mark times of turning points corresponding respectively to those shown in <code>plot_infection</code> and <code>plot_removed</code>. Moreover, the 95% credible intervals of these turning points are also highlighted by semi-transparent rectangles. </p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>, calculated as the average of the time points with maximum posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;darkgreen&quot; lines in the two plots <code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary point such that the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>, calculated as the average of the time points with maximum posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;darkgreen&quot; lines in the two plots <code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary point such that the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_ci</code></td>
<td>
<p>fwith <code>first_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>second_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\theta_t^I=0</code>, calculated as the average of the stationary points of all of posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;pruple&quot; lines in the plots of <code>plot_infection</code> and <code>plot_removed</code>. The latter indicate stationary t at which the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> equals zero.</p>
</td></tr>
<tr><td><code>second_tp_ci</code></td>
<td>
<p>with <code>second_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>dic_val</code></td>
<td>
<p>the output of <code>dic.samples()</code> in <code><a href="rjags.html#topic+dic.samples">dic.samples</a></code>, computing deviance information criterion for model comparison.</p>
</td></tr>
<tr><td><code>gelman_diag_list</code></td>
<td>
<p> Since version 0.3.3, we incorporated Gelman And Rubin's Convergence Diagnostic using <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>. We included both the statistics and their upper C.I. limits. Values substantially above 1 indicate lack of convergence. Error messages would be printed as they are. This would be only valid for multiple chains (e.g. nchain &gt; 1). Note that for time dependent processes, we only compute the convergence of the last observation data (<code>T_prime</code>), though it shows to be <code>T_prime+1</code>, which is due to the day 0 for initialization.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
NI_complete &lt;- c(
  41, 41, 41, 45, 62, 131, 200, 270, 375, 444, 549, 729,
  1052, 1423, 2714, 3554, 4903, 5806, 7153, 9074, 11177,
  13522, 16678, 19665, 22112, 24953, 27100, 29631, 31728, 33366
)
RI_complete &lt;- c(
  1, 1, 7, 10, 14, 20, 25, 31, 34, 45, 55, 71, 94, 121, 152, 213,
  252, 345, 417, 561, 650, 811, 1017, 1261, 1485, 1917, 2260,
  2725, 3284, 3754
)
N &lt;- 58.5e6
R &lt;- RI_complete / N
Y &lt;- NI_complete / N - R # Jan13-&gt;Feb 11

change_time &lt;- c("01/23/2020", "02/04/2020", "02/08/2020")
phi0 &lt;- c(0.1, 0.4, 0.4)
res.q &lt;- qh.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  phi0 = phi0, change_time = change_time,
  casename = "Hubei_q", save_files = TRUE, save_mcmc = FALSE,
  M = 5e2, nburnin = 2e2
)
res.q$plot_infection
# res.q$plot_removed

res.noq &lt;- qh.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, casename = "Hubei_noq",
  M = 5e2, nburnin = 2e2
)
res.noq$plot_infection


change_time &lt;- c("01/16/2020")
phi0 &lt;- c(0.1)
NI_complete2 &lt;- c(41, 45)
RI_complete2 &lt;- c(1, 1)
N2 &lt;- 1E3
res2 &lt;- qh.eSIR(
  RI_complete2 / N2,
  NI_complete2 / N2,
  begin_str = "01/13/2020",
  T_fin = 4,
  phi0 = phi0,
  change_time = change_time,
  dic = FALSE,
  casename = "Hubei_q",
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  M = 50,
  nburnin = 1
)
closeAllConnections()

</code></pre>

<hr>
<h2 id='recovered'>Confirmed COVID-19 recovered</h2><span id='topic+recovered'></span>

<h3>Description</h3>

<p>Confirmed COVID-19 recovered in US states
</p>


<h3>Format</h3>

<p>a list with
</p>

<ul>
<li><p>Province_State name of the US state
</p>
</li>
<li><p>date ... a column for each date
</p>
</li></ul>


<hr>
<h2 id='tvt.eSIR'>Fit extended state-space SIR model with time-varying transmission rates</h2><span id='topic+tvt.eSIR'></span>

<h3>Description</h3>

<p>Fit extended state-space SIR model with pre-specified changes in the transmission rate, either stepwise or continuous, accommodating time-varying quarantine protocols.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvt.eSIR(
  Y,
  R,
  pi0 = NULL,
  change_time = NULL,
  exponential = FALSE,
  lambda0 = NULL,
  begin_str = "01/13/2020",
  T_fin = 200,
  nchain = 4,
  nadapt = 10000,
  M = 500,
  thn = 10,
  nburnin = 200,
  dic = FALSE,
  death_in_R = 0.02,
  beta0 = 0.2586,
  gamma0 = 0.0821,
  R0 = beta0/gamma0,
  gamma0_sd = 0.1,
  R0_sd = 1,
  casename = "tvt.eSIR",
  file_add = character(0),
  add_death = FALSE,
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  eps = 1e-10
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvt.eSIR_+3A_y">Y</code></td>
<td>
<p>the time series of daily observed infected compartment proportions.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_r">R</code></td>
<td>
<p>the time series of daily observed removed compartment proportions, including death and recovered.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_pi0">pi0</code></td>
<td>
<p>the time-dependent transmission rate modifier <code class="reqn">\pi(t)</code> between 0 and 1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_change_time">change_time</code></td>
<td>
<p>the change points over time for step function pi, defalt value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_exponential">exponential</code></td>
<td>
<p>logical, whether <code class="reqn">\pi(t)</code> is exponential <code class="reqn">\exp(-\lambda_0t)</code> or not; the default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_lambda0">lambda0</code></td>
<td>
<p>the rate of decline in the exponential survival function in <code class="reqn">\exp(-\lambda_0t)</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_begin_str">begin_str</code></td>
<td>
<p>the character of starting time, the default is &quot;01/13/2020&quot;.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_t_fin">T_fin</code></td>
<td>
<p>the end of follow-up time after the beginning date <code>begin_str</code>, the default is 200.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_nchain">nchain</code></td>
<td>
<p>the number of MCMC chains generated by <code><a href="rjags.html#topic+rjags">rjags</a></code>, the default is 4.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_nadapt">nadapt</code></td>
<td>
<p>the iteration number of adaptation in the MCMC. We recommend using at least the default value 1e4 to obtained fully adapted chains.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_m">M</code></td>
<td>
<p>the number of draws in each chain, with no thinning. The default is M=5e2 but suggest using 5e5.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_thn">thn</code></td>
<td>
<p>the thinning interval between mixing. The total number of draws thus would become <code>round(M/thn)*nchain</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_nburnin">nburnin</code></td>
<td>
<p>the burn-in period. The default is 2e2 but suggest 2e5.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_dic">dic</code></td>
<td>
<p>logical, whether compute the DIC (deviance information criterion) for model selection.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_death_in_r">death_in_R</code></td>
<td>
<p>the numeric value of average of cumulative deaths in the removed compartments. The default is 0.4 within Hubei and 0.02 outside Hubei.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_beta0">beta0</code></td>
<td>
<p>the hyperparameter of average transmission rate, the default is the one estimated from the SARS first-month outbreak (0.2586).</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_gamma0">gamma0</code></td>
<td>
<p>the hyperparameter of average removed rate, the default is the one estimated from the SARS first-month outbreak (0.0821).</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_r0">R0</code></td>
<td>
<p>the hyperparameter of the mean reproduction number R0. The default is thus the ratio of <code>beta0/gamma0</code>, which can be specified directly.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_gamma0_sd">gamma0_sd</code></td>
<td>
<p>the standard deviation for the prior distrbution of the removed rate <code class="reqn">\gamma</code>, the default is 0.1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_r0_sd">R0_sd</code></td>
<td>
<p>the standard deviation for the prior disbution of R0, the default is 1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_casename">casename</code></td>
<td>
<p>the string of the job's name. The default is &quot;tvt.eSIR&quot;.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_file_add">file_add</code></td>
<td>
<p>the string to denote the location of saving output files and tables.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_add_death">add_death</code></td>
<td>
<p>logical, whether add the approximate death curve to the plot, default is false.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_save_files">save_files</code></td>
<td>
<p>logical, whether to save plots to file.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_save_mcmc">save_mcmc</code></td>
<td>
<p>logical, whether save (<code>TRUE</code>) all the MCMC outputs or not (<code>FALSE</code>).The output file will be an <code>.RData</code> file named by the <code class="reqn">casename</code>. We include arrays of prevalence values of the three compartments with their matrices of posterior draws up to the last date of the collected data as <code>theta_p[,,1]</code> and afterwards as <code>theta_pp[,,1]</code> for <code class="reqn">\theta_t^S</code>, <code>theta_p[,,2]</code> and <code>theta_pp[,,2]</code> for <code class="reqn">\theta_t^I</code>, and <code>theta_p[,,3]</code> and <code>theta_pp[,,3]</code> for <code class="reqn">\theta_t^R</code>. Moreover, the input and predicted proportions <code>Y</code>, <code>Y_pp</code>, <code>R</code> and <code>R_pp</code> can also be retrieved. The prevalence and predicted proportion matrices have rows for MCMC replicates, and columns for days. The MCMC posterior draws of other parameters including <code>beta_p</code>, <code>gamma_p</code>, <code>R0_p</code>, and variance controllers <code>k_p</code>, <code>lambdaY_p</code>, <code>lambdaR_p</code> are also available.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_save_plot_data">save_plot_data</code></td>
<td>
<p>logical, whether save the plotting data or not.</p>
</td></tr>
<tr><td><code id="tvt.eSIR_+3A_eps">eps</code></td>
<td>
<p>a non-zero controller so that all the input <code>Y</code> and <code>R</code> values would be bounded above 0 (at least <code>eps</code>). Its default value is 1e-10</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We fit a state-space model with extended SIR, in which a time-varying transmission rate modifier <code class="reqn">\pi(t)</code> (between 0 and 1) is introduced to model. This allows us to accommodate quarantine protocol changes and ignored resources of hospitalization. The form of reducing rate may be a step-function with jumps at times of big policy changes or a smooth exponential survival function <code class="reqn">\exp(-\lambda_0t)</code>. The parameters of the function and change points, if any, should be predefined.
</p>


<h3>Value</h3>

<table>
<tr><td><code>casename</code></td>
<td>
<p>the predefined <code>casename</code>.</p>
</td></tr>
<tr><td><code>incidence_mean</code></td>
<td>
<p>mean cumulative incidence, the mean prevalence of cumulative confirmed cases at the end of the study.</p>
</td></tr>
<tr><td><code>incidence_ci</code></td>
<td>
<p>2.5%, 50%, and 97.5% quantiles of the incidences.</p>
</td></tr>
<tr><td><code>out_table</code></td>
<td>
<p>summary tables including the posterior mean of the prevalance processes of the 3 states compartments (<code class="reqn">\theta_t^S,\theta_t^I,\theta_t^R</code>) at last date of data collected ((<code class="reqn">t^\prime</code>) decided by the lengths of your input data <code>Y</code> and <code>R</code>), and their respective credible inctervals (ci); the respective means and ci's of the reporduction number (R0), removed rate (<code class="reqn">\gamma</code>), transmission rate  (<code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code>plot_infection</code></td>
<td>
<p>plot of summarizing and forecasting for the infection compartment, in which the vertial blue line denotes the last date of data collected (<code class="reqn">t^\prime</code>), the vertial darkgray line denotes the deacceleration point (first turning point) that the posterior mean first-derivative of infection prevalence <code class="reqn">\dot{\theta}_t^I</code> achieves the  maximum, the vertical purple line denotes the second turning point that the posterior mean first-derivative infection proportion <code class="reqn">\dot{\theta}_t^I</code> equals zero, the darkgray line denotes the posterior mean of the infection prevalence <code class="reqn">\theta_t^I</code> and the red line denotes its posterior median. </p>
</td></tr>
<tr><td><code>plot_removed</code></td>
<td>
<p>plot of summarizing and forecasting for the removed compartment with lines similar to those in the <code>plot_infection</code>. The vertical lines are identical, but the horizontal mean and median correspond to the posterior mean and median of the removed process <code class="reqn">\theta_t^R</code>. An additional line indicates the estimated death prevalence from the input <code>death_in_R</code>.</p>
</td></tr>
<tr><td><code>spaghetti_plot</code></td>
<td>
<p>20 randomly selected MCMC draws of the first-order derivative of the posterior prevalence of infection, namely <code class="reqn">\dot{\theta}_t^I</code>. The black curve is the posterior mean of the derivative, and the vertical lines mark times of turning points corresponding respectively to those shown in <code>plot_infection</code> and <code>plot_removed</code>. Moreover, the 95% credible intervals of these turning points are also highlighted by semi-transparent rectangles. </p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>, calculated as the average of the time points with maximum posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;darkgreen&quot; lines in the two plots <code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary point such that the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_ci</code></td>
<td>
<p>fwith <code>first_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>second_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\theta_t^I=0</code>, calculated as the average of the stationary points of all of posterior first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from the one labeled by the &quot;pruple&quot; lines in the plots of <code>plot_infection</code> and <code>plot_removed</code>. The latter indicate stationary t at which the first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> equals zero.</p>
</td></tr>
<tr><td><code>second_tp_ci</code></td>
<td>
<p>with <code>second_tp_mean</code>, it reports the corresponding credible interval and median.</p>
</td></tr>
<tr><td><code>dic_val</code></td>
<td>
<p>the output of <code>dic.samples()</code> in  <code><a href="rjags.html#topic+dic.samples">dic.samples</a></code>, computing deviance information criterion for model comparison.</p>
</td></tr>
<tr><td><code>gelman_diag_list</code></td>
<td>
<p> Since version 0.3.3, we incorporated Gelman And Rubin's Convergence Diagnostic using <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>. We included both the statistics and their upper C.I. limits. Values substantially above 1 indicate lack of convergence. Error messages would be printed as they are. This would be only valid for multiple chains (e.g. nchain &gt; 1). Note that for time dependent processes, we only compute the convergence of the last observation data (<code>T_prime</code>), though it shows to be <code>T_prime+1</code>, which is due to the day 0 for initialization.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
NI_complete &lt;- c(
  41, 41, 41, 45, 62, 131, 200, 270, 375, 444, 549, 729,
  1052, 1423, 2714, 3554, 4903, 5806, 7153, 9074, 11177,
  13522, 16678, 19665, 22112, 24953, 27100, 29631, 31728, 33366
)
RI_complete &lt;- c(
  1, 1, 7, 10, 14, 20, 25, 31, 34, 45, 55, 71, 94, 121, 152, 213,
  252, 345, 417, 561, 650, 811, 1017, 1261, 1485, 1917, 2260,
  2725, 3284, 3754
)
N &lt;- 58.5e6
R &lt;- RI_complete / N
Y &lt;- NI_complete / N - R # Jan13-&gt;Feb 11
### Step function of pi(t)
change_time &lt;- c("01/23/2020", "02/04/2020", "02/08/2020")
pi0 &lt;- c(1.0, 0.9, 0.5, 0.1)
res.step &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, pi0 = pi0, change_time = change_time, dic = TRUE,
  casename = "Hubei_step", save_files = TRUE,
  save_mcmc = FALSE, M = 5e2, nburnin = 2e2
)
res.step$plot_infection
res.step$plot_removed
res.step$dic_val

### continuous exponential function of pi(t)
res.exp &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, exponential = TRUE, dic = FALSE, lambda0 = 0.05,
  casename = "Hubei_exp", save_files = FALSE, save_mcmc = FALSE,
  M = 5e2, nburnin = 2e2
)
res.exp$plot_infection
# res.exp$plot_removed

### without pi(t), the standard state-space SIR model without intervention
res.nopi &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, casename = "Hubei_nopi", save_files = FALSE,
  M = 5e2, nburnin = 2e2
)
res.nopi$plot_infection
# res.nopi$plot_removed


change_time &lt;- c("01/18/2020")
pi0&lt;- c(1.0, 0.9)
NI_complete2 &lt;- c(41, 45, 62, 131)
RI_complete2 &lt;- c(1, 1, 7, 10)
N2 &lt;- 1E3
res1 &lt;- tvt.eSIR(
  RI_complete2 / N2,
  (NI_complete2 - RI_complete2) / N2,
  begin_str = "01/10/2020",
  T_fin =10,
  pi0 = pi0,
  change_time = change_time,
  dic = FALSE,
  casename = "Hubei_step",
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  M = 50,
  nburnin = 1
)
closeAllConnections()

</code></pre>

<hr>
<h2 id='tvt.eSIR2'>Fit extended state-space SIR model with time-varying transmission rates</h2><span id='topic+tvt.eSIR2'></span>

<h3>Description</h3>

<p>Fit extended state-space SIR model with pre-specified changes in the
transmission rate, either stepwise or continuous, accommodating time-varying
quarantine protocols.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tvt.eSIR2(
  Y,
  R,
  pi0 = NULL,
  change_time = NULL,
  exponential = FALSE,
  lambda0 = NULL,
  begin_str = "01/13/2020",
  T_fin = 200,
  nchain = 4,
  nadapt = 10000,
  M = 500,
  thn = 10,
  nburnin = 200,
  dic = FALSE,
  death_in_R = 0.02,
  beta0 = 0.2586,
  gamma0 = 0.0821,
  R0 = beta0/gamma0,
  gamma0_sd = 0.1,
  R0_sd = 1,
  casename = "tvt.eSIR2",
  file_add = character(0),
  add_death = FALSE,
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  eps = 1e-10,
  time_unit = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tvt.eSIR2_+3A_y">Y</code></td>
<td>
<p>the time series of daily observed infected compartment proportions.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_r">R</code></td>
<td>
<p>the time series of daily observed removed compartment proportions,
including death and recovered.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_pi0">pi0</code></td>
<td>
<p>the time-dependent transmission rate modifier <code class="reqn">\pi(t)</code> between
0 and 1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_change_time">change_time</code></td>
<td>
<p>the change points over time for step function pi, defalt
value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_exponential">exponential</code></td>
<td>
<p>logical, whether <code class="reqn">\pi(t)</code> is exponential
<code class="reqn">\exp(-\lambda_0t)</code> or not; the default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_lambda0">lambda0</code></td>
<td>
<p>the rate of decline in the exponential survival function in
<code class="reqn">\exp(-\lambda_0t)</code>.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_begin_str">begin_str</code></td>
<td>
<p>the character of starting time, the default is &quot;01/13/2020&quot;.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_t_fin">T_fin</code></td>
<td>
<p>the end of follow-up time after the beginning date
<code>begin_str</code>, the default is 200. This value must be longer than the
length of your input observed time series data.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_nchain">nchain</code></td>
<td>
<p>the number of MCMC chains generated by
<code><a href="rjags.html#topic+rjags">rjags</a></code>, the default is 4.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_nadapt">nadapt</code></td>
<td>
<p>the iteration number of adaptation in the MCMC. We recommend
using at least the default value 1e4 to obtained fully adapted chains.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_m">M</code></td>
<td>
<p>the number of draws in each chain, with no thinning. The default is
M=5e2 but suggest using 5e5.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_thn">thn</code></td>
<td>
<p>the thinning interval between mixing. The total number of draws
thus would become <code>round(M/thn)*nchain</code>. The default is 10.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_nburnin">nburnin</code></td>
<td>
<p>the burn-in period. The default is 2e2 but suggest 2e5.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_dic">dic</code></td>
<td>
<p>logical, whether compute the DIC (deviance information criterion)
for model selection.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_death_in_r">death_in_R</code></td>
<td>
<p>the numeric value of average of cumulative deaths in the
removed compartments. The default is 0.4 within Hubei and 0.02 outside Hubei.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_beta0">beta0</code></td>
<td>
<p>the hyperparameter of average transmission rate, the default is
the one estimated from the SARS first-month outbreak (0.2586).</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_gamma0">gamma0</code></td>
<td>
<p>the hyperparameter of average removed rate, the default is the
one estimated from the SARS first-month outbreak (0.0821).</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_r0">R0</code></td>
<td>
<p>the hyperparameter of the mean reproduction number R0. The default
is thus the ratio of <code>beta0/gamma0</code>, which can be specified directly.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_gamma0_sd">gamma0_sd</code></td>
<td>
<p>the standard deviation for the prior distrbution of the
removed rate <code class="reqn">\gamma</code>, the default is 0.1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_r0_sd">R0_sd</code></td>
<td>
<p>the standard deviation for the prior disbution of R0, the
default is 1.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_casename">casename</code></td>
<td>
<p>the string of the job's name. The default is &quot;tvt.eSIR2&quot;.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_file_add">file_add</code></td>
<td>
<p>the string to denote the location of saving output files and
tables.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_add_death">add_death</code></td>
<td>
<p>logical, whether add the approximate death curve to the
plot, default is false.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_save_files">save_files</code></td>
<td>
<p>logical, whether to save plots to file.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_save_mcmc">save_mcmc</code></td>
<td>
<p>logical, whether save (<code>TRUE</code>) all the MCMC outputs or
not (<code>FALSE</code>).The output file will be an <code>.RData</code> file named by the
<code class="reqn">casename</code>. We include arrays of prevalence values of the three
compartments with their matrices of posterior draws up to the last date of
the collected data as <code>theta_p[,,1]</code> and afterwards as
<code>theta_pp[,,1]</code> for <code class="reqn">\theta_t^S</code>, <code>theta_p[,,2]</code> and
<code>theta_pp[,,2]</code> for <code class="reqn">\theta_t^I</code>, and <code>theta_p[,,3]</code> and
<code>theta_pp[,,3]</code> for <code class="reqn">\theta_t^R</code>. Moreover, the input and
predicted proportions <code>Y</code>, <code>Y_pp</code>, <code>R</code> and <code>R_pp</code> can
also be retrieved. The prevalence and predicted proportion matrices have
rows for MCMC replicates, and columns for days. The MCMC posterior draws of
other parameters including <code>beta_p</code>, <code>gamma_p</code>, <code>R0_p</code>, and
variance controllers <code>k_p</code>, <code>lambdaY_p</code>, <code>lambdaR_p</code> are
also available.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_save_plot_data">save_plot_data</code></td>
<td>
<p>logical, whether save the plotting data or not.</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_eps">eps</code></td>
<td>
<p>a non-zero controller so that all the input <code>Y</code> and <code>R</code>
values would be bounded above 0 (at least <code>eps</code>). Its default value is
1e-10</p>
</td></tr>
<tr><td><code id="tvt.eSIR2_+3A_time_unit">time_unit</code></td>
<td>
<p>numeric, newly added argument, which can be changed to an
integer (ceiling) of the input to indicate the time unit for each data
point. The default is one-day, i.e., we let each input time series data
correspond to each day. If this value is set to be 7, each data point
represents one-week's aggregated data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We fit a state-space model with extended SIR, in which a time-varying
transmission rate modifier <code class="reqn">\pi(t)</code> (between 0 and 1) is introduced to
the model. This allows us to accommodate quarantine protocol changes and
ignored resources of hospitalization. The form of reducing rate may be a step
-function with jumps at times of big policy changes or a smooth exponential
survival function <code class="reqn">\exp(-\lambda_0t)</code>. The parameters of the function and
change points, if any, should be predefined.
</p>


<h3>Value</h3>

<table>
<tr><td><code>casename</code></td>
<td>
<p>the predefined <code>casename</code>.</p>
</td></tr>
<tr><td><code>incidence_mean</code></td>
<td>
<p>mean cumulative incidence, the mean prevalence of
cumulative confirmed cases at the end of the study.</p>
</td></tr>
<tr><td><code>incidence_ci</code></td>
<td>
<p>2.5%, 50%, and 97.5% quantiles of the incidences.</p>
</td></tr>
<tr><td><code>out_table</code></td>
<td>
<p>summary tables including the posterior mean of the
prevalence processes of the 3 states compartments (<code class="reqn">\theta_t^S,
\theta_t^I,\theta_t^R</code>) at last date of data collected ((<code class="reqn">t^\prime</code>)
decided by the lengths of your input data <code>Y</code> and <code>R</code>), and their
respective credible intervals (ci); the respective means and ci's of the
reproduction number (R0), removed rate (<code class="reqn">\gamma</code>), transmission rate
(<code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code>plot_infection</code></td>
<td>
<p>plot of summarizing and forecasting for the infection
compartment, in which the vertical blue line denotes the last date of data
collected (<code class="reqn">t^\prime</code>), the vertial darkgray line denotes the
deacceleration point (first turning point) that the posterior mean
first-derivative of infection prevalence <code class="reqn">\dot{\theta}_t^I</code> achieves the
maximum, the vertical purple line denotes the second turning point that
the posterior mean first-derivative infection proportion
<code class="reqn">\dot{\theta}_t^I</code> equals zero, the darkgray line denotes the
posterior mean of the infection prevalence <code class="reqn">\theta_t^I</code> and the red
line denotes its posterior median. </p>
</td></tr>
<tr><td><code>plot_removed</code></td>
<td>
<p>plot of summarizing and forecasting for the removed
compartment with lines similar to those in the <code>plot_infection</code>. The
vertical lines are identical, but the horizontal mean and median correspond
to the posterior mean and median of the removed process <code class="reqn">\theta_t^R</code>.
An additional line indicates the estimated death prevalence from the input
<code>death_in_R</code>.</p>
</td></tr>
<tr><td><code>spaghetti_plot</code></td>
<td>
<p>20 randomly selected MCMC draws of the first-order
derivative of the posterior prevalence of infection, namely
<code class="reqn">\dot{\theta}_t^I</code>. The black curve is the posterior mean of the
derivative, and the vertical lines mark times of turning points corresponding
respectively to those shown in <code>plot_infection</code> and
<code>plot_removed</code>. Moreover, the 95% credible intervals of these turning
points are also highlighted by semi-transparent rectangles. </p>
</td></tr>
<tr><td><code>first_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\ddot{\theta}_t^I=0</code>,
calculated as the average of the time points with maximum posterior
first-order derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly
different from the one labeled by the &quot;darkgreen&quot; lines in the two plots
<code>plot_infection</code> and <code>plot_removed</code>, which indicate the stationary
point such that the first-order derivative of the averaged posterior of
<code class="reqn">\theta_t^I</code> reaches its maximum.</p>
</td></tr>
<tr><td><code>first_tp_ci</code></td>
<td>
<p>fwith <code>first_tp_mean</code>, it reports the corresponding
credible interval and median.</p>
</td></tr>
<tr><td><code>second_tp_mean</code></td>
<td>
<p>the date t at which <code class="reqn">\theta_t^I=0</code>, calculated as
the average of the stationary points of all of posterior first-order
derivatives <code class="reqn">\dot{\theta}_t^I</code>; this value may be slightly different from
the one labeled by the &quot;pruple&quot; lines in the plots of <code>plot_infection</code>
and <code>plot_removed</code>. The latter indicate stationary t at which the
first-order derivative of the averaged posterior of <code class="reqn">\theta_t^I</code> equals
zero.</p>
</td></tr>
<tr><td><code>second_tp_ci</code></td>
<td>
<p>with <code>second_tp_mean</code>, it reports the corresponding
credible interval and median.</p>
</td></tr>
<tr><td><code>dic_val</code></td>
<td>
<p>the output of <code>dic.samples()</code> in  <code><a href="rjags.html#topic+dic.samples">dic.samples</a></code>,
computing deviance information criterion for model comparison.</p>
</td></tr>
<tr><td><code>gelman_diag_list</code></td>
<td>
<p> Since version 0.3.3, we incorporated Gelman And
Rubin's Convergence Diagnostic using <code><a href="coda.html#topic+gelman.diag">gelman.diag</a></code>. We
included both the statistics and their upper C.I. limits. Values
substantially above 1 indicate lack of convergence. Error messages would be
printed as they are. This would be only valid for multiple chains
(e.g. nchain &gt; 1). Note that for time dependent processes, we only compute
the convergence of the last observation data (<code>T_prime</code>), though it
shows to be <code>T_prime+1</code>, which is due to the day 0 for initialization.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
NI_complete &lt;- c(
  41, 41, 41, 45, 62, 131, 200, 270, 375, 444, 549, 729,
  1052, 1423, 2714, 3554, 4903, 5806, 7153, 9074, 11177,
  13522, 16678, 19665, 22112, 24953, 27100, 29631, 31728, 33366
)
RI_complete &lt;- c(
  1, 1, 7, 10, 14, 20, 25, 31, 34, 45, 55, 71, 94, 121, 152, 213,
  252, 345, 417, 561, 650, 811, 1017, 1261, 1485, 1917, 2260,
  2725, 3284, 3754
)
N &lt;- 58.5e6
R &lt;- RI_complete / N
Y &lt;- NI_complete / N - R # Jan13-&gt;Feb 11
### Step function of pi(t)
change_time &lt;- c("01/23/2020", "02/04/2020", "02/08/2020")
pi0 &lt;- c(1.0, 0.9, 0.5, 0.1)
res.step &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, pi0 = pi0, change_time = change_time, dic = TRUE,
  casename = "Hubei_step", save_files = TRUE,
  save_mcmc = FALSE, M = 5e2, nburnin = 2e2
)
res.step$plot_infection
res.step$plot_removed
res.step$dic_val

### continuous exponential function of pi(t)
res.exp &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, exponential = TRUE, dic = FALSE, lambda0 = 0.05,
  casename = "Hubei_exp", save_files = FALSE, save_mcmc = FALSE,
  M = 5e2, nburnin = 2e2
)
res.exp$plot_infection
# res.exp$plot_removed

### without pi(t), the standard state-space SIR model without intervention
res.nopi &lt;- tvt.eSIR(Y, R,
  begin_str = "01/13/2020", death_in_R = 0.4,
  T_fin = 200, casename = "Hubei_nopi", save_files = FALSE,
  M = 5e2, nburnin = 2e2
)
res.nopi$plot_infection
# res.nopi$plot_removed


change_time &lt;- c("01/18/2020")
pi0&lt;- c(1.0, 0.9)
NI_complete2 &lt;- c(41, 45, 62, 131)
RI_complete2 &lt;- c(1, 1, 7, 10)
N2 &lt;- 1E3
res1 &lt;- tvt.eSIR(
  Y = RI_complete2 / N2,
  R = (NI_complete2 - RI_complete2) / N2,
  begin_str = "01/10/2020",
  T_fin =10,
  pi0 = pi0,
  change_time = change_time,
  dic = FALSE,
  casename = "Hubei_step",
  save_files = FALSE,
  save_mcmc = FALSE,
  save_plot_data = FALSE,
  M = 50,
  nburnin = 1
)
closeAllConnections()

</code></pre>

<hr>
<h2 id='USA_state_N'>Population of US states</h2><span id='topic+USA_state_N'></span>

<h3>Description</h3>

<p>Data frame with the populations of each state.
</p>


<h3>Format</h3>

<p>a list with
</p>

<ul>
<li><p>Province_State State as a character string
</p>
</li>
<li><p>N Population of the state
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
