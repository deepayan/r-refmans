<!DOCTYPE html><html lang="en"><head><title>Help for package ciuupi2</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ciuupi2}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bsciuupi2'><p>Compute the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the</p>
Kabaila &amp; Giri (2009) CIUUPI</a></li>
<li><a href='#bsspline2'><p>Evaluate the functions b and s at x</p></a></li>
<li><a href='#cistandard2'><p>Compute the usual confidence interval</p></a></li>
<li><a href='#ciuupi2'><p>Compute the Kabaila &amp; Giri (2009) CIUUPI</p></a></li>
<li><a href='#cpciuupi2'><p>Compute the coverage probability of the Kabaila &amp; Giri (2009) CIUUPI</p></a></li>
<li><a href='#find_rho'><p>Find rho</p></a></li>
<li><a href='#sel1ciuupi2'><p>Compute the first definition of the scaled expected length of the Kabaila &amp;</p>
Giri (2009) CIUUPI</a></li>
<li><a href='#sel2ciuupi2'><p>Compute the second definition of the scaled expected length of the Kabaila &amp;</p>
Giri (2009) CIUUPI</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Kabaila and Giri (2009) Confidence Interval</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Computes a confidence interval for a specified linear combination of 
    the regression parameters in a linear regression model with iid normal 
    errors with unknown variance when there is uncertain prior information 
    that a distinct specified linear combination of the regression 
    parameters takes a specified number. This confidence interval, found by 
    numerical nonlinear constrained optimization, has the required minimum coverage 
    and utilizes this uncertain prior information through desirable 
    expected length properties. This confidence interval is proposed by 
    Kabaila, P. and Giri, K. (2009) &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2009.03.018">doi:10.1016/j.jspi.2009.03.018</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>functional, nloptr, pracma, PreciseSums, statmod</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-03-09 22:47:04 UTC; 18881372</td>
</tr>
<tr>
<td>Author:</td>
<td>Nishika Ranathunga [aut],
  Paul Kabaila [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Kabaila &lt;P.Kabaila@latrobe.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-03-11 15:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bsciuupi2'>Compute the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
Kabaila &amp; Giri (2009) CIUUPI</h2><span id='topic+bsciuupi2'></span>

<h3>Description</h3>

<p>Compute the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
Kabaila and Giri (2009) confidence interval that utilizes uncertain prior
information (CIUUPI) and has minimum coverage 1 - <code>alpha</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsciuupi2(alpha, m, rho, obj = 1, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bsciuupi2_+3A_alpha">alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td></tr>
<tr><td><code id="bsciuupi2_+3A_m">m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td></tr>
<tr><td><code id="bsciuupi2_+3A_rho">rho</code></td>
<td>
<p>A known correlation</p>
</td></tr>
<tr><td><code id="bsciuupi2_+3A_obj">obj</code></td>
<td>
<p>Equal to 1 (default) for the first definition of the scaled
expected length or 2 for the second definition of the scaled expected
length</p>
</td></tr>
<tr><td><code id="bsciuupi2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the functions b and s are found by
natural cubic spline interpolation or 0 if these functions are found by
clamped cubic spline interpolation in the interval [-d, d]</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix
with linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is the random error with components that
are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code>
<code>c</code>' <code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code>
are specified linearly independent vectors nonzero <code class="reqn">p</code>-vectors and
<code>t</code> is a specified number. <code>rho</code> is the known correlation between
the least squares estimators of <code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is
determined by the <code class="reqn">n</code> by <code class="reqn">p</code> design matrix X and the
<code class="reqn">p</code>-vectors a and c using <code><a href="#topic+find_rho">find_rho</a></code>.
</p>
<p>The confidence interval for <code class="reqn">\theta</code>, with minimum coverage probability
<code>1 - alpha</code>, that utilizes the uncertain prior information that
<code class="reqn">\tau = </code> <code>t</code> belongs to a class of confidence intervals indexed
by the functions b and s. The function b is an odd continuous function and
the function s is an even continuous function. In addition, b(x)=0 and s(x)
is equal to the <code class="reqn">1 - \alpha/2</code> quantile of the <code class="reqn">t</code> distribution
with <code>m</code> degrees of freedom for all |x| greater than or equal to d,
where d is a sufficiently large positive number (chosen by the function
<code>bsciuupi2</code>). The values of these functions in the interval
<code class="reqn">[-d,d]</code> are specified by the vectors <code class="reqn">(b(d/6), b(2d/6), \dots,
  b(5d/6))</code> and <code class="reqn">(s(0), s(d/6), \dots, s(5d/6))</code> as follows. By
assumption, <code class="reqn">b(0)=0</code> and <code class="reqn">b(-i)=-b(i)</code> and <code class="reqn">s(-i)=s(i)</code> for
<code class="reqn">i=d/6,...,d</code>. The values of <code class="reqn">b(x)</code> and <code class="reqn">s(x)</code> for any <code class="reqn">x</code>
in the interval <code class="reqn">[-d,d]</code> are found using cube spline interpolation for
the given values of <code class="reqn">b(i)</code> and <code class="reqn">s(i)</code> for
<code class="reqn">i=-d,-5d/6,...,0,d/6,...,5d/6,d</code>. The choices of <code class="reqn">d</code> for <code class="reqn">m =
  1, 2</code> and <code class="reqn">&gt;2</code> are <code class="reqn">d=20, 10</code> and <code class="reqn">6</code>, respectively.
</p>
<p>The vector  <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6), \dots,
  s(5d/6))</code> is found by numerical nonlinear constrained optimization so that
the confidence interval has minimum coverage probability <code>1 - alpha</code>
and utilizes the uncertain prior information that <code class="reqn">\tau = </code> t through
its desirable expected length properties. The optimization is performed
using the <code>slsqp</code> function in the <code>nloptr</code> package.
</p>
<p>The first definition of the scaled expected length of the Kabaila and
Giri(2009) CIUUPI is the expected length of this confidence interval
divided by the expected length of the usual confidence interval with
coverage probability <code>1 - alpha</code>. The second definition of the scaled
expected length of the Kabaila and Giri(2009) CIUUPI is the expected value
of the ratio of the length of this confidence interval divided by the
length of the usual confidence interval, with coverage probability <code>1
  - alpha</code>, computed from the same data.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example
described in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>.
</p>


<h3>Value</h3>

<p>The vector <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6),
  \dots, s(5d/6))</code> that specifies the Kabaila &amp; Giri (2009) CIUUPI, with
minimum coverage 1 - <code>alpha</code>.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, R. (2009).  Confidence intervals in
regression utilizing prior information. Journal of Statistical Planning and
Inference, 139, 3419-3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compute the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI, with minimum coverage 1 - alpha,
# for the first definition of the scaled expected length (default)
# for given alpha, m and rho (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha = 0.05, m = 8, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
# c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
#    1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)


</code></pre>

<hr>
<h2 id='bsspline2'>Evaluate the functions b and s at x</h2><span id='topic+bsspline2'></span>

<h3>Description</h3>

<p>Evaluate the functions b and s, as specified by the vector
(b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6)) computed using
<code>bsciuupi2</code>, <code>alpha</code>, <code>m</code>
and <code>natural</code> at <code>x</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bsspline2(x, bsvec, alpha, m, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bsspline2_+3A_x">x</code></td>
<td>
<p>A value or vector of values at which the functions b and s are to be
evaluated</p>
</td></tr>
<tr><td><code id="bsspline2_+3A_bsvec">bsvec</code></td>
<td>
<p>The vector <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6),
\dots, s(5d/6))</code> computed using <code>bsciuupi2</code></p>
</td></tr>
<tr><td><code id="bsspline2_+3A_alpha">alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td></tr>
<tr><td><code id="bsspline2_+3A_m">m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td></tr>
<tr><td><code id="bsspline2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are evaluated by
natural cubic spline interpolation or 0 if evaluated by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function b is an odd continuous function and the function s is an
even continuous function. In addition, b(x)=0 and s(x) is equal to the
<code class="reqn">1 - \alpha/2</code> quantile of the <code class="reqn">t</code> distribution with <code>m</code>
degrees of freedom for all |x| greater than or equal to d, where d is a
sufficiently large positive number (chosen by the function
<code>bsciuupi2</code>). The values of these functions in the interval
<code class="reqn">[-d,d]</code> are specified by the vector <code class="reqn">(b(d/6), b(2d/6), \dots,
 b(5d/6), s(0), s(d/6), \dots, s(5d/6))</code> as follows. By assumption,
<code class="reqn">b(0)=0</code> and <code class="reqn">b(-i)=-b(i)</code> and <code class="reqn">s(-i)=s(i)</code> for
<code class="reqn">i=d/6,...,d</code>. The values of <code class="reqn">b(x)</code> and <code class="reqn">s(x)</code> for any <code class="reqn">x</code>
in the interval <code class="reqn">[-d,d]</code> are found using cubic spline interpolation for
the given values of <code class="reqn">b(i)</code> and <code class="reqn">s(i)</code> for
<code class="reqn">i=-d,-5d/6,...,0,d/6,...,5d/6,d</code>. The choices of <code class="reqn">d</code> for <code class="reqn">m =
 1, 2</code> and <code class="reqn">&gt;2</code> are <code class="reqn">d=20, 10</code> and <code class="reqn">6</code> respectively.
</p>
<p>The vector <code class="reqn">(b(d/6), b(2d/6), \dots, b(5d/6), s(0), s(d/6), \dots,
 s(5d/6))</code> that specifies the Kabaila and Giri(2009) confidence interval that
utilizes uncertain prior information (CIUUPI), with minimum coverage
probability <code>1 - alpha</code>, is obtained using
<code><a href="#topic+bsciuupi2">bsciuupi2</a></code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>.
</p>


<h3>Value</h3>

<p>A data frame containing <code>x</code> and the corresponding values of the
functions b and s.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, R. (2009).  Confidence intervals in
regression utilizing prior information. Journal of Statistical Planning and
Inference, 139, 3419-3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>, <code><a href="#topic+bsciuupi2">bsciuupi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the first definition of the
# scaled expected length (default) (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
            1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)

# Graph the functions b and s
x &lt;- seq(0, 8, by = 0.1)
splineval &lt;- bsspline2(x, bsvec, alpha, m)

plot(x, splineval[, 2], type = "l", main = "b function",
ylab = " ", las = 1, lwd = 2, xaxs = "i", col = "blue")
plot(x, splineval[, 3], type = "l", main = "s function",
ylab = " ", las = 1, lwd = 2, xaxs = "i",  col = "blue")

</code></pre>

<hr>
<h2 id='cistandard2'>Compute the usual confidence interval</h2><span id='topic+cistandard2'></span>

<h3>Description</h3>

<p>Compute the usual 1 - <code>alpha</code> confidence interval
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cistandard2(X, a, y, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cistandard2_+3A_x">X</code></td>
<td>
<p>A known <code class="reqn">n</code> by <code class="reqn">p</code> matrix</p>
</td></tr>
<tr><td><code id="cistandard2_+3A_a">a</code></td>
<td>
<p>A <code class="reqn">p</code>-vector used to specify the parameter of interest</p>
</td></tr>
<tr><td><code id="cistandard2_+3A_y">y</code></td>
<td>
<p>The <code class="reqn">n</code>-vector of observed responses</p>
</td></tr>
<tr><td><code id="cistandard2_+3A_alpha">alpha</code></td>
<td>
<p>1 - <code>alpha</code> is the coverage probability of the
confidence interval</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">Y = X \beta + \epsilon</code>
</p>
<p> is a random <code class="reqn">n</code>-vector
of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix with linearly
independent columns, <code class="reqn">\beta</code> is an unknown parameter <code class="reqn">p</code>-vector and
<code class="reqn">\epsilon</code> is the random error with components that
are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>, where <code>a</code> is a specified <code class="reqn">p</code>-vector.
Then <code>cistandard2</code>
computes the usual 1 - <code>alpha</code> confidence interval for <code class="reqn">\theta</code>,
for given <code class="reqn">n</code>-vector of observed responses <code>y</code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>, for the vector of observed
responses <code class="reqn">y</code> = (-1.3, 0.8, 2.6, 5.8, 0.3, 1.3, 4.3, 5.0, -0.4, 1.0,
5.2, 6.2).
</p>
<p>The design matrix <code class="reqn">X</code> and the vector <code>a</code> (denoted in
R by a.vec) are entered into R using the commands
in the following example.
</p>


<h3>Value</h3>

<p>The usual 1 - <code>alpha</code> confidence interval.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression
utilizing prior information.  Journal of Statistical Planning and Inference,
139, 3419 - 3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>col1 &lt;- rep(1,4)
col2 &lt;- c(-1, 1, -1, 1)
col3 &lt;- c(-1, -1, 1, 1)
col4 &lt;- c(1, -1, -1, 1)
X.single.rep &lt;- cbind(col1, col2, col3, col4)
X &lt;- rbind(X.single.rep, X.single.rep, X.single.rep)
a.vec &lt;- c(0, 2, 0, -2)
y &lt;- c(-1.3, 0.8, 2.6, 5.8, 0.3, 1.3, 4.3, 5.0, -0.4, 1.0, 5.2, 6.2)

# Calculate the usual 95% confidence interval
res &lt;- cistandard2(X, a=a.vec, y, alpha = 0.05)
res

# The usual 1 - alpha confidence interval for theta is (-0.08185, 3.08185)

</code></pre>

<hr>
<h2 id='ciuupi2'>Compute the Kabaila &amp; Giri (2009) CIUUPI</h2><span id='topic+ciuupi2'></span>

<h3>Description</h3>

<p>Compute the Kabaila and Giri (2009) confidence interval that utilizes
uncertain prior information (CIUUPI), with minimum coverage 1 - <code>alpha</code>,
for a given vector <code>y</code> of observed responses.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciuupi2(alpha, X, a, c, bsvec, t, y, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ciuupi2_+3A_alpha">alpha</code></td>
<td>
<p>1 - <code>alpha</code> is the minimum coverage probability of the
confidence interval</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_x">X</code></td>
<td>
<p>The <code class="reqn">n</code> by <code class="reqn">p</code> design matrix</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_a">a</code></td>
<td>
<p>A vector used to specify the parameter of interest</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_c">c</code></td>
<td>
<p>A vector used to specify the parameter about which we have uncertain
prior information</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_bsvec">bsvec</code></td>
<td>
<p>The vector (b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6))
computed using <code>bsciuupi2</code></p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_t">t</code></td>
<td>
<p>A number used to specify the uncertain prior information, which has
the form <code class="reqn">\tau =</code> t</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_y">y</code></td>
<td>
<p>The <code class="reqn">n</code>-vector of observed responses</p>
</td></tr>
<tr><td><code id="ciuupi2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are evaluated by
natural cubic spline interpolation or 0 if evaluated by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix
with linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with components
that are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code> <code>c</code>'
<code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code> are
specified linearly independent vectors nonzero <code class="reqn">p</code>-vectors and <code>t</code>
is a specified number. Given the vector <code>bsvec</code>, computed using
<code><a href="#topic+bsciuupi2">bsciuupi2</a></code>, the design matrix <code>X</code>, the vectors <code>a</code>
and <code>c</code> and the number t, <code>ciuupi2</code> computes the confidence
interval for <code class="reqn">\theta</code> that utilizes the uncertain prior information that
<code class="reqn">\tau</code> = <code>t</code> for given <code class="reqn">n</code>-vector of observed responses
<code>y</code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>, for the vector of observed
responses <code class="reqn">y</code> = (-1.3, 0.8, 2.6, 5.8, 0.3, 1.3, 4.3, 5.0, -0.4, 1.0,
5.2, 6.2).
</p>


<h3>Value</h3>

<p>The Kabaila &amp; Giri (2009) confidence interval, with minimum coverage 1
- <code>alpha</code>, that utilizes the uncertain prior information.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139, 3419 -
3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>, <code><a href="#topic+bsciuupi2">bsciuupi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Specify the design matrix X and vectors a and c
# (denoted in R by a.vec and c.vec, respectively)
col1 &lt;- rep(1,4)
col2 &lt;- c(-1, 1, -1, 1)
col3 &lt;- c(-1, -1, 1, 1)
col4 &lt;- c(1, -1, -1, 1)
X.single.rep &lt;- cbind(col1, col2, col3, col4)
X &lt;- rbind(X.single.rep, X.single.rep, X.single.rep)
a.vec &lt;- c(0, 2, 0, -2)
c.vec &lt;- c(0, 0, 0, 1)


# Compute the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI, with minimum coverage 1 - alpha, for the
# first definition of the scaled expected length (default)
# for given alpha, m and rho (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha = 0.05, m = 8, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
            1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)


# Specify t and y
t &lt;- 0
y &lt;- c(-1.3, 0.8, 2.6, 5.8, 0.3, 1.3, 4.3, 5.0, -0.4, 1.0, 5.2, 6.2)

# Find the Kabaila and Giri (2009) CIUUPI, with minimum coverage 1 - alpha,
# for the first definition of the scaled expected length
res &lt;- ciuupi2(alpha=0.05, X, a=a.vec, c=c.vec, bsvec, t, y, natural = 1)
res

# The Kabaila and Giri (2009) CIUUPI, with minimum coverage 1 - alpha,
# is (0.14040, 2.85704).
# The usual 1 - alpha confidence interval for theta is (-0.08185, 3.08185).

</code></pre>

<hr>
<h2 id='cpciuupi2'>Compute the coverage probability of the Kabaila &amp; Giri (2009) CIUUPI</h2><span id='topic+cpciuupi2'></span>

<h3>Description</h3>

<p>Evaluate the coverage probability of the Kabaila &amp; Giri (2009) confidence
interval that utilizes uncertain prior information (CIUUPI),
with minimum coverage 1 - <code>alpha</code>, at <code>gam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpciuupi2(gam, bsvec, alpha, m, rho, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpciuupi2_+3A_gam">gam</code></td>
<td>
<p>A value of gamma or vector of gamma values at which the coverage
probability function is evaluated</p>
</td></tr>
<tr><td><code id="cpciuupi2_+3A_bsvec">bsvec</code></td>
<td>
<p>The vector (b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6))
computed using <code>bsciuupi2</code></p>
</td></tr>
<tr><td><code id="cpciuupi2_+3A_alpha">alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td></tr>
<tr><td><code id="cpciuupi2_+3A_m">m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td></tr>
<tr><td><code id="cpciuupi2_+3A_rho">rho</code></td>
<td>
<p>A known correlation</p>
</td></tr>
<tr><td><code id="cpciuupi2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are obtained by
natural cubic spline interpolation or 0 if obtained by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix
with linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with
components that are independent and identically normally distributed with
zero mean and unknown variance. The parameter of interest is <code class="reqn">\theta = </code>
<code>a</code>' <code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code>
<code>c</code>' <code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code>
are specified linearly independent vectors and <code>t</code> is a specified
number. <code>rho</code> is the known correlation between the least squares
estimators of <code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is determined by the <code class="reqn">n</code>
by <code class="reqn">p</code> design matrix X and the <code class="reqn">p</code>-vectors a and c using
<code><a href="#topic+find_rho">find_rho</a></code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>.
</p>


<h3>Value</h3>

<p>The value(s) of the coverage probability of the Kabaila &amp; Giri (2009)
CIUUPI at <code>gam</code>.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139, 3419 -
3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>, <code><a href="#topic+bsciuupi2">bsciuupi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the first definition of the
# scaled expected length (default) (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
            1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)


# Graph the coverage probability function
gam &lt;- seq(0, 10, by = 0.1)
cp &lt;- cpciuupi2(gam, bsvec, alpha, m, rho = -0.7071068)
plot(gam, cp, type = "l", lwd = 2, ylab = "", las = 1, xaxs = "i",
main = "Coverage Probability", col = "blue",
xlab = expression(paste("|", gamma, "|")), ylim = c(0.9490, 0.9510))
abline(h = 1-alpha, lty = 2)

</code></pre>

<hr>
<h2 id='find_rho'>Find rho</h2><span id='topic+find_rho'></span>

<h3>Description</h3>

<p>Find the correlation rho for given <code class="reqn">n</code> by <code class="reqn">p</code> design matrix X and
given <code class="reqn">p</code>-vectors a and c
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_rho(X, a, c)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_rho_+3A_x">X</code></td>
<td>
<p>The <code class="reqn">n</code> by <code class="reqn">p</code> design matrix</p>
</td></tr>
<tr><td><code id="find_rho_+3A_a">a</code></td>
<td>
<p>A vector used to specify the parameter of interest</p>
</td></tr>
<tr><td><code id="find_rho_+3A_c">c</code></td>
<td>
<p>A vector used to specify the parameter about which we have uncertain
prior information</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix
with linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with
components that are independent and identically normally distributed with
zero mean and unknown variance. The parameter of interest is <code class="reqn">\theta =
  </code> <code>a</code>' <code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau
  = </code> <code>c</code>' <code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and
<code>c</code> are specified linearly independent nonzero <code class="reqn">p</code>-vectors and
<code>t</code> is a specified number. <code>rho</code> is the known correlation between
the least squares estimators of <code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is
determined by the <code class="reqn">n</code> by <code class="reqn">p</code> design matrix X and the
<code class="reqn">p</code>-vectors a and c.
</p>


<h3>Value</h3>

<p>The value of the correlation rho.
</p>


<h3><code class="reqn">X</code>, <code>a</code> and <code>c</code> for a particular example</h3>

<p>Consider
the same 2 x 2 factorial example as that described in Section 4 of Kabaila
and Giri (2009), except that the number of replicates is 3 instead of 20.
In this case, <code class="reqn">X</code> is a 12 x 4 matrix, <code class="reqn">\beta</code> is an unknown
parameter 4-vector and <code class="reqn">\epsilon</code> is a random 12-vector with components
that are independent and identically normally distributed with zero mean
and unknown variance. In other words, the length of the response vector
<code class="reqn">y</code> is <code class="reqn">n</code> = 12 and the length of the parameter vector <code class="reqn">\beta</code>
is <code class="reqn">p</code> = 4, so that <code class="reqn">m = n - p</code> = 8. The parameter of interest is
<code class="reqn">\theta = </code> <code>a</code>' <code class="reqn">\beta</code>, where the column vector <code>a</code> =
(0, 2, 0, -2). Also, the parameter <code class="reqn">\tau = </code> <code>c</code>' <code class="reqn">\beta</code>,
where the column vector <code>c</code> = (0, 0, 0, 1). The uncertain prior
information is that <code class="reqn">\tau = </code> <code>t</code>, where <code>t</code> = 0.
</p>
<p>The design matrix <code class="reqn">X</code> and the vectors <code>a</code> and <code>c</code> (denoted in
R by a.vec and c.vec, respectively) are entered into R using the commands
in the following example.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, R. (2009).  Confidence intervals in
regression utilizing prior information. Journal of Statistical Planning and
Inference, 139, 3419-3429.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>col1 &lt;- rep(1,4)
col2 &lt;- c(-1, 1, -1, 1)
col3 &lt;- c(-1, -1, 1, 1)
col4 &lt;- c(1, -1, -1, 1)
X.single.rep &lt;- cbind(col1, col2, col3, col4)
X &lt;- rbind(X.single.rep, X.single.rep, X.single.rep)
a.vec &lt;- c(0, 2, 0, -2)
c.vec &lt;- c(0, 0, 0, 1)

# Find the value of rho
rho &lt;- find_rho(X, a=a.vec, c=c.vec)
rho

# The value of rho is -0.7071068

</code></pre>

<hr>
<h2 id='sel1ciuupi2'>Compute the first definition of the scaled expected length of the Kabaila &amp;
Giri (2009) CIUUPI</h2><span id='topic+sel1ciuupi2'></span>

<h3>Description</h3>

<p>Evaluate the first definition of the scaled expected length of the Kabaila &amp;
Giri (2009) confidence interval that utilizes uncertain prior information
(CIUUPI), with minimum coverage 1 - <code>alpha</code>, at <code>gam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel1ciuupi2(gam, bsvec, alpha, m, rho, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sel1ciuupi2_+3A_gam">gam</code></td>
<td>
<p>A value of gamma or vector of gamma values at which the first
definition of the scaled expected length function is evaluated</p>
</td></tr>
<tr><td><code id="sel1ciuupi2_+3A_bsvec">bsvec</code></td>
<td>
<p>The vector (b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6))
computed using <code>bsciuupi2</code></p>
</td></tr>
<tr><td><code id="sel1ciuupi2_+3A_alpha">alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td></tr>
<tr><td><code id="sel1ciuupi2_+3A_m">m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td></tr>
<tr><td><code id="sel1ciuupi2_+3A_rho">rho</code></td>
<td>
<p>A known correlation</p>
</td></tr>
<tr><td><code id="sel1ciuupi2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are obtained by
natural cubic spline interpolation or 0 if obtained by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix with
linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with components
that are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code> <code>c</code>'
<code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code> are
specified linearly independent vectors and <code>t</code> is a specified number.
<code>rho</code> is the known correlation between the least squares estimators of
<code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is determined by the <code class="reqn">n</code> by <code class="reqn">p</code> design
matrix X and the <code class="reqn">p</code>-vectors a and c using <code><a href="#topic+find_rho">find_rho</a></code>.
</p>
<p>The Kabaila &amp; Giri (2009) CIUUPI is specified by the vector
(b(d/6),...,b(5d/6),s(0),...,s(5d/6)), <code>alpha</code>, <code>m</code> and
<code>natural</code>
</p>
<p>The first definition of the scaled expected length of the Kabaila and
Giri(2009) CIUUPI is the expected length of this confidence interval divided
by the expected length of the usual confidence interval with coverage
probability <code>1 - alpha</code>.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>.
</p>


<h3>Value</h3>

<p>The value(s) of the first definition of the scaled expected length of
the Kabaila &amp; Giri (2009) CIUUPI at <code>gam</code>.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139, 3419 -
3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>, <code><a href="#topic+bsciuupi2">bsciuupi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the first definition of the
# scaled expected length (default) (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0287487, -0.2151595, -0.3430403, -0.3125889, -0.0852146,
            1.9795390,  2.0665414,  2.3984471,  2.6460159,  2.6170066,  2.3925494)


# Graph the squared scaled expected length function
gam &lt;- seq(0, 10, by = 0.1)
sel &lt;- sel1ciuupi2(gam, bsvec, alpha, m, rho = -0.7071068)
plot(gam, sel^2, type = "l", lwd = 2, ylab = "", las = 1, xaxs = "i",
main = "Squared Scaled Expected Length", col = "blue",
xlab = expression(paste("|", gamma, "|")))
abline(h = 1, lty = 2)

</code></pre>

<hr>
<h2 id='sel2ciuupi2'>Compute the second definition of the scaled expected length of the Kabaila &amp;
Giri (2009) CIUUPI</h2><span id='topic+sel2ciuupi2'></span>

<h3>Description</h3>

<p>Evaluate the second definition of the scaled expected length of the Kabaila &amp;
Giri (2009) confidence interval that utilizes uncertain prior information
(CIUUPI), with minimum coverage 1 - <code>alpha</code>, at <code>gam</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel2ciuupi2(gam, bsvec, alpha, m, rho, natural = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sel2ciuupi2_+3A_gam">gam</code></td>
<td>
<p>A value of gamma or vector of gamma values at which the second
definition of the scaled expected length function is evaluated</p>
</td></tr>
<tr><td><code id="sel2ciuupi2_+3A_bsvec">bsvec</code></td>
<td>
<p>The vector (b(d/6),b(2d/6),...,b(5d/6),s(0),s(d/6),...,s(5d/6))
computed using <code>bsciuupi2</code></p>
</td></tr>
<tr><td><code id="sel2ciuupi2_+3A_alpha">alpha</code></td>
<td>
<p>The minimum coverage probability is 1 - <code>alpha</code></p>
</td></tr>
<tr><td><code id="sel2ciuupi2_+3A_m">m</code></td>
<td>
<p>Degrees of freedom <code>n - p</code></p>
</td></tr>
<tr><td><code id="sel2ciuupi2_+3A_rho">rho</code></td>
<td>
<p>A known correlation</p>
</td></tr>
<tr><td><code id="sel2ciuupi2_+3A_natural">natural</code></td>
<td>
<p>Equal to 1 (default) if the b and s functions are obtained by
natural cubic spline interpolation or 0 if obtained by clamped cubic spline
interpolation. This parameter must take the same value as that used in
<code>bsciuupi2</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Suppose that </p>
<p style="text-align: center;"><code class="reqn">y = X \beta + \epsilon</code>
</p>
<p> where <code class="reqn">y</code> is a random
<code class="reqn">n</code>-vector of responses, <code class="reqn">X</code> is a known <code class="reqn">n</code> by <code class="reqn">p</code> matrix with
linearly independent columns, <code class="reqn">\beta</code> is an unknown parameter
<code class="reqn">p</code>-vector and <code class="reqn">\epsilon</code> is a random <code class="reqn">n</code>-vector with components
that are independent and identically normally distributed with zero mean and
unknown variance. The parameter of interest is <code class="reqn">\theta = </code> <code>a</code>'
<code class="reqn">\beta</code>. The uncertain prior information is that <code class="reqn">\tau = </code> <code>c</code>'
<code class="reqn">\beta</code> takes the value <code>t</code>, where <code>a</code> and <code>c</code> are
specified linearly independent vectors and <code>t</code> is a specified number.
<code>rho</code> is the known correlation between the least squares estimators of
<code class="reqn">\theta</code> and <code class="reqn">\tau</code>. It is determined by the <code class="reqn">n</code> by <code class="reqn">p</code> design
matrix X and the <code class="reqn">p</code>-vectors a and c using <code><a href="#topic+find_rho">find_rho</a></code>.
</p>
<p>The Kabaila &amp; Giri (2009) CIUUPI is specified by the vector
(b(d/6),...,b(5d/6),s(0),...,s(5d/6)), <code>alpha</code>, <code>m</code> and
<code>natural</code>
</p>
<p>The second definition of the scaled expected length of the Kabaila and
Giri(2009) CIUUPI is the expected value of the ratio of the length of this
confidence interval divided by the length of the usual confidence interval,
with coverage probability <code>1 - alpha</code>, computed from the same data.
</p>
<p>In the examples, we continue with the same 2 x 2 factorial example described
in the documentation for <code><a href="#topic+find_rho">find_rho</a></code>.
</p>


<h3>Value</h3>

<p>The value(s) of the second definition of the scaled expected length of
the Kabaila &amp; Giri (2009) CIUUPI at <code>gam</code>.
</p>


<h3>References</h3>

<p>Kabaila, P. and Giri, K. (2009) Confidence intervals in regression utilizing
prior information.  Journal of Statistical Planning and Inference, 139, 3419 -
3429.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+find_rho">find_rho</a></code>, <code><a href="#topic+bsciuupi2">bsciuupi2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
m &lt;- 8

# Find the vector (b(d/6),...,b(5d/6),s(0),...,s(5d/6)) that specifies the
# Kabaila &amp; Giri (2009) CIUUPI for the second definition of the
# scaled expected length (takes about 30 mins to run):

bsvec &lt;- bsciuupi2(alpha, m, rho = -0.7071068, obj = 2)


# The result bsvec is (to 7 decimal places) the following:
bsvec &lt;- c(-0.0344224, -0.2195927, -0.3451243, -0.3235045, -0.1060439,
            1.9753281,  2.0688684,  2.3803642,  2.6434660,  2.6288564,  2.4129931)


# Graph the squared scaled expected length function
gam &lt;- seq(0, 10, by = 0.1)
sel &lt;- sel2ciuupi2(gam, bsvec, alpha, m, rho = -0.7071068)
plot(gam, sel^2, type = "l", lwd = 2, ylab = "", las = 1, xaxs = "i",
main = "Squared Scaled Expected Length", col = "blue",
xlab = expression(paste("|", gamma, "|")))
abline(h = 1, lty = 2)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
