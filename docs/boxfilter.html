<!DOCTYPE html><html><head><title>Help for package boxfilter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {boxfilter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boxclip'>
<p>Boxfilter Main Function</p></a></li>
<li><a href='#clipview'>
<p>Get View Of Different clipit  Values</p></a></li>
<li><a href='#ibex_hr'>
<p>One year of heart rates of a capricorn free-living in the alps.</p></a></li>
<li><a href='#showdata'>
<p>Boxfilter function</p></a></li>
<li><a href='#sleepduration'>
<p>data centering around sleeop in a humam</p></a></li>
<li><a href='#store'>
<p>Store data</p></a></li>
<li><a href='#summary.boxclip'>
<p>Summarize boxclip results</p></a></li>
<li><a href='#wb_month'>
<p>One month of heart rates and their quality in a wild boar. Quality was assessed by Star-Oddi, Island.</p></a></li>
<li><a href='#wb_year'>
<p>One year of heart rates of a wild boar female.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Filter Noisy Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-05-24</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thomas Ruf &lt;Thomas.P.Ruf@me.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Noise filter based on determining the proportion of neighboring points. A false point will be rejected if it has only few neighbors, but accepted if the proportion of neighbors in a rectangular frame is high. The size of the rectangular frame as well as the cut-off value, i.e. of a minimum proportion of neighbor-points, may be supplied or can be calculated automatically. Originally designed for the cleaning of heart rates, but suitable for filtering any slowly-changing physiological variable.For more information see Signer (2010)&lt;<a href="https://doi.org/10.1111%2Fj.2041-210X.2009.00010.x">doi:10.1111/j.2041-210X.2009.00010.x</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, gridExtra</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.50)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-05-24 10:57:28 UTC; ruf</td>
</tr>
<tr>
<td>Author:</td>
<td>Thomas Ruf <a href="https://orcid.org/0000-0002-9235-7079"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-05-24 11:20:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='boxclip'>
Boxfilter Main Function
</h2><span id='topic+boxclip'></span>

<h3>Description</h3>

<p>Filters noise from data (e.g. heartrates) using x for x-axis data and y for y-axis, based on the proportion of neighbors of each point in a surrounding box of width and height (these may be determined automatically). It discards all data points that have less than a proportion of clipit neighbors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>boxclip (x=NULL,y,clipit=NULL,QI=NULL,width=NULL, height=NULL,
miny=min(y,na.rm=TRUE), maxy=max(y,na.rm=TRUE), plotit=TRUE, histo=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="boxclip_+3A_x">x</code></td>
<td>

<p>The x-axis of data, a datetime for example. Optional. If x=NULL x&lt;-1:length(y) will be generated.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_y">y</code></td>
<td>

<p>The y-axis of data, probably noisy. Required.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_clipit">clipit</code></td>
<td>

<p>Optional. Y-values with less than a proportion of clipit neighbors will be discarded.
If clipit is omitted it is set equal to the first trough in the neighbor proportion histogram.
</p>
</td></tr></table>
<p>ci
</p>
<table>
<tr><td><code id="boxclip_+3A_qi">QI</code></td>
<td>

<p>Optional. An integer quality index for each data point.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_width">width</code></td>
<td>

<p>Optional. The width of the box. If width is omitted it will be generated from floor(length(x)*0.01).
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_height">height</code></td>
<td>

<p>Optional. The height of the box. If height is omitted it will be generated from floor(mean(y,na.rm=T)/4).
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_miny">miny</code></td>
<td>

<p>The minimum y-value expected. Anything below miny is discarded.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_maxy">maxy</code></td>
<td>

<p>The maximum y-value expected. Anything above maxy is discarded.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_plotit">plotit</code></td>
<td>

<p>Optional.If TRUE show a graph of the original and filtered data.
</p>
</td></tr>
<tr><td><code id="boxclip_+3A_histo">histo</code></td>
<td>

<p>Optional. If TRUE also show a histogram of the neighboring points.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Boxfilter mimics the human criterion of self-similarity.
Data points with many neighbors are more trustworthy.
</p>


<h3>Value</h3>


<table>
<tr><td><code>x</code></td>
<td>
<p>Original x-axis data</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Original y-axis data</p>
</td></tr>
<tr><td><code>filtered</code></td>
<td>
<p>Filtered data. Discarded data points are set to NA.</p>
</td></tr>
<tr><td><code>neighbors</code></td>
<td>
<p>Proportion of neighbors of each point.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>To store only filtered data, use e.g.:
</p>
<p>bc=boxclip (x,y)
data=data.frame(x=bc$x, hrf=bc$filtered)
data=na.omit(data)
write.csv(data,file=&quot;myheartrates.csv&quot;)
</p>


<h3>Author(s)</h3>

<p>Thomas Ruf (thomas.p.ruf@me.com)
</p>


<h3>See Also</h3>

<p>clipview
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("wb_month")
data("ibex_hr")

x=wb_month$x
y=wb_month$hr


myclip=boxclip(x,y, histo=TRUE)
summary(myclip)

r=seq(1,28400,by=4) 
myclip=boxclip(ibex_hr$Time[r],ibex_hr$Heartrate[r],0.65)
summary(myclip)
#store(myclip)


data("sleepduration")
Date=as.POSIXct(sleepduration$Date)
Duration=as.numeric(sleepduration$Bedtime)
boxclip(Date,Duration,miny=0)
</code></pre>

<hr>
<h2 id='clipview'>
Get View Of Different clipit  Values
</h2><span id='topic+clipview'></span>

<h3>Description</h3>

<p>Gives a view of the original data, a histogram of the neighbors, and results of four values of clipit. The cutoff-values clipit are determined  by a sequence of length .-
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clipview (x=NULL,y,clipit=NULL,width=NULL, height=NULL,
miny=min(y,na.rm=TRUE), maxy=max(y,na.rm=TRUE),plotit=FALSE)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clipview_+3A_x">x</code></td>
<td>

<p>The x-axis of data, a datetime for example. Optional. If x=NULL x&lt;-1:length(y) will be generated.
</p>
</td></tr>
<tr><td><code id="clipview_+3A_y">y</code></td>
<td>

<p>The y-axis of data, probably noisy. Required.
</p>
</td></tr>
<tr><td><code id="clipview_+3A_clipit">clipit</code></td>
<td>

<p>This function requires a sequence of four items &lt;1, e.g. clipit=seq(0.1, 0.4, by=0.1)
</p>
</td></tr>
<tr><td><code id="clipview_+3A_width">width</code></td>
<td>

<p>Optional. The width of the box. If width is omitted it will be generated from floor(length(x)*0.01).
</p>
</td></tr>
<tr><td><code id="clipview_+3A_height">height</code></td>
<td>

<p>Optional. The height of the box. If height is omitted it will be generated from floor(mean(y,na.rm=T)/4).
</p>
</td></tr>
<tr><td><code id="clipview_+3A_miny">miny</code></td>
<td>

<p>The minimum y-value expected. Anything below miny is discarded.
</p>
</td></tr>
<tr><td><code id="clipview_+3A_maxy">maxy</code></td>
<td>

<p>The minimum y-value expected. Anything above maxy is discarded.
</p>
</td></tr>
<tr><td><code id="clipview_+3A_plotit">plotit</code></td>
<td>

<p>Optional.If TRUE show a graph of the original and filtered data.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that a sequence is required for clipit here, while a scalar is required in boxclip().
</p>


<h3>Value</h3>

<p>There is no return value.Six graphs are generated, original, histogram, and four for each value of clipit.
</p>


<h3>Author(s)</h3>

<p>Thomas Ruf (thomas.p.ruf@me.com)
</p>


<h3>See Also</h3>

<p>boxclip()
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("wb_year")


r=seq(1,54179,by=5)   

x=wb_year$x[r]
y=wb_year$y[r]

clipview(x,y,clipit=seq(0.2,0.5,0.1), miny=10)

</code></pre>

<hr>
<h2 id='ibex_hr'>
One year of heart rates of a capricorn free-living in the alps.
</h2><span id='topic+ibex_hr'></span>

<h3>Description</h3>

<p>Heart rates were obtained using acoustic loggers in the rumen.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ibex_hr")</code></pre>


<h3>Format</h3>

<p>A data frame with 28454 observations on the following 2 variables.
</p>

<dl>
<dt><code>Time</code></dt><dd><p>datetime</p>
</dd>
<dt><code>Heartrate</code></dt><dd><p>in bpm</p>
</dd>
</dl>



<h3>References</h3>

<p>Signer, C., Ruf, T., &amp; Arnold, W. (2011). Hypometabolism and basking: The strategies of Alpine ibex to endure harsh over‐wintering conditions. Functional Ecology, 25(3), 537-547.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ibex_hr)
</code></pre>

<hr>
<h2 id='showdata'>
Boxfilter function
</h2><span id='topic+showdata'></span>

<h3>Description</h3>

<p>Shows a graph of the data and its change over time.Called by boxclip()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showdata(x,y)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showdata_+3A_x">x</code></td>
<td>

<p>The x-axis of data, a datetime for example.
</p>
</td></tr>
<tr><td><code id="showdata_+3A_y">y</code></td>
<td>

<p>The y-axis of data, probably noisy.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Asks the user whether to continue or not.Continue only if you want points to be deleted
</p>


<h3>Author(s)</h3>

<p>Thomas Ruf (thomas.p.ruf@me.com)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
y=runif(1000,20,30)
ix=sample(1:1000,50)
y[ix]=runif(50,60,70)
showdata(1:1000,y)
</code></pre>

<hr>
<h2 id='sleepduration'>
data centering around sleeop in a humam
</h2><span id='topic+sleepduration'></span>

<h3>Description</h3>

<p>data on duration in bed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sleepduration")</code></pre>


<h3>Format</h3>

<p>A data frame with 881 observations on the following 2 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a character vector</p>
</dd>
<dt><code>Bedtime</code></dt><dd><p>a character vector, convert to decimal number</p>
</dd>
</dl>



<h3>Source</h3>

<p>https://www.kaggle.com/datasets/danagerous/sleep-data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sleepduration)
## maybe str(sleepduration) ; plot(sleepduration) ...
</code></pre>

<hr>
<h2 id='store'>
Store data
</h2><span id='topic+store'></span>

<h3>Description</h3>

<p>Stores original and filtered data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>store(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="store_+3A_object">object</code></td>
<td>

<p>Must be of class &quot;boxclip&quot;, resulting from boxclip.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>returns nothing
</p>


<h3>Author(s)</h3>

<p>Thomas Ruf (thomas.p.ruf@me.com)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data ("wb_month.RData")

x=wb_month$x
y=wb_month$hr

myclip=boxclip(x,y,clipit=0.25,width=15)
summary(myclip)
store(myclip)

</code></pre>

<hr>
<h2 id='summary.boxclip'>
Summarize boxclip results
</h2><span id='topic+summary.boxclip'></span>

<h3>Description</h3>

<p>Summary method for class boxclip.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'boxclip'
summary(object,...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.boxclip_+3A_object">object</code></td>
<td>

<p>an object of class boxclip
</p>
</td></tr>
<tr><td><code id="summary.boxclip_+3A_...">...</code></td>
<td>

<p>currently, no other arguments are required.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>summary.boxclip prints the following items:
</p>
<table>
<tr><td><code>clipit</code></td>
<td>
<p>Cut-off value. Only points with a proportion &gt;= clipit will be retained.</p>
</td></tr>
<tr><td><code>width</code></td>
<td>
<p>Rectangle width in x-units. Filter criterion is the proportion of data points inside the rectangle.</p>
</td></tr>
<tr><td><code>height</code></td>
<td>
<p>Rectangle height in y-units. Filter criterion is the proportion of data points inside the rectangle.</p>
</td></tr>
<tr><td><code>full</code></td>
<td>
<p>Number of original data.</p>
</td></tr>
<tr><td><code>remaining</code></td>
<td>
<p>Number of data remaining.</p>
</td></tr>
<tr><td><code>rest</code></td>
<td>
<p>Percentage remaining.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Thomas Ruf <a href="mailto:thomas.p.ruf@me.com">thomas.p.ruf@me.com</a>
</p>


<h3>References</h3>

<p>Signer (2010) &lt;doi: 10.1111/j.2041-210X.2009.00010.x&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+boxclip">boxclip</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data ("wb_month.RData")

x=wb_month$x
y=wb_month$hr

myclip=boxclip(x,y,clipit=0.25,width=15)
summary(myclip)
</code></pre>

<hr>
<h2 id='wb_month'>
One month of heart rates and their quality in a wild boar. Quality was assessed by Star-Oddi, Island.
</h2><span id='topic+wb_month'></span>

<h3>Description</h3>

<p>Heart rates were obtained from DST centi- HRT, Star-Oddi, Gardabaer, Iceland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wb_month")</code></pre>


<h3>Format</h3>

<p>A data frame with 3720 observations on the following 3 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>x-axis, datetime</p>
</dd>
<dt><code>hr</code></dt><dd><p>y-axis, heart rate</p>
</dd>
<dt><code>QI</code></dt><dd><p>quality index (0-3) of the signal</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(wb_month)
</code></pre>

<hr>
<h2 id='wb_year'>
One year of heart rates of a wild boar female.
</h2><span id='topic+wb_year'></span>

<h3>Description</h3>

<p>Heart rates were obtained from DST centi- HRT, Star-Oddi, Gardabaer, Iceland.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("wb_year")</code></pre>


<h3>Format</h3>

<p>A data frame with 3720 observations on the following 3 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>x-axis, datetime</p>
</dd>
<dt><code>y</code></dt><dd><p>y-axis, heart rate</p>
</dd>
</dl>



<h3>References</h3>

<p>Ruf, T., Vetter, S. G., Painer, J., Stalder, G., &amp; Bieber, C. (2021). Atypical for northern ungulates, energy metabolism is lowest during summer in female wild boars (Sus scrofa). Scientific Reports, 11(1), 1-12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wb_year)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
