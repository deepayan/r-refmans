<!DOCTYPE html><html><head><title>Help for package WaveletComp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {WaveletComp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#analyze.coherency'>
<p>Computation of the cross-wavelet power and wavelet coherence spectrum</p>
of two time series</a></li>
<li><a href='#analyze.wavelet'>
<p>Computation of the wavelet power spectrum of a single time series</p></a></li>
<li><a href='#AR'><p>Simulation of an AR(p) surrogate for a given time series x</p></a></li>
<li><a href='#ARIMA'><p>Simulation of an ARIMA(p,0,q) surrogate for a given time series x</p></a></li>
<li><a href='#arrow'><p>Plot an arrow</p></a></li>
<li><a href='#COI'><p>Computation of the cone of influence</p></a></li>
<li><a href='#FourierRand'><p>Simulation of a surrogate for a given time series x by Fourier randomization</p></a></li>
<li><a href='#FXtrade.transactions'><p>Series of FX trade transactions</p></a></li>
<li><a href='#marriages.Turkey'><p>Series of monthly marriages in Turkey</p></a></li>
<li><a href='#periodic.series'>
<p>Computation of a (deterministic) periodic time series of linearly changing period.</p></a></li>
<li><a href='#reconstruct'>
<p>Reconstruction of a (detrended) time series from output provided by an</p>
object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></a></li>
<li><a href='#ridge'><p>Ridge of a wavelet power or coherence spectrum</p></a></li>
<li><a href='#SurrogateData'><p>Simulation of surrogates for a given time series x, subject to the specified method and parameters</p></a></li>
<li><a href='#USelection2016.Instagram'><p>Hourly time series of the number of candidate-related media posted on Instagram during the week before the 2016 US presidential election</p></a></li>
<li><a href='#WaveletCoherency'><p>Computation of the cross-wavelet power and wavelet coherence of two time series</p></a></li>
<li><a href='#WaveletComp-package'><p>Computational Wavelet Analysis</p></a></li>
<li><a href='#WaveletTransform'><p>Morlet wavelet transformation of a time series</p></a></li>
<li><a href='#wc'><p>Cross-wavelet transformation, wavelet coherence computation, and a simulation algorithm</p></a></li>
<li><a href='#wc.angle'><p>Plot arrows into a cross-wavelet or wavelet coherency spectrum</p></a></li>
<li><a href='#wc.avg'>
<p>Plot cross-wavelet power averages and wavelet coherence averages across time of two time series</p></a></li>
<li><a href='#wc.image'>
<p>Image plot of the cross-wavelet power spectrum and wavelet coherence</p>
spectrum of two time series</a></li>
<li><a href='#wc.phasediff.image'>
<p>Image plot of phase differences of periodic components for two time</p>
series</a></li>
<li><a href='#wc.sel.phases'>
<p>Comparison plot of phases for selected periodic components of two time</p>
series</a></li>
<li><a href='#weather.radiation.Mannheim'><p>Series of weather data and ambient gamma dose rate readings</p></a></li>
<li><a href='#wt'><p>Wavelet transformation, and a simulation algorithm</p></a></li>
<li><a href='#wt.avg'>
<p>Plot of wavelet power averages across time of a single time series</p></a></li>
<li><a href='#wt.image'>
<p>Image plot of the wavelet power spectrum of a single time series</p></a></li>
<li><a href='#wt.phase.image'>
<p>Image plot of the phases of periodic components for a single time</p>
series</a></li>
<li><a href='#wt.sel.phases'>
<p>Plot phases for selected periodic components of a single time series</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-03-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Computational Wavelet Analysis</td>
</tr>
<tr>
<td>Author:</td>
<td>Angi Roesch &lt;angi@angi-stat.com&gt; and Harald Schmidbauer &lt;harald@hs-stat.com&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Angi Roesch &lt;angi@angi-stat.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Wavelet analysis and reconstruction of time series, cross-wavelets and phase-difference (with filtering options), significance with simulation algorithms.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>URL:</td>
<td>Guide booklet at
<a href="http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf">http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-03-18 14:09:15 UTC; angi</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-03-18 14:31:53 UTC</td>
</tr>
</table>
<hr>
<h2 id='analyze.coherency'>
Computation of the cross-wavelet power and wavelet coherence spectrum
of two time series
</h2><span id='topic+analyze.coherency'></span>

<h3>Description</h3>

<p>The two time series are selected from an input data frame by specifying either their names 
or their column numbers. Optionally, the time series are detrended, using <code>loess</code> with parameter
<code>loess.span</code>. Internally, the series will be standardized before they undergo wavelet transformation.
</p>
<p>The cross-wavelet power spectrum is computed applying the Morlet wavelet. 
P-values to test the null hypothesis that a period (within <code>lowerPeriod</code> and <code>upperPeriod</code>) 
is irrelevant at a certain time are calculated if desired; this is accomplished with the help of a
simulation algorithm. There is a selection of models from which to choose the alternative hypothesis.
The selected model will be fitted to the data and simulated according to estimated parameters
in order to provide surrogate time series.
</p>
<p>For the computation of wavelet coherence, a variety of filtering methods is provided, 
with flexible window parameters.
</p>
<p>Wavelet transformation, as well as p-value computations, are carried out by calling subroutine <code>wc</code>.
</p>
<p>The name and parts of the layout of subroutine <code>wc</code> were inspired by a similar function 
developed by Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>). 
The basic concept of the simulation algorithm and of ridge determination build on ideas 
developed by these authors. The major part of the code for the computation of the cone of influence
and the code for Fourier-randomized surrogate time series has been adopted from Huidong Tian. 
The implementation of a choice of filtering windows for the computation of the wavelet coherence 
was inspired by Luis Aguiar-Conraria and Maria Joana Soares (<code>GWPackage</code>).
</p>
<p>Cross-wavelet and coherence computation, the simulation algorithm and ridge determination build heavily 
on the use of matrices in order to minimize computation time in R. 
</p>
<p>This function provides a broad variety of final as well as intermediate results 
which can be further analyzed in detail. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze.coherency(my.data, my.pair = c(1, 2), loess.span = 0.75, 
                  dt = 1, dj = 1/20, 
                  lowerPeriod = 2*dt, 
                  upperPeriod = floor(nrow(my.data)/3)*dt, 
                  window.type.t = 1, window.type.s = 1, 
                  window.size.t = 5, window.size.s = 1/4, 
                  make.pval = TRUE, method = "white.noise", params = NULL, 
                  n.sim = 100, 
                  date.format = NULL, date.tz = NULL, 
                  verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.coherency_+3A_my.data">my.data</code></td>
<td>
<p>data frame of time series (including header, and dates as row names or as separate column 
named <code>"date"</code> if available)</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_my.pair">my.pair</code></td>
<td>
<p>pair of names or column indices indicating the series to be analyzed, 
e.g. <code>c(1,2)</code>, <code>c(2,1)</code>, <code>c("dji","ftse")</code>. 
</p>
<p>Default: <code>c(1,2)</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_loess.span">loess.span</code></td>
<td>
<p>parameter <code>alpha</code> in <code>loess</code> controlling the degree of time series smoothing, 
if the time series are to be detrended; no detrending if <code>loess.span = 0</code>. 
</p>
<p>Default: <code>0.75</code>.
</p>
</td></tr>

<tr><td><code id="analyze.coherency_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="analyze.coherency_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition.<br /> 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr> 

<tr><td><code id="analyze.coherency_+3A_window.type.t">window.type.t</code></td>
<td>
<p>type of window for smoothing in time direction; select from:  
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in time direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_window.type.s">window.type.s</code></td>
<td>
<p>type of window for smoothing in scale (period) direction; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in scale (period) </td>
</tr>
<tr>
 <td style="text-align: right;"> 
                     </td><td style="text-align: left;">           </td><td style="text-align: left;">                 </td><td style="text-align: left;">   </td><td style="text-align: left;"> direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_window.size.t">window.size.t</code></td>
<td>
<p>size of the window used for smoothing in time direction, measured in time units 
determined by <code>dt</code>, see the explanations concerning <code>dt</code>. 
</p>
<p>Default: <code>5</code>, which together with <code>dt = 1</code> defines a window of length <code>5*(1/dt)</code> = 5, 
equaling 5 observations (observation epochs). Windows of even-numbered sizes are extended by 1.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_window.size.s">window.size.s</code></td>
<td>
<p>size of the window used for smoothing in scale (period) direction in units of <code>1/dj</code>. 
</p>
<p>Default: <code>1/4</code>, which together with <code>dj = 1/20</code> defines a window of length <code>(1/4)*(1/dj)</code> = 5. 
Windows of even-numbered sizes are extended by 1.
</p>
</td></tr> 

<tr><td><code id="analyze.coherency_+3A_make.pval">make.pval</code></td>
<td>
<p>Compute p-values? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="analyze.coherency_+3A_method">method</code></td>
<td>
<p>the method of generating surrogate time series; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"white.noise"</code>  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> white noise </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"shuffle"</code>      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> shuffling the given time series </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"Fourier.rand"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> time series with a similar spectrum </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"AR"</code>           </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR(p) </td>
</tr>
<tr>
 <td style="text-align: right;">  
                    </td><td style="text-align: left;"> <code>"ARIMA"</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> ARIMA(p,0,q) 
                    </td>
</tr>

</table>

<p>Default: <code>"white.noise"</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_params">params</code></td>
<td>
<p>a list of assignments between methods (AR, and ARIMA) and lists of parameter values 
applying to surrogates. Default: <code>NULL</code>. 
</p>
<p>Default includes two lists named <code>AR</code> and <code>ARIMA</code>:
</p>
  
<ul>
<li> <p><code>AR = list(...)</code>, a list containing one single element:
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">          </td><td style="text-align: left;">   </td><td style="text-align: left;"> Default: <code>1</code>.
                </td>
</tr>

</table>

</li>
<li> <p><code>ARIMA = list(...)</code>, a list of six elements:            
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>TRUE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation. </td>
</tr>
<tr>
 <td style="text-align: right;">  
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>0.01</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>
</li></ul>

</td></tr>      

<tr><td><code id="analyze.coherency_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations. 
</p>
<p>Default: <code>100</code>.</p>
</td></tr>

<tr><td><code id="analyze.coherency_+3A_date.format">date.format</code></td>
<td>
<p>optional, and for later reference: the format of calendar date 
(if available in the input data frame) given as a character string, e.g. <code>"%Y-%m-%d"</code>, 
or equivalently <code>"%F"</code>; see <code>strptime</code> for a list of implemented date conversion specifications.
Explicit information given here will be overwritten by any later specification given in 
e.g. <code>wc.image</code>. 
If unspecified, date formatting will be attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="analyze.coherency_+3A_date.tz">date.tz</code></td>
<td>
<p>optional, and for later reference: a character string specifying the time zone of calendar date 
(if available in the input data frame); see <code>strptime</code>. 
Explicit information given here will be overwritten by any specification given in 
e.g. <code>wc.image</code>. 
If unspecified, <code>""</code> (the local time zone) will be used. 
</p>
<p>Default: <code>NULL</code>.
</p>
</td></tr>

<tr><td><code id="analyze.coherency_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>"analyze.coherency"</code> with elements of different dimensions.

The elements of matrix type, namely:
</p>

<ul>
<li> <p><code>Wave.xy</code>, <code>Angle</code>, <code>sWave.xy</code>, <code>sAngle</code>, 
</p>
</li>
<li> <p><code>Power.xy</code>, <code>Power.xy.pval</code>, 
</p>
</li>
<li> <p><code>Coherency</code>, <code>Coherence</code>, <code>Coherence.pval</code>, 
</p>
</li>
<li> <p><code>Wave.x</code>, <code>Wave.y</code>, <code>Phase.x</code>, <code>Phase.y</code>, <code>Ampl.x</code>, <code>Ampl.y</code>, 
</p>
</li>
<li> <p><code>Power.x</code>, <code>Power.y</code>, <code>Power.x.pval</code>, <code>Power.y.pval</code>, <code>sPower.x</code>, <code>sPower.y</code>, 
</p>
</li>
<li> <p><code>Ridge.xy</code>, <code>Ridge.co</code>, <code>Ridge.x</code>, <code>Ridge.y</code>,</p>
</li></ul>
 
<p>have the following structure:<br /> 
columns correspond to observations (observation epochs; &quot;epoch&quot; meaning point in time), 
rows correspond to scales (Fourier periods) whose values are given in <code>Scale</code> (<code>Period</code>).

Here is a detailed list of all elements:
</p>
<table>
<tr><td><code>series</code></td>
<td>
<p>a data frame with the following columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> date                 </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the calendar date </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> (if available as column in <code>my.data</code>) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;, &lt;y&gt;             </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the two series which have been analyzed </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> (detrended, if <code>loess.span != 0</code>; </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> original names retained) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;.trend, &lt;y&gt;.trend </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the two trend series </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> (included if <code>loess.span != 0</code>) 
                     </td>
</tr>

</table>
 
<p>Row names are taken over from <code>my.data</code>, and so are dates if given as row names.        
</p>
</td></tr>    
<tr><td><code>loess.span</code></td>
<td>
<p>parameter <code>alpha</code> in <code>loess</code> controlling the degree of time series smoothing 
if the time series were detrended; no detrending if <code>loess.span = 0</code></p>
</td></tr>

<tr><td><code>dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of suboctaves (voices per octave)</p>
</td></tr>

<tr><td><code>Wave.xy</code></td>
<td>
<p>(complex-valued) cross-wavelet transform (analogous to Fourier cross-frequency spectrum, and to the covariance in statistics)</p>
</td></tr> 
<tr><td><code>Angle</code></td>
<td>
<p>phase difference, i.e. phase lead of &lt;x&gt; over &lt;y&gt; (= <code>phase.x</code> minus <code>phase.y</code>)</p>
</td></tr>
<tr><td><code>sWave.xy</code></td>
<td>
<p>smoothed (complex-valued) cross-wavelet transform</p>
</td></tr>
<tr><td><code>sAngle</code></td>
<td>
<p>phase difference, i.e. phase lead of &lt;x&gt; over &lt;y&gt;, affected by smoothing</p>
</td></tr> 

<tr><td><code>Power.xy</code></td>
<td>
<p>cross-wavelet power (analogous to Fourier cross-frequency power spectrum)</p>
</td></tr>
<tr><td><code>Power.xy.avg</code></td>
<td>
<p>average cross-wavelet power in the frequency domain (averages over time)</p>
</td></tr> 
<tr><td><code>Power.xy.pval</code></td>
<td>
<p>p-values of cross-wavelet power</p>
</td></tr>
<tr><td><code>Power.xy.avg.pval</code></td>
<td>
<p>p-values of average cross-wavelet power</p>
</td></tr>

<tr><td><code>Coherency</code></td>
<td>
<p>the (complex-valued) wavelet coherency of series &lt;x&gt; over series &lt;y&gt; in the time/frequency domain, affected by smoothing (analogous to Fourier coherency, and to the coefficient of correlation in statistics)</p>
</td></tr>       
<tr><td><code>Coherence</code></td>
<td>
<p>wavelet coherence (analogous to Fourier coherence, and to the coefficient of determination in statistics (affected by smoothing)</p>
</td></tr>
<tr><td><code>Coherence.avg</code></td>
<td>
<p>average wavelet coherence in the frequency domain (averages across time)</p>
</td></tr>
<tr><td><code>Coherence.pval</code></td>
<td>
<p>p-values of wavelet coherence</p>
</td></tr>
<tr><td><code>Coherence.avg.pval</code></td>
<td>
<p>p-values of average wavelet coherence</p>
</td></tr>

<tr><td><code>Wave.x</code>, <code>Wave.y</code></td>
<td>
<p>(complex-valued) wavelet transforms of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>Phase.x</code>, <code>Phase.y</code></td>
<td>
<p>phases of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>Ampl.x</code>, <code>Ampl.y</code></td>
<td>
<p>amplitudes of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>Power.x</code>, <code>Power.y</code></td>
<td>
<p>wavelet power of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>Power.x.avg</code>, <code>Power.y.avg</code></td>
<td>
<p>average wavelet power of series &lt;x&gt; and &lt;y&gt;, averages across time</p>
</td></tr> 
<tr><td><code>Power.x.pval</code>, <code>Power.y.pval</code></td>
<td>
<p>p-values of wavelet power of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>Power.x.avg.pval</code>, <code>Power.y.avg.pval</code></td>
<td>
<p>p-values of average wavelet power of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>
<tr><td><code>sPower.x</code>, <code>sPower.y</code></td>
<td>
<p>smoothed wavelet power of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr> 

<tr><td><code>Ridge.xy</code></td>
<td>
<p>ridge of cross-wavelet power, in the form of a matrix of <code>0</code>s and <code>1</code>s</p>
</td></tr>
<tr><td><code>Ridge.co</code></td>
<td>
<p>ridge of wavelet coherence</p>
</td></tr>
<tr><td><code>Ridge.x</code>, <code>Ridge.y</code></td>
<td>
<p>power ridges of series &lt;x&gt; and &lt;y&gt;</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code>coi.1</code>, <code>coi.2</code></td>
<td>
<p>borders of the region where the wavelet transforms are not influenced by edge effects (cone of influence). 
The coordinates of the borders are expressed in terms of internal axes <code>axis.1</code> and <code>axis.2</code>.</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
<tr><td><code>axis.2</code></td>
<td>
<p>tick levels corresponding to the log of Fourier periods: <code>log2(Period)</code>. This determines the period axis in plot functions provided by <code>WaveletComp</code>.</p>
</td></tr>

<tr><td><code>date.format</code></td>
<td>
<p>the format of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.tz</code></td>
<td>
<p>the time zone of calendar date (if available)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; 
credits are also due to Huidong Tian, Bernard Cazelles, Luis Aguiar-Conraria, and Maria Joana Soares.</p>


<h3>References</h3>

 
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2012. <code>GWPackage</code>. 
Available at <a href="https://sites.google.com/site/aguiarconraria/joanasoares-wavelets">https://sites.google.com/site/aguiarconraria/joanasoares-wavelets</a>; accessed September 4, 2013.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+wc.avg">wc.avg</a></code>, <code><a href="#topic+wc.sel.phases">wc.sel.phases</a></code>, <code><a href="#topic+wc.phasediff.image">wc.phasediff.image</a></code>, 
<code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is modified from Veleda et al, 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3 &lt;- periodic.series(start.period = 4*24, length = series.length)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3 + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(out of phase at period 16, different amplitudes at period 64)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherence, x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
## There is an option to store the date format and time zone as additional
## parameters within object 'my.wc' for later reference. 

my.wc &lt;- analyze.coherency(my.data, c("x","y"), 
                           loess.span = 0, 
                           dt = 1/24, dj = 1/20, 
                           window.size.t = 1, window.size.s = 1/2, 
                           lowerPeriod = 1/4,
                           make.pval = TRUE, n.sim = 10,
                           date.format = "%F %T", date.tz = "")
## Note:                           
## By default, Bartlett windows are used for smoothing in order to obtain
## the wavelet coherence spectrum; window lengths in this example:
## 1*24 + 1 = 25 observations in time direction,
## (1/2)*20 + 1 = 11 units in scale (period) direction.                             
                         
## Plot of cross-wavelet power 
## (with color breakpoints according to quantiles):
wc.image(my.wc, main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels"),
   periodlab = "period (days)")
   
## The same plot, now with calendar axis
## (according to date format stored in 'my.wc'):
wc.image(my.wc, main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels"),
   periodlab = "period (days)", show.date = TRUE)   
         
## Plot of average cross-wavelet power:
wc.avg(my.wc, siglvl = 0.05, sigcol = 'red', 
   periodlab = "period (days)")

## Plot of wavelet coherence 
## (with color breakpoints according to quantiles):
wc.image(my.wc, which.image = "wc",  main = "wavelet coherence, x over y", 
   legend.params = list(lab = "wavelet coherence levels", 
                        lab.line = 3.5, label.digits = 3),
   periodlab = "period (days)")
         
## plot of average coherence:
wc.avg(my.wc, which.avg = "wc", 
   siglvl = 0.05, sigcol = 'red', 
   legend.coords = "topleft", 
   periodlab = "period (days)")

## Please see our guide booklet for further examples:
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='analyze.wavelet'>
Computation of the wavelet power spectrum of a single time series
</h2><span id='topic+analyze.wavelet'></span>

<h3>Description</h3>

<p>The time series is selected from an input data frame by specifying
either its name or its column number. Optionally, the time series
is detrended, using <code>loess</code> with parameter <code>loess.span</code>.
Internally, the series will be further standardized before it
undergoes wavelet transformation.
</p>
<p>The wavelet power spectrum is computed by applying the Morlet
wavelet. P-values to test the null hypothesis that a period (within <code>lowerPeriod</code> and <code>upperPeriod</code>) 
is irrelevant at a certain time are calculated if desired; this is accomplished with the help of a
simulation algorithm. There is a selection of models from which to
choose the alternative hypothesis. The selected model will be fitted to
the data and simulated according to estimated parameters in order
to provide surrogate time series.
</p>
<p>Wavelet transformation, as well as p-value computations, are
carried out by calling subroutine <code>wt</code>.
</p>
<p>The name and parts of the layout of subroutine <code>wt</code> were inspired by a similar function developed by 
Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>). The basic concept of the simulation algorithm
and of ridge determination build on ideas developed by these authors. The major part of the code for the computation of
the cone of influence and the code for Fourier-randomized surrogate time series
has been adopted from Huidong Tian. 
</p>
<p>Wavelet computation, the simulation algorithm and ridge determination build heavily on the use of matrices 
in order to minimize computation time in R. 
</p>
<p>This function provides a broad variety of final as well as intermediate results 
which can be further analyzed in detail. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>analyze.wavelet(my.data, my.series = 1, loess.span = 0.75, 
                dt = 1, dj = 1/20, 
                lowerPeriod = 2*dt, 
                upperPeriod = floor(nrow(my.data)/3)*dt, 
                make.pval = TRUE, method = "white.noise", params = NULL,
                n.sim = 100, 
                date.format = NULL, date.tz = NULL, 
                verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="analyze.wavelet_+3A_my.data">my.data</code></td>
<td>
<p>data frame of time series (including header, and dates as row names or as separate column 
named <code>"date"</code> if available)</p>
</td></tr>
<tr><td><code id="analyze.wavelet_+3A_my.series">my.series</code></td>
<td>
<p>name or column index indicating the series to be analyzed, 
e.g. <code>1</code>, <code>2</code>, <code>"dji"</code>, <code>"ftse"</code>. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>

<tr><td><code id="analyze.wavelet_+3A_loess.span">loess.span</code></td>
<td>
<p>parameter <code>alpha</code> in <code>loess</code> controlling the degree of time series smoothing, 
if the time series is to be detrended; no detrending if <code>loess.span = 0</code>. 
</p>
<p>Default: <code>0.75</code>.
</p>
</td></tr>

<tr><td><code id="analyze.wavelet_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="analyze.wavelet_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="analyze.wavelet_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition.<br /> 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="analyze.wavelet_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr>                    

<tr><td><code id="analyze.wavelet_+3A_make.pval">make.pval</code></td>
<td>
<p>Compute p-values? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>                      

<tr><td><code id="analyze.wavelet_+3A_method">method</code></td>
<td>
<p>the method of generating surrogate time series; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"white.noise"</code>  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> white noise </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"shuffle"</code>      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> shuffling the given time series </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"Fourier.rand"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> time series with a similar spectrum </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"AR"</code>           </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR(p) </td>
</tr>
<tr>
 <td style="text-align: right;">  
                    </td><td style="text-align: left;"> <code>"ARIMA"</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> ARIMA(p,0,q) 
                    </td>
</tr>

</table>

<p>Default: <code>"white.noise"</code>.
</p>
</td></tr>
<tr><td><code id="analyze.wavelet_+3A_params">params</code></td>
<td>
<p>a list of assignments between methods (AR, and ARIMA) and lists of parameter values 
applying to surrogates. Default: <code>NULL</code>. 
</p>
<p>Default includes two lists named <code>AR</code> and <code>ARIMA</code>:
</p>
  
<ul>
<li> <p><code>AR = list(...)</code>, a list containing one single element:
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">          </td><td style="text-align: left;">   </td><td style="text-align: left;"> Default: <code>1</code>.
                </td>
</tr>

</table>

</li>
<li> <p><code>ARIMA = list(...)</code>, a list of six elements:            
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>TRUE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation. </td>
</tr>
<tr>
 <td style="text-align: right;">  
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>0.01</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>
</li></ul>

</td></tr>      

<tr><td><code id="analyze.wavelet_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations. 
</p>
<p>Default: <code>100</code>.</p>
</td></tr>

<tr><td><code id="analyze.wavelet_+3A_date.format">date.format</code></td>
<td>
<p>optional, and for later reference: the format of calendar date 
(if available in the input data frame) given as a character string, e.g. <code>"%Y-%m-%d"</code>, 
or equivalently <code>"%F"</code>; see <code>strptime</code> for a list of implemented date conversion specifications.
Explicit information given here will be overwritten by any later specification given in 
e.g. <code>wt.image</code>. 
If unspecified, date formatting will be attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.
</p>
</td></tr>
<tr><td><code id="analyze.wavelet_+3A_date.tz">date.tz</code></td>
<td>
<p>optional, and for later reference: a character string specifying the time zone of calendar date 
(if available in the input data frame); see <code>strptime</code>. 
Explicit information given here will be overwritten by any specification given in 
e.g. <code>wt.image</code>. 
If unspecified, <code>""</code> (the local time zone) will be used. 
</p>
<p>Default: <code>NULL</code>.
</p>
</td></tr>

<tr><td><code id="analyze.wavelet_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>TRUE</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Wavelet transformation, as well as p-value computations, are
carried out by calling the internal function <code>wt</code>.
</p>


<h3>Value</h3>

<p>A list of class <code>"analyze.wavelet"</code> with elements of different dimensions.

The elements of matrix type (namely, <code>Wave</code>, <code>Phase</code>, <code>Ampl</code>, <code>Power</code>, <code>Power.pval</code>, 
<code>Ridge</code>) have the following structure:<br /> 
columns correspond to observations (observation epochs; &quot;epoch&quot; meaning point in time), 
rows correspond to scales (Fourier periods) whose values are given in <code>Scale</code> (<code>Period</code>).

Here is a detailed list of all elements:
</p>
<table>
<tr><td><code>series</code></td>
<td>
<p>a data frame with the following columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> date        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the calendar date </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">             </td><td style="text-align: left;">   </td><td style="text-align: left;"> (if available as column in <code>my.data</code>) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;         </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the series which has been analyzed </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">             </td><td style="text-align: left;">   </td><td style="text-align: left;"> (detrended, if <code>loess.span != 0</code>; </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">             </td><td style="text-align: left;">   </td><td style="text-align: left;">  original name retained) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;.trend   </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the trend series (if <code>loess.span != 0</code>)
                     </td>
</tr>

</table>
 
<p>Row names are taken over from <code>my.data</code>, and so are dates if given as row names.   
</p>
</td></tr>

<tr><td><code>loess.span</code></td>
<td>
<p>parameter <code>alpha</code> in <code>loess</code> controlling the degree of time series smoothing 
if the time series was detrended; no detrending if <code>loess.span = 0</code></p>
</td></tr>

<tr><td><code>dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of suboctaves (voices per octave)</p>
</td></tr>

<tr><td><code>Wave</code></td>
<td>
<p>complex wavelet transform of the series</p>
</td></tr>
<tr><td><code>Phase</code></td>
<td>
<p>phases</p>
</td></tr>
<tr><td><code>Ampl</code></td>
<td>
<p>amplitudes</p>
</td></tr>

<tr><td><code>Power</code></td>
<td>
<p>wavelet power in the time/frequency domain</p>
</td></tr>
<tr><td><code>Power.avg</code></td>
<td>
<p>average wavelet power in the frequency domain (averages over time)</p>
</td></tr> 
<tr><td><code>Power.pval</code></td>
<td>
<p>p-values of wavelet power</p>
</td></tr>
<tr><td><code>Power.avg.pval</code></td>
<td>
<p>p-values of average wavelet power</p>
</td></tr>

<tr><td><code>Ridge</code></td>
<td>
<p>wavelet power ridge, in the form of a matrix of <code>0</code>s and <code>1</code>s</p>
</td></tr> 

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code>coi.1</code>, <code>coi.2</code></td>
<td>
<p>borders of the region where the wavelet transforms are not influenced by edge effects (cone of influence). 
The coordinates of the borders are expressed in terms of internal axes <code>axis.1</code> and <code>axis.2</code>.</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
<tr><td><code>axis.2</code></td>
<td>
<p>tick levels corresponding to the log of Fourier periods: <code>log2(Period)</code>. This determines the period axis in plot functions provided by <code>WaveletComp</code>.</p>
</td></tr>

<tr><td><code>date.format</code></td>
<td>
<p>the format of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.tz</code></td>
<td>
<p>the time zone of calendar date (if available)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
   
## The following dates refer to the local time zone
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
## There is an option to store the date format and time zone as additional 
## parameters within object 'my.wt' for later reference.    

my.wt &lt;- analyze.wavelet(my.data, "x", 
                         loess.span = 0, 
                         dt = 1/24, dj = 1/20, 
                         lowerPeriod = 1/4, 
                         make.pval = TRUE, n.sim = 10,
                         date.format = "%F %T", date.tz = "")

## Plot of wavelet power spectrum (with equidistant color breakpoints):  
wt.image(my.wt, color.key = "interval", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels"),
   periodlab = "period (days)")

## Plot of average wavelet power:
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", 
   periodlab = "period (days)")

## Please see our guide booklet for further examples:
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='AR'>Simulation of an AR(p) surrogate for a given time series x</h2><span id='topic+AR'></span>

<h3>Description</h3>

<p>It simulates an AR(p) surrogate for the time series x analyzed by wavelet transformation using either function
<code>analyze.wavelet</code> or function <code>analyze.coherency</code>. A set of surrogates is used for significance assessment 
to test the hypothesis of equal periodic components.
</p>
<p>Simulation is subject to coefficient estimates referring to the given AR order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AR(x, params = list(AR = list(p = 1)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AR_+3A_x">x</code></td>
<td>
<p>the given time series</p>
</td></tr>

<tr><td><code id="AR_+3A_params">params</code></td>
<td>
<p>a list containing an assignment of (the only) parameter value to AR. Default: <code>NULL</code>. 
</p>
<p>Default includes:
</p>
<p><code>AR = list(...)</code>, a list containing one single element:
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">          </td><td style="text-align: left;">   </td><td style="text-align: left;"> Default: <code>1</code>.
        </td>
</tr>

</table>

</td></tr>              
</table>


<h3>Details</h3>

<p>Basics of model estimation and simulation are provided by application of the R functions <code>pcf</code> and <code>arima.sim</code>.
</p>


<h3>Value</h3>

<p>A surrogate series for x is returned which has the same length and properties according to estimates resulting from the given AR order.
</p>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+SurrogateData">SurrogateData</a></code>, <code><a href="#topic+ARIMA">ARIMA</a></code>, <code><a href="#topic+FourierRand">FourierRand</a></code>
</p>

<hr>
<h2 id='ARIMA'>Simulation of an ARIMA(p,0,q) surrogate for a given time series x</h2><span id='topic+ARIMA'></span>

<h3>Description</h3>

<p>It simulates an ARIMA(p,0,q) surrogate for the time series x analyzed by wavelet transformation using either function
<code>analyze.wavelet</code> or function <code>analyze.coherency</code>. A set of surrogates is used for significance assessment 
to test the hypothesis of equal periodic components. 
</p>
<p>Simulation is subject to parameters concerning:
AR and MA order, an indicator of mean/intercept term inclusion, a boosting factor which is applied to 
the residual standard deviation, an indicator to trim the data according to the given trimming proportion 
(i.e. to restrict them to the interval between the lower and upper quantile corresponding to the given probability).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ARIMA(x, params = 
      list(ARIMA = list(p = 1, q = 1, 
                        include.mean = TRUE, sd.fac = 1, 
                        trim = FALSE, trim.prop = 0.01)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ARIMA_+3A_x">x</code></td>
<td>
<p>the given time series</p>
</td></tr>

<tr><td><code id="ARIMA_+3A_params">params</code></td>
<td>
<p>a list containing an assignment of parameter values to ARIMA. Default: <code>NULL</code>. 
</p>
<p>Default includes: 
</p>
<p><code>ARIMA = list(...)</code>, a list of six elements:            
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>TRUE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation. </td>
</tr>
<tr>
 <td style="text-align: right;">  
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>0.01</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td>
</tr>

</table>

</td></tr>              
</table>


<h3>Details</h3>

<p>Basics of model estimation and simulation are provided by application of the R functions <code>arima</code> and <code>arima.sim</code>.
</p>


<h3>Value</h3>

<p>A surrogate series for x is returned which has the same length and properties according to estimates resulting from 
the given ARIMA setting. 
</p>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+SurrogateData">SurrogateData</a></code>, <code><a href="#topic+AR">AR</a></code>, 
<code><a href="#topic+FourierRand">FourierRand</a></code>
</p>

<hr>
<h2 id='arrow'>Plot an arrow</h2><span id='topic+arrow'></span>

<h3>Description</h3>

<p>It plots a polygon arrow subject to criteria concerning position, length, width, direction and color.
</p>
<p>In plots of the cross-wavelet power (or wavelet coherency) spectrum of two time series as performed 
by function <code>wc.image</code>, arrows are used as a symbolic indicator of phase differences between 
the series in the time/frequency domain.
</p>
<p>This code has been developed by Huidong Tian (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>arrow(x, y, l = 0.1, w = 0.3*l, alpha, col.arrow = "black")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="arrow_+3A_x">x</code></td>
<td>
<p>the x coordinate of the center of the arrow</p>
</td></tr>
<tr><td><code id="arrow_+3A_y">y</code></td>
<td>
<p>the y coordinate of the center of the arrow</p>
</td></tr>
<tr><td><code id="arrow_+3A_l">l</code></td>
<td>
<p>the length of the arrow. Default: <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="arrow_+3A_w">w</code></td>
<td>
<p>the width of the arrow. Default: <code>0.3*l</code>.</p>
</td></tr>
<tr><td><code id="arrow_+3A_alpha">alpha</code></td>
<td>
<p>the direction of the arrow, ranging from <code>0</code> to <code>2*pi</code></p>
</td></tr>
<tr><td><code id="arrow_+3A_col.arrow">col.arrow</code></td>
<td>
<p>color of the arrow. Default: <code>"black"</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Code developed by Huidong Tian.</p>


<h3>References</h3>

<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>

<hr>
<h2 id='COI'>Computation of the cone of influence</h2><span id='topic+COI'></span>

<h3>Description</h3>

<p>Wavelet transformation of a time series includes padding with zeros at the edges.
This function determines the spectrum borders influenced by edge effects.
</p>
<p>This code has been developed by Huidong Tian (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>COI(start = start, dt = dt, nc = nc, nr = nr, Period = Period)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="COI_+3A_start">start</code></td>
<td>
<p>starting point in time. Default: <code>start = 1</code>.</p>
</td></tr>

<tr><td><code id="COI_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit</p>
</td></tr>

<tr><td><code id="COI_+3A_nc">nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code id="COI_+3A_nr">nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code id="COI_+3A_period">Period</code></td>
<td>
<p>the Fourier periods (measured in time units determined by <code>dt</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with the following elements:
</p>

<table>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;"> <code>x</code>, <code>y</code>   </td><td style="text-align: left;"> : </td><td style="text-align: left;"> coordinates of the cone of influence </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;"> <code>axis.1</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> tick levels corresponding to the time steps </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> used for wavelet transformation: </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> <code>1, 1+dt, 1+2dt, ...</code> if <code>start = 1</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
       </td><td style="text-align: left;"> <code>axis.2</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> tick levels corresponding to the log of Fourier periods: </td>
</tr>
<tr>
 <td style="text-align: right;"> 
       </td><td style="text-align: left;">                      </td><td style="text-align: left;">   </td><td style="text-align: left;"> <code>log2(Period)</code>
       </td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Code developed by Huidong Tian.</p>


<h3>References</h3>

<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wc.image">wc.image</a></code>
</p>

<hr>
<h2 id='FourierRand'>Simulation of a surrogate for a given time series x by Fourier randomization</h2><span id='topic+FourierRand'></span>

<h3>Description</h3>

<p>It simulates a surrogate with similar Fourier spectrum for a given time series x analyzed 
by wavelet transformation using either function <code>analyze.wavelet</code> or function <code>analyze.coherency</code>.
A set of surrogates is used for significance assessment to test the hypothesis of equal periodic components. 
</p>
<p>This code has been developed by Huidong Tian (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FourierRand(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="FourierRand_+3A_x">x</code></td>
<td>
<p>the given time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A surrogate series for x is returned which has the same length and a similar Fourier spectrum. 
</p>


<h3>Author(s)</h3>

<p>Code developed by Huidong Tian.</p>


<h3>References</h3>

<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+SurrogateData">SurrogateData</a></code>, <code><a href="#topic+AR">AR</a></code>, <code><a href="#topic+ARIMA">ARIMA</a></code>
</p>

<hr>
<h2 id='FXtrade.transactions'>Series of FX trade transactions</h2><span id='topic+FXtrade.transactions'></span>

<h3>Description</h3>

<p>USD/euro FX (foreign exchange) trade: number of worldwide transactions recorded per 5-minute intervals in July 2010. The data set contains four full weekly cycles (plus three days at the beginning of July 2010), a weekly cycle lasting from Sunday, 21:00, to Friday, 20:55. The number of transactions between Friday, 21:00, and Sunday, 20:55, is 0 or close to 0. For these intervals, variable <code>"active"</code> is <code>FALSE</code>, otherwise <code>TRUE</code>.
</p>
<p>Derived from data delivered by Morning Star.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("FXtrade.transactions")</code></pre>


<h3>Format</h3>

<p>A data frame of two columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> date         </td><td style="text-align: left;"> : </td><td style="text-align: left;"> date and GMT time (resolution: 5 minutes), </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">              </td><td style="text-align: left;">   </td><td style="text-align: left;"> format: <code>"%Y-%m-%d %H:%M:%S"</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">              </td><td style="text-align: left;">   </td><td style="text-align: left;"> (equivalently, <code>"%F %T"</code>) </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> transactions </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of transactions in the 5-minute interval </td>
</tr>
<tr>
 <td style="text-align: right;"> 
    </td><td style="text-align: left;">              </td><td style="text-align: left;">   </td><td style="text-align: left;"> starting with the time indicated  </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> active       </td><td style="text-align: left;"> : </td><td style="text-align: left;"> trade activity indicator
    </td>
</tr>

</table>



<h3>Source</h3>

<p>Morning Star, <a href="http://www.morningstar.com/">http://www.morningstar.com/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(FXtrade.transactions)
plot(as.POSIXct(FXtrade.transactions$date, format = "%F %T", tz = "GMT"),
     FXtrade.transactions$transactions, 
     type = "l",
     xlab = "day", ylab = "transactions in 5-minute intervals")
</code></pre>

<hr>
<h2 id='marriages.Turkey'>Series of monthly marriages in Turkey</h2><span id='topic+marriages.Turkey'></span>

<h3>Description</h3>

<p>Series of monthly marriages in Turkey (1988-2013), as reported by DIE (Devlet Istatistik Enstitusu) / TUIK (Turkiye Istatistik Kurumu).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("marriages.Turkey")</code></pre>


<h3>Format</h3>

<p> A data frame of three columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
                 </td><td style="text-align: left;"> date          </td><td style="text-align: left;"> : </td><td style="text-align: left;"> end-of-month date, </td>
</tr>
<tr>
 <td style="text-align: right;">   
                 </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> format: <code>"%Y-%m-%d"</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
                 </td><td style="text-align: left;"> n.Sun         </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of Sundays in this month </td>
</tr>
<tr>
 <td style="text-align: right;">
                 </td><td style="text-align: left;"> marriages     </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of marriages in this month
                 </td>
</tr>

</table>



<h3>Source</h3>

<p> DIE (Devlet Istatistik Enstitusu) / TUIK (Turkiye Istatistik Kurumu) 
</p>
<p>Jan 1988 to Dec 2000:<br /> &quot;Evlenme istatistikleri&quot;, DIE (Devlet Istatistik Enstitusu, Ankara), ISSN: 1300-1086; several issues.
</p>
<p>Jan 2001 to Dec 2013:<br /> <a href="http://www.tuik.gov.tr/VeriTabanlari.do?vt_id=21&amp;ust_id=109">http://www.tuik.gov.tr/VeriTabanlari.do?vt_id=21&amp;ust_id=109</a>; accessed Oct 1, 2014.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(marriages.Turkey)
plot(ts(marriages.Turkey$marriages, frequency = 12, start = c(1988,1)), 
     type = "l", 
     xlab = "", ylab = "", 
     main = "monthly marriages in Turkey (1988-2013)")     
</code></pre>

<hr>
<h2 id='periodic.series'>
Computation of a (deterministic) periodic time series of linearly changing period.
</h2><span id='topic+periodic.series'></span>

<h3>Description</h3>

<p>It computes and returns a sinusoid of a specified length, which has the given initial phase, and 
linearly changing periods (if requested) starting from a given period length through the given length at the end.
There is an option to plot the time series. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  periodic.series(start.period = 100, end.period = start.period, 
                  phase = 0, 
                  length = 600, 
                  make.plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="periodic.series_+3A_start.period">start.period</code></td>
<td>
<p>period length at start (in steps of time). Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="periodic.series_+3A_end.period">end.period</code></td>
<td>
<p>period length at end (in steps of time). Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="periodic.series_+3A_phase">phase</code></td>
<td>
<p>phase difference (in steps of time), i.e. part of period length which has elapsed relative to the origin.
Default: <code>0</code>.</p>
</td></tr>
<tr><td><code id="periodic.series_+3A_length">length</code></td>
<td>
<p>number of time steps. Default: <code>600</code>.</p>
</td></tr>
<tr><td><code id="periodic.series_+3A_make.plot">make.plot</code></td>
<td>
<p>Plot time series? Logical. Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function can be used for illustrating methods and functions.
</p>
<p>Producing a sinusoid, <code>periodic.series</code> 
will work best if <code>start.period</code> (and <code>end.period</code>, if different from <code>start.period</code>) is not too small.
</p>


<h3>Value</h3>

<p>the series as vector
</p>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, 
<code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The following time series involves periods from 100 through 50:
x &lt;- periodic.series(start.period = 100, end.period = 50, make.plot = TRUE)
title("time series with period changing linearly from 100 to 50")

# The following three time series involve three different types of period evolution 
# starting from period 100:
x1 &lt;- 0.8*periodic.series(start.period = 100, end.period = 95, phase = 0, length = 1000)
x2 &lt;-     periodic.series(start.period = 100, end.period = 100, phase = 0, length = 1000)
x3 &lt;- 1.2*periodic.series(start.period = 100, end.period = 105, phase = 0, length = 1000)

ts.plot(x2, ylim = c(-2, +2), xlab = "time", ylab = "series with variable period")
lines(x1, col = "blue")
lines(x3, col = "red")
legend("topleft", 
   legend = c("speeding up (end period = 95)", "period = 100", 
              "slowing down (end period = 105)"), 
   lty = 1, col = c("blue", "black", "red"))
</code></pre>

<hr>
<h2 id='reconstruct'>
Reconstruction of a (detrended) time series from output provided by an
object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code>
</h2><span id='topic+reconstruct'></span>

<h3>Description</h3>

<p>This function reconstructs a (detrended) time series analyzed
by wavelet transformation using either function
<code>analyze.wavelet</code> or function <code>analyze.coherency</code>, subject to
optional criteria concerning: minimum wavelet power, significance of wavelet power at a
given significance level, specification of (Fourier) periods or
period bands, exclusive use of the power ridge and/or the cone of influence.
An option is provided to prevent the reconstructed series from final rescaling 
(applying the original (detrended) series' mean and standard deviation).
</p>
<p>(If the object provided as input is of class <code>"analyze.coherency"</code>, 
then the number or name of the time series must be specified.)  
</p>
<p>Optional: plot of wavelets used for reconstruction, plot of 
reconstructed series against original (detrended)
series. An option is given to individualize the time axis 
by specifying tick marks and labels.
</p>
<p>Output includes the original (detrended) and the reconstructed
time series, along with reconstruction waves and parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reconstruct(WT, my.series = 1, lvl = 0, 
      only.coi = FALSE, 
      only.sig = TRUE, siglvl = 0.05, 
      only.ridge = FALSE, 
      sel.period = NULL, sel.lower = NULL, sel.upper = NULL,  
      rescale = TRUE,
      plot.waves = FALSE, plot.rec = TRUE, 
      lty = 1, lwd = 1, col = 1:2, ylim = NULL,
      show.legend = TRUE, 
      legend.coords = "topleft", legend.horiz = FALSE, legend.text = NULL,
      label.time.axis = TRUE, 
      show.date = FALSE, date.format = NULL, date.tz = NULL,
      timelab = NULL, timetck = 0.02, timetcl = 0.5,
      spec.time.axis = list(at = NULL, labels = TRUE, 
                            las = 1, hadj = NA, padj = NA),
      main.waves = NULL, main.rec = NULL, main = NULL, 
      lwd.axis = 1, 
      verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="reconstruct_+3A_wt">WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></p>
</td></tr>
<tr><td><code id="reconstruct_+3A_my.series">my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td></tr>

<tr><td><code id="reconstruct_+3A_lvl">lvl</code></td>
<td>
<p>minimum level of wavelet power to be applied for the inclusion of reconstruction waves. 
</p>
<p>Default: <code>0</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_only.coi">only.coi</code></td>
<td>
<p>Exclude borders influenced by edge effects in reconstruction, i.e. include the cone of influence only? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_only.sig">only.sig</code></td>
<td>
<p>Use wavelet power significance in reconstruction? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_siglvl">siglvl</code></td>
<td>
<p>level of wavelet power significance to be applied for the inclusion of reconstruction waves. 
</p>
<p>Default: 0.05.</p>
</td></tr> 
<tr><td><code id="reconstruct_+3A_only.ridge">only.ridge</code></td>
<td>
<p>Select only the wavelet power ridge? Logical.
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_sel.period">sel.period</code></td>
<td>
<p>a vector of numbers to select Fourier periods (or closest available periods)
and corresponding wavelets for the reconstruction. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_sel.lower">sel.lower</code></td>
<td>
<p>a number to define a lower Fourier period (or the closest available) for the selection 
of a band of wavelets for the reconstruction.<br /> 
(Only effective if <code>sel.period = NULL</code>.) 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_sel.upper">sel.upper</code></td>
<td>
<p>a number to define an upper Fourier period (or the closest available) for the selection
of a band of wavelets for the reconstruction.<br /> 
(Only effective if <code>sel.period = NULL</code>.) 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_rescale">rescale</code></td>
<td>
<p>Shall the reconstructed series finally be rescaled to attain the original (detrended) series' mean and standard deviation? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_plot.waves">plot.waves</code></td>
<td>
<p>Shall reconstruction waves be plotted? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_plot.rec">plot.rec</code></td>
<td>
<p>Shall the reconstructed series (together with the original (detrended) series) be plotted? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_lty">lty</code></td>
<td>
<p>parameter for the plot of original vs. reconstructed series: line type, e.g. <code>1:2</code>. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_lwd">lwd</code></td>
<td>
<p>parameter for the plot of original vs. reconstructed series: line width, e.g. <code>1:2</code>. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_col">col</code></td>
<td>
<p>parameter for the plot of original vs. reconstructed series: color of lines. 
</p>
<p>Default: <code>1:2</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_ylim">ylim</code></td>
<td>
<p>numeric vector of length <code>2</code>, providing the range of vertical coordinates for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_show.legend">show.legend</code></td>
<td>
<p>Include legend into the plot of original vs. reconstructed series? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_legend.coords">legend.coords</code></td>
<td>
<p>coordinates to position the legend (as in function <code>legend</code>). 
</p>
<p>Default: <code>"topleft"</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_legend.horiz">legend.horiz</code></td>
<td>
<p>Set the legend horizontally rather than vertically? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_legend.text">legend.text</code></td>
<td>
<p>legend text. Default: <code>c("original (detrended)", "reconstructed")</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WT</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WT</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label.  
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="reconstruct_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="reconstruct_+3A_main.waves">main.waves</code></td>
<td>
<p>an overall title for the plot of reconstruction waves. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_main.rec">main.rec</code></td>
<td>
<p>an overall title for the plot of original vs. reconstructed series. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_main">main</code></td>
<td>
<p>an overall title for both plots. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="reconstruct_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>reconstruct</code> with the following elements:

</p>
<table>
<tr><td><code>series</code></td>
<td>
<p>a data frame building on <code>WT$series</code> with the following columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> date             </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the calendar date (if available as column</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                  </td><td style="text-align: left;">   </td><td style="text-align: left;"> in WT$series) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;              </td><td style="text-align: left;"> : </td><td style="text-align: left;"> series &lt;x&gt;, with original name retained </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">                  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> (detrended, if <code>loess.span != 0</code>) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;.trend        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the trend series (if <code>loess.span != 0</code>) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;"> &lt;x&gt;.r            </td><td style="text-align: left;"> : </td><td style="text-align: left;"> the reconstructed (detrended) series
                     </td>
</tr>

</table>
 
<p>Row names are taken over from WT$series, and so are dates if given as row names.
If <code>WT</code> is of class <code>analyze.coherency</code>, the second series in the coherency analysis is retained; 
if <code>loess.span != 0</code>, the second series is retained in the detrended version, and the trend is retained as well.   
</p>
</td></tr>

<tr><td><code>rec.waves</code></td>
<td>
<p>data frame of scaled waves used for reconstruction</p>
</td></tr>

<tr><td><code>loess.span</code></td>
<td>
<p>parameter <code>alpha</code> in <code>loess</code> controlling the degree of time series smoothing, 
if the time series was detrended; no detrending if <code>loess.span = 0</code>.</p>
</td></tr>

<tr><td><code>lvl</code></td>
<td>
<p>minimum level of wavelet power for waves (wave segments) to be included
in the reconstruction</p>
</td></tr>
<tr><td><code>only.coi</code></td>
<td>
<p>Was the influence of edge effects excluded? I.e. was the cone of influence used only?</p>
</td></tr>  
<tr><td><code>only.sig</code></td>
<td>
<p>Was wavelet power significance used in reconstruction?</p>
</td></tr> 
<tr><td><code>siglvl</code></td>
<td>
<p>level of wavelet power significance</p>
</td></tr>
<tr><td><code>only.ridge</code></td>
<td>
<p>Was the wavelet power ridge used only?</p>
</td></tr>  

<tr><td><code>rnum.used</code></td>
<td>
<p>the vector of Fourier period numbers used for reconstruction </p>
</td></tr>  

<tr><td><code>rescale</code></td>
<td>
<p>Was the reconstructed series rescaled according to the mean and standard deviation 
taken from the original (detrended) series?</p>
</td></tr> 

<tr><td><code>dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit</p>
</td></tr>
<tr><td><code>dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of suboctaves (voices per octave)</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
<tr><td><code>axis.2</code></td>
<td>
<p>tick levels corresponding to the log of Fourier periods: <code>log2(Period)</code>. This determines the period axis in plot functions provided by <code>WaveletComp</code>.</p>
</td></tr>

<tr><td><code>date.format</code></td>
<td>
<p>the format of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.tz</code></td>
<td>
<p>the time zone of calendar date (if available)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, 
<code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+wc.avg">wc.avg</a></code>, <code><a href="#topic+wc.sel.phases">wc.sel.phases</a></code>, <code><a href="#topic+wc.phasediff.image">wc.phasediff.image</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length = 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
  
my.data &lt;- data.frame(x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24', 
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.w &lt;- analyze.wavelet(my.data, "x", 
                       loess.span = 0, 
                       dt = 1/24, dj = 1/20, 
                       lowerPeriod = 1/4, 
                       make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum (with equidistant color breakpoints):  
wt.image(my.w, color.key = "interval", 
   legend.params = list(lab = "wavelet power levels"),
   periodlab = "period (days)")

## Reconstruction of the time series, 
## including significant components only: 
reconstruct(my.w)

## The same reconstruction, but showing wave components first:
reconstruct(my.w, plot.waves = TRUE)

## Reconstruction, including all components whether significant or not: 
reconstruct(my.w, only.sig = FALSE)

## Reconstruction, including significant components, 
## but selected periods only (e.g. ignoring period 8):  
reconstruct(my.w, sel.period = c(1,32,128))

## Reconstruction, including significant components,
## but the ridge only:
reconstruct(my.w, only.ridge = TRUE)

## Alternate styles of the time axis:

## The plot with time elapsed in days, starting from 0 and proceeding 
## in steps of 50 days (50*24 hours),
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24

## Insert your specification of time axis: 
reconstruct(my.w, only.ridge = TRUE,
   timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))
            
## See the periods involved:
my.rec &lt;- reconstruct(my.w, only.ridge = TRUE)
print(my.rec$Period[my.rec$rnum.used])

## The original and reconstructed time series can be retrieved:
plot(my.rec$series$x, type = "l", xlab = "index", ylab = "")
lines(my.rec$series$x.r, col="red")
legend("topleft", legend = c("original","reconstructed"), 
       lty = 1, col = c("black","red"))

## Please see also the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='ridge'>Ridge of a wavelet power or coherence spectrum</h2><span id='topic+ridge'></span>

<h3>Description</h3>

<p>It finds the ridge of a (cross-)wavelet power or coherence spectrum, subject to criteria concerning:
the band of neighboring values to be included in the search area for local maximization, 
and a scale factor applied to the global maximum defining a minimum level constraint.
</p>
<p>The basic concept of ridge determination builds on ideas developed by Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
This code is an efficient implementation of this concept, building heavily on the use of matrices
in order to minimize computation time in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ridge(wavelet.spectrum, band = 5, scale.factor = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ridge_+3A_wavelet.spectrum">wavelet.spectrum</code></td>
<td>
<p>(cross-)wavelet power or coherence spectrum in the time/frequency domain</p>
</td></tr>
<tr><td><code id="ridge_+3A_band">band</code></td>
<td>
<p>lower/upper band of neighboring values in the frequency domain used in the search for local maxima.<br /> 
Default: <code>5</code>.</p>
</td></tr>
<tr><td><code id="ridge_+3A_scale.factor">scale.factor</code></td>
<td>
<p>a scale factor applied to the global maximum defining a minimum level constraint. <br />
Default: <code>0.1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of <code>0</code>s and <code>1</code>s is returned which determines the course of (cross-)wavelet power or coherence ridge in the time/frequency domain.
</p>


<h3>Note</h3>

<p>Credits are also due to Huidong Tian and Bernard Cazelles whose basic concept of ridge determination has been adopted.</p>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>

<hr>
<h2 id='SurrogateData'>Simulation of surrogates for a given time series x, subject to the specified method and parameters</h2><span id='topic+SurrogateData'></span>

<h3>Description</h3>

<p>It simulates a surrogate for the time series x to be analyzed by wavelet transformation using either function 
<code>analyze.wavelet</code> or function <code>analyze.coherency</code>. A set of surrogates is used for significance assessment 
to test the hypothesis of equal periodic components. 
</p>
<p>Simulation is subject to model/method specification and parameter setting:
Currently, one can choose from a variety of 6 methods (white noise, series shuffling, Fourier randomization, AR, and ARIMA) 
with respective lists of parameters to set.
</p>
<p>The name and layout were inspired by a similar function developed by Huidong Tian (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurrogateData(x, method = "white.noise", params = list( 
         AR    = list(p = 1), 
         ARIMA = list(p = 1, q = 1, include.mean = TRUE, sd.fac = 1, 
                      trim = FALSE, trim.prop = 0.01)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SurrogateData_+3A_x">x</code></td>
<td>
<p>the given time series</p>
</td></tr>

<tr><td><code id="SurrogateData_+3A_method">method</code></td>
<td>
<p>the method of generating surrogate time series; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"white.noise"</code>  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> white noise </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"shuffle"</code>      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> shuffling the given time series </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"Fourier.rand"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> time series with a similar spectrum </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"AR"</code>           </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR(p) </td>
</tr>
<tr>
 <td style="text-align: right;">  
                    </td><td style="text-align: left;"> <code>"ARIMA"</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> ARIMA(p,0,q) 
                    </td>
</tr>

</table>

<p>Default: <code>"white.noise"</code>.
</p>
</td></tr>
<tr><td><code id="SurrogateData_+3A_params">params</code></td>
<td>
<p>a list of assignments between methods (AR, and ARIMA) and lists of parameter values 
applying to surrogates. Default: <code>NULL</code>. 
</p>
<p>Default includes:
</p>
<p><code>AR = list(p = 1)</code>,<br /> where:
</p>

<table>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order
                </td>
</tr>

</table>

<p><code>ARIMA = list(p = 1, q = 1, include.mean = TRUE, sd.fac = 1,</code><br /> 
<code>trim = FALSE, trim.prop = 0.01)</code>,<br /> where:                
</p>

<table>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
  </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation </td>
</tr>
<tr>
 <td style="text-align: right;">  
  </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
  </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion
                </td>
</tr>

</table>

</td></tr>      
</table>


<h3>Value</h3>

<p>A surrogate series for x is returned which has the same length and properties according to estimates 
resulting from the model/method specification and parameter setting. 
</p>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian.</p>


<h3>References</h3>

<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+AR">AR</a></code>, <code><a href="#topic+ARIMA">ARIMA</a></code>, <code><a href="#topic+FourierRand">FourierRand</a></code>
</p>

<hr>
<h2 id='USelection2016.Instagram'>Hourly time series of the number of candidate-related media posted on Instagram during the week before the 2016 US presidential election</h2><span id='topic+USelection2016.Instagram'></span>

<h3>Description</h3>

<p>One week (Sunday, 2016-10-30 23:00:00 EDT through Sunday, 2016-11-06 23:00:00 EST; 170 hours) of hourly readings of the number of media posted on Instagram, supposedly (according to hashtags with which they were annotated) positive/neutral or in opposition towards candidates Trump and Clinton. The 2016 US presidential election took place on Tuesday, 2016-11-08.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("USelection2016.Instagram")</code></pre>


<h3>Format</h3>

<p>A data frame of four columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> date          </td><td style="text-align: left;"> : </td><td style="text-align: left;"> hour of measurement (in EST5EDT, Eastern Time Zone), </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> format: <code>"%F %T"</code> </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> trump.pos     </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of media uploads with hashtag suggesting </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> positive/neutral annotation to Trump </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> clinton.pos   </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of media uploads with hashtag suggesting </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> positive/neutral annotation to Clinton </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> trump.neg     </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of media uploads with hashtag suggesting </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> negative annotation to Trump </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> clinton.neg   </td><td style="text-align: left;"> : </td><td style="text-align: left;"> number of media uploads with hashtag suggesting </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> negative annotation to Clinton
    </td>
</tr>

</table>



<h3>Details</h3>

<p>Media posted on Instagram are usually annotated with hashtags. A hashtag can be used to determine whether a candidate-related posting is positive/neutral towards a candidate (for example, #makeamericagreatagain for Trump, #hillary2016 for Clinton) or opposing a candidate (for example, #dumptrump for Trump, #neverhillary for Clinton). In this way, four hourly time series are obtained: Trump vs. Clinton, supporters vs. opponents. For further details, see the reference below. The date column also contains a label EDT (Eastern Daylight Time) or EST (Eastern Standard Time); daylight saving time ended 2016-11-06 at 1:00 a.m. when clocks were moved back to 1:00 a.m. EST. The time stamp &quot;2016-11-06 02:00:00&quot; therefore occurs twice, once with EDT and once with EST.
</p>


<h3>Source</h3>

<p>Hourly readings of the number of media posted on Instagram were collected using Instagram's built-in API.
</p>


<h3>References</h3>

<p>Schmidbauer H., Roesch A., Stieler F., 2018.
The 2016 US presidential election and media on Instagram: Who was in the lead?
Computers in Human Behavior 81, 148&ndash;160. 
doi: <a href="http://doi.org/10.1016/j.chb.2017.11.021">10.1016/j.chb.2017.11.021</a>  
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(USelection2016.Instagram)
attach(USelection2016.Instagram)

my.date &lt;- as.POSIXct(date, format = "%F %T", tz = "EST5EDT")

plot(my.date, trump.pos, type = "l", col = 1, lwd = 2,
     ylab = "number of media posted on Instagram", ylim = c(0,6e+6),
     xlab = "the week before the Election Day (Tuesday, 2016-11-08)")
lines(my.date, clinton.pos, col = 2, lwd = 2) 
lines(my.date, trump.neg, col = 3, lwd = 2)
lines(my.date, clinton.neg, col = 4, lwd = 2) 
legend("topleft", legend=names(USelection2016.Instagram[-1]), 
       lty = 1, lwd = 2, col = 1:4) 

detach(USelection2016.Instagram)

</code></pre>

<hr>
<h2 id='WaveletCoherency'>Computation of the cross-wavelet power and wavelet coherence of two time series</h2><span id='topic+WaveletCoherency'></span>

<h3>Description</h3>

<p>Given two time series x and y having the same length and timestamp, this function computes 
the cross-wavelet power and wavelet coherence applying the Morlet wavelet, 
subject to criteria concerning:
the time and frequency resolution, an (optional) lower and/or upper Fourier period, and 
filtering method for the coherence computation.
</p>
<p>The output is further processed by the higher-order function <code>wc</code>
and can be retrieved from <code>analyze.coherency</code>.
</p>
<p>The name and layout were inspired by a similar function developed by Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
The implementation of a choice of filtering windows for the computation of the wavelet coherence 
was inspired by Luis Aguiar-Conraria and Maria Joana Soares (<code>GWPackage</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WaveletCoherency(x, y, dt = 1, dj = 1/20, 
                 lowerPeriod = 2*dt, upperPeriod = floor(length(x)*dt/3), 
                 window.type.t = 1, window.type.s = 1, 
                 window.size.t = 5, window.size.s = 1/4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WaveletCoherency_+3A_x">x</code></td>
<td>
<p>the time series x to be analyzed</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_y">y</code></td>
<td>
<p>the time series y to be analyzed (of the same length as x</p>
</td></tr>

<tr><td><code id="WaveletCoherency_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="WaveletCoherency_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr> 

<tr><td><code id="WaveletCoherency_+3A_window.type.t">window.type.t</code></td>
<td>
<p>type of window for smoothing in time direction; select from:  
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in time direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_window.type.s">window.type.s</code></td>
<td>
<p>type of window for smoothing in scale (period) direction; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in scale (period) </td>
</tr>
<tr>
 <td style="text-align: right;"> 
                     </td><td style="text-align: left;">           </td><td style="text-align: left;">                 </td><td style="text-align: left;">   </td><td style="text-align: left;"> direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_window.size.t">window.size.t</code></td>
<td>
<p>size of the window used for smoothing in time direction, measured in time units 
determined by <code>dt</code>, see the explanations concerning <code>dt</code>. 
Default: <code>5</code>, which together with <code>dt = 1</code> defines a window of length <code>5*(1/dt)</code> = 5, equaling 
5 observations (observation epochs). Windows of even-numbered sizes are extended by 1.
</p>
</td></tr>
<tr><td><code id="WaveletCoherency_+3A_window.size.s">window.size.s</code></td>
<td>
<p>size of the window used for smoothing in scale (period) direction in units of <code>1/dj</code>. 
Default: <code>1/4</code>, which together with <code>dj = 1/20</code> defines a window of length <code>(1/4)*(1/dj)</code> = 5. 
Windows of even-numbered sizes are extended by 1.
</p>
</td></tr>     
</table>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<table>
<tr><td><code>Wave.xy</code></td>
<td>
<p>(complex-valued) cross-wavelet transform (analogous to Fourier cross-frequency spectrum, 
and to the covariance in statistics)</p>
</td></tr> 
<tr><td><code>sWave.xy</code></td>
<td>
<p>smoothed (complex-valued) cross-wavelet transform</p>
</td></tr>
<tr><td><code>Power.xy</code></td>
<td>
<p>cross-wavelet power (analogous to Fourier cross-frequency power spectrum)</p>
</td></tr> 
<tr><td><code>Coherency</code></td>
<td>
<p>(complex-valued) wavelet coherency of series x over series y in the time/frequency domain, 
affected by smoothing (analogous to Fourier coherency, and to the coefficient of correlation in statistics)</p>
</td></tr>       
<tr><td><code>Coherence</code></td>
<td>
<p>wavelet coherence (analogous to Fourier coherence, and to the coefficient of determination 
in statistics (affected by smoothing)</p>
</td></tr>
<tr><td><code>Wave.x</code>, <code>Wave.y</code></td>
<td>
<p>(complex-valued) wavelet transforms of series x and y</p>
</td></tr>
<tr><td><code>Phase.x</code>, <code>Phase.y</code></td>
<td>
<p>phases of series x and y</p>
</td></tr>
<tr><td><code>Ampl.x</code>, <code>Ampl.y</code></td>
<td>
<p>amplitudes of series x and y</p>
</td></tr>
<tr><td><code>Power.x</code>, <code>Power.y</code></td>
<td>
<p>wavelet power of series x and y</p>
</td></tr>
<tr><td><code>sPower.x</code>, <code>sPower.y</code></td>
<td>
<p>smoothed wavelet power of series x and y</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, Bernard Cazelles,
Luis Aguiar-Conraria, and Maria Joana Soares.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2012. <code>GWPackage</code>. 
Available at <a href="https://sites.google.com/site/aguiarconraria/joanasoares-wavelets">https://sites.google.com/site/aguiarconraria/joanasoares-wavelets</a>; accessed September 4, 2013.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+WaveletTransform">WaveletTransform</a></code>, <code><a href="#topic+wc">wc</a></code>, <code><a href="#topic+analyze.coherency">analyze.coherency</a></code>
</p>

<hr>
<h2 id='WaveletComp-package'>Computational Wavelet Analysis</h2><span id='topic+WaveletComp-package'></span><span id='topic+WaveletComp'></span>

<h3>Description</h3>

<p>Wavelet analysis and reconstruction of time series, cross-wavelets and phase difference (with filtering options), 
significance with bootstrap algorithms.</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> WaveletComp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-03-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> Guide booklet at </td>
</tr>
<tr>
 <td style="text-align: left;">
     </td><td style="text-align: left;"> <a href="http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf">http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Periodic phenomena of a single time series can be analyzed with function <code>analyze.wavelet</code>.
Results of the analysis (a time/period image of the wavelet power spectrum, plots of the average power, 
and phase plots for selected periods and a time/period image of phases) can be accessed through various plot functions
(<code>wt.image</code>, <code>wt.avg</code>, <code>wt.sel.phases</code>, <code>wt.phase.image</code>). 
Function <code>reconstruct</code> returns the reconstructed time series where reconstruction is according to constraints 
on significance, period specification, and cone of influence.
</p>
<p>The cross-wavelet spectrum and coherency spectrum of two time series can be analyzed with function <code>analyze.coherency</code>.
Results (a time/period image of cross-wavelet power or coherency, plots of averages, plots of phases and phase differences 
for selected periods and the time/period image of phase differences) can be accessed through corresponding functions
(<code>wc.image</code>, <code>wc.avg</code>, <code>wc.sel.phases</code>, <code>wc.phasediff.image</code>).
</p>
<p>Detrending of the time series at hand is offered as an option. Wavelet transformations are computed using the Morlet wavelet. 
Smoothing filters are provided in the case of cross-wavelet transformation to compute wavelet coherency.
</p>
<p>Significance is assessed with simulation algorithms, a variety of alternative hypotheses to test is available, for which 
surrogate time series are provided: white noise, shuffling the given time series, time series with a similar spectrum, AR, and ARIMA.
</p>
<p>Names and parts of the layout of some routines were inspired by similar functions developed by Huidong Tian 
and Bernard Cazelles (archived R package <code>WaveletCo</code>). The basic concept of the simulation algorithm 
and of ridge determination build on ideas developed by these authors. The major part of the code for the computation
of the cone of influence and the code for Fourier-randomized surrogate time series has been adopted from Huidong Tian. 
The implementation of a choice of filtering windows for the computation of the wavelet coherence was inspired by 
Luis Aguiar-Conraria and Maria Joana Soares (<code>GWPackage</code>).
</p>
<p>Cross-wavelet and coherence computation, the simulation algorithm, and ridge determination build heavily on the use of matrices
in order to minimize computation time in R. <br />
</p>
<p>What is new in <code>WaveletComp</code> version 1.1?
</p>
<p>Tools for displaying and analyzing periodic phenomena across time have been extended. The main innovations are:
</p>

<ul>
<li><p> All functions of family <code>wt.&lt;&gt;</code> (showing results concerning a single time series) can now also be applied 
to extract univariate outcomes from cross-wavelet and coherence analysis (objects of class <code>"analyze.coherency"</code>).
</p>
</li>
<li><p> It is possible to control the color gradation of time-period spectrum plots, and accentuate the contrast, by raising 
the wavelet power values to any (positive) exponent before plotting.
</p>
</li>
<li><p> Setting a maximum level for the color bar facilitates the visual comparison of time-period spectrum plots. 
Maximum and minimum plot levels are options for plots of averages too.
</p>
</li>
<li><p> The time and period axes are now easier to individualize by specifying tick marks and labels. 
Coordinates on the time axis can be conveniently addressed via an index or a <code>"POSIXct"</code> object.
</p>
</li>
<li><p> Graphical parameters of global coverage (<code>cex.axis</code>, <code>font.axis</code>, <code>cex.lab</code>, <code>font.lab</code>, 
<code>mgp</code> etc., see <code>par</code>) as well as parameters of local coverage (within axis specification options) help fine-tune plots.
</p>
</li>
<li><p> Two more real-world data sets have been included in WaveletComp, namely:
</p>

<ul>
<li><p>  Data set <code>"weather.radiation.Mannheim"</code>, containing daily weather and ambient radiation readings from Mannheim (Germany).
</p>
</li>
<li><p> Data set <code>"USelection2016.Instagram"</code>, containing hourly numbers of candidate-related media uploads to Instagram right before the 2016 US presidential election.
</p>
</li></ul>

</li></ul>



<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, Bernard Cazelles, Luis Aguiar-Conraria, and Maria Joana Soares.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2012. <code>GWPackage</code>. 
Available at <a href="https://sites.google.com/site/aguiarconraria/joanasoares-wavelets">https://sites.google.com/site/aguiarconraria/joanasoares-wavelets</a>; accessed September 4, 2013.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Schmidbauer H., Roesch A., Stieler F., 2018.
The 2016 US presidential election and media on Instagram: Who was in the lead?
Computers in Human Behavior 81, 148&ndash;160. 
doi: <a href="http://doi.org/10.1016/j.chb.2017.11.021">10.1016/j.chb.2017.11.021</a> 
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>

<hr>
<h2 id='WaveletTransform'>Morlet wavelet transformation of a time series</h2><span id='topic+WaveletTransform'></span>

<h3>Description</h3>

 
<p>It computes the Morlet wavelet transformation of a given time series, subject to criteria concerning:
the time and frequency resolution, an (optional) lower and/or upper Fourier period.
</p>
<p>The output is further processed by higher-order functions <code>wt</code>, <code>WaveletCoherency</code> and 
<code>wc</code>, and can be retrieved from <code>analyze.wavelet</code> and <code>analyze.coherency</code>.
</p>
<p>The name and layout were inspired by a similar function developed by Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WaveletTransform(x, dt = 1, dj = 1/20, 
                 lowerPeriod = 2*dt, upperPeriod = floor(length(x)*dt/3))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WaveletTransform_+3A_x">x</code></td>
<td>
<p>the time series to be analyzed</p>
</td></tr>

<tr><td><code id="WaveletTransform_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="WaveletTransform_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="WaveletTransform_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="WaveletTransform_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr> 

</table>


<h3>Value</h3>

<p>A list of class <code>analyze.wavelet</code> with the following elements:
</p>
<table>
<tr><td><code>Wave</code></td>
<td>
<p>complex wavelet transform of the series</p>
</td></tr>
<tr><td><code>Phase</code></td>
<td>
<p>phases</p>
</td></tr>
<tr><td><code>Ampl</code></td>
<td>
<p>amplitudes</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>Power</code></td>
<td>
<p>wavelet power in the time/frequency domain</p>
</td></tr>

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+wt">wt</a></code>, <code><a href="#topic+WaveletCoherency">WaveletCoherency</a></code>, <code><a href="#topic+wc">wc</a></code>, <code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, 
<code><a href="#topic+analyze.coherency">analyze.coherency</a></code>
</p>

<hr>
<h2 id='wc'>Cross-wavelet transformation, wavelet coherence computation, and a simulation algorithm</h2><span id='topic+wc'></span>

<h3>Description</h3>

<p>This function provides Morlet cross-wavelet transformation results of the given two time series, 
performed within the lower-order functions <code>WaveletCoherency</code> and <code>WaveletTransform</code> 
subject to criteria concerning the time and frequency resolution, an (optional) lower and/or upper Fourier period, 
and a variety of filtering methods for the coherence computation.
It performs a simulation algorithm to test against a specified alternative hypothesis, 
which can be chosen from a variety of options, and provides p-values. 
The selected model will be fitted to the data and simulated according to estimated parameters 
in order to provide surrogate time series.
This function is called by function <code>analyze.coherency</code>.
</p>
<p>The name and parts of the layout were inspired by a similar function developed by 
Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>). 
The major part of the code for the computation of the cone of influence and the code for 
Fourier-randomized surrogate time series have been adopted from Huidong Tian.
The implementation of a choice of filtering windows for the computation of
the wavelet coherence was inspired by Luis Aguiar-Conraria and Maria Joana Soares (<code>GWPackage</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc(x, y, start = 1, dt = 1, dj = 1/20, 
   lowerPeriod = 2*dt, upperPeriod = floor(length(x)/3)*dt, 
   window.type.t = 1, window.type.s = 1, 
   window.size.t = 5, window.size.s = 1/4,
   make.pval = TRUE, method = "white.noise", params = NULL, 
   n.sim = 100, save.sim = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc_+3A_x">x</code></td>
<td>
<p>the time series x to be analyzed</p>
</td></tr>
<tr><td><code id="wc_+3A_y">y</code></td>
<td>
<p>the time series y to be analyzed (of the same length as x</p>
</td></tr>

<tr><td><code id="wc_+3A_start">start</code></td>
<td>
<p>starting point in time (for the computation of the cone of influence).
</p>
<p>Default: <code>start = 1</code>.</p>
</td></tr>

<tr><td><code id="wc_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="wc_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="wc_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition.<br /> 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="wc_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr> 

<tr><td><code id="wc_+3A_window.type.t">window.type.t</code></td>
<td>
<p>type of window for smoothing in time direction; select from:  
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in time direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="wc_+3A_window.type.s">window.type.s</code></td>
<td>
<p>type of window for smoothing in scale (period) direction; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>0</code> </td><td style="text-align: left;"> (<code>"none"</code>) </td><td style="text-align: left;"> : </td><td style="text-align: left;"> no smoothing in scale (period) </td>
</tr>
<tr>
 <td style="text-align: right;"> 
                     </td><td style="text-align: left;">           </td><td style="text-align: left;">                 </td><td style="text-align: left;">   </td><td style="text-align: left;"> direction </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>1</code> </td><td style="text-align: left;"> (<code>"bar"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Bartlett </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>2</code> </td><td style="text-align: left;"> (<code>"tri"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Triangular (Non-Bartlett) </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>3</code> </td><td style="text-align: left;"> (<code>"box"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Boxcar (Rectangular, Dirichlet)</td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>4</code> </td><td style="text-align: left;"> (<code>"han"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hanning </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>5</code> </td><td style="text-align: left;"> (<code>"ham"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Hamming </td>
</tr>
<tr>
 <td style="text-align: right;">
                     </td><td style="text-align: left;">  <code>6</code> </td><td style="text-align: left;"> (<code>"bla"</code>)  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> Blackman 
                     </td>
</tr>

</table>
 
<p>Default: <code>1</code> = <code>"bar"</code>.
</p>
</td></tr>
<tr><td><code id="wc_+3A_window.size.t">window.size.t</code></td>
<td>
<p>size of the window used for smoothing in time direction, measured in time units 
determined by <code>dt</code>, see the explanations concerning <code>dt</code>. 
Default: <code>5</code>, which together with <code>dt = 1</code> defines a window of length <code>5*(1/dt)</code> = 5, 
equaling 5 observations (observation epochs). Windows of even-numbered sizes are extended by 1.
</p>
</td></tr>
<tr><td><code id="wc_+3A_window.size.s">window.size.s</code></td>
<td>
<p>size of the window used for smoothing in scale (period) direction in units of <code>1/dj</code>. 
Default: <code>1/4</code>, which together with <code>dj = 1/20</code> defines a window of length <code>(1/4)*(1/dj)</code> = 5. 
Windows of even-numbered sizes are extended by 1.
</p>
</td></tr> 

<tr><td><code id="wc_+3A_make.pval">make.pval</code></td>
<td>
<p>Compute p-values? Logical. Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wc_+3A_method">method</code></td>
<td>
<p>the method of generating surrogate time series; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"white.noise"</code>  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> white noise </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"shuffle"</code>      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> shuffling the given time series </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"Fourier.rand"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> time series with a similar spectrum </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"AR"</code>           </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR(p) </td>
</tr>
<tr>
 <td style="text-align: right;">  
                    </td><td style="text-align: left;"> <code>"ARIMA"</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> ARIMA(p,0,q) 
                    </td>
</tr>

</table>

<p>Default: <code>"white.noise"</code>.
</p>
</td></tr>
<tr><td><code id="wc_+3A_params">params</code></td>
<td>
<p>a list of assignments between methods (AR, and ARIMA) and lists of parameter values 
applying to surrogates. Default: <code>NULL</code>. 
</p>
<p>Default includes two lists named <code>AR</code> and <code>ARIMA</code>:
</p>
  
<ul>
<li> <p><code>AR = list(...)</code>, a list containing one single element:
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">          </td><td style="text-align: left;">   </td><td style="text-align: left;"> Default: <code>1</code>.
                </td>
</tr>

</table>

</li>
<li> <p><code>ARIMA = list(...)</code>, a list of six elements:            
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>TRUE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation. </td>
</tr>
<tr>
 <td style="text-align: right;">  
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>0.01</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>
</li></ul>

</td></tr>      

<tr><td><code id="wc_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations. Default: <code>100</code>.</p>
</td></tr>

<tr><td><code id="wc_+3A_save.sim">save.sim</code></td>
<td>
<p>Shall simulations be saved on the output list? Logical.<br /> Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:

</p>
<table>
<tr><td><code>Wave.xy</code></td>
<td>
<p>(complex-valued) cross-wavelet transform (analogous to Fourier cross-frequency spectrum, 
and to the covariance in statistics)</p>
</td></tr> 
<tr><td><code>Angle</code></td>
<td>
<p>phase difference, i.e. phase lead of x over y (= <code>phase.x</code>-<code>phase.y</code>)</p>
</td></tr>
<tr><td><code>sWave.xy</code></td>
<td>
<p>smoothed (complex-valued) cross-wavelet transform</p>
</td></tr>
<tr><td><code>sAngle</code></td>
<td>
<p>phase difference, i.e. phase lead of x over y, affected by smoothing</p>
</td></tr> 

<tr><td><code>Power.xy</code></td>
<td>
<p>cross-wavelet power (analogous to Fourier cross-frequency power spectrum)</p>
</td></tr>
<tr><td><code>Power.xy.avg</code></td>
<td>
<p>average cross-wavelet power in the frequency domain (averages over time)</p>
</td></tr> 
<tr><td><code>Power.xy.pval</code></td>
<td>
<p>p-values of cross-wavelet power</p>
</td></tr>
<tr><td><code>Power.xy.avg.pval</code></td>
<td>
<p>p-values of average cross-wavelet power</p>
</td></tr>

<tr><td><code>Coherency</code></td>
<td>
<p>(complex-valued) wavelet coherency of series x over series y in the time/frequency domain,
affected by smoothing (analogous to Fourier coherency, and to the coefficient of correlation in statistics)</p>
</td></tr>       
<tr><td><code>Coherence</code></td>
<td>
<p>wavelet coherence (analogous to Fourier coherence, and to the coefficient of determination 
in statistics (affected by smoothing)</p>
</td></tr>
<tr><td><code>Coherence.avg</code></td>
<td>
<p>average wavelet coherence in the frequency domain (averages across time)</p>
</td></tr>
<tr><td><code>Coherence.pval</code></td>
<td>
<p>p-values of wavelet coherence</p>
</td></tr>
<tr><td><code>Coherence.avg.pval</code></td>
<td>
<p>p-values of average wavelet coherence</p>
</td></tr>

<tr><td><code>Wave.x</code>, <code>Wave.y</code></td>
<td>
<p>(complex-valued) wavelet transforms of series x and y</p>
</td></tr>
<tr><td><code>Phase.x</code>, <code>Phase.y</code></td>
<td>
<p>phases of series x and y</p>
</td></tr>
<tr><td><code>Ampl.x</code>, <code>Ampl.y</code></td>
<td>
<p>amplitudes of series x and y</p>
</td></tr>
<tr><td><code>Power.x</code>, <code>Power.y</code></td>
<td>
<p>wavelet power of series x and y</p>
</td></tr>
<tr><td><code>Power.x.avg</code>, <code>Power.y.avg</code></td>
<td>
<p>average wavelet power of series x and y, averages across time</p>
</td></tr> 
<tr><td><code>Power.x.pval</code>, <code>Power.y.pval</code></td>
<td>
<p>p-values of wavelet power of series x and y</p>
</td></tr>
<tr><td><code>Power.x.avg.pval</code>, <code>Power.y.avg.pval</code></td>
<td>
<p>p-values of average wavelet power of series x and y</p>
</td></tr>
<tr><td><code>sPower.x</code>, <code>sPower.y</code></td>
<td>
<p>smoothed wavelet power of series x and y</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>coi.1</code>, <code>coi.2</code></td>
<td>
<p>borders of the region where the wavelet transforms are not influenced by edge effects (cone of influence). 
The coordinates of the borders are expressed in terms of internal axes <code>axis.1</code> and <code>axis.2</code>.</p>
</td></tr> 

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
<tr><td><code>axis.2</code></td>
<td>
<p>tick levels corresponding to the log of Fourier periods: <code>log2(Period)</code>. This determines the period axis in plot functions provided by <code>WaveletComp</code>.</p>
</td></tr>

<tr><td><code>series.sim</code></td>
<td>
<p>a data frame of the series simulated as surrogates for the (detrended) time series 
(if both <code>make.pval = TRUE</code> and <code>save.sim = TRUE</code>.)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, Bernard Cazelles,
Luis Aguiar-Conraria, and Maria Joana Soares.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2012. <code>GWPackage</code>. 
Available at <a href="https://sites.google.com/site/aguiarconraria/joanasoares-wavelets">https://sites.google.com/site/aguiarconraria/joanasoares-wavelets</a>; accessed September 4, 2013.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>

<hr>
<h2 id='wc.angle'>Plot arrows into a cross-wavelet or wavelet coherency spectrum</h2><span id='topic+wc.angle'></span>

<h3>Description</h3>

<p>It adds arrows as symbolic indicators of phase-differences into 
a cross-wavelet spectrum or wavelet coherency spectrum of two time series. 
</p>
<p>In particular, the area to be filled with
arrows can be determined in several ways: to reflect significance
(at a given level) with respect to cross-wavelet power, wavelet
coherency, or individual wavelet power, and/or to flag a
high-value region (&quot;high&quot; according to a given level) with respect
to cross-wavelet power (coherency values, respectively). 
</p>
<p>There is an option to choose &quot;smoothed&quot; arrows (phase differences) for plotting; 
these have been computed from smoothing filters as defined in <code>analyze.coherency</code>.
</p>
<p>The name and layout were inspired by a similar function developed by Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>). The code for the arrow design to reflect phase differences 
has been adopted from Huidong Tian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.angle(WC = WC, exponent = 1, use.sAngle = TRUE, p = 1, 
         which.lvl = "wp", lvl = 0, 
         which.sig = which.lvl, siglvl = 0.05, 
         col.arrow = "black")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc.angle_+3A_wc">WC</code></td>
<td>
<p>an object of class <code>analyze.coherency</code></p>
</td></tr>

<tr><td><code id="wc.angle_+3A_exponent">exponent</code></td>
<td>
<p>Exponent applied to cross-wavelet power (or wavelet coherence, depending on <code>which.lvl</code>) values before selecting the area 
to be filled with arrows according to level, see <code>lvl</code> (only effective if <code>p = 0</code> or <code>p = 2</code>); the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="wc.angle_+3A_use.sangle">use.sAngle</code></td>
<td>
<p>Use smoothed version of phase difference to plot arrows? Logical.<br /> Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wc.angle_+3A_p">p</code></td>
<td>
<p>Which area should be filled with arrows displaying phase differences?<br /> 
</p>

<ul>
<li><p>[<code>0</code> :] Select the area w.r.t. power (or coherence, depending on <code>which.lvl</code>.<br /> 
The value of <code>lvl</code> is the threshold.<br /> 
Set <code>lvl = 0</code> to plot arrows over the entire area.
</p>
</li>
<li><p>[<code>1</code> :] Select the area w.r.t. significance as specified in <code>which.sig</code>.<br /> 
The value of <code>siglvl</code> is the threshold.
</p>
</li>
<li><p>[<code>2</code> :] Intersection of both areas above. 
</p>
</li></ul>

<p>Default: <code>1</code>.
</p>
</td></tr>  

<tr><td><code id="wc.angle_+3A_which.lvl">which.lvl</code></td>
<td>
<p>Which spectrum should be used to restrict the area of arrows according to its level? 
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td>
</tr>

</table>

<p>Default: <code>"wp"</code>.
</p>
</td></tr>
<tr><td><code id="wc.angle_+3A_lvl">lvl</code></td>
<td>
<p>minimum level of cross-wavelet power (or wavelet coherence, depending on <code>which.lvl</code>) for arrows to be plotted 
(only effective if <code>p = 0</code> or <code>p = 2</code>).
</p>
<p>Default: <code>0</code>.
</p>
</td></tr> 

<tr><td><code id="wc.angle_+3A_which.sig">which.sig</code></td>
<td>
<p>Which spectrum and corresponding p-values should be used to restrict the area of arrows according to significance? 
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wt"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> individual wavelet power
                                </td>
</tr>

</table>

<p>Default: <code>which.lvl</code>
</p>
</td></tr>
<tr><td><code id="wc.angle_+3A_siglvl">siglvl</code></td>
<td>
<p>level of significance referring to <code>which.sig</code> 
(only effective if <code>p = 1</code> or <code>p = 2</code>).
</p>
<p>Default: <code>0.05</code>.
</p>
</td></tr>

<tr><td><code id="wc.angle_+3A_col.arrow">col.arrow</code></td>
<td>
<p>arrow color. Default: &quot;black&quot;.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+arrow">arrow</a></code>
</p>

<hr>
<h2 id='wc.avg'>
Plot cross-wavelet power averages and wavelet coherence averages across time of two time series
</h2><span id='topic+wc.avg'></span>

<h3>Description</h3>

<p>This function plots cross-wavelet power averages across time, or alternatively 
wavelet coherence averages, of two time series, 
which are provided by an object of class <code>"analyze.coherency"</code>. 
The vertical axis shows the Fourier periods. The horizontal axis shows the averages.
User-defined minimum and maximum levels can be applied to cross-wavelet power averages, 
minimum levels can be applied to coherence averages. 
Also, an option is given to individualize the period axis and/or axis of averages 
by specifying tick marks and labels.
</p>
<p>There is an option to label periods according to significance of
averages (if p-values are provided) at given levels of significance. 
Labels are point symbols along the line of averages which can be assigned individually.
</p>
<p>The idea to show significance levels by colors of plotting characters and its implementation 
has been adopted from Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.avg(WC, which.avg = "wp", exponent = 1,
   show.siglvl = TRUE, 
   siglvl = c(0.05, 0.1), 
   sigcol = c("red", "blue"), sigpch = 20, sigcex = 1,
   minimum.level = NULL, maximum.level = NULL,
   label.avg.axis = TRUE, 
   averagelab = NULL, averagetck = 0.02, averagetcl = 0.5,
   spec.avg.axis = list(at = NULL, labels = TRUE, 
                        las = 1, hadj = NA, padj = NA),
   label.period.axis = TRUE, 
   periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
   spec.period.axis = list(at = NULL, labels = TRUE, 
                           las = 1, hadj = NA, padj = NA),
   show.legend = TRUE, legend.coords = "topright", 
   main = NULL, 
   lwd = 1, col = 1, 
   lwd.axis = 1,
   verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc.avg_+3A_wc">WC</code></td>
<td>
<p>an object of class <code>"analyze.coherency"</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_which.avg">which.avg</code></td>
<td>
<p>Which averages should be plotted?
</p>

<table>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence                            
                           </td>
</tr>

</table>

<p>Default: <code>"wp"</code>.                
</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_exponent">exponent</code></td>
<td>
<p>Exponent applied to averages before plotting; the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_show.siglvl">show.siglvl</code></td>
<td>
<p>Label periods according to significance of averages? (Effective only if p-values are provided.) 
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_siglvl">siglvl</code></td>
<td>
<p>a vector of significance levels (of any length and order). Default: <code>c(0.05, 0.1)</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_sigcol">sigcol</code></td>
<td>
<p>a vector of colors (should be of same length as and correspond to <code>siglvl</code>, 
otherwise colors <code>1 : length(siglvl)</code>).
</p>
<p>Default: <code>c("red","blue")</code>.
</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_sigpch">sigpch</code></td>
<td>
<p>a vector of plotting &quot;characters&quot; (symbols) to use as labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different plotting labels, 
otherwise the default setting is used. A single input value affects all labels.) 
</p>
<p>Default: <code>20</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_sigcex">sigcex</code></td>
<td>
<p>a numerical vector working as size of labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different-sized labels, 
otherwise the default setting is used.  A single input value affects all labels. 
Note that <code>sigcex</code> is affected by <code>cex</code> in <code>par</code>.) 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_minimum.level">minimum.level</code></td>
<td>
<p>Minimum plot level of cross-wavelet power or wavelet coherence averages considered. 
</p>
<p>Default: NULL (referring to minimum level observed).</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_maximum.level">maximum.level</code></td>
<td>
<p>Maximum plot level of cross-wavelet power averages considered. 
</p>
<p>Default: NULL (referring to maximum level observed). Wavelet coherence has maximum average level <code>1</code> by definition.</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_label.avg.axis">label.avg.axis</code></td>
<td>
<p>Label the axis of averages? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_averagelab">averagelab</code></td>
<td>
<p>Label for the axis of averages. 
</p>
<p>Default: <code>"average cross-wavelet power"</code> or <code>"average coherence"</code>, depending on <code>which.avg</code>.</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_averagetck">averagetck</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the smaller of the width or height of 
the plotting region; see <code>par</code>.  
If <code>averagetck &gt;= 0.5</code>, <code>averagetck</code> is interpreted as a fraction of the length of the axis of averages, 
so if <code>averagetck = 1</code> (and <code>averagetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>averagetck = NA</code> is to use <code>averagetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_averagetcl">averagetcl</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the height of a line of text; see <code>par</code>. 
With <code>averagetcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward.
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_spec.avg.axis">spec.avg.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized labeling of the axis of averages 
(only effective if <code>label.avg.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and non-negative values only. <br />
Default: <code>NULL</code>.
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal).
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
   
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wc.avg_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wc.avg_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.avg_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
          
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wc.avg_+3A_show.legend">show.legend</code></td>
<td>
<p>Include legend of significance levels into the plot? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_legend.coords">legend.coords</code></td>
<td>
<p>coordinates to position the legend (as in function <code>legend</code>). 
</p>
<p>Default: <code>"topright"</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: NULL.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_lwd">lwd</code></td>
<td>
<p>width of line of averages. 
</p>
<p>Default: 1.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_col">col</code></td>
<td>
<p>color of line of averages. 
</p>
<p>Default: <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: 1.</p>
</td></tr>
<tr><td><code id="wc.avg_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+wc.sel.phases">wc.sel.phases</a></code>, <code><a href="#topic+wc.phasediff.image">wc.phasediff.image</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>,
<code><a href="#topic+wt.avg">wt.avg</a></code>, <br /> <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is modified from Veleda et al., 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3 &lt;- periodic.series(start.period = 4*24, length = series.length)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3 + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(out of phase at period 16, different amplitudes at period 64)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherence, x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.wc &lt;- analyze.coherency(my.data, c("x","y"), 
                           loess.span = 0, 
                           dt = 1/24, dj = 1/20, 
                           window.size.t = 1, window.size.s = 1/2, 
                           lowerPeriod = 1/4,
                           make.pval = TRUE, n.sim = 10)

## Plot of cross-wavelet power, 
## with color breakpoints according to quantiles:
wc.image(my.wc, main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.      
## By default, arrows are plotted which show the phase differences 
## of x over y at respective significant periods. 
## (Please see our guide booklet for further explanation.)
         
## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days)
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24

## Insert your specification of the time axis: 
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))
       
## Plot of average cross-wavelet power:
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", periodlab = "period (days)")

## The same plot, but with enhanced symbol size, user-defined axes, 
## minimum and a maximum plot level of averages:
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", sigcex = 1.5, 
   minimum.level = 0, maximum.level = 17, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,2,4,8,16,32,64,128)), 
   spec.avg.axis = list(at = seq(0,16,2)), 
   lwd = 1.5)
       
## Another style of the plot:
## 'cex.axis' in 'par' controls for the size of axis tick labels, 
## while 'cex.lab' controls for the size of axis and legend labels. 
## Note that scaling by 'cex' would also affect 'sigcex'. 
op &lt;- par(no.readonly = TRUE)
par(cex.lab = 1.3, cex.axis = 1.1)
wc.avg(my.wc, siglvl = 0.05, sigcol = "red", sigcex = 1.5, 
   minimum.level = 0, maximum.level = 17, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,2,4,8,16,32,64,128)), 
   spec.avg.axis = list(at = seq(0,16,2)),
   lwd = 1.5)
par(op)      

## Plot of wavelet coherence 
## (with color breakpoints according to quantiles):
wc.image(my.wc, which.image = "wc", main = "wavelet coherence, x over y",
   legend.params = list(label.digits = 3),
   periodlab = "period (days)")
         
## Plot of average wavelet coherence:
wc.avg(my.wc, which.avg = "wc", 
   siglvl = 0.05, sigcol = "red", legend.coords = "topleft", 
   periodlab = "period (days)", 
   lwd = 1.5)

## The same plot, setting the minimum plot level of averages to 0: 
wc.avg(my.wc, which.avg = "wc", 
   siglvl = 0.05, sigcol = "red", legend.coords = "topleft", 
   minimum.level = 0, 
   periodlab = "period (days)", 
   lwd = 1.5)
 
## Please see also the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='wc.image'>
Image plot of the cross-wavelet power spectrum and wavelet coherence
spectrum of two time series
</h2><span id='topic+wc.image'></span>

<h3>Description</h3>

<p>This function plots the cross-wavelet power image, or alternatively the wavelet
coherence image, of two time series, which are provided by an object of class
<code>"analyze.coherency"</code>.  
The vertical axis shows the Fourier periods. The horizontal axis shows time step counts, but can
be easily transformed into a calendar axis if dates are provided in either row names or a variable 
named <code>"date"</code> in the data frame at hand. Both axes can be relabeled.
In particular, an option is given to individualize the period and/or time axis 
by specifying tick marks and labels.
</p>
<p>An option is given to raise cross-wavelet power (or wavelet coherence) values 
to any (positive) exponent before plotting in order to accentuate the contrast of the image.
</p>
<p>The color levels can be defined according to quantiles of values
or according to equidistant breakpoints (covering the interval
from 0 to maximum level), with the number of levels as a further
parameter. A user-defined maximum level can be applied to cross-wavelet power images. 
In addition, there is an option to adopt an individual color palette.
</p>
<p>Further plot design options concern: plot of the cone of
influence, plot of contour lines to border areas of significance, plot of 
the ridge, and plot of arrows (optional: &quot;smoothed&quot; arrows computed 
from smoothing filters as defined in <code>analyze.coherency</code>) to reflect
phase differences.
</p>
<p>For that matter, the significance level of contour lines can be
defined separately. The plot of the ridge can be restricted to a high-level region 
(&quot;high&quot; according to a given level of plotted values). 
In particular, the area to be filled with arrows can be determined in several ways: 
to reflect significance (at a given level) with respect to cross-wavelet power, wavelet
coherence, or individual wavelet power, and/or to flag a high-value region. 
Furthermore, there is an option to clear out the area where the p-values of
cross-wavelet power (coherence, respectively) exceed a given
level.
</p>
<p>Finally, there is an option to format and insert a color legend (a
right-hand vertical color bar) and to set the plot title.  For
further processing of the plot, graphical parameters of plot
regions are provided as output.
</p>
<p>The name and parts of the layout were inspired by a similar function developed by 
Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>). 
The code for the arrow design to reflect phase differences 
has been adopted from Huidong Tian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.image(WC, 
     which.image = "wp", exponent = 1, 
     plot.coi = TRUE, 
     plot.contour = TRUE, siglvl.contour = 0.1, col.contour = "white",
     plot.ridge = FALSE, lvl = 0, col.ridge = "black",
     plot.arrow = TRUE, use.sAngle = FALSE, 
     p = 1, 
     which.arrow.sig = which.image, 
     siglvl.arrow = 0.05, col.arrow = "black",
     clear.area = FALSE, 
     which.area.sig = which.image, siglvl.area = 0.2, 
     color.key = "quantile", 
     n.levels = 100, 
     color.palette = "rainbow(n.levels, start = 0, end = .7)", 
     maximum.level = NULL,
     useRaster = TRUE, max.contour.segments = 250000,
     plot.legend = TRUE,
     legend.params = list(width=1.2, shrink = 0.9, mar = 5.1, 
                          n.ticks = 6, 
                          label.digits = 1, label.format = "f", 
                          lab = NULL, lab.line = 2.5),
     label.time.axis = TRUE, 
     show.date = FALSE, date.format = NULL, date.tz = NULL,
     timelab = NULL, timetck = 0.02, timetcl = 0.5,
     spec.time.axis = list(at = NULL, labels = TRUE, 
                           las = 1, hadj = NA, padj = NA),
     label.period.axis = TRUE, 
     periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
     spec.period.axis = list(at = NULL, labels = TRUE, 
                             las = 1, hadj = NA, padj = NA),
     main = NULL,
     lwd = 2, lwd.axis = 1, 
     graphics.reset = TRUE,
     verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc.image_+3A_wc">WC</code></td>
<td>
<p>an object of class <code>"analyze.coherency"</code></p>
</td></tr>
<tr><td><code id="wc.image_+3A_which.image">which.image</code></td>
<td>
<p>Which image is to be plotted?
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td>
</tr>

</table>

<p>Default: <code>"wp"</code>.
</p>
</td></tr>

<tr><td><code id="wc.image_+3A_exponent">exponent</code></td>
<td>
<p>Exponent applied to values before plotting in order to accentuate the contrast of the image; 
the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>

<tr><td><code id="wc.image_+3A_plot.coi">plot.coi</code></td>
<td>
<p>Plot cone of influence? Logical. Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_plot.contour">plot.contour</code></td>
<td>
<p>Plot contour lines to border the area of cross-wavelet power (or wavelet coherence, 
depending on <code>which.image</code>) significance? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_siglvl.contour">siglvl.contour</code></td>
<td>
<p>level of cross-wavelet power (or wavelet coherence, depending on <code>which.image</code>) 
significance to be applied to the plot of contour lines. 
</p>
<p>Default: <code>0.1</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_col.contour">col.contour</code></td>
<td>
<p>color of contour lines. Default: <code>"white"</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_plot.ridge">plot.ridge</code></td>
<td>
<p>Plot the cross-wavelet power (or wavelet coherence, depending on <code>which.image</code>) ridge? Logical.
</p>
<p>Default: <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_lvl">lvl</code></td>
<td>
<p>minimum level of cross-wavelet power (or wavelet coherence, depending on <code>which.image</code>) for ridge or arrows to be plotted.<br />
(Only effective if <code>plot.ridge = TRUE</code> or, when setting <code>p = 0</code> or <code>p = 2</code>, if <code>plot.arrow = TRUE</code>.)
</p>
<p>Default: <code>0</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_col.ridge">col.ridge</code></td>
<td>
<p>ridge color. Default: <code>"black"</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_plot.arrow">plot.arrow</code></td>
<td>
<p>Plot arrows depicting the phase difference? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_use.sangle">use.sAngle</code></td>
<td>
<p>Use smoothed version of phase difference? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_p">p</code></td>
<td>
<p>Which area should be filled with arrows displaying phase differences?<br /> 
(Only effective if <code>plot.arrow = TRUE</code>.)
</p>

<ul>
<li><p>[<code>0</code> :] Select the area w.r.t. power (or coherence, depending on <code>which.image</code>.<br /> 
The value of <code>lvl</code> is the threshold.<br /> 
Set <code>lvl = 0</code> to plot arrows over the entire area.
</p>
</li>
<li><p>[<code>1</code> :] Select the area w.r.t. significance as specified in <code>which.arrow.sig</code>.<br /> 
The value of <code>siglvl.arrow</code> is the threshold.
</p>
</li>
<li><p>[<code>2</code> :] Intersection of both areas above. 
</p>
</li></ul>

<p>Default: <code>1</code>.
</p>
</td></tr>  

<tr><td><code id="wc.image_+3A_which.arrow.sig">which.arrow.sig</code></td>
<td>
<p>Which spectrum (and corresponding p-values) should be used to restrict the plot 
of arrows according to significance?
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wt"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> individual wavelet power
                                </td>
</tr>

</table>

<p>Default: <code>which.image</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_siglvl.arrow">siglvl.arrow</code></td>
<td>
<p>level of significance for arrows to be plotted. <br /> 
(Only effective if <code>plot.arrow = TRUE</code> and <code>p = 1</code> or <code>p = 2</code>.)
</p>
<p>Default: <code>0.05</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_col.arrow">col.arrow</code></td>
<td>
<p>arrow color. Default: <code>"black"</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_clear.area">clear.area</code></td>
<td>
<p>Clear out an area where p-values are above a certain level? Logical.
</p>
<p>(Here, p-values will refer to the spectrum defined by <code>which.area.sig</code> and significance level <code>siglvl.area</code>, see below.) 
</p>
<p>Default: <code>FALSE</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_which.area.sig">which.area.sig</code></td>
<td>
<p>Which power spectrum (and corresponding p-values) should be used to clear the outer area? <br />
(Only effective if <code>clear.area = TRUE</code>) 
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wt"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> individual wavelet power
                                </td>
</tr>

</table>

<p>Default: <code>which.image</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_siglvl.area">siglvl.area</code></td>
<td>
<p>level of significance for the area to be cleared out. <br />
(Only effective if <code>clear.area = TRUE</code>.) 
</p>
<p>Default: <code>0.2</code>.
</p>
</td></tr>

<tr><td><code id="wc.image_+3A_color.key">color.key</code></td>
<td>
<p>How to assign colors to power and coherence levels? Two options:
</p>

<table>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">  <code>"interval"</code> or <code>"i"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> equidistant breakpoints </td>
</tr>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">                                  </td><td style="text-align: left;">   </td><td style="text-align: left;"> (from <code>0</code> through maximum value) </td>
</tr>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">  <code>"quantile"</code> or <code>"q"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> quantiles 
                           </td>
</tr>

</table>
 
<p>Default: <code>"quantile"</code>.
</p>
</td></tr>
<tr><td><code id="wc.image_+3A_n.levels">n.levels</code></td>
<td>
<p>Number of color levels. Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_color.palette">color.palette</code></td>
<td>
<p>Definition of color levels. (The color palette will be assigned to levels in reverse order!)
</p>
<p>Default: <code>"rainbow(n.levels, start = 0, end = .7)"</code>.
</p>
</td></tr>

<tr><td><code id="wc.image_+3A_maximum.level">maximum.level</code></td>
<td>
<p>Maximum plot level of cross-wavelet power considered; only effective in case of equidistant breakpoints (<code>color.key</code> equaling <code>"i"</code>).  
</p>
<p>Default: <code>NULL</code> (referring to maximum level observed).<br /> 
Wavelet coherence has maximum plot level <code>1</code> by definition.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_useraster">useRaster</code></td>
<td>
<p>Use a bitmap raster instead of polygons to plot the image? Logical.
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_max.contour.segments">max.contour.segments</code></td>
<td>
<p>limit on the number of segments in a single contour line, positive integer. 
</p>
<p>Default: <code>250000</code> (<code>options(...)</code> default settings: <code>25000</code>).</p>
</td></tr>

<tr><td><code id="wc.image_+3A_plot.legend">plot.legend</code></td>
<td>
<p>Plot color legend (a vertical bar of colors and breakpoints)? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_legend.params">legend.params</code></td>
<td>
<p>a list of parameters for the plot of the color legend; parameter values can be set selectively 
(style in parts adopted from <code>image.plot</code> in the R package <code>fields</code> by Douglas Nychka):
</p>

<ul>
<li><p>[<code>width</code>:] width of legend bar. <br /> 
Default: <code>1.2</code>. 
</p>
</li>
<li><p>[<code>shrink</code>:] a vertical shrinkage factor. <br />
Default: <code>0.9</code>. 
</p>
</li>
<li><p>[<code>mar</code>:] right margin of legend bar. <br />
Default: <code>5.1</code>. 
</p>
</li>
<li><p>[<code>n.ticks</code>:] number of ticks for labels. <br /> 
Default: <code>6</code>. 
</p>
</li>
<li><p>[<code>label.digits</code>:] digits of labels. <br />
Default: <code>1</code>. 
</p>
</li>
<li><p>[<code>label.format</code>:] format of labels. <br />
Default: <code>"f"</code>. 
</p>
</li>
<li><p>[<code>lab</code>:] axis label. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>lab.line</code>:] line (in user coordinate units) where to put the axis label. <br />
Default: <code>2.5</code>.
</p>
</li></ul>

</td></tr>

<tr><td><code id="wc.image_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which has been analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WC</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WC</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label. 
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wc.image_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wc.image_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn.<br /> 
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.image_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
  
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>  

<tr><td><code id="wc.image_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_lwd">lwd</code></td>
<td>
<p>line width of contour lines and ridge. 
</p>
<p>Default: <code>2</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes (image and legend bar). 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wc.image_+3A_graphics.reset">graphics.reset</code></td>
<td>
<p>Reset graphical parameters? Logical. 
</p>
<p>Default: <code>TRUE</code></p>
</td></tr>
<tr><td><code id="wc.image_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>graphical parameters</code> with the following elements:
</p>
<table>
<tr><td><code>op</code></td>
<td>
<p>original graphical parameters</p>
</td></tr>
<tr><td><code>image.plt</code></td>
<td>
<p>image plot region</p>
</td></tr>
<tr><td><code>legend.plt</code></td>
<td>
<p>legend plot region</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, and Bernard Cazelles.</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wc.avg">wc.avg</a></code>, <code><a href="#topic+wc.sel.phases">wc.sel.phases</a></code>, <code><a href="#topic+wc.phasediff.image">wc.phasediff.image</a></code>, 
<code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <br />
<code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is modified from Veleda et al., 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3 &lt;- periodic.series(start.period = 4*24, length = series.length)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3 + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(out of phase at period 16, different amplitudes at period 64)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherence, x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.wc &lt;- analyze.coherency(my.data, c("x","y"), 
                           loess.span = 0, 
                           dt = 1/24, dj = 1/20, 
                           window.size.t = 1, window.size.s = 1/2, 
                           lowerPeriod = 1/4,
                           make.pval = TRUE, n.sim = 10)

## Plot of cross-wavelet power spectrum, 
## with color breakpoints according to quantiles:
wc.image(my.wc, 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.      
## By default, arrows are plotted which show the phase differences 
## of x over y at respective significant periods. 
## (Please see our guide booklet for further explanation.)

## The same plot, but with equidistant color breakpoints: 
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   periodlab = "period (days)")

## The same plot, but adopting a palette of gray colors, 
## omitting the arrows:
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   plot.arrow = FALSE,
   periodlab = "period (days)")
         
## The same plot, now with ridge of power:
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   plot.arrow = FALSE,
   plot.ridge = TRUE, col.ridge = "red",
   periodlab = "period (days)")             
         
## The plot, turning back to arrows, now in yellow color:
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow",
   periodlab = "period (days)")   
         
## Alternate styles of the time axis:          
    
## The plot with time elapsed in days, starting from 0 and proceeding 
## in steps of 50 days (50*24 hours), instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24    

## Insert your specification of time axis: 
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow",
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The plot with (automatically produced) calendar axis:
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow",
   periodlab = "period (days)",
   show.date = TRUE, date.format = "%F %T")

## Individualizing your calendar axis (works with show.date = TRUE)...
## How to obtain, for example, monthly date ticks and labels:

## The sequence of tick positions:
monthly.ticks &lt;- seq(as.POSIXct("2014-11-01 00:00:00", format = "%F %T"), 
                     as.POSIXct("2015-11-01 00:00:00", format = "%F %T"), 
                     by = "month")
## Observe that the following specification may produce an error:
## 'seq(as.Date("2014-11-01"), as.Date("2015-11-01"), by = "month")'
## Time of the day is missing here!

## The sequence of labels (e.g. information on month and year only):
monthly.labels &lt;- strftime(monthly.ticks, format = "%b %Y")

## Insert your specification of time axis as parameter to wc.image: 
wc.image(my.wc, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y", 
   legend.params = list(lab = "cross-wavelet power levels (equidistant)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow", 
   periodlab = "period (days)",
   show.date = TRUE, date.format = "%F %T", 
   spec.time.axis = list(at = monthly.ticks, labels = monthly.labels, 
                         las = 2))
## Note: 
## The monthly ticks specify the midpoints of the colored cells and 
## match the location of corresponding (default) time index ticks.

## A cross-wavelet power plot with individualized period axis and exponent 
## to accentuate contrast in the image:
wc.image(my.wc, exponent = 0.5, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels 
   (raised by exponent 0.5, equidistant levels)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow", 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,2,4,8,16,32,64,128))) 
         
## An option to switch to the corresponding frequency axis:
my.periods &lt;- c(1,2,4,8,16,32,64,128)
my.frequencies &lt;- paste("1/",my.periods, sep = "")
wc.image(my.wc, exponent = 0.5, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels
   (raised by exponent 0.5, equidistant levels)"),
   color.palette = "gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow", 
   periodlab = "frequency (per day)", 
   spec.period.axis = list(at = my.periods, labels = my.frequencies))            

## Adding, for example, horizontal lines at period ticks...

## There is an option to add further objects to the image plot region, 
## by setting 'graphics.reset = FALSE' 
## (but recall previous par settings after plotting):

op &lt;- par(no.readonly = TRUE)
wc.image(my.wc, exponent = 0.5, color.key = "i", 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels
   (raised by exponent 0.5, equidistant levels)"),
   color.palette="gray( (1:n.levels)/n.levels )", 
   col.arrow = "yellow", 
   periodlab = "frequency (per day)", 
   spec.period.axis = list(at = my.periods, labels = my.frequencies),
   timelab = "",
   show.date = TRUE, date.format = "%F %T",
   graphics.reset = FALSE)            
abline(h = log2(my.periods))
year2015 &lt;- as.POSIXct("2015-01-01 00:00:00", format = "%F %T")
abline(v = year2015)
axis(1, at = year2015, labels = 2015, padj = 1)
par(op)

## For further axis plotting options: 
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.    
            
## Plot of wavelet coherence of x over y, 
## with color breakpoints according to quantiles:
wc.image(my.wc, which.image = "wc", 
   main = "wavelet coherence, x over y",
   legend.params = list(lab = "wavelet coherence levels (quantiles)", 
                        lab.line = 3.5, label.digits = 3),
   periodlab = "period (days)")

## Plot of wavelet coherence, but with equidistant color breakpoints:
wc.image(my.wc, which.image = "wc", color.key = "i",
   main = "wavelet coherence, x over y",
   legend.params = list(lab = "wavelet coherence levels (equidistant)"),
   periodlab = "period (days)")  
   

## End(Not run)
</code></pre>

<hr>
<h2 id='wc.phasediff.image'>
Image plot of phase differences of periodic components for two time
series
</h2><span id='topic+wc.phasediff.image'></span>

<h3>Description</h3>

<p>This function plots the phase difference image of two time series, which is 
provided by an object of class <code>"analyze.coherency"</code>.  
The vertical axis shows the Fourier periods. The horizontal axis shows time step counts, but can 
be easily transformed into a calendar axis if dates are provided in either row names or a variable 
named <code>"date"</code> in the data frame at hand. Both axes can be relabeled.
In particular, an option is given to individualize the period and/or time axis 
by specifying tick marks and labels.
</p>
<p>The color levels are defined according to equidistant breakpoints
(covering the interval from <code>-pi</code> to <code>+pi</code>), with the number of levels
as a further parameter. In addition, there is an option to adopt
an individual color palette.
</p>
<p>If the default palette is retained, colors indicate the following. Green:
phase differences close to zero, which means that the two time
series are in phase at the respective period. Yellowgreen: in
phase, series 1 leading. Turquoise: in phase, series 2 leading.
Red: phase differences are close to <code>+pi</code>, out of phase, series
2 leading. Blue: phase differences are close to <code>-pi</code>, out of
phase, series 1 leading.
</p>
<p>Further plot design options concern: plot of the cone of
influence, plot of contour lines to border areas of significance
with respect to cross-wavelet power or wavelet coherence at a
given significance level.
</p>
<p>Finally, there is an option to insert and format a color legend (a
right-hand vertical color bar) and to set the plot title.  For
further processing of the plot, graphical parameters of plot
regions are provided as output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.phasediff.image(WC, use.sAngle = FALSE, 
   plot.coi = TRUE, 
   plot.contour = TRUE, which.contour = "wp", 
   siglvl = 0.1, col.contour = "white",
   n.levels = 100, 
   color.palette = "rainbow(n.levels, start = 0, end = .7)", 
   useRaster = TRUE, max.contour.segments = 250000,
   plot.legend = TRUE,
   legend.params = list(width = 1.2, shrink = 0.9, mar = 5.1, 
                        n.ticks = 6, 
                        pi.style = TRUE, 
                        label.digits = 1, label.format = "f", 
                        lab = NULL, lab.line = 3),
   label.time.axis = TRUE, 
   show.date = FALSE, date.format = NULL, date.tz = NULL,
   timelab = NULL, timetck = 0.02, timetcl = 0.5,
   spec.time.axis = list(at = NULL, labels = TRUE, 
                         las = 1, hadj = NA, padj = NA),
   label.period.axis = TRUE, 
   periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
   spec.period.axis = list(at = NULL, labels = TRUE, 
                           las = 1, hadj = NA, padj = NA),
   main = NULL,
   lwd = 2, lwd.axis = 1,
   graphics.reset = TRUE,
   verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc.phasediff.image_+3A_wc">WC</code></td>
<td>
<p>an object of class <code>"analyze.coherency"</code></p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_use.sangle">use.sAngle</code></td>
<td>
<p>Use smoothed version of phase difference? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_plot.coi">plot.coi</code></td>
<td>
<p>Plot cone of influence? Logical. Default: <code>TRUE</code></p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_plot.contour">plot.contour</code></td>
<td>
<p>Plot contour lines to border the area of cross-wavelet power (or wavelet coherence, 
depending on <code>which.contour</code>) significance? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_which.contour">which.contour</code></td>
<td>
<p>Contour lines of which spectrum should be plotted?
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence 
                                </td>
</tr>

</table>

<p>Default: <code>"wp"</code>.
</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_siglvl">siglvl</code></td>
<td>
<p>level of cross-wavelet power (or wavelet coherence, depending on <code>which.contour</code>) 
significance to be applied to the plot of contour lines. 
</p>
<p>Default: <code>0.1</code>.
</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_col.contour">col.contour</code></td>
<td>
<p>color of contour lines. Default: <code>"white"</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_n.levels">n.levels</code></td>
<td>
<p>Number of color levels. Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_color.palette">color.palette</code></td>
<td>
<p>Definition of color levels. (The color palette will be assigned to levels in reverse order!)
</p>
<p>Default: <code>"rainbow(n.levels, start = 0, end = .7)"</code>.
</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_useraster">useRaster</code></td>
<td>
<p>Use a bitmap raster instead of polygons to plot the image? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_max.contour.segments">max.contour.segments</code></td>
<td>
<p>limit on the number of segments in a single contour line, positive integer. 
</p>
<p>Default: <code>250000</code> (<code>options(...)</code> default settings: <code>25000</code>).</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_plot.legend">plot.legend</code></td>
<td>
<p>Plot color legend (a vertical bar of colors and breakpoints)? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_legend.params">legend.params</code></td>
<td>
<p>a list of parameters for the plot of the color legend; parameter values can be set selectively 
(style in parts adopted from <code>image.plot</code> in the R package <code>fields</code> by Douglas Nychka):
</p>

<ul>
<li><p>[<code>width</code>:] width of legend bar. <br /> 
Default: <code>1.2</code>. 
</p>
</li>
<li><p>[<code>shrink</code>:] a vertical shrinkage factor. <br />
Default: <code>0.9</code>. 
</p>
</li>
<li><p>[<code>mar</code>:] right margin of legend bar. <br />
Default: <code>5.1</code>. 
</p>
</li>
<li><p>[<code>n.ticks</code>:] number of ticks for labels. <br /> 
Default: <code>6</code>. 
</p>
</li>
<li><p>[<code>pi.style</code>:] style of labels, logical: if <code>TRUE</code>, the symbol <code>"pi"</code> is used to label the legend bar; otherwise, labels are numerals. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>label.digits</code>:] number of digits of (numerical factors of) labels. <br />
Default: <code>1</code> if <code>pi.style</code> is <code>TRUE</code>, else <code>2</code>. 
</p>
</li>
<li><p>[<code>label.format</code>:] format of labels. <br />
Default: <code>"f"</code>. 
</p>
</li>
<li><p>[<code>lab</code>:] axis label. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>lab.line</code>:] line (in user coordinate units) where to put the axis label. <br />
Default: <code>3</code>.
</p>
</li></ul>
         
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WC</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WC</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label. 
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wc.phasediff.image_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wc.phasediff.image_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.phasediff.image_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
  
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>  

<tr><td><code id="wc.phasediff.image_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_lwd">lwd</code></td>
<td>
<p>line width of contour lines and ridge. 
</p>
<p>Default: <code>2</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes (image and legend bar). 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_graphics.reset">graphics.reset</code></td>
<td>
<p>Reset graphical parameters? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.phasediff.image_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>graphical parameters</code> with the following elements:
</p>
<table>
<tr><td><code>op</code></td>
<td>
<p>original graphical parameters</p>
</td></tr>
<tr><td><code>image.plt</code></td>
<td>
<p>image plot region</p>
</td></tr>
<tr><td><code>legend.plt</code></td>
<td>
<p>legend plot region</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+wc.avg">wc.avg</a></code>, <code><a href="#topic+wc.sel.phases">wc.sel.phases</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is modified from Veleda et al., 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3a &lt;- periodic.series(start.period = 4*24, length = series.length)
x3b &lt;- periodic.series(start.period = 4*24, length = series.length,
                       phase = 24)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3a + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3b + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(different phases at periods 4 and 16)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherence, x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.wc &lt;- analyze.coherency(my.data, c("x","y"), 
                           loess.span = 0, 
                           dt = 1/24, dj = 1/20, 
                           window.size.t = 1, window.size.s = 1/2, 
                           lowerPeriod = 1/4,
                           make.pval = TRUE, n.sim = 10)

## Plot of cross-wavelet power spectrum, 
## with color breakpoints according to quantiles:
wc.image(my.wc, 
   main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)")

## Default plot of phase differences 
## (with contour lines referring to cross-wavelet power)
wc.phasediff.image(my.wc, which.contour = "wp", 
   main = "image of phase differences, x over y",
   periodlab = "period (days)")
      
## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24      
wc.phasediff.image(my.wc, which.contour = "wp", 
   main = "image of phase differences, x over y",
   periodlab = "period (days)",
   timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The same plot, but with (automatically produced) calendar axis:  
wc.phasediff.image(my.wc, which.contour = "wp", 
   main = "image of phase differences, x over y",
   periodlab = "period (days)",
   show.date = TRUE, date.format = "%F %T")
     
## For further axis plotting options:
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf. 

## Plot of phase difference with numerals as labels of the color legend bar: 
wc.phasediff.image(my.wc, 
   legend.params=list(pi.style = FALSE, label.digits = 2))
   

## End(Not run)
</code></pre>

<hr>
<h2 id='wc.sel.phases'>
Comparison plot of phases for selected periodic components of two time
series
</h2><span id='topic+wc.sel.phases'></span>

<h3>Description</h3>

<p>This function plots the phases for periodic components of two time series, 
which are provided by an object of class <code>"analyze.coherency"</code>.
</p>
<p>Periodic components can be selected by specification of a single
Fourier period or of a period band. In the latter case, and in the
default case (no specification at all), phases are averaged across
periods for each time series. Other options: restriction to the 
cone of influence, restriction to an area of significance (with respect 
to cross-wavelet power, wavelet coherence or individual wavelet power). 
Phase differences (i.e. angles, smoothed or not
smoothed) can be added to the plot.
</p>
<p>(The time axis can be altered to display dates, see e.g. <code>wt.image</code>.
In particular, an option is given to individualize the phase and/or time axis
by specifying tick marks and labels.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wc.sel.phases(WC, sel.period = NULL, sel.lower = NULL, sel.upper = NULL, 
      only.coi = FALSE, 
      only.sig = TRUE, which.sig = "wp", siglvl = 0.05, 
      phase.cols = c("red", "blue"), 
      show.Angle = TRUE, use.sAngle = FALSE, Angle.col = "black", 
      show.legend = TRUE, legend.coords = "topleft", legend.horiz = TRUE,
      label.time.axis = TRUE, 
      show.date = FALSE, date.format = NULL, date.tz = NULL, 
      timelab = NULL, timetck = 0.02, timetcl = 0.5,
      spec.time.axis = list(at = NULL, labels = TRUE, 
                            las = 1, hadj = NA, padj = NA),
      label.phase.axis = TRUE, 
      phaselab = NULL, phasetck = 0.02, phasetcl = 0.5,
      spec.phase.axis = list(at = NULL, labels = TRUE, 
                             las = 1, hadj = NA, padj = NA),
      phaselim = c(-pi,pi+show.legend*ifelse(legend.horiz,0.8,2)),      
      main = NULL, sub = NULL,
      lwd = 1, lwd.Angle = 2, lwd.axis = 1, 
      verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wc.sel.phases_+3A_wc">WC</code></td>
<td>
<p>an object of class <code>"analyze.coherency"</code>. </p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_sel.period">sel.period</code></td>
<td>
<p>a single number which determines the (closest available) Fourier period to be selected. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_sel.lower">sel.lower</code></td>
<td>
<p>a number to define a lower Fourier period (or the closest available) for the selection 
of a band of periods (effective if <code>sel.period</code> is <code>NULL</code>). 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_sel.upper">sel.upper</code></td>
<td>
<p>a number to define an upper Fourier period (or the closest available) for the selection 
of a band of periods (effective if <code>sel.period</code> is <code>NULL</code>). 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr> 

<tr><td><code id="wc.sel.phases_+3A_only.coi">only.coi</code></td>
<td>
<p>Exclude borders influenced by edge effects, i.e. include the cone of influence only? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_only.sig">only.sig</code></td>
<td>
<p>Use cross-wavelet power (or wavelet coherence, depending on <code>which.sig</code>) significance 
to decide about the inclusion of (parts of) the series of phases? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_which.sig">which.sig</code></td>
<td>
<p>Which spectrum should significance refer to?
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wp"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wc"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> <code>"wt"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> individual wavelet power
                                </td>
</tr>

</table>

<p>Default: <code>"wp"</code>
</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_siglvl">siglvl</code></td>
<td>
<p>level of cross-wavelet power (or wavelet coherence, depending on <code>which.sig</code>) significance.
</p>
<p>Default: <code>0.05</code>.</p>
</td></tr> 

<tr><td><code id="wc.sel.phases_+3A_phase.cols">phase.cols</code></td>
<td>
<p>a vector of two colors for the plot of (average) phases referring to the two time series.
</p>
<p>Default: <code>c("red","blue")</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_show.angle">show.Angle</code></td>
<td>
<p>Show the (average) phase difference (the Angle) between the two series? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_use.sangle">use.sAngle</code></td>
<td>
<p>Use smoothed version of phase difference? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_angle.col">Angle.col</code></td>
<td>
<p>color of the line of Angles. 
</p>
<p>Default: <code>"black"</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_show.legend">show.legend</code></td>
<td>
<p>Include legend? Logical.
Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_legend.coords">legend.coords</code></td>
<td>
<p>Coordinates to position the legend (with the same options as given in function <code>legend</code>). 
</p>
<p>Default: <code>"topleft"</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_legend.horiz">legend.horiz</code></td>
<td>
<p>Set the legend horizontally rather than vertically? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WC</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WC</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label. 
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br /> 
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wc.sel.phases_+3A_label.phase.axis">label.phase.axis</code></td>
<td>
<p>Label the phase axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_phaselab">phaselab</code></td>
<td>
<p>Phase axis label. 
</p>
<p>Default: <code>"phase"</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_phasetck">phasetck</code></td>
<td>
<p>length of tick marks on the phase axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>phasetck &gt;= 0.5</code>, <code>phasetck</code> is interpreted as a fraction of the length of the phase axis, so if <code>phasetck = 1</code> 
(and <code>phasetcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>phasetck = NA</code> is to use <code>phasetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_phasetcl">phasetcl</code></td>
<td>
<p>length of tick marks on the phase axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>phasetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_spec.phase.axis">spec.phase.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized phase axis labeling 
(only effective if <code>label.phase.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical values between <code>-pi</code> and <code>pi</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>   

<tr><td><code id="wc.sel.phases_+3A_phaselim">phaselim</code></td>
<td>
<p>numeric vector of length 2, giving the phase coordinate range.
</p>
<p>Default: <code>c(-pi,pi+0.8)</code><br />
(<code>+0.8</code> in order to accomodate the horizontal legend, <code>+2</code> in case of a vertical legend).</p>
</td></tr>

<tr><td><code id="wc.sel.phases_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_sub">sub</code></td>
<td>
<p>a subtitle for the plot. 
</p>
<p>Default: <code>NULL</code>. In this case, the selected period range will be given in the subtitle.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_lwd">lwd</code></td>
<td>
<p>width of lines of phases. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_lwd.angle">lwd.Angle</code></td>
<td>
<p>width of lines of (average) phase differences (the Angles) between the two series (this line will be plotted if <code>show.Angle = TRUE</code>).
</p>
<p>Default: <code>2</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wc.sel.phases_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>"sel.phases"</code> with the following elements:
</p>
<table>
<tr><td><code>Period</code></td>
<td>
<p>the selected period (or period band)</p>
</td></tr>
<tr><td><code>Phase.x</code></td>
<td>
<p>time series of (average) phases at the selected period (or period band), case of series x</p>
</td></tr> 
<tr><td><code>Phase.y</code></td>
<td>
<p>time series of (average) phases at the selected period (or period band), case of series y</p>
</td></tr>
<tr><td><code>Angle</code></td>
<td>
<p>time series of (average) phase differences (non-smoothed version) at the selected period (or period band)</p>
</td></tr>
<tr><td><code>sAngle</code></td>
<td>
<p>time series of (average) smoothed phase differences at the selected periods</p>
</td></tr>
<tr><td><code>only.coi</code></td>
<td>
<p>Is the influence of edge effects excluded? I.e. is the cone of influence used only?</p>
</td></tr>  
<tr><td><code>only.sig</code></td>
<td>
<p>Was significance used in selection of phases?</p>
</td></tr> 
<tr><td><code>which.sig</code></td>
<td>
<p>Which spectrum was used to refer to significance?  
</p>

<table>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> "wp" </td><td style="text-align: left;"> : </td><td style="text-align: left;"> cross-wavelet power </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> "wc" </td><td style="text-align: left;"> : </td><td style="text-align: left;"> wavelet coherence </td>
</tr>
<tr>
 <td style="text-align: right;">
                                </td><td style="text-align: left;"> "wt" </td><td style="text-align: left;"> : </td><td style="text-align: left;"> individual wavelet power
                                </td>
</tr>

</table>

</td></tr>
<tr><td><code>siglvl</code></td>
<td>
<p>level of significance</p>
</td></tr>
<tr><td><code>date</code></td>
<td>
<p>time series of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.format</code></td>
<td>
<p>the format of calendar date as provided</p>
</td></tr>
<tr><td><code>date.tz</code></td>
<td>
<p>the time zone of calendar date as provided</p>
</td></tr>
<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: 1, 1+dt, 1+2dt, ...</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
Business cycle synchronization and the Euro: A wavelet analysis. 
Journal of Macroeconomics 33 (3), 477&ndash;489.
</p>
<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu P.C., 1994. 
Wavelet spectrum analysis and ocean wind waves. 
In: Foufoula-Georgiou E., and Kumar P., (eds.), Wavelets in Geophysics, Academic Press, San Diego, 151&ndash;166.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis.
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>
<p>Veleda D., Montagne R., and Araujo M., 2012. 
Cross-Wavelet Bias Corrected by Normalizing Scales. 
Journal of Atmospheric and Oceanic Technology 29, 1401&ndash;1408.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+analyze.coherency">analyze.coherency</a></code>, <code><a href="#topic+wc.image">wc.image</a></code>, <code><a href="#topic+wc.avg">wc.avg</a></code>, <code><a href="#topic+wc.phasediff.image">wc.phasediff.image</a></code>, 
<code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <br />
<code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is modified from Veleda et al., 2012:

series.length &lt;- 3*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 2*24, length = series.length)
x3a &lt;- periodic.series(start.period = 4*24, length = series.length)
x3b &lt;- periodic.series(start.period = 4*24, length = series.length,
                       phase = 24)
x4 &lt;- periodic.series(start.period = 8*24, length = series.length)
x5 &lt;- periodic.series(start.period = 16*24, length = series.length)
x6 &lt;- periodic.series(start.period = 32*24, length = series.length)
x7 &lt;- periodic.series(start.period = 64*24, length = series.length)
x8 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3a + x4 + 3*x5 + x6 + x7 + x8 + rnorm(series.length)
y &lt;- x1 + x2 + x3b + x4 - 3*x5 + x6 + 3*x7 + x8 + rnorm(series.length)

matplot(data.frame(x, y), type = "l", lty = 1, xaxs = "i", col = 1:2, 
 xlab = "index", ylab = "",
 main = "hourly series with periods of 1, 2, 4, 8, 16, 32, 64, 128 days", 
 sub = "(different phases at periods 4 and 16)")
legend("topright", legend = c("x","y"), col = 1:2, lty = 1)

my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x, y = y)

## Computation of cross-wavelet power and wavelet coherency of x over y:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24', 
## resulting in one time unit equaling one day.
## This is also the time unit in which periods are measured.
my.wc &lt;- analyze.coherency(my.data, c("x","y"), loess.span = 0, 
                          dt = 1/24, dj = 1/20,
                          window.size.t = 1, window.size.s = 1/2, 
                          lowerPeriod = 1/4, 
                          make.pval = TRUE, n.sim = 10)

## Plot of cross-wavelet power spectrum, 
## with color breakpoints according to quantiles:
wc.image(my.wc, main = "cross-wavelet power spectrum, x over y",
   legend.params = list(lab = "cross-wavelet power levels (quantiles)"),
   periodlab = "period (days)")

## Select period 64 and compare plots of corresponding phases, including 
## the phase differences (angles) in their non-smoothed (default) version:
wc.sel.phases(my.wc, sel.period = 64, show.Angle = TRUE)

## With time elapsed in days
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24
wc.sel.phases(my.wc, sel.period = 64, show.Angle = TRUE,  
   timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The same plot, but with (automatically produced) calendar axis:
wc.sel.phases(my.wc, sel.period = 64, show.Angle = TRUE,   
   show.date = TRUE, date.format = "%F %T")

## For further axis plotting options:
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.    

## Now, select period 16...
## and observe that corresponding components are out of phase:
wc.sel.phases(my.wc, sel.period = 16, show.Angle = TRUE,
   show.date = TRUE, date.format = "%F %T")
## ... compare to period 4...
wc.sel.phases(my.wc, sel.period = 4, show.Angle = TRUE,
   show.date = TRUE, date.format = "%F %T")   

## In the following, no periods are selected. 
## In this case, instead of individual phases, the plot shows 
## average phases for each series: 
wc.sel.phases(my.wc)


## End(Not run)
</code></pre>

<hr>
<h2 id='weather.radiation.Mannheim'>Series of weather data and ambient gamma dose rate readings</h2><span id='topic+weather.radiation.Mannheim'></span>

<h3>Description</h3>

<p>Ten years (from January 2005 through December 2014; 3652 values) of daily mean temperature, relative humidity, and ambient gamma dose rate (German abbreviation: ODL) readings from Mannheim-Rheinau (Germany).
</p>
<p>ODL data retrieved in 2015 from ODL-INFO <a href="http://odlinfo.bfs.de/download.php">http://odlinfo.bfs.de/download.php</a> of the German Federal Office for Radiation Protection (in German: Bundesamt fuer Strahlenschutz, BfS), weather data from the German Meteorological Office (in German: Deutscher Wetterdienst, DWD) <a href="ftp://ftp-cdc.dwd.de/pub/CDC/observations_germany/climate/daily/kl/historical/">ftp://ftp-cdc.dwd.de/pub/CDC/observations_germany/climate/daily/kl/historical/</a>.<br /> &mdash; We owe this example to our former student Nadiya Appelhans.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("weather.radiation.Mannheim")</code></pre>


<h3>Format</h3>

<p>A data frame of four columns:
</p>

<table>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> date          </td><td style="text-align: left;"> : </td><td style="text-align: left;"> day of measurement (in UTC, Coordinated Universal Time), </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;">               </td><td style="text-align: left;">   </td><td style="text-align: left;"> format: "%Y-%m-%d" </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> temperature   </td><td style="text-align: left;"> : </td><td style="text-align: left;"> mean daily temperature, in degrees Celsius </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> humidity      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> mean daily relative humidity, in percent </td>
</tr>
<tr>
 <td style="text-align: right;">
    </td><td style="text-align: left;"> radiation     </td><td style="text-align: left;"> : </td><td style="text-align: left;"> mean daily ambient gamma dose rate (ODL), in microsieverts per hour
    </td>
</tr>

</table>



<h3>Details</h3>

<p>The ambient gamma dose rate is an equivalent dose representing the stochastic health effects of low levels of ionizing radiation on the human body. According to BfS, radioactivity is to be found everywhere in the environment. It may be of natural or artificial origin. &mdash; We drew Mannheim randomly from a set of places for which weather and radiation data were available; there is no conspicuous radiation in Mannheim.</p>


<h3>Source</h3>

<p>The Federal Office for Radiation Protection (BfS) Germany, <a href="http://www.bfs.de/EN/home/home_node.html">http://www.bfs.de/EN/home/home_node.html</a>, and in particular <a href="http://www.bfs.de/EN/topics/ion/environment/environment_node.html">http://www.bfs.de/EN/topics/ion/environment/environment_node.html</a>
</p>
<p>ODL-INFO <a href="http://odlinfo.bfs.de/DE/service/downloadbereich.html">http://odlinfo.bfs.de/DE/service/downloadbereich.html</a>
</p>
<p>DWD (Deutscher Wetterdienst) <a href="https://www.dwd.de/EN/Home/home_node.html">https://www.dwd.de/EN/Home/home_node.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(weather.radiation.Mannheim)

plot(as.Date(weather.radiation.Mannheim$date, tz = "UTC"),
     weather.radiation.Mannheim$radiation, type = "l",
     xlab = "day", 
     ylab = "mean daily ambient gamma dose rate (ODL) in microsieverts per hour")
</code></pre>

<hr>
<h2 id='wt'>Wavelet transformation, and a simulation algorithm</h2><span id='topic+wt'></span>

<h3>Description</h3>

<p>This function provides Morlet wavelet transformation results of the given time series, 
performed within the lower-order function <code>WaveletTransform</code>,  
subject to criteria concerning the time and frequency resolution, and an (optional) lower and/or upper Fourier period.
It performs a simulation algorithm to test against a specified alternative hypothesis, which can be chosen from a variety of options,
and provides p-values. The selected model will be fitted to the data and simulated according to estimated parameters 
in order to provide surrogate time series.
This function is called by function <code>analyze.wavelet</code>.
</p>
<p>The name and parts of the layout were inspired by a similar function developed by Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
The major part of the code for the computation of the cone of influence, and the code for Fourier-randomized surrogate time series
has been adopted from Huidong Tian.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt(x, start = 1, dt = 1, dj = 1/20, 
   lowerPeriod = 2*dt, upperPeriod = floor(length(x)*dt/3), 
   make.pval = TRUE, method = "white.noise", params = NULL, 
   n.sim = 100, save.sim = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt_+3A_x">x</code></td>
<td>
<p>the time series to be analyzed</p>
</td></tr>

<tr><td><code id="wt_+3A_start">start</code></td>
<td>
<p>starting point in time (for the computation of the cone of influence).
</p>
<p>Default: <code>start = 1</code>.</p>
</td></tr>

<tr><td><code id="wt_+3A_dt">dt</code></td>
<td>
<p>time resolution, i.e. sampling resolution in the time domain, <code>1/dt</code> = number of observations per time unit. 
For example: a natural choice of <code>dt</code> in case of hourly data is <code>dt = 1/24</code>, 
resulting in one time unit equaling one day. This is also the time unit in which periods are measured.
If <code>dt = 1</code>, the time interval between two consecutive observations will equal one time unit.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>
<tr><td><code id="wt_+3A_dj">dj</code></td>
<td>
<p>frequency resolution, i.e. sampling resolution in the frequency domain, <code>1/dj</code> = number of 
suboctaves (voices per octave).
</p>
<p>Default: <code>1/20</code>.
</p>
</td></tr>

<tr><td><code id="wt_+3A_lowerperiod">lowerPeriod</code></td>
<td>
<p>lower Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition.<br /> 
If <code>dt = 1</code>, the minimum admissible value is 2. 
</p>
<p>Default: <code>2*dt</code>.</p>
</td></tr>
<tr><td><code id="wt_+3A_upperperiod">upperPeriod</code></td>
<td>
<p>upper Fourier period (measured in time units determined by <code>dt</code>, 
see the explanations concerning <code>dt</code>) for wavelet decomposition. 
</p>
<p>Default: <code>(floor of one third of time series length)*dt</code>.
</p>
</td></tr> 

<tr><td><code id="wt_+3A_make.pval">make.pval</code></td>
<td>
<p>Compute p-values? Logical. Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wt_+3A_method">method</code></td>
<td>
<p>the method of generating surrogate time series; select from:
</p>

<table>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"white.noise"</code>  </td><td style="text-align: left;"> : </td><td style="text-align: left;"> white noise </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"shuffle"</code>      </td><td style="text-align: left;"> : </td><td style="text-align: left;"> shuffling the given time series </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"Fourier.rand"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> time series with a similar spectrum </td>
</tr>
<tr>
 <td style="text-align: right;">
                    </td><td style="text-align: left;"> <code>"AR"</code>           </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR(p) </td>
</tr>
<tr>
 <td style="text-align: right;">  
                    </td><td style="text-align: left;"> <code>"ARIMA"</code>        </td><td style="text-align: left;"> : </td><td style="text-align: left;"> ARIMA(p,0,q) 
                    </td>
</tr>

</table>

<p>Default: <code>"white.noise"</code>.
</p>
</td></tr>
<tr><td><code id="wt_+3A_params">params</code></td>
<td>
<p>a list of assignments between methods (AR, and ARIMA) and lists of parameter values 
applying to surrogates. Default: <code>NULL</code>. 
</p>
<p>Default includes two lists named <code>AR</code> and <code>ARIMA</code>:
</p>
  
<ul>
<li> <p><code>AR = list(...)</code>, a list containing one single element:
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> AR order.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">          </td><td style="text-align: left;">   </td><td style="text-align: left;"> Default: <code>1</code>.
                </td>
</tr>

</table>

</li>
<li> <p><code>ARIMA = list(...)</code>, a list of six elements:            
</p>

<table>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>p</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  AR order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>q</code>            </td><td style="text-align: left;"> : </td><td style="text-align: left;">  MA order. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>include.mean</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Include a mean/intercept term? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>TRUE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>sd.fac</code>       </td><td style="text-align: left;"> : </td><td style="text-align: left;">  magnification factor to boost the </td>
</tr>
<tr>
 <td style="text-align: right;"> 
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  residual standard deviation. </td>
</tr>
<tr>
 <td style="text-align: right;">  
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>1</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim</code>         </td><td style="text-align: left;"> : </td><td style="text-align: left;">  Simulate trimmed data? </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>FALSE</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;"> <code>trim.prop</code>    </td><td style="text-align: left;"> : </td><td style="text-align: left;">  high/low trimming proportion. </td>
</tr>
<tr>
 <td style="text-align: right;">
        </td><td style="text-align: left;">                     </td><td style="text-align: left;">   </td><td style="text-align: left;">  Default: <code>0.01</code>.</td>
</tr>
<tr>
 <td style="text-align: right;">
                </td>
</tr>

</table>
</li></ul>
  
</td></tr>      

<tr><td><code id="wt_+3A_n.sim">n.sim</code></td>
<td>
<p>number of simulations. Default: <code>100</code>.</p>
</td></tr>

<tr><td><code id="wt_+3A_save.sim">save.sim</code></td>
<td>
<p>Should simulations be saved on the output list? Logical. Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following elements:

</p>
<table>
<tr><td><code>Wave</code></td>
<td>
<p>complex wavelet transform of the series</p>
</td></tr>
<tr><td><code>Phase</code></td>
<td>
<p>phases</p>
</td></tr>
<tr><td><code>Ampl</code></td>
<td>
<p>amplitudes</p>
</td></tr>

<tr><td><code>Power</code></td>
<td>
<p>wavelet power in the time/frequency domain</p>
</td></tr>
<tr><td><code>Power.avg</code></td>
<td>
<p>vector of average wavelet power in the frequency domain (averages over time)</p>
</td></tr> 
<tr><td><code>Power.pval</code></td>
<td>
<p>p-values of wavelet power</p>
</td></tr>
<tr><td><code>Power.avg.pval</code></td>
<td>
<p>vector of p-values of average wavelet power</p>
</td></tr>

<tr><td><code>Period</code></td>
<td>
<p>the Fourier periods 
(measured in time units determined by <code>dt</code>, see the explanations concerning <code>dt</code>)</p>
</td></tr>
<tr><td><code>Scale</code></td>
<td>
<p>the scales (the Fourier periods divided by the Fourier factor)</p>
</td></tr>

<tr><td><code>coi.1</code>, <code>coi.2</code></td>
<td>
<p>borders of the region where the wavelet transforms are not influenced by edge effects (cone of influence). 
The coordinates of the borders are expressed in terms of internal axes <code>axis.1</code> and <code>axis.2</code>.</p>
</td></tr> 

<tr><td><code>nc</code></td>
<td>
<p>number of columns = number of observations = number of observation epochs; &quot;epoch&quot; meaning point in time</p>
</td></tr>
<tr><td><code>nr</code></td>
<td>
<p>number of rows = number of scales (Fourier periods)</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
<tr><td><code>axis.2</code></td>
<td>
<p>tick levels corresponding to the log of Fourier periods: <code>log2(Period)</code>. This determines the period axis in plot functions provided by <code>WaveletComp</code>.</p>
</td></tr>

<tr><td><code>series.sim</code></td>
<td>
<p>a data frame of the series simulated as surrogates for the (detrended) time series 
(if both <code>make.pval = TRUE</code> and <code>save.sim = TRUE</code>.)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian, and Bernard Cazelles</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+WaveletTransform">WaveletTransform</a></code>, <code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code> </p>

<hr>
<h2 id='wt.avg'>
Plot of wavelet power averages across time of a single time series
</h2><span id='topic+wt.avg'></span>

<h3>Description</h3>

<p>This function plots wavelet power averages across time of a single time
series, which are provided by an object of class <code>"analyze.wavelet"</code>, 
or alternatively of class <code>"analyze.coherency"</code>. 
(In the latter case, the series number or name must be specified.) 
The vertical axis shows the Fourier periods. The horizontal axis shows the averages.
User-defined minimum and maximum average levels can be applied. 
Also, an option is given to individualize the period axis and/or axis of averages 
by specifying tick marks and labels.
</p>
<p>There is an option to label periods according to significance of
averages (if p-values are provided) at given levels of significance.
Labels are point symbols along the
line of averages which can be assigned individually.
</p>
<p>The idea to show significance levels by colors of plotting characters and its 
implementation has been adopted from Huidong Tian and Bernard Cazelles 
(archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.avg(WT, my.series = 1, exponent = 1,
  show.siglvl = TRUE, siglvl = c(0.05, 0.1), 
  sigcol = c("red", "blue"), sigpch = 20, sigcex = 1,
  minimum.level = NULL, maximum.level = NULL,
  label.avg.axis = TRUE, 
  averagelab = NULL, averagetck = 0.02, averagetcl = 0.5,
  spec.avg.axis = list(at = NULL, labels = TRUE, 
                       las = 1, hadj = NA, padj = NA),
  label.period.axis = TRUE, 
  periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
  spec.period.axis = list(at = NULL, labels = TRUE, 
                          las = 1, hadj = NA, padj = NA),
  show.legend = TRUE, legend.coords = "topright", 
  main = NULL, 
  lwd = 1, col = 1, 
  lwd.axis = 1,
  verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.avg_+3A_wt">WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></p>
</td></tr>
<tr><td><code id="wt.avg_+3A_my.series">my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of 
the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td></tr>

<tr><td><code id="wt.avg_+3A_exponent">exponent</code></td>
<td>
<p>Exponent applied to averages before plotting; 
the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_show.siglvl">show.siglvl</code></td>
<td>
<p>Label periods according to significance of averages? (Effective only if p-values are provided.) 
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_siglvl">siglvl</code></td>
<td>
<p>a vector of significance levels (of any length and order). Default: <code>c(0.05, 0.1)</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_sigcol">sigcol</code></td>
<td>
<p>a vector of colors (should be of same length as and correspond to <code>siglvl</code>, 
otherwise colors <code>1 : length(siglvl)</code>).
</p>
<p>Default: <code>c("red","blue")</code>.
</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_sigpch">sigpch</code></td>
<td>
<p>a vector of plotting &quot;characters&quot; (symbols) to use as labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different plotting labels, 
otherwise the default setting is used. A single input value affects all labels.) 
</p>
<p>Default: <code>20</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_sigcex">sigcex</code></td>
<td>
<p>a numerical vector working as size of labels of significance. 
(It should be of same length as and correspond to <code>siglvl</code> to produce different-sized labels, 
otherwise the default setting is used.  A single input value affects all labels. 
Note that <code>sigcex</code> is affected by <code>cex</code> in <code>par</code>.) 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_minimum.level">minimum.level</code></td>
<td>
<p>Minimum plot level of wavelet power averages considered. 
</p>
<p>Default: NULL (referring to minimum level observed).</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_maximum.level">maximum.level</code></td>
<td>
<p>Maximum plot level of wavelet power averages considered. 
</p>
<p>Default: NULL (referring to maximum level observed).</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_label.avg.axis">label.avg.axis</code></td>
<td>
<p>Label the axis of averages? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_averagelab">averagelab</code></td>
<td>
<p>Label for the axis of averages. 
</p>
<p>Default: <code>"average wavelet power"</code>.</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_averagetck">averagetck</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the smaller of the width or height of 
the plotting region; see <code>par</code>.  
If <code>averagetck &gt;= 0.5</code>, <code>averagetck</code> is interpreted as a fraction of the length of the axis of averages, 
so if <code>averagetck = 1</code> (and <code>averagetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>averagetck = NA</code> is to use <code>averagetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_averagetcl">averagetcl</code></td>
<td>
<p>length of tick marks on the axis of averages as a fraction of the height of a line of text; see <code>par</code>. 
With <code>averagetcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward.
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_spec.avg.axis">spec.avg.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized labeling of the axis of averages 
(only effective if <code>label.avg.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and non-negative values only. <br />
Default: <code>NULL</code>.
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal).
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wt.avg_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wt.avg_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.avg_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
  
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wt.avg_+3A_show.legend">show.legend</code></td>
<td>
<p>Include legend of significance levels into the plot? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_legend.coords">legend.coords</code></td>
<td>
<p>coordinates to position the legend (as in function <code>legend</code>). 
</p>
<p>Default: <code>"topright"</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_lwd">lwd</code></td>
<td>
<p>width of line of averages. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_col">col</code></td>
<td>
<p>color of line of averages. 
</p>
<p>Default: <code>"black"</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.avg_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian and Bernard Cazelles</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
        
my.data &lt;- data.frame(x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24',
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured. 
my.wt &lt;- analyze.wavelet(my.data, "x", loess.span = 0, 
                         dt = 1/24, dj = 1/20, 
                         lowerPeriod = 1/4,
                         make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum (with equidistant color breakpoints): 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant levels)"),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.
         
## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24

## Insert your specification of time axis: 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant levels)"),
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))
         
## Plot of average wavelet power:
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", periodlab = "period (days)")

## The same plot, but with enhanced symbol size, user-defined period axis, 
## and horizontal grid:
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", sigcex = 1.3, 
   periodlab = "period (days)",
   spec.period.axis = list(at = c(1,8,32,128)), 
   periodtck = 1, periodtcl = NULL, 
   lwd = 1.5, lwd.axis = 0.25)
       
## Another style of the plot: 
## With user-defined period axis and axis of averages, 
## minimum and maximum plot levels of averages:

op &lt;- par(no.readonly = TRUE)
par(cex.lab = 1.3, cex.axis = 1.1)
wt.avg(my.wt, siglvl = 0.05, sigcol = "red", sigcex = 1.3, 
   minimum.level = 0, maximum.level = 11,
   periodlab = "period (days)", 
   spec.period.axis = list(at = c(1,8,32,128)), 
   spec.avg.axis = list(at = 0:10),
   lwd = 1.5)
par(op)   
## Note:
## 'cex.axis' in 'par' controls for the size of axis tick labels, 
## while 'cex.lab' controls for the size of axis and legend labels. 
## Scaling by 'cex' would also affect 'sigcex'. 


## Please see also the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='wt.image'>
Image plot of the wavelet power spectrum of a single time series
</h2><span id='topic+wt.image'></span>

<h3>Description</h3>

<p>This function plots the wavelet power spectrum of a single time series, which is provided by an object of 
class <code>"analyze.wavelet"</code>, or alternatively of class <code>"analyze.coherency"</code>. 
(In the latter case, the series number or name must be specified.)
The vertical axis shows the Fourier periods. The horizontal axis shows time step counts, but can
be easily transformed into a calendar axis if dates are provided in either row names or as a variable 
named <code>"date"</code> in the data frame at hand. Both axes can be relabeled. 
In particular, an option is given to individualize the period and/or time axis 
by specifying tick marks and labels.
</p>
<p>An option is given to raise wavelet power values to any (positive) exponent before
plotting in order to accentuate the contrast of the image.
</p>
<p>The color levels can be defined according to quantiles of values or
according to equidistant breakpoints (covering the interval from 0
to maximum level), with the number of levels as a further
parameter. A user-defined maximum level can be applied. 
In addition, there is an option to adopt an individual color palette.
</p>
<p>Further plot design options concern: plot of the cone of
influence, plot of wavelet power contour lines at a specified
level of significance, plot of power ridges.
</p>
<p>Finally, there is an option to insert and format a color legend (a
right-hand vertical color bar) and to set the plot title.  For
further processing of the plot, graphical parameters of plot
regions are provided as output.
</p>
<p>The name and parts of the layout were inspired by a similar function developed by 
Huidong Tian and Bernard Cazelles (archived R package <code>WaveletCo</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.image(WT, my.series = 1, exponent = 1,
     plot.coi = TRUE, 
     plot.contour = TRUE, siglvl = 0.1, col.contour = "white",
     plot.ridge = TRUE, lvl = 0, col.ridge = "black", 
     color.key = "quantile", 
     n.levels = 100, 
     color.palette = "rainbow(n.levels, start = 0, end = .7)",
     maximum.level = NULL,
     useRaster = TRUE, max.contour.segments = 250000,
     plot.legend = TRUE,
     legend.params = list(width = 1.2, shrink = 0.9, mar = 5.1, 
                          n.ticks = 6, 
                          label.digits = 1, label.format = "f", 
                          lab = NULL, lab.line = 2.5),
     label.time.axis = TRUE, 
     show.date = FALSE, date.format = NULL, date.tz = NULL, 
     timelab = NULL, timetck = 0.02, timetcl = 0.5,
     spec.time.axis = list(at = NULL, labels = TRUE, 
                           las = 1, hadj = NA, padj = NA),
     label.period.axis = TRUE, 
     periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
     spec.period.axis = list(at = NULL, labels = TRUE, 
                             las = 1, hadj = NA, padj = NA),
     main = NULL,
     lwd = 2, lwd.axis = 1, 
     graphics.reset = TRUE,
     verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.image_+3A_wt">WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></p>
</td></tr>
<tr><td><code id="wt.image_+3A_my.series">my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td></tr>

<tr><td><code id="wt.image_+3A_exponent">exponent</code></td>
<td>
<p>Exponent applied to values before plotting in order to accentuate the contrast of the image; 
the exponent should be positive.
</p>
<p>Default: <code>1</code>.
</p>
</td></tr>

<tr><td><code id="wt.image_+3A_plot.coi">plot.coi</code></td>
<td>
<p>Plot cone of influence? Logical. Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_plot.contour">plot.contour</code></td>
<td>
<p>Plot contour lines to border the area of wavelet power significance? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wt.image_+3A_siglvl">siglvl</code></td>
<td>
<p>level of wavelet power significance to be applied to the plot of contour lines. 
</p>
<p>Default: <code>0.1</code>.
</p>
</td></tr>
<tr><td><code id="wt.image_+3A_col.contour">col.contour</code></td>
<td>
<p>color of contour lines. Default: <code>"white"</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_plot.ridge">plot.ridge</code></td>
<td>
<p>Plot the wavelet power ridge? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wt.image_+3A_lvl">lvl</code></td>
<td>
<p>minimum level of wavelet power for ridge to be plotted.
</p>
<p>Default: <code>0</code>.
</p>
</td></tr>
<tr><td><code id="wt.image_+3A_col.ridge">col.ridge</code></td>
<td>
<p>ridge color. Default: <code>"black"</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_color.key">color.key</code></td>
<td>
<p>How to assign colors to power and coherence levels? Two options:
</p>

<table>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">  <code>"interval"</code> or <code>"i"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> equidistant breakpoints </td>
</tr>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">                                  </td><td style="text-align: left;">   </td><td style="text-align: left;"> (from <code>0</code> through maximum value) </td>
</tr>
<tr>
 <td style="text-align: right;">
                            </td><td style="text-align: left;">  <code>"quantile"</code> or <code>"q"</code> </td><td style="text-align: left;"> : </td><td style="text-align: left;"> quantiles 
                           </td>
</tr>

</table>
 
<p>Default: <code>"quantile"</code>.
</p>
</td></tr>
<tr><td><code id="wt.image_+3A_n.levels">n.levels</code></td>
<td>
<p>Number of color levels. Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_color.palette">color.palette</code></td>
<td>
<p>Definition of color levels. (The color palette will be assigned to levels in reverse order!)
</p>
<p>Default: <code>"rainbow(n.levels, start = 0, end = .7)"</code>.
</p>
</td></tr>

<tr><td><code id="wt.image_+3A_maximum.level">maximum.level</code></td>
<td>
<p>Maximum plot level of wavelet power considered; only effective in case of equidistant breakpoints (<code>color.key</code> equaling <code>"i"</code>).
</p>
<p>Default: <code>NULL</code> (referring to maximum level observed).</p>
</td></tr>

<tr><td><code id="wt.image_+3A_useraster">useRaster</code></td>
<td>
<p>Use a bitmap raster instead of polygons to plot the image? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_max.contour.segments">max.contour.segments</code></td>
<td>
<p>limit on the number of segments in a single contour line, positive integer. 
</p>
<p>Default: <code>250000</code> (<code>options(...)</code> default settings: <code>25000</code>).</p>
</td></tr>

<tr><td><code id="wt.image_+3A_plot.legend">plot.legend</code></td>
<td>
<p>Plot color legend (a vertical bar of colors and breakpoints)? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_legend.params">legend.params</code></td>
<td>
<p>a list of parameters for the plot of the color legend; parameter values can be set selectively 
(style in parts adopted from <code>image.plot</code> in the R package <code>fields</code> by Douglas Nychka):
</p>

<ul>
<li><p>[<code>width</code>:] width of legend bar. <br /> 
Default: <code>1.2</code>. 
</p>
</li>
<li><p>[<code>shrink</code>:] a vertical shrinkage factor. <br />
Default: <code>0.9</code>. 
</p>
</li>
<li><p>[<code>mar</code>:] right margin of legend bar. <br />
Default: <code>5.1</code>. 
</p>
</li>
<li><p>[<code>n.ticks</code>:] number of ticks for labels. <br /> 
Default: <code>6</code>. 
</p>
</li>
<li><p>[<code>label.digits</code>:] digits of labels. <br />
Default: <code>1</code>. 
</p>
</li>
<li><p>[<code>label.format</code>:] format of labels. <br />
Default: <code>"f"</code>. 
</p>
</li>
<li><p>[<code>lab</code>:] axis label. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>lab.line</code>:] line (in user coordinate units) where to put the axis label. <br />
Default: <code>2.5</code>.
</p>
</li></ul>
         
</td></tr>

<tr><td><code id="wt.image_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WT</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WT</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label.  
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wt.image_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wt.image_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.image_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
   
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>  

<tr><td><code id="wt.image_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_lwd">lwd</code></td>
<td>
<p>line width of contour lines and ridge.
</p>
<p>Default: <code>2</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes (image and legend bar). 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_graphics.reset">graphics.reset</code></td>
<td>
<p>Reset graphical parameters? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.image_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>graphical parameters</code> with the following elements:
</p>
<table>
<tr><td><code>op</code></td>
<td>
<p>original graphical parameters</p>
</td></tr>
<tr><td><code>image.plt</code></td>
<td>
<p>image plot region</p>
</td></tr>
<tr><td><code>legend.plt</code></td>
<td>
<p>legend plot region</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer; credits are also due to Huidong Tian and Bernard Cazelles</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Tian, H., and Cazelles, B., 2012. <code>WaveletCo</code>. 
Available at <a href="https://cran.r-project.org/src/contrib/Archive/WaveletCo/">https://cran.r-project.org/src/contrib/Archive/WaveletCo/</a>, archived April 2013; accessed July 26, 2013.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
     
## The following dates refer to the local time zone 
## (possibly allowing for daylight saving time):      
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24', 
## resulting in one time unit equaling one day. 
## This is also the time unit in which periods are measured.
my.wt &lt;- analyze.wavelet(my.data, "x", 
                        loess.span = 0, 
                        dt = 1/24, dj = 1/20, 
                        lowerPeriod = 1/4, 
                        make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum 
## with color breakpoints referring to quantiles:  
wt.image(my.wt, main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (quantiles)", 
                        lab.line = 3.5, 
                        label.digits = 2),
   periodlab = "period (days)")
## Note:
## The default time axis shows an index of given points in time, 
## which is the count of hours in our example.

## The same plot, but with equidistant color breakpoints: 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"),
   periodlab = "period (days)")
         
## Alternative styles of the time axis:          
         
## The plot with time elapsed in days, starting from 0 and proceeding 
## in steps of 50 days (50*24 hours),
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24
## Insert your specification of the time axis: 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"),
   periodlab = "period (days)", timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The plot with (automatically produced) calendar axis:
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"), 
   periodlab = "period (days)",
   show.date = TRUE, date.format = "%F %T")

## Individualizing your calendar axis (works with 'show.date = TRUE')...
## How to obtain, for example, monthly date ticks and labels:

## The sequence of tick positions:
monthly.ticks &lt;- seq(as.POSIXct("2014-11-01 00:00:00", format = "%F %T"), 
                     as.POSIXct("2016-11-01 00:00:00", format = "%F %T"), 
                     by = "month")
## Observe that the following specification may produce an error:
## 'seq(as.Date("2014-11-01"), as.Date("2016-11-01"), by = "month")'
## Time of the day is missing here!

## The sequence of labels (e.g. information on month and year only):
monthly.labels &lt;- strftime(monthly.ticks, format = "%b %Y")

## Insert your specification of the time axis: 
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"), 
   periodlab = "period (days)", 
   show.date = TRUE, date.format = "%F %T", 
   spec.time.axis = list(at = monthly.ticks, labels = monthly.labels, 
                         las = 2))
## Note: 
## The monthly ticks specify the midpoints of the colored cells and match 
## the location of corresponding (default) time index ticks.
         
## Furthermore, the plot with an individualized period axis:
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"), 
   periodlab = "period (days)", 
   show.date = TRUE, date.format = "%F %T",
   spec.time.axis = list(at = monthly.ticks, labels = monthly.labels, 
                         las = 2),
   spec.period.axis = list(at = c(1,8,32,128))) 
         
## Switching the time axis from index to time elapsed in hours 
## (starting from 0, and proceeding in steps of 500 hours), 
## and the period axis from days to hours:
index.ticks  &lt;- seq(1, series.length, by = 500)
index.labels &lt;- index.ticks - 1
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"), 
   timelab = "time elapsed (hours)", periodlab = "period (hours)",
   spec.time.axis = list(at = index.ticks, labels = index.labels),
   spec.period.axis = list(at = c(1,8,32,128), labels = c(1,8,32,128)*24))            

## A plot with different colors:
wt.image(my.wt, main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (quantiles)", 
                        lab.line = 3.5, label.digits = 2), 
   color.palette = "gray((1:n.levels)/n.levels)", col.ridge = "yellow",
   periodlab = "period (days)")

## In the case of monthly (or quarterly) data, the time axis should be 
## labeled at equally spaced time points. An example:

monthyear &lt;- seq(as.Date("2014-01-01"), as.Date("2018-01-01"),
                 by = "month")
monthyear &lt;- strftime(monthyear, format = "%b %Y")

xx &lt;- periodic.series(start.period = 6, length = length(monthyear))
xx &lt;- xx + 0.2*rnorm(length(monthyear))

plot(xx, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "monthly series with period of 6 months")

monthly.data &lt;- data.frame(date = monthyear, xx = xx)
 
my.wt &lt;- analyze.wavelet(monthly.data, "xx", loess.span = 0, 
                         dt = 1, dj = 1/250, 
                         make.pval = TRUE, n.sim = 250)
## Note: 
## The natural choice of 'dt' in this example is 'dt = 1', 
## resulting in periods measured in months. 
## (Setting 'dt = 1/12' would result in periods measured in years.)

## The default wavelet power plot then shows the monthly:
wt.image(my.wt, main = "wavelet power spectrum", 
   periodlab = "period (months)")

## The following plot shows the elapsed time, measured in months: 
wt.image(my.wt, main = "wavelet power spectrum", 
   periodlab = "period (months)", timelab = "time elapsed (months)",
   spec.time.axis = list(at = 1:length(monthyear), 
                         labels = (1:length(monthyear))-1))
                                     
## In case you prefer the monthyear labels themselves: 
wt.image(my.wt,  main = "wavelet power spectrum", 
   periodlab = "period (months)", timelab = "month and year",
   spec.time.axis = list(at = 1:length(monthyear), labels = monthyear)) 

## You may sometimes wish to enhance your plot with additional information. 
## There is an option to add further objects to the image plot region, 
## by setting 'graphics.reset = FALSE' 
## (but recall previous par settings after plotting):

op &lt;- par(no.readonly = TRUE)
wt.image(my.wt, main = "wavelet power spectrum", 
   periodlab = "period (months)", 
   spec.period.axis = list(at = c(2,4,6,8,12)), 
   spec.time.axis = list(at = 1:length(monthyear),
                         labels = substr(monthyear,1,3)),
   graphics.reset = FALSE)
abline(h = log2(6), lty = 3)         
abline(v = seq(1, length(monthyear), by = 12), lty = 3)
mtext(2014:2018, side = 1, 
      at = seq(1, length(monthyear), by = 12), line = 2)
par(op)

## For further axis plotting options:
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.


## End(Not run)
</code></pre>

<hr>
<h2 id='wt.phase.image'>
Image plot of the phases of periodic components for a single time
series
</h2><span id='topic+wt.phase.image'></span>

<h3>Description</h3>

<p>This function plots the wavelet phase image for a time series, which is provided by an object of
class <code>"analyze.wavelet"</code>, or alternatively of class <code>"analyze.coherency"</code>. 
(In the latter case, the series number or name must be specified.)  
The vertical axis shows the Fourier periods. The horizontal axis shows time step counts, but can
be easily transformed into a calendar axis if dates are provided in either row names or as a variable 
named <code>"date"</code> in the data frame at hand. Both axes can be relabeled.
In particular, an option is given to individualize the period and/or time axis 
by specifying tick marks and labels.
</p>
<p>The color levels are defined according to equidistant breakpoints
(covering the interval from <code>-pi</code> to <code>+pi</code>), with the number of levels
as a further parameter. In addition, there is an option to adopt
an individual color palette.
</p>
<p>If the default palette is retained, colors indicate the following. Green: Phases
close to zero. Red: phases close to <code>+pi</code>. Blue: phases close to <code>-pi</code>.
</p>
<p>Further plot design options concern: plot of the cone of
influence, plot of contour lines to border areas of significance
with respect to cross-wavelet power or wavelet coherency at a
given significance level, plot of power ridges.
</p>
<p>Finally, there is an option to insert and format a color legend (a
right-hand vertical color bar) and to set the plot title.  For
further processing of the plot, graphical parameters of plot
regions are provided as output.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.phase.image(WT, my.series = 1,
       plot.coi = TRUE, 
       plot.contour = TRUE, 
       siglvl = 0.1, col.contour = "white",
       plot.ridge = TRUE, col.ridge = "black", 
       n.levels = 100, 
       color.palette = "rainbow(n.levels, start = 0, end = .7)", 
       useRaster = TRUE, max.contour.segments = 250000,
       plot.legend = TRUE,
       legend.params = list(width = 1.2, shrink = 0.9, mar = 5.1, 
                            n.ticks = 6, 
                            pi.style = TRUE,
                            label.digits = 1, label.format = "f", 
                            lab = NULL, lab.line = 3),
       label.time.axis = TRUE, 
       show.date = FALSE, date.format = NULL, date.tz = NULL, 
       timelab = NULL, timetck = 0.02, timetcl = 0.5,
       spec.time.axis = list(at = NULL, labels = TRUE, 
                             las = 1, hadj = NA, padj = NA),
       label.period.axis = TRUE, 
       periodlab = NULL, periodtck = 0.02, periodtcl = 0.5,
       spec.period.axis = list(at = NULL, labels = TRUE, 
                               las = 1, hadj = NA, padj = NA),
       main = NULL,
       lwd = 2, lwd.axis = 1, 
       graphics.reset = TRUE,
       verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.phase.image_+3A_wt">WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code></p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_my.series">my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_plot.coi">plot.coi</code></td>
<td>
<p>Plot cone of influence? Logical. Default: <code>TRUE</code></p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_plot.contour">plot.contour</code></td>
<td>
<p>Plot contour lines to border the area of wavelet power significance? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_siglvl">siglvl</code></td>
<td>
<p>level of wavelet power significance to be applied to the plot of contour lines. 
</p>
<p>Default: <code>0.1</code>.
</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_col.contour">col.contour</code></td>
<td>
<p>color of contour lines. Default: <code>"white"</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_plot.ridge">plot.ridge</code></td>
<td>
<p>Plot the wavelet power ridge? Logical.
</p>
<p>Default: <code>TRUE</code>.
</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_col.ridge">col.ridge</code></td>
<td>
<p>ridge color. Default: <code>"black"</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_n.levels">n.levels</code></td>
<td>
<p>Number of color levels. Default: <code>100</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_color.palette">color.palette</code></td>
<td>
<p>Definition of color levels. (The color palette will be assigned to levels in reverse order!)
</p>
<p>Default: <code>"rainbow(n.levels, start = 0, end = .7)"</code>.
</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_useraster">useRaster</code></td>
<td>
<p>Use a bitmap raster instead of polygons to plot the image? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_max.contour.segments">max.contour.segments</code></td>
<td>
<p>limit on the number of segments in a single contour line, positive integer. 
</p>
<p>Default: <code>250000</code> (<code>options(...)</code> default settings: <code>25000</code>).</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_plot.legend">plot.legend</code></td>
<td>
<p>Plot color legend (a vertical bar of colors and breakpoints)? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_legend.params">legend.params</code></td>
<td>
<p>a list of parameters for the plot of the color legend; parameter values can be set selectively 
(style in parts adopted from <code>image.plot</code> in the R package <code>fields</code> by Douglas Nychka):
</p>

<ul>
<li><p>[<code>width</code>:] width of legend bar. <br /> 
Default: <code>1.2</code>. 
</p>
</li>
<li><p>[<code>shrink</code>:] a vertical shrinkage factor. <br />
Default: <code>0.9</code>. 
</p>
</li>
<li><p>[<code>mar</code>:] right margin of legend bar. <br />
Default: <code>5.1</code>. 
</p>
</li>
<li><p>[<code>n.ticks</code>:] number of ticks for labels. <br /> 
Default: <code>6</code>. 
</p>
</li>
<li><p>[<code>pi.style</code>:] style of labels, logical: if <code>TRUE</code>, the symbol <code>"pi"</code> is used to label the legend bar; otherwise, labels are numerals. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>label.digits</code>:] number of digits of (numerical factors of) labels. <br />
Default: <code>1</code> if <code>pi.style</code> is <code>TRUE</code>, else <code>2</code>.
</p>
</li>
<li><p>[<code>label.format</code>:] format of labels. <br />
Default: <code>"f"</code>. 
</p>
</li>
<li><p>[<code>lab</code>:] axis label. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>lab.line</code>:] line (in user coordinate units) where to put the axis label. <br />
Default: <code>3</code>.
</p>
</li></ul>
       
</td></tr>

<tr><td><code id="wt.phase.image_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WT</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WT</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label.  
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wt.phase.image_+3A_label.period.axis">label.period.axis</code></td>
<td>
<p>Label the (Fourier) period axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_periodlab">periodlab</code></td>
<td>
<p>(Fourier) period axis label. 
</p>
<p>Default: <code>"period"</code>.</p>
</td></tr> 

<tr><td><code id="wt.phase.image_+3A_periodtck">periodtck</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the smaller of the width or height 
of the plotting region; see <code>par</code>. If <code>periodtck &gt;= 0.5</code>, <code>periodtck</code> is interpreted as a fraction
of the length of the period axis, so if <code>periodtck = 1</code> (and <code>periodtcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>periodtck = NA</code> is to use <code>periodtcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_periodtcl">periodtcl</code></td>
<td>
<p>length of tick marks on the period axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>periodtcl = -0.5</code> (which is the R default setting of <code>tcl</code>) ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.phase.image_+3A_spec.period.axis">spec.period.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized period axis labeling 
(only effective if <code>label.period.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical and positive values only. <br />
Default: <code>NULL</code>.        
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>
      
<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>  

<tr><td><code id="wt.phase.image_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_lwd">lwd</code></td>
<td>
<p>line width of contour lines and ridge. 
</p>
<p>Default: <code>2</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes (image and legend bar). 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_graphics.reset">graphics.reset</code></td>
<td>
<p>Reset graphical parameters? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.phase.image_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>graphical parameters</code> with the following elements:
</p>
<table>
<tr><td><code>op</code></td>
<td>
<p>original graphical parameters</p>
</td></tr>
<tr><td><code>image.plt</code></td>
<td>
<p>image plot region</p>
</td></tr>
<tr><td><code>legend.plt</code></td>
<td>
<p>legend plot region</p>
</td></tr> 
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.sel.phases">wt.sel.phases</a></code>, <code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'> 
## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")

my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x)  

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24', 
## resulting in one time unit equaling one day.
## This is also the time unit in which periods are measured.
my.wt &lt;- analyze.wavelet(my.data, "x", 
                        loess.span = 0, 
                        dt = 1/24, dj = 1/20, 
                        lowerPeriod = 1/4, 
                        make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum with equidistant color breakpoints:  
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"),
   periodlab = "period (days)")

## Default image of phases:
wt.phase.image(my.wt, 
   main = "image of phases", 
   periodlab = "period (days)")

## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24
wt.phase.image(my.wt, 
   main = "image of phases", 
   periodlab = "period (days)",
   timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The same plot, but with (automatically produced) calendar axis:
wt.phase.image(my.wt, 
   main = "image of phases", periodlab = "period (days)", 
   show.date = TRUE, date.format = "%F %T")

## For further axis plotting options:
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.    

## Image plot of phases with numerals as labels of the color legend bar: 
wt.phase.image(my.wt, 
   legend.params=list(pi.style = FALSE, label.digits = 2))
   

## End(Not run)
</code></pre>

<hr>
<h2 id='wt.sel.phases'>
Plot phases for selected periodic components of a single time series
</h2><span id='topic+wt.sel.phases'></span>

<h3>Description</h3>

<p>This function plots the phases for selected periodic components of a time series, 
which are provided by an object of class <code>"analyze.wavelet"</code>, or alternatively of class
<code>"analyze.coherency"</code>. (In the latter case, the series number or name must be specified.)
</p>
<p>Periodic components can be selected by specification of a single
Fourier period or of a period band. In the latter case, and in the
default case (no specification at all), there is an option to
average the phases across periods. Other options: restriction to the 
cone of influence, restriction to an area of significance (with respect 
to wavelet power).
</p>
<p>(The time axis can be altered to give dates, see e.g. <code>wt.image</code>.
In particular, an option is given to individualize the phase and/or time axis
by specifying tick marks and labels.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wt.sel.phases(WT, my.series = 1,
      sel.period = NULL, sel.lower = NULL, sel.upper = NULL, 
      only.coi = FALSE,
      only.sig = TRUE, siglvl = 0.05, 
      show.avg.phase = FALSE, phase.avg.col = "black", 
      label.time.axis = TRUE, 
      show.date = FALSE, date.format = NULL, date.tz = NULL, 
      timelab = NULL, timetck = 0.02, timetcl = 0.5,
      spec.time.axis = list(at = NULL, labels = TRUE, 
                            las = 1, hadj = NA, padj = NA),
      label.phase.axis = TRUE, 
      phaselab = NULL, phasetck = 0.02, phasetcl = 0.5,
      spec.phase.axis = list(at = NULL, labels = TRUE, 
                             las = 1, hadj = NA, padj = NA),
      main = NULL, sub = NULL, 
      lwd = 1, lwd.axis = 1,
      verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="wt.sel.phases_+3A_wt">WT</code></td>
<td>
<p>an object of class <code>"analyze.wavelet"</code> or <code>"analyze.coherency"</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_my.series">my.series</code></td>
<td>
<p>In case <code>class(WT) = "analyze.coherency"</code>: number (<code>1</code> or <code>2</code>) or name of the series to be analyzed. 
</p>
<p>Default: <code>1</code>. </p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_sel.period">sel.period</code></td>
<td>
<p>a single number which determines the (closest available) Fourier period to be selected. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_sel.lower">sel.lower</code></td>
<td>
<p>a number to define a lower Fourier period (or the closest available) for the selection 
of a band of periods (effective if <code>sel.period</code> is <code>NULL</code>). 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_sel.upper">sel.upper</code></td>
<td>
<p>a number to define an upper Fourier period (or the closest available) for the selection 
of a band of periods (effective if <code>sel.period</code> is <code>NULL</code>). 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr> 

<tr><td><code id="wt.sel.phases_+3A_only.coi">only.coi</code></td>
<td>
<p>Exclude borders influenced by edge effects, i.e. include the cone of influence only? Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_only.sig">only.sig</code></td>
<td>
<p>Use wavelet power significance to decide about the inclusion of (parts of) the phases' series? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_siglvl">siglvl</code></td>
<td>
<p>level of wavelet power significance. Default: <code>0.05</code>.</p>
</td></tr> 

<tr><td><code id="wt.sel.phases_+3A_show.avg.phase">show.avg.phase</code></td>
<td>
<p>Show average phases over selected periods? (Effective only if a band of periods is selected.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_phase.avg.col">phase.avg.col</code></td>
<td>
<p>color of line of phase averages. Default: &quot;black&quot;.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_label.time.axis">label.time.axis</code></td>
<td>
<p>Label the time axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_show.date">show.date</code></td>
<td>
<p>Show calendar dates? (Effective only if dates are available as row names or by variable 
<code>date</code> in the data frame which is analyzed.) Logical. 
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_date.format">date.format</code></td>
<td>
<p>the format of calendar date given as a character string, e.g. <code>"%Y-%m-%d"</code>, or equivalently <code>"%F"</code>; 
see <code>strptime</code> for a list of implemented date conversion specifications. Explicit information given here will overturn any specification 
stored in <code>WT</code>. If unspecified, date formatting is attempted according to <code>as.Date</code>. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_date.tz">date.tz</code></td>
<td>
<p>a character string specifying the time zone of calendar date; see <code>strptime</code>. Explicit information given here will overturn 
any specification stored in <code>WT</code>. If unspecified, <code>""</code> (the local time zone) is used. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_timelab">timelab</code></td>
<td>
<p>Time axis label.  
</p>
<p>Default: <code>"index"</code>; in case of a calendar axis: <code>"calendar date"</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_timetck">timetck</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>timetck &gt;= 0.5</code>, <code>timetck</code> is interpreted as a fraction of the length of the time axis, so if <code>timetck = 1</code> 
(and <code>timetcl = NULL</code>), vertical grid lines will be drawn. <br />
Setting <code>timetck = NA</code> is to use <code>timetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_timetcl">timetcl</code></td>
<td>
<p>length of tick marks on the time axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>timetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_spec.time.axis">spec.time.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized time axis labeling 
(only effective if <code>label.time.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied).
Valid tick marks can be provided as numerical values or as dates. Dates are used only in the case <code>show.date = TRUE</code>, however, 
and date formats should conform to <code>as.Date</code> or the format given in <code>date.format</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used). 
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr> 

<tr><td><code id="wt.sel.phases_+3A_label.phase.axis">label.phase.axis</code></td>
<td>
<p>Label the phase axis? Logical. 
</p>
<p>Default: <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_phaselab">phaselab</code></td>
<td>
<p>Phase axis label. 
</p>
<p>Default: <code>"phase"</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_phasetck">phasetck</code></td>
<td>
<p>length of tick marks on the phase axis as a fraction of the smaller of the width or height of the plotting region; see <code>par</code>.  
If <code>phasetck &gt;= 0.5</code>, <code>phasetck</code> is interpreted as a fraction of the length of the phase axis, so if <code>phasetck = 1</code> 
(and <code>phasetcl = NULL</code>), horizontal grid lines will be drawn. <br />
Setting <code>phasetck = NA</code> is to use <code>phasetcl = -0.5</code> (which is the R default setting of <code>tck</code> and <code>tcl</code>).
</p>
<p>Default here: <code>0.02</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_phasetcl">phasetcl</code></td>
<td>
<p>length of tick marks on the phase axis as a fraction of the height of a line of text; see <code>par</code>. 
With <code>phasetcl = -0.5</code> (which is the R default setting of <code>tcl</code>), ticks will be drawn outward. 
</p>
<p>Default here: <code>0.5</code>.</p>
</td></tr>

<tr><td><code id="wt.sel.phases_+3A_spec.phase.axis">spec.phase.axis</code></td>
<td>
<p>a list of tick mark and label specifications for individualized phase axis labeling 
(only effective if <code>label.phase.axis = TRUE</code>):
</p>

<ul>
<li><p>[<code>at</code>:] locations of tick marks (when <code>NULL</code>, default plotting will be applied). Valid tick marks can be provided as 
numerical values between <code>-pi</code> and <code>pi</code>. <br />
Default: <code>NULL</code>. 
</p>
</li>
<li><p>[<code>labels</code>:] either a logical value specifying whether annotations at the tick marks are the tick marks themselves, 
or any vector of labels. If <code>labels</code> is non-logical, <code>at</code> should be of same length. <br />
Default: <code>TRUE</code>. 
</p>
</li>
<li><p>[<code>las</code>:] the style of axis labels, see <code>par</code>. <br />
Default: <code>1</code> (always horizontal). 
</p>
</li>
<li><p>[<code>hadj</code>:] adjustment of labels horizontal to the reading direction, see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).
</p>
</li>
<li><p>[<code>padj</code>:] adjustment of labels perpendicular to the reading direction (this can be a vector of adjustments for each label), 
see <code>axis</code>. <br />
Default: <code>NA</code> (centering is used).                           
</p>
</li></ul>

<p>Mismatches will result in a reset to default plotting.                               
</p>
</td></tr>   

<tr><td><code id="wt.sel.phases_+3A_main">main</code></td>
<td>
<p>an overall title for the plot. 
</p>
<p>Default: <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_sub">sub</code></td>
<td>
<p>a subtitle for the plot. 
</p>
<p>Default: <code>NULL</code>. In this case, the selected period range will be given in the subtitle.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_lwd">lwd</code></td>
<td>
<p>line width of phases. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_lwd.axis">lwd.axis</code></td>
<td>
<p>line width of axes. 
</p>
<p>Default: <code>1</code>.</p>
</td></tr>
<tr><td><code id="wt.sel.phases_+3A_verbose">verbose</code></td>
<td>
<p>Print verbose output on the screen? Logical.
</p>
<p>Default: <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>"sel.phases"</code> with the following elements:

</p>
<table>
<tr><td><code>Period</code></td>
<td>
<p>the selected period (or period band)</p>
</td></tr>
<tr><td><code>Phase</code></td>
<td>
<p>time series of (average) phases at the selected period (or period band)</p>
</td></tr> 
<tr><td><code>only.coi</code></td>
<td>
<p>Is the influence of edge effects excluded? I.e. is the cone of influence used only?</p>
</td></tr>  
<tr><td><code>only.sig</code></td>
<td>
<p>Was wavelet power significance used in selection of phases?</p>
</td></tr> 
<tr><td><code>siglvl</code></td>
<td>
<p>level of wavelet power significance</p>
</td></tr>

<tr><td><code>date</code></td>
<td>
<p>time series of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.format</code></td>
<td>
<p>the format of calendar date (if available)</p>
</td></tr>
<tr><td><code>date.tz</code></td>
<td>
<p>the time zone of calendar date (if available)</p>
</td></tr>

<tr><td><code>axis.1</code></td>
<td>
<p>tick levels corresponding to the time steps used for (cross-)wavelet transformation: <code>1, 1+dt, 1+2dt, ...</code>.
The default time axis in plot functions provided by <code>WaveletComp</code> is determined by observation epochs, however; &quot;epoch&quot; meaning point in time. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Angi Roesch and Harald Schmidbauer</p>


<h3>References</h3>

<p>Aguiar-Conraria L., and Soares M.J., 2011. 
The Continuous Wavelet Transform: A Primer. 
NIPE Working Paper Series 16/2011.
</p>
<p>Carmona R., Hwang W.-L., and Torresani B., 1998. 
Practical Time Frequency Analysis. Gabor and Wavelet Transforms with an Implementation in S.
Academic Press, San Diego.
</p>
<p>Cazelles B., Chavez M., Berteaux, D., Menard F., Vik J.O., Jenouvrier S., and Stenseth N.C., 2008.
Wavelet analysis of ecological time series.
Oecologia 156, 287&ndash;304.
</p>
<p>Liu Y., Liang X.S., and Weisberg R.H., 2007.
Rectification of the Bias in the Wavelet Power Spectrum. 
Journal of Atmospheric and Oceanic Technology 24, 2093&ndash;2102.
</p>
<p>Torrence C., and Compo G.P., 1998. 
A practical guide to wavelet analysis. 
Bulletin of the American Meteorological Society 79 (1), 61&ndash;78.
</p>


<h3>See Also</h3>

 
<p><code><a href="#topic+analyze.wavelet">analyze.wavelet</a></code>, <code><a href="#topic+wt.image">wt.image</a></code>, <code><a href="#topic+wt.avg">wt.avg</a></code>, <code><a href="#topic+wt.phase.image">wt.phase.image</a></code>, 
<code><a href="#topic+reconstruct">reconstruct</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following example is adopted from Liu et al., 2007:

series.length &lt;- 6*128*24
x1 &lt;- periodic.series(start.period = 1*24, length = series.length)
x2 &lt;- periodic.series(start.period = 8*24, length = series.length)
x3 &lt;- periodic.series(start.period = 32*24, length = series.length)
x4 &lt;- periodic.series(start.period = 128*24, length = series.length)

x &lt;- x1 + x2 + x3 + x4

plot(x, type = "l", xlab = "index", ylab = "", xaxs = "i",
     main = "hourly series with periods of 1, 8, 32, 128 days")
     
my.date &lt;- seq(as.POSIXct("2014-10-14 00:00:00", format = "%F %T"), 
               by = "hour", 
               length.out = series.length)     
my.data &lt;- data.frame(date = my.date, x = x)

## Computation of wavelet power:
## a natural choice of 'dt' in the case of hourly data is 'dt = 1/24', 
## resulting in one time unit equaling one day.
## This is also the time unit in which periods are measured.
my.wt &lt;- analyze.wavelet(my.data, "x", 
                         loess.span = 0, 
                         dt = 1/24, dj = 1/20, 
                         lowerPeriod = 1/4, 
                         make.pval = TRUE, n.sim = 10)

## Plot of wavelet power spectrum with equidistant color breakpoints:  
wt.image(my.wt, color.key = "i", main = "wavelet power spectrum",
   legend.params = list(lab = "wavelet power levels (equidistant)"),
   periodlab = "period (days)")                       

## Select period 8 and plot corresponding phases across time:
wt.sel.phases(my.wt, sel.period = 8)

## With time elapsed in days 
## (starting from 0 and proceeding in steps of 50 days) 
## instead of the (default) time index:
index.ticks  &lt;- seq(1, series.length, by = 50*24)
index.labels &lt;- (index.ticks-1)/24
wt.sel.phases(my.wt, sel.period = 8,  
   timelab = "time elapsed (days)",
   spec.time.axis = list(at = index.ticks, labels = index.labels))

## The same plot, but with (automatically produced) calendar axis:
wt.sel.phases(my.wt, sel.period = 8,  
   show.date = TRUE, date.format = "%F %T")

## For further axis plotting options:
## Please see the examples in our guide booklet,
## URL http://www.hs-stat.com/projects/WaveletComp/WaveletComp_guided_tour.pdf.        

## In the following, no period is selected.
## By setting 'show.avg.phase = TRUE', the plot shows average phases 
## instead of individual phases: 
wt.sel.phases(my.wt, show.avg.phase = TRUE)


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
