<!DOCTYPE html><html><head><title>Help for package bgev</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {bgev}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bgev-package'>
<p>Bimodal GEV Distribution with Location Parameter</p></a></li>
<li><a href='#bgev.mle'>
<p>Parameter estimation of bimodal GEV distribution based on real data</p>
that appears to be bimodal.</a></li>
<li><a href='#bgev.support'>
<p>Support of the bimodal GEV distribution</p></a></li>
<li><a href='#distCheck'>
<p>Check implementation of a distribution in <span class="rlang"><b>R</b></span>.</p></a></li>
<li><a href='#likbgev'>
<p>Log likelihood function for the bimodal GEV distribution.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bimodal GEV Distribution with Location Parameter</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-07</td>
</tr>
<tr>
<td>Depends:</td>
<td>EnvStats, DEoptim, stats, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>Density, distribution function, quantile function random generation and estimation of bimodal GEV distribution given in Otiniano et al. (2023) &lt;<a href="https://doi.org/10.1007%2Fs10651-023-00566-7">doi:10.1007/s10651-023-00566-7</a>&gt;. This new generalization of the well-known GEV (Generalized Extreme Value) distribution is useful for modeling heterogeneous bimodal data from different areas.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-14 15:36:27 UTC; thiagosousa</td>
</tr>
<tr>
<td>Author:</td>
<td>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Thiago Sousa Developer &lt;thiagoestatistico@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-14 20:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='bgev-package'>
Bimodal GEV Distribution with Location Parameter
</h2><span id='topic+bgev-package'></span><span id='topic+bgev'></span><span id='topic+dbgev'></span><span id='topic+pbgev'></span><span id='topic+qbgev'></span><span id='topic+rbgev'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function random generation and estimation of bimodal GEV distribution given in Otiniano et al. (2023) &lt;doi:10.1007/s10651-023-00566-7&gt;. This new generalization of the well-known GEV (Generalized Extreme Value) distribution is useful for modeling heterogeneous bimodal data from different areas.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbgev(y, mu = 1, sigma = 1, xi = 0.3, delta = 2)
pbgev(y, mu = 1, sigma = 1, xi = 0.3, delta = 2)
qbgev(p, mu = 1, sigma = 1, xi = 0.3, delta = 2)
rbgev(n, mu = 1, sigma = 1, xi = 0.3, delta = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgev-package_+3A_y">y</code></td>
<td>

<p>a unidimensional vector containing the points to compute the density (dbgev) or  
the probability (pbgev) froma bimodal GEV distribution with parameters
<code>mu</code>, <code>sigma</code>, <code>xi</code> and <code>delta</code>.
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_p">p</code></td>
<td>

<p>a unidimensional vector containing the probabilities 
used to compute the quantiles
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_n">n</code></td>
<td>

<p>an integer describing the number of observations to generate random bimodal
GEV observations
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_mu">mu</code></td>
<td>

<p>location parameter
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_sigma">sigma</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_xi">xi</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="bgev-package_+3A_delta">delta</code></td>
<td>

<p>bimodality parameter
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Density, distribution function, quantile function and random generation of 
bimodal GEV distribution with location parameter. In addition, maximum likelihood
estimation based on real data is also provided.
</p>


<h3>Value</h3>

<p><code>dbgev</code> gives the density, <code>pbgev</code> gives the distribution function, 
<code>qbgev</code> gives the quantile function, and <code>rbgev</code> generates random
bimodal GEV observations. 
</p>


<h3>Note</h3>

<p>The probability density of a GEV random variable; <code class="reqn">Y \sim F_{\xi, \sigma, \mu}</code> is given by: 
</p>
<p style="text-align: center;"><code class="reqn">
	f_{\xi, \mu, \sigma}(y)=
		\begin{cases}
		\dfrac{1}{\sigma} \left[ 1+ \xi \left(\dfrac{y-\mu}{\sigma}\right) \right]^{(-1/\xi) -1} \exp\left\{- \left[1+\xi\left(\dfrac{y-\mu}{\sigma}\right)\right]^{-1/\xi}\right\} ,&amp; \text{if } \xi \ne 0 \\
		\dfrac{1}{\sigma} \exp \left\{ - \left(  \dfrac{y-\mu}{\sigma}\right)  - \exp \left[ - \left(  \dfrac{y-\mu}{\sigma}\right)  \right]  \right\},              &amp; \text{if }  \xi = 0 ,
	\end{cases}
</code>
</p>

<p>where <code class="reqn">\xi</code> and <code class="reqn">\sigma</code> are the shape parameters and <code class="reqn">\mu</code> is the location parameter.
</p>
<p>The bimodal Generalized Extreme Value (GEV) model, denoted as BGEV, consists of composing the distribution of a random variable following the GEV distribution with a location parameter <code class="reqn">\mu=0</code>, i.e., <code class="reqn">Y \sim F_{\xi, 0, \sigma}</code>, with the transformation <code class="reqn">T_{\mu, \delta}</code> defined below. Thus, the cumulative distribution function (CDF) of a random variable BGEV, denoted as <code class="reqn">X \sim F_{BG_{\xi, \mu, \sigma, \delta}}</code>, is given by:
</p>
<p style="text-align: center;"><code class="reqn">F_{BG_{\xi,\mu,\sigma, \delta}}(x) =  F_{\xi, 0, \sigma}(T_{\mu, \delta}(x)),</code>
</p>

<p>where the function <code class="reqn">T_{\mu, \delta}</code> is defined as:
</p>
<p style="text-align: center;"><code class="reqn">T_{\mu, \delta}(x)=\left(  x - \mu  \right) \left| x -\mu \right| ^{\delta}, \quad \delta &gt; -1, \quad \mu \in \mathbb{R}.</code>
</p>

<p>Moreover, the function <code class="reqn">T</code> is invertible, with the inverse given by:
</p>
<p style="text-align: center;"><code class="reqn">T^{-1}_{\mu, \delta}(x) = \text{sng}(x) |x|^{\dfrac{1}{\left( \delta +1 \right) }} + \mu.</code>
</p>

<p>Additionally, it is differentiable, and its derivative has the following form:
</p>
<p style="text-align: center;"><code class="reqn">T'_{\mu, \delta}(x) = (\delta + 1 ) |x - \mu|^{\delta}.</code>
</p>

<p>Its probability density function <code class="reqn">X\sim F_{BG_{\xi,\mu,\sigma, \delta}}</code> is given by
</p>
<p style="text-align: center;"><code class="reqn">
	f_{BG_{\xi,\mu,\sigma, \delta}} (x)= \begin{cases}
		\dfrac{1}{\sigma} \left[ 1+ \xi \left(\dfrac{T_{\mu, \delta}(x)}{\sigma}\right) \right]^{(-1/\xi) -1} \exp\left[- \left[1+\xi\left(\dfrac{T_{\mu, \delta}(x)}        {\sigma}\right)\right]^{-1/\xi}\right] T'_{\mu, \delta}(x)
		, &amp; \xi \neq 0 \\
		\dfrac{1}{\sigma} \exp \left( - \dfrac{T_{\mu, \delta}(x)}{\sigma} \right) \exp \left[- \exp \left( - \dfrac{T_{\mu, \delta}(x)}{\sigma}\right)  \right] T'_{\mu, \delta}(x), &amp;  \xi=0.
	\end{cases}
</code>
</p>



<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>
<p>Maintainer: Thiago Sousa Developer &lt;thiagoestatistico@gmail.com&gt;
</p>


<h3>References</h3>

<p>Otiniano, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate 100 values distributed according to a bimodal GEV
x = rbgev(50, mu = 0.2, sigma = 1, xi = 0.5, delta = 0.2) 
# estimate the bimodal GEV parameters using the generated data
bgev.mle(x)
</code></pre>

<hr>
<h2 id='bgev.mle'>
Parameter estimation of bimodal GEV distribution based on real data 
that appears to be bimodal.
</h2><span id='topic+bgev.mle'></span>

<h3>Description</h3>

<p>Finds the maximum likelihood estimators of the bimodal GEV distribution 
parameters by minimizing the log-likelihood function of the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgev.mle(x, lower = c(-3, 0.1, -3, -0.9), upper = c(3, 3, 3,3), itermax = 50)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgev.mle_+3A_x">x</code></td>
<td>

<p>a unidimensional vector containing observations to estimate a bimodal GEV 
distribution
</p>
</td></tr>
<tr><td><code id="bgev.mle_+3A_lower">lower</code></td>
<td>

<p>a vector of dimension 4 containing the lower limit for each of the bimodal GEV
parameters where the search is going to take place. 
</p>
</td></tr>
<tr><td><code id="bgev.mle_+3A_upper">upper</code></td>
<td>

<p>a vector of dimension 4 containing the upper limit for each of the bimodal GEV
parameters where the search is going to take place. 
</p>
</td></tr>
<tr><td><code id="bgev.mle_+3A_itermax">itermax</code></td>
<td>

<p>maximum number of interations when finding a good starting value for the optimization algorithm.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components returned by the optim R function for which the 
main values are
</p>
<table>
<tr><td><code>par</code></td>
<td>
<p>best parameters of bimodal gev fitting the data</p>
</td></tr>
<tr><td><code>value</code></td>
<td>
<p>value of the log-likelihood corresponding to 'par'</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>


<h3>References</h3>

<p>OTINIANO, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate 100 values distributed according to a bimodal GEV
x = rbgev(50, mu = 0.2, sigma = 1, xi = 0.5, delta = 0.2) 
# estimate the bimodal GEV parameters using the generated data
bgev.mle(x)
</code></pre>

<hr>
<h2 id='bgev.support'>
Support of the bimodal GEV distribution
</h2><span id='topic+bgev.support'></span>

<h3>Description</h3>

<p>When the shape parameter <code>xi</code> is different from zero, the support
is truncated either at the left or at the right side of the real. 
Considering the support is particularly useful to estimating momoments and 
to compute the likelihood function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bgev.support(mu, sigma, xi, delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bgev.support_+3A_mu">mu</code></td>
<td>

<p>location parameter
</p>
</td></tr>
<tr><td><code id="bgev.support_+3A_sigma">sigma</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="bgev.support_+3A_xi">xi</code></td>
<td>

<p>shape parameter
</p>
</td></tr>
<tr><td><code id="bgev.support_+3A_delta">delta</code></td>
<td>

<p>bimodality parameter
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It returns a vector representing the interval for which the density function 
is not null. 
</p>


<h3>Note</h3>

<p>The Support of the bimodal GEV distribution is given by the following equation:
</p>
<p style="text-align: center;"><code class="reqn">
    \begin{cases}
     x \in \mathbb {R} : x \geq \mathbf{sng} \left(-\frac{\sigma}{\xi}\right) | \frac{\sigma}{\xi}| ^{\frac{1}{\delta+1}}+\mu, &amp;  \xi \neq 0 \\
     x \in \mathbb {R}, &amp; \xi =0.
    \end{cases}
</code>
</p>



<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>


<h3>References</h3>

<p>Otiniano, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Computes the support of a specific bimodal GEV distribution
support = bgev.support(mu=1, sigma=10, xi=0.3, delta=2)
</code></pre>

<hr>
<h2 id='distCheck'>
Check implementation of a distribution in <span class="rlang"><b>R</b></span>. 
</h2><span id='topic+distCheck'></span>

<h3>Description</h3>

<p>This is just a refactorization of 
the original <span class="rlang"><b>R</b></span> function <code>distCheck</code> to allow customization for heavy tailed distributions
and distribution with constrained support. Assumes one has implemented density, 
probability, quantile and random generation for a new distribution. 
Originally implemented to be used with the bimodal GEV distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distCheck(fun = "norm", n = 1000, robust = FALSE, subdivisions = 1500, 
support.lower = -Inf, support.upper = Inf, 
var.exists = TRUE, print.result = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distCheck_+3A_fun">fun</code></td>
<td>

<p>Name of distribution. E.g, &quot;bgev&quot; for bimodal GEV, &quot;gev&quot; for GEV, &quot;norm&quot; for normal. 
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_n">n</code></td>
<td>

<p>size of the sample when generating random values through &quot;rfun&quot;
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_robust">robust</code></td>
<td>

<p>Boolean. Used for computing mean and variance in a robust way when evaluating mean 
and variance.
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_subdivisions">subdivisions</code></td>
<td>

<p>used for numerical integration when using &quot;dfun&quot;
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_support.lower">support.lower</code></td>
<td>

<p>lower limit of the support of the distribution
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_support.upper">support.upper</code></td>
<td>

<p>upper limit of the support of the distribution
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_var.exists">var.exists</code></td>
<td>

<p>Boolean indicating if variance exists (useful for gev, bimodal gev, stable etc)
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_print.result">print.result</code></td>
<td>

<p>Boolean indicating weather to print results of the tests on screen.
</p>
</td></tr>
<tr><td><code id="distCheck_+3A_...">...</code></td>
<td>

<p>parameters passed to the distribution, e.g., mu and sd for normal, mu, sigma, xi
and delta for bimodal GEV.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All tests results are organized into a list to make it easier to find where 
results went wrong and to make it scalable for testing distributions for 
several parameters. 
</p>


<h3>Value</h3>

<p>A list of lists with test results
</p>
<p><code>list( functionTested = fun,
              functionParam = list(...),</code><br />
<code>test1.density =      list(computed = NULL, expected = NULL, error.check = NULL),</code><br />
<code>test2.quantile.cdf = list(computed = NULL, expected = NULL, error.check = NULL),</code><br />
<code>test3.mean.var =     list(computed = list(mean = NULL, var = NULL, log = NULL), </code><br />
<code> expected = list(mean = NULL, var = NULL, log = NULL),</code><br />
<code>  error.check = NULL, </code><br />
<code>  condition.is.var.finite = TRUE))</code>
</p>
<table>
<tr><td><code>functionParam</code></td>
<td>
<p>Additional parameters passed to the distribution with the ... argument</p>
</td></tr>
<tr><td><code>test1.density</code></td>
<td>
<p>results for the density function test. A list with the 'computed' value 
using the density function and numerical integration, the 'expected' value (which is 1) and 
the result of the 'error.check' comparing both values.</p>
</td></tr>
<tr><td><code>test2.quantile.cdf</code></td>
<td>
<p>results for the quantile function test. A list with the 'computed' value 
using the quantile function at chosen probabilites on [0,1], the 'expected' value (which is 1) and 
the result of the 'error.check' comparing both values.</p>
</td></tr>
<tr><td><code>test3.mean.var</code></td>
<td>
<p>results for the random generation and the density function. 
A list with the 'computed' values using the random quantities (computes mean(X), variance(X) and E(log(abs(X))) where X follows
the distribution being tested. The 'expected' is a list containing the same quantities computed using numerical integration</p>
</td></tr>
<tr><td><code>error.check</code></td>
<td>
<p>check if expected variance and computed variance are close enough.</p>
</td></tr>
<tr><td><code>condition.is.var.finite</code></td>
<td>
<p>For some distributions there are known conditions for the variance to be finite. This quantity
is expected to be evaluated outside the DistCheck function and passed through the argument 'var.exists'.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>


<h3>References</h3>

<p>Otiniano, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class='language-R'># generate random values for the parameters and test the 
# bimodal gev distribution implementation
set.seed(1)
mu = runif(1,-2,2)
sigma = runif(1,0.1,2)
xi = runif(1,0.3,0.9) * sign(runif(1,-1,1))
delta = 1#runif(1,-0.6,2)
support = bgev.support(mu, sigma, xi, delta)
var.exists = ( xi != 0) &amp; (xi &lt; (delta + 1)/2)
ret = distCheck(fun="bgev", n = 2000, 
      support.lower = support[1], support.upper = support[2], 
      subdivisions = 5000, mu = mu, sigma = sigma, xi = xi, 
      delta = delta, var.exists = var.exists, print.result = TRUE)
</code></pre>

<hr>
<h2 id='likbgev'>
Log likelihood function for the bimodal GEV distribution.
</h2><span id='topic+likbgev'></span>

<h3>Description</h3>

<p>Uses the density function to evaluate the likelihood. This is useful for the
'bgev.mle' function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>likbgev(y, theta = c(1, 1, 0.3, 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="likbgev_+3A_y">y</code></td>
<td>

<p>a unidimensional vector containing the points to compute the log likelihood
</p>
</td></tr>
<tr><td><code id="likbgev_+3A_theta">theta</code></td>
<td>

<p>bimodal GEV parameters as an ordered pair <code>theta = (mu,sigma,xi,delta)</code>
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a unidimensional vector containing the computed log likelihood for <code>y</code>.
</p>


<h3>Author(s)</h3>

<p>Cira Otiniano Author [aut],
  Yasmin Lirio Author [aut],
  Thiago Sousa Developer [cre]
</p>


<h3>References</h3>

<p>Otiniano, Cira EG, et al. (2023). A bimodal model for extremes data. Environmental and Ecological Statistics, 1-28. http://dx.doi.org/10.1007/s10651-023-00566-7
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get random points from bimodal GEV
y = rbgev(100, mu = 1, sigma = 1, xi = 0.3, delta = 2)

# compute log-likelihood
likbgev (y, theta = c(1, 1, 0.3, 2)) 
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
