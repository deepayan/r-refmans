<!DOCTYPE html><html lang="en"><head><title>Help for package ggcompare</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ggcompare}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ggcompare-package'><p>ggcompare: Mean Comparison in 'ggplot2'</p></a></li>
<li><a href='#geom_bracket'><p>Add Brackets with Labels to a ggplot</p></a></li>
<li><a href='#stat_compare'><p>Add Mean Comparison for Groups to a ggplot</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Mean Comparison in 'ggplot2'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Add mean comparison annotations to a 'ggplot'. 
             This package provides an easy way to indicate if two or more groups are significantly different in a 'ggplot'. 
             Usually you do not need to specify the test method, you only need to tell stat_compare() whether you want to perform a parametric test or a nonparametric test, and stat_compare() will automatically choose the appropriate test method based on your data. 
             For comparisons between two groups, the p-value is calculated by t-test (parametric) or Wilcoxon rank sum test (nonparametric). For comparisons among more than two groups, the p-value is calculated by One-way ANOVA (parametric) or Kruskal-Wallis test (nonparametric).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/Artistic-2.0">Artistic-2.0</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://hmu-wh.github.io/ggcompare/">https://hmu-wh.github.io/ggcompare/</a>,
<a href="https://github.com/HMU-WH/ggcompare/">https://github.com/HMU-WH/ggcompare/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HMU-WH/ggcompare/issues/">https://github.com/HMU-WH/ggcompare/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-12-09 05:45:56 UTC; 22835</td>
</tr>
<tr>
<td>Author:</td>
<td>Hao Wang <a href="https://orcid.org/0009-0000-9477-9585"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hao Wang &lt;wanghao8772@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-12-09 06:00:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='ggcompare-package'>ggcompare: Mean Comparison in 'ggplot2'</h2><span id='topic+ggcompare'></span><span id='topic+ggcompare-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Add mean comparison annotations to a 'ggplot'. This package provides an easy way to indicate if two or more groups are significantly different in a 'ggplot'. Usually you do not need to specify the test method, you only need to tell stat_compare() whether you want to perform a parametric test or a nonparametric test, and stat_compare() will automatically choose the appropriate test method based on your data. For comparisons between two groups, the p-value is calculated by t-test (parametric) or Wilcoxon rank sum test (nonparametric). For comparisons among more than two groups, the p-value is calculated by One-way ANOVA (parametric) or Kruskal-Wallis test (nonparametric).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Hao Wang <a href="mailto:wanghao8772@gmail.com">wanghao8772@gmail.com</a> (<a href="https://orcid.org/0009-0000-9477-9585">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://hmu-wh.github.io/ggcompare/">https://hmu-wh.github.io/ggcompare/</a>
</p>
</li>
<li> <p><a href="https://github.com/HMU-WH/ggcompare/">https://github.com/HMU-WH/ggcompare/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/HMU-WH/ggcompare/issues/">https://github.com/HMU-WH/ggcompare/issues/</a>
</p>
</li></ul>


<hr>
<h2 id='geom_bracket'>Add Brackets with Labels to a ggplot</h2><span id='topic+geom_bracket'></span>

<h3>Description</h3>

<p>Add brackets with labeled annotations to a ggplot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geom_bracket(
  mapping = NULL,
  data = NULL,
  stat = "identity",
  position = "identity",
  ...,
  arrow = NULL,
  parse = FALSE,
  bracket = TRUE,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geom_bracket_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_stat">stat</code></td>
<td>
<p>The statistical transformation to use on the data for this layer.
When using a <code style="white-space: pre;">&#8288;geom_*()&#8288;</code> function to construct a layer, the <code>stat</code>
argument can be used the override the default coupling between geoms and
stats. The <code>stat</code> argument accepts the following:
</p>

<ul>
<li><p> A <code>Stat</code> ggproto subclass, for example <code>StatCount</code>.
</p>
</li>
<li><p> A string naming the stat. To give the stat as a string, strip the
function name of the <code>stat_</code> prefix. For example, to use <code>stat_count()</code>,
give the stat as <code>"count"</code>.
</p>
</li>
<li><p> For more information and other ways to specify the stat, see the
<a href="ggplot2.html#topic+layer_stats">layer stat</a> documentation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="geom_bracket_+3A_position">position</code></td>
<td>
<p>A position adjustment to use on the data for this layer. This
can be used in various ways, including to prevent overplotting and
improving the display. The <code>position</code> argument accepts the following:
</p>

<ul>
<li><p> The result of calling a position function, such as <code>position_jitter()</code>.
This method allows for passing extra arguments to the position.
</p>
</li>
<li><p> A string naming the position adjustment. To give the position as a
string, strip the function name of the <code>position_</code> prefix. For example,
to use <code>position_jitter()</code>, give the position as <code>"jitter"</code>.
</p>
</li>
<li><p> For more information and other ways to specify the position, see the
<a href="ggplot2.html#topic+layer_positions">layer position</a> documentation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="geom_bracket_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <a href="ggplot2.html#topic+layer">layer()</a>.</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_arrow">arrow</code></td>
<td>
<p><code>arrow</code>, the arrow appear at both ends of the brackets, created by <code><a href="grid.html#topic+arrow">grid::arrow()</a></code>.</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_parse">parse</code></td>
<td>
<p><code>logical</code>, whether to parse the labels as expressions and displayed as described in <a href="grDevices.html#topic+plotmath">plotmath</a>.</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_bracket">bracket</code></td>
<td>
<p><code>logical</code>, whether to display the bracket. If <code>FALSE</code>, only the label will be displayed.</p>
</td></tr>
<tr><td><code id="geom_bracket_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>LayerInstance</code>, a layer that can be added to a ggplot.
</p>


<h3>Aesthetics</h3>


<ul>
<li><p> required: <code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code>, <code>label</code>
</p>
</li>
<li><p> optional: <code>angle</code>, <code>alpha</code>, <code>hjust</code>, <code>vjust</code>, <code>colour</code>, <code>family</code>, <code>fontsize</code>, <code>fontface</code>, <code>linetype</code>, <code>linewidth</code>, <code>lineheight</code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p>HMU-WH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

ggplot(mpg, aes(class, displ)) +
  geom_boxplot() +
  annotate("bracket", xmin = 2, xmax = 4, ymin = 4.5, ymax = 5, label = "label",
           arrow = grid::arrow(type = "closed", length = unit(0.1, "inches")))

</code></pre>

<hr>
<h2 id='stat_compare'>Add Mean Comparison for Groups to a ggplot</h2><span id='topic+stat_compare'></span>

<h3>Description</h3>

<p>Add group mean comparisons to a ggplot. The comparisons can be performed using the t-test, Wilcoxon rank-sum test, one-way ANOVA, or Kruskal-Wallis test.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stat_compare(
  mapping = NULL,
  data = NULL,
  position = "identity",
  ...,
  nudge = 0,
  start = NULL,
  breaks = NULL,
  labels = NULL,
  cutoff = NULL,
  method = NULL,
  ref_group = NULL,
  tip_length = 0.02,
  parametric = FALSE,
  correction = "none",
  panel_indep = FALSE,
  method_args = NULL,
  comparisons = NULL,
  step_increase = 0.1,
  inherit.aes = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="stat_compare_+3A_mapping">mapping</code></td>
<td>
<p>Set of aesthetic mappings created by <code><a href="ggplot2.html#topic+aes">aes()</a></code>. If specified and
<code>inherit.aes = TRUE</code> (the default), it is combined with the default mapping
at the top level of the plot. You must supply <code>mapping</code> if there is no plot
mapping.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_data">data</code></td>
<td>
<p>The data to be displayed in this layer. There are three
options:
</p>
<p>If <code>NULL</code>, the default, the data is inherited from the plot
data as specified in the call to <code><a href="ggplot2.html#topic+ggplot">ggplot()</a></code>.
</p>
<p>A <code>data.frame</code>, or other object, will override the plot
data. All objects will be fortified to produce a data frame. See
<code><a href="ggplot2.html#topic+fortify">fortify()</a></code> for which variables will be created.
</p>
<p>A <code>function</code> will be called with a single argument,
the plot data. The return value must be a <code>data.frame</code>, and
will be used as the layer data. A <code>function</code> can be created
from a <code>formula</code> (e.g. <code>~ head(.x, 10)</code>).</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_position">position</code></td>
<td>
<p>A position adjustment to use on the data for this layer. This
can be used in various ways, including to prevent overplotting and
improving the display. The <code>position</code> argument accepts the following:
</p>

<ul>
<li><p> The result of calling a position function, such as <code>position_jitter()</code>.
This method allows for passing extra arguments to the position.
</p>
</li>
<li><p> A string naming the position adjustment. To give the position as a
string, strip the function name of the <code>position_</code> prefix. For example,
to use <code>position_jitter()</code>, give the position as <code>"jitter"</code>.
</p>
</li>
<li><p> For more information and other ways to specify the position, see the
<a href="ggplot2.html#topic+layer_positions">layer position</a> documentation.
</p>
</li></ul>
</td></tr>
<tr><td><code id="stat_compare_+3A_...">...</code></td>
<td>
<p>additional arguments passed on to <code><a href="#topic+geom_bracket">geom_bracket()</a></code>.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_nudge">nudge</code></td>
<td>
<p><code>numeric</code>, the nudge of start position in fraction of scale range.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_start">start</code></td>
<td>
<p><code>numeric</code>, the bracket start position. Defaults to the maximum value of <code>y</code>.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_breaks">breaks</code></td>
<td>
<p><code>numeric</code>, the breaks for p-value labels, like <code>c(0, 0.001, 0.01, 0.05, 1)</code>.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_labels">labels</code></td>
<td>
<p><code>character</code>, the labels for p-value breaks, like <code>c("***", "**", "*", "ns")</code>.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_cutoff">cutoff</code></td>
<td>
<p><code>numeric</code>, the cutoff for p-value, labels above this value will be removed.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_method">method</code></td>
<td>
<p><code>function</code>, the method for the test; it should support formula interface and return a list with components <code>p.value</code> and <code>method</code> (name).</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_ref_group">ref_group</code></td>
<td>
<p><code>character</code>, the reference group for comparison. other groups will be compared to this group.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_tip_length">tip_length</code></td>
<td>
<p><code>numeric</code>, the length of the bracket tips in fraction of scale range.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_parametric">parametric</code></td>
<td>
<p><code>logical</code>, whether to use parametric test (t-test, One-way ANOVA) or non-parametric test (Wilcoxon rank sum test, Kruskal-Wallis test). Applicable only when <code>method</code> is NULL.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_correction">correction</code></td>
<td>
<p><code>character</code>, the method for p-value adjustment; options include <a href="stats.html#topic+p.adjust">p.adjust.methods</a> with &quot;<code>none</code>&quot; as the default.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_panel_indep">panel_indep</code></td>
<td>
<p><code>logical</code>, whether to correct the p-value only at the panel level. If <code>FALSE</code>, the p-value will be corrected at the layer level.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_method_args">method_args</code></td>
<td>
<p><code>list</code>, additional arguments to be passed to the test method.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_comparisons">comparisons</code></td>
<td>
<p><code>list</code>, a list of comparisons to be made. Each element should contain two groups to be compared.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_step_increase">step_increase</code></td>
<td>
<p><code>numeric</code>, the step increase in fraction of scale range for every additional comparison, in order to avoid overlapping brackets.</p>
</td></tr>
<tr><td><code id="stat_compare_+3A_inherit.aes">inherit.aes</code></td>
<td>
<p>If <code>FALSE</code>, overrides the default aesthetics,
rather than combining with them. This is most useful for helper functions
that define both data and aesthetics and shouldn't inherit behaviour from
the default plot specification, e.g. <code><a href="ggplot2.html#topic+borders">borders()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Usually you do not need to specify the test method, you only need to tell <code>stat_compare()</code> whether you want to perform a parametric test or a nonparametric test, and <code>stat_compare()</code> will automatically choose the appropriate test method based on your data.
For comparisons between two groups, the p-value is calculated by t-test (parametric) or Wilcoxon rank sum test (nonparametric). For comparisons among more than two groups, the p-value is calculated by One-way ANOVA (parametric) or Kruskal-Wallis test (nonparametric).
</p>


<h3>Value</h3>

<p><code>LayerInstance</code>, a layer that can be added to a ggplot.
</p>


<h3>Aesthetics</h3>


<ul>
<li><p> required: <code>x</code>, <code>y</code>
</p>
</li></ul>



<h3>Computed variables</h3>


<ul>
<li> <p><strong><code>p</code></strong>: p-value of the test.
</p>
</li>
<li> <p><strong><code>q</code></strong>: adjusted p-value of the test.
</p>
</li>
<li> <p><strong><code>label</code></strong>: the label of the bracket.
</p>
</li>
<li> <p><strong><code>method</code></strong>: the method name of the test.
</p>
</li>
<li> <p><strong><code>xmin</code></strong>, <strong><code>xmax</code></strong>, <strong><code>ymin</code></strong>, <strong><code>ymax</code></strong>: the position of the bracket.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>HMU-WH
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(ggplot2)

p &lt;- ggplot(mpg, aes(class, displ, color = class)) +
  geom_boxplot(show.legend = FALSE) +
  theme_test()

# Global comparison: Each x has only one group.
p + stat_compare()
# If you just want to display text, you can set parameters "bracket" to FALSE.
p + stat_compare(bracket = FALSE)
# If you want to display the test method, you can do this.
p + stat_compare(aes(label = after_stat(sprintf("%s: %s", method, label))))

# Comparison between two groups: specify a reference group.
p + stat_compare(ref_group = "minivan")
# If you only want to display the p-value less or equal to 0.01, you can do this.
p + stat_compare(ref_group = "minivan", cutoff = 0.01)
# If you want to display the significance level, you can do this.
p + stat_compare(ref_group = "minivan", breaks = c(0, 0.001, 0.01, 0.05, 1))

# Comparison between two groups: specify the comparison group.
p + stat_compare(tip_length = 0.05,
                 step_increase = 0,
                 comparisons = list(c("compact", "midsize"), c("pickup", "suv")),
                 arrow = grid::arrow(type = "closed", length = unit(0.1, "inches")))
                 # Yeah, this supports adding arrows.

# Within-group (grouped by the x-axis) population comparison.
ggplot(mpg, aes(drv, displ, fill = class)) +
  geom_boxplot() +
  stat_compare() +
  stat_compare(aes(group = drv), nudge = 0.1, color = "gray") + # add global comparison
  theme_test()

# Better adaptation to faceting.
ggplot(mpg, aes(drv, displ)) +
  geom_boxplot() +
  stat_compare(comparisons = combn(unique(mpg$drv), 2, simplify = FALSE)) +
  facet_grid(cols = vars(class), scales = "free") +
  theme_test()

# P-value correction
p &lt;- ggplot(mpg, aes(class, displ)) +
  geom_boxplot() +
  facet_grid(cols = vars(cyl), scales = "free") +
  theme_test()
# Layer-level P-value correction
p + stat_compare(ref_group = 1, correction = "fdr")
# Panel-level P-value correction
p + stat_compare(ref_group = 1, correction = "fdr", panel_indep = TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
