<!DOCTYPE html><html><head><title>Help for package demodelr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {demodelr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#compute_likelihood'><p>Likelihood plot of a two parameter model</p></a></li>
<li><a href='#eigenvalues'><p>Matrix eigenvalues and eigenvectors</p></a></li>
<li><a href='#euler'><p>Euler's method solution for a differential equation.</p></a></li>
<li><a href='#euler_stochastic'><p>Euler-Maruyama method solution for a stochastic differential equation.</p></a></li>
<li><a href='#global_temperature'><p>Measured average global temperature anomaly by year</p></a></li>
<li><a href='#mcmc_analyze'><p>Markov Chain parameter estimates</p></a></li>
<li><a href='#mcmc_estimate'><p>Markov Chain parameter estimates</p></a></li>
<li><a href='#parks'><p>Visitor and resource usage to a national park</p></a></li>
<li><a href='#phaseplane'><p>Phase plane of differential equation.</p></a></li>
<li><a href='#phosphorous'><p>Measured phosphorous of Daphnia and algae</p></a></li>
<li><a href='#precipitation'><p>Measured precipitation from a rainfall event</p></a></li>
<li><a href='#rk4'><p>Runge Kutta method solution for a differential equation.</p></a></li>
<li><a href='#snowfall'><p>Measured snowfall from a blizzard in April 2018</p></a></li>
<li><a href='#wilson'><p>Measured Weight of a dog over time</p></a></li>
<li><a href='#yeast'><p>Measured Sacchromyces data (yeast) from Gause 1932 &quot;Experimental studies on the struggle for coexistence&quot;</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Simulating Differential Equations with Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Designed to support the visualization, numerical computation,
     qualitative analysis, model-data fusion, and stochastic simulation for
     autonomous systems of differential equations. Euler and Runge-Kutta methods
     are implemented, along with tools to visualize the two-dimensional
     phaseplane. Likelihood surfaces and a simple Markov Chain Monte Carlo
     parameter estimator can be used for model-data fusion of differential
     equations and empirical models. The Euler-Maruyama method is provided for
     simulation of stochastic differential equations. The package was originally
     written for internal use to support teaching by Zobitz, and refined to
     support the text "Exploring modeling with data and differential equations
     using R" by John Zobitz (2021) <a href="https://jmzobitz.github.io/ModelingWithR/index.html">https://jmzobitz.github.io/ModelingWithR/index.html</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>ggplot2, purrr, tidyr, dplyr, formula.tools, GGally, rlang,
utils, tibble</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-16 15:11:48 UTC; zobitz</td>
</tr>
<tr>
<td>Author:</td>
<td>John Zobitz <a href="https://orcid.org/0000-0002-1830-143X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Zobitz &lt;zobitz@augsburg.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-16 15:36:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='compute_likelihood'>Likelihood plot of a two parameter model</h2><span id='topic+compute_likelihood'></span>

<h3>Description</h3>

<p><code>compute_likelihood</code> computes the likelihood for a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compute_likelihood(model, data, parameters, logLikely = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compute_likelihood_+3A_model">model</code></td>
<td>
<p>a function or model of our situation, written with formula notation</p>
</td></tr>
<tr><td><code id="compute_likelihood_+3A_data">data</code></td>
<td>
<p>Data frame of data
First column is the independent variable, second column dependent variable.
Must be a data.frame</p>
</td></tr>
<tr><td><code id="compute_likelihood_+3A_parameters">parameters</code></td>
<td>
<p>The data frame matrix of values of the parameters we are using.  This will be made using expand.grid or equivalent</p>
</td></tr>
<tr><td><code id="compute_likelihood_+3A_loglikely">logLikely</code></td>
<td>
<p>Do we compute the log likelihood function (default is FALSE).  NOTE: what gets returned is - logLikely - meaning that this will be a positive number to work with.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with two entries: (1) the likelihood values and (2) values of parameters that optimize the likelihood.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Contour plot of a logistic model for two parameters K and b
### using data collected from growth of yeast population

# Define the solution to the differential equation with
# parameters K and b Gause model equation
gause_model &lt;- volume ~ K / (1 + exp(log(K / 0.45 - 1) - b * time))
# Identify the ranges of the parameters that we wish to investigate
kParam &lt;- seq(5, 20, length.out = 100)
bParam &lt;- seq(0, 1, length.out = 100)
# Allow for all the possible combinations of parameters
gause_parameters &lt;- expand.grid(K = kParam, b = bParam)
# Now compute the likelihood
gause_likelihood &lt;- compute_likelihood( model = gause_model,
                                       data = yeast,
                                       parameters = gause_parameters,
                                       logLikely = FALSE
)
</code></pre>

<hr>
<h2 id='eigenvalues'>Matrix eigenvalues and eigenvectors</h2><span id='topic+eigenvalues'></span>

<h3>Description</h3>

<p><code>eigenvalues</code> visualizes the vector field for a one or two dimensional differential equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>eigenvalues(matrix_entries, matrix_rows = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="eigenvalues_+3A_matrix_entries">matrix_entries</code></td>
<td>
<p>entries of your matrix in row wise format.
So the matrix
#   4  3
#   2  1
# would be entered in c(4,3,2,1)</p>
</td></tr>
<tr><td><code id="eigenvalues_+3A_matrix_rows">matrix_rows</code></td>
<td>
<p>the number of rows and columns in your SQUARE matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a list with two elements (denoted by the “$”), values and vectors.
result$values are the eigenvalues, stored as a vector. The leading eigenvalue is the first entry in the vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>eigenvalues(c(1,2,3,4))

# Note: for the 3 x 3 case, we need to define the number of matrix rows:
eigenvalues(c(1,2,3,4,5,6,7,8,9),matrix_rows=3)
</code></pre>

<hr>
<h2 id='euler'>Euler's method solution for a differential equation.</h2><span id='topic+euler'></span>

<h3>Description</h3>

<p><code>euler</code> solves a multi-dimensional differential equation with Euler's method.  The parameters listed as required are needed
See the vignette for detailed examples of usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>euler(
  system_eq,
  initial_condition,
  parameters = NULL,
  t_start = 0,
  deltaT = 1,
  n_steps = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="euler_+3A_system_eq">system_eq</code></td>
<td>
<p>(REQUIRED) The 1 or multi dimensional system of equations, written in formula notation as a vector (i.e.  c(dx ~ f(x,y), dy ~ g(x,y)))</p>
</td></tr>
<tr><td><code id="euler_+3A_initial_condition">initial_condition</code></td>
<td>
<p>(REQUIRED) Listing of initial conditions, as a vector</p>
</td></tr>
<tr><td><code id="euler_+3A_parameters">parameters</code></td>
<td>
<p>The values of the parameters we are using (optional)</p>
</td></tr>
<tr><td><code id="euler_+3A_t_start">t_start</code></td>
<td>
<p>The starting time point (defaults to t = 0)</p>
</td></tr>
<tr><td><code id="euler_+3A_deltat">deltaT</code></td>
<td>
<p>The timestep length (defaults to 1)</p>
</td></tr>
<tr><td><code id="euler_+3A_n_steps">n_steps</code></td>
<td>
<p>The number of timesteps to compute solution (defaults to n_steps = 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy of data frame for the calculated solutions and the time
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rk4">rk4</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the rate equation:
lynx_hare_eq &lt;- c(
 dHdt ~ r * H - b * H * L,
 dLdt ~ e * b * H * L - d * L
)

# Define the parameters (as a named vector):
lynx_hare_params &lt;- c(r = 2, b = 0.5, e = 0.1, d = 1)

# Define the initial condition (as a named vector):
lynx_hare_init &lt;- c(H = 1, L = 3)

# Define deltaT and the number of time steps:
deltaT &lt;- 0.05
n_steps &lt;- 200

# Compute the solution via Euler's method:
out_solution &lt;- euler(system_eq = lynx_hare_eq,
                     parameters = lynx_hare_params,
                     initial_condition = lynx_hare_init,
                     deltaT = deltaT,
                     n_steps = n_steps
)
</code></pre>

<hr>
<h2 id='euler_stochastic'>Euler-Maruyama method solution for a stochastic differential equation.</h2><span id='topic+euler_stochastic'></span>

<h3>Description</h3>

<p><code>euler_stochastic</code> solves a multi-dimensional differential equation with the Euler-Maruyama method with stochastic elements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>euler_stochastic(
  deterministic_rate,
  stochastic_rate,
  initial_condition,
  parameters = NULL,
  t_start = 0,
  deltaT = 1,
  n_steps = 1,
  D = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="euler_stochastic_+3A_deterministic_rate">deterministic_rate</code></td>
<td>
<p>The 1 or multi dimensional system of equations for the deterministic part of the differential equation, written in formula notation as a vector (i.e.  c(dx ~ f(x,y), dy ~ g(x,y)))</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_stochastic_rate">stochastic_rate</code></td>
<td>
<p>The 1 or multi dimensional system of equations for the stochastic part of the differential equation, written in formula notation as a vector (i.e.  c(dx ~ f(x,y), dy ~ g(x,y)))</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_initial_condition">initial_condition</code></td>
<td>
<p>(REQUIRED) Listing of initial conditions, as a vector</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_parameters">parameters</code></td>
<td>
<p>The values of the parameters we are using</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_t_start">t_start</code></td>
<td>
<p>The starting time point (defaults to t = 0)</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_deltat">deltaT</code></td>
<td>
<p>The timestep length (defaults to 1)</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_n_steps">n_steps</code></td>
<td>
<p>The number of timesteps to compute solution (defaults to n_steps = 1)</p>
</td></tr>
<tr><td><code id="euler_stochastic_+3A_d">D</code></td>
<td>
<p>diffusion coefficient for the stochastic part of the SDE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy of data frame the solutions
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### Simulate the stochastic differential equation dx = r*x*(1-x/K) dt + dW(t)
# Identify the deterministic and stochastic parts of the DE:
deterministic_logistic &lt;- c(dx ~ r*x*(1-x/K))
stochastic_logistic &lt;- c(dx ~ 1)

# Identify the initial condition and any parameters
init_logistic &lt;- c(x=3)

logistic_parameters &lt;- c(r=0.8, K=100) # parameters: a named vector

# Identify how long we run the simulation
deltaT_logistic &lt;- .05 # timestep length
timesteps_logistic &lt;- 200 # must be a number greater than 1

# Identify the standard deviation of the stochastic noise
D_logistic &lt;- 1

# Do one simulation of this differential equation
logistic_out &lt;- euler_stochastic(
deterministic_rate = deterministic_logistic,
stochastic_rate = stochastic_logistic,
initial_condition = init_logistic,
parameters = logistic_parameters,
deltaT = deltaT_logistic,
n_steps = timesteps_logistic, D = D_logistic
)
### Simulate a stochastic process for the tourism model presented in
### Sinay, Laura, and Leon Sinay. 2006. “A Simple Mathematical
### Model for the Effects of the Growth of Tourism on Environment.”
### In International Tourism Conference. Alanya, Turkey.
### where we have the following SDE:
### dr = r*(1-r)-a*v dt, dv = b*v*(r-v) dt + v*(r-v) dW(t)

# Identify the deterministic and stochastic parts of the DE:
deterministic_tourism&lt;- c(dr ~ r*(1-r)-a*v, dv ~ b*v*(r-v))
stochastic_tourism &lt;-  c(dr ~ 0, dv ~ v*(r-v))

# Identify the initial condition and any parameters
init_tourism &lt;- c(r = 0.995, v = 0.00167)
tourism_parameters &lt;- c(a = 0.15, b = 0.3316)   #

deltaT_tourism &lt;- .5 # timestep length
timeSteps_tourism &lt;- 200 # must be a number greater than 1

# Identify the diffusion coefficient
D_tourism &lt;- .05

# Do one simulation of this differential equation
tourism_out &lt;- euler_stochastic(
  deterministic_rate = deterministic_tourism,
 stochastic_rate = stochastic_tourism,
 initial_condition = init_tourism,
 parameters = tourism_parameters,
 deltaT = deltaT_tourism,
 n_steps = timeSteps_tourism,
 D = D_tourism
)
</code></pre>

<hr>
<h2 id='global_temperature'>Measured average global temperature anomaly by year</h2><span id='topic+global_temperature'></span>

<h3>Description</h3>

<p>A dataset containing average global temperature anomaly for each year since 1880. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(global_temperature)
</code></pre>


<h3>Format</h3>

<p>A data frame with 142 rows and 2 variables
</p>


<h3>Details</h3>


<ul>
<li><p> year_since_1880. The year since 1880 (year)
</p>
</li>
<li><p> temperature_anomaly. Average global temperature anomaly (degrees Celsius, relative to 1951-1980)
</p>
</li></ul>



<h3>Source</h3>

<p>The data were collected from NOAA. <a href="https://climate.nasa.gov/vital-signs/global-temperature/">https://climate.nasa.gov/vital-signs/global-temperature/</a>, download 2022-06-08
</p>

<hr>
<h2 id='mcmc_analyze'>Markov Chain parameter estimates</h2><span id='topic+mcmc_analyze'></span>

<h3>Description</h3>

<p><code>mcmc_analyze</code> Computes summary histograms and model-data comparisons from and Markov Chain Monte Carlo parameter estimate for a given model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_analyze(
  model,
  data,
  mcmc_out,
  mode = "emp",
  initial_condition = NULL,
  deltaT = NULL,
  n_steps = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_analyze_+3A_model">model</code></td>
<td>
<p>the model equations that we use to compute the result.</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_data">data</code></td>
<td>
<p>the data used to assess the model</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_mcmc_out">mcmc_out</code></td>
<td>
<p>A dataframe: the first column is the accept flag  of the mcmc run (TRUE/FALSE), the log likelihood, and the parameter values</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_mode">mode</code></td>
<td>
<p>two choices: emp &ndash;&gt; empirical (default) or de &ndash;&gt; differential equations. The estimator works differently depending on which is used.</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_initial_condition">initial_condition</code></td>
<td>
<p>The initial condition for the differential equation (DE mode only)</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_deltat">deltaT</code></td>
<td>
<p>The length between timesteps (DE mode only)</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_n_steps">n_steps</code></td>
<td>
<p>The number of time steps we run the model (DE mode only)</p>
</td></tr>
<tr><td><code id="mcmc_analyze_+3A_verbose">verbose</code></td>
<td>
<p>TRUE / FALSE indicate if parameter estimates should be printed to console (option, defaults to TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots: (1) fitted model results compared to data, and (2) pairwise parameter histograms and scatterplots to test model equifinality.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcmc_estimate">mcmc_estimate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Example with an empirical model:
## Step 1: Define the model and parameters
phos_model &lt;- daphnia ~ c * algae^(1 / theta)

phos_param &lt;- tibble::tibble( name = c("c", "theta"),
lower_bound = c(0, 1),
upper_bound = c(2, 20))

## Step 2: Determine MCMC settings
# Define the number of iterations
phos_iter &lt;- 1000

## Step 3: Compute MCMC estimate
phos_mcmc &lt;- mcmc_estimate(model = phos_model,
data = phosphorous,
parameters = phos_param,
iterations = phos_iter)

## Step 4: Analyze results:
mcmc_analyze(model = phos_model,
data = phosphorous,
mcmc_out = phos_mcmc)

## Example with a differential equation:
## Step 1: Define the model, parameters, and data
## Define the tourism model
tourism_model &lt;- c(dRdt ~ resources * (1 - resources) - a * visitors,
dVdt ~ b * visitors * (resources - visitors))

# Define the parameters that you will use with their bounds
tourism_param &lt;- tibble::tibble( name = c("a", "b"),
lower_bound = c(10, 0),
upper_bound = c(30, 5))

## Step 2: Determine MCMC settings
# Define the initial conditions
tourism_init &lt;- c(resources = 0.995, visitors = 0.00167)
deltaT &lt;- .1 # timestep length
n_steps &lt;- 15 # must be a number greater than 1
# Define the number of iterations
tourism_iter &lt;- 1000

## Step 3: Compute MCMC estimate
tourism_out &lt;- mcmc_estimate(
 model = tourism_model,
 data = parks,
 parameters = tourism_param,
 mode = "de",
 initial_condition = tourism_init, deltaT = deltaT,
 n_steps = n_steps,
 iterations = tourism_iter)

## Step 4: Analyze results
mcmc_analyze(
 model = tourism_model,
 data = parks,
 mcmc_out = tourism_out,
 mode = "de",
 initial_condition = tourism_init, deltaT = deltaT,
 n_steps = n_steps
)


</code></pre>

<hr>
<h2 id='mcmc_estimate'>Markov Chain parameter estimates</h2><span id='topic+mcmc_estimate'></span>

<h3>Description</h3>

<p><code>mcmc_estimate</code> Computes and Markov Chain Monte Carlo parameter estimate for a given model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc_estimate(
  model,
  data,
  parameters,
  iterations = 1,
  knob_flag = FALSE,
  mode = "emp",
  initial_condition = NULL,
  deltaT = NULL,
  n_steps = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mcmc_estimate_+3A_model">model</code></td>
<td>
<p>the model equations that we use to compute the result.</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_data">data</code></td>
<td>
<p>the data used to assess the model</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_parameters">parameters</code></td>
<td>
<p>a data frame that lists the names of the parameters along with upper and lower bounds</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_iterations">iterations</code></td>
<td>
<p>the number of iterations we wish to run the MCMC for.</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_knob_flag">knob_flag</code></td>
<td>
<p>determines if we tune the range that can be search (annealing)</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_mode">mode</code></td>
<td>
<p>two choices: emp &ndash;&gt; empirical (default) or de &ndash;&gt; differential equations. The estimator works differently depending on which is used.</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_initial_condition">initial_condition</code></td>
<td>
<p>The initial condition for the differential equation (DE mode only)</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_deltat">deltaT</code></td>
<td>
<p>The length between timesteps (DE mode only)</p>
</td></tr>
<tr><td><code id="mcmc_estimate_+3A_n_steps">n_steps</code></td>
<td>
<p>The number of time steps we run the model (DE mode only)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe: the first column is the accept flag  of the mcmc run (TRUE/FALSE), the log likelihood, and the parameter values
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mcmc_analyze">mcmc_analyze</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

## Example with an empirical model:
## Step 1: Define the model and parameters
phos_model &lt;- daphnia ~ c * algae^(1 / theta)

phos_param &lt;- tibble::tibble( name = c("c", "theta"),
lower_bound = c(0, 1),
upper_bound = c(2, 20))

## Step 2: Determine MCMC settings
# Define the number of iterations
phos_iter &lt;- 1000

## Step 3: Compute MCMC estimate
phos_mcmc &lt;- mcmc_estimate(model = phos_model,
data = phosphorous,
parameters = phos_param,
iterations = phos_iter)

## Example with a differential equation:
## Step 1: Define the model, parameters, and data
## Define the tourism model
tourism_model &lt;- c(dRdt ~ resources * (1 - resources) - a * visitors,
dVdt ~ b * visitors * (resources - visitors))

# Define the parameters that you will use with their bounds
tourism_param &lt;- tibble::tibble( name = c("a", "b"),
lower_bound = c(10, 0),
upper_bound = c(30, 5))

## Step 2: Determine MCMC settings
# Define the initial conditions
tourism_init &lt;- c(resources = 0.995, visitors = 0.00167)
deltaT &lt;- .1 # timestep length
n_steps &lt;- 15 # must be a number greater than 1
# Define the number of iterations
tourism_iter &lt;- 1000

## Step 3: Compute MCMC estimate
tourism_out &lt;- mcmc_estimate(
 model = tourism_model,
 data = parks,
  parameters = tourism_param,
 mode = "de",
  initial_condition = tourism_init, deltaT = deltaT,
 n_steps = n_steps,
  iterations = tourism_iter)



</code></pre>

<hr>
<h2 id='parks'>Visitor and resource usage to a national park</h2><span id='topic+parks'></span>

<h3>Description</h3>

<p>A dataset containing scaled visitor usage to a national park. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(parks)
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows and 3 variables
</p>


<h3>Details</h3>


<ul>
<li><p> time. (days)
</p>
</li>
<li><p> visitors. number of visitors to a national parked, scaled by the equilibrium value.
</p>
</li>
<li><p> resources. scaled area of the reserve not deforested.
</p>
</li></ul>



<h3>Source</h3>

<p>Sinay, Laura, and Leon Sinay. 2006. “A Simple Mathematical Model for the Effects of the Growth of Tourism on Environment.” In International Tourism Conference. Alanya, Turkey.
</p>

<hr>
<h2 id='phaseplane'>Phase plane of differential equation.</h2><span id='topic+phaseplane'></span>

<h3>Description</h3>

<p><code>phaseplane</code> visualizes the vector field for a one or two dimensional differential equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phaseplane(
  system_eq,
  x_var,
  y_var,
  parameters = NULL,
  x_window = c(-4, 4),
  y_window = c(-4, 4),
  plot_points = 10,
  eq_soln = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phaseplane_+3A_system_eq">system_eq</code></td>
<td>
<p>(required) The 1 or 2 dimensional system of equations, written in formula notation as a vector (i.e.  c(dx ~ f(x,y), dy ~ g(x,y)))</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_x_var">x_var</code></td>
<td>
<p>(required) x axis variable (used to create the plot and label axes)</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_y_var">y_var</code></td>
<td>
<p>(required) y axis variable (used to create the plot and label axes)</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_parameters">parameters</code></td>
<td>
<p>(optional) any parameters in the system of equations</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_x_window">x_window</code></td>
<td>
<p>(optional) x axis limits.  Must be of the form c(minVal,maxVal).  Defaults to -4 to 4.</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_y_window">y_window</code></td>
<td>
<p>(optional) y axis limits.  Must be of the form c(minVal,maxVal). Defaults to -4 to 4.</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_plot_points">plot_points</code></td>
<td>
<p>(optional) number of points we evaluate on the grid in both directions. Defaults to 10.</p>
</td></tr>
<tr><td><code id="phaseplane_+3A_eq_soln">eq_soln</code></td>
<td>
<p>(optional) TRUE / FALSE - lets you know if you want the code to estimate if there are any equilibrium solutions in the provided window. This will print out the equilibrium solutions to the console.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A phase plane diagram of system of differential equations
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For a two variable system of differential equations we use the
# formula notation for dx/dt and the dy/dt separately:
system_eq &lt;- c(dx ~ cos(y),
              dy ~ sin(x))
phaseplane(system_eq,x_var='x',y_var='y')

# For a one dimensional system: dy/dt = f(t,y).  In this case the
# xWindow represents time.
# However, the code is structured a little differently.
# Consider dy/dt = -y*(1-y):

system_eq &lt;- c(dt ~ 1,
               dy ~ -y*(1-y))

 phaseplane(system_eq,x_var="t",y_var="y")

# Here is an example to find equilibrium solutions.

 system_eq &lt;- c(dx ~ y+x,
               dy ~ x-y)

 phaseplane(system_eq,x_var='x',y_var='y',eq_soln=TRUE)

# We would expect an equilibrium at the origin,
# but no equilibrium solution was found, but if we narrow the search range:

 phaseplane(system_eq,x_var='x',y_var='y',x_window = c(-0.1,0.1),y_window=c(-0.1,0.1),eq_soln=TRUE)

# Confirm any equilbrium solutions through direct evaluation of the differential equation.



</code></pre>

<hr>
<h2 id='phosphorous'>Measured phosphorous of Daphnia and algae</h2><span id='topic+phosphorous'></span>

<h3>Description</h3>

<p>A dataset containing phosphorous content in Daphnia and algae. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(phosphorous)
</code></pre>


<h3>Format</h3>

<p>A data frame with 6 rows and 2 variables
</p>


<h3>Details</h3>


<ul>
<li><p> algae. Phosphorous content in algal food (%)
</p>
</li>
<li><p> daphnia. Phosphorous content in <em>Daphnia</em> (%)
</p>
</li></ul>



<h3>Source</h3>

<p>The data were digitized from Sterner and Elser <em>Ecological Stoichiometry</em>, page 22, Figure 1.9A.  The original study was DeMott et. al (1998) <em>Limnol. Oceanogr</em>. 44:1557.
</p>

<hr>
<h2 id='precipitation'>Measured precipitation from a rainfall event</h2><span id='topic+precipitation'></span>

<h3>Description</h3>

<p>A dataset containing measured precipitation data from the Minneapolis St. Paul Area:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(precipitation)
</code></pre>


<h3>Format</h3>

<p>A data frame with 56 rows and 5 variables
</p>


<h3>Details</h3>


<ul>
<li><p> date. Calendar day of year of measurement
</p>
</li>
<li><p> time. Time measurement is made
</p>
</li>
<li><p> station_id Shorthand name for station in CoCoRaHS network
</p>
</li>
<li><p> station_name Name of station in CoCoRaHS network
</p>
</li>
<li><p> precip. Observed precipitation (inches)
</p>
</li></ul>



<h3>Source</h3>

<p>The data were collected from Community Collaborative Rain Hail and Snow Network (CoCoRaHS). <a href="https://www.cocorahs.org/ViewData/ListDailyPrecipReports.aspx">https://www.cocorahs.org/ViewData/ListDailyPrecipReports.aspx</a>
</p>

<hr>
<h2 id='rk4'>Runge Kutta method solution for a differential equation.</h2><span id='topic+rk4'></span>

<h3>Description</h3>

<p><code>rk4</code> solves a multi-dimensional differential equation with Runge-Kutta 4th order method.  The parameters listed as required are needed
See the vignette for detailed examples of usage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rk4(
  system_eq,
  initial_condition,
  parameters = NULL,
  t_start = 0,
  deltaT = 1,
  n_steps = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rk4_+3A_system_eq">system_eq</code></td>
<td>
<p>(REQUIRED) The 1 or 2 dimensional system of equations, written in formula notation as a vector (i.e.  c(dx ~ f(x,y), dy ~ g(x,y)))</p>
</td></tr>
<tr><td><code id="rk4_+3A_initial_condition">initial_condition</code></td>
<td>
<p>(REQUIRED) Listing of initial conditions, as a vector</p>
</td></tr>
<tr><td><code id="rk4_+3A_parameters">parameters</code></td>
<td>
<p>The values of the parameters we are using (optional)</p>
</td></tr>
<tr><td><code id="rk4_+3A_t_start">t_start</code></td>
<td>
<p>The starting time point (defaults to t = 0)</p>
</td></tr>
<tr><td><code id="rk4_+3A_deltat">deltaT</code></td>
<td>
<p>The timestep length (defaults to 1)</p>
</td></tr>
<tr><td><code id="rk4_+3A_n_steps">n_steps</code></td>
<td>
<p>The number of timesteps to compute solution (defaults to n_steps = 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tidy of data frame for the calculated solutions and the time
</p>


<h3>See Also</h3>

<p>See <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">Runge Kutta methods</a> for more explanation of Runge-Kutta methods, as well as the code <code><a href="#topic+euler">euler</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Define the rate equation:
quarantine_eq &lt;- c(
 dSdt ~ -k * S * I,
 dIdt ~ k * S * I - beta * I
)
# Define the parameters (as a named vector):
quarantine_parameters &lt;- c(k = .05, beta = .2)
# Define the initial condition (as a named vector):
quarantine_init &lt;- c(S = 300, I = 1)
# Define deltaT and the number of time steps:
deltaT &lt;- .1 # timestep length
n_steps &lt;- 10 # must be a number greater than 1
# Compute the solution via Euler's method:
out_solution &lt;- rk4(system_eq = quarantine_eq,
                   parameters = quarantine_parameters,
                   initial_condition = quarantine_init, deltaT = deltaT,
                   n_steps = n_steps
)
</code></pre>

<hr>
<h2 id='snowfall'>Measured snowfall from a blizzard in April 2018</h2><span id='topic+snowfall'></span>

<h3>Description</h3>

<p>A dataset containing measured snowfall data from the Minneapolis St. Paul Area:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(snowfall)
</code></pre>


<h3>Format</h3>

<p>A data frame with 16 rows and 5 variables
</p>


<h3>Details</h3>


<ul>
<li><p> date. Calendar day of year of measurement
</p>
</li>
<li><p> time. Time measurement is made
</p>
</li>
<li><p> station_id Shorthand name for station in CoCoRaHS network
</p>
</li>
<li><p> station_name Name of station in CoCoRaHS network
</p>
</li>
<li><p> snowfall total snowfall (inches)
</p>
</li></ul>



<h3>Source</h3>

<p>The data were collected from Community Collaborative Rain Hail and Snow Network (CoCoRaHS). <a href="https://www.cocorahs.org/ViewData/ListDailyPrecipReports.aspx">https://www.cocorahs.org/ViewData/ListDailyPrecipReports.aspx</a>
</p>

<hr>
<h2 id='wilson'>Measured Weight of a dog over time</h2><span id='topic+wilson'></span>

<h3>Description</h3>

<p>A dataset containing the mass of a growing dog.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wilson)
</code></pre>


<h3>Format</h3>

<p>A data frame with 19 rows and 2 variables
</p>


<h3>Details</h3>


<ul>
<li><p> days since birth
</p>
</li>
<li><p> weight. (pounds)
</p>
</li></ul>



<h3>Source</h3>

<p>From <a href="https://bscheng.com/2014/05/07/modeling-logistic-growth-data-in-r/">https://bscheng.com/2014/05/07/modeling-logistic-growth-data-in-r/</a>
</p>

<hr>
<h2 id='yeast'>Measured Sacchromyces data (yeast) from Gause 1932 &quot;Experimental studies on the struggle for coexistence&quot;</h2><span id='topic+yeast'></span>

<h3>Description</h3>

<p>A dataset containing measurements of growth of yeast in a culture. The variables are as follows:
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(yeast)
</code></pre>


<h3>Format</h3>

<p>A data frame with 7 rows and 2 variables
</p>


<h3>Details</h3>


<ul>
<li><p> time. (hours)
</p>
</li>
<li><p> volume. Sacchromyces volume in container (cubic centimeters)
</p>
</li></ul>



<h3>Source</h3>

<p>Table 1 from Gause, G. F. 1932. “Experimental Studies on the Struggle for Existence: I. Mixed Population of Two Species of Yeast.” Journal of Experimental Biology 9 (4): 389–402.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
