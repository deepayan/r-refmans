<!DOCTYPE html><html lang="en"><head><title>Help for package astroFns</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {astroFns}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#astroFns-package'>
<p>Astronomy: Time and Position Functions, Misc. Utilities</p></a></li>
<li><a href='#angSep'><p>Angular separation of two sky positions</p></a></li>
<li><a href='#b2j'>
<p>B1950 to J2000 coordinate conversion</p></a></li>
<li><a href='#beamDiskOverlap'><p>Gaussian beam and disk overlap with shift</p></a></li>
<li><a href='#dmjd2ut'>
<p>DMJD to UT</p></a></li>
<li><a href='#dms2rad'>
<p>Degrees, minutes, and seconds to radians</p></a></li>
<li><a href='#elev'><p> Source elevation</p></a></li>
<li><a href='#gmst1'><p> GMST1 (Greenwich Mean Siderial Time at 0h, UT1) from UT1 date</p></a></li>
<li><a href='#hms2rad'>
<p>Hours, minutes, and seconds to radians</p></a></li>
<li><a href='#j2b'>
<p>J2000 to B1950 coordinate converstion</p></a></li>
<li><a href='#jd2ymd'>
<p>JD to year, month, date</p></a></li>
<li><a href='#planetFlux'>
<p>Flux density from a thermal disk</p></a></li>
<li><a href='#rad2dms'>
<p>Convert radians to degrees, minutes, and seconds</p></a></li>
<li><a href='#rad2hms'>
<p>Convert radians to hours, minutes, and seconds</p></a></li>
<li><a href='#ut2dmjd'>
<p>UT to DMJD</p></a></li>
<li><a href='#ut2lst'>
<p>Universal time to local sidereal time or hour angle</p></a></li>
<li><a href='#ymd2jd'>
<p>Year, month, day to 0h on Julian day</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Astronomy: Time and Position Functions, Misc. Utilities</td>
</tr>
<tr>
<td>Version:</td>
<td>4.2-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Harris</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Harris &lt;harris@astro.umd.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Miscellaneous astronomy functions, utilities, and data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-08 16:37:01 UTC; Andy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-08 17:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='astroFns-package'>
Astronomy: Time and Position Functions, Misc. Utilities
</h2><span id='topic+astroFns-package'></span><span id='topic+astroFns'></span>

<h3>Description</h3>

<p>Collection of time, position, and utility functions for astronomy:
Julian and Modified Julian Day transformations, J2000/B1950 coordinate
transformations, GMST at 0h from UT, UT to LST and hour angle, angular
unit transformations and distance, etc.  Precision generally at the
level of a millisecond in time for JD, 0.1 s for LST, and a few tenths
of an arcsecond in position for B2000-J1950 and vice versa.
Additional functions include flux from
thermal disk-shaped source, and others.  Functions were originally assembled
to support single-dish radio astronomy planning and observations.
Cosmology-related functions are in the <code>cosmoFns</code> package.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> astroFns</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 4.2-0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-05-08</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2) </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Andrew Harris
Maintainer: Andrew Harris &lt;harris@astro.umd.edu&gt;
</p>

<hr>
<h2 id='angSep'>Angular separation of two sky positions</h2><span id='topic+angSep'></span>

<h3>Description</h3>

<p><code>angSep</code> calculates the angular separation of two sky positions
using spherical trigonometry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>angSep(ra1, dec1, ra2, dec2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="angSep_+3A_ra1">ra1</code></td>
<td>
<p>Right ascention (string) of the first position.</p>
</td></tr>
<tr><td><code id="angSep_+3A_dec1">dec1</code></td>
<td>
<p>Declination of (string) the first position.</p>
</td></tr>
<tr><td><code id="angSep_+3A_ra2">ra2</code></td>
<td>
<p>Right ascention (string) the second position.</p>
</td></tr>
<tr><td><code id="angSep_+3A_dec2">dec2</code></td>
<td>
<p>Declination of (string) the second position.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Enter positions as text strings with fields separated by characters d,
h, m, s, a colon, or a comma, e.g. '17, 42, 28', '-28h43m03s', or
'- 28 :43 : 3'.
Spaces are removed in input conversion.
This is a
spherical trigonometry calculation, valid for small and large distances.
</p>


<h3>Value</h3>

<p>Returns angluar separation in decimal degrees.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code> for input conversions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>angSep('1, 59, 03', '-3, 40, 44', '2, 30', '5, 40, 03')
angSep('1h59m03s', '-3d40m44s', '2h30', '5h40m03')
angSep('1', '0', '2', '0')
angSep('   1,  40,  4', '  -  5, 6', '3', '1')
</code></pre>

<hr>
<h2 id='b2j'>
B1950 to J2000 coordinate conversion
</h2><span id='topic+b2j'></span>

<h3>Description</h3>

<p>Precession from B1950 to J2000
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b2j(ra = "17h42m29.3076s", dec = "-28d59m18.484s")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="b2j_+3A_ra">ra</code></td>
<td>
<p>B1950 Right ascention (string)</p>
</td></tr>
<tr><td><code id="b2j_+3A_dec">dec</code></td>
<td>
<p>B1950 Declination (string)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Enter positions as text strings with fields separated by characters d,
h, m, s, a colon, or a comma, e.g. '17, 42, 28', '-28h43m03s', or '- 28
:43 : 3'.
Spaces are removed in input conversion.
Trailing missing values are taken as zero.  The code uses an
approximate formula for precession; spot checks give results accurate
within a few tenths of an arcsecond.
</p>


<h3>Value</h3>

<p>List with strings in:
</p>
<table role = "presentation">
<tr><td><code>ra2000</code></td>
<td>
<p>J2000 Right ascension</p>
</td></tr>
<tr><td><code>dec2000</code></td>
<td>
<p>J2000 Declination</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Calculation based on power-law expansion of exact function.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Explanatory supplement to the Astronomical
Almanac, Seidelmann (ed.), c.~1992, chapter 3.213
</p>


<h3>See Also</h3>

<p><code><a href="#topic+j2b">j2b</a></code>.  See <code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code>
for input conversions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b2j()
b2j(ra='17, 43', dec='-28, 47, 30')
b2j(ra='17, 43', dec=' -  28,  47, 30')
b2j(ra='17h43m', dec='-28d47m30s')
tmp &lt;- b2j(ra='17, 43', dec=' -  28,  47, 30')
str(tmp)
tmp
</code></pre>

<hr>
<h2 id='beamDiskOverlap'>Gaussian beam and disk overlap with shift
</h2><span id='topic+beamDiskOverlap'></span>

<h3>Description</h3>

<p>Calculate the overlap integral of a 2-D Gaussian beam and a uniform
disk, including a shift between the centers of the beam and disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beamDiskOverlap(s = 0, r = 1, theta.fwhm = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="beamDiskOverlap_+3A_s">s</code></td>
<td>
<p>Shift between centers</p>
</td></tr>
<tr><td><code id="beamDiskOverlap_+3A_r">r</code></td>
<td>
<p>Disk radius</p>
</td></tr>
<tr><td><code id="beamDiskOverlap_+3A_theta.fwhm">theta.fwhm</code></td>
<td>
<p>Gaussian beam FWHM</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Converts the 2-D integral to 1-D for speed.  Use consistent units.
</p>


<h3>Value</h3>

<p>Value of the overlap integral, normalized to unity for a beam much
smaller than the disk.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>&quot;Telescope illumination and beam measurements for submillimeter
astrononomy,&quot; A.I. Harris, Internat. J. IR and mm Waves, 9, 231 (1988)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>s &lt;- seq(0, 10, 0.1)
plot(s, beamDiskOverlap(s, 4, 1), t='l', col=4)
</code></pre>

<hr>
<h2 id='dmjd2ut'>
DMJD to UT
</h2><span id='topic+dmjd2ut'></span>

<h3>Description</h3>

<p>Decimal modified Julian date to Universal time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dmjd2ut(dmjd, tz='UTC')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dmjd2ut_+3A_dmjd">dmjd</code></td>
<td>
<p>Time in decimal Modified Julian Date</p>
</td></tr>
<tr><td><code id="dmjd2ut_+3A_tz">tz</code></td>
<td>
<p>Time zone string</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculation is always from UTC, but it is possible to correct to local time
zone with <code>tz</code> (see <code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code>).  For instance, <code>tz = 'EST5EDT'</code>
converts to U.S. Eastern time, with EST or EDT based on the system's knowledge
of the date for switching between the two.  Set the number of digits
after the decimal place for seconds, <code>n</code>, with
<code>options('digits.secs'=n)</code>.
</p>


<h3>Value</h3>

<p>Time string with class POSIXct
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ut2dmjd">ut2dmjd</a></code>, <code><a href="#topic+ymd2jd">ymd2jd</a></code>,
<code><a href="base.html#topic+strptime">strptime</a></code>, <code><a href="base.html#topic+ISOdatetime">ISOdatetime</a></code>,
<code><a href="graphics.html#topic+axis.POSIXct">axis.POSIXct</a></code> for time in plot axes;
<code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code> to recover time in plot from <code>locator()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dmjd2ut(56951.54183613)

sd &lt;- getOption('digits.secs')
dmjd2ut(ut2dmjd(2010, 1, 5, 2, 34, 17.8115))
options('digits.secs' = 3)
dmjd2ut(ut2dmjd(2015, 1, 5, 2, 34, 17.8115))
options('digits.secs' = sd)

dmjd2ut(ut2dmjd(2015, 1, 5, 2, 34, 17.8115), tz='CET')
dmjd2ut(ut2dmjd(2015, 8, 5, 2, 34, 17.8115), tz='CET')
dmjd2ut(ut2dmjd(2015, 1, 5, 2, 34, 17.8115), tz='EST5EDT')
dmjd2ut(ut2dmjd(2015, 8, 5, 2, 34, 17.8115), tz='EST5EDT')

dmjd2ut(ymd2jd(2001, 1, 1) - 2400000.5)
</code></pre>

<hr>
<h2 id='dms2rad'>
Degrees, minutes, and seconds to radians
</h2><span id='topic+dms2rad'></span>

<h3>Description</h3>

<p>Angular conversion from degrees, minutes, and seconds to radians
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dms2rad(d = '33d 09m 35.0s')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dms2rad_+3A_d">d</code></td>
<td>
<p>String containing degrees, minutes, and seconds</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function reads a string (the input is a string to allow
conversion of angles between -1 and zero degrees) with degrees,
minutes, and seconds separated by any of characters d, m, s, a colon,
or a comma.  Spaces are not valid separators, as they are removed as
part of input parsing.  Decimal values are allowed in any position.
Zeros are the default if values for minutes or seconds are missing
from the string. A minus sign, W, or w before the degrees indicates
negative degrees.  Positive degrees are denoted by no character, +, E,
or e before the degrees values.</p>


<h3>Value</h3>

<p> Angle in radians </p>


<h3>Author(s)</h3>

<p> Andrew Harris </p>


<h3>See Also</h3>

 <p><code><a href="#topic+hms2rad">hms2rad</a></code>, <code><a href="#topic+rad2dms">rad2dms</a></code>,
<code><a href="#topic+rad2hms">rad2hms</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>dms2rad('10, 22, 14')
dms2rad('10:22:14')
dms2rad('10d22m14s')
dms2rad('-0, 30')
dms2rad('-77d30.5m')
dms2rad('W 77d30.5m')
dms2rad(-77.5083333)
</code></pre>

<hr>
<h2 id='elev'> Source elevation </h2><span id='topic+elev'></span><span id='topic+azimuth'></span>

<h3>Description</h3>

<p>Calculates source elevation and azimuth in degrees given declination, hour angle, and
observatory latitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elev(dec.sou = "33d 09m 35.0s", ha = 0, lat.obs = "38d 25m 59.2s")

azimuth(dec.sou = "33d 09m 35.0s", ha = 0, lat.obs = "38d 25m 59.2s")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elev_+3A_dec.sou">dec.sou</code></td>
<td>
<p>Source declination (string)</p>
</td></tr>
<tr><td><code id="elev_+3A_ha">ha</code></td>
<td>
<p>Hour angle (decimal hours)</p>
</td></tr>
<tr><td><code id="elev_+3A_lat.obs">lat.obs</code></td>
<td>
<p>Observatory latitude (string)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Enter latitude as s text string with fields separated by characters d,
h, m, s, a colon, or a comma, e.g. '38d25m59.2s' or '38, 25, 59.2' or
'38:25:59.2' or '38:25.987' for
the Green Bank Telescope.
Spaces are removed in input conversion.
Decimal values for degrees or minutes are allowed.
Trailing missing values are taken as zero.
</p>


<h3>Value</h3>

<p>Source elevation or azimuth (E from N) in degrees.
</p>


<h3>Note</h3>

<p>Geometrical calculation only, no corrections for refraction,
aberration, precession, etc.</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>&quot;Astrophysical Formulae,&quot; K.R. Lang, Springer c. 1986, 5-45</p>


<h3>See Also</h3>

<p><code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code> for input formats,
<code><a href="#topic+ut2ha">ut2ha</a></code> to convert UT to hour angle.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Maximum elevation at Green Bank
elev(dms2rad('-28, 20'))

# Maximum elevation at Mauna Kea
elev(dms2rad('-28, 20'), 0, '19:49')

# Plot elevation and azimugh vs. hour angle
ha &lt;- seq(0, 24, 0.25)
el &lt;- elev('30d 33m 22s', ha)
plot(ha, el, t='l', col=4)
az &lt;- azimuth('30d 33m 22s', ha)
plot(ha, az, t='l', col=4)

# Plot elevation and azimuth vs. UT (using many defaults)
h.ut &lt;-  seq(0, 24, 0.25)
el &lt;- elev(dec.sou='30d 33m 22s', ha=ut2ha(hr=h.ut))
plot(h.ut, el, t='l', col=4)
az &lt;- azimuth(dec.sou='30d 33m 22s', ha=ut2ha(hr=h.ut))
plot(h.ut, az, t='l', col=4)


</code></pre>

<hr>
<h2 id='gmst1'> GMST1 (Greenwich Mean Siderial Time at 0h, UT1) from UT1 date</h2><span id='topic+gmst1'></span>

<h3>Description</h3>

<p>Calculate Greenwich Mean Siderial Time at 0h, UT1 (GMST1) from UT1
year, month, and day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gmst1(yr = 2012, mo = 1, dy = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gmst1_+3A_yr">yr</code></td>
<td>
<p>UT1 year (integer)</p>
</td></tr>
<tr><td><code id="gmst1_+3A_mo">mo</code></td>
<td>
<p>UT1 month (integer)</p>
</td></tr>
<tr><td><code id="gmst1_+3A_dy">dy</code></td>
<td>
<p>UT1 day (integer) </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function calculates Greenwich Mean Siderial Time at 0h, UT1 (GMST1) given UT1
year, month, and day.
</p>


<h3>Value</h3>

<p>Returns fractional hours of GMST1 with class fracHrs.  The
corresponding print method gives hh:mm:ss format rounded to <code>n</code> decimal
places in seconds by setting <code>options('digits.secs'=n)</code>.
</p>


<h3>Note</h3>

<p>Multiply UT1 fractional day by
1.002737909350795 to get fractional sidereal day.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Explanatory Supplement to the Astronomical Almanac
Seidelmann (ed), c. 1992</p>


<h3>See Also</h3>

 <p><code><a href="#topic+ymd2jd">ymd2jd</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  out &lt;- gmst1(yr=2012, mo=7, dy=8)
  str(out)
  out
</code></pre>

<hr>
<h2 id='hms2rad'>
Hours, minutes, and seconds to radians
</h2><span id='topic+hms2rad'></span>

<h3>Description</h3>

<p>Angular conversion from hours, minutes, and seconds to radians.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hms2rad(h = '12h 3m 45.6s')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="hms2rad_+3A_h">h</code></td>
<td>
<p>String hours, minutes, and seconds</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function reads a string (the input is a string to allow
conversion of angles between -1 and zero hours) with hours, minutes,
and seconds separated by any of characters d, m, s, a colon, or a
comma.  Spaces are not valid separators, as they are removed as part
of input parsing.  Zeros are the default if values for minutes or
seconds are missing from the string.  A minus sign before the hours
indicates negative hours.  Decimal values are allowed in any
position. </p>


<h3>Value</h3>

<p>Angle in radians.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+rad2hms">rad2hms</a></code>, <code><a href="#topic+rad2dms">rad2dms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>hms2rad('10, 22, 14')
hms2rad('-0:30')
hms2rad('0h30')
</code></pre>

<hr>
<h2 id='j2b'>
J2000 to B1950 coordinate converstion
</h2><span id='topic+j2b'></span>

<h3>Description</h3>

<p>Precession from J1950 to B2000
</p>


<h3>Usage</h3>

<pre><code class='language-R'>j2b(ra = "17:30:30", dec = "-28:47")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="j2b_+3A_ra">ra</code></td>
<td>
<p>J2000 Right ascention (string)</p>
</td></tr>
<tr><td><code id="j2b_+3A_dec">dec</code></td>
<td>
<p>J2000 Declination (string)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Enter positions as text strings with fields separated by characters d,
h, m, s, a colon, or a comma, e.g. '17, 42, 28', '-28h43m03s', or '- 28
:43 : 3'.
Spaces are removed in input conversion.
Trailing missing values are taken as zero.  The code uses an
approximate formula for precession; spot checks give results accurate
within a few tenths of an arcsecond.
</p>


<h3>Value</h3>

<p>List with strings in:
</p>
<table role = "presentation">
<tr><td><code>ra1950</code></td>
<td>
<p>B1950 Right ascension</p>
</td></tr>
<tr><td><code>dec1950</code></td>
<td>
<p>B1950 Declination</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Values based on power-law expansion of more exact calculation.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Explanatory supplement to the Astronomical
Almanac, Seidelmann (ed.), c.~1992, chapter 3.213
</p>


<h3>See Also</h3>

<p><code><a href="#topic+b2j">b2j</a></code>.  See <code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code> for input conversions.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>j2b()
j2b(ra='17h43m', dec='-28d47m30s')
tmp &lt;- j2b(ra='17, 43', dec=' -  28,  47, 30')
str(tmp)
tmp
</code></pre>

<hr>
<h2 id='jd2ymd'>
JD to year, month, date
</h2><span id='topic+jd2ymd'></span>

<h3>Description</h3>

<p>Convert Julian date to UT1 year, month, and date.
</p>


<h3>Value</h3>

<p>Date for 0h, UT1, with class POSIXct
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Fliegel &amp; Van Flandern, Comm. ACM 10, 657 (1968), whose algorithm
uses FORTRAN integer mathematics
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+weekdays">weekdays</a></code>, <code><a href="#topic+dmjd2ut">dmjd2ut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>jd2ymd(2456092.5) # returns 0h date, 2012-06-14 UT
jd2ymd(2456092.6) # returns 0h date, 2012-06-14 UT
jd2ymd(2456092.4) # returns 0h date, 2012-06-13 UT
</code></pre>

<hr>
<h2 id='planetFlux'>
Flux density from a thermal disk
</h2><span id='topic+planetFlux'></span>

<h3>Description</h3>

<p>The flux density from a disk-shaped blackbody with uniform temperature
observed in a Gaussian beam.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>planetFlux(T = 195, dp = 14.8, thetab = 19.4, f = 32)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="planetFlux_+3A_t">T</code></td>
<td>
<p>Disk's physical temperature</p>
</td></tr>
<tr><td><code id="planetFlux_+3A_dp">dp</code></td>
<td>
<p>Planet diameter, arcsec</p>
</td></tr>
<tr><td><code id="planetFlux_+3A_thetab">thetab</code></td>
<td>
<p>Beam FWHM, arcsec</p>
</td></tr>
<tr><td><code id="planetFlux_+3A_f">f</code></td>
<td>
<p>Observing frequency, GHz</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Geometry is for a uniform-temperature disk, a planet to some
approximation, in a Gaussian beam.
</p>


<h3>Value</h3>

<p>Flux density in janskys
</p>


<h3>Note</h3>

<p>For a physical Mars model, see &lt;http://www.aoc.nrao.edu/~bbutler/work/mars/model/&gt;</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>Examples</h3>

<pre><code class='language-R'>planetFlux()
</code></pre>

<hr>
<h2 id='rad2dms'>
Convert radians to degrees, minutes, and seconds
</h2><span id='topic+rad2dms'></span>

<h3>Description</h3>

<p>Angular conversion from radians to degrees, minutes, and seconds
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rad2dms(rad = 1, places = 2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rad2dms_+3A_rad">rad</code></td>
<td>
<p>Decimal radians</p>
</td></tr>
<tr><td><code id="rad2dms_+3A_places">places</code></td>
<td>
<p>Number of decimal places in seconds term (0:6)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Convert radians to degrees, minutes, and seconds.
</p>


<h3>Value</h3>

<p>Fixed-format string with sign, then degrees, minutes, and seconds separated by colons.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rad2hms">rad2hms</a></code>, <code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rad2dms(2.44)
rad2dms(dms2rad(c('-1,4,5.12', '10:04: 5.3')), places=3)
rad2dms(-66.5 * pi/180) # from degrees to dms
</code></pre>

<hr>
<h2 id='rad2hms'>
Convert radians to hours, minutes, and seconds
</h2><span id='topic+rad2hms'></span>

<h3>Description</h3>

<p>Angular conversion from radians to hours, minutes, and seconds
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rad2hms(rad = 1, places = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rad2hms_+3A_rad">rad</code></td>
<td>
<p>Decimal radians</p>
</td></tr>
<tr><td><code id="rad2hms_+3A_places">places</code></td>
<td>
<p>Number of decimal places in seconds term (0:6)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fixed-format string with hours, minutes, and seconds separated by colons.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+rad2dms">rad2dms</a></code>, <code><a href="#topic+dms2rad">dms2rad</a></code>, <code><a href="#topic+hms2rad">hms2rad</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rad2hms(2.44)
rad2hms(hms2rad(c('10:04:5.12', '27,04,5.3', '-3:0:0')), places=3)
rad2hms(266.5 * pi/180) # from degrees to hms
</code></pre>

<hr>
<h2 id='ut2dmjd'>
UT to DMJD
</h2><span id='topic+ut2dmjd'></span>

<h3>Description</h3>

<p>Universal time to decimal modified Julian date.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ut2dmjd(yr = 2012, mo = 1, dy = 1, hr = 0, mi = 0, se = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ut2dmjd_+3A_yr">yr</code></td>
<td>
<p>UT year</p>
</td></tr>
<tr><td><code id="ut2dmjd_+3A_mo">mo</code></td>
<td>
<p>UT month</p>
</td></tr>
<tr><td><code id="ut2dmjd_+3A_dy">dy</code></td>
<td>
<p>UT day</p>
</td></tr>
<tr><td><code id="ut2dmjd_+3A_hr">hr</code></td>
<td>
<p>UT hour</p>
</td></tr>
<tr><td><code id="ut2dmjd_+3A_mi">mi</code></td>
<td>
<p>UT minute</p>
</td></tr>
<tr><td><code id="ut2dmjd_+3A_se">se</code></td>
<td>
<p>UT second</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Decimal modified Julian date.
</p>


<h3>Note</h3>

<p>Uses <code><a href="#topic+ymd2jd">ymd2jd</a></code> to calculate Julian date</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dmjd2ut">dmjd2ut</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ut2dmjd(yr=2000, mo=1, dy=1, hr=0, mi=0, se=0)
format(ut2dmjd(yr=2012, mo=5, dy=20, hr=7, mi=8, se=39), digits=10)
</code></pre>

<hr>
<h2 id='ut2lst'>
Universal time to local sidereal time or hour angle
</h2><span id='topic+ut2lst'></span><span id='topic+ut2ha'></span>

<h3>Description</h3>

<p>Functions to calculate local sidereal time (LST) or hour angle (HA) from
Universal time (strictly, UTC1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ut2lst(yr = 2012, mo = 1, dy = 1, hr = 0, mi = 0, se = 0,
lon.obs = "W 79d 50.5m")

ut2ha(yr = 2012, mo = 1, dy = 1, hr = 0, mi = 0, se = 0,
ra.sou = "13h 31m 08.3s", lon.obs = "W 79d 50m 23.4s")

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ut2lst_+3A_yr">yr</code></td>
<td>
<p>UT1 Year</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_mo">mo</code></td>
<td>
<p>UT1 Month number</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_dy">dy</code></td>
<td>
<p>UT1 Day number</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_hr">hr</code></td>
<td>
<p>UT1 Hour</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_mi">mi</code></td>
<td>
<p>UT1 Minute</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_se">se</code></td>
<td>
<p>UT1 Seconds</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_ra.sou">ra.sou</code></td>
<td>
<p>String with source Right Ascension</p>
</td></tr>
<tr><td><code id="ut2lst_+3A_lon.obs">lon.obs</code></td>
<td>
<p>String with observatory longitude</p>
</td></tr>
</table>


<h3>Details</h3>

<p> If this input is <code>hr = Sys.time()</code> the function uses system time,
including conversion to UT.  UT is within a few seconds of UT1.  </p>


<h3>Value</h3>

<p> Returns decimal local sidereal time in range 0 to 24 hours and
hour angle from -1 to 12 hours, with class <code>fracHrs</code> (prints as
h:m:s).  For elapsed siderial time difference over multiple sidereal
days, difference UT days (from e.g. <code><a href="#topic+ut2dmjd">ut2dmjd</a></code>) and
multiply by 1.002737909350795.  </p>


<h3>Note</h3>

<p>Spot checks show values match tabulated values in The Astronomical Almanac
within ~0.01 seconds.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Greenwich mean sidereal time (GMST) at 0h UT1 from the &quot;Explanatory
Supplement to the Astronomical Almanac, &quot; Seidelmann (ed), c. 1992.
Approximate equation of the equinoxes from
http://aa.usno.navy.mil/faq/docs/GAST.php.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ymd2jd">ymd2jd</a></code>, <code><a href="#topic+gmst1">gmst1</a></code>, <code><a href="#topic+dms2rad">dms2rad</a></code> and
<code><a href="#topic+hms2rad">hms2rad</a></code> for input formats, <code><a href="base.html#topic+Sys.time">Sys.time</a></code>,
<code><a href="base.html#topic+Sys.timezone">Sys.timezone</a></code> and time zone examples in <code><a href="base.html#topic+as.POSIXlt">as.POSIXlt</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># LST at UT1 midnight on the first of every month for Green Bank, WV, USA
midLST &lt;- ut2lst(yr = 2012, mo = 1:12, dy = 1, hr = 0, mi = 0, se = 0,
                 lon.obs="W 79d 50.5m")
str(midLST)
midLST

# LST at EST midnight on the first of every month for Green Bank, WV, USA
# (EST = UT1-5 hours)
midLST &lt;- ut2lst(yr = 2012, mo = 1:12, dy = 1, hr = -5, mi = 0, se = 0,
                 lon.obs="W 79d 50.5m")
str(midLST)
midLST

# LST in Green Bank, WV, USA, now, and 12 hours from now.
ut2lst(Sys.time())
ut2lst(Sys.time() + 12*3600)

# Hour angle of 3C286 in Green Bank now (using function defaults)
ut2ha(Sys.time())

</code></pre>

<hr>
<h2 id='ymd2jd'>
Year, month, day to 0h on Julian day
</h2><span id='topic+ymd2jd'></span>

<h3>Description</h3>

<p>Convert year, month, day to 0h on Julian day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ymd2jd(yr = 2012, mo = 1, dy = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ymd2jd_+3A_yr">yr</code></td>
<td>
<p>UT1 Year</p>
</td></tr>
<tr><td><code id="ymd2jd_+3A_mo">mo</code></td>
<td>
<p>UT1 Month number</p>
</td></tr>
<tr><td><code id="ymd2jd_+3A_dy">dy</code></td>
<td>
<p>UT1 Day number</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns Julian date of 0 hours on the specified day.  To get to noon
on day, the time origin of Julian days, add 0.5.
</p>


<h3>Value</h3>

<p>Julian date
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Fliegel &amp; Van Flandern, Comm. ACM 10, 657 (1968), whose algorithm
uses FORTRAN integer mathematics.  See also the Explanatory Supplement
to the Astronomical Almanac, ed. P.K. Seidelmann, c. 1992.
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+weekdays">weekdays</a></code>, <code><a href="#topic+ut2dmjd">ut2dmjd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Ensure enough digits to see result, then return to previous value
dig &lt;- getOption('digits')
options(digits=16)
ymd2jd(yr=2000, mo=1, dy=1)
ymd2jd(yr=2000, mo=1, dy=1.3)  # rounds to nearest day
options(digits=dig)
jd2ymd(ymd2jd(yr=2000, mo=1, dy=1))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
