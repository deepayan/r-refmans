<!DOCTYPE html><html><head><title>Help for package esDesign</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {esDesign}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#AED.boundary'><p>Calculate the critical value used at the final analysis in AED</p></a></li>
<li><a href='#AED.sim'><p>Conduct the simulation studies of the Adaptive Enrichment Design without</p>
early stopping boundary</a></li>
<li><a href='#AED1_SSR.boundary'><p>Calculate the critical value used at the final analysis of the</p>
Adaptive Enrichment Design (Strategy 1) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED1_SSR.CP'><p>Calculate the conditional power of the Adaptive Enrichment Design with</p>
(Strategy 1) Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED1_SSR.N2'><p>Calculate the sample size required at the second stage of the adaptive</p>
enrichment design (Strategy1) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED1_SSR.sim'><p>Conduct the simulation studies of the Adaptive Enrichment Design</p>
(Strategy 1) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED2_SSR.boundary'><p>Calculate the futility and efficacy stopping boundaries of the Adaptive</p>
Enrichment Design (Strategy 2) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED2_SSR.CP'><p>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in the Adaptive</p>
Enrichment Design (Strategy 2) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED2_SSR.sim'><p>Conduct the simulation studies of the Adaptive Enrichment Design (Strategy 2)</p>
with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED3_SSR.boundary'><p>Calculate the futility and efficacy stopping boundaries in Adaptive</p>
enrichment design (Strategy 3) with Sample Size Re-estimation Procedure
for the continuous endpoint</a></li>
<li><a href='#AED3_SSR.CP'><p>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in the Adaptive</p>
Enrichment Design (Strategy 3) with Sample Size Re-estimation Procedure</a></li>
<li><a href='#AED3_SSR.sim'><p>Conduct the simulation studies of the Adaptive Enrichment Design</p>
(Strategy 3) with Sample Size Re-estimation Procedure based on
Futility and Efficacy Stopping Boundaries for the continuous
endpoint</a></li>
<li><a href='#MaST.sim'><p>Conduct the simulation studies of the Marker Sequential Test design</p></a></li>
<li><a href='#SD.sim'><p>Conduct the simulation studies of the standard design</p></a></li>
<li><a href='#SigP'><p>Commonly used <code class="reqn">\alpha</code>-spending functions</p></a></li>
<li><a href='#sSize.norm'><p>Sample size calculation for the standard design with continuous endpoint</p></a></li>
<li><a href='#SSR.boundary'><p>Calculate the futility and efficacy stopping boundaries for Sample Size</p>
Re-estimation Procedure based on the conditional error function</a></li>
<li><a href='#SSR.CP'><p>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in Sample Size</p>
Re-estimation Procedure</a></li>
<li><a href='#SSR.sim'><p>Conduct the simulation studies using SSR</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Adaptive Enrichment Designs with Sample Size Re-Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-07-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Zhao Yang, Ruitao Lin, Guosheng Yin and Ying Yuan</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Zhao Yang &lt;yangz98@connect.hku.hk&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Software of 'esDesign' is developed to implement the adaptive 
    enrichment designs with sample size re-estimation presented in 
    Lin et al. (2021) &lt;<a href="https://doi.org/10.1016%2Fj.cct.2020.106216">doi:10.1016/j.cct.2020.106216</a>&gt;. In details, 
    three-proposed trial designs are provided, including the AED1-SSR (or ES1-SSR),
    AED2-SSR (or ES2-SSR) and AED3-SSR (or ES3-SSR). In addition, this package 
    also contains several widely used adaptive designs, such as the Marker 
    Sequential Test (MaST) design proposed Freidlin et al. 
    (2014) &lt;<a href="https://doi.org/10.1177%2F1740774513503739">doi:10.1177/1740774513503739</a>&gt;, the adaptive enrichment designs 
    without early stopping (AED or ES), the sample size re-estimation 
    procedure (SSR) based on the conditional power proposed by 
    Proschan and Hunsberger (1995), and some useful functions. 
    In details, we can calculate the futility and/or efficacy stopping 
    boundaries, the sample size required, calibrate the value of the threshold 
    of the difference between subgroup-specific test statistics, conduct the 
    simulation studies in AED, SSR, AED1-SSR, AED2-SSR and AED3-SSR.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>false</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-07-13 05:38:25 UTC; Yang Zhao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-07-13 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='AED.boundary'>Calculate the critical value used at the final analysis in AED</h2><span id='topic+AED.boundary'></span>

<h3>Description</h3>

<p><code>AED.boundary()</code> is used to calculate the critical value
used at the final analysis in AED design, meanwhile preserving the overall
type I error rate at <code class="reqn">\alpha</code> level
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED.boundary(rho, alpha, Info, epsilon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED.boundary_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED.boundary_+3A_alpha">alpha</code></td>
<td>
<p>The overall type I error rate</p>
</td></tr>
<tr><td><code id="AED.boundary_+3A_info">Info</code></td>
<td>
<p>The infromation fraction</p>
</td></tr>
<tr><td><code id="AED.boundary_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of difference between the subgroup-specific test
statistics</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The critical value used at the final analysis
</p>


<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>AED.boundary(rho = 0.5, alpha = 0.05, Info = 0.5, epsilon = 0.5)
</code></pre>

<hr>
<h2 id='AED.sim'>Conduct the simulation studies of the Adaptive Enrichment Design without
early stopping boundary</h2><span id='topic+AED.sim'></span>

<h3>Description</h3>

<p>The <code>AED.sim()</code> is used to conduct the simulation studies
of the Adaptive Enrichment Design without early stopping boundary. The AED
design is quite similar with the AED1_SSR design. But, in the AED design,
the futility stopping boundary and the Sample Size Re-estimation Procedure
are removed. On the contrary, a fixed sample size is used to replace the
sample size re-estimated procedure. In addition, an <code class="reqn">\epsilon</code>-rule is
also introduced to select the subgroup with larger subgroup-specific test
statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED.sim(
  N1,
  N2,
  rho,
  alpha,
  beta,
  theta,
  theta0,
  K,
  Info,
  epsilon,
  sigma0,
  nSim,
  Seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED.sim_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_n2">N2</code></td>
<td>
<p>The sample size used at the second stage</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of the subgroup 1</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_beta">beta</code></td>
<td>
<p>The (1 - Power)</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effects in subgroups 1 and 2 among the
experimental arm</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect in standard arm</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_k">K</code></td>
<td>
<p>The number of subgroups</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_info">Info</code></td>
<td>
<p>The observed information</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of difference between the subgroup-specific test
statistics</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="AED.sim_+3A_seed">Seed</code></td>
<td>
<p>The random Seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average expected sample size
</p>
</li>
<li><p> H00 The probability of rejecting the null hypothesis of <code class="reqn">H_{00}</code>
</p>
</li>
<li><p> H01 The probability of rejecting the null hypothesis of <code class="reqn">H_{01}</code>
</p>
</li>
<li><p> H02 The probability of rejecting the null hypothesis of <code class="reqn">H_{02}</code>
</p>
</li>
<li><p> H0  The probabilities of rejecting at least one of the null hypothesis
</p>
</li>
<li><p> Enrich01 The prevalence of adaptive enrichment of subgroup 1
</p>
</li>
<li><p> Enrich02 The prevalence of adaptive enrichment of subgroup 2
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N1 &lt;- 310
N2 &lt;- 310
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.20
theta &lt;- c(0,0)
theta0 &lt;- 0
K &lt;- 2
Info &lt;- 0.5
epsilon &lt;- 0.5
sigma0 &lt;- 1
nSim &lt;- 1000
Seed &lt;- 6
AED.sim(N1 = N1, N2 = N2, rho = rho, alpha = alpha,
        beta = beta, theta = theta, theta0 = theta0,
        K  = K, Info = Info, epsilon = epsilon,
        sigma0 = sigma0, nSim = nSim, Seed = Seed)
</code></pre>

<hr>
<h2 id='AED1_SSR.boundary'>Calculate the critical value used at the final analysis of the
Adaptive Enrichment Design (Strategy 1) with Sample Size Re-estimation Procedure</h2><span id='topic+AED1_SSR.boundary'></span>

<h3>Description</h3>

<p>The <code>AED1_SSR.boundary()</code> is used to calculate the critical
value required at the final analysis of the Adaptive Enrichment Design
(Strategy 1) with sample size
re-estimation procedure. In the AED1-SSR design, the adaptive enrichment
strategy is guided by a pre-specified futility stopping boundary and a
threshold of the difference between the subgroup-specific test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED1_SSR.boundary(rho, alpha, pstar, Info, epsilon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED1_SSR.boundary_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1.</p>
</td></tr>
<tr><td><code id="AED1_SSR.boundary_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate.</p>
</td></tr>
<tr><td><code id="AED1_SSR.boundary_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED1_SSR.boundary_+3A_info">Info</code></td>
<td>
<p>The observation information, which is commonly calculated through
the sample size used at each stage of the trial.</p>
</td></tr>
<tr><td><code id="AED1_SSR.boundary_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of the difference between subgroup-specific test
statistics.</p>
</td></tr>
</table>


<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>AED1_SSR.boundary(rho = 0.5, alpha = 0.05, pstar = 0.2, Info = 0.5, epsilon = 0.5)
</code></pre>

<hr>
<h2 id='AED1_SSR.CP'>Calculate the conditional power of the Adaptive Enrichment Design with
(Strategy 1) Sample Size Re-estimation Procedure</h2><span id='topic+AED1_SSR.CP'></span>

<h3>Description</h3>

<p>The <code>AED1_SSR.CP()</code> is used to calculate the conditional
power of the Adaptive Enrichment Design (Strategy 1) with sample size
re-estimation procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED1_SSR.CP(c, Z1, N1, N2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED1_SSR.CP_+3A_c">c</code></td>
<td>
<p>The critical value used at the final analysis</p>
</td></tr>
<tr><td><code id="AED1_SSR.CP_+3A_z1">Z1</code></td>
<td>
<p>The test statistic obtained at the interim analysis</p>
</td></tr>
<tr><td><code id="AED1_SSR.CP_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED1_SSR.CP_+3A_n2">N2</code></td>
<td>
<p>The sample size used at the second stage</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> Critical.Value The critical value used at the final analysis
</p>
</li>
<li><p> Conditional.Power The value of conditional power given the observed data
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>c &lt;- 2.258
Z1 &lt;- 1.975
N1 &lt;- 248
N2 &lt;- 200
AED1_SSR.CP(c = 2.258, Z1 = 1.974, N1 = 248, N2 = 200)
</code></pre>

<hr>
<h2 id='AED1_SSR.N2'>Calculate the sample size required at the second stage of the adaptive
enrichment design (Strategy1) with Sample Size Re-estimation Procedure</h2><span id='topic+AED1_SSR.N2'></span>

<h3>Description</h3>

<p>The <code>AED1_SSR.N2()</code> is used to calculated the sample size
required at the second stage of the Adaptive Enrichment Design (Strategy 1)
with Sample Size Re-estimation Procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED1_SSR.N2(c, z1, N1, beta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED1_SSR.N2_+3A_c">c</code></td>
<td>
<p>The critical value used at the final analysis</p>
</td></tr>
<tr><td><code id="AED1_SSR.N2_+3A_z1">z1</code></td>
<td>
<p>The test statistic obtained at the interim analysis</p>
</td></tr>
<tr><td><code id="AED1_SSR.N2_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED1_SSR.N2_+3A_beta">beta</code></td>
<td>
<p>The (1 - power)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The Value of the re-estimated sample size
</p>


<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>c &lt;- 2.258
z1 &lt;- 1.974
N1 &lt;- 248
beta &lt;- 0.2
AED1_SSR.N2(c = c, z1 = z1, N1 = N1, beta = beta)

</code></pre>

<hr>
<h2 id='AED1_SSR.sim'>Conduct the simulation studies of the Adaptive Enrichment Design
(Strategy 1) with Sample Size Re-estimation Procedure</h2><span id='topic+AED1_SSR.sim'></span>

<h3>Description</h3>

<p>The <code>AED1_SSR.sim()</code> is used to conduct the simulation study
of the Adaptive Enrichment Design (Strategy 1) with Sample Size Re-estimation
procedure
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED1_SSR.sim(
  N1,
  rho,
  alpha,
  beta,
  pstar,
  theta,
  theta0,
  Info,
  K = 2,
  epsilon,
  sigma0,
  nSim,
  Seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED1_SSR.sim_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1 among the overall patients</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_beta">beta</code></td>
<td>
<p>The (1 - Power)</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of the treatment effect in subgroups 1 and 2 with the
experimental arm</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of the treatment effect in standard arm</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_info">Info</code></td>
<td>
<p>The observation information</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_k">K</code></td>
<td>
<p>The number of subgroups. The default value is <code>K = 2</code></p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of the difference between the subgroup-specific
test statistic</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="AED1_SSR.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average expected sample size
</p>
</li>
<li><p> H00 The probability of rejecting the null hypothesis of <code class="reqn">H_{00}</code>
</p>
</li>
<li><p> H01 The probability of rejecting the null hypothesis of <code class="reqn">H_{01}</code>
</p>
</li>
<li><p> H02 The probability of rejecting the null hypothesis of <code class="reqn">H_{02}</code>
</p>
</li>
<li><p> H0  The probabilities of rejecting at least one of the null hypothesis
</p>
</li>
<li><p> ESF The probability of early stopping for futility
</p>
</li>
<li><p> ESE The probability of early stopping for efficacy
</p>
</li>
<li><p> Enrich01 The prevalence of adaptive enrichment of subgroup 1
</p>
</li>
<li><p> Enrich02 The prevalence of adaptive enrichment of subgroup 2
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Lin, R., Yang, Z., Yuan, Y. and Yin, G., 2021. Sample size re-estimation
in adaptive enrichment design. Contemporary Clinical Trials, 100, p.106216.
&lt;doi: 10.1016/j.cct.2020.106216&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>res &lt;- AED1_SSR.sim(
  N1 = 310, rho = 0.5,
  alpha = 0.05, beta = 0.2, pstar = 0.2,
  theta = c(0,0), theta0 = 0, Info = 0.5,
  epsilon = 0.5, sigma0 = 1, nSim = 1000, Seed = 6)
</code></pre>

<hr>
<h2 id='AED2_SSR.boundary'>Calculate the futility and efficacy stopping boundaries of the Adaptive
Enrichment Design (Strategy 2) with Sample Size Re-estimation Procedure</h2><span id='topic+AED2_SSR.boundary'></span>

<h3>Description</h3>

<p>The <code>AED2_SSR.boundary()</code> is used to calculate the futility
and efficacy stopping boundaries of the Adaptive Enrichment Design (strategy 2)
with Sample Size Re-estimation Procedure. In the AED2-SSR design, an
<code class="reqn">\epsilon</code>-rule is introduced to select the subgroup with larger test
statistic. In practice, the value of <code class="reqn">\epsilon</code> should be calibrated to
fit the requirement of the trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED2_SSR.boundary(rho, alpha, pstar, epsilon)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED2_SSR.boundary_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED2_SSR.boundary_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED2_SSR.boundary_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED2_SSR.boundary_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of difference between the subgroup-specific test
statistics</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> upper.boundary The upper and efficacy stopping boundary
</p>
</li>
<li><p> lower.boundary The lower and futility stopping boundary
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- 0.5
alpha &lt;- 0.05
pstar &lt;- 0.15
epsilon &lt;- 0.5
AED2_SSR.boundary(rho = rho, alpha = alpha, pstar = pstar, epsilon = epsilon)
</code></pre>

<hr>
<h2 id='AED2_SSR.CP'>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in the Adaptive
Enrichment Design (Strategy 2) with Sample Size Re-estimation Procedure</h2><span id='topic+AED2_SSR.CP'></span>

<h3>Description</h3>

<p>The <code>AED2_SSR.CP()</code> is used to calculate the sample size required
at the second stage and the critical value used at the final analysis in the
Adaptive Enrichment Design with Sample Size Re-estimation Procedure. In
addition, this function can also used to conduct the conditional power
analysis in terms of <code class="reqn">N2</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED2_SSR.CP(
  Z1 = NULL,
  delta = NULL,
  N1 = NULL,
  pstar,
  rho,
  epsilon,
  alpha,
  beta,
  N2 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED2_SSR.CP_+3A_z1">Z1</code></td>
<td>
<p>The test statistic obtained at the interim analysis</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_delta">delta</code></td>
<td>
<p>The standardized size of treatment effect, which can be estimated
by using <code class="reqn">(\mu_{X} - \mu_{Y})/\sqrt{\sigma^2}</code>.</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of the difference between subgroup-specific test
statistics.</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 - Power)</code></p>
</td></tr>
<tr><td><code id="AED2_SSR.CP_+3A_n2">N2</code></td>
<td>
<p>The pre-specified sample size used at the second stage, which is used
to conduct the conditional power analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> upper.boundary The efficacy stopping boundary
</p>
</li>
<li><p> lower.boundary The futility stopping boundary
</p>
</li>
<li><p> N2 The pre-specified sample size used at the second stage, which is
used to implement the conditional power analysis
</p>
</li>
<li><p> Conditional.Power The value of conditional power given the value of <code>N2</code> in the
conditional power analysis
</p>
</li>
<li><p> P.Value The corresponding P-Value used at the final analysis in the conditional
power analysis
</p>
</li>
<li><p> N2.CP The re-estimated sample size of <code>N2</code> to ensure an adequate
conditional power
</p>
</li>
<li><p> c.CP The estimated the critical value used at the final analysis based
the conditional power
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>Z1 &lt;- 1.974
delta &lt;- 0.355
N1 &lt;- 248
pstar &lt;- 0.15
alpha &lt;- 0.05
rho &lt;- 0.5
epsilon &lt;- 0.5
beta &lt;- 0.20
N2 &lt;- 104
res &lt;- AED2_SSR.CP(Z1 = Z1, delta = delta, N1 = N1, pstar = pstar,
           alpha = alpha, rho = rho, epsilon = epsilon,
           beta = beta, N2 = N2)

</code></pre>

<hr>
<h2 id='AED2_SSR.sim'>Conduct the simulation studies of the Adaptive Enrichment Design (Strategy 2)
with Sample Size Re-estimation Procedure</h2><span id='topic+AED2_SSR.sim'></span>

<h3>Description</h3>

<p>The <code>AED2_SSR.sim()</code> is used to conduct the simulation studies
of the Adaptive Enrichment Design (Strategy) with sample size re-estimation
procedure. The AED2-SSR is different from the AED3-SSR, in which an
<code class="reqn">\epsilon</code>-rule is introduced to select the subgroup with larger
subgroup-specific test statistic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED2_SSR.sim(
  N1,
  rho,
  alpha,
  beta,
  pstar,
  theta,
  theta0,
  sigma0,
  epsilon,
  nSim,
  Seed
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED2_SSR.sim_+3A_n1">N1</code></td>
<td>
<p>The sample size used in the first stage</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_beta">beta</code></td>
<td>
<p>The (1 - power)</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effect in subgroups 1 and 2 with the
experimental treatment</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect with the standard treatment</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_epsilon">epsilon</code></td>
<td>
<p>The threshold of the difference between subgroup-specific test
statistics</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="AED2_SSR.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average expected sample size
</p>
</li>
<li><p> H00 The probability of rejecting the null hypothesis of <code class="reqn">H_{00}</code>
</p>
</li>
<li><p> H01 The probability of rejecting the null hypothesis of <code class="reqn">H_{01}</code>
</p>
</li>
<li><p> H02 The probability of rejecting the null hypothesis of <code class="reqn">H_{02}</code>
</p>
</li>
<li><p> H0  The probabilities of rejecting at least one of the null hypothesis
</p>
</li>
<li><p> ESF The probability of early stopping for futility
</p>
</li>
<li><p> ESE The probability of early stopping for efficacy
</p>
</li>
<li><p> Enrich01 The prevalence of adaptive enrichment of subgroup 1
</p>
</li>
<li><p> Enrich02 The prevalence of adaptive enrichment of subgroup 2
</p>
</li>
<li><p> Trigger03 The prevalence of no enrichment
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 310
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.2
theta &lt;- c(0,0)
theta0 &lt;- 0
sigma0 &lt;- 1
epsilon &lt;- 0.5
pstar &lt;- 0.20
nSim &lt;- 1000
Seed &lt;- 6
res &lt;- AED2_SSR.sim(N1 = N, rho = rho, alpha = alpha,
             beta = beta, theta = theta, theta0 = theta0,
             sigma0 = sigma0, pstar = pstar, epsilon = epsilon,
             nSim = nSim, Seed = Seed)
</code></pre>

<hr>
<h2 id='AED3_SSR.boundary'>Calculate the futility and efficacy stopping boundaries in Adaptive
enrichment design (Strategy 3) with Sample Size Re-estimation Procedure
for the continuous endpoint</h2><span id='topic+AED3_SSR.boundary'></span>

<h3>Description</h3>

<p>The <code>AED3_SSR.boundary()</code> is used to calculate the futility
and efficacy stopping boundaries in the Adaptive Enrichment Design with
Sample Size Re-estimation Procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED3_SSR.boundary(rho, alpha, pstar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED3_SSR.boundary_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED3_SSR.boundary_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED3_SSR.boundary_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> upper.boundary The upper or the efficacy stopping boundary
</p>
</li>
<li><p> lower.boundary The lower or the futility stopping boundary
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>rho &lt;- 0.5
alpha &lt;- 0.05
pstar &lt;- 0.15
res &lt;- AED3_SSR.boundary(rho = rho, alpha = alpha, pstar = pstar)
</code></pre>

<hr>
<h2 id='AED3_SSR.CP'>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in the Adaptive
Enrichment Design (Strategy 3) with Sample Size Re-estimation Procedure</h2><span id='topic+AED3_SSR.CP'></span>

<h3>Description</h3>

<p>The <code>AED3_SSR.CP()</code> is used to calculate the sample size required
at the second stage and the critical value used at the final analysis in the
Adaptive Enrichment Design with Sample Size Re-estimation Procedure. In
addition, this function can also used to conduct the conditional power
analysis in terms of <code class="reqn">N2</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED3_SSR.CP(
  Z1 = NULL,
  delta = NULL,
  N1 = NULL,
  pstar,
  rho,
  alpha,
  beta,
  N2 = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED3_SSR.CP_+3A_z1">Z1</code></td>
<td>
<p>The test statistic obtained at the interim analysis</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_delta">delta</code></td>
<td>
<p>The standardized size of treatment effect, which can be estimated
by using <code class="reqn">(\mu_{X} - \mu_{Y})/\sqrt{\sigma^2}</code>.</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 - Power)</code></p>
</td></tr>
<tr><td><code id="AED3_SSR.CP_+3A_n2">N2</code></td>
<td>
<p>The pre-specified sample size used at the second stage, which is used
to conduct the conditional power analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> N2 The pre-specified sample size used at the second stage, which is
used to implement the conditional power analysis
</p>
</li>
<li><p> Conditional.Power The value of conditional power given the value of <code>N2</code> in the
conditional power analysis
</p>
</li>
<li><p> P.Value The corresponding P-Value used at the final analysis in the conditional
power analysis
</p>
</li>
<li><p> N2.CP The re-estimated sample size of <code>N2</code> to ensure an adequate
conditional power
</p>
</li>
<li><p> c.CP The estimated the critical value used at the final analysis based
the conditional power
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>Z1 &lt;- 1.974
delta &lt;- 0.355
N1 &lt;- 248
pstar &lt;- 0.15
alpha &lt;- 0.05
rho &lt;- 0.5
beta &lt;- 0.20
N2 &lt;- 108
AED3_SSR.CP(Z1 = Z1, delta = delta, N1 = N1, pstar = pstar,
           alpha = alpha, rho = rho, beta = beta, N2 = N2)

</code></pre>

<hr>
<h2 id='AED3_SSR.sim'>Conduct the simulation studies of the Adaptive Enrichment Design
(Strategy 3) with Sample Size Re-estimation Procedure based on
Futility and Efficacy Stopping Boundaries for the continuous
endpoint</h2><span id='topic+AED3_SSR.sim'></span>

<h3>Description</h3>

<p>The <code>AED3_SSR.sim()</code> is used to conduct the adaptive enrichment
design with Sample Size Re-estimation, in which futility and efficacy stopping
boundaries are used to guide the adaptive enrichment process. For the
adaptively enriched subgroup, we re-estimate the sample size to maintain an
adequate conditional power meanwhile protect the overall Type I error rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AED3_SSR.sim(N1, rho, alpha, beta, theta, theta0, sigma0, pstar, nSim, Seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="AED3_SSR.sim_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1 among the overall patients</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 - Power)</code></p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effect in subgroups 1 and 2 with experimental treatment</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect in standard treatment</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The known variance of the treatment effect</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies.</p>
</td></tr>
<tr><td><code id="AED3_SSR.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average expected sample size
</p>
</li>
<li><p> H00 The probability of rejecting the null hypothesis of <code class="reqn">H_{00}</code>
</p>
</li>
<li><p> H01 The probability of rejecting the null hypothesis of <code class="reqn">H_{01}</code>
</p>
</li>
<li><p> H02 The probability of rejecting the null hypothesis of <code class="reqn">H_{02}</code>
</p>
</li>
<li><p> H0  The probabilities of rejecting at least one of the null hypothesis
</p>
</li>
<li><p> Enrich01 The prevalence of adaptive enrichment of subgroup 1
</p>
</li>
<li><p> Enrich02 The prevalence of adaptive enrichment of subgroup 2
</p>
</li>
<li><p> Trigger03 The prevalence of early stopping for the situation, in which
the treatment effect in subgroup 1 is superiority, while the treatment
effect in subgroup 2 is inconclusive
</p>
</li>
<li><p> Trigger04 The prevalence of early stopping for the situation, in which
the treatment effect in subgroup 2 is superiority, while the treatment
effect in subgroup 2 is inconclusive
</p>
</li>
<li><p> ESF The probability of early stopping for futility
</p>
</li>
<li><p> ESE The probability of early stopping for efficacy
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 310
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.2
theta &lt;- c(0,0)
theta0 &lt;- 0
sigma0 &lt;- 1
pstar &lt;- 0.20
nSim &lt;- 100
Seed &lt;- 6
res &lt;- AED3_SSR.sim(N1 = N, rho = rho, alpha = alpha,
             beta = beta, theta = theta, theta0 = theta0,
             sigma0 = sigma0, pstar = pstar, nSim = nSim,
             Seed = Seed)
</code></pre>

<hr>
<h2 id='MaST.sim'>Conduct the simulation studies of the Marker Sequential Test design</h2><span id='topic+MaST.sim'></span>

<h3>Description</h3>

<p>The <code>MaST.sim()</code> is used to conduct the simulation studies
of the marker sequential test design (MaST).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MaST.sim(N, rho, alpha, beta, theta, theta0, sigma0, nSim, Seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MaST.sim_+3A_n">N</code></td>
<td>
<p>The total sample size used at the trial</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1 among the overall patients</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_beta">beta</code></td>
<td>
<p>The (1 - Power)</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effect in subgroups 1 and 2 with the
experimental arm</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect in the standard arm</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="MaST.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average expected sample size
</p>
</li>
<li><p> H00 The probability of rejecting the null hypothesis of <code class="reqn">H_{00}</code>
</p>
</li>
<li><p> H01 The probability of rejecting the null hypothesis of <code class="reqn">H_{01}</code>
</p>
</li>
<li><p> H02 The probability of rejecting the null hypothesis of <code class="reqn">H_{02}</code>
</p>
</li>
<li><p> H0  The probabilities of rejecting at least one of the null hypothesis
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Freidlin, B., Korn, E. L., and Gray, R. (2014). Marker sequential
test (MaST) design. Clinical trials, 11(1), 19-27. &lt;doi:10.1177/1740774513503739&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 310
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.20
theta &lt;- c(0,0)
theta0 &lt;- 0
sigma0 &lt;- 1
nSim &lt;- 1000
Seed &lt;- 6
MaST.sim(N = N, rho = rho, alpha = alpha, beta = beta,
         theta = theta, theta0 = theta0, sigma0 = sigma0,
         nSim = nSim, Seed = Seed)
</code></pre>

<hr>
<h2 id='SD.sim'>Conduct the simulation studies of the standard design</h2><span id='topic+SD.sim'></span>

<h3>Description</h3>

<p>The <code>SD.sim()</code> is used to implement the simulation studies
of the standard design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SD.sim(N, rho, alpha, beta, theta, theta0, sigma0, nSim, Seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SD.sim_+3A_n">N</code></td>
<td>
<p>The total sample size required</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 -Power)</code></p>
</td></tr>
<tr><td><code id="SD.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effects for subgroups 1 and 2 in experimental arm</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect for the control arm</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="SD.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains,
</p>

<ul>
<li><p> nTotal the total sample used
</p>
</li>
<li><p> The power of the specified trial. Here, the power is defined as the
probability of rejecting the null hypothesis.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 620
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.2
theta &lt;- c(0.2,0.0)
theta0 &lt;- 0
sigma0 &lt;- 1
nSim &lt;- 1000
Seed &lt;- 6
SD.sim(N = N, rho = rho,
       alpha = alpha, beta = beta, theta = theta, theta0 = theta0,
       sigma0 = sigma0, nSim = nSim, Seed = Seed)

</code></pre>

<hr>
<h2 id='SigP'>Commonly used <code class="reqn">\alpha</code>-spending functions</h2><span id='topic+SigP'></span>

<h3>Description</h3>

<p>The <code>SigP()</code> is used to calculate the reduced significant
level based on several widely used <code class="reqn">\alpha</code>-spending functions, such as
the &quot;Pocock&quot;, &quot;Lan-DeMets&quot;, &quot;O'Brein-Fleming&quot; and &quot;Power&quot; functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SigP(alpha, Info, esFunction = "Pocock", gamma = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SigP_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="SigP_+3A_info">Info</code></td>
<td>
<p>The fraction of the observed information</p>
</td></tr>
<tr><td><code id="SigP_+3A_esfunction">esFunction</code></td>
<td>
<p>The specific <code class="reqn">\alpha</code>-spending function. For example,
<code>esFunction = "Pocock"</code> for the Pocock method,
<code>esFunction = "LD"</code> for the Lan-Demets method,
<code>esFunction = "OF"</code> for the O'Brein-Fleming method, and
<code>esFunction = "Power"</code> for the Power method.</p>
</td></tr>
<tr><td><code id="SigP_+3A_gamma">gamma</code></td>
<td>
<p>The parameter used in the Power method. The default value is
<code>gamma = 1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The reduced significant level
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
Info &lt;- 0.5
esFunction = "OF"
SigP(alpha = alpha, Info = Info, esFunction = esFunction)
</code></pre>

<hr>
<h2 id='sSize.norm'>Sample size calculation for the standard design with continuous endpoint</h2><span id='topic+sSize.norm'></span>

<h3>Description</h3>

<p>The <code>sSize.norm()</code> is used to calculate the sample size
used in the standard design with continuous endpoint.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sSize.norm(alpha, beta, theta, side, r, sigma2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sSize.norm_+3A_alpha">alpha</code></td>
<td>
<p>The Type I error rate or the significant level</p>
</td></tr>
<tr><td><code id="sSize.norm_+3A_beta">beta</code></td>
<td>
<p>beta The <code>(1 -Power)</code></p>
</td></tr>
<tr><td><code id="sSize.norm_+3A_theta">theta</code></td>
<td>
<p>The size of treatment effect</p>
</td></tr>
<tr><td><code id="sSize.norm_+3A_side">side</code></td>
<td>
<p>One-sided or two-sided Test</p>
</td></tr>
<tr><td><code id="sSize.norm_+3A_r">r</code></td>
<td>
<p>The ratio of sample size between the experimental and control arms</p>
</td></tr>
<tr><td><code id="sSize.norm_+3A_sigma2">sigma2</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains the total sample size, and the sample sizes required
for the experimental and control arms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
beta &lt;- 0.2
theta &lt;- 0.2
side &lt;- 1
r &lt;- 1
sigma2 &lt;- 0.8
sSize.norm(alpha = alpha, beta = beta, theta = theta,
side = side, r = r, sigma2 = sigma2)

</code></pre>

<hr>
<h2 id='SSR.boundary'>Calculate the futility and efficacy stopping boundaries for Sample Size
Re-estimation Procedure based on the conditional error function</h2><span id='topic+SSR.boundary'></span>

<h3>Description</h3>

<p>The <code>SSD.boundary()</code> is used to calculate the futility
and efficacy stopping boundaries, meanwhile protect the overall Type I
error rate at the pre-specified level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSR.boundary(alpha, pstar)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSR.boundary_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="SSR.boundary_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contain
</p>

<ul>
<li><p> upper.boundary The efficacy stopping boundary at the interim analysis
</p>
</li>
<li><p> lower.boundary The futility stopping boundary at the interim analysis
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Proschan MA, Hunsberger SA. Designed extension of studies based on
conditional power. Biometrics 1995:1315-24. &lt;doi:10.2307/2533262&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>alpha &lt;- 0.05
pstar &lt;- 0.2
res &lt;- SSR.boundary(alpha = alpha, pstar = pstar)

</code></pre>

<hr>
<h2 id='SSR.CP'>Calculate the <code class="reqn">N2</code> and the critical value <code class="reqn">C</code> in Sample Size
Re-estimation Procedure</h2><span id='topic+SSR.CP'></span>

<h3>Description</h3>

<p>The <code>SSR.CP()</code> is used to calculate the sample size required
at the second stage and the critical value used at the final analysis. In
addition, this function can also used to conduct the conditional power
analysis in terms of <code class="reqn">N2</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSR.CP(Z1 = NULL, delta = NULL, N1 = NULL, pstar, alpha, beta, N2 = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSR.CP_+3A_z1">Z1</code></td>
<td>
<p>The test statistic obtained at the interim analysis</p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_delta">delta</code></td>
<td>
<p>The standardized size of treatment effect, which can be estimated
by using <code class="reqn">(\mu_{X} - \mu_{Y})/\sqrt{\sigma^2}</code>.</p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_n1">N1</code></td>
<td>
<p>The sample size used at the first stage</p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 - Power)</code></p>
</td></tr>
<tr><td><code id="SSR.CP_+3A_n2">N2</code></td>
<td>
<p>The pre-specified sample size used at the second stage, which is used
to conduct the conditional power analysis</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> N2 The pre-specified sample size used at the second stage, which is
used to implement the conditional power analysis
</p>
</li>
<li><p> Conditional.Power The value of conditional power given the value of <code>N2</code> in the
conditional power analysis
</p>
</li>
<li><p> P.Value The corresponding P-Value used at the final analysis in the conditional
power analysis
</p>
</li>
<li><p> N2.CP The re-estimated sample size of <code>N2</code> to ensure an adequate
conditional power
</p>
</li>
<li><p> c.CP The estimated the critical value used at the final analysis based
the conditional power
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Proschan MA, Hunsberger SA. Designed extension of studies based on
conditional power. Biometrics 1995:1315-1324. &lt;doi:10.2307/2533262&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>Z1 &lt;- 1.527
delta &lt;- 0.137
N1 &lt;- 248
pstar &lt;- 0.15
alpha &lt;- 0.05
beta &lt;- 0.2
res &lt;- SSR.CP(Z1 = Z1, delta = delta, N1 = N1,
       pstar = pstar, alpha = alpha, beta = beta)

</code></pre>

<hr>
<h2 id='SSR.sim'>Conduct the simulation studies using SSR</h2><span id='topic+SSR.sim'></span>

<h3>Description</h3>

<p>The <code>SSR.sim()</code> is used to implement the simulation studies
based on the Sample Size Re-estimation Procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SSR.sim(N, rho, alpha, beta, theta, theta0, sigma0, pstar, nSim, Seed)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SSR.sim_+3A_n">N</code></td>
<td>
<p>The sample size used at the first stage. Note that this <code>N</code> is
not the initial total sample size calculated using the standard design</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_rho">rho</code></td>
<td>
<p>The proportion of subgroup 1</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_alpha">alpha</code></td>
<td>
<p>The overall Type I error rate</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_beta">beta</code></td>
<td>
<p>The <code>(1 - Power)</code></p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_theta">theta</code></td>
<td>
<p>The sizes of treatment effects for subgroups 1 and 2 in the
experimental arm</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_theta0">theta0</code></td>
<td>
<p>The size of treatment effect in the control arm</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_sigma0">sigma0</code></td>
<td>
<p>The variance of the treatment effect</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_pstar">pstar</code></td>
<td>
<p>The <code>(1 - power)</code> of accepting the null hypothesis at the
interim analysis.</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_nsim">nSim</code></td>
<td>
<p>The number of simulated studies</p>
</td></tr>
<tr><td><code id="SSR.sim_+3A_seed">Seed</code></td>
<td>
<p>The random seed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains
</p>

<ul>
<li><p> nTotal The average total sample size used in SSR
</p>
</li>
<li><p> H0 The power of SSR under the specific trial design. Here, the power
is defined as the probability of rejecting the null hypothesis
</p>
</li>
<li><p> ESF The percentage of early stopping for futility
</p>
</li>
<li><p> ESE The percentage of early stopping for efficacy
</p>
</li></ul>



<h3>References</h3>


<ul>
<li><p> Proschan MA, Hunsberger SA. Designed extension of studies based on
conditional power. Biometrics 1995:1315-1324. &lt;doi:10.2307/2533262&gt;
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>N &lt;- 310
rho &lt;- 0.5
alpha &lt;- 0.05
beta &lt;- 0.2
pstar &lt;- 0.2
theta &lt;- c(0.2,0)
theta0 &lt;- 0
sigma0 &lt;- 1.0
nSim &lt;- 1000
Seed &lt;- 6
res &lt;- SSR.sim(N = N, rho = rho, alpha = alpha, beta = beta, theta = theta,
        theta0 = theta0, sigma0 = sigma0, pstar = pstar,
        nSim = nSim, Seed = Seed)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
