<!DOCTYPE html><html><head><title>Help for package KINSIMU</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {KINSIMU}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EvaluatePanel'><p>Evaluate a panel</p></a></li>
<li><a href='#FortytwoSTR'><p>Information of 42 autosomal STRs</p></a></li>
<li><a href='#IICAL'><p>Incest index</p></a></li>
<li><a href='#logLR'><p>CLR for a single case</p></a></li>
<li><a href='#LRgpgcam'><p>LR in grandparent-child identification with reference</p></a></li>
<li><a href='#LRhsip'><p>LR in half-sibling identification with the identical parent participated</p></a></li>
<li><a href='#LRparas'><p>Calculating parameters in LR</p></a></li>
<li><a href='#outputCSV'><p>Output frequency data into ISFG format</p></a></li>
<li><a href='#pairsimu'><p>Pairwise simulation</p></a></li>
<li><a href='#pediexample'><p>Example of pedi matrix</p></a></li>
<li><a href='#pedisimu'><p>Pedigree simulation</p></a></li>
<li><a href='#testsimulation'><p>Simulation in kinship analysis</p></a></li>
<li><a href='#trioPI'><p>LR in standard trio cases</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Panel Evaluation in Forensic Kinship Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-01-05</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Guanju Ma &lt;mache124@126.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Evaluate specific panels in different aspects: i) Simulation tools related to pedigree researches; ii) calculation for systemic effectiveness indicators, such as probability of exclusion (PE).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-08 02:29:49 UTC; mache</td>
</tr>
<tr>
<td>Author:</td>
<td>Guanju Ma [aut, cre],
  Shujin Li [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-08 10:00:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='EvaluatePanel'>Evaluate a panel</h2><span id='topic+EvaluatePanel'></span>

<h3>Description</h3>

<p>Transfer the input allele frequency data (in a .csv file or a data frame) into form usable for other functions and then calculate several population parameters based on the frequency data for each marker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EvaluatePanel(
  type = "csv",
  strpath,
  raremode = "ISFG",
  Nind = "lastrow",
  Th = 0.01
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EvaluatePanel_+3A_type">type</code></td>
<td>
<p>The type of input data, either 'csv'(a .csv containing af matrix, with the marker names listed in the first row), or 'df' (a data frame cantaining the af matrix with the marker names as column names)</p>
</td></tr>
<tr><td><code id="EvaluatePanel_+3A_strpath">strpath</code></td>
<td>
<p>pathway of the .csv file or the name of the data frame</p>
</td></tr>
<tr><td><code id="EvaluatePanel_+3A_raremode">raremode</code></td>
<td>
<p>mode of the calculation method of rare alleles, with a default of &quot;ISFG&quot;, indicating the recommended method from ISFG, i.e., (X+1)/(2N+1), where X and N stood for the number of allele types detected in a survey and the sample size, respectively. Three alternative methods are given: &quot;MAF&quot;, take the minimum allele frequency as such frequency; &quot;1/2N&quot;, take the minimum of possible frequency a survey can achieved; and a number .</p>
</td></tr>
<tr><td><code id="EvaluatePanel_+3A_nind">Nind</code></td>
<td>
<p>mode of sample size, with a default of &quot;lastrow&quot;, meaning that the sample size was presented in the last row of the .csv file. An alternative method is given, i.e., input a unified sample size.</p>
</td></tr>
<tr><td><code id="EvaluatePanel_+3A_th">Th</code></td>
<td>
<p>The threshold for the difference in allele frequency sum at a locus with 1, to detect data error from rounding error when the frequency sum does not equal 1. Loci exceeding this threshold will be excluded from the calculation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of four vectors: afmatrix, a list of allele frequency data of each locus; rare, a data.frame containing the frequency of rare allele on each locus; indicators, a data.frame containing parameters of system efficiency for each locus; panelparas, a data.frame containing system efficiency parameters for the whole panel, with the form of log10(1-paramter) to avoid the situation that the parameters being displayed as 1 because they were too close to 1
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#A .csv file can be output with FortytwoSTR data
path&lt;-tempdir()
outputCSV(FortytwoSTR,file.path(path,'data.csv'))
#Example 1, 'df' type, by read the csv file into a data frame
allele_data &lt;- read.csv(file = file.path(path,'data.csv'), header = TRUE)
STR42&lt;- EvaluatePanel(type = 'df',strpath = allele_data,raremode = "ISFG",Nind = "lastrow")
#Example 2, 'csv' type, the same evaluation can be done by directly input the csv file
STR42_2 &lt;- EvaluatePanel(type = 'csv',strpath = file.path(path,'data.csv'),
raremode = "ISFG",Nind = "lastrow")
#The data "FortytwoSTR" is generated with these codes.
</code></pre>

<hr>
<h2 id='FortytwoSTR'>Information of 42 autosomal STRs</h2><span id='topic+FortytwoSTR'></span>

<h3>Description</h3>

<p>Example of the results achieved by &quot;EvaluatePanel&quot; function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FortytwoSTR
</code></pre>


<h3>Format</h3>

<p>A list of 3 vectors: i) a list nameed afmatrix containing 42 data.frames, each of which exhibiting the allele frequecies of alleles on a locus with the row names being the corresponding names of such alleles; ii) a data.fram with 1 row and 42 columns containing the frequencies of rare alleles on the 42 loci; and iii) a data.frame named indicators with 42 columns and 12 rows containing the main effeciency indicators of the 42 loci.
</p>

<hr>
<h2 id='IICAL'>Incest index</h2><span id='topic+IICAL'></span>

<h3>Description</h3>

<p>Calculation of the ratio for a parent-child pair between the probability that the child's other parent is a relative of the present parent to the probability that the child's parents are unrelated
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IICAL(Parent, Child, af, rare = NULL, allelename = FALSE, phi = 0.25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IICAL_+3A_parent">Parent</code></td>
<td>
<p>Genotypes of individual A of each case, which should be data.frame with 2 columns and ss rows, where ss stand for sample size</p>
</td></tr>
<tr><td><code id="IICAL_+3A_child">Child</code></td>
<td>
<p>Genotypes of individual B of each case, which should be data.frame with 2 columns and ss rows, where ss stand for sample size</p>
</td></tr>
<tr><td><code id="IICAL_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column with the allele name being row names</p>
</td></tr>
<tr><td><code id="IICAL_+3A_rare">rare</code></td>
<td>
<p>frequency of rare allele</p>
</td></tr>
<tr><td><code id="IICAL_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the af matrix</p>
</td></tr>
<tr><td><code id="IICAL_+3A_phi">phi</code></td>
<td>
<p>kinship coefficent between the parents under Hp (that under Hd euquals to 0),with a defualt of 0.25, i.e., father-daughter incest or full-sibling incest</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The premise of using this function should be the confirmation of the parent-child relationship between the two individuals, if there is no sharing alleles between them, 1-2phi would be regarded as the output
</p>


<h3>Value</h3>

<p>a data.frame containing 2 columns: Ngs (the genotype similarity score, 1 if both of the two alleles in child's genotype can be inherited from the mother) and Log10LR for each simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate 10,000 mother-child pairs with father-daughter incest with pedisimu() function
# based on the 42 STRs in "FortytwoSTR" data.
pedi&lt;-data.frame(Person=c("F","M","C"),Father=c("RI","F","F"),Mother=c("RI","RI","M"))
II_1=II_2=data.frame(Ngs=rep(0,10000),IIphi=rep(0,10000))
for (i in 1:42) {
Genotype1&lt;-pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi)
# Calculate II for each case.
II_1&lt;-II_1+IICAL(Parent = Genotype1[,3:4],Child = Genotype1[,5:6],af=FortytwoSTR$afmatrix[[i]],
rare=FortytwoSTR$rare[i][1,1],phi=0.25)
#Simulate 10,000 non-inbred mother-child pairs
Genotype2&lt;-pairsimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,delta = c(0,1,0),allelename = FALSE)
II_2&lt;-II_2+IICAL(Parent = Genotype2[,1:2],Child = Genotype2[,3:4],af=FortytwoSTR$afmatrix[[i]],
rare=FortytwoSTR$rare[i][1,1],phi=0.25)
}
# histograms of CII distributions in the two groups
xmin&lt;-floor(min(min(II_1$IIphi),min(II_2$IIphi)))
xmax&lt;-ceiling(max(max(II_1$IIphi),max(II_2$IIphi)))
par(mfrow = c(1,2))
hist(II_2$IIphi,xlab = expression(log[10]~CII),main = "Non-inbreed cases",
xlim = c(xmin,xmax), col = "red")
hist(II_1$IIphi,xlab = expression(log[10]~CII),main = "Inbreed cases",
xlim = c(xmin,xmax), col = "blue")
</code></pre>

<hr>
<h2 id='logLR'>CLR for a single case</h2><span id='topic+logLR'></span>

<h3>Description</h3>

<p>CLR calculation for a single case, where two individual participated and labeled as A and B
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logLR(
  AB,
  afmatrix = NULL,
  rare = NULL,
  allelename = FALSE,
  stepPI = FALSE,
  adelta3 = NULL,
  adelta9 = NULL,
  mu = 0.002
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLR_+3A_ab">AB</code></td>
<td>
<p>Genotypes of two individuals in a case, which should be data.frame with 4 columns (2 for each individual) and <code>nl</code> rows, where <code>nl</code> stand for number of loci. The row names should be the name of each locus;</p>
</td></tr>
<tr><td><code id="logLR_+3A_afmatrix">afmatrix</code></td>
<td>
<p>name of allele frequency list, which can be loaded with &quot;EvaluatePanel&quot; function</p>
</td></tr>
<tr><td><code id="logLR_+3A_rare">rare</code></td>
<td>
<p>a data frame containing the frequency of rare allele on the locus, with 1 row and multiple columns, each column for a marker;</p>
</td></tr>
<tr><td><code id="logLR_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the afmatrix</p>
</td></tr>
<tr><td><code id="logLR_+3A_steppi">stepPI</code></td>
<td>
<p>If TRUE, empirical decreasing model of STR mutation would be taken when paternity index is needed to be calculated, otherwise, mutation rate would be taken as PI if IBS=0 between an alleged PC pair.</p>
</td></tr>
<tr><td><code id="logLR_+3A_adelta3">adelta3</code></td>
<td>
<p>distributions of the IBD coefficient of the outbred plaintiff's hypotheses in LR calculation, which should be a data.frame with 3 columns and x rows, where x stood for the number of such LR being calculated. The names of columns should be &quot;k0&quot;, &quot;k1&quot; and &quot;k2&quot;, and those of rows the name of LRs</p>
</td></tr>
<tr><td><code id="logLR_+3A_adelta9">adelta9</code></td>
<td>
<p>distributions of the Jacquard coefficient of the inbred plaintiff's hypotheses in LR calculation, which should be a data.frame with 9 columns and x rows, where x stood for the number of such LR being calculated. The names of columns should be &quot;D1-D9&quot;, and those of rows the name of LRs</p>
</td></tr>
<tr><td><code id="logLR_+3A_mu">mu</code></td>
<td>
<p>mutation rate when paternity index is needed to be calculated, defualts to 0.002.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list of two data.frames: (i) results_on_each_marker: multiple types of parameters calculated on each marker, including IBS and multiple log10 of LRs; (ii) total_results_of_the _case: the CIBS and log10CLR results for the whole case.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example code
AB&lt;-data.frame(a=rep(0,42),b=rep(0,42),c=rep(0,42),d=rep(0,42))
for (i in 1:42) {
temp&lt;-pairsimu(af = FortytwoSTR$afmatrix[[i]],ss = 1,delta = c(0,1,0),allelename = FALSE)
AB[i,]=temp
rownames(AB)[i]=names(FortytwoSTR$afmatrix)[i]
}
adelta3&lt;-data.frame(k0=c(0,0.25,0.5),k1=c(1,0.5,0.5),k2=c(0,0.25,0),row.names = c("PC","FS","HS"))
adelta9&lt;-data.frame(D1=0,D2=0,D3=0,D4=0,D5=0.25,D6=0,D7=0.25,D8=0.5,D9=0,row.names = "FIMCpair")
results&lt;-logLR(AB=AB,afmatrix=FortytwoSTR$afmatrix,rare=FortytwoSTR$rare,stepPI=TRUE,
adelta3=adelta3,adelta9=adelta9)
results$total_results_of_the_case
</code></pre>

<hr>
<h2 id='LRgpgcam'>LR in grandparent-child identification with reference</h2><span id='topic+LRgpgcam'></span>

<h3>Description</h3>

<p>LR when a child (C) is alleged to be a grand-child of another individual (GP), and an offspring(A) of the alleged grandparent participated, with or without the assistant of B's other parent (M). Hp is that, C is an offspring of A's full-sibling; and Hd that, C is unrelated to GP and A. Inbreeding is not considered.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRgpgcam(A, C, GP, af, rare = NULL, allelename = FALSE, M = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRgpgcam_+3A_a">A</code></td>
<td>
<p>Genotype data of the alleged uncle/aunt, should be data.frame with 2 columns and ss rows, where ss stand for sample size;</p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_c">C</code></td>
<td>
<p>Genotype data of the child, with the same form with <code>A</code></p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_gp">GP</code></td>
<td>
<p>Genotype data of the alleged grandparent of C, with the same form with <code>A</code></p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names</p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_rare">rare</code></td>
<td>
<p>frequency of rare allele on the locus</p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the af matrix</p>
</td></tr>
<tr><td><code id="LRgpgcam_+3A_m">M</code></td>
<td>
<p>Genotype data of the other parent of C, which can be <code>NULL</code> or as that of <code>A</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>There might be no allele sharing between GP and A, or between M and B, if so, the related part in the LR calculation would be treated as 0, which can be further optimized in future version.
</p>


<h3>Value</h3>

<p>a data frame with one column and ss rows, containing log10 value of the CLR of each case
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Construct pedi data.frames for two types of pedigrees
pedi1 &lt;- data.frame(Person=c("GF","GM","F","A","M","C"),
Father=c("RI","RI","GF","GF","RI","F"),
Mother=c("RI","RI","GM","GM","RI","M"))
pedi2 &lt;- data.frame(Person=c("GF","GM","F","A","M","C"),
Father=c("RI","RI","RI","GF","RI","F"),
Mother=c("RI","RI","RI","GM","RI","M"))
LR_1=LR_2=data.frame(Log10CLR=rep(0,10000))
for (i in 1:42) { 
# Simulate 10000 group of pedigrees where the Hp is true
  Genotype &lt;- pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi1)
  LR_1 &lt;-LR_1+ LRgpgcam(A=Genotype[,7:8],C=Genotype[,11:12],GP=Genotype[,1:2],M=Genotype[,9:10],
                        af=FortytwoSTR$afmatrix[[i]],rare=FortytwoSTR$rare[i][1,1])
#Simulate 10000 group of false pedigrees, i.e., P and C is unrelated to GP and A
Genotype &lt;- pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi2)
  LR_2 &lt;-LR_2+ LRgpgcam(A=Genotype[,7:8],C=Genotype[,11:12],GP=Genotype[,1:2],M=Genotype[,9:10],
                        af=FortytwoSTR$afmatrix[[i]],rare=FortytwoSTR$rare[i][1,1])
}
xmin&lt;-floor(min(min(LR_1$Log10CLR),min(LR_2$Log10CLR)))
xmax&lt;-ceiling(max(max(LR_1$Log10CLR),max(LR_2$Log10CLR)))
par(mfrow = c(1, 2))
hist(LR_2$Log10CLR,xlab = expression(log[10]~CLR),main = "False pedigree",
     xlim = c(xmin,xmax), col = "red")
hist(LR_1$Log10CLR,xlab = expression(log[10]~CLR),main = "True cases",
     xlim = c(xmin,xmax), col = "blue")  


</code></pre>

<hr>
<h2 id='LRhsip'>LR in half-sibling identification with the identical parent participated</h2><span id='topic+LRhsip'></span>

<h3>Description</h3>

<p>LR when a pair of siblings and one of their identical parent participated, Hp and Hd of which being &quot;the other parents of the two siblings being specific related&quot; and &quot;the other parents of them being unrelated&quot;. Inbreeding factors are not taken into consideration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRhsip(A, B, P, af, rare = NULL, allelename = FALSE, phi = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRhsip_+3A_a">A</code></td>
<td>
<p>Genotype data of the first sibling, should be data.frame with 2 columns and ss rows, where ss stand for sample size;</p>
</td></tr>
<tr><td><code id="LRhsip_+3A_b">B</code></td>
<td>
<p>Genotype data of the second sibling, with the same form with <code>A</code></p>
</td></tr>
<tr><td><code id="LRhsip_+3A_p">P</code></td>
<td>
<p>Genotype data of the identical parent of <code>A</code> and <code>B</code>, with the same form with them</p>
</td></tr>
<tr><td><code id="LRhsip_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names</p>
</td></tr>
<tr><td><code id="LRhsip_+3A_rare">rare</code></td>
<td>
<p>frequency of rare allele on the locus</p>
</td></tr>
<tr><td><code id="LRhsip_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the af matrix</p>
</td></tr>
<tr><td><code id="LRhsip_+3A_phi">phi</code></td>
<td>
<p>kinship coefficient of the other parents of the two siblings under Hp, with default of 1/2, i.e, being identical or MZ</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mutation might be found between P with A or B, if so, LR would be output as 1-phi, which can be further optimized in the future version.
</p>


<h3>Value</h3>

<p>a data frame with one column and ss rows, containing log10 value of the CLR of each case
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Construct pedi data.frames for two types of pedigrees
pedi1 &lt;- data.frame(Person=c("F","M","A","B"),
                    Father=c("RI","RI","F","F"),
                    Mother=c("RI","RI","M","M"))
pedi2 &lt;- data.frame(Person=c("M","A","B"),
                    Father=c("RI","RI","RI"),
                    Mother=c("RI","M","M"))
LR_1=LR_2=data.frame(Log10CLR=rep(0,10000))
for (i in 1:42) {
  # Simulate 10000 groups of A/B/P where A is full sibiling of B
  Genotype1=pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi1)
  LR_1=LR_1+LRhsip(A=Genotype1[,5:6],B=Genotype1[,7:8],P=Genotype1[,3:4],
                   af = FortytwoSTR$afmatrix[[i]],rare=FortytwoSTR$rare[i][1,1])
  # Simulate 10000 groups of A/B/P where A is half sibling of B, i.e., the true phi=0
  Genotype2=pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi2)
  LR_2=LR_2+LRhsip(A=Genotype2[,3:4],B=Genotype2[,5:6],P=Genotype2[,1:2],
                   af = FortytwoSTR$afmatrix[[i]],rare=FortytwoSTR$rare[i][1,1])
}
# histograms of CLR distributions in the two groups
xmin&lt;-floor(min(min(LR_1$Log10CLR),min(LR_2$Log10CLR)))
xmax&lt;-ceiling(max(max(LR_1$Log10CLR),max(LR_2$Log10CLR)))
par(mfrow = c(1, 2))
hist(LR_2$Log10CLR,xlab = expression(log[10]~CLR),main = "False pedigree",
     xlim = c(xmin,xmax), col = "red")
hist(LR_1$Log10CLR,xlab = expression(log[10]~CLR),main = "True cases",
     xlim = c(xmin,xmax), col = "blue")

</code></pre>

<hr>
<h2 id='LRparas'>Calculating parameters in LR</h2><span id='topic+LRparas'></span>

<h3>Description</h3>

<p>Counting and calculating parameters used in the calculation process of different pairwise LR calculation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LRparas(
  AB,
  af = NULL,
  rare = NULL,
  allelename = FALSE,
  stepwisePI = FALSE,
  bred = FALSE,
  mu = 0.002
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LRparas_+3A_ab">AB</code></td>
<td>
<p>Genotypes of two individuals of each case, which should be data.frame with 4 columns (2 for each individual) and <code>ss</code> rows, where <code>ss</code> stand for sample size;</p>
</td></tr>
<tr><td><code id="LRparas_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names</p>
</td></tr>
<tr><td><code id="LRparas_+3A_rare">rare</code></td>
<td>
<p>frequency of rare allele on the locus</p>
</td></tr>
<tr><td><code id="LRparas_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the af matrix</p>
</td></tr>
<tr><td><code id="LRparas_+3A_stepwisepi">stepwisePI</code></td>
<td>
<p>If TRUE, empirical decreasing model of STR mutation would be taken when paternity index is needed to be calculated, otherwise, mutation rate would be taken as PImu if IBS=0 between an alleged PC pair.</p>
</td></tr>
<tr><td><code id="LRparas_+3A_bred">bred</code></td>
<td>
<p>if TRUE, parameters used in the calculation of LR in inbred relationship would be calculated</p>
</td></tr>
<tr><td><code id="LRparas_+3A_mu">mu</code></td>
<td>
<p>mutation rate for PI calculation, with a default of 0.002</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that LR elements are in their original values instead of log10 values used in other functions.
</p>


<h3>Value</h3>

<p>a data frame with multiple column and ss rows, containing different types of parameters used in different LR calculation according to argument settings
</p>


<h3>Examples</h3>

<pre><code class='language-R'>af = FortytwoSTR$afmatrix[[1]]
AB = pairsimu(af = af,ss = 10000,delta = c(0,1,0),allelename = FALSE)
LRelements&lt;-LRparas(AB=AB, af=af, rare=FortytwoSTR$rare[1][1,1],allelename=FALSE,
  stepwisePI=TRUE,bred=TRUE)

</code></pre>

<hr>
<h2 id='outputCSV'>Output frequency data into ISFG format</h2><span id='topic+outputCSV'></span>

<h3>Description</h3>

<p>Output frequency data into ISFG format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>outputCSV(data, strpath)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="outputCSV_+3A_data">data</code></td>
<td>
<p>frequency data, a list containing 4 data frames.</p>
</td></tr>
<tr><td><code id="outputCSV_+3A_strpath">strpath</code></td>
<td>
<p>name of the pathway of the output csv file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a .csv file in ISFG formate
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path&lt;-tempdir()
outputCSV(FortytwoSTR,file.path(path,'data.csv'))
</code></pre>

<hr>
<h2 id='pairsimu'>Pairwise simulation</h2><span id='topic+pairsimu'></span>

<h3>Description</h3>

<p>Generating genotype combinations of multiple individual pairs with specific relationships on an autosomal marker, ignoring mutaion
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pairsimu(af, ss, delta, allelename = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pairsimu_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names, which can be loaded with &quot;EvaluatePanel&quot; function, not necessary if Parent is not NULL</p>
</td></tr>
<tr><td><code id="pairsimu_+3A_ss">ss</code></td>
<td>
<p>sample size, i.e., how many individual pairs do you want simulate</p>
</td></tr>
<tr><td><code id="pairsimu_+3A_delta">delta</code></td>
<td>
<p>distribution of IBD or Jacquard coefficient of specific relationship, i.e., kappa(0-2) or Delta(1-9), respectively. Which should be input in form of single row of data with c() function. It should be noted that the data should be in order of kappa0 to kappa2 or Delta1 to Delta9.</p>
</td></tr>
<tr><td><code id="pairsimu_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, outputing the names of alleles, otherwise, the positions of them in the af matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with four columns and <code>ss</code> rows, consisting of the alleles of the first individual in the first two columns and the alleles of the second individual in the remaining two columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Take the first STR in the 42 STR as example
af = FortytwoSTR$afmatrix[[1]]
# simulating 10,000 unrelated pairs
a&lt;-pairsimu(af = af,ss = 10000,delta = c(1,0,0),allelename = FALSE)
# simulating 10,000 parent-child pairs
b&lt;-pairsimu(af = af,ss = 10000,delta = c(0,1,0),allelename = FALSE)
# simulating 10,000 full-sibling pairs
c&lt;-pairsimu(af = af,ss = 10000,delta = c(0.25,0.5,0.25),allelename = FALSE)

</code></pre>

<hr>
<h2 id='pediexample'>Example of pedi matrix</h2><span id='topic+pediexample'></span>

<h3>Description</h3>

<p>Example of pedi, a matrix containing inherence information of a pedigree, used in function of &quot;pedisimu&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pediexample
</code></pre>


<h3>Format</h3>

<p>a data.frame containg 3 columns
</p>

<hr>
<h2 id='pedisimu'>Pedigree simulation</h2><span id='topic+pedisimu'></span>

<h3>Description</h3>

<p>Generating genotype combinations of multiple pedigrees with specific relationships on an autosomal marker.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pedisimu(
  af,
  ss,
  pedi,
  random_name = "RI",
  muf = 0,
  mum = 0,
  allelename = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pedisimu_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names, which can be loaded with &quot;EvaluatePanel&quot; function, not necessary if Parent is not NULL</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_ss">ss</code></td>
<td>
<p>sample size, i.e., how many individual pairs do you want simulate</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_pedi">pedi</code></td>
<td>
<p>a matrix in data.frame form containing the pedigree structure information</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_random_name">random_name</code></td>
<td>
<p>the name of random individual, with a default of &quot;RI&quot;</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_muf">muf</code></td>
<td>
<p>father-child mutation rate</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_mum">mum</code></td>
<td>
<p>mother-child mutation rate</p>
</td></tr>
<tr><td><code id="pedisimu_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE the output data would be the allele name, which should be the row names of af matrix, otherwise, it would be the position in that matrix</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame with <code>ss</code> rows and 2*<code>n</code> columns, where <code>n</code> is equal to the number of rows in the pedi data.frame. Each pair of columns contains alleles of an individual, with the individuals sorted in the same order as in the pedi data.frame.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#simulating a first cousin pedigree without considring mutation
pedi&lt;-pediexample
af&lt;-FortytwoSTR$afmatrix[[1]]
pedisimu(af = af,ss = 10000,pedi = pedi)


</code></pre>

<hr>
<h2 id='testsimulation'>Simulation in kinship analysis</h2><span id='topic+testsimulation'></span>

<h3>Description</h3>

<p>Simulation and calculation in kinship analysis, in which genotype combinations of two groups of individual pairs with different relationships would be generated, specific likelihood ratio, as well as the CIBS score would be calculated for each pair.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testsimulation(
  afmatrix,
  ss,
  tdelta,
  adelta3 = NULL,
  adelta9 = NULL,
  pedname = "SimPed",
  stepPI = FALSE,
  mu = 0.002
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testsimulation_+3A_afmatrix">afmatrix</code></td>
<td>
<p>name of allele frequency list, which can be loaded with &quot;EvaluatePanel&quot; function</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_ss">ss</code></td>
<td>
<p>sample size</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_tdelta">tdelta</code></td>
<td>
<p>distribution of the actual IBD or Jacquard coefficient of the individual pairs, i.e., kappa(0-2) or Delta(1-9), respectively. Which should be input in form of single row of data with c() function. It should be noted that the data should be in order of kappa0 to kappa2 or Delta1 to Delta9.</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_adelta3">adelta3</code></td>
<td>
<p>distributions of the IBD coefficient of the outbred plaintiff's hypotheses in LR calculation, which should be a data.frame with 3 columns and x rows, where x stood for the number of such LR being calculated. The names of columns should be &quot;k0&quot;, &quot;k1&quot; and &quot;k2&quot;, and those of rows the name of LRs</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_adelta9">adelta9</code></td>
<td>
<p>distributions of the Jacquard coefficient of the inbred plaintiff's hypotheses in LR calculation, which should be a data.frame with 9 columns and x rows, where x stood for the number of such LR being calculated. The names of columns should be &quot;D1-D9&quot;, and those of rows the name of LRs</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_pedname">pedname</code></td>
<td>
<p>name of the real relationship, defaults to &quot;SimPed&quot;.</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_steppi">stepPI</code></td>
<td>
<p>If TRUE, empirical decreasing model of STR mutation would be taken when paternity index is needed to be calculated, otherwise, mutation rate would be taken as PI if IBS=0 between an alleged PC pair.</p>
</td></tr>
<tr><td><code id="testsimulation_+3A_mu">mu</code></td>
<td>
<p>mutation rate when paternity index is needed to be calculated, defualts to 0.002.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame containing multiple columns: relationship, CIBS and multiple log0CLR for each simulation
</p>


<h3>Examples</h3>

<pre><code class='language-R'>adelta3&lt;-data.frame(k0=c(0,0.25,0.5),k1=c(1,0.5,0.5),k2=c(0,0.25,0),row.names = c("PC","FS","HS"))
adelta9&lt;-data.frame(D1=0,D2=0,D3=0,D4=0,D5=0.25,D6=0,D7=0.25,D8=0.5,D9=0,row.names = "FIMCpair")
data(FortytwoSTR)
results&lt;-testsimulation(afmatrix = FortytwoSTR[["afmatrix"]],ss = 10000,tdelta = c(0,1,0),
adelta3 = adelta3, adelta9 = adelta9,pedname="PC")


</code></pre>

<hr>
<h2 id='trioPI'>LR in standard trio cases</h2><span id='topic+trioPI'></span>

<h3>Description</h3>

<p>Calculating LR in cases where 3 participants being available, a child, his/her biological mother (or father) whose parentage is confirmed, and a male (or female) who is unrelated to the confirmed parent and alleged to be specific relative of the child, usually the father. Null hypothesis, i.e., that the alleged participant is unrelated to the child, is taken as Hd.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trioPI(
  AR,
  C,
  TP,
  af,
  rare = NULL,
  allelename = FALSE,
  muAtoC = 0.002,
  muTtoC = 0.002/3.5,
  kappa1 = 1
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="trioPI_+3A_ar">AR</code></td>
<td>
<p>Genotype of the alleged relative, which should be data.frame with 2 columns and ss rows, where ss stand for sample size;</p>
</td></tr>
<tr><td><code id="trioPI_+3A_c">C</code></td>
<td>
<p>Genotype of the child, see in <code>AR</code> for the data form</p>
</td></tr>
<tr><td><code id="trioPI_+3A_tp">TP</code></td>
<td>
<p>Genotype of the confirmed parent of the child, see in <code>AR</code> for the data form</p>
</td></tr>
<tr><td><code id="trioPI_+3A_af">af</code></td>
<td>
<p>name of allele frequency matrix, a data.frame of 1 column containing frequencies with allele names being row names</p>
</td></tr>
<tr><td><code id="trioPI_+3A_rare">rare</code></td>
<td>
<p>frequency of rare allele on the locus</p>
</td></tr>
<tr><td><code id="trioPI_+3A_allelename">allelename</code></td>
<td>
<p>if TRUE, the input genotype data would be regarded as allelenames, otherwise, the position in the af matrix</p>
</td></tr>
<tr><td><code id="trioPI_+3A_muatoc">muAtoC</code></td>
<td>
<p>mutation rate from <code>AR</code> to <code>C</code> if AR is alleged to be the child's parent, with a default of 0.002, please note that mistakes would be introduced if the mutation rate is larger than 0.2</p>
</td></tr>
<tr><td><code id="trioPI_+3A_muttoc">muTtoC</code></td>
<td>
<p>mutation rate from <code>TP</code> to <code>C</code>, with a default of 0.002/3.5, please note that mistakes would be introduced if the mutation rate is larger than 0.2</p>
</td></tr>
<tr><td><code id="trioPI_+3A_kappa1">kappa1</code></td>
<td>
<p>kappa_1 of the alleged relationship between AR and C, with a default of 1, meaning the AR is alleged to be the other parent of C</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If any one of TP or AR cannot provide any of the C's alleles through integer steps, <code>muAtoC</code> would be output when calculating PI, and under other situations, the case with minimum mutation steps, (AR to C)+(TP to C) under Hp and (TP to C) under Hd, would be considered. Much more is required for further discussion in PI calculation involving mutations.
</p>


<h3>Value</h3>

<p>a data.frame containing <code>ss</code> rows and 1 column, containing the log10 of LR for each group
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # Three types of pedigrees are simulated: pedi1: father-mother-child; 
 # pedi2: random male-mother-child; and pedi3: uncle-mother-child
 pedi1 &lt;- data.frame(Person=c("F","M","C"),Father=c("RI","RI","F"),Mother=c("RI","RI","M"))
 pedi2 &lt;- data.frame(Person=c("F","M","C"),Father=c("RI","RI","RI"),Mother=c("RI","RI","M"))
 pedi3 &lt;- data.frame(Person=c("GF","GM","AR","F","M","C"),
 Father=c("RI","RI","GF","GF","RI","F"),
 Mother=c("RI","RI","GM","GM","RI","M"))
 # Two types of LRs are calculated: PI_1 and PI_2: Paternity index in trio cases; 
 # AI_1 and AI_2: Avuncular index in trio cases.
 PI_1=PI_2=AI_1=AI_2=data.frame(Log10CLR=rep(0,10000))
 # Simulation are carried out based on the frequency data of the 42 STRs in FortytwoSTR dataset
 # Setting sample size as 10,000
 for (i in 1:42) {
   Genotype1&lt;-pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi1)
   PI_1&lt;-PI_1+trioPI(AR=Genotype1[,1:2],TP=Genotype1[,3:4],
                C=Genotype1[,5:6],af=FortytwoSTR$afmatrix[[i]],
                rare=FortytwoSTR$rare[i])
   Genotype2&lt;-pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi2)
   PI_2&lt;-PI_2+trioPI(AR=Genotype2[,1:2],TP=Genotype2[,3:4],
                C=Genotype2[,5:6],af=FortytwoSTR$afmatrix[[i]],
                rare=FortytwoSTR$rare[i])
   AI_2&lt;-AI_2+trioPI(AR=Genotype2[,1:2],TP=Genotype2[,3:4],
                C=Genotype2[,5:6],af=FortytwoSTR$afmatrix[[i]],
                rare=FortytwoSTR$rare[i],kappa1=0.5)             
   Genotype3&lt;-pedisimu(af = FortytwoSTR$afmatrix[[i]],ss = 10000,pedi = pedi3)
   AI_1&lt;-AI_1+trioPI(AR=Genotype3[,5:6],TP=Genotype3[,9:10],
                C=Genotype3[,11:12],af=FortytwoSTR$afmatrix[[i]],
                rare=FortytwoSTR$rare[i],kappa1=0.5)
 }
 #histogram of the final results
 xmin1&lt;-floor(min(min(PI_1$Log10CLR),min(PI_2$Log10CLR)))
 xmax1&lt;-ceiling(max(max(PI_1$Log10CLR),max(PI_2$Log10CLR)))
 xmin2&lt;-floor(min(min(AI_1$Log10CLR),min(AI_2$Log10CLR)))
 xmax2&lt;-ceiling(max(max(AI_1$Log10CLR),max(AI_2$Log10CLR)))
 par(mfrow = c(2, 2))
 hist(PI_1$Log10CLR,xlab = expression(log[10]~CPI),main = "True parentage cases",
      xlim = c(xmin1,xmax1), col = "blue")
 hist(AI_1$Log10CLR,xlab = expression(log[10]~CAI),main = "True avuncular cases",
      xlim = c(xmin2,xmax2), col = "blue")  
 hist(PI_2$Log10CLR,xlab = expression(log[10]~CPI),main = "False pedigree in parentage cases",
      xlim = c(xmin1,xmax1), col = "red")
 hist(AI_2$Log10CLR,xlab = expression(log[10]~CAI),main = "False pedigree in avuncular cases",
      xlim = c(xmin2,xmax2), col = "red")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
