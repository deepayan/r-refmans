<!DOCTYPE html><html><head><title>Help for package RInSp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {RInSp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#Eindex'>
<p>Calculate index E and Cws</p></a></li>
<li><a href='#Emc'>
<p>Monte Carlo resampling procedure for index E and Cws</p></a></li>
<li><a href='#Hier2L'>
<p>Variance partition and WIC/TNW</p></a></li>
<li><a href='#import.RInSp'>
<p>Import data into a RInSp object</p></a></li>
<li><a href='#Likelihood and Wi'><p>Likelihood measure of niche breadth</p></a></li>
<li><a href='#MCp.RInSp'><p>Monte Carlo resampling procedure</p></a></li>
<li><a href='#NODF'>
<p>Nestedness metric based on overlap and decreasing fill</p></a></li>
<li><a href='#Null.Hp.RInSp'><p>Generate a data set based on a specific null hypothesis</p></a></li>
<li><a href='#overlap'><p>Mean pairwise overlap</p></a></li>
<li><a href='#pop.diet'>
<p>Calculate population diet</p></a></li>
<li><a href='#PSicalc'><p>Calculate the proportional similarity index</p></a></li>
<li><a href='#RInSp-package'>
<p>R Individual Specialization</p></a></li>
<li><a href='#RInSp2vegan'>
<p>Vegan support procedure</p></a></li>
<li><a href='#Stickleback'>
<p>Example of data from threespine Stickleback gut contents</p></a></li>
<li><a href='#sumMC.RInSp'>
<p>Summary function for Monte Carlo resampling results</p></a></li>
<li><a href='#Trout'><p>Example of continuous data from fish prey lengths of brown trout</p></a></li>
<li><a href='#WTcMC'>
<p>Monte Carlo resampling of WIC/TNW for the continuous case</p></a></li>
<li><a href='#WTdMC'>
<p>Monte Carlo resampling of WIC/TNW for the discrete case</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>R Individual Specialization</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-05-18</td>
</tr>
<tr>
<td>Author:</td>
<td>Dr. Nicola Zaccarelli [aut, cre],
  Giorgio Mancinelli [aut],
  Dan Bolnick [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dr. Nicola Zaccarelli &lt;nicola.zaccarelli@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to calculate several ecological indices of individual 
    and population niche width (Araujo's E, clustering and pairwise similarity 
    among individuals, IS, Petraitis' W, and Roughgarden's WIC/TNW) to assess 
    individual specialization based on data of resource use. Resource use can 
    be quantified by counts of categories, measures of mass or length, or 
    proportions. Monte Carlo resampling procedures are available for hypothesis 
    testing against multinomial null models.
    Details are provided in Zaccarelli et al. (2013) &lt;<a href="https://doi.org/10.1111%2F2041-210X.12079">doi:10.1111/2041-210X.12079</a>&gt;
    and associated references.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-20 08:20:48 UTC; Nicola</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-20 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='Eindex'>
Calculate index E and Cws
</h2><span id='topic+Eindex'></span>

<h3>Description</h3>

<p>The procedure calculates the E measure of interindividual variation, its variance and the value of the <code class="reqn">C_{ws}</code> measure of modularity after Araujo et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Eindex(dataset, index = "saramaki", jackknife = FALSE, precision = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Eindex_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo;, &ldquo;integer&rdquo; or &ldquo;proportions&rdquo;.</p>
</td></tr>
<tr><td><code id="Eindex_+3A_index">index</code></td>
<td>
<p>The type of clustering coefficient to use. Valid values are Saramaki's and Barrat's index: &ldquo;saramaki&rdquo; or &ldquo;barrat&rdquo;.</p>
</td></tr>
<tr><td><code id="Eindex_+3A_jackknife">jackknife</code></td>
<td>
<p>Specify if a jackknife estimate of the index variance is required. Default is FALSE.</p>
</td></tr>
<tr><td><code id="Eindex_+3A_precision">precision</code></td>
<td>
<p>a filter to remove from the PS matrix all values which are lower than &quot;precision&quot;. In this way some interactions are removed due to their small weight in the PS matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The index E has been proposed by Araujo et al. (2008) as a measure of individual specialization where, in absence of interindividual niche variation, its value is zero. The index will increase towards one with the increase of interindividual variation.
</p>
<p>A jackknife estimation of the variance of E can be derived using the formalism of U-statistics (Aversen, 1969). For a complete description and a formal demonstration of the jackknife estimation of the variance of the E index the reader is refered to Araujo et al. (2008).
</p>
<p>A measure of the relative degree of clustering in a network to test for modularity in the niche overlap network is <code class="reqn">C_{ws}</code>. In a totally random network (i.e., a network consisting of individuals that sample randomly from the population niche), <code class="reqn">C_{ws}</code> is approximally 0, indicating no modularity. If individuals form discrete groups specialized on distinct sets of resources, <code class="reqn">C_{ws} &gt; 0</code>, and the network is modular. If <code class="reqn">C_{ws} &lt; 0</code> the network degree of clustering is actually lower than what would be expected solely on the overall network density of connections, indicating that diet variation takes place at the level of the individual, as opposed to discrete groups.
</p>
<p>The relative degree of clustering <code class="reqn">C_{ws}</code> is obtained as the mean values over all nodes the niche overlap network of the individual node weighted clustering coefficients (<code class="reqn">C_{w_i}</code>).
</p>
<p>The clustering can be measured using two different type of weighted clustering coefficients. In general the degree of unweighted clustering around a vertex <em>i</em> in a network is quantified by evaluating the number of triangles in which the vertex participates normalized by the maximum possible number of such triangles. Hence we have zero if none of the neighbours of a vertex are connected, otherwise we have one. By extending the above line of reasoning, the weighted clustering coefficient should also take into account how much weight is present in the neighbourhood of the vertex, compared to some limiting case. This can be done in several ways.
Barrat et al. (2004) were the  first to  propose a weighted version of the clustering coefficient of the form:
</p>
<p style="text-align: center;"><code class="reqn"> C_{w_i} = \frac{1}{s_i(k_i -1)} \sum_{j,h}{\frac{(w_{ij}+w_{ih})}{2}a_{ij}a_{ih}a_{jh}} </code>
</p>

<p>where <code class="reqn">s_i</code> is the sum of the weights (<code class="reqn">w_i</code>) of all the edges between node i and the nodes to which it is connected; <code class="reqn">k_i</code> is the number of edges between node i and its neighbours; <code class="reqn">w_{ij}</code> is the weight of the edge between thw two nodes i and j; <code class="reqn">a</code> is 1 if an edge is present between each pair <em>ij</em>, <em>ih</em>, and <em>jh</em> respectively, and zero otherwise. The summation, therefore, quantifies the weights of all edges between node i and its neighbours that are also neighbours to each other.
</p>
<p>Samaraki et al. (2007) and Onnela et al. (2005) proposed a version of a clustering index of the form:
</p>
<p style="text-align: center;"><code class="reqn"> C_{w_i} = \frac{1}{k_i(k_i -1)} \sum_{j,h}{(w_{ij}w_{ih}w_{jh})^\frac{1}{3}} </code>
</p>

<p>where <code class="reqn">k_i</code> is the number of edges between individual i and its neighbours; <code class="reqn">w_{ij}</code> is the weight of the edge between individual i and j obtained by dividing the actual weight by the maximum of all weights. The summation, therefore, quantifies the weights of all edges between individual i and its neighbours that are also neighbours to each other.
</p>
<p>The default value of the procedure has been set for analogy with the Dieta1.c code provided by Araujo et al. (2008). The original source code Dieta1.c is available from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>): identifier E089-115-A1; <a href="http://esapubs.org/archive/ecol/E089/115/">http://esapubs.org/archive/ecol/E089/115/</a>.
</p>
<p>Version 1.1 of the package fixes the case of highly specialised individuals in the calculation of <code class="reqn">C_{ws}</code>.
</p>


<h3>Value</h3>

<p>The result is a list of class &lsquo;RInSp&rsquo; composed of:
</p>
<table>
<tr><td><code>Omean</code></td>
<td>
<p>Mean value of the measure of the network overall degree of pairwise overlap.</p>
</td></tr>
<tr><td><code>E</code></td>
<td>
<p>Value of the index of individual specialization E.</p>
</td></tr>
<tr><td><code>PS</code></td>
<td>
<p>Matrix of the measure of niche pairwise overlap between i and j, adapted from Schoener (1968).</p>
</td></tr>
<tr><td><code>PSbinary</code></td>
<td>
<p>Binary matrix derived by applying the threshold of Omean to the PS matrix. This matrix can be imported into the software PAJEK (<a href="http://vlado.fmf.uni-lj.si/pub/networks/pajek/">http://vlado.fmf.uni-lj.si/pub/networks/pajek/</a>) to draw binary networks of diet similarity among individuals (e.g., see Araujo et al. 2008).</p>
</td></tr>
<tr><td><code>Ejack</code></td>
<td>
<p>Values of the measure of interindividual variation used for the Jackknife estimates of Var(E).</p>
</td></tr>
<tr><td><code>VarE</code></td>
<td>
<p>Jackknife estimates of the variance of E.</p>
</td></tr>
<tr><td><code>CW</code></td>
<td>
<p>is the network weighted clustering coefficient.</p>
</td></tr>
<tr><td><code>CwS</code></td>
<td>
<p>Vector of the individuals weighted clustering coefficients.</p>
</td></tr>
<tr><td><code>Cw</code></td>
<td>
<p>Value of the measure of modularity.</p>
</td></tr>
<tr><td><code>index</code></td>
<td>
<p>The type of clustering coefficient used.</p>
</td></tr>
<tr><td><code>Ki</code></td>
<td>
<p>A vector with the degree of the nodes of the network.</p>
</td></tr>
<tr><td><code>Precission</code></td>
<td>
<p>The value of the selected threshold for precision.</p>
</td></tr>
<tr><td><code>Isolation</code></td>
<td>
<p>If the value is different from zero there are isolated individuals in the network.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Araujo M.S., Guimaraes Jr., P.R., Svanback, R., Pinheiro, A., Guimaraes P., dos Reis, S.F., and Bolnick, D.I. 2008. Network analysis reveals contrasting effects of intraspecific competition on individual vs. population diets. <em>Ecology</em> <b>89</b>: 1981-1993.
</p>
<p>Aversen J.N. 1969. Jackknifing U-statistics. <em>Annals of Mathematical Statistics</em> <b>40</b>: 2076-2100.
</p>
<p>Barrat A., Barthelemy M., Pastor-Satorras R., and Vespignani, A. 2004. The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences</em> <b>101</b>: 3747-3752
</p>
<p>Onnela J.P., Saramaki J., Kertesz J., and Kaski, K. 2005. Intensity and coherence of motifs in weighted complex networks. <em>Physics Review E</em> <b>71</b>: 065103.
</p>
<p>Saramaki J., Kivela M., Onnela J.P., Kaski K., and Kertesz, J. 2007. Generalizations of the clustering coefficient to weighted complex networks. <em>Physics Review E</em> <b>75</b>: 027105.
</p>
<p>Schoener, T.W. 1968. The <em>Anolis</em> lizards of Bimini: resources partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>


<h3>See Also</h3>

<p> Function <code><a href="#topic+Emc">Emc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Eindex example with data from Bolnick and Paull (2009)
data(Stickleback)
# Select a single spatial sampling site (site B)
GutContents_SiteB &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "B"))
# Index calculation with jackknife variance estimate
# This can take time for big data sets
Eresult &lt;- Eindex(GutContents_SiteB, index = "saramaki", jackknife = TRUE)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Emc'>
Monte Carlo resampling procedure for index E and Cws
</h2><span id='topic+Emc'></span>

<h3>Description</h3>

<p>The procedure performs a Monte Carlo resampling under a null hypothesis to calculate the E measure of interindividual variation and the value of the <code class="reqn">C_{ws}</code> measure of modularity following Araujo et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Emc(dataset, popd.type = "sum", index = "saramaki", replicates=999, precision = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Emc_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp. Only data of type &ldquo;integer&rdquo; can be used. See <code><a href="#topic+import.RInSp">import.RInSp</a></code> for details.</p>
</td></tr>
<tr><td><code id="Emc_+3A_popd.type">popd.type</code></td>
<td>
<p>Option specifying the way to calculate the population diet. Valid values are &ldquo;sum&rdquo; or &ldquo;average&rdquo;. See <code><a href="#topic+pop.diet">pop.diet</a></code> for details.</p>
</td></tr>
<tr><td><code id="Emc_+3A_index">index</code></td>
<td>
<p>The type of clustering coefficient to use. Valid values are Saramaki's and Barrat's index: &ldquo;saramaki&rdquo; or &ldquo;barrat&rdquo;. See <code><a href="#topic+Eindex">Eindex</a></code> for details.</p>
</td></tr>
<tr><td><code id="Emc_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for the Monte Carlo resampling, under the null hypothesis that any observed diet variation arose from individuals sampling stochastically from a shared distribution.</p>
</td></tr>
<tr><td><code id="Emc_+3A_precision">precision</code></td>
<td>
<p>a filter to remove from the PS matrix all values which are lower than &quot;precision&quot;. In this way some interactions are removed due to their small weight in the PS matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For counts of individual prey items representing approximately independent prey-capture decisions (i.e., integer data type), it is possible to run a Monte Carlo resampling simulation to test the null hypothesis that any observed diet variation arose from individuals sampling stochastically from a shared distribution. See Araujo et al. (2011) for a discussion of the biological assumptions underlying this Monte Carlo resampling procedure. In the simulations, each individual is assigned a number of prey items equal to the number of items it was observed eating, and then prey items are randomly assigned to the individual's diet via multinomial sampling from the observed population resource distribution. Next, both <code class="reqn">E</code> and <code class="reqn">C_{ws}</code> are recalculated for the resulting simulated population. The program generates a specified number of such null datasets, and the observed test statistic is compared to the distribution observed under the null hypothesis.
</p>
<p>Note that the Monte Carlo method should not be applied to non-integer diet data (e.g., total mass of each prey species, proportion of stomach volume per prey species).
</p>
<p>There are two options for calculating the population's diet proportions (<code class="reqn">q_j</code>, the proportion of the resource j in the population's diet): <em>sum</em> and <em>average</em>.  When <em>sum</em> is specified, one sums up all resource counts within a category across all individuals to get the population's use, then determine the proportion of each resource category in the population's repertoire:
</p>
<p style="text-align: center;"><code class="reqn"> q_j = \frac{\sum_i{n_{ij}}}{\sum_{ji}{n_{ij}}}</code>
</p>

<p>The drawback of this approach is that individuals that eat large numbers of items, or larger total mass of items, will bias the population to look more like them.
The <em>average</em> method (average proportion) circumvents this problem by first converting individual diets into proportions <code class="reqn">p_{ik}</code>, then averaging these proportions for each resource k.
</p>
<p>An adjusted value of E is calculated as:
</p>
<p style="text-align: center;"><code class="reqn">E_{adj} = \frac{E_{obs} - E_{null}}{1 - E_{null}}</code>
</p>

<p>This rescales the value of E (i.e., the observed value <code class="reqn">E_{obs}</code>) to range from a minimum of 0 when the observed value is equal to the mean Null value (i.e., <code class="reqn">E_{null}</code>, up to a maximum of 1 when individual specialization is strongest). This allows one to compare datasets with different mean Null values.
</p>
<p>Version 1.1 of the package fixes the case of highly specialised individuals in the calculation of <code class="reqn">C_{ws}</code> by removing a bug in the C code taken from Dieta1.c affecting how the weight matrix and the number of links where calculated when highly specilised individuals are present.
</p>


<h3>Value</h3>

<p>The result is a list of class &lsquo;RInSp&rsquo; composed of:
</p>
<table>
<tr><td><code>E</code></td>
<td>
<p>Value of the index of individual specialization E.</p>
</td></tr>
<tr><td><code>meannullE</code></td>
<td>
<p>The mean value of the Monte Carlo resampling simulated data.</p>
</td></tr>
<tr><td><code>Eadj</code></td>
<td>
<p>The adjusted value of E.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>It is the proportion of Monte Carlo resampling simulated values greater than the observed E.</p>
</td></tr>
<tr><td><code>montecarlo</code></td>
<td>
<p>It is a matrix where the first line collects the values of Omean, E, CW and Cws for the provided dataset, and the following lines hold the Monte Carlo resampled values.</p>
</td></tr>
<tr><td><code>pop.diet</code></td>
<td>
<p>Option specifying the way to calculate the population diet. Valid values are &ldquo;sum&rdquo; or &ldquo;average&rdquo;.</p>
</td></tr>
<tr><td><code>ind.type</code></td>
<td>
<p>The type of clustering coefficient to use. Valid values are Saramaki's and Barrat's index: &ldquo;saramaki&rdquo; or &ldquo;barrat&rdquo;.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>an index used in <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code> to point to the column of the matrix &lsquo;montecarlo&rsquo; for plotting results. If zero no Monte Carlo resampling is performed.</p>
</td></tr>
<tr><td><code>Precission</code></td>
<td>
<p>The value of the selected threshold for precision.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI.
Please note that the C code is partially based on the C source of Dieta.c by Araujo et al. (2008). The original source code Dieta1.c (identifier E089-115-A1; <a href="http://esapubs.org/archive/ecol/E089/115/">http://esapubs.org/archive/ecol/E089/115/</a>) can be downloaded from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>)</p>


<h3>References</h3>

<p>Araujo M.S., Guimaraes Jr., P.R., Svanback, R., Pinheiro, A., Guimaraes P., dos Reis, S.F., and Bolnick, D.I. 2008. Network analysis reveals contrasting effects of intraspecific competition on individual vs. population diets. <em>Ecology</em> <b>89</b>: 1981-1993.
</p>
<p>Araujo M.A., Layman C., and Bolnick, D.I. 2011. The ecological causes of individual specialization. <em>Ecology Letters</em> <b>14</b>: 948-958.
</p>
<p>Schoener, T.W. 1968. The <em>Anolis</em> lizards of Bimini: resources partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>


<h3>See Also</h3>

<p> Function <code><a href="#topic+Eindex">Eindex</a></code>, <code><a href="#topic+Null.Hp.RInSp">Null.Hp.RInSp</a></code>, <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Example with stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site B)
GutContents_SiteB &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "B"))
# Warning, the number of replicates is set low to speed up the example!
# Note, for real analyses we recommend to set replicates =&gt; 999
ResEmc &lt;- Emc(GutContents_SiteB, popd.type = "average", replicates = 99)

# This Eadj re-scales the observed E value to range from 0 when
# it is equal to the null expectation, up to a maximum of 1.
# This allows comparison of E values across samples with
# different null Es.
# For example, consider a case with no individual specialization
Nulldata &lt;- Null.Hp.RInSp(GutContents_SiteB, prop="average")
# Warning, the number of replicates is set low to speed up he example!
# Note, for real analyses we recommend to set replicates =&gt; 999
EmcNull &lt;- Emc(Nulldata, popd.type = "average", replicates = 99)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Hier2L'>
Variance partition and WIC/TNW
</h2><span id='topic+Hier2L'></span>

<h3>Description</h3>

<p>Variance partition based on a single multi-level factor and comparison of the relative contribution of the &ldquo;<em>Between Group Component</em>&rdquo; (BGC) versus the ratio WIC/TNW. For a more general discussion of variance partition the reader is pointed to Viola et al. (2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Hier2L(dataset, factor = 1, weight.type = "N_items")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Hier2L_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo;.</p>
</td></tr>
<tr><td><code id="Hier2L_+3A_factor">factor</code></td>
<td>
<p>Numeric value indicating the column in the <em>info</em> part of the RInSp input dataset containing the factor used for build subsets.</p>
</td></tr>
<tr><td><code id="Hier2L_+3A_weight.type">weight.type</code></td>
<td>
<p>The weighting option for unbalanced prey numbers. See details in <code><a href="#topic+WTcMC">WTcMC</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Beteen Group Component is calculated as the (population) variance of the mean values of the n-levels groups.
</p>
<p>The level of checking performed by the procedure is low. Pay attention to input parameters.
</p>


<h3>Value</h3>

<p>The result is a matrix of 5 rows by n+1 columns, when n is the number of levels of the factor used to create groups in the dataset. The first four rows are the values for WIC, BIC, TNC and WIC/TNW for all possible levels and the whole dataset. Last row is the value of the &ldquo;<em>Between Group Component</em>&rdquo; (BGC) for the n-levels factor.
</p>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI and Dr. Giorgio MANCINELLI</p>


<h3>References</h3>

<p>Violle C., Enquist B.J., McGill B.J., Jiang L., Albert C.H., Hulshof C., Jung V. and Messier J. 2012. The return of the variance: intraspecific variability in community ecology. <em>Trends in Ecology &amp; Evolution</em> <b>27</b>: 244252.
</p>


<h3>See Also</h3>

<p>Function <code><a href="#topic+WTcMC">WTcMC</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of variance decomposition
data(Trout)
TroutRIS &lt;- import.RInSp(Trout, col.header=TRUE, row.names=1, info.cols=2, data.type="double")
decomp &lt;- Hier2L(TroutRIS, factor=1)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='import.RInSp'>
Import data into a RInSp object
</h2><span id='topic+import.RInSp'></span>

<h3>Description</h3>

<p>The procedure reads and checks data to create an object of class RInSp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import.RInSp(filename, col.header=FALSE, row.names = 0, info.cols= 0,
             subset.column = 0, subset.rows = NA, data.type= "integer",
             print.messages=TRUE, sep = "", dec = ".")

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import.RInSp_+3A_filename">filename</code></td>
<td>
<p>Name of the file or dataframe to be read.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_col.header">col.header</code></td>
<td>
<p>Logical value to indicate if a header row is there. Default is FALSE.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_row.names">row.names</code></td>
<td>
<p>Numeric value for column of rows' name. Default is zero for no names.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_info.cols">info.cols</code></td>
<td>
<p>A vector collecting columns numbers for additional information. Defaults is to have no additional information.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_subset.column">subset.column</code></td>
<td>
<p>A vector of columns' indices to be used as a subset. Default is to have no columns subsetting.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_subset.rows">subset.rows</code></td>
<td>
<p>A string vector where the first element points to the column name to be used for rows subsetting, and following elements with criteria. Default is to have no rows subsetting.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_data.type">data.type</code></td>
<td>
<p>Data type among &quot;integer&quot; or &quot;double&quot;. From the data a proportion matrix will be produced. Default is to use integers/counts values.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_print.messages">print.messages</code></td>
<td>
<p>Prints messages concerning the number of rows and columns eventually deleted after subsetting because composed of all zeros. Default is TRUE.</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_sep">sep</code></td>
<td>
<p>The field separator character. Values on each line of the file are separated by this character. If <code>sep = ""</code> (the default for <code>read.table</code>) the separator is ‘white space’, that is one or more spaces, tabs, newlines or carriage returns</p>
</td></tr>
<tr><td><code id="import.RInSp_+3A_dec">dec</code></td>
<td>
<p>The character used in the file for decimal points.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three different types of data can be used. Integer/count values and decimal/real values are stored in the &ldquo;resources&rdquo; section of the output list and used to derive all meaningful information. While for proportions the &ldquo;resources&rdquo; section will be empty. Valid key words are: &ldquo;integer&rdquo;, &ldquo;double&rdquo;, and &ldquo;proportion&rdquo;. Use zero for empty cells.
</p>
<p>The procedure will check for the presence of zero sum columns/rows for the selected dataset. A warning is printed in case of column/row deletion. It must be considered that the degree of checking on the subsetting is low.
</p>


<h3>Value</h3>

<p>Return an list of class RInSp composed by:
</p>
<table>
<tr><td><code>resources</code></td>
<td>
<p>A matrix of the resources data.</p>
</td></tr>
<tr><td><code>proportions</code></td>
<td>
<p>A matrix of proportions of each resources in its row. This matrix can be imported into the software PAJEK (<a href="http://vlado.fmf.uni-lj.si/pub/networks/pajek/">http://vlado.fmf.uni-lj.si/pub/networks/pajek/</a>) to draw a weighted bipartite network connecting individuals to the various prey categories.</p>
</td></tr>
<tr><td><code>data.type</code></td>
<td>
<p>Data type used.</p>
</td></tr>
<tr><td><code>col.names</code></td>
<td>
<p>Name of the different columns of the resource data.</p>
</td></tr>
<tr><td><code>ind.names</code></td>
<td>
<p>Name of the individual.</p>
</td></tr>
<tr><td><code>info</code></td>
<td>
<p>A data frame containing additional information for the resource data.</p>
</td></tr>
<tr><td><code>num.prey</code></td>
<td>
<p>Number of resources/prey (i.e., columns) in the dataset after zero sum checking.</p>
</td></tr>
<tr><td><code>num.individuals</code></td>
<td>
<p>Number of individuals/sites (i.e., rows) in the dataset after zero sum checking.</p>
</td></tr>
<tr><td><code>num.zero.prey</code></td>
<td>
<p>Number of resources/prey (i.e., columns) in the dataset without zero sum checking.</p>
</td></tr>
<tr><td><code>num.ind.zero</code></td>
<td>
<p>Number of individuals/sites (i.e., rows) in the dataset without zero sum checking.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Stickleback)
# Import data
GutContents &lt;- import.RInSp(Stickleback,  row.names = 1, info.cols = c(2:13))
GutContents
# Select a single spatial sampling site (site A)
GutContents_SiteA &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13),
subset.rows &lt;- c("Site", "A"))

# Select a subset of prey types
GutContents_subset &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13),
subset.column &lt;- c(13:28, 45))

# Lump prey types into functional groups then import data
# define new columns representing lumped prey categories
attach(Stickleback)
Copepods &lt;- Calanoid + Cyclopoid + Harpacticoid
Diptera &lt;- Diptera.Pupae + Chironomid.larvae + Ceratopogonid.larvae + Tipulid.larvae +
Tipulidae.Adult + Diptera.Adult + Diptera.Larvae + Ceratopogonid.Adult
InsectLarvae &lt;- Ephemeroptera + Trichoptera.larvae + Ephemeroptera.pupae +
Zygoptera.larvae + Plecoptera.larvae
Cladocera &lt;- Bosmina + Polyphemus + Holopedium + Daphnia + Chydorus
names(Stickleback)
GutContents_lumped &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13),
subset.column &lt;- c(18,24,28,31,43:46))
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Likelihood+20and+20Wi'>Likelihood measure of niche breadth</h2><span id='topic+like.Wi'></span>

<h3>Description</h3>

<p>The procedure calculates the estimation of likelihood measures of niche breadth and overlap described in Petraitis (1979).</p>


<h3>Usage</h3>

<pre><code class='language-R'>like.Wi(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Likelihood+2B20and+2B20Wi_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function returns the likelihood of the observed diet (<code class="reqn">\lambda_i</code>) the associated probability , and the value of the Petraitirs' W.
The likelihood of the observed diet of individual <em>i</em> is:
</p>
<p style="text-align: center;"><code class="reqn">\lambda_i = \prod_j (\frac{q_j}{p_{ij}})^{n_{ij}}</code>
</p>

<p>where <code class="reqn">q_j</code> is the population proportion of the resource <em>j</em>, <code class="reqn">p_{ij}</code> is the proportion of the resource <em>j</em> in the diet of the individual <em>i</em>, and <code class="reqn">n_{ij}</code> is the number of items for the individual <em>i</em> and the resource <em>j</em>.
</p>
<p>This can be used to calculate a p-value to test the significance of the diet specialization, as <code class="reqn">-2ln(\lambda)</code> is distributed as a chi-square with (r-1) degrees of freedom, where r is the number of resource categories.
</p>
<p>The generalised likelihood ratio test rejects the null hypothesis for a unilateral alternative hypotesis using significance level <code class="reqn">\alpha</code> if:
</p>
<p style="text-align: center;"><code class="reqn">-2ln(\lambda) &gt; \chi^2_{(r-1)}</code>
</p>

<p>Petraitis' W is computed following:
</p>
<p style="text-align: center;"><code class="reqn">W_i = \lambda_i^{(1/D_i)}</code>
</p>

<p>where <code class="reqn">D_i</code> is the number of diet items recorded in the diet of individual <em>i</em>. This index is a measure of niche width relative to a specified distribution. For a complete generalist individual, <code class="reqn">W_i = 1</code>, and the value decreases with greater specialization.
</p>


<h3>Value</h3>

<p>Return a list of class RInSp with:
</p>
<table>
<tr><td><code>MeanWi</code></td>
<td>
<p>the mean population value of Wi;</p>
</td></tr>
<tr><td><code>ResCat</code></td>
<td>
<p>the number of resource categories;</p>
</td></tr>
<tr><td><code>ind.vals</code></td>
<td>
<p>A matrix with three columns: &ldquo;Likelihood&rdquo; with value of the likelihood index for the individual <em>i</em>; &ldquo;p-value&rdquo; for the the probability associated to the likelihood value; &ldquo;Wi&rdquo; with the value of the Petraitis' W index for the individual <em>i</em>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Petraitis, P. S. 1979. Likelihood measures of niche breadth and overlap. <em>Ecology</em> <b>60</b>(4): 703-710.
</p>
<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Likelihood and Wi example with stickleback data
# from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site D)
SiteD &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "D"))
Wi &lt;- like.Wi(SiteD)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='MCp.RInSp'>Monte Carlo resampling procedure</h2><span id='topic+MCp.RInSp'></span>

<h3>Description</h3>

<p>The procedure replicates the two strategies of Monte Carlo resampling available in the following commands: <code><a href="#topic+Emc">Emc</a></code>, <code><a href="#topic+PSicalc">PSicalc</a></code>, <code><a href="#topic+WTdMC">WTdMC</a></code>, and <code><a href="#topic+WTcMC">WTcMC</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MCp.RInSp(dataset, pop.diet = "sum", replicates = 999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MCp.RInSp_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo; or &ldquo;integer&rdquo;.</p>
</td></tr>
<tr><td><code id="MCp.RInSp_+3A_pop.diet">pop.diet</code></td>
<td>
<p>Option specifying the type of calculation for the population diet: &ldquo;sum&rdquo; or &ldquo;average&rdquo;. See <code><a href="#topic+pop.diet">pop.diet</a></code> for details.</p>
</td></tr>
<tr><td><code id="MCp.RInSp_+3A_replicates">replicates</code></td>
<td>
<p>Number of resampled data matrices.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Araujo et al (2011) for a discussion of the biological assumptions underlying this Monte Carlo resampling procedure.
</p>
<p>For counts of individual prey items representing approximately independent prey-capture decisions (i.e., integer data type), it is possible to run a Monte Carlo resampling simulation to test the null hypothesis that any observed diet variation arose from individuals sampling stochastically from a shared distribution. In the simulations, each individual is assigned a number of prey items equal to the number of items it was observed eating, and then prey items are randomly assigned to the individual's diet via multinomial sampling from the observed population resource distribution.
</p>
<p>For double data type, as mass of each food category in an individual's gut, the Monte Carlo resampling procedure first determines the number of prey used by each individual, <code class="reqn">n_i</code>. The program then randomly reassigns each individual <code class="reqn">n_i</code> prey items drawn from the population distribution of items. This is repeated a user-specified number of times. Hence, the resampled population yields a null model corresponding to a population composed of generalists that sample randomly from the population's diet, and have diet sizes equal to those of the observed data set.
</p>
<p>The procedure can easily create a big three dimensional array. This object can create problems as it can consume an huge amount of memory. If needed use a package like &ldquo;ff&rdquo; and a for loop to create an array able to hold the results.
</p>


<h3>Value</h3>

<p>A matrix of &ldquo;replicates + 1&rdquo; datasets with the same number of individuals/resources of the input file. The first matrix is the original input data file.</p>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Araujo M.A., Layman C., and Bolnick D.I. 2011. The ecological causes of individual specialization. <em>Ecology Letters</em> <b>14</b>: 948-958.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+pop.diet">pop.diet</a></code>, <code><a href="#topic+Emc">Emc</a></code>, <code><a href="#topic+PSicalc">PSicalc</a></code>, <code><a href="#topic+WTdMC">WTdMC</a></code>, <code><a href="#topic+WTcMC">WTcMC</a>.</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Monte Carlo resampling for NODF
# EXAMPLE NOT RUN
# with stickleback data from Bolnick and Paull 2009
# data(Stickleback)
# Select a single spatial sampling site (site A)
# SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
# info.cols = c(2:13), subset.rows = c("Site", "A"))
# nreplicates &lt;- 999
# Null.data &lt;- MCp.RInSp(SiteA, replicates = nreplicates)
# Build a vector holding real and resampled results
# the NODF values and warning messages from import.RInSp
# are printed, too.
# null.d.NODF &lt;- c()
# for (i in 1:(nreplicates + 1)) {
#   null.d.NODF &lt;- c(null.d.NODF, NODF(import.RInSp(Null.data[ , , i], print.messages=FALSE),
#  print.results=FALSE)$NODF)
# }
# hist(null.d.NODF)
# summary(null.d.NODF)
# Observed value of NODF from data
# null.d.NODF[1]
# rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='NODF'>
Nestedness metric based on overlap and decreasing fill</h2><span id='topic+NODF'></span>

<h3>Description</h3>

<p>The procedure calculates the &ldquo;nestedness metric based on overlap and decreasing fill&rdquo; (NODF) for a binary matrix following Almeida-Neto et al. (2008).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NODF(dataset, print.results= TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NODF_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo; or &ldquo;integer&rdquo;.</p>
</td></tr>
<tr><td><code id="NODF_+3A_print.results">print.results</code></td>
<td>
<p>Define if results for NODF should be printed. Default is TRUE</p>
</td></tr></table>
<p>.
</p>


<h3>Details</h3>

<p>Nestedness is a feature of binary matrices (also called presence/absence or incidence matrices). The notion of nestedness is particularly relevant for studies focusing the patterns of species occurrence among a set of locations (e.g., islands) and the patterns of interacting species within ecological networks.
</p>
<p>Almeida-Neto et al. (2008) propose a nestedness metric is based on two simple properties: decreasing fill (or DF) and paired overlap (or PO). Assuming that in a matrix with m rows and n columns, row i is located at an upper position from row j, and column k is located at a left position from column l. In addition, let MT be the marginal total (i.e. the sum of 1's) of any column or row. For any pair of rows/columns i and j, <code class="reqn">DF_{ij}</code> will be equal to 100 if <code class="reqn">MT_j</code> is lower than <code class="reqn">MT_i</code>. Alternatively, <code class="reqn">DF_{ij}</code> will be equal to 0 if <code class="reqn">MT_j</code> is greater or equal to <code class="reqn">MT_i</code>. For columns/rows, paired overlap (<code class="reqn">PO_{kl}</code>) is simply the percentage of 1's in a given column/row l that are located at identical row/column positions to those in a column/row k. For any left-to-right column pair and, similarly, for any up-to-down row pair, there is a degree of paired nestedness (<code class="reqn">N_{paired}</code>) as zero if <code class="reqn">DF_{paired}</code> is zero, and PO if <code class="reqn">DF_{paired}</code> is 100.
</p>
<p>From the <code class="reqn">n(n-1)/2</code>  and <code class="reqn">m(m-1)/2</code> paired degrees of nestedness for n columns and m rows, we can calculate a measure of nestedness among all columns (<code class="reqn">N_{col}</code>) and among all rows (<code class="reqn">N_{row}</code>) by simply averaging all paired values of columns and rows.
</p>
<p>Finally, the measure of nestedness for the whole matrix is given by:
</p>
<p style="text-align: center;"><code class="reqn"> NODF = \frac{\sum{N_{paired}}}{(\frac{n(n-1)}{2})+(\frac{m(m-1)}{2})} </code>
</p>

<p>In the context of studies of individual specialization, one form of diet variation arises when individuals differ in their niche breadth, such that some individuals diet is a subset of other individuals' diet. This is revealed by a nestedness metric, which may be large (indicating nesting) or small (indicating clustering).
</p>


<h3>Value</h3>

<p>The result is a list of class &lsquo;RInSp&rsquo; composed of:
</p>
<table>
<tr><td><code>NODF</code></td>
<td>
<p>Value of the index of nestedness.</p>
</td></tr>
<tr><td><code>Nrows</code></td>
<td>
<p>Value of the index of nestedness for rows.</p>
</td></tr>
<tr><td><code>Ncols</code></td>
<td>
<p>Value of the index of nestedness for columns.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Binary matrix with individuals as rows and resources as columns. This matrix can be imported into the software PAJEK (<a href="http://vlado.fmf.uni-lj.si/pub/networks/pajek/">http://vlado.fmf.uni-lj.si/pub/networks/pajek/</a>) to draw a binary bipartite network of diet connectance between individuals (one set of nodes) and resources (a second set of nodes).</p>
</td></tr>
<tr><td><code>NpR</code></td>
<td>
<p>The degree of nestedness observed for rows.</p>
</td></tr>
<tr><td><code>NpC</code></td>
<td>
<p>The degree of nestedness observed for columns.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Almeida-Neto M., Guimaraes P., Guimaraes P.R., Loyola R.D., and Ulrich, W. 2008. A consistent metric for nestedness analysis in ecological systems: reconciling concept and measurement. <em>Oikos</em> <b>117</b>: 1227-1239.
</p>


<h3>See Also</h3>

<p>For further indices see the R package &ldquo;vegan&rdquo;. Please consider that the NODF implementation lacks the ordering and weighting options of <em>nestednodf</em> available in &ldquo;vegan&rdquo;.</p>


<h3>Examples</h3>

<pre><code class='language-R'># NODF example with stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site D)
SiteD &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13),
subset.rows = c("Site", "D"))
Nesting &lt;- NODF(SiteD)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Null.Hp.RInSp'>Generate a data set based on a specific null hypothesis</h2><span id='topic+Null.Hp.RInSp'></span>

<h3>Description</h3>

<p>The procedure let you build an integer/count dataset of class RInSp:
</p>
<p>- by fixing the number of items/resources per individual and the population diet;
</p>
<p>- by providing a specific dataset of class RInSp and and option of &ldquo;sum&rdquo; or &ldquo;average&rdquo; for the population diet.
</p>
<p>It builds a table with a specified number of individuals and for each, a resources vector is created using a multinomial distribution with probability equal to the specified population diet and number of items.
</p>
<p>As the procedure checks for zero sum columns/rows, it can be time consuming.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Null.Hp.RInSp(dataset, prop = "sum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Null.Hp.RInSp_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;integer&rdquo; or a numeric integer vector specifying the number of items for each individual in the simulated data set.</p>
</td></tr>
<tr><td><code id="Null.Hp.RInSp_+3A_prop">prop</code></td>
<td>
<p>Option specifying the type of calculation for population diet. Two types are valid when &ldquo;dataset&rdquo; is an object of class RInSp: &ldquo;sum&rdquo; or &ldquo;average&rdquo;. For details see <code><a href="#topic+pop.diet">pop.diet</a></code>. Or a numeric vector when the counts of items for individuals is provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The procedure can take a long time as it assure that the final data set has no columns/rows sum equal to zero.
</p>
<p>It can be used under two scenarios:
</p>
<p>- when a specific data set of integer/count data is of interest, it can be used as input to generate a null data set with the same number of individuals/resources and total number of diet items, but the probability of assignment can be derived by the population diet (providing the &ldquo;sum&rdquo; or &ldquo;average&rdquo;) or a diet specified by the user;
</p>
<p>- to generate a null data set by specifying the total number of items for each individual and the probability of the resource type in the diet using a diet provided.
</p>
<p>When the user provides the number of items for individuals, the procedure checks for negative values and it converts the numbers into integers.
</p>
<p>When the diet is specified by the user, the procedure will convert all values into positive numbers and recalculate the proportions of each entry, so to ensure to have a vector of probabilities (i.e., sum equal to one, values between zero and one).
</p>
<p>A progress bar shows the progress in generating random samples till a maximum of 400 new random data sets.
</p>
<p>The procedure can easily create a big three dimensional array. This object can create problems as it can consume an huge amount of memory. If needed use a package like &ldquo;ff&rdquo; and a for loop to create an array able to hold the results.
</p>


<h3>Value</h3>

<p>An object of class RInSp holding the null model data set.
</p>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI and Dr. I. Bolnick</p>


<h3>See Also</h3>

<p> Function <code><a href="#topic+pop.diet">pop.diet</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example with stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Null model using a specified data set
SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "A"))
Eresult &lt;- Eindex(SiteA, index = "saramaki", jackknife = FALSE)
Nulldata &lt;- Null.Hp.RInSp(SiteA, prop="average")
Eresult &lt;- Eindex(Nulldata, index = "saramaki", jackknife = FALSE)

# Null model with diet and per individual resource
# Generate a number-of-items-per-individual vector for 30 individuals
ind.resources &lt;- floor(runif(30, 15, 120))
# Generate a population diet with 6 items
diet &lt;- c(10, 30, 15, 60, 100)
Nulldata2 &lt;- Null.Hp.RInSp(ind.resources, prop= diet)
Eresult2 &lt;- Eindex(Nulldata2, index = "saramaki", jackknife = FALSE)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='overlap'>Mean pairwise overlap</h2><span id='topic+overlap'></span>

<h3>Description</h3>

<p>This procedure calculates the pairwise diet overlap between all individuals in a sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>overlap(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="overlap_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For a sample size of N individuals, this will produce an N * N matrix, each cell <code class="reqn">o_{ik}</code> representing the diet overlap between individual i and individual k. The diagonal is all ones because an individual has a 100% overlap with itself. Pairwise overlap is calculated by determining the proportional similarity between each individual.
</p>
<p>The script reports the average pairwise diet overlap (not including diagonal values), the average pairwise diet dissimilarity (i.e., one minus the average pairwise diet overlap) and the complete diet overlap matrix. The overlap matrix can be useful for testing whether diet (dis)similarity is a function of various other metrics of between-individual difference or similarity (e.g., Bolnick and Paull 2009).</p>


<h3>Value</h3>

<p>Return an matrix of three columns:
</p>
<table>
<tr><td><code>meanoverlap</code></td>
<td>
<p>The mean pairwise overlap for all pairs of individuals, excluding the diagonal.</p>
</td></tr>
<tr><td><code>meanindividualoverlap</code></td>
<td>
<p>The mean pairwise overlap for individual i and all others, excluding the diagonal.</p>
</td></tr>
<tr><td><code>meandissimilarity</code></td>
<td>
<p>The mean pairwise dissimilarity overlap for all pairs of individuals, excluding the diagonal.</p>
</td></tr>
<tr><td><code>overlapmatrix</code></td>
<td>
<p>The probability associated to the likelihood value.</p>
</td></tr>
<tr><td><code>parameter=0</code></td>
<td>
<p>Internal option for plotting results.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Bolnick, D.I., and Paull, J.S., 2009. Morphological and dietary differences between individuals are weakly but positively correlated within a population of threespine Stickleback. <em>Evolutionary Ecology Research</em> <b>11</b>: 1217-1233.
</p>
<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> data(Stickleback)
# Select a single spatial sampling site (site D)
GutContents_SiteD = import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "D"))
similarity = overlap(GutContents_SiteD)

## Not run: 
# Generate a plot similar to Bolnick and Paull 2009, testing whether
# morphological differences between individuals are positively related
# to diet differences (or conversely are negatively related to diet similarity)
GutContents &lt;- import.RInSp(Stickleback, row.names = 1,info.cols = c(2:13))
similarity &lt;- overlap(GutContents)
diet.similarity &lt;- as.dist(similarity$overlapmatrix)
size.dissimilarity &lt;- dist(GutContents$info[,3])
plot(diet.similarity ~ size.dissimilarity, xlab = "Size dissimilarity",
ylab = "Diet similarity", pch = 16, cex = 0.4)
model &lt;- lm(diet.similarity ~ size.dissimilarity)
abline(model, lwd = 3, col = "red")

# The ade4 package is needed to complete the analysis
# not run
# library(ade4)
# mantel.rtest(diet.similarity, size.dissimilarity)

## End(Not run)
</code></pre>

<hr>
<h2 id='pop.diet'>
Calculate population diet
</h2><span id='topic+pop.diet'></span>

<h3>Description</h3>

<p>This function calculates the population diet using two different approaches: the &ldquo;sum&rdquo; or the &ldquo;average&rdquo; method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pop.diet(dataset, prop = "sum")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pop.diet_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data.</p>
</td></tr>
<tr><td><code id="pop.diet_+3A_prop">prop</code></td>
<td>
<p>Option specifying the type of calculation. Two types: &ldquo;sum&rdquo; or &ldquo;average&rdquo;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The &ldquo;sum&rdquo; approach is the most straightforward. One sums up all resource counts within a category across all individuals to get the population's use, then determine the proportion of each resource category in the population's repertoire. The proportion <code class="reqn">q_j</code> of the resource j in the population's diet is:
</p>
<p style="text-align: center;"><code class="reqn">q_j = \frac{\sum_i{n_{ij}}}{\sum_{ji}{n_{ij}}}</code>
</p>

<p>The drawback of this approach is that individuals that eat large numbers of items, or larger total mass of items, will bias the population to look more like them.
</p>
<p>The &ldquo;average&rdquo; method (average proportion) circumvents this problem by first converting individual diets into proportions <code class="reqn">p_{ik}</code>, then averaging these proportions for each resource k.
</p>
<p>Along with the population's diet the procedure calculates the Levins' D index (Levins 1968) of diversity as:
</p>
<p style="text-align: center;"><code class="reqn"> D = 1 - \frac{1}{\sum{q_{j}^2}}</code>
</p>



<h3>Value</h3>

<p>Returns a list of information:
</p>
<table>
<tr><td><code>popdiet</code></td>
<td>
<p>Vector of the specified population diet.</p>
</td></tr>
<tr><td><code>popdtype</code></td>
<td>
<p>The type of population diet.</p>
</td></tr>
<tr><td><code>richness</code></td>
<td>
<p>The richness of resources (for now it has sense only for integer data type).</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>The Levins' D index for resources.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Levins R. 1968. <em>Evolution in Changing Environments: Some Theoretical Explorations</em>. Princeton Univ. Press.
</p>


<h3>See Also</h3>

<p> Function <code><a href="#topic+Null.Hp.RInSp">Null.Hp.RInSp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Stickleback)
# Select a single spatial sampling site (site D)
GutContents_SiteD &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13),
subset.rows = c("Site", "D"))
PopDiet &lt;- pop.diet(GutContents_SiteD, prop = "average")
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='PSicalc'>Calculate the proportional similarity index</h2><span id='topic+PSicalc'></span>

<h3>Description</h3>

<p>A measure of individual specialization proposed by Bolnick et al. (2003), based on the average pairwise overlap of the niche distribution of individuals and the population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PSicalc(dataset, pop.diet = "sum", exclude = FALSE, replicates=999, precision = 1e-9)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PSicalc_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data.</p>
</td></tr>
<tr><td><code id="PSicalc_+3A_pop.diet">pop.diet</code></td>
<td>
<p>Option specifying the way to calculate the population diet. Valid values are &ldquo;sum&rdquo; or &ldquo;average&rdquo;.</p>
</td></tr>
<tr><td><code id="PSicalc_+3A_exclude">exclude</code></td>
<td>
<p>A logical value to exclude or not the individual in variance estimates. Defalut is FALSE, i.e. keep all individuals.</p>
</td></tr>
<tr><td><code id="PSicalc_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for Monte Carlo resampling.</p>
</td></tr>
<tr><td><code id="PSicalc_+3A_precision">precision</code></td>
<td>
<p>a filter to remove from the PS matrix all values which are lower than &quot;precision&quot;. In this way some interactions are removed due to their small weight in the PS matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both Schoener (1968) and Feinsinger et al. (1981) advocated using Czekanowski's proportional similarity index (PS) for interspecific niche studies. Adapted to individual-level analyses, the diet overlap between an individual and the population is:
</p>
<p style="text-align: center;"><code class="reqn"> PS_i = 1 - 0.5 \sum_j{|p_{ij} - q_j|} </code>
</p>

<p>where <code class="reqn">p_{ij}</code> is the frequency of category j in the individual i's diet, and <code class="reqn">q_j</code>  is the frequency of category j in the population as a whole.
The prevalence of individual specialization (IS) in the population is then measured by the average of individuals' PS values:
</p>
<p style="text-align: center;"><code class="reqn">IS = \frac{\sum_i(PS_i)}{N}</code>
</p>

<p>Monte Carlo resampling for hypothesis testing is implemented for the case when all individuals are kept.
</p>
<p>The user has the option of calculating each individual's <code class="reqn">PS_i</code> and <code class="reqn">Var(PS_i)</code> using <code class="reqn">q_j</code> values calculated by either including or excluding individual i.</p>


<h3>Value</h3>

<p>The function returns a list composed by:
</p>
<table>
<tr><td><code>PSi</code></td>
<td>
<p>A column vector with the individual proportional similarity index for each individual i.</p>
</td></tr>
<tr><td><code>IS</code></td>
<td>
<p>The value of the prevalence of individual specialization.</p>
</td></tr>
<tr><td><code>PSi.montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code></p>
</td></tr>
<tr><td><code>Var.montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code>'s variance</p>
</td></tr>
<tr><td><code>VarPSi</code></td>
<td>
<p>A column vector of the estimated variance for each individual.</p>
</td></tr>
<tr><td><code>population.diet</code></td>
<td>
<p>A vector describing the population diet. A matrix is returned when &ldquo;exclude&rdquo; is TRUE.</p>
</td></tr>
<tr><td><code>IS.pvalue</code></td>
<td>
<p>Probability value for the observed IS against the Monte Carlo resampling simulation. Consider to use more than 1000 simulations.</p>
</td></tr>
<tr><td><code>montecarlo</code></td>
<td>
<p>Monte Carlo resampling simulation values for <code class="reqn">PS_i</code></p>
</td></tr>
<tr><td><code>num.individuals</code></td>
<td>
<p>The number of individuals of the data set.</p>
</td></tr>
<tr><td><code>parmeter</code></td>
<td>
<p>The value points to the column of the &ldquo;montecarlo&rdquo; matrix for plotting results.</p>
</td></tr>
<tr><td><code>Precission</code></td>
<td>
<p>The value of the selected threshold for precision.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>References</h3>

<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Feinsinger, P., Spears, E. E., and Poole, R. W. 1981. A simple measure of niche breadth. <em>Ecology</em>  <b>62</b>: 27-32.
</p>
<p>Schoener, T.W. 1968. The <em>Anolis</em> lizards of Bimini: resource partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># PSicalc example using stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site A)
GutContents_SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "A"))
# Warning, the number of replicates is set low to speed up he example!
# Note, for real analyses we recommend to set replicates =&gt; 999
PSi &lt;- PSicalc(GutContents_SiteA, exclude = FALSE, replicates = 99)
sumMC.RInSp(PSi)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='RInSp-package'>
R Individual Specialization
</h2><span id='topic+RInSp-package'></span><span id='topic+RInSp'></span>

<h3>Description</h3>

<p>&ldquo;R Individual Specialization&rdquo; (RInSp) is an R package for analysing resource use data to calculate ecological measures of within-population niche variation based on data on individuals' resource use (e.g., stomach contents, repeated observations of prey choice or habitat use). The package implements several ecological niche metrics to measure individual and population niche width in order to measure individual specialization. This version of RInSp is able to compute Araujo's E, measures of clustering and pairwise similarity among individuals, IS, Petraitis' W, and Roughgarden's WIC/TNW, and an example of a measure of nestedness (NODF). For some of these indices Monte Carlo re-sampling procedures for testing significance are provided.
</p>
<p>To cite package check the command <code>CITATION</code> or use:
</p>
<p>Zaccarelli, N., Mancinelli, G. and Bolnick, D.I. (2013) RInSp: an R package for the analysis of individual specialisation in resource use. Methods in Ecology and Evolution, 4(11): 1018-1023, doi: 10.1111/2041-210X.12079
</p>
<p>This package can be used on Mac, Windows and UNIX platforms, and on both i386 and x64 architectures. It is based on IndSpec1.0 developed by Prof. D. Bolnick (Bolnick et al. 2002), and on Dieta1 developed by Dr. M.A. Araujo (Araujo et al. 2008).
</p>
<p>The original source code of IndSpec1.0 is available from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>): identifier E083-056-S1; <a href="http://esapubs.org/archive/ecol/E083/056/">http://esapubs.org/archive/ecol/E083/056/</a>.
The original source code Dieta1 is available from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>): identifier E089-115-A1; <a href="http://esapubs.org/archive/ecol/E089/115/">http://esapubs.org/archive/ecol/E089/115/</a>.
</p>
<p>Version 1.1 of the package fixes three issues:
</p>

<ol>
<li><p> in <code><a href="#topic+Eindex">Eindex</a></code> the case of highly specialised individuals is now handled correctly;
</p>
</li>
<li><p> in <code><a href="#topic+like.Wi">like.Wi</a></code> the probability for each value of Petraitis' W is properly handled;
</p>
</li>
<li><p> in <code><a href="#topic+Emc">Emc</a></code> the C code taken from Dieta1.c has been fixed for an error in the calculation of the weight matrix when highly specilised individuals are present.</p>
</li></ol>

<p>Version 1.2.3 of the package has been changed to address the following things:
</p>

<ol>
<li><p> we introduce a filter to remove from the PS matrix all values which are lower than a set threshold (i.e., the parameter &quot;<em>precision</em>&quot;). In this way some interactions are removed due to their negligible weight in the PS matrix. The affected functions are: <code><a href="#topic+Eindex">Eindex</a></code>, <code><a href="#topic+Emc">Emc</a></code>, <code><a href="#topic+PSicalc">PSicalc</a></code> and the C code used for the resampling;
</p>
</li>
<li><p> in <code><a href="#topic+Eindex">Eindex</a></code> users are now warned for cases of isolated individuals by means of a text message and by the value of the variable <em>Isolation</em>;
</p>
</li>
<li><p> all progressbars are removed from all functions, so in case your problem is big have a little bit of patience;
</p>
</li>
<li><p> now <code><a href="#topic+Eindex">Eindex</a></code> and <code><a href="#topic+Emc">Emc</a></code> will work corectly with the Barrat index in case of isolated individuals;
</p>
</li>
<li><p> Undefined global functions or variables are now properly registered in the NAMESPACE file;
</p>
</li>
<li><p> native routines have been registered and symbol search has een disabled;
</p>
</li>
<li><p> unprotected variables have been taken care of.
</p>
</li></ol>

<p>Version 1.2.4 of the package has been changed to address the following things:
</p>

<ol>
<li> <p><code><a href="#topic+import.RInSp">import.RInSp</a></code> has been fixed for an error affecting the subsetting;
</p>
</li>
<li><p> in <code><a href="#topic+import.RInSp">import.RInSp</a></code> we have add some flexibility in defining the separator and the decimal character in input files;
</p>
</li>
<li><p> all procedures have been revised to fix issues with the use of <code>class(.)</code>.
</p>
</li></ol>

<p>Version 1.2.5 of the package has been changed to address some warnings during the CRAN check procedure.
</p>
<p>The Authors thank for their help in imprving the package Miss Georgia Karoline Kosmala (<a href="mailto:geh_karol@hotmail.com">geh_karol@hotmail.com</a>), Miss Ambika Kamath (<a href="mailto:geh_karol@hotmail.com">geh_karol@hotmail.com</a>), Miss Isabel Fisk Baruque (<a href="mailto:isabel.fiskbaruque@gmail.com">isabel.fiskbaruque@gmail.com</a>), Mr Diogo B. Provete, and Dr. Marcio S. Araujo (<a href="mailto:msaraujo@rc.unesp.br">msaraujo@rc.unesp.br</a>).
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> RInSp</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2.5</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-05-18</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI <a href="mailto:nicola.zaccarelli@gmail.com">nicola.zaccarelli@gmail.com</a>, <br />
Dr. Giorgio MANCINELLI <a href="mailto:giorgio.mancinelli@unisalento.it">giorgio.mancinelli@unisalento.it</a>, <br />
and Prof. Dan BOLNICK <a href="mailto:daniel.bolnick@uconn.edu">daniel.bolnick@uconn.edu</a></p>


<h3>References</h3>

<p>Almeida-Neto M., Guimaraes P., Guimaraes P.R., Loyola R.D., and Ulrich W. 2008. A consistent metric for nestedness analysis in ecological systems: reconciling concept and measurement. <em>Oikos</em> <b>117</b>: 1227-1239.
</p>
<p>Araujo M.S., Guimaraes Jr., P.R., Svanback, R., Pinheiro, A., Guimaraes P., dos Reis, S.F., and Bolnick, D.I. 2008. Network analysis reveals contrasting effects of intraspecific competition on individual vs. population diets. <em>Ecology</em> <b>89</b>: 1981-1993.
</p>
<p>Araujo M.A., Layman C., and Bolnick D.I. 2011. The ecological causes of individual specialization. <em>Ecology Letters</em> <b>14</b>: 948-958.
</p>
<p>Aversen. J.N. 1969. Jackknifing U-statistics. <em>Annals of Mathematical Statistics</em> <b>40</b>: 2076-2100.
</p>
<p>Barrat A., Barthelemy M., Pastor-Satorras R., and Vespignani A. 2004. The architecture of complex weighted networks. <em>Proceedings of the National Academy of Sciences</em> <b>101</b>: 3747-3752
</p>
<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Bolnick, D.I., and Paull, J.S. 2009. Morphological and dietary differences between individuals are weakly but positively correlated within a population of threespine Stickleback. <em>Evolutionary Ecology Research</em> <b>11</b>: 1217-1233.
</p>
<p>Onnela J.P., Saramaki J., Kertesz J., and Kaski K. 2005. Intensity and coherence of motifs in weighted complex networks. <em>Physics Review E</em> <b>71</b>: 065103.
</p>
<p>Roughgarden, J. 1974. Niche width: biogeographic patterns among <em>Anolis lizard</em> populations. <em>American Naturalist</em> <b>108</b>: 429-411.
</p>
<p>Saramaki J., Kivela M., Onnela J.P., Kaski K., and Kertesz J. 2007. Generalizations of the clustering coefficient to weighted complex networks. <em>Physics Review E</em> <b>75</b>: 027105.
</p>
<p>Schoener, T.W. 1968. The <em>Anolis</em> lizards of Bimini: resources partitioning in a complex fauna. <em>Ecology</em> <b>49</b>: 704-726.
</p>
<p>Zaccarelli, N., Bolnick, D.I., and Mancinelli, G. 2013. RInSp: an R package for the analysis of individual specialization in resource use. <em>Methods in Ecology and Evolution</em> <b>4</b>: 1018-1023.
</p>

<hr>
<h2 id='RInSp2vegan'>
Vegan support procedure</h2><span id='topic+RInSp2vegan'></span>

<h3>Description</h3>

<p>The procedure converts an RInSp class object into a dataframe to be used as input for the &ldquo;Vegan&rdquo; package to calculate nestedness indices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>RInSp2vegan(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="RInSp2vegan_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo;, &ldquo;integer&rdquo; or &ldquo;proportions&rdquo;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result is a binary dataframe with rows and columns names from the input object.
</p>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>See Also</h3>

<p>For further indices see the R package &ldquo;vegan&rdquo;.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Stickleback)
# Select a single spatial sampling site (site D)
GutContents &lt;- import.RInSp(Stickleback, row.names = 1, info.cols = c(2:13))
risul &lt;- RInSp2vegan(GutContents)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Stickleback'>
Example of data from threespine Stickleback gut contents
</h2><span id='topic+Stickleback'></span>

<h3>Description</h3>

<p>Example of a raw data matrix to be used with the <code><a href="#topic+import.RInSp">import.RInSp</a></code> procedure. Data are from Bolnick and Paull (2009), studying individual specialization in threespine Stickleback (<em>Gasterosteus aculeatus</em>) from 5 sites within one lake in British Columbia. Data columns include:
</p>
<p>- FishID: a unique identifier for each individual fish;
</p>
<p>- Site: A-E, five locations around the lake where fish were collected;
</p>
<p>- Mass: fish mass in grams;
</p>
<p>- Standard.length, Body.width, gape.width: fish dimensions in centimetres;
</p>
<p>- raker.number: gill raker number;
</p>
<p>- raker.length: gill raker length (mm);
</p>
<p>- Sex: sex;
</p>
<p>- MicrogN, DeltaAir, MicrogC, DeltaPDB: stable isotope data for C and N stable isotope ratios.
</p>
<p>All other columns are counts of prey categories in Stickleback stomach contents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Stickleback)</code></pre>


<h3>References</h3>

<p>Bolnick, D.I., and Paull, J.S. 2009. Morphological and dietary differences between individuals are weakly but positively correlated within a population of threespine Stickleback. <em>Evolutionary Ecology Research</em> <b>11</b>: 1217-1233.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Stickleback)
summary(Stickleback)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='sumMC.RInSp'>
Summary function for Monte Carlo resampling results
</h2><span id='topic+sumMC.RInSp'></span>

<h3>Description</h3>

<p>The function  provides summary statistics on the Monte Carlo resampling simulated index distributions. It plots an histogram with the position of the actual value of the index for the original dataset (blue line) and the 2.5% and 97.5% percentile of the simulated distribution (red dashed lines).
</p>
<p>It works for objects of class &lsquo;RInSp&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumMC.RInSp(dataset)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumMC.RInSp_+3A_dataset">dataset</code></td>
<td>
<p>Dataset of class RInSp.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI</p>


<h3>See Also</h3>

<p> See also <code><a href="#topic+WTcMC">WTcMC</a></code>, <code><a href="#topic+WTdMC">WTdMC</a></code>, or <code><a href="#topic+Emc">Emc</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#  sumMC.RInSp example using stickleback data from Bolnick and Paull 2009
data(Stickleback)
# Select a single spatial sampling site (site A)
GutContents_SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "A"))
EmcRes &lt;- Emc(GutContents_SiteA, replicates=499)
sumMC.RInSp(EmcRes)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='Trout'>Example of continuous data from fish prey lengths of brown trout</h2><span id='topic+Trout'></span>

<h3>Description</h3>

<p>The example reproduces data published in Kahilainen &amp; Lehtonen (2001) on prey lengths from a sample of 59 individuals of stocked (S) and native (N) brown trout (<em>Salmo trutta</em>) in the subarctic Lake Muddusjarvi in northern Finland.
</p>
<p>Column names refer to:
</p>
<p>- FishID: a unique identifier for each individual fish within the geographic area;
</p>
<p>- Type: stocked (S) and native (N) brown trout.
</p>
<p>All other columns are lengths (in mm) of fish prey found in stomachs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Trout)</code></pre>


<h3>References</h3>

<p>Kahilainen, K. and Lehtonen, H. 2001. Resource use of native and stocked brown trout <em>Salmo trutta</em> L., in a subarctic lake. <em>Fisheries Management and Ecology</em> <b>8</b>: 83-94.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Summary of total length of preys in stomach content
# by geographic region
data(Trout)
# Mean prey length by individual
# First change zeros to NA
troutTMP &lt;- Trout
troutTMP[ troutTMP == 0] = NA
individuals &lt;- by(troutTMP[, 3:7], troutTMP[, 2], rowMeans, na.rm=TRUE)
TroutN &lt;- subset(Trout, Type == "N", PL1:PL5)
TroutN &lt;- TroutN[TroutN &gt; 0]
TroutS &lt;- subset(Trout, Type == "S", PL1:PL5)
TroutS &lt;- TroutN[TroutS &gt; 0]
boxplot(c(TroutS, TroutN) ~ c(rep("N", length(TroutN)), rep("S", length(TroutS))))
rm(list=ls(all=TRUE))

</code></pre>

<hr>
<h2 id='WTcMC'>
Monte Carlo resampling of WIC/TNW for the continuous case
</h2><span id='topic+WTcMC'></span>

<h3>Description</h3>

<p>The program calculates the Total Niche Width (TNW), and breaks TNW down into its Between Individual Component (BIC) and Within Individual Component (WIC). It reports these three statistics and the proportion WIC/TNW. Niche widths of the population, within individuals, and among individuals are calculated following Roughgarden's formulas (1974).
</p>
<p>A Monte Carlo resampling routine is used to calculate a null distribution for each of these statistics and generate a p-value testing the null hypothesis that all individuals sample equally from the population diet distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WTcMC(dataset, replicates = 999, weight = "equal", print.ris=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WTcMC_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;double&rdquo;.</p>
</td></tr>
<tr><td><code id="WTcMC_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for the Monte Carlo resampling.</p>
</td></tr>
<tr><td><code id="WTcMC_+3A_weight">weight</code></td>
<td>
<p>The weighting scheme for individuals. Default value is &ldquo;equal&rdquo;. Alternative value is &ldquo;N_items&rdquo;.</p>
</td></tr>
<tr><td><code id="WTcMC_+3A_print.ris">print.ris</code></td>
<td>
<p>Printing results to screen. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Roughgarden (1972) suggested that the total niche width of a population (TNW) can be broken down into two components: the variation in resource use within individuals (within-individual component, WIC), and the variance between individuals (between-individual component, BIC) so that TNW = WIC + BIC. Originally  developed  for  within-  and  between-phenotype (or between-sex) variation, it can be applied at the individual level. Assuming that variation in niche parameters can be expressed along a single continuous dimension x (e.g., prey size), let X be a matrix of diet data where each element <code class="reqn">x_{ij}</code> is the size (or other measure) of the jth prey item in individual i's diet. Then,
</p>
<p style="text-align: center;"><code class="reqn">TNW = Var(x_{ij})</code>
</p>

<p style="text-align: center;"><code class="reqn">WIC = E(Var(x_j | i))</code>
</p>

<p style="text-align: center;"><code class="reqn">BIC = Var(E(x_j | i))</code>
</p>

<p>The relative degree of individual specialization can be measured as the proportion of TNW explained by within-individual variation, WIC/TNW. As this value approaches 1, all individuals utilize the full range of the population's niche, whereas smaller values indicate decreasing inter-individual overlap and hence higher individual specialization.
</p>
<p>Roughgarden's WIC/TNW is limited to continuous diet data. To carry this approach over to discrete data such as the frequency of alternate prey taxa in the diet, Roughgarden (1979:510) proposed a measure that uses the Shannon-Weaver index as a proxy for variance (See <code><a href="#topic+WTdMC">WTdMC</a></code> for details).
</p>
<p>In case of a marked presence of individuals with one or few prey items, the relation TNW = BIC + WIC may not hold. In this case there is the option to weight the number of items per individuals following two alternatives:
</p>
<p>- &ldquo;equal&rdquo;: weighting by the number of items in each individual's diet, so those with more data contribute more to estimating parameters; <br />
- &ldquo;N_items&rdquo;: weighting each individual equally regardless of diet items number; requires weighting each diet item by the inverse of the number of items in the individual's diet for calculating TNW.
</p>
<p>The Monte Carlo resampling procedure first determines the number of prey used by each individual, <code class="reqn">n_i</code>. Subsequently, the procedure randomly reassigns each individual <code class="reqn">n_i</code> prey items drawn from the population distribution of items. This is repeated a user-specified number of times. Hence, the resampled population yields a null model corresponding to a population composed of generalists that sample randomly from the population's diet, and have diet sizes equal to those of the observed data set.
The original statistics are merged into the Monte Carlo set.
</p>


<h3>Value</h3>

<p>The result is a list of class &ldquo;RInSp&rdquo;composed of:
</p>
<table>
<tr><td><code>WonT</code></td>
<td>
<p>The value of WIC/TNW for the dataset &ldquo;dataset&rdquo;.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The Monte Carlo resampling probability value for the calculated WIC/TNW ratio.</p>
</td></tr>
<tr><td><code>montecarlo</code></td>
<td>
<p>is a matrix with the replicate number &lsquo;REP&rsquo;, the value of &lsquo;WIC&rsquo;, the value of &lsquo;BIC&rsquo;, the value of &lsquo;TNW&rsquo; and the derived value for &lsquo;WonT&rsquo;.  The first line holds the values for the provided dataset, and the following lines the results of the Monte Carlo resampling.</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>The weighting scheme for individuals used.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>An index used in <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code> to point to the column of the matrix &lsquo;montecarlo&rsquo; for plotting results.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI. Please note that the C code is partially based on the C++ source of IndSpec from Bolnick et al. (2002). For the &ldquo;weight&rdquo; option Travis Ingram is acknowledged (Ingram et al. 2011).
</p>
<p>The original source code of IndSpec1.0 is available from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>): identifier E083-056-S1; <a href="http://esapubs.org/archive/ecol/E083/056/">http://esapubs.org/archive/ecol/E083/056/</a>.</p>


<h3>References</h3>

<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Ingram,T., Stutz, W.E., Bolnick, D.I. 2011. Does intraspecific size variation in a predator affects its diet diversity and top-down control of prey? <em>PLoS ONE</em> <b>6</b>: e20782.
</p>
<p>Roughgarden, J. 1974. Niche width: biogeographic patterns among <em>Anolis lizard</em> populations. <em>American Naturalist</em> <b>108</b>: 429-411.
</p>


<h3>See Also</h3>

<p> Function <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example of analysis with the trout data from Finland
data(Trout)
TroutRIS &lt;- import.RInSp(Trout, col.header=TRUE, row.names=1, info.cols=2, data.type="double")
# Warning, the number of replicates is set low to speed up he example!
# Note, for real analyses we recommend to set replicates =&gt; 999
TroutRIS_MC &lt;- WTcMC(TroutRIS, replicates = 99)
sumMC.RInSp(TroutRIS_MC)
rm(list=ls(all=TRUE))
</code></pre>

<hr>
<h2 id='WTdMC'>
Monte Carlo resampling of WIC/TNW for the discrete case
</h2><span id='topic+WTdMC'></span>

<h3>Description</h3>

<p>The program calculates the Total Niche Width (TNW), and breaks TNW down into its Between Individual Component (BIC) and Within Individual Component (WIC). It reports these three statistics and the proportion WIC/TNW. Niche widths of the population, within individuals, and among individuals are calculated using the Shannon-Weaver diversity index on count data, following Roughgarden's formulas (1974) and Bolnick et al. (2002).
A Monte Carlo resampling routine is used to calculate a null distribution for each of these statistics and generate a p-value testing the null hypothesis that all individuals sample equally from the population diet distribution. Note that the bootstrapping procedure is only biologically meaningful when applied to integer data representing counts of individual prey within individual predators' diets, and should not be applied to other forms of data such as prey mass or proportion of total volume.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>WTdMC(dataset, pop.diet = "sum", replicates=999, print.ris=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="WTdMC_+3A_dataset">dataset</code></td>
<td>
<p>Object of class RInSp with data of type &ldquo;integer&rdquo;.</p>
</td></tr>
<tr><td><code id="WTdMC_+3A_pop.diet">pop.diet</code></td>
<td>
<p>Option specifying the way to calculate the population diet. Valid values are &ldquo;sum&rdquo; or &ldquo;average&rdquo;. See <code><a href="#topic+pop.diet">pop.diet</a></code> for details.</p>
</td></tr>
<tr><td><code id="WTdMC_+3A_replicates">replicates</code></td>
<td>
<p>Number of replicates for the Monte Carlo resampling.</p>
</td></tr>
<tr><td><code id="WTdMC_+3A_print.ris">print.ris</code></td>
<td>
<p>Printing results to screen. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Roughgarden's measures are the most widely reported indices of diet variation, due to historical precedent. They are closely analogous to an Analysis of Variance, in that one partitions the total variation in resource use (TNW) into within- and between-individual components (WIC and BIC). An advantage of this approach is that one can simultaneously evaluate the degree of diet variation (WIC/TNW), and shifts in individual and population niche widths. A drawback is that, for categorical diet data, the Shannon-Weaver measure of diversity can lead to biased estimates of diet variation (Bolnick et al. 2002). Despite its historical precedent, users are advised to avoid using WIC/TNW. This bias is not a concern for WIC/TNW measured on quantitative traits (prey size) rather than prey categories, but this is rarely done.
</p>
<p>Roughgarden (1979, pg 510) proposed a measure to describe the niche width based on Shannon-Weaver information theory. The following formulae are equivalent to Roughgarden's formulation, although we use different notation. Let N be a matrix of diet data, where elements <code class="reqn">n_{ij}</code> represent the number (or mass) of diet items in individual i's diet that fall in category j. This raw data matrix is then transformed into a proportion matrix P, with elements <code class="reqn">p_{ij}</code> describing the proportion of the jth resource category in individual (or phenotype) i's diet.
</p>
<p>Using these proportions or the raw numerical counts one then calculates population diet proportions (<code class="reqn">q_{k}</code>, see <code><a href="#topic+pop.diet">pop.diet</a></code> for details). These data can then be used to calculate WIC, BIC, and TNW (Roughgarden 1979; Bolnick et al. 2002):
</p>
<p style="text-align: center;"><code class="reqn">WIC = \sum_i{p_i} (- \sum_k{p_{ik} ln(p_{ik})})</code>
</p>

<p style="text-align: center;"><code class="reqn">BIC = \sum_k{p_i ln(p_i)} - \sum_k{q_k (- \sum_i{t_{ik}ln(t_{ik})})}</code>
</p>

<p style="text-align: center;"><code class="reqn">TNW = - \sum_k{q_k ln(q_k)}</code>
</p>

<p>where: <code class="reqn">p_i</code> is the proportion of all resources used by individual i (<code class="reqn">\frac{\sum_k{n_{ik}}}{\sum_{ik}{n_{ik}}}</code>); <code class="reqn">q_k</code> is the proportion of the kth resource category in the population's niche, and <code class="reqn">t_{ik}</code> is the proportion of the population's total use of resource k that was used by individual i (i.e., <code class="reqn">\frac{n_{ik}}{\sum_i{n_{ik}}}</code>).
</p>
<p>It is important to remember that TNW = BIC + WIC, and one can easily calculate the proportion WIC, which we refer to as WIC/TNW.
</p>
<p>Be aware that monophagous individuals (100% of diet from a single resource) have excessively large leverage drawing WIC towards zero, possibly leading to downward-biased WIC/TNW exaggerating individual specialization. The procedure prints a warning message with the name of monophagous individuals in the dataset.
</p>
<p>The Monte Carlo resampling procedure first determines the number of prey used by each individual, <code class="reqn">n_i</code>. It then determines the frequencies with which the population as a whole used the various resources (see <code><a href="#topic+pop.diet">pop.diet</a></code> for details). Subsequently, the procedure randomly reassigns each individual <code class="reqn">n_i</code> prey drawn from the population frequency distribution, and then recalculates a null measure of diet variation. This is repeated a user-specified number of times. Hence, the resampled population yields a null model corresponding to a population composed of generalists that sample randomly from the population's diet, and have diet sizes equal to those of the observed data set.
The original statistics are merged into the Monte Carlo set.
</p>


<h3>Value</h3>

<p>The result is a list of class &lsquo;RInSp&rsquo; composed of:
</p>
<table>
<tr><td><code>WonT</code></td>
<td>
<p>The value of WIC/TNW for the dataset &ldquo;dataset&rdquo;.</p>
</td></tr>
<tr><td><code>Zeros</code></td>
<td>
<p>A character vector with the names of  individuals with Shannon-Weaver scores equal to zero. Or zero otherwise.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>The Monte Carlo resampling probability value for the calculated WIC/TNW ratio;</p>
</td></tr>
<tr><td><code>montecarlo</code></td>
<td>
<p>A matrix with the replicate number &lsquo;Zeroes&rsquo;, the value of &lsquo;WIC&rsquo;, the value of &lsquo;BIC&rsquo;, the value of &lsquo;TNW&rsquo; and the derived value for &lsquo;WonT&rsquo;. The first line holds the values for the provided dataset, and the following lines the results of the Monte Carlo resampling.</p>
</td></tr>
<tr><td><code>parameter</code></td>
<td>
<p>An index used in <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code> to point to the column of the matrix &lsquo;montecarlo&rsquo; for plotting results.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dr. Nicola ZACCARELLI. Please note that the C code is partially based on the C++ source of IndSpec from Bolnick et al. (2002).
</p>
<p>The original source code of IndSpec1.0.exe is available from the &ldquo;Ecological Archives&rdquo; of the Ecological Society of America (<a href="http://esapubs.org/archive/">http://esapubs.org/archive/</a>): identifier E083-056-S1; <a href="http://esapubs.org/archive/ecol/E083/056/">http://esapubs.org/archive/ecol/E083/056/</a>.</p>


<h3>References</h3>

<p>Bolnick, D.I., L.H. Yang, J.A. Fordyce, J.M. Davis, and Svanback, R. 2002. Measuring individual-level resource specialization. <em>Ecology</em> <b>83</b>: 2936-2941.
</p>
<p>Roughgarden, J. 1979. Theory of population genetics and evolutionary ecology: an introduction. Macmillan, New York, NY, USA.
</p>


<h3>See Also</h3>

<p> For the continuous case see <code><a href="#topic+WTcMC">WTcMC</a></code> and for a summary statistics the function <code><a href="#topic+sumMC.RInSp">sumMC.RInSp</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Stickleback)
# Select a single spatial sampling site (site A)
GutContents_SiteA &lt;- import.RInSp(Stickleback, row.names = 1,
info.cols = c(2:13), subset.rows = c("Site", "A"))
# Warning, the number of replicates is set low to speed up he example!
# Note, for real analyses we recommend to set replicates =&gt; 999
WT &lt;- WTdMC(GutContents_SiteA, replicates = 99)
sumMC.RInSp(WT)
rm(list=ls(all=TRUE))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
