<!DOCTYPE html><html><head><title>Help for package rareNMtests</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rareNMtests}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BiogTest.individual'><p> Biogeographical null model tests</p></a></li>
<li><a href='#chao1'><p>Computes the Chao 1 species richness estimator</p></a></li>
<li><a href='#Chiapas'><p> Tree abundance in tropical montane forest plots</p></a></li>
<li><a href='#EcoTest.individual'><p> Ecological null model tests</p></a></li>
<li><a href='#rarefaction.individual'><p> Rarefied species richness with Hill numbers</p></a></li>
<li><a href='#rareNMtests-internal'><p> Internal rareNMtests function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ecological and Biogeographical Null Model Tests for Comparing
Rarefaction Curves</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-06-05</td>
</tr>
<tr>
<td>Author:</td>
<td>Luis Cayuela and Nicholas J. Gotelli</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Luis Cayuela &lt;luis.cayuela@urjc.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>vegan</td>
</tr>
<tr>
<td>Description:</td>
<td>Randomization tests for the statistical comparison of i = two or more individual-based, sample-based or coverage-based rarefaction curves. The ecological null hypothesis is that the i samples were all drawn randomly from a single assemblage, with (necessarily) a single underlying species abundance distribution. The biogeographic null hypothesis is that the i samples were all drawn from different assemblages that, nonetheless, share similar species richness and species abundance distributions. Functions are described in L. Cayuela, N.J. Gotelli &amp; R.K. Colwell (2015) &lt;<a href="https://doi.org/10.1890%2F14-1261.1">doi:10.1890/14-1261.1</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-07 12:30:40 UTC; luis</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-07 12:50:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='BiogTest.individual'> Biogeographical null model tests </h2><span id='topic+BiogTest.individual'></span><span id='topic+BiogTest.sample'></span><span id='topic+plot.BiogTest'></span>

<h3>Description</h3>

<p> Biogeographical null model tests for comparing rarefaction curves. </p>


<h3>Usage</h3>

<pre><code class='language-R'>BiogTest.individual(x, MARGIN = 2, niter = 200, method = "sample-size", q = 0, 
trace = TRUE, powerfun = 1, log.scale = FALSE, distr = "lnorm")
BiogTest.sample(x, by = NULL, MARGIN = 2, niter = 200, method = "sample-size", 
q = 0, trace = TRUE, distr = "lnorm")
## S3 method for class 'BiogTest'
plot(x, max.poly = 50, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BiogTest.individual_+3A_x">x</code></td>
<td>
<p> Community data, a matrix-like object, with entries representing abundance for <code>EcoTest.individual</code>, or presence-absence for <code>EcoTest.sample</code>, or an <code>'EcoTest'</code> class object for <code>plot</code> function. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_margin">MARGIN</code></td>
<td>
<p> If <code>MARGIN=1</code>, sampling units are rows and species are columns; if <code>MARGIN=2</code> (default), then species are rows and sampling units are columns. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_niter">niter</code></td>
<td>
<p> Number of randomizations used for the null model hypothesis test. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_method">method</code></td>
<td>
<p> Either <code>"sample-size"</code> (default) or <code>"coverage"</code>. <code>"sample-size"</code> uses either abundance data (in individual-based rarefaction) or incidence data (in sample-based rarefaction), whereas <code>"coverage"</code> uses the estimated coverage (see Details) of either abundance or number of samples as the x-axis in the sampling curve. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_q">q</code></td>
<td>
<p> First three Hill numbers, namely species richness (<code>q = 0</code>), the exponential Shannon index (<code>q = 1</code>), and the inverse Simpson index (<code>q = 2</code>). </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_trace">trace</code></td>
<td>
<p> If trace=TRUE, information is printed during the randomization process. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_powerfun">powerfun</code></td>
<td>
<p> By default rarefied richness is estimated for all subsample sizes, from 1 to <em>n</em>, where <em>n</em> is the total number of individuals in the sample. If <code>powerfun</code> is less than 1, it decreases the total number of subsamples as a power function of {hn. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_log.scale">log.scale</code></td>
<td>
<p> If <code>FALSE</code> (default), subsample sizes for rarefying community are spaced apart at regular intervals. Otherwise (<code>log.scale = TRUE</code>), subsample sizes are spaced apart on a log-scale. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_distr">distr</code></td>
<td>
<p> Underlying species abundance distribution from which random assemblages are created by sampling to construct the null distribution. Available options include the log-normal (<code>lnorm</code>), geometric (<code>geom</code>), and broken-stick (<code>stick</code>) distributions. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_by">by</code></td>
<td>
<p> Factor for grouping sampling units in sample-based rarefaction. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_max.poly">max.poly</code></td>
<td>
<p> Maximum number of polygons to draw in <code>plot</code> function. Each polygon represents the area between each unique pair of the <em>K</em> sample rarefaction curves. </p>
</td></tr>
<tr><td><code id="BiogTest.individual_+3A_...">...</code></td>
<td>
<p> Additional graphical parameters passed to plot (not used). </p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>BiogTest.individual</code> and <code>BiogTest.sample</code> present randomization tests for the statistical comparison of two or more individual-based, sample-based, or coverage-based rarefaction curves. The biogeographical null hypothesis <em>H0</em> is that  is that two (or more) reference samples, represented by either abundance or incidence data, were drawn randomly from different assemblages that, nonetheless, share similar species richness and species abundance distributions. 
</p>
<p>To calculate the <code>BiogTest</code> statistic, <em>Zobs</em>, we summed the area between all unique pairs of the <em>K</em> sample rarefaction curves. If <em>H0</em> is true, then <em>Zobs</em> should be relatively small because all of the rarefaction curves should have similar profiles, regardless of their species composition. In the limit, if all of the rarefaction curves had an identical profile, <em>Zobs</em> would equal 0. To construct the null distribution, the algorithm creates random assemblages by sampling from an underlying species abundance distribution. Of the many possible distributions which distribution should be used? The algorithm offers the possibility to choose among different underlying relative abundance distributions, including the log-normal, geometric and broken-stick distributions, although the former has some advantages, and thus its use is recommended.
</p>
<p>The statistical parameters of the log-normal rank abundance distribution are the number of species in the assemblage and the variance of the distribution; the latter controls the differences in abundance between common and rare species. If these underlying parameters are known, then sample size effects can be estimated by random sampling of individuals from the specified distribution. However, it is very difficult to directly estimate these parameters from a sample or set of samples (O'Hara 2005). Instead, a suite of log-normal distributions is generated, that might act as a reasonable sampling universe for comparison with a set of reference samples to test the biogeographic null hypothesis. Our strategy was to specify a distribution for each of the two parameters in the log normal: species number and variance. As in a random effects model, each replicate of the null distribution reflects a single sample from a log-normal distribution in which the two model parameters were first determined by random assignment. 
</p>
<p>For the lower boundary of species richness, the minimum possible value cannot be smaller than the maximum number of species observed in the richest single sample among a set of samples. For the upper boundary of species richness, we calculated the upper bound of the Chao1 95
</p>
<p>For the standard deviation of the log-normal, we sampled a random uniform value between 1.1 and 33 (0.1 and 3.5 on a log scale). For empirical assemblages, standard deviations typically fall within this range (Limpert et al. 2001). Once the null assemblage was specified by selection of parameters for species richness and the standard deviation, we sampled (with replacement) the specified number of individuals for each sample in an individual-based data set. For incidence data, we sampled the observed number of species in each sampling unit, sampling species without replacement, with sample probabilities set proportional to relative abundances in the log-normal distribution. We then used the analytic formulas in Chao et al. (2014) to construct the rarefaction curves for each of the pseudosamples, simulated a distribution of <code>Zsim</code>, and compared it to <code>Zobs</code> to estimate <code class="reqn">p(Z_{obs}|H_{0})</code>.
</p>
<p>For the broken stick, the number of species in the meta-community must be known, and then a random partition is made to define the relative abundance of each species. For the geometric series, two parameters are needed: the number of species in the meta-community and a constant ratio <code>D</code> (<code>D</code>&lt;1), which determines the abundance of the next species in the sequence. In the geometric series, <code>D</code> was obtained by sampling a random uniform value between 0.1 and 1. In all cases, the number of species (<code>S</code>), as in the log-normal distribution, was obtained by randomly drawing from a uniform distribution that was bounded at the low end by the maximum observed <code>S</code> and at the high end by the maximum upper bound of the 95
</p>
<p>To better mimic the sampling process, a negative binomial random error was added to the abundance counts every time a sample was randomly drawn from the simulated meta-community. The negative binomial distribution was used to generate realistic heterogeneity that often results from spatial clustering of individuals and other small-scale processes. The expectation <code class="reqn">mu</code> of the negative binomial was represented by the abundance count of each species in the meta-community.
</p>
<p>Analytic estimators for individual-based, sample-based, and coverage-based rarefaction on Hill numbers were derived by Chao et al. (2014), and are currently implemented in this package (see <code>link{rarefaction.individual}</code> and <code>link{rarefaction.sample}</code> functions).
</p>


<h3>Value</h3>

 <p><code>BiogTest.individual</code> and <code>BiogTest.sample</code> return an object of class <code>'BiogTest'</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>subclass</code></td>
<td>
<p> A character indicating the type of data used to build rarefaction curves, namely &quot;Individual-based method&quot; for individual-based rarefaction (abundance data), and &quot;Sample-based method&quot; for sample-based rarefaction (incidence data), respectively. </p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p> A character indicating the variable used for the x-axis in the sampling curve, either &quot;Sample-size&quot; for abundance data (in individual-based rarefaction) or incidence data (in sample-based rarefaction), or &quot;Coverage measure&quot; for the estimated coverage of either abundance or number of samples. </p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p> A list of data frames, with as many components as individual samples. Each data frame contains two columns, one for either sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and another for the estimated Hill number in each observed sample. </p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p> A list of data frames, with as many components as individual samples. Each data frame contains two columns, one for either sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and another for the estimated Hill number in each simulated sample from one artificial set of samples. </p>
</td></tr>
<tr><td><code>Zsim</code></td>
<td>
<p> A vector of length <code>niter</code> showing each of the cumulative areas between all unique pairs of the <code>K</code> simulated rarefaction curves. </p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p> The cumulative area between all unique pairs of the <code>K</code> observed sample rarefaction curves. </p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p> The probability of <code>Z</code> given the distribution of <code>Zsim</code>. Low <em>p-values</em> imply that observed differences among samples in richness, and/or relative abundance are improbable if the samples were all drawn from similar assemblages regardless of differences in species composition. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Luis Cayuela and Nicholas J. Gotelli </p>


<h3>References</h3>

<p>Cayuela, L., Gotelli, N.J. &amp; Colwell, R.K. (2015). Ecological and biogeographical null hypotheses for comparing rarefaction curves. <em>Ecological Monographs</em> 85: 437-455.
</p>
<p>Chao, A. (1984). Nonparametric-estimation of the number of classes in a population. <em>Scandinavian Journal of Statistics</em> 11: 265-270.
</p>
<p>Chao, A., Gotelli, N.J., Hsieh, T.C., Sander, E.L., Ma, K.H., Colwell, R.K. &amp; Ellison, A.M. (2014). Rarefaction and extrapolation with Hill numbers: a framework for sampling and estimation in species diversity studies. emphEcological Monographs 84: 45-67.
</p>
<p>Limpert, E., Stahel, W.A. &amp; Abbt, M. (2001). Log-normal distributions across the sciences: keys and clues. emphBioScience 51: 341-352.
</p>
<p>O'Hara, R.B. (2005). Species richness estimators: how many species can dance on the head of a pin? emphJournal of Animal Ecology 74: 375-386. 
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rarefaction.individual">rarefaction.individual</a></code>, <code><a href="#topic+rarefaction.sample">rarefaction.sample</a></code>, <code><a href="vegan.html#topic+rarecurve">rarecurve</a></code>, <code><a href="#topic+chao1">chao1</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
   ## Individual-based and coverage-based rarefaction
   # Simulate a community with number of species (spn) and evenness randomly selected

   spn &lt;- round(runif(1, 10, 200))
   evenness &lt;- runif(1, log(1.1), log(33))
   com &lt;- round(rlnorm(spn, 2, evenness))
   Ss &lt;- round(runif(1, 50, 500))
   sample1 &lt;- sample(paste("sp",1:length(com)), rpois(1, Ss), replace=TRUE, prob=com)
   sample1 &lt;- data.frame(table(sample1))
   colnames(sample1) &lt;- c("species", "sample1")
   sample2 &lt;- sample(paste("sp",1:length(com)), rpois(1, Ss), replace=TRUE, prob=com)
   sample2 &lt;- data.frame(table(sample2))
   colnames(sample2) &lt;- c("species", "sample2")
   df &lt;- merge(sample1, sample2, by="species", all=TRUE)
   rownames(df) &lt;- df$species
   df[is.na(df)] &lt;- 0
   df &lt;- df[,2:3]

   # Biogeographical null model test using sample-based rarefaction curves
   # for species richness (q = 0)
   # The test should not reject the null hypothesis (p &gt; 0.05)
   ibbiogq0 &lt;- BiogTest.individual(df, MARGIN=2, powerfun=0.8, log.scale=TRUE)
   plot(ibbiogq0)

   # Biogeographical null model test using coverage-based rarefaction curves
   # for the exponential Shannon index (q = 1)
   ibbiogq1cov &lt;- BiogTest.individual(df, MARGIN=2, method="coverage", q=1, 
   powerfun=0.8, log.scale=TRUE)
   plot(ibbiogq1cov)

   ## Sample-based and coverage-based rarefaction
   # Load the data
   data(Chiapas)
   Chiapas &lt;- subset(Chiapas, Region!="El Triunfo")
   str(Chiapas)

   # Biogeographical null model test using sample-based rarefaction curves
   # for species richness (q = 0)
   sbbiogq0 &lt;- BiogTest.sample(Chiapas[,-1], by=Chiapas[,1], MARGIN=1)
   plot(sbbiogq0)

   # Biogeographical null model test using coverage-based rarefaction curves
   # for the inverse Simpson index (q = 2)
   sbbioq2cov &lt;- EcoTest.sample(Chiapas[,-1], by=Chiapas[,1], MARGIN=1, 
   method="coverage", q=2)
   plot(sbbioq2cov)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='chao1'>Computes the Chao 1 species richness estimator</h2><span id='topic+chao1'></span>

<h3>Description</h3>

<p>Computes the Chao 1 richness estimator, its estimated variance, and the corresponding 95
</p>


<h3>Usage</h3>

<pre><code class='language-R'>   chao1(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chao1_+3A_x">x</code></td>
<td>
<p>Vector of species abundances.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Different equations are used to compute the classic Chao1 richness estimator, its estimated variance, and the corresponding 95
</p>


<h3>Value</h3>

<p>A data frame with five columns including the observed number of species (Sobs), the estimated number of species with the Chao 1 estimator (S.chao1), the estimated variance (var), and the upper and lower 95
</p>


<h3>Author(s)</h3>

<p>Luis Cayuela
</p>


<h3>References</h3>

<p>Chao, A. (1987). Estimating the population size for capture-recapture data with unequal catchability. <em>Biometrics</em> 43, 783-791. 
</p>


<h3>See Also</h3>

<p><code><a href="vegan.html#topic+specpool">specpool</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   abund &lt;- c(19, 12, 7, 3, 3, 2, 2, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
   print(chao1(abund))
</code></pre>

<hr>
<h2 id='Chiapas'> Tree abundance in tropical montane forest plots </h2><span id='topic+Chiapas'></span>

<h3>Description</h3>

<p> Tree abundance in 224 0.1-ha plots in three montane cloud forest regions of Chiapas, Mexico. </p>


<h3>Usage</h3>

<pre><code class='language-R'> data(Chiapas) </code></pre>


<h3>Format</h3>

<p> The <code>Chiapas</code> data set contains data for 375 tree species (columns) from 224 0.1-ha plots (rows). The first column is a factor with three levels with the name of the region.
</p>


<h3>Details</h3>

<p>This data set characterizes tree communities from tropical montane cloud forests in three regions of the state of Chiapas, Mexico: El Triunfo Biosphere Reserve in Sierra Madre (100 plots), the Highlands (38 plots), and the Northern Mountains (86 plots). For these plots, incidence records were based on trees exceeding 5 cm in diameter at breast height. Data were obtained from the BIOTREE-NET website (www.biotreenet.com). Species names were standardized and typographical errors were corrected using The Plant List through the <span class="pkg">Taxostand</span> package (Cayuela et al. 2012). Distance between regions ranged from ca. 50 kms (the Highlands and Northern Mountains) to ca. 250 kms (El Triunfo and Northern Mountains).
</p>


<h3>References</h3>

<p>Cayuela, L., Golicher, D.J., Rey Benayas, J.M., Gonzalez-Espinosa, M. &amp; Ramirez-Marcial, N. (2006). Fragmentation, disturbance and tree diversity conservation in tropical montane forests. <em>Journal of Applied Ecology</em> 43: 1172-1181.
</p>
<p>Cayuela, L., Granzow-de la Cerda, I., Albuquerque, F.S., &amp; Golicher, J.D. (2012). Taxonstand: An R package for species names standardisation in vegetation databases. <em>Methods in Ecology and Evolution</em> 3(6): 1078-1083.
</p>
<p>Ramirez-Marcial, N., Gonzalez-Espinosa, M. &amp; Williams-Linera, G. (2001). Anthropogenic disturbance and tree diversity in montane rain forests in Chiapas, Mexico. <em>Forest Ecology and Management</em> 154(1): 311-326.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   data(Chiapas)
   str(Chiapas)
</code></pre>

<hr>
<h2 id='EcoTest.individual'> Ecological null model tests </h2><span id='topic+EcoTest.individual'></span><span id='topic+EcoTest.sample'></span><span id='topic+plot.EcoTest'></span>

<h3>Description</h3>

<p> Ecological null model tests for comparing rarefaction curves. </p>


<h3>Usage</h3>

<pre><code class='language-R'>EcoTest.individual(x, MARGIN = 2, niter = 200, method = "sample-size", q = 0, 
trace = TRUE, powerfun = 1, log.scale = FALSE)
EcoTest.sample(x, by = NULL, MARGIN = 2, niter = 200, method = "sample-size", 
q = 0, trace = TRUE)
## S3 method for class 'EcoTest'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EcoTest.individual_+3A_x">x</code></td>
<td>
<p> Community data, a matrix-like object, with entries representing abundance for <code>EcoTest.individual</code>, or presence-absence for <code>EcoTest.sample</code>, or an <code>'EcoTest'</code> class object for <code>plot</code> function. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_margin">MARGIN</code></td>
<td>
<p> If <code>MARGIN=1</code>, sampling units are rows and species are columns; if <code>MARGIN=2</code> (default), then species are rows and sampling units are columns. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_niter">niter</code></td>
<td>
<p> Number of randomizations used for the null model hypothesis test. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_method">method</code></td>
<td>
<p> Either <code>"sample-size"</code> (default) or <code>"coverage"</code>. <code>"sample-size"</code> uses either abundance data (in individual-based rarefaction) or incidence data (in sample-based rarefaction), whereas <code>"coverage"</code> uses the estimated coverage (see Details) of either abundance or number of samples as the x-axis in the sampling curve. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_q">q</code></td>
<td>
<p> First three Hill numbers, namely species richness (<code>q = 0</code>), the exponential Shannon index (<code>q = 1</code>), and the inverse Simpson index (<code>q = 2</code>). </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_trace">trace</code></td>
<td>
<p> If <code>trace=TRUE</code>, information is printed during the randomization process. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_powerfun">powerfun</code></td>
<td>
<p> By default rarefied richness is estimated for all subsample sizes, from 1 to <em>n</em>, where <em>n</em> is the total number of individuals in the sample. If <code>powerfun</code> is less than 1, it decreases the total number of subsamples as a power function of <em>n</em>. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_log.scale">log.scale</code></td>
<td>
<p> If FALSE (default), subsample sizes for rarefying community are spaced apart at regular intervals. Otherwise (<code>log.scale = TRUE</code>), subsample sizes are spaced apart on a log-scale. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_by">by</code></td>
<td>
<p> Factor for grouping sampling units in sample-based rarefaction. </p>
</td></tr>
<tr><td><code id="EcoTest.individual_+3A_...">...</code></td>
<td>
<p> Additional graphical parameters passed to plot (not used). </p>
</td></tr>
</table>


<h3>Details</h3>

 
<p><code>EcoTest.individual</code> and <code>EcoTest.sample</code> present randomization tests for the statistical comparison of two or more individual-based, sample-based, or coverage-based rarefaction curves. The ecological null hypothesis <em>H0</em> is that two (or more) reference samples, represented by either abundance or incidence data, were both drawn from the same assemblage of <em>N*</em> individuals and <em>S</em> species. Therefore, any differences among the samples in species composition, species richness, or relative abundance reflect only random variation, given the number of individuals (or sampling units) in each collection. The alternative hypothesis, in the event that <em>H0</em> cannot be rejected, is that the sample data were drawn from different assemblages. If <em>H0</em> is true, then pooling the samples should give a composite sample that is also a (larger) random subset of the complete assemblage. It is from this pooled composite sample that we make random draws for comparison with the actual data.
</p>
<p>To construct the <code>EcoTest</code> metric, we begin by plotting the expected rarefaction curves for the individual samples and for the pooled composite sample <em>C</em>. Next, for each individual sample <em>i</em>, we calculate the cumulative area <em>Ai</em> between the sample rarefaction curve and the pooled rarefaction curve. For a set of <em>i</em>=1 to <em>K</em> samples, we define the observed difference index:
</p>
<p style="text-align: center;"><code class="reqn">Z_{obs}=\sum_{i=1}^{K}A_{i}</code>
</p>

<p>Note that two identically-shaped rarefaction curves may nevertheless differ from the pooled curve. This difference can arise because species identities in the individual samples are retained in the pooled composite sample <em>C</em>, which affects the shape of the pooled rarefaction curve.
</p>
<p>The data are next reshuffled by randomly re-assigning every individual to a sample (for abundance data) or every sampling unit to a sample (for incidence data), and preserving the original sample sizes (number of individuals for abundance data and number of samples for incidence data). From this randomization, we again construct rarefaction curves and calculate <em>Zsim</em> as the cumulative area between the rarefaction curves of the randomized samples and the composite rarefaction curve. This procedure is repeated many times, leading to a distribution of <em>Zsim</em> values and a 95
</p>
<p>Analytic estimators for individual-based, sample-based, and coverage-based rarefaction on Hill numbers were derived by Chao et al. (2014), and are currently implemented in this package (see <code>link{rarefaction.individual}</code> and <code>link{rarefaction.sample}</code> functions).
</p>


<h3>Value</h3>

 <p><code>EcoTest.individual</code> and <code>EcoTest.sample</code> return an object of class <code>'EcoTest'</code>, basically a list with the following components:
</p>
<table>
<tr><td><code>subclass</code></td>
<td>
<p> A character indicating the type of data used to build rarefaction curves, namely &quot;Individual-based method&quot; for individual-based rarefaction (abundance data), and &quot;Sample-based method&quot; for sample-based rarefaction (incidence data), respectively. </p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p> A character indicating the variable used for the x-axis in the sampling curve, either &quot;Sample-size&quot; for abundance data (in individual-based rarefaction) or incidence data (in sample-based rarefaction), or &quot;Coverage measure&quot; for the estimated coverage of either abundance or number of samples. </p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p> A list of data frames, with as many components as individual samples. Each data frame contains two columns, one for either sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and another for the estimated Hill number in each observed sample. </p>
</td></tr>
<tr><td><code>sim</code></td>
<td>
<p> A list of data frames, with as many components as individual samples. Each data frame contains two columns, one for either sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and another for the estimated Hill number in each simulated sample from one randomized set of samples. </p>
</td></tr>
<tr><td><code>pooled</code></td>
<td>
<p> A data frame with entries for sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and the corresponding Hill number for the composite (i.e. pooled) rarefaction curve. </p>
</td></tr>
<tr><td><code>Zsim</code></td>
<td>
<p> A vector of length <code>niter</code> showing each of the cumulative areas between the rarefaction curves of one randomized sample data set and the composite rarefaction curve. </p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p> The cumulative area between the observed sample rarefaction curves and the composite rarefaction curve. </p>
</td></tr>
<tr><td><code>pval</code></td>
<td>
<p> The probability of <em>Z</em> given the distribution of <em>Zsim</em>. Low <em>p-values</em> imply that observed differences among samples in species composition, richness, and/or relative abundance are improbable if the samples were all drawn from the same assemblage. </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p> Luis Cayuela and Nicholas J. Gotelli </p>


<h3>References</h3>

<p>Cayuela, L., Gotelli, N.J. &amp; Colwell, R.K. (2015). Ecological and biogeographical null hypotheses for comparing rarefaction curves. <em>Ecological Monographs</em> 85: 437-455.
</p>
<p>Chao, A., Gotelli, N.J., Hsieh, T.C., Sander, E.L., Ma, K.H., Colwell, R.K. &amp; Ellison, A.M. (2014). Rarefaction and extrapolation with Hill numbers: a framework for sampling and estimation in species diversity studies. emphEcological Monographs 84: 45-67.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+rarefaction.individual">rarefaction.individual</a></code>, <code><a href="#topic+rarefaction.sample">rarefaction.sample</a></code>, <code><a href="vegan.html#topic+rarecurve">rarecurve</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
   ## Individual-based and coverage-based rarefaction
   # Simulate a community with number of species (spn) and evenness randomly selected

   spn &lt;- round(runif(1, 10, 200))
   evenness &lt;- runif(1, log(1.1), log(33))
   com &lt;- round(rlnorm(spn, 2, evenness))
   Ss &lt;- round(runif(1, 50, 500))
   sample1 &lt;- sample(paste("sp",1:length(com)), rpois(1, Ss), replace=TRUE, prob=com)
   sample1 &lt;- data.frame(table(sample1))
   colnames(sample1) &lt;- c("species", "sample1")
   sample2 &lt;- sample(paste("sp",1:length(com)), rpois(1, Ss), replace=TRUE, prob=com)
   sample2 &lt;- data.frame(table(sample2))
   colnames(sample2) &lt;- c("species", "sample2")
   df &lt;- merge(sample1, sample2, by="species", all=TRUE)
   rownames(df) &lt;- df$species
   df[is.na(df)] &lt;- 0
   df &lt;- df[,2:3]

   # Ecological null model test using sample-based rarefaction curves
   # for species richness (q = 0)
   # The test should not reject the null hypothesis in most cases (p &gt; 0.05)
   ibecoq0 &lt;- EcoTest.individual(df, MARGIN=2, powerfun=0.8, log.scale=TRUE)
   plot(ibecoq0)

   # Ecological null model test using coverage-based rarefaction curves
   # for the exponential Shannon index (q = 1)
   ibecoq1cov &lt;- EcoTest.individual(df, MARGIN=2, method="coverage", 
   q=1, powerfun=0.8, log.scale=TRUE)
   plot(ibecoq1cov)

   ## Sample-based and coverage-based rarefaction
   # Load the data
   data(Chiapas)
   Chiapas &lt;- subset(Chiapas, Region!="El Triunfo")
   str(Chiapas)

   # Ecological null model test using sample-based rarefaction curves
   # for species richness (q = 0)
   sbecoq0 &lt;- EcoTest.sample(Chiapas[,-1], by=Chiapas[,1], MARGIN=1)
   plot(sbecoq0)

   # Ecological null model test using coverage-based rarefaction curves
   # for the inverse Simpson index (q = 2)
   sbecoq2cov &lt;- EcoTest.sample(Chiapas[,-1], by=Chiapas[,1], 
   MARGIN=1, method="coverage", q=2)
   plot(sbecoq2cov)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='rarefaction.individual'> Rarefied species richness with Hill numbers </h2><span id='topic+rarefaction.individual'></span><span id='topic+rarefaction.sample'></span>

<h3>Description</h3>

<p> Individual-based (abundance data), sample-based (incidence data), and coveraged-based (based on both abundance and incidence data) rarefaction with Hill numbers. </p>


<h3>Usage</h3>

<pre><code class='language-R'>rarefaction.individual(x, method = "sample-size", q = 0, powerfun = 1, 
log.scale = FALSE, inds = NULL)
rarefaction.sample(x, method = "sample-size", q = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rarefaction.individual_+3A_x">x</code></td>
<td>
<p> Community data, a vector (for individual-based rarefaction) or a matrix-like object (for sample-based rarefaction). </p>
</td></tr>
<tr><td><code id="rarefaction.individual_+3A_method">method</code></td>
<td>
<p> Either <code>"sample-size"</code> (default) or <code>"coverage"</code>. <code>"sample-size"</code> uses either abundance data (in individual-based rarefaction) or incidence data (in sample-based rarefaction), whereas <code>"coverage"</code> uses the estimated coverage (see Details) of either abundance or number of samples as the x-axis in the sampling curve. </p>
</td></tr> 
<tr><td><code id="rarefaction.individual_+3A_q">q</code></td>
<td>
<p> First three Hill numbers, namely species richness (<code>q = 0</code>), the exponential Shannon index (<code>q = 1</code>), and the inverse Simpson index (<code>q = 2</code>). </p>
</td></tr>
<tr><td><code id="rarefaction.individual_+3A_powerfun">powerfun</code></td>
<td>
<p> By default rarefied richness is estimated for all subsample sizes, from 1 to <em>n</em>, where <em>n</em> is the total number of individuals in the sample. If <code>powerfun</code> is less than 1, it decreases the total number of subsamples as a power function of <em>n</em>. </p>
</td></tr>
<tr><td><code id="rarefaction.individual_+3A_log.scale">log.scale</code></td>
<td>
<p> If <code>FALSE</code> (default), subsample sizes for rarefying community are spaced apart at regular intervals. Otherwise (<code>log.scale = TRUE</code>), subsample sizes are spaced apart on a log-scale. </p>
</td></tr>
<tr><td><code id="rarefaction.individual_+3A_inds">inds</code></td>
<td>
<p> Subsample size for rarefying community, either a single value or a vector. If not specified (default), rarefaction is calculated for all subsample sizes. </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Consider a complete assemblage for which all species and their relative abundance are known. In this complete assemblage, there are <em>i</em>=1 to <em>S</em> species and <code>N*</code> total individuals, with <code>Ni</code> individuals of species <code>i</code>. For individual-based (abundance) data, the reference sample consists of <code>n</code> individuals drawn at random from <code>N*</code>, with <code>Sobs</code> species present, each represented by <code>Xi</code> individuals. Individual-based data is represented as a single vector of length <code>Sobs</code>, the elements of which are the observed abundances <code>Xi</code>. For sample-based (incidence) data, the reference sample consists of a set of <code>R</code> standardized sampling units, such as traps, plots, transect lines, etc. Within each of these sampling units, the presence (1) or absence (0) of each species are the required data, even though abundance data may have been collected. Sample-based incidence data can be represented as a single matrix, with <code>i</code>=1 to <code>R</code> rows and <code>j</code>=1 to <code>Sobs</code> columns, and entries <code>Wij</code>=1 or <code>Wij</code>=0 to indicate the presence or absence of species <code>j</code> in sampling unit <code>i</code>. 
</p>
<p>In the past, rarefaction curves have been estimated by repeated subsampling, but it is no longer necessary. Analytic estimators for individual-based, sample-based, and coverage-based rarefaction on Hill numbers were derived by Chao et al. (2014). In standard rarefaction curves the x-axis is either the abundance (individual-based) or number of samples (sample-based). Additionally, the x-axis can also be the estimated coverage of either abundance or number of samples. Coverage is defined as the proportion of total individuals or samples from the complete assemblage that is represented by the species present in the sample or subset of samples (Chao and Jost 2012).
</p>
<p>Functions <code>rarefaction.individual</code> and <code>rarefaction.sample</code> rarefies a series of diversity indices known as Hill numbers (Hill 1973), which can be algebraically transformed into more familiar diversity indices. The order <code>q</code>  of the Hill number determines the weighting given to more common species, with species richness defined by <code>q</code>=0. Other Hill numbers are the exponential Shannon index (<code>q</code>=1), and the inverse Simpson index (<code>q</code>=2).
</p>
<p>By default, rarefaction is estimated for all subsample sizes, from 1 to <code>n</code> in individual-based rarefaction, or from 1 to <code>R</code> in sample-based rarefaction, where <code>n</code> is the total number of individuals in the sample, and <code>R</code> is the total number of sampling units, respectively. In individual-based rarefaction, computation of Hill numbers for different subsample sizes can be very time consuming when total number of individuals, <code>n</code>, is high (e.g. &gt; 1000) to extremely high (e.g. &gt; 10000). To reduce computation time, one can select a given number of subsample sizes by setting <code>powerfun</code> below 1. This decreases the total number of subsamples as a power function of <code>n</code>. Subsample sizes can be spaced apart at regular intervals if <code>log.scale=FALSE</code>, or at log-intervals if <code>log.scale=TRUE</code>. This allows getting the entire rarefaction curve profile at faster speed. It is not advisable to set the value of <code>powerfun</code> below 0.5, and recommended values are between 0.6 and 0.8.
</p>


<h3>Value</h3>

<p> A data frame with entries for sample-size (this refers either to number of individuals in individual-based rarefaction, or to number of sampling units in sample-based rarefaction) or coverage (in coverage-based rarefaction), and the corresponding Hill number. </p>


<h3>Author(s)</h3>

<p> Luis Cayuela and Nicholas J. Gotelli </p>


<h3>References</h3>

<p>Chao, A., Gotelli, N.J., Hsieh, T.C., Sander, E.L., Ma, K.H., Colwell, R.K. &amp; Ellison, A.M. (2014). Rarefaction and extrapolation with Hill numbers: a framework for sampling and estimation in species diversity studies. emphEcological Monographs 84: 45-67.
</p>
<p>Chao, A. &amp; Jost, J. (2012). Coverage-based rarefaction and extrapolation: standardizing samples by completeness rather than size. emphEcology 93: 2533-2547.
</p>
<p>Hill, M.O. (1973). Diversity and evenness: a unifying notation and its consequences. emphEcology 54: 427-432.
</p>


<h3>See Also</h3>

 <p><code><a href="vegan.html#topic+rarecurve">rarecurve</a></code> </p>


<h3>Examples</h3>

<pre><code class='language-R'>  ## Not run: 
   ## Individual-based and coverage-based rarefaction
   # Simulate a community with number of species (sr) and evenness randomly selected
   spn &lt;- rlnorm(runif(1, 10, 200))
   evenness &lt;- runif(1, log(1.1), log(33))
   com &lt;- round(rlnorm(spn, 3, evenness))
   # Sample the community (with sample size n = 500 individuals)
   sample1 &lt;- sample(paste("sp",1:length(com)), 500, replace=TRUE, prob=com)
   sample1 &lt;- table(sample1)

   # Get the individual-based and coverage-based rarefaction curves for different Hill numbers
   ibr.q0 &lt;- rarefaction.individual(sample1)
   ibr.q1 &lt;- rarefaction.individual(sample1, q=1)
   ibr.q2 &lt;- rarefaction.individual(sample1, q=2)
   ibr.q0.cov &lt;- rarefaction.individual(sample1, method="coverage")
   ibr.q1.cov &lt;- rarefaction.individual(sample1, q=1, method="coverage")
   ibr.q2.cov &lt;- rarefaction.individual(sample1, q=2, method="coverage")

   # Plot the results
   par(mfcol=c(1,2))
   plot(ibr.q0[,1], ibr.q0[,2], lwd=2, xlab="Number of individuals", ylab="Hill numbers",
   type="l", main="Individual-based rarefaction")
   lines(ibr.q1[,1], ibr.q1[,2], lwd=2, lty=2)
   lines(ibr.q2[,1], ibr.q2[,2], lwd=2, lty=3)
   legend("bottomright", lty=c(1,2,3), lwd=2, legend=c("q = 0", "q = 1", "q = 2"), cex=1.2)
   plot(ibr.q0.cov[,1], ibr.q0.cov[,2], lwd=2, xlab="Coverage", ylab="Hill numbers",
   type="l", main="Coverage-based rarefaction")
   lines(ibr.q1.cov[,1], ibr.q1.cov[,2], lwd=2, lty=2)
   lines(ibr.q2.cov[,1], ibr.q2.cov[,2], lwd=2, lty=3)
   legend("topleft", lty=c(1,2,3), lwd=2, legend=c("q = 0", "q = 1", "q = 2"), cex=1.2)

   ## Sample-based and coverage-based rarefaction
   # Load the data
   data(Chiapas)
   Chiapas &lt;- subset(Chiapas, Region=="El Triunfo")
   str(Chiapas)

   # Get sample-based and coverage-based rarefaction curves for different Hill numbers
   sbr.q0 &lt;- rarefaction.sample(Chiapas[,-1])
   sbr.q1 &lt;- rarefaction.sample(Chiapas[,-1], q=1)
   sbr.q2 &lt;- rarefaction.sample(Chiapas[,-1], q=2)
   sbr.q0.cov &lt;- rarefaction.sample(Chiapas[,-1], method="coverage")
   sbr.q1.cov &lt;- rarefaction.sample(Chiapas[,-1], q=1, method="coverage")
   sbr.q2.cov &lt;- rarefaction.sample(Chiapas[,-1], q=2, method="coverage")

   # Plot the results
   par(mfcol=c(1,2))
   plot(sbr.q0[,1], sbr.q0[,2], lwd=2, xlab="Sampling units", ylab="Hill numbers",
   type="l", main="Sample-based rarefaction")
   lines(sbr.q1[,1], sbr.q1[,2], lwd=2, lty=2)
   lines(sbr.q2[,1], sbr.q2[,2], lwd=2, lty=3)
   legend("bottomright", lty=c(1,2,3), lwd=2, legend=c("q = 0", "q = 1", "q = 2"), cex=1.2)
   plot(sbr.q0.cov[,1], sbr.q0.cov[,2], lwd=2, xlab="Coverage", ylab="Hill numbers",
   type="l", main="Coverage-based rarefaction")
   lines(sbr.q1.cov[,1], sbr.q1.cov[,2], lwd=2, lty=2)
   lines(sbr.q2.cov[,1], sbr.q2.cov[,2], lwd=2, lty=3)
   legend("topleft", lty=c(1,2,3), lwd=2, legend=c("q = 0", "q = 1", "q = 2"), cex=1.2)
  
## End(Not run)
</code></pre>

<hr>
<h2 id='rareNMtests-internal'> Internal rareNMtests function </h2><span id='topic+area.xypolygon'></span>

<h3>Description</h3>

<p> Internal rareNMtests function. </p>


<h3>Usage</h3>

<pre><code class='language-R'>   area.xypolygon(polly)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rareNMtests-internal_+3A_polly">polly</code></td>
<td>
<p>A polygon data set.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This internal function is not usually called directly by the user. 
</p>


<h3>Value</h3>

<p> The area of the polygon is returned. </p>


<h3>Note</h3>

<p>The function <code>area.xypolygon</code> is similar to the <code>area.xypolygon</code> internal function of the <span class="pkg">spatstat</span> package.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
