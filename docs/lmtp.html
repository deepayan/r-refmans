<!DOCTYPE html><html><head><title>Help for package lmtp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {lmtp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#lmtp-package'><p>lmtp: Non-Parametric Causal Effects of Feasible Interventions Based on Modified Treatment Policies</p></a></li>
<li><a href='#create_node_list'><p>Create a node list specification</p></a></li>
<li><a href='#event_locf'><p>Time To Event Last Outcome Carried Forward</p></a></li>
<li><a href='#ipsi'><p>IPSI Function Factory</p></a></li>
<li><a href='#lmtp_contrast'><p>Perform Contrasts of LMTP Fits</p></a></li>
<li><a href='#lmtp_control'><p>Set LMTP Estimation Parameters</p></a></li>
<li><a href='#lmtp_ipw'><p>LMTP IPW Estimator</p></a></li>
<li><a href='#lmtp_sdr'><p>LMTP Sequential Doubly Robust Estimator</p></a></li>
<li><a href='#lmtp_sub'><p>LMTP Substitution Estimator</p></a></li>
<li><a href='#lmtp_tmle'><p>LMTP Targeted Maximum Likelihood Estimator</p></a></li>
<li><a href='#multivariate_data'><p>Simulated Multivariate Exposure Data</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#sim_cens'><p>Simulated Longitudinal Data With Censoring</p></a></li>
<li><a href='#sim_point_surv'><p>Simulated Point-treatment Survival Data</p></a></li>
<li><a href='#sim_t4'><p>Simulated Longitudinal Data</p></a></li>
<li><a href='#sim_timevary_surv'><p>Simulated Time-varying Survival Data</p></a></li>
<li><a href='#static_binary_off'><p>Turn All Treatment Nodes Off</p></a></li>
<li><a href='#static_binary_on'><p>Turn All Treatment Nodes On</p></a></li>
<li><a href='#tidy.lmtp'><p>Tidy a(n) lmtp object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Non-Parametric Causal Effects of Feasible Interventions Based on
Modified Treatment Policies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Non-parametric estimators for casual effects based on longitudinal modified treatment 
  policies as described in Diaz, Williams, Hoffman, and Schenck &lt;<a href="https://doi.org/10.1080%2F01621459.2021.1955691">doi:10.1080/01621459.2021.1955691</a>&gt;, traditional point treatment, 
  and traditional longitudinal effects. Continuous, binary, categorical treatments, and multivariate treatments are allowed as well are 
  censored outcomes. The treatment mechanism is estimated via a density ratio classification procedure 
  irrespective of treatment variable type. For both continuous and binary outcomes, additive treatment effects 
  can be calculated and relative risks and odds ratios may be calculated for binary outcomes.  </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, nnls, cli, R6, generics, origami, future (&ge; 1.17.0),
progressr, data.table (&ge; 1.13.0), checkmate (&ge; 2.1.0),
SuperLearner, schoolmath</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://beyondtheate.com/">https://beyondtheate.com/</a>, <a href="https://github.com/nt-williams/lmtp">https://github.com/nt-williams/lmtp</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/nt-williams/lmtp/issues">https://github.com/nt-williams/lmtp/issues</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 2.1.0), covr, rmarkdown, knitr, ranger, twang</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-27 03:27:38 UTC; ntw2117</td>
</tr>
<tr>
<td>Author:</td>
<td>Nicholas Williams <a href="https://orcid.org/0000-0002-1378-4831"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Iván Díaz <a href="https://orcid.org/0000-0001-9056-2047"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Nicholas Williams &lt;ntwilliams.personal@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-27 03:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='lmtp-package'>lmtp: Non-Parametric Causal Effects of Feasible Interventions Based on Modified Treatment Policies</h2><span id='topic+lmtp'></span><span id='topic+lmtp-package'></span>

<h3>Description</h3>

<p>Non-parametric estimators for casual effects based on longitudinal modified treatment policies as described in Diaz, Williams, Hoffman, and Schenck <a href="https://doi.org/10.1080/01621459.2021.1955691">doi:10.1080/01621459.2021.1955691</a>, traditional point treatment, and traditional longitudinal effects. Continuous, binary, categorical treatments, and multivariate treatments are allowed as well are censored outcomes. The treatment mechanism is estimated via a density ratio classification procedure irrespective of treatment variable type. For both continuous and binary outcomes, additive treatment effects can be calculated and relative risks and odds ratios may be calculated for binary outcomes.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Nicholas Williams <a href="mailto:ntwilliams.personal@gmail.com">ntwilliams.personal@gmail.com</a> (<a href="https://orcid.org/0000-0002-1378-4831">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Iván Díaz <a href="mailto:Ivan.Diaz@nyulangone.org">Ivan.Diaz@nyulangone.org</a> (<a href="https://orcid.org/0000-0001-9056-2047">ORCID</a>) [copyright holder]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://beyondtheate.com/">https://beyondtheate.com/</a>
</p>
</li>
<li> <p><a href="https://github.com/nt-williams/lmtp">https://github.com/nt-williams/lmtp</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/nt-williams/lmtp/issues">https://github.com/nt-williams/lmtp/issues</a>
</p>
</li></ul>


<hr>
<h2 id='create_node_list'>Create a node list specification</h2><span id='topic+create_node_list'></span>

<h3>Description</h3>

<p>Creates a node list specification that is used by the provided estimators.
<code>create_node_list()</code> is not explicitly called by the analyst, rather
it is provided so the analyst can confirm how estimators will use variables
before actually performing the estimation procedure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_node_list(trt, tau, time_vary = NULL, baseline = NULL, k = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="create_node_list_+3A_trt">trt</code></td>
<td>
<p>A vector of column names of treatment variables.</p>
</td></tr>
<tr><td><code id="create_node_list_+3A_tau">tau</code></td>
<td>
<p>The number of time points of observation, excluding the final outcome.</p>
</td></tr>
<tr><td><code id="create_node_list_+3A_time_vary">time_vary</code></td>
<td>
<p>A list of length tau with the column names for new time_vary to
be introduced at each time point. The list should be ordered following
the time ordering of the model.</p>
</td></tr>
<tr><td><code id="create_node_list_+3A_baseline">baseline</code></td>
<td>
<p>An optional vector of columns names for baseline covariates to be
included for adjustment at every timepoint.</p>
</td></tr>
<tr><td><code id="create_node_list_+3A_k">k</code></td>
<td>
<p>An integer specifying how previous time points should be
used for estimation at the given time point. Default is <code>Inf</code>,
all time points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of lists. Each sub-list is the same length of the
<code>time_vary</code> parameter with the variables to be used for estimation at that given time point
for either the treatment mechanism or outcome regression.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>a &lt;- c("A_1", "A_2", "A_3", "A_4")
bs &lt;- c("W_1", "W_2")
time_vary &lt;- list(c("L_1"), c("L_2"), c("L_3"), c("L_4"))

# assuming no Markov property
create_node_list(a, 4, time_vary, bs, k = Inf)

# assuming a Markov property
create_node_list(a, 4, time_vary, bs, k = 0)
</code></pre>

<hr>
<h2 id='event_locf'>Time To Event Last Outcome Carried Forward</h2><span id='topic+event_locf'></span>

<h3>Description</h3>

<p>A helper function to prepare survival data for use with LMTP estimators
by imputing outcome nodes using last outcome carried forward when an observation
experiences the event before the end-of-follow-up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>event_locf(data, outcomes)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="event_locf_+3A_data">data</code></td>
<td>
<p>The dataset to modify.</p>
</td></tr>
<tr><td><code id="event_locf_+3A_outcomes">outcomes</code></td>
<td>
<p>A vector of outcome nodes ordered by time.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A modified dataset with future outcome nodes set to 1 if an observation
experienced an event at any previous time point.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>event_locf(sim_point_surv, paste0("Y.", 1:6))
</code></pre>

<hr>
<h2 id='ipsi'>IPSI Function Factory</h2><span id='topic+ipsi'></span>

<h3>Description</h3>

<p>A function factory that returns a shift function for increasing or decreasing
the probability of exposure when exposure is binary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ipsi(delta)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ipsi_+3A_delta">delta</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
A risk ratio between 0 and Inf.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A shift function.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmtp_tmle">lmtp_tmle()</a></code>, <code><a href="#topic+lmtp_sdr">lmtp_sdr()</a></code>, <code><a href="#topic+lmtp_sub">lmtp_sub()</a></code>, <code><a href="#topic+lmtp_ipw">lmtp_ipw()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("iptwExWide", package = "twang")
a &lt;- paste0("tx", 1:3)
baseline &lt;- c("gender", "age")
tv &lt;- list(c("use0"), c("use1"), c("use2"))
lmtp_sdr(iptwExWide, a, "outcome", baseline = baseline, time_vary = tv,
         shift = ipsi(0.5), outcome_type = "continuous", folds = 2)

</code></pre>

<hr>
<h2 id='lmtp_contrast'>Perform Contrasts of LMTP Fits</h2><span id='topic+lmtp_contrast'></span>

<h3>Description</h3>

<p>Estimates contrasts of multiple LMTP fits compared to either a known reference value
or a reference LMTP fit.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_contrast(..., ref, type = c("additive", "rr", "or"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_contrast_+3A_...">...</code></td>
<td>
<p>One or more objects of class lmtp.</p>
</td></tr>
<tr><td><code id="lmtp_contrast_+3A_ref">ref</code></td>
<td>
<p>A reference value or another lmtp fit to compare all other fits against.</p>
</td></tr>
<tr><td><code id="lmtp_contrast_+3A_type">type</code></td>
<td>
<p>The contrasts of interest. Options are &quot;additive&quot; (the default),
&quot;rr&quot;, and &quot;or&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>lmtp_contrast</code> containing the following components:
</p>
<table>
<tr><td><code>type</code></td>
<td>
<p>The type of contrast performed.</p>
</td></tr>
<tr><td><code>null</code></td>
<td>
<p>The null hypothesis.</p>
</td></tr>
<tr><td><code>vals</code></td>
<td>
<p>A dataframe containing the contrasts estimates, standard errors, and confidence intervals.</p>
</td></tr>
<tr><td><code>eifs</code></td>
<td>
<p>Un-centered estimated influence functions for contrasts estimated.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  a &lt;- c("A1", "A2")
  nodes &lt;- list(c("L1"), c("L2"))
  cens &lt;- c("C1", "C2")
  y &lt;- "Y"

  # mean population outcome
  psi_null &lt;- lmtp_tmle(sim_cens, a, y, time_vary = nodes, cens = cens, shift = NULL, folds = 1)

  # treatment rule, everyone is increased by 0.5
  d &lt;- function(data, x) data[[x]] + 0.5
  psi_rule1 &lt;- lmtp_tmle(sim_cens, a, y, time_vary = nodes, cens = cens,
                         shift = d, folds = 1, mtp = TRUE)

  # treatment rule, everyone is decreased by 0.5
  d &lt;- function(data, x) data[[x]] - 0.5
  psi_rule2 &lt;- lmtp_tmle(sim_cens, a, y, time_vary = nodes, cens = cens,
                         shift = d, folds = 1, mtp = TRUE)

  # Example 1.1
  # Additive effect of rule 1 compared to a known constant
  lmtp_contrast(psi_rule1, ref = 0.9)

  # Example 1.2
  # Additive effect of rule 1 compared to the population mean outcome
  lmtp_contrast(psi_rule1, ref = psi_null)

  # Example 1.3
  # Additive effects of rule 1 and 2 compared to the population mean outcome
  lmtp_contrast(psi_rule1, psi_rule2, ref = psi_null)

  # Example 1.4
  # Relative risk of rule 1 compared to observed exposure
  lmtp_contrast(psi_rule1, ref = psi_null, type = "rr")

  # Example 1.5
  # Odds of rule 1 compared to observed exposure
  lmtp_contrast(psi_rule1, ref = psi_null, type = "or")

</code></pre>

<hr>
<h2 id='lmtp_control'>Set LMTP Estimation Parameters</h2><span id='topic+lmtp_control'></span>

<h3>Description</h3>

<p>Set LMTP Estimation Parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_control(
  .bound = 1e+05,
  .trim = 0.999,
  .learners_outcome_folds = 10,
  .learners_trt_folds = 10,
  .return_full_fits = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_control_+3A_.bound">.bound</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
Determines that maximum and minimum values (scaled) predictions
will be bounded by. The default is 1e-5, bounding predictions by 1e-5 and 0.9999.</p>
</td></tr>
<tr><td><code id="lmtp_control_+3A_.trim">.trim</code></td>
<td>
<p>[<code>numeric(1)</code>]<br />
Determines the amount the density ratios should be trimmed.
The default is 0.999, trimming the density ratios greater than the 0.999 percentile
to the 0.999 percentile. A value of 1 indicates no trimming.</p>
</td></tr>
<tr><td><code id="lmtp_control_+3A_.learners_outcome_folds">.learners_outcome_folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of cross-validation folds for <code>learners_outcome</code>.</p>
</td></tr>
<tr><td><code id="lmtp_control_+3A_.learners_trt_folds">.learners_trt_folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of cross-validation folds for <code>learners_trt</code>.</p>
</td></tr>
<tr><td><code id="lmtp_control_+3A_.return_full_fits">.return_full_fits</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Return full SuperLearner fits? Default is <code>FALSE</code>, return only SuperLearner weights.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of parameters controlling the estimation procedure.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lmtp_control(.trim = 0.975)
</code></pre>

<hr>
<h2 id='lmtp_ipw'>LMTP IPW Estimator</h2><span id='topic+lmtp_ipw'></span>

<h3>Description</h3>

<p>Inverse probability of treatment weighting estimator for the effects of traditional causal
effects and modified treatment policies for both point treatment and longitudinal data
with binary, continuous, or time-to-event outcomes. Supports binary, categorical, and continuous exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_ipw(
  data,
  trt,
  outcome,
  baseline = NULL,
  time_vary = NULL,
  cens = NULL,
  shift = NULL,
  shifted = NULL,
  mtp = FALSE,
  k = Inf,
  id = NULL,
  outcome_type = c("binomial", "continuous", "survival"),
  learners = "SL.glm",
  folds = 10,
  weights = NULL,
  control = lmtp_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_ipw_+3A_data">data</code></td>
<td>
<p>[<code>data.frame</code>]<br />
A <code>data.frame</code> in wide format containing all necessary variables
for the estimation problem. Must not be a <code>data.table</code>.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_trt">trt</code></td>
<td>
<p>[<code>character</code>] or [<code>list</code>]<br />
A vector containing the column names of treatment variables ordered by time.
Or, a list of vectors, the same length as the number of time points of observation.
Vectors should contain column names for the treatment variables at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_outcome">outcome</code></td>
<td>
<p>[<code>character</code>]<br />
The column name of the outcome variable. In the case of time-to-event
analysis, a vector containing the columns names of intermediate outcome variables and the final
outcome variable ordered by time. Only numeric values are allowed. If the outcome type
is binary, data should be coded as 0 and 1.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_baseline">baseline</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector containing the column names of baseline covariates to be
included for adjustment at every time point.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_time_vary">time_vary</code></td>
<td>
<p>[<code>list</code>]<br />
A list the same length as the number of time points of observation with
the column names for new time-varying covariates introduced at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_cens">cens</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector of column names of censoring indicators the same
length as the number of time points of observation. If missingness in the outcome is
present or if time-to-event outcome, must be provided.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_shift">shift</code></td>
<td>
<p>[<code>closure</code>]<br />
A two argument function that specifies how treatment variables should be shifted.
See examples for how to specify shift functions for continuous, binary, and categorical exposures.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_shifted">shifted</code></td>
<td>
<p>[<code>data.frame</code>]<br />
An optional data frame, the same as in <code>data</code>, but modified according
to the treatment policy of interest. If specified, <code>shift</code> is ignored.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_mtp">mtp</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Is the intervention of interest a modified treatment policy?
Default is <code>FALSE</code>. If treatment variables are continuous this should be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_k">k</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
An integer specifying how previous time points should be
used for estimation at the given time point. Default is <code>Inf</code>,
all time points.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_id">id</code></td>
<td>
<p>[<code>character(1)</code>]<br />
An optional column name containing cluster level identifiers.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_outcome_type">outcome_type</code></td>
<td>
<p>[<code>character(1)</code>]<br />
Outcome variable type (i.e., continuous, binomial, survival).</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_learners">learners</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the exposure mechanism. Default is <code>"SL.glm"</code>, a main effects GLM.
<b>Only include candidate learners capable of binary classification</b>.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_folds">folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of folds to be used for cross-fitting.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_weights">weights</code></td>
<td>
<p>[<code>numeric(nrow(data))</code>]<br />
An optional vector containing sampling weights.</p>
</td></tr>
<tr><td><code id="lmtp_ipw_+3A_control">control</code></td>
<td>
<p>[<code>list()</code>]<br />
Output of <code>lmtp_control()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Should <code>mtp = TRUE</code>?</h4>

<p>A modified treatment policy (MTP) is an intervention that depends
on the natural value of the exposure (the value that the treatment would have taken under no intervention).
This differs from other causal effects,
such as the average treatment effect (ATE), where an exposure would be increased (or decreased) deterministically.
<b>If your intervention of interest adds, subtracts, or multiplies the observed treatment values
by some amount, use <code>mtp = TRUE</code></b>.
</p>



<h3>Value</h3>

<p>A list of class <code>lmtp</code> containing the following components:
</p>
<table>
<tr><td><code>estimator</code></td>
<td>
<p>The estimator used, in this case &quot;IPW&quot;.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The estimated population LMTP effect.</p>
</td></tr>
<tr><td><code>standard_error</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The shift function specifying the treatment policy of interest.</p>
</td></tr>
<tr><td><code>density_ratios</code></td>
<td>
<p>An n x Tau matrix of the estimated density ratios.</p>
</td></tr>
<tr><td><code>fits_r</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold of density ratio estimation.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(56)
  n &lt;- 1000
  W &lt;- rnorm(n, 10, 5)
  A &lt;- 23 + 5*W + rnorm(n)
  Y &lt;- 7.2*A + 3*W + rnorm(n)
  ex1_dat &lt;- data.frame(W, A, Y)

  # Example 1.1
  # Point treatment, continuous exposure, continuous outcome, no loss-to-follow-up
  # Interested in the effect of a modified treatment policy where A is decreased by 15
  # units only among observations whose observed A was above 80.
  # The true value under this intervention is about 513.
  policy &lt;- function(data, x) {
    (data[[x]] &gt; 80)*(data[[x]] - 15) + (data[[x]] &lt;= 80)*data[[x]]
  }

  lmtp_ipw(ex1_dat, "A", "Y", "W", mtp = TRUE, shift = policy,
           outcome_type = "continuous", folds = 2)

  # Example 2.1
  # Longitudinal setting, time-varying continuous exposure bounded by 0,
  # time-varying covariates, and a binary outcome with no loss-to-follow-up.
  # Interested in the effect of a treatment policy where exposure decreases by
  # one unit at every time point if an observations observed exposure is greater
  # than or equal to 2. The true value under this intervention is about 0.305.
  head(sim_t4)

  A &lt;- c("A_1", "A_2", "A_3", "A_4")
  L &lt;- list(c("L_1"), c("L_2"), c("L_3"), c("L_4"))

  policy &lt;- function(data, trt) {
    a &lt;- data[[trt]]
    (a - 1) * (a - 1 &gt;= 1) + a * (a - 1 &lt; 1)
  }

  # BONUS: progressr progress bars!
  progressr::handlers(global = TRUE)

  lmtp_ipw(sim_t4, A, "Y", time_vary = L,
           shift = policy, folds = 2, mtp = TRUE)

  # Example 2.2
  # The previous example assumed that the outcome (as well as the treatment variables)
  # were directly affected by all other nodes in the past. In certain situations,
  # domain specific knowledge may suggest otherwise.
  # This can be controlled using the k argument.
  lmtp_ipw(sim_t4, A, "Y", time_vary = L, mtp = TRUE,
           shift = policy, k = 0, folds = 2)

  # Example 2.3
  # Using the same data as examples 2.1 and 2.2.
  # Now estimating the effect of a dynamic modified treatment policy.
  # creating a dynamic mtp that applies the shift function
  # but also depends on history and the current time
  policy &lt;- function(data, trt) {
    mtp &lt;- function(data, trt) {
      (data[[trt]] - 1) * (data[[trt]] - 1 &gt;= 1) + data[[trt]] * (data[[trt]] - 1 &lt; 1)
    }

    # if its the first time point, follow the same mtp as before
    if (trt == "A_1") return(mtp(data, trt))

    # otherwise check if the time varying covariate equals 1
    ifelse(
      data[[sub("A", "L", trt)]] == 1,
      mtp(data, trt), # if yes continue with the policy
      data[[trt]]     # otherwise do nothing
    )
  }

  lmtp_ipw(sim_t4, A, "Y", time_vary = L,
           k = 0, mtp = TRUE, shift = policy, folds = 2)

  # Example 2.4
  # Using the same data as examples 2.1, 2.2, and 2.3, but now treating the exposure
  # as an ordered categorical variable. To account for the exposure being a
  # factor we just need to modify the shift function (and the original data)
  # so as to respect this.
  tmp &lt;- sim_t4
  for (i in A) {
    tmp[[i]] &lt;- factor(tmp[[i]], levels = 0:5, ordered = TRUE)
  }

  policy &lt;- function(data, trt) {
    out &lt;- list()
    a &lt;- data[[trt]]
    for (i in 1:length(a)) {
      if (as.character(a[i]) %in% c("0", "1")) {
        out[[i]] &lt;- as.character(a[i])
      } else {
        out[[i]] &lt;- as.numeric(as.character(a[i])) - 1
      }
    }
    factor(unlist(out), levels = 0:5, ordered = TRUE)
  }

  lmtp_ipw(tmp, A, "Y", time_vary = L, shift = policy,
           k = 0, folds = 2, mtp = TRUE)

  # Example 3.1
  # Longitudinal setting, time-varying binary treatment, time-varying covariates
  # and baseline covariates with no loss-to-follow-up. Interested in a "traditional"
  # causal effect where treatment is set to 1 at all time points for all observations.
  if (require("twang")) {
    data("iptwExWide", package = "twang")

    A &lt;- paste0("tx", 1:3)
    W &lt;- c("gender", "age")
    L &lt;- list(c("use0"), c("use1"), c("use2"))

    lmtp_ipw(iptwExWide, A, "outcome", baseline = W, time_vary = L,
             shift = static_binary_on, outcome_type = "continuous",
             mtp = FALSE, folds = 2)
  }

  # Example 4.1
  # Longitudinal setting, time-varying continuous treatment, time-varying covariates,
  # binary outcome with right censoring. Interested in the mean population outcome under
  # the observed exposures in a hypothetical population with no loss-to-follow-up.
  head(sim_cens)

  A &lt;- c("A1", "A2")
  L &lt;- list(c("L1"), c("L2"))
  C &lt;- c("C1", "C2")
  Y &lt;- "Y"

  lmtp_ipw(sim_cens, A, Y, time_vary = L, cens = C, shift = NULL, folds = 2)

  # Example 5.1
  # Time-to-event analysis with a binary time-invariant exposure. Interested in
  # the effect of treatment being given to all observations on the cumulative
  # incidence of the outcome.
  # For a survival problem, the outcome argument now takes a vector of outcomes
  # if an observation experiences the event prior to the end of follow-up, all future
  # outcome nodes should be set to 1 (i.e., last observation carried forward).
  A &lt;- "trt"
  Y &lt;- paste0("Y.", 1:6)
  C &lt;- paste0("C.", 0:5)
  W &lt;- c("W1", "W2")

  lmtp_ipw(sim_point_surv, A, Y, W, cens = C, folds = 2,
            shift = static_binary_on, outcome_type = "survival")

  # Example 6.1
  # Intervening on multiple exposures simultaneously. Interested in the effect of
  # a modified treatment policy where variable D1 is decreased by 0.1 units and
  # variable D2 is decreased by 0.5 units simultaneously.
  A &lt;- list(c("D1", "D2"))
  W &lt;- paste0("C", 1:3)
  Y &lt;- "Y"

  d &lt;- function(data, a) {
    out = list(
      data[[a[1]]] - 0.1,
      data[[a[2]]] - 0.5
    )
    setNames(out, a)
  }

  lmtp_ipw(multivariate_data, A, Y, W, shift = d,
           outcome_type = "continuous", folds = 1, mtp = TRUE)

</code></pre>

<hr>
<h2 id='lmtp_sdr'>LMTP Sequential Doubly Robust Estimator</h2><span id='topic+lmtp_sdr'></span>

<h3>Description</h3>

<p>Sequentially doubly robust estimator for the effects of traditional causal effects and
modified treatment policies for both point treatment and longitudinal data with binary,
continuous, or time-to-event outcomes. Supports binary, categorical, and continuous exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_sdr(
  data,
  trt,
  outcome,
  baseline = NULL,
  time_vary = NULL,
  cens = NULL,
  shift = NULL,
  shifted = NULL,
  k = Inf,
  mtp = FALSE,
  outcome_type = c("binomial", "continuous", "survival"),
  id = NULL,
  bounds = NULL,
  learners_outcome = "SL.glm",
  learners_trt = "SL.glm",
  folds = 10,
  weights = NULL,
  control = lmtp_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_sdr_+3A_data">data</code></td>
<td>
<p>[<code>data.frame</code>]<br />
A <code>data.frame</code> in wide format containing all necessary variables
for the estimation problem. Must not be a <code>data.table</code>.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_trt">trt</code></td>
<td>
<p>[<code>character</code>] or [<code>list</code>]<br />
A vector containing the column names of treatment variables ordered by time.
Or, a list of vectors, the same length as the number of time points of observation.
Vectors should contain column names for the treatment variables at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_outcome">outcome</code></td>
<td>
<p>[<code>character</code>]<br />
The column name of the outcome variable. In the case of time-to-event
analysis, a vector containing the columns names of intermediate outcome variables and the final
outcome variable ordered by time. Only numeric values are allowed. If the outcome type
is binary, data should be coded as 0 and 1.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_baseline">baseline</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector containing the column names of baseline covariates to be
included for adjustment at every time point.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_time_vary">time_vary</code></td>
<td>
<p>[<code>list</code>]<br />
A list the same length as the number of time points of observation with
the column names for new time-varying covariates introduced at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_cens">cens</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector of column names of censoring indicators the same
length as the number of time points of observation. If missingness in the outcome is
present or if time-to-event outcome, must be provided.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_shift">shift</code></td>
<td>
<p>[<code>closure</code>]<br />
A two argument function that specifies how treatment variables should be shifted.
See examples for how to specify shift functions for continuous, binary, and categorical exposures.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_shifted">shifted</code></td>
<td>
<p>[<code>data.frame</code>]<br />
An optional data frame, the same as in <code>data</code>, but modified according
to the treatment policy of interest. If specified, <code>shift</code> is ignored.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_k">k</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
An integer specifying how previous time points should be
used for estimation at the given time point. Default is <code>Inf</code>,
all time points.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_mtp">mtp</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Is the intervention of interest a modified treatment policy?
Default is <code>FALSE</code>. If treatment variables are continuous this should be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_outcome_type">outcome_type</code></td>
<td>
<p>[<code>character(1)</code>]<br />
Outcome variable type (i.e., continuous, binomial, survival).</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_id">id</code></td>
<td>
<p>[<code>character(1)</code>]<br />
An optional column name containing cluster level identifiers.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_bounds">bounds</code></td>
<td>
<p>[<code>numeric(2)</code>]<br />
An optional, ordered vector of the bounds for a continuous outcomes. If <code>NULL</code>,
the bounds will be taken as the minimum and maximum of the observed data.
Should be left as <code>NULL</code> if the outcome type is binary.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_learners_outcome">learners_outcome</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the outcome regression. Default is <code>"SL.glm"</code>, a main effects GLM.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_learners_trt">learners_trt</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the exposure mechanism. Default is <code>"SL.glm"</code>, a main effects GLM.
<b>Only include candidate learners capable of binary classification</b>.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_folds">folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of folds to be used for cross-fitting.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_weights">weights</code></td>
<td>
<p>[<code>numeric(nrow(data))</code>]<br />
An optional vector containing sampling weights.</p>
</td></tr>
<tr><td><code id="lmtp_sdr_+3A_control">control</code></td>
<td>
<p>[<code>list()</code>]<br />
Output of <code>lmtp_control()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Should <code>mtp = TRUE</code>?</h4>

<p>A modified treatment policy (MTP) is an intervention that depends
on the natural value of the exposure (the value that the treatment would have taken under no intervention).
This differs from other causal effects,
such as the average treatment effect (ATE), where an exposure would be increased (or decreased) deterministically.
<b>If your intervention of interest adds, subtracts, or multiplies the observed treatment values
by some amount, use <code>mtp = TRUE</code></b>.
</p>



<h3>Value</h3>

<p>A list of class <code>lmtp</code> containing the following components:
</p>
<table>
<tr><td><code>estimator</code></td>
<td>
<p>The estimator used, in this case &quot;SDR&quot;.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The estimated population LMTP effect.</p>
</td></tr>
<tr><td><code>standard_error</code></td>
<td>
<p>The estimated standard error of the LMTP effect.</p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>Lower bound of the 95% confidence interval of the LMTP effect.</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>Upper bound of the 95% confidence interval of the LMTP effect.</p>
</td></tr>
<tr><td><code>eif</code></td>
<td>
<p>The estimated, un-centered, influence function of the estimate.</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The shift function specifying the treatment policy of interest.</p>
</td></tr>
<tr><td><code>outcome_reg</code></td>
<td>
<p>An n x Tau + 1 matrix of outcome regression predictions.
The mean of the first column is used for calculating theta.</p>
</td></tr>
<tr><td><code>density_ratios</code></td>
<td>
<p>An n x Tau matrix of the estimated, non-cumulative, density ratios.</p>
</td></tr>
<tr><td><code>fits_m</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold for the outcome regression.</p>
</td></tr>
<tr><td><code>fits_r</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold of density ratio estimation.</p>
</td></tr>
<tr><td><code>outcome_type</code></td>
<td>
<p>The outcome variable type.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(56)
  n &lt;- 1000
  W &lt;- rnorm(n, 10, 5)
  A &lt;- 23 + 5*W + rnorm(n)
  Y &lt;- 7.2*A + 3*W + rnorm(n)
  ex1_dat &lt;- data.frame(W, A, Y)

  # Example 1.1
  # Point treatment, continuous exposure, continuous outcome, no loss-to-follow-up
  # Interested in the effect of a modified treatment policy where A is decreased by 15
  # units only among observations whose observed A was above 80.
  # The true value under this intervention is about 513.
  policy &lt;- function(data, x) {
    (data[[x]] &gt; 80)*(data[[x]] - 15) + (data[[x]] &lt;= 80)*data[[x]]
  }

  lmtp_sdr(ex1_dat, "A", "Y", "W", shift = policy,
           outcome_type = "continuous", folds = 2, mtp = TRUE)

  # Example 2.1
  # Longitudinal setting, time-varying continuous exposure bounded by 0,
  # time-varying covariates, and a binary outcome with no loss-to-follow-up.
  # Interested in the effect of a treatment policy where exposure decreases by
  # one unit at every time point if an observations observed exposure is greater
  # than or equal to 2. The true value under this intervention is about 0.305.
  head(sim_t4)

  A &lt;- c("A_1", "A_2", "A_3", "A_4")
  L &lt;- list(c("L_1"), c("L_2"), c("L_3"), c("L_4"))

  policy &lt;- function(data, trt) {
    a &lt;- data[[trt]]
    (a - 1) * (a - 1 &gt;= 1) + a * (a - 1 &lt; 1)
  }

  # BONUS: progressr progress bars!
  progressr::handlers(global = TRUE)

  lmtp_sdr(sim_t4, A, "Y", time_vary = L, shift = policy,
           folds = 2, mtp = TRUE)

  # Example 2.2
  # The previous example assumed that the outcome (as well as the treatment variables)
  # were directly affected by all other nodes in the past. In certain situations,
  # domain specific knowledge may suggest otherwise.
  # This can be controlled using the k argument.
  lmtp_sdr(sim_t4, A, "Y", time_vary = L, shift = policy,
           k = 0, folds = 2, mtp = TRUE)

  # Example 2.3
  # Using the same data as examples 2.1 and 2.2.
  # Now estimating the effect of a dynamic modified treatment policy.
  # creating a dynamic mtp that applies the shift function
  # but also depends on history and the current time
  policy &lt;- function(data, trt) {
    mtp &lt;- function(data, trt) {
      (data[[trt]] - 1) * (data[[trt]] - 1 &gt;= 1) + data[[trt]] * (data[[trt]] - 1 &lt; 1)
    }

    # if its the first time point, follow the same mtp as before
    if (trt == "A_1") return(mtp(data, trt))

    # otherwise check if the time varying covariate equals 1
    ifelse(
      data[[sub("A", "L", trt)]] == 1,
      mtp(data, trt), # if yes continue with the policy
      data[[trt]]     # otherwise do nothing
    )
  }

  lmtp_sdr(sim_t4, A, "Y", time_vary = L, mtp = TRUE,
           k = 0, shift = policy, folds = 2)

  # Example 2.4
  # Using the same data as examples 2.1, 2.2, and 2.3, but now treating the exposure
  # as an ordered categorical variable. To account for the exposure being a
  # factor we just need to modify the shift function (and the original data)
  # so as to respect this.
  tmp &lt;- sim_t4
  for (i in A) {
    tmp[[i]] &lt;- factor(tmp[[i]], levels = 0:5, ordered = TRUE)
  }

  policy &lt;- function(data, trt) {
    out &lt;- list()
    a &lt;- data[[trt]]
    for (i in 1:length(a)) {
      if (as.character(a[i]) %in% c("0", "1")) {
        out[[i]] &lt;- as.character(a[i])
      } else {
        out[[i]] &lt;- as.numeric(as.character(a[i])) - 1
      }
    }
    factor(unlist(out), levels = 0:5, ordered = TRUE)
  }

  lmtp_sdr(tmp, A, "Y", time_vary = L, shift = policy,
           k = 0, folds = 2, mtp = TRUE)

  # Example 3.1
  # Longitudinal setting, time-varying binary treatment, time-varying covariates
  # and baseline covariates with no loss-to-follow-up. Interested in a "traditional"
  # causal effect where treatment is set to 1 at all time points for all observations.
  if (require("twang")) {
    data("iptwExWide", package = "twang")

    A &lt;- paste0("tx", 1:3)
    W &lt;- c("gender", "age")
    L &lt;- list(c("use0"), c("use1"), c("use2"))

    lmtp_sdr(
      iptwExWide, A, "outcome", baseline = W, time_vary = L,
      shift = static_binary_on, outcome_type = "continuous",
      mtp = FALSE, folds = 2
    )
  }

  # Example 4.1
  # Longitudinal setting, time-varying continuous treatment, time-varying covariates,
  # binary outcome with right censoring. Interested in the mean population outcome under
  # the observed exposures in a hypothetical population with no loss-to-follow-up.
  head(sim_cens)

  A &lt;- c("A1", "A2")
  L &lt;- list(c("L1"), c("L2"))
  C &lt;- c("C1", "C2")
  Y &lt;- "Y"

  lmtp_sdr(sim_cens, A, Y, time_vary = L, cens = C, shift = NULL, folds = 2)

  # Example 5.1
  # Time-to-event analysis with a binary time-invariant exposure. Interested in
  # the effect of treatment being given to all observations on the cumulative
  # incidence of the outcome.
  # For a survival problem, the outcome argument now takes a vector of outcomes
  # if an observation experiences the event prior to the end of follow-up, all future
  # outcome nodes should be set to 1 (i.e., last observation carried forward).
  A &lt;- "trt"
  Y &lt;- paste0("Y.", 1:6)
  C &lt;- paste0("C.", 0:5)
  W &lt;- c("W1", "W2")

  lmtp_sdr(sim_point_surv, A, Y, W, cens = C, folds = 2,
           shift = static_binary_on, outcome_type = "survival")

  # Example 6.1
  # Intervening on multiple exposures simultaneously. Interested in the effect of
  # a modified treatment policy where variable D1 is decreased by 0.1 units and
  # variable D2 is decreased by 0.5 units simultaneously.
  A &lt;- list(c("D1", "D2"))
  W &lt;- paste0("C", 1:3)
  Y &lt;- "Y"

  d &lt;- function(data, a) {
    out = list(
      data[[a[1]]] - 0.1,
      data[[a[2]]] - 0.5
    )
    setNames(out, a)
  }

  lmtp_sdr(multivariate_data, A, Y, W, shift = d,
           outcome_type = "continuous", folds = 1, mtp = TRUE)

</code></pre>

<hr>
<h2 id='lmtp_sub'>LMTP Substitution Estimator</h2><span id='topic+lmtp_sub'></span>

<h3>Description</h3>

<p>G-computation estimator for the effects of traditional causal effects and
modified treatment policies for both point treatment and longitudinal data with binary,
continuous, or time-to-event outcomes. Supports binary, categorical, and continuous exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_sub(
  data,
  trt,
  outcome,
  baseline = NULL,
  time_vary = NULL,
  cens = NULL,
  shift = NULL,
  shifted = NULL,
  k = Inf,
  outcome_type = c("binomial", "continuous", "survival"),
  id = NULL,
  bounds = NULL,
  learners = "SL.glm",
  folds = 10,
  weights = NULL,
  control = lmtp_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_sub_+3A_data">data</code></td>
<td>
<p>[<code>data.frame</code>]<br />
A <code>data.frame</code> in wide format containing all necessary variables
for the estimation problem. Must not be a <code>data.table</code>.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_trt">trt</code></td>
<td>
<p>[<code>character</code>] or [<code>list</code>]<br />
A vector containing the column names of treatment variables ordered by time.
Or, a list of vectors, the same length as the number of time points of observation.
Vectors should contain column names for the treatment variables at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_outcome">outcome</code></td>
<td>
<p>[<code>character</code>]<br />
The column name of the outcome variable. In the case of time-to-event
analysis, a vector containing the columns names of intermediate outcome variables and the final
outcome variable ordered by time. Only numeric values are allowed. If the outcome type
is binary, data should be coded as 0 and 1.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_baseline">baseline</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector containing the column names of baseline covariates to be
included for adjustment at every time point.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_time_vary">time_vary</code></td>
<td>
<p>[<code>list</code>]<br />
A list the same length as the number of time points of observation with
the column names for new time-varying covariates introduced at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_cens">cens</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector of column names of censoring indicators the same
length as the number of time points of observation. If missingness in the outcome is
present or if time-to-event outcome, must be provided.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_shift">shift</code></td>
<td>
<p>[<code>closure</code>]<br />
A two argument function that specifies how treatment variables should be shifted.
See examples for how to specify shift functions for continuous, binary, and categorical exposures.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_shifted">shifted</code></td>
<td>
<p>[<code>data.frame</code>]<br />
An optional data frame, the same as in <code>data</code>, but modified according
to the treatment policy of interest. If specified, <code>shift</code> is ignored.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_k">k</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
An integer specifying how previous time points should be
used for estimation at the given time point. Default is <code>Inf</code>,
all time points.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_outcome_type">outcome_type</code></td>
<td>
<p>[<code>character(1)</code>]<br />
Outcome variable type (i.e., continuous, binomial, survival).</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_id">id</code></td>
<td>
<p>[<code>character(1)</code>]<br />
An optional column name containing cluster level identifiers.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_bounds">bounds</code></td>
<td>
<p>[<code>numeric(2)</code>]<br />
An optional, ordered vector of the bounds for a continuous outcomes. If <code>NULL</code>,
the bounds will be taken as the minimum and maximum of the observed data.
Should be left as <code>NULL</code> if the outcome type is binary.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_learners">learners</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the outcome regression. Default is <code>"SL.glm"</code>, a main effects GLM.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_folds">folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of folds to be used for cross-fitting.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_weights">weights</code></td>
<td>
<p>[<code>numeric(nrow(data))</code>]<br />
An optional vector containing sampling weights.</p>
</td></tr>
<tr><td><code id="lmtp_sub_+3A_control">control</code></td>
<td>
<p>[<code>list()</code>]<br />
Output of <code>lmtp_control()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of class <code>lmtp</code> containing the following components:
</p>
<table>
<tr><td><code>estimator</code></td>
<td>
<p>The estimator used, in this case &quot;substitution&quot;.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The estimated population LMTP effect.</p>
</td></tr>
<tr><td><code>standard_error</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>NA</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The shift function specifying the treatment policy of interest.</p>
</td></tr>
<tr><td><code>outcome_reg</code></td>
<td>
<p>An n x Tau + 1 matrix of outcome regression predictions.
The mean of the first column is used for calculating theta.</p>
</td></tr>
<tr><td><code>fits_m</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold for the outcome regression.</p>
</td></tr>
<tr><td><code>outcome_type</code></td>
<td>
<p>The outcome variable type.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(56)
  n &lt;- 1000
  W &lt;- rnorm(n, 10, 5)
  A &lt;- 23 + 5*W + rnorm(n)
  Y &lt;- 7.2*A + 3*W + rnorm(n)
  ex1_dat &lt;- data.frame(W, A, Y)

  # Example 1.1
  # Point treatment, continuous exposure, continuous outcome, no loss-to-follow-up
  # Interested in the effect of a modified treatment policy where A is decreased by 15
  # units only among observations whose observed A was above 80.
  # The true value under this intervention is about 513.
  policy &lt;- function(data, x) {
    (data[[x]] &gt; 80)*(data[[x]] - 15) + (data[[x]] &lt;= 80)*data[[x]]
  }

  lmtp_sub(ex1_dat, "A", "Y", "W", shift = policy,
           outcome_type = "continuous", folds = 2)

  # Example 2.1
  # Longitudinal setting, time-varying continuous exposure bounded by 0,
  # time-varying covariates, and a binary outcome with no loss-to-follow-up.
  # Interested in the effect of a treatment policy where exposure decreases by
  # one unit at every time point if an observations observed exposure is greater
  # than or equal to 2. The true value under this intervention is about 0.305.
  head(sim_t4)

  A &lt;- c("A_1", "A_2", "A_3", "A_4")
  L &lt;- list(c("L_1"), c("L_2"), c("L_3"), c("L_4"))

  policy &lt;- function(data, trt) {
    a &lt;- data[[trt]]
    (a - 1) * (a - 1 &gt;= 1) + a * (a - 1 &lt; 1)
  }

  # BONUS: progressr progress bars!
  progressr::handlers(global = TRUE)

  lmtp_sub(sim_t4, A, "Y", time_vary = L, shift = policy, folds = 2)

  # Example 2.2
  # The previous example assumed that the outcome (as well as the treatment variables)
  # were directly affected by all other nodes in the past. In certain situations,
  # domain specific knowledge may suggest otherwise.
  # This can be controlled using the k argument.
  lmtp_sub(sim_t4, A, "Y", time_vary = L, shift = policy, k = 0, folds = 2)

  # Example 2.3
  # Using the same data as examples 2.1 and 2.2.
  # Now estimating the effect of a dynamic modified treatment policy.

  # creating a dynamic mtp that applies the shift function
  # but also depends on history and the current time
  policy &lt;- function(data, trt) {
    mtp &lt;- function(data, trt) {
      (data[[trt]] - 1) * (data[[trt]] - 1 &gt;= 1) + data[[trt]] * (data[[trt]] - 1 &lt; 1)
    }

    # if its the first time point, follow the same mtp as before
    if (trt == "A_1") return(mtp(data, trt))

    # otherwise check if the time varying covariate equals 1
    ifelse(
      data[[sub("A", "L", trt)]] == 1,
      mtp(data, trt), # if yes continue with the policy
      data[[trt]]     # otherwise do nothing
    )
  }

  lmtp_sub(sim_t4, A, "Y", time_vary = L, k = 0, shift = policy, folds = 2)

  # Example 2.4
  # Using the same data as examples 2.1, 2.2, and 2.3, but now treating the exposure
  # as an ordered categorical variable. To account for the exposure being a
  # factor we just need to modify the shift function (and the original data)
  # so as to respect this.
  tmp &lt;- sim_t4
  for (i in A) {
    tmp[[i]] &lt;- factor(tmp[[i]], levels = 0:5, ordered = TRUE)
  }

  policy &lt;- function(data, trt) {
    out &lt;- list()
    a &lt;- data[[trt]]
    for (i in 1:length(a)) {
      if (as.character(a[i]) %in% c("0", "1")) {
        out[[i]] &lt;- as.character(a[i])
      } else {
        out[[i]] &lt;- as.numeric(as.character(a[i])) - 1
      }
    }
    factor(unlist(out), levels = 0:5, ordered = TRUE)
  }

  lmtp_sub(tmp, A, "Y", time_vary = L, shift = policy, k = 0, folds = 2)

  # Example 3.1
  # Longitudinal setting, time-varying binary treatment, time-varying covariates
  # and baseline covariates with no loss-to-follow-up. Interested in a "traditional"
  # causal effect where treatment is set to 1 at all time points for all observations.
  if (require("twang")) {
    data("iptwExWide", package = "twang")

    A &lt;- paste0("tx", 1:3)
    W &lt;- c("gender", "age")
    L &lt;- list(c("use0"), c("use1"), c("use2"))

    lmtp_sub(iptwExWide, A, "outcome", baseline = W, time_vary = L,
             shift = static_binary_on, outcome_type = "continuous")
  }

  # Example 4.1
  # Longitudinal setting, time-varying continuous treatment, time-varying covariates,
  # binary outcome with right censoring. Interested in the mean population outcome under
  # the observed exposures in a hypothetical population with no loss-to-follow-up.
  head(sim_cens)

  A &lt;- c("A1", "A2")
  L &lt;- list(c("L1"), c("L2"))
  C &lt;- c("C1", "C2")
  Y &lt;- "Y"

  lmtp_sub(sim_cens, A, Y, time_vary = L, cens = C, shift = NULL, folds = 2)

  # Example 5.1
  # Time-to-event analysis with a binary time-invariant exposure. Interested in
  # the effect of treatment being given to all observations on the cumulative
  # incidence of the outcome.
  # For a survival problem, the outcome argument now takes a vector of outcomes
  # if an observation experiences the event prior to the end of follow-up, all future
  # outcome nodes should be set to 1 (i.e., last observation carried forward).
  A &lt;- "trt"
  Y &lt;- paste0("Y.", 1:6)
  C &lt;- paste0("C.", 0:5)
  W &lt;- c("W1", "W2")

  lmtp_sub(sim_point_surv, A, Y, W, cens = C, folds = 2,
           shift = static_binary_on, outcome_type = "survival")

  # Example 6.1
  # Intervening on multiple exposures simultaneously. Interested in the effect of
  # a modified treatment policy where variable D1 is decreased by 0.1 units and
  # variable D2 is decreased by 0.5 units simultaneously.
  A &lt;- list(c("D1", "D2"))
  W &lt;- paste0("C", 1:3)
  Y &lt;- "Y"

  d &lt;- function(data, a) {
    out = list(
      data[[a[1]]] - 0.1,
      data[[a[2]]] - 0.5
    )
    setNames(out, a)
  }

  lmtp_sub(multivariate_data, A, Y, W, shift = d,
           outcome_type = "continuous", folds = 1)

</code></pre>

<hr>
<h2 id='lmtp_tmle'>LMTP Targeted Maximum Likelihood Estimator</h2><span id='topic+lmtp_tmle'></span>

<h3>Description</h3>

<p>Targeted maximum likelihood estimator for the effects of traditional causal effects and
modified treatment policies for both point treatment and longitudinal data with binary,
continuous, or time-to-event outcomes. Supports binary, categorical, and continuous exposures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmtp_tmle(
  data,
  trt,
  outcome,
  baseline = NULL,
  time_vary = NULL,
  cens = NULL,
  shift = NULL,
  shifted = NULL,
  k = Inf,
  mtp = FALSE,
  outcome_type = c("binomial", "continuous", "survival"),
  id = NULL,
  bounds = NULL,
  learners_outcome = "SL.glm",
  learners_trt = "SL.glm",
  folds = 10,
  weights = NULL,
  control = lmtp_control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lmtp_tmle_+3A_data">data</code></td>
<td>
<p>[<code>data.frame</code>]<br />
A <code>data.frame</code> in wide format containing all necessary variables
for the estimation problem. Must not be a <code>data.table</code>.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_trt">trt</code></td>
<td>
<p>[<code>character</code>] or [<code>list</code>]<br />
A vector containing the column names of treatment variables ordered by time.
Or, a list of vectors, the same length as the number of time points of observation.
Vectors should contain column names for the treatment variables at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_outcome">outcome</code></td>
<td>
<p>[<code>character</code>]<br />
The column name of the outcome variable. In the case of time-to-event
analysis, a vector containing the columns names of intermediate outcome variables and the final
outcome variable ordered by time. Only numeric values are allowed. If the outcome type
is binary, data should be coded as 0 and 1.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_baseline">baseline</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector containing the column names of baseline covariates to be
included for adjustment at every time point.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_time_vary">time_vary</code></td>
<td>
<p>[<code>list</code>]<br />
A list the same length as the number of time points of observation with
the column names for new time-varying covariates introduced at each time point. The list
should be ordered following the time ordering of the model.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_cens">cens</code></td>
<td>
<p>[<code>character</code>]<br />
An optional vector of column names of censoring indicators the same
length as the number of time points of observation. If missingness in the outcome is
present or if time-to-event outcome, must be provided.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_shift">shift</code></td>
<td>
<p>[<code>closure</code>]<br />
A two argument function that specifies how treatment variables should be shifted.
See examples for how to specify shift functions for continuous, binary, and categorical exposures.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_shifted">shifted</code></td>
<td>
<p>[<code>data.frame</code>]<br />
An optional data frame, the same as in <code>data</code>, but modified according
to the treatment policy of interest. If specified, <code>shift</code> is ignored.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_k">k</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
An integer specifying how previous time points should be
used for estimation at the given time point. Default is <code>Inf</code>,
all time points.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_mtp">mtp</code></td>
<td>
<p>[<code>logical(1)</code>]<br />
Is the intervention of interest a modified treatment policy?
Default is <code>FALSE</code>. If treatment variables are continuous this should be <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_outcome_type">outcome_type</code></td>
<td>
<p>[<code>character(1)</code>]<br />
Outcome variable type (i.e., continuous, binomial, survival).</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_id">id</code></td>
<td>
<p>[<code>character(1)</code>]<br />
An optional column name containing cluster level identifiers.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_bounds">bounds</code></td>
<td>
<p>[<code>numeric(2)</code>]<br />
An optional, ordered vector of the bounds for a continuous outcomes. If <code>NULL</code>,
the bounds will be taken as the minimum and maximum of the observed data.
Should be left as <code>NULL</code> if the outcome type is binary.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_learners_outcome">learners_outcome</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the outcome regression. Default is <code>"SL.glm"</code>, a main effects GLM.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_learners_trt">learners_trt</code></td>
<td>
<p>[<code>character</code>]<br /> A vector of <code>SuperLearner</code> algorithms for estimation
of the exposure mechanism. Default is <code>"SL.glm"</code>, a main effects GLM.
<b>Only include candidate learners capable of binary classification</b>.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_folds">folds</code></td>
<td>
<p>[<code>integer(1)</code>]<br />
The number of folds to be used for cross-fitting.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_weights">weights</code></td>
<td>
<p>[<code>numeric(nrow(data))</code>]<br />
An optional vector containing sampling weights.</p>
</td></tr>
<tr><td><code id="lmtp_tmle_+3A_control">control</code></td>
<td>
<p>[<code>list()</code>]<br />
Output of <code>lmtp_control()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>



<h4>Should <code>mtp = TRUE</code>?</h4>

<p>A modified treatment policy (MTP) is an intervention that depends
on the natural value of the exposure (the value that the treatment would have taken under no intervention).
This differs from other causal effects,
such as the average treatment effect (ATE), where an exposure would be increased (or decreased) deterministically.
<b>If your intervention of interest adds, subtracts, or multiplies the observed treatment values
by some amount, use <code>mtp = TRUE</code></b>.
</p>



<h3>Value</h3>

<p>A list of class <code>lmtp</code> containing the following components:
</p>
<table>
<tr><td><code>estimator</code></td>
<td>
<p>The estimator used, in this case &quot;TMLE&quot;.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>The estimated population LMTP effect.</p>
</td></tr>
<tr><td><code>standard_error</code></td>
<td>
<p>The estimated standard error of the LMTP effect.</p>
</td></tr>
<tr><td><code>low</code></td>
<td>
<p>Lower bound of the 95% confidence interval of the LMTP effect.</p>
</td></tr>
<tr><td><code>high</code></td>
<td>
<p>Upper bound of the 95% confidence interval of the LMTP effect.</p>
</td></tr>
<tr><td><code>eif</code></td>
<td>
<p>The estimated, un-centered, influence function of the estimate.</p>
</td></tr>
<tr><td><code>shift</code></td>
<td>
<p>The shift function specifying the treatment policy of interest.</p>
</td></tr>
<tr><td><code>outcome_reg</code></td>
<td>
<p>An n x Tau + 1 matrix of outcome regression predictions.
The mean of the first column is used for calculating theta.</p>
</td></tr>
<tr><td><code>density_ratios</code></td>
<td>
<p>An n x Tau matrix of the estimated, non-cumulative, density ratios.</p>
</td></tr>
<tr><td><code>fits_m</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold for the outcome regression.</p>
</td></tr>
<tr><td><code>fits_r</code></td>
<td>
<p>A list the same length as <code>folds</code>, containing the fits at each time-point
for each fold of density ratio estimation.</p>
</td></tr>
<tr><td><code>outcome_type</code></td>
<td>
<p>The outcome variable type.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
  set.seed(56)
  n &lt;- 1000
  W &lt;- rnorm(n, 10, 5)
  A &lt;- 23 + 5*W + rnorm(n)
  Y &lt;- 7.2*A + 3*W + rnorm(n)
  ex1_dat &lt;- data.frame(W, A, Y)

  # Example 1.1
  # Point treatment, continuous exposure, continuous outcome, no loss-to-follow-up
  # Interested in the effect of a modified treatment policy where A is decreased by 15
  # units only among observations whose observed A was above 80.
  # The true value under this intervention is about 513.
  policy &lt;- function(data, x) {
    (data[[x]] &gt; 80)*(data[[x]] - 15) + (data[[x]] &lt;= 80)*data[[x]]
  }

  lmtp_tmle(ex1_dat, "A", "Y", "W", shift = policy,
            outcome_type = "continuous", folds = 2, mtp = TRUE)

  # Example 2.1
  # Longitudinal setting, time-varying continuous exposure bounded by 0,
  # time-varying covariates, and a binary outcome with no loss-to-follow-up.
  # Interested in the effect of a treatment policy where exposure decreases by
  # one unit at every time point if an observations observed exposure is greater
  # than or equal to 2. The true value under this intervention is about 0.305.
  head(sim_t4)

  A &lt;- c("A_1", "A_2", "A_3", "A_4")
  L &lt;- list(c("L_1"), c("L_2"), c("L_3"), c("L_4"))
  policy &lt;- function(data, trt) {
    a &lt;- data[[trt]]
    (a - 1) * (a - 1 &gt;= 1) + a * (a - 1 &lt; 1)
  }

  # BONUS: progressr progress bars!
  progressr::handlers(global = TRUE)

  lmtp_tmle(sim_t4, A, "Y", time_vary = L, shift = policy,
            folds = 2, mtp = TRUE)

  # Example 2.2
  # The previous example assumed that the outcome (as well as the treatment variables)
  # were directly affected by all other nodes in the past. In certain situations,
  # domain specific knowledge may suggest otherwise.
  # This can be controlled using the k argument.
  lmtp_tmle(sim_t4, A, "Y", time_vary = L, shift = policy,
            k = 0, folds = 2, mtp = TRUE)

  # Example 2.3
  # Using the same data as examples 2.1 and 2.2.
  # Now estimating the effect of a dynamic modified treatment policy.
  # creating a dynamic mtp that applies the shift function
  # but also depends on history and the current time
  policy &lt;- function(data, trt) {
    mtp &lt;- function(data, trt) {
      (data[[trt]] - 1) * (data[[trt]] - 1 &gt;= 1) + data[[trt]] * (data[[trt]] - 1 &lt; 1)
    }

    # if its the first time point, follow the same mtp as before
    if (trt == "A_1") return(mtp(data, trt))

    # otherwise check if the time varying covariate equals 1
    ifelse(
      data[[sub("A", "L", trt)]] == 1,
      mtp(data, trt), # if yes continue with the policy
      data[[trt]]     # otherwise do nothing
    )
  }

  lmtp_tmle(sim_t4, A, "Y", time_vary = L, mtp = TRUE,
            k = 0, shift = policy, folds = 2)

  # Example 2.4
  # Using the same data as examples 2.1, 2.2, and 2.3, but now treating the exposure
  # as an ordered categorical variable. To account for the exposure being a
  # factor we just need to modify the shift function (and the original data)
  # so as to respect this.
  tmp &lt;- sim_t4
  for (i in A) {
    tmp[[i]] &lt;- factor(tmp[[i]], levels = 0:5, ordered = TRUE)
  }

  policy &lt;- function(data, trt) {
    out &lt;- list()
    a &lt;- data[[trt]]
    for (i in 1:length(a)) {
      if (as.character(a[i]) %in% c("0", "1")) {
        out[[i]] &lt;- as.character(a[i])
      } else {
        out[[i]] &lt;- as.numeric(as.character(a[i])) - 1
      }
    }
    factor(unlist(out), levels = 0:5, ordered = TRUE)
  }

  lmtp_tmle(tmp, A, "Y", time_vary = L, shift = policy,
            k = 0, folds = 2, mtp = TRUE)

  # Example 3.1
  # Longitudinal setting, time-varying binary treatment, time-varying covariates
  # and baseline covariates with no loss-to-follow-up. Interested in a "traditional"
  # causal effect where treatment is set to 1 at all time points for all observations.
  if (require("twang")) {
    data("iptwExWide", package = "twang")

    A &lt;- paste0("tx", 1:3)
    W &lt;- c("gender", "age")
    L &lt;- list(c("use0"), c("use1"), c("use2"))

    lmtp_tmle(iptwExWide, A, "outcome", baseline = W, time_vary = L,
              shift = static_binary_on, outcome_type = "continuous",
              mtp = FALSE, folds = 2)
  }

  # Example 4.1
  # Longitudinal setting, time-varying continuous treatment, time-varying covariates,
  # binary outcome with right censoring. Interested in the mean population outcome under
  # the observed exposures in a hypothetical population with no loss-to-follow-up.
  head(sim_cens)

  A &lt;- c("A1", "A2")
  L &lt;- list(c("L1"), c("L2"))
  C &lt;- c("C1", "C2")
  Y &lt;- "Y"

  lmtp_tmle(sim_cens, A, Y, time_vary = L, cens = C, shift = NULL, folds = 2)

  # Example 5.1
  # Time-to-event analysis with a binary time-invariant exposure. Interested in
  # the effect of treatment being given to all observations on the cumulative
  # incidence of the outcome.
  # For a survival problem, the outcome argument now takes a vector of outcomes
  # if an observation experiences the event prior to the end of follow-up, all future
  # outcome nodes should be set to 1 (i.e., last observation carried forward).
  A &lt;- "trt"
  Y &lt;- paste0("Y.", 1:6)
  C &lt;- paste0("C.", 0:5)
  W &lt;- c("W1", "W2")

  lmtp_tmle(sim_point_surv, A, Y, W, cens = C, folds = 2,
            shift = static_binary_on, outcome_type = "survival")

  # Example 6.1
  # Intervening on multiple exposures simultaneously. Interested in the effect of
  # a modified treatment policy where variable D1 is decreased by 0.1 units and
  # variable D2 is decreased by 0.5 units simultaneously.
  A &lt;- list(c("D1", "D2"))
  W &lt;- paste0("C", 1:3)
  Y &lt;- "Y"

  d &lt;- function(data, a) {
    out = list(
      data[[a[1]]] - 0.1,
      data[[a[2]]] - 0.5
    )
    setNames(out, a)
  }

  lmtp_tmle(multivariate_data, A, Y, W, shift = d,
            outcome_type = "continuous", folds = 1, mtp = TRUE)

</code></pre>

<hr>
<h2 id='multivariate_data'>Simulated Multivariate Exposure Data</h2><span id='topic+multivariate_data'></span>

<h3>Description</h3>

<p>A dataset with a continuous outcome, three baseline covariates,
and two treatment variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multivariate_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 6 variables:
</p>

<dl>
<dt>C1</dt><dd><p>Continuous baseline variable.</p>
</dd>
<dt>C2</dt><dd><p>Continuous baseline variable.</p>
</dd>
<dt>C3</dt><dd><p>Continuous baseline variable.</p>
</dd>
<dt>D1</dt><dd><p>Treatment variable one at baseline.</p>
</dd>
<dt>D2</dt><dd><p>Treatment variable two at baseline.</p>
</dd>
<dt>Y</dt><dd><p>Continuous outcome</p>
</dd>
</dl>


<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+tidy'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>generics</dt><dd><p><code><a href="generics.html#topic+tidy">tidy</a></code></p>
</dd>
</dl>

<hr>
<h2 id='sim_cens'>Simulated Longitudinal Data With Censoring</h2><span id='topic+sim_cens'></span>

<h3>Description</h3>

<p>A dataset with a binary outcome, two time varying treatment nodes,
two time varying covariates, and two censoring indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_cens
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 10 variables:
</p>

<dl>
<dt>L1</dt><dd><p>Time varying covariate time 1</p>
</dd>
<dt>A1</dt><dd><p>Treatment node at time 1, effected by L_1</p>
</dd>
<dt>C1</dt><dd><p>Censoring indicator that the observation is observed after time 1</p>
</dd>
<dt>L2</dt><dd><p>Time varying covariate at time 2, effected by L_1 and A_1</p>
</dd>
<dt>A2</dt><dd><p>Treatment node at time 2, effected by L_2 and A_1</p>
</dd>
<dt>C2</dt><dd><p>Censoring indicator that the observation is observed after time 2</p>
</dd>
<dt>Y</dt><dd><p>Binary outcome at time 3, effected by L_2 and A_2</p>
</dd>
</dl>


<hr>
<h2 id='sim_point_surv'>Simulated Point-treatment Survival Data</h2><span id='topic+sim_point_surv'></span>

<h3>Description</h3>

<p>A dataset with a time-to-event outcome, two baseline nodes, a binary
point treatment, six past-time outcome nodes, and six censoring indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_point_surv
</code></pre>


<h3>Format</h3>

<p>A data frame with 2000 rows and 16 variables:
</p>

<dl>
<dt>W1</dt><dd><p>Binary baseline variable.</p>
</dd>
<dt>W2</dt><dd><p>Categorical baseline variable.</p>
</dd>
<dt>trt</dt><dd><p>Binary treatment variable.</p>
</dd>
<dt>C.0</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.1</dt><dd><p>Outcome node at time 1.</p>
</dd>
<dt>C.1</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.2</dt><dd><p>Outcome node at time 2.</p>
</dd>
<dt>C.2</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.3</dt><dd><p>Outcome node at time 3.</p>
</dd>
<dt>C.3</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.4</dt><dd><p>Outcome node at time 4.</p>
</dd>
<dt>C.4</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.5</dt><dd><p>Outcome node at time 5.</p>
</dd>
<dt>C.5</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y.6</dt><dd><p>Final outcome node.</p>
</dd>
</dl>


<hr>
<h2 id='sim_t4'>Simulated Longitudinal Data</h2><span id='topic+sim_t4'></span>

<h3>Description</h3>

<p>A dataset with a binary outcome, four time varying treatment nodes,
and four time varying covariates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_t4
</code></pre>


<h3>Format</h3>

<p>A data frame with 5000 rows and 10 variables:
</p>

<dl>
<dt>ID</dt><dd><p>observation ID</p>
</dd>
<dt>L_1</dt><dd><p>Time varying covariate time 1</p>
</dd>
<dt>A_1</dt><dd><p>Treatment node at time 1, effected by L_1</p>
</dd>
<dt>L_2</dt><dd><p>Time varying covariate time 1, effected by L_1 and A_1</p>
</dd>
<dt>A_2</dt><dd><p>Treatment node at time 2, effected by L_2 and A_1</p>
</dd>
<dt>L_3</dt><dd><p>Time varying covariate time 1, effected by L_2 and A_2</p>
</dd>
<dt>A_3</dt><dd><p>Treatment node at time 3, effected by L_3 and A_2</p>
</dd>
<dt>L_4</dt><dd><p>Time varying covariate time 1, effected by L_3 and A_3</p>
</dd>
<dt>A_4</dt><dd><p>Treatment node at time 3, effected by L_4 and A_3</p>
</dd>
<dt>Y</dt><dd><p>Binary outcome at time 5, effected by L_4 and A_4</p>
</dd>
</dl>


<hr>
<h2 id='sim_timevary_surv'>Simulated Time-varying Survival Data</h2><span id='topic+sim_timevary_surv'></span>

<h3>Description</h3>

<p>A dataset with a time-to-event outcome, one baseline nodes, two time-varying
covariates, a binary time-varying treatment, two outcome nodes,
and two censoring indicators. Data-generating mechanism taken from
Lendle, Schwab, Petersen, and van der Laan (<a href="https://www.jstatsoft.org/article/view/v081i01">https://www.jstatsoft.org/article/view/v081i01</a>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_timevary_surv
</code></pre>


<h3>Format</h3>

<p>A data frame with 500 rows and 11 variables:
</p>

<dl>
<dt>L0.a</dt><dd><p>Continuous baseline variable.</p>
</dd>
<dt>L0.b</dt><dd><p>Time varying covariate at baseline.</p>
</dd>
<dt>L0.c</dt><dd><p>Time varying covariate at baseline.</p>
</dd>
<dt>A0</dt><dd><p>Treatment variable at baseline</p>
</dd>
<dt>C0</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>L1.a</dt><dd><p>Time varying covariate at time 1.</p>
</dd>
<dt>L1.b</dt><dd><p>Time varying covariate at time 1.</p>
</dd>
<dt>Y1</dt><dd><p>Outcome node at time 1.</p>
</dd>
<dt>A1</dt><dd><p>Treatment variable at time 1.</p>
</dd>
<dt>C1</dt><dd><p>Censoring indicator that the observation is observed future time points.</p>
</dd>
<dt>Y2</dt><dd><p>Final outcome node.</p>
</dd>
</dl>


<hr>
<h2 id='static_binary_off'>Turn All Treatment Nodes Off</h2><span id='topic+static_binary_off'></span>

<h3>Description</h3>

<p>A pre-packaged shift function for use with provided estimators when the exposure is binary.
Used to estimate the population intervention effect when all treatment variables are set to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>static_binary_off(data, trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="static_binary_off_+3A_data">data</code></td>
<td>
<p>A dataframe containing the treatment variables.</p>
</td></tr>
<tr><td><code id="static_binary_off_+3A_trt">trt</code></td>
<td>
<p>The name of the current treatment variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with all treatment nodes set to 0.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmtp_tmle">lmtp_tmle()</a></code>, <code><a href="#topic+lmtp_sdr">lmtp_sdr()</a></code>, <code><a href="#topic+lmtp_sub">lmtp_sub()</a></code>, <code><a href="#topic+lmtp_ipw">lmtp_ipw()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("iptwExWide", package = "twang")
a &lt;- paste0("tx", 1:3)
baseline &lt;- c("gender", "age")
tv &lt;- list(c("use0"), c("use1"), c("use2"))
lmtp_sdr(iptwExWide, a, "outcome", baseline = baseline, time_vary = tv,
         shift = static_binary_off, outcome_type = "continuous", folds = 2)

</code></pre>

<hr>
<h2 id='static_binary_on'>Turn All Treatment Nodes On</h2><span id='topic+static_binary_on'></span>

<h3>Description</h3>

<p>A pre-packaged shift function for use with provided estimators when the exposure is binary.
Used to estimate the population intervention effect when all treatment variables are set to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>static_binary_on(data, trt)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="static_binary_on_+3A_data">data</code></td>
<td>
<p>A dataframe containing the treatment variables.</p>
</td></tr>
<tr><td><code id="static_binary_on_+3A_trt">trt</code></td>
<td>
<p>The name of the current treatment variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dataframe with all treatment nodes set to 1.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmtp_tmle">lmtp_tmle()</a></code>, <code><a href="#topic+lmtp_sdr">lmtp_sdr()</a></code>, <code><a href="#topic+lmtp_sub">lmtp_sub()</a></code>, <code><a href="#topic+lmtp_ipw">lmtp_ipw()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("iptwExWide", package = "twang")
a &lt;- paste0("tx", 1:3)
baseline &lt;- c("gender", "age")
tv &lt;- list(c("use0"), c("use1"), c("use2"))
lmtp_sdr(iptwExWide, a, "outcome", baseline = baseline, time_vary = tv,
         shift = static_binary_on, outcome_type = "continuous", folds = 2)

</code></pre>

<hr>
<h2 id='tidy.lmtp'>Tidy a(n) lmtp object</h2><span id='topic+tidy.lmtp'></span>

<h3>Description</h3>

<p>Tidy a(n) lmtp object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lmtp'
tidy(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tidy.lmtp_+3A_x">x</code></td>
<td>
<p>A <code>lmtp</code> object produced by a call to <code><a href="#topic+lmtp_tmle">lmtp_tmle()</a></code>, <code><a href="#topic+lmtp_sdr">lmtp_sdr()</a></code>,
<code><a href="#topic+lmtp_sub">lmtp_sub()</a></code>, or <code><a href="#topic+lmtp_ipw">lmtp_ipw()</a></code>.</p>
</td></tr>
<tr><td><code id="tidy.lmtp_+3A_...">...</code></td>
<td>
<p>Unused, included for generic consistency only.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
a &lt;- c("A1", "A2")
nodes &lt;- list(c("L1"), c("L2"))
cens &lt;- c("C1", "C2")
y &lt;- "Y"
fit &lt;- lmtp_tmle(sim_cens, a, y, time_vary = nodes, cens = cens, shift = NULL, folds = 2)
tidy(fit)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
