<!DOCTYPE html><html><head><title>Help for package R2WinBUGS</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R2WinBUGS}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#R2WinBUGS-package'><p>Running WinBUGS and OpenBUGS from R / S-PLUS</p></a></li>
<li><a href='#as.bugs.array'><p>Convert to bugs object</p></a></li>
<li><a href='#attach.all'><p>Attach / detach elements of (bugs) objects to search path</p></a></li>
<li><a href='#bugs'><p>Run WinBUGS and OpenBUGS from R or S-PLUS</p></a></li>
<li><a href='#bugs.data'><p>Writing input for WinBUGS</p></a></li>
<li><a href='#bugs.inits'><p>Writing input for WinBUGS - intended for internal use only</p></a></li>
<li><a href='#bugs.log'><p>Read data from WinBUGS logfile</p></a></li>
<li><a href='#bugs.plot'><p>Plotting summary information - intended for internal use only</p></a></li>
<li><a href='#bugs.run'><p>Calling WinBUGS</p></a></li>
<li><a href='#bugs.script'><p>Writes script for running WinBUGS</p></a></li>
<li><a href='#bugs.sims'><p>WinBUGS output reader</p></a></li>
<li><a href='#bugs.update.settings'><p>Adjusting WinBUGS registry</p></a></li>
<li><a href='#decode.parameter.name'><p>Decodes WinBUGS parameter names</p></a></li>
<li><a href='#monitor'><p>Special summary statistics</p></a></li>
<li><a href='#openbugs'><p>Wrapper to run OpenBUGS</p></a></li>
<li><a href='#plot.bugs'><p>Plotting a bugs object</p></a></li>
<li><a href='#print.bugs'><p>Printing a bugs object</p></a></li>
<li><a href='#read.bugs'><p>Read output files in CODA format</p></a></li>
<li><a href='#schools'><p>8 schools analysis</p></a></li>
<li><a href='#write.datafile'><p>Write data for WinBUGS</p></a></li>
<li><a href='#write.model'><p>Creating a WinBUGS model file</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Running 'WinBUGS' and 'OpenBUGS' from 'R' / 'S-PLUS'</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-12-14</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-22.1</td>
</tr>
<tr>
<td>Author:</td>
<td>originally written by Andrew Gelman &lt;gelman@stat.columbia.edu&gt;;
 changes and packaged by Sibylle Sturtz &lt;sturtz@statistik.tu-dortmund.de&gt;
 and Uwe Ligges &lt;ligges@statistik.tu-dortmund.de&gt;.
 With considerable contributions by Gregor Gorjanc &lt;gregor.gorjanc@bfro.uni-lj.si&gt;
 and Jouni Kerman &lt;kerman@stat.columbia.edu&gt;.
 Ported to S-PLUS by Insightful Corp.</td>
</tr>
<tr>
<td>Description:</td>
<td>Invoke a 'BUGS' model in 'OpenBUGS' or 'WinBUGS', a class "bugs" for 'BUGS' 
  results and functions to work with that class.
  Function write.model() allows a 'BUGS' model file to be written.  
  The class and auxiliary functions could be used with other MCMC programs, including 'JAGS'.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.13.0), coda (&ge; 0.11-0), boot</td>
</tr>
<tr>
<td>Imports:</td>
<td>utils, stats, graphics</td>
</tr>
<tr>
<td>Suggests:</td>
<td>BRugs (&ge; 0.3-2)</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>OpenBugs for functions bugs() and openbugs() or
WinBUGS 1.4 for function bugs()</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Uwe Ligges &lt;ligges@statistik.tu-dortmund.de&gt;</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-04 20:14:44 UTC; ripley</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-05 07:58:28 UTC</td>
</tr>
</table>
<hr>
<h2 id='R2WinBUGS-package'>Running WinBUGS and OpenBUGS from R / S-PLUS</h2><span id='topic+R2WinBUGS-package'></span><span id='topic+R2WinBUGS'></span>

<h3>Description</h3>

<p><span class="pkg">R2WinBUGS</span> package provides possiblity to call a <span class="pkg">BUGS</span> model,
summarize inferences and convergence in a table and graph, and save the
simulations in arrays for easy access in <span class="rlang"><b>R</b></span> / S-PLUS. In S-PLUS, the
<span class="pkg">OpenBUGS</span> functionality and the windows emulation functionality is
not yet available. The main command is <code><a href="#topic+bugs">bugs</a></code>.
</p>


<h3>Details</h3>

<p>The following are sources of information on <span class="pkg">R2WinBUGS</span> package:
</p>

<table>
<tr>
 <td style="text-align: left;">
  DESCRIPTION file</td><td style="text-align: left;"> <code>library(help="R2WinBUGS")</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  This file</td><td style="text-align: left;">        <code>package?R2WinBUGS</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  Vignette</td><td style="text-align: left;">         <code>vignette("R2WinBUGS")</code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  Some help files</td><td style="text-align: left;">  <code><a href="#topic+bugs">bugs</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;">                 <code><a href="#topic+write.model">write.model</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;">                 <code><a href="#topic+print.bugs">print.bugs</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;">                 <code><a href="#topic+plot.bugs">plot.bugs</a></code></td>
</tr>
<tr>
 <td style="text-align: left;">
  </td><td style="text-align: left;"> </td>
</tr>
<tr>
 <td style="text-align: left;">
  News</td><td style="text-align: left;">             <code>file.show(system.file("NEWS", package="R2WinBUGS"))</code></td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<hr>
<h2 id='as.bugs.array'>Convert to bugs object</h2><span id='topic+as.bugs.array'></span>

<h3>Description</h3>

<p>Function converting results from Markov chain simulations,
that might not be from BUGS, to bugs object. Used mainly to display
results with <code><a href="#topic+plot.bugs">plot.bugs</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.bugs.array(sims.array, model.file=NULL, program=NULL,
    DIC=FALSE, DICOutput=NULL, n.iter=NULL, n.burnin=0, n.thin=1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.bugs.array_+3A_sims.array">sims.array</code></td>
<td>
<p>3-way array of simulation output, with dimensions
n.keep, n.chains, and length of combined parameter vector.</p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_model.file">model.file</code></td>
<td>
<p>file containing the model written in <span class="pkg">WinBUGS</span> code</p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_program">program</code></td>
<td>
<p>the program used</p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_dic">DIC</code></td>
<td>
<p>logical; whether DIC should be calculated, see also
argument <code>DICOutput</code> and details</p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_dicoutput">DICOutput</code></td>
<td>
<p>DIC value</p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations per chain used for generating
<code>sims.array</code></p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in, i.e. number of iterations to
discarded at the beginning for generating <code>sims.array</code></p>
</td></tr>
<tr><td><code id="as.bugs.array_+3A_n.thin">n.thin</code></td>
<td>
<p>thinning rate, a positive integer, used for generating
<code>sims.array</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function takes a 3-way array of simulations and makes it into a
<code><a href="#topic+bugs">bugs</a></code> object that can be conveniently displayed using
<code>print</code> and <code>plot</code> and accessed using <code>attach.bugs</code>.  If
the third dimension of sims() has names, the resulting bugs object will
respect that naming convention. For example, if the parameter names are
&ldquo;alpha[1]&rdquo;, &ldquo;alpha[2]&rdquo;, ..., &ldquo;alpha[8]&rdquo;,
&ldquo;mu&rdquo;, &ldquo;tau&rdquo;, then <code>as.bugs.array</code> will know that
alpha is a vector of length 8, and mu and tau are scalar parameters.
These will all be plotted appropriately by <code>plot</code> and attached
appropriately by <code>attach.bugs</code>.
</p>
<p>If <code>DIC=TRUE</code> then DIC can be either already passed to argument
<code>DICOutput</code> as it is done in <code><a href="#topic+openbugs">openbugs</a></code> or calculated
from deviance values in <code>sims.array</code>.
</p>


<h3>Value</h3>

<p>A <code><a href="#topic+bugs">bugs</a></code> object is returned</p>


<h3>Author(s)</h3>

<p>Jouni Kerman, <a href="mailto:kerman@stat.columbia.edu">kerman@stat.columbia.edu</a> with modification
by Andrew Gelman, <a href="mailto:gelman@stat.columbia.edu">gelman@stat.columbia.edu</a>, packaged by Uwe
Ligges, <a href="mailto:ligges@statistik.tu-dortmund.de">ligges@statistik.tu-dortmund.de</a>.</p>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code></p>

<hr>
<h2 id='attach.all'>Attach / detach elements of (bugs) objects to search path</h2><span id='topic+attach.all'></span><span id='topic+detach.all'></span><span id='topic+attach.bugs'></span><span id='topic+detach.bugs'></span>

<h3>Description</h3>

<p>The database is attached/detached to the search path. See
<code><a href="base.html#topic+attach">attach</a></code> for details.</p>


<h3>Usage</h3>

<pre><code class='language-R'>    attach.all(x, overwrite = NA, name = "attach.all")
    attach.bugs(x, overwrite = NA)
    detach.all(name = "attach.all")
    detach.bugs()
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="attach.all_+3A_x">x</code></td>
<td>
<p>An object, which must be of class <code>bugs</code> for
<code>attach.bugs</code>.</p>
</td></tr>
<tr><td><code id="attach.all_+3A_overwrite">overwrite</code></td>
<td>
<p>If <code>TRUE</code>, objects with identical names in the
Workspace (.GlobalEnv) that are masking objects in the database to
be attached will be deleted. If <code>NA</code> (the default) and an
interactive session is running, a dialog box asks the user whether
masking objects should be deleted.  In non-interactive mode,
behaviour is identical to <code>overwrite=FALSE</code>, i.e. nothing will
be deleted.</p>
</td></tr>
<tr><td><code id="attach.all_+3A_name">name</code></td>
<td>
<p>The name of the environment where <code>x</code> will be
attached / which will be detached.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While <code>attach.all</code> attaches all elements of an object <code>x</code> to
a database called <code>name</code>, <code>attach.bugs</code> attaches all
elements of <code>x$sims.list</code> to the database <code>bugs.sims</code> itself
making use of <code>attach.all</code>.<br />
</p>
<p><code>detach.all</code> and <code>detach.bugs</code> are removing the databases
mentioned above.<br /> <code>attach.all</code> also attaches <code>n.sims</code> (the
number of simulations saved from the MCMC runs) to the database.<br /><br />
</p>
<p>Each scalar parameter in the model is attached as vectors of length
<code>n.sims</code>, each vector is attached as a 2-way array (with first
dimension equal to <code>n.sims</code>), each matrix is attached as a 3-way
array, and so forth.
</p>


<h3>Value</h3>

<p><code>attach.all</code> and <code>attach.bugs</code> invisibly return the
<code><a href="base.html#topic+environment">environment</a></code>(s).<br />
</p>
<p><code>detach.all</code> and <code>detach.bugs</code> detach the
<code>environment</code>(s) named <code>name</code> created by <code>attach.all</code>.
</p>


<h3>Note</h3>

<p>Without detaching, do not use <code>attach.all</code> or <code>attach.bugs</code>
on another (<code>bugs</code>) object, because instead of the given name, an
object called <code>name</code> is attached. Therefore strange things may
happen ...
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code>, <code><a href="base.html#topic+attach">attach</a></code>, <code><a href="base.html#topic+detach">detach</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'># An example model file is given in:
model.file &lt;- system.file("model", "schools.txt", package="R2WinBUGS")
# Some example data (see ?schools for details):
data(schools)
J &lt;- nrow(schools)
y &lt;- schools$estimate
sigma.y &lt;- schools$sd
data &lt;- list ("J", "y", "sigma.y")
inits &lt;- function(){
    list(theta = rnorm(J, 0, 100), mu.theta = rnorm(1, 0, 100),
        sigma.theta = runif(1, 0, 100))
}
parameters &lt;- c("theta", "mu.theta", "sigma.theta")
## Not run: 
## You may need to edit "bugs.directory",
## also you need write access in the working directory:
schools.sim &lt;- bugs(data, inits, parameters, model.file,
    n.chains = 3, n.iter = 1000,
    bugs.directory = "c:/Program Files/WinBUGS14/",
    working.directory = NULL)

# Do some inferential summaries
attach.bugs(schools.sim)
# posterior probability that the coaching program in school A
# is better than in school C:
print(mean(theta[,1] &gt; theta[,3]))
# 50
# and school C's program:
print(quantile(theta[,1] - theta[,3], c(.25, .75)))
plot(theta[,1], theta[,3])
detach.bugs()

## End(Not run)
</code></pre>

<hr>
<h2 id='bugs'>Run WinBUGS and OpenBUGS from R or S-PLUS</h2><span id='topic+bugs'></span>

<h3>Description</h3>

<p>The <code>bugs</code> function takes data and starting values as
input.  It automatically writes a <span class="pkg">WinBUGS</span> script, calls the model, and
saves the simulations for easy access in <span class="rlang"><b>R</b></span> or S-PLUS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs(data, inits, parameters.to.save, model.file="model.bug",
    n.chains=3, n.iter=2000, n.burnin=floor(n.iter/2),
    n.thin=max(1, floor(n.chains * (n.iter - n.burnin) / n.sims)),
    n.sims = 1000, bin=(n.iter - n.burnin) / n.thin,
    debug=FALSE, DIC=TRUE, digits=5, codaPkg=FALSE,
    bugs.directory="c:/Program Files/WinBUGS14/",
    program=c("WinBUGS", "OpenBUGS", "winbugs", "openbugs"),
    working.directory=NULL, clearWD=FALSE,
    useWINE=.Platform$OS.type != "windows", WINE=NULL,
    newWINE=TRUE, WINEPATH=NULL, bugs.seed=NULL, summary.only=FALSE,
    save.history=!summary.only, over.relax = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs_+3A_data">data</code></td>
<td>
<p>either a named list (names corresponding to variable names
in the <code>model.file</code>) of the data for the <span class="pkg">WinBUGS</span> model,
<em>or</em> (which is not recommended and unsafe) a vector or list of the names of the data objects used by
the model. If <code>data</code> is a one element character vector (such as <code>"data.txt"</code>), 
it is assumed that data have already been written to the working directory into that file, 
e.g. by the function <code><a href="#topic+bugs.data">bugs.data</a></code>.</p>
</td></tr>
<tr><td><code id="bugs_+3A_inits">inits</code></td>
<td>
<p>a list with <code>n.chains</code> elements; each element of the
list is itself a list of starting values for the <span class="pkg">WinBUGS</span> model,
<em>or</em> a function creating (possibly random) initial values.
Alternatively, if <code>inits=NULL</code>, initial values are generated
by <span class="pkg">WinBUGS</span>. If <code>inits</code> is a character vector with <code>n.chains</code> elements, 
it is assumed that inits have already been written to the working directory into those files, 
e.g. by the function <code><a href="#topic+bugs.inits">bugs.inits</a></code>.</p>
</td></tr>
<tr><td><code id="bugs_+3A_parameters.to.save">parameters.to.save</code></td>
<td>
<p>character vector of the names of the
parameters to save which should be monitored</p>
</td></tr>
<tr><td><code id="bugs_+3A_model.file">model.file</code></td>
<td>
<p>file containing the model written in <span class="pkg">WinBUGS</span> code.
The extension can be either &lsquo;<span class="file">.bug</span>&rsquo; or &lsquo;<span class="file">.txt</span>&rsquo;.
If the extension is &lsquo;<span class="file">.bug</span>&rsquo; and <code>program=="WinBUGS"</code>,
a copy of the file with extension &lsquo;<span class="file">.txt</span>&rsquo; will be created
in the <code>bugs()</code> call and removed afterwards. Note that
similarly named &lsquo;<span class="file">.txt</span>&rsquo; files will be overwritten.
Alternatively, <code>model.file</code> can be an R function that contains a BUGS model that is written to a 
temporary model file (see <code><a href="base.html#topic+tempfile">tempfile</a></code>) using <code><a href="#topic+write.model">write.model</a></code>.</p>
</td></tr>
<tr><td><code id="bugs_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains (default: 3)</p>
</td></tr>
<tr><td><code id="bugs_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td></tr>
<tr><td><code id="bugs_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in, i.e. number of iterations to
discard at the beginning. Default is <code>n.iter/2</code>, that is,
discarding the first half of the simulations.</p>
</td></tr>
<tr><td><code id="bugs_+3A_n.thin">n.thin</code></td>
<td>
<p>thinning rate. Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td></tr>
<tr><td><code id="bugs_+3A_n.sims">n.sims</code></td>
<td>
<p>The approximate number of simulations to keep after thinning.</p>
</td></tr>
<tr><td><code id="bugs_+3A_bin">bin</code></td>
<td>
<p>number of iterations between saving of results
(i.e. the coda files are saved after each <code>bin</code> iterations);
default is to save only at the end.</p>
</td></tr>
<tr><td><code id="bugs_+3A_debug">debug</code></td>
<td>
<p>if <code>FALSE</code> (default), <span class="pkg">WinBUGS</span> is closed automatically
when the script has finished running, otherwise <span class="pkg">WinBUGS</span> remains open
for further investigation</p>
</td></tr>
<tr><td><code id="bugs_+3A_dic">DIC</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), compute deviance, pD,
and DIC. This is done in <span class="pkg">WinBUGS</span> directly using the rule <code>pD =
    Dbar - Dhat</code>.  If there are less iterations than required for the
adaptive phase, the rule <code>pD=var(deviance) / 2</code> is used.</p>
</td></tr>
<tr><td><code id="bugs_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">WinBUGS</span> input, see
<code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
<tr><td><code id="bugs_+3A_codapkg">codaPkg</code></td>
<td>
<p>logical; if <code>FALSE</code> (default) a <code>bugs</code> object
is returned, if <code>TRUE</code> file names of <span class="pkg">WinBUGS</span> output are
returned for easy access by the <span class="pkg">coda</span> package through function
<code><a href="#topic+read.bugs">read.bugs</a></code> (not used if <code>program="OpenBUGS"</code>).
A <code>bugs</code> object can be converted to an <code>mcmc.list</code> object as 
used by the <span class="pkg">coda</span> package with the method <code><a href="coda.html#topic+as.mcmc.list">as.mcmc.list</a></code> 
(for which a method is provided by R2WinBUGS).</p>
</td></tr>
<tr><td><code id="bugs_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>directory that contains the <span class="pkg">WinBUGS</span> executable.
If the global option <code>R2WinBUGS.bugs.directory</code> is not <code>NULL</code>, 
it will be used as the default.</p>
</td></tr>
<tr><td><code id="bugs_+3A_program">program</code></td>
<td>
<p>the program to use, either
<code>winbugs</code>/<code>WinBUGS</code> or <code>openbugs</code>/<code>OpenBUGS</code>,
the latter makes use of function <code><a href="#topic+openbugs">openbugs</a></code> and requires
the CRAN package <span class="pkg">BRugs</span>. The <code>openbugs</code>/<code>OpenBUGS</code>
choice is not available in S-PLUS.</p>
</td></tr>
<tr><td><code id="bugs_+3A_working.directory">working.directory</code></td>
<td>
<p>sets working directory during execution of
this function; <span class="pkg">WinBUGS</span>' in- and output will be stored in this
directory; if <code>NULL</code>, a temporary working directory via
<code><a href="base.html#topic+tempdir">tempdir</a></code> is used.</p>
</td></tr>
<tr><td><code id="bugs_+3A_clearwd">clearWD</code></td>
<td>
<p>logical; indicating whether the files &lsquo;<span class="file">data.txt</span>&rsquo;,
&lsquo;<span class="file">inits[1:n.chains].txt</span>&rsquo;, &lsquo;<span class="file">log.odc</span>&rsquo;, &lsquo;<span class="file">codaIndex.txt</span>&rsquo;,
and &lsquo;<span class="file">coda[1:nchains].txt</span>&rsquo; should be removed after <span class="pkg">WinBUGS</span> has
finished.  If set to <code>TRUE</code>, this argument is only respected if
<code>codaPkg=FALSE</code>.</p>
</td></tr>
<tr><td><code id="bugs_+3A_usewine">useWINE</code></td>
<td>
<p>logical; attempt to use the Wine emulator to run
<span class="pkg">WinBUGS</span>, defaults to <code>FALSE</code> on Windows, and <code>TRUE</code>
otherwise. Not available in S-PLUS.</p>
</td></tr>
<tr><td><code id="bugs_+3A_wine">WINE</code></td>
<td>
<p>character, path to &lsquo;<span class="file">wine</span>&rsquo; binary file, it is
tried hard (by a guess and the utilities <code>which</code> and <code>locate</code>) 
to get the information automatically if not given.</p>
</td></tr>
<tr><td><code id="bugs_+3A_newwine">newWINE</code></td>
<td>
<p>Use new versions of Wine that have &lsquo;<span class="file">winepath</span>&rsquo;
utility</p>
</td></tr>
<tr><td><code id="bugs_+3A_winepath">WINEPATH</code></td>
<td>
<p>character, path to &lsquo;<span class="file">winepath</span>&rsquo; binary file, it is
tried hard (by a guess and the utilities <code>which</code> and <code>locate</code>) 
to get the information automatically if not given.</p>
</td></tr>
<tr><td><code id="bugs_+3A_bugs.seed">bugs.seed</code></td>
<td>
<p>random seed for <span class="pkg">WinBUGS</span> (default is no seed)</p>
</td></tr>
<tr><td><code id="bugs_+3A_summary.only">summary.only</code></td>
<td>
<p>If <code>TRUE</code>, only a parameter summary for very quick analyses is given, 
temporary created files are not removed in that case.</p>
</td></tr>
<tr><td><code id="bugs_+3A_save.history">save.history</code></td>
<td>
<p>If <code>TRUE</code> (the default), trace plots are generated at the end.</p>
</td></tr>
<tr><td><code id="bugs_+3A_over.relax">over.relax</code></td>
<td>
<p>If <code>TRUE</code>, over-relaxed form of MCMC is used if available from WinBUGS.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To run:
</p>

<ol>
<li><p> Write a <span class="pkg">BUGS</span> model in an ASCII file (hint: use
<code><a href="#topic+write.model">write.model</a></code>).
</p>
</li>
<li><p> Go into <span class="rlang"><b>R</b></span> / S-PLUS.
</p>
</li>
<li><p> Prepare the inputs for the <code>bugs</code> function and run it (see
Example section).
</p>
</li>
<li><p> A <span class="pkg">WinBUGS</span> window will pop up and <span class="rlang"><b>R</b></span> / S-PLUS will freeze
up. The model will now run in <span class="pkg">WinBUGS</span>. It might take awhile. You
will see things happening in the Log window within <span class="pkg">WinBUGS</span>. When
<span class="pkg">WinBUGS</span> is done, its window will close and <span class="rlang"><b>R</b></span> / S-PLUS will work
again.
</p>
</li>
<li><p> If an error message appears, re-run with <code>debug=TRUE</code>.
</p>
</li></ol>

<p>BUGS version support:
</p>

<dl>
<dt><span class="pkg">WinBUGS</span> 1.4.*</dt><dd><p>default</p>
</dd>
<dt><span class="pkg">OpenBUGS</span> 2.*</dt><dd><p>via argument <code>program="OpenBUGS"</code></p>
</dd>
</dl>

<p>Operation system support:
</p>

<dl>
<dt><span class="pkg">MS Windows</span></dt><dd><p>no problem</p>
</dd>
<dt><span class="pkg">Linux</span>, <span class="pkg">Mac OS X</span> and <span class="pkg">Unix</span> in
general</dt><dd><p>possible with Wine emulation via <code>useWINE=TRUE</code>, but
only for <span class="pkg">WinBUGS</span> 1.4.*</p>
</dd>
</dl>

<p>If <code>useWINE=TRUE</code> is used, all paths (such as
<code>working.directory</code> and <code>model.file</code>, must be given in
native (Unix) style, but <code>bugs.directory</code> can be given in
Windows path style (e.g. &ldquo;c:/Program Files/WinBUGS14/&rdquo;) or
native (Unix) style
(e.g. &ldquo;/path/to/wine/folder/dosdevices/c:/Program
Files/WinBUGS14&rdquo;).  This is done to achieve greatest portability with
default argument value for <code>bugs.directory</code>.
</p>


<h3>Value</h3>

<p>If <code>codaPkg=TRUE</code> the returned values are the names
of coda output files written by <span class="pkg">WinBUGS</span> containing
the Markov Chain Monte Carlo output in the CODA format.
This is useful for direct access with <code><a href="#topic+read.bugs">read.bugs</a></code>.
</p>
<p>If <code>codaPkg=FALSE</code>, the following values are returned:
</p>
<table>
<tr><td><code>n.chains</code></td>
<td>
<p>see Section &lsquo;Arguments&rsquo;</p>
</td></tr>
<tr><td><code>n.iter</code></td>
<td>
<p>see Section &lsquo;Arguments&rsquo;</p>
</td></tr>
<tr><td><code>n.burnin</code></td>
<td>
<p>see Section &lsquo;Arguments&rsquo;</p>
</td></tr>
<tr><td><code>n.thin</code></td>
<td>
<p>see Section &lsquo;Arguments&rsquo;</p>
</td></tr>
<tr><td><code>n.keep</code></td>
<td>
<p>number of iterations kept per chain (equal to
<code>(n.iter-n.burnin) / n.thin</code>)</p>
</td></tr>
<tr><td><code>n.sims</code></td>
<td>
<p>number of posterior simulations (equal to
<code>n.chains * n.keep</code>)</p>
</td></tr>
<tr><td><code>sims.array</code></td>
<td>
<p>3-way array of simulation output, with dimensions
n.keep, n.chains, and length of combined parameter vector</p>
</td></tr>
<tr><td><code>sims.list</code></td>
<td>
<p>list of simulated parameters:
for each scalar parameter, a vector of length n.sims
for each vector parameter, a 2-way array of simulations,
for each matrix parameter, a 3-way array of simulations, etc.
(for convenience, the <code>n.keep*n.chains</code> simulations in
sims.matrix and sims.list (but NOT sims.array) have been randomly
permuted)</p>
</td></tr>
<tr><td><code>sims.matrix</code></td>
<td>
<p>matrix of simulation output, with
<code>n.chains*n.keep</code> rows and one column for each element of
each saved parameter (for convenience, the <code>n.keep*n.chains</code>
simulations in sims.matrix and sims.list (but NOT sims.array) have
been randomly permuted)</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>summary statistics and convergence information for
each saved parameter.</p>
</td></tr>
<tr><td><code>mean</code></td>
<td>
<p>a list of the estimated parameter means</p>
</td></tr>
<tr><td><code>sd</code></td>
<td>
<p>a list of the estimated parameter standard deviations</p>
</td></tr>
<tr><td><code>median</code></td>
<td>
<p>a list of the estimated parameter medians</p>
</td></tr>
<tr><td><code>root.short</code></td>
<td>
<p>names of argument <code>parameters.to.save</code> and
&ldquo;deviance&rdquo;</p>
</td></tr>
<tr><td><code>long.short</code></td>
<td>
<p>indexes; programming stuff</p>
</td></tr>
<tr><td><code>dimension.short</code></td>
<td>
<p>dimension of <code>indexes.short</code></p>
</td></tr>
<tr><td><code>indexes.short</code></td>
<td>
<p>indexes of <code>root.short</code></p>
</td></tr>
<tr><td><code>last.values</code></td>
<td>
<p>list of simulations from the most recent
iteration; they can be used as starting points if you wish to run
<span class="pkg">WinBUGS</span> for further iterations</p>
</td></tr>
<tr><td><code>pD</code></td>
<td>
<p>an estimate of the effective number of parameters, for
calculations see the section &ldquo;Arguments&rdquo;.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p><code>mean(deviance) + pD</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andrew Gelman, <a href="mailto:gelman@stat.columbia.edu">gelman@stat.columbia.edu</a>; modifications and
packaged by Sibylle Sturtz, <a href="mailto:sturtz@statistik.tu-dortmund.de">sturtz@statistik.tu-dortmund.de</a>,
and Uwe Ligges.</p>


<h3>References</h3>

<p>Gelman, A., Carlin, J.B., Stern, H.S., Rubin, D.B. (2003):
<em>Bayesian Data Analysis</em>, 2nd edition, CRC Press.
</p>
<p>Sturtz, S., Ligges, U., Gelman, A. (2005):
R2WinBUGS: A Package for Running WinBUGS from R.
<em>Journal of Statistical Software</em> 12(3), 1-16.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+print.bugs">print.bugs</a></code>, <code><a href="#topic+plot.bugs">plot.bugs</a></code>, as well as
<span class="pkg">coda</span> and <span class="pkg">BRugs</span> packages</p>


<h3>Examples</h3>

<pre><code class='language-R'># An example model file is given in:
model.file &lt;- system.file(package="R2WinBUGS", "model", "schools.txt")
# Let's take a look:
file.show(model.file)

# Some example data (see ?schools for details):
data(schools)
schools

J &lt;- nrow(schools)
y &lt;- schools$estimate
sigma.y &lt;- schools$sd
data &lt;- list(J=J, y=y, sigma.y=sigma.y)
inits &lt;- function(){
    list(theta=rnorm(J, 0, 100), mu.theta=rnorm(1, 0, 100),
         sigma.theta=runif(1, 0, 100))
}
## or alternatively something like:
# inits &lt;- list(
#   list(theta=rnorm(J, 0, 90), mu.theta=rnorm(1, 0, 90),
#        sigma.theta=runif(1, 0, 90)),
#   list(theta=rnorm(J, 0, 100), mu.theta=rnorm(1, 0, 100),
#        sigma.theta=runif(1, 0, 100))
#   list(theta=rnorm(J, 0, 110), mu.theta=rnorm(1, 0, 110),
#        sigma.theta=runif(1, 0, 110)))

parameters &lt;- c("theta", "mu.theta", "sigma.theta")

## Not run: 
## You may need to edit "bugs.directory",
## also you need write access in the working directory:
schools.sim &lt;- bugs(data, inits, parameters, model.file,
    n.chains=3, n.iter=5000,
    bugs.directory="c:/Program Files/WinBUGS14/")
print(schools.sim)
plot(schools.sim)

## End(Not run)
</code></pre>

<hr>
<h2 id='bugs.data'>Writing input for WinBUGS</h2><span id='topic+bugs.data'></span>

<h3>Description</h3>

<p>Write file for <span class="pkg">WinBUGS</span> to read - for
internal use.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.data(data, dir = getwd(), digits = 5, data.file = "data.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.data_+3A_data">data</code></td>
<td>
<p>either a named list (names corresponding to variable names
in the <code>model.file</code>) of the data for the <span class="pkg">WinBUGS</span> model,
<em>or</em> (which is not recommended and unsafe) a vector or list of the names of the data objects used by
the model</p>
</td></tr>
<tr><td><code id="bugs.data_+3A_dir">dir</code></td>
<td>
<p>the directory to write the file &lsquo;<span class="file">data.txt</span>&rsquo; to</p>
</td></tr>
<tr><td><code id="bugs.data_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">WinBUGS</span>
input, see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
<tr><td><code id="bugs.data_+3A_data.file">data.file</code></td>
<td>
<p>name for the file R writes the data into.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The name of <code>data.file</code> is returned and as a side effect, 
the data file is written</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.inits'>Writing input for WinBUGS - intended for internal use only</h2><span id='topic+bugs.inits'></span>

<h3>Description</h3>

<p>Write files &lsquo;<span class="file">inits1.txt</span>&rsquo;, &lsquo;<span class="file">inits2.txt</span>&rsquo;, etc., in
the working directory for <span class="pkg">WinBUGS</span> to read - for internal use.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.inits(inits, n.chains, digits,
    inits.files = paste("inits", 1:n.chains, ".txt", sep = ""))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.inits_+3A_inits">inits</code></td>
<td>
<p>a list with <code>n.chains</code> elements; each element of the
list is itself a list of starting values for the <span class="pkg">WinBUGS</span> model,
<em>or</em> a function creating (possibly random) initial values</p>
</td></tr>
<tr><td><code id="bugs.inits_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="bugs.inits_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">WinBUGS</span>
input, see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
<tr><td><code id="bugs.inits_+3A_inits.files">inits.files</code></td>
<td>
<p>name for the inits files R write the inits into.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of names of <code>inits.files</code>; as a side effect, the inits files &lsquo;<span class="file">inits*.txt</span>&rsquo;
are written</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.log'>Read data from WinBUGS logfile</h2><span id='topic+bugs.log'></span>

<h3>Description</h3>

<p>Read data such as summary statistics and DIC information
from the <span class="pkg">WinBUGS</span> logfile</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.log(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.log_+3A_file">file</code></td>
<td>
<p>Location of the <span class="pkg">WinBUGS</span> logfile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>stats</code></td>
<td>
<p>A matrix containing summary statistics for each saved
parameter. Comparable to the information in the element
<code>summary</code> of a bugs object as returned by <code><a href="#topic+bugs">bugs</a></code>.</p>
</td></tr>
<tr><td><code>DIC</code></td>
<td>
<p>A matrix containing the DIC statistics as returned from
<span class="pkg">WinBUGS</span>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jouni Kerman</p>


<h3>See Also</h3>

<p>The main function that generates the log file is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.plot'>Plotting summary information - intended for internal use only</h2><span id='topic+bugs.plot.summary'></span><span id='topic+bugs.plot.inferences'></span>

<h3>Description</h3>

<p>Plotting summary information - intended for internal use</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.plot.summary(sims, ...)
bugs.plot.inferences(sims, display.parallel, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.plot_+3A_sims">sims</code></td>
<td>
<p>an object of class &lsquo;bugs&rsquo;, see <code><a href="#topic+bugs">bugs</a></code> for
details</p>
</td></tr>
<tr><td><code id="bugs.plot_+3A_display.parallel">display.parallel</code></td>
<td>
<p>display parallel intervals in both halves of
the summary plots; this is a convergence-monitoring tool and is not
necessary once you have approximate convergence (default is
<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="bugs.plot_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to low-level plot functions</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>bugs.plot.summary</code> (left hand side of plot) and
<code>bugs.plot.inferences</code> (right hand side of plot).
</p>


<h3>Value</h3>

<p>Does not return anything, but prints and plots as side-effects.</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code>plot</code>, see
<code><a href="#topic+plot.bugs">plot.bugs</a></code> for details.</p>

<hr>
<h2 id='bugs.run'>Calling WinBUGS</h2><span id='topic+bugs.run'></span>

<h3>Description</h3>

<p>Updates the lengths of the adaptive phases in the
<span class="pkg">WinBUGS</span> registry (using <code><a href="#topic+bugs.update.settings">bugs.update.settings</a></code>),
calls <span class="pkg">WinBUGS</span> and runs it with &lsquo;<span class="file">script.txt</span>&rsquo; - intended for
internal use</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.run(n.burnin, bugs.directory,
         useWINE=.Platform$OS.type != "windows", WINE=NULL,
         newWINE=TRUE, WINEPATH=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.run_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in</p>
</td></tr>
<tr><td><code id="bugs.run_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>directory that contains the <span class="pkg">WinBUGS</span> executable</p>
</td></tr>
<tr><td><code id="bugs.run_+3A_usewine">useWINE</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.run_+3A_wine">WINE</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.run_+3A_newwine">newWINE</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.run_+3A_winepath">WINEPATH</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, but has side effects as documented in
<code><a href="#topic+bugs.update.settings">bugs.update.settings</a></code> and calls <span class="pkg">WinBUGS</span>.</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.script'>Writes script for running WinBUGS</h2><span id='topic+bugs.script'></span>

<h3>Description</h3>

<p>Write file &lsquo;<span class="file">script.txt</span>&rsquo; for <span class="pkg">WinBUGS</span> to read -
intended for internal use</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.script(parameters.to.save, n.chains, n.iter, n.burnin, n.thin,
    model.file, debug=FALSE, is.inits, bin, DIC=FALSE,
    useWINE=.Platform$OS.type != "windows", newWINE=TRUE, WINEPATH=NULL, 
    bugs.seed=NULL, summary.only=FALSE, save.history=TRUE, 
    bugs.data.file, bugs.inits.files, over.relax = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.script_+3A_parameters.to.save">parameters.to.save</code></td>
<td>
<p>parameters that should be monitored</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations (including burn in)</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_n.thin">n.thin</code></td>
<td>
<p>size of thinning parameter</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_model.file">model.file</code></td>
<td>
<p>file containing the model written in <span class="pkg">WinBUGS</span> code</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_debug">debug</code></td>
<td>
<p>if <code>FALSE</code>, <span class="pkg">WinBUGS</span> is closed automatically,
otherwise <span class="pkg">WinBUGS</span> remains open for further investigation</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_is.inits">is.inits</code></td>
<td>
<p>logical; whether initial values are given by the user
(<code>TRUE</code>) or have to be generated by <span class="pkg">WinBUGS</span></p>
</td></tr>
<tr><td><code id="bugs.script_+3A_bin">bin</code></td>
<td>
<p>number of iterations between saving of results</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_dic">DIC</code></td>
<td>
<p>logical; if <code>TRUE</code>, compute deviance, pD, and DIC
automatically in <span class="pkg">WinBUGS</span></p>
</td></tr>
<tr><td><code id="bugs.script_+3A_usewine">useWINE</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_newwine">newWINE</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_winepath">WINEPATH</code></td>
<td>
<p>as in <code><a href="#topic+bugs">bugs</a></code> meta function</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_bugs.seed">bugs.seed</code></td>
<td>
<p>random seed for <span class="pkg">WinBUGS</span> (default is no seed)</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_summary.only">summary.only</code></td>
<td>
<p>If <code>TRUE</code>, only a parameter summary for very quick analyses is given, 
temporary created files are not removed in that case.</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_save.history">save.history</code></td>
<td>
<p>If <code>TRUE</code> (the default), trace plots are generated at the end.</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_bugs.data.file">bugs.data.file</code></td>
<td>
<p>character name of the data file</p>
</td></tr>
<tr><td><code id="bugs.script_+3A_bugs.inits.files">bugs.inits.files</code></td>
<td>
<p>character vector of names of the inits files</p>
</td></tr>  
<tr><td><code id="bugs.script_+3A_over.relax">over.relax</code></td>
<td>
<p>If <code>TRUE</code>, over-relaxed form of MCMC is used if available from WinBUGS.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, but as a side effect, the script file &lsquo;<span class="file">script.txt</span>&rsquo;
is written</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.sims'>WinBUGS output reader</h2><span id='topic+bugs.sims'></span>

<h3>Description</h3>

<p>Reads simulations from <span class="pkg">WinBUGS</span> into <span class="rlang"><b>R</b></span> or S-PLUS,
formats them, monitors convergence, performs convergence checks, and
computes medians and quantiles - intended for internal use.</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.sims(parameters.to.save, n.chains, n.iter, n.burnin, n.thin,
    DIC = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.sims_+3A_parameters.to.save">parameters.to.save</code></td>
<td>
<p>parameters that should be monitored</p>
</td></tr>
<tr><td><code id="bugs.sims_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="bugs.sims_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations (including burn in)</p>
</td></tr>
<tr><td><code id="bugs.sims_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in</p>
</td></tr>
<tr><td><code id="bugs.sims_+3A_n.thin">n.thin</code></td>
<td>
<p>size of thinning parameter</p>
</td></tr>
<tr><td><code id="bugs.sims_+3A_dic">DIC</code></td>
<td>
<p>calculation of DIC</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the same values as <code><a href="#topic+bugs">bugs</a></code>.</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='bugs.update.settings'>Adjusting WinBUGS registry</h2><span id='topic+bugs.update.settings'></span>

<h3>Description</h3>

<p>Adjusts WinBUGS registry - intended for internal use</p>


<h3>Usage</h3>

<pre><code class='language-R'>bugs.update.settings(n.burnin, bugs.directory)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bugs.update.settings_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in</p>
</td></tr>
<tr><td><code id="bugs.update.settings_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>directory that contains the <span class="pkg">WinBUGS</span> executable</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Alter the adaptive phases in the <span class="pkg">WinBUGS</span> updaters (in the
&lsquo;<span class="file">BUGS/System/Rsrc/Registry.odc</span>&rsquo; file, where BUGS is map of
installed <span class="pkg">WinBUGS</span>) so that all adaptive updating is done during
the burnin stage. Otherwise <span class="pkg">WinBUGS</span> will not report results if the
burnin is less than a minimum value such as 500 or 4000 (depending on
the model). Write permission on above mentioned file is needed for this!
</p>


<h3>Value</h3>

<p>Nothing, but as a side effect, the registry file
&lsquo;<span class="file">BUGS/System/Rsrc/Registry.odc</span>&rsquo; is modified</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='decode.parameter.name'>Decodes WinBUGS parameter names</h2><span id='topic+decode.parameter.name'></span>

<h3>Description</h3>

<p>Decodes <span class="pkg">WinBUGS</span> parameter names (e.g.,
<code>beta[3,14]</code> becomes <code>beta</code> with 2 indexes: 3 and 14) for
use by the <code><a href="#topic+bugs.sims">bugs.sims</a></code> function - intended for internal
use</p>


<h3>Usage</h3>

<pre><code class='language-R'>decode.parameter.name(a)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decode.parameter.name_+3A_a">a</code></td>
<td>
<p>one element of the first column of &lsquo;<span class="file">codaIndex.txt</span>&rsquo;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with elements:
</p>
<table>
<tr><td><code>root</code></td>
<td>
<p>name of parameter, e.g. <code>beta</code></p>
</td></tr>
<tr><td><code>dimension</code></td>
<td>
<p>number of <code>indexes</code>, e.g. 2</p>
</td></tr>
<tr><td><code>indexes</code></td>
<td>
<p>indexes, e.g. 3 and 14</p>
</td></tr>
</table>
<p>given <code>a == "beta[3, 14]"</code>
</p>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='monitor'>Special summary statistics</h2><span id='topic+monitor'></span><span id='topic+conv.par'></span>

<h3>Description</h3>

<p>Special summary statistics of the WinBUGS output.</p>


<h3>Usage</h3>

<pre><code class='language-R'>monitor(a, n.chains = dim(a)[2], trans = NULL, keep.all = FALSE, Rupper.keep = FALSE)
conv.par(x, n.chains, Rupper.keep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monitor_+3A_a">a</code></td>
<td>
<p>a <code>n * m * k</code> array: <code>m</code> sequences of length
<code>n</code>, <code>k</code> variables measured</p>
</td></tr>
<tr><td><code id="monitor_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains</p>
</td></tr>
<tr><td><code id="monitor_+3A_trans">trans</code></td>
<td>
<p>a vector of length <code>k</code>: &quot;&quot; if no transformation, or
&quot;log&quot; or &quot;logit&quot; (If <code>trans</code> is <code>NULL</code>, it will be set to
&quot;log&quot; for parameters that are all-positive and 0 otherwise.)</p>
</td></tr>
<tr><td><code id="monitor_+3A_keep.all">keep.all</code></td>
<td>
<p>if <code>FALSE</code> (default), first half of <code>a</code> will
be discarded</p>
</td></tr>
<tr><td><code id="monitor_+3A_rupper.keep">Rupper.keep</code></td>
<td>
<p>if <code>FALSE</code>, don't return <code>Rupper</code></p>
</td></tr>
<tr><td><code id="monitor_+3A_x">x</code></td>
<td>
<p>for internal use only</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>conv.par</code> is intended for internal use only.</p>


<h3>Value</h3>

<p>for <code>monitor</code>:
</p>
<table>
<tr><td><code>output</code></td>
<td>
<p>list of &quot;mean&quot;,&quot;sd&quot;, quantiles
(&quot;2.5%&quot;,&quot;25%&quot;,&quot;50%&quot;,&quot;75%&quot;,&quot;97.5%&quot;), &quot;Rhat&quot; if
<code>n.chains&gt;1</code>, &quot;Rupper&quot; if <code>(Rupper.keep == TRUE) &amp;&amp;
      (n.chains &gt; 1)</code>, and &quot;n.eff&quot; if <code>n.chains &gt; 1</code></p>
</td></tr>
</table>
<p>for <code>conv.par</code> a list with elements:
</p>
<table>
<tr><td><code>quantiles</code></td>
<td>
<p>emipirical quantiles of simulated sequences</p>
</td></tr>
<tr><td><code>confshrink</code></td>
<td>
<p>estimated potential scale reduction (that would be
achieved by continuing simulations forever) has two components: an
estimate and an approx. 97.5% upper bound</p>
</td></tr>
<tr><td><code>n.eff</code></td>
<td>
<p>effective sample size: <code>m*n*min(sigma.hat^2/B,1)</code>.
This is a crude measure of sample size because it relies on the
between variance, <code>B</code>, which can only be estimated with m
degrees of freedom.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='openbugs'>Wrapper to run OpenBUGS</h2><span id='topic+openbugs'></span>

<h3>Description</h3>

<p>The <code>openbugs</code> function takes data and starting values
as input.  It automatically calls the package <span class="pkg">BRugs</span> and runs
something similar to <code><a href="BRugs.html#topic+BRugsFit">BRugsFit</a></code>.  Not available in
S-PLUS.</p>


<h3>Usage</h3>

<pre><code class='language-R'>openbugs(data, inits, parameters.to.save,
    model.file = "model.txt", n.chains = 3, n.iter = 2000,
    n.burnin = floor(n.iter/2),
    n.thin = max(1, floor(n.chains * (n.iter - n.burnin) / n.sims)),
    n.sims = 1000,  DIC = TRUE, 
    bugs.directory = "c:/Program Files/OpenBUGS/",
    working.directory = NULL, digits = 5, over.relax = FALSE, seed=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="openbugs_+3A_data">data</code></td>
<td>
<p>either a named list (names corresponding to variable names
in the <code>model.file</code>) of the data for the <span class="pkg">OpenBUGS</span> model,
<em>or</em> a vector or list of the names of the data objects used by
the model.  If <code>data</code> is a one element character vector (such as <code>"data.txt"</code>), 
it is assumed that data have already been written to the working directory into that file, 
e.g. by the function <code><a href="#topic+bugs.data">bugs.data</a></code>.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_inits">inits</code></td>
<td>
<p>a list with <code>n.chains</code> elements; each element of the
list is itself a list of starting values for the <span class="pkg">OpenBUGS</span> model,
<em>or</em> a function creating (possibly random) initial values.
Alternatively, if <code>inits</code> are missing or <code>inits = NULL</code>,
initial values are generated by <span class="pkg">OpenBUGS</span>.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_parameters.to.save">parameters.to.save</code></td>
<td>
<p>character vector of the names of the
parameters to save which should be monitored</p>
</td></tr>
<tr><td><code id="openbugs_+3A_model.file">model.file</code></td>
<td>
<p>file containing the model written in <span class="pkg">OpenBUGS</span> code.
The extension can be either &lsquo;<span class="file">.bug</span>&rsquo; or &lsquo;<span class="file">.txt</span>&rsquo;.  If
&lsquo;<span class="file">.bug</span>&rsquo;, a copy of the file with extension &lsquo;<span class="file">.txt</span>&rsquo; will be
created in the <code>bugs()</code> call and removed afterwards.  Note that
similarly named &lsquo;<span class="file">.txt</span>&rsquo; files will be overwritten.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_n.chains">n.chains</code></td>
<td>
<p>number of Markov chains (default: 3)</p>
</td></tr>
<tr><td><code id="openbugs_+3A_n.iter">n.iter</code></td>
<td>
<p>number of total iterations per chain (including burn in;
default: 2000)</p>
</td></tr>
<tr><td><code id="openbugs_+3A_n.burnin">n.burnin</code></td>
<td>
<p>length of burn in, i.e. number of iterations to
discard at the beginning.  Default is <code>n.iter/2</code>, that is,
discarding the first half of the simulations.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_n.thin">n.thin</code></td>
<td>
<p>thinning rate.  Must be a positive integer.  Set
<code>n.thin</code> &gt; 1 to save memory and computation time if
<code>n.iter</code> is large.  Default is <code>max(1, floor(n.chains *
    (n.iter-n.burnin) / 1000))</code> which will only thin if there are at
least 2000 simulations.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_n.sims">n.sims</code></td>
<td>
<p>The approximate number of simulations to keep after thinning.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_dic">DIC</code></td>
<td>
<p>logical; if <code>TRUE</code> (default), compute deviance, pD, and
DIC.  This is done in <span class="pkg">BRugs</span> directly.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">OpenBUGS</span> input,
see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
<tr><td><code id="openbugs_+3A_bugs.directory">bugs.directory</code></td>
<td>
<p>directory that contains the <span class="pkg">OpenBUGS</span> executable
- currently unused</p>
</td></tr>
<tr><td><code id="openbugs_+3A_working.directory">working.directory</code></td>
<td>
<p>sets working directory during execution of
this function; <span class="pkg">WinBUGS</span> in- and output will be stored in this
directory; if <code>NULL</code>, a temporary working directory via
<code><a href="base.html#topic+tempdir">tempdir</a></code> is used.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_over.relax">over.relax</code></td>
<td>
<p>If <code>TRUE</code>, over-relaxed form of MCMC is used if available from OpenBUGS.</p>
</td></tr>
<tr><td><code id="openbugs_+3A_seed">seed</code></td>
<td>
<p>random seed (default is no seed)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code><a href="#topic+bugs">bugs</a></code> object.</p>


<h3>Note</h3>

<p>By default, BRugs (and hence <code>openbugs()</code>) is quite verbose. 
This can be controlled for the whole BRugs package by the option &lsquo;BRugsVerbose&rsquo; (see <code><a href="base.html#topic+options">options</a></code>)
which is set to <code>TRUE</code> by default.
</p>


<h3>Author(s)</h3>

<p>Andrew Gelman, <a href="mailto:gelman@stat.columbia.edu">gelman@stat.columbia.edu</a>; modifications and
packaged by Sibylle Sturtz, <a href="mailto:sturtz@statistik.tu-dortmund.de">sturtz@statistik.tu-dortmund.de</a>,
and Uwe Ligges.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code> and the <span class="pkg">BRugs</span> package</p>


<h3>Examples</h3>

<pre><code class='language-R'># An example model file is given in:
model.file &lt;- system.file(package = "R2WinBUGS", "model", "schools.txt")
# Let's take a look:
file.show(model.file)

# Some example data (see ?schools for details):
data(schools)
schools

J &lt;- nrow(schools)
y &lt;- schools$estimate
sigma.y &lt;- schools$sd
data &lt;- list ("J", "y", "sigma.y")
inits &lt;- function(){
    list(theta = rnorm(J, 0, 100), mu.theta = rnorm(1, 0, 100),
         sigma.theta = runif(1, 0, 100))
}
## or alternatively something like:
# inits &lt;- list(
#   list(theta = rnorm(J, 0, 90), mu.theta = rnorm(1, 0, 90),
#        sigma.theta = runif(1, 0, 90)),
#   list(theta = rnorm(J, 0, 100), mu.theta = rnorm(1, 0, 100),
#        sigma.theta = runif(1, 0, 100))
#   list(theta = rnorm(J, 0, 110), mu.theta = rnorm(1, 0, 110),
#        sigma.theta = runif(1, 0, 110)))

parameters &lt;- c("theta", "mu.theta", "sigma.theta")

## Not run: 
## both write access in the working directory and package BRugs required:
schools.sim &lt;- bugs(data, inits, parameters, model.file,
    n.chains = 3, n.iter = 5000,
    program = "openbugs", working.directory = NULL)
print(schools.sim)
plot(schools.sim)

## End(Not run)
</code></pre>

<hr>
<h2 id='plot.bugs'>Plotting a bugs object</h2><span id='topic+plot.bugs'></span>

<h3>Description</h3>

<p>Plotting a <code>bugs</code> object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bugs'
plot(x, display.parallel = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.bugs_+3A_x">x</code></td>
<td>
<p>an object of class &lsquo;bugs&rsquo;, see <code><a href="#topic+bugs">bugs</a></code> for details</p>
</td></tr>
<tr><td><code id="plot.bugs_+3A_display.parallel">display.parallel</code></td>
<td>
<p>display parallel intervals in both halves of
the summary plots; this is a convergence-monitoring tool and is not
necessary once you have approximate convergence (default is
<code>FALSE</code>)</p>
</td></tr>
<tr><td><code id="plot.bugs_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="graphics.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code></p>

<hr>
<h2 id='print.bugs'>Printing a bugs object</h2><span id='topic+print.bugs'></span>

<h3>Description</h3>

<p>Printing a <code>bugs</code> object</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'bugs'
print(x, digits.summary = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.bugs_+3A_x">x</code></td>
<td>
<p>an object of class &lsquo;bugs&rsquo;, see <code><a href="#topic+bugs">bugs</a></code> for details</p>
</td></tr>
<tr><td><code id="print.bugs_+3A_digits.summary">digits.summary</code></td>
<td>
<p>rounding for tabular output on the console
(default is to round to 1 decimal place)</p>
</td></tr>
<tr><td><code id="print.bugs_+3A_...">...</code></td>
<td>
<p>further arguments to <code><a href="base.html#topic+print">print</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code></p>

<hr>
<h2 id='read.bugs'>Read output files in CODA format</h2><span id='topic+read.bugs'></span>

<h3>Description</h3>

<p>This function reads Markov Chain Monte Carlo output in the
CODA format produced by <span class="pkg">WinBUGS</span> and returns an object of class
<code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code> for further output analysis using the
<span class="pkg">coda</span> package.</p>


<h3>Usage</h3>

<pre><code class='language-R'>read.bugs(codafiles, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read.bugs_+3A_codafiles">codafiles</code></td>
<td>
<p>character vector of filenames (e.g. returned from
<code><a href="#topic+bugs">bugs</a></code> in call such as <code>bugs(....., codaPkg=TRUE,
    .....)</code>). Each of the files contains coda output for one chain
produced by <span class="pkg">WinBUGS</span>, the <em>directory</em> name of the corresponding
file &lsquo;<span class="file">codaIndex.txt</span>&rsquo; is extracted from the first element of
<code>codafiles</code>.</p>
</td></tr>
<tr><td><code id="read.bugs_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to
<code><a href="coda.html#topic+read.coda">read.coda</a></code></p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code>, <code><a href="coda.html#topic+read.coda">read.coda</a></code>,
<code><a href="coda.html#topic+mcmc.list">mcmc.list</a></code></p>

<hr>
<h2 id='schools'>8 schools analysis</h2><span id='topic+schools'></span>

<h3>Description</h3>

<p>8 schools analysis</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(schools)</code></pre>


<h3>Format</h3>

<p>A data frame with 8 observations on the following 3 variables.
</p>

<dl>
<dt>school</dt><dd><p>See Source.</p>
</dd>
<dt>estimate</dt><dd><p>See Source.</p>
</dd>
<dt>sd</dt><dd><p>See Source.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Rubin, D.B. (1981): Estimation in Parallel Randomized Experiments.
<em>Journal of Educational Statistics</em> 6(4), 377-400.
</p>
<p>Section 5.5 of
Gelman, A., Carlin, J.B., Stern, H.S., Rubin, D.B. (2003): 
<em>Bayesian Data Analysis</em>, 2nd edition, CRC Press.
</p>

<hr>
<h2 id='write.datafile'>Write data for WinBUGS</h2><span id='topic+write.datafile'></span><span id='topic+formatdata'></span>

<h3>Description</h3>

<p>Write data in files that can be read by <span class="pkg">WinBUGS</span> - intended
for internal use</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.datafile(datalist, towhere, fill = TRUE)
formatdata(datalist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.datafile_+3A_datalist">datalist</code></td>
<td>
<p>a <em>list</em> to be written into an appropriate structure</p>
</td></tr>
<tr><td><code id="write.datafile_+3A_towhere">towhere</code></td>
<td>
<p>the name of the file which the data are to be written to</p>
</td></tr>
<tr><td><code id="write.datafile_+3A_fill">fill</code></td>
<td>
<p>see <code><a href="base.html#topic+cat">cat</a></code>, defaults to <code>TRUE</code></p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>datalist.tofile</code></td>
<td>
<p>A structure appropriate to be read in by <span class="pkg">WinBUGS</span>.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>The main function to be called by the user is <code><a href="#topic+bugs">bugs</a></code>.</p>

<hr>
<h2 id='write.model'>Creating a WinBUGS model file</h2><span id='topic+write.model'></span>

<h3>Description</h3>

<p>Convert <span class="rlang"><b>R</b></span> / S-PLUS function to a <span class="pkg">WinBUGS</span> model file</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.model(model, con = "model.bug", digits = 5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.model_+3A_model">model</code></td>
<td>
<p><span class="rlang"><b>R</b></span> / S-PLUS function containing the BUGS model in the BUGS
model language, for minor differences see Section Details.</p>
</td></tr>
<tr><td><code id="write.model_+3A_con">con</code></td>
<td>
<p>passed to <code><a href="base.html#topic+writeLines">writeLines</a></code> which actually writes
the model file</p>
</td></tr>
<tr><td><code id="write.model_+3A_digits">digits</code></td>
<td>
<p>number of significant digits used for <span class="pkg">WinBUGS</span>
input, see <code><a href="base.html#topic+formatC">formatC</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>BUGS models follow closely S syntax. It is therefore possible to write
most BUGS models as <span class="rlang"><b>R</b></span> functions.
</p>
<p>As a difference, BUGS syntax allows truncation specification like this:
<code>dnorm(...) I(...)</code>  but this is illegal in <span class="rlang"><b>R</b></span> and S-PLUS. To
overcome this incompatibility, use dummy operator <code>%_%</code> before
<code>I(...)</code>: <code>dnorm(...) %_% I(...)</code>. The dummy operator
<code>%_%</code> will be removed before the BUGS code is saved.
</p>
<p>In S-PLUS, a warning is generated when the model function is defined if
the last statement in the model is an assignment.  To avoid this
warning, add the line &quot;invisible()&quot; to the end of the model definition.
This line will be removed before the BUGS code is saved.
</p>


<h3>Value</h3>

<p>Nothing, but as a side effect, the model file is written</p>


<h3>Author(s)</h3>

<p>original idea by Jouni Kerman, modified by Uwe Ligges</p>


<h3>See Also</h3>

<p><code><a href="#topic+bugs">bugs</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Same "schoolsmodel" that is used in the examples in ?bugs:
schoolsmodel &lt;- function(){
    for (j in 1:J){
        y[j] ~ dnorm (theta[j], tau.y[j])
        theta[j] ~ dnorm (mu.theta, tau.theta)
        tau.y[j] &lt;- pow(sigma.y[j], -2)
    }
    mu.theta ~ dnorm (0.0, 1.0E-6)
    tau.theta &lt;- pow(sigma.theta, -2)
    sigma.theta ~ dunif (0, 1000)
}

## some temporary filename:
filename &lt;- file.path(tempdir(), "schoolsmodel.bug")


## write model file:
write.model(schoolsmodel, filename)
## and let's take a look:
file.show(filename)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
