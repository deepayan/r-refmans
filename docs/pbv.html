<!DOCTYPE html><html><head><title>Help for package pbv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pbv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#pbv-package'>
<p>Probabilities for Bivariate Normal Distribution</p></a></li>
<li><a href='#pbvnorm'>
<p>Probabilities for Bivariate Normal Distribution</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Probabilities for Bivariate Normal Distribution</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-47</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-30 15:01:12.000296</td>
</tr>
<tr>
<td>Author:</td>
<td>Alexander Robitzsch [aut,cre] (&lt;https://orcid.org/0000-0002-8226-3132&gt;)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Computes probabilities of the bivariate normal distribution
    in a vectorized R function (Drezner &amp; Wesolowsky, 1990, 
    &lt;<a href="https://doi.org/10.1080%2F00949659008811236">doi:10.1080/00949659008811236</a>&gt;).</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Enhances:</td>
<td>pbivnorm</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/alexanderrobitzsch/pbv">https://github.com/alexanderrobitzsch/pbv</a>,
<a href="https://sites.google.com/view/alexander-robitzsch/software">https://sites.google.com/view/alexander-robitzsch/software</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-30 14:02:18 UTC; sunpn563</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-30 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='pbv-package'>
Probabilities for Bivariate Normal Distribution
</h2><span id='topic+pbv-package'></span><span id='topic+pbv'></span>

<h3>Description</h3>


<p>    Computes probabilities of the bivariate normal distribution
    in a vectorized R function (Drezner &amp; Wesolowsky, 1990, 
    &lt;doi:10.1080/00949659008811236&gt;).
</p>


<h3>Author(s)</h3>

<p>Alexander Robitzsch [aut,cre] (&lt;https://orcid.org/0000-0002-8226-3132&gt;)
</p>
<p>Maintainer: Alexander Robitzsch &lt;robitzsch@ipn.uni-kiel.de&gt;
</p>


<h3>References</h3>

<p>Drezner, Z., &amp; Wesolowsky, G. O. (1990). On the computation of the bivariate normal 
integral. <em>Journal of Statistical Computation and Simulation, 35</em>(1-2), 101-107.
<a href="https://doi.org/10.1080/00949659008811236">doi:10.1080/00949659008811236</a>
</p>

<hr>
<h2 id='pbvnorm'>
Probabilities for Bivariate Normal Distribution
</h2><span id='topic+pbvnorm'></span><span id='topic+dbvnorm'></span><span id='topic+pbv_rcpp_dbvnorm'></span><span id='topic+pbv_rcpp_dbvnorm0'></span><span id='topic+pbv_rcpp_pbvnorm'></span><span id='topic+pbv_rcpp_pbvnorm0'></span>

<h3>Description</h3>

<p>The function <code>pbvnorm</code> computes probabilities <code class="reqn">\Phi_2(x,y,\rho)</code> for
the standardized bivariate normal distribution (Drezner &amp; Wesolowsky, 1990;
West, 2004).
</p>
<p>The function <code>dbvnorm</code> computes the corresponding density <code class="reqn">\phi_2(x,y,\rho)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pbvnorm(x, y, rho)

dbvnorm(x, y, rho, log=FALSE)

## exported Rcpp functions
pbv_rcpp_pbvnorm0( h1, hk, r)
pbv_rcpp_pbvnorm( x, y, rho)
pbv_rcpp_dbvnorm0( x, y, rho, use_log)
pbv_rcpp_dbvnorm( x, y, rho, use_log)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pbvnorm_+3A_x">x</code></td>
<td>

<p>Vector of first ordinate
</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_y">y</code></td>
<td>

<p>Vector of second ordinate
</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_rho">rho</code></td>
<td>

<p>Vector of correlations
</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_log">log</code></td>
<td>
<p>Logical indicating whether logarithm of the density
should be calculated</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_h1">h1</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_hk">hk</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_r">r</code></td>
<td>
<p>Numeric</p>
</td></tr>
<tr><td><code id="pbvnorm_+3A_use_log">use_log</code></td>
<td>
<p>Logical</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector
</p>


<h3>Note</h3>

<p>The <span class="pkg">pbv</span> package can also be used to include <a href="https://CRAN.R-project.org/package=Rcpp"><span class="pkg">Rcpp</span></a> functions for
computing bivariate probabilities at the C++ level. Numeric and vector versions are
<br /> <br />
<code>double pbv::pbv_rcpp_pbvnorm0( double h1, double hk, double r)</code> <br /> <br />
<code>Rcpp::NumericVector pbv::pbv_rcpp_pbvnorm( Rcpp::NumericVector x, </code><br />
<code>     Rcpp::NumericVector y, Rcpp::NumericVector rho)</code>
</p>


<h3>References</h3>

<p>Drezner, Z., &amp; Wesolowsky, G. O. (1990). On the computation of the bivariate normal
integral. <em>Journal of Statistical Computation and Simulation, 35</em>(1-2), 101-107.
<a href="https://doi.org/10.1080/00949659008811236">doi:10.1080/00949659008811236</a>
</p>
<p>Genz, A. (1992). Numerical computation of multivariate normal probabilities.
<em>Journal of Computational and Graphical Statistics, 1</em>(2), 141-149.
</p>
<p>West, G. (2005). Better approximations to cumulative normal functions.
<em>Wilmott Magazine, 9</em>, 70-76.
</p>


<h3>See Also</h3>

<p>See <code><a href="pbivnorm.html#topic+pbivnorm">pbivnorm::pbivnorm</a></code> in the <span class="pkg">pbivnorm</span> package
and <code>mnormt::biv.nt.prob</code> in the <span class="pkg">mnormt</span> package
for alternative implementations (Genz, 1992).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################################################################
# EXAMPLE 1: Comparison with alternative implementations
#############################################################################

#*** simulate different values of ordinates and correlations
set.seed(9898)
N &lt;- 3000
x &lt;- stats::runif(N,-3,3)
y &lt;- stats::runif(N,-3,3)
rho &lt;- stats::runif(N,-.95,.95)

#*** compute probabilities
res1 &lt;- pbv::pbvnorm(x=x,y=y,rho=rho)

## Not run: 
#-- compare results with pbivnorm package
library(pbivnorm)
res2 &lt;- pbivnorm::pbivnorm(x=x, y=y, rho=rho)

summary(abs(res1-res2))

#*** compute density values
log &lt;- TRUE    # logical indicating whether log density should be evaluated
res1 &lt;- pbv::dbvnorm(x=x, y=y, rho=rho, log=log )

#-- compare results with mvtnorm package
library(mvtnorm)
res2 &lt;- rep(NA, N)
sigma &lt;- diag(2)
for (ii in 1:N){
    sigma[1,2] &lt;- sigma[2,1] &lt;- rho[ii]
    res2[ii] &lt;- mvtnorm::dmvnorm(x=c(x[ii],y[ii]), sigma=sigma, log=log)
}
summary(abs(res1-res2))

## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
