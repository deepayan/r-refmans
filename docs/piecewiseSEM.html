<!DOCTYPE html><html lang="en"><head><title>Help for package piecewiseSEM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {piecewiseSEM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#piecewiseSEM-package'><p>The 'piecewiseSEM' package</p></a></li>
<li><a href='#+25~~+25'><p>Correlated error operator</p></a></li>
<li><a href='#+25not_in+25'><p>Operator for non-overlap in sets</p></a></li>
<li><a href='#AIC_psem'><p>Information criterion values for SEM</p></a></li>
<li><a href='#AIC.psem'><p>Generic function for SEM AIC(c) score</p></a></li>
<li><a href='#all_vars_merMod'><p>Remove random effects from all.vars</p></a></li>
<li><a href='#all_vars_notrans'><p>Get vector of untransformed variables</p></a></li>
<li><a href='#all_vars_trans'><p>Get vector of transformed variables</p></a></li>
<li><a href='#anova.psem'><p>ANOVA and chi-squared difference test for model comparison</p></a></li>
<li><a href='#anovaLRT'><p>Chi-square difference test</p></a></li>
<li><a href='#anovaTable'><p>Single anova</p></a></li>
<li><a href='#as.psem'><p>Convert list to psem object</p></a></li>
<li><a href='#basisSet'><p>Derivation of the basis set</p></a></li>
<li><a href='#captureTable'><p>Captures output table</p></a></li>
<li><a href='#cbind_fill'><p>Bind data.frames of differing dimensions</p></a></li>
<li><a href='#cerror'><p>Correlated errors</p></a></li>
<li><a href='#checkData'><p>Check to see whether supplied data.frame matches model-extracted data</p></a></li>
<li><a href='#checkTransformations'><p>Check to see whether variables exist as transformed and untransformed</p></a></li>
<li><a href='#coefs'><p>Extract path coefficients</p></a></li>
<li><a href='#dataTrans'><p>Transform variables based on model formula and store in new data frame</p></a></li>
<li><a href='#dSep'><p>Tests of directed separation</p></a></li>
<li><a href='#dupOutput'><p>Identify duplicate output</p></a></li>
<li><a href='#evaluateClasses'><p>Evaluate model classes and stop if unsupported model class</p></a></li>
<li><a href='#filterExisting'><p>Remove existing paths from the basis set</p></a></li>
<li><a href='#filterExogenous'><p>Filter relationships among exogenous variables from the basis set (ignoring add.vars)</p></a></li>
<li><a href='#filterInteractions'><p>Filter interactions from the d-sep tests</p></a></li>
<li><a href='#filterSmoothed'><p>First, remove claims where linear and non-linear terms appear in the same claim</p></a></li>
<li><a href='#findbars.lme'><p>Get random effects from lme</p></a></li>
<li><a href='#fisherC'><p>Summarize tests of directed separation using Fisher's C statistic</p></a></li>
<li><a href='#fixCatDir'><p>Flip independence claims so categorical variables are not the response</p></a></li>
<li><a href='#formatpsem'><p>Format for psem</p></a></li>
<li><a href='#get_response'><p>Get Response Name as a Character</p></a></li>
<li><a href='#getAnova'><p>Get ANOVA results from 'merMod'</p></a></li>
<li><a href='#getCoefficients'><p>Get coefficients from linear regression</p></a></li>
<li><a href='#getDAG'><p>Generate adjacency matrix from list of structural equations</p></a></li>
<li><a href='#GetData'><p>Get data from model list</p></a></li>
<li><a href='#getLHS'><p>Get Left-hand side of formulae</p></a></li>
<li><a href='#GetOLRE'><p>Obtain (observation-level) random effects from a generalized linear mixed model</p></a></li>
<li><a href='#getResidModels'><p>Identify models with correlated errors and return modified versions</p></a></li>
<li><a href='#getRHS'><p>Get Right-hand side of formulae</p></a></li>
<li><a href='#getSatModels'><p>Get saturated model by reinserting all excluded paths</p></a></li>
<li><a href='#GetSDx'><p>Get standard deviation of predictor variables</p></a></li>
<li><a href='#GetSDy'><p>Properly scale standard deviations depending on the error distribution</p></a></li>
<li><a href='#GetSingleData'><p>Get data from one model</p></a></li>
<li><a href='#getSortedPsem'><p>Get a sorted psem object in DAG order</p></a></li>
<li><a href='#GetVarCov'><p>Get random effects variance-covariance from lme</p></a></li>
<li><a href='#handleCategoricalCoefs'><p>Handles putting categorical variables into coefficient tables</p>
for easy use in path analysis</a></li>
<li><a href='#import'><p>Functions to import from dependencies</p></a></li>
<li><a href='#isSig'><p>Assess significance</p></a></li>
<li><a href='#keeley'><p>Data set from Grace &amp; Keeley (2006)</p></a></li>
<li><a href='#listFormula'><p>Recompute P-values using Kenward-Rogers approximation</p></a></li>
<li><a href='#LLchisq'><p>Generalized chi-squared for piecewise SEM</p></a></li>
<li><a href='#meadows'><p>Data set from Grace &amp; Jutila (1999)</p></a></li>
<li><a href='#multigroup'><p>Multigroup Analysis for Piecewise SEM</p></a></li>
<li><a href='#nObs'><p>Get number of observations from a model</p></a></li>
<li><a href='#onlyBars'><p>Get random effects from merMod</p></a></li>
<li><a href='#partialCorr'><p>Calculate partial correlations from partial residuals</p></a></li>
<li><a href='#partialResid'><p>Computing partial effects</p></a></li>
<li><a href='#plot.psem'><p>Plotting of Piecewise Structural Equation Models</p></a></li>
<li><a href='#print.anova.psem'><p>Print anova</p></a></li>
<li><a href='#print.attr'><p>Do not print attributes with custom functions</p></a></li>
<li><a href='#print.basisSet'><p>Print basis set</p></a></li>
<li><a href='#print.multigroup.psem'><p>Print multigroup</p></a></li>
<li><a href='#print.psem'><p>Print psem</p></a></li>
<li><a href='#print.summary.psem'><p>Print summary</p></a></li>
<li><a href='#psem'><p>Fitting piecewise structural equation models</p></a></li>
<li><a href='#removeCerror'><p>Remove correlated errors from the basis set</p></a></li>
<li><a href='#removeData'><p>Remove data from the model list</p></a></li>
<li><a href='#resid.lme'><p>Get residuals from innermost grouping of mixed models (replicate-level)</p></a></li>
<li><a href='#residuals.psem'><p>Residual values from fit models</p></a></li>
<li><a href='#reverseAddVars'><p>Replace transformations in the basis set by cycling through neighbors and applying</p>
transformations in order of how variables are treated in the child nearest to current node</a></li>
<li><a href='#reverseNonLin'><p>If intermediate endogenous variables are nonlinear, return both directions</p></a></li>
<li><a href='#rsquared'><p>R-squared for linear regression</p></a></li>
<li><a href='#rsquared.gam'><p>R^2 for gam objects</p></a></li>
<li><a href='#rsquared.glm'><p>R^2 for glm objects</p></a></li>
<li><a href='#rsquared.glmerMod'><p>R^2 for glmer objects</p></a></li>
<li><a href='#rsquared.glmmPQL'><p>R^2 for glmmPQL objects</p></a></li>
<li><a href='#rsquared.gls'><p>R^2 for gls objects</p></a></li>
<li><a href='#rsquared.lm'><p>R^2 for lm objects</p></a></li>
<li><a href='#rsquared.lme'><p>R^2 for lme objects</p></a></li>
<li><a href='#rsquared.merMod'><p>R^2 for phylolm objects</p></a></li>
<li><a href='#rsquared.negbin'><p>R^2 for negbin objects</p></a></li>
<li><a href='#rsquared.Sarlm'><p>R^2 for Sarlm objects</p></a></li>
<li><a href='#scaleGLM'><p>Compute standard deviation or relevant range of response for GLMs</p></a></li>
<li><a href='#scaleInt'><p>Calculate standard deviation or relevant range for interaction terms</p></a></li>
<li><a href='#shipley'><p>Data set from Shipley (2006)</p></a></li>
<li><a href='#sortDag'><p>Sort DAG based on ancestry</p></a></li>
<li><a href='#specifyDir'><p>Remove duplicate items from the basis set whose direction is not a priori specified</p></a></li>
<li><a href='#stdCoefs'><p>Calculate standardized regression coefficients</p></a></li>
<li><a href='#stop_psem'><p>Stop function for unsupported methods</p></a></li>
<li><a href='#stripTransformations'><p>Strip transformations</p></a></li>
<li><a href='#summary.psem'><p>Summarizing piecewise structural equation models</p></a></li>
<li><a href='#testBasisSetElements'><p>Evaluate conditional independence claim from the basis set</p></a></li>
<li><a href='#unstdCoefs'><p>Get raw (undstandardized) coefficients from model</p></a></li>
<li><a href='#update.psem'><p>Update psem model object with additional values.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Piecewise Structural Equation Modeling</td>
</tr>
<tr>
<td>Version:</td>
<td>2.3.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-06</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jon Lefcheck &lt;jslefche@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements piecewise structural equation modeling from a single
    list of structural equations, with new methods for non-linear, latent, and
    composite variables, standardized coefficients, query-based prediction and
    indirect effects. See <a href="http://jslefche.github.io/piecewiseSEM/">http://jslefche.github.io/piecewiseSEM/</a> for more.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.4.0)</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jslefche/">https://github.com/jslefche/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jslefche/piecewiseSEM/issues">https://github.com/jslefche/piecewiseSEM/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>car, DiagrammeR, emmeans, igraph, lme4, multcomp, MuMIn, MASS,
methods, nlme, performance</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-11 13:10:03 UTC; jslef</td>
</tr>
<tr>
<td>Author:</td>
<td>Jon Lefcheck [aut, cre],
  Jarrett Byrnes [aut],
  James Grace [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-11 14:10:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='piecewiseSEM-package'>The 'piecewiseSEM' package</h2><span id='topic+piecewiseSEM'></span><span id='topic+piecewiseSEM-package'></span>

<h3>Description</h3>

<p>Piecewise structural equation modeling
</p>
<p>Fitting and evaluation of piecewise structural equation models, complete
with goodness-of-fit tests, estimates of (standardized) path coefficients,
and evaluation of individual model fits (e.g., through R-squared values).
Compared with traditional variance-covariance based SEM, piecewise SEM
allows for fitting of models to different distributions through GLM and/or
hierarchical/nested random structures through (G)LMER. Supported model
classes include: <code>lm, glm, gls, Sarlm, lme, glmmPQL, lmerMod, merModLmerTest, 
glmerMod, glmmTMB, gam</code>.
</p>

<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> piecewiseSEM</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version:
</td><td style="text-align: left;"> 2.3.0.1</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2024-06-11</td>
</tr>
<tr>
 <td style="text-align: left;"> Depends: </td><td style="text-align: left;"> R (&gt;= 4.4.0), car,
DiagrammeR, emmeans, igraph, lme4, multcomp, MuMIn, MASS, methods, nlme</td>
</tr>
<tr>
 <td style="text-align: left;"> 
License: </td><td style="text-align: left;"> MIT</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>
<p> The primary functions in the package are <code><a href="#topic+psem">psem</a></code> 
which unites structural equations in a single model, and <code>summary.psem</code> can
be used on an object of class <code>psem</code> to provide various summary statistics for 
evaluation and interpretation.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;jslefche@gmail.com&gt;
</p>


<h3>References</h3>

<p>Shipley, Bill. &quot;A new inferential test for path models based on
directed acyclic graphs.&quot; Structural Equation Modeling 7.2 (2000): 206-218.
</p>
<p>Shipley, Bill. Cause and correlation in biology: a user's guide to path
analysis, structural equations and causal inference. Cambridge University
Press, 2002.
</p>
<p>Shipley, Bill. &quot;Confirmatory path analysis in a generalized multilevel
context.&quot; Ecology 90.2 (2009): 363-368.
</p>
<p>Shipley, Bill. &quot;The AIC model selection method applied to path analytic
models compared using a d-separation test.&quot; Ecology 94.3 (2013): 560-564.
</p>
<p>Shipley, Bill, and Jacob C. Douma. &quot;Generalized AIC and chi‐squared statistics
for path models consistent with directed acyclic graphs.&quot; Ecology 101.3 (2020): e02960.
</p>
<p>Grace, J.B., Johnson, D.A., Lefcheck, J.S., and Byrnes, J.E.
&quot;Standardized Coefficients in Regression and Structural Models with Binary Outcomes.&quot;
Ecosphere 9(6): e02283.
</p>
<p>Nakagawa, Shinichi, Paul CD Johnson, and Holger Schielzeth. &quot;The coefficient
of determination R2 and intra-class correlation coefficient from generalized
linear mixed-effects models revisited and expanded.&quot;
Journal of the Royal Society Interface 14.134 (2017): 20170213.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/jslefche/">https://github.com/jslefche/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/jslefche/piecewiseSEM/issues">https://github.com/jslefche/piecewiseSEM/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25~~+25'>Correlated error operator</h2><span id='topic++25~~+25'></span>

<h3>Description</h3>

<p>Specifies correlated errors among predictors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e1 %~~% e2
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25~~+2B25_+3A_e1">e1</code></td>
<td>
<p>first variable involved in correlated error</p>
</td></tr>
<tr><td><code id="+2B25~~+2B25_+3A_e2">e2</code></td>
<td>
<p>second variable involved in correlated error</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For use in <code>psem</code> to identify correlated sets of variables.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;, Jarrett Byrnes
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cerror">cerror</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
dat &lt;- data.frame(x1 = runif(50),
  x2 = runif(50), y1 = runif(50),
    y2 = runif(50))

# Create list of structural equations
sem &lt;- psem(
  lm(y1 ~ x1 + x2, dat),
  lm(y2 ~ y1 + x1, dat)
)

# Look at correlated error between x1 and x2
# (exogenous)
cerror(x1 %~~% x2, sem, dat)

# Same as cor.test
with(dat, cor.test(x1, x2))

# Look at correlatde error between x1 and y1
# (endogenous)
cerror(y1 %~~% x1, sem, dat)

# Not the same as cor.test
# (accounts for influence of x1 and x2 on y1)
with(dat, cor.test(y1, x1))

# Specify in psem
sem &lt;- update(sem, x1 %~~% y1)

coefs(sem)

</code></pre>

<hr>
<h2 id='+25not_in+25'>Operator for non-overlap in sets</h2><span id='topic++25not_in+25'></span>

<h3>Description</h3>

<p>Operator for non-overlap in sets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>x %not_in% y
</code></pre>

<hr>
<h2 id='AIC_psem'>Information criterion values for SEM</h2><span id='topic+AIC_psem'></span>

<h3>Description</h3>

<p>Information criterion values for SEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AIC_psem(
  modelList,
  AIC.type = "loglik",
  Cstat = NULL,
  add.claims = NULL,
  basis.set = NULL,
  direction = NULL,
  interactions = FALSE,
  conserve = FALSE,
  conditional = FALSE,
  .progressBar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC_psem_+3A_modellist">modelList</code></td>
<td>
<p>a list of structural equations</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_aic.type">AIC.type</code></td>
<td>
<p>whether the log-likelihood <code>"loglik"</code> or d-sep <code>"dsep"</code> AIC score 
should be reported. Default is <code>"loglik"</code></p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_cstat">Cstat</code></td>
<td>
<p>Fisher's C statistic obtained from <code>fisherC</code></p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_add.claims">add.claims</code></td>
<td>
<p>an optional vector of additional independence claims (P-values) 
to be added to the basis set</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_basis.set">basis.set</code></td>
<td>
<p>An optional list of independence claims.</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_direction">direction</code></td>
<td>
<p>a vector of claims defining the specific directionality of any independence 
claim(s)</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in independence claims. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_conserve">conserve</code></td>
<td>
<p>whether the most conservative P-value should be returned (See Details) 
Default is FALSE</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_conditional">conditional</code></td>
<td>
<p>whether the conditioning variables should be shown in the table. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="AIC_psem_+3A_.progressbar">.progressBar</code></td>
<td>
<p>an optional progress bar. Default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame of AIC, AICc, d.f., and sample size
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;, Jim Grace
</p>


<h3>References</h3>

<p>Shipley, Bill, and Jacob C. Douma. &quot;Generalized AIC and chi‐squared statistics 
for path models consistent with directed acyclic graphs.&quot; Ecology 101.3 (2020): e02960.
</p>
<p>Shipley, Bill. &quot;The AIC model selection method applied to path analytic models compared using 
a d‐separation test.&quot; Ecology 94.3 (2013): 560-564.
</p>

<hr>
<h2 id='AIC.psem'>Generic function for SEM AIC(c) score</h2><span id='topic+AIC.psem'></span>

<h3>Description</h3>

<p>Generic function for SEM AIC(c) score
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
AIC(object, ..., AIC.type = "loglik", aicc = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.psem_+3A_object">object</code></td>
<td>
<p>a psem object</p>
</td></tr>
<tr><td><code id="AIC.psem_+3A_...">...</code></td>
<td>
<p>additional arguments to AIC</p>
</td></tr>
<tr><td><code id="AIC.psem_+3A_aic.type">AIC.type</code></td>
<td>
<p>whether the log-likelihood <code>"loglik"</code> or d-sep <code>"dsep"</code> AIC score 
should be reported. Default is <code>"loglik"</code></p>
</td></tr>
<tr><td><code id="AIC.psem_+3A_aicc">aicc</code></td>
<td>
<p>whether correction for small sample size should be applied. Default is <code>FALSE</code></p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
mod &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

# Get log-likelihood based AIC
AIC(mod)

# Get d-sep based AIC
AIC(mod, AIC.type = "dsep")
 
</code></pre>

<hr>
<h2 id='all_vars_merMod'>Remove random effects from all.vars</h2><span id='topic+all_vars_merMod'></span>

<h3>Description</h3>

<p>Remove random effects from all.vars
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_vars_merMod(formula.)
</code></pre>

<hr>
<h2 id='all_vars_notrans'>Get vector of untransformed variables</h2><span id='topic+all_vars_notrans'></span>

<h3>Description</h3>

<p>Get vector of untransformed variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_vars_notrans(formula.)
</code></pre>

<hr>
<h2 id='all_vars_trans'>Get vector of transformed variables</h2><span id='topic+all_vars_trans'></span>

<h3>Description</h3>

<p>Get vector of transformed variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all_vars_trans(formula., smoothed = FALSE)
</code></pre>

<hr>
<h2 id='anova.psem'>ANOVA and chi-squared difference test for model comparison</h2><span id='topic+anova.psem'></span>

<h3>Description</h3>

<p>Compute analysis of variance table for one or more structural equation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
anova(object, ..., digits = 3, anovafun = "Anova")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="anova.psem_+3A_object">object</code></td>
<td>
<p>a <code>psem</code> object</p>
</td></tr>
<tr><td><code id="anova.psem_+3A_...">...</code></td>
<td>
<p>additional objects of the same type</p>
</td></tr>
<tr><td><code id="anova.psem_+3A_digits">digits</code></td>
<td>
<p>number of digits to round results. Default is 3</p>
</td></tr>
<tr><td><code id="anova.psem_+3A_anovafun">anovafun</code></td>
<td>
<p>The function used for ANOVA. Defaults to <code>Anova</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Additional models will be tested against the first model using a Chi-squared difference test.
</p>


<h3>Value</h3>

<p>an F, LRT, or other table for a single model, or a list of
comparisons between multiple models
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;, Jarrett Byrnes &lt;jarrett.byrnes@umb.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="car.html#topic+Anova">Anova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(keeley)

mod1 &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

# get type II Anova
anova(mod1)

# conduct LRT
mod2 &lt;- psem(
  lm(rich ~ cover, data = keeley),
  lm(cover ~ firesev, data = keeley),
  age ~ 1,
  data = keeley
)

anova(mod1, mod2)

</code></pre>

<hr>
<h2 id='anovaLRT'>Chi-square difference test</h2><span id='topic+anovaLRT'></span>

<h3>Description</h3>

<p>Chi-square difference test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anovaLRT(object)
</code></pre>

<hr>
<h2 id='anovaTable'>Single anova</h2><span id='topic+anovaTable'></span>

<h3>Description</h3>

<p>Single anova
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anovaTable(object, anovafun = "Anova", digits = 3)
</code></pre>

<hr>
<h2 id='as.psem'>Convert list to psem object</h2><span id='topic+as.psem'></span>

<h3>Description</h3>

<p>Convert list to psem object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.psem(object, Class = "psem")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.psem_+3A_object">object</code></td>
<td>
<p>any <code>R</code> object</p>
</td></tr>
<tr><td><code id="as.psem_+3A_class">Class</code></td>
<td>
<p>the name of the class to which <code>object</code> should be coerced</p>
</td></tr>
</table>

<hr>
<h2 id='basisSet'>Derivation of the basis set</h2><span id='topic+basisSet'></span>

<h3>Description</h3>

<p>Acquires the set of independence claims&ndash;or the 'basis set'&ndash;for use in
evaluating the goodness-of-fit for piecewise structural equation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>basisSet(modelList, direction = NULL, interactions = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="basisSet_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations</p>
</td></tr>
<tr><td><code id="basisSet_+3A_direction">direction</code></td>
<td>
<p>a vector of claims defining the specific directionality of any independence 
claim(s)</p>
</td></tr>
<tr><td><code id="basisSet_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in independence claims. 
Default is FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a list of independence claims. Each
claim is a vector of the predictor of interest, followed by the response,
and, if present, any conditioning variables.
</p>
<p>Relationships among exogenous variables are omitted from the basis set
because the directionality is unclear&ndash;e.g., does temperature 
cause latitude or does latitude cause temperature?&ndash;and the assumptions 
of the variables are not specified in the list of structural equations, 
so evaluating the relationship becomes challenging without further 
input from the user. This creates a circular scenario whereby the 
user specifies relationships among exogenous variables, raising the 
issue of whether they should be included as directed paths if they can 
be assigned directional relationships.
</p>
<p>Paths can be omitted from the basis set by specifying them as correlated
errors using <code>%~~%</code> or by assigning a directionality using 
the argument <code>direction</code>, e.g. <code>direction = c("X &lt;- Y")</code>. 
This can be done if post hoc examination of the d-sep tests reveals
nonsensical independence claims (e.g., arthropod abundance predicting
photosynthetically-active radiation) that the user may wish to 
exclude from evaluation.
</p>


<h3>Value</h3>

<p>A <code>list</code> of independence claims.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;
</p>


<h3>References</h3>

<p>Shipley, Bill. &quot;A new inferential test for path models based on directed acyclic graphs.&quot; Structural Equation Modeling 7.2 (2000): 206-218.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dSep">dSep</a></code>
</p>

<hr>
<h2 id='captureTable'>Captures output table</h2><span id='topic+captureTable'></span>

<h3>Description</h3>

<p>Captures output table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>captureTable(g, row.names = FALSE)
</code></pre>

<hr>
<h2 id='cbind_fill'>Bind data.frames of differing dimensions</h2><span id='topic+cbind_fill'></span>

<h3>Description</h3>

<p>From: https://stackoverflow.com/a/31678079
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cbind_fill(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cbind_fill_+3A_...">...</code></td>
<td>
<p>data.frames to be bound, separated by commas
</p>
<p>@keywords internal</p>
</td></tr>
</table>

<hr>
<h2 id='cerror'>Correlated errors</h2><span id='topic+cerror'></span>

<h3>Description</h3>

<p>Calculates partial correlations and partial significance tests.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cerror(formula., modelList, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cerror_+3A_formula.">formula.</code></td>
<td>
<p>A formula specifying the two correlated variables using <code>%~~%</code>.</p>
</td></tr>
<tr><td><code id="cerror_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations.</p>
</td></tr>
<tr><td><code id="cerror_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> containing the data used in the list of equations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If the variables are exogenous, then the correlated error is the raw
bivariate correlation.
</p>
<p>If the variables are endogenous, then the correlated error is the partial
correlation, accounting for the influence of any predictors.
</p>
<p>The significance of the correlated error is conducted using <code>cor.test</code>
if the variables are exogenous. Otherwise, a t-statistic is constructed and
compared to a t-distribution with N - k - 2 degrees of freedom (where N is
the total number of replicates, and k is the total number of variables
informing the relationship) to derive a P-value.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> containing the (partial) correlation and
associated significance test.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic++25~~+25">%~~%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example data
dat &lt;- data.frame(x1 = runif(50),
  x2 = runif(50), y1 = runif(50),
    y2 = runif(50))

# Create list of structural equations
sem &lt;- psem(
  lm(y1 ~ x1 + x2, dat),
  lm(y2 ~ y1 + x1, dat)
)

# Look at correlated error between x1 and x2
# (exogenous)
cerror(x1 %~~% x2, sem, dat)

# Same as cor.test
with(dat, cor.test(x1, x2))

# Look at correlatde error between x1 and y1
# (endogenous)
cerror(y1 %~~% x1, sem, dat)

# Not the same as cor.test
# (accounts for influence of x1 and x2 on y1)
with(dat, cor.test(y1, x1))

# Specify in psem
sem &lt;- update(sem, x1 %~~% y1)

coefs(sem)

</code></pre>

<hr>
<h2 id='checkData'>Check to see whether supplied data.frame matches model-extracted data</h2><span id='topic+checkData'></span>

<h3>Description</h3>

<p>Check to see whether supplied data.frame matches model-extracted data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkData(x)
</code></pre>

<hr>
<h2 id='checkTransformations'>Check to see whether variables exist as transformed and untransformed</h2><span id='topic+checkTransformations'></span>

<h3>Description</h3>

<p>Check to see whether variables exist as transformed and untransformed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkTransformations(x)
</code></pre>

<hr>
<h2 id='coefs'>Extract path coefficients</h2><span id='topic+coefs'></span>

<h3>Description</h3>

<p>Extracts (standardized) path coefficients from a <code>psem</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coefs(
  modelList,
  standardize = "scale",
  standardize.type = "latent.linear",
  test.statistic = "F",
  test.type = "II",
  intercepts = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coefs_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations, or a model.</p>
</td></tr>
<tr><td><code id="coefs_+3A_standardize">standardize</code></td>
<td>
<p>The type of standardization: <code>none</code>, <code>scale</code>, <code>range</code>.
Default is <code>scale</code>.</p>
</td></tr>
<tr><td><code id="coefs_+3A_standardize.type">standardize.type</code></td>
<td>
<p>The type of standardized for non-Gaussian responses:
<code>latent.linear</code>, <code>Menard.OE</code>. Default is <code>latent.linear</code> for binomial; 
otherwise it is <code>Menard.OE</code>.</p>
</td></tr>
<tr><td><code id="coefs_+3A_test.statistic">test.statistic</code></td>
<td>
<p>the type of test statistic generated by <code>Anova</code></p>
</td></tr>
<tr><td><code id="coefs_+3A_test.type">test.type</code></td>
<td>
<p>the type of test for significance of categorical variables
from <code>Anova</code>. Default is type &quot;II&quot;.</p>
</td></tr>
<tr><td><code id="coefs_+3A_intercepts">intercepts</code></td>
<td>
<p>Whether intercepts should be included in the coefficients
table. Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>P-values for models constructed using <code>lme4</code> are obtained
using the Kenward-Roger approximation of the denominator degrees of freedom
as implemented in the <code>Anova</code> function.
</p>
<p>Different forms of standardization can be implemented using the <code>standardize</code>
argument:</p>

<ul>
<li><p><code>none</code> No standardized coefficients are reported.
</p>
</li>
<li><p><code>scale</code> Raw coefficients are scaled by the ratio of the standard deviation
of x divided by the standard deviation of y. See below for cases pertaining to GLM. 
</p>
</li>
<li><p><code>range</code> Raw coefficients are scaled by a pre-selected range of x
divided by a preselected range of y. The default argument is <code>range</code> which takes the
two extremes of the data, otherwise the user must supply must a named <code>list</code> where
the names are the variables to be standardized, and each entry contains a vector of 
length == 2 to the ranges to be used in standardization.
</p>
</li></ul>

<p>For non-Gaussian responses, standardized coefficients are obtained in one of two ways:
</p>
 <ul>
<li><p><code>latent.linear</code> Referred to in Grace et al. 2019 as the standard form of
the latent-theoretic (LT) approach. In this method, there is assumed to be a continuous 
latent propensity, y*, that underlies the observed binary responses. The standard
deviation of y* is computed as the square-root of the variance of the predictions
(on the linear or 'link' scale) plus the distribution-specific theoretical variance in the
case of binomial responses (for logit links: pi^2/3, for probit links: 1).
</p>
</li>
<li><p><code>Menard.OE</code> Referred to in Grace et al. 2019 as the standard form of
the observed-empirical (OE) approach. In this method, error variance is based on the
differences between predicted scores and the observed binary data. The standard
deviation used for standardization is computed as the square-root of the variance of
the predictions (on the linear scale) plus the correlation between the observed and
predicted (on the original or 'response' scale) values of y.
</p>
</li></ul>

<p>For categorical predictors: significance is determined using ANOVA (or analysis of
deviance). Because n-1 coefficients are reported for n levels, the output instead
reports model-estimated means in the <code>Estimate</code> column. This is done so all
n paths in the corresponding path diagram have assignable values.
</p>
<p>The means are generated using function <code>emmeans</code> in the <code>emmeans</code> package. 
Pairwise contrasts are further conducted among all levels using the default  
correction for multiple testing. The results of those comparisons are given in the 
significance codes (e.g., &quot;a&quot;, &quot;b&quot;, &quot;ab&quot;) as reported in the <code>multcomp::cld</code> function.
</p>
<p>For non-linear variables (i.e., smoothing functions from <code>mgcv::gam</code>), there are
no linear estimates reported.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> of coefficients, their standard errors,
degrees of freedom, and significance tests.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;, Jim Grace
</p>


<h3>References</h3>

<p>Grace, J.B., Johnson, D.A., Lefcheck, J.S., and Byrnes, J.E.
&quot;Standardized Coefficients in Regression and Structural Models with Binary Outcomes.&quot; 
Ecosphere 9(6): e02283.
</p>


<h3>See Also</h3>

<p><code><a href="car.html#topic+Anova">Anova</a></code>, <code><a href="emmeans.html#topic+emmeans">emmeans</a></code>, <code><a href="multcomp.html#topic+cld">cld</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

coefs(mod)

</code></pre>

<hr>
<h2 id='dataTrans'>Transform variables based on model formula and store in new data frame</h2><span id='topic+dataTrans'></span>

<h3>Description</h3>

<p>Transform variables based on model formula and store in new data frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataTrans(formula., data)
</code></pre>

<hr>
<h2 id='dSep'>Tests of directed separation</h2><span id='topic+dSep'></span>

<h3>Description</h3>

<p>Evaluation of conditional independence claims to be used in determining the
goodness-of-fit for piecewise structural equation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dSep(
  modelList,
  basis.set = NULL,
  direction = NULL,
  interactions = FALSE,
  conserve = FALSE,
  conditioning = FALSE,
  .progressBar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dSep_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations created using <code>psem</code>.</p>
</td></tr>
<tr><td><code id="dSep_+3A_basis.set">basis.set</code></td>
<td>
<p>An optional list of independence claims.</p>
</td></tr>
<tr><td><code id="dSep_+3A_direction">direction</code></td>
<td>
<p>A <code>vector</code> of claims defining the specific
directionality of independence claims; for use in special cases (see
Details).</p>
</td></tr>
<tr><td><code id="dSep_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in independence claims. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="dSep_+3A_conserve">conserve</code></td>
<td>
<p>Whether the most conservative P-value should be returned;
for use in special cases (see Details). Default is FALSE.</p>
</td></tr>
<tr><td><code id="dSep_+3A_conditioning">conditioning</code></td>
<td>
<p>Whether the conditioning variables should be shown in
the summary table. Default is FALSE.</p>
</td></tr>
<tr><td><code id="dSep_+3A_.progressbar">.progressBar</code></td>
<td>
<p>An optional progress bar. Default is TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In cases involving non-normally distributed responses in the independence
claims that are modeled using generalized linear models, the significance of
the independence claim is not reversible (e.g., the P-value of Y ~ X is not
the same as X ~ Y). This is due to the transformation of the response via
the link function. In extreme cases, this can bias the goodness-of-fit
tests. <code>summary.psem</code> will issue a warning when this case is present
and provide guidance for solutions.
</p>
<p>One solution is to specify the directionality of the relationship using the
<code>direction</code> argument, e.g. <code>direction = c("X &lt;- Y")</code>. Another is
to run both tests (Y ~ X, X ~ Y) and return the most conservative (i.e.,
lowest) P-value, which can be toggled using the <code>conserve = TRUE</code>
argument.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> of independence claims and their
significance values.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;, Jarrett Byrnes
</p>


<h3>References</h3>

<p>Shipley, Bill. &quot;A new inferential test for path models based on
directed acyclic graphs.&quot; Structural Equation Modeling 7.2 (2000): 206-218.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+basisSet">basisSet</a></code>
</p>

<hr>
<h2 id='dupOutput'>Identify duplicate output</h2><span id='topic+dupOutput'></span>

<h3>Description</h3>

<p>Identify duplicate output
</p>
<p>Identify duplicate output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupOutput(b, conserve = FALSE)

dupOutput(b, conserve = FALSE)
</code></pre>

<hr>
<h2 id='evaluateClasses'>Evaluate model classes and stop if unsupported model class</h2><span id='topic+evaluateClasses'></span>

<h3>Description</h3>

<p>Evaluate model classes and stop if unsupported model class
</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluateClasses(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="evaluateClasses_+3A_x">x</code></td>
<td>
<p>a list of structural equations or a model object</p>
</td></tr>
</table>

<hr>
<h2 id='filterExisting'>Remove existing paths from the basis set</h2><span id='topic+filterExisting'></span>

<h3>Description</h3>

<p>Remove existing paths from the basis set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterExisting(b, modelList)
</code></pre>

<hr>
<h2 id='filterExogenous'>Filter relationships among exogenous variables from the basis set (ignoring add.vars)</h2><span id='topic+filterExogenous'></span>

<h3>Description</h3>

<p>Filter relationships among exogenous variables from the basis set (ignoring add.vars)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterExogenous(b, modelList, amat)
</code></pre>

<hr>
<h2 id='filterInteractions'>Filter interactions from the d-sep tests</h2><span id='topic+filterInteractions'></span>

<h3>Description</h3>

<p>Filter interactions from the d-sep tests
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterInteractions(b, interactions = FALSE)
</code></pre>

<hr>
<h2 id='filterSmoothed'>First, remove claims where linear and non-linear terms appear in the same claim</h2><span id='topic+filterSmoothed'></span>

<h3>Description</h3>

<p>First, remove claims where linear and non-linear terms appear in the same claim
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filterSmoothed(b, modelList)
</code></pre>

<hr>
<h2 id='findbars.lme'>Get random effects from lme</h2><span id='topic+findbars.lme'></span>

<h3>Description</h3>

<p>Get random effects from lme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>findbars.lme(model)
</code></pre>

<hr>
<h2 id='fisherC'>Summarize tests of directed separation using Fisher's C statistic</h2><span id='topic+fisherC'></span>

<h3>Description</h3>

<p>Summarize tests of directed separation using Fisher's C statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fisherC(
  dTable,
  add.claims = NULL,
  basis.set = NULL,
  direction = NULL,
  interactions = FALSE,
  conserve = FALSE,
  conditional = FALSE,
  .progressBar = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fisherC_+3A_dtable">dTable</code></td>
<td>
<p>a <code>data.frame</code> containing tests of directed separation from <code>dSep</code></p>
</td></tr>
<tr><td><code id="fisherC_+3A_add.claims">add.claims</code></td>
<td>
<p>an optional vector of additional independence claims (i.e., P-values) 
to be added to the basis set</p>
</td></tr>
<tr><td><code id="fisherC_+3A_basis.set">basis.set</code></td>
<td>
<p>An optional list of independence claims.</p>
</td></tr>
<tr><td><code id="fisherC_+3A_direction">direction</code></td>
<td>
<p>a vector of claims defining the specific directionality of any independence 
claim(s)</p>
</td></tr>
<tr><td><code id="fisherC_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in independence claims. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="fisherC_+3A_conserve">conserve</code></td>
<td>
<p>whether the most conservative P-value should be returned. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="fisherC_+3A_conditional">conditional</code></td>
<td>
<p>whether the conditioning variables should be shown in the table. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="fisherC_+3A_.progressbar">.progressBar</code></td>
<td>
<p>an optional progress bar. Default is FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame corresponding to the C statistic, d.f., and P-value
</p>

<hr>
<h2 id='fixCatDir'>Flip independence claims so categorical variables are not the response</h2><span id='topic+fixCatDir'></span>

<h3>Description</h3>

<p>Flip independence claims so categorical variables are not the response
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fixCatDir(b, modelList)
</code></pre>

<hr>
<h2 id='formatpsem'>Format for psem</h2><span id='topic+formatpsem'></span>

<h3>Description</h3>

<p>Format for psem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatpsem(x)
</code></pre>

<hr>
<h2 id='get_response'>Get Response Name as a Character</h2><span id='topic+get_response'></span>

<h3>Description</h3>

<p>Get Response Name as a Character
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_response(mod)
</code></pre>

<hr>
<h2 id='getAnova'>Get ANOVA results from 'merMod'</h2><span id='topic+getAnova'></span>

<h3>Description</h3>

<p>Get ANOVA results from 'merMod'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getAnova(model, test.statistic = "F", test.type = "III")
</code></pre>

<hr>
<h2 id='getCoefficients'>Get coefficients from linear regression</h2><span id='topic+getCoefficients'></span>

<h3>Description</h3>

<p>Get coefficients from linear regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getCoefficients(model, data = NULL, test.statistic = "F", test.type = "II")
</code></pre>

<hr>
<h2 id='getDAG'>Generate adjacency matrix from list of structural equations</h2><span id='topic+getDAG'></span>

<h3>Description</h3>

<p>Generate adjacency matrix from list of structural equations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getDAG(modelList)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getDAG_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations</p>
</td></tr>
</table>

<hr>
<h2 id='GetData'>Get data from model list</h2><span id='topic+GetData'></span>

<h3>Description</h3>

<p>Get data from model list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetData(modelList)
</code></pre>

<hr>
<h2 id='getLHS'>Get Left-hand side of formulae</h2><span id='topic+getLHS'></span>

<h3>Description</h3>

<p>Get Left-hand side of formulae
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getLHS(formulaList)
</code></pre>

<hr>
<h2 id='GetOLRE'>Obtain (observation-level) random effects from a generalized linear mixed model</h2><span id='topic+GetOLRE'></span>

<h3>Description</h3>

<p>RE = &quot;all&quot; all random effects are reported
RE = &quot;RE&quot; just group effects are reported
RE = &quot;OLRE&quot; just observation-level effects are reported
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetOLRE(sigma, model, X, data, RE = c("all", "RE", "OLRE"))
</code></pre>

<hr>
<h2 id='getResidModels'>Identify models with correlated errors and return modified versions</h2><span id='topic+getResidModels'></span>

<h3>Description</h3>

<p>Identify models with correlated errors and return modified versions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getResidModels(vars, modelList, data)
</code></pre>

<hr>
<h2 id='getRHS'>Get Right-hand side of formulae</h2><span id='topic+getRHS'></span>

<h3>Description</h3>

<p>Get Right-hand side of formulae
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getRHS(formulaList)
</code></pre>

<hr>
<h2 id='getSatModels'>Get saturated model by reinserting all excluded paths</h2><span id='topic+getSatModels'></span>

<h3>Description</h3>

<p>Get saturated model by reinserting all excluded paths
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSatModels(b, modelList, data)
</code></pre>

<hr>
<h2 id='GetSDx'>Get standard deviation of predictor variables</h2><span id='topic+GetSDx'></span>

<h3>Description</h3>

<p>Get standard deviation of predictor variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetSDx(model, modelList, data, standardize = "scale")
</code></pre>

<hr>
<h2 id='GetSDy'>Properly scale standard deviations depending on the error distribution</h2><span id='topic+GetSDy'></span>

<h3>Description</h3>

<p>Properly scale standard deviations depending on the error distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetSDy(model, data, standardize = "scale", standardize.type = "latent.linear")
</code></pre>

<hr>
<h2 id='GetSingleData'>Get data from one model</h2><span id='topic+GetSingleData'></span>

<h3>Description</h3>

<p>Get data from one model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetSingleData(model)
</code></pre>

<hr>
<h2 id='getSortedPsem'>Get a sorted psem object in DAG order</h2><span id='topic+getSortedPsem'></span>

<h3>Description</h3>

<p>Takes a [psem] object, pulls out the
DAG, and then sorts the psem object into the order
of the DAG (from exogenous to terminal endogenous
variable) for use by other functions. Note: removes
correlated errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getSortedPsem(object, keepdata = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getSortedPsem_+3A_object">object</code></td>
<td>
<p>A fit [psem] object</p>
</td></tr>
<tr><td><code id="getSortedPsem_+3A_keepdata">keepdata</code></td>
<td>
<p>Defaults to TRUE. Should the
data with the psem be included in the returned
object?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A new [psem] object, without the data.
</p>

<hr>
<h2 id='GetVarCov'>Get random effects variance-covariance from lme</h2><span id='topic+GetVarCov'></span>

<h3>Description</h3>

<p>Get random effects variance-covariance from lme
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GetVarCov(model)
</code></pre>

<hr>
<h2 id='handleCategoricalCoefs'>Handles putting categorical variables into coefficient tables
for easy use in path analysis</h2><span id='topic+handleCategoricalCoefs'></span>

<h3>Description</h3>

<p>Handles putting categorical variables into coefficient tables
for easy use in path analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>handleCategoricalCoefs(
  ret,
  model,
  data,
  test.statistic = "F",
  test.type = "II"
)
</code></pre>

<hr>
<h2 id='import'>Functions to import from dependencies</h2><span id='topic+import'></span>

<h3>Description</h3>

<p>Functions to import from dependencies
</p>

<hr>
<h2 id='isSig'>Assess significance</h2><span id='topic+isSig'></span>

<h3>Description</h3>

<p>Assess significance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isSig(p)
</code></pre>

<hr>
<h2 id='keeley'>Data set from Grace &amp; Keeley (2006)</h2><span id='topic+keeley'></span>

<h3>Description</h3>

<p>Data set from Grace &amp; Keeley (2006)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>keeley
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 90 observations of 8 variables.
</p>

<dl>
<dt>distance</dt><dd><p>Distance to coast</p>
</dd>
<dt>elev</dt><dd><p>Elevation from sea level</p>
</dd>
<dt>abiotic</dt><dd><p>Abiotic favorability</p>
</dd>
<dt>age</dt><dd><p>Age of stand before fire</p>
</dd>
<dt>hetero</dt><dd><p>Plot heterogeneity</p>
</dd>
<dt>firesev</dt><dd><p>Severity of fire</p>
</dd>
<dt>cover</dt><dd><p>Cover of plants</p>
</dd>
<dt>rich</dt><dd><p>Plant species richness</p>
</dd>
</dl>


<hr>
<h2 id='listFormula'>Recompute P-values using Kenward-Rogers approximation</h2><span id='topic+listFormula'></span>

<h3>Description</h3>

<p>Recompute P-values using Kenward-Rogers approximation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listFormula(modelList, formulas = 0)
</code></pre>

<hr>
<h2 id='LLchisq'>Generalized chi-squared for piecewise SEM</h2><span id='topic+LLchisq'></span>

<h3>Description</h3>

<p>Derivation of log-likelihoods to be used in determining the
goodness-of-fit for piecewise structural equation models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LLchisq(
  modelList,
  basis.set = NULL,
  direction = NULL,
  interactions = FALSE,
  conserve = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LLchisq_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations created using <code>psem</code>.</p>
</td></tr>
<tr><td><code id="LLchisq_+3A_basis.set">basis.set</code></td>
<td>
<p>An optional list of independence claims.</p>
</td></tr>
<tr><td><code id="LLchisq_+3A_direction">direction</code></td>
<td>
<p>A <code>vector</code> of claims defining the specific
directionality of independence claims; for use in special cases (see
<code><a href="#topic+dSep">dSep</a></code>.</p>
</td></tr>
<tr><td><code id="LLchisq_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in basis set. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="LLchisq_+3A_conserve">conserve</code></td>
<td>
<p>Whether the most conservative log-likelihood should be returned;
for use in special cases (see Details). Default is FALSE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, a list of saturated models is first derived from the list of
structured equations using the basis set. Then, the differences in summed
log-likelihoods are computed and used to calculate the Chi-squared statistic.
</p>


<h3>Value</h3>

<p>a data.frame corresponding to the Chi-squared statistic, d.f., and P-value
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;
</p>


<h3>References</h3>

<p>Shipley, Bill, and Jacob C. Douma. &quot;Generalized AIC and chi‐squared statistics 
for path models consistent with directed acyclic graphs.&quot; Ecology 101.3 (2020): e02960.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+basisSet">basisSet</a></code>, <code><a href="#topic+dSep">dSep</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

LLchisq(mod)

</code></pre>

<hr>
<h2 id='meadows'>Data set from Grace &amp; Jutila (1999)</h2><span id='topic+meadows'></span>

<h3>Description</h3>

<p>Data set from Grace &amp; Jutila (1999)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meadows
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 354 observations of 4 variables.
</p>

<dl>
<dt>grazed</dt><dd><p>Whether meadows were exposed to grazing: 0 = no, 1 = yes</p>
</dd>
<dt>mass</dt><dd><p>Plant biomass in g m[-2]</p>
</dd>
<dt>elev</dt><dd><p>Elevation of the plot above mean sea level</p>
</dd>
<dt>rich</dt><dd><p>Plant species richness per m[2]</p>
</dd>
</dl>


<hr>
<h2 id='multigroup'>Multigroup Analysis for Piecewise SEM</h2><span id='topic+multigroup'></span>

<h3>Description</h3>

<p>Multigroup Analysis for Piecewise SEM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multigroup(
  modelList,
  group,
  standardize = "scale",
  standardize.type = "latent.linear",
  test.type = "III"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="multigroup_+3A_modellist">modelList</code></td>
<td>
<p>a list of structural equations</p>
</td></tr>
<tr><td><code id="multigroup_+3A_group">group</code></td>
<td>
<p>the name of the grouping variable in quotes</p>
</td></tr>
<tr><td><code id="multigroup_+3A_standardize">standardize</code></td>
<td>
<p>The type of standardization: <code>none</code>, <code>scale</code>, <code>range</code>.
Default is <code>scale</code>.</p>
</td></tr>
<tr><td><code id="multigroup_+3A_standardize.type">standardize.type</code></td>
<td>
<p>The type of standardized for non-Gaussian responses:
<code>latent.linear</code>, <code>Menard.OE</code>. Default is <code>latent.linear</code>.</p>
</td></tr>
<tr><td><code id="multigroup_+3A_test.type">test.type</code></td>
<td>
<p>what kind of ANOVA should be reported. Default is type III</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(meadows)

jutila &lt;- psem(
lm(rich ~ elev + mass, data = meadows),
lm(mass ~ elev, data = meadows)
)

jutila.multigroup &lt;- multigroup(jutila, group = "grazed")

jutila.multigroup

</code></pre>

<hr>
<h2 id='nObs'>Get number of observations from a model</h2><span id='topic+nObs'></span>

<h3>Description</h3>

<p>Get number of observations from a model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nObs(object, ...)
</code></pre>

<hr>
<h2 id='onlyBars'>Get random effects from merMod</h2><span id='topic+onlyBars'></span>

<h3>Description</h3>

<p>Get random effects from merMod
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onlyBars(formula., slopes = TRUE)
</code></pre>

<hr>
<h2 id='partialCorr'>Calculate partial correlations from partial residuals</h2><span id='topic+partialCorr'></span>

<h3>Description</h3>

<p>Calculate partial correlations from partial residuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partialCorr(formula., modelList, data = NULL)
</code></pre>

<hr>
<h2 id='partialResid'>Computing partial effects</h2><span id='topic+partialResid'></span>

<h3>Description</h3>

<p>Extracts partial residuals from a model or <code>psem</code> object for a given
<code>x</code> and <code>y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>partialResid(formula., modelList, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="partialResid_+3A_formula.">formula.</code></td>
<td>
<p>A formula where the <code>lhs</code> is the response and the
<code>rhs</code> is the predictor whose partial effect is desired.</p>
</td></tr>
<tr><td><code id="partialResid_+3A_modellist">modelList</code></td>
<td>
<p>A list of structural equations.</p>
</td></tr>
<tr><td><code id="partialResid_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code> used to fit the equations.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes the partial residuals of <code>y ~ x + Z</code> in a
two-step procedure to remove the variation explained by <code>Z</code>: (1) remove
<code>x</code> from the equation and model <code>y ~ Z</code>, and (2) replace <code>y</code>
with <code>x</code> and model <code>x ~ Z</code>.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> of residuals of <code>y ~ Z</code> called
<code>yresids</code>, of <code>x ~ Z</code> called <code>xresids</code>.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cerror">cerror</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Generate data
dat &lt;- data.frame(y = rnorm(100), x1 = rnorm(100), x2 = rnorm(100))

# Build model
model &lt;- lm(y ~ x1 + x2, dat)

# Compute partial residuals of y ~ x1
yresid &lt;- resid(lm(y ~ x2, dat))

xresid &lt;- resid(lm(x1 ~ x2, dat))

plot(xresid, yresid)

# Use partialResid
presid &lt;- partialResid(y ~ x1, model)

with(presid, plot(xresid, yresid)) # identical plot!

</code></pre>

<hr>
<h2 id='plot.psem'>Plotting of Piecewise Structural Equation Models</h2><span id='topic+plot.psem'></span>

<h3>Description</h3>

<p>plot.psem uses [DiagrammeR] to generate path diagrams 
of 'piecewiseSEM&ldquo; fits within R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
plot(
  x,
  return = FALSE,
  node_attrs = data.frame(shape = "rectangle", color = "black", fillcolor = "white"),
  edge_attrs = data.frame(style = "solid", color = "black"),
  ns_dashed = T,
  alpha = 0.05,
  show = "std",
  digits = 3,
  add_edge_label_spaces = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.psem_+3A_x">x</code></td>
<td>
<p>a [psem()] object</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_return">return</code></td>
<td>
<p>whether to return the output from [DiagrammeR::create_graph()] for modification and later plotting</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_node_attrs">node_attrs</code></td>
<td>
<p>List of node attributes to override defaults of rectangular nodes with black outline and white fill. See [here](http://visualizers.co/diagrammer/articles/node-edge-data-frames.html) and [here](http://visualizers.co/diagrammer/articles/graphviz-mermaid.html) for a more complete rundown of options.</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_edge_attrs">edge_attrs</code></td>
<td>
<p>List of edge attributes to override defaults of solid black arrows. See [here](http://visualizers.co/diagrammer/articles/node-edge-data-frames.html) and [here](http://visualizers.co/diagrammer/articles/graphviz-mermaid.html) for a more complete rundown of options.</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_ns_dashed">ns_dashed</code></td>
<td>
<p>If TRUE, paths that are not different from 0 will be dashed rather than solid, unless the whole is overridden in 'edge_attrs'</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_alpha">alpha</code></td>
<td>
<p>The alpha level for assessing whether a path is different from 0</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_show">show</code></td>
<td>
<p>What types of path coefficients are shown? Default '&quot;std&quot;' is standardized coefficients. For undstandardized, use '&quot;unstd&quot;'</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_digits">digits</code></td>
<td>
<p>How many significant digits should be shown?</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_add_edge_label_spaces">add_edge_label_spaces</code></td>
<td>
<p>Should spaces by added on either side of edge labels? Default is 'TRUE' as otherwise paths too often overlap edges.</p>
</td></tr>
<tr><td><code id="plot.psem_+3A_...">...</code></td>
<td>
<p>Other arguments to [DiagrammeR::render_graph()]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns an object of class [DiagrammeR::dgr_graph]
</p>


<h3>Author(s)</h3>

<p>Jarrett Byrnes &lt;jarrett.byrnes@umb.edu&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(keeley)

mod &lt;- psem(
  lm(rich ~ cover, data=keeley),
  lm(cover ~ firesev, data=keeley),
  lm(firesev ~ age, data=keeley),
  data = keeley
)

plot(mod)

### More customized plot

plot(mod, node_attrs = list(
  shape = "rectangle", color = "black",
  fillcolor = "orange", x = 3, y=1:4))
  
</code></pre>

<hr>
<h2 id='print.anova.psem'>Print anova</h2><span id='topic+print.anova.psem'></span>

<h3>Description</h3>

<p>Print anova
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'anova.psem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.anova.psem_+3A_x">x</code></td>
<td>
<p>an object of class anova.psem</p>
</td></tr>
<tr><td><code id="print.anova.psem_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>

<hr>
<h2 id='print.attr'>Do not print attributes with custom functions</h2><span id='topic+print.attr'></span>

<h3>Description</h3>

<p>Do not print attributes with custom functions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'attr'
print(x, ...)
</code></pre>

<hr>
<h2 id='print.basisSet'>Print basis set</h2><span id='topic+print.basisSet'></span>

<h3>Description</h3>

<p>Print basis set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'basisSet'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.basisSet_+3A_x">x</code></td>
<td>
<p>a basis set</p>
</td></tr>
<tr><td><code id="print.basisSet_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>

<hr>
<h2 id='print.multigroup.psem'>Print multigroup</h2><span id='topic+print.multigroup.psem'></span>

<h3>Description</h3>

<p>Print multigroup
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multigroup.psem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.multigroup.psem_+3A_x">x</code></td>
<td>
<p>an object to print</p>
</td></tr>
<tr><td><code id="print.multigroup.psem_+3A_...">...</code></td>
<td>
<p>additional arguments to print</p>
</td></tr>
</table>

<hr>
<h2 id='print.psem'>Print psem</h2><span id='topic+print.psem'></span>

<h3>Description</h3>

<p>Print psem
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.psem_+3A_x">x</code></td>
<td>
<p>an object of class psem</p>
</td></tr>
<tr><td><code id="print.psem_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>

<hr>
<h2 id='print.summary.psem'>Print summary</h2><span id='topic+print.summary.psem'></span>

<h3>Description</h3>

<p>Print summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.psem'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.psem_+3A_x">x</code></td>
<td>
<p>an object of class summary.psem</p>
</td></tr>
<tr><td><code id="print.summary.psem_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods</p>
</td></tr>
</table>

<hr>
<h2 id='psem'>Fitting piecewise structural equation models</h2><span id='topic+psem'></span>

<h3>Description</h3>

<p><code>psem</code> is used to unite a list of structural equations into a single
structural equation model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psem(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psem_+3A_...">...</code></td>
<td>
<p>A list of structural equations</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>psem</code> takes a list of structural equations, which can be model objects
of classes: <code>lm, glm, gls, pgls, Sarlm, lme, glmmPQL, lmerMod,
lmerModLmerTest, glmerMod, glmmTMB, gam</code>.
</p>
<p>It also takes objects of class <code>formula, formula.cerror</code>, corresponding
to additional variables to be included in the tests of directed separation
(<code>X ~ 1</code>) or correlated errors (<code>X1 %~~% X2</code>).
</p>
<p>The function optionally accepts data objects of classes: <code>matrix,
data.frame, SpatialPointsDataFrame, comparative.data</code>, or these are derived
internally from the structural equations.
</p>


<h3>Value</h3>

<p>Returns an object of class <code>psem</code>
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;LefcheckJ@si.edu&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+summary.psem">summary.psem</a></code>, <code><a href="#topic++25~~+25">%~~%</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mod &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

summary(mod)

</code></pre>

<hr>
<h2 id='removeCerror'>Remove correlated errors from the basis set</h2><span id='topic+removeCerror'></span>

<h3>Description</h3>

<p>Remove correlated errors from the basis set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeCerror(b, modelList)
</code></pre>

<hr>
<h2 id='removeData'>Remove data from the model list</h2><span id='topic+removeData'></span>

<h3>Description</h3>

<p>formulas = 0, keep everything
formulas = 1, remove all formulas including correlated errors
formulas = 2, remove only formula but keep correlated errors
formulas = 3, remove correlated errors but keep formula
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeData(modelList, formulas = 0)
</code></pre>

<hr>
<h2 id='resid.lme'>Get residuals from innermost grouping of mixed models (replicate-level)</h2><span id='topic+resid.lme'></span>

<h3>Description</h3>

<p>Get residuals from innermost grouping of mixed models (replicate-level)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lme'
resid(model)
</code></pre>

<hr>
<h2 id='residuals.psem'>Residual values from fit models</h2><span id='topic+residuals.psem'></span>

<h3>Description</h3>

<p>Residual values from fit models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
residuals(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.psem_+3A_object">object</code></td>
<td>
<p>a <code><a href="#topic+psem">psem</a></code> object</p>
</td></tr>
<tr><td><code id="residuals.psem_+3A_...">...</code></td>
<td>
<p>additional arguments to residuals</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>data.frame</code> of residuals for endogenous variables as columns
</p>

<hr>
<h2 id='reverseAddVars'>Replace transformations in the basis set by cycling through neighbors and applying
transformations in order of how variables are treated in the child nearest to current node</h2><span id='topic+reverseAddVars'></span>

<h3>Description</h3>

<p>Replace transformations in the basis set by cycling through neighbors and applying
transformations in order of how variables are treated in the child nearest to current node
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reverseAddVars(b, modelList, amat)
</code></pre>

<hr>
<h2 id='reverseNonLin'>If intermediate endogenous variables are nonlinear, return both directions</h2><span id='topic+reverseNonLin'></span>

<h3>Description</h3>

<p>If intermediate endogenous variables are nonlinear, return both directions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reverseNonLin(b, modelList, amat)
</code></pre>

<hr>
<h2 id='rsquared'>R-squared for linear regression</h2><span id='topic+rsquared'></span>

<h3>Description</h3>

<p>Returns (pseudo)-R^2 values for all linear, generalized linear, and
generalized linear mixed effects models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared(modelList, method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rsquared_+3A_modellist">modelList</code></td>
<td>
<p>a regression, or a list of structural equations.</p>
</td></tr>
<tr><td><code id="rsquared_+3A_method">method</code></td>
<td>
<p>The method used to compute the R2 value (See Details)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For mixed models, marginal R2 considers only the variance by the fixed
effects, and the conditional R2 by both the fixed and random effects.
</p>
<p>For generalized additive models fit to gaussian distribution, the function
returns ths adjusted-R2. For all other distributions, it returns the proportion
of deviance explained.
</p>
<p>For GLMs (<code>glm</code>), supported methods include: </p>

<ul>
<li><p><code>mcfadden</code> 1 - ratio of likelihoods of full vs. null models
</p>
</li>
<li><p><code>coxsnell</code> McFadden's R2 but raised to 2/N. Upper limit is &lt; 1
</p>
</li>
<li><p><code>nagelkerke</code> Adjusts Cox-Snell R2 so that upper limit = 1. The
DEFAULT method
</p>
</li></ul>
<p> For GLMERs fit to Poisson, Gamma, and negative binomial distributions
(<code>glmer</code>, <code>glmmPQL</code>, <code>glmer.nb</code>), supported methods include
</p>
 <ul>
<li><p><code>delta</code> Approximates the observation variance based on
second-order Taylor series expansion. Can be used with many families and
link functions
</p>
</li>
<li><p><code>lognormal</code> Observation variance is the variance of the log-normal
distribution
</p>
</li>
<li><p><code>trigamma</code> Provides most accurate estimate of the observation
variance but is limited to only the log link. The DEFAULT method
</p>
</li></ul>
<p> For GLMERs fit to the binomial distribution (<code>glmer</code>,
<code>glmmPQL</code>), supported methods include: </p>

<ul>
<li><p><code>theoretical</code> Assumes observation variance is pi^2/3
</p>
</li>
<li><p><code>delta</code> Approximates the observation variance as above. The
DEFAULT method
</p>
</li></ul>



<h3>Value</h3>

<p>Returns a <code>data.frame</code> with the response, its family and link,
the method used to estimate R2, and the R2 value itself. Mixed models also
return marginal and conditional R2 values.
</p>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;
</p>


<h3>References</h3>

<p>Nakagawa, Shinichi, Paul CD Johnson, and Holger Schielzeth. 
&quot;The coefficient of determination R 2 and intra-class correlation coefficient 
from generalized linear mixed-effects models revisited and expanded.&quot; 
Journal of the Royal Society Interface 14.134 (2017): 20170213.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  ## Not run: 
    # Create data
    dat &lt;- data.frame(
      ynorm = rnorm(100),
      ypois = rpois(100, 100),
      x1 = rnorm(100),
      random = letters[1:5]
    )

    # Get R2 for linear model
    rsquared(lm(ynorm ~ x1, dat))

    # Get R2 for generalized linear model
    rsquared(glm(ypois ~ x1, "poisson", dat))

    rsquared(glm(ypois ~ x1, "poisson", dat), method = "mcfadden") # McFadden R2

    # Get R2 for generalized least-squares model
    rsquared(gls(ynorm ~ x1, dat))

    # Get R2 for linear mixed effects model (nlme)
    rsquared(nlme::lme(ynorm ~ x1, random = ~ 1 | random, dat))

    # Get R2 for linear mixed effects model (lme4)
    rsquared(lme4::lmer(ynorm ~ x1 + (1 | random), dat))

    # Get R2 for generalized linear mixed effects model (lme4)
    rsquared(lme4::glmer(ypois ~ x1 + (1 | random), family = poisson, dat))

    rsquared(lme4::glmer(ypois ~ x1 + (1 | random), family = poisson, dat), method = "delta")

    # Get R2 for generalized linear mixed effects model (glmmPQL)
    rsquared(MASS::glmmPQL(ypois ~ x1, random = ~ 1 | random, family = poisson, dat))
    
    # Get R2 for generalized additive models (gam)
    rsquared(mgcv::gam(ynorm ~ x1, dat))
  
## End(Not run)

</code></pre>

<hr>
<h2 id='rsquared.gam'>R^2 for gam objects</h2><span id='topic+rsquared.gam'></span>

<h3>Description</h3>

<p>R^2 for gam objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.gam(model)
</code></pre>

<hr>
<h2 id='rsquared.glm'>R^2 for glm objects</h2><span id='topic+rsquared.glm'></span>

<h3>Description</h3>

<p>R^2 for glm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.glm(model, method = "nagelkerke")
</code></pre>

<hr>
<h2 id='rsquared.glmerMod'>R^2 for glmer objects</h2><span id='topic+rsquared.glmerMod'></span>

<h3>Description</h3>

<p>R^2 for glmer objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.glmerMod(model, method = "trigamma")
</code></pre>

<hr>
<h2 id='rsquared.glmmPQL'>R^2 for glmmPQL objects</h2><span id='topic+rsquared.glmmPQL'></span>

<h3>Description</h3>

<p>R^2 for glmmPQL objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.glmmPQL(model, method = "trigamma")
</code></pre>

<hr>
<h2 id='rsquared.gls'>R^2 for gls objects</h2><span id='topic+rsquared.gls'></span>

<h3>Description</h3>

<p>R^2 for gls objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.gls(model)
</code></pre>

<hr>
<h2 id='rsquared.lm'>R^2 for lm objects</h2><span id='topic+rsquared.lm'></span>

<h3>Description</h3>

<p>R^2 for lm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.lm(model)
</code></pre>

<hr>
<h2 id='rsquared.lme'>R^2 for lme objects</h2><span id='topic+rsquared.lme'></span>

<h3>Description</h3>

<p>R^2 for lme objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.lme(model)
</code></pre>

<hr>
<h2 id='rsquared.merMod'>R^2 for phylolm objects</h2><span id='topic+rsquared.merMod'></span>

<h3>Description</h3>

<p>R^2 for phylolm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.merMod(model)
</code></pre>

<hr>
<h2 id='rsquared.negbin'>R^2 for negbin objects</h2><span id='topic+rsquared.negbin'></span>

<h3>Description</h3>

<p>R^2 for negbin objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.negbin(model, method = "trigamma")
</code></pre>

<hr>
<h2 id='rsquared.Sarlm'>R^2 for Sarlm objects</h2><span id='topic+rsquared.Sarlm'></span>

<h3>Description</h3>

<p>R^2 for Sarlm objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rsquared.Sarlm(model)
</code></pre>

<hr>
<h2 id='scaleGLM'>Compute standard deviation or relevant range of response for GLMs</h2><span id='topic+scaleGLM'></span>

<h3>Description</h3>

<p>Compute standard deviation or relevant range of response for GLMs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleGLM(
  model,
  family.,
  link.,
  standardize = "scale",
  standardize.type = "latent.linear"
)
</code></pre>

<hr>
<h2 id='scaleInt'>Calculate standard deviation or relevant range for interaction terms</h2><span id='topic+scaleInt'></span>

<h3>Description</h3>

<p>Calculate standard deviation or relevant range for interaction terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scaleInt(model, newdata, standardize)
</code></pre>

<hr>
<h2 id='shipley'>Data set from Shipley (2006)</h2><span id='topic+shipley'></span>

<h3>Description</h3>

<p>Data set from Shipley (2006)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shipley
</code></pre>


<h3>Format</h3>

<p>A <code>data.frame</code> with 1900 observations of 9 variables.
</p>

<dl>
<dt>site</dt><dd><p>Site of observation</p>
</dd>
<dt>tree</dt><dd><p>Individual tree of observation</p>
</dd>
<dt>lat</dt><dd><p>Latitude</p>
</dd>
<dt>year</dt><dd><p>Year of observation</p>
</dd>
<dt>Date</dt><dd><p>Julian date of first bud burst</p>
</dd>
<dt>DD</dt><dd><p>Cumulative degree days until first bud burst</p>
</dd>
<dt>Growth</dt><dd><p>Increase in stem diameter</p>
</dd>
<dt>Survival</dt><dd><p>Proportional survival</p>
</dd>
<dt>Live</dt><dd><p>Alive (1) or dead (0)</p>
</dd>
</dl>


<hr>
<h2 id='sortDag'>Sort DAG based on ancestry</h2><span id='topic+sortDag'></span>

<h3>Description</h3>

<p>Sort DAG based on ancestry
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortDag(amat, formulaList)
</code></pre>

<hr>
<h2 id='specifyDir'>Remove duplicate items from the basis set whose direction is not a priori specified</h2><span id='topic+specifyDir'></span>

<h3>Description</h3>

<p>Remove duplicate items from the basis set whose direction is not a priori specified
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specifyDir(b, direction)
</code></pre>

<hr>
<h2 id='stdCoefs'>Calculate standardized regression coefficients</h2><span id='topic+stdCoefs'></span>

<h3>Description</h3>

<p>Calculate standardized regression coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stdCoefs(
  modelList,
  data = NULL,
  standardize = "scale",
  standardize.type = "latent.linear",
  test.statistic = "F",
  test.type = "II",
  intercepts = FALSE
)
</code></pre>

<hr>
<h2 id='stop_psem'>Stop function for unsupported methods</h2><span id='topic+stop_psem'></span>

<h3>Description</h3>

<p>Stop function for unsupported methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stop_psem(x)
</code></pre>

<hr>
<h2 id='stripTransformations'>Strip transformations</h2><span id='topic+stripTransformations'></span>

<h3>Description</h3>

<p>Strip transformations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>stripTransformations(x)
</code></pre>

<hr>
<h2 id='summary.psem'>Summarizing piecewise structural equation models</h2><span id='topic+summary.psem'></span>

<h3>Description</h3>

<p>Returns information necessary to interpret piecewise structural equation
models, including tests of directed separation, path coefficients,
information criterion values, and R-squared values of individual models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
summary(
  object,
  ...,
  basis.set = NULL,
  direction = NULL,
  interactions = FALSE,
  conserve = FALSE,
  conditioning = FALSE,
  add.claims = NULL,
  standardize = "scale",
  standardize.type = "latent.linear",
  test.statistic = "F",
  test.type = "II",
  intercepts = FALSE,
  AIC.type = "loglik",
  .progressBar = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.psem_+3A_object">object</code></td>
<td>
<p>a list of structural equations</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_...">...</code></td>
<td>
<p>additional arguments to summary</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_basis.set">basis.set</code></td>
<td>
<p>an optional basis set</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_direction">direction</code></td>
<td>
<p>a vector of claims defining the specific directionality of any independence 
claim(s)</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_interactions">interactions</code></td>
<td>
<p>whether interactions should be included in independence claims. 
Default is FALSE</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_conserve">conserve</code></td>
<td>
<p>whether the most conservative P-value should be returned (See Details) 
Default is FALSE</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_conditioning">conditioning</code></td>
<td>
<p>whether all conditioning variables should be shown in the table
Default is FALSE</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_add.claims">add.claims</code></td>
<td>
<p>an optional vector of additional independence claims (P-values) 
to be added to the basis set</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_standardize">standardize</code></td>
<td>
<p>whether standardized path coefficients should be reported 
Default is &quot;scale&quot;</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_standardize.type">standardize.type</code></td>
<td>
<p>the type of standardized for non-Gaussian responses: 
<code>latent.linear</code> (default), <code>Mendard.OE</code></p>
</td></tr>
<tr><td><code id="summary.psem_+3A_test.statistic">test.statistic</code></td>
<td>
<p>the type of test statistic generated by <code><a href="car.html#topic+Anova">Anova</a></code></p>
</td></tr>
<tr><td><code id="summary.psem_+3A_test.type">test.type</code></td>
<td>
<p>the type of test (&quot;II&quot; or &quot;III&quot;) for significance of categorical
variables (from <code>car::Anova</code>)</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_intercepts">intercepts</code></td>
<td>
<p>whether intercepts should be included in the coefficient  table
Default is FALSE</p>
</td></tr>
<tr><td><code id="summary.psem_+3A_aic.type">AIC.type</code></td>
<td>
<p>whether the log-likelihood <code>"loglik"</code> or d-sep <code>"dsep"</code> AIC score 
should be reported. Default is <code>"loglik"</code></p>
</td></tr>
<tr><td><code id="summary.psem_+3A_.progressbar">.progressBar</code></td>
<td>
<p>an optional progress bar. Default is TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The forthcoming argument <code>groups</code> splits the analysis based on an optional grouping
factor, conducts separate d-sep tests, and reports goodness-of-fit and path
coefficients for each submodel. The procedure is approximately similar to a
multigroup analysis in traditional variance-covariance SEM. Coming in version 2.1.
</p>
<p>In cases involving non-normally distributed responses in the independence
claims that are modeled using generalized linear models, the significance of
the independence claim is not reversible (e.g., the P-value of Y ~ X is not
the same as X ~ Y). This is due to the transformation of the response via
the link function. In extreme cases, this can bias the goodness-of-fit
tests. <code>summary.psem</code> will issue a warning when this case is present
and provide guidance for solutions. One solution is to specify the
directionality of the relationship using the <code>direction</code> argument, e.g.
<code>direction = c("X &lt;- Y")</code>. Another is to run both tests (Y ~ X, X ~ Y)
and return the most conservative (i.e., lowest) P-value, which can be
toggled using the <code>conserve = TRUE</code> argument.
</p>
<p>In some cases, additional claims that were excluded from the basis set can
be added back in using the argument <code>add.claims</code>. These could be, for
instance, independence claims among exogenous variables. See Details in
<code><a href="#topic+basisSet">basisSet</a></code>.
</p>
<p>Standardized path coefficients are scaled by standard deviations.
</p>


<h3>Value</h3>

<p>The function <code>summary.psem</code> returns a list of summary
statistics: </p>
<table role = "presentation">
<tr><td><code>dTable</code></td>
<td>
<p> A summary table of the tests of directed
separation, from <code><a href="#topic+dSep">dSep</a></code>.  </p>
</td></tr> <tr><td><code>CStat</code></td>
<td>
<p> Fisher's C statistic,
degrees of freedom, and significance value based on a Chi-square test.  </p>
</td></tr>
<tr><td><code>AIC</code></td>
<td>
<p> Information criterion (Akaike, corrected Akaike) as
well as degrees of freedom and sample size.  </p>
</td></tr> <tr><td><code>coefficients</code></td>
<td>
<p> A
summary table of the path coefficients, from <code>link{coefs}</code>.  </p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p> (Pseudo)-R2 values, from <code><a href="#topic+rsquared">rsquared</a></code>.  </p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Jon Lefcheck &lt;lefcheckj@si.edu&gt;
</p>


<h3>References</h3>

<p>Shipley, Bill. &quot;A new inferential test for path models based on
directed acyclic graphs.&quot; Structural Equation Modeling 7.2 (2000): 206-218.
</p>
<p>Shipley, Bill. Cause and correlation in biology: a user's guide to path
analysis, structural equations and causal inference. Cambridge University
Press, 2002.
</p>
<p>Shipley, Bill. &quot;Confirmatory path analysis in a generalized multilevel
context.&quot; Ecology 90.2 (2009): 363-368.
</p>
<p>Shipley, Bill. &quot;The AIC model selection method applied to path analytic
models compared using a d-separation test.&quot; Ecology 94.3 (2013): 560-564.
</p>


<h3>See Also</h3>

<p>The model fitting function <code><a href="#topic+psem">psem</a></code>.
</p>

<hr>
<h2 id='testBasisSetElements'>Evaluate conditional independence claim from the basis set</h2><span id='topic+testBasisSetElements'></span>

<h3>Description</h3>

<p>Evaluate conditional independence claim from the basis set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testBasisSetElements(i, b, modelList, data, conditioning, .progressBar, pb)
</code></pre>

<hr>
<h2 id='unstdCoefs'>Get raw (undstandardized) coefficients from model</h2><span id='topic+unstdCoefs'></span>

<h3>Description</h3>

<p>Get raw (undstandardized) coefficients from model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unstdCoefs(
  modelList,
  data = NULL,
  test.statistic = "F",
  test.type = "II",
  intercepts = FALSE
)
</code></pre>

<hr>
<h2 id='update.psem'>Update psem model object with additional values.</h2><span id='topic+update.psem'></span>

<h3>Description</h3>

<p>Update psem model object with additional values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'psem'
update(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="update.psem_+3A_object">object</code></td>
<td>
<p>a psem object</p>
</td></tr>
<tr><td><code id="update.psem_+3A_...">...</code></td>
<td>
<p>additional arguments to update</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>mod &lt;- psem(
lm(rich ~ cover, data = keeley),
lm(cover ~ firesev, data = keeley),
lm(firesev ~ age, data = keeley),
data = keeley
)

update(mod, firesev ~ age + cover)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
