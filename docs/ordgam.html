<!DOCTYPE html><html lang="en"><head><title>Help for package ordgam</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ordgam}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#centeredBasis.gen'><p>Generation of a recentered B-spline basis matrix in additive models</p></a></li>
<li><a href='#DesignFormula'><p>Internal function extracting design matrices from formulas in the DALSM function and computing penalty related matrices.</p></a></li>
<li><a href='#freehmsData'><p>Perception of gay men and lesbians in Wallonia, Belgium.</p></a></li>
<li><a href='#freehmsDataBE'><p>Perception of gay men and lesbians in Belgium.</p></a></li>
<li><a href='#lmarg.gammaTilde'><p>Marginal posterior density function for a remapped non-penalized parameter in an ordgam model</p></a></li>
<li><a href='#lpost.gamma'><p>Posterior density function for the non-penalized parameters in an ordgam model</p></a></li>
<li><a href='#ordgam'><p>Fit of an additive proportional odds model for ordinal data using Laplace approximations and P-splines</p></a></li>
<li><a href='#ordgam_additive'><p>Compute the additive terms estimated using an 'ordgam' model</p></a></li>
<li><a href='#ordgam.object'><p>Object resulting from the fit of an additive proportional odds model using 'ordgam'</p></a></li>
<li><a href='#ordregr'><p>Fit a proportional odds model for ordinal data</p></a></li>
<li><a href='#ordregr_lpost'><p>Log-posterior function for a proportional odds model</p></a></li>
<li><a href='#ordregr.object'><p>Object resulting from the fit of a proportional odds model using 'ordregr'</p></a></li>
<li><a href='#Pcal.fun'><p>Compute the penalty matrix associated to a vector containing fixed (non-penalized) parameters and equal-size sub-vectors of penalized spline parameters</p></a></li>
<li><a href='#plot.ordgam'><p>Plot the the additive terms in an &lt;ordgam&gt; object with its credible regions</p></a></li>
<li><a href='#print.ordregr'><p>Print an 'ordregr' or an 'ordgam' object.</p></a></li>
<li><a href='#s'><p>Specification of smooth terms in formulas in the ordgam function.</p></a></li>
<li><a href='#SNapprox'><p>Skew-Normal approximation to a density evaluated on a sparse grid</p></a></li>
<li><a href='#STapprox'><p>Skew-t approximation to a density evaluated on a sparse grid</p></a></li>
<li><a href='#testStat'><p>Significance test of an additive term</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Additive Model for Ordinal Data using Laplace P-Splines</td>
</tr>
<tr>
<td>Version:</td>
<td>0.9.1</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philippe Lambert &lt;p.lambert@uliege.be&gt;</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/plambertULiege/ordgam/issues">https://github.com/plambertULiege/ordgam/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Additive proportional odds model for ordinal data using Laplace P-splines. The combination of Laplace approximations and P-splines enable fast and flexible inference in a Bayesian framework. Specific approximations are proposed to account for the asymmetry in the marginal posterior distributions of non-penalized parameters. For more details, see Lambert and Gressani (2023) &lt;<a href="https://doi.org/10.1177%2F1471082X231181173">doi:10.1177/1471082X231181173</a>&gt; ; Preprint: &lt;<a href="https://doi.org/10.48550/arXiv.2210.01668">doi:10.48550/arXiv.2210.01668</a>&gt;).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td>&lt;<a href="https://github.com/plambertULiege/ordgam&amp;gt;">https://github.com/plambertULiege/ordgam&gt;</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>cubicBsplines, Matrix, mgcv, marqLevAlg, sn, MASS, numDeriv,
ucminf</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-09-13 11:26:17 UTC; plambert</td>
</tr>
<tr>
<td>Author:</td>
<td>Philippe Lambert <a href="https://orcid.org/0000-0002-3670-3328"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-09-14 09:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='centeredBasis.gen'>Generation of a recentered B-spline basis matrix in additive models</h2><span id='topic+centeredBasis.gen'></span>

<h3>Description</h3>

<p>Generation of a B-spline basis matrix with recentered columns
to handle the identifiability constraint in additive models. See Wood (CRC Press 2017, pp. 175-176) for more details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centeredBasis.gen(x, knots, cm = NULL, pen.order = 2, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centeredBasis.gen_+3A_x">x</code></td>
<td>
<p>vector of values where to compute the &quot;recentered&quot; B-spline basis</p>
</td></tr>
<tr><td><code id="centeredBasis.gen_+3A_knots">knots</code></td>
<td>
<p>vector of knots (that should cover the values in &lt;x&gt;)</p>
</td></tr>
<tr><td><code id="centeredBasis.gen_+3A_cm">cm</code></td>
<td>
<p>(Optional) values subtracted from each column of the original B-spline matrix</p>
</td></tr>
<tr><td><code id="centeredBasis.gen_+3A_pen.order">pen.order</code></td>
<td>
<p>penalty order for the B-spline parameters (Default: 2)</p>
</td></tr>
<tr><td><code id="centeredBasis.gen_+3A_verbose">verbose</code></td>
<td>
<p>verbose indicator (Default: TRUE)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing
</p>

<ul>
<li><p><code>B</code> : <code style="white-space: pre;">&#8288; &#8288;</code>centered B-spline matrix (with columns recentered to have mean 0 over equi-spaced x values on the range of the knots).
</p>
</li>
<li><p><code>Dd</code> : <code style="white-space: pre;">&#8288; &#8288;</code>difference matrix (of order &lt;pen.order&gt;) for the associated centered B-spline matrix.
</p>
</li>
<li><p><code>Pd</code> : <code style="white-space: pre;">&#8288; &#8288;</code>penalty matrix (of order &lt;pen.order&gt;) for the associated centered B-spline matrix.
</p>
</li>
<li><p><code>K</code> : <code style="white-space: pre;">&#8288; &#8288;</code>number of centered B-splines in the basis.
</p>
</li>
<li><p><code>cm</code> : <code style="white-space: pre;">&#8288; &#8288;</code>values subtracted from each column of the original B-spline matrix. By default, this is a vector containing the mean of each column in the original B-spline matrix.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x = seq(0,1,by=.01)
knots = seq(0,1,length=5)
obj = centeredBasis.gen(x,knots)
matplot(x,obj$B,type="l",ylab="Centered B-splines")
colMeans(obj$B)

</code></pre>

<hr>
<h2 id='DesignFormula'>Internal function extracting design matrices from formulas in the DALSM function and computing penalty related matrices.</h2><span id='topic+DesignFormula'></span>

<h3>Description</h3>

<p>Internal function extracting design matrices from formulas in the DALSM function and computing penalty related matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DesignFormula(
  formula,
  data,
  K = 10,
  pen.order = 2,
  knots.x = NULL,
  n = NULL,
  nointercept = FALSE,
  verbose = TRUE
)
</code></pre>

<hr>
<h2 id='freehmsData'>Perception of gay men and lesbians in Wallonia, Belgium.</h2><span id='topic+freehmsData'></span>

<h3>Description</h3>

<p>Data extracted from the European Social Survey (2018) conducted in
a series of European countries including Belgium and one of its three regions, Wallonia.
Each of the 552 participants (aged at least 15) was asked to react to the following statement,
&quot;Gay men and lesbians should be free to live their own life as they wish&quot;,
with a positioning on a Likert scale going from 1 (=Agree strongly) to 5 (=Disagree strongly),
with 3 labelled as Neither agree nor disagree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freehmsData)
</code></pre>


<h3>Format</h3>

<p>A data frame with 552 rows and 4 columns.
</p>

<dl>
<dt><code>freehms</code></dt><dd><p>Ordinal response (1: Agree strongly to 5: Disagree strongly).</p>
</dd>
<dt><code>age</code></dt><dd><p>Age of the respondent.</p>
</dd>
<dt><code>gndr</code></dt><dd><p>Gender of the respondent.</p>
</dd>
<dt><code>eduyrs</code></dt><dd><p>Number of years of education completed.</p>
</dd>
</dl>



<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>
<p>European Social Survey Round 9 Data (2018)
Data file edition 3.1. NSD - Norwegian Centre for Research Data, Norway.
</p>

<hr>
<h2 id='freehmsDataBE'>Perception of gay men and lesbians in Belgium.</h2><span id='topic+freehmsDataBE'></span>

<h3>Description</h3>

<p>Data extracted from the European Social Survey (2018) conducted in
a series of European countries including Belgium.
Each of the 1737 participants (aged at least 15) was asked to react to the following statement,
&quot;Gay men and lesbians should be free to live their own life as they wish&quot;,
with a positioning on a Likert scale going from 1 (=Agree strongly) to 5 (=Disagree strongly),
with 3 labelled as Neither agree nor disagree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(freehmsDataBE)
</code></pre>


<h3>Format</h3>

<p>A data frame with 1737 rows and 5 columns.
</p>

<dl>
<dt><code>freehms</code></dt><dd><p>Ordinal response (1: Agree strongly to 5: Disagree strongly).</p>
</dd>
<dt><code>gndr</code></dt><dd><p>Gender of the respondent.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age of the respondent.</p>
</dd>
<dt><code>eduyrs</code></dt><dd><p>Number of years of education completed.</p>
</dd>
<dt><code>region</code></dt><dd><p>Belgian region of residence: WAL (Wallonia), FL (Flanders) or BXL (Brussels).</p>
</dd>
</dl>



<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>
<p>European Social Survey Round 9 Data (2018)
Data file edition 3.1. NSD - Norwegian Centre for Research Data, Norway.
</p>

<hr>
<h2 id='lmarg.gammaTilde'>Marginal posterior density function for a remapped non-penalized parameter in an ordgam model</h2><span id='topic+lmarg.gammaTilde'></span>

<h3>Description</h3>

<p>Marginal posterior density function for a remapped non-penalized parameter in an ordgam model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmarg.gammaTilde(gamtk, k, model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmarg.gammaTilde_+3A_gamtk">gamtk</code></td>
<td>
<p>Remapped parameter value at which the marginal log posterior density for &lt;gamma.tilde[k]&gt; must be evaluated.</p>
</td></tr>
<tr><td><code id="lmarg.gammaTilde_+3A_k">k</code></td>
<td>
<p>Targetted component in the vector of remapped non-penalized parameters &lt;gamma.tilde&gt;.</p>
</td></tr>
<tr><td><code id="lmarg.gammaTilde_+3A_model">model</code></td>
<td>
<p>An <code><a href="#topic+ordgam.object">ordgam.object</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log of p(gamma.tilde[k] | lambda,data)
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordgam">ordgam</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ s(eduyrs) + s(age), data=freehmsData, descending=TRUE,
             lambda0=c(192,18),select.lambda=FALSE)
ngamma = with(mod, nalpha+nfixed) ## Number of non-penalized parms
k = 1 ## Focus on gamma.tilde[1]
x.grid = seq(-4,4,length=7) ## Grid of values for gamma.tilde[k]
lfy.grid = ordgam::lmarg.gammaTilde(x.grid,k=k,mod) ## log p(gamma.tilde[k] | D) on the grid
gamt.ST = ordgam::STapprox(x.grid,lfy.grid)$dp ## Approximate using a skew-t
## Plot the estimated marginal posterior for &lt;gamma.tilde[k]&gt;
xlab = bquote(tilde(gamma)[.(k)])
ylab = bquote(p(tilde(gamma)[.(k)]~ "|"~lambda~","~D))
xlim = sn::qst(c(.0001,.9999),dp=gamt.ST)
curve(sn::dst(x,dp=gamt.ST),xlim=xlim,
      xlab=xlab,ylab=ylab,col="blue",lwd=2,lty=1)

</code></pre>

<hr>
<h2 id='lpost.gamma'>Posterior density function for the non-penalized parameters in an ordgam model</h2><span id='topic+lpost.gamma'></span>

<h3>Description</h3>

<p>Posterior density function for the non-penalized parameters in an ordgam model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lpost.gamma(model)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lpost.gamma_+3A_model">model</code></td>
<td>
<p>An <code><a href="#topic+ordgam.object">ordgam.object</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Log joint posterior density function for the non-penalized regression parameters.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordgam">ordgam</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ s(eduyrs) + s(age), data=freehmsData, descending=TRUE)
print(mod$theta) ## Model regression parameters
gam.hat = mod$theta[1:4] ## Non-penalized parameter estimates
ordgam::lpost.gamma(mod)(gam.hat)

</code></pre>

<hr>
<h2 id='ordgam'>Fit of an additive proportional odds model for ordinal data using Laplace approximations and P-splines</h2><span id='topic+ordgam'></span>

<h3>Description</h3>

<p>Fit of an additive proportional odds model for ordinal data using Laplace approximations and P-splines
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordgam(
  formula,
  data,
  nc = NULL,
  K = 10,
  pen.order = 2,
  descending = TRUE,
  select.lambda = TRUE,
  lambda.family = "dgamma",
  lambda.optimizer = "nlminb",
  lprior.lambda = function(x) dgamma(x, 1, 1e-04, log = TRUE),
  theta0 = NULL,
  lambda0 = NULL,
  ci.level = 0.95,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordgam_+3A_formula">formula</code></td>
<td>
<p>A model formula</p>
</td></tr>
<tr><td><code id="ordgam_+3A_data">data</code></td>
<td>
<p>A data frame containing a column 'y' with the ordinal response (taking integer values) besides the covariates.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_nc">nc</code></td>
<td>
<p>(optional) Number of categories for the ordinal response.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_k">K</code></td>
<td>
<p>Number of B-splines to model each additive term (Default: 10).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_pen.order">pen.order</code></td>
<td>
<p>Penalty order (Default: 2).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_descending">descending</code></td>
<td>
<p>Logical indicating if the odds of the response taking a value in the upper scale should be preferred over values in the lower scale (Default: TRUE).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_select.lambda">select.lambda</code></td>
<td>
<p>Logical indicating if the penalty parameters should be tuned (Default: TRUE).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_lambda.family">lambda.family</code></td>
<td>
<p>Prior for &lt;lambda&gt;. Possible choices are &quot;none&quot;, &quot;dgamma&quot;, &quot;BetaPrime&quot; or &quot;myprior&quot; for a user specified function for the prior of &lt;lambda&gt;.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_lambda.optimizer">lambda.optimizer</code></td>
<td>
<p>Algorithm used to maximize p(lambda|data). Possible choices are &quot;nlminb&quot;,&quot;ucminf&quot;,&quot;nlm&quot;,&quot;LevMarq&quot; (Default: &quot;nlminb&quot;).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_lprior.lambda">lprior.lambda</code></td>
<td>
<p>Log of the prior density for a &lt;lambda&gt; component if <code>lambda.family</code> set to &quot;myprior&quot;.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_theta0">theta0</code></td>
<td>
<p>(Optional) Vector containing starting values for the regression parameters.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_lambda0">lambda0</code></td>
<td>
<p>Vector of penalty parameters for the additive terms (Default: 10 for each additive term).</p>
</td></tr>
<tr><td><code id="ordgam_+3A_ci.level">ci.level</code></td>
<td>
<p>Confidence levels of the computed credible intervals for the regression parameters.</p>
</td></tr>
<tr><td><code id="ordgam_+3A_verbose">verbose</code></td>
<td>
<p>Verbose mode (logical)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of type <code><a href="#topic+ordgam.object">ordgam.object</a></code>.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordregr">ordregr</a></code>, <code><a href="#topic+ordgam.object">ordgam.object</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ gndr + s(eduyrs) + s(age),
             data=freehmsData, descending=TRUE)
print(mod)
plot(mod)

</code></pre>

<hr>
<h2 id='ordgam_additive'>Compute the additive terms estimated using an 'ordgam' model</h2><span id='topic+ordgam_additive'></span>

<h3>Description</h3>

<p>Compute the additive terms estimated using an 'ordgam' model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordgam_additive(obj.ordgam, ngrid = 300, ci.level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordgam_additive_+3A_obj.ordgam">obj.ordgam</code></td>
<td>
<p>An object of class 'ordgam'.</p>
</td></tr>
<tr><td><code id="ordgam_additive_+3A_ngrid">ngrid</code></td>
<td>
<p>Number of grid points where the additive terms are computed.</p>
</td></tr>
<tr><td><code id="ordgam_additive_+3A_ci.level">ci.level</code></td>
<td>
<p>Credibility level for the pointwise credible region for the additive terms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing:
</p>

<ul>
<li><p><code>nalpha</code> : <code style="white-space: pre;">&#8288; &#8288;</code>number of intercepts in the proportional odds model.
</p>
</li>
<li><p><code>nfixed</code> : <code style="white-space: pre;">&#8288; &#8288;</code>number of non-penalized regression parameters in 'beta'.
</p>
</li>
<li><p><code>J</code> : <code style="white-space: pre;">&#8288; &#8288;</code>number of additive terms.
</p>
</li>
<li><p><code>additive.lab</code> : <code style="white-space: pre;">&#8288; &#8288;</code>labels of the additive terms.
</p>
</li>
<li><p><code>K</code> : <code style="white-space: pre;">&#8288; &#8288;</code>number of spline parameters to specify an additive term.
</p>
</li>
<li><p><code>knots</code> : <code style="white-space: pre;">&#8288; &#8288;</code>list of length J containing the knots for the B-spline basis associated to a given additive term.
</p>
</li>
<li><p><code>f.grid</code> : <code style="white-space: pre;">&#8288; &#8288;</code>list of length J with, for each additive term, a list of length 2 with 'x': a vector of grid values for the covariate ; 'y.mat': a matrix with 3 columns (est,low,up) giving the additive term and its pointwise credible region
</p>
</li>
<li><p><code>f</code> : <code style="white-space: pre;">&#8288; &#8288;</code>a list of length J with, for each additive term &lt;x&gt;, a list with f$x: a function computing the additive term f(x) for a given covariate value 'x' ; attributes(f$x): support, label, range.
</p>
</li>
<li><p><code>f.se</code> : <code style="white-space: pre;">&#8288; &#8288;</code>a list of length J with, for each additive term &lt;x&gt;, a list with f.se$x: a function computing the s.e. of f(x) for a given covariate value 'x' ; attributes(f.se$x): support, label, range
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ gndr + s(eduyrs) + s(age),
             data=freehmsData, descending=TRUE)
obj = ordgam_additive(mod)
names(obj)
with(obj$f.grid$age,
      matplot(x, y.mat, lty=c(1,2,2),type="l",col=1,
              xlab="Age", ylab="f(Age)"))

</code></pre>

<hr>
<h2 id='ordgam.object'>Object resulting from the fit of an additive proportional odds model using 'ordgam'</h2><span id='topic+ordgam.object'></span>

<h3>Description</h3>

<p>An object returned by the <code><a href="#topic+ordgam">ordgam</a></code> function: this is a list
with various components related to the fit of such a model.
</p>


<h3>Value</h3>

<p>An <code>ordgam</code> object is a list with following elements:
</p>

<ul>
<li><p><code>val</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at convergence.
</p>
</li>
<li><p><code>val.start</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at the start of the Newton-Raphson (N-R) algorithm.
</p>
</li>
<li><p><code>theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>(Penalized) MLE or MAP of the regression coefficients.
</p>
</li>
<li><p><code>grad</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Gradient of the log-posterior at <code>theta</code>.
</p>
</li>
<li><p><code>Hessian</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian of the log-posterior at <code>theta</code>.
</p>
</li>
<li><p><code>iter</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of iterations of the N-R algorithm.
</p>
</li>
<li><p><code>llik</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Multinomial log likelihood.
</p>
</li>
<li><p><code>Hessian0</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian of the (non-penalized) log-likelihood at <code>theta</code>.
</p>
</li>
<li><p><code>Sigma.theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Variance-covariance of 'theta'.
</p>
</li>
<li><p><code>ED.full</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Effective degrees of freedom associated to each regression parameter, penalized parameters included.
</p>
</li>
<li><p><code>se.theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Standard errors of the regression coefficents.
</p>
</li>
<li><p><code>theta.mat</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Matrix containing the point estimate, standard error, credible interval, Z-score and P-value for <code>theta</code>.
</p>
</li>
<li><p><code>nc</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of categories for the ordinal response.
</p>
</li>
<li><p><code>nalpha</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of intercepts in the proportional odds model (=<code>nc</code>-1) .
</p>
</li>
<li><p><code>nbeta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of regression parameters (intercepts excluded).
</p>
</li>
<li><p><code>nfixed</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of non-penalized regression parameters.
</p>
</li>
<li><p><code>ci.level</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Nominal coverage of the credible intervals (Default: .95).
</p>
</li>
<li><p><code>n</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Sample size.
</p>
</li>
<li><p><code>call</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Function call.
</p>
</li>
<li><p><code>descending</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Logical indicating if the odds of the response taking a value in the upper scale should be preferred over values in the lower scale.
</p>
</li>
<li><p><code>use.prior</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Logical indicating if a prior (such as a penalty) is assumed for the regression parameters.
</p>
</li>
<li><p><code>lpost</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at convergence.
</p>
</li>
<li><p><code>levidence</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Log of the marginal likelihood (also named 'evidence').
</p>
</li>
<li><p><code>AIC</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Aikake information criterion: AIC = -2 logLik + 2 x edf where edf stands for the effective degrees of freedom.
</p>
</li>
<li><p><code>BIC</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Schwarz information criterion: BIC = -2 logLik + n x log(edf) where edf stands for the effective degrees of freedom.
</p>
</li>
<li><p><code>y</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Vector containing the values of the ordinal response.
</p>
</li>
<li><p><code>regr</code> : <code style="white-space: pre;">&#8288; &#8288;</code>List created by the internal function <code>DesignFormula</code> and containing diverse objects associated to the model specification, including the part of the design matrix 'X' associated to regressors and its extended version 'Xcal' with B-spline bases for additive term.
</p>
</li>
<li><p><code>ED.Chi2</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Matrix containing the Effective Degrees of Freedom associated to the additive terms with their respective significance Chi2 test and P-value.
</p>
</li>
<li><p><code>ED.Tr</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Matrix containing the Effective Degrees of Freedom associated to the additive terrms with their respective significance &lt;Tr&gt; test (described by S. Wood, Biometrika 2013) and P-value.
</p>
</li>
<li><p><code>lpost.fun</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Function with arguments (theta,lambda,gradient=TRUE,Hessian=TRUE) computing the log-posterior for given regression (and possibly spline) parameters <code>theta</code> and vector of penalty parameters <code>lambda</code> associated to the additive terms. Gradient and Hessian are also computed if requested.
</p>
</li>
<li><p><code>lambda0</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Initial values for the vector of penalty parameters. Its length corresponds to the number of additive terms.
</p>
</li>
<li><p><code>lambda</code> : <code style="white-space: pre;">&#8288; &#8288;</code>(Selected) vector of penalty parameters. Its length corresponds to the number of additive terms.
</p>
</li>
<li><p><code>select.lambda</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Logical indicating if <code>lambda</code> should be selected by maximizing the marginal likelihood or its marginal posterior.
</p>
</li>
<li><p><code>lambda.family</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Chosen prior for <code>lambda</code>: possible choices are &quot;none&quot;, &quot;dgamma&quot; (i.e. dgamma(1,1e-4)), &quot;BetaPrime&quot; (BetaPrime(.5,.5)) or &quot;myprior&quot; (with log of the prior density function in <code>myprior</code>). When &quot;none&quot; is selected, the marginal likelihood is directly maximized.
</p>
</li>
<li><p><code>lprior.lambda</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Log of the prior density for the penalty parameters <code>lambda</code> when <code>select.lambda</code> is TRUE.
</p>
</li>
<li><p><code>loglambda.loss</code> : <code style="white-space: pre;">&#8288; &#8288;</code>The function of <code>log(lambda)</code> that is minimized to select <code>lambda</code>. It is minus the log marginal likelihood (when <code>lambda.family</code> is &quot;none&quot;) or minus the log of the marginal posterior for <code>lambda</code> otherwise.
</p>
</li>
<li><p><code>nu.lpost</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Function giving the log of the marginal posterior density of <code>nu=log(lambda)</code>.
</p>
</li>
<li><p><code>nu.hat</code> : <code style="white-space: pre;">&#8288; &#8288;</code>The mode of the marginal posterior density <code>nu.lpost</code> for <code>nu=log(lambda)</code>.
</p>
</li>
<li><p><code>V.nu</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Variance of the marginal posterior for <code>nu=log(lambda)</code>.
</p>
</li>
<li><p><code>se.nu</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Standard error of <code>nu=log(lambda)</code>, i.e. the square-root of the diagonal elements of <code>V.nu</code>.
</p>
</li>
<li><p><code>nu.dp</code> : <code style="white-space: pre;">&#8288; &#8288;</code>List containing the parameters of the skew-t approximation to the marginal posterior of <code>nu[j]=loglambda[j]</code> associated to each of the <code>J</code> additive terms.
</p>
</li>
<li><p><code>formula</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Formula used during the model specification.
</p>
</li>
<li><p><code>elapsed.time</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Elapsed time.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordgam">ordgam</a></code>, <code><a href="#topic+print.ordregr">print.ordregr</a></code>, <code><a href="#topic+plot.ordgam">plot.ordgam</a></code>
</p>

<hr>
<h2 id='ordregr'>Fit a proportional odds model for ordinal data</h2><span id='topic+ordregr'></span>

<h3>Description</h3>

<p>Fit a proportional odds model for ordinal data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordregr(
  y,
  nc = NULL,
  Xcal = Xcal,
  descending = FALSE,
  prior = list(mean = NULL, Prec = NULL),
  theta0 = NULL,
  ci.level = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordregr_+3A_y">y</code></td>
<td>
<p>Vector containing the ordinal response (coded using integers in 1:nc).</p>
</td></tr>
<tr><td><code id="ordregr_+3A_nc">nc</code></td>
<td>
<p>(optional) Maximum value of <code>y</code>.</p>
</td></tr>
<tr><td><code id="ordregr_+3A_xcal">Xcal</code></td>
<td>
<p>Design matrix (excluding intercept columns).</p>
</td></tr>
<tr><td><code id="ordregr_+3A_descending">descending</code></td>
<td>
<p>Logical indicating if the odds of the response taking a value in the upper scale should be preferred over values in the lower scale.</p>
</td></tr>
<tr><td><code id="ordregr_+3A_prior">prior</code></td>
<td>
<p>(optional) List giving the 'mean' and 'Prec'(ision) of the regression parameters.</p>
</td></tr>
<tr><td><code id="ordregr_+3A_theta0">theta0</code></td>
<td>
<p>(Optional) Vector containing starting values for the regression parameters.</p>
</td></tr>
<tr><td><code id="ordregr_+3A_ci.level">ci.level</code></td>
<td>
<p>Confidence levels of the computed credible intervals for the regression parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <a href="#topic+ordregr.object">ordregr.object</a>.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordgam">ordgam</a></code>, <code><a href="#topic+ordregr.object">ordregr.object</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
Xcal = with(freehmsData, cbind(gndr,eduyrs,age))
mod = ordregr(y=freehmsData$freehms, Xcal=Xcal, descending=TRUE)
print(mod)

</code></pre>

<hr>
<h2 id='ordregr_lpost'>Log-posterior function for a proportional odds model</h2><span id='topic+ordregr_lpost'></span>

<h3>Description</h3>

<p>Log-posterior function for a proportional odds model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ordregr_lpost(
  y,
  nc,
  Xcal,
  theta,
  descending = FALSE,
  prior = list(mean = NULL, Prec = NULL),
  gradient = TRUE,
  Hessian = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ordregr_lpost_+3A_y">y</code></td>
<td>
<p>Vector containing the ordinal response (coded using integers in 1:nc).</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_nc">nc</code></td>
<td>
<p>(optional) Maximum value of <code>y</code>.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_xcal">Xcal</code></td>
<td>
<p>Design matrix.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_theta">theta</code></td>
<td>
<p>Vector c(alpha,beta) with intercepts &lt;alpha&gt; and regression parameters &lt;beta&gt;.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_descending">descending</code></td>
<td>
<p>Logical indicating if the odds of the response taking a value in the upper scale should be preferred over values in the lower scale.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_prior">prior</code></td>
<td>
<p>(optional) List given the mean and Prec(ision) of the regression parameters.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_gradient">gradient</code></td>
<td>
<p>Logical indicating if the gradient of the log-posterior should be computed.</p>
</td></tr>
<tr><td><code id="ordregr_lpost_+3A_hessian">Hessian</code></td>
<td>
<p>Logical indicating if the Hessian of the log-posterior should be computed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The log-posterior with the following attributes:
</p>

<ul>
<li><p><code>Salpha</code> : <code style="white-space: pre;">&#8288; &#8288;</code>gradient wrt intercepts 'alpha'.
</p>
</li>
<li><p><code>Sbeta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>gradient wrt regression parameters 'beta'.
</p>
</li>
<li><p><code>grad</code> : <code style="white-space: pre;">&#8288; &#8288;</code>gradient wrt  c(alpha,beta).
</p>
</li>
<li><p><code>Halpha</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian wrt intercepts 'alpha'.
</p>
</li>
<li><p><code>Hbeta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian wrt regression parameters 'beta'.
</p>
</li>
<li><p><code>Hba</code> : <code style="white-space: pre;">&#8288; &#8288;</code>cross-derivatives (Hessian) submatrix wrt 'alpha' &amp; 'beta'.
</p>
</li>
<li><p><code>Hessian</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian wrt c(alpha,beta).
</p>
</li>
<li><p><code>dtheta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>step in a Newton-Raphson iteration: solve(-Hessian,grad).
</p>
</li></ul>



<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>

<hr>
<h2 id='ordregr.object'>Object resulting from the fit of a proportional odds model using 'ordregr'</h2><span id='topic+ordregr.object'></span>

<h3>Description</h3>

<p>An object returned by the <code><a href="#topic+ordregr">ordregr</a></code> function: this is a list
with various components related to the fit of such a model.
</p>


<h3>Value</h3>

<p>A <code>ordregr</code> object is a list with  following elements:
</p>

<ul>
<li><p><code>val</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at convergence.
</p>
</li>
<li><p><code>val.start</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at the start of the Newton-Raphson (N-R) algorithm.
</p>
</li>
<li><p><code>theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>(Penalized) MLE or MAP of the regression coefficients.
</p>
</li>
<li><p><code>grad</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Gradient of the log-posterior at <code>theta</code>.
</p>
</li>
<li><p><code>Hessian</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian of the log-posterior at <code>theta</code>.
</p>
</li>
<li><p><code>iter</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of iterations of the N-R algorithm.
</p>
</li>
<li><p><code>Hessian0</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Hessian of the (non-penalized) log-likelihood at <code>theta</code>.
</p>
</li>
<li><p><code>Sigma.theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Variance-covariance of 'theta'.
</p>
</li>
<li><p><code>ED.full</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Effective degrees of freedom associated to each regression parameter, penalized parameters included.
</p>
</li>
<li><p><code>se.theta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Standard errors of the regression coefficents.
</p>
</li>
<li><p><code>theta.mat</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Matrix containing the point estimate, standard error, credible interval, Z-score and P-value for <code>theta</code>.
</p>
</li>
<li><p><code>nc</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of categories for the ordinal response.
</p>
</li>
<li><p><code>nalpha</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of intercepts in the proportional odds model (=<code>nc</code>-1) .
</p>
</li>
<li><p><code>nbeta</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of regression parameters (intercepts excluded).
</p>
</li>
<li><p><code>nfixed</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Number of non-penalized regression parameters.
</p>
</li>
<li><p><code>ci.level</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Nominal coverage of the credible intervals (Default: .95).
</p>
</li>
<li><p><code>n</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Sample size.
</p>
</li>
<li><p><code>call</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Function call.
</p>
</li>
<li><p><code>descending</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Logical indicating if the odds of the response taking a value in the upper scale should be preferred over values in the lower scale.
</p>
</li>
<li><p><code>use.prior</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Logical indicating if a prior (such as a penalty) is assumed for the regression parameters.
</p>
</li>
<li><p><code>lpost</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the log-posterior at convergence.
</p>
</li>
<li><p><code>levidence</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Log of the marginal likelihood (also named 'evidence').
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordregr">ordregr</a></code>, <code><a href="#topic+print.ordregr">print.ordregr</a></code>
</p>

<hr>
<h2 id='Pcal.fun'>Compute the penalty matrix associated to a vector containing fixed (non-penalized) parameters and equal-size sub-vectors of penalized spline parameters</h2><span id='topic+Pcal.fun'></span>

<h3>Description</h3>

<p>Compute the penalty matrix associated to a vector containing fixed (non-penalized) parameters and equal-size sub-vectors of penalized spline parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Pcal.fun(nfixed, lambda, Pd.x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Pcal.fun_+3A_nfixed">nfixed</code></td>
<td>
<p>the number of fixed (i.e. non-penalized) parameters</p>
</td></tr>
<tr><td><code id="Pcal.fun_+3A_lambda">lambda</code></td>
<td>
<p>a vector of <code>J</code> penalty parameters where each component is associated to a sub-vector of spline parameters of length <code>K</code></p>
</td></tr>
<tr><td><code id="Pcal.fun_+3A_pd.x">Pd.x</code></td>
<td>
<p>a penalty matrix of size <code>J</code> associated to a given sub-vector of spline parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A block diagonal penalty matrix of size <code>(nfixed+JK)</code> given by Blockdiag(diag(0,<code>nfixed</code>), diag(<code>lambda</code>).kron.<code>Pd.x</code>)
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Dd = diff(diag(1,5),diff=2) ## Difference penalty matrix for a vector of length 5
Pd = t(Dd) %*% Dd ## Penalty matrix of order 2
nfixed = 2 ## 2 unpenalized parameters
## Global penalty matrix when 2 unpenalized parameters and 2 additive terms with
##   2 vectors of 5 P-splines coefficients with lambda values 10 and 100 respectively.
Pcal.fun(nfixed=2,lambda=c(10,100),Pd)
</code></pre>

<hr>
<h2 id='plot.ordgam'>Plot the the additive terms in an &lt;ordgam&gt; object with its credible regions</h2><span id='topic+plot.ordgam'></span>

<h3>Description</h3>

<p>Plot the the additive terms in an object generated by <code>ordgam</code> with its credible regions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ordgam'
plot(x,ngrid=300,ci.level=.95,mfrow=NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ordgam_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+ordgam.object">ordgam.object</a> generated by <a href="#topic+ordgam">ordgam</a>.</p>
</td></tr>
<tr><td><code id="plot.ordgam_+3A_ngrid">ngrid</code></td>
<td>
<p>An integer indicating the number of gridpoints where the additive terms should be evaluated.</p>
</td></tr>
<tr><td><code id="plot.ordgam_+3A_ci.level">ci.level</code></td>
<td>
<p>Credibility level for the pointwise credible region of the additive terms.</p>
</td></tr>
<tr><td><code id="plot.ordgam_+3A_mfrow">mfrow</code></td>
<td>
<p>(Optional) A vector of the form c(nr, nc). Subsequent figures will be drawn in an nr-by-nc array on the device by rows.</p>
</td></tr>
<tr><td><code id="plot.ordgam_+3A_...">...</code></td>
<td>
<p>Additional generic plotting arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>In addition to the plots, an invisible object containing information on the estimated additive terms is returned, see the <code>ordgam_additive</code> function documentation for more details.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordgam">ordgam</a></code>, <code><a href="#topic+ordgam.object">ordgam.object</a></code>, <code>ordgam.additive</code>, <code><a href="#topic+print.ordregr">print.ordregr</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ gndr + s(eduyrs) + s(age),
             data=freehmsData, descending=TRUE)
print(mod)
plot(mod)

</code></pre>

<hr>
<h2 id='print.ordregr'>Print an 'ordregr' or an 'ordgam' object.</h2><span id='topic+print.ordregr'></span>

<h3>Description</h3>

<p>Print a summary of the information contained in an <code><a href="#topic+ordregr.object">ordregr.object</a></code> or <code><a href="#topic+ordgam.object">ordgam.object</a></code> generated by <code><a href="#topic+ordregr">ordregr</a></code> or <code><a href="#topic+ordgam">ordgam</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ordregr'
print(x, expEst, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ordregr_+3A_x">x</code></td>
<td>
<p>An <a href="#topic+ordregr.object">ordregr.object</a> generated by <a href="#topic+ordregr">ordregr</a> or <a href="#topic+ordgam">ordgam</a>.</p>
</td></tr>
<tr><td><code id="print.ordregr_+3A_expest">expEst</code></td>
<td>
<p>Logical indicating if the exponential of the regression coefficients should be printed (Default: TRUE)</p>
</td></tr>
<tr><td><code id="print.ordregr_+3A_...">...</code></td>
<td>
<p>Possible additional printing options.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Print summary statistics.
</p>


<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ordregr">ordregr</a></code>, <code><a href="#topic+ordgam">ordgam</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)
data(freehmsData)
mod = ordgam(freehms ~ gndr + s(eduyrs) + s(age),
             data=freehmsData, descending=TRUE)
print(mod)
plot(mod)

</code></pre>

<hr>
<h2 id='s'>Specification of smooth terms in formulas in the ordgam function.</h2><span id='topic+s'></span>

<h3>Description</h3>

<p>Specification of smooth terms in formulas in the ordgam function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>s(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="s_+3A_x">x</code></td>
<td>
<p>Name of the variable for which an additive term is requested</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The submitted variable for which an additive term is required
</p>

<hr>
<h2 id='SNapprox'>Skew-Normal approximation to a density evaluated on a sparse grid</h2><span id='topic+SNapprox'></span>

<h3>Description</h3>

<p>Skew-Normal approximation to a density evaluated on a sparse grid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SNapprox(x, lfx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SNapprox_+3A_x">x</code></td>
<td>
<p>Vector containing a grid of values on the density support and covering the posterior mode.</p>
</td></tr>
<tr><td><code id="SNapprox_+3A_lfx">lfx</code></td>
<td>
<p>Log density values on the grid <code>x</code> (possibly up to an additive constant)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li><p><code>dp</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Parameters of the approximating skew-Normal density.
</p>
</li>
<li><p><code>fitted.moments</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Mean, variance, skewness, kurtosis of the approximating skew-Normal.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+STapprox">STapprox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)

## Density to be approximated by a Skew-Normal
dtarget = function(x) dgamma(x,10,2)
curve(dtarget(x),0,15,lwd=2,ylab="Density")

## Values of the target density on a sparse grid
ngrid = 6 ## Sparse grid size
xgrid = seq(2,8,length=ngrid) ## Grid
lfx = log(dtarget(xgrid)) ## Log values

## Skew-Normal approximation
dp = ordgam::SNapprox(xgrid,lfx)$dp
curve(sn::dsn(x,dp=dp),add=TRUE,lwd=2,lty=2,col=2)
points(xgrid,exp(lfx))
legend("topright",legend=c("Target density","Skew-Normal approx."),
       col=1:2,lty=1:2,lwd=2,bty="n")#' library(ordgam)
</code></pre>

<hr>
<h2 id='STapprox'>Skew-t approximation to a density evaluated on a sparse grid</h2><span id='topic+STapprox'></span>

<h3>Description</h3>

<p>Skew-t approximation to a density evaluated on a sparse grid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STapprox(x, lfx)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="STapprox_+3A_x">x</code></td>
<td>
<p>Vector containing a grid of values on the density support and covering the posterior mode.</p>
</td></tr>
<tr><td><code id="STapprox_+3A_lfx">lfx</code></td>
<td>
<p>Log density values on the grid <code>x</code> (possibly up to an additive constant)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li><p><code>dp</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Parameters of the approximating skew-t density.
</p>
</li>
<li><p><code>fitted.moments</code> : <code style="white-space: pre;">&#8288; &#8288;</code>Mean, variance, skewness, kurtosis of the approximating skew-t.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Philippe Lambert <a href="mailto:p.lambert@uliege.be">p.lambert@uliege.be</a>
</p>


<h3>References</h3>

<p>Lambert, P. and Gressani, 0. (2023) Penalty parameter selection and asymmetry corrections
to Laplace approximations in Bayesian P-splines models. Statistical Modelling. &lt;doi:10.1177/1471082X231181173&gt;. Preprint: &lt;arXiv:2210.01668&gt;.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+SNapprox">SNapprox</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(ordgam)

## Density to be approximated by a Skew-t
dtarget = function(x) dgamma(x,10,2)
curve(dtarget(x),0,15,lwd=2,ylab="Density")

## Values of the target density on a sparse grid
ngrid = 6 ## Sparse grid size
xgrid = seq(2,8,length=ngrid) ## Grid
lfx = log(dtarget(xgrid)) ## Log values

## Skew-t approximation
dp = ordgam::STapprox(xgrid,lfx)$dp
curve(sn::dst(x,dp=dp),add=TRUE,lwd=2,lty=2,col=2)
points(xgrid,exp(lfx))
legend("topright",legend=c("Target density","Skew-t approx."),
       col=1:2,lty=1:2,lwd=2,bty="n")

</code></pre>

<hr>
<h2 id='testStat'>Significance test of an additive term</h2><span id='topic+testStat'></span>

<h3>Description</h3>

<p>Significance test of an additive term relying on the methodology
in Wood (Biometrika 2013). It is extracted from a hidden function
in the 'mgcv' package. The additive term is estimated using the product of a matrix &lt;X&gt; and a vector &lt;p&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testStat(p, X, V, rank = NULL, type = 0, res.df = -1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="testStat_+3A_p">p</code></td>
<td>
<p>Vector of spline parameters used to estimate f(x)</p>
</td></tr>
<tr><td><code id="testStat_+3A_x">X</code></td>
<td>
<p>(Centered) B-spline basis evaluated on a fine regular grid on the support of variable &lt;x&gt;</p>
</td></tr>
<tr><td><code id="testStat_+3A_v">V</code></td>
<td>
<p>Posterior variance-covariance matrix of parameter &lt;p&gt;</p>
</td></tr>
<tr><td><code id="testStat_+3A_rank">rank</code></td>
<td>
<p>Effective dimension of &lt;p&gt;</p>
</td></tr>
<tr><td><code id="testStat_+3A_type">type</code></td>
<td>
<p>0 value by default</p>
</td></tr>
<tr><td><code id="testStat_+3A_res.df">res.df</code></td>
<td>
<p>-1 indicates that the scale is fixed (cf. ordinal response)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list with following elements:
</p>

<ul>
<li><p>stat : <code style="white-space: pre;">&#8288; &#8288;</code>Value of the test statistics
</p>
</li>
<li><p>pval : <code style="white-space: pre;">&#8288; &#8288;</code>P-value of the test for the null hypothesis Ho: p=0
</p>
</li>
<li><p>rank : <code style="white-space: pre;">&#8288; &#8288;</code>Effective dimension of &lt;p&gt;
</p>
</li></ul>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
