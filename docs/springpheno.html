<!DOCTYPE html><html lang="en"><head><title>Help for package springpheno</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {springpheno}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BatonRouge'>
<p>Example Data for use with springpheno package.</p></a></li>
<li><a href='#calc_si'>
<p>Spring Index Calculator</p></a></li>
<li><a href='#chilldate'>
<p>Chill Date Calculator</p></a></li>
<li><a href='#chillh'>
<p>Chill Hours Calculator</p></a></li>
<li><a href='#damageindex'>
<p>Damage Index Calculator</p></a></li>
<li><a href='#daylength'>
<p>Daylength Calculator</p></a></li>
<li><a href='#falsesprings'>
<p>False Spring Indicators</p></a></li>
<li><a href='#freezedates'>
<p>Freeze Date Calculator</p></a></li>
<li><a href='#FSEI'>
<p>False Spring Exposure Index</p></a></li>
<li><a href='#growdh'>
<p>Growing Degree Hours Calculator</p></a></li>
<li><a href='#lat'>
<p>Latitude</p></a></li>
<li><a href='#leafindex'>
<p>Leaf Index Calculator</p></a></li>
<li><a href='#soldec'>
<p>Solar Declination Determination</p></a></li>
<li><a href='#synval'>
<p>Synoptic Event Identifier</p></a></li>
<li><a href='#TMAX'>
<p>Daily High Temperature data</p></a></li>
<li><a href='#TMIN'>
<p>Daily Low Temperature data</p></a></li>
<li><a href='#YEAR'>
<p>Years of the Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Spring Phenological Indices</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Adrienne M. Wootten (University of Oklahoma)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Adrienne M. Wootten &lt;amwootte@ou.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the extended spring indices (SI-x) and false spring 
    exposure indices (FSEI). The SI-x indices are standard indices used for 
    analysis in spring phenology studies. In addition, the FSEI is also from 
    research on the climatology of false springs and adjusted to include an 
    early and late false spring exposure index. The indices  include the 
    first leaf index, first bloom index, and false spring exposure indices, 
    along with all calculations for all functions needed to calculate 
    each index. The main function returns all indices, but each function can 
    also be run separately. 
    Allstadt et al. (2015) &lt;<a href="https://doi.org/10.1088%2F1748-9326%2F10%2F10%2F104008">doi:10.1088/1748-9326/10/10/104008</a>&gt; 
    Ault et al. (2015) &lt;<a href="https://doi.org/10.1016%2Fj.cageo.2015.06.015">doi:10.1016/j.cageo.2015.06.015</a>&gt; 
    Peterson and Abatzoglou (2014) &lt;<a href="https://doi.org/10.1002%2F2014GL059266">doi:10.1002/2014GL059266</a>&gt;
    Schwarz et al. (2006) &lt;<a href="https://doi.org/10.1111%2Fj.1365-2486.2005.01097.x">doi:10.1111/j.1365-2486.2005.01097.x</a>&gt; 
    Schwarz et al. (2013) &lt;<a href="https://doi.org/10.1002%2Fjoc.3625">doi:10.1002/joc.3625</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-10 15:44:22 UTC; casc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-11 08:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BatonRouge'>
Example Data for use with springpheno package.
</h2><span id='topic+BatonRouge'></span>

<h3>Description</h3>

<p>Example data for use with the springpheno package. Includes high temperatures,
low temperatures, latitude for Baton Rouge, LA along with the years of data
available in the example dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("BatonRouge")</code></pre>


<h3>Format</h3>

<p>Two matrices, a scalar, and a vector
</p>

<dl>
<dt><code>TMAX</code></dt><dd><p>a numeric matrix</p>
</dd>
<dt><code>TMIN</code></dt><dd><p>a numeric matrix</p>
</dd>
<dt><code>lat</code></dt><dd><p>a numeric scalar</p>
</dd>
<dt><code>YEAR</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>TMAX contains daily high temperature (degF) for Baton Rouge, LA from 1981-2005
TMIN contains daily low temperature (degF) for Baton Rouge, LA from 1981-2005
lat is the latitude of Baton Rouge, LA
YEAR is the vector of years 1981-2005
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BatonRouge)
## maybe str(BatonRouge) ; plot(BatonRouge) ...
</code></pre>

<hr>
<h2 id='calc_si'>
Spring Index Calculator
</h2><span id='topic+calc_si'></span>

<h3>Description</h3>

<p>Given the multiple years of daily high and low temperatures and the latitude for the location, this function will calculate the extended spring indices (SI-x, Schwarz et al. 2006; Schwarz et al. 2013), false spring indicators, and the early and late false spring exposure indices (EFSEI, LFSEI, Peterson and Abatzoglou, 2014; Allstadt et al. 2015). The extended spring indices are calculated in a similar manner to Ault et al. (2015) with the correction implemented as suggested by Allstadt et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_si(TMAX, TMIN, lat,missingcalc="mean")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_si_+3A_tmax">TMAX</code></td>
<td>

<p>Matrix - daily high temperatures (degrees Fahrenheit). This is matrix of 366 rows (on per each day of year) and N columns (representing the total number of years). There should always be 366 days supplied to this function, as the SI-x will calculate a replacement for missing values and leap days during non-leap years.
</p>
</td></tr>
<tr><td><code id="calc_si_+3A_tmin">TMIN</code></td>
<td>

<p>Matix - daily low temperatures (degrees Fahrenheit). This should be the same size and structure as TMAX.
</p>
</td></tr>
<tr><td><code id="calc_si_+3A_lat">lat</code></td>
<td>

<p>Scalar - latitude of the location of interest in decimal degrees.
</p>
</td></tr>
<tr><td><code id="calc_si_+3A_missingcalc">missingcalc</code></td>
<td>

<p>Scalar - character which signifies which approach will be taken to address missing values. The current options are &quot;mean&quot; (default) and &quot;loess&quot;. The &quot;mean&quot; option means that calc_si will use the monthly mean to replace missing values which appear during the same month. The &quot;loess&quot; option means that calc_si will use a loess regression to estimate missing temperature values.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>While each individual function in the springpheno package can be run
independently, the calc_si function does wrap through all the associated
functions in the springpheno package and produce results from all functions.
</p>


<h3>Value</h3>

<p>The output is a list containing the following:
</p>
<table role = "presentation">
<tr><td><code>FLImat</code></td>
<td>

<p>Matrix - First Leaf Index (FLI). This is a matrix of N rows (one row per year) by 4 columns. The 4 columns correspond to the mean first leaf and the first leaf for plants 1-3 [mean,plant 1, plant 2, plant 3]
</p>
</td></tr>
<tr><td><code>FBImat</code></td>
<td>

<p>Matrix - First Bloom Index (FBI). This is a matrix of N rows (one row per year) by 4 columns. The 4 columns correspond to the mean first bloom and the first bloom for plants 1-3 [mean,plant 1, plant 2, plant 3]
</p>
</td></tr>
<tr><td><code>DMGmat</code></td>
<td>

<p>Matrix - Damage Index (days). This is a matrix of N rows (one row per year) by 4 columns. The 4 columns correspond to the mean damage index and the damage index for plants 1-3 [mean,plant 1, plant 2, plant 3]
</p>
</td></tr>
<tr><td><code>lastfreeze</code></td>
<td>

<p>Vector - Day of Last Spring Freeze. This is a vector of length N years holding the last spring freeze for each year of data supplied to calc_is
</p>
</td></tr>
<tr><td><code>FSmat</code></td>
<td>

<p>Matrix - False Spring Indicators. This is a matrix of N rows (one row per year) by 2 columns. The two columns represent each of the false spring indicators [early false spring, late false spring]. A value of 1 in either column represents that a false spring occurred. A value of 0 represents that a false spring did not occur.
</p>
</td></tr>
<tr><td><code>FSEImat</code></td>
<td>

<p>Vector - False Spring Exposure Index. This is a vector of length 2. There is one value of FSEI each for the early and late false springs. [early FSEI, late FSEI].
</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Thresholds for base temperature (baset=31) and freezing temperature (frzval=28) are fixed in this code. This matches Ault et al. (2015), but it could be changed to an extra argument for this function in later versions.
</p>
<p>FSmat and FSEImat are current calculated using the first values of FLImat and FBImat. This is also consistent with prior code, but could be altered to provide the FSmat and FSEImat based on all four values of FLImat and FBImat.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Allstadt, A.J., S.J. Vavrus, P.J. Heglund, A.M Pidgeon, W. E. Thogmartin and V.C. Radeloff, 2015: Spring plant
phenology and false springs in the conterminous US during the 21st century. Environmental Research Letters,
10, DOI: 10.1088/1748-9326/10/10/104008
</p>
<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily
meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>
<p>Peterson, A.G. and J.T. Abatzoglou, 2014: Observed changes in false springs over the contiguous United States.
Geophysical Research Letters, 41, DOI: 10.1002/2014GL059266
</p>
<p>Schwarz, M., R. Ahas and A. Aasa, 2006: Onset of spring starting earlier across the Northern Hemisphere, 12,
DOI: 10.1111/j.1365-2486.2005.01097.x
</p>
<p>Schwarz, M., T.R. Ault and J.L. Betancourt, 2013: Spring onset variations and trends in the continental United
States: Past and regional assessment using temperature-based indices. International Journal of Climatology,
33, DOI: 10.1002/joc.3625
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BatonRouge")
RESULTS = calc_si(TMAX,TMIN,lat) # calc_si runs all SI-x calculations

####
# Plotting First Leaf Index
oldpar &lt;- par(mfrow = c(1,1))
ylimrange = range(RESULTS$FLImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FLImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting First Bloom Index
ylimrange = range(RESULTS$FBImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FBImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting Day of Last Freeze
ylimrange = range(RESULTS$lastfreeze)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$lastfreeze~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting False Springs
ylimrange = range(RESULTS$FSmat)
ylimrange[2]=ylimrange[2]+0.5
par(mfrow=c(2,1))
plot(RESULTS$FSmat[,1]~YEAR,type="b",pch=19,ylim=ylimrange)
plot(RESULTS$FSmat[,2]~YEAR,type="b",pch=19,ylim=ylimrange)

par(oldpar)

</code></pre>

<hr>
<h2 id='chilldate'>
Chill Date Calculator
</h2><span id='topic+chilldate'></span>

<h3>Description</h3>

<p>This function calculates the estimated day of the calendar year where the chill requirement is met for each of the three plants used in the extended spring indices (SI-x, Schwarz et al. 2006; 2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chilldate(tasmax, tasmin, DOY, daylen, baset, plant = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chilldate_+3A_tasmax">tasmax</code></td>
<td>

<p>Vector - daily high temperatures for a given year
</p>
</td></tr>
<tr><td><code id="chilldate_+3A_tasmin">tasmin</code></td>
<td>

<p>Vector - daily low temperatures for a given year
</p>
</td></tr>
<tr><td><code id="chilldate_+3A_doy">DOY</code></td>
<td>

<p>Vector - day of year values for a given year (1:365 or 1:366 depending on calendar)
</p>
</td></tr>
<tr><td><code id="chilldate_+3A_daylen">daylen</code></td>
<td>

<p>Vector - day lengths for each day for a given year (calculated from daylength function).
</p>
</td></tr>
<tr><td><code id="chilldate_+3A_baset">baset</code></td>
<td>

<p>Scalar  - base temperature for determining chill hours. Typically this is 44.96 degrees Fahrenheit, but can be plant specific.
</p>
</td></tr>
<tr><td><code id="chilldate_+3A_plant">plant</code></td>
<td>

<p>Plant type 1 (default), 2, or 3. plant = 1 for lilac, plant = 2 for arnold red, or plant =3 for zabelli.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>chillDOY - scalar, estimated day of year the chill requirement for the specified plant is met.
</p>


<h3>Note</h3>

<p>Many questions regarding how this is calculated, use this function at your own risk.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Schwarz, M., R. Ahas and A. Aasa, 2006: Onset of spring starting earlier across the Northern Hemisphere, 12, DOI: 10.1111/j.1365-2486.2005.01097.x
</p>
<p>Schwarz, M., T.R. Ault and J.L. Betancourt, 2013: Spring onset variations and trends in the continental United States: Past and regional assessment using temperature-based indices. International Journal of Climatology, 33, DOI: 10.1002/joc.3625
</p>

<hr>
<h2 id='chillh'>
Chill Hours Calculator
</h2><span id='topic+chillh'></span>

<h3>Description</h3>

<p>This function calculates the chill hours for a given day and plant given the high and low temperature, plant base temperature, and day length (from the daylength function). Still in development, but based on Schwarz et al. (2006 and 2013)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chillh(tmax, tmin, daylen, baset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="chillh_+3A_tmax">tmax</code></td>
<td>

<p>Scalar - daily high temperature in degrees Fahrenheit
</p>
</td></tr>
<tr><td><code id="chillh_+3A_tmin">tmin</code></td>
<td>

<p>Scalar - daily low temperature in degrees Fahrenheit
</p>
</td></tr>
<tr><td><code id="chillh_+3A_daylen">daylen</code></td>
<td>

<p>Scalar - day length in hours
</p>
</td></tr>
<tr><td><code id="chillh_+3A_baset">baset</code></td>
<td>

<p>Scalar - base temperature for determining chill hours. Typically this is 44.96 degrees Fahrenheit, but can be plant specific.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>CHOUR - total chill hours for a given day. That is, number of hours the temperature fell below baset.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Schwarz, M., R. Ahas and A. Aasa, 2006: Onset of spring starting earlier across the Northern Hemisphere, 12, DOI: 10.1111/j.1365-2486.2005.01097.x
</p>
<p>Schwarz, M., T.R. Ault and J.L. Betancourt, 2013: Spring onset variations and trends in the continental United States: Past and regional assessment using temperature-based indices. International Journal of Climatology, 33, DOI: 10.1002/joc.3625
</p>


<h3>Examples</h3>

<pre><code class='language-R'> daystop &lt;- 366
lat &lt;- 35.476 # latitude for OKC
daylen &lt;- daylength(daystop=daystop,lat=lat)

tmax &lt;- 65
tmin &lt;- 42
dlen &lt;- daylen[60]
bt &lt;- 44.96

result &lt;- chillh(tmax,tmin,dlen,bt)

</code></pre>

<hr>
<h2 id='damageindex'>
Damage Index Calculator
</h2><span id='topic+damageindex'></span>

<h3>Description</h3>

<p>This function calculates the damage index (Schwarz et al. 2006, Schwarz et al. 2013) given the first leaf index (FLI) and day of year for the last spring freeze. This is based on the calculation done in the original Matlab code base (Ault et al. 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>damageindex(leafidx, lastfreeze)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="damageindex_+3A_leafidx">leafidx</code></td>
<td>

<p>Scalar - FLI value from the leafindex function. It's recommended to use the average, but one could also use the FLI for the individual plants.
</p>
</td></tr>
<tr><td><code id="damageindex_+3A_lastfreeze">lastfreeze</code></td>
<td>

<p>Scalar - day of year of the last spring freeze.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a scalar with the value of the damage index. The damage index is effectively the difference between the FLI and the last freeze. Negative values are converted to zero as no damage occurs if the last freeze is before the first leaf.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily
meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>
<p>Schwarz, M., R. Ahas and A. Aasa, 2006: Onset of spring starting earlier across the Northern Hemisphere, 12,
DOI: 10.1111/j.1365-2486.2005.01097.x
</p>
<p>Schwarz, M., T.R. Ault and J.L. Betancourt, 2013: Spring onset variations and trends in the continental United
States: Past and regional assessment using temperature-based indices. International Journal of Climatology,
33, DOI: 10.1002/joc.3625
</p>

<hr>
<h2 id='daylength'>
Daylength Calculator
</h2><span id='topic+daylength'></span>

<h3>Description</h3>

<p>The function daylength will calculate the day length for a given for all days of the year up to the user defined day of the year and latitude of the location. Essentially this is the number of hours of daylight for given location for each day. The formula for day length calculation is retained from Ault et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>daylength(daystop, lat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="daylength_+3A_daystop">daystop</code></td>
<td>

<p>Scalar - Calendar day of year from 1 to 366 where the function should cease day length calculations
</p>
</td></tr>
<tr><td><code id="daylength_+3A_lat">lat</code></td>
<td>

<p>Scalar - latitude of the locations, in decimal degrees
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>DAYLEN - vector of length equal to input daystop describing the total hours of daylight per day.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daystop &lt;- 366
lat &lt;- 35.476 # latitude for OKC
result &lt;- daylength(daystop=daystop,lat=lat)
</code></pre>

<hr>
<h2 id='falsesprings'>
False Spring Indicators
</h2><span id='topic+falsesprings'></span>

<h3>Description</h3>

<p>Given the information about the first leaf, first bloom, and freeze events, this function determines if an early false spring and late false spring occurred. The calculations here are based on the work of Peterson and Abatzoglou (2014) and Allstadt et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>falsesprings(SI = c(60, 65), freezedata)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="falsesprings_+3A_si">SI</code></td>
<td>

<p>Vector - the first leaf index (FLI) and first bloom index (FBI) in a vector. The FLI should always be the first item in the vector. Defaults to 60 and 65, but these are randomly chosen and should be replaced with values calculated by leafindex.
</p>
</td></tr>
<tr><td><code id="falsesprings_+3A_freezedata">freezedata</code></td>
<td>

<p>Data frame - table of low temperatures, day of year, and adjusted day of year for all the freeze days of a given year. This is calculated by the freezedates function.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a list with two items:
</p>
<table role = "presentation">
<tr><td><code>EFS</code></td>
<td>

<p>Scalar - Early False Spring indicator. This equals 1 if an early false spring occurred, 0 otherwise.
</p>
</td></tr>
<tr><td><code>LFS</code></td>
<td>

<p>Scalar - Late False Spring indicator. This equals 1 if a late false spring occurred, 0 otherwise.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Allstadt, A.J., S.J. Vavrus, P.J. Heglund, A.M Pidgeon, W. E. Thogmartin and V.C. Radeloff, 2015: Spring plant
phenology and false springs in the conterminous US during the 21st century. Environmental Research Letters,
10, DOI: 10.1088/1748-9326/10/10/104008
</p>
<p>Peterson, A.G. and J.T. Abatzoglou, 2014: Observed changes in false springs over the contiguous United States.
Geophysical Research Letters, 41, DOI: 10.1002/2014GL059266
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BatonRouge")
RESULTS = calc_si(TMAX,TMIN,lat) # calc_si runs all SI-x calculations

####
# Plotting First Leaf Index
oldpar &lt;- par(mfrow = c(1,1))
ylimrange = range(RESULTS$FLImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FLImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting First Bloom Index
ylimrange = range(RESULTS$FBImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FBImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting Day of Last Freeze
ylimrange = range(RESULTS$lastfreeze)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$lastfreeze~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting False Springs
ylimrange = range(RESULTS$FSmat)
ylimrange[2]=ylimrange[2]+0.5
par(mfrow=c(2,1))
plot(RESULTS$FSmat[,1]~YEAR,type="b",pch=19,ylim=ylimrange)
plot(RESULTS$FSmat[,2]~YEAR,type="b",pch=19,ylim=ylimrange)

par(oldpar)

</code></pre>

<hr>
<h2 id='freezedates'>
Freeze Date Calculator
</h2><span id='topic+freezedates'></span>

<h3>Description</h3>

<p>This function determines when freezes occur during the year given the daily low temperature data, freeze threshold, and the day of year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>freezedates(tasmin, frzval, DOY)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="freezedates_+3A_tasmin">tasmin</code></td>
<td>

<p>Vector - daily low temperature data (degrees Fahrenheit). The vector should have a length of 366.
</p>
</td></tr>
<tr><td><code id="freezedates_+3A_frzval">frzval</code></td>
<td>

<p>Scalar - freeze threshold (degrees Fahrenheit). Typically this is 28F.
</p>
</td></tr>
<tr><td><code id="freezedates_+3A_doy">DOY</code></td>
<td>

<p>Vector - day of year (1:366)
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output from this function is a list with the following:
</p>
<table role = "presentation">
<tr><td><code>firstfreeze</code></td>
<td>

<p>Scalar - day of year matching the first freeze that occurs in the fall.
</p>
</td></tr>
<tr><td><code>lastfreeze</code></td>
<td>

<p>Scalar - day of year matching the last freeze that occurs in the spring.
</p>
</td></tr>
<tr><td><code>freezeperiod</code></td>
<td>

<p>Scalar - range of days between the first and last freeze.
</p>
</td></tr>
<tr><td><code>freezedata</code></td>
<td>

<p>Data Frame - Table containing the values for low temperature (tasmin), Day of year (DOY), and adjusted Day of Year (DOYadj) for those days of the year where a freeze occurs.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>

<hr>
<h2 id='FSEI'>
False Spring Exposure Index
</h2><span id='topic+FSEI'></span>

<h3>Description</h3>

<p>Given the false spring indicators for multiple years, this function calculate the False Spring Exposure Index (FSEI). This is calculated according to the methodology of Peterson and Abatzoglou (2014). If early false spring indicators are provided, then this function calculates the FSEI for the early false spring. Providing the late false spring indicators will allow the function to calculate the FSEI for the late false spring.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FSEI(falsespringvector)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="FSEI_+3A_falsespringvector">falsespringvector</code></td>
<td>

<p>Vector - the false spring indicators for multiple years. This forms a vector of length N, for the N years used. This can be either early or late false spring indicators.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a scalar with the value of the FSEI. The larger the value, the more like the location will be exposed to a false spring.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Allstadt, A.J., S.J. Vavrus, P.J. Heglund, A.M Pidgeon, W. E. Thogmartin and V.C. Radeloff, 2015: Spring plant
phenology and false springs in the conterminous US during the 21st century. Environmental Research Letters,
10, DOI: 10.1088/1748-9326/10/10/104008
</p>
<p>Peterson, A.G. and J.T. Abatzoglou, 2014: Observed changes in false springs over the contiguous United States.
Geophysical Research Letters, 41, DOI: 10.1002/2014GL059266
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BatonRouge")
RESULTS = calc_si(TMAX,TMIN,lat) # calc_si runs all SI-x calculations

####
# Plotting First Leaf Index
oldpar &lt;- par(mfrow = c(1,1))
ylimrange = range(RESULTS$FLImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FLImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting First Bloom Index
ylimrange = range(RESULTS$FBImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FBImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting Day of Last Freeze
ylimrange = range(RESULTS$lastfreeze)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$lastfreeze~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting False Springs
ylimrange = range(RESULTS$FSmat)
ylimrange[2]=ylimrange[2]+0.5
par(mfrow=c(2,1))
plot(RESULTS$FSmat[,1]~YEAR,type="b",pch=19,ylim=ylimrange)
plot(RESULTS$FSmat[,2]~YEAR,type="b",pch=19,ylim=ylimrange)

par(oldpar)

</code></pre>

<hr>
<h2 id='growdh'>
Growing Degree Hours Calculator
</h2><span id='topic+growdh'></span>

<h3>Description</h3>

<p>Given appropriate inputs, this function calculates the growing degree hours for a given day and locations. The formula is also retained from the original Matlab code for the extended spring indices (SI-x, Ault et al. 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>growdh(tmax, tmin, daylen, baset)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="growdh_+3A_tmax">tmax</code></td>
<td>

<p>Scalar - daily high temperature (degrees Fahrenheit) for a given day
</p>
</td></tr>
<tr><td><code id="growdh_+3A_tmin">tmin</code></td>
<td>

<p>Scalar - daily low temperature (degrees Fahrenheit) for a given day
</p>
</td></tr>
<tr><td><code id="growdh_+3A_daylen">daylen</code></td>
<td>

<p>Scalar - day length for a given day (calculated from daylength function)
</p>
</td></tr>
<tr><td><code id="growdh_+3A_baset">baset</code></td>
<td>

<p>Scalar - base temperature for determining growing degree hours. Typically this 31 degrees Fahrenheit
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>GDHOUR - scalar, total growing degree hours for a given day.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>daystop &lt;- 366
lat &lt;- 35.476 # latitude for OKC
daylen &lt;- daylength(daystop=daystop,lat=lat)

tmax &lt;- 65
tmin &lt;- 42
dlen &lt;- daylen[60]
bt &lt;- 31

result &lt;- growdh(tmax,tmin,dlen,bt)

</code></pre>

<hr>
<h2 id='lat'>
Latitude
</h2><span id='topic+lat'></span>

<h3>Description</h3>

<p>lat is a scalar that is the user provided latitude for the location of interest (deg N).
Example latitude is available if one calls data(&quot;BatonRouge&quot;)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>TMIN</code></td>
<td>
<p> - a numeric scalar</p>
</td></tr>
</table>

<hr>
<h2 id='leafindex'>
Leaf Index Calculator
</h2><span id='topic+leafindex'></span>

<h3>Description</h3>

<p>This function calculates either the First Leaf Index (FLI) or the First Bloom Index (FBI). The calculation of the FLI and FBI follows that described by the original Matlab code (Ault et al. 2015) with the correction implemented by Allstadt et al. (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>leafindex(tasmax, tasmin, daylen, baset, refdate,
type = "leaf", plant = 1, verbose = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="leafindex_+3A_tasmax">tasmax</code></td>
<td>

<p>Vector - daily high temperatures for a given year (degrees F)
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_tasmin">tasmin</code></td>
<td>

<p>Vector - daily low temperatures for a given year (degrees F)
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_daylen">daylen</code></td>
<td>

<p>Vector - daylength for each day for a given year (recommended from the daylength function)
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_baset">baset</code></td>
<td>

<p>Scalar - base temperature for growing degree hours calculation (Typically this is 31 degrees F)
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_refdate">refdate</code></td>
<td>

<p>Scalar - reference day of year at which to begin calculations. For the FLI, refdate should equal 1. For the FBI, refdate should equal the FLI.
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_type">type</code></td>
<td>

<p>Either &quot;leaf&quot; (default) or &quot;bloom&quot; to calculate the FLI or FBI respectively.
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_plant">plant</code></td>
<td>

<p>Scalar - a value of 1 (default), 2, or 3 to match the appropriate plant for the FLI. For plant=1, the plant is lilac. For plant=2, the plant is arnold red. For plant=3, the plant is zabelli
</p>
</td></tr>
<tr><td><code id="leafindex_+3A_verbose">verbose</code></td>
<td>

<p>Logical - either TRUE or FALSE (default). If set to TRUE, the function will print more information. Helpful for debugging issues.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If verbose=FALSE, then the output is the day of year corresponding to first leaf or first bloom depending on the user inputs.
if verbose=TRUE, then the output is a list with the following:
</p>
<table role = "presentation">
<tr><td><code>OUTDOY</code></td>
<td>

<p>Scalar - day of year corresponding to first leaf or first bloom depending on the user inputs.
</p>
</td></tr>
<tr><td><code>parametersout</code></td>
<td>

<p>Matrix - values for all the parameters used in the calculation of FLI and FBI. This matrix is 366 rows by 6 columns. The 366 rows correspond to each day of year. Values will exist in the table from the reference date (refdate) to the day of first leaf or first bloom. Values are NA otherwise. The columns correspond to each of the following parameters, 1) number of days since the reference date, 2) total number of accumulated synoptic events, 3) sum of growing degree hours for the current day and previous two days, 4) sum of growing degree hours for 5-7 days prior to the current day, 5) accumulated growing degree hours, 6) growing degree hours for the current day.
</p>
</td></tr>
<tr><td><code>lagGDHvals</code></td>
<td>

<p>Matrix - values of lag growing degree hours for 1-7 days prior to the current day. This is 366 rows by 7 columns. One row for each day of the year, one column for each lag of growing degree hours (column 1 is a lag of 1 day, column 7 is a lag of 7 days).
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Allstadt, A.J., S.J. Vavrus, P.J. Heglund, A.M Pidgeon, W. E. Thogmartin and V.C. Radeloff, 2015: Spring plant
phenology and false springs in the conterminous US during the 21st century. Environmental Research Letters,
10, DOI: 10.1088/1748-9326/10/10/104008
</p>
<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily
meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("BatonRouge")
RESULTS = calc_si(TMAX,TMIN,lat) # calc_si runs all SI-x calculations

####
# Plotting First Leaf Index
oldpar &lt;- par(mfrow = c(1,1))
ylimrange = range(RESULTS$FLImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FLImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting First Bloom Index
ylimrange = range(RESULTS$FBImat)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$FBImat[,1]~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting Day of Last Freeze
ylimrange = range(RESULTS$lastfreeze)
ylimrange[1]=ylimrange[1]-10
ylimrange[2]=ylimrange[2]+10
plot(RESULTS$lastfreeze~YEAR,type="b",pch=19,lwd=2,ylim=ylimrange)

#####
# Plotting False Springs
ylimrange = range(RESULTS$FSmat)
ylimrange[2]=ylimrange[2]+0.5
par(mfrow=c(2,1))
plot(RESULTS$FSmat[,1]~YEAR,type="b",pch=19,ylim=ylimrange)
plot(RESULTS$FSmat[,2]~YEAR,type="b",pch=19,ylim=ylimrange)

par(oldpar)

</code></pre>

<hr>
<h2 id='soldec'>
Solar Declination Determination
</h2><span id='topic+soldec'></span>

<h3>Description</h3>

<p>Retains the legacy calculation for the solar declination from the Ault et al. (2015) Matlab code. This returns the day of year based on the start of climatological spring, meant for use with the function daylength. That is, a DOY=1 is March 1. The function itself uses the calendar day of the year (from 1-366).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>soldec(DOY)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="soldec_+3A_doy">DOY</code></td>
<td>

<p>Scalar - day of year from 1 to 366.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Scalar - Spring climatological calendar day of year for the location and calendar day of year matching the appropriate solar declination angle.
</p>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doy &lt;- 45
result &lt;- soldec(doy)
</code></pre>

<hr>
<h2 id='synval'>
Synoptic Event Identifier
</h2><span id='topic+synval'></span>

<h3>Description</h3>

<p>This function identifies if a given period is a synoptic warm event which would help trigger plant growth. This function requires the growing degree hours for the current day and the growing degree hours for the prior seven days. Finally, this function will calculate if a period will trigger growth for first leaf or first bloom. The formulas for this calculation are based on the original Matlab code for the extended spring indices (SI-x, Ault et al. 2015)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>synval(GDH, lagGDH, type = "leaf")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="synval_+3A_gdh">GDH</code></td>
<td>

<p>Scalar - growing degree hours for a given day
</p>
</td></tr>
<tr><td><code id="synval_+3A_laggdh">lagGDH</code></td>
<td>

<p>Vector - growing degree hours for the 7 previous days. Must be a vector of at least a length 7 or the function will throw an error.
</p>
</td></tr>
<tr><td><code id="synval_+3A_type">type</code></td>
<td>

<p>Either leaf (default) to identify events contributing to first leaf, or bloom to identify events contributing to first bloom.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is a list with the following:
</p>
<table role = "presentation">
<tr><td><code>synflag</code></td>
<td>

<p>Scalar - synoptic event flag. Has a value of 1 if a synoptic event happened, value of 0 otherwise.
</p>
</td></tr>
<tr><td><code>dde2</code></td>
<td>

<p>Scalar - sum of growing degree hours for current day and previous two days.
</p>
</td></tr>
<tr><td><code>dd57</code></td>
<td>

<p>Scalar - sum of growing degree hours 5-7 prior to current day.
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adrienne M. Wootten (University of Oklahoma)
</p>


<h3>References</h3>

<p>Ault, T.R., R. Zurita-Miller and M. Schwarz, 2015: A Matlab© toolbox for calculating spring indices from daily meteorological data. Computers and Geosciences, 83, DOI: 10.1016/j.cageo.2015.06.015
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
daystop &lt;- 240
lat &lt;- 35.476 # latitude for OKC
daylen &lt;- daylength(daystop=daystop,lat=lat)

tmax &lt;- rep(65,daystop)
tmin &lt;- rep(42,daystop)
bt &lt;- 31

gdh &lt;- c()

for(i in 1:daystop){
gdh[i] &lt;- growdh(tmax[i],tmin[i],daylen[i],bt)
}

idx &lt;- 60
lagidx &lt;- idx - 1:7

laggdh &lt;- gdh[lagidx]

result &lt;- synval(gdh[idx],laggdh,type="leaf")

</code></pre>

<hr>
<h2 id='TMAX'>
Daily High Temperature data
</h2><span id='topic+TMAX'></span>

<h3>Description</h3>

<p>TMAX is a user provided matrix of daily high temperatures (deg F). The matrix should be
366 rows (366 days) by as many years as desired in columns. Example high temperature
data is available if one calls data(&quot;BatonRouge&quot;)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>TMAX</code></td>
<td>
<p> - a numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='TMIN'>
Daily Low Temperature data
</h2><span id='topic+TMIN'></span>

<h3>Description</h3>

<p>TMIN is a user provided matrix of daily low temperatures (deg F). The matrix should be
366 rows (366 days) by as many years as desired in columns. Example low temperature
data is available if one calls data(&quot;BatonRouge&quot;)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>TMIN</code></td>
<td>
<p> - a numeric matrix</p>
</td></tr>
</table>

<hr>
<h2 id='YEAR'>
Years of the Data
</h2><span id='topic+YEAR'></span>

<h3>Description</h3>

<p>YEAR is a user provided vector of the years in the TMAX and TMIN data used with calc_si.
YEAR is not used in the calc_si (or any internal functions), but it is used for
plotting the results in the example code.
Example of YEAR is available if one calls data(&quot;BatonRouge&quot;)
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>YEAR</code></td>
<td>
<p> - a numeric vector</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
