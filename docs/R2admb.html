<!DOCTYPE html><html lang="en"><head><title>Help for package R2admb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {R2admb}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#R2admb-package'><p>ADMB to R interface functions</p></a></li>
<li><a href='#admb_version'><p>Query ADMB version</p></a></li>
<li><a href='#AIC.admb'><p>Standard accessor functions for ADMB model fits</p></a></li>
<li><a href='#compile_admb'><p>Compile ADMB files, run, read output</p></a></li>
<li><a href='#do_admb'><p>Compile and/or run an ADMB model, collect output</p></a></li>
<li><a href='#extract_gradient'><p>Extract gradients</p></a></li>
<li><a href='#find_large_cor'><p>Find large correlations</p></a></li>
<li><a href='#mcmc.control'><p>Control options for MCMC after ADMB fitting</p></a></li>
<li><a href='#plot.admb_hist'><p>Plot MCMC histogram</p></a></li>
<li><a href='#read_pars'><p>Read in parameters from an AD Model Builder run</p></a></li>
<li><a href='#read_plt'><p>Read in ADMB profile file</p></a></li>
<li><a href='#run.control'><p>set run options for running ADMB via R</p></a></li>
<li><a href='#setup_admb'><p>Set up AD Model Builder environment variables</p></a></li>
<li><a href='#write_pin'><p>Write parameter and data files for ADMB</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>'ADMB' to R Interface Functions</td>
</tr>
<tr>
<td>Version:</td>
<td>0.7.16.3</td>
</tr>
<tr>
<td>Description:</td>
<td>A series of functions to call 'AD Model Builder' (i.e.,
    compile and run models) from within R, read the results back
    into R as 'admb' objects, and provide standard accessors (i.e.
    coef(), vcov(), etc.)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>coda, lattice</td>
</tr>
<tr>
<td>Suggests:</td>
<td>bbmle, lme4, ggplot2 (&ge; 3.4.0), testthat, knitr</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>AD Model Builder &lt;http://admb-project.org&gt;</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-11-07 15:53:16 UTC; bolker</td>
</tr>
<tr>
<td>Author:</td>
<td>Ben Bolker [aut, cre],
  Hans Skaug [aut],
  Jeff Laake [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ben Bolker &lt;bolker@mcmaster.ca&gt;</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-11-07 16:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='R2admb-package'>ADMB to R interface functions</h2><span id='topic+R2admb-package'></span><span id='topic+R2admb'></span>

<h3>Description</h3>

<p>A series of functions to call AD Model Builder (i.e., compile and run models)
from within R, read the results back into R as &quot;admb&quot; objects, and provide
standard accessors (i.e. coef(), vcov(), etc.)
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;"> Package: </td><td style="text-align: left;"> R2admb</td>
</tr>
<tr>
 <td style="text-align: left;"> Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;"> Version: </td><td style="text-align: left;">
0.5</td>
</tr>
<tr>
 <td style="text-align: left;"> Date: </td><td style="text-align: left;"> 2009-11-11</td>
</tr>
<tr>
 <td style="text-align: left;"> License: </td><td style="text-align: left;"> GPL</td>
</tr>
<tr>
 <td style="text-align: left;"> LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;"> </td>
</tr>

</table>

<p>More here!
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>
<p>Maintainer: Ben Bolker &lt;bolker@ufl.edu&gt;
</p>


<h3>References</h3>

<p><a href="http://www.admb-project.org">http://www.admb-project.org</a>
</p>


<h3>See Also</h3>

<p>PBSadmb package, glmmADMB package, ADMB2R
</p>

<hr>
<h2 id='admb_version'>Query ADMB version</h2><span id='topic+admb_version'></span>

<h3>Description</h3>

<p>Report on the version of ADMB being used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>admb_version()
</code></pre>


<h3>Value</h3>

<p>Prints the version string from a compiled ADMB file, and returns the value (invisibly) as a character vector; returns NA if ADMB is not installed
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>admb_version()
</code></pre>

<hr>
<h2 id='AIC.admb'>Standard accessor functions for ADMB model fits</h2><span id='topic+AIC.admb'></span><span id='topic+confint.admb'></span><span id='topic+print.admb'></span><span id='topic+summary.admb'></span><span id='topic+print.summary.admb'></span><span id='topic+logLik.admb'></span><span id='topic+coef.admb'></span><span id='topic+vcov.admb'></span><span id='topic+stdEr'></span><span id='topic+stdEr.admb'></span><span id='topic+deviance.admb'></span>

<h3>Description</h3>

<p>Extract standard information such as log-likelihood, AIC, coefficients, etc.
from ADMB model fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'admb'
AIC(object, ..., k = 2)

## S3 method for class 'admb'
confint(object, parm, level = 0.95, method = "default",
  type = "fixed", ...)

## S3 method for class 'admb'
print(x, verbose = FALSE, ...)

## S3 method for class 'admb'
summary(object, correlation = FALSE, symbolic.cor = FALSE,
  ...)

## S3 method for class 'summary.admb'
print(x, digits = max(3, getOption("digits") - 3),
  symbolic.cor = x$symbolic.cor,
  signif.stars = getOption("show.signif.stars"), ...)

## S3 method for class 'admb'
logLik(object, ...)

## S3 method for class 'admb'
coef(object, type = "fixed", ...)

## S3 method for class 'admb'
vcov(object, type = "fixed", ...)

stdEr(object, ...)

## S3 method for class 'admb'
stdEr(object, type = "fixed", ...)

## S3 method for class 'admb'
deviance(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AIC.admb_+3A_object">object</code></td>
<td>
<p>an ADMB model fit (of class &quot;admb&quot;)</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_...">...</code></td>
<td>
<p>other parameters (for S3 generic compatibility)</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_k">k</code></td>
<td>
<p>penalty value for AIC fits</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_parm">parm</code></td>
<td>
<p>(currently ignored: FIXME) select parameters</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_level">level</code></td>
<td>
<p>alpha level for confidence interval</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_method">method</code></td>
<td>
<p>(character): &quot;default&quot; or &quot;quad&quot;, quadratic (Wald) intervals
based on approximate standard errors; &quot;profile&quot;, profile CIs (if
profile was computed); &quot;quantile&quot;, CIs based on quantiles of the
MCMC-generated posterior density (if MCMC was computed);
&quot;HPDinterval&quot;, CIs based on highest posterior density (ditto)</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_type">type</code></td>
<td>
<p>which type of parameters to report. Character vector, including
one or more of &quot;fixed&quot; or &quot;par&quot; (standard, fixed-effect parameters);
&quot;random&quot; (random effect parameters); &quot;rep&quot; (report variables); &quot;sdrpt&quot; (sdreport variables);
&quot;extra&quot; (report and sdreport); &quot;all&quot; (all of the above).</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_x">x</code></td>
<td>
<p>an ADMB model fit (of class &quot;admb&quot;)</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_verbose">verbose</code></td>
<td>
<p>show messages</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_correlation">correlation</code></td>
<td>
<p>currently unused parameter</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_symbolic.cor">symbolic.cor</code></td>
<td>
<p>currently unused parameter</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_digits">digits</code></td>
<td>
<p>number of digits to display</p>
</td></tr>
<tr><td><code id="AIC.admb_+3A_signif.stars">signif.stars</code></td>
<td>
<p>show significance stars?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Extracts appropriate values: numeric (scalar) for AIC, type logLik
for logLik, numeric vector of coefficients, numeric variance-covariance
matrix of parameter estimates
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 admbex &lt;- system.file("doc","Reedfrog_runs.RData",package="R2admb")
 load(admbex)
 m1
 coef(m1)
 summary(m1)
 coef(summary(m1)) ## returns just z-table
 AIC(m1)
 vcov(m1)
 logLik(m1)
 deviance(m1)
 stdEr(m1)

</code></pre>

<hr>
<h2 id='compile_admb'>Compile ADMB files, run, read output</h2><span id='topic+compile_admb'></span><span id='topic+run_admb'></span><span id='topic+read_admb'></span>

<h3>Description</h3>

<p>With various tests, calls the <code>admb</code> script to compile from a TPL file
to an executable, or runs the resulting executable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compile_admb(fn,safe=FALSE,re=FALSE,
verbose=FALSE,
admb_errors=c("stop","warn","ignore"))

 run_admb(fn,verbose=FALSE,mcmc=FALSE,
mcmc.opts=mcmc.control(),profile=FALSE,
extra.args="",admb_errors=c("stop","warn","ignore"))

read_admb(fn,verbose=FALSE,profile=FALSE,
mcmc=FALSE,mcmc.opts=NULL,admbOut=NULL,checkterm=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compile_admb_+3A_fn">fn</code></td>
<td>
<p>(character) name of TPL file, without extension</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_safe">safe</code></td>
<td>
<p>(logical) Compile in safe mode?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_re">re</code></td>
<td>
<p>(logical) Compile in random effects (ADMB-RE) mode?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_verbose">verbose</code></td>
<td>
<p>(logical) Verbose output?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_admb_errors">admb_errors</code></td>
<td>
<p>(character) how to handle compilation/linking errors?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_profile">profile</code></td>
<td>
<p>(logical) Run likelihood profiles?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_extra.args">extra.args</code></td>
<td>
<p>(character) extra arguments for ADMB run</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_mcmc">mcmc</code></td>
<td>
<p>(logical) run post-hoc MCMC?</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_mcmc.opts">mcmc.opts</code></td>
<td>
<p>options for MCMC run (see <code><a href="#topic+mcmc.control">mcmc.control</a></code>)</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_admbout">admbOut</code></td>
<td>
<p>(character) ADMB run output for inclusion in <code>admb</code>
object (for internal use)</p>
</td></tr>
<tr><td><code id="compile_admb_+3A_checkterm">checkterm</code></td>
<td>
<p>(logical) compute termination criteria (ratio of min/max
eigenvalue) and include it in the saved object?</p>
</td></tr>
</table>


<h3>Value</h3>

 <ul>
<li> <p><code>compile_admb</code> returns nothing (it has the side
effect of creating an executable) </p>
</li>
<li> <p><code>run_admb</code> invisibly returns the
output produced by the ADMB run; it also produces output files on disk as a
side effect </p>
</li>
<li> <p><code>read_admb</code> returns an object of class <code>admb</code>,
containing as much information as possible gleaned from the output files
(parameter estimates, standard errors, variance-covariance matrix, profiles,
MCMC output) </p>
</li></ul>



<h3>Note</h3>

<p>Compiling also sets executable mode.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>

<hr>
<h2 id='do_admb'>Compile and/or run an ADMB model, collect output</h2><span id='topic+do_admb'></span>

<h3>Description</h3>

<p>Compile an ADMB model, run it, collect output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>do_admb(fn, data = NULL, params = NULL, bounds = NULL, phase = NULL,
  re = NULL, data_type = NULL, safe = TRUE, profile = NULL,
  profile.opts = NULL, mcmc = NULL, mcmc.opts = mcmc.control(),
  impsamp = FALSE, verbose = FALSE, run.opts = run.control(),
  objfunname = "f", workdir = getwd(), admb_errors = c("stop", "warn",
  "ignore"), extra.args)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="do_admb_+3A_fn">fn</code></td>
<td>
<p>(character) base name of a TPL function, located in the working
directory</p>
</td></tr>
<tr><td><code id="do_admb_+3A_data">data</code></td>
<td>
<p>a named list of input data variables (order must match TPL file): each element of the list can either be a single value, or a list containing elements
</p>

<ul>
<li><p>valuethe value of the data
</p>
</li>
<li><p>data_typecharacter: possible values as in <code><a href="base.html#topic+storage.mode">storage.mode</a></code>, typically &quot;integer&quot; or &quot;numeric&quot;: this overrides R2admb's attempts to guess whether variables are supposed to be integers or floats (default NA)
</p>
</li></ul>
</td></tr>
<tr><td><code id="do_admb_+3A_params">params</code></td>
<td>
<p>a named list of starting parameter values (order must match TPL file): each element of the list can either be a single value, or a list containing elements
</p>

<dl>
<dt>value</dt><dd><p>starting value of the parameter (default 0)</p>
</dd>
<dt>bounds</dt><dd><p>two-element vector of lower and upper bounds</p>
</dd>
<dt>phase</dt><dd><p>integer, specifying phase: not implemented yet</p>
</dd>
</dl>
</td></tr>
<tr><td><code id="do_admb_+3A_bounds">bounds</code></td>
<td>
<p>named list of 2-element vectors of lower and upper bounds for
specified parameters</p>
</td></tr>
<tr><td><code id="do_admb_+3A_phase">phase</code></td>
<td>
<p>named numeric vector of phases (not implemented yet)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_re">re</code></td>
<td>
<p>a named list of the identities and dimensions of any random effects
vectors or matrices used in the TPL file</p>
</td></tr>
<tr><td><code id="do_admb_+3A_data_type">data_type</code></td>
<td>
<p>a named vector specifying (optional) data types for
parameters, in parname=&quot;storage mode&quot; format (e.g.
<code>c(x="integer",y="numeric")</code>)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_safe">safe</code></td>
<td>
<p>(logical) compile in safe mode?</p>
</td></tr>
<tr><td><code id="do_admb_+3A_profile">profile</code></td>
<td>
<p>(logical) generate likelihood profiles? (untested!)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_profile.opts">profile.opts</code></td>
<td>
<p>(list) list of options, including
</p>

<ul>
<li><p>parsvector of names of parameters to profile
</p>
</li></ul>
</td></tr>
<tr><td><code id="do_admb_+3A_mcmc">mcmc</code></td>
<td>
<p>(logical) run MCMC around best fit?</p>
</td></tr>
<tr><td><code id="do_admb_+3A_mcmc.opts">mcmc.opts</code></td>
<td>
<p>options for MCMC (see <code><a href="#topic+mcmc.control">mcmc.control</a></code> for details)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_impsamp">impsamp</code></td>
<td>
<p>(logical) run importance sampling?</p>
</td></tr>
<tr><td><code id="do_admb_+3A_verbose">verbose</code></td>
<td>
<p>(logical) print details</p>
</td></tr>
<tr><td><code id="do_admb_+3A_run.opts">run.opts</code></td>
<td>
<p>options for ADMB run (see <code><a href="#topic+run.control">run.control</a></code> for details)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_objfunname">objfunname</code></td>
<td>
<p>(character) name for objective function in TPL file (only relevant if <code>checkparam</code> is set to &quot;write&quot;)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_workdir">workdir</code></td>
<td>
<p>temporary working directory (dat/pin/tpl files will be copied)</p>
</td></tr>
<tr><td><code id="do_admb_+3A_admb_errors">admb_errors</code></td>
<td>
<p>how to treat ADMB errors (in either compilation or run): use &quot;ignore&quot; option at your own risk!</p>
</td></tr>
<tr><td><code id="do_admb_+3A_extra.args">extra.args</code></td>
<td>
<p>(character) extra argument string to pass to admb</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>do_admb</code> will attempt to do everything required to start from the model
definition (TPL file) specified by <code>fn</code>, the data list, and the list of
input parameters, compile and run (i.e. minimize the objective function of)
the model in AD Model Builder, and read the results back into an object of
class <code>admb</code> in R. If <code>checkparam</code> or <code>checkdata</code> are set to
&quot;write&quot;, it will attempt to construct a DATA section, and construct or
(augment an existing) PARAMETER section (which may contain definitions of
non-input parameters to be used in the model). It copies the input TPL file
to a backup (.bak); on finishing, it restores the original TPL file and
leaves the auto-generated TPL file in a file called [fn]_gen.tpl.
</p>


<h3>Value</h3>

<p>An object of class <code>admb</code>.
</p>


<h3>Note</h3>

<p>1. Mixed-case file names are ignored by ADMB; this function makes a
temporary copy with the file name translated to lower case. 2. Parameter
names containing periods/full stops will not work, because this violates C
syntax (currently not checked). 3. There are many, many, implicit
restrictions and assumptions: for example, all vectors and matrices are
assumed to be indexed starting from 1.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
setup_admb()
file.copy(system.file("tplfiles","ReedfrogSizepred0.tpl",package="R2admb"),"tadpole.tpl")
tadpoledat &lt;-
 data.frame(TBL = rep(c(9,12,21,25,37),each=3),
            Kill = c(0,2,1,3,4,5,0,0,0,0,1,0,0,0,0L),
            nexposed=rep(10,15))
m1 &lt;- do_admb("tadpole",
             data=c(list(nobs=15),tadpoledat),
             params=list(c=0.45,d=13,g=1),
             bounds=list(c=c(0,1),d=c(0,50),g=c(-1,25)),
             run.opts=run.control(checkparam="write",
               checkdata="write",clean="all"))
m2 &lt;- do_admb("tadpole",
             data=c(list(nobs=15),tadpoledat),
             params=list(c=list(0.45,bounds=c(0,1)),
                         d=list(13,bounds=c(0,50)),
                         g=list(1,bounds=c(-1,25))),
             run.opts=run.control(checkparam="write",
               checkdata="write",clean="all"))
unlink("tadpole.tpl")

## End(Not run)

</code></pre>

<hr>
<h2 id='extract_gradient'>Extract gradients</h2><span id='topic+extract_gradient'></span>

<h3>Description</h3>

<p>Extract gradient values from last iteration of screen output and return
dataframe with variable names, values and gradient, sorted in order of
ascending absolute value of the gradient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_gradient(admbfile)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extract_gradient_+3A_admbfile">admbfile</code></td>
<td>
<p>base name of admb project</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with 3 columns var=variable name,
value= final parameter value, gradient= gradient value
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>

<hr>
<h2 id='find_large_cor'>Find large correlations</h2><span id='topic+find_large_cor'></span>

<h3>Description</h3>

<p>Find any correlations for which their absolute value exceeds a
specified amount (rho). Returns a dataframe with row and column names and correlation
from lower triangular matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_large_cor(x, rho = 0.9)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_large_cor_+3A_x">x</code></td>
<td>
<p>correlation matrix</p>
</td></tr>
<tr><td><code id="find_large_cor_+3A_rho">rho</code></td>
<td>
<p>abolute value for lower bound of correlation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a dataframe with 3 columns var1=row name,
var2= column name or number, Value of matrix element. Only contains rows
in which matrix element satisfies logical expression.
</p>


<h3>Author(s)</h3>

<p>Jeff Laake
</p>

<hr>
<h2 id='mcmc.control'>Control options for MCMC after ADMB fitting</h2><span id='topic+mcmc.control'></span>

<h3>Description</h3>

<p>Determines the options (number of steps, save interval, etc.)  for running
MCMC based on the estimated mode (maximum likelihood estimate) and parameter
variance-covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcmc.control(mcmc = 1000, mcmc2 = 0, mcsave, mcnoscale = FALSE,
  mcgrope = FALSE, mcmult = 1, mcmcpars = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcmc.control_+3A_mcmc">mcmc</code></td>
<td>
<p>Total number of MCMC steps</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcmc2">mcmc2</code></td>
<td>
<p>MCMC2 steps (see ADMB-RE manual)</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcsave">mcsave</code></td>
<td>
<p>Thinning interval for values saved in the PSV file.  Default is
<code>pmax(1,floor(mcmc/1000))</code>, i.e. aim to save 1000 steps</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcnoscale">mcnoscale</code></td>
<td>
<p>don't rescale step size for mcmc depending on acceptance rate</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcgrope">mcgrope</code></td>
<td>
<p>(double) Use a candidate distribution that is a mixture of a
multivariate normal and a fatter-tailed distribution with a proportion
<code>mcmcgrope</code> of the fatter-tailed distribution; the ADMB manual suggests
values of <code>mcgrope</code> between 0.05 and 0.1</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcmult">mcmult</code></td>
<td>
<p>Multiplier for the MCMC candidate distribution</p>
</td></tr>
<tr><td><code id="mcmc.control_+3A_mcmcpars">mcmcpars</code></td>
<td>
<p>(character) vector of parameters to track in MCMC run.
<em>At least one must be specified.</em> ADMB produces two kinds of output for
MCMC.  For any <code>sdreport</code> parameters it will produce a <code>hst</code> file
that contains a summary histogram; <code>mcmcpars</code> constructs appropriate
<code>sdreport</code> parameters in the auto-generated TPL file.  Step-by-step
output for all parameters (regulated by <code>mcsave</code>) is saved in the
<code>PSV</code> file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See the AD Model Builder reference manual. The <code>mcrb</code> option (reduce
correlation of the Hessian when constructing the candidate distribution) and
the <code>mcseed</code> options (seed for random number generator) are not yet
implemented; <code>mcnoscale</code> above may not work properly
</p>


<h3>Value</h3>

<p>Returns a list of options suitable for passing as the
<code>mcmc.opts</code> argument to <code><a href="#topic+do_admb">do_admb</a></code>
</p>


<h3>Note</h3>

<p>Some options (<code>mcmc2</code>, etc.) that can be used in AD Model Builder
and ADMB-RE may not be available
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
mcmc.control(mcmc=2000)

</code></pre>

<hr>
<h2 id='plot.admb_hist'>Plot MCMC histogram</h2><span id='topic+plot.admb_hist'></span>

<h3>Description</h3>

<p>Plot MCMC histogram
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'admb_hist'
plot(x,type=c("lattice","ggplot"),dtype=c("hist","density"),pars,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.admb_hist_+3A_x">x</code></td>
<td>
<p>plotting data</p>
</td></tr>
<tr><td><code id="plot.admb_hist_+3A_type">type</code></td>
<td>
<p>only &quot;lattice&quot; at present</p>
</td></tr>
<tr><td><code id="plot.admb_hist_+3A_dtype">dtype</code></td>
<td>
<p>either &quot;hist&quot; or &quot;density&quot;</p>
</td></tr>
<tr><td><code id="plot.admb_hist_+3A_pars">pars</code></td>
<td>
<p>passed to rhist</p>
</td></tr>
<tr><td><code id="plot.admb_hist_+3A_...">...</code></td>
<td>
<p>additional parameters for compatibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot object
</p>

<hr>
<h2 id='read_pars'>Read in parameters from an AD Model Builder run</h2><span id='topic+read_pars'></span><span id='topic+read_psv'></span><span id='topic+read_rep'></span>

<h3>Description</h3>

<p>Reads coefficients, standard errors, log-likelihoods, maximum gradients,
correlation and variance-covariance matrices from AD Model Builder output
files
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_pars(fn, drop_phase = TRUE, covfn = "admodel.cov",
  warn_nonstd_rep = TRUE)

read_psv(fn, names = NULL)

read_rep(fn, names = NULL, warn_nonstd_rep = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_pars_+3A_fn">fn</code></td>
<td>
<p>(character) Base name of AD Model Builder</p>
</td></tr>
<tr><td><code id="read_pars_+3A_drop_phase">drop_phase</code></td>
<td>
<p>(logical) drop negative-phase (fixed) parameters from results?</p>
</td></tr>
<tr><td><code id="read_pars_+3A_covfn">covfn</code></td>
<td>
<p>(character) file name for covariance matrix information</p>
</td></tr>
<tr><td><code id="read_pars_+3A_warn_nonstd_rep">warn_nonstd_rep</code></td>
<td>
<p>warn if report file is in nonstandard format?</p>
</td></tr>
<tr><td><code id="read_pars_+3A_names">names</code></td>
<td>
<p>(character) Names of variables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given the output from an ADMB run on FOO.tpl, <code>read_pars</code> reads the
files FOO.par (parameters, log-likelihood, max gradient); FOO.std (standard
deviations); FOO.cor (correlations); FOO.rep (report variables);
admodel.hes for hessian; and admodel.cov for
covariance matrix.  <code>read_psv</code> reads the output of MCMC runs.
</p>

<p><code>read_rep</code> (called by <code>read_admb</code> to read the <code>.rep</code> file) first
checks if the report file is in a standard format: first line starts with a
comment character (#); thereafter, each block starts with a single commented
line containing the name of the parameter (possibly ending with a colon),
followed by a block of all-numeric lines, which are read as a single vector.
If the report file is in a standard format, the values are added to the end
of the coefficients list.  Otherwise, the numeric values from the report file
are included in the results as a single, concantenated numeric vector.

</p>


<h3>Value</h3>

<p>List containing the following elements
</p>

<ul>
<li><p>coefficientsparameter estimates
</p>
</li>
<li><p>coeflistparameter estimates in list format, with proper shape (vectors, matrices, etc.)
</p>
</li>
<li><p>seestimated standard errors of coefficients
</p>
</li>
<li><p>logliklog-likelihood
</p>
</li>
<li><p>maxgradmaximum gradient of log-likelihood surface
</p>
</li>
<li><p>corcorrelation matrix
</p>
</li>
<li><p>vcovvariance-covariance matrix
</p>
</li>
<li><p>nparnumber of parameters
</p>
</li>
<li><p>heshessian matrix (only if no vcov matrix)
</p>
</li>
<li><p>reportvalues from report file (if non-standard report file)
</p>
</li></ul>



<h3>Warnings</h3>


<ul>
<li><p>The <code>coeflist</code> component is untested for data
structures more complicated than scalars, vectors or matrices (i.e. higher-dimensional or ragged arrays)
</p>
</li>
<li><p>Because ADMB hard-codes the file name for covariance matrix information (<code>admodel.cov</code>), care is necessary when running different models in the same directory; users may want to rename this file by hand and use the <code>covfn</code> argument
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+write_pin">write_pin</a></code>, <code><a href="#topic+write_dat">write_dat</a></code>
</p>

<hr>
<h2 id='read_plt'>Read in ADMB profile file</h2><span id='topic+read_plt'></span>

<h3>Description</h3>

<p>Read in the output from ADMB likelihood profiling stored in a <code>.plt</code>
file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_plt(varname)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_plt_+3A_varname">varname</code></td>
<td>
<p>(character) Name of profiled variable (base name of <code>.plot</code> file)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the following elements:
</p>
<table role = "presentation">
<tr><td><code>prof</code></td>
<td>
<p>likelihood profile: a two-column matrix containing the parameter value and the corresponding likelihood (<em>not</em> the log-likelihood or negative log-likelihood), scaled to integrate to 1.0</p>
</td></tr>
<tr><td><code>ci</code></td>
<td>
<p>matrix of upper and lower confidence intervals at the 0.9, 0.95, and 0.975 levels</p>
</td></tr>
<tr><td><code>prof_norm</code></td>
<td>
<p>likelihood profile, based on a normal approximation</p>
</td></tr>
<tr><td><code>cinorm</code></td>
<td>
<p>confidence interval matrix, based on normal approximation</p>
</td></tr>
</table>

<hr>
<h2 id='run.control'>set run options for running ADMB via R</h2><span id='topic+run.control'></span>

<h3>Description</h3>

<p>A helper function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>run.control(check_tpl = TRUE, write_files = TRUE, checkparam = c("stop",
  "warn", "write", "ignore"), checkdata = c("stop", "warn", "write",
  "ignore"), compile = TRUE, run = TRUE, read_files = TRUE,
  clean_files = "all")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="run.control_+3A_check_tpl">check_tpl</code></td>
<td>
<p>Check the specified TPL file for problems?</p>
</td></tr>
<tr><td><code id="run.control_+3A_write_files">write_files</code></td>
<td>
<p>Write out data and initialization files?</p>
</td></tr>
<tr><td><code id="run.control_+3A_checkparam">checkparam</code></td>
<td>
<p>How to check <code>PARAMETERS</code> section of the TPL file:
<code>stop</code>=stop if there are problems; <code>warn</code>=give a warning if there
are problems, but try to proceed; <code>write</code>=modify TPL file, writing
appropriate sections; <code>ignore</code>=assume TPL file is OK, proceed</p>
</td></tr>
<tr><td><code id="run.control_+3A_checkdata">checkdata</code></td>
<td>
<p>as with <code>checkparam</code>: how/whether to check/generate the
<code>DATA</code> section of the TPL file</p>
</td></tr>
<tr><td><code id="run.control_+3A_compile">compile</code></td>
<td>
<p>compile the TPL file (via ADMB) into an executable?</p>
</td></tr>
<tr><td><code id="run.control_+3A_run">run</code></td>
<td>
<p>run the executable file with the specified data/initial values?</p>
</td></tr>
<tr><td><code id="run.control_+3A_read_files">read_files</code></td>
<td>
<p>read the results of an ADMB run into R?</p>
</td></tr>
<tr><td><code id="run.control_+3A_clean_files">clean_files</code></td>
<td>
<p>Delete working files after completion of the run?  Options
are <code>"all"</code>, <code>"sys"</code>, <code>"output"</code>, <code>"none"</code>; <code>TRUE</code>
is equivalent to <code>"all"</code> and <code>FALSE</code> is equivalent to <code>"none"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with appropriate default values inserted for passing to
<code><a href="#topic+do_admb">do_admb</a></code>
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>

<hr>
<h2 id='setup_admb'>Set up AD Model Builder environment variables</h2><span id='topic+setup_admb'></span><span id='topic+clean_admb'></span>

<h3>Description</h3>

<p>Attempts to set environment variables so that AD Model Builder will &quot;just
work&quot; when run from inside R
</p>


<h3>Usage</h3>

<pre><code class='language-R'>setup_admb(admb_home)

       clean_admb(fn,which=c("sys","output"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="setup_admb_+3A_admb_home">admb_home</code></td>
<td>
<p>(character) directory containing AD Model Builder binary
files</p>
</td></tr>
<tr><td><code id="setup_admb_+3A_fn">fn</code></td>
<td>
<p>(character) base name of ADMB model files</p>
</td></tr>
<tr><td><code id="setup_admb_+3A_which">which</code></td>
<td>
<p>what to remove: any combination of &quot;sys&quot; (system), &quot;input&quot;,
&quot;output&quot;, or &quot;all&quot; or &quot;none&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>(1) If the environment variable ADMB_HOME is not already set and admb_home is
not specified, this function will try to set it sensibly. (I.e., on Unix
systems, it will run a &quot;locate&quot; command (if one is available) to try to find
the binaries, and thereafter check if they are installed in the default
location (/usr/local/admb); on Windows it will assume they are installed in
the default location (C:/ADMB).) (2) If ADMB_HOME is set and admb_home is not
specified, it will leave the original setting alone. (3) If admb_home is
specified, it will set the environment variable ADMB_HOME to that value.
</p>
<p>The function also prepends the admb_home value to the PATH variable.
</p>


<h3>Value</h3>

<p>A character vector containing the name of the current ADMB_HOME.
</p>


<h3>Author(s)</h3>

<p>Ben Bolker
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 orig &lt;- Sys.getenv("ADMB_HOME")
## this doesn't make sense but won't break anything
## until you actually try to run AD Model Builder
 setup_admb("elsewhere")   
 Sys.setenv(ADMB_HOME="") ## erase environment variable
## Not run: 
 setup_admb()              ## auto-locate (fails if ADMB not found)

## End(Not run)
 Sys.setenv(ADMB_HOME=orig) ## restore sanity

</code></pre>

<hr>
<h2 id='write_pin'>Write parameter and data files for ADMB</h2><span id='topic+write_pin'></span><span id='topic+write_dat'></span><span id='topic+dat_write'></span>

<h3>Description</h3>

<p>Given base filenames and lists, write output files for starting parameter
values and data in a format suitable for input by AD Model Builder
from glmmADMB, by Hans Skaug
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_pin(name,L)

      write_dat(name, L, append=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_pin_+3A_name">name</code></td>
<td>
<p>(character) the base name of the file</p>
</td></tr>
<tr><td><code id="write_pin_+3A_l">L</code></td>
<td>
<p>a list of objects to be written to file</p>
</td></tr>
<tr><td><code id="write_pin_+3A_append">append</code></td>
<td>
<p>(logical) append to existing file?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns nothing; creates files in the current working directory as a
side effect
</p>


<h3>Note</h3>

<p>numeric vectors and matrices are the only objects that can be written
(at present)
</p>


<h3>Author(s)</h3>

<p>Hans Skaug
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_pars">read_pars</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
