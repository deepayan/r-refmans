<!DOCTYPE html><html><head><title>Help for package carcass</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {carcass}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#batdist'>
<p>Distribution of bat carcasses below wind turbines</p></a></li>
<li><a href='#carcass-package'>
<p>Estimation of the Number of Fatalities from Carcass Searches</p></a></li>
<li><a href='#CIetterson'>
<p>Confidence interval for the functions ettersonEq14, ettersonEq14v1 and ettersonEq14v2</p></a></li>
<li><a href='#estimateN'><p>Estimation of number of killed animals based on carcass searches and estimates</p>
for detection probability</a></li>
<li><a href='#ettersonEq14'>
<p>Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925</p></a></li>
<li><a href='#ettersonEq14v1'>
<p>Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925,</p>
adapted so that persistence probability and searcher efficiency can vary
with calender date</a></li>
<li><a href='#ettersonEq14v2'>
<p>Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925,</p>
adapted so that persistence probability and searcher efficiency can vary
with age of the carcass</a></li>
<li><a href='#integrate.persistence'>
<p>Integrate persistence probability over the discrete time intervals (e.g. days)</p>
to account for constant arrival of carcasses</a></li>
<li><a href='#perickson'>
<p>Carcass detection probability acording to Erickson et al. 2004</p></a></li>
<li><a href='#persistence'>
<p>Times until removal for brown mice carcasses</p></a></li>
<li><a href='#persistence.prob'>
<p>Estimates carcass persistence probability based on carcass removal experiment data</p></a></li>
<li><a href='#phuso'>
<p>Carcass detection probability acording to Huso 2010</p></a></li>
<li><a href='#pkorner'>
<p>Carcass detection probability acording to Korner-Nievergelt et al. 2011</p></a></li>
<li><a href='#posteriorN'>
<p>Posterior distribution of the number of fatalities based on the number of carcasses found and the probability of finding a carcass.</p></a></li>
<li><a href='#search.efficiency'>
<p>Estimates detection probability per person and visibility classes using a binomial model</p></a></li>
<li><a href='#searches'>
<p>Data of a searcher efficiency trial</p></a></li>
<li><a href='#shapeparameter'>
<p>Shapeparameters of a beta-distribution from the mean, the lower and upper limit of the 95% confidence or credible interval</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of the Number of Fatalities from Carcass Searches</td>
</tr>
<tr>
<td>Version:</td>
<td>1.7</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-30</td>
</tr>
<tr>
<td>Author:</td>
<td>Fraenzi Korner-Nievergelt, Ivo Niermann, Oliver Behr, Matthew A. Etterson, Robert Brinkmann, Pius Korner, Barbara Hellriegel, Tobias Roth, Manuela M. P. Huso, Dan Dalthorp</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fraenzi Korner-Nievergelt &lt;fraenzi.korner@oikostat.ch&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.0), stats, lme4, survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>expm, arm, MASS</td>
</tr>
<tr>
<td>Description:</td>
<td>The number of bird or bat fatalities from collisions with buildings, towers or wind energy turbines can be estimated based on carcass searches and experimentally assessed carcass persistence times and searcher efficiency. Functions for estimating the probability that a bird or bat that died is found by a searcher are provided. Further functions calculate the posterior distribution of the number of fatalities based on the number of carcasses found and the estimated detection probability.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-02 19:51:24 UTC; fk</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-03 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='batdist'>
Distribution of bat carcasses below wind turbines
</h2><span id='topic+batdist'></span>

<h3>Description</h3>

<p>The data contains the proportion of bats killed at wind turbines falling into different 10m-distance rings from the turbine.
It is a collection of empirical and theoretical estimates from different publications.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(batdist)</code></pre>


<h3>Format</h3>

<p>A data frame with 6 observations on the following 16 variables.
</p>

<dl>
<dt><code>studyname</code></dt><dd><p>a factor with the name of the study</p>
</dd>
<dt><code>study</code></dt><dd><p>a factor with the code of the study, see tutorial</p>
</dd>
<dt><code>rotor.diameter.m</code></dt><dd><p>a numeric vector giving the average rotor diameter (in m) for the turbines investigated</p>
</dd>
<dt><code>nacelle.height.m</code></dt><dd><p>a numeric vector giving the average nacelle height (in m) for the turbines investigated</p>
</dd>
<dt><code>n</code></dt><dd><p>a numeric vector indicating the sample size (i.e. numbers of carcasses found)</p>
</dd>
<dt><code>method</code></dt><dd><p>a factor indicating the method used to obtain the carcass distribution. <code>empirical</code>: based on field data, <code>physical_model</code>: according to a theoretical ballistic model</p>
</dd>
<dt><code>species</code></dt><dd><p>a factor with only one level at the moment <code>bat</code></p>
</dd>
<dt><code>prop10m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 0 and 10 m from the turbine</p>
</dd>
<dt><code>prop20m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 10 and 20 m from the turbine</p>
</dd>
<dt><code>prop30m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 20 and 30 m from the turbine</p>
</dd>
<dt><code>prop40m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 30 and 40 m from the turbine</p>
</dd>
<dt><code>prop50m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 40 and 50 m from the turbine</p>
</dd>
<dt><code>prop60m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 50 and 60 m from the turbine</p>
</dd>
<dt><code>prop70m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 60 and 70 m from the turbine</p>
</dd>
<dt><code>prop80m</code></dt><dd><p>a numeric vector with the proportion of killed bats lying in between 70 and 80 m from the turbine</p>
</dd>
<dt><code>prop50mplus</code></dt><dd><p>a numeric vector: the sum of prop60m, prop70m and prop80m</p>
</dd>
</dl>



<h3>References</h3>

<p>Arnett, E. B., W. P. Erickson, J. Kerns, and J. Horn. 2005. Relationships between Bats and Wind Turbines in Pennsylvania and West Virginia:
An Assessment of Fatality Search Protocols, Patterns of Fatality, and Behavioral Interactions with Wind Turbines. Bat Conservation International, Austin, Texas, USA.
</p>
<p>Hull, C. L. and S. Muir. 2010. Search area for monitoring bird and bat carcasses at wind farms using a Monte-Carlo model. Australian Journal of Environmental Management 17:77-87.
</p>
<p>Niermann, I., R. Brinkmann, F. Korner-Nievergelt, and O. Behr. 2011. Systematische Schlagopfersuche - Methodische Rahmenbedingungen, statistische Analyseverfahren und Ergebnisse. Pages 40-115 in R. Brinkmann, O. Behr, I. Niermann, and M. Reich, editors. Entwicklung von Methoden zur Untersuchung und Reduktion des Kollisionsrisikos von Fledermaeusen an Onshore-Windenergieanlagen. Cuvillier Verlag, Goettingen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(batdist)
batdist
</code></pre>

<hr>
<h2 id='carcass-package'>
Estimation of the Number of Fatalities from Carcass Searches
</h2><span id='topic+carcass-package'></span><span id='topic+carcass'></span>

<h3>Description</h3>

<p>The number of bird or bat fatalities from collisions with buildings, towers or 
wind energy turbines can be estimated based on carcass searches and experimentally 
assessed carcass persistence times and searcher efficiency. This package provides 
diverse functions for estimating the probability that a bird or bat that died is 
found by a searcher. It further provides a function to obtain a posterior distribution 
of the number of fatalities based on the number of carcasses found and the estimated detection probability.
see worked example in Korner-Nievergelt et al 2011, and 2015.
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt, Ivo Niermann, Oliver Behr, Matthew A. Etterson, 
Robert Brinkmann, Pius Korner, Barbara Hellriegel, Tobias Roth, 
Manuela M. P. Huso, Dan Dalthorp
</p>
<p>Maintainer: Fraenzi Korner-Nievergelt &lt;fraenzi.korner@oikostat.ch&gt;
</p>
<p>The authors thank Helga Garcia and Joana Bernardino for reporting bugs.
</p>


<h3>References</h3>

<p>Erickson WP, Jeffrey J, Kronner K, Bay K (2004) Stateline Wind Project Wildlife. 
Monitoring Final Report, July 2001 - December 2003. - Technical report 
peer-reviewed by and submitted to FPL Energy, the Oregon Energy Facility 
Siting Council, and the Stateline Technical Advisory Committee, Oregon, USA, 105 pp<br />
</p>
<p>Etterson, M.A. (2013) Hidden Markov models for estimating animal mortality from 
antropogenic hazards. Ecological Applications, 23, 1915-1925.
</p>
<p>Huso M (2010) An estimator of wildlife fatality from observed carcasses. 
Environmetrics 22: 318-329<br />
</p>
<p>Korner-Nievergelt F, Korner-Nievergelt P, Behr O, Niermann I, Brinkmann R, 
Hellriegel B (2011) A new method to determine bird and bat fatality at wind 
energy turbines from carcass searches. Wildlife Biology 17: 350-363<br />
</p>
<p>Korner-Nievergelt F, Behr O, Brinkmann R, Etterson MA, Huso MM, Dalthorp D, 
Korner-Nievergelt P, Roth T, Niermann I (2015) Mortality estimation from carcass 
searches using the R-package carcass ? a tutorial. Wildlife Biology 21: 30-43.
</p>

<hr>
<h2 id='CIetterson'>
Confidence interval for the functions ettersonEq14, ettersonEq14v1 and ettersonEq14v2
</h2><span id='topic+CIetterson'></span>

<h3>Description</h3>

<p>Calculates the Monte Carlo confidence intervals for the estimated carcass detection probability
when persistence probability and searcher efficiency are uncertain. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CIetterson(s, s.lwr, s.upr, f, f.lwr, f.upr, J, s.time.variance = "carcass age", 
f.time.variance = "number of searches", nsim = 1000, ci = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CIetterson_+3A_s">s</code></td>
<td>
<p>point estiate for persistence probability (see help file for functions etterson14, 
ettersonEq14v1 or ettersonEq14v2)
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_s.lwr">s.lwr</code></td>
<td>
<p>lower limit of the 95% confidence interval of persistence probability
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_s.upr">s.upr</code></td>
<td>
<p>upper limit of the 95% confidence interval of persistence probability
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_f">f</code></td>
<td>
<p>point estimate for the searcher efficiency (see help file for functions etterson14, 
ettersonEq14v1 or ettersonEq14v2
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_f.lwr">f.lwr</code></td>
<td>
<p>lower limit of the 95% confidence interval of searcher efficiency
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_f.upr">f.upr</code></td>
<td>
<p>upper limit of the 95% confidence interval of searcher efficiency
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_j">J</code></td>
<td>

<p>vector of search intervals
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_s.time.variance">s.time.variance</code></td>
<td>

<p>character, one of &quot;date&quot; or &quot;carcass age&quot;
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_f.time.variance">f.time.variance</code></td>
<td>

<p>character, one of &quot;date&quot; or  &quot;number of searches&quot;
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_nsim">nsim</code></td>
<td>

<p>number of Monte Carlo simulations
</p>
</td></tr>
<tr><td><code id="CIetterson_+3A_ci">ci</code></td>
<td>

<p>size of the confidence interval, default is 0.95
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The time variance in s and f is either both with date or both with carcass age and 
number of searches, respectively.
In case of constant s and f, the function uses ettersonEq14 independent of the 
arguments s.time.variance or f.time.variance, when only one value is given for both 
parameters.
</p>


<h3>Value</h3>

<p>a list
</p>
<table>
<tr><td><code>p.lower</code></td>
<td>
<p>lower limit of the confidence interval</p>
</td></tr>
<tr><td><code>p.upper</code></td>
<td>
<p>upper limit of the confidence interval</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>F. Korner
</p>


<h3>Examples</h3>

<pre><code class='language-R'>J &lt;- c(2,3,2,4,3,5,3,2,3,4)
s &lt;- plogis(seq(0.2, 2, length=sum(J)))
f &lt;- plogis(seq(1.5, 0.9, length=length(J)))

s.lwr&lt;- plogis(seq(0.2, 2, length=sum(J))-0.5)
f.lwr &lt;- plogis(seq(1.5, 0.9, length=length(J))-0.3)

s.upr &lt;- plogis(seq(0.2, 2, length=sum(J))+0.5)
f.upr &lt;- plogis(seq(1.5, 0.9, length=length(J))+0.3)

CIetterson(s=s, s.lwr=s.lwr, s.upr=s.upr, f=f, f.lwr=f.lwr, f.upr=f.upr, J=J, nsim=100)
 # nsim is too low, please, increase!
</code></pre>

<hr>
<h2 id='estimateN'>Estimation of number of killed animals based on carcass searches and estimates 
for detection probability
</h2><span id='topic+estimateN'></span>

<h3>Description</h3>

<p>Estimates the number of killed animals from carcass searches taking into account 
the uncertainty in the estimates for carcass detection probability (or alternatively 
for searcher efficiency and carcass persistence probability).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateN(count, p = NA, p.lower = NA, p.upper = NA,
          f = NA, f.lower = NA, f.upper = NA, s = NA, 
          s.lower = NA, s.upper = NA, arrival="discrete", a=1, a.lower=1, a.upper=1,
          pform = "korner", d = 1, n = NA, J=NA, maxn = 1000, 
          nsim = 1000, plot = TRUE, postdist=FALSE, k=1,  x=c(1:10))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateN_+3A_count">count</code></td>
<td>

<p>number of carcasses found
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_p">p</code></td>
<td>

<p>estimate for detection probability (alternatively give f, s, d and n)
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_p.lower">p.lower</code></td>
<td>

<p>lower limit of 95% CI of detection probability
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_p.upper">p.upper</code></td>
<td>

<p>upper limit of 95% CI of detection probability
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_f">f</code></td>
<td>

<p>estimate for searcher efficiency
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_f.lower">f.lower</code></td>
<td>

<p>lower limit of 95% CI of searcher efficiency
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_f.upper">f.upper</code></td>
<td>

<p>upper limit of 95% CI of searcher efficiency
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_s">s</code></td>
<td>

<p>estimate for persistence probability: this is a scalar in case of constant persistence probability.
In case of non-constant persistence probability, it is a vector. ATTENTION: 
If 'pform=&quot;korner&quot;', the proportion
of remaining carcasses until each day after death (survivor function) have to be given. 
If 'pform=&quot;etterson&quot;', the daily persistence probabilities for each day after death are needed.
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_s.lower">s.lower</code></td>
<td>

<p>lower limit of 95% CI of persistence probability
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_s.upper">s.upper</code></td>
<td>

<p>upper limit of 95% CI of persistence probability
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_arrival">arrival</code></td>
<td>

<p>either &quot;uniform&quot; or &quot;discrete&quot;.
assumption of the distribution of carcass arrival times: 
if &quot;uniform&quot; it is assumed that carcasses arrive and are removed at a constant rate 
over time. 
if &quot;discrete&quot; (default) it is assumed that all carcasses arrive every day at the same time and 
and persistence probability given for the first day corresponds to the time from
death to the time when carcass searches normally take place on the first day (the search 
does not necessary need to take place on the first day).
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_a">a</code></td>
<td>

<p>estimate for the proportion of killed animals that falled into the searched area. 
default is 1 (complete area searched).
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_a.lower">a.lower</code></td>
<td>

<p>lower limit of 95% CI of the proportion of killed animals that falled into the 
searched area. default is 1 (complete area searched).
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_a.upper">a.upper</code></td>
<td>

<p>upper limit of 95% CI of the proportion of killed animals that falled into the 
searched area. default is 1 (complete area searched).
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_pform">pform</code></td>
<td>

<p>formula used to estimate p, one of &quot;korner&quot;, &quot;huso&quot;, &quot;erickson&quot;, &quot;etterson&quot;
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_d">d</code></td>
<td>

<p>search interval, the number days (or any other time unit) between two searches
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_n">n</code></td>
<td>

<p>number of searches
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_j">J</code></td>
<td>

<p>vector of length of search intervals. This argument can only be used with pform=&quot;etterson&quot;. 
For the other methods regular search intervals are used and their length is given in the argument d.
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_maxn">maxn</code></td>
<td>

<p>maximal possible number of animals killed for which the posterior probability is estimated (should not be too high but also not be too low!)
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_nsim">nsim</code></td>
<td>

<p>number of Monte Carlo simulations
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_plot">plot</code></td>
<td>

<p>logical, TRUE = posterior probability is plotted
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_postdist">postdist</code></td>
<td>

<p>logical, TRUE = the posterior probability distribution of the number of fatalities is given in the output. See details.
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_k">k</code></td>
<td>

<p>numeric, factor of decrease of searcher efficiency with number of searches, see help to pkorner.
</p>
</td></tr>
<tr><td><code id="estimateN_+3A_x">x</code></td>
<td>

<p>vector of integers. The posterior probability of the number of killed animals being larger than x will be calculated.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either p (with p.lower and p.upper) OR f (with f.lower and f.upper), 
s (with s.lower and s.upper), n and d are needed. In the latter case, p is calculated
from f, s, n and d using the formula specified in the argument 'pform'.
</p>
<p>A documented code of this function if given in the Appendix of Korner-Nievergelt et al. (2011) J. Wildlife. Biol.
</p>
<p>If postdist is TRUE, the output is a list, if postdist is FALSE, the output is a named numeric vector. 
</p>


<h3>Value</h3>

<p>If postdist=FALSE, the function produces a vector with the median of the posterior distribution (&quot;estimate&quot;),
the 2.5% and the 97.5% quantiles (&quot;lower&quot;, and &quot;upper&quot;) and the Horvitz-Thompson estimate (&quot;HT.estimate&quot;, which equals
count/p). 
If postdist=TRUE, the output is a list with the following elements:
</p>
<table>
<tr><td><code>estimate</code></td>
<td>
<p>median of the posterior distribution</p>
</td></tr>
<tr><td><code>lower</code></td>
<td>
<p>2.5% quantile of the posterior distribution</p>
</td></tr>
<tr><td><code>upper</code></td>
<td>
<p>97.5% quantile of the posterior distribution</p>
</td></tr>
<tr><td><code>HT.estimate</code></td>
<td>
<p>Horvitz-Thompson estimate, i.e. count/p</p>
</td></tr>
<tr><td><code>P.true.larger.x</code></td>
<td>
<p>Posterior probability that the true mortality is larger than x.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>F. Korner-Nievergelt
</p>


<h3>References</h3>

<p>Erickson WP, Jeffrey J, Kronner K, Bay K (2004) Stateline Wind Project Wildlife. 
Monitoring Final Report, July 2001 - December 2003. - Technical report peer-reviewed 
by and submitted to FPL Energy, the Oregon Energy Facility Siting Council, and the Stateline 
Technical Advisory Committee, Oregon, USA, 105 pp<br />
Etterson, MA (2013) Hidden Markov models for estimating animal mortality from antropogenic 
hazards. Ecological Applications 23: 1915-1925<br />
Huso M (2010) An estimator of wildlife fatality from observed carcasses. Environmetrics 
22: 318-329<br />
Korner-Nievergelt F, Korner-Nievergelt P, Behr O, Niermann I, Brinkmann R, Hellriegel B (2011) 
A new method to determine bird and bat fatality at wind energy turbines from carcass searches.
Wildlife Biology 17: 350-363
Huso M, Dathorp D in prep.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+posteriorN">posteriorN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
estimateN(count=3, f=0.72, f.lower=0.62, f.upper=0.81, s=0.84, s.lower=0.64, 
            s.upper=0.94, d=2, pform="korner", n=100, maxn=500, nsim=1000, 
            plot=TRUE)

estimateN(count=3, f=0.72, f.lower=0.62, f.upper=0.81, s=0.84, s.lower=0.64, 
            s.upper=0.94, d=2, pform="huso", maxn=500, nsim=1000, plot=TRUE)

res.p &lt;- pkorner(f=0.72, f.lower=0.62, f.upper=0.81, s=0.84, s.lower=0.64, s.upper=0.94, 
                 d=2, n=100, CI=TRUE)
estimateN(count=3, p=res.p["p"], p.lower=res.p["2.5%"], p.upper=res.p["97.5%"])

</code></pre>

<hr>
<h2 id='ettersonEq14'>
Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925
</h2><span id='topic+ettersonEq14'></span>

<h3>Description</h3>

<p>Calculates the probability that a carcass that has fallen in the search area during 
n regular or irregular search intervals is found  by a searcher. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ettersonEq14(s, f, J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ettersonEq14_+3A_s">s</code></td>
<td>
<p>persistence probability, probability that a carcass persists a specific time interval 
(normally a day), i.e. daily persistence probability. Note that the same time unit 
as for the length of the search interval must be used.
</p>
</td></tr>
<tr><td><code id="ettersonEq14_+3A_f">f</code></td>
<td>
<p>searcher efficiency, i.e. the probability that a carcass present in the search area
is found during one search.
</p>
</td></tr>
<tr><td><code id="ettersonEq14_+3A_j">J</code></td>
<td>
<p>a vector containing the lengths of the search intervals.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This formula can handle irregular search intervals. It assumes constant persistence time
and constant searcher efficiency.  
Confidence intervals are not yet implemented, but a Monte Carlo confidence intervals 
will be calculated by the function estimateN with the argument form=&quot;etterson&quot;. 
</p>


<h3>Value</h3>

<p>the probability that a carcass that has fallen into the search area during the study
is found by the searcher.
</p>


<h3>Note</h3>

<p>In case of regular search intervals the functions ettersonEq14 and pkorner 
are equivalent (see first example). A mathematical proof for this equivalence is
given in the tutorial to carcass (Korner-Nievergelt et al., re-submitted to Wildlife Biology June 2014).
When search intervals are irregular, 
pkorner overestimates the detecton probability (i.e. underestimates fatality rates)
as you see in the second example below.
</p>


<h3>Author(s)</h3>

<p>M. A. Etterson
</p>


<h3>References</h3>

<p>Etterson, M.A. (2013) Hidden Markov models for estimating animal mortality from 
antropogenic hazards. Ecological Applications, 23, 1915-1925.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ettersonEq14v1">ettersonEq14v1</a></code>
<code><a href="#topic+ettersonEq14v2">ettersonEq14v2</a></code>
<code><a href="#topic+pkorner">pkorner</a></code>
<code><a href="#topic+phuso">phuso</a></code>
<code><a href="#topic+perickson">perickson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# in case of regular search intervals, the calculations below give the same results
ettersonEq14(s=0.8, f=0.8, J=c(3,3,3,3,3))
pkorner(s=0.8, f=0.8, d=3, n=5)


 # in case of irregular search intervals the function ettersonEq14 is more appropriate
ettersonEq14(s=0.8, f=0.8, J=c(3,5,1,4,2))
pkorner(s=0.8, f=0.8, d=mean(c(3,5,1,4,2)), n=5)

</code></pre>

<hr>
<h2 id='ettersonEq14v1'>
Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925, 
adapted so that persistence probability and searcher efficiency can vary 
with calender date
</h2><span id='topic+ettersonEq14v1'></span>

<h3>Description</h3>

<p>Calculates the probability that a carcass that has fallen in the search area during 
n regular or irregular search intervals is found  by a searcher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ettersonEq14v1(s, f, J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ettersonEq14v1_+3A_s">s</code></td>
<td>
<p>vector of persistence probabilities with N elements, where N is the number of days in
the full study period (i.e, N = sum(J)).
</p>
</td></tr>
<tr><td><code id="ettersonEq14v1_+3A_f">f</code></td>
<td>
<p>vector of searcher efficiency values (probabilities that a carcass 
present in the search area is found during one search) with n elements, 
where n is the number of searches performed.
</p>
</td></tr>
<tr><td><code id="ettersonEq14v1_+3A_j">J</code></td>
<td>
<p>a vector containing the lengths of the search intervals.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that persistence probability and searcher efficiency change over
time and that this change depends upon serial date within your study period. In other words, it
assumes that all carcasses in the environment on a given date experience the same scavenging probability
and detectability, regardless of how old the carcasses is.
However it does allow persistence probability and searcher efficiency to change with the calendar date.
</p>


<h3>Value</h3>

<p>the probability that a carcass that has fallen into the search area during the study
is found by the searcher.
</p>


<h3>Author(s)</h3>

<p>M. A. Etterson
</p>


<h3>References</h3>

<p>Etterson, M.A. (2013) Hidden Markov models for estimating animal mortality from 
antropogenic hazards. Ecological Applications, 23, 1915-1925.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ettersonEq14">ettersonEq14</a></code>
<code><a href="#topic+ettersonEq14v2">ettersonEq14v2</a></code>
<code><a href="#topic+pkorner">pkorner</a></code>
<code><a href="#topic+phuso">phuso</a></code>
<code><a href="#topic+perickson">perickson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
J &lt;- c(2,3,2,4,3,5,3,2,3,4)
s &lt;- plogis(seq(0.2, 2, length=sum(J)))
f &lt;- plogis(seq(1.5, 0.9, length=length(J)))
ettersonEq14v1(s,f,J)

</code></pre>

<hr>
<h2 id='ettersonEq14v2'>
Equation 14 of Etterson (2013) Ecological Applications 23, 1915-1925, 
adapted so that persistence probability and searcher efficiency can vary 
with age of the carcass
</h2><span id='topic+ettersonEq14v2'></span>

<h3>Description</h3>

<p>Calculates the probability that a carcass that has fallen in the search area during 
n regular or irregular search intervals is found  by a searcher.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ettersonEq14v2(s, f, J)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ettersonEq14v2_+3A_s">s</code></td>
<td>
<p>vector of persistence probabilities with N elements, where N is the number of days in
the full study period (i.e, N = sum(J)) (so N is the maximum number of days that
a carcass could be present in the environment).
</p>
</td></tr>
<tr><td><code id="ettersonEq14v2_+3A_f">f</code></td>
<td>
<p>vector of discovery probabilities with n elements, where n is the number of searches
performed.
</p>
</td></tr>
<tr><td><code id="ettersonEq14v2_+3A_j">J</code></td>
<td>
<p>a vector containing the lengths of the search intervals.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function assumes that persistence probability and searcher efficiency change over
time and that this change depends upon the time elapsed since the carcass was killed (carcass age). 
If you assume that the change in detectability of a carcass is due to its age, 
then this function may not be reliable because it indexes the searcher efficiency 
to the number of searches the carcass has been exposed to.
However, if you assume that searcher efficiency changes with the number of
searches a carcass was exposed to because the easy carcasses are found first, 
then this function should perform well.
</p>


<h3>Value</h3>

<p>the probability that a carcass that has fallen into the search area during the study
is found by the searcher.
</p>


<h3>Author(s)</h3>

<p>M. A. Etterson
</p>


<h3>References</h3>

<p>Etterson, M.A. (2013) Hidden Markov models for estimating animal mortality from 
antropogenic hazards. Ecological Applications, 23, 1915-1925.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ettersonEq14">ettersonEq14</a></code>
<code><a href="#topic+ettersonEq14v1">ettersonEq14v1</a></code>
<code><a href="#topic+pkorner">pkorner</a></code>
<code><a href="#topic+phuso">phuso</a></code>
<code><a href="#topic+perickson">perickson</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>J &lt;- c(2,3,2,4,3,5,3,2,3,4)
s &lt;- plogis(seq(0.2, 2, length=sum(J)))
f &lt;- plogis(seq(1.5, 0.9, length=length(J)))
ettersonEq14v2(s,f,J)
</code></pre>

<hr>
<h2 id='integrate.persistence'>
Integrate persistence probability over the discrete time intervals (e.g. days) 
to account for constant arrival of carcasses 
</h2><span id='topic+integrate.persistence'></span>

<h3>Description</h3>

<p>The function integrates the proportion of carcasses remaining on the ground (measured
at discrete time intervals after death) over the last time interval. This gives for each
discrete time point the proportion of carcasses that have arrived continuously 
(uniformly distributed) during the first time interval. This takes into account
that carcasses of the same cohort (arrived during the same time interval) can 
be of different age (max. age difference is length of time interval, e.g one day in most studies).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>integrate.persistence(s, n = 20, d = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="integrate.persistence_+3A_s">s</code></td>
<td>

<p>Either a number or a numeric vector. If a number is given (which should be the probability that a 
carcass persists one time interval, e.g. 24 hours), an exponential survivor
function (constant persistence probability) is assumed and the proportion of carcasses
persisting until the end of every time interval is calculated. Thus, the function returns a vector. 
The first number is the proportion of carcasses remaining until the end of the first time interval,
which is the time interval during which the carcasses have continuously arrived at a constant rate. 
The second number gives the proportion of carcasses that have arrived during the first time interval 
and that are still persisting until the end of the second time interval, a.s.o. This proportion is calculated
up to the n-th time interval.
If a vector is given, this vector can be either the proportion of carcasses remaining after 
every time interval after death (&quot;survivor function&quot;) or the age dependent probability 
to persist one time interval (e.g. daily persistence probability). In the first case, 
the function returns the proportion of persisting carcasses after each time interval
assuming that they arrived at a constant rate during the first time interval. In 
the second case the same integration leads to a average of the persistence probability
at time t and t-1 and can thus be seen as a correction for the different ages of the
carcasses belonging to the same cohort.
ATTENTION: if you use an exponential survival model (constant persistence probability) together
with the function ettersonEqv2 that requires daily persistence probabilities rather than survivor 
functions, you must not provide s as a single number here. Use rep(s, n) in this case! 
</p>
</td></tr>
<tr><td><code id="integrate.persistence_+3A_n">n</code></td>
<td>

<p>number of time intervals for which the proportion of persisting carcasses is calculated, default is 20
</p>
</td></tr>
<tr><td><code id="integrate.persistence_+3A_d">d</code></td>
<td>

<p>This argument is only needed by the function estimateN, where n is the number of searches and
d the search interval. Therefore, the number of days of the study is n*d and it is reasonable
to calcualte the persistence probabilities for a maximum time span that equals the study length. 
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>IMPORTANT: if you set the argument &quot;arrival='uniform'&quot; in the estimateN function, you must 
not use the function integrate.persistence prior to use the estimateN function. Since
estimateN does this integration when &quot;arrival='uniform'&quot;. But the integrate.persistence
function is useful in combination with the function pkorner, phuso, perikson, and all
etterson-formulas.
</p>


<h3>Value</h3>

<p>A vector containing the proportion of carcasses of one cohort of carcasses (that
have arrived at a constant rate during the first time interval) that persist until the
end of n time intervals. 
</p>


<h3>Author(s)</h3>

<p>F. Korner
</p>


<h3>References</h3>

<p>Software in prep by Dan Dalthorp and Manuela Huso
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimateN">estimateN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>integrate.persistence(0.5)
integrate.persistence(c(0.8,0.7,0.6,0.55))
</code></pre>

<hr>
<h2 id='perickson'>
Carcass detection probability acording to Erickson et al. 2004
</h2><span id='topic+perickson'></span>

<h3>Description</h3>

<p>Calculates carcass detection probability based on persistence time, searcher efficiency, search interval and duration of study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>perickson(t.bar=NULL, s, f, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="perickson_+3A_t.bar">t.bar</code></td>
<td>

<p>mean carcass persistence time in days (or another time unit)
</p>
</td></tr>
<tr><td><code id="perickson_+3A_s">s</code></td>
<td>

<p>mean (e.g. daily) carcass persistence probability. 
</p>
</td></tr>
<tr><td><code id="perickson_+3A_f">f</code></td>
<td>

<p>searcher efficiency: probability that a carcass present on the study plot is detected by a searcher during a seach.
</p>
</td></tr>
<tr><td><code id="perickson_+3A_d">d</code></td>
<td>

<p>search interval: time (in days) between two searches
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time measurements (search interval and carcass persistence time or persistence probability) should be given in the same unit. 
Either t.bar or s has to be provided.
</p>


<h3>Value</h3>

<p>a proportion: the probability that an animal that dies during the study period on the study plot is detected by a searcher
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Erickson WP, Jeffrey J, Kronner K, Bay K (2004) Stateline Wind Project Wildlife. Monitoring Final Report, July 2001 - December 2003. - Technical report peer-reviewed by and submitted to FPL Energy, the Oregon Energy Facility Siting Council, and the Stateline Technical Advisory Committee, Oregon, USA, 105 pp
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phuso">phuso</a></code>
<code><a href="#topic+pkorner">pkorner</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>perickson(t.bar=30, f=0.8, d=1)
</code></pre>

<hr>
<h2 id='persistence'>
Times until removal for brown mice carcasses 
</h2><span id='topic+persistence'></span>

<h3>Description</h3>

<p>Experimental data to measure persistence time of bat-sized mammal carcasses. In total, 595 brown mice and 41 bat carcasses have been
put on the ground at 30 different sites (turbineID). During 14 days, the carcasses have been observed and the number of days until their
disappearance was noted. All carcasses that did not disappear until day 14 were marked as censored (status=0) in the data.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(persistence)</code></pre>


<h3>Format</h3>

<p>A data frame with 636 observations on the following 3 variables.
</p>

<dl>
<dt><code>turbineID</code></dt><dd><p>a factor with site or turbine names</p>
</dd>
<dt><code>perstime</code></dt><dd><p>a numeric vector containing the days until disappearance (persistence times)</p>
</dd>
<dt><code>status</code></dt><dd><p>a numeric vector 1 = disappearance is observed, 0 = no disappearance until end of study (censored)</p>
</dd>
</dl>



<h3>Details</h3>

<p>Due to conservation reasons, experiments to estimate carcass persistence times have been conducted with brown mice instead of bat carcasses. 
There has been concern that bats have longer persistence times than mice. In our data, during the first four days removal probability of mice and bats were identical. 
After four days, bats seem to be removed less likely. However, this difference was based on such low sample size that we do not dare to claim any difference at the moment.
For the moment, we can say that it is probably save to use mice when the search interval is less than four days. But for longer search intervals, it may be better to use bats to measure carcass persistence probability.<br />
</p>


<h3>Source</h3>

<p>Niermann, I., R. Brinkmann, F. Korner-Nievergelt, and O. Behr. 2011. Systematische Schlagopfersuche - Methodische Rahmenbedingungen, statistische Analyseverfahren und Ergebnisse. Pages 40-115 in R. Brinkmann, O. Behr, I. Niermann, and M. Reich, editors. Entwicklung von Methoden zur Untersuchung und Reduktion des Kollisionsrisikos von Fledermaeusen an Onshore-Windenergieanlagen. Cuvillier Verlag, Goettingen.
</p>


<h3>References</h3>

<p>Niermann, I., R. Brinkmann, F. Korner-Nievergelt, and O. Behr. 2011. Systematische Schlagopfersuche - Methodische Rahmenbedingungen, statistische Analyseverfahren und Ergebnisse. Pages 40-115 in R. Brinkmann, O. Behr, I. Niermann, and M. Reich, editors. Entwicklung von Methoden zur Untersuchung und Reduktion des Kollisionsrisikos von Fledermaeusen an Onshore-Windenergieanlagen. Cuvillier Verlag, Goettingen.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(persistence)
head(persistence)
</code></pre>

<hr>
<h2 id='persistence.prob'>
Estimates carcass persistence probability based on carcass removal experiment data
</h2><span id='topic+persistence.prob'></span>

<h3>Description</h3>

<p>This function either uses a Cox proportional hazard model or an exponential model (if persistence probability can assumed to be constant over time) to estimate daily persistence probabilities of carcasses. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>persistence.prob(turbineID, perstime, status, pers.const = FALSE, R = 10000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="persistence.prob_+3A_turbineid">turbineID</code></td>
<td>

<p>factor, character or numeric vector with name of the turbines or sites for which the carcass persistence probability should be estimated separatedly<br />
</p>
</td></tr>
<tr><td><code id="persistence.prob_+3A_perstime">perstime</code></td>
<td>
  
<p>numeric vector with the persistence times for each object (e.g. in days)
</p>
</td></tr>
<tr><td><code id="persistence.prob_+3A_status">status</code></td>
<td>

<p>indicator variable of observed removal (1= removal has been observed, 0 = object was still there at the end of the observation period)<br />
</p>
</td></tr>
<tr><td><code id="persistence.prob_+3A_pers.const">pers.const</code></td>
<td>

<p>logical value indicating whether a constant persistenc probability over time can be assumed. default is FALSE. If FALSE, a Cox proportional hazard model is used and for each turbine/site the estimated proportion of remaining objects is given for each day. If TRUE, an exponential model is fitted and the estimated daily persistence probability is give for each turbine/site.
</p>
</td></tr>
<tr><td><code id="persistence.prob_+3A_r">R</code></td>
<td>

<p>number of Monte Carlo simulations used to obtain the 95 percent confidence intervals of the estimated persistence probabilities from the exponential model
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that there is increasing evidence in the literature that carcass persistence probability increases with the age of a carcass. Thus you are saver to use non-constant persistence probabilities unless you have tested, how seriously an assumption of constant persistence probability influences your results. 
</p>


<h3>Value</h3>

<p>If you do not assume constant persistence probability, the function returns a list:
</p>
<table>
<tr><td><code>persistence.prob</code></td>
<td>
<p>matrix with estimated proportion of remaining carcasses after each time indicated on the rows for each turbine/site indicated on the column</p>
</td></tr>
<tr><td><code>estpers.lwr</code></td>
<td>
<p>the lower limits of the 95 percent confidence intervals</p>
</td></tr>
<tr><td><code>estpers.upr</code></td>
<td>
<p>the upper limits of the 95 percent confidence intervals</p>
</td></tr>
</table>
<p>If you assume constant persistence probability, the function returns a data frame with the following variables:<br />
turbineID: name of the turbine/site<br />
persistence.prob: estimated daily persistence probability<br />
lower: lower limit of the 95 percent confidence interval of the estimated persistence probability<br />
upper: upper limit of the 95 percent confidence interval of the estimated persistence probability<br />
mean.persistence.time: estimated mean persistence time<br /> 
</p>


<h3>Note</h3>

<p>Whether the models used in this function fits to your data is not in the responsibility of the author!
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Cox, D. R. 1972. Regression models and life-tables (with discussion). Journal of the Royal Statistical Society B 34:187-220.<br />
Klein, J. P. and M. L. Moeschberber. 2003. Survival Analysis, Techiques for Censored and Truncated Data. Springer, New York.
</p>


<h3>See Also</h3>

<p><code><a href="survival.html#topic+coxph">coxph</a></code>
<code><a href="survival.html#topic+survreg">survreg</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(persistence)
persistence.prob(persistence$turbineID, persistence$perstime, persistence$status)
persistence.prob(persistence$turbineID, persistence$perstime, persistence$status, 
    pers.const=TRUE)
</code></pre>

<hr>
<h2 id='phuso'>
Carcass detection probability acording to Huso 2010
</h2><span id='topic+phuso'></span>

<h3>Description</h3>

<p>Calculates carcass detection probability based on persistence time, searcher 
efficiency, search interval and duration of study. Persistence time 
obtained by any survival model (e.g. Exponential, Weibull, Log-Normal,...) can
be given (but see below). Alternatively to persistence time, persistence probability can be given,
In this case, the exponential model (constant persistence probability) is used to transform
persistence probability into mean persistence time. <br />
An argument shape and distribution for other than the Exponential persistence model will be provided soon.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phuso(s, t.bar, f, d)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="phuso_+3A_s">s</code></td>
<td>

<p>persistence probability: probability that a carcass remains on the study plot for one day. 
This parameter is only used when t.bar is not provided. Note that if s is given instead
of t.bar, an exponential survival function (constant persistence probability) is used.
</p>
</td></tr>
<tr><td><code id="phuso_+3A_t.bar">t.bar</code></td>
<td>

<p>mean persistence time (in days). Alternatively, s can be provided. Then, an exponential persistence model is assumed.  
</p>
</td></tr>
<tr><td><code id="phuso_+3A_f">f</code></td>
<td>

<p>searcher efficiency: probability that a carcass present on the study plot is detected by a searcher during a seach.
</p>
</td></tr>
<tr><td><code id="phuso_+3A_d">d</code></td>
<td>

<p>search interval: time (in days) between two searches
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time measurements (search interval) and reference time units (persistence probability) should be given in the same unit. 
</p>


<h3>Value</h3>

<p>a proportion: the probability that an animal that dies during the study period on the study plot is detected by a searcher
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Huso M (2010) An estimator of wildlife fatality from observed carcasses. Environmetrics 22: 318-329
</p>


<h3>See Also</h3>

<p><code><a href="#topic+perickson">perickson</a></code>
<code><a href="#topic+pkorner">pkorner</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>phuso(s=0.8, f=0.7, d=7)
</code></pre>

<hr>
<h2 id='pkorner'>
Carcass detection probability acording to Korner-Nievergelt et al. 2011
</h2><span id='topic+pkorner'></span>

<h3>Description</h3>

<p>Calculates carcass detection probability based on persistence probability, searcher efficiency, search interval and duration of study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pkorner(s, s.lower=NA, s.upper=NA, f, f.lower=NA, f.upper=NA, d, n, k=0.25, 
        search.efficiency.constant=TRUE, CI=FALSE, nsim=1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pkorner_+3A_s">s</code></td>
<td>

<p>persistence probability: Probability that a carcass remains on the study plot for one day (or another time unit). 
Scalar in case of constant persistence probability, vector with probabilities to 
persist until each day after death ('survivor function', i.e. proportion of remaining carcasses for
each day after death) in case of non-constant persistence probabilities.
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_s.lower">s.lower</code></td>
<td>

<p>lower limit of 95% CI of persistence probability
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_s.upper">s.upper</code></td>
<td>

<p>upper limit of 95% CI of persistence probability
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_f">f</code></td>
<td>

<p>searcher efficiency: Probability that a carcass present on the study plot is detected by a searcher during a seach.
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_f.lower">f.lower</code></td>
<td>

<p>lower limit of 95% CI of searcher efficiency
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_f.upper">f.upper</code></td>
<td>

<p>upper limit of 95% CI of searcher efficiency
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_d">d</code></td>
<td>

<p>search interval: time (in days) between two searches
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_n">n</code></td>
<td>

<p>number of searches: n*d = duration of study
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_k">k</code></td>
<td>

<p>Factor by which the search efficiency is multiplied after each search for a specific carcass (see details).
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_search.efficiency.constant">search.efficiency.constant</code></td>
<td>

<p>TRUE if search efficiency is constant over time, FALSE if it decreases by a factor k with each search.
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_ci">CI</code></td>
<td>

<p>TRUE if 95% CI should be calculated based on a beta distribution and Monte Carlo simulations, FALSE otherwise.
</p>
</td></tr>
<tr><td><code id="pkorner_+3A_nsim">nsim</code></td>
<td>

<p>number of Monte Carlo simulations
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Time measurements (search interval) and reference time units (persistence probability) should be given in the same unit.
The argument k together with search.efficiency.constant=FALSE can be given to account for the fact that during the first search 
carcasses with high detectability are found overproportionatedly, whereas carcasses hard to find remain on the study plot. Thus with each
search, searcher efficiency decreases by the factor k. If search.efficiency.constant=TRUE the value given at the argument k is ignored (i.e. k=1). 
If one assumes that persistence probability is not constant, the function <code><a href="#topic+persistence.prob">persistence.prob</a></code> could be used to provide the data for <code>s</code> (see examples below).
An estimate for s should be provided for every day for a sufficient time span, e.g. 14 days. Missing estimates for intermediate days have to be interpolated. 
After the last day with an s provided, the function assumes that the proportion of persisting carcasses is zero, e.g. s is assumed to be zero from day 15 and onwards if s is a vector of length 14.
</p>


<h3>Value</h3>

<p>a proportion: the probability that an animal that dies during the study period on the study plot is detected by a searcher
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Korner-Nievergelt F, Korner-Nievergelt P, Behr O, Niermann I, Brinkmann R, Hellriegel B (2011) A new method to determine bird and bat fatality at wind energy turbines from carcass searches. Wildlife Biology 17: 350-363
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phuso">phuso</a></code>,
<code><a href="#topic+perickson">perickson</a></code>,
<code><a href="#topic+persistence.prob">persistence.prob</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Data
  f &lt;- 0.72
  s &lt;- 0.8
  data(persistence)
  attach(persistence)
  sv &lt;- persistence.prob(turbineID, perstime, status)$persistence.prob[,1]
  sv.lower &lt;- persistence.prob(turbineID, perstime, status)$lower[,1]
  sv.upper &lt;- persistence.prob(turbineID, perstime, status)$upper[,1]
  n &lt;- 4
  d &lt;- 3
  
### Constant search efficiency and constant persistence probability
  pkorner(s=s, f=f, d=d, n=n)
  pkorner(s=s, s.lower=0.6, s.upper=0.9, f=f, f.lower=0.6, f.upper=0.8, 
    d=d, n=n, CI=TRUE)

### Decreasing search efficiency and constant persistence probability
  pkorner(s=s, f=f, d=d, n=n, k=0.25, search.efficiency.constant=FALSE)

### Constant search efficiency and decreasing persistence probability
  pkorner(s=sv, f=f, d=d, n=n)

### Decreasing search efficiency and decreasing persistence probability
  pkorner(s=sv, f=f, d=d, n=n, search.efficiency.constant=FALSE)
  pkorner(s=sv, s.lower=sv.lower, s.upper=sv.upper, f=f, f.lower=0.6, 
    f.upper=0.8, d=d, n=n, search.efficiency.constant=FALSE, CI=TRUE)

</code></pre>

<hr>
<h2 id='posteriorN'>
Posterior distribution of the number of fatalities based on the number of carcasses found and the probability of finding a carcass.
</h2><span id='topic+posteriorN'></span><span id='topic+posterior.N'></span>

<h3>Description</h3>

<p>This function gives the posterior distribution of the number of fatalities based on the number of carcasses counted during carcass searches and the probability of detecting a carcass. 
The function uses the theorem of Bayes. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posteriorN(p, nf = 0, maxN = 1000, ci.int = 0.95, plot = TRUE,
              dist = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="posteriorN_+3A_p">p</code></td>
<td>

<p>probability of finding a carcass. This probability can be obtained by e.g. pkorner, phuso or perickson.
</p>
</td></tr>
<tr><td><code id="posteriorN_+3A_nf">nf</code></td>
<td>

<p>the number of carcasses found
</p>
</td></tr>
<tr><td><code id="posteriorN_+3A_maxn">maxN</code></td>
<td>

<p>the maximal number of fatalities for which a posterior densitiy should be given. It should be higher than the upper tail (density larger 0.0001) of the posterior distribution (there is a warning if not). If maxN is lower than the lower edge of the posterior distribution, an error is produced. 
</p>
</td></tr>
<tr><td><code id="posteriorN_+3A_ci.int">ci.int</code></td>
<td>

<p>length of the credible interval that should be given. Default is 0.95.
</p>
</td></tr>
<tr><td><code id="posteriorN_+3A_plot">plot</code></td>
<td>

<p>if TRUE the posterior distribution is plotted
</p>
</td></tr>
<tr><td><code id="posteriorN_+3A_dist">dist</code></td>
<td>

<p>if TRUE the posterior density is given for all elements in 0:maxN
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>interval</code></td>
<td>
<p>vector of length 2 containing the lower and upper limit of the interval specified in the argument ci.int</p>
</td></tr>
<tr><td><code>expected</code></td>
<td>
<p>median of the posterior distribution of the number of fatalities</p>
</td></tr>
<tr><td><code>HT.estimate</code></td>
<td>
<p>Horvitz-Thompson estimate, i.e. nf/p</p>
</td></tr>
<tr><td><code>pN</code></td>
<td>
<p>posterior density for each element in 0:maxN number of fatalities</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The function does not take into account the uncertainty of the estimate for the detection probability. If you want do account for this uncertainty, use the function estimateN.
For reporting bugs in the code, we would like to thank A. Marcia Barbosa.
</p>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Korner-Nievergelt F, Korner-Nievergelt P, Behr O, Niermann I, Brinkmann R, Hellriegel B (2011) A new method to determine bird and bat fatality at wind energy turbines from carcass searches. Wildlife Biology 17: 350-363
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimateN">estimateN</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>posteriorN(p=0.5, nf=3, dist=TRUE, maxN=15)
</code></pre>

<hr>
<h2 id='search.efficiency'>
Estimates detection probability per person and visibility classes using a binomial model
</h2><span id='topic+search.efficiency'></span>

<h3>Description</h3>

<p>The function estimates detection probability per visibility class and person.
A binomial mixed model is used with vegetation density as fixed effect and person as random factor, when data of more than 2 persons are available.
The number of found and the number of overseen items have to be provided per person and visibility class (one line per observer and visibility class). When only one visibility class is available, the variable visibility must be provided with only one entry. It does not matter what.
The detection probabilities are given per person with a 95% credible interval. An average vegetation density specific detection probabilty over all persons is given in addition. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>search.efficiency(dat=NA, person=NA, visibility=NA, detected=NA,
    notdetected=NA, nsim = 1000)
</code></pre>


<h3>Arguments</h3>

<p>The search efficiancy data may be provided as a <code>data.frame</code> containing all data or, alternatively, as seperate vectors. If no visibility classes are available, the variable visibility should be a vector with the same length as the others containing a single value (e.g. &quot;not_measured&quot;).
</p>
<table>
<tr><td><code id="search.efficiency_+3A_dat">dat</code></td>
<td>
<p><code>Data.frame</code> containing the following columns:<br /> 
<code>person</code>: names of the persons who searched<br />
<code>visibility</code>: visibility class<br />
<code>detected</code>: number of detected items<br />
<code>notdetected</code>: number of not detected items<br /></p>
</td></tr>  
<tr><td><code id="search.efficiency_+3A_person">person</code></td>
<td>
<p>vector with names of the persons who searched</p>
</td></tr>
<tr><td><code id="search.efficiency_+3A_visibility">visibility</code></td>
<td>
<p>vector with visibility classes</p>
</td></tr>
<tr><td><code id="search.efficiency_+3A_detected">detected</code></td>
<td>
<p>numeric vector with number of detected items</p>
</td></tr>
<tr><td><code id="search.efficiency_+3A_notdetected">notdetected</code></td>
<td>
<p>numeric vector with number of not detected items</p>
</td></tr>
<tr><td><code id="search.efficiency_+3A_nsim">nsim</code></td>
<td>

<p>the number of simulations from the posterior distributions of the model parameters used to construct the 95 percent credible intervals
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses the function glmer of the package lme4 and the function sim of the package arm.
</p>


<h3>Value</h3>

<p>A list with two elements of class data.frame
</p>
<table>
<tr><td><code>f.perperson</code></td>
<td>
<p>a <code>data.frame</code> with the estimated detection probabilities per person and visibility class, its lower and uper limit of the 95% credible interval and its standard error</p>
</td></tr>
<tr><td><code>f.average</code></td>
<td>
<p>a data.frame with the estimated detection probabilities per visibility class averaged over the persons</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Gelman A, Hill J (2007) Data Analysis Using Regression and Multilevel and Hierarchical Models. Cambridge: Cambridge University Press.
</p>
<p>Niermann I, Brinkmann R, Korner-Nievergelt F, Behr O (2011) Systematische Schlagopfersuche - Methodische Rahmenbedingungen, statistische Analyseverfahren und Ergebnisse. In: Brinkmann R, Niermann I, Behr O, editors. Entwicklung von Methoden zur Untersuchung und Reduktion des Kollisionsrisikos von Fledermaeusen an Onshore-Windenergieanlagen Goettingen: Cuvillier Verlag. pp. 40-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(searches)
searches

# Call to the function with data provided as data.frame:
## Not run: search.efficiency(searches)

# Alternative:
per &lt;- searches$person
visi &lt;- searches$visibility
det &lt;- searches$detected
notdet &lt;- searches$notdetected
## Not run: search.efficiency(person=per, visibility=visi, detected=det, notdetected=notdet)

</code></pre>

<hr>
<h2 id='searches'>
Data of a searcher efficiency trial
</h2><span id='topic+searches'></span>

<h3>Description</h3>

<p>Data containing the number of seen and not-seen items of a searcher efficiency trial performed in 3 different vegetation densities (visibilities) and for various persons.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(searches)</code></pre>


<h3>Format</h3>

<p>A data frame with 17 observations on the following 4 variables.
</p>

<dl>
<dt><code>person</code></dt><dd><p>a factor with the names of the persons</p>
</dd>
<dt><code>visibility</code></dt><dd><p>a factor with visibility classes (vegetation densities)</p>
</dd>
<dt><code>detected</code></dt><dd><p>a numeric vector indicating the number of found items</p>
</dd>
<dt><code>notdetected</code></dt><dd><p>a numeric vector indicating the number of not found items</p>
</dd>
</dl>



<h3>Source</h3>

<p>Niermann I, Brinkmann R, Korner-Nievergelt F, Behr O (2011) Systematische Schlagopfersuche - Methodische Rahmenbedingungen, statistische Analyseverfahren und Ergebnisse. <em>In:</em> Brinkmann R, Niermann I, Behr O, editors. Entwicklung von Methoden zur Untersuchung und Reduktion des Kollisionsrisikos von Fledermaeusen an Onshore-Windenergieanlagen Goettingen: Cuvillier Verlag. pp. 40-115.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(searches)
str(searches)
search.efficiency(searches)
</code></pre>

<hr>
<h2 id='shapeparameter'>
Shapeparameters of a beta-distribution from the mean, the lower and upper limit of the 95% confidence or credible interval
</h2><span id='topic+shapeparameter'></span>

<h3>Description</h3>

<p>The function returens the shapeparameters a ad b of a beta-distribution from the mean, the lower and upper limit of the 95% confidence or credible interval.
The derivation from mean and se to the shapeparameters of a beta-distribution is done by the method of moments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>shapeparameter(m, lwr=NA, upr=NA, se=NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="shapeparameter_+3A_m">m</code></td>
<td>

<p>mean
</p>
</td></tr>
<tr><td><code id="shapeparameter_+3A_lwr">lwr</code></td>
<td>

<p>lower limit of the 95percent confidence/credible interval
</p>
</td></tr>
<tr><td><code id="shapeparameter_+3A_upr">upr</code></td>
<td>

<p>upper limit of the 95percent confidence/credible interval
</p>
</td></tr>
<tr><td><code id="shapeparameter_+3A_se">se</code></td>
<td>

<p>standard error of the proportion
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Either se or both lwr and upr has to be given. The result may be more reliable if se is given, since the calculation is based on se.
If the lwr and upr limits of the 95% confidence interval are given, se is estimated as 1/4 times the width of the 95% confidence interval.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>a</code></td>
<td>
<p>parameter a of a beta-distribution</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>parameter b of a beta-distribution</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Fraenzi Korner-Nievergelt
</p>


<h3>References</h3>

<p>Gelman et al. (2004)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a &lt;- shapeparameter(0.8, 0.72, 0.88)$a
b &lt;- shapeparameter(0.8, 0.72, 0.88)$b
x &lt;- seq(0, 1, by=0.01)
y &lt;- dbeta(x, a, b)
plot(x, y, type="l")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
