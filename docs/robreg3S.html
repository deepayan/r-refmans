<!DOCTYPE html><html><head><title>Help for package robreg3S</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {robreg3S}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#robreg3S'><p>Robust regression estimation and inference in the presence of cellwise and casewise contamination</p></a></li>
<li><a href='#simulation-tools'><p>Data generator for simulation study on cell- and case-wise contamination</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Three-Step Regression and Inference for Cellwise and Casewise
Contamination</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2015-12-28</td>
</tr>
<tr>
<td>Author:</td>
<td>Andy Leung, Hongyang Zhang, Ruben Zamar</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andy Leung &lt;andy.leung@stat.ubc.ca&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Three-step regression and inference for cellwise and casewise contamination.</td>
</tr>
<tr>
<td>Depends:</td>
<td>GSE, MASS</td>
</tr>
<tr>
<td>Imports:</td>
<td>robustbase</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2015-12-30 02:02:57 UTC; Andy</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2015-12-30 08:36:45</td>
</tr>
</table>
<hr>
<h2 id='robreg3S'>Robust regression estimation and inference in the presence of cellwise and casewise contamination</h2><span id='topic+robreg3S'></span><span id='topic+coef.robreg3S'></span><span id='topic+print.robreg3S'></span><span id='topic+summary.robreg3S'></span><span id='topic+confint.robreg3S'></span>

<h3>Description</h3>

<p>Finds 3S-robust regression estimator using the adaptive consistent filter. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	robreg3S(y, x, dummies=NULL, filter=TRUE, alpha=0.20, K=5, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="robreg3S_+3A_y">y</code></td>
<td>
<p>vector of responses.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_x">x</code></td>
<td>
<p>matrix of the numerical variables.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_dummies">dummies</code></td>
<td>
<p>matrix of the dummy covariates, i.e., where each column are 0&ndash;1 vectors.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_filter">filter</code></td>
<td>
<p>logical, whether the filtering is used. Default value is TRUE.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_alpha">alpha</code></td>
<td>
<p>1-alpha upper quantile (and alpha lower quantile) of the covariate distribution used in tail comparison in the first step. An exponential tail is used as the reference distribution. Default value is 0.20.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_k">K</code></td>
<td>
<p>number of alternating M-S iterations in the estimation of the coefficients of the dummy covariates. Default value is 5. See Leung et al. for more details.</p>
</td></tr>
<tr><td><code id="robreg3S_+3A_...">...</code></td>
<td>
<p>optional arguments to be used in the computation of GSE in the second step. See <code><a href="GSE.html#topic+GSE">GSE</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function computes 3S-robust regression as described in Leung et al. (2015).  
</p>
<p>If the model contains dummy variables (i.e., <code>dummies != NULL</code>),
3S-regression is computed using an iterative algorithm as described in Leung et al. (2015).
Briefly, the algorithm first estimates the coefficients of the dummies using
an M-estimator of regression and the coefficients of the continuous
covariates using the original 3S-regression. See Leung et al. (2015) for more
details.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>Summary.Table</code></td>
<td>
<p>Matrix of information available about the
estimator. It contains regression coefficients, and for <code>dummies != NULL</code>, columns
for the standard error, t-statistic, and p-value.</p>
</td></tr>
<tr><td><code>coef</code></td>
<td>
<p>vector of regression coefficients.</p>
</td></tr>
<tr><td><code>acov</code></td>
<td>
<p>matrix of the asymptotic covariate matrix, only for <code>dummies != NULL</code>.</p>
</td></tr>
<tr><td><code>resid</code></td>
<td>
<p>vector of residuals, that is the response minus the fitted values.</p>
</td></tr>
<tr><td><code>sigma.hat</code></td>
<td>
<p>the estimated residual standard error.</p>
</td></tr>
<tr><td><code>MD</code></td>
<td>
<p>the squared Mahalanobis distances of each observation based on the continuous covariates to the
generalized location S-estimator with respect to the generalized scatter S-estimator.</p>
</td></tr> 
<tr><td><code>xfilter</code></td>
<td>
<p>filtered matrix of the numerical variables from Step 1 of the estimator.</p>
</td></tr>
<tr><td><code>ximpute</code></td>
<td>
<p>matrix of the numerical variables with filtered cells imputed from Step 2 of the estimator.</p>
</td></tr>
<tr><td><code>weight</code></td>
<td>
<p>vector of the weights used in the estimation of the location generalized S-estimator. Not meant to be accessed.</p>
</td></tr>
<tr><td><code>Syx</code></td>
<td>
<p>estimated generalized S-scatter from Step 2. Not meant to be accessed.</p>
</td></tr>
<tr><td><code>myx</code></td>
<td>
<p>estimated generalized S-location from Step 2. Not meant to be accessed.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Hongyang Zhang, Ruben H. Zamar</p>


<h3>References</h3>

<p>Leung, A. , Zamar, R.H., and Zhang, H. Robust regression estimation and inference in the presence of cellwise and casewise contamination. arXiv:1509.02564.
</p>


<h3>See Also</h3>

<p><code><a href="GSE.html#topic+GSE">GSE</a></code>, <code><a href="#topic+generate.cellcontam.regress">generate.cellcontam.regress</a></code>, <code><a href="#topic+generate.casecontam.regress">generate.casecontam.regress</a></code>,
<code><a href="#topic+generate.casecontam.regress.dummies">generate.casecontam.regress.dummies</a></code>, <code><a href="#topic+generate.casecontam.regress.dummies">generate.casecontam.regress.dummies</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Boston housing data
data(Boston, package="MASS")
boston &lt;- Boston; rm(Boston)
boston$crim &lt;- log(boston$crim)
boston$nox &lt;- boston$nox^2
boston$rm &lt;- boston$rm^2
boston$dis &lt;- log(boston$dis)
boston$lstat &lt;- log(boston$lstat)
boston$medv &lt;- log(boston$medv)
boston$black &lt;- boston$black/1000
boston$age &lt;- boston$age/100
boston$tax &lt;- boston$tax/100
boston$indus &lt;- boston$indus/100
boston &lt;- subset( boston, select=c(medv, crim, nox, rm, age, dis, tax, ptratio, black, lstat) )

## LS, MM, 3S
set.seed(100)
fit.LS &lt;- lm(medv ~  ., data=boston)
fit.MM &lt;- robustbase::lmrob(medv ~  ., data=boston)
fit.2S &lt;- robreg3S( y=boston$medv, x=as.matrix(subset(boston,select=-medv)), filter = FALSE )
fit.3S &lt;- robreg3S( y=boston$medv, x=as.matrix(subset(boston,select=-medv)) )

## Compare estimated coefficients
nrow(boston) *sum(( coef(fit.LS)[-1] - coef(fit.3S)[-1])^2* apply(boston[,-1], 2, mad)^2)
nrow(boston) *sum(( coef(fit.MM)[-1] - coef(fit.3S)[-1])^2* apply(boston[,-1], 2, mad)^2)
nrow(boston) *sum(( coef(fit.2S)[-1] - coef(fit.3S)[-1])^2* apply(boston[,-1], 2, mad)^2)

## Summary table
summary(fit.3S)

</code></pre>

<hr>
<h2 id='simulation-tools'>Data generator for simulation study on cell- and case-wise contamination</h2><span id='topic+generate.randbeta'></span><span id='topic+generate.cellcontam.regress'></span><span id='topic+generate.casecontam.regress'></span><span id='topic+generate.cellcontam.regress.dummies'></span><span id='topic+generate.casecontam.regress.dummies'></span>

<h3>Description</h3>

<p>Includes the data generator for the simulation study on cell- and case-wise contamination that appears on Leung et al. (2015). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>generate.randbeta(p) 

generate.cellcontam.regress(n, p, A, sigma, b, k, cp)

generate.casecontam.regress(n, p, A, sigma, b, l, k, cp)

generate.cellcontam.regress.dummies(n, p, pd, probd, A, sigma, b, k, cp)

generate.casecontam.regress.dummies(n, p, pd, probd, A, sigma, b, l, k, cp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulation-tools_+3A_n">n</code></td>
<td>
<p>integer indicating the number of observations to be generated.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_p">p</code></td>
<td>
<p>integer indicating the number of continuous variables to be generated.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_pd">pd</code></td>
<td>
<p>integer indicating the number of dummy variables to be generated.</p>
</td></tr>  
<tr><td><code id="simulation-tools_+3A_probd">probd</code></td>
<td>
<p>vector of quantiles of length <code>pd</code>. To generate dummy variables 
<code>pd</code> continuous variables are first generated. Then, the variables are dichotomize
at normal quantiles of <code>probd</code>.</p>
</td></tr>  
<tr><td><code id="simulation-tools_+3A_a">A</code></td>
<td>
<p>a correlation matrix. See also <code><a href="GSE.html#topic+generate.randcorr">generate.randcorr</a></code>.</p>
</td></tr> 
<tr><td><code id="simulation-tools_+3A_sigma">sigma</code></td>
<td>
<p>residual standard deviation.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_b">b</code></td>
<td>
<p>vector of regression coefficients.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_k">k</code></td>
<td>
<p>size of cellwise outliers and vertical outliers. See Leung et al. for details.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_l">l</code></td>
<td>
<p>size of leverage outliers. See Leung et al. for details.</p>
</td></tr>
<tr><td><code id="simulation-tools_+3A_cp">cp</code></td>
<td>
<p>proportion of cell- or case-wise contamination. Maximum of 10% for cellwise and 50% for casewise.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with components:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>multivariate normal sample with cell- or case-wise contamination.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>vector of responses.</p>
</td></tr>
<tr><td><code>dummies</code></td>
<td>
<p>vector of dummies.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Andy Leung <a href="mailto:andy.leung@stat.ubc.ca">andy.leung@stat.ubc.ca</a>, Hongyang Zhang, Ruben H. Zamar</p>


<h3>References</h3>

<p>Leung, A. , Zamar, R.H., and Zhang, H. Robust regression estimation and inference in the presence of cellwise and casewise contamination. arXiv:1509.02564.
</p>


<h3>See Also</h3>

<p><code><a href="GSE.html#topic+generate.randcorr">generate.randcorr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##################################################
## Cellwise contaminated data simulation 
## (continuous covariates only)
set.seed(10)
b &lt;- 10*generate.randbeta(p=15)
A &lt;- generate.randcorr(cond=100, p=15)
dat &lt;- generate.cellcontam.regress(n=300, p=15, A=A, sigma=0.5, b=b, k=10, cp=0.05)

## LS
fit.LS &lt;- lm( y ~ x, dat)
mean((coef(fit.LS)[-1] - b)^2)

## MM regression
fit.MM &lt;- robustbase::lmrob( y ~ x, dat)
mean((coef(fit.MM)[-1] - b)^2)

## 3S regression
fit.3S &lt;- robreg3S( y=dat$y, x=dat$x, init="imputed")
mean((coef(fit.3S)[-1] - b)^2)



##################################################
## Casewise contaminated data simulation
## (continuous covariates only)
set.seed(10)
b &lt;- 10*generate.randbeta(p=10)
A &lt;- generate.randcorr(cond=100, p=10)
dat &lt;- generate.casecontam.regress(n=200, p=10, A=A, sigma=0.5, b=b, l=8, k=10, cp=0.10)

## LS
fit.LS &lt;- lm( y ~ x, dat)
mean((coef(fit.LS)[-1] - b)^2)

## MM regression
fit.MM &lt;- robustbase::lmrob( y ~ x, dat)
mean((coef(fit.MM)[-1] - b)^2)

## 3S regression
fit.3S &lt;- robreg3S( y=dat$y, x=dat$x, init="imputed")
mean((coef(fit.3S)[-1] - b)^2)


## Not run: 
##################################################
## Cellwise contaminated data simulation 
## (continuous and dummies covariates)
set.seed(10)
b &lt;- 10*generate.randbeta(p=15)
A &lt;- generate.randcorr(cond=100, p=15)
dat &lt;- generate.cellcontam.regress.dummies(n=300, p=12, pd=3, 
   probd=c(1/2,1/3,1/4), A=A, sigma=0.5, b=b, k=10, cp=0.05)

## LS
fit.LS &lt;- lm( dat$y ~ dat$x + dat$dummies)
mean((coef(fit.LS)[-1] - b)^2)

## MM regression
fit.MM &lt;- robustbase::lmrob( dat$y ~ dat$x + dat$dummies)
mean((coef(fit.MM)[-1] - b)^2)

## 3S regression
fit.3S &lt;- robreg3S( y=dat$y, x=dat$x, dummies=dat$dummies, init="imputed")
mean((coef(fit.3S)[-1] - b)^2)


##################################################
## Casewise contaminated data simulation 
## (continuous and dummies covariates)
set.seed(10)
b &lt;- 10*generate.randbeta(p=15)
A &lt;- generate.randcorr(cond=100, p=15)
dat &lt;- generate.casecontam.regress.dummies(n=300, p=12, pd=3, 
   probd=c(1/2,1/3,1/4), A=A, sigma=0.5, b=b, l=7, k=10, cp=0.10)

## LS
fit.LS &lt;- lm( dat$y ~ dat$x + dat$dummies)
mean((coef(fit.LS)[-1] - b)^2)

## MM regression
fit.MM &lt;- robustbase::lmrob( dat$y ~ dat$x + dat$dummies)
mean((coef(fit.MM)[-1] - b)^2)

## 3S regression
fit.3S &lt;- robreg3S( y=dat$y, x=dat$x, dummies=dat$dummies, init="imputed")
mean((coef(fit.3S)[-1] - b)^2)


## End(Not run)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
