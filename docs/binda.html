<!DOCTYPE html><html><head><title>Help for package binda</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {binda}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binda'><p>Binary Discriminant Analysis: Model Fit and Class Prediction</p></a></li>
<li><a href='#binda-internal'><p>Internal binda Functions</p></a></li>
<li><a href='#binda-package'><p>The binda Package</p></a></li>
<li><a href='#binda.ranking'><p>Binary Discriminant Analysis: Variable Ranking</p></a></li>
<li><a href='#chances'><p>Estimate Bernoulli Parameters from Binary Matrix with Class Labels</p></a></li>
<li><a href='#dichotomize'><p>Dichotomize Continuous Data Set With Labels</p></a></li>
<li><a href='#is.binaryMatrix'><p>Check For Binary Matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-20</td>
</tr>
<tr>
<td>Title:</td>
<td>Multi-Class Discriminant Analysis using Binary Predictors</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastian Gibb and Korbinian Strimmer.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Korbinian Strimmer &lt;strimmerlab@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.2), entropy (&ge; 1.3.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>crossval</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements functions for multi-class
   discriminant analysis using binary predictors, for corresponding 
   variable selection, and for dichotomizing continuous data.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://strimmerlab.github.io/software/binda/">https://strimmerlab.github.io/software/binda/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-20 17:17:54 UTC; strimmer</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-20 18:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='binda'>Binary Discriminant Analysis: Model Fit and Class Prediction</h2><span id='topic+binda'></span><span id='topic+predict.binda'></span>

<h3>Description</h3>

<p><code>binda</code> trains a diagonal multivariate Bernoulli model.
<code>predict.binda</code> performs corresponding class prediction.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binda(Xtrain, L, lambda.freqs, verbose=TRUE)
## S3 method for class 'binda'
predict(object, Xtest, verbose=TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binda_+3A_xtrain">Xtrain</code></td>
<td>
<p>A matrix  containing the training data set. Note that 
the rows correspond to observations and the columns
to variables.</p>
</td></tr>
<tr><td><code id="binda_+3A_l">L</code></td>
<td>
<p>A factor with the class labels of the training samples. </p>
</td></tr>
<tr><td><code id="binda_+3A_lambda.freqs">lambda.freqs</code></td>
<td>
<p>Shrinkage intensity for the frequencies. If not specified it is 
estimated from the data. <code>lambda.freqs=0</code> implies no shrinkage (i.e. empirical frequencies)
and <code>lambda.freqs=1</code> complete shrinkage (i.e. uniform frequencies). </p>
</td></tr>
<tr><td><code id="binda_+3A_verbose">verbose</code></td>
<td>
<p>Report shrinkage intensities (binda) and number of used features (predict.binda).</p>
</td></tr>
<tr><td><code id="binda_+3A_object">object</code></td>
<td>
<p>An <code>binda</code> fit object obtained from the function <code>binda</code>.</p>
</td></tr>
<tr><td><code id="binda_+3A_xtest">Xtest</code></td>
<td>
<p>A matrix containing the test data set. Note that 
the rows correspond to observations and the columns
to variables.</p>
</td></tr>
<tr><td><code id="binda_+3A_...">...</code></td>
<td>
<p>Additional arguments for generic predict.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For detailed description of binary discriminant analysis as implented in <code>binda</code> see Gibb and Strimmer (2015).
</p>


<h3>Value</h3>

<p><code>predict.binda</code> predicts class probabilities for each test sample and returns
a list with two components:
</p>
<table>
<tr><td><code>class</code></td>
<td>
<p>a factor with the most probable class assignment for each test sample, and</p>
</td></tr>
<tr><td><code>posterior</code></td>
<td>
<p>a matrix containing the respective class posterior probabilities.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Gibb, S., and K. Strimmer. 2015.  Differential protein expression and peak selection in mass spectrometry data by binary discriminant analysis. Bioinformatics 31:3156-3162.
&lt;DOI:10.1093/bioinformatics/btv334&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binda.ranking">binda.ranking</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># load "binda" library
library("binda")

# training data set with labels
Xtrain = matrix(c(1, 1, 0, 1, 0, 0,
             1, 1, 1, 1, 0, 0,
             1, 0, 0, 0, 1, 1,
             1, 0, 0, 0, 1, 1), nrow=4, byrow=TRUE)
colnames(Xtrain) = paste0("V", 1:ncol(Xtrain))
is.binaryMatrix(Xtrain) # TRUE
L = factor(c("Treatment", "Treatment", "Control", "Control") )

# learn predictor
binda.fit = binda(Xtrain, L)

# predict classes using new test data
Xtest = matrix(c(1, 1, 0, 1, 1, 1,
                 1, 0, 0, 0, 1, 1), nrow=2, byrow=TRUE)
colnames(Xtest) = paste0("V", 1:ncol(Xtest))

predict(binda.fit, Xtest)

</code></pre>

<hr>
<h2 id='binda-internal'>Internal binda Functions</h2><span id='topic+binda-internal'></span>

<h3>Description</h3>

<p>Internal binda functions.
</p>


<h3>Note</h3>

<p>These are not to be called by the user (or in some cases are just
waiting for proper documentation to be written).
</p>

<hr>
<h2 id='binda-package'>The binda Package</h2><span id='topic+binda-package'></span>

<h3>Description</h3>

<p>The &quot;binda&quot; package implements functions for multi-class discriminant
analysis using binary predictors, for corresponding variable selection, 
and for dichotomizing continuous data.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io/">https://strimmerlab.github.io/</a>)</p>


<h3>References</h3>

<p>Gibb, S., and K. Strimmer. 2015.  Differential protein expression and peak selection in mass spectrometry data by binary discriminant analysis. Bioinformatics 31:3156-3162.
&lt;DOI:10.1093/bioinformatics/btv334&gt;
</p>
<p>Website: <a href="https://strimmerlab.github.io/software/binda/">https://strimmerlab.github.io/software/binda/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binda">binda</a></code>, <code><a href="#topic+binda.ranking">binda.ranking</a></code>, <code><a href="#topic+dichotomize">dichotomize</a></code>, <code><a href="#topic+chances">chances</a></code>.
</p>

<hr>
<h2 id='binda.ranking'>Binary Discriminant Analysis: Variable Ranking</h2><span id='topic+binda.ranking'></span><span id='topic+plot.binda.ranking'></span>

<h3>Description</h3>

<p><code>binda.ranking</code> determines a ranking of predictors by computing corresponding t-scores
between the group means and the pooled mean.
</p>
<p><code>plot.binda.ranking</code> provides a graphical visualization of the top ranking variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binda.ranking(Xtrain, L, lambda.freqs, verbose=TRUE)
## S3 method for class 'binda.ranking'
plot(x, top=40, arrow.col="blue", zeroaxis.col="red", ylab="Variables", main, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binda.ranking_+3A_xtrain">Xtrain</code></td>
<td>
<p>A matrix  containing the training data set. Note that 
the rows correspond to observations and the columns
to variables.</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_l">L</code></td>
<td>
<p>A factor with the class labels of the training samples. </p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_lambda.freqs">lambda.freqs</code></td>
<td>
<p>Shrinkage intensity for the class frequencies. If not specified it is 
estimated from the data. <code>lambda.freqs=0</code> implies no shrinkage (i.e. empirical frequencies)
and <code>lambda.freqs=1</code> complete shrinkage (i.e. uniform frequencies). </p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_verbose">verbose</code></td>
<td>
<p>Print out some info while computing.</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_x">x</code></td>
<td>
<p>A &quot;binda.ranking&quot; object &ndash; this is produced by the binda.ranking() function.</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_top">top</code></td>
<td>
<p>The number of top-ranking variables shown in the plot (default: 40).</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_arrow.col">arrow.col</code></td>
<td>
<p>Color of the arrows in the plot (default is <code>"blue"</code>).</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_zeroaxis.col">zeroaxis.col</code></td>
<td>
<p>Color for the center zero axis (default is <code>"red"</code>).</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_ylab">ylab</code></td>
<td>
<p>Label written next to feature list (default is <code>"Variables"</code>).</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_main">main</code></td>
<td>
<p>Main title (if missing, <code>"The", top, "Top Ranking Variables"</code> is used).</p>
</td></tr>
<tr><td><code id="binda.ranking_+3A_...">...</code></td>
<td>
<p>Other options passed on to generic plot().</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The overall ranking of a feature is determined by computing a weighted sum of
the squared t-scores. This is approximately equivalent to the mutual information between the response and each variable.  The same criterion is used in <code><a href="#topic+dichotomize">dichotomize</a></code>.  For precise details see Gibb and Strimmer (2015).
</p>


<h3>Value</h3>

<p><code>binda.ranking</code> returns a matrix with the following columns:
</p>
<table>
<tr><td><code>idx</code></td>
<td>
<p>original feature number</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>the score determining the overall ranking of a variable</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>for each group and feature the t-score of the class mean versus the pooled mean</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Gibb, S., and K. Strimmer. 2015.  Differential protein expression and peak selection in mass spectrometry data by binary discriminant analysis. Bioinformatics 31:3156-3162.
&lt;DOI:10.1093/bioinformatics/btv334&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+binda">binda</a></code>, <code><a href="#topic+predict.binda">predict.binda</a></code>, <code><a href="#topic+dichotomize">dichotomize</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># load "binda" library
library("binda")

# training data set with labels
Xtrain = matrix(c(1, 1, 0, 1, 0, 0,
             1, 1, 1, 1, 0, 0,
             1, 0, 0, 0, 1, 1,
             1, 0, 0, 0, 1, 1), nrow=4, byrow=TRUE)
colnames(Xtrain) = paste0("V", 1:ncol(Xtrain))
is.binaryMatrix(Xtrain) # TRUE
L = factor(c("Treatment", "Treatment", "Control", "Control") )

# ranking variables
br = binda.ranking(Xtrain, L)
br
#   idx    score t.Control t.Treatment
#V2   2 4.000000 -2.000000    2.000000
#V4   4 4.000000 -2.000000    2.000000
#V5   5 4.000000  2.000000   -2.000000
#V6   6 4.000000  2.000000   -2.000000
#V3   3 1.333333 -1.154701    1.154701
#V1   1 0.000000  0.000000    0.000000
#attr(,"class")
#[1] "binda.ranking"
#attr(,"cl.count")
#[1] 2

# show plot
plot(br)

# result: variable V1 is irrelevant for distinguishing the two groups


</code></pre>

<hr>
<h2 id='chances'>Estimate Bernoulli Parameters from Binary Matrix with Class Labels</h2><span id='topic+chances'></span>

<h3>Description</h3>

<p><code>chances</code> estimates Bernoulli parameters (=chances) from a binary matrix and associated class labels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chances(X, L, lambda.freqs, verbose=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chances_+3A_x">X</code></td>
<td>
<p>data matrix (columns correspond to variables, rows to samples).</p>
</td></tr>
<tr><td><code id="chances_+3A_l">L</code></td>
<td>
<p>factor containing the class labels, one for each sample (row).</p>
</td></tr>
<tr><td><code id="chances_+3A_lambda.freqs">lambda.freqs</code></td>
<td>
<p>shrinkage parameter for class frequencies (if not specified it is estimated).</p>
</td></tr>
<tr><td><code id="chances_+3A_verbose">verbose</code></td>
<td>
<p>report shrinkage intensity and other information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The class-specific chances are estimated using the empirical means over the 0s and 1s in each class. For estimating the pooled mean the class-specific means are weighted using the
estimated class frequencies. Class frequencies are estimated using <code><a href="entropy.html#topic+freqs.shrink">freqs.shrink</a></code>.
</p>


<h3>Value</h3>

<p><code>chances</code> returns a list with the following components:
</p>
<p><code>samples</code>: the samples in each class,
</p>
<p><code>regularization</code>: the shrinkage intensity used to estimate the class frequencies,
</p>
<p><code>freqs</code>: the estimated class frequencies,
</p>
<p><code>means</code>:  the estimated chances (parameters of Bernoulli distribution, expectations of 1s) for each variable conditional on class, as well as the marginal changes (pooled means).
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+is.binaryMatrix">is.binaryMatrix</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># load binda library
library("binda")

# example binary matrix with 6 variables (in columns) and 4 samples (in rows)
Xb = matrix(c(1, 1, 0, 1, 0, 0,
             1, 1, 1, 1, 0, 0,
             1, 0, 0, 0, 1, 1,
             1, 0, 0, 0, 1, 1), nrow=4, byrow=TRUE)
colnames(Xb) = paste0("V", 1:ncol(Xb))

# Test for binary matrix
is.binaryMatrix(Xb) # TRUE

L = factor(c("Treatment", "Treatment", "Control", "Control") )

chances(Xb, L)
</code></pre>

<hr>
<h2 id='dichotomize'>Dichotomize Continuous Data Set With Labels</h2><span id='topic+dichotomize'></span><span id='topic+optimizeThreshold'></span>

<h3>Description</h3>

<p><code>dichotomize</code> converts a matrix containing continous measurements into a binary matrix.
</p>
<p><code>optimizeThreshold</code> determines optimal thresholds for dichotomization.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dichotomize(X, thresh)
optimizeThreshold(X, L, lambda.freqs, verbose=FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dichotomize_+3A_x">X</code></td>
<td>
<p>data matrix (columns correspond to variables, rows to samples).</p>
</td></tr>
<tr><td><code id="dichotomize_+3A_thresh">thresh</code></td>
<td>
<p>vector of thresholds, one for each variable (column).</p>
</td></tr>
<tr><td><code id="dichotomize_+3A_l">L</code></td>
<td>
<p>factor containing the class labels, one for each sample (row).</p>
</td></tr>
<tr><td><code id="dichotomize_+3A_lambda.freqs">lambda.freqs</code></td>
<td>
<p>shrinkage parameter for class frequencies (if not specified it is estimated).</p>
</td></tr>
<tr><td><code id="dichotomize_+3A_verbose">verbose</code></td>
<td>
<p>report shrinkage intensity and other information.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dichotomize</code> assigns 0 if a matrix entry is lower than given column-specific threshold, otherwise it assigns 1.
</p>
<p><code>optimizeThreshold</code> uses (approximate) mutual information to 
determine the optimal thresholds.  Specifically, the thresholds are chosen to maximize the
mutual information between response and each variable.  The same criterion is also used in
<code><a href="#topic+binda.ranking">binda.ranking</a></code>.  For detailed description of the dichotomization procedure see Gibb and Strimmer (2015).
</p>
<p>Class frequencies are estimated using <code><a href="entropy.html#topic+freqs.shrink">freqs.shrink</a></code>.
</p>


<h3>Value</h3>

<p><code>dichotomize</code> returns a binary matrix.
</p>
<p><code>optimizeThreshold</code> returns a vector containing the variable thresholds.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>References</h3>

<p>Gibb, S., and K. Strimmer. 2015.  Differential protein expression and peak selection in mass spectrometry data by binary discriminant analysis. Bioinformatics 31:3156-3162.
&lt;DOI:10.1093/bioinformatics/btv334&gt;
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+binda.ranking">binda.ranking</a></code>, <code><a href="entropy.html#topic+freqs.shrink">freqs.shrink</a></code>, <code><a href="entropy.html#topic+mi.plugin">mi.plugin</a></code>,  <code><a href="#topic+is.binaryMatrix">is.binaryMatrix</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'># load binda library
library("binda")

# example data with 6 variables (in columns) and 4 samples (in rows)
X = matrix(c(1, 1, 1, 1.75, 0.4,    0,
             1, 1, 2,    2, 0.4, 0.09,
             1, 0, 1,    1, 0.5,  0.1,
             1, 0, 1,  0.5, 0.6,  0.1), nrow=4, byrow=TRUE)
colnames(X) = paste0("V", 1:ncol(X))

# class labels
L = factor(c("Treatment", "Treatment", "Control", "Control") )
rownames(X) = paste0(L, rep(1:2, times=2))

X
#          V1 V2 V3   V4  V5   V6
#Treatment1  1  1  1 1.75 0.4 0.00
#Treatment2  1  1  2 2.00 0.4 0.09
#Control1    1  0  1 1.00 0.5 0.10
#Control2    1  0  1 0.50 0.6 0.10

# find optimal thresholds (one for each variable)
thr = optimizeThreshold(X, L)
thr
#  V1   V2   V3   V4   V5   V6 
#1.00 1.00 2.00 1.75 0.50 0.10

# convert into binary matrix
# if value is lower than threshold -&gt; 0 otherwise -&gt; 1
Xb = dichotomize(X, thr)
is.binaryMatrix(Xb) # TRUE
Xb
#          V1 V2 V3 V4 V5 V6
#Treatment1  1  1  0  1  0  0
#Treatment2  1  1  1  1  0  0
#Control1    1  0  0  0  1  1
#Control2    1  0  0  0  1  1
#attr(,"thresh")
#  V1   V2   V3   V4   V5   V6 
#1.00 1.00 2.00 1.75 0.50 0.10
</code></pre>

<hr>
<h2 id='is.binaryMatrix'>Check For Binary Matrix</h2><span id='topic+is.binaryMatrix'></span>

<h3>Description</h3>

<p><code>is.binaryMatrix</code>  tests whether <code>m</code> is a matrix and whether it contains only 0s and 1s.
</p>
<p>Note that functions like <code><a href="#topic+binda.ranking">binda.ranking</a></code> and <code><a href="#topic+binda">binda</a></code> require a binary matrix as input.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.binaryMatrix(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.binaryMatrix_+3A_m">m</code></td>
<td>
<p>a matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>is.binaryMatrix</code> returns either <code>TRUE</code> or <code>FALSE</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastian Gibb and Korbinian Strimmer (<a href="https://strimmerlab.github.io">https://strimmerlab.github.io</a>).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load binda library
library("binda")

# test matrix
m = matrix(c(1, 1, 0, 1, 0, 0,
             1, 1, 1, 1, 0, 0,
             1, 0, 0, 0, 1, 1,
             1, 0, 0, 0, 1, 1), nrow=4, byrow=TRUE)

# Test for binary matrix
is.binaryMatrix(m) # TRUE
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
