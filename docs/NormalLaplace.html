<!DOCTYPE html><html lang="en"><head><title>Help for package NormalLaplace</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {NormalLaplace}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NormalLaplace-package'>
<p>The Package &lsquo;NormalLaplace&rsquo;: Summary Information</p></a></li>
<li><a href='#MillsRatio'><p>Mills Ratio</p></a></li>
<li><a href='#nlCheckPars'>
<p>Check Parameters of the Normal Laplace Distribution</p></a></li>
<li><a href='#nlFit'><p>Fit the Normal Laplace Distribution to Data</p></a></li>
<li><a href='#nlFitStart'><p>Find Starting Values for Fitting a Normal Laplace Distribution</p></a></li>
<li><a href='#nlPlots'><p>Normal Laplace Quantile-Quantile and Percent-Percent Plots</p></a></li>
<li><a href='#NormalLaplaceDistribution'>
<p>Normal Laplace Distribution</p></a></li>
<li><a href='#NormalLaplaceMeanVar'>
<p>Mean, Variance, Skewness and Kurtosis of the Normal Laplace Distribution.</p></a></li>
<li><a href='#summary.nlFit'><p>Summarizing Normal Laplace Distribution Fit</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Version:</td>
<td>0.3-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-11-26</td>
</tr>
<tr>
<td>Title:</td>
<td>The Normal Laplace Distribution</td>
</tr>
<tr>
<td>Author:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;, Jason Shicong Fu and
	Simon Potter</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Scott &lt;d.scott@auckland.ac.nz&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, DistributionUtils,
GeneralizedHyperbolic</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RUnit</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for the normal Laplace distribution.  Currently, it
 provides limited functionality.  Density, distribution and quantile
 functions, random number generation, and moments are provided.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://r-forge.r-project.org/projects/rmetrics/">https://r-forge.r-project.org/projects/rmetrics/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-11-25 23:55:19 UTC; dsco036</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-11-26 00:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='NormalLaplace-package'>
The Package &lsquo;NormalLaplace&rsquo;: Summary Information
</h2><span id='topic+NormalLaplace-package'></span><span id='topic+NormalLaplace'></span>

<h3>Description</h3>

<p>This package provides a collection of functions for Normal Laplace
distributions. Functions are provided for the density function,
distribution function, quantiles and random number generation. The mean,
variance, skewness and kurtosis of a given Normal Laplace distribution
are given by <code>nlMean</code>, <code>nlVar</code>, <code>nlSkew</code>, and
<code>nlKurt</code> respectively.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Jason Shicong Fu
</p>
<p>Maintainer: David Scott &lt;d.scott@auckland.ac.nz&gt;
</p>


<h3>References</h3>

<p>William J. Reed. (2006) The Normal-Laplace Distribution and Its
Relatives. In <em>Advances in Distribution Theory, Order Statistics
and Inference</em>, pp. 61&ndash;74.  Birkh채user,
Boston.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnl">dnl</a></code>, <code><a href="#topic+millsR">millsR</a></code>,
<code><a href="#topic+NormalLaplaceMeanVar">NormalLaplaceMeanVar</a></code>
</p>

<hr>
<h2 id='MillsRatio'>Mills Ratio</h2><span id='topic+MillsRatio'></span><span id='topic+millsR'></span>

<h3>Description</h3>

<p>Calculates the Mills ratio
</p>


<h3>Usage</h3>

<pre><code class='language-R'>millsR(y, log = FALSE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MillsRatio_+3A_y">y</code></td>
<td>
<p>Numeric. Value at which the Mills' Ratio is evaluated.</p>
</td></tr>
<tr><td><code id="MillsRatio_+3A_log">log</code></td>
<td>
<p>Logical. If <code>log = TRUE</code>, Mills' Ratios are given as
log(millsR).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function calculates the Mills' Ratio.
Since the Mill's Ratio converges to zero for large positive <code class="reqn">z</code>
and infinity for large negative <code class="reqn">z</code>. The range over which the
logarithm of the Mill's ratio may be calculated is greater than that
for which the Mill's ratio itself may be calculated.
</p>


<h3>Value</h3>

<p>The Mills' Ratio is
</p>
<p style="text-align: center;"><code class="reqn">R(z)=\frac{1-\Phi(z)}{\phi(z)}</code>
</p>

<p>where <code class="reqn">\Phi(z)</code> and <code class="reqn">\phi(z)</code> are
respectively the distribution function and density function of the
standard normal distribution.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Jason Shicong Fu</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## compare millsR calculated directly with the millsR calculated
## by transforming to log scale and then back-transformed
millsR(1:10)
exp(millsR(1:10, log = TRUE))
exp(millsR(10*(1:10)))
exp(millsR(10*(1:10), log = TRUE))
</code></pre>

<hr>
<h2 id='nlCheckPars'>
Check Parameters of the Normal Laplace Distribution
</h2><span id='topic+nlCheckPars'></span>

<h3>Description</h3>

<p>Given a set of parameters for the normal Laplace distribution,
the functions checks the validity of each parameter and if they
and if they correspond to the boundary cases.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlCheckPars(param)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlCheckPars_+3A_param">param</code></td>
<td>
<p>Numeric. Parameter values for the normal
Laplace distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The vector <code>param</code> takes the form <code>c(mu, sigma, alpha, beta)</code>.
</p>
<p>If any of <code>sigma</code>, <code>alpha</code> or <code>beta</code> is negative or NA, an
error is returned.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Simon Potter
</p>


<h3>References</h3>

<p>William J. Reed. (2006) The Normal-Laplace Distribution and Its
Relatives. In <em>Advances in Distribution Theory, Order Statistics
and Inference</em>, pp. 61&ndash;74.  Birkh채user,
Boston.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Correct parameters
nlCheckPars(c(0, 1.5, 1, 2))
nlCheckPars(c(3, 1, 1.5, 2))

## Incorrect parameters, each error providing a different error message
nlCheckPars(c(2, -1, 1, 1))          # invalid sigma
nlCheckPars(c(2, 1, -1, 2))          # invalid alpha
nlCheckPars(c(0, 1, 2, -1))          # invalid beta
nlCheckPars(c(0, -0.01, -0.1, 1))    # sigma and alpha incorrect
nlCheckPars(c(2, -0.5, 1, -0.2))     # sigma and beta incorrect
nlCheckPars(c(1, 1, -0.2, -1))       # alpha and beta incorrect
nlCheckPars(c(0, -0.1, -0.2, -0.3))  # all three parameters erroneous
nlCheckPars(c(0.5, NA, 1, 1))        # NA introduced
nlCheckPars(c(-1, 1, 1))             # incorrect number of parameters
</code></pre>

<hr>
<h2 id='nlFit'>Fit the Normal Laplace Distribution to Data</h2><span id='topic+nlFit'></span><span id='topic+print.nlFit'></span><span id='topic+plot.nlFit'></span><span id='topic+coef.nlFit'></span><span id='topic+vcov.nlFit'></span>

<h3>Description</h3>

<p>Fits a normal Laplace distribution to data.
Displays the histogram, log-histogram (both with fitted densities),
Q-Q plot and P-P plot for the fit which has the maximum likelihood.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlFit(x, freq = NULL, breaks = "FD", paramStart = NULL,
        startMethod = "Nelder-Mead",
        startValues = c("MoM", "US"),
        method = c("Nelder-Mead", "BFGS", "L-BFGS-B",
                   "nlm", "nlminb"),
        hessian = FALSE,
        plots = FALSE, printOut = FALSE,
        controlBFGS = list(maxit = 200),
        controlLBFGSB = list(maxit = 200),
        controlNLMINB = list(),
        controlNM = list(maxit = 1000),
        maxitNLM = 1500, ...)
  ## S3 method for class 'nlFit'
print(x, digits = max(3, getOption("digits") - 3), ...)
  ## S3 method for class 'nlFit'
plot(x, which = 1:4,
    plotTitles = paste(c("Histogram of ","Log-Histogram of ",
                         "Q-Q Plot of ","P-P Plot of "), x$obsName,
                       sep = ""),
    ask = prod(par("mfcol")) &lt; length(which) &amp; dev.interactive(), ...)
  ## S3 method for class 'nlFit'
coef(object, ...)
  ## S3 method for class 'nlFit'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlFit_+3A_x">x</code></td>
<td>
<p>Data vector for <code>nlFit</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_freq">freq</code></td>
<td>
<p>A vector of weights with length equal to <code>length(x)</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for plotted histogram, defaults to those generated by
<code>hist(x, right = FALSE, plot = FALSE)</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_paramstart">paramStart</code></td>
<td>
<p>A user specified starting parameter vector taking the form
<code>c(mu, sigma, alpha, beta)</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_startmethod">startMethod</code></td>
<td>
<p>Method used by <code>nlFitStart</code> in calls to
<code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_startvalues">startValues</code></td>
<td>
<p>Code giving the method of determining starting values
for finding the maximum likelihood estimate of the parameters.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_method">method</code></td>
<td>
<p>Different optimisation methods to consider.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_hessian">hessian</code></td>
<td>
<p>Logical. If <code>TRUE</code> the value of the Hessian
is returned.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_plots">plots</code></td>
<td>
<p>Logical. If <code>FALSE</code> the printing of the histogram,
log-histogram, Q-Q plot and P-P plot are suppressed.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_printout">printOut</code></td>
<td>
<p>Logical. If <code>FALSE</code> the printing of the results of
fitting will be suppressed.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_controlbfgs">controlBFGS</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"BFGS"</code> method of optimisation.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_controllbfgsb">controlLBFGSB</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"L-BFGS-B"</code> method of optimisation.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_controlnlminb">controlNLMINB</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"nlminb"</code> method of optimisation.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_controlnm">controlNM</code></td>
<td>
<p>A list of control parameters for <code>optim</code> when
using the <code>"Nelder-Mead"</code> method of optimisation.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_maxitnlm">maxitNLM</code></td>
<td>
<p>A positive integer specifying the maximum number of
iterations that are to be undertaken when using the <code>"nlm"</code> method
of optimisation.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_object">object</code></td>
<td>
<p>Object of class <code>"nlFit"</code> for <code>print.nlFit</code>,
<code>plot.nlFit</code>, <code>coef.nlFit</code> and <code>vcov.nlFit</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_digits">digits</code></td>
<td>
<p>Desired number of digits to be shown when the object
is printed.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_which">which</code></td>
<td>
<p>If a subset of the plots if required, specify a subset of
the numbers <code>1:4</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_plottitles">plotTitles</code></td>
<td>
<p>Titles to appear as the main title above the plots.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_ask">ask</code></td>
<td>
<p>Logical. If <code>TRUE</code>, the user is <em>ask</em>ed before
each plot, see <code><a href="graphics.html#topic+par">par</a>(ask = .)</code>.</p>
</td></tr>
<tr><td><code id="nlFit_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>par</code>, <code>hist</code>, <code>logHist</code>,
<code>qqnl</code> and <code>ppnl</code>. For the <code>print</code>, <code>coef</code> and
<code>vcov</code> methods this parameter has no effect.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>startMethod</code> must be <code>"Nelder-Mead"</code>.
</p>
<p><code>startValues</code> can only be <code>"MoM"</code> when using the Method of
Moments for estimation, or <code>"US"</code> for user-supplied parameters. For
details regarding the use of <code>paramStart</code>, <code>startMethod</code> and
<code>startValues</code>, see <code><a href="#topic+nlFitStart">nlFitStart</a></code>.
</p>
<p>Three optimisation methods are available for use:
</p>

<dl>
<dt><code>"BFGS"</code></dt><dd><p>Uses the quasi-Newton method <code>"BFGS"</code> as
documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"L-BFGS-B"</code></dt><dd><p>Uses the constrained method <code>"L-BFGS-B"</code> as
documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"Nelder-Mead"</code></dt><dd><p>Uses an implementation of the Nelder and
Mead method as documented in <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</dd>
<dt><code>"nlm"</code></dt><dd><p>Uses the <code><a href="stats.html#topic+nlm">nlm</a></code> function in R.</p>
</dd>
<dt><code>"nlminb"</code></dt><dd><p>Uses the <code><a href="stats.html#topic+nlminb">nlminb</a></code> function in R,
with constrained parameters.</p>
</dd>
</dl>

<p>For details on how to pass control information for optimisation using
<code><a href="stats.html#topic+optim">optim</a></code> and <code><a href="stats.html#topic+nlm">nlm</a></code>, see <code><a href="stats.html#topic+optim">optim</a></code> and
<code><a href="stats.html#topic+nlm">nlm</a></code>.
</p>
<p>When <code>method = "nlm"</code> or <code>method = "nlm"</code> is used, warnings
may be produced. However, these do not appear to be problematic.
</p>


<h3>Value</h3>

<p>A list with components:
</p>
<table role = "presentation">
<tr><td><code>param</code></td>
<td>
<p>A vector giving the maximum likelihood estimate of
parameters, as
<code>c(mu, sigma, alpha, beta)</code>.</p>
</td></tr>
<tr><td><code>maxLik</code></td>
<td>
<p>The value of maximised log-likelihood.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>If <code>hessian</code> was set to <code>TRUE</code>, the value of
the Hessian. Not present otherwise.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>Optimisation method used.</p>
</td></tr>
<tr><td><code>conv</code></td>
<td>
<p>Convergence code. See the relevant documentation (either
<code><a href="stats.html#topic+optim">optim</a></code> or <code><a href="stats.html#topic+nlm">nlm</a></code>) for details on convergence.</p>
</td></tr>
<tr><td><code>iter</code></td>
<td>
<p>Number of iterations made by the optimisation routine.</p>
</td></tr>
<tr><td><code>obs</code></td>
<td>
<p>The data used to fit the normal Laplace distribution.</p>
</td></tr>
<tr><td><code>obsName</code></td>
<td>
<p>A character vector with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>paramStart</code></td>
<td>
<p>Starting value of parameters returned by call to
<code><a href="#topic+nlFitStart">nlFitStart</a></code>.</p>
</td></tr>
<tr><td><code>svName</code></td>
<td>
<p>Descriptive name for the method of finding start values.</p>
</td></tr>
<tr><td><code>startValues</code></td>
<td>
<p>Acronym for the method of finding start values.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>The cell boundaries found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Simon Potter</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+optim">optim</a></code>, <code><a href="stats.html#topic+nlm">nlm</a></code>, <code><a href="graphics.html#topic+par">par</a></code>,
<code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="DistributionUtils.html#topic+logHist">logHist</a></code>, <code><a href="#topic+qqnl">qqnl</a></code>,
<code><a href="#topic+ppnl">ppnl</a></code>, <code><a href="#topic+dnl">dnl</a></code> and
<code><a href="#topic+nlFitStart">nlFitStart</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(0, 2, 1, 1)
dataVector &lt;- rnl(1000, param = param)

## Let's see how well nlFit works
nlFit(dataVector)
nlFit(dataVector, plots = TRUE)
fit &lt;- nlFit(dataVector)
par(mfrow = c(1, 2))
plot(fit, which = c(1, 3))  # See only histogram and Q-Q plot
</code></pre>

<hr>
<h2 id='nlFitStart'>Find Starting Values for Fitting a Normal Laplace Distribution</h2><span id='topic+nlFitStart'></span><span id='topic+nlFitStartMoM'></span>

<h3>Description</h3>

<p>Finds starting values for input to a maximum likelihood routine for
fitting a normal Laplace distribution to data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  nlFitStart(x, breaks = "FD",
             paramStart = NULL,
             startValues = c("MoM", "US"),
             startMethodMoM = "Nelder-Mead", ...)
  nlFitStartMoM(x, startMethodMoM = "Nelder-Mead", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlFitStart_+3A_x">x</code></td>
<td>
<p>Data vector.</p>
</td></tr>
<tr><td><code id="nlFitStart_+3A_breaks">breaks</code></td>
<td>
<p>Breaks for histogram. If missing, defaults to those
generated by
<code>hist(x, right = FALSE, plot = FALSE)</code>.</p>
</td></tr>
<tr><td><code id="nlFitStart_+3A_paramstart">paramStart</code></td>
<td>
<p>Starting values for parameter vector if
<code>startValues = "US"</code>.</p>
</td></tr>
<tr><td><code id="nlFitStart_+3A_startvalues">startValues</code></td>
<td>
<p>Vector of the different starting value methods
to consider.
See <b>Details</b>.</p>
</td></tr>
<tr><td><code id="nlFitStart_+3A_startmethodmom">startMethodMoM</code></td>
<td>
<p>Method used by call to <code><a href="stats.html#topic+optim">optim</a></code> in
finding method of moments estimates.</p>
</td></tr>
<tr><td><code id="nlFitStart_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code><a href="stats.html#topic+optim">optim</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Possible values of the argument <code>startValues</code> are the following:
</p>

<dl>
<dt><code>"US"</code></dt><dd><p>User-supplied.</p>
</dd>
<dt><code>"MoM"</code></dt><dd><p>Method of moments.</p>
</dd>
</dl>

<p>If <code>startValues = "US"</code> then a value must be supplied for
<code>paramStart</code>.
</p>
<p>If <code>startValues = "MoM"</code>, <code>nlFitStartMoM</code> is
called.
</p>
<p>If <code>startValues = "MoM"</code> an initial optimisation is needed to find
the starting values. These optimisations call <code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Value</h3>

<p><code>nlFitStart</code> returns a list with components:
</p>
<table role = "presentation">
<tr><td><code>paramStart</code></td>
<td>
<p>A vector with elements <code>mu</code>, <code>sigma</code>,
<code>alpha</code> and <code>beta</code> giving the starting value of param.</p>
</td></tr>
<tr><td><code>xName</code></td>
<td>
<p>A character string with the actual <code>x</code> argument name.</p>
</td></tr>
<tr><td><code>breaks</code></td>
<td>
<p>The cell boundaries found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>midpoints</code></td>
<td>
<p>The cell midpoints found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
<tr><td><code>empDens</code></td>
<td>
<p>The estimated density found by a call to
<code><a href="graphics.html#topic+hist">hist</a></code>.</p>
</td></tr>
</table>
<p><code>nlFitStartMoM</code> returns only the method of moments estimates
as a vector with elements <code>mu</code>, <code>sigma</code>, <code>alpha</code> and
<code>beta</code>.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>,
Simon Potter</p>


<h3>See Also</h3>

<p><code><a href="#topic+dnl">dnl</a></code>, <code><a href="#topic+nlFit">nlFit</a></code>, <code><a href="graphics.html#topic+hist">hist</a></code>, and
<code><a href="stats.html#topic+optim">optim</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(2, 2, 1, 1)
dataVector &lt;- rnl(500, param = param)
nlFitStart(dataVector, startValues = "MoM")
</code></pre>

<hr>
<h2 id='nlPlots'>Normal Laplace Quantile-Quantile and Percent-Percent Plots</h2><span id='topic+qqnl'></span><span id='topic+ppnl'></span>

<h3>Description</h3>

<p><code>qqnl</code> produces a normal Laplace Q-Q plot of the values in
<code>y</code>.
</p>
<p><code>ppnl</code> produces a normal Laplace P-P (percent-percent) or
probability plot of the values in <code>y</code>.
</p>
<p>Graphical parameters may be given as arguments to <code>qqnl</code>,
and <code>ppnl</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqnl(y, mu = 0, sigma = 1, alpha = 1, beta = 1,
     param = c(mu, sigma, alpha, beta),
     main = "Normal Laplace Q-Q Plot",
     xlab = "Theoretical Quantiles",
     ylab = "Sample Quantiles",
     plot.it = TRUE, line = TRUE, ...)
ppnl(y, mu = 0, sigma = 1, alpha = 1, beta = 1,
     param = c(mu, sigma, alpha, beta),
     main = "Normal Laplace P-P Plot",
     xlab = "Uniform Quantiles",
     ylab = "Probability-integral-transformed Data",
     plot.it = TRUE, line = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nlPlots_+3A_y">y</code></td>
<td>
<p>The data sample.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_mu">mu</code></td>
<td>
<p><code class="reqn">\mu</code> is the location parameter. By default this is
set to 0.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_sigma">sigma</code></td>
<td>
<p><code class="reqn">\sigma</code> is the variance parameter of the distribution.
A default value of 1 has been set.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_alpha">alpha</code></td>
<td>
<p><code class="reqn">\alpha</code> is a skewness parameter, with a default
value of 1.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_beta">beta</code></td>
<td>
<p><code class="reqn">\beta</code> is a shape parameter, by default this is 1.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_param">param</code></td>
<td>
<p>Parameters of the normal Laplace distribution.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_xlab">xlab</code>, <code id="nlPlots_+3A_ylab">ylab</code>, <code id="nlPlots_+3A_main">main</code></td>
<td>
<p>Plot labels.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_plot.it">plot.it</code></td>
<td>
<p>Logical. Should the result be plotted?</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_line">line</code></td>
<td>
<p>Add line through origin with unit slope.</p>
</td></tr>
<tr><td><code id="nlPlots_+3A_...">...</code></td>
<td>
<p>Further graphical parameters.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For <code>qqnl</code> and <code>ppnl</code>, a list with components:
</p>
<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>The x coordinates of the points that are to be plotted.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>The y coordinates of the points that are to be plotted.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Wilk, M. B. and Gnanadesikan, R. (1968)
Probability plotting methods for the analysis of data.
<em>Biometrika</em>.
<b>55</b>, 1&ndash;17.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ppoints">ppoints</a></code>, <code><a href="#topic+dnl">dnl</a></code>, <code><a href="#topic+nlFit">nlFit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>par(mfrow = c(1, 2))
param &lt;- c(2, 2, 1, 1)
y &lt;- rnl(200, param = param)
qqnl(y, param = param, line = FALSE)
abline(0, 1, col = 2)
ppnl(y, param = param)
</code></pre>

<hr>
<h2 id='NormalLaplaceDistribution'>
Normal Laplace Distribution
</h2><span id='topic+NormalLaplaceDistribution'></span><span id='topic+dnl'></span><span id='topic+pnl'></span><span id='topic+qnl'></span><span id='topic+rnl'></span>

<h3>Description</h3>

<p>Density function, distribution function, quantiles and random number
generation for the normal Laplace distribution, with parameters
<code class="reqn">\mu</code> (location), <code class="reqn">\delta</code> (scale),
<code class="reqn">\beta</code> (skewness), and <code class="reqn">\nu</code> (shape).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dnl(x, mu = 0, sigma = 1, alpha = 1, beta = 1,
    param = c(mu,sigma,alpha,beta))
pnl(q, mu = 0, sigma = 1, alpha = 1, beta = 1,
    param = c(mu,sigma,alpha,beta))
qnl(p, mu = 0, sigma = 1, alpha = 1, beta = 1,
    param = c(mu,sigma,alpha,beta),
    tol = 10^(-5), nInterpol = 100, subdivisions = 100, ...)
rnl(n, mu = 0, sigma = 1, alpha = 1, beta = 1,
    param = c(mu,sigma,alpha,beta))

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NormalLaplaceDistribution_+3A_x">x</code>, <code id="NormalLaplaceDistribution_+3A_q">q</code></td>
<td>
<p>Vector of quantiles.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_p">p</code></td>
<td>
<p>Vector of probabilities.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_n">n</code></td>
<td>
<p>Number of random variates to be generated.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_sigma">sigma</code></td>
<td>
<p>Scale parameter <code class="reqn">\sigma</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_alpha">alpha</code></td>
<td>
<p>Skewness parameter <code class="reqn">\alpha</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_beta">beta</code></td>
<td>
<p>Shape parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu,sigma,alpha,beta)</code>.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_tol">tol</code></td>
<td>
<p>Specified level of tolerance when checking if
parameter beta is equal to 0.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_subdivisions">subdivisions</code></td>
<td>
<p>The maximum number of subdivisions used to
integrate the density and determine the accuracy of the distribution
function calculation.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_ninterpol">nInterpol</code></td>
<td>
<p>Number of points used in <code>qnl</code> for cubic
spline interpolation of the distribution function.</p>
</td></tr>
<tr><td><code id="NormalLaplaceDistribution_+3A_...">...</code></td>
<td>
<p>Passes arguments to <code>uniroot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones.
</p>
<p>The density function is
</p>
<p style="text-align: center;"><code class="reqn">f(y)=\frac{\alpha\beta}{\alpha+\beta}\phi\left(\frac{y-\mu}{\sigma }%
    \right)\left[R\left(\alpha\sigma-\frac{(y-\mu)}{\sigma}\right)+%
    R\left(\beta \sigma+\frac{(y-\mu)}{\sigma}\right)\right]</code>
</p>

<p>The distribution function is
</p>
<p style="text-align: center;"><code class="reqn">F(y)=\Phi\left(\frac{y-\mu}{\sigma}\right)-%
    \phi\left(\frac{y-\mu}{\sigma}\right)%
    \left[\beta R(\alpha\sigma-\frac{y-\mu}{\sigma})-%
    \alpha R\left(\beta\sigma+\frac{y-\mu}{\sigma}\right)\right]/%
    (\alpha+\beta)</code>
</p>

<p>The function <code class="reqn">R(z)</code> is the Mills' Ratio, see <code><a href="#topic+millsR">millsR</a></code>.
</p>
<p>Generation of random observations from the normal Laplace distribution
using <code>rnl</code> is based on the representation
</p>
<p style="text-align: center;"><code class="reqn">Y\sim Z+W</code>
</p>

<p>where <code class="reqn">Z</code> and <code class="reqn">W</code>
are independent random variables with
</p>
<p style="text-align: center;"><code class="reqn">Z\sim N(\mu,\sigma^2)</code>
</p>

<p>and <code class="reqn">W</code> following an asymmetric Laplace distribution with pdf
</p>
<p style="text-align: center;"><code class="reqn">f_W(w) = \left\{ \begin{array}{ll}%
    (\alpha\beta)/(\alpha+\beta)e^{\beta w} &amp;
    \textrm{for $w\le0$}\\ %
    (\alpha\beta)/(\alpha+\beta)e^{-\beta w} &amp; \textrm{for $w&gt;0$}%
    \end{array} \right.</code>
</p>



<h3>Value</h3>

<p><code>dnl</code> gives the density function, <code>pnl</code> gives the
distribution function, <code>qnl</code> gives the quantile function and
<code>rnl</code> generates random variates.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Jason Shicong Fu
</p>


<h3>References</h3>

<p>William J. Reed. (2006) The Normal-Laplace Distribution and Its
Relatives. In <em>Advances in Distribution Theory, Order Statistics
and Inference</em>, pp. 61&ndash;74.  Birkh채user,
Boston.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(0,1,3,2)
par(mfrow = c(1,2))


## Curves of density and distribution
curve(dnl(x, param = param), -5, 5, n = 1000)
title("Density of the Normal Laplace Distribution")
curve(pnl(x, param = param), -5, 5, n = 1000)
title("Distribution Function of the Normal Laplace Distribution")


## Example of density and random numbers
 par(mfrow = c(1,1))
 param1  &lt;-  c(0,1,1,1)
 data1  &lt;-  rnl(1000, param = param1)
 curve(dnl(x, param = param1),
       from = -5, to = 5, n = 1000, col = 2)
 hist(data1, freq = FALSE, add = TRUE)
 title("Density and Histogram")


</code></pre>

<hr>
<h2 id='NormalLaplaceMeanVar'>
Mean, Variance, Skewness and Kurtosis of the Normal Laplace Distribution.
</h2><span id='topic+NormalLaplaceMeanVar'></span><span id='topic+nlMean'></span><span id='topic+nlVar'></span><span id='topic+nlSkew'></span><span id='topic+nlKurt'></span>

<h3>Description</h3>

<p>Functions to calculate the mean, variance, skewness and kurtosis
of a specified normal Laplace distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nlMean(mu = 0, sigma = 1, alpha = 1, beta = 1,
         param = c(mu, sigma, alpha, beta))
nlVar(mu = 0, sigma = 1, alpha = 1, beta = 1,
         param = c(mu, sigma, alpha, beta))
nlSkew(mu = 0, sigma = 1, alpha = 1, beta = 1,
         param = c(mu, sigma, alpha, beta))
nlKurt(mu = 0, sigma = 1, alpha = 1, beta = 1,
         param = c(mu, sigma, alpha, beta))

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NormalLaplaceMeanVar_+3A_mu">mu</code></td>
<td>
<p>Location parameter <code class="reqn">\mu</code>, default is 0.</p>
</td></tr>
<tr><td><code id="NormalLaplaceMeanVar_+3A_sigma">sigma</code></td>
<td>
<p>Scale parameter <code class="reqn">\sigma</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceMeanVar_+3A_alpha">alpha</code></td>
<td>
<p>Skewness parameter <code class="reqn">\alpha</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceMeanVar_+3A_beta">beta</code></td>
<td>
<p>Shape parameter <code class="reqn">\beta</code>, default is 1.</p>
</td></tr>
<tr><td><code id="NormalLaplaceMeanVar_+3A_param">param</code></td>
<td>
<p>Specifying the parameters as a vector of the form<br />
<code>c(mu, sigma, alpha, beta)</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Users may either specify the values of the parameters individually or
as a vector. If both forms are specified, then the values specified by
the vector <code>param</code> will overwrite the other ones.
</p>
<p>The mean function is
</p>
<p style="text-align: center;"><code class="reqn">E(Y)=\mu+1/\alpha-1/\beta.</code>
</p>

<p>The variance function is
</p>
<p style="text-align: center;"><code class="reqn">V(Y)=\sigma^2+1/\alpha^2+1/\beta^2.%
  </code>
</p>

<p>The skewness function is
</p>
<p style="text-align: center;"><code class="reqn">\Upsilon =
    [2/\alpha^3-2/\beta^3]/[\sigma^2+1/\alpha^2+1/\beta^2]^{3/2}.%
  </code>
</p>

<p>The kurtosis function is
</p>
<p style="text-align: center;"><code class="reqn">\Gamma = [6/\alpha^4 +
    6/\beta^4]/[\sigma^2+1/\alpha^2+1/\beta^2]^2.</code>
</p>



<h3>Value</h3>

<p><code>nlMean</code> gives the mean of the skew hyperbolic <code>nlVar</code> the
variance, <code>nlSkew</code> the skewness, and <code>nlKurt</code> the kurtosis.
</p>


<h3>Author(s)</h3>

<p>David Scott <a href="mailto:d.scott@auckland.ac.nz">d.scott@auckland.ac.nz</a>, Jason Shicong Fu
</p>


<h3>References</h3>

<p>William J. Reed. (2006) The Normal-Laplace Distribution and Its
Relatives. In <em>Advances in Distribution Theory, Order Statistics
and Inference</em>, pp. 61&ndash;74.  Birkh채user,  Boston.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>param &lt;- c(10,1,5,9)
nlMean(param = param)
nlVar(param = param)
nlSkew(param = param)
nlKurt(param = param)


curve(dnl(x, param = param), -10, 10)

</code></pre>

<hr>
<h2 id='summary.nlFit'>Summarizing Normal Laplace Distribution Fit</h2><span id='topic+summary.nlFit'></span><span id='topic+print.summary.nlFit'></span>

<h3>Description</h3>

<p><code>summary</code> Method for class <code>"nlFit"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'nlFit'
summary(object, ...)
  ## S3 method for class 'summary.nlFit'
print(x,
        digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.nlFit_+3A_object">object</code></td>
<td>
<p>An object of class <code>"nlFit"</code>,
resulting from a call to <code><a href="#topic+nlFit">nlFit</a></code>.</p>
</td></tr>
<tr><td><code id="summary.nlFit_+3A_x">x</code></td>
<td>
<p>An object of class <code>"summary.nlFit"</code>
resulting from a call to <code>summary.nlFit</code>.</p>
</td></tr>
<tr><td><code id="summary.nlFit_+3A_digits">digits</code></td>
<td>
<p>The number of significant digits to use when printing.</p>
</td></tr>
<tr><td><code id="summary.nlFit_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>summary.nlFit</code> calculates standard errors for the estimates
of <code class="reqn">\mu</code>, <code class="reqn">\sigma</code>, <code class="reqn">\alpha</code>, and
<code class="reqn">\beta</code> of the normal laplace distribution parameter vector
param if the Hessian from the call to <code><a href="#topic+nlFit">nlFit</a></code> is available.
</p>


<h3>Value</h3>

<p>If the Hessian is available, <code>summary.nlFit</code> computes
standard errors for the estimates of <code class="reqn">\mu</code>, <code class="reqn">\sigma</code>,
<code class="reqn">\alpha</code>, and <code class="reqn">\beta</code>, and adds them to <code>object</code>
as <code>object$sds</code>. Otherwise, no calculations are performed and the
composition of <code>object</code> is unaltered.
</p>
<p><code>summary.nlFit</code> invisibly returns <code>object</code>
with class changed to <code>summary.nlFit</code>.
</p>
<p>See <code><a href="#topic+nlFit">nlFit</a></code> for the composition of an object of class
<code>nlFit</code>.
</p>
<p><code>print.summary.nlFit</code> prints a summary in the same format as
<code><a href="#topic+print.nlFit">print.nlFit</a></code> when the Hessian is not available from
the fit. When the Hessian is available, the standard errors for the
parameter estimates are printed in parentheses beneath the parameter
estimates, in the manner of <code>fitdistr</code> in the package
<code>MASS</code>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nlFit">nlFit</a></code>, <code><a href="base.html#topic+summary">summary</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Continuing the  nlFit() example:
param &lt;- c(2, 2, 1, 1)
dataVector &lt;- rnl(500, param = param)
fit &lt;- nlFit(dataVector, hessian = TRUE)
print(fit)
summary(fit)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
