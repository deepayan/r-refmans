<!DOCTYPE html><html lang="en"><head><title>Help for package changepointsVar</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {changepointsVar}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#changepointsVar-package'>
<p>Change-Points Detections for Changes in Variance</p></a></li>
<li><a href='#fit.control'>
<p>Auxiliary function for controlling model fitting</p></a></li>
<li><a href='#internals'><p>Internal Functions</p></a></li>
<li><a href='#jumpointsVar'>
<p>Change-point detection for variance piecewise constant models</p></a></li>
<li><a href='#plot.jumpointsVar'>
<p>Plot method for changes in variance</p></a></li>
<li><a href='#sel.control'>
<p>Auxiliary function for controlling model selection</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Change-Points Detections for Changes in Variance</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Detection of change-points for variance of heteroscedastic Gaussian variables with piecewise constant variance function. Adelfio, G. (2012), Change-point detection for variance piecewise constant models, Communications in Statistics, Simulation and Computation, 41:4, 437-448, &lt;<a href="https://doi.org/10.1080%2F03610918.2011.592248">doi:10.1080/03610918.2011.592248</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>MASS, lars</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-23 20:24:34 UTC; gianlucasottile</td>
</tr>
<tr>
<td>Author:</td>
<td>Gianluca Sottile [cre],
  Giada Adelfio [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-23 20:53:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='changepointsVar-package'>
Change-Points Detections for Changes in Variance
</h2><span id='topic+changepointsVar-package'></span>

<h3>Description</h3>

<p>This algorithm allows breakpoint detections for changes in variation assuming that the variance function can be described by a piecewise constant function with segments delimited by unknown change-points. The approach is a generalization of the <code>cumSeg</code> procedure proposed by Muggeo and Adelfio (2011) assuming that testing for stepwise changes in variance of a sequence of Gaussian random variables may be transformed equivalently to the case of testing for changes in mean of the squared residuals (from an estimated linear model that accounts for the mean behavior of the observed signal) assuming a gamma GLM with a log-link function. A variation of <code>lars</code> procedure adapted to the GLM case is considered to discard the spurious change-points on the basis of a generalized version of the BIC. The proposed approach results in a very efficient algorithm even with n large and many change-points to be estimated. Adelfio, G. (2012), Change-point detection for variance piecewise constant models, <em>Communications in Statistics, Simulation and Computation</em>, 41:4, 437-448. Muggeo, V.M.R., Adelfio, G. (2011) Efficient change point detection for genomic sequences of continuous measurements, <em>Bioinformatics</em> 27, 161-166.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> jumpointsVar</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.1.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-01-22</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The function <code><a href="#topic+jumpointsVar">jumpointsVar</a></code> allows to specify the variable in which to look for change-point in variance. The auxiliary function <code><a href="#topic+plot.jumpointsVar">plot.jumpointsVar</a></code> can be used to plot the brekpoints detected from the main algorithm.
</p>


<h3>Author(s)</h3>

<p>Giada Adelfio
</p>
<p>Maintainer: Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;
</p>


<h3>References</h3>

<p>Adelfio, G. (2012), Change-point detection for variance piecewise constant models, <em>Communications in Statistics, Simulation and Computation</em>, 41:4, 437-448
</p>
<p>Muggeo, V.M.R., Adelfio, G. (2011) Efficient change point detection for genomic sequences of continuous measurements, <em>Bioinformatics</em> 27, 161-166.</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- see jumpointsVar documentation ----
</code></pre>

<hr>
<h2 id='fit.control'>
Auxiliary function for controlling model fitting
</h2><span id='topic+fit.control'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for model fitting. Typically
only used when calling 'jumpointsVar'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.control(toll=0.001, it.max=10, last=TRUE, scale.res=FALSE,
            maxit.glm=30, h=1, stop.if.error=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit.control_+3A_toll">toll</code></td>
<td>

<p>positive convergence tolerance.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_it.max">it.max</code></td>
<td>

<p>integer giving the maximal number of iterations.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_last">last</code></td>
<td>

<p>Currently ignored.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_scale.res">scale.res</code></td>
<td>

<p>logical indicating if the residuals have to be scaled.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_maxit.glm">maxit.glm</code></td>
<td>

<p>Currently ignored.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_h">h</code></td>
<td>

<p>Currently ignored.
</p>
</td></tr>
<tr><td><code id="fit.control_+3A_stop.if.error">stop.if.error</code></td>
<td>

<p>logical indicating if the algorithm should stop when one or more estimated changepoints
do not assume admissible values. Default is <code>FALSE</code> which implies automatic
changepoint selection.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments as components to be used by 'jumpointsVar'.
</p>


<h3>Author(s)</h3>

<p>Gianluca Sottile
Maintainer: Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jumpointsVar">jumpointsVar</a></code></p>

<hr>
<h2 id='internals'>Internal Functions</h2><span id='topic+internals'></span><span id='topic+maxRSS'></span><span id='topic+seg.lm.fit0.gamma'></span><span id='topic+print.jumpointsVar'></span>

<h3>Description</h3>

<p>Functions for internal use only, or not yet documented.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seg.lm.fit0.gamma(y, Z, PSI, control, round=FALSE, print.level=0)
maxRSS(RSS, S, n)
## S3 method for class 'jumpointsVar'
print(x, digits=max(3L, getOption("digits") - 3L), ...)
</code></pre>

<hr>
<h2 id='jumpointsVar'>
Change-point detection for variance piecewise constant models
</h2><span id='topic+jumpointsVar'></span>

<h3>Description</h3>

<p>Detection of change-points for variance of
heteroscedastic Gaussian variables  with piecewise constant
variance function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jumpointsVar(y, x, y.res=FALSE, k=min(30, round(length(y)/10)), print.level=0,
             plot.it=FALSE, psi=NULL, round=TRUE, control=fit.control(),
             selection=sel.control())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="jumpointsVar_+3A_y">y</code></td>
<td>

<p>the response variable.
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_x">x</code></td>
<td>

<p>the 'segmented' variable; if missing simple indices 1,2,... are assumed.
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_y.res">y.res</code></td>
<td>

<p>logical:
if  <code>FALSE</code>, <code>y</code>  is the observed sequence with piecewise constant variance function;
if <code>TRUE</code>, <code>y</code> is the vector of the squared residuals from a fitted linear
model that accounts for the mean behavior of the observed signal with changes in variation; see Details
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_k">k</code></td>
<td>

<p>the starting number of changepoints. It should be quite larger than the supposed number of (true) changepoints. This argument is ignored if starting values of the changepoints are specified via psi.
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_print.level">print.level</code></td>
<td>

<p>the default value is 0 indicating nothing is printed; 1 allows to print some informations during the algorithm; 2 the same as for 1 plus lars information.
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_plot.it">plot.it</code></td>
<td>

<p>logical indicating if the curve of the criterion choosen has to be displayed.
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_psi">psi</code></td>
<td>

<p>numeric vector to indicate the starting values for the changepoints. When <code>psi=NULL</code> (default), <code>k</code> quantiles are assumed
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_round">round</code></td>
<td>

<p>logical: if the change-point values should be rounded
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_control">control</code></td>
<td>

<p>a list returned by <code>fit.control</code>
</p>
</td></tr>
<tr><td><code id="jumpointsVar_+3A_selection">selection</code></td>
<td>

<p>a list returned by <code>sel.control</code>
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This algorithm allows breakpoint detections for changes in variation assuming that the variance function can be described by a piecewise constant function with segments delimited by unknown change-points.
</p>
<p>The approach is a generalization of the <code>cumSeg</code> procedure proposed by Muggeo and Adelfio (2011) assuming that testing for stepwise changes in variance of a sequence of Gaussian random variables may be transformed equivalently to the case of testing for changes in mean of the squared residuals (from an estimated linear model that accounts for the mean behavior of the observed signal) assuming a gamma GLM with a log-link function.
</p>
<p>A variation of <code>lars</code> procedure adapted to the GLM case is considered to discard the spurious change-points on the basis of a generalized version of the BIC.
</p>
<p>The proposed approach results in a very efficient algorithm even with n large and many change-points to be estimated.
</p>


<h3>Value</h3>

<p>An object of class <code>jumpointsVar</code>. It's a list including several components:
</p>
<table role = "presentation">
<tr><td><code>psi</code></td>
<td>
<p>the estimated changepoints</p>
</td></tr>
<tr><td><code>est.means</code></td>
<td>
<p>the estimated means</p>
</td></tr>
<tr><td><code>n.psi</code></td>
<td>
<p>the estimated number of changepoints</p>
</td></tr>
<tr><td><code>psi0</code></td>
<td>
<p>the initial estimated changepoints (before applying the selection criterion)</p>
</td></tr>
<tr><td><code>est.means0</code></td>
<td>
<p>the initial estimated means (before applying the selection criterion)</p>
</td></tr>
<tr><td><code>criterion</code></td>
<td>
<p>the curve of the selected criterion</p>
</td></tr>
<tr><td><code>fitted.values</code></td>
<td>
<p>the fitted values</p>
</td></tr>
<tr><td><code>input</code></td>
<td>
<p>the input parameters</p>
</td></tr>
<tr><td><code>call</code></td>
<td>
<p>the call function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Giada Adelfio
</p>
<p>Maintainer: Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;
</p>


<h3>References</h3>

<p>Adelfio, G. (2012), Change-point detection for variance piecewise constant models, <em>Communications in Statistics, Simulation and Computation</em>, 41:4, 437-448
</p>
<p>Muggeo, V.M.R., Adelfio, G. (2011) Efficient change point detection for genomic sequences of continuous measurements, <em>Bioinformatics</em> 27, 161-166.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.jumpointsVar">plot.jumpointsVar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
n = 500
x = 1:n/n
mu = 10+6*sin(3*pi*x)
# if there are two change-points
sigma = c(rep(0.5,.2*n), rep(8,.4*n), rep(3,.4*n))
y = mu + rnorm(n, 0, sigma)
reg = lm(y ~ mu)
h = influence(reg)$hat
r2 = resid(reg)^2/(1-h) + 1
o = jumpointsVar(y=r2, y.res=TRUE, k=30)
o
plot(o)

# if there are no change-points
sigma = 0.5*x
y = mu + rnorm(n, 0, sigma)
reg = lm(y ~ mu)
h = influence(reg)$hat
r2 = resid(reg)^2/(1-h)+1
o = jumpointsVar(y=r2, y.res=TRUE, k=30)
plot(o)

# if the mean behavior of the observed signal is unkown
sigma = c(rep(0.5,.2*n), rep(8,.4*n), rep(3,.4*n))
y = 10 + rnorm(n, 0, sigma)
o = jumpointsVar(y=y, y.res=FALSE, k=30)
plot(o)

</code></pre>

<hr>
<h2 id='plot.jumpointsVar'>
Plot method for changes in variance
</h2><span id='topic+plot.jumpointsVar'></span>

<h3>Description</h3>

<p>Plots signal with changes in variance and corresponding changepoints
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'jumpointsVar'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.jumpointsVar_+3A_x">x</code></td>
<td>

<p>object returned by jumpointsVar
</p>
</td></tr>
<tr><td><code id="plot.jumpointsVar_+3A_...">...</code></td>
<td>

<p>additional arguments.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This fuction takes a fitted object returned by jumpointsVar and plots the resulting fit with changepoints.
</p>


<h3>Value</h3>

<p>The function simply plot the fit returned by 'jumpointsVar'
</p>


<h3>Author(s)</h3>

<p>Giada Adelfio
</p>
<p>Maintainer: Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;
</p>


<h3>References</h3>

<p>Adelfio, G. (2012), Change-point detection for variance piecewise constant models,<em>Communications in Statistics, Simulation and Computation</em>, 41:4, 437-448
</p>
<p>Muggeo, V.M.R., Adelfio, G. (2011) Efficient change point detection for genomic sequences of continuous measurements, <em>Bioinformatics</em> 27, 161-166.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jumpointsVar">jumpointsVar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##---- see jumpointsVar documentation ----
</code></pre>

<hr>
<h2 id='sel.control'>
Auxiliary function for controlling model selection
</h2><span id='topic+sel.control'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for model selection. Typically
only used when calling 'jumpointsVar'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sel.control(type=c("bic", "rss"), S=1, Cn="2*log(log(n))",
            alg=c("lasso", "stepwise"), edf.psi=TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sel.control_+3A_type">type</code></td>
<td>

<p>the criterion to be used to perform model selection.
</p>
</td></tr>
<tr><td><code id="sel.control_+3A_s">S</code></td>
<td>

<p>if <code>type="rss"</code> the optimal model is selected when the residual sum of squares decreases
by the threshold <code>S</code>.
</p>
</td></tr>
<tr><td><code id="sel.control_+3A_cn">Cn</code></td>
<td>

<p>if <code>type="bic"</code> a character string (as a function of <code>'n'</code>) to specify to generalized BIC.
If <code>Cn=1</code> the standard BIC is used.
</p>
</td></tr>
<tr><td><code id="sel.control_+3A_alg">alg</code></td>
<td>

<p>which procedure should be used to perform model selection? The value of <code>alg</code> is
passed to the argument <code>'type'</code> of <code>lars</code>.
</p>
</td></tr>
<tr><td><code id="sel.control_+3A_edf.psi">edf.psi</code></td>
<td>

<p>logical indicating if the number of changepoints should be computed in the model df.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function specifies how to perform model seletion, namely how many change points should be selected.
</p>


<h3>Value</h3>

<p>A list with the arguments as components to be used by 'jumpointsVar' and in turn by 'lars'.
</p>


<h3>Author(s)</h3>

<p>Gianluca Sottile
Maintainer: Gianluca Sottile &lt;gianluca.sottile@unipa.it&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+jumpointsVar">jumpointsVar</a></code>, <code><a href="lars.html#topic+lars">lars</a></code></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
