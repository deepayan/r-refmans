<!DOCTYPE html><html><head><title>Help for package MF.beta4</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MF.beta4}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#MF.beta4-package'><p>Measuring ecosystem multifunctionality and assessing BEF relationships</p></a></li>
<li><a href='#forest_biodiversity_data'><p>Biodiversity data for six European forests</p></a></li>
<li><a href='#forest_function_data_normalized'><p>Normalized ecosystem function data for six European forests</p></a></li>
<li><a href='#forest_function_data_raw'><p>Ecosystem function data for six European forests</p></a></li>
<li><a href='#function_normalization'><p>Normalize raw ecosystem function values to [0,1]</p></a></li>
<li><a href='#MF1_single'><p>multifunctionality measures for a single ecosystem</p></a></li>
<li><a href='#MF2_multiple'><p>multifunctionality measures for multiple ecosystems</p></a></li>
<li><a href='#MFggplot'><p>ggplot2 extension for a MF1_single or MF2_multiple object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Measuring Ecosystem Multi-Functionality and Its Decomposition</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Anne Chao [aut, cre],
  Chun-Yu Liu [ctb],
  KaiHsiang Hu [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anne Chao &lt;chao@stat.nthu.edu.tw&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/AnneChao/MF.beta4">https://github.com/AnneChao/MF.beta4</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/AnneChao/MF.beta4/issues">https://github.com/AnneChao/MF.beta4/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Provide simple functions to (i) compute a class of 
  multi-functionality measures for a single ecosystem for given 
  function weights, (ii) decompose gamma multi-functionality 
  for multiple ecosystems into a within-ecosystem component 
  (alpha multi-functionality) and an among-ecosystem component 
  (beta multi-functionality). In each case, the correlation 
  between functions can be corrected for. Based on biodiversity 
  and ecosystem function data, this software also facilitates 
  graphics for assessing biodiversity-ecosystem functioning 
  relationships across scales. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>broom, devtools, ggplot2, dplyr, stats, ggpubr, grid, purrr,
patchwork, tidyr, lme4, lmerTest, tidyverse</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-25 05:32:07 UTC; stat-pc</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-25 07:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='MF.beta4-package'>Measuring ecosystem multifunctionality and assessing BEF relationships</h2><span id='topic+MF.beta4-package'></span>

<h3>Description</h3>

<p><code>MF.beta4</code> is an R package for measuring ecosystem multifunctionality and assessing BEF relationships. The measures are illustrated by using ecosystem function and biodiversity data collected in a total of 209 plots in six European countries (the FunDivEUROPE dataset). All data are available from the Dryad repository; see Ratcliffe et al. (2017a, b) and Scherer-Lorenzen et al. (2023) for data details. The software was originally developed for the Beta4 project (Müller et al. 2022) on the effect of enhancing the beta diversity between forest patches on ecosystem multifunctionality and forest resilience across spatial scales.    <br />
</p>
<p>Based on a framework of Hill-Chao numbers of orders q = 0, 1 and 2, <code>MF.beta4</code> features the following multifunctionality measures for a single and multiple ecosystems; see Chao et al. (2023) for pertinent methodology and decomposition theory. <br />
</p>
<p>(1)	Multifunctionality measures in a single ecosystem: <code>MF.beta4</code> computes a class of weighted multifunctionality measures for given function weights. Multifunctionality measures that correct for strong correlations between ecosystem functions to avoid redundancy are also provided. <br />
</p>
<p>(2)	Multifunctionality measures in multiple ecosystems: for given function weights, <code>MF.beta4</code> computes the gamma multifunctionality of pooled ecosystems, the within-ecosystem component (alpha multifunctionality) and the among-ecosystem component (beta multifunctionality). The correlation between functions can also be corrected for.   <br />
</p>
<p>Based on biodiversity and function data from ecosystems, this package also provides graphics for assessing biodiversity-ecosystem functioning (BEF) relationships across scales.   <br />
</p>
<p>This package includes four main functions:   <br />
</p>
<p>1. <code>function_normalization</code> transforms ecosystem functions data to values between 0 and 1. <br /> 
</p>
<p>2. <code>MF1_single</code> computes a class of weighted multifuctionality measures in a single ecosystem for given individual function weights separately for two cases: (i) correlations between functions are not corrected for, and (ii) correlations between functions are corrected for. <br />
</p>
<p>3. <code>MF2_multiple</code> computes alpha, beta and gamma multifuctionality measures in multiple ecosystems for given function weights separately for two cases (i) correlations between functions are not corrected for, and (ii) correlations between functions are corrected for.<br />
</p>
<p>4. <code>MFggplot</code> provides the graphical BEF relationships based on the output from the function <code>MF1_single</code> or <code>MF2_multiple</code>.
</p>


<h3>Author(s)</h3>

<p>Anne Chao, Chun-Yu Liu, K. H. Hu  <br />
Maintainer: Anne Chao &lt;chao@stat.nthu.edu.tw&gt; 
</p>


<h3>References</h3>

<p>Chao, A., Chiu, C. H., Hu, K. H., van der Plas, F., Cadotte, M. W., Mitesser, O., et al. (2023). Hill-Chao numbers in multifunctionality allows decomposing gamma multifunctionality into alpha and beta components. To appear in Ecology Letters.  
</p>
<p>Müller, J., Mitesser, O. Cadotte, M. W., van der Plas, F., Mori, A, Ammer, C., Eisenhauer N. (2023). Enhancing the structural diversity between forest patches - a concept and real-world experiment to study biodiversity and multifunctionality across spatial scales. Global Change Biology, 29, 1437-1450.
</p>
<p>Ratcliffe, S. Wirth, C., Jucker, T. van der Plas, F., Scherer-Lorenzen, M. Verheyen, K. et al. (2017a). Biodiversity and ecosystem functioning relations in European forests depend on environmental context. Ecology Letters, 20, 1414-1426.
</p>
<p>Ratcliffe, S. Wirth, C., Jucker, T., van der Plas, F., Scherer-Lorenzen, M., Verheyen, K. et al. (2017b). Data for Biodiversity and ecosystem functioning relations in European forests depend on environmental context. https://doi.org/10.6084/m9.figshare.5368846.v1
</p>
<p>Scherer-Lorenzen, M. et al. (2023). The functional significance of tree species diversity in European forests - the FunDivEUROPE dataset [Dataset]. Dryad. https://doi.org/10.5061/dryad.9ghx3ffpz
</p>

<hr>
<h2 id='forest_biodiversity_data'>Biodiversity data for six European forests</h2><span id='topic+forest_biodiversity_data'></span>

<h3>Description</h3>

<p>In addition to row and column names, this dataset consists of three columns: the “plotID” column indicates the names of plots, the “species” column includes species names, and the column “abundance” (basal area as a proxy of species abundance). Because missing values of “basal area” in the original dataset were imputed by the mean of the same species within the country, and basal areas were combined for two species (“Betula pendula” and “Betula pubescens”), the dataset provided with the package is slightly different from the original dataset provided in Scherer-Lorenzen et al. (2023). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("forest_biodiversity_data")
</code></pre>


<h3>Format</h3>

<p>a data.frame with 481 rows (the total number of combinations of plot and tree species in 209 plots) and 3 columns (plotID, species name, and the corresponding basal area as species abundance).
</p>


<h3>References</h3>

<p>Scherer-Lorenzen, M. et al. (2023). The functional significance of tree species diversity in European forests - the FunDivEUROPE dataset [Dataset]. Dryad. https://doi.org/10.5061/dryad.9ghx3ffpz
</p>

<hr>
<h2 id='forest_function_data_normalized'>Normalized ecosystem function data for six European forests</h2><span id='topic+forest_function_data_normalized'></span>

<h3>Description</h3>

<p>This dataset represents the normalized version of the raw dataset (<code>forest_function_data_raw</code>). All raw ecosystem functions are normalized to the range of [0, 1], whereas other variables remain unchanged.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("forest_function_data_normalized")
</code></pre>


<h3>Format</h3>

<p>a data.frame with 209 plots (rows) and 32 columns, in addition to row and column names; the first 5 columns show the relevant plot information, followed by 26 normalized ecosystem functions. The last column shows the corresponding country for each plot.
</p>

<hr>
<h2 id='forest_function_data_raw'>Ecosystem function data for six European forests</h2><span id='topic+forest_function_data_raw'></span>

<h3>Description</h3>

<p>In addition to plot information, this dataset includes raw values of 26 ecosystem functions collected from 209 plots (each with 30 m × 30 m) in six European countries, representing six major European forest types: boreal forest (Finland, 28 plots); hemi-boreal (Poland, 43 plots); temperate deciduous (Germany, 38 plots); mountainous deciduous (Romania, 28 plots); thermophilous deciduous (Italy, 36 plots); and Mediterranean mixed (Spain, 36 plots). See Table 1 of Ratcliffe et al. (2017a) for a description of the 26 functions. Each plot is designated as an ecosystem in assessing BEF relationships. See Ratcliffe et al. (2017b) and Scherer-Lorenzen et al. (2023) for the original dataset. For each missing value of functions in the original dataset, the mean of the given function within the country was imputed. An additional column “country” for each plot is added (as the last column) because function normalization and relevant analyses will be performed within each country. Thus, the dataset provided with the package is slightly different from the original one. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("forest_function_data_raw")
</code></pre>


<h3>Format</h3>

<p>a data.frame with 209 plots (rows) and 32 columns, in addition to row and column names; the first 5 columns show the relevant plot information, followed by 26 raw ecosystem functions (columns 6 to 31). The last column shows the corresponding country for each plot.
</p>


<h3>References</h3>

<p>Ratcliffe, S. Wirth, C., Jucker, T. van der Plas, F., Scherer-Lorenzen, M. Verheyen, K. et al. (2017a). Biodiversity and ecosystem functioning relations in European forests depend on environmental context. Ecology Letters, 20, 1414–1426. <br />
</p>
<p>Ratcliffe, S. Wirth, C., Jucker, T., van der Plas, F., Scherer-Lorenzen, M., Verheyen, K. et al. (2017b). Data for Biodiversity and ecosystem functioning relations in European forests depend on environmental con- text. https://doi.org/10.6084/m9.figshare.5368846.v1 <br />
</p>
<p>Scherer-Lorenzen, M. et al. (2023). The functional significance of tree species diversity in European forests - the FunDivEUROPE dataset [Dataset]. Dryad. https://doi.org/10.5061/dryad.9ghx3ffpz
</p>

<hr>
<h2 id='function_normalization'>Normalize raw ecosystem function values to [0,1]</h2><span id='topic+function_normalization'></span>

<h3>Description</h3>

<p><code>function_normalization</code> transforms raw function values to values between 0 and 1. For positive functionality,
ecosystems with the highest value in the raw function data are transformed to the maximal value of 1, and those with the lowest raw value are transformed to the minimum value of 0.
Because the value &quot;0&quot; always implies absent functions, if the lowest raw value is not 0, the transformed 0 from this non-zero raw value will be replaced by a very small number,e.g., 10^(-5). 
In a similar manner, for negative functionality, if the highest raw value is not 0, the transformed 0 will also be replaced by a very small number, e.g., 10^(-5).
These replacements will not affect any numerical computations but will help indicate that the transformed values represent functions that should be regarded as &quot;present&quot; ones.
Thus, present or absent functions can be clearly distinguished in the transformed data, and the information on presence/absence of functions is required in the decomposition of multifunctionality
among ecosystems.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>function_normalization(
  data,
  fun_cols = 1:ncol(data),
  negative = NULL,
  by_group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="function_normalization_+3A_data">data</code></td>
<td>
<p>data can be input as a data.frame with ecosystems/plots as rows and relevant ecosystem/plot information and ecosystem functions as columns. All missing values should be imputed in the input data. <br />
If the stratifying/grouping variable (specified in the argument <code>by_group</code>) is not <code>NULL</code>, data must contain a column that is used for stratification.</p>
</td></tr>
<tr><td><code id="function_normalization_+3A_fun_cols">fun_cols</code></td>
<td>
<p>the columns that represent ecosystem functions.</p>
</td></tr>
<tr><td><code id="function_normalization_+3A_negative">negative</code></td>
<td>
<p>names of the negative functionality.</p>
</td></tr>
<tr><td><code id="function_normalization_+3A_by_group">by_group</code></td>
<td>
<p>the column name of the stratifying variable that is used to group data for performing normalization.
For example, if <code>by_group = "country"</code>, then all functions will be normalized to the range of [0, 1] within a country. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with all values in functions (specified in <code>fun_cols</code>) being replaced by the transformed values between 0 and 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

### Use data from six countries

data("forest_function_data_raw")
function_normalization(data = forest_function_data_raw, fun_cols = 6:31,
                       negative = c("soil_cn_ff_10","wue"), by_group = "country")


### Use partial data to quickly obtain output 
### (Take the first 18 plots in Germany and the last 18 plots in Italy)

data("forest_function_data_raw")
GER_ITA_forest_function_raw &lt;- filter(forest_function_data_raw, 
                                      country=="GER"|country=="ITA")[c(1:18,57:74),]
function_normalization(data = GER_ITA_forest_function_raw, fun_cols = 6:31,
                       negative = c("soil_cn_ff_10","wue"), by_group = "country")


</code></pre>

<hr>
<h2 id='MF1_single'>multifunctionality measures for a single ecosystem</h2><span id='topic+MF1_single'></span>

<h3>Description</h3>

<p><code>MF1_single</code> computes multifunctionality measures of orders q = 0, 1 and 2 for given function weights in a single ecosystem separately for two cases
(i) correlations between functions are not corrected for, and (ii) correlations between functions are corrected for.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MF1_single(func_data, species_data = NULL, weight = 1, q = c(0, 1, 2))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MF1_single_+3A_func_data">func_data</code></td>
<td>
<p>ecosystem function data should be input as a data.frame (ecosystems by functions). All function values must be normalized between 0 and 1.<br />
The row names of <code>func_data</code> should be set the same as the names of plotID specified in <code>species_data</code> if <code>species_data</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="MF1_single_+3A_species_data">species_data</code></td>
<td>
<p>species abundance data should be input as a data.frame and must include three columns: &quot;plotID&quot;, &quot;species&quot; and &quot;abundance&quot; (or any proxy such as basal area). Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="MF1_single_+3A_weight">weight</code></td>
<td>
<p>a constant number (if all weights are equal) or a numerical vector specifying weights for ecosystem functions.
In the latter case, the length of <code>weight</code> must be equal to the number of functions.
Default is <code>weight = 1</code>, which means equal weight and weight = 1 for all ecosystem functions.</p>
</td></tr>
<tr><td><code id="MF1_single_+3A_q">q</code></td>
<td>
<p>a numerical vector specifying the multifunctionality and diversity orders. Default is q = 0, 1 and 2.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with columns &quot;plotID&quot;, &quot;Type&quot; (corr_uncorrected or corr_corrected), &quot;Order.q&quot; and &quot;qMF&quot; (multifunctionality of order q).
When <code>species_data</code> is not <code>NULL</code>, the data.frame will include an additional column &quot;Species.diversity&quot; in the last column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)


### Use data from six countries

data("forest_function_data_normalized")
data("forest_biodiversity_data")
MF1_single(func_data = forest_function_data_normalized[,6:31], weight = 1,
           species_data = forest_biodiversity_data)


### Use partial data to quickly obtain output 
### (Take the first 18 plots in Germany and the last 18 plots in Italy)

data("forest_function_data_raw")
data("forest_biodiversity_data")
GER_ITA_forest_function_raw &lt;- filter(forest_function_data_raw, 
                                      country=="GER"|country=="ITA")[c(1:18,57:74),]
GER_ITA_forest_function_normalized &lt;- function_normalization(data = GER_ITA_forest_function_raw,
                                                             fun_cols = 6:31, 
                                                             negative = c("soil_cn_ff_10","wue"),
                                                             by_group = "country")
GER_ITA_forest_biodiversity &lt;- forest_biodiversity_data[c(49:82,181:229),]
MF1_single(func_data = GER_ITA_forest_function_normalized[,6:31], weight = 1,
           species_data = GER_ITA_forest_biodiversity)

</code></pre>

<hr>
<h2 id='MF2_multiple'>multifunctionality measures for multiple ecosystems</h2><span id='topic+MF2_multiple'></span>

<h3>Description</h3>

<p><code>MF2_multiple</code> computes alpha, beta and gamma multifuctionality measures of orders q = 0, 1 and 2 for given function weights in multiple ecosystems separately for two cases
(i) correlations between functions are not corrected for, and (ii) correlations between functions are corrected for.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MF2_multiple(
  func_data,
  species_data = NULL,
  weight = 1,
  q = c(0, 1, 2),
  by_group = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MF2_multiple_+3A_func_data">func_data</code></td>
<td>
<p>ecosystem function data should be input as a data.frame (ecosystems by functions for multiple ecosystems). All function values must be normalized between 0 and 1. <br />
For <code>by_group = NULL</code>, the <code>func_data</code> must contain only the ecosystem function columns. (e.g., those columns specified in the argument <code>fun_cols</code> if user use <code>function_normalization</code> to do normalization).
If <code>by_group</code> is not <code>NULL</code>,in addition to ecosystem function columns, the <code>by_group</code> column must be included. <br />
The row names of <code>func_data</code> should be set the same as the names of plotID specified in <code>species_data</code> if <code>species_data</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="MF2_multiple_+3A_species_data">species_data</code></td>
<td>
<p>species abundance data should be input as a data.frame and must include three columns: &quot;plotID&quot;, &quot;species&quot; and &quot;abundance&quot;. Default is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="MF2_multiple_+3A_weight">weight</code></td>
<td>
<p>a constant number (if all weights are equal) or a numerical vector specifying weights for ecosystem functions.
In the latter case, the length of <code>weight</code> must be equal to the number of functions. Default is <code>weight = 1</code>, which means equal weight and weight = 1 for all ecosystem functions.</p>
</td></tr>
<tr><td><code id="MF2_multiple_+3A_q">q</code></td>
<td>
<p>a numerical vector specifying the multifunctionality and diversity orders. Default is q = 0, 1 and 2.</p>
</td></tr>
<tr><td><code id="MF2_multiple_+3A_by_group">by_group</code></td>
<td>
<p>the column name of the stratifying variable that is used to group data for performing decomposition.
For example, if <code>by_group = "country"</code>, then multifunctionality decomposition is performed for any pair of plots selected within a country. <br />
The <code>by_group</code> setting must be the same as that set in <code>function_normalization</code>. Default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data.frame with columns &quot;plotID&quot; (combinations of plot pairs), &quot;Order.q&quot; , &quot;Type&quot; (corr_uncorrected or corr_corrected) , &quot;Scale&quot; (gamma, alpha or beta) and &quot;qMF&quot; (multifunctionality of order q).
When <code>by_group</code> is not <code>NULL</code> (i.e., the column name of the stratifying variable is specified),
an additional column with stratification variable (e.g., &quot;country&quot; of the plot pairs) is also shown after the plotID column. For <code>species_data</code> is not <code>NULL</code>,
the data.frame will show an additional column contain &quot;Species.diversity&quot; in the last column.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)


### Use data from five countries (data in Finland are excluded)

data("forest_function_data_normalized")
data("forest_biodiversity_data")
forest_function_data_normalized &lt;- filter(forest_function_data_normalized, country != "FIN")
forest_biodiversity_data &lt;- forest_biodiversity_data[-(1:48),]
MF2_multiple(func_data = forest_function_data_normalized[,6:32],
             species_data = forest_biodiversity_data,
             weight = 1,
             by_group = "country")

### Use partial data to quickly obtain output 
### (Take the first 18 plots in Germany and the last 18 plots in Italy)

data("forest_function_data_raw")
data("forest_biodiversity_data")
GER_ITA_forest_function_raw &lt;- filter(forest_function_data_raw, 
                                      country=="GER"|country=="ITA")[c(1:18,57:74),]
GER_ITA_forest_function_normalized &lt;- function_normalization(data = GER_ITA_forest_function_raw,
                                                             fun_cols = 6:31, 
                                                             negative = c("soil_cn_ff_10","wue"),
                                                             by_group = "country")
GER_ITA_forest_biodiversity &lt;- forest_biodiversity_data[c(49:82,181:229),]
MF2_multiple(func_data = GER_ITA_forest_function_normalized[,6:32],
             species_data = GER_ITA_forest_biodiversity,
             weight = 1,
             by_group = "country")


</code></pre>

<hr>
<h2 id='MFggplot'>ggplot2 extension for a MF1_single or MF2_multiple object</h2><span id='topic+MFggplot'></span>

<h3>Description</h3>

<p><code>MFggplot</code> provides graphical BEF relationships based on the output from the function <code>MF1_single</code> or <code>MF2_multiple</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MFggplot(output, model = "LMM.both", caption = "slope", by_group = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MFggplot_+3A_output">output</code></td>
<td>
<p>the output obtained from <code>MF1_single</code> or <code>MF2_multiple</code>. <br />
For output obtained from <code>MF1_single</code>, if BEF relationships are desired within each category specified <code>by_group</code>, the <code>by_group</code> column must be included in the input.</p>
</td></tr>
<tr><td><code id="MFggplot_+3A_model">model</code></td>
<td>
<p>specifying the fitting model, <code>model = "lm"</code> for linear model; <code>model = "LMM.intercept"</code>,
<code>"LMM.slope"</code> and <code>"LMM.both"</code> for linear mixed models with random effects for intercepts, slopes, and both, respectively.
Default is <code>model = "LMM.both"</code>.</p>
</td></tr>
<tr><td><code id="MFggplot_+3A_caption">caption</code></td>
<td>
<p>caption that will be shown in the BEF plots; <code>caption = "slope"</code> to show the estimated slopes in each plot,
or <code>caption = "R.squared"</code> to show the ordinary R-squared for linear models or estimated marginal and conditional R-squared for linear mixed models in each plot.
Default is <code>caption = "slope"</code>.</p>
</td></tr>
<tr><td><code id="MFggplot_+3A_by_group">by_group</code></td>
<td>
<p>the column name of the stratifying variable that is used to group data for model fitting. For example, if <code>by_group = "country"</code>, then model will be fitted within each country. Default is <code>NULL</code>. <br />
It is required if a linear mixed model is selected in the <code>model</code>. <br />
If <code>output</code> is obtained from <code>MF2_multiple</code>, the <code>by_group</code> setting must be the same as that set in <code>MF2_multiple</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For an <code>MF1_single</code> object, this function returns a figure that plots the BEF relationship between multifunctionality of
order q (= 0, 1 and 2) and species diversity of the same order q for two cases (i) correlations between functions are not corrected for, and (ii) correlations between
functions are corrected. The fitted lines for the chosen model are also shown in the figure. <br />
</p>
<p>For an <code>MF2_multiple</code> object of given individual function weights, this function returns a list of two objects (<code>$corr_uncorrected</code> and <code>$corr_corrected</code>)
that respectively for two cases: (i) correlations between functions are not corrected for, and (ii) correlations between functions are corrected for. <br />
</p>
<p>Each object consists of four figures: &quot;<code>$ALL</code>&quot; returns a figure that depicts the BEF relationship between alpha/beta/gamma multifunctionality of
order q (= 0, 1 and 2) and the corresponding species diversity of the same order q. The fitted lines for the chosen model are also shown in the figure.
&quot;<code>$Gamma</code>&quot; returns only the gamma part of &quot;<code>$ALL</code>&quot;, &quot;<code>$Alpha</code>&quot; returns only the alpha part of &quot;<code>$ALL</code>&quot;, and &quot;<code>$Beta</code>&quot; returns only the beta part of &quot;<code>$ALL</code>&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(dplyr)

### Use data from six countries


## single ecosystem
data("forest_function_data_normalized")
data("forest_biodiversity_data")
output1 &lt;- MF1_single(func_data = forest_function_data_normalized[,6:31], weight = 1,
                      species_data = forest_biodiversity_data)
  
## Display fitted line of linear mixed model with random slopes and random intercepts  
output1 &lt;- data.frame(output1, country=rep(forest_function_data_normalized$country, each = 6))
MFggplot(output1, model = "LMM.both", by_group="country", caption = "slope")


### Use data from five countries (data in Finland are excluded)
 
## multiple ecosystems
data("forest_function_data_normalized")
data("forest_biodiversity_data")
forest_function_data_normalized &lt;- filter(forest_function_data_normalized, country != "FIN")
forest_biodiversity_data &lt;- forest_biodiversity_data[-(1:48),]
output2 &lt;- MF2_multiple(func_data = forest_function_data_normalized[,6:32],
                        species_data = forest_biodiversity_data,
                        weight = 1,
                        by_group = "country")

## Display fitted line of linear mixed model with random slopes and random intercepts  
figure_LMM &lt;- MFggplot(output2, model = "LMM.both", by_group = "country", 
                       caption = "slope")
figure_LMM$corr_uncorrected$ALL
figure_LMM$corr_corrected$ALL


### Use partial data to quickly obtain output  
### (Take the first 18 plots in Germany and the last 18 plots in Italy)

## single ecosystem
data("forest_function_data_raw")
data("forest_biodiversity_data")
GER_ITA_forest_function_raw &lt;- filter(forest_function_data_raw, 
                                      country=="GER"|country=="ITA")[c(1:18,57:74),]
GER_ITA_forest_function_normalized &lt;- function_normalization(data = GER_ITA_forest_function_raw,
                                                             fun_cols = 6:31, 
                                                             negative = c("soil_cn_ff_10","wue"),
                                                             by_group = "country")
GER_ITA_forest_biodiversity &lt;- forest_biodiversity_data[c(49:82,181:229),]
output3 &lt;- MF1_single(func_data = GER_ITA_forest_function_normalized[,6:31], weight = 1,
                      species_data = GER_ITA_forest_biodiversity)


## Display fitted line of linear mixed model with random slopes and random intercepts  
output3 &lt;- data.frame(output3, country=rep(GER_ITA_forest_function_normalized$country, each = 6))
MFggplot(output3, model = "LMM.both", by_group="country", caption = "slope")


## multiple ecosystems
data("forest_function_data_raw")
data("forest_biodiversity_data")
GER_ITA_forest_function_raw &lt;- filter(forest_function_data_raw, 
                                      country=="GER"|country=="ITA")[c(1:18,57:74),]
GER_ITA_forest_function_normalized &lt;- function_normalization(data = GER_ITA_forest_function_raw,
                                                             fun_cols = 6:31, 
                                                             negative = c("soil_cn_ff_10","wue"),
                                                             by_group = "country")
GER_ITA_forest_biodiversity &lt;- forest_biodiversity_data[c(49:82,181:229),]
output4 &lt;- MF2_multiple(func_data = GER_ITA_forest_function_normalized[,6:32],
                        species_data = GER_ITA_forest_biodiversity,
                        weight = 1,
                        by_group = "country")


## Display fitted line of linear mixed model with random slopes and random intercepts  
figure_LMM_GER_ITA &lt;- MFggplot(output4, model = "LMM.both", by_group = "country", 
                               caption = "slope")
figure_LMM_GER_ITA$corr_uncorrected$ALL
figure_LMM_GER_ITA$corr_corrected$ALL


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
