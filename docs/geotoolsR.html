<!DOCTYPE html><html lang="en"><head><title>Help for package geotoolsR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {geotoolsR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gboot_block'><p>Block bootstrap</p></a></li>
<li><a href='#gboot_CI'><p>Bootstrap Confidence Interval</p></a></li>
<li><a href='#gboot_cloud'><p>Bootstrap of the variogram cloud</p></a></li>
<li><a href='#gboot_cross'><p>Cross-validation bootstrap</p></a></li>
<li><a href='#gboot_plot'><p>Bootstrap plot</p></a></li>
<li><a href='#gboot_solow'><p>Solow bootstrap</p></a></li>
<li><a href='#gboot_variogram'><p>Variogram bootstrap</p></a></li>
<li><a href='#NVDI'><p>Normalized Difference Vegetation Index experiment</p></a></li>
<li><a href='#soilmoisture'><p>Soil moisture experiment</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Tools to Improve the Use of Geostatistic</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.1</td>
</tr>
<tr>
<td>Author:</td>
<td>Diogo Francisco Rossoni
    <a href="https://orcid.org/0000-0001-6337-6628"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  Vinicius Basseto Felix [aut],
  Ricardo Puziol de Oliveira
    <a href="https://orcid.org/0000-0001-6134-5975"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Diogo Francisco Rossoni &lt;dfrossoni@uem.br&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>The basic idea of this package is provides some tools to help the researcher to work with geostatistics. Initially, we present a collection of functions that allow the researchers to deal with spatial data using bootstrap procedure. There are five methods available and two ways to display them: bootstrap confidence interval - provides a two-sided bootstrap confidence interval; bootstrap plot - a graphic with the original variogram and each of the B bootstrap variograms.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), geoR(&ge; 1.9), tidyr, dplyr, ggplot2</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-27 15:11:35 UTC; rpuzi</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-07-21 11:00:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='gboot_block'>Block bootstrap</h2><span id='topic+gboot_block'></span>

<h3>Description</h3>

<p>Performs a bootstrap based on subdivision of data in blocks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_block(data,var,model,B,L1,L2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_block_+3A_data">data</code></td>
<td>
<p>object of the class geodata.</p>
</td></tr>
<tr><td><code id="gboot_block_+3A_var">var</code></td>
<td>
<p>object of the class variogram.</p>
</td></tr>
<tr><td><code id="gboot_block_+3A_model">model</code></td>
<td>
<p>object of the class variomodel.</p>
</td></tr>
<tr><td><code id="gboot_block_+3A_b">B</code></td>
<td>
<p>number of the bootstrap that will be performed (default B=1000).</p>
</td></tr>
<tr><td><code id="gboot_block_+3A_l1">L1</code></td>
<td>
<p>number of cuts in the vertical (L1xL2 blocks).</p>
</td></tr>
<tr><td><code id="gboot_block_+3A_l2">L2</code></td>
<td>
<p>number of cuts in the horizontal (L1xL2 blocks).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm for the block bootstrap is an adaptation of the time series bootstrap.
Consider that your data presents the second order stationarity, so, we can subdivide them into small blocks.
The steps of the algorithm are:
</p>

<ol>
<li><p> Subdivide the data into L1xL2 blocks;
</p>
</li>
<li><p> Realocate each block with probability<code class="reqn">\frac{1}{L1L2}</code> ;
</p>
</li>
<li><p> Calculate the new variogram from the new data;
</p>
</li>
<li><p> Calculate and save the statistics of interest;
</p>
</li>
<li><p> Return to step 2 and repeat the process at least 1000 times.
</p>
</li></ol>



<h3>Value</h3>

<p><b>variogram_boot</b> gives the variogram of each bootstrap.
</p>
<p><b>variogram_or</b> gives the original variogram.
</p>
<p><b>pars_boot</b> gives the estimatives of the nugget, sill, contribution, range and practical range for each bootstrap.
</p>
<p><b>pars_or</b> gives the original estimatives of the nugget, sill, contribution, range and practical range.
</p>
<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>


<h3>References</h3>

<p>DAVISON, A.C.; HINKLEY, D. V. Bootstrap Methods and their Application. [s.l.] Cambridge University Press, 1997. p. 582
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example 1

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(soilmoisture)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 140) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(2,80),nugget = 2,cov.model = "sph")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_block(data,var,mod,B=10, L1=2, L2=2)
## For better Confidence Interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

# Example 2

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(NVDI)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 18) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(0.003,6),nugget = 0.003,cov.model = "gaus")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- boot&lt;- gboot_block(data,var,mod,B=10, L1=2, L2=2)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot


</code></pre>

<hr>
<h2 id='gboot_CI'>Bootstrap Confidence Interval</h2><span id='topic+gboot_CI'></span>

<h3>Description</h3>

<p>Provides a two-sided bootstrap confidence interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_CI(x,alpha=0.05,digits=3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_CI_+3A_x">x</code></td>
<td>
<p>object generate by functions <code><a href="#topic+gboot_block">gboot_block</a></code>,
<code><a href="#topic+gboot_cloud">gboot_cloud</a></code>, <code><a href="#topic+gboot_cross">gboot_cross</a></code>,
<code><a href="#topic+gboot_solow">gboot_solow</a></code>, <code><a href="#topic+gboot_variogram">gboot_variogram</a></code></p>
</td></tr>
<tr><td><code id="gboot_CI_+3A_alpha">alpha</code></td>
<td>
<p>significance level (Default=0.05).</p>
</td></tr>
<tr><td><code id="gboot_CI_+3A_digits">digits</code></td>
<td>
<p>number of decimal places.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Examples of this function can be found in <code><a href="#topic+gboot_block">gboot_block</a></code>,
<code><a href="#topic+gboot_cloud">gboot_cloud</a></code>, <code><a href="#topic+gboot_cross">gboot_cross</a></code>,
<code><a href="#topic+gboot_solow">gboot_solow</a></code>, <code><a href="#topic+gboot_variogram">gboot_variogram</a></code>
</p>


<h3>Value</h3>

<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>

<hr>
<h2 id='gboot_cloud'>Bootstrap of the variogram cloud</h2><span id='topic+gboot_cloud'></span>

<h3>Description</h3>

<p>Performs a boostrap based on the variogram cloud
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_cloud(data,var,model,B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_cloud_+3A_data">data</code></td>
<td>
<p>object of the class geodata.</p>
</td></tr>
<tr><td><code id="gboot_cloud_+3A_var">var</code></td>
<td>
<p>object of the class variogram.</p>
</td></tr>
<tr><td><code id="gboot_cloud_+3A_model">model</code></td>
<td>
<p>object of the class variomodel.</p>
</td></tr>
<tr><td><code id="gboot_cloud_+3A_b">B</code></td>
<td>
<p>number of the bootstrap that will be performed (default B=1000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The variogram cloud is computed by the function <code><a href="geoR.html#topic+variog">variog</a></code>.
It provides all the possible pairs that will generate the classical variogram.
The algorithm performs a classical bootstrap in each lag of the variogram.
The steps are:
</p>

<ol>
<li><p> Calculate the variogram cloud;
</p>
</li>
<li><p> Obtain the number of lags (See details in <code><a href="geoR.html#topic+variog">variog</a></code>: defining the bins);
</p>
</li>
<li><p> Sample with replacement in each lag;
</p>
</li>
<li><p> Create a new variogram using the average of all pairs in each lag;
</p>
</li>
<li><p> Calculate and save the statistics of interest;
</p>
</li>
<li><p> Return to step 3 and repeat the process at least 1000 times.
</p>
</li></ol>



<h3>Value</h3>

<p><b>variogram_boot</b> gives the variogram of each bootstrap.
</p>
<p><b>variogram_or</b> gives the original variogram.
</p>
<p><b>pars_boot</b> gives the estimatives of the nugget, sill, contribution, range and practical range for each bootstrap.
</p>
<p><b>pars_or</b> gives the original estimatives of the nugget, sill, contribution, range and practical range.
</p>
<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example 1

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(soilmoisture)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 140) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(2,80),nugget = 2,cov.model = "sph")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_cloud(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

# Example 2

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(NVDI)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 18) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(0.003,6),nugget = 0.003,cov.model = "gaus")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_cloud(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

</code></pre>

<hr>
<h2 id='gboot_cross'>Cross-validation bootstrap</h2><span id='topic+gboot_cross'></span>

<h3>Description</h3>

<p>Performs a boostrap based on error from the cross-validation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_cross(data,var,model,B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_cross_+3A_data">data</code></td>
<td>
<p>object of the class geodata.</p>
</td></tr>
<tr><td><code id="gboot_cross_+3A_var">var</code></td>
<td>
<p>object of the class variogram.</p>
</td></tr>
<tr><td><code id="gboot_cross_+3A_model">model</code></td>
<td>
<p>object of the class variomodel.</p>
</td></tr>
<tr><td><code id="gboot_cross_+3A_b">B</code></td>
<td>
<p>number of the bootstrap that will be performed (default B=1000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We can define the error of prediction by <code class="reqn">\epsilon({s_i})=Z({s_i})-\hat Z({s_i})</code>,
where <code class="reqn">\hat Z({s_i})</code> are obtained from cross-validation. The steps of the algorithm are:
</p>

<ol>
<li><p> Set <code class="reqn">{s_i}^*={s_i}</code>;
</p>
</li>
<li><p> Obtain <code class="reqn">\hat Z({s_i})</code> from <code class="reqn">\hat Z({s_i})=\sum\limits_{j \ne i}^{n - 1}{{\lambda _j}Z({s_j})}</code>;
</p>
</li>
<li><p> Calculate <code class="reqn">\epsilon({s_i})=Z({s_i})-\hat Z({s_i})</code>
</p>
</li>
<li><p> Sample with replacement <code class="reqn">\epsilon^*(s_i)</code> from <code class="reqn">\epsilon (s_i) - \bar \epsilon (s_i)</code>;
</p>
</li>
<li><p> The new data will be <code class="reqn">Z^*({s_i})=\hat Z({s_i})+ \epsilon^*(s_i)</code>;
</p>
</li>
<li><p> Calculate the new variogram;
</p>
</li>
<li><p> Calculate and save the statistics of interest;
</p>
</li>
<li><p> Return to step 4 and repeat the process at least 1000 times.
</p>
</li></ol>



<h3>Value</h3>

<p><b>variogram_boot</b> gives the variogram of each bootstrap.
</p>
<p><b>variogram_or</b> gives the original variogram.
</p>
<p><b>pars_boot</b> gives the estimatives of the nugget, sill, contribution, range and practical range for each bootstrap.
</p>
<p><b>pars_or</b> gives the original estimatives of the nugget, sill, contribution, range and practical range.
</p>
<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Example 1

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(soilmoisture)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 140) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(2,80),nugget = 2,cov.model = "sph")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_cross(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

# Example 2

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(NVDI)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 18) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(0.003,6),nugget = 0.003,cov.model = "gaus")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_cross(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot


</code></pre>

<hr>
<h2 id='gboot_plot'>Bootstrap plot</h2><span id='topic+gboot_plot'></span>

<h3>Description</h3>

<p>A graphic with the original variogram and each of the B bootstrap variograms.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_plot(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_plot_+3A_x">x</code></td>
<td>
<p>object generate by functions <code><a href="#topic+gboot_block">gboot_block</a></code>,
<code><a href="#topic+gboot_cloud">gboot_cloud</a></code>, <code><a href="#topic+gboot_cross">gboot_cross</a></code>,
<code><a href="#topic+gboot_solow">gboot_solow</a></code>, <code><a href="#topic+gboot_variogram">gboot_variogram</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Examples of this function can be found in <code><a href="#topic+gboot_block">gboot_block</a></code>,
<code><a href="#topic+gboot_cloud">gboot_cloud</a></code>, <code><a href="#topic+gboot_cross">gboot_cross</a></code>,
<code><a href="#topic+gboot_solow">gboot_solow</a></code>, <code><a href="#topic+gboot_variogram">gboot_variogram</a></code>
</p>


<h3>Value</h3>

<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>

<hr>
<h2 id='gboot_solow'>Solow bootstrap</h2><span id='topic+gboot_solow'></span>

<h3>Description</h3>

<p>Performs a spatial boostrap proposed by Solow(1985).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_solow(data,var,model,B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_solow_+3A_data">data</code></td>
<td>
<p>object of the class geodata.</p>
</td></tr>
<tr><td><code id="gboot_solow_+3A_var">var</code></td>
<td>
<p>object of the class variogram.</p>
</td></tr>
<tr><td><code id="gboot_solow_+3A_model">model</code></td>
<td>
<p>object of the class variomodel.</p>
</td></tr>
<tr><td><code id="gboot_solow_+3A_b">B</code></td>
<td>
<p>number of the bootstrap that will be performed (default B=1000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The basic idea involves transforming correlated observation to uncorrelated
quantities, forming a bootstrap sample from these quantities, and transforming back to a
bootstrap sample form the original observations (SOLOW, 1985). Suppose that <code class="reqn">Z_n</code>
is an <code class="reqn">n</code> vector of observations from a realization of a second-order stationary
random process, <code class="reqn">Z(s_i)</code>, and the covariance matrix for <code class="reqn">Z_n</code> is <code class="reqn">C</code>. Suppose
further that <code class="reqn">E(Z_n)={0_n}</code>, where <code class="reqn">{0_n}</code> is an <code class="reqn">n</code> vector of zeroes.
In practice <code class="reqn">Z_n</code> can be centered by subtracting an estimate of the stationary mean from
each observation. So, the steps of the algorithm are:
</p>

<ol>
<li><p> Obtain <code class="reqn">C</code>;
</p>
</li>
<li><p> Apply the Cholesky decomposition in <code class="reqn">C</code>, obtaining <code class="reqn">C=LL^t</code>, where
<code class="reqn">L</code> is lower triangular;
</p>
</li>
<li><p> Obtain <code class="reqn">U_n=L^{-1}Z_n</code>;
</p>
</li>
<li><p> Sample with replacement <code class="reqn">{U^*}_n</code> from <code class="reqn">U_n - \bar U_n</code>;
</p>
</li>
<li><p> The new data will be <code class="reqn">{Z^*}_n=L{U^*}_n</code>;
</p>
</li>
<li><p> Calculate the new variogram;
</p>
</li>
<li><p> Calculate and save the statistics of interest;
</p>
</li>
<li><p> Return to step 4 and repeat the process at least 1000 times.
</p>
</li></ol>



<h3>Value</h3>

<p><b>variogram_boot</b> gives the variogram of each bootstrap.
</p>
<p><b>variogram_or</b> gives the original variogram.
</p>
<p><b>pars_boot</b> gives the estimatives of the nugget, sill, contribution, range and practical range for each bootstrap.
</p>
<p><b>pars_or</b> gives the original estimatives of the nugget, sill, contribution, range and practical range.
</p>
<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>


<h3>References</h3>

<p>Solow, A. R. (1985). Bootstrapping correlated data. Journal of the International Association for Mathematical Geology, 17(7), 769-775. https://doi.org/10.1007/BF01031616
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(soilmoisture)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 140) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(2,80),nugget = 2,cov.model = "sph")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_solow(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot


# Example 2

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(NVDI)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 18) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(0.003,6),nugget = 0.003,cov.model = "gaus")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_solow(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

</code></pre>

<hr>
<h2 id='gboot_variogram'>Variogram bootstrap</h2><span id='topic+gboot_variogram'></span>

<h3>Description</h3>

<p>Perform a boostrap based on error from the fitted model of the variogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gboot_variogram(data,var,model,B)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gboot_variogram_+3A_data">data</code></td>
<td>
<p>object of the class geodata.</p>
</td></tr>
<tr><td><code id="gboot_variogram_+3A_var">var</code></td>
<td>
<p>object of the class variogram.</p>
</td></tr>
<tr><td><code id="gboot_variogram_+3A_model">model</code></td>
<td>
<p>object of the class variomodel.</p>
</td></tr>
<tr><td><code id="gboot_variogram_+3A_b">B</code></td>
<td>
<p>number of the bootstrap that will be performed (default B=1000).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The algorithm for the bootstrap variogram is the same presented for
Davison and Hinkley (1997) for the non linear regression. We can write the
variogram as <code class="reqn">\hat \gamma(h) = \gamma_{mod}(h)+\epsilon</code>, where <code class="reqn">\gamma_{mod}(h)</code>
is the fitted model. The steps of the algorithm are:
</p>

<ol>
<li><p> Set <code class="reqn">h^*=h</code>;
</p>
</li>
<li><p> Sample with replacement <code class="reqn">\epsilon^*</code> from <code class="reqn">\epsilon - \bar \epsilon</code>;
</p>
</li>
<li><p> The new variogram will be <code class="reqn">\gamma^*(h^*) = \gamma_{mod}(h)+\epsilon^*</code>;
</p>
</li>
<li><p> Calculate and save the statistics of interest;
</p>
</li>
<li><p> Return to step 2 and repeat the process at least 1000 times.
</p>
</li></ol>



<h3>Value</h3>

<p><b>variogram_boot</b> gives the variogram of each bootstrap.
</p>
<p><b>variogram_or</b> gives the original variogram.
</p>
<p><b>pars_boot</b> gives the estimatives of the nugget, sill, contribution, range and practical range for each bootstrap.
</p>
<p><b>pars_or</b> gives the original estimatives of the nugget, sill, contribution, range and practical range.
</p>
<p>Invalid arguments will return an error message.
</p>


<h3>Author(s)</h3>

<p>Diogo Francisco Rossoni <a href="mailto:dfrossoni@uem.br">dfrossoni@uem.br</a>
</p>
<p>Vinicius Basseto Felix <a href="mailto:felix_prot@hotmail.com">felix_prot@hotmail.com</a>
</p>


<h3>References</h3>

<p>DAVISON, A.C.; HINKLEY, D. V. Bootstrap Methods and their Application. [s.l.] Cambridge University Press, 1997. p. 582
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Example 1

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(soilmoisture)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 140) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(2,80),nugget = 2,cov.model = "sph")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_variogram(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot


# Example 2

## transforming the data.frame in an object of class geodata
data&lt;- as.geodata(NVDI)

points(data) ## data visualization

var&lt;- variog(data, max.dist = 18) ## Obtaining the variogram
plot(var)

## Fitting the model
mod&lt;- variofit(var,ini.cov.pars = c(0.003,6),nugget = 0.003,cov.model = "gaus")
lines(mod, col=2, lwd=2) ##fitted model

## Bootstrap procedure

boot&lt;- gboot_variogram(data,var,mod,B=10)
## For better Confidence interval, try B=1000

gboot_CI(boot,digits = 4) ## Bootstrap Confidence Interval

gboot_plot(boot) ## Bootstrap Variogram plot

</code></pre>

<hr>
<h2 id='NVDI'>Normalized Difference Vegetation Index experiment</h2><span id='topic+NVDI'></span>

<h3>Description</h3>

<p>Field experiment, realized in CTI (Tecnical Center of Irrigation), in an area of
3 m x 24 m, with 88 observations in a regular grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(soilmoisture)
</code></pre>


<h3>Format</h3>

<p>An object of class data.frame
</p>


<h3>Details</h3>


<ul>
<li> <p><b>x</b> a vector containing the sample locations(in cm) in the horizontal.
</p>
</li>
<li> <p><b>y</b> a vector containing the sample locations(in cm) in the vertical.
</p>
</li>
<li> <p><b>z</b> a vector containing the value of normalized difference vegetation index (NDVI).
</p>
</li></ul>



<h3>References</h3>

<p>HARA. A. T., GONÇALVES, A. C. A. Temporal stability of the spatial pattern of water storage in the soil at different
spatial scales. (Doctoral thesis). Retrieved from url <a href="http://www.pga.uem.br/dissertacao-tese/710">http://www.pga.uem.br/dissertacao-tese/710</a>
</p>

<hr>
<h2 id='soilmoisture'>Soil moisture experiment</h2><span id='topic+soilmoisture'></span>

<h3>Description</h3>

<p>Field experiment, realized in CTI (Tecnical Center of Irrigation), in an area of
350 cm x 150 cm, with 355 observations in a regular grid.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(soilmoisture)
</code></pre>


<h3>Format</h3>

<p>An object of class data.frame
</p>


<h3>Details</h3>


<ul>
<li> <p><b>x</b> a vector containing the sample locations(in cm) in the horizontal.
</p>
</li>
<li> <p><b>y</b> a vector containing the sample locations(in cm) in the vertical.
</p>
</li>
<li> <p><b>z</b> a vector containing the value of soil moisture in percents.
</p>
</li></ul>



<h3>References</h3>

<p>HARA. A. T., GONÇALVES, A. C. A. Temporal stability of the spatial pattern of water storage in the soil at different
spatial scales. (Doctoral thesis). Retrieved from url <a href="http://www.pga.uem.br/dissertacao-tese/710">http://www.pga.uem.br/dissertacao-tese/710</a>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
