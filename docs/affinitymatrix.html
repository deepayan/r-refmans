<!DOCTYPE html><html><head><title>Help for package affinitymatrix</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {affinitymatrix}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#estimate.affinity.matrix'><p>Estimate Dupuy and Galichon's model</p></a></li>
<li><a href='#estimate.affinity.matrix.lowrank'><p>Estimate Dupuy and Galichon's model</p></a></li>
<li><a href='#estimate.affinity.matrix.unipartite'><p>Estimate Ciscato, Galichon and Gousse's model</p></a></li>
<li><a href='#export.table'><p>Export an affinitymatrix table</p></a></li>
<li><a href='#show.affinity.matrix'><p>Print affinity matrix</p></a></li>
<li><a href='#show.correlations'><p>Print correlations of matching factors with matching and outcome variables</p></a></li>
<li><a href='#show.cross.validation'><p>Print cross validation summary</p></a></li>
<li><a href='#show.diagonal'><p>Print the diagonal of the affinity matrix</p></a></li>
<li><a href='#show.saliency'><p>Print summary of saliency analysis</p></a></li>
<li><a href='#show.test'><p>Print summaries of rank tests</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Estimation of Affinity Matrix</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools to study sorting patterns in matching markets and to estimate the affinity matrix of both the bipartite one-to-one matching model without frictions and with Transferable Utility by 'Dupuy' and 'Galichon' (2014) &lt;<a href="https://doi.org/10.1086%2F677191">doi:10.1086/677191</a>&gt; and its 'unipartite' variant by 'Ciscato', 'Galichon' and 'Gousse' (2020) &lt;<a href="https://doi.org/10.1086%2F704611">doi:10.1086/704611</a>&gt;. It also contains all the necessary tools to implement the 'saliency' analysis, to run rank tests of the affinity matrix and to build tables and plots summarizing the findings.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, grid, expm, MASS, Hmisc, ggplot2, ggrepel</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-11-25 15:36:42 UTC; u0129287</td>
</tr>
<tr>
<td>Author:</td>
<td>Edoardo Ciscato <a href="https://orcid.org/0000-0002-9894-1778"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Edoardo Ciscato &lt;edoardo.ciscato@kuleuven.be&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-11-26 17:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='estimate.affinity.matrix'>Estimate Dupuy and Galichon's model</h2><span id='topic+estimate.affinity.matrix'></span>

<h3>Description</h3>

<p>This function estimates the affinity matrix of the matching model of Dupuy
and Galichon (2014), performs the saliency analysis and the rank tests. The
user must supply a <em>matched sample</em> that is treated as the equilibrium
matching of a bipartite one-to-one matching model without frictions and with
Transferable Utility. For the sake of clarity, in the documentation we take
the example of the marriage market and refer to &quot;men&quot; as the observations on
one side of the market and to &quot;women&quot; as the observations on the other side.
Other applications may include matching between CEOs and firms, firms and
workers, buyers and sellers, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.affinity.matrix(
  X,
  Y,
  w = rep(1, N),
  A0 = matrix(0, nrow = Kx, ncol = Ky),
  lb = matrix(-Inf, nrow = Kx, ncol = Ky),
  ub = matrix(Inf, nrow = Kx, ncol = Ky),
  pr = 0.05,
  max_iter = 10000,
  tol_level = 1e-06,
  scale = 1,
  nB = 2000,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate.affinity.matrix_+3A_x">X</code></td>
<td>
<p>The matrix of men's traits. Its rows must be ordered so that the
i-th man is matched with the i-th woman: this means that <code>nrow(X)</code>
must be equal to <code>nrow(Y)</code>. Its columns correspond to the different
matching variables: <code>ncol(X)</code> can be different from <code>ncol(Y)</code>.
For the sake of clarity of exposition when using descriptive tools such
as <code><a href="#topic+show.correlations">show.correlations</a></code>, it is recommended assigning the same
matching variable to the k-th column of <code>X</code> and to the k-th column
of <code>Y</code>, whenever possible. If <code>X</code> has more matching variables
than <code>Y</code>, then those variables that appear in <code>X</code> but no in Y
should be found in the last columns of <code>X</code> (and vice versa). The
matrix is demeaned and rescaled before the start of the estimation
algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_y">Y</code></td>
<td>
<p>The matrix of women's traits. Its rows must be ordered so that the
i-th woman is matched with the i-th man: this means that <code>nrow(Y)</code>
must be equal to <code>nrow(X)</code>.  Its columns correspond to the different
matching variables: <code>ncol(Y)</code> can be different from <code>ncol(X)</code>.
The matrix is demeaned and rescaled before the start of the estimation
algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_w">w</code></td>
<td>
<p>A vector of sample weights with length <code>nrow(X)</code>. Defaults to
uniform weights.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_a0">A0</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the initial values of the affinity matrix to be fed to
the estimation algorithm. Optional. Defaults to matrix of zeros.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_lb">lb</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the lower bounds of the elements of the affinity matrix.
Defaults to <code>-Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_ub">ub</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the upper bounds of the elements of the affinity matrix.
Defaults to <code>Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the significance level used to compute
bootstrap two-sided confidence intervals for <code>U</code>, <code>V</code> and
<code>lambda</code>. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_max_iter">max_iter</code></td>
<td>
<p>An integer indicating the maximum number of iterations in the
Maximum Likelihood Estimation. See <code><a href="stats.html#topic+optim">optim</a></code> for the
<code>"L-BFGS-B"</code> method. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_tol_level">tol_level</code></td>
<td>
<p>A positive real number indicating the tolerance level in the
Maximum Likelihood Estimation. See <code><a href="stats.html#topic+optim">optim</a></code> for the
<code>"L-BFGS-B"</code> method. Defaults to 1e-6.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_scale">scale</code></td>
<td>
<p>A positive real number indicating the scale of the model.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_nb">nB</code></td>
<td>
<p>An integer indicating the number of bootstrap replications used to
compute the confidence intervals of <code>U</code>, <code>V</code> and <code>lambda</code>.
Defaults to 2000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the function displays messages to keep track
of its progress. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with elements: <code>X</code>, the demeaned and
rescaled matrix of men's traits; <code>Y</code>, the demeaned and rescaled
matrix of men's traits; <code>fx</code>, the empirical marginal distribution of
men; <code>fy</code>, the empirical marginal distribution of women;
<code>Aopt</code>, the estimated affinity matrix; <code>sdA</code>, the standard
errors of <code>Aopt</code>; <code>tA</code>, the Z-test statistics of <code>Aopt</code>;
<code>VarCovA</code>, the full variance-covariance matrix of <code>Aopt</code>;
<code>rank.tests</code>, a list with all the summaries of the rank tests on
<code>Aopt</code>; <code>U</code>, whose columns are the left-singular vectors of
<code>Aopt</code>; <code>V</code>, whose columns are the right-singular vectors of
<code>Aopt</code>; <code>lambda</code>, whose elements are the singular values of
<code>Aopt</code>; <code>UCI</code>, whose columns are the lower and the upper bounds
of the confidence intervals of <code>U</code>; <code>VCI</code>, whose columns are
the lower and the upper bounds of the confidence intervals of <code>V</code>;
<code>lambdaCI</code>, whose columns are the lower and the upper bounds of the
confidence intervals of <code>lambda</code>; <code>df.bootstrap</code>, a data frame
resulting from the <code>nB</code> bootstrap replications and used to infer the
empirical distribution of the estimated objects.
</p>


<h3>See Also</h3>

<p><strong>Dupuy, Arnaud, and Alfred Galichon</strong>. &quot;Personality traits and
the marriage market.&quot; <em>Journal of Political Economy</em> 122, no. 6
(2014): 1271-1319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Parameters
Kx = 4; Ky = 4; # number of matching variables on both sides of the market
N = 200 # sample size
mu = rep(0, Kx+Ky) # means of the data generating process
Sigma = matrix(c(1, 0.326, 0.1446, -0.0668, 0.5712, 0.4277, 0.1847, -0.2883,
                 0.326, 1, -0.0372, 0.0215, 0.2795, 0.8471, 0.1211, -0.0902,
                 0.1446, -0.0372, 1, -0.0244, 0.2186, 0.0636, 0.1489,
                 -0.1301, -0.0668, 0.0215, -0.0244, 1, 0.0192, 0.0452,
                 -0.0553, 0.2717, 0.5712, 0.2795, 0.2186, 0.0192, 1, 0.3309,
                 0.1324, -0.1896, 0.4277, 0.8471, 0.0636, 0.0452, 0.3309, 1,
                 0.0915, -0.1299, 0.1847, 0.1211, 0.1489, -0.0553, 0.1324,
                 0.0915, 1, -0.1959, -0.2883, -0.0902, -0.1301, 0.2717,
                 -0.1896, -0.1299, -0.1959, 1),
               nrow=Kx+Ky) # (normalized) variance-covariance matrix of the
               # data generating process
labels_x = c("Educ.", "Age", "Height", "BMI") # labels for men's matching variables
labels_y = c("Educ.", "Age", "Height", "BMI") # labels for women's matching variables

# Sample
data = MASS::mvrnorm(N, mu, Sigma) # generating sample
X = data[,1:Kx]; Y = data[,Kx+1:Ky] # men's and women's sample data
w = sort(runif(N-1)); w = c(w,1) - c(0,w) # sample weights

# Main estimation
res = estimate.affinity.matrix(X, Y, w = w, nB = 500)

# Summarize results
show.affinity.matrix(res, labels_x = labels_x, labels_y = labels_y)
show.diagonal(res, labels = labels_x)
show.test(res)
show.saliency(res, labels_x = labels_x, labels_y = labels_y,
              ncol_x = 2, ncol_y = 2)
show.correlations(res, labels_x = labels_x, labels_y = labels_y,
                  label_x_axis = "Husband", label_y_axis = "Wife", ndims = 2)

</code></pre>

<hr>
<h2 id='estimate.affinity.matrix.lowrank'>Estimate Dupuy and Galichon's model</h2><span id='topic+estimate.affinity.matrix.lowrank'></span>

<h3>Description</h3>

<p>This function estimates the affinity matrix of the matching model of Dupuy
and Galichon (2014) under a rank restriction on the affinity matrix, as
suggested by Dupuy, Galichon and Sun (2019). In their own words, &quot;to
accommodate high dimensionality of the data, they propose a novel method that
incorporates a nuclear norm regularization which effectively enforces a rank
constraint on the affinity matrix.&quot; This function also performs the saliency
analysis and the rank tests. The user must supply a <em>matched sample</em>
that is treated as the equilibrium matching of a bipartite one-to-one
matching model without frictions and with Transferable Utility. For the sake
of clarity, in the documentation we take the example of the marriage market
and refer to &quot;men&quot; as the observations on one side of the market and to
&quot;women&quot; as the observations on the other side. Other applications may include
matching between CEOs and firms, firms and workers, buyers and sellers, etc.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.affinity.matrix.lowrank(
  X,
  Y,
  w = rep(1, N),
  A0 = matrix(0, nrow = Kx, ncol = Ky),
  lb = matrix(-Inf, nrow = Kx, ncol = Ky),
  ub = matrix(Inf, nrow = Kx, ncol = Ky),
  pr = 0.05,
  max_iter = 10000,
  tol_level = 1e-08,
  tau = 1,
  scale = 1,
  cross_validation = TRUE,
  manual_lambda = 0,
  lambda_min = 0,
  Nfolds = 5,
  nB = 2000,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_x">X</code></td>
<td>
<p>The matrix of men's traits. Its rows must be ordered so that the
i-th man is matched with the i-th woman: this means that <code>nrow(X)</code>
must be equal to <code>nrow(Y)</code>. Its columns correspond to the different
matching variables: <code>ncol(X)</code> can be different from <code>ncol(Y)</code>.
For the sake of clarity of exposition when using descriptive tools such as
<code><a href="#topic+show.correlations">show.correlations</a></code>, it is recommended assigning the same
matching variable to the k-th column of <code>X</code> and to the k-th column of
<code>Y</code>, whenever possible. If <code>X</code> has more matching variables than
<code>Y</code>, then those variables that appear in <code>X</code> but no in Y should
be found in the last columns of <code>X</code> (and vice versa). The matrix is
demeaned and rescaled before the start of the estimation algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_y">Y</code></td>
<td>
<p>The matrix of women's traits. Its rows must be ordered so that the
i-th woman is matched with the i-th man: this means that <code>nrow(Y)</code>
must be equal to <code>nrow(X)</code>.  Its columns correspond to the different
matching variables: <code>ncol(Y)</code> can be different from <code>ncol(X)</code>.
The matrix is demeaned and rescaled before the start of the estimation
algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_w">w</code></td>
<td>
<p>A vector of sample weights with length <code>nrow(X)</code>. Defaults to
uniform weights.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_a0">A0</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the initial values of the affinity matrix to be fed to the
estimation algorithm. Optional. Defaults to matrix of zeros.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_lb">lb</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the lower bounds of the elements of the affinity matrix.
Defaults to <code>-Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_ub">ub</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the upper bounds of the elements of the affinity matrix.
Defaults to <code>Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the significance level used to compute
bootstrap two-sided confidence intervals for <code>U</code>, <code>V</code> and
<code>lambda</code>. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_max_iter">max_iter</code></td>
<td>
<p>An integer indicating the maximum number of iterations in the
proximal gradient descent algorithm. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_tol_level">tol_level</code></td>
<td>
<p>A positive real number indicating the tolerance level in the
proximal gradient descent algorithm. Defaults to 1e-8.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_tau">tau</code></td>
<td>
<p>A positive real number indicating a sensitivity parameter in the
proximal gradient descent algorithm. Defaults to 1 and should not be
changed unless computational problems arise.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_scale">scale</code></td>
<td>
<p>A positive real number indicating the scale of the model.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_cross_validation">cross_validation</code></td>
<td>
<p>If <code>TRUE</code>, the function looks for a rank
restriction through cross validation. The cross validation exercise aims to
minimize the covariance mismatch: in other words, it avoids overfitting
without excessively reducing the number of free parameters. Defaults to
<code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_manual_lambda">manual_lambda</code></td>
<td>
<p>A positive real number indicating the user-supply
<code>lambda</code> when <code>cross_validation==FALSE</code>. The higher
<code>lambda</code>, the tighter the rank restriction. Defaults to 0.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_lambda_min">lambda_min</code></td>
<td>
<p>A positive real number indicating minimum value for
<code>lambda</code> considered during the cross validation. We recommend using 0,
but with a high number of matching variables relatively to the sample size
it is reasonable to set <code>lambda_min</code> to a higher value. Defaults to 0.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_nfolds">Nfolds</code></td>
<td>
<p>An integer indicating the number of folds in the cross
validation. Defaults to 5 and can be increased with a large sample size.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_nb">nB</code></td>
<td>
<p>An integer indicating the number of bootstrap replications used to
compute the confidence intervals of <code>Aopt</code>, <code>U</code>, <code>V</code> and
<code>lambda</code>. Defaults to 2000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.lowrank_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the function displays messages to keep track
of its progress. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with elements: <code>X</code>, the demeaned and
rescaled matrix of men's traits; <code>Y</code>, the demeaned and rescaled matrix
of men's traits; <code>fx</code>, the empirical marginal distribution of men;
<code>fy</code>, the empirical marginal distribution of women; <code>Aopt</code>, the
estimated affinity matrix; <code>sdA</code>, the standard errors of <code>Aopt</code>;
<code>tA</code>, the Z-test statistics of <code>Aopt</code>; <code>VarCovA</code>, the full
variance-covariance matrix of <code>Aopt</code>; <code>rank.tests</code>, a list with
all the summaries of the rank tests on <code>Aopt</code>; <code>U</code>, whose columns
are the left-singular vectors of <code>Aopt</code>; <code>V</code>, whose columns are
the right-singular vectors of <code>Aopt</code>; <code>lambda</code>, whose elements
are the singular values of <code>Aopt</code>; <code>UCI</code>, whose columns are the
lower and the upper bounds of the confidence intervals of <code>U</code>;
<code>VCI</code>, whose columns are the lower and the upper bounds of the
confidence intervals of <code>V</code>; <code>lambdaCI</code>, whose columns are the
lower and the upper bounds of the confidence intervals of <code>lambda</code>;
<code>df.bootstrap</code>, a data frame resulting from the <code>nB</code> bootstrap
replications and used to infer the empirical distribution of the estimated
objects; <code>lambda.rank.restriction</code>, a positive real number indicating
the value of the Lagrange multiplier of the nuclear norm constraint of the
affinity matrix, either chosen by the user or through Cross Validation;
<code>df.cross.validation</code>, a data frame containing the detailed results of
the cross validation exercise.
</p>


<h3>See Also</h3>

<p><strong>Dupuy, Arnaud, Alfred Galichon, and Yifei Sun</strong>. &quot;Estimating
matching affinity matrices under low-rank constraints.&quot; <em>Information
and Inference: A Journal of the IMA</em> 8, no. 4 (2019): 677-689.
<strong>Dupuy, Arnaud, and Alfred Galichon</strong>. &quot;Personality traits and the
marriage market.&quot; <em>Journal of Political Economy</em> 122, no. 6 (2014):
1271-1319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Parameters
Kx = 2; Ky = 2; # number of matching variables on both sides of the market
N = 100 # sample size
mu = rep(0, Kx+Ky) # means of the data generating process
Sigma = matrix(c(1, -0.0244, 0.1489, -0.1301, -0.0244, 1, -0.0553, 0.2717,
                 0.1489, -0.0553, 1, -0.1959, -0.1301, 0.2717, -0.1959, 1),
                 nrow=Kx+Ky)
    # (normalized) variance-covariance matrix of the data generating process
labels_x = c("Height", "BMI") # labels for men's matching variables
labels_y = c("Height", "BMI") # labels for women's matching variables

# Sample
data = MASS::mvrnorm(N, mu, Sigma) # generating sample
X = data[,1:Kx]; Y = data[,Kx+1:Ky] # men's and women's sample data
w = sort(runif(N-1)); w = c(w,1) - c(0,w) # sample weights

# Main estimation
res = estimate.affinity.matrix.lowrank(X, Y, w = w, tol_level = 1e-03,
                                       nB = 50, Nfolds = 2)

# Summarize results
show.affinity.matrix(res, labels_x = labels_x, labels_y = labels_y)
show.diagonal(res, labels = labels_x)
show.test(res)
show.saliency(res, labels_x = labels_x, labels_y = labels_y,
              ncol_x = 2, ncol_y = 2)
show.cross.validation(res)
show.correlations(res, labels_x = labels_x, labels_y = labels_y,
                  label_x_axis = "Husband", label_y_axis = "Wife", ndims = 2)

</code></pre>

<hr>
<h2 id='estimate.affinity.matrix.unipartite'>Estimate Ciscato, Galichon and Gousse's model</h2><span id='topic+estimate.affinity.matrix.unipartite'></span>

<h3>Description</h3>

<p>This function estimates the affinity matrix of the matching model of Ciscato
Gousse and Galichon (2020), performs the saliency analysis and the rank
tests. The user must supply a <em>matched sample</em> that is treated as the
equilibrium matching of a bipartite one-to-one matching model without
frictions and with Transferable Utility. The model differs from the original
Dupuy and Galichon (2014) since all agents are pooled in one group and can
match within the group. For the sake of clarity, in the documentation we take
the example of the same-sex marriage market and refer to &quot;first partner&quot; and
&quot;second partner&quot; in order to distinguish between the arbitrary partner order
in a database (e.g., survey respondent and partner of the respondent). Note
that in this case the variable &quot;sex&quot; is treated as a matching variable rather
than a criterion to assign partners to one side of the market as in the
bipartite case. Other applications may include matching between coworkers,
roommates or teammates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.affinity.matrix.unipartite(
  X,
  Y,
  w = rep(1, N),
  A0 = matrix(0, nrow = K, ncol = K),
  lb = matrix(-Inf, nrow = K, ncol = K),
  ub = matrix(Inf, nrow = K, ncol = K),
  pr = 0.05,
  max_iter = 10000,
  tol_level = 1e-06,
  scale = 1,
  nB = 2000,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_x">X</code></td>
<td>
<p>The matrix of traits of the first partner. Its rows must be ordered
so that the i-th individual in <code>X</code> is matched with the i-th partner in
<code>Y</code>: this means that <code>nrow(X)</code> must be equal to <code>nrow(Y)</code>.
Its columns correspond to the different matching variables: <code>ncol(X)</code>
must be equal to <code>ncol(Y)</code> and the variables must be sorted in the
same way in both matrices. The matrix is demeaned and rescaled before the
start of the estimation algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_y">Y</code></td>
<td>
<p>The matrix of traits of the second partner. Its rows must be ordered
so that the i-th individual in <code>Y</code> is matched with the i-th partner in
<code>X</code>: this means that <code>nrow(Y)</code> must be equal to <code>nrow(X)</code>.
Its columns correspond to the different matching variables: <code>ncol(Y)</code>
must be equal to <code>ncol(X)</code> and the variables must be sorted in the
same way in both matrices. The matrix is demeaned and rescaled before the
start of the estimation algorithm.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_w">w</code></td>
<td>
<p>A vector of sample weights with length <code>nrow(X)</code>. Defaults to
uniform weights.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_a0">A0</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the initial values of the affinity matrix to be fed to the
estimation algorithm. Optional. Defaults to a matrix of zeros.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_lb">lb</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the lower bounds of the elements of the affinity matrix.
Defaults to <code>-Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_ub">ub</code></td>
<td>
<p>A vector or matrix with <code>ncol(X)*ncol(Y)</code> elements
corresponding to the upper bounds of the elements of the affinity matrix.
Defaults to <code>Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the significance level used to compute
bootstrap two-sided confidence intervals for <code>U</code>, <code>V</code> and
<code>lambda</code>. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_max_iter">max_iter</code></td>
<td>
<p>An integer indicating the maximum number of iterations in the
Maximum Likelihood Estimation. See <code><a href="stats.html#topic+optim">optim</a></code> for the
<code>"L-BFGS-B"</code> method. Defaults to 10000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_tol_level">tol_level</code></td>
<td>
<p>A positive real number indicating the tolerance level in the
Maximum Likelihood Estimation. See <code><a href="stats.html#topic+optim">optim</a></code> for the
<code>"L-BFGS-B"</code> method. Defaults to 1e-6.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_scale">scale</code></td>
<td>
<p>A positive real number indicating the scale of the model.
Defaults to 1.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_nb">nB</code></td>
<td>
<p>An integer indicating the number of bootstrap replications used to
compute the confidence intervals of <code>U</code>, <code>V</code> and <code>lambda</code>.
Defaults to 2000.</p>
</td></tr>
<tr><td><code id="estimate.affinity.matrix.unipartite_+3A_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, the function displays messages to keep track
of its progress. Defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list with elements: <code>X</code>, the demeaned and
rescaled matrix of traits of the first partner; <code>Y</code>, the demeaned and
rescaled matrix of traits of the second partner; <code>fx</code>, the empirical
marginal distribution of first partners; <code>fy</code>, the empirical marginal
distribution of second partners; <code>Aopt</code>, the estimated affinity
matrix; <code>sdA</code>, the standard errors of <code>Aopt</code>; <code>tA</code>, the
Z-test statistics of <code>Aopt</code>; <code>VarCovA</code>, the full
variance-covariance matrix of <code>Aopt</code>; <code>rank.tests</code>, a list with
all the summaries of the rank tests on <code>Aopt</code>; <code>U</code>, whose columns
are the left-singular vectors of <code>Aopt</code>; <code>V</code>, whose columns are
the right-singular vectors of <code>Aopt</code>; <code>lambda</code>, whose elements
are the singular values of <code>Aopt</code>; <code>UCI</code>, whose columns are the
lower and the upper bounds of the confidence intervals of <code>U</code>;
<code>VCI</code>, whose columns are the lower and the upper bounds of the
confidence intervals of <code>V</code>; <code>lambdaCI</code>, whose columns are the
lower and the upper bounds of the confidence intervals of <code>lambda</code>;
<code>df.bootstrap</code>, a data frame resulting from the <code>nB</code> bootstrap
replications and used to infer the empirical distribution of the estimated
objects.
</p>


<h3>See Also</h3>

<p><strong>Ciscato, Edoardo, Alfred Galichon, and Marion Gousse</strong>. &quot;Like
attract like? a structural comparison of homogamy across same-sex and
different-sex households.&quot; <em>Journal of Political Economy</em> 128, no. 2
(2020): 740-781. <strong>Dupuy, Arnaud, and Alfred Galichon</strong>. &quot;Personality
traits and the marriage market.&quot; <em>Journal of Political Economy</em> 122,
no. 6 (2014): 1271-1319.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Parameters
K = 4 # number of matching variables
N = 100 # sample size
mu = rep(0, 2*K) # means of the data generating process
Sigma = matrix(c(1, -0.0992, 0.0443, -0.0246, -0.8145, 0.083, -0.0438,
    0.0357, -0.0992, 1, 0.0699, -0.0043, 0.083, 0.8463, 0.0699, -0.0129, 0.0443,
    0.0699, 1, -0.0434, -0.0438, 0.0699, 0.5127, -0.0383, -0.0246, -0.0043,
    -0.0434, 1, 0.0357, -0.0129, -0.0383, 0.6259, -0.8145, 0.083, -0.0438,
    0.0357, 1, -0.0992, 0.0443, -0.0246, 0.083, 0.8463, 0.0699, -0.0129, -0.0992,
    1, 0.0699, -0.0043, -0.0438, 0.0699, 0.5127, -0.0383, 0.0443, 0.0699, 1,
    -0.0434, 0.0357, -0.0129, -0.0383, 0.6259, -0.0246, -0.0043, -0.0434, 1),
               nrow=K+K) # (normalized) variance-covariance matrix of the
               # data generating process with a block symmetric structure
labels = c("Sex", "Age", "Educ.", "Black") # labels for matching variables

# Sample
data = MASS::mvrnorm(N, mu, Sigma) # generating sample
X = data[,1:K]; Y = data[,K+1:K] # men's and women's sample data
w = sort(runif(N-1)); w = c(w,1) - c(0,w) # sample weights

# Main estimation
res = estimate.affinity.matrix.unipartite(X, Y, w = w, nB = 500)

# Summarize results
show.affinity.matrix(res, labels_x = labels, labels_y = labels)
show.diagonal(res, labels = labels)
show.test(res)
show.saliency(res, labels_x = labels, labels_y = labels,
              ncol_x = 2, ncol_y = 2)
show.correlations(res, labels_x = labels, labels_y = labels,
                  label_x_axis = "First partner",
                  label_y_axis = "Second partner", ndims = 2)

</code></pre>

<hr>
<h2 id='export.table'>Export an affinitymatrix table</h2><span id='topic+export.table'></span>

<h3>Description</h3>

<p>The function stores a LaTeX style table in a txt file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export.table(tabular, name = "table", path = getwd())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export.table_+3A_tabular">tabular</code></td>
<td>
<p>A long string corresponding to the output of
<code><a href="#topic+show.affinity.matrix">show.affinity.matrix</a></code>, <code><a href="#topic+show.diagonal">show.diagonal</a></code> or
<code><a href="#topic+show.test">show.test</a></code>, or one of the two elements of
<code><a href="#topic+show.saliency">show.saliency</a></code> (<code>U.table</code> or <code>V.table</code>).</p>
</td></tr>
<tr><td><code id="export.table_+3A_name">name</code></td>
<td>
<p>A string indicating the name of the txt file. Defaults to
<code>"affinity_matrix"</code>.</p>
</td></tr>
<tr><td><code id="export.table_+3A_path">path</code></td>
<td>
<p>A string indicating the path where to save the txt file. Defaults
to current path.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function stores a long string in LaTeX style that can be
processed in the standard LaTeX tabular environment in a txt file in
located in <code>path</code>.
</p>

<hr>
<h2 id='show.affinity.matrix'>Print affinity matrix</h2><span id='topic+show.affinity.matrix'></span>

<h3>Description</h3>

<p>This function prints the estimated affinity matrix in LaTeX style. Standard
errors are printed below the elements of the affinity matrix. Estimates that
are significant at the <code>pr</code> level are printed in boldface: this format
feature can be avoided by setting <code>pr</code> to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.affinity.matrix(
  res,
  labels_x = paste0("Trait ", 1:Kx),
  labels_y = paste0("Trait ", 1:Ky),
  pr = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.affinity.matrix_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
<tr><td><code id="show.affinity.matrix_+3A_labels_x">labels_x</code></td>
<td>
<p>A vector of strings indicating the names of men's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.affinity.matrix_+3A_labels_y">labels_y</code></td>
<td>
<p>A vector of strings indicating the names of women's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.affinity.matrix_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the two-tailed significance level required
for an estimated parameter to be printed in boldface. Defaults to 0.05
and can be set to 0 to avoid printing any estimate in boldface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a long string in LaTeX style that can be
processed in the standard LaTeX tabular environment in order to display
the estimates of the affinity matrix <code>Aopt</code>.
</p>

<hr>
<h2 id='show.correlations'>Print correlations of matching factors with matching and outcome variables</h2><span id='topic+show.correlations'></span>

<h3>Description</h3>

<p>This function returns a list of plots, one for each of the first <code>ndims</code>
orthogonal sorting dimension. In the k-th plot, the correlation between a
man's observed matching variable and the man's k-th matching factor is
plotted on the x-axis; the correlation between a woman's observed matching
variable and the woman's k-th matching factor is plotted on the y-axis. In
addition, the user can supply additional variables stored in the matrix
<code>Z</code> that were not previously used in the estimation (&quot;outcome
variables&quot;). The function prints the correlation between the outcome variable
and the man's k-th matching factor on the x-axis, while the correlation
between the outcome variable and the woman's k-th matching factor is on the
y-axis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.correlations(
  res,
  Z = matrix(0, nrow = N, ncol = 0),
  labels_x = paste0("Trait ", 1:Kx),
  labels_y = paste0("Trait ", 1:Ky),
  labels_z = if (Kz &gt; 0) paste0("Outcome ", 1:Kz) else c(),
  ndims = min(Kx, Ky, 10),
  pr = 0.02,
  color_arrows = c("black", "red"),
  size_arrows = 0.5,
  font_labels = c("bold", "italic"),
  label_x_axis = "First partner",
  label_y_axis = "Second partner"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.correlations_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_z">Z</code></td>
<td>
<p>A matrix Z with additional variables that were not previously used
in the estimation. The i-th row of <code>Z</code> must contain information on
the couple formed by the i-th row of <code>X</code> and the i-th row of
<code>Y</code>, so that <code>nrow(Z)=nrow(X)</code>. Defaults to an empty matrix:
<code>Z</code> is optional.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_labels_x">labels_x</code></td>
<td>
<p>A vector of strings indicating the names of men's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_labels_y">labels_y</code></td>
<td>
<p>A vector of strings indicating the names of women's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_labels_z">labels_z</code></td>
<td>
<p>A vector of strings indicating the names of the outcome
variables. Defaults to <code>"Outcome k"</code> for every <code>k</code> outcome variable.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_ndims">ndims</code></td>
<td>
<p>An integer indicating the number of orthogonal matching
dimensions that will be plotted. The function plots the first \
codendims dimensions. Defaults to all dimensions unless the latter are
more than 10, in which case only the first 10 are plotted.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the two-tailed significance level required
for a matching or outcome variable to be displayed in a plot. In order to
avoid having too many variables plotted at the same time, the function
only selects those whose correlation with the matching factor is
significantly different from zero (in a two-tailed test) at the <code>pr</code>
level. Defaults to 0.02 and can be set to 1 to print all variables.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_color_arrows">color_arrows</code></td>
<td>
<p>A string or a vector of strings containing color names
for the arrows. All matching variables are assigned the first color given
in the vector, while all outcome variables are assigned the second color.
See <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. Defaults to <code>"black"</code> and
<code>"red"</code> respectively.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_size_arrows">size_arrows</code></td>
<td>
<p>A positive real number or a vector containing the size of
the arrows. All matching variables are assigned the first size given in
the vector, while all outcome variables are assigned the second size. See
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. Defaults to 0.5 for both.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_font_labels">font_labels</code></td>
<td>
<p>A string or a vector of strings containing font types for
the labels. All matching variables are assigned the first font type given
in the vector, while all outcome variables are assigned the second font
type. See <code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>. Defaults to <code>"bold"</code> and
<code>"italic"</code> respectively.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_label_x_axis">label_x_axis</code></td>
<td>
<p>A string containing a root for all x-axis names in
different plots. Defaults to <code>"First partner"</code>.</p>
</td></tr>
<tr><td><code id="show.correlations_+3A_label_y_axis">label_y_axis</code></td>
<td>
<p>A string containing a root for all y-axis names in
different plots. Defaults to <code>"Second partner"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list of <code>ndims</code> plots created with
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>


<h3>See Also</h3>

<p><strong>Chiappori, Pierre-Andre, Edoardo Ciscato, and Carla
Guerriero</strong>. &quot;Analyzing matching patterns in marriage: theory and
application to Italian data.&quot; <em>HCEO Working Paper</em> no. 2020-080
(2020).
</p>

<hr>
<h2 id='show.cross.validation'>Print cross validation summary</h2><span id='topic+show.cross.validation'></span>

<h3>Description</h3>

<p>This function returns a plot reporting the estimated covariance mismatch as a
function of the rank restriction parameter lambda. This is the result of the
cross validation exercise. The function is expected to be convex in lambda
and the chosen lambda is the unique minimum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.cross.validation(res)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.cross.validation_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot created with
<code><a href="ggplot2.html#topic+ggplot">ggplot</a></code>.
</p>

<hr>
<h2 id='show.diagonal'>Print the diagonal of the affinity matrix</h2><span id='topic+show.diagonal'></span>

<h3>Description</h3>

<p>This function prints the estimates of the diagonal of the affinity matrix in
LaTeX style. Standard errors are printed below the elements of the affinity
matrix. Estimates that are significant at the <code>pr</code> level are printed in
boldface: this format feature can be avoided by setting <code>pr</code> to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.diagonal(res, labels = paste0("Trait ", 1:K), pr = 0.05)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.diagonal_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
<tr><td><code id="show.diagonal_+3A_labels">labels</code></td>
<td>
<p>A vector of strings indicating the names of the matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.diagonal_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the two-tailed significance level required
for an estimated parameter to be printed in boldface. Defaults to 0.05
and can be set to 0 to avoid printing any estimate in boldface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a long string in LaTeX style that can be
processed in the standard LaTeX tabular environment in order to display
the estimates of diagonal of the affinity matrix <code>Aopt</code>.
</p>

<hr>
<h2 id='show.saliency'>Print summary of saliency analysis</h2><span id='topic+show.saliency'></span>

<h3>Description</h3>

<p>This function prints the results from the saliency analysis in LaTeX style.
The function returns a list of two elements: <code>U.table</code> contains the
first <code>ncol_x</code> vectors of loadings that map men's <code>Kx</code> observed
traits into the first <code>ncol_x</code> matching factors; <code>V.table</code> contains
the first <code>ncol_y</code> vectors of loadings that map women's <code>Ky</code>
observed traits into the first <code>ncol_y</code> matching factors. In both
tables, the last line reports the normalized singular values of the affinity
matrix in descending order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.saliency(
  res,
  ncol_x = Kx,
  ncol_y = Ky,
  labels_x = paste0("Trait ", 1:Kx),
  labels_y = paste0("Trait ", 1:Ky),
  pr = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.saliency_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
<tr><td><code id="show.saliency_+3A_ncol_x">ncol_x</code></td>
<td>
<p>An integer indicating the number of singular vector to print
for men. The function prints the first <code>ncol_x</code> singular vectors.
Defaults to <code>ncol(U)</code>.</p>
</td></tr>
<tr><td><code id="show.saliency_+3A_ncol_y">ncol_y</code></td>
<td>
<p>An integer indicating the number of singular vector to print
for women. The function prints the first <code>ncol_y</code> singular vectors.
Defaults to <code>ncol(V)</code>.</p>
</td></tr>
<tr><td><code id="show.saliency_+3A_labels_x">labels_x</code></td>
<td>
<p>A vector of strings indicating the names of men's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.saliency_+3A_labels_y">labels_y</code></td>
<td>
<p>A vector of strings indicating the names of women's matching
variables. Defaults to <code>"Trait k"</code> for every <code>k</code> matching
variable.</p>
</td></tr>
<tr><td><code id="show.saliency_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the two-tailed significance level required
for an estimated parameter to be printed in boldface. Defaults to 0.05
and can be set to 0 to avoid printing any estimate in boldface.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a long string in LaTeX style that can be
processed in the standard LaTeX tabular environment in order to display
the estimates of the vectors of loadings for the first <code>ncol_x</code>
men's matching factors and the first <code>ncol_y</code> women's matching
factors.
</p>

<hr>
<h2 id='show.test'>Print summaries of rank tests</h2><span id='topic+show.test'></span>

<h3>Description</h3>

<p>This function prints the summaries of the first <code>n_tests</code> rank tests in
in LaTeX. The first row specifies the null hypothesis, the second row gives
the test statistic, the third the degrees of freedom and the fourth says
whether the null hypothesis passes the test at the <code>pr</code> level.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>show.test(res, pr = 0.05, n_tests = K - 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.test_+3A_res">res</code></td>
<td>
<p>A list corresponding to the output of
<code><a href="#topic+estimate.affinity.matrix">estimate.affinity.matrix</a></code>,
<code><a href="#topic+estimate.affinity.matrix.lowrank">estimate.affinity.matrix.lowrank</a></code> or
<code><a href="#topic+estimate.affinity.matrix.unipartite">estimate.affinity.matrix.unipartite</a></code>.</p>
</td></tr>
<tr><td><code id="show.test_+3A_pr">pr</code></td>
<td>
<p>A probability indicating the significance level required to pass a
rank test. Defaults to 0.05.</p>
</td></tr>
<tr><td><code id="show.test_+3A_n_tests">n_tests</code></td>
<td>
<p>An integer indicating the number of tests to show. The
function prints the first <code>n_tests</code> rank tests. Defaults to
<code>min(nrow(Y),nrow(X))-1</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a long string in LaTeX style that can be
processed in the standard LaTeX tabular environment in order to display
the results from the first <code>n_tests</code> rank tests of the affinity
matrix.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
