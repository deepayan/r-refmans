<!DOCTYPE html><html lang="en"><head><title>Help for package divent</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {divent}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#divent-package'><p>divent</p></a></li>
<li><a href='#abd_freq_count'><p>Abundance Frequency Count of a Community</p></a></li>
<li><a href='#abd_species'><p>Abundances of Communities</p></a></li>
<li><a href='#accum_div_phylo'><p>Phylogenetic Diversity Accumulation of a Community</p></a></li>
<li><a href='#accum_hill'><p>Diversity Accumulation of a Community</p></a></li>
<li><a href='#accum_sp'><p>Spatial Accumulation of Diversity</p></a></li>
<li><a href='#accum_sp_hill'><p>Spatial Diversity Accumulation of a Community</p></a></li>
<li><a href='#alphahull'><p>alpha-shape calculation</p></a></li>
<li><a href='#autoplot.accumulation'><p>Plot Accumulation Objects</p></a></li>
<li><a href='#autoplot.profile'><p>Plot Profile Objects</p></a></li>
<li><a href='#autoplot.wmppp'><p>ggplot method to plot wmppp objects</p></a></li>
<li><a href='#check_divent_args'><p>check_divent_args</p></a></li>
<li><a href='#coverage'><p>Sample Coverage of a Community</p></a></li>
<li><a href='#div_gen_simpson'><p>Generalized Simpson's Diversity</p></a></li>
<li><a href='#div_hill'><p>Hill number of a Community</p></a></li>
<li><a href='#div_hurlbert'><p>Hurlbert Diversity of a Community</p></a></li>
<li><a href='#div_part'><p>Diversity partition</p></a></li>
<li><a href='#div_pd'><p>Faith's Phylogenetic Diversity of a Community</p></a></li>
<li><a href='#div_phylo'><p>Phylogenetic Diversity of a Community</p></a></li>
<li><a href='#div_richness'><p>Number of Species of a Community</p></a></li>
<li><a href='#div_similarity'><p>Similarity-Based Diversity of a Community</p></a></li>
<li><a href='#e_n_q'><p>Grassberger's expectation of n^q</p></a></li>
<li><a href='#ent_allen'><p>Allen et al.'s Phylogenetic Entropy of a Community</p></a></li>
<li><a href='#ent_gen_simpson'><p>Generalized Simpson's Entropy</p></a></li>
<li><a href='#ent_hurlbert'><p>Hurlbert Entropy of a Community</p></a></li>
<li><a href='#ent_phylo'><p>Phylogenetic Entropy of a Community</p></a></li>
<li><a href='#ent_rao'><p>Rao's Quadratic Entropy of a Community</p></a></li>
<li><a href='#ent_shannon'><p>Shannon's Entropy of a Community</p></a></li>
<li><a href='#ent_similarity'><p>Similarity-Based Entropy of a Community</p></a></li>
<li><a href='#ent_simpson'><p>Simpson's Entropy of a Community</p></a></li>
<li><a href='#ent_sp_simpson'><p>Spatially Explicit Simpson's Entropy</p></a></li>
<li><a href='#ent_tsallis'><p>Tsallis Entropy of a Community</p></a></li>
<li><a href='#exp_q'><p>Deformed exponential</p></a></li>
<li><a href='#fit_rac'><p>Fit a distribution</p></a></li>
<li><a href='#fun_ordinariness'><p>Functional ordinariness of a community</p></a></li>
<li><a href='#fun_similarity'><p>Functional similarity</p></a></li>
<li><a href='#ln_q'><p>Deformed logarithm</p></a></li>
<li><a href='#metacommunity'><p>Aggregate communities into a metacommunity</p></a></li>
<li><a href='#mock_3sp'><p>Mock data</p></a></li>
<li><a href='#non_species_columns'><p>Non-Species columns</p></a></li>
<li><a href='#paracou_6'><p>Paracou plot 6</p></a></li>
<li><a href='#paracou_6_fundist'><p>Functional distances between Paracou plot 6 species</p></a></li>
<li><a href='#paracou_6_taxo'><p>Taxonomy of Paracou plot 6 species</p></a></li>
<li><a href='#phylo_divent'><p>Class phylo_divent</p></a></li>
<li><a href='#plot.phylo_divent'><p>Plot phylo_divent Objects</p></a></li>
<li><a href='#plot.species_distribution'><p>Plot Profile Objects</p></a></li>
<li><a href='#probabilities'><p>Probabilities of Species</p></a></li>
<li><a href='#profile_hill'><p>Diversity Profile of a Community</p></a></li>
<li><a href='#profile_phylo'><p>Phylogenetic Diversity Profile of a Community</p></a></li>
<li><a href='#profile_similarity'><p>Similarity-Based Diversity Profile of a Community</p></a></li>
<li><a href='#rcommunity'><p>Random communities</p></a></li>
<li><a href='#reexports'><p>Objects exported from other packages</p></a></li>
<li><a href='#rlseries'><p>Log-Series Distribution</p></a></li>
<li><a href='#species_distribution'><p>Species Distributions</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Entropy Partitioning to Measure Diversity</td>
</tr>
<tr>
<td>Version:</td>
<td>0.5-2</td>
</tr>
<tr>
<td>Description:</td>
<td>Measurement and partitioning of diversity, based on Tsallis entropy, following Marcon and Herault (2015) &lt;<a href="https://doi.org/10.18637%2Fjss.v067.i08">doi:10.18637/jss.v067.i08</a>&gt;.
  'divent' provides functions to estimate alpha, beta and gamma diversity of communities, including phylogenetic and functional diversity.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://ericmarcon.github.io/divent/">https://ericmarcon.github.io/divent/</a>,
<a href="https://github.com/EricMarcon/divent">https://github.com/EricMarcon/divent</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EricMarcon/divent/issues">https://github.com/EricMarcon/divent/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GNU General Public License]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1), Rcpp (&ge; 0.12.14)</td>
</tr>
<tr>
<td>Imports:</td>
<td>alphahull, ape, cli, dbmss, dplyr, ggplot2, graphics, igraph,
EntropyEstimation, RColorBrewer, RcppParallel, Rdpack, rlang,
spatstat.explore, spatstat.geom, spatstat.random, stats,
tibble, tidyr, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ade4, knitr, pkgdown, rmarkdown, SPECIES, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppParallel</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RdMacros:</td>
<td>Rdpack</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make, pandoc</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-09 19:42:38 UTC; emarc</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric Marcon <a href="https://orcid.org/0000-0002-5249-321X"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric Marcon &lt;eric.marcon@agroparistech.fr&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-10 00:00:10 UTC</td>
</tr>
</table>
<hr>
<h2 id='divent-package'>divent</h2><span id='topic+divent'></span><span id='topic+divent-package'></span>

<h3>Description</h3>

<p>Measures of Diversity and Entropy
</p>


<h3>Details</h3>

<p>This package is a reboot of the <strong>entropart</strong> package (Marcon and Hérault 2015).
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Eric Marcon <a href="mailto:eric.marcon@agroparistech.fr">eric.marcon@agroparistech.fr</a> (<a href="https://orcid.org/0000-0002-5249-321X">ORCID</a>)
</p>


<h3>References</h3>

<p>Marcon E, Hérault B (2015).
&ldquo;Entropart, an R Package to Measure and Partition Diversity.&rdquo;
<em>Journal of Statistical Software</em>, <b>67</b>(8), 1&ndash;26.
<a href="https://doi.org/10.18637/jss.v067.i08">doi:10.18637/jss.v067.i08</a>.
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://ericmarcon.github.io/divent/">https://ericmarcon.github.io/divent/</a>
</p>
</li>
<li> <p><a href="https://github.com/EricMarcon/divent">https://github.com/EricMarcon/divent</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/EricMarcon/divent/issues">https://github.com/EricMarcon/divent/issues</a>
</p>
</li></ul>


<hr>
<h2 id='abd_freq_count'>Abundance Frequency Count of a Community</h2><span id='topic+abd_freq_count'></span>

<h3>Description</h3>

<p>Count the number of species observed the same number of times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abd_freq_count(
  abd,
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="abd_freq_count_+3A_abd">abd</code></td>
<td>
<p>A numeric vector containing species abundances.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>A string containing an estimator recognized by
<a href="#topic+div_richness">div_richness</a> to evaluate the total number of species in <a href="#topic+probabilities">probabilities</a>.
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="abd_freq_count_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Abundance Frequency Count (Chao and Jost 2015) is the number
of species observed each number of times.
It is a way to summarize the species distribution.
</p>
<p>It can be estimated at a specified level of interpolation or extrapolation.
Extrapolation relies on the estimation of the estimation of the asymptotic
distribution of the community by <a href="#topic+probabilities">probabilities</a> and eq. (5)
of (Chao et al. 2014).
</p>


<h3>Value</h3>

<p>A two-column tibble. The first column contains the number of observations,
the second one the number of species observed this number of times.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>abd_freq_count(as.numeric(paracou_6_abd[1, ]))
</code></pre>

<hr>
<h2 id='abd_species'>Abundances of Communities</h2><span id='topic+abd_species'></span><span id='topic+abd_sum'></span><span id='topic+prob_species'></span>

<h3>Description</h3>

<p>Utilities for community abundances (objects of class &quot;abundances&quot;).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>abd_species(abundances, check_arguments = TRUE)

abd_sum(abundances, as_numeric = FALSE, check_arguments = TRUE)

prob_species(species_distribution, check_arguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="abd_species_+3A_abundances">abundances</code></td>
<td>
<p>an object of class <a href="#topic+abundances">abundances</a>.</p>
</td></tr>
<tr><td><code id="abd_species_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="abd_species_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="abd_species_+3A_species_distribution">species_distribution</code></td>
<td>
<p>an object of class <a href="#topic+species_distribution">species_distribution</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>abd_species()</code> returns a tibble containing the species abundance columns only,
to simplify numeric operations.
</p>
<p><code>prob_species()</code> returns the same tibble but values are probabilities.
</p>
<p><code>abd_sum()</code> returns the sample sizes of the communities in a numeric vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>abd_species(paracou_6_abd)
prob_species(paracou_6_abd)
abd_sum(paracou_6_abd)

</code></pre>

<hr>
<h2 id='accum_div_phylo'>Phylogenetic Diversity Accumulation of a Community</h2><span id='topic+accum_div_phylo'></span><span id='topic+accum_ent_phylo'></span><span id='topic+accum_ent_phylo.numeric'></span><span id='topic+accum_ent_phylo.abundances'></span><span id='topic+accum_div_phylo.numeric'></span><span id='topic+accum_div_phylo.abundances'></span>

<h3>Description</h3>

<p>Diversity and Entropy Accumulation Curves represent the accumulation of
entropy with respect to the sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accum_ent_phylo(x, ...)

## S3 method for class 'numeric'
accum_ent_phylo(
  x,
  tree,
  q = 0,
  normalize = TRUE,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
accum_ent_phylo(
  x,
  tree,
  q = 0,
  normalize = TRUE,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

accum_div_phylo(x, ...)

## S3 method for class 'numeric'
accum_div_phylo(
  x,
  tree,
  q = 0,
  normalize = TRUE,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
accum_div_phylo(
  x,
  tree,
  q = 0,
  normalize = TRUE,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="accum_div_phylo_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_levels">levels</code></td>
<td>
<p>The levels, i.e. the sample sizes of interpolation or
extrapolation: a vector of integer values.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_n_simulations">n_simulations</code></td>
<td>
<p>the number of simulations used to estimate the confidence envelope.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_alpha">alpha</code></td>
<td>
<p>the risk level, 5% by default.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="accum_div_phylo_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>accum_ent_phylo()</code> or <code>accum_div_phylo()</code> estimate the phylogenetic
diversity or entropy accumulation curve of a distribution.
See <a href="#topic+ent_tsallis">ent_tsallis</a> for details about the computation of entropy at each level
of interpolation and extrapolation.
</p>
<p>In accumulation curves, extrapolation if done by estimating the asymptotic
distribution of the community and estimating entropy at different levels
by interpolation.
</p>
<p>Interpolation and extrapolation of integer orders of diversity are from
Chao et al. (2014).
The asymptotic richness is adjusted so that the extrapolated part of the
accumulation joins the observed value at the sample size.
</p>
<p>&quot;accumulation&quot; objects can be plotted.
They generalize the classical Species Accumulation Curves (SAC) which are
diversity accumulation of order <code class="reqn">q=0</code>.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the accumulated entropy
or diversity at each level of sampling effort.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Richness accumulation up to the sample size.
# 100 simulations only to save time.
autoplot(
  accum_div_phylo(mock_3sp_abd, tree = mock_3sp_tree, n_simulations = 100)
)

</code></pre>

<hr>
<h2 id='accum_hill'>Diversity Accumulation of a Community</h2><span id='topic+accum_hill'></span><span id='topic+accum_tsallis'></span><span id='topic+accum_tsallis.numeric'></span><span id='topic+accum_tsallis.abundances'></span><span id='topic+accum_hill.numeric'></span><span id='topic+accum_hill.abundances'></span>

<h3>Description</h3>

<p>Diversity and Entropy Accumulation Curves represent the accumulation of
entropy and diversity with respect to the sample size.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accum_tsallis(x, ...)

## S3 method for class 'numeric'
accum_tsallis(
  x,
  q = 0,
  levels = seq_len(sum(x)),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
accum_tsallis(
  x,
  q = 0,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

accum_hill(x, ...)

## S3 method for class 'numeric'
accum_hill(
  x,
  q = 0,
  levels = seq_len(sum(x)),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
accum_hill(
  x,
  q = 0,
  levels = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  n_simulations = 0,
  alpha = 0.05,
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="accum_hill_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_levels">levels</code></td>
<td>
<p>The levels, i.e. the sample sizes of interpolation or
extrapolation: a vector of integer values.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_n_simulations">n_simulations</code></td>
<td>
<p>the number of simulations used to estimate the confidence envelope.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_alpha">alpha</code></td>
<td>
<p>the risk level, 5% by default.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="accum_hill_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>accum_hill()</code> or <code>accum_tsallis()</code> estimate the diversity or entropy accumulation
curve of a distribution.
See <a href="#topic+ent_tsallis">ent_tsallis</a> for details about the computation of entropy at each level
of interpolation and extrapolation.
</p>
<p>In accumulation curves, extrapolation is done by estimating the asymptotic
distribution of the community and estimating entropy at different levels
by interpolation.
</p>
<p>Interpolation and extrapolation of integer orders of diversity are from
Chao et al. (2014).
The asymptotic richness is adjusted so that the extrapolated part of the
accumulation joins the observed value at the sample size.
</p>
<p>&quot;accumulation&quot; objects can be plotted.
They generalize the classical Species Accumulation Curves (SAC) which are
diversity accumulation of order <code class="reqn">q=0</code>.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the accumulated entropy
or diversity at each level of sampling effort.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Paracou 6 subplot 1
autoplot(accum_hill(paracou_6_abd[1, ]))

</code></pre>

<hr>
<h2 id='accum_sp'>Spatial Accumulation of Diversity</h2><span id='topic+accum_sp'></span><span id='topic+accum_sp_entropy'></span><span id='topic+accum_sp_diversity'></span><span id='topic+accum_sp_mixing'></span><span id='topic+plot.accum_sp'></span><span id='topic+autoplot.accum_sp'></span><span id='topic+plot_map'></span>

<h3>Description</h3>

<p>A spatial accumulation is a measure of diversity with respect to the distance from individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'accum_sp'
plot(
  x,
  ...,
  q = dimnames(x$accumulation)$q[1],
  type = "l",
  main = "accumulation of ...",
  xlab = "Sample size...",
  ylab = "Diversity...",
  ylim = NULL,
  show_h0 = TRUE,
  line_width = 2,
  col_shade = "grey75",
  col_border = "red"
)

## S3 method for class 'accum_sp'
autoplot(
  object,
  ...,
  q = dimnames(object$accumulation)$q[1],
  main = "Accumulation of ...",
  xlab = "Sample size...",
  ylab = "Diversity...",
  ylim = NULL,
  show_h0 = TRUE,
  col_shade = "grey75",
  col_border = "red"
)

plot_map(
  accum,
  q = as.numeric(dimnames(accum$accumulation)$q[1]),
  neighborhood = as.numeric(dplyr::last(colnames(accum$neighborhoods))),
  sigma = spatstat.explore::bw.scott(accum$X, isotropic = TRUE),
  allow_jitter = TRUE,
  weighted = FALSE,
  adjust = 1,
  dim_x = 128,
  dim_y = 128,
  main = "",
  col = grDevices::terrain.colors(256),
  contour = TRUE,
  contour_levels = 10,
  contour_col = "dark red",
  points = FALSE,
  pch = 20,
  point_col = "black",
  suppress_margins = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="accum_sp_+3A_x">x</code></td>
<td>
<p>an <code>accum_sp</code> object.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <a href="base.html#topic+plot">plot</a>, or, in <code>plot_map()</code>,
to <a href="spatstat.explore.html#topic+bw.smoothppp">spatstat.explore::bw.smoothppp</a> and <a href="spatstat.explore.html#topic+density.ppp">spatstat.explore::density.ppp</a> to
control the kernel smoothing and to <a href="spatstat.geom.html#topic+plot.im">spatstat.geom::plot.im</a> to plot the image.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_type">type</code></td>
<td>
<p>plotting parameter. Default is &quot;l&quot;.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_main">main</code></td>
<td>
<p>main title of the plot.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_xlab">xlab</code></td>
<td>
<p>X-axis label.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_ylab">ylab</code></td>
<td>
<p>Y-axis label.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_ylim">ylim</code></td>
<td>
<p>limits of the Y-axis, as a vector of two numeric values.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_show_h0">show_h0</code></td>
<td>
<p>if <code>TRUE</code>, the values of the null hypothesis are plotted.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_line_width">line_width</code></td>
<td>
<p>width of the Diversity Accumulation Curve line.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_col_shade">col_shade</code></td>
<td>
<p>The color of the shaded confidence envelope.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_col_border">col_border</code></td>
<td>
<p>The color of the borders of the confidence envelope.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_object">object</code></td>
<td>
<p>an <code>accum_sp</code> object.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_accum">accum</code></td>
<td>
<p>an object to map.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_neighborhood">neighborhood</code></td>
<td>
<p>The neighborhood size, i.e. the number of neighbors or the distance to consider.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_sigma">sigma</code></td>
<td>
<p>the smoothing bandwidth.
The standard deviation of the isotropic smoothing kernel.
Either a numerical value, or a function that computes an appropriate value of sigma.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_allow_jitter">allow_jitter</code></td>
<td>
<p>if <code>TRUE</code>, duplicated points are jittered to avoid their
elimination by the smoothing procedure.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_weighted">weighted</code></td>
<td>
<p>if <code>TRUE</code>, the weight of the points is used by the smoothing
procedure.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_adjust">adjust</code></td>
<td>
<p>force the automatically selected bandwidth to be multiplied
by <code>adjust</code>.
Setting it to values lower than one (1/2 for example) will sharpen the estimation.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_dim_x">dim_x</code></td>
<td>
<p>the number of columns (pixels) of the resulting map, 128 by default.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_dim_y">dim_y</code></td>
<td>
<p>the number of rows (pixels) of the resulting map, 128 by default.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_col">col</code></td>
<td>
<p>the colors of the map. See <a href="spatstat.geom.html#topic+plot.im">spatstat.geom::plot.im</a> for details.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_contour">contour</code></td>
<td>
<p>if <code>TRUE</code>, contours are added to the map.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_contour_levels">contour_levels</code></td>
<td>
<p>the number of levels of contours.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_contour_col">contour_col</code></td>
<td>
<p>the color of the contour lines.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_points">points</code></td>
<td>
<p>if <code>TRUE</code>, the points that brought the data are added to the map.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_pch">pch</code></td>
<td>
<p>the symbol used to represent points.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_point_col">point_col</code></td>
<td>
<p>the color of the points.
Standard base graphic arguments such as <code>main</code> can be used.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_suppress_margins">suppress_margins</code></td>
<td>
<p>if <code>TRUE</code>, the map has reduced margins.</p>
</td></tr>
<tr><td><code id="accum_sp_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Objects of class <code>accum_sp</code> contain the value of diversity
(<code>accum_sp_diversity</code> objects), entropy (<code>accum_sp_entropy</code> objects) or
mixing (<code>accum_sp_mixing</code> objects) at distances from the individuals.
</p>
<p>These objects are lists:
</p>

<ul>
<li> <p><code>X</code> contains the <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> point pattern,
</p>
</li>
<li> <p><code>accumulation</code> is a 3-dimensional array, with orders of diveristy in rows,
neighborhood size (number of points or distance) in columns and a single slice
for the observed entropy, diversity or mixing.
</p>
</li>
<li> <p><code>neighborhoods</code> is a similar 3-dimensional array with one slice per point
of <code>X</code>.
</p>
</li></ul>

<p>They can be plotted or mapped.
</p>


<h3>Value</h3>

<p><code>plot.accum_sp()</code> returns <code>NULL</code>.
</p>
<p><code>autoplot.accum_sp()</code> returns a <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object.
</p>
<p><code>plot_map</code> returns a <a href="spatstat.geom.html#topic+im">spatstat.geom::im</a> object that can be used to produce
alternative maps.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a random community
X &lt;- rspcommunity(1, size = 50, species_number = 10)
# Calculate the species accumulation curve
accum &lt;- accum_sp_hill(X, orders = 0, r = c(0, 0.2), individual = TRUE)
# Plot the local richness at distance = 0.2
plot_map(accum, q = 0, neighborhood = 0.2)

</code></pre>

<hr>
<h2 id='accum_sp_hill'>Spatial Diversity Accumulation of a Community</h2><span id='topic+accum_sp_hill'></span><span id='topic+accum_sp_tsallis'></span><span id='topic+accum_mixing'></span>

<h3>Description</h3>

<p>Spatial Diversity and Entropy Accumulation Curves represent the accumulation of
entropy and diversity with respect to the distance from individuals
</p>


<h3>Usage</h3>

<pre><code class='language-R'>accum_sp_tsallis(
  X,
  orders = 0,
  neighbors = 1:ceiling(X$n/2),
  r = NULL,
  correction = c("none", "extrapolation"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  individual = FALSE,
  show_progress = TRUE,
  check_arguments = TRUE
)

accum_sp_hill(
  X,
  orders = 0,
  neighbors = 1:ceiling(X$n/2),
  r = NULL,
  correction = c("none", "extrapolation"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  h0 = c("none", "multinomial", "random location", "binomial"),
  alpha = 0.05,
  n_simulations = 100,
  individual = FALSE,
  show_progress = TRUE,
  check_arguments = TRUE
)

accum_mixing(
  X,
  orders = 0,
  neighbors = 1:ceiling(X$n/2),
  r = NULL,
  correction = c("none", "extrapolation"),
  richness_estimator = c("rarefy", "jackknife", "iChao1", "Chao1", "naive"),
  h0 = c("none", "multinomial", "random location", "binomial"),
  alpha = 0.05,
  n_simulations = 100,
  individual = FALSE,
  show_progress = TRUE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="accum_sp_hill_+3A_x">X</code></td>
<td>
<p>a spatialized community
(A <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object with <code>PointType</code> values as species names.)</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_orders">orders</code></td>
<td>
<p>A numeric vector: the diversity orders to address. Default is 0.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_neighbors">neighbors</code></td>
<td>
<p>A vector of integers.
Entropy will be accumulated along this number of neighbors around each individual.
Default is 10% of the individuals.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_r">r</code></td>
<td>
<p>A vector of distances.
If <code>NULL</code> accumulation is along <code>n</code>, else neighbors are accumulated in circles of radius <code>r</code>.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_correction">correction</code></td>
<td>
<p>The edge-effect correction to apply when estimating
the entropy of a neighborhood community that does not fit in the window.
Does not apply if neighborhoods are defined by the number of neighbors.
Default is &quot;none&quot;.
&quot;extrapolation&quot; extrapolates the observed diversity up to the number of individuals
estimated in the full area of the neighborhood, which is slow.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_individual">individual</code></td>
<td>
<p>If <code>TRUE</code>, individual neighborhood entropies are returned.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_h0">h0</code></td>
<td>
<p>The null hypothesis to compare the distribution of <code>X</code> to.
If &quot;none&quot;, the default value, no null hypothesis is tested.
&quot;multinomial&quot; means the community will be rarefied down to the number of <code>neighbors</code>.
&quot;random location&quot; means the points will we randomly permuted across their actual locations.
&quot;binomial&quot; means the points will we uniformly and independently drawn
in the window (a binomial point process is a Poisson point process conditionally to the number of points).</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_alpha">alpha</code></td>
<td>
<p>the risk level, 5% by default.</p>
</td></tr>
<tr><td><code id="accum_sp_hill_+3A_n_simulations">n_simulations</code></td>
<td>
<p>the number of simulations used to estimate the confidence envelope.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>accum_sp_hill()</code> or <code>accum_sp_tsallis()</code> estimate the diversity or entropy
accumulation curve of a distribution.
</p>


<h3>Value</h3>

<p>An <a href="#topic+accum_sp">accum_sp</a> object, that is also either an <a href="#topic+accum_sp_diversity">accum_sp_diversity</a>,
<a href="#topic+accum_sp_entropy">accum_sp_entropy</a> or <a href="#topic+accum_sp_mixing">accum_sp_mixing</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a random community
X &lt;- rspcommunity(1, size = 50, species_number = 3)
# Calculate the accumulation of richness
accum &lt;- accum_sp_hill(X)
plot(accum, q = 0)
# along distance
accum_r &lt;- accum_sp_hill(X, orders = 1, r = seq(0, .5, .05))
autoplot(accum_r, q = 1)

</code></pre>

<hr>
<h2 id='alphahull'>alpha-shape calculation</h2><span id='topic+alphahull'></span>

<h3>Description</h3>

<p>Calculate a window containing all points of a point pattern.
The window is not convex but as close as possible to the points.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alphahull(X, alpha = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="alphahull_+3A_x">X</code></td>
<td>
<p>a planar point pattern (<a href="spatstat.geom.html#topic+ppp.object">spatstat.geom::ppp.object</a>).</p>
</td></tr>
<tr><td><code id="alphahull_+3A_alpha">alpha</code></td>
<td>
<p>a smoothing parameter to delimit concave polygons.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The typical use of this function is to define a narrow window around
a point pattern that has been created with a default, rectangle window.
</p>
<p>The window is built by the <code><a href="alphahull.html#topic+ashape">alphahull::ashape()</a></code> function and then transformed
into a <a href="spatstat.geom.html#topic+owin.object">spatstat.geom::owin.object</a>.
The <code>alpha</code> parameter determines the smallest size of zones excluded from the window.
If it is not specified, a first attempt is 1/256 of the diameter of the existing window of <code>X</code>.
If the shape cannot be calculated, <code>alpha</code> is doubled and a new attempt is made.
</p>


<h3>Value</h3>

<p>A window, i.e. a <a href="spatstat.geom.html#topic+owin.object">spatstat.geom::owin.object</a>.
</p>


<h3>See Also</h3>

<p><a href="spatstat.geom.html#topic+convexhull">spatstat.geom::convexhull</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a point pattern
if (require(spatstat.random)) {
  X &lt;- rpoispp(50)
  plot(X)
  # Calculate its border
  X$window &lt;- alphahull(X)
  plot(X)
}
</code></pre>

<hr>
<h2 id='autoplot.accumulation'>Plot Accumulation Objects</h2><span id='topic+autoplot.accumulation'></span>

<h3>Description</h3>

<p>Plot objects of class &quot;accumulation&quot; produced by <a href="#topic+accum_hill">accum_hill</a> and other
accumulation functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'accumulation'
autoplot(
  object,
  ...,
  main = NULL,
  xlab = "Sample Size",
  ylab = NULL,
  shade_color = "grey75",
  alpha = 0.3,
  lty = 1,
  lwd = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.accumulation_+3A_object">object</code></td>
<td>
<p>An object of class &quot;accumulation&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_main">main</code></td>
<td>
<p>The main title of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_xlab">xlab</code></td>
<td>
<p>The label of the x-axis.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_ylab">ylab</code></td>
<td>
<p>The label of the y-axis.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_shade_color">shade_color</code></td>
<td>
<p>The color of the shaded confidence envelopes.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_alpha">alpha</code></td>
<td>
<p>The opacity of the confidence envelopes, between 0 (transparent) and 1 (opaque).</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_lty">lty</code></td>
<td>
<p>The line type of the curves.</p>
</td></tr>
<tr><td><code id="autoplot.accumulation_+3A_lwd">lwd</code></td>
<td>
<p>The line width of the curves.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Species accumulation curve
autoplot(accum_hill(mock_3sp_abd))

</code></pre>

<hr>
<h2 id='autoplot.profile'>Plot Profile Objects</h2><span id='topic+autoplot.profile'></span>

<h3>Description</h3>

<p>Plot objects of class &quot;profile&quot; produced by <a href="#topic+profile_hill">profile_hill</a> and other
profile functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'profile'
autoplot(
  object,
  ...,
  main = NULL,
  xlab = "Order of Diversity",
  ylab = "Diversity",
  shade_color = "grey75",
  alpha = 0.3,
  lty = 1,
  lwd = 0.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.profile_+3A_object">object</code></td>
<td>
<p>An object of class &quot;profile&quot;.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_main">main</code></td>
<td>
<p>The main title of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_xlab">xlab</code></td>
<td>
<p>The label of the x-axis.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_ylab">ylab</code></td>
<td>
<p>The label of the y-axis.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_shade_color">shade_color</code></td>
<td>
<p>The color of the shaded confidence envelopes.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_alpha">alpha</code></td>
<td>
<p>The opacity of the confidence envelopes, between 0 (transparent) and 1 (opaque).</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_lty">lty</code></td>
<td>
<p>The line type of the curves.</p>
</td></tr>
<tr><td><code id="autoplot.profile_+3A_lwd">lwd</code></td>
<td>
<p>The line width of the curves.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diversity profile curve
autoplot(profile_hill(mock_3sp_abd))

</code></pre>

<hr>
<h2 id='autoplot.wmppp'>ggplot method to plot wmppp objects</h2><span id='topic+autoplot.wmppp'></span>

<h3>Description</h3>

<p>This method is from the dbmss package. See <a href="dbmss.html#topic+autoplot">dbmss::autoplot.wmppp</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'wmppp'
autoplot(
  object,
  ...,
  show.window = TRUE,
  MaxPointTypes = 6,
  Other = "Other",
  main = NULL,
  xlab = NULL,
  ylab = NULL,
  LegendLabels = NULL,
  labelSize = "Weight",
  labelColor = "Type",
  palette = "Set1",
  windowColor = "black",
  windowFill = "transparent",
  alpha = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="autoplot.wmppp_+3A_object">object</code></td>
<td>
<p>an object to be plotted.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_...">...</code></td>
<td>
<p>extra arguments, currently unused.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_show.window">show.window</code></td>
<td>
<p>if <code>TRUE</code>, the borders of the window containing the points are shown on the point map.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_maxpointtypes">MaxPointTypes</code></td>
<td>
<p>the maximum number of different point types to show.
If the point set contains more of them, the less frequent ones are gathered as &quot;Other&quot;.
This number must be limited for readability and not to exceed the number of colors offered by the palette.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_other">Other</code></td>
<td>
<p>the name of the point types gathered as &quot;Other&quot;</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_main">main</code></td>
<td>
<p>the title of the plot.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_xlab">xlab</code></td>
<td>
<p>the X-axis label.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_ylab">ylab</code></td>
<td>
<p>the Y-axis label.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_legendlabels">LegendLabels</code></td>
<td>
<p>a vector of characters.
The first two items describe the observed and null-hypothesis curves, the third and last item the confidence interval.
To be used only in plots with two curves (typically observed and expected values).
The default is <code>NULL</code> to display the full description of functions.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_labelsize">labelSize</code></td>
<td>
<p>the guide of the point size legend in point maps, i.e. what the <code>PointSize</code> mark represents.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_labelcolor">labelColor</code></td>
<td>
<p>the guide of the point color legend in point maps, i.e. what the <code>PointType</code> mark represents.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_palette">palette</code></td>
<td>
<p>the color palette used to display point types in maps. See <a href="ggplot2.html#topic+scale_brewer">ggplot2::scale_colour_brewer</a>.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_windowcolor">windowColor</code></td>
<td>
<p>the color used to draw the limits of the windows in point maps.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_windowfill">windowFill</code></td>
<td>
<p>the color used to fill the windows in point maps.</p>
</td></tr>
<tr><td><code id="autoplot.wmppp_+3A_alpha">alpha</code></td>
<td>
<p>the opacity of the confidence envelope (in function values) or the points (in maps), between 0 and 1.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <a href="ggplot2.html#topic+ggplot">ggplot2::ggplot</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (require("ggplot2")) {
  autoplot(paracou_6_wmppp) +
    # use radius scale because point sizes are already areas
    scale_radius() +
    labs(color = "Species", size = "Basal area")
}
</code></pre>

<hr>
<h2 id='check_divent_args'>check_divent_args</h2><span id='topic+check_divent_args'></span>

<h3>Description</h3>

<p>Checks the arguments of a function of the package divent
</p>


<h3>Usage</h3>

<pre><code class='language-R'>check_divent_args(
  abd = NULL,
  abundances = NULL,
  alpha = NULL,
  as_numeric = NULL,
  bootstrap = NULL,
  check_arguments = NULL,
  correction = NULL,
  coverage_estimator = NULL,
  distances = NULL,
  distribution = NULL,
  estimator = NULL,
  fisher_alpha = NULL,
  gamma = NULL,
  global = NULL,
  jack_alpha = NULL,
  jack_max = NULL,
  k = NULL,
  level = NULL,
  n = NULL,
  n_simulations = NULL,
  normalize = NULL,
  orders = NULL,
  prob = NULL,
  prob_geom = NULL,
  probability_estimator = NULL,
  q = NULL,
  q_threshold = NULL,
  r = NULL,
  rate = NULL,
  richness_estimator = NULL,
  sample_coverage = NULL,
  sd_lnorm = NULL,
  show_progress = NULL,
  similarities = NULL,
  size = NULL,
  species_number = NULL,
  species_distribution = NULL,
  thomas_mu = NULL,
  thomas_scale = NULL,
  tree = NULL,
  use.names = NULL,
  unveiling = NULL,
  weights = NULL,
  w_max = NULL,
  w_mean = NULL,
  w_min = NULL,
  weibull_scale = NULL,
  weibull_shape = NULL,
  X = NULL,
  win = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="check_divent_args_+3A_abd">abd</code></td>
<td>
<p>a numeric vector containing abundances.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_abundances">abundances</code></td>
<td>
<p>an object of class <a href="#topic+abundances">abundances</a>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_alpha">alpha</code></td>
<td>
<p>the risk level, 5% by default.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_bootstrap">bootstrap</code></td>
<td>
<p>the method used to obtain the probabilities to generate
bootstrapped communities from observed abundances.
If &quot;Marcon2012&quot;, the probabilities are simply the abundances divided by the total
number of individuals (Marcon et al. 2012).
If &quot;Chao2013&quot; or &quot;Chao2015&quot; (by default), a more sophisticated approach is used
(see <a href="#topic+as_probabilities">as_probabilities</a>) following Chao et al. (2013) or
Chao and Jost (2015).</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_correction">correction</code></td>
<td>
<p>the edge-effect correction to apply when estimating
the number of neighbors.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_distances">distances</code></td>
<td>
<p>a distance matrix or an object of class <a href="stats.html#topic+dist">stats::dist</a>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_distribution">distribution</code></td>
<td>
<p>The distribution of species abundances.
May be &quot;lnorm&quot; (log-normal), &quot;lseries&quot; (log-series), &quot;geom&quot; (geometric) or
&quot;bstick&quot; (broken stick).</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_estimator">estimator</code></td>
<td>
<p>an estimator of asymptotic entropy, diversity or richness.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_fisher_alpha">fisher_alpha</code></td>
<td>
<p>Fisher's <code class="reqn">\alpha</code> in the log-series distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_global">global</code></td>
<td>
<p>if <code>TRUE</code>, a global envelope sensu (Duranton and Overman 2005) is calculated.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_k">k</code></td>
<td>
<p>the order of Hurlbert's diversity.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_n">n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_n_simulations">n_simulations</code></td>
<td>
<p>the number of simulations used to estimate the confidence envelope.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_orders">orders</code></td>
<td>
<p>The orders of diversity.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_prob">prob</code></td>
<td>
<p>a numeric vector containing probabilities.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_prob_geom">prob_geom</code></td>
<td>
<p>the proportion of resources taken by successive species
of the geometric distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_q_threshold">q_threshold</code></td>
<td>
<p>the value of <code>q</code> above which diversity is computed
directly with the naive estimator <code class="reqn">(\sum{p_s^q}^{\frac{1}{(1-q)}}</code>,
without computing entropy.
When <code>q</code> is great, the exponential of entropy goes to <code class="reqn">0^{\frac{1}{(1-q)}}</code>,
causing rounding errors while the naive estimator of diversity is less and
less biased.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_r">r</code></td>
<td>
<p>a vector of distances.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_rate">rate</code></td>
<td>
<p>the decay rate of the exponential similarity.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_sd_lnorm">sd_lnorm</code></td>
<td>
<p>the simulated log-normal distribution standard deviation.
This is the standard deviation on the log scale.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_similarities">similarities</code></td>
<td>
<p>a similarity matrix, that can be obtained by <a href="#topic+fun_similarity">fun_similarity</a>.
Its default value is the identity matrix.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_size">size</code></td>
<td>
<p>the number of individuals to draw in each community.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_species_number">species_number</code></td>
<td>
<p>the number of species.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_species_distribution">species_distribution</code></td>
<td>
<p>an object of class <a href="#topic+species_distribution">species_distribution</a>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_thomas_mu">thomas_mu</code></td>
<td>
<p>in Thomas point patterns, the mean number of points per cluster.
The intensity of the Poisson process of cluster centers is calculated as
the number of points (<code>size</code>) per area divided by <code>thomas_mu</code>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_thomas_scale">thomas_scale</code></td>
<td>
<p>in Thomas point patterns, the standard deviation of random displacement
(along each coordinate axis) of a point from its cluster center.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_use.names">use.names</code></td>
<td>
<p>if <code>TRUE</code>, the names of the <code>species_distribution</code> are kept
in the matrix or vector they are converted to.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_weights">weights</code></td>
<td>
<p>the weights of the sites of the species distributions.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_w_max">w_max</code></td>
<td>
<p>the maximum weight in a uniform distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_w_mean">w_mean</code></td>
<td>
<p>the mean weight in an exponential distribution
(i.e. the negative of the inverse of the decay rate).</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_w_min">w_min</code></td>
<td>
<p>the minimum weight in a uniform, exponential or Weibull distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>the scale parameter in a Weibull distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>the shape parameter in a Weibull distribution.</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_x">X</code></td>
<td>
<p>a spatialized community
(A <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object with <code>PointType</code> values as species names.)</p>
</td></tr>
<tr><td><code id="check_divent_args_+3A_win">win</code></td>
<td>
<p>the window containing the point pattern.
It is an <a href="spatstat.geom.html#topic+owin">spatstat.geom::owin</a> object.
Default is a 1x1 square.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function compares the arguments passed to its parent function to the type
they should be and performs some extra tests, <em>e.g.</em> probabilities must be positive and sum to 1.
It stops if an argument is not correct.
</p>
<p>The function is always called without arguments.
Its arguments exist only for documentation.
</p>


<h3>Value</h3>

<p>Returns <code>TRUE</code> or stops if a problem is detected.
</p>

<hr>
<h2 id='coverage'>Sample Coverage of a Community</h2><span id='topic+coverage'></span><span id='topic+coverage.numeric'></span><span id='topic+coverage.abundances'></span><span id='topic+coverage_to_size'></span><span id='topic+coverage_to_size.numeric'></span><span id='topic+coverage_to_size.abundances'></span>

<h3>Description</h3>

<p><code>coverage()</code> calculates an estimator of the sample coverage of a community
described by its abundance vector.
<code>coverage_to_size()</code> estimates the sample size corresponding to the chosen
sample coverage.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coverage(x, ...)

## S3 method for class 'numeric'
coverage(
  x,
  estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  level = NULL,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
coverage(
  x,
  estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  level = NULL,
  ...,
  check_arguments = TRUE
)

coverage_to_size(x, ...)

## S3 method for class 'numeric'
coverage_to_size(
  x,
  sample_coverage,
  estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
coverage_to_size(
  x,
  sample_coverage,
  estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coverage_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="coverage_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="coverage_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of the sample coverage.
&quot;ZhangHuang&quot; is the most accurate but does not allow choosing a <code>level</code>.
&quot;Good&quot;'s estimator only allows interpolation, i.e. estimation of the coverage
of a subsample.
&quot;Chao&quot; allows estimation at any <code>level</code>, including extrapolation.
&quot;Turing&quot; is the simplest estimator, equal to 1 minus the number of singletons
divided by the sample size.</p>
</td></tr>
<tr><td><code id="coverage_+3A_level">level</code></td>
<td>
<p>The level of interpolation or extrapolation, i.e. an abundance.</p>
</td></tr>
<tr><td><code id="coverage_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="coverage_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="coverage_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>The target sample coverage.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample coverage <code class="reqn">C</code> of a community is the total probability of
occurrence of the species observed in the sample.
<code class="reqn">1-C</code> is the probability for an individual of the whole community to
belong to a species that has not been sampled.
</p>
<p>The historical estimator is due to Turing (Good 1953).
It only relies on singletons (species observed only once).
Chao's (Chao and Shen 2010) estimator uses doubletons too and
Zhang-Huang's (Chao et al. 1988; Zhang and Huang 2007) uses the whole
distribution.
</p>
<p>If <code>level</code> is not <code>NULL</code>, the sample coverage is interpolated or extrapolated.
Interpolation by the Good estimator relies on the equality between sampling
deficit and the generalized Simpson entropy (Good 1953).
The Chao et al. (2014) estimator allows extrapolation,
reliable up a level equal to the double size of the sample.
</p>


<h3>Value</h3>

<p><code>coverage()</code> returns a named number equal to the calculated sample coverage.
The name is that of the estimator used.
</p>
<p><code>coverage_to_size()</code> returns a number equal to the sample size corresponding
to the chosen sample coverage.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Chao A, Lee S, Chen T (1988).
&ldquo;A Generalized Good's Nonparametric Coverage Estimator.&rdquo;
<em>Chinese Journal of Mathematics</em>, <b>16</b>, 189&ndash;199.
43836340.<br /><br /> Chao A, Shen T (2010).
<em>Program SPADE: Species Prediction and Diversity Estimation. Program and User's Guide.</em>.
CARE.<br /><br /> Good IJ (1953).
&ldquo;The Population Frequency of Species and the Estimation of Population Parameters.&rdquo;
<em>Biometrika</em>, <b>40</b>(3/4), 237&ndash;264.
<a href="https://doi.org/10.1093/biomet/40.3-4.237">doi:10.1093/biomet/40.3-4.237</a>.<br /><br /> Zhang Z, Huang H (2007).
&ldquo;Turing's Formula Revisited.&rdquo;
<em>Journal of Quantitative Linguistics</em>, <b>14</b>(2-3), 222&ndash;241.
<a href="https://doi.org/10.1080/09296170701514189">doi:10.1080/09296170701514189</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>coverage(paracou_6_abd)
coverage_to_size(paracou_6_abd, sample_coverage = 0.9)

</code></pre>

<hr>
<h2 id='div_gen_simpson'>Generalized Simpson's Diversity</h2><span id='topic+div_gen_simpson'></span><span id='topic+div_gen_simpson.numeric'></span><span id='topic+div_gen_simpson.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the diversity sensu stricto, i.e. the effective number of species
(Grabchak et al. 2017) from abundance or probability data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_gen_simpson(x, k = 1, ...)

## S3 method for class 'numeric'
div_gen_simpson(
  x,
  k = 1,
  estimator = c("Zhang", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_gen_simpson(
  x,
  k = 1,
  estimator = c("Zhang", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_gen_simpson_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_gen_simpson_+3A_k">k</code></td>
<td>
<p>the order of Hurlbert's diversity.</p>
</td></tr>
<tr><td><code id="div_gen_simpson_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_gen_simpson_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of asymptotic diversity.</p>
</td></tr>
<tr><td><code id="div_gen_simpson_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_gen_simpson_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
</p>
<p>Estimation techniques are from Zhang and Grabchak (2016).
It is limited to orders <code class="reqn">k</code> less than or equal to the number of individuals
in the community.
</p>
<p>Generalized Simpson's diversity cannot be estimated at a specified level
of interpolation or extrapolation, and diversity partitioning is not available.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity.
</p>


<h3>References</h3>

<p>Grabchak M, Marcon E, Lang G, Zhang Z (2017).
&ldquo;The Generalized Simpson's Entropy Is a Measure of Biodiversity.&rdquo;
<em>Plos One</em>, <b>12</b>(3), e0173305.
<a href="https://doi.org/10.1371/journal.pone.0173305">doi:10.1371/journal.pone.0173305</a>.<br /><br /> Zhang Z, Grabchak M (2016).
&ldquo;Entropic Representation and Estimation of Diversity Indices.&rdquo;
<em>Journal of Nonparametric Statistics</em>, <b>28</b>(3), 563&ndash;575.
<a href="https://doi.org/10.1080/10485252.2016.1190357">doi:10.1080/10485252.2016.1190357</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+ent_gen_simpson">ent_gen_simpson</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diversity of each community
div_gen_simpson(paracou_6_abd, k = 50)

</code></pre>

<hr>
<h2 id='div_hill'>Hill number of a Community</h2><span id='topic+div_hill'></span><span id='topic+div_hill.numeric'></span><span id='topic+div_hill.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the diversity sensu stricto, i.e. the Hill (1973)
number of species from abundance or probability data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_hill(x, q = 1, ...)

## S3 method for class 'numeric'
div_hill(
  x,
  q = 1,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q_threshold = 10,
  sample_coverage = NULL,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_hill(
  x,
  q = 1,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q_threshold = 10,
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_hill_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_estimator">estimator</code></td>
<td>
<p>an estimator of asymptotic diversity.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_q_threshold">q_threshold</code></td>
<td>
<p>the value of <code>q</code> above which diversity is computed
directly with the naive estimator <code class="reqn">(\sum{p_s^q}^{\frac{1}{(1-q)}}</code>,
without computing entropy.
When <code>q</code> is great, the exponential of entropy goes to <code class="reqn">0^{\frac{1}{(1-q)}}</code>,
causing rounding errors while the naive estimator of diversity is less and
less biased.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="div_hill_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several estimators are available to deal with incomplete sampling.
</p>
<p>Bias correction requires the number of individuals.
</p>
<p>Estimation techniques are from Chao and Shen (2003),
Grassberger (1988),Holste et al. (1998),
Bonachela et al. (2008), Marcon et al. (2014)
which is actually the max value of &quot;ChaoShen&quot; and &quot;Grassberger&quot;,
Zhang and Grabchak (2014), Chao et al. (2015),
Chao and Jost (2015) and Marcon (2015).
</p>
<p>The <code>ChaoJost</code> estimator (Chao et al. 2013; Chao and Jost 2015) contains
an unbiased part concerning observed species, equal to that of
Zhang and Grabchak (2014), and a (biased) estimator of the remaining
bias based on the estimation of the species-accumulation curve.
It is very efficient but slow if the number of individuals is more than a few hundreds.
</p>
<p>The unveiled estimators rely on Chao et al. (2015),
completed by Marcon (2015).
The actual probabilities of observed species are estimated and completed by
a geometric distribution of the probabilities of unobserved species.
The number of unobserved species is estimated by the Chao1 estimator (<code>UnveilC</code>),
following Chao et al. (2015), or by the iChao1 (<code>UnveiliC</code>)
or the jackknife (<code>UnveilJ</code>).
The <code>UnveilJ</code> estimator often has a lower bias but a greater variance
(Marcon 2015).
It is a good first choice thanks to the versatility of the jackknife
estimator of richness.
</p>
<p>Estimators by Bonachela et al. (2008) and
Holste et al. (1998) are rarely used.
</p>
<p>To estimate <code class="reqn">\gamma</code> diversity, the size of a metacommunity (see
<a href="#topic+metacommunity">metacommunity</a>) is unknown so it has to be set according to a rule which does
not ensure that its abundances are integer values.
Then, classical bias-correction methods do not apply.
Providing the <code>sample_coverage</code> argument allows applying the <code>ChaoShen</code> and
<code>Grassberger</code> estimators to estimate quite well the entropy.
</p>
<p>Diversity can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_hill">accum_hill</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity.
</p>


<h3>References</h3>

<p>Bonachela JA, Hinrichsen H, Muñoz MA (2008).
&ldquo;Entropy Estimates of Small Data Sets.&rdquo;
<em>Journal of Physics A: Mathematical and Theoretical</em>, <b>41</b>(202001), 1&ndash;9.
<a href="https://doi.org/10.1088/1751-8113/41/20/202001">doi:10.1088/1751-8113/41/20/202001</a>.<br /><br /> Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Chao A, Hsieh TC, Chazdon RL, Colwell RK, Gotelli NJ (2015).
&ldquo;Unveiling the Species-Rank Abundance Distribution by Generalizing Good-Turing Sample Coverage Theory.&rdquo;
<em>Ecology</em>, <b>96</b>(5), 1189&ndash;1201.
<a href="https://doi.org/10.1890/14-0550.1">doi:10.1890/14-0550.1</a>.<br /><br /> Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Shen T (2003).
&ldquo;Nonparametric Estimation of Shannon's Index of Diversity When There Are Unseen Species in Sample.&rdquo;
<em>Environmental and Ecological Statistics</em>, <b>10</b>(4), 429&ndash;443.
<a href="https://doi.org/10.1023/A%3A1026096204727">doi:10.1023/A:1026096204727</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.<br /><br /> Grassberger P (1988).
&ldquo;Finite Sample Corrections to Entropy and Dimension Estimates.&rdquo;
<em>Physics Letters A</em>, <b>128</b>(6-7), 369&ndash;373.
<a href="https://doi.org/10.1016/0375-9601%2888%2990193-4">doi:10.1016/0375-9601(88)90193-4</a>.<br /><br /> Hill MO (1973).
&ldquo;Diversity and Evenness: A Unifying Notation and Its Consequences.&rdquo;
<em>Ecology</em>, <b>54</b>(2), 427&ndash;432.
<a href="https://doi.org/10.2307/1934352">doi:10.2307/1934352</a>.<br /><br /> Holste D, Große I, Herzel H (1998).
&ldquo;Bayes' Estimators of Generalized Entropies.&rdquo;
<em>Journal of Physics A: Mathematical and General</em>, <b>31</b>(11), 2551&ndash;2566.<br /><br /> Marcon E (2015).
&ldquo;Practical Estimation of Diversity from Abundance Data.&rdquo;
<em>HAL</em>, <b>01212435</b>(version 2).<br /><br /> Marcon E, Scotti I, Hérault B, Rossi V, Lang G (2014).
&ldquo;Generalization of the Partitioning of Shannon Diversity.&rdquo;
<em>Plos One</em>, <b>9</b>(3), e90289.
<a href="https://doi.org/10.1371/journal.pone.0090289">doi:10.1371/journal.pone.0090289</a>.<br /><br /> Zhang Z, Grabchak M (2014).
&ldquo;Nonparametric Estimation of Kullback-Leibler Divergence.&rdquo;
<em>Neural computation</em>, <b>26</b>(11), 2570&ndash;2593.
<a href="https://doi.org/10.1162/NECO_a_00646">doi:10.1162/NECO_a_00646</a>, 25058703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diversity of each community
div_hill(paracou_6_abd, q = 2)
# gamma diversity
div_hill(paracou_6_abd, q = 2, gamma = TRUE)

# At 80% coverage
div_hill(paracou_6_abd, q = 2, level = 0.8)

</code></pre>

<hr>
<h2 id='div_hurlbert'>Hurlbert Diversity of a Community</h2><span id='topic+div_hurlbert'></span><span id='topic+div_hurlbert.numeric'></span><span id='topic+div_hurlbert.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the diversity sensu stricto, i.e. the effective
number of species Dauby and Hardy (2012)
from abundance or probability data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_hurlbert(x, k = 1, ...)

## S3 method for class 'numeric'
div_hurlbert(
  x,
  k = 2,
  estimator = c("Hurlbert", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_hurlbert(
  x,
  k = 2,
  estimator = c("Hurlbert", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_hurlbert_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_hurlbert_+3A_k">k</code></td>
<td>
<p>the order of Hurlbert's diversity.</p>
</td></tr>
<tr><td><code id="div_hurlbert_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_hurlbert_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of asymptotic diversity.</p>
</td></tr>
<tr><td><code id="div_hurlbert_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_hurlbert_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Several estimators are available to deal with incomplete sampling.
</p>
<p>Bias correction requires the number of individuals.
</p>
<p>Estimation techniques are from Hurlbert (1971).
</p>
<p>Hurlbert's diversity cannot be estimated at a specified level of interpolation or
extrapolation, and diversity partioning is not available.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity.
</p>


<h3>References</h3>

<p>Dauby G, Hardy OJ (2012).
&ldquo;Sampled-Based Estimation of Diversity Sensu Stricto by Transforming Hurlbert Diversities into Effective Number of Species.&rdquo;
<em>Ecography</em>, <b>35</b>(7), 661&ndash;672.
<a href="https://doi.org/10.1111/j.1600-0587.2011.06860.x">doi:10.1111/j.1600-0587.2011.06860.x</a>.<br /><br /> Hurlbert SH (1971).
&ldquo;The Nonconcept of Species Diversity: A Critique and Alternative Parameters.&rdquo;
<em>Ecology</em>, <b>52</b>(4), 577&ndash;586.
<a href="https://doi.org/10.2307/1934145">doi:10.2307/1934145</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+ent_hurlbert">ent_hurlbert</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diversity of each community
div_hurlbert(paracou_6_abd, k = 2)

</code></pre>

<hr>
<h2 id='div_part'>Diversity partition</h2><span id='topic+div_part'></span>

<h3>Description</h3>

<p>Calculate <code class="reqn">\gamma</code>, <code class="reqn">\beta</code> and <code class="reqn">\alpha</code> diversities of a metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_part(
  abundances,
  q = 1,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Holste",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q_threshold = 10,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_part_+3A_abundances">abundances</code></td>
<td>
<p>an object of class <a href="#topic+abundances">abundances</a>.</p>
</td></tr>
<tr><td><code id="div_part_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="div_part_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of diversity.</p>
</td></tr>
<tr><td><code id="div_part_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="div_part_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_part_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_part_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="div_part_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="div_part_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="div_part_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="div_part_+3A_q_threshold">q_threshold</code></td>
<td>
<p>the value of <code>q</code> above which diversity is computed
directly with the naive estimator <code class="reqn">(\sum{p_s^q}^{\frac{1}{(1-q)}}</code>,
without computing entropy.
When <code>q</code> is great, the exponential of entropy goes to <code class="reqn">0^{\frac{1}{(1-q)}}</code>,
causing rounding errors while the naive estimator of diversity is less and
less biased.</p>
</td></tr>
<tr><td><code id="div_part_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function computes <code class="reqn">\gamma</code> diversity after building a metacommunity
from local communities according to their weight (Marcon et al. 2014).
<code class="reqn">\alpha</code> entropy is the weighted mean local entropy, converted into Hill
numbers to obtain <code class="reqn">\alpha</code> diversity.
<code class="reqn">\beta</code> diversity is obtained as the ratio of <code class="reqn">\gamma</code> to <code class="reqn">\alpha</code>.
</p>


<h3>Value</h3>

<p>A tibble with diversity values at each scale.
</p>


<h3>References</h3>

<p>Marcon E, Scotti I, Hérault B, Rossi V, Lang G (2014).
&ldquo;Generalization of the Partitioning of Shannon Diversity.&rdquo;
<em>Plos One</em>, <b>9</b>(3), e90289.
<a href="https://doi.org/10.1371/journal.pone.0090289">doi:10.1371/journal.pone.0090289</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>div_part(paracou_6_abd)

</code></pre>

<hr>
<h2 id='div_pd'>Faith's Phylogenetic Diversity of a Community</h2><span id='topic+div_pd'></span><span id='topic+div_pd.numeric'></span><span id='topic+div_pd.species_distribution'></span>

<h3>Description</h3>

<p>Estimate PD (Faith 1992) or FD (Petchey and Gaston 2002) from
abundance or probability data and a phylogenetic or functional dendrogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_pd(x, tree, ...)

## S3 method for class 'numeric'
div_pd(x, tree, prune = FALSE, as_numeric = FALSE, ..., check_arguments = TRUE)

## S3 method for class 'species_distribution'
div_pd(
  x,
  tree,
  prune = FALSE,
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_pd_+3A_x">x</code></td>
<td>
<p>An object, that may be a named numeric vector (names are species names)
containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_prune">prune</code></td>
<td>
<p>What to do when some species are in the tree but not in <code>x</code>?
If <code>TRUE</code>, the tree is pruned to keep species of <code>x</code> only.
The height of the tree may be changed if a pruned branch is related to the root.
If <code>FALSE</code> (default), the length of branches of missing species is not summed
but the height of the tree is never changed.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="div_pd_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimators to deal with incomplete sampling are not implemented.
Use function <a href="#topic+div_hill">div_hill</a> with argument <code>q = 0</code> if they are needed.
</p>
<p>PD and FD are defined as the total length of the branches of the tree.
</p>
<p>All species of the <code>species_distribution</code> must be found in the tips of the
<code>tree</code>.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity.
</p>


<h3>References</h3>

<p>Faith DP (1992).
&ldquo;Conservation Evaluation and Phylogenetic Diversity.&rdquo;
<em>Biological Conservation</em>, <b>61</b>(1), 1&ndash;10.
<a href="https://doi.org/10.1016/0006-3207%2892%2991201-3">doi:10.1016/0006-3207(92)91201-3</a>.<br /><br /> Petchey OL, Gaston KJ (2002).
&ldquo;Functional Diversity (FD), Species Richness and Community Composition.&rdquo;
<em>Ecology Letters</em>, <b>5</b>, 402&ndash;411.
<a href="https://doi.org/10.1046/j.1461-0248.2002.00339.x">doi:10.1046/j.1461-0248.2002.00339.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># diversity of each community
div_pd(paracou_6_abd, tree = paracou_6_taxo)

# gamma diversity
div_pd(paracou_6_abd, tree = paracou_6_taxo, gamma = TRUE)

</code></pre>

<hr>
<h2 id='div_phylo'>Phylogenetic Diversity of a Community</h2><span id='topic+div_phylo'></span><span id='topic+div_phylo.numeric'></span><span id='topic+div_phylo.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the diversity of species from abundance or probability data
and a phylogenetic tree.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_phylo(x, tree, q = 1, ...)

## S3 method for class 'numeric'
div_phylo(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_phylo(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_phylo_+3A_x">x</code></td>
<td>
<p>An object, that may be a named numeric vector (names are species names)
containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of asymptotic diversity.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="div_phylo_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
See <a href="#topic+div_hill">div_hill</a> for estimators.
</p>
<p>Entropy can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_tsallis">accum_tsallis</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated
diversity
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>div_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2)

# At 80% coverage
div_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2, level = 0.8)

# Gamma entropy
div_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2, gamma = TRUE)

</code></pre>

<hr>
<h2 id='div_richness'>Number of Species of a Community</h2><span id='topic+div_richness'></span><span id='topic+div_richness.numeric'></span><span id='topic+div_richness.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the number of species from abundance or probability data.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_richness(x, ...)

## S3 method for class 'numeric'
div_richness(
  x,
  estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_richness(
  x,
  estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_richness_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a>  or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_...">...</code></td>
<td>
<p>Unused.
The metacommunity if built by combining the community abundances with respect to their weight.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of richness to evaluate the total number of species.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_level">level</code></td>
<td>
<p>The level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
The asymptotic <code>estimator</code> is used in extrapolation
(i.e. a <code>level</code> greater than the sample size).</p>
</td></tr>
<tr><td><code id="div_richness_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>A string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only by the estimator of richness &quot;rarefy&quot;.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_unveiling">unveiling</code></td>
<td>
<p>A string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only by the estimator of richness &quot;rarefy&quot;.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="div_richness_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
Chao's estimation techniques are from Chao et al. (2014)
and Chiu et al. (2014).
The Jackknife estimator is calculated by a straight adaptation of the code
by Ji-Ping Wang (jackknife in package <strong>SPECIES</strong>).
The optimal order is selected according to
Burnham and Overton (1978); Burnham and Overton (1979).
Many other estimators are available elsewhere, the ones implemented here are
necessary for other entropy estimations.
</p>
<p>Richness can be estimated at a specified <code>level</code> of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chiu et al. 2014), rather than its asymptotic value.
Extrapolation relies on the estimation of the asymptotic richness.
If <code>probability_estimator</code> is &quot;naive&quot;, then the asymptotic estimation of
richness is made using the chosen <code>estimator</code>, else the asymptotic
distribution of the community is derived and its estimated richness adjusted
so that the richness of a sample of this distribution of the size of the
actual sample has the richness of the actual sample.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated numbers of species.
</p>


<h3>References</h3>

<p>Burnham KP, Overton WS (1978).
&ldquo;Estimation of the Size of a Closed Population When Capture Probabilities Vary among Animals.&rdquo;
<em>Biometrika</em>, <b>65</b>(3), 625&ndash;633.
<a href="https://doi.org/10.2307/2335915">doi:10.2307/2335915</a>.<br /><br /> Burnham KP, Overton WS (1979).
&ldquo;Robust Estimation of Population Size When Capture Probabilities Vary among Animals.&rdquo;
<em>Ecology</em>, <b>60</b>(5), 927&ndash;936.
<a href="https://doi.org/10.2307/1936861">doi:10.2307/1936861</a>.<br /><br /> Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Chiu C, Wang Y, Walther BA, Chao A (2014).
&ldquo;An Improved Nonparametric Lower Bound of Species Richness via a Modified Good-Turing Frequency Formula.&rdquo;
<em>Biometrics</em>, <b>70</b>(3), 671&ndash;682.
<a href="https://doi.org/10.1111/biom.12200">doi:10.1111/biom.12200</a>, 24945937.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Diversity of each community
div_richness(paracou_6_abd)
# gamma diversity
div_richness(paracou_6_abd, gamma = TRUE)

# At 80% coverage
div_richness(paracou_6_abd, level = 0.8)

</code></pre>

<hr>
<h2 id='div_similarity'>Similarity-Based Diversity of a Community</h2><span id='topic+div_similarity'></span><span id='topic+div_similarity.numeric'></span><span id='topic+div_similarity.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the diversity of species from abundance or probability data and a
similarity matrix between species.
Several estimators are available to deal with incomplete sampling.
Bias correction requires the number of individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>div_similarity(x, similarities, q = 1, ...)

## S3 method for class 'numeric'
div_similarity(
  x,
  similarities = diag(length(x)),
  q = 1,
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  sample_coverage = NULL,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
div_similarity(
  x,
  similarities = diag(sum(!colnames(x) %in% non_species_columns)),
  q = 1,
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="div_similarity_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.
If it is a numeric vector, then its length must equal the dimensions of the
<code>similarities</code> matrix: species are assumed to be in the same order.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_similarities">similarities</code></td>
<td>
<p>a similarity matrix, that can be obtained by <a href="#topic+fun_similarity">fun_similarity</a>.
Its default value is the identity matrix.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of asymptotic diversity.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="div_similarity_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All species of the <code>species_distribution</code> must be found in the matrix of
<code>similarities</code> if it is named.
If it is not, its size must equal the number of species.
Then, the order of species is assumed to be the same as that of the
<code>species_distribution</code>.
</p>
<p>Similarity-Based diversity can't be interpolated of extrapolated as of the
state of the art.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Similarity matrix
Z &lt;- fun_similarity(paracou_6_fundist)
# Diversity of each community
div_similarity(paracou_6_abd, similarities = Z, q = 2)
# gamma diversity
div_similarity(paracou_6_abd, similarities = Z, q = 2, gamma = TRUE)

</code></pre>

<hr>
<h2 id='e_n_q'>Grassberger's expectation of n^q</h2><span id='topic+e_n_q'></span>

<h3>Description</h3>

<p>Expected value of <code class="reqn">n^q</code> when <code class="reqn">n</code> follows a Poisson distribution
of parameter <code class="reqn">n</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e_n_q(n, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="e_n_q_+3A_n">n</code></td>
<td>
<p>A positive integer vector.</p>
</td></tr>
<tr><td><code id="e_n_q_+3A_q">q</code></td>
<td>
<p>A positive number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The expectation of <code class="reqn">n^q</code> when <code class="reqn">n</code> follows a Poisson distribution
was derived by Grassberger (1988).
</p>
<p>It is computed using the <a href="base.html#topic+beta">beta</a> function.
Its value is 0 for <code class="reqn">n-q+1&lt;0</code>, and close to 0 when <code class="reqn">n=q</code>,
which is not a correct estimate: it should not be used when <code class="reqn">q &gt; n</code>.
</p>


<h3>Value</h3>

<p>A vector of the same length as n containing the transformed values.
</p>


<h3>References</h3>

<p>Grassberger P (1988).
&ldquo;Finite Sample Corrections to Entropy and Dimension Estimates.&rdquo;
<em>Physics Letters A</em>, <b>128</b>(6-7), 369&ndash;373.
<a href="https://doi.org/10.1016/0375-9601%2888%2990193-4">doi:10.1016/0375-9601(88)90193-4</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 10
q &lt;- 2
# Compare
e_n_q(n, q)
# with (empirical estimation)
mean(rpois(1000, lambda = n)^q)
# and (naive estimation)
n^q

</code></pre>

<hr>
<h2 id='ent_allen'>Allen et al.'s Phylogenetic Entropy of a Community</h2><span id='topic+ent_allen'></span><span id='topic+ent_allen.numeric'></span><span id='topic+ent_allen.species_distribution'></span>

<h3>Description</h3>

<p>Estimate entropy (Allen et al. 2009) from
abundance or probability data and a phylogenetic or functional dendrogram.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_allen(x, tree, ...)

## S3 method for class 'numeric'
ent_allen(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  prune = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_allen(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  prune = FALSE,
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_allen_+3A_x">x</code></td>
<td>
<p>An object, that may be a named numeric vector (names are species names)
containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_prune">prune</code></td>
<td>
<p>What to do when some species are in the tree but not in <code>x</code>?
If <code>TRUE</code>, the tree is pruned to keep species of <code>x</code> only.
The height of the tree may be changed if a pruned branch is related to the root.
If <code>FALSE</code> (default), the length of branches of missing species is not summed
but the height of the tree is never changed.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_allen_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimators to deal with incomplete sampling are not implemented.
Use function <a href="#topic+ent_phylo">ent_phylo</a> with argument if they are needed.
</p>
<p>The phylogenetic entropy is calculated following
Allen et al. (2009) for order <code class="reqn">q=1</code> and
Leinster and Cobbold (2012) for other orders.
The result is identical to the total entropy calculated by
<a href="#topic+ent_phylo">ent_phylo</a>.
It is much faster but no bias correction is available.
</p>
<p>All species of the <code>species_distribution</code> must be found in the tips of the
<code>tree</code>.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Allen B, Kon M, Bar-Yam Y (2009).
&ldquo;A New Phylogenetic Diversity Measure Generalizing the Shannon Index and Its Application to Phyllostomid Bats.&rdquo;
<em>American Naturalist</em>, <b>174</b>(2), 236&ndash;243.
<a href="https://doi.org/10.1086/600101">doi:10.1086/600101</a>.<br /><br /> Leinster T, Cobbold C (2012).
&ldquo;Measuring Diversity: The Importance of Species Similarity.&rdquo;
<em>Ecology</em>, <b>93</b>(3), 477&ndash;489.
<a href="https://doi.org/10.1890/10-2402.1">doi:10.1890/10-2402.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># entropy of each community
ent_allen(paracou_6_abd, tree = paracou_6_taxo)

# gamma entropy
ent_allen(paracou_6_abd, tree = paracou_6_taxo, gamma = TRUE)

</code></pre>

<hr>
<h2 id='ent_gen_simpson'>Generalized Simpson's Entropy</h2><span id='topic+ent_gen_simpson'></span><span id='topic+ent_gen_simpson.numeric'></span><span id='topic+ent_gen_simpson.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the Generalized Simpson's entropy of species from abundance
or probability data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_gen_simpson(x, ...)

## S3 method for class 'numeric'
ent_gen_simpson(
  x,
  k = 1,
  estimator = c("Zhang", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_gen_simpson(
  x,
  k = 1,
  estimator = c("Zhang", "naive"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_gen_simpson_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_k">k</code></td>
<td>
<p>the order of Hurlbert's diversity.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_gen_simpson_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Generalized Simpson's Entropy (Zhang and Zhou 2010) of order <code class="reqn">k</code> is,
in the species accumulation curve,the probability for the individual sampled
in rank <code class="reqn">k + 1</code> to belong to a new species.
It is a measure of diversity so long as <code class="reqn">k</code> is lower than the number
of species (Grabchak et al. 2017).
</p>
<p>Bias correction requires the number of individuals.
It is limited to orders <code class="reqn">r</code> less than or equal to the number of individuals
in the community (Zhang and Grabchak 2016).
</p>
<p>Generalized Simpson's diversity cannot be estimated at a specified level
of interpolation or extrapolation, and diversity partitioning is not available.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>Note</h3>

<p>The unbiased estimator is calculated by the <a href="EntropyEstimation.html#topic+GenSimp.z">EntropyEstimation::GenSimp.z</a>
function of the <strong>EntropyEstimation</strong> package.
</p>


<h3>See Also</h3>

<p><a href="#topic+div_gen_simpson">div_gen_simpson</a>
</p>
<p>#' @references
Grabchak M, Marcon E, Lang G, Zhang Z (2017).
&ldquo;The Generalized Simpson's Entropy Is a Measure of Biodiversity.&rdquo;
<em>Plos One</em>, <b>12</b>(3), e0173305.
<a href="https://doi.org/10.1371/journal.pone.0173305">doi:10.1371/journal.pone.0173305</a>.<br /><br /> Zhang Z, Grabchak M (2016).
&ldquo;Entropic Representation and Estimation of Diversity Indices.&rdquo;
<em>Journal of Nonparametric Statistics</em>, <b>28</b>(3), 563&ndash;575.
<a href="https://doi.org/10.1080/10485252.2016.1190357">doi:10.1080/10485252.2016.1190357</a>.<br /><br /> Zhang Z, Zhou J (2010).
&ldquo;Re-Parameterization of Multinomial Distributions and Diversity Indices.&rdquo;
<em>Journal of Statistical Planning and Inference</em>, <b>140</b>(7), 1731&ndash;1738.
<a href="https://doi.org/10.1016/j.jspi.2009.12.023">doi:10.1016/j.jspi.2009.12.023</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_gen_simpson(paracou_6_abd, k = 50)
# gamma entropy
ent_gen_simpson(paracou_6_abd, k = 50, gamma = TRUE)

</code></pre>

<hr>
<h2 id='ent_hurlbert'>Hurlbert Entropy of a Community</h2><span id='topic+ent_hurlbert'></span><span id='topic+ent_hurlbert.numeric'></span><span id='topic+ent_hurlbert.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the Hurlbert entropy (Hurlbert 1971) of species from abundance or probability data.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_hurlbert(x, k = 2, ...)

## S3 method for class 'numeric'
ent_hurlbert(
  x,
  k = 2,
  estimator = c("Hurlbert", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_hurlbert(
  x,
  k = 2,
  estimator = c("Hurlbert", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_hurlbert_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_hurlbert_+3A_k">k</code></td>
<td>
<p>the order of Hurlbert's diversity.</p>
</td></tr>
<tr><td><code id="ent_hurlbert_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_hurlbert_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_hurlbert_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_hurlbert_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
See <a href="#topic+div_hurlbert">div_hurlbert</a> for estimators.
</p>
<p>Hurlbert's entropy cannot be estimated at a specified level of interpolation or
extrapolation, and entropy partitioning is not available.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Hurlbert SH (1971).
&ldquo;The Nonconcept of Species Diversity: A Critique and Alternative Parameters.&rdquo;
<em>Ecology</em>, <b>52</b>(4), 577&ndash;586.
<a href="https://doi.org/10.2307/1934145">doi:10.2307/1934145</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+div_hurlbert">div_hurlbert</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_hurlbert(paracou_6_abd, k = 2)

</code></pre>

<hr>
<h2 id='ent_phylo'>Phylogenetic Entropy of a Community</h2><span id='topic+ent_phylo'></span><span id='topic+ent_phylo.numeric'></span><span id='topic+ent_phylo.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the entropy of species from abundance or probability data
and a phylogenetic tree.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_phylo(x, tree, q = 1, ...)

## S3 method for class 'numeric'
ent_phylo(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_phylo(
  x,
  tree,
  q = 1,
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_phylo_+3A_x">x</code></td>
<td>
<p>An object, that may be a named numeric vector (names are species names)
containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_phylo_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
See <a href="#topic+div_hill">div_hill</a> for estimators.
</p>
<p>Entropy can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_tsallis">accum_tsallis</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated
entropy.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2)
# Gamma entropy
ent_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2, gamma = TRUE)

# At 80% coverage
ent_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2, level = 0.8)


</code></pre>

<hr>
<h2 id='ent_rao'>Rao's Quadratic Entropy of a Community</h2><span id='topic+ent_rao'></span><span id='topic+ent_rao.numeric'></span><span id='topic+ent_rao.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the quadratic entropy (Rao 1982) of species from
abundance or probability data.
An estimator (Lande 1996) is available to deal with
incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_rao(x, ...)

## S3 method for class 'numeric'
ent_rao(
  x,
  distances = NULL,
  tree = NULL,
  normalize = TRUE,
  estimator = c("Lande", "naive"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_rao(
  x,
  distances = NULL,
  tree = NULL,
  normalize = TRUE,
  estimator = c("Lande", "naive"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_rao_+3A_x">x</code></td>
<td>
<p>An object, that may be a named numeric vector (names are species names)
containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_distances">distances</code></td>
<td>
<p>a distance matrix or an object of class <a href="stats.html#topic+dist">stats::dist</a>.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_rao_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Rao's entropy is phylogenetic or similarity-based entropy of order 2.
<a href="#topic+ent_phylo">ent_phylo</a> and <a href="#topic+ent_similarity">ent_similarity</a> with argument <code>q = 2</code> provide more estimators
and allow estimating entropy at a chosen level.
</p>
<p>All species of the <code>species_distribution</code> must be found in the matrix of
<code>distances</code> if it is named.
If it is not or if <code>x</code> is numeric, its size must equal the number of species.
Then, the order of species is assumed to be the same as that of the
<code>species_distribution</code> or its numeric equivalent.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Lande R (1996).
&ldquo;Statistics and Partitioning of Species Diversity, and Similarity among Multiple Communities.&rdquo;
<em>Oikos</em>, <b>76</b>(1), 5&ndash;13.
<a href="https://doi.org/10.2307/3545743">doi:10.2307/3545743</a>.<br /><br /> Rao CR (1982).
&ldquo;Diversity and Dissimilarity Coefficients: A Unified Approach.&rdquo;
<em>Theoretical Population Biology</em>, <b>21</b>, 24&ndash;43.
<a href="https://doi.org/10.1016/0040-5809%2882%2990004-1">doi:10.1016/0040-5809(82)90004-1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_rao(paracou_6_abd, tree = paracou_6_taxo)
# Similar to (but estimators are not the same)
ent_phylo(paracou_6_abd, tree = paracou_6_taxo, q = 2)

# Functional entropy
ent_rao(paracou_6_abd, distances = paracou_6_fundist)

# gamma entropy
ent_rao(paracou_6_abd, tree = paracou_6_taxo, gamma = TRUE)

</code></pre>

<hr>
<h2 id='ent_shannon'>Shannon's Entropy of a Community</h2><span id='topic+ent_shannon'></span><span id='topic+ent_shannon.numeric'></span><span id='topic+ent_shannon.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the entropy (Shannon 1948) of species from abundance
or probability data.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_shannon(x, ...)

## S3 method for class 'numeric'
ent_shannon(
  x,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Grassberger2003",
    "Holste", "Miller", "Schurmann", "ZhangHz"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_shannon(
  x,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Grassberger2003",
    "Holste", "Miller", "Schurmann", "ZhangHz"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_shannon_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_shannon_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
</p>
<p>See <a href="#topic+div_hill">div_hill</a> for non-specific estimators.
Shannon-specific estimators are from Miller (1955),
Grassberger (2003), Schürmann (2004)
and Zhang (2012).
More estimators can be found in the <strong>entropy</strong> package.
</p>
<p>Entropy can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_tsallis">accum_tsallis</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Grassberger P (2003).
&ldquo;Entropy Estimates from Insufficient Samplings.&rdquo;
<em>arXiv Physics e-prints</em>, <b>0307138</b>(v2).<br /><br /> Miller GA (1955).
&ldquo;Note on the Bias of Information Estimates.&rdquo;
In Quastler H (ed.), <em>Information Theory in Psychology: Problems and Methods</em>, 95&ndash;100.
Free Press, Glencoe, Ill.<br /><br /> Schürmann T (2004).
&ldquo;Bias Analysis in Entropy Estimation.&rdquo;
<em>Journal of Physics A: Mathematical and General</em>, <b>37</b>(27), L295&ndash;L301.
<a href="https://doi.org/10.1088/0305-4470/37/27/L02">doi:10.1088/0305-4470/37/27/L02</a>.<br /><br /> Shannon CE (1948).
&ldquo;A Mathematical Theory of Communication.&rdquo;
<em>The Bell System Technical Journal</em>, <b>27</b>(3), 379&ndash;423, 623&ndash;656.
<a href="https://doi.org/10.1002/j.1538-7305.1948.tb01338.x">doi:10.1002/j.1538-7305.1948.tb01338.x</a>.<br /><br /> Zhang Z (2012).
&ldquo;Entropy Estimation in Turing's Perspective.&rdquo;
<em>Neural Computation</em>, <b>24</b>(5), 1368&ndash;1389.
<a href="https://doi.org/10.1162/NECO_a_00266">doi:10.1162/NECO_a_00266</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_shannon(paracou_6_abd)
# gamma entropy
ent_shannon(paracou_6_abd, gamma = TRUE)

# At 80% coverage
ent_shannon(paracou_6_abd, level = 0.8)

</code></pre>

<hr>
<h2 id='ent_similarity'>Similarity-Based Entropy of a Community</h2><span id='topic+ent_similarity'></span><span id='topic+ent_similarity.numeric'></span><span id='topic+ent_similarity.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the entropy of species from abundance or probability data and a
similarity matrix between species.
Several estimators are available to deal with incomplete sampling.
Bias correction requires the number of individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_similarity(x, similarities, q = 1, ...)

## S3 method for class 'numeric'
ent_similarity(
  x,
  similarities = diag(length(x)),
  q = 1,
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  sample_coverage = NULL,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_similarity(
  x,
  similarities = diag(sum(!colnames(x) %in% non_species_columns)),
  q = 1,
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_similarity_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.
If it is a numeric vector, then its length must equal the dimensions of the
<code>similarities</code> matrix: species are assumed to be in the same order.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_similarities">similarities</code></td>
<td>
<p>a similarity matrix, that can be obtained by <a href="#topic+fun_similarity">fun_similarity</a>.
Its default value is the identity matrix.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_similarity_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All species of the <code>species_distribution</code> must be found in the matrix of
<code>similarities</code> if it is named.
If it is not or if <code>x</code> is numeric, its size must equal the number of species.
Then, the order of species is assumed to be the same as that of the
<code>species_distribution</code> or its numeric equivalent.
</p>
<p>Similarity-Based entropy can't be interpolated of extrapolated as of the
state of the art.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Similarity matrix
Z &lt;- fun_similarity(paracou_6_fundist)
# Diversity of each community
ent_similarity(paracou_6_abd, similarities = Z, q = 2)
# gamma diversity
ent_similarity(paracou_6_abd, similarities = Z, q = 2, gamma = TRUE)

</code></pre>

<hr>
<h2 id='ent_simpson'>Simpson's Entropy of a Community</h2><span id='topic+ent_simpson'></span><span id='topic+ent_simpson.numeric'></span><span id='topic+ent_simpson.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the entropy (Simpson 1949) of species from abundance
or probability data.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_simpson(x, ...)

## S3 method for class 'numeric'
ent_simpson(
  x,
  estimator = c("Lande", "UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_simpson(
  x,
  estimator = c("Lande", "UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_simpson_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_simpson_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
See <a href="#topic+div_hill">div_hill</a> for non-specific estimators.
</p>
<p>Simpson-specific estimator is from Lande (1996).
</p>
<p>Entropy can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_tsallis">accum_tsallis</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.<br /><br /> Lande R (1996).
&ldquo;Statistics and Partitioning of Species Diversity, and Similarity among Multiple Communities.&rdquo;
<em>Oikos</em>, <b>76</b>(1), 5&ndash;13.
<a href="https://doi.org/10.2307/3545743">doi:10.2307/3545743</a>.<br /><br /> Simpson EH (1949).
&ldquo;Measurement of Diversity.&rdquo;
<em>Nature</em>, <b>163</b>(4148), 688.
<a href="https://doi.org/10.1038/163688a0">doi:10.1038/163688a0</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_simpson(paracou_6_abd)
# gamma entropy
ent_simpson(paracou_6_abd, gamma = TRUE)

# At 80% coverage
ent_simpson(paracou_6_abd, level = 0.8)

</code></pre>

<hr>
<h2 id='ent_sp_simpson'>Spatially Explicit Simpson's Entropy</h2><span id='topic+ent_sp_simpson'></span><span id='topic+ent_sp_simpsonEnvelope'></span>

<h3>Description</h3>

<p>Simpson's entropy of the neighborhood of individuals,
up to a distance (Shimatani 2001).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_sp_simpson(
  X,
  r = NULL,
  correction = c("isotropic", "translate", "none"),
  check_arguments = TRUE
)

ent_sp_simpsonEnvelope(
  X,
  r = NULL,
  n_simulations = 100,
  alpha = 0.05,
  correction = c("isotropic", "translate", "none"),
  h0 = c("RandomPosition", "RandomLabeling"),
  global = FALSE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_sp_simpson_+3A_x">X</code></td>
<td>
<p>a spatialized community
(A <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object with <code>PointType</code> values as species names.)</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_r">r</code></td>
<td>
<p>a vector of distances.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_correction">correction</code></td>
<td>
<p>the edge-effect correction to apply when estimating
the number of neighbors or the <em>K</em> function with <a href="spatstat.explore.html#topic+Kest">spatstat.explore::Kest</a>.
Default is &quot;isotropic&quot;.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_n_simulations">n_simulations</code></td>
<td>
<p>the number of simulations used to estimate the confidence envelope.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_alpha">alpha</code></td>
<td>
<p>the risk level, 5% by default.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_h0">h0</code></td>
<td>
<p>A string describing the null hypothesis to simulate.
The null hypothesis may be &quot;RandomPosition&quot;: points are drawn in a Poisson process (default)
or &quot;RandomLabeling&quot;: randomizes point types, keeping locations unchanged.</p>
</td></tr>
<tr><td><code id="ent_sp_simpson_+3A_global">global</code></td>
<td>
<p>if <code>TRUE</code>, a global envelope sensu (Duranton and Overman 2005) is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>ent_sp_simpson</code> returns an object of class <code>fv</code>,
see <a href="spatstat.explore.html#topic+fv.object">spatstat.explore::fv.object</a>.
There are methods to print and plot this class.
It contains the value of the spatially explicit Simpson's entropy
for each distance in <code>r</code>.
</p>
<p><code>ent_sp_simpsonEnvelope</code> returns an envelope object <a href="spatstat.explore.html#topic+envelope">spatstat.explore::envelope</a>.
There are methods to print and plot this class.
It contains the observed value of the function,
its average simulated value and the confidence envelope.
</p>


<h3>References</h3>

<p>Duranton G, Overman HG (2005).
&ldquo;Testing for Localisation Using Micro-Geographic Data.&rdquo;
<em>Review of Economic Studies</em>, <b>72</b>(4), 1077&ndash;1106.
<a href="https://doi.org/10.1111/0034-6527.00362">doi:10.1111/0034-6527.00362</a>.<br /><br /> Shimatani K (2001).
&ldquo;Multivariate Point Processes and Spatial Variation of Species Diversity.&rdquo;
<em>Forest Ecology and Management</em>, <b>142</b>(1-3), 215&ndash;229.
<a href="https://doi.org/10.1016/s0378-1127%2800%2900352-2">doi:10.1016/s0378-1127(00)00352-2</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a random community
X &lt;- rspcommunity(1, size = 1000, species_number = 3)
# Calculate the entropy and plot it
autoplot(ent_sp_simpson(X))

# Generate a random community
X &lt;- rspcommunity(1, size = 100, species_number = 3)
# Calculate the entropy and plot it
autoplot(ent_sp_simpsonEnvelope(X, n_simulations = 10))

</code></pre>

<hr>
<h2 id='ent_tsallis'>Tsallis Entropy of a Community</h2><span id='topic+ent_tsallis'></span><span id='topic+ent_tsallis.numeric'></span><span id='topic+ent_tsallis.species_distribution'></span>

<h3>Description</h3>

<p>Estimate the entropy of species from abundance or probability data.
Several estimators are available to deal with incomplete sampling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ent_tsallis(x, q = 1, ...)

## S3 method for class 'numeric'
ent_tsallis(
  x,
  q = 1,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  sample_coverage = NULL,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
ent_tsallis(
  x,
  q = 1,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Marcon",
    "UnveilC", "UnveiliC", "ZhangGrabchak", "naive", "Bonachela", "Holste"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ent_tsallis_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_q">q</code></td>
<td>
<p>a number: the order of diversity.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="ent_tsallis_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Bias correction requires the number of individuals.
See <a href="#topic+div_hill">div_hill</a> for estimators.
</p>
<p>Entropy can be estimated at a specified level of interpolation or
extrapolation, either a chosen sample size or sample coverage
(Chao et al. 2014), rather than its asymptotic value.
See <a href="#topic+accum_tsallis">accum_tsallis</a> for details.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated entropy.
</p>


<h3>References</h3>

<p>Chao A, Gotelli NJ, Hsieh TC, Sander EL, Ma KH, Colwell RK, Ellison AM (2014).
&ldquo;Rarefaction and Extrapolation with Hill Numbers: A Framework for Sampling and Estimation in Species Diversity Studies.&rdquo;
<em>Ecological Monographs</em>, <b>84</b>(1), 45&ndash;67.
<a href="https://doi.org/10.1890/13-0133.1">doi:10.1890/13-0133.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Entropy of each community
ent_tsallis(paracou_6_abd, q = 2)
# gamma entropy
ent_tsallis(paracou_6_abd, q = 2, gamma = TRUE)

# At 80% coverage
ent_tsallis(paracou_6_abd, level = 0.8)

</code></pre>

<hr>
<h2 id='exp_q'>Deformed exponential</h2><span id='topic+exp_q'></span>

<h3>Description</h3>

<p>Calculate the deformed exponential of order <em>q</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exp_q(x, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exp_q_+3A_x">x</code></td>
<td>
<p>A numeric vector or array.</p>
</td></tr>
<tr><td><code id="exp_q_+3A_q">q</code></td>
<td>
<p>A number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deformed exponential is the reciprocal of the deformed logarithm
(Tsallis 1994), see <a href="#topic+ln_q">ln_q</a>.
It is defined as <code class="reqn">(x(1-q)+1)^{\frac{1}{(1-q)}}</code>.
</p>
<p>For <code class="reqn">q&gt;1</code>, <code class="reqn">\ln_q{(+\infty)}=\frac{1}{(q-1)}</code>
so <code class="reqn">\exp_q{(x)}</code> is not defined for <code class="reqn">x&gt;\frac{1}{(q-1)}</code>.
When <code>x</code> is very close to this value, the exponential is severely subject
to rounding errors.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> containing the transformed values.
</p>


<h3>References</h3>

<p>Tsallis C (1994).
&ldquo;What Are the Numbers That Experiments Provide?&rdquo;
<em>Química Nova</em>, <b>17</b>(6), 468&ndash;471.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(exp_q(x, q = 0), from = -5, to = 0, lty = 2)
curve(exp(x), from = -5, to = 0, lty= 1, add = TRUE)
curve(exp_q(x, q = 2), from = -5, to = 0, lty = 3, add = TRUE)
legend("bottomright",
  legend = c(
    expression(exp[0](x)),
    expression(exp(x)),
    expression(exp[2](x))
  ),
  lty = c(2, 1, 3),
  inset = 0.02
)

</code></pre>

<hr>
<h2 id='fit_rac'>Fit a distribution</h2><span id='topic+fit_rac'></span><span id='topic+fit_rac.numeric'></span><span id='topic+fit_rac.species_distribution'></span>

<h3>Description</h3>

<p>Fit a well-known distribution to a species distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_rac(x, ...)

## S3 method for class 'numeric'
fit_rac(
  x,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
fit_rac(
  x,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_rac_+3A_x">x</code></td>
<td>
<p>An object</p>
</td></tr>
<tr><td><code id="fit_rac_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="fit_rac_+3A_distribution">distribution</code></td>
<td>
<p>The distribution of species abundances.
May be &quot;lnorm&quot; (log-normal), &quot;lseries&quot; (log-series), &quot;geom&quot; (geometric) or
&quot;bstick&quot; (broken stick).</p>
</td></tr>
<tr><td><code id="fit_rac_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><a href="#topic+abundances">abundances</a> can be used to fit rank-abundance curves (RAC) of classical
distributions:
</p>

<ul>
<li><p> &quot;lnorm&quot; for log-normal (Preston 1948).
</p>
</li>
<li><p> &quot;lseries&quot; for log-series (Fisher et al. 1943).
</p>
</li>
<li><p> &quot;geom&quot; for geometric (Motomura 1932).
</p>
</li>
<li><p> &quot;bstick&quot; for broken stick (MacArthur 1957).
It has no parameter, so the maximum abundance is returned.
</p>
</li></ul>



<h3>Value</h3>

<p>A tibble with the sites and the estimated distribution parameters.
</p>


<h3>References</h3>

<p>Fisher RA, Corbet AS, Williams CB (1943).
&ldquo;The Relation between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population.&rdquo;
<em>Journal of Animal Ecology</em>, <b>12</b>, 42&ndash;58.
<a href="https://doi.org/10.2307/1411">doi:10.2307/1411</a>.<br /><br /> MacArthur RH (1957).
&ldquo;On the Relative Abundance of Bird Species.&rdquo;
<em>Proceedings of the National Academy of Sciences of the United States of America</em>, <b>43</b>(3), 293&ndash;295.
<a href="https://doi.org/10.1073/pnas.43.3.293">doi:10.1073/pnas.43.3.293</a>, 89566.<br /><br /> Motomura I (1932).
&ldquo;On the statistical treatment of communities.&rdquo;
<em>Zoological Magazine</em>, <b>44</b>, 379&ndash;383.<br /><br /> Preston FW (1948).
&ldquo;The Commonness, and Rarity, of Species.&rdquo;
<em>Ecology</em>, <b>29</b>(3), 254&ndash;283.
<a href="https://doi.org/10.2307/1930989">doi:10.2307/1930989</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fit_rac(paracou_6_abd, distribution = "lnorm")

</code></pre>

<hr>
<h2 id='fun_ordinariness'>Functional ordinariness of a community</h2><span id='topic+fun_ordinariness'></span>

<h3>Description</h3>

<p>The ordinariness of a species is the average similarity of its individuals
with others (Leinster and Cobbold 2012).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fun_ordinariness(
  species_distribution,
  similarities = diag(sum(!colnames(species_distribution) %in% non_species_columns)),
  as_numeric = FALSE,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fun_ordinariness_+3A_species_distribution">species_distribution</code></td>
<td>
<p>an object of class <a href="#topic+species_distribution">species_distribution</a>.</p>
</td></tr>
<tr><td><code id="fun_ordinariness_+3A_similarities">similarities</code></td>
<td>
<p>a similarity matrix, that can be obtained by <a href="#topic+fun_similarity">fun_similarity</a>.
Its default value is the identity matrix.</p>
</td></tr>
<tr><td><code id="fun_ordinariness_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="fun_ordinariness_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All species of the <code>species_distribution</code> must be found in the matrix of
<code>similarities</code> if it is named.
If it is not, its size must equal the number of species.
Then, the order of species is assumed to be the same as that of the
<code>species_distribution</code>.
</p>


<h3>Value</h3>

<p>A tibble with the ordinariness of each species, or a matrix if
argument <code>as_numeric</code> is <code>TRUE</code>.
</p>


<h3>References</h3>

<p>Leinster T, Cobbold C (2012).
&ldquo;Measuring Diversity: The Importance of Species Similarity.&rdquo;
<em>Ecology</em>, <b>93</b>(3), 477&ndash;489.
<a href="https://doi.org/10.1890/10-2402.1">doi:10.1890/10-2402.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fun_ordinariness(paracou_6_abd, fun_similarity(paracou_6_fundist))

# Compare with probabilities
probabilities(paracou_6_abd)
# Decrease similarities so that ordinariness is close to probability
fun_ordinariness(paracou_6_abd, fun_similarity(paracou_6_fundist, rate = 100))

</code></pre>

<hr>
<h2 id='fun_similarity'>Functional similarity</h2><span id='topic+fun_similarity'></span>

<h3>Description</h3>

<p>Transform a distance matrix into a similarity matrix
(Leinster and Cobbold 2012).
Similarity between two species is defined either by a negative exponential
function of their distance or by the complement to 1 of their normalized
distance (such that the most distant species are 1 apart).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fun_similarity(distances, exponential = TRUE, rate = 1, check_arguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fun_similarity_+3A_distances">distances</code></td>
<td>
<p>a distance matrix or an object of class <a href="stats.html#topic+dist">stats::dist</a>.</p>
</td></tr>
<tr><td><code id="fun_similarity_+3A_exponential">exponential</code></td>
<td>
<p>If <code>TRUE</code>, similarity is <code class="reqn">e^{-r \delta}</code>,
where <code class="reqn">r</code> is argument <code>rate</code>.
If <code>FALSE</code>, it is <code class="reqn">1 - \delta / \max(\delta)</code>.</p>
</td></tr>
<tr><td><code id="fun_similarity_+3A_rate">rate</code></td>
<td>
<p>the decay rate of the exponential similarity.</p>
</td></tr>
<tr><td><code id="fun_similarity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A similarity matrix.
</p>


<h3>References</h3>

<p>Leinster T, Cobbold C (2012).
&ldquo;Measuring Diversity: The Importance of Species Similarity.&rdquo;
<em>Ecology</em>, <b>93</b>(3), 477&ndash;489.
<a href="https://doi.org/10.1890/10-2402.1">doi:10.1890/10-2402.1</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Similarity between Paracou 6 species
hist(fun_similarity(paracou_6_fundist))

</code></pre>

<hr>
<h2 id='ln_q'>Deformed logarithm</h2><span id='topic+ln_q'></span>

<h3>Description</h3>

<p>Calculate the deformed logarithm of order <em>q</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ln_q(x, q)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ln_q_+3A_x">x</code></td>
<td>
<p>A numeric vector or array.</p>
</td></tr>
<tr><td><code id="ln_q_+3A_q">q</code></td>
<td>
<p>A number.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The deformed logarithm (Tsallis 1994) is defined as
<code class="reqn">\ln_q{x}=\frac{(x^{(1-q)}-1)}{(1-q)}</code>.
</p>
<p>The shape of the deformed logarithm is similar to that of the regular one.
<code class="reqn">\ln_1{x}=\log{x}</code>.
</p>
<p>For <code class="reqn">q&gt;1</code>, <code class="reqn">\ln_q{(+\infty)}=\frac{1}{(q-1)}</code>.
</p>


<h3>Value</h3>

<p>A vector of the same length as <code>x</code> containing the transformed values.
</p>


<h3>References</h3>

<p>Tsallis C (1994).
&ldquo;What Are the Numbers That Experiments Provide?&rdquo;
<em>Química Nova</em>, <b>17</b>(6), 468&ndash;471.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>curve(ln_q(1/ x, q = 0), 0, 1, lty = 2, ylab = "Logarithm", ylim = c(0, 10))
curve(log(1 / x), 0, 1, lty = 1, n =1E4, add = TRUE)
curve(ln_q(1 / x, q = 2), 0, 1, lty = 3, add = TRUE)
legend("topright",
  legend = c(
    expression(ln[0](1/x)),
    expression(log(1/x)),
    expression(ln[2](1/x))
  ),
  lty = c(2, 1, 3),
  inset = 0.02
 )

</code></pre>

<hr>
<h2 id='metacommunity'>Aggregate communities into a metacommunity</h2><span id='topic+metacommunity'></span><span id='topic+metacommunity.matrix'></span><span id='topic+metacommunity.abundances'></span>

<h3>Description</h3>

<p>Abundances of communities are summed according to their weights to obtain
the abundances of the metacommunity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>metacommunity(x, name = "metacommunity", ...)

## S3 method for class 'matrix'
metacommunity(
  x,
  name = "metacommunity",
  weights = rep(1, nrow(x)),
  as_numeric = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
metacommunity(
  x,
  name = "metacommunity",
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="metacommunity_+3A_x">x</code></td>
<td>
<p>An object of class <a href="#topic+abundances">abundances</a> that contains several communities or
a matrix of abundances with communities in rows and species in columns.</p>
</td></tr>
<tr><td><code id="metacommunity_+3A_name">name</code></td>
<td>
<p>The name of the metacommunity</p>
</td></tr>
<tr><td><code id="metacommunity_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="metacommunity_+3A_weights">weights</code></td>
<td>
<p>the weights of the sites of the species distributions.</p>
</td></tr>
<tr><td><code id="metacommunity_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="metacommunity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The total abundance of the metacommunity is by design equal to the sum
of community abundances so that the information used by diversity estimators.
A consequence is that equal weights lead to a metacommunity whose species
abundances are the sum of community species abundances.
</p>
<p>If community weights are not equal then the metacommunity abundances are
in general not integer.
Most diversity estimators can't be applied to non-integer abundances but the knowledge
of the sample coverage of each community allow &quot;ChaoShen&quot; and &quot;Grassberger&quot;
estimators.
</p>


<h3>Value</h3>

<p>An object of class <a href="#topic+abundances">abundances</a> with a single row or a named vector
if <code>as_numeric = TRUE</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>metacommunity(paracou_6_abd)

</code></pre>

<hr>
<h2 id='mock_3sp'>Mock data</h2><span id='topic+mock_3sp'></span><span id='topic+mock_3sp_abd'></span><span id='topic+mock_3sp_dist'></span><span id='topic+mock_3sp_tree'></span>

<h3>Description</h3>

<p>A simple dataset to test diversity functions.
It contains 3 species with their abundances, their distance matrix and
their phylogenetic tree.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mock_3sp_abd

mock_3sp_dist

mock_3sp_tree
</code></pre>


<h3>Format</h3>

<p><code>mock_3sp_abd</code> is a vector, <code>mock_3sp_dist</code> a matrix and
<code>mock_3sp_tree</code> an object of class <a href="ape.html#topic+read.tree">ape::phylo</a>.
</p>
<p>An object of class <code>dist</code> of length 3.
</p>
<p>An object of class <code>phylo</code> of length 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>mock_3sp_abd
mock_3sp_dist
plot(mock_3sp_tree)
axis(2)

</code></pre>

<hr>
<h2 id='non_species_columns'>Non-Species columns</h2><span id='topic+non_species_columns'></span>

<h3>Description</h3>

<p>The column names that are not those of species in a <a href="#topic+species_distribution">species_distribution</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>non_species_columns
</code></pre>


<h3>Format</h3>

<p>A character vector.
</p>


<h3>Details</h3>

<p>Objects of classes <a href="#topic+abundances">abundances</a> and <a href="#topic+probabilities">probabilities</a>, that are also of class
<a href="#topic+species_distribution">species_distribution</a>, have columns named after the species they contain.
Some columns are reserved to describe the plots and their diversity.
</p>

<hr>
<h2 id='paracou_6'>Paracou plot 6</h2><span id='topic+paracou_6'></span><span id='topic+paracou_6_abd'></span><span id='topic+paracou_6_wmppp'></span>

<h3>Description</h3>

<p>A community assembly.
It contains number of trees per species of the plot #6 of Paracou.
The plot covers 6.25 ha of tropical rainforest, divided into 4 equally-sized subplots.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paracou_6_abd

paracou_6_wmppp
</code></pre>


<h3>Format</h3>

<p><code>paracou_6_abd</code> is an object of class <a href="#topic+abundances">abundances</a>, which is also a <a href="tibble.html#topic+tibble">tibble::tibble</a>.
Each line of the tibble is a subplot.
<code>paracou_6_wmppp</code> is a <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object, i.e. a weighted, marked planar point pattern.
</p>
<p>An object of class <code>wmppp</code> (inherits from <code>ppp</code>) of length 6.
</p>


<h3>Details</h3>

<p>In <code>paracou_6_abd</code> (a tibble), the &quot;site&quot; column contains the subplot number, &quot;weight&quot; contains its area and all others columns contain a species.
Data are the number of trees above 10 cm diameter at breast height (DBH).
</p>
<p>In <code>paracou_6_wmppp</code> (a point pattern), the point type is tree species and the point weight is their basal area, in square centimeters.
</p>
<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou: <a href="https://paracou.cirad.fr/">https://paracou.cirad.fr/</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+paracou_6_taxo">paracou_6_taxo</a>, <a href="#topic+paracou_6_fundist">paracou_6_fundist</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Rank-abundance curve of the species of the whole plot
autoplot(metacommunity(paracou_6_abd))

</code></pre>

<hr>
<h2 id='paracou_6_fundist'>Functional distances between Paracou plot 6 species</h2><span id='topic+paracou_6_fundist'></span>

<h3>Description</h3>

<p>A functional distance matrix of species of the dataset <a href="#topic+paracou_6_abd">paracou_6_abd</a>.
Distances were computed from a trait dataset including specific leaf area,
wood density, seed mass and 95th percentile of height. Gower's metric
(Gower 1971) was used to obtain a distance matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paracou_6_fundist
</code></pre>


<h3>Format</h3>

<p>A matrix.
</p>


<h3>Details</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou: <a href="https://paracou.cirad.fr/">https://paracou.cirad.fr/</a>
</p>


<h3>References</h3>

<p>Gower JC (1971).
&ldquo;A General Coefficient of Similarity and Some of Its Properties.&rdquo;
<em>Biometrics</em>, <b>27</b>(4), 857&ndash;871.
<a href="https://doi.org/10.2307/2528823">doi:10.2307/2528823</a>.
</p>


<h3>See Also</h3>

<p><a href="#topic+paracou_6_abd">paracou_6_abd</a>, <a href="#topic+paracou_6_taxo">paracou_6_taxo</a>
</p>

<hr>
<h2 id='paracou_6_taxo'>Taxonomy of Paracou plot 6 species</h2><span id='topic+paracou_6_taxo'></span>

<h3>Description</h3>

<p>The taxonomy of species of the dataset <a href="#topic+paracou_6_abd">paracou_6_abd</a>.
Distances in the tree are 1 (different species of the same genus),
2 (same family) or 3 (different families).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paracou_6_taxo
</code></pre>


<h3>Format</h3>

<p>An object of class <a href="ape.html#topic+read.tree">ape::phylo</a>, which is a phylogenetic tree.
</p>


<h3>Details</h3>

<p>This dataset is from Paracou field station, French Guiana, managed by <a href="https://www.cirad.fr">Cirad</a>.
</p>


<h3>Source</h3>

<p>Permanent data census of Paracou: <a href="https://paracou.cirad.fr/">https://paracou.cirad.fr/</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+paracou_6_abd">paracou_6_abd</a>, <a href="#topic+paracou_6_fundist">paracou_6_fundist</a>
</p>

<hr>
<h2 id='phylo_divent'>Class phylo_divent</h2><span id='topic+phylo_divent'></span><span id='topic+as_phylo_divent'></span><span id='topic+is_phylo_divent'></span>

<h3>Description</h3>

<p>Methods for dendrograms of class &quot;phylo_divent&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_phylo_divent(tree)

is_phylo_divent(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phylo_divent_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="phylo_divent_+3A_x">x</code></td>
<td>
<p>An object of class &quot;phylo_divent&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>as_phylo_divent</code> calculates cuts and intervals of a phylogenetic tree and makes
it available both in <a href="stats.html#topic+hclust">stats::hclust</a> and <a href="ape.html#topic+read.tree">ape::phylo</a> formats.
The conversion preprocesses the tree: it calculates cuts so that the tree
can be reused efficiently by phylodiversity functions.
</p>


<h3>Value</h3>

<p><code>as_phylo_divent</code> returns a phylogenetic tree that is an object of
class &quot;phylo_divent&quot;.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Paracou plot 6 species taxonomy
tree &lt;- as_phylo_divent(mock_3sp_tree)
plot(tree)

</code></pre>

<hr>
<h2 id='plot.phylo_divent'>Plot phylo_divent Objects</h2><span id='topic+plot.phylo_divent'></span>

<h3>Description</h3>

<p>Plot objects of class &quot;phylo_divent&quot; produced by <a href="#topic+as_phylo_divent">as_phylo_divent</a>, that are
phylogenetic trees.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'phylo_divent'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.phylo_divent_+3A_x">x</code></td>
<td>
<p>An object of class &quot;phylo_divent&quot;.</p>
</td></tr>
<tr><td><code id="plot.phylo_divent_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="stats.html#topic+dendrogram">stats::plot.dendrogram</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>. Called for side effects.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Paracou plot 6 species taxonomy
tree &lt;- as_phylo_divent(paracou_6_taxo)
plot(tree, leaflab = "none")

</code></pre>

<hr>
<h2 id='plot.species_distribution'>Plot Profile Objects</h2><span id='topic+plot.species_distribution'></span><span id='topic+autoplot.species_distribution'></span>

<h3>Description</h3>

<p>Plot objects of class &quot;species_distribution&quot; produced by
<a href="#topic+species_distribution">species_distribution</a> and similar functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'species_distribution'
plot(
  x,
  type = c("RAC", "Metacommunity"),
  ...,
  fit_rac = FALSE,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  ylog = "y",
  main = NULL,
  xlab = "Rank",
  ylab = NULL,
  palette = "Set1"
)

## S3 method for class 'species_distribution'
autoplot(
  object,
  ...,
  fit_rac = FALSE,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  ylog = TRUE,
  main = NULL,
  xlab = "Rank",
  ylab = NULL,
  pch = 19,
  cex = 1.5
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.species_distribution_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_type">type</code></td>
<td>
<p>The type of plot. &quot;RAC&quot; (Rank-abundance curve, or Whittaker plot)
or &quot;Metacommunity&quot; to represent species abundances of each community along
with those of the metacommunity.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <a href="base.html#topic+plot">plot</a>. Unused elsewhere.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_fit_rac">fit_rac</code></td>
<td>
<p>If <code>TRUE</code>, estimate a theoretical distribution and fit the data with it.
RAC plot only.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_distribution">distribution</code></td>
<td>
<p>The distribution of species abundances.
May be &quot;lnorm&quot; (log-normal), &quot;lseries&quot; (log-series), &quot;geom&quot; (geometric) or
&quot;bstick&quot; (broken stick).
RAC plot only.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_ylog">ylog</code></td>
<td>
<p>If <code>TRUE</code>, the Y-axis is in log-scale.
RAC plot only.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_main">main</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_xlab">xlab</code></td>
<td>
<p>The label of the X-axis.
RAC plot only.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_ylab">ylab</code></td>
<td>
<p>The  label of the Y-axis.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_palette">palette</code></td>
<td>
<p>The name of a color palette, recognized by <a href="RColorBrewer.html#topic+ColorBrewer">RColorBrewer::brewer.pal</a>.
RAC plot only.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_object">object</code></td>
<td>
<p>An object of class <a href="#topic+species_distribution">species_distribution</a>.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_pch">pch</code></td>
<td>
<p>The plotting characters. See <a href="graphics.html#topic+points">graphics::points</a>.</p>
</td></tr>
<tr><td><code id="plot.species_distribution_+3A_cex">cex</code></td>
<td>
<p>The character expansion (size) of the points. See <a href="graphics.html#topic+points">graphics::points</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>NULL</code>. Called for side effects.
</p>

<hr>
<h2 id='probabilities'>Probabilities of Species</h2><span id='topic+probabilities'></span><span id='topic+probabilities.numeric'></span><span id='topic+probabilities.abundances'></span>

<h3>Description</h3>

<p>Estimate actual probabilities of species from a sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>probabilities(x, ...)

## S3 method for class 'numeric'
probabilities(
  x,
  estimator = c("naive", "Chao2013", "Chao2015", "ChaoShen"),
  unveiling = c("none", "uniform", "geometric"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q = 0,
  as_numeric = FALSE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'abundances'
probabilities(
  x,
  estimator = c("naive", "Chao2013", "Chao2015", "ChaoShen"),
  unveiling = c("none", "uniform", "geometric"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "rarefy", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q = 0,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="probabilities_+3A_x">x</code></td>
<td>
<p>An object. It may be:
</p>

<ul>
<li><p> a numeric vector containing abundances. It may be named to track species names.
</p>
</li>
<li><p> an object of class <a href="#topic+species_distribution">species_distribution</a>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="probabilities_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_estimator">estimator</code></td>
<td>
<p>One of the estimators of a probability distribution:
&quot;naive&quot; (the default value), or &quot;Chao2013&quot;, &quot;Chao2015&quot;, &quot;ChaoShen&quot; to estimate
the probabilities of the observed species in the asymptotic distribution.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_unveiling">unveiling</code></td>
<td>
<p>One of the possible unveiling methods to estimate the probabilities
of the unobserved species: &quot;none&quot; (default, no species is added), &quot;uniform&quot;
(all unobserved species have the same probability) or &quot;geometric&quot; (the
unobserved species distribution is geometric).</p>
</td></tr>
<tr><td><code id="probabilities_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>An estimator of richness to evaluate the total number
of species. &quot;jackknife&quot; is the default value.
An alternative is &quot;rarefy&quot; to estimate the number of species such that the
entropy of the asymptotic distribution rarefied to the observed sample size equals
the actual entropy of the data.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_q">q</code></td>
<td>
<p>The order of diversity. Default is 0 for richness.
Used only to estimate asymptotic probability distributions when argument
<code>richness_estimator</code> is &quot;rarefy&quot;. Then, the number of unobserved species is
fitted so that the entropy of order q of the asymptotic probability distribution
at the observed sample size equals the actual entropy of the data.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="probabilities_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>probabilities()</code> estimates a probability distribution from a sample.
If the <code>estimator</code> is not &quot;naive&quot;, the observed abundance distribution is used
to estimate the actual probability distribution.
The list of species is changed:
zero-abundance species are cleared, and some unobserved species are added.
First, observed species probabilities are estimated following
Chao and Shen (2003), i.e. input probabilities are multiplied by
the sample coverage, or according to more sophisticated models:
Chao et al. (2013), a single-parameter model, or
Chao and Jost (2015), a two-parameter model.
The total probability of observed species equals the sample coverage.
Then, the distribution of unobserved species can be unveiled: their number
is estimated according to the <code>richness_estimator</code>.
The coverage deficit (1 minus the sample coverage) is shared by the unobserved
species equally (<code>unveiling</code> = &quot;uniform&quot;, (Chao et al. 2013)) or
according to a geometric distribution (<code>unveiling</code> = &quot;geometric&quot;, (Chao and Jost 2015)).
</p>


<h3>Value</h3>

<p>An object of class &quot;probabilities&quot;, which is a <a href="#topic+species_distribution">species_distribution</a>
or a numeric vector with argument <code>as_numeric = TRUE</code>.
</p>


<h3>References</h3>

<p>Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Shen T (2003).
&ldquo;Nonparametric Estimation of Shannon's Index of Diversity When There Are Unseen Species in Sample.&rdquo;
<em>Environmental and Ecological Statistics</em>, <b>10</b>(4), 429&ndash;443.
<a href="https://doi.org/10.1023/A%3A1026096204727">doi:10.1023/A:1026096204727</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Just transform abundances into probabilities
probabilities(paracou_6_abd)
# Estimate the distribution of probabilities from observed abundances (unveiled probabilities)
prob_unv &lt;- probabilities(
  paracou_6_abd,
  estimator = "Chao2015",
  unveiling = "geometric",
  richness_estimator = "jackknife"
)
# Estimate entropy from the unveiled probabilities
ent_shannon(prob_unv)
# Identical to
ent_shannon(paracou_6_abd, estimator = "UnveilJ")

</code></pre>

<hr>
<h2 id='profile_hill'>Diversity Profile of a Community</h2><span id='topic+profile_hill'></span><span id='topic+profile_hill.numeric'></span><span id='topic+profile_hill.species_distribution'></span>

<h3>Description</h3>

<p>Calculate the diversity profile of a community, i.e. diversity (Hill numbers)
against its order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_hill(x, orders = seq(from = 0, to = 2, by = 0.1), ...)

## S3 method for class 'numeric'
profile_hill(
  x,
  orders = seq(from = 0, to = 2, by = 0.1),
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Holste",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q_threshold = 10,
  sample_coverage = NULL,
  as_numeric = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
profile_hill(
  x,
  orders = seq(from = 0, to = 2, by = 0.1),
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Holste",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  q_threshold = 10,
  gamma = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_hill_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_orders">orders</code></td>
<td>
<p>The orders of diversity used to build the profile.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_q_threshold">q_threshold</code></td>
<td>
<p>the value of <code>q</code> above which diversity is computed
directly with the naive estimator <code class="reqn">(\sum{p_s^q}^{\frac{1}{(1-q)}}</code>,
without computing entropy.
When <code>q</code> is great, the exponential of entropy goes to <code class="reqn">0^{\frac{1}{(1-q)}}</code>,
causing rounding errors while the naive estimator of diversity is less and
less biased.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_n_simulations">n_simulations</code></td>
<td>
<p>The number of simulations used to estimate the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_alpha">alpha</code></td>
<td>
<p>The risk level, 5% by default, of the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_bootstrap">bootstrap</code></td>
<td>
<p>the method used to obtain the probabilities to generate
bootstrapped communities from observed abundances.
If &quot;Marcon2012&quot;, the probabilities are simply the abundances divided by the total
number of individuals (Marcon et al. 2012).
If &quot;Chao2013&quot; or &quot;Chao2015&quot; (by default), a more sophisticated approach is used
(see <a href="#topic+as_probabilities">as_probabilities</a>) following Chao et al. (2013) or
Chao and Jost (2015).</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="profile_hill_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A bootstrap confidence interval can be produced by simulating communities
(their number is <code>n_simulations</code>) with <a href="#topic+rcommunity">rcommunity</a> and calculating their profiles.
Simulating communities implies a downward bias in the estimation:
rare species of the actual community may have abundance zero in simulated communities.
Simulated diversity values are recentered so that their mean is that of the actual community.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity at each order.
This is an object of class &quot;profile&quot; that can be plotted.
</p>


<h3>References</h3>

<p>Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.<br /><br /> Marcon E, Hérault B, Baraloto C, Lang G (2012).
&ldquo;The Decomposition of Shannon's Entropy and a Confidence Interval for <em>Beta</em> Diversity.&rdquo;
<em>Oikos</em>, <b>121</b>(4), 516&ndash;522.
<a href="https://doi.org/10.1111/j.1600-0706.2011.19267.x">doi:10.1111/j.1600-0706.2011.19267.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>autoplot(profile_hill(paracou_6_abd))

</code></pre>

<hr>
<h2 id='profile_phylo'>Phylogenetic Diversity Profile of a Community</h2><span id='topic+profile_phylo'></span><span id='topic+profile_phylo.numeric'></span><span id='topic+profile_phylo.species_distribution'></span>

<h3>Description</h3>

<p>Calculate the diversity profile of a community, i.e. its phylogenetic diversity
against its order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_phylo(x, tree, orders = seq(from = 0, to = 2, by = 0.1), ...)

## S3 method for class 'numeric'
profile_phylo(
  x,
  tree,
  orders = seq(from = 0, to = 2, by = 0.1),
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Holste",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  sample_coverage = NULL,
  as_numeric = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
profile_phylo(
  x,
  tree,
  orders = seq(from = 0, to = 2, by = 0.1),
  normalize = TRUE,
  estimator = c("UnveilJ", "ChaoJost", "ChaoShen", "GenCov", "Grassberger", "Holste",
    "Marcon", "UnveilC", "UnveiliC", "ZhangGrabchak", "naive"),
  level = NULL,
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_phylo_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_tree">tree</code></td>
<td>
<p>an ultrametric, phylogenetic tree.
May be an object of class <a href="#topic+phylo_divent">phylo_divent</a>, <a href="ape.html#topic+read.tree">ape::phylo</a>, <a href="ade4.html#topic+phylog">ade4::phylog</a> or <a href="stats.html#topic+hclust">stats::hclust</a>.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_orders">orders</code></td>
<td>
<p>The orders of diversity used to build the profile.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_normalize">normalize</code></td>
<td>
<p>if <code>TRUE</code>, phylogenetic is normalized: the height of the tree is set to 1.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_level">level</code></td>
<td>
<p>the level of interpolation or extrapolation.
It may be a sample size (an integer) or a sample coverage
(a number between 0 and 1).
If not <code>NULL</code>, the asymptotic <code>estimator</code> is ignored.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_n_simulations">n_simulations</code></td>
<td>
<p>The number of simulations used to estimate the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_alpha">alpha</code></td>
<td>
<p>The risk level, 5% by default, of the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_bootstrap">bootstrap</code></td>
<td>
<p>the method used to obtain the probabilities to generate
bootstrapped communities from observed abundances.
If &quot;Marcon2012&quot;, the probabilities are simply the abundances divided by the total
number of individuals (Marcon et al. 2012).
If &quot;Chao2013&quot; or &quot;Chao2015&quot; (by default), a more sophisticated approach is used
(see <a href="#topic+as_probabilities">as_probabilities</a>) following Chao et al. (2013) or
Chao and Jost (2015).</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="profile_phylo_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A bootstrap confidence interval can be produced by simulating communities
(their number is <code>n_simulations</code>) with <a href="#topic+rcommunity">rcommunity</a> and calculating their profiles.
Simulating communities implies a downward bias in the estimation:
rare species of the actual community may have abundance zero in simulated communities.
Simulated diversity values are recentered so that their mean is that of the actual community.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity at each order.
This is an object of class &quot;profile&quot; that can be plotted.
</p>


<h3>References</h3>

<p>Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.<br /><br /> Marcon E, Hérault B, Baraloto C, Lang G (2012).
&ldquo;The Decomposition of Shannon's Entropy and a Confidence Interval for <em>Beta</em> Diversity.&rdquo;
<em>Oikos</em>, <b>121</b>(4), 516&ndash;522.
<a href="https://doi.org/10.1111/j.1600-0706.2011.19267.x">doi:10.1111/j.1600-0706.2011.19267.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>profile_phylo(paracou_6_abd, tree = paracou_6_taxo)

</code></pre>

<hr>
<h2 id='profile_similarity'>Similarity-Based Diversity Profile of a Community</h2><span id='topic+profile_similarity'></span><span id='topic+profile_similarity.numeric'></span><span id='topic+profile_similarity.species_distribution'></span>

<h3>Description</h3>

<p>Calculate the diversity profile of a community, i.e. its similarity-based diversity
against its order.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>profile_similarity(
  x,
  similarities,
  orders = seq(from = 0, to = 2, by = 0.1),
  ...
)

## S3 method for class 'numeric'
profile_similarity(
  x,
  similarities = diag(length(x)),
  orders = seq(from = 0, to = 2, by = 0.1),
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  richness_estimator = c("jackknife", "iChao1", "Chao1", "naive"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  sample_coverage = NULL,
  as_numeric = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'species_distribution'
profile_similarity(
  x,
  similarities = diag(sum(!colnames(x) %in% non_species_columns)),
  orders = seq(from = 0, to = 2, by = 0.1),
  estimator = c("UnveilJ", "Max", "ChaoShen", "MarconZhang", "UnveilC", "UnveiliC",
    "naive"),
  probability_estimator = c("Chao2015", "Chao2013", "ChaoShen", "naive"),
  unveiling = c("geometric", "uniform", "none"),
  jack_alpha = 0.05,
  jack_max = 10,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  gamma = FALSE,
  n_simulations = 0,
  alpha = 0.05,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  show_progress = TRUE,
  ...,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="profile_similarity_+3A_x">x</code></td>
<td>
<p>An object, that may be a numeric vector containing abundances or probabilities,
or an object of class <a href="#topic+abundances">abundances</a> or <a href="#topic+probabilities">probabilities</a>.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_similarities">similarities</code></td>
<td>
<p>a similarity matrix, that can be obtained by <a href="#topic+fun_similarity">fun_similarity</a>.
Its default value is the identity matrix.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_orders">orders</code></td>
<td>
<p>The orders of diversity used to build the profile.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_estimator">estimator</code></td>
<td>
<p>An estimator of entropy.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_probability_estimator">probability_estimator</code></td>
<td>
<p>a string containing one of the possible estimators
of the probability distribution (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_unveiling">unveiling</code></td>
<td>
<p>a string containing one of the possible unveiling methods
to estimate the probabilities of the unobserved species (see <a href="#topic+probabilities">probabilities</a>).
Used only for extrapolation.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_richness_estimator">richness_estimator</code></td>
<td>
<p>an estimator of richness to evaluate the total number of species,
see <a href="#topic+div_richness">div_richness</a>. used for interpolation and extrapolation.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_jack_alpha">jack_alpha</code></td>
<td>
<p>the risk level, 5% by default, used to optimize the jackknife order.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_jack_max">jack_max</code></td>
<td>
<p>the highest jackknife order allowed. Default is 10.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_sample_coverage">sample_coverage</code></td>
<td>
<p>the sample coverage of <code>x</code> calculated elsewhere.
Used to calculate the gamma diversity of meta-communities, see details.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_as_numeric">as_numeric</code></td>
<td>
<p>if <code>TRUE</code>, a number or a numeric vector is returned rather than a tibble.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_n_simulations">n_simulations</code></td>
<td>
<p>The number of simulations used to estimate the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_alpha">alpha</code></td>
<td>
<p>The risk level, 5% by default, of the confidence envelope of the profile.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_bootstrap">bootstrap</code></td>
<td>
<p>the method used to obtain the probabilities to generate
bootstrapped communities from observed abundances.
If &quot;Marcon2012&quot;, the probabilities are simply the abundances divided by the total
number of individuals (Marcon et al. 2012).
If &quot;Chao2013&quot; or &quot;Chao2015&quot; (by default), a more sophisticated approach is used
(see <a href="#topic+as_probabilities">as_probabilities</a>) following Chao et al. (2013) or
Chao and Jost (2015).</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="profile_similarity_+3A_gamma">gamma</code></td>
<td>
<p>if <code>TRUE</code>, <code class="reqn">\gamma</code> diversity, i.e. diversity of the metacommunity, is computed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A bootstrap confidence interval can be produced by simulating communities
(their number is <code>n_simulations</code>) with <a href="#topic+rcommunity">rcommunity</a> and calculating their profiles.
Simulating communities implies a downward bias in the estimation:
rare species of the actual community may have abundance zero in simulated communities.
Simulated diversity values are recentered so that their mean is that of the actual community.
</p>


<h3>Value</h3>

<p>A tibble with the site names, the estimators used and the estimated diversity at each order.
This is an object of class &quot;profile&quot; that can be plotted.
</p>


<h3>References</h3>

<p>Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.<br /><br /> Marcon E, Hérault B, Baraloto C, Lang G (2012).
&ldquo;The Decomposition of Shannon's Entropy and a Confidence Interval for <em>Beta</em> Diversity.&rdquo;
<em>Oikos</em>, <b>121</b>(4), 516&ndash;522.
<a href="https://doi.org/10.1111/j.1600-0706.2011.19267.x">doi:10.1111/j.1600-0706.2011.19267.x</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Similarity matrix
Z &lt;- fun_similarity(paracou_6_fundist)
# Profile
profile_similarity(paracou_6_abd, similarities = Z, q = 2)

</code></pre>

<hr>
<h2 id='rcommunity'>Random communities</h2><span id='topic+rcommunity'></span><span id='topic+rspcommunity'></span>

<h3>Description</h3>

<p><code>rcommunity()</code> draws random communities according to a probability distribution.
<code>rspcommunity()</code> extends it by spatializing the random communities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcommunity(
  n,
  size = sum(abd),
  prob = NULL,
  abd = NULL,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  species_number = 300,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  sd_lnorm = 1,
  prob_geom = 0.1,
  fisher_alpha = 40,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  check_arguments = TRUE
)

rspcommunity(
  n,
  size = sum(abd),
  prob = NULL,
  abd = NULL,
  bootstrap = c("Chao2015", "Marcon2012", "Chao2013"),
  species_number = 300,
  distribution = c("lnorm", "lseries", "geom", "bstick"),
  sd_lnorm = 1,
  prob_geom = 0.1,
  fisher_alpha = 40,
  coverage_estimator = c("ZhangHuang", "Chao", "Turing", "Good"),
  spatial = c("Binomial", "Thomas"),
  thomas_scale = 0.2,
  thomas_mu = 10,
  win = spatstat.geom::owin(),
  species_names = NULL,
  weight_distribution = c("Uniform", "Weibull", "Exponential"),
  w_min = 1,
  w_max = 1,
  w_mean = 15,
  weibull_scale = 20,
  weibull_shape = 2,
  check_arguments = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rcommunity_+3A_n">n</code></td>
<td>
<p>the number of communities to draw.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_size">size</code></td>
<td>
<p>the number of individuals to draw in each community.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_prob">prob</code></td>
<td>
<p>a numeric vector containing probabilities.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_abd">abd</code></td>
<td>
<p>a numeric vector containing abundances.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_bootstrap">bootstrap</code></td>
<td>
<p>the method used to obtain the probabilities to generate
bootstrapped communities from observed abundances.
If &quot;Marcon2012&quot;, the probabilities are simply the abundances divided by the total
number of individuals (Marcon et al. 2012).
If &quot;Chao2013&quot; or &quot;Chao2015&quot; (by default), a more sophisticated approach is used
(see <a href="#topic+as_probabilities">as_probabilities</a>) following Chao et al. (2013) or
Chao and Jost (2015).</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_species_number">species_number</code></td>
<td>
<p>the number of species.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_distribution">distribution</code></td>
<td>
<p>The distribution of species abundances.
May be &quot;lnorm&quot; (log-normal), &quot;lseries&quot; (log-series), &quot;geom&quot; (geometric) or
&quot;bstick&quot; (broken stick).</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_sd_lnorm">sd_lnorm</code></td>
<td>
<p>the simulated log-normal distribution standard deviation.
This is the standard deviation on the log scale.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_prob_geom">prob_geom</code></td>
<td>
<p>the proportion of resources taken by successive species
of the geometric distribution.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_fisher_alpha">fisher_alpha</code></td>
<td>
<p>Fisher's <code class="reqn">\alpha</code> in the log-series distribution.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_coverage_estimator">coverage_estimator</code></td>
<td>
<p>an estimator of sample coverage used by <a href="#topic+coverage">coverage</a>.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_spatial">spatial</code></td>
<td>
<p>the spatial distribution of points.
May be &quot;Binomial&quot; (a completely random point pattern except for its fixed number of points) or
&quot;Thomas&quot; for a clustered point pattern with parameters <code>scale</code> and <code>mu</code>.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_thomas_scale">thomas_scale</code></td>
<td>
<p>in Thomas point patterns, the standard deviation of random displacement
(along each coordinate axis) of a point from its cluster center.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_thomas_mu">thomas_mu</code></td>
<td>
<p>in Thomas point patterns, the mean number of points per cluster.
The intensity of the Poisson process of cluster centers is calculated as
the number of points (<code>size</code>) per area divided by <code>thomas_mu</code>.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_win">win</code></td>
<td>
<p>the window containing the point pattern.
It is an <a href="spatstat.geom.html#topic+owin">spatstat.geom::owin</a> object.
Default is a 1x1 square.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_species_names">species_names</code></td>
<td>
<p>a vector of characters or of factors containing the possible species names.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_weight_distribution">weight_distribution</code></td>
<td>
<p>the distribution of point weights.
By default, all weight are 1.
May be &quot;uniform&quot; for a uniform distribution between <code>w_min</code> and <code>w_max</code>,
&quot;weibull&quot; with parameters <code>w_min</code>, <code>weibull_scale</code> and <code>shape</code> or
&quot;exponential&quot; with parameter <code>w_mean</code>.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_w_min">w_min</code></td>
<td>
<p>the minimum weight in a uniform, exponential or Weibull distribution.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_w_max">w_max</code></td>
<td>
<p>the maximum weight in a uniform distribution.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_w_mean">w_mean</code></td>
<td>
<p>the mean weight in an exponential distribution
(i.e. the negative of the inverse of the decay rate).</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_weibull_scale">weibull_scale</code></td>
<td>
<p>the scale parameter in a Weibull distribution.</p>
</td></tr>
<tr><td><code id="rcommunity_+3A_weibull_shape">weibull_shape</code></td>
<td>
<p>the shape parameter in a Weibull distribution.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Communities of fixed <code>size</code> are drawn in a multinomial distribution according
to the distribution of probabilities provided by <code>prob</code>.
An abundance vector <code>abd</code> may be used instead of probabilities,
then <code>size</code> is by default the total number of individuals in the vector.
Random communities can be built by drawing in a multinomial law following
Marcon et al. (2012), or trying to estimate the
distribution of the actual community with <a href="#topic+probabilities">probabilities</a>.
If <code>bootstrap</code> is &quot;Chao2013&quot;, the distribution is estimated by a single
parameter model and unobserved species are given equal probabilities.
If <code>bootstrap</code> is &quot;Chao2015&quot;, a two-parameter model is used and unobserved
species follow a geometric distribution.
</p>
<p>Alternatively, the probabilities may be drawn following a classical
distribution: either lognormal (&quot;lnorm&quot;)  (Preston 1948)
with given standard deviation (<code>sd_lnorm</code>; note that the mean is actually
a normalizing constant. Its value is set equal to 0 for the simulation of
the normal distribution of unnormalized log-abundances), log-series (&quot;lseries&quot;)
(Fisher et al. 1943) with parameter <code>fisher_alpha</code>, geometric
(&quot;geom&quot;) (Motomura 1932) with parameter <code>prob_geom</code>,
or broken stick (&quot;bstick&quot;) (MacArthur 1957).
The number of simulated species is fixed by <code>species_number</code>, except for
&quot;lseries&quot; where it is obtained from <code>fisher_alpha</code> and <code>size</code>:
<code class="reqn">S = \alpha \ln(1 + size / \alpha)</code>.
Note that the probabilities are drawn once only.
If the number of communities to draw, <code>n</code>, is greater than 1, then they are
drawn in a multinomial distribution following these probabilities.
</p>
<p>Log-normal, log-series and broken-stick distributions are stochastic.
The geometric distribution is completely determined by its parameters.
</p>
<p>Spatialized communities include the location of individuals in a window,
in a <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object.
Several point processes are available, namely binomial (points are uniformly
distributed in the window) and Thomas (1949), which
is clustered.
</p>
<p>Point weights, that may be for instance the size of the trees in a forest
community, can be uniform, follow a Weibull or a negative exponential distribution.
The latter describe well the diameter distribution of trees in a forest
(Rennolls et al. 1985; Turner 2004).
</p>


<h3>Value</h3>

<p><code>rcommunity()</code> returns an object of class <a href="#topic+abundances">abundances</a>.
</p>
<p><code>rspcommunity()</code> returns either a spatialized community,
which is a <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> object , with <code>PointType</code>
values as species names if <code>n</code>=1 or an object of class ppplist
(see <a href="spatstat.geom.html#topic+solist">spatstat.geom::solist</a>)  if <code>n</code>&gt;1.
</p>


<h3>References</h3>

<p>Chao A, Jost L (2015).
&ldquo;Estimating Diversity and Entropy Profiles via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>6</b>(8), 873&ndash;882.
<a href="https://doi.org/10.1111/2041-210X.12349">doi:10.1111/2041-210X.12349</a>.<br /><br /> Chao A, Wang Y, Jost L (2013).
&ldquo;Entropy and the Species Accumulation Curve: A Novel Entropy Estimator via Discovery Rates of New Species.&rdquo;
<em>Methods in Ecology and Evolution</em>, <b>4</b>(11), 1091&ndash;1100.
<a href="https://doi.org/10.1111/2041-210x.12108">doi:10.1111/2041-210x.12108</a>.<br /><br /> Fisher RA, Corbet AS, Williams CB (1943).
&ldquo;The Relation between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population.&rdquo;
<em>Journal of Animal Ecology</em>, <b>12</b>, 42&ndash;58.
<a href="https://doi.org/10.2307/1411">doi:10.2307/1411</a>.<br /><br /> MacArthur RH (1957).
&ldquo;On the Relative Abundance of Bird Species.&rdquo;
<em>Proceedings of the National Academy of Sciences of the United States of America</em>, <b>43</b>(3), 293&ndash;295.
<a href="https://doi.org/10.1073/pnas.43.3.293">doi:10.1073/pnas.43.3.293</a>, 89566.<br /><br /> Marcon E, Hérault B, Baraloto C, Lang G (2012).
&ldquo;The Decomposition of Shannon's Entropy and a Confidence Interval for <em>Beta</em> Diversity.&rdquo;
<em>Oikos</em>, <b>121</b>(4), 516&ndash;522.
<a href="https://doi.org/10.1111/j.1600-0706.2011.19267.x">doi:10.1111/j.1600-0706.2011.19267.x</a>.<br /><br /> Motomura I (1932).
&ldquo;On the statistical treatment of communities.&rdquo;
<em>Zoological Magazine</em>, <b>44</b>, 379&ndash;383.<br /><br /> Preston FW (1948).
&ldquo;The Commonness, and Rarity, of Species.&rdquo;
<em>Ecology</em>, <b>29</b>(3), 254&ndash;283.
<a href="https://doi.org/10.2307/1930989">doi:10.2307/1930989</a>.<br /><br /> Rennolls K, Geary DN, Rollinson TJD (1985).
&ldquo;Characterizing Diameter Distributions by the Use of the Weibull Distribution.&rdquo;
<em>Forestry</em>, <b>58</b>(1), 57&ndash;66.
ISSN 0015-752X, 1464-3626, <a href="https://doi.org/10.1093/forestry/58.1.57">doi:10.1093/forestry/58.1.57</a>.<br /><br /> Thomas M (1949).
&ldquo;A Generalization of Poisson's Binomial Limit for Use in Ecology.&rdquo;
<em>Biometrika</em>, <b>36</b>(1/2), 18&ndash;25.
<a href="https://doi.org/10.2307/2332526">doi:10.2307/2332526</a>, 2332526.<br /><br /> Turner IM (2004).
<em>The Ecology of Trees in the Tropical Rain Forest</em>, 2nd edition.
Cambridge University Press.
ISBN 978-0-521-80183-6, <a href="https://doi.org/10.1017/CBO9780511542206">doi:10.1017/CBO9780511542206</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a community made of 100000 individuals among 300 species and fit it
abundances &lt;- rcommunity(n = 1, size = 1E5,
  species_number = 300, distribution = "lnorm")
autoplot(abundances)
X &lt;- rspcommunity(1, size = 30, species_number = 5)
autoplot(X)

</code></pre>

<hr>
<h2 id='reexports'>Objects exported from other packages</h2><span id='topic+reexports'></span><span id='topic+autoplot'></span>

<h3>Description</h3>

<p>These objects are imported from other packages. Follow the links
below to see their documentation.
</p>

<dl>
<dt>ggplot2</dt><dd><p><code><a href="ggplot2.html#topic+autoplot">autoplot</a></code></p>
</dd>
</dl>

<hr>
<h2 id='rlseries'>Log-Series Distribution</h2><span id='topic+rlseries'></span>

<h3>Description</h3>

<p>Random generation for the log-series distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlseries(n, size, fisher_alpha, show_progress = TRUE, check_arguments = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rlseries_+3A_n">n</code></td>
<td>
<p>the number of observations.</p>
</td></tr>
<tr><td><code id="rlseries_+3A_size">size</code></td>
<td>
<p>The size of the distribution.</p>
</td></tr>
<tr><td><code id="rlseries_+3A_fisher_alpha">fisher_alpha</code></td>
<td>
<p>Fisher's <code class="reqn">\alpha</code> in the log-series distribution.</p>
</td></tr>
<tr><td><code id="rlseries_+3A_show_progress">show_progress</code></td>
<td>
<p>if TRUE, a progress bar is shown during long computations.</p>
</td></tr>
<tr><td><code id="rlseries_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fast implementation of the random generation of a log-series distribution
(Fisher et al. 1943).
</p>
<p>The complete set of functions (including density, distribution function and quantiles)
can be found in package <em>sads</em> but this implementation of the random generation is much faster.
</p>
<p>If <code>size</code> is too large, i.e. <code>size</code> + 1 can't be distinguished from <code>size</code> due to rounding,
then an error is raised.
</p>


<h3>Value</h3>

<p>A numeric vector with the random values drawn from the log-series distribution.
</p>


<h3>References</h3>

<p>Fisher RA, Corbet AS, Williams CB (1943).
&ldquo;The Relation between the Number of Species and the Number of Individuals in a Random Sample of an Animal Population.&rdquo;
<em>Journal of Animal Ecology</em>, <b>12</b>, 42&ndash;58.
<a href="https://doi.org/10.2307/1411">doi:10.2307/1411</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a community made of 10000 individuals with alpha=40
size &lt;- 1E4
fisher_alpha &lt;- 40
species_number &lt;- fisher_alpha * log(1 + size / fisher_alpha)
abundances &lt;- rlseries(species_number, size = 1E5, fisher_alpha = 40)
# rcommunity() may be a better choice here
autoplot(rcommunity(1, size = 1E4, fisher_alpha = 40, distribution = "lseries"))
</code></pre>

<hr>
<h2 id='species_distribution'>Species Distributions</h2><span id='topic+species_distribution'></span><span id='topic+as_species_distribution'></span><span id='topic+as_species_distribution.numeric'></span><span id='topic+as_species_distribution.matrix'></span><span id='topic+as_species_distribution.data.frame'></span><span id='topic+as_species_distribution.wmppp'></span><span id='topic+as_species_distribution.character'></span><span id='topic+as_species_distribution.factor'></span><span id='topic+is_species_distribution'></span><span id='topic+as_probabilities'></span><span id='topic+as_probabilities.numeric'></span><span id='topic+as_probabilities.matrix'></span><span id='topic+as_probabilities.data.frame'></span><span id='topic+as_probabilities.wmppp'></span><span id='topic+as_probabilities.character'></span><span id='topic+as_probabilities.factor'></span><span id='topic+is_probabilities'></span><span id='topic+abundances'></span><span id='topic+as_abundances'></span><span id='topic+as_abundances.numeric'></span><span id='topic+as_abundances.matrix'></span><span id='topic+as_abundances.data.frame'></span><span id='topic+as_abundances.wmppp'></span><span id='topic+as_abundances.character'></span><span id='topic+as_abundances.factor'></span><span id='topic+is_abundances'></span><span id='topic+as.matrix.species_distribution'></span><span id='topic+as.double.species_distribution'></span><span id='topic+as.numeric.species_distribution'></span>

<h3>Description</h3>

<p>A Species Distribution is a <a href="tibble.html#topic+tibble">tibble::tibble</a> containing species abundances
or probabilities.
Rows of the tibble are communities and column are species.
Values are either abundances or probabilities.
Special columns contain the site names, and their weights
(e.g. their area or number of individuals):
their names must be &quot;site&quot; and &quot;weight&quot;.
All other column names are considered as species names.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>species_distribution(x, names = NULL, weights = NULL, check_arguments = TRUE)

as_species_distribution(x, ...)

## S3 method for class 'numeric'
as_species_distribution(x, ..., check_arguments = TRUE)

## S3 method for class 'matrix'
as_species_distribution(
  x,
  names = NULL,
  weights = NULL,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'data.frame'
as_species_distribution(x, ..., check_arguments = TRUE)

## S3 method for class 'wmppp'
as_species_distribution(x, ..., check_arguments = TRUE)

## S3 method for class 'character'
as_species_distribution(x, ..., check_arguments = TRUE)

## S3 method for class 'factor'
as_species_distribution(x, ..., check_arguments = TRUE)

is_species_distribution(x)

as_probabilities(x, ...)

## S3 method for class 'numeric'
as_probabilities(x, ..., check_arguments = TRUE)

## S3 method for class 'matrix'
as_probabilities(x, names = NULL, weights = NULL, ..., check_arguments = TRUE)

## S3 method for class 'data.frame'
as_probabilities(x, ..., check_arguments = TRUE)

## S3 method for class 'wmppp'
as_probabilities(x, ..., check_arguments = TRUE)

## S3 method for class 'character'
as_probabilities(x, ..., check_arguments = TRUE)

## S3 method for class 'factor'
as_probabilities(x, ..., check_arguments = TRUE)

is_probabilities(x)

abundances(
  x,
  round = TRUE,
  names = NULL,
  weights = NULL,
  check_arguments = TRUE
)

as_abundances(x, ...)

## S3 method for class 'numeric'
as_abundances(x, round = TRUE, ..., check_arguments = TRUE)

## S3 method for class 'matrix'
as_abundances(
  x,
  round = TRUE,
  names = NULL,
  weights = NULL,
  ...,
  check_arguments = TRUE
)

## S3 method for class 'data.frame'
as_abundances(x, ..., check_arguments = TRUE)

## S3 method for class 'wmppp'
as_abundances(x, ..., check_arguments = TRUE)

## S3 method for class 'character'
as_abundances(x, ..., check_arguments = TRUE)

## S3 method for class 'factor'
as_abundances(x, ..., check_arguments = TRUE)

is_abundances(x)

## S3 method for class 'species_distribution'
as.matrix(x, use.names = TRUE, ...)

## S3 method for class 'species_distribution'
as.double(x, use.names = TRUE, ...)

## S3 method for class 'species_distribution'
as.numeric(x, use.names = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="species_distribution_+3A_x">x</code></td>
<td>
<p>an object.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_names">names</code></td>
<td>
<p>The names of the species distributions.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_weights">weights</code></td>
<td>
<p>the weights of the sites of the species distributions.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_check_arguments">check_arguments</code></td>
<td>
<p>if <code>TRUE</code>, the function arguments are verified.
Should be set to <code>FALSE</code> to save time when the arguments have been checked elsewhere.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_...">...</code></td>
<td>
<p>Unused.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_round">round</code></td>
<td>
<p>If <code>TRUE</code>, the values of <code>x</code> are rounded to the nearest integer.</p>
</td></tr>
<tr><td><code id="species_distribution_+3A_use.names">use.names</code></td>
<td>
<p>If <code>TRUE</code>, the names of the <code>species_distribution</code> are kept
in the matrix or vector they are converted to.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>species_distribution</code> objects include <code>abundances</code> and <code>probabilities</code>
objects.
</p>
<p><code>species_distribution()</code> creates a <code>species_distribution</code> object from a vector
or a matrix or a dataframe.
</p>
<p><code>as_species_distribution()</code>, <code>as_abundances()</code> and <code>as_probabilities</code> format
the numeric, matrix or dataframe <code>x</code> so that appropriate
versions of community functions (generic methods such as <a href="base.html#topic+plot">plot</a> or
<a href="#topic+div_richness">div_richness</a>) are applied.
Abundance values are rounded (by default) to the nearest integer.
They also accept a <a href="dbmss.html#topic+wmppp">dbmss::wmppp</a> objects,
i.e. a weighted, marked planar point pattern and count the abundances of
point types, character and factor objects.
</p>
<p><code>as_probabilities()</code> normalizes the vector <code>x</code> so that it sums to 1. It gives
the same output as <code>probabilities()</code> with <code>estimator = "naive"</code>.
</p>
<p><code>species_distribution</code> objects objects can be plotted by <a href="base.html#topic+plot">plot</a> and <a href="#topic+autoplot">autoplot</a>.
</p>


<h3>Value</h3>

<p>An object of classes <code>species_distribution</code> and <code>abundances</code>
or <code>probabilities</code>.
</p>
<p><code>as.double()</code> and its synonymous <code>as.numeric()</code> return a numeric vector
that contains species abundances or probabilities of a single-row
<code>species_distribution</code>.
<code>as.matrix()</code> returns a numeric matrix if the <code>species_distribution</code> contains
several rows.
These are methods of the generic functions for class <code>species_distribution</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Paracou data is a tibble
paracou_6_abd
# Class
class(paracou_6_abd)
is_species_distribution(paracou_6_abd)
# Whittaker plot fitted by a log-normal distribution
autoplot(paracou_6_abd[1,], fit_rac = TRUE, distribution = "lnorm")
# Character vectors
as_abundances(c("A", "C", "B", "C"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
