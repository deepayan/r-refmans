<!DOCTYPE html><html><head><title>Help for package besthr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {besthr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#add_rank'><p>calculate ranks of a score column and adds result to a dataframe</p></a></li>
<li><a href='#bootstrap_dist'><p>runs bootstrapping of ranks</p></a></li>
<li><a href='#bstrap_sample'><p>resamples a rank column in a dataframe based on groups</p></a></li>
<li><a href='#conf_intervals'><p>gets confidence interval limits for means of bootstrapped ranks</p></a></li>
<li><a href='#dot_plot'><p>dot plot of ranked data without technical replicates</p></a></li>
<li><a href='#estimate'><p>Perform bootstrap estimation of confidence intervals of ranked HR scores</p></a></li>
<li><a href='#factorise_cols'><p>Convert named columns to factors</p></a></li>
<li><a href='#group_means'><p>Get mean rank of groups in a data frame</p></a></li>
<li><a href='#group_ns'><p>Get number of observations in a group in a data frame</p></a></li>
<li><a href='#make_data'><p>return a sample data set of random values for two groups</p></a></li>
<li><a href='#make_data2'><p>return a sample data set of random values for two groups with three technical reps per group</p></a></li>
<li><a href='#make_data3'><p>return a sample data set of random values for three groups with three technical reps per group</p></a></li>
<li><a href='#plot.hrest'><p>plots the <code>hrest</code> object</p></a></li>
<li><a href='#print.hrest'><p>print a summary of the hrest object</p></a></li>
<li><a href='#tech_rep_dot_plot'><p>dot plot of score data with technical replicates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Generating Bootstrap Estimation Distributions of HR Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Creates plots showing scored HR experiments and plots of distribution of
    means of ranks of HR score from bootstrapping. Authors (2019) &lt;<a href="https://doi.org/10.5281%2Fzenodo.3374507">doi:10.5281/zenodo.3374507</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, ggplot2, ggridges, magrittr, patchwork, rlang, stringr,
tibble</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, readr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-14 05:47:55 UTC; taz23vul</td>
</tr>
<tr>
<td>Author:</td>
<td>Dan MacLean [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dan MacLean &lt;dan.maclean@tsl.ac.uk&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-14 08:50:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic++25+3E+25">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Value</h3>

<p>result of previous expression
</p>

<hr>
<h2 id='add_rank'>calculate ranks of a score column and adds result to a dataframe</h2><span id='topic+add_rank'></span>

<h3>Description</h3>

<p><code>add_rank</code> returns a copy of the passed data frame containing a new
column called <code>rank</code> which has the ranks of the named score column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_rank(df, quo_score_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="add_rank_+3A_df">df</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="add_rank_+3A_quo_score_col">quo_score_col</code></td>
<td>
<p>quoted score column name</p>
</td></tr>
</table>

<hr>
<h2 id='bootstrap_dist'>runs bootstrapping of ranks</h2><span id='topic+bootstrap_dist'></span>

<h3>Description</h3>

<p><code>boostrap_dist</code> runs multiple bootstrap resamplings using
<code><a href="#topic+bstrap_sample">bstrap_sample</a></code> to generate a data frame of bootstrap rank means
of per group scores
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bootstrap_dist(df, quo_score_col, quo_group_col, nits = 10, control = "A")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bootstrap_dist_+3A_df">df</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="bootstrap_dist_+3A_quo_score_col">quo_score_col</code></td>
<td>
<p>quoted column name containing the HR scores</p>
</td></tr>
<tr><td><code id="bootstrap_dist_+3A_quo_group_col">quo_group_col</code></td>
<td>
<p>quoted group name containing the group column</p>
</td></tr>
<tr><td><code id="bootstrap_dist_+3A_nits">nits</code></td>
<td>
<p>number of bootstrap iterations to do</p>
</td></tr>
<tr><td><code id="bootstrap_dist_+3A_control">control</code></td>
<td>
<p>character naming the control group that will be removed prior
to bootstrapping</p>
</td></tr>
</table>

<hr>
<h2 id='bstrap_sample'>resamples a rank column in a dataframe based on groups</h2><span id='topic+bstrap_sample'></span>

<h3>Description</h3>

<p><code>bstrap_sample</code> performs a single iteration of bootstrapping of a rank
column in a data frame. The rows matching <code>control</code> in the quoted
<code>quo_group_col</code> column are removed. The remaining rows are grouped by
<code>quo_group_col</code> and in each group the rank column is resampled with
replacement and the mean rank of the resampling for each group is returned
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bstrap_sample(iteration, quo_score_col, quo_group_col, df, control = "A")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bstrap_sample_+3A_iteration">iteration</code></td>
<td>
<p>integer giving the current bootstrap iteration from the
calling function</p>
</td></tr>
<tr><td><code id="bstrap_sample_+3A_quo_score_col">quo_score_col</code></td>
<td>
<p>quoted column name containing the HR scores</p>
</td></tr>
<tr><td><code id="bstrap_sample_+3A_quo_group_col">quo_group_col</code></td>
<td>
<p>quoted group name containing the group name of the
observation</p>
</td></tr>
<tr><td><code id="bstrap_sample_+3A_df">df</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="bstrap_sample_+3A_control">control</code></td>
<td>
<p>character naming the control group that will be removed prior
to bootstrapping</p>
</td></tr>
</table>

<hr>
<h2 id='conf_intervals'>gets confidence interval limits for means of bootstrapped ranks</h2><span id='topic+conf_intervals'></span>

<h3>Description</h3>

<p><code>conf_intervals</code> calculates a low and a high quantile for the
<code>mean</code> column of each group of a dataframe
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conf_intervals(df, quo_group_col, low = 0.05, high = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conf_intervals_+3A_df">df</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="conf_intervals_+3A_quo_group_col">quo_group_col</code></td>
<td>
<p>quoted group name containing the column to group on</p>
</td></tr>
<tr><td><code id="conf_intervals_+3A_low">low</code></td>
<td>
<p>the low probability value of the quantile</p>
</td></tr>
<tr><td><code id="conf_intervals_+3A_high">high</code></td>
<td>
<p>the high probability value of the quantile</p>
</td></tr>
</table>

<hr>
<h2 id='dot_plot'>dot plot of ranked data without technical replicates</h2><span id='topic+dot_plot'></span>

<h3>Description</h3>

<p><code>dot_plot</code> returns a ggplot object of ranked data with group on the
x-axis and rank on the y-axis. Point size indicates the number of
observations seen at that point. A per group horizontal line shows the group
ranked mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dot_plot(hrest, group_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dot_plot_+3A_hrest">hrest</code></td>
<td>
<p>the hrest object from <code>estimate</code></p>
</td></tr>
<tr><td><code id="dot_plot_+3A_group_col">group_col</code></td>
<td>
<p>quoted group column name</p>
</td></tr>
</table>

<hr>
<h2 id='estimate'>Perform bootstrap estimation of confidence intervals of ranked HR scores</h2><span id='topic+estimate'></span>

<h3>Description</h3>

<p><code>estimate</code> carries out estimation of bootstrap confidence intervals on
ranked score data. Returns a <code>hrest</code> object of the result
Proceeeds by calculating score ranks, then bootstrapping ranks in non-control
groups retaining the mean for each bootstrap iteration. Calculates
low and high quantiles of bootstrap mean distributions for each group.
If technical replicates are provided in a second grouping column these will
be averaged before proceeding.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate(df, ..., control = "A", nits = 100, low = 0.025, high = 0.975)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate_+3A_df">df</code></td>
<td>
<p>data frame of score and group data. Contains minimally a score and
group column</p>
</td></tr>
<tr><td><code id="estimate_+3A_...">...</code></td>
<td>
<p>bare names of columns to use, minimally the score column and the
group column in that order. Optionally a third technical replicate column can
be provided</p>
</td></tr>
<tr><td><code id="estimate_+3A_control">control</code></td>
<td>
<p>the value of the grouping column taken to be the control group</p>
</td></tr>
<tr><td><code id="estimate_+3A_nits">nits</code></td>
<td>
<p>the number of bootstap iterations to be done</p>
</td></tr>
<tr><td><code id="estimate_+3A_low">low</code></td>
<td>
<p>the low probability value of the quantile</p>
</td></tr>
<tr><td><code id="estimate_+3A_high">high</code></td>
<td>
<p>the high probability value of the quantile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list object of class &quot;hrest&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 d1 &lt;- make_data()
 estimate(d1, score, group)

 d2 &lt;- make_data2()
 estimate(d2, score_column_name, sample_column_name, rep_column_name )


 d3 &lt;- make_data3()
 estimate(d3, score, sample, rep, nits = 1000)

</code></pre>

<hr>
<h2 id='factorise_cols'>Convert named columns to factors</h2><span id='topic+factorise_cols'></span>

<h3>Description</h3>

<p><code>factorise_cols</code> returns a copy of the passed data frame in which all
explicitly named columns are converted to factors with <code>as.factor</code>
All columns with only NA values are ommitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factorise_cols(df, col_list)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="factorise_cols_+3A_df">df</code></td>
<td>
<p>data frame</p>
</td></tr>
<tr><td><code id="factorise_cols_+3A_col_list">col_list</code></td>
<td>
<p>vector of quoted column names</p>
</td></tr>
</table>

<hr>
<h2 id='group_means'>Get mean rank of groups in a data frame</h2><span id='topic+group_means'></span>

<h3>Description</h3>

<p><code>group_means</code> groups the provided dataframe by a column and returns
a summary dataframe with a mean column containing the mean of the group's
rank column
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_means(df, quo_group_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_means_+3A_df">df</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="group_means_+3A_quo_group_col">quo_group_col</code></td>
<td>
<p>quoted group name containing the column to group on</p>
</td></tr>
</table>

<hr>
<h2 id='group_ns'>Get number of observations in a group in a data frame</h2><span id='topic+group_ns'></span>

<h3>Description</h3>

<p><code>group_ns</code> groups the provided dataframe by a column and returns
a summary dataframe with an column <code>n</code> containg the number of
observations in a group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_ns(df, quo_group_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_ns_+3A_df">df</code></td>
<td>
<p>input data frame</p>
</td></tr>
<tr><td><code id="group_ns_+3A_quo_group_col">quo_group_col</code></td>
<td>
<p>quoted group name containing the column to group on</p>
</td></tr>
</table>

<hr>
<h2 id='make_data'>return a sample data set of random values for two groups</h2><span id='topic+make_data'></span>

<h3>Description</h3>

<p>return a sample data set of random values for two groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_data()
</code></pre>


<h3>Value</h3>

<p>tibble of random values for two groups
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 d1 &lt;- make_data()

</code></pre>

<hr>
<h2 id='make_data2'>return a sample data set of random values for two groups with three technical reps per group</h2><span id='topic+make_data2'></span>

<h3>Description</h3>

<p>return a sample data set of random values for two groups with three technical reps per group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_data2()
</code></pre>


<h3>Value</h3>

<p>tibble of random values for two groups with three technical reps per group
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 d2 &lt;- make_data2()

</code></pre>

<hr>
<h2 id='make_data3'>return a sample data set of random values for three groups with three technical reps per group</h2><span id='topic+make_data3'></span>

<h3>Description</h3>

<p>@examples
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_data3()
</code></pre>


<h3>Details</h3>

<p>d3 &lt;- make_data3()
</p>


<h3>Value</h3>

<p>tibble of random values for three groups with three technical reps per group
</p>

<hr>
<h2 id='plot.hrest'>plots the <code>hrest</code> object</h2><span id='topic+plot.hrest'></span>

<h3>Description</h3>

<p>returns a ggplot object representing the hrest object from
<code><a href="#topic+estimate">estimate</a></code>. The content of left panel varies according to the
value of the <code>which</code> parameter. If <code>which = "rank_simulation"</code> is
used a plot of rank score values will be plotted in the left panel. In this
case technical replicates will be averaged if provided. If
<code>which = "just_data" </code> a plot of scores only is created and technical
replicates are displayed as is. In each case, the right hand panel shows the
rank bootstrap distribution and confidence interval boundaries for all non-
control groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrest'
plot(x, ..., which = "rank_simulation")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.hrest_+3A_x">x</code></td>
<td>
<p>the <code>hrest</code> object from <code><a href="#topic+estimate">estimate</a></code></p>
</td></tr>
<tr><td><code id="plot.hrest_+3A_...">...</code></td>
<td>
<p>Other parameters</p>
</td></tr>
<tr><td><code id="plot.hrest_+3A_which">which</code></td>
<td>
<p>the type of left hand panel to create. Either &quot;rank_simulation&quot;
or &quot;just_data&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ggplot object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 d1 &lt;- make_data()
 hr_est &lt;- estimate(d1, score, group)
 plot(hr_est)

</code></pre>

<hr>
<h2 id='print.hrest'>print a summary of the hrest object</h2><span id='topic+print.hrest'></span>

<h3>Description</h3>

<p>print a summary of the hrest object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hrest'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.hrest_+3A_x">x</code></td>
<td>
<p>hrest object</p>
</td></tr>
<tr><td><code id="print.hrest_+3A_...">...</code></td>
<td>
<p>other parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>null
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
 d1 &lt;- make_data()
 hr_est &lt;- estimate(d1, score, group)
 print(hr_est)

</code></pre>

<hr>
<h2 id='tech_rep_dot_plot'>dot plot of score data with technical replicates</h2><span id='topic+tech_rep_dot_plot'></span>

<h3>Description</h3>

<p><code>tech_rep_dot_plot</code> returns a ggplot object of score data with group on
technical replicate on the x-axis, score on the y-axis with point size
representing the number of observations at that point. Facets represent
individual groups
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tech_rep_dot_plot(hrest, score_col, group_col, tech_rep_col)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tech_rep_dot_plot_+3A_hrest">hrest</code></td>
<td>
<p>the hrest object from <code>estimate</code></p>
</td></tr>
<tr><td><code id="tech_rep_dot_plot_+3A_score_col">score_col</code></td>
<td>
<p>quoted score column name</p>
</td></tr>
<tr><td><code id="tech_rep_dot_plot_+3A_group_col">group_col</code></td>
<td>
<p>quoted group column name</p>
</td></tr>
<tr><td><code id="tech_rep_dot_plot_+3A_tech_rep_col">tech_rep_col</code></td>
<td>
<p>quoted tech replicate column name</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
