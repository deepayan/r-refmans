<!DOCTYPE html><html lang="en"><head><title>Help for package phenModel</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {phenModel}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#phenModel-package'>
<p>Insect Phenology Model Evaluation Based on Daily Temperatures</p></a></li>
<li><a href='#assign_observed_data'>
<p>Observed Data Preparation</p></a></li>
<li><a href='#bivrp-internal'><p>Internal functions to used to evaluate a phenology model and plot the results</p></a></li>
<li><a href='#casement9596'>
<p>Casement 1995-1996 Data</p></a></li>
<li><a href='#cdl_check'>
<p>Plots for Checking Sensitivity to CDL</p></a></li>
<li><a href='#cum_dev_rate'>
<p>Cumulative Development Rates</p></a></li>
<li><a href='#get_cycle'>
<p>Obtain Yearly Cycles</p></a></li>
<li><a href='#get_total_info'>
<p>Compute Day Length, Mean Temperature, Thermal Units, and Cumulative Chill Days</p></a></li>
<li><a href='#phen_model'>
<p>Phenology Model Evaluation</p></a></li>
<li><a href='#phen_model_forecast'>
<p>Multi-Year Forecast Based on the Phenology Model</p></a></li>
<li><a href='#phen_model_gen2'>
<p>Phenology Model Evaluation for Further Generations</p></a></li>
<li><a href='#plot_phen_forecast'>
<p>Plot Phenology Model Multi-Year Forecast</p></a></li>
<li><a href='#plot_phen_model'>
<p>Plot Phenology Model Evaluations</p></a></li>
<li><a href='#pvulg_budburst_parameters'>
<p>Estimated Parameters for the Exponential Decay Model for Budburst</p></a></li>
<li><a href='#pvulg_lactin_parameters'>
<p>Estimated Parameters for the Lactin Model for P. Vulgatissima</p></a></li>
<li><a href='#pvulg_weibull_parameters'>
<p>Estimated Parameters for the Weibull Model for P. Vulgatissima</p></a></li>
<li><a href='#sensitivity'>
<p>Sensitivity Analysis for Evaluated Phenology Model</p></a></li>
<li><a href='#valentia'>
<p>Valentia Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Insect Phenology Model Evaluation Based on Daily Temperatures</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-08-01</td>
</tr>
<tr>
<td>Author:</td>
<td>Rafael de Andrade Moral [aut, cre],
  Rowan Fealy [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Rafael de Andrade Moral &lt;rafael.deandrademoral@mu.ie&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0), ggplot2, dplyr, reshape, grid</td>
</tr>
<tr>
<td>Description:</td>
<td>Generates predicted stage change days for an insect, based on daily temperatures and development rate parameters, as developed by Pollard (2014) <a href="http://mural.maynoothuniversity.ie/view/ethesisauthor/Pollard=3ACiaran_P=2E=3A=3A.html">http://mural.maynoothuniversity.ie/view/ethesisauthor/Pollard=3ACiaran_P=2E=3A=3A.html</a>. A few example datasets are included and implemented for P. vulgatissima, the blue willow beetle, but the approach can be readily applied to other species that display similar behaviour.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-08-01 12:35:04 UTC; rafael</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-08-02 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='phenModel-package'>
Insect Phenology Model Evaluation Based on Daily Temperatures
</h2><span id='topic+phenModel-package'></span><span id='topic+phenModel'></span>

<h3>Description</h3>

<p>Generates predicted stage change days for an insect, based on daily temperatures and development rate parameters, as developed by Pollard (2014) &lt;http://mural.maynoothuniversity.ie/view/ethesisauthor/Pollard=3ACiaran_P=2E=3A=3A.html&gt;. A few example datasets are included and implemented for P. vulgatissima, the blue willow beetle, but the approach can be readily applied to other species that display similar behaviour.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> phenModel</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Insect Phenology Model Evaluation Based on Daily Temperatures</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-08-01</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person("Rafael", "de Andrade Moral", role = c("aut", "cre"), email = "rafael.deandrademoral@mu.ie"), person("Rowan", "Fealy", role = "aut"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Rafael de Andrade Moral [aut, cre], Rowan Fealy [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Rafael de Andrade Moral &lt;rafael.deandrademoral@mu.ie&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.0.0), ggplot2, dplyr, reshape, grid</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Generates predicted stage change days for an insect, based on daily temperatures and development rate parameters, as developed by Pollard (2014) &lt;http://mural.maynoothuniversity.ie/view/ethesisauthor/Pollard=3ACiaran_P=2E=3A=3A.html&gt;. A few example datasets are included and implemented for P. vulgatissima, the blue willow beetle, but the approach can be readily applied to other species that display similar behaviour.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;=2)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>Index of help topics:
</p>
<pre>
assign_observed_data    Observed Data Preparation
bp_maxmin               Internal functions to used to evaluate a
                        phenology model and plot the results
casement9596            Casement 1995-1996 Data
cdl_check               Plots for Checking Sensitivity to CDL
cum_dev_rate            Cumulative Development Rates
get_cycle               Obtain Yearly Cycles
get_total_info          Compute Day Length, Mean Temperature, Thermal
                        Units, and Cumulative Chill Days
phenModel-package       Insect Phenology Model Evaluation Based on
                        Daily Temperatures
phen_model              Phenology Model Evaluation
phen_model_forecast     Multi-Year Forecast Based on the Phenology
                        Model
phen_model_gen2         Phenology Model Evaluation for Further
                        Generations
plot_phen_forecast      Plot Phenology Model Multi-Year Forecast
plot_phen_model         Plot Phenology Model Evaluations
pvulg_budburst_parameters
                        Estimated Parameters for the Exponential Decay
                        Model for Budburst
pvulg_lactin_parameters
                        Estimated Parameters for the Lactin Model for
                        P. Vulgatissima
pvulg_weibull_parameters
                        Estimated Parameters for the Weibull Model for
                        P. Vulgatissima
sensitivity             Sensitivity Analysis for Evaluated Phenology
                        Model
valentia                Valentia Data
</pre>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral [aut, cre], Rowan Fealy [aut]
</p>
<p>Maintainer: Rafael de Andrade Moral &lt;rafael.deandrademoral@mu.ie&gt;
</p>


<h3>References</h3>

<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>

<hr>
<h2 id='assign_observed_data'>
Observed Data Preparation
</h2><span id='topic+assign_observed_data'></span>

<h3>Description</h3>

<p>Prepares observed data for plotting with model evaluation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_observed_data(obj, eggs = NA, larvae = NA, pupae = NA, adults)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign_observed_data_+3A_obj">obj</code></td>
<td>
<p>an object generated from <code><a href="#topic+phen_model">phen_model</a></code></p>
</td></tr>
<tr><td><code id="assign_observed_data_+3A_eggs">eggs</code></td>
<td>
<p>vector of days in which eggs were observed</p>
</td></tr>
<tr><td><code id="assign_observed_data_+3A_larvae">larvae</code></td>
<td>
<p>vector of days in which larvae were observed</p>
</td></tr>
<tr><td><code id="assign_observed_data_+3A_pupae">pupae</code></td>
<td>
<p>vector of days in which pupae were observed</p>
</td></tr>
<tr><td><code id="assign_observed_data_+3A_adults">adults</code></td>
<td>
<p>vector of days in which adults were observed</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Reads in the data and returns an object ready to be passed to <code><a href="#topic+plot_phen_model">plot_phen_model</a></code> for plotting. Uses a simple probability checking to determine whether the observations for the adults category belong to the post-diapause, ovipositing or adult emergence stage, based on normal distributions.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> with five columns, one for each stage (post-diapause, eggs, larvae, pupae and adults).
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phen_model">phen_model</a></code>, <code><a href="#topic+plot_phen_model">plot_phen_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)
casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

## loading fitted parameters
data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

## evaluating model
quantiles_seq &lt;- seq(.001, .95, .001)

phen95 &lt;- phen_model(Tmean = "Tmean",
                     thermal_units = "thermal_units",
                     chill_days = "chill_days",
                     day_length = "day_length",
                     bud_pars = pvulg_budburst_parameters,
                     weib_pars = pvulg_weibull_parameters,
                     lactin_pars = pvulg_lactin_parameters,
                     max_day_length = 14.92,
                     pop_quantiles = quantiles_seq,
                     data = casement1995)

phen95_gen2 &lt;- phen_model_gen2(Tmean = "Tmean",
                               day_length = "day_length",
                               bud_pars = pvulg_budburst_parameters,
                               weib_pars = pvulg_weibull_parameters,
                               lactin_pars = pvulg_lactin_parameters,
                               sex_mat_day = phen95["0.05","sexual_maturation_day"],
                               pop_quantiles = .05,
                               data = casement1995)

## adding observed points
made_up_data &lt;- assign_observed_data(obj = phen95,
                                     eggs = c(182,184,204,227,233,242),
                                     larvae = c(204,227,233,242,249),
                                     adults = c(204,212,220,221,222,224,227,233,242,269,283,298,
                                                305,310,311,312,313,314,315,316,317,318,
                                                319,320,321,322,323,334,325,326,327,328,
                                                329,330,331,332))

plot_phen_model(obj = phen95, obj_gen2 = phen95_gen2,
                observed_data = made_up_data)
</code></pre>

<hr>
<h2 id='bivrp-internal'>Internal functions to used to evaluate a phenology model and plot the results</h2><span id='topic+bp_maxmin'></span><span id='topic+budburst_pred'></span><span id='topic+exp_dec_wrapper'></span><span id='topic+exp_dec'></span><span id='topic+get_chill_days'></span><span id='topic+get_day_length'></span><span id='topic+get_thermal_units'></span><span id='topic+get_Tmean'></span><span id='topic+lactin_wrapper'></span><span id='topic+lactin'></span><span id='topic+stage_change_pred_gen2'></span><span id='topic+stage_change_pred'></span><span id='topic+weibull3p_inverse_wrapper'></span><span id='topic+weibull3p_inverse'></span><span id='topic+weibull3p'></span>

<h3>Description</h3>

<p>Internal functions used to evaluate a phenology model and plot the results</p>


<h3>Author(s)</h3>

<p>Rafael A. Moral &lt;rafael.deandrademoral@mu.ie&gt; and Rowan Fealy
</p>

<hr>
<h2 id='casement9596'>
Casement 1995-1996 Data
</h2><span id='topic+casement9596'></span>

<h3>Description</h3>

<p>Daily minimum and maximum temperature data obtained at the Casement Aerodrome weather station for the period of 1st November 1995 to 31st October 1996.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("casement9596")</code></pre>


<h3>Format</h3>

<p>A data frame with 366 observations on the following 7 variables.
</p>

<dl>
<dt><code>Year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Month</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Day</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Lat</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Tmin</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Tmax</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>day</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data was obtained from the Irish National Meteorological Agency (Met Éireann).
</p>


<h3>Source</h3>

<p>https://www.met.ie/climate/available-data/historical-data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

## evaluating model
quantiles_seq &lt;- seq(.001, .95, .001)

## loading fitted parameters
data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

phen95 &lt;- phen_model(Tmean = "Tmean",
                     thermal_units = "thermal_units",
                     chill_days = "chill_days",
                     day_length = "day_length",
                     bud_pars = pvulg_budburst_parameters,
                     weib_pars = pvulg_weibull_parameters,
                     lactin_pars = pvulg_lactin_parameters,
                     max_day_length = 14.92,
                     pop_quantiles = quantiles_seq,
                     data = casement1995)

phen95_gen2 &lt;- phen_model_gen2(Tmean = "Tmean",
                               day_length = "day_length",
                               bud_pars = pvulg_budburst_parameters,
                               weib_pars = pvulg_weibull_parameters,
                               lactin_pars = pvulg_lactin_parameters,
                               sex_mat_day = phen95["0.05","sexual_maturation_day"],
                               pop_quantiles = .05,
                               data = casement1995)

plot_phen_model(obj = phen95, obj_gen2 = phen95_gen2)
</code></pre>

<hr>
<h2 id='cdl_check'>
Plots for Checking Sensitivity to CDL
</h2><span id='topic+cdl_check'></span>

<h3>Description</h3>

<p>Produces plots based on sensitivity analysis for the critical day length threshold.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cdl_check(cdl, quantiles, max_day_length)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cdl_check_+3A_cdl">cdl</code></td>
<td>
<p>a vector with the CDL thersholds calculated by <code><a href="#topic+sensitivity">sensitivity</a></code></p>
</td></tr>
<tr><td><code id="cdl_check_+3A_quantiles">quantiles</code></td>
<td>
<p>the quantiles corresponding to each value from <code>cdl</code></p>
</td></tr>
<tr><td><code id="cdl_check_+3A_max_day_length">max_day_length</code></td>
<td>
<p>the maximum day length set when running <code><a href="#topic+sensitivity">sensitivity</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sensitivity">sensitivity</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

test_quantiles &lt;- c(.01,.05,.1,.25,.5,.75,.9,.95,.99)
cdl_thresholds &lt;- NULL
for(q in test_quantiles) {
  sens_casement_cdl &lt;- sensitivity(Tmax = casement9596$Tmax,
                                   Tmin = casement9596$Tmin,
                                   Tbase = 7,
                                   lat = casement9596$Lat,
                                   day = casement9596$day,
                                   bud_pars = pvulg_budburst_parameters,
                                   weib_pars = pvulg_weibull_parameters,
                                   lactin_pars = pvulg_lactin_parameters,
                                   max_day_length = 14.92, 
                                   pop_quantile = q,
                                   data = casement9596,
                                   study_type = "cdl",
                                   percent_variation = 1,
                                   resolution = 20) # increase resolution for better visualisation
  cdl_thresholds &lt;- c(cdl_thresholds, summary_sensitivity(sens_casement_cdl)[1])
}

names(cdl_thresholds) &lt;- paste(test_quantiles)
cdl_thresholds
                                 
cdl_check(cdl = cdl_thresholds,
          quantiles = test_quantiles,
          max_day_length = 14.92) +
  ggtitle("CDL sensitivity")
</code></pre>

<hr>
<h2 id='cum_dev_rate'>
Cumulative Development Rates
</h2><span id='topic+cum_dev_rate'></span>

<h3>Description</h3>

<p>Returns the cumulative development rates calculated when the phenology model is being evaluated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cum_dev_rate(Tmean, thermal_units, chill_days, day_length,
             bud_pars, weib_pars, lactin_pars, max_day_length,
             pop_quantiles = 0.5, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cum_dev_rate_+3A_tmean">Tmean</code></td>
<td>
<p>name of the column in the data representing the mean temperature</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_thermal_units">thermal_units</code></td>
<td>
<p>name of the column in the data representing the thermal units</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_chill_days">chill_days</code></td>
<td>
<p>name of the column in the data representing the number of chill days</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_day_length">day_length</code></td>
<td>
<p>name of the column in the data representing the day length</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_bud_pars">bud_pars</code></td>
<td>
<p>vector of parameters for the budburst model</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_weib_pars">weib_pars</code></td>
<td>
<p>matrix of parameters for the Weibull model for each developmental stage</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_lactin_pars">lactin_pars</code></td>
<td>
<p>matrix of parameters for the lactin model for each developmental stage</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_max_day_length">max_day_length</code></td>
<td>
<p>critical day length threshold</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_pop_quantiles">pop_quantiles</code></td>
<td>
<p>quantile of the population to be evaluated by the phenology model</p>
</td></tr>
<tr><td><code id="cum_dev_rate_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the data with an appended column representing the cumulative development rates evaluated by the model.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phen_model">phen_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

## loading fitted parameters
data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

casement1995 &lt;- cum_dev_rate(Tmean = "Tmean",
                             thermal_units = "thermal_units",
                             chill_days = "chill_days",
                             day_length = "day_length",
                             bud_pars = pvulg_budburst_parameters,
                             weib_pars = pvulg_weibull_parameters,
                             lactin_pars = pvulg_lactin_parameters,
                             max_day_length = 14.92,
                             data = casement1995)
</code></pre>

<hr>
<h2 id='get_cycle'>
Obtain Yearly Cycles
</h2><span id='topic+get_cycle'></span>

<h3>Description</h3>

<p>Given a <code>data.frame</code> with columns representing days and months, returns a vector of indices representing which cycle each row corresponds to.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_cycle(data, day, month, day.end, month.end)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_cycle_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
<tr><td><code id="get_cycle_+3A_day">day</code></td>
<td>
<p>name of the column representing the days</p>
</td></tr>
<tr><td><code id="get_cycle_+3A_month">month</code></td>
<td>
<p>name of the column representing the months</p>
</td></tr>
<tr><td><code id="get_cycle_+3A_day.end">day.end</code></td>
<td>
<p>which day determines the end of a cycle?</p>
</td></tr>
<tr><td><code id="get_cycle_+3A_month.end">month.end</code></td>
<td>
<p>which month determines the end of a cycle?</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of integers.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(valentia)

# cycle ends on 31st of October
valentia$cycle &lt;- get_cycle(data = valentia, day = "day", month = "month",
                            day.end = 31, month.end = 10)
</code></pre>

<hr>
<h2 id='get_total_info'>
Compute Day Length, Mean Temperature, Thermal Units, and Cumulative Chill Days
</h2><span id='topic+get_total_info'></span>

<h3>Description</h3>

<p>Computes daily day length, mean temperature, thermal units and cumulative number of chill days for a dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_total_info(Tmax, Tmin, Tbase, lat, day)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_total_info_+3A_tmax">Tmax</code></td>
<td>
<p>a vector of daily maximum temperatures</p>
</td></tr>
<tr><td><code id="get_total_info_+3A_tmin">Tmin</code></td>
<td>
<p>a vector of daily minimum temperatures</p>
</td></tr>
<tr><td><code id="get_total_info_+3A_tbase">Tbase</code></td>
<td>
<p>the base temperature used to define a chill day</p>
</td></tr>
<tr><td><code id="get_total_info_+3A_lat">lat</code></td>
<td>
<p>the latitude</p>
</td></tr>
<tr><td><code id="get_total_info_+3A_day">day</code></td>
<td>
<p>day of the year (vector)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Implements the method by Forsythe et al. (1995) to calculate the day length, and the single-sine degree-day method to compute the thermal units.
</p>


<h3>Value</h3>

<p>Returns a <code>data.frame</code> with the day lengths, mean temperatures, thermal units and cumulative number of chill days.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.denadrademoral@mu.ie) and Rowan Fealy
</p>


<h3>References</h3>

<p>Cannell, M.G.R., Smith, R.I. (1983) Thermal time, chill days and prediction of budburst in Picea sitchensis. Journal of Applied Ecology, 20(3), 951–963.
</p>
<p>Forsythe et al. (1995) A model comparison for daylength as a function of latitude and day of the year. Ecological Modeling 80:87-95.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

with(casement9596, get_total_info(Tmax, Tmin, Tbase = 7, Lat, day))
</code></pre>

<hr>
<h2 id='phen_model'>
Phenology Model Evaluation
</h2><span id='topic+phen_model'></span>

<h3>Description</h3>

<p>Evaluates the phenology model for specified population quantiles, based on daily temperatures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phen_model(Tmean, thermal_units, chill_days, day_length,
           bud_pars, weib_pars, lactin_pars, max_day_length,
           pop_quantiles = c(0.05, 0.5, 0.95),
           print.l = FALSE, save.l = FALSE, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phen_model_+3A_tmean">Tmean</code></td>
<td>
<p>name of the column in the data representing the mean temperature</p>
</td></tr>
<tr><td><code id="phen_model_+3A_thermal_units">thermal_units</code></td>
<td>
<p>name of the column in the data representing the thermal units</p>
</td></tr>
<tr><td><code id="phen_model_+3A_chill_days">chill_days</code></td>
<td>
<p>name of the column in the data representing the number of chill days</p>
</td></tr>
<tr><td><code id="phen_model_+3A_day_length">day_length</code></td>
<td>
<p>name of the column in the data representing the day length</p>
</td></tr>
<tr><td><code id="phen_model_+3A_bud_pars">bud_pars</code></td>
<td>
<p>vector of parameters for the budburst model</p>
</td></tr>
<tr><td><code id="phen_model_+3A_weib_pars">weib_pars</code></td>
<td>
<p>matrix of parameters for the Weibull model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_+3A_lactin_pars">lactin_pars</code></td>
<td>
<p>matrix of parameters for the lactin model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_+3A_max_day_length">max_day_length</code></td>
<td>
<p>critical day length threshold</p>
</td></tr>
<tr><td><code id="phen_model_+3A_pop_quantiles">pop_quantiles</code></td>
<td>
<p>vector of quantiles of the population to be evaluated by the phenology model</p>
</td></tr>
<tr><td><code id="phen_model_+3A_print.l">print.l</code></td>
<td>
<p>logical. If <code>TRUE</code>, prints the cumulative development rates as the model iterates.</p>
</td></tr>
<tr><td><code id="phen_model_+3A_save.l">save.l</code></td>
<td>
<p>logical. If <code>TRUE</code>, returns the cumulative development rates instead of model evaluations.</p>
</td></tr>
<tr><td><code id="phen_model_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>As inputs, the model requires site latitude and daily minimum and maximum temperatures from the 1st November of the preceding year. Development, quantified by a temperature dependent development rate model defined for each life cycle stage, is initialised in the model following the simulated date of budburst, a biofix dependent on the accumulation of required thermal and chilling days from the 1st November of the preceding year, described below. Once budburst is simulated to have occurred, post-diapause pre-oviposition development commences. Following completion of the post-diapause pre-oviposition stage, the first day of egg-lay is returned for adult females emerging from overwintering. Oviposition period stage advancement occurs when the required development for this life cycle stage has been completed. Egg, larval and pupal development stages are then initiated sequentially. Following completion of the pupal development stage, the emerging adults enter a sexual maturation or post-eclosion pre-oviposition period. This life-cycle stage is hypothesised to be sensitive to a diapause-inducing stimulus - photoperiod (Tauber et al., 1986; Danks, 1987; Dalin, 2011; Hodek 2012; Pollard, 2014) - defined in the model as a critical day length (CDL) threshold. New generation adults that finish sexual maturation after the critical day length (CDL) enter into a state of reproductive diapause. P. vulgatissima adults that complete development prior to the CDL threshold can begin ovipositing to initiate subsequent generations.
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing model evaluations for each life cycle (columns) and population quantile (rows).
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>References</h3>

<p>Dalin P. (2011) Diapause induction and termination in a commonly univoltine leaf beetle (Phratora vulgatissima). Insect Science, 18, 443-450. doi:10.1111/j.1744-7917.2011.01417.x
</p>
<p>Danks, H.V. (1987) Insect dormancy: an ecological perspective 1st ed. H. V. Danks, ed., Biological Survey of Canada (Terrestrial Artropods) (Ottawa).
</p>
<p>Hodek, I. (2012) Adult diapause in Coleoptera. Psyche, 2012, 1–10.
</p>
<p>Tauber M.J., Tauber C.A. and Masaki S. (1986) Seasonal adaptations of insects. Oxford University Press, New York, USA
</p>
<p>Pollard, C. (2014) A Temperature-Dependent Development Model for Willow Beetle Species (Coleoptera: Chrysomelidae) in Ireland: Simulation of Phenology/Voltinism in Response to Climate Change. Unpublished PhD thesis, submitted to the National University of Ireland Maynooth, Maynooth, 1-373.
</p>
<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_phen_model">plot_phen_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

phen_model(Tmean = "Tmean",
           thermal_units = "thermal_units",
           chill_days = "chill_days",
           day_length = "day_length",
           bud_pars = pvulg_budburst_parameters,
           weib_pars = pvulg_weibull_parameters,
           lactin_pars = pvulg_lactin_parameters,
           max_day_length = 14.92,
           data = casement1995)
</code></pre>

<hr>
<h2 id='phen_model_forecast'>
Multi-Year Forecast Based on the Phenology Model
</h2><span id='topic+phen_model_forecast'></span>

<h3>Description</h3>

<p>A forecast based on the phenology model for multiple years, based on daily temperatures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phen_model_forecast(Tmean, thermal_units, chill_days, day_length,
                    bud_pars, weib_pars, lactin_pars,
                    max_day_length = 14.92, pop_quantile, year, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phen_model_forecast_+3A_tmean">Tmean</code></td>
<td>
<p>name of the column in the data representing the mean temperature</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_thermal_units">thermal_units</code></td>
<td>
<p>name of the column in the data representing the thermal units</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_chill_days">chill_days</code></td>
<td>
<p>name of the column in the data representing the number of chill days</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_day_length">day_length</code></td>
<td>
<p>name of the column in the data representing the day length</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_bud_pars">bud_pars</code></td>
<td>
<p>vector of parameters for the budburst model</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_weib_pars">weib_pars</code></td>
<td>
<p>matrix of parameters for the Weibull model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_lactin_pars">lactin_pars</code></td>
<td>
<p>matrix of parameters for the lactin model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_max_day_length">max_day_length</code></td>
<td>
<p>critical day length threshold</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_pop_quantile">pop_quantile</code></td>
<td>
<p>quantile of the population to be evaluated by the phenology model</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_year">year</code></td>
<td>
<p>a vector of indices representing each yearly cycle (usually the output from <code><a href="#topic+get_cycle">get_cycle</a></code>)</p>
</td></tr>
<tr><td><code id="phen_model_forecast_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+phen_model">phen_model</a></code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> with the number of rows equal to the total number of yearly cycles, and each column representing the developmental stage of the insect.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_phen_forecast">plot_phen_forecast</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(valentia)

valentia$cycle &lt;- get_cycle(data = valentia, day = "day", month = "month",
                            day.end = 31, month.end = 10)
valentia_split &lt;- split(valentia, valentia$cycle)
valentia_split &lt;- lapply(valentia_split,
                         function(x) data.frame(x,
                                                with(x, get_total_info(Tmax = x$max_temp,
                                                                       Tmin = x$min_temp,
                                                                       Tbase = 7,
                                                                       lat = x$Lat,
                                                                       x$day_of_year))))
valentia &lt;- do.call("rbind", valentia_split)

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

phen_forecast &lt;- phen_model_forecast(Tmean = "Tmean",
                                     thermal_units = "thermal_units",
                                     chill_days = "chill_days",
                                     day_length = "day_length",
                                     bud_pars = pvulg_budburst_parameters,
                                     weib_pars = pvulg_weibull_parameters,
                                     lactin_pars = pvulg_lactin_parameters,
                                     pop_quantile = .5,
                                     year = "cycle",
                                     data = valentia)
</code></pre>

<hr>
<h2 id='phen_model_gen2'>
Phenology Model Evaluation for Further Generations
</h2><span id='topic+phen_model_gen2'></span>

<h3>Description</h3>

<p>Evaluates the phenology model for specified population quantiles, based on daily temperatures for further generations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>phen_model_gen2(Tmean, day_length,
                bud_pars, weib_pars, lactin_pars,
                sex_mat_day, pop_quantiles = 0.5,
                max_day_length = 14.92, data)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="phen_model_gen2_+3A_tmean">Tmean</code></td>
<td>
<p>name of the column in the data representing the mean temperature</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_day_length">day_length</code></td>
<td>
<p>name of the column in the data representing the day length</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_bud_pars">bud_pars</code></td>
<td>
<p>vector of parameters for the budburst model</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_weib_pars">weib_pars</code></td>
<td>
<p>matrix of parameters for the Weibull model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_lactin_pars">lactin_pars</code></td>
<td>
<p>matrix of parameters for the lactin model for each developmental stage</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_sex_mat_day">sex_mat_day</code></td>
<td>
<p>the day individuals from the first generation reached the sexual maturation stage</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_pop_quantiles">pop_quantiles</code></td>
<td>
<p>vector of quantiles of the population to be evaluated by the phenology model</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_max_day_length">max_day_length</code></td>
<td>
<p>critical day length threshold</p>
</td></tr>
<tr><td><code id="phen_model_gen2_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>See <code><a href="#topic+phen_model">phen_model</a></code>
</p>


<h3>Value</h3>

<p>A <code>data.frame</code> containing model evaluations for each life cycle (columns) and population quantile (rows).
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_phen_model">plot_phen_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

phen95 &lt;- phen_model(Tmean = "Tmean",
                     thermal_units = "thermal_units",
                     chill_days = "chill_days",
                     day_length = "day_length",
                     bud_pars = pvulg_budburst_parameters,
                     weib_pars = pvulg_weibull_parameters,
                     lactin_pars = pvulg_lactin_parameters,
                     max_day_length = 14.92,
                     data = casement1995)
           
phen95_gen2 &lt;- phen_model_gen2(Tmean = "Tmean",
                               day_length = "day_length",
                               bud_pars = pvulg_budburst_parameters,
                               weib_pars = pvulg_weibull_parameters,
                               lactin_pars = pvulg_lactin_parameters,
                               sex_mat_day = phen95["0.05","sexual_maturation_day"],
                               pop_quantiles = .05,
                               data = casement1995)
</code></pre>

<hr>
<h2 id='plot_phen_forecast'>
Plot Phenology Model Multi-Year Forecast
</h2><span id='topic+plot_phen_forecast'></span>

<h3>Description</h3>

<p>Produces a plot of the phenology model multi-year forecasting evaluations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_phen_forecast(obj, year_from = 1, xlab = "Year",
                   ylab = "Days from 1st November")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_phen_forecast_+3A_obj">obj</code></td>
<td>
<p>an output from the <code><a href="#topic+phen_model_forecast">phen_model_forecast</a></code> function</p>
</td></tr>
<tr><td><code id="plot_phen_forecast_+3A_year_from">year_from</code></td>
<td>
<p>the first year we are forecasting for (e.g. &quot;2015&quot;)</p>
</td></tr>
<tr><td><code id="plot_phen_forecast_+3A_xlab">xlab</code></td>
<td>
<p>the x-axis label</p>
</td></tr>
<tr><td><code id="plot_phen_forecast_+3A_ylab">ylab</code></td>
<td>
<p>the y-axis label</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+valentia">valentia</a></code>
</p>

<hr>
<h2 id='plot_phen_model'>
Plot Phenology Model Evaluations
</h2><span id='topic+plot_phen_model'></span>

<h3>Description</h3>

<p>Produces a plot of the phenology model evaluations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_phen_model(obj, obj_gen2, binwidth = 8, forecast = FALSE,
                observed_data = NULL, ylab = "Days from 1st November",
                xlab = "Modelled Life-Cycle Stages", 
                labels = c("Budburst",
                           "Post-Diapause",
                           "Ovipositing Period (Eggs)",
                           "Larvae Emergence",
                           "Pupae Emergence",
                           "Adult Emergence",
                           "Sexual Maturation"))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_phen_model_+3A_obj">obj</code></td>
<td>
<p>an output of the <code><a href="#topic+phen_model">phen_model</a></code> or <code><a href="#topic+phen_model_forecast">phen_model_forecast</a></code> functions</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_obj_gen2">obj_gen2</code></td>
<td>
<p>an output of the <code><a href="#topic+phen_model_gen2">phen_model_gen2</a></code> or <code><a href="#topic+phen_model_forecast">phen_model_forecast</a></code> functions</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_binwidth">binwidth</code></td>
<td>
<p>binwidth of the density estimator</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_forecast">forecast</code></td>
<td>
<p>logical. Set to <code>TRUE</code> if you are plotting a multi-year forecast (i.e. if <code>obj</code> and <code>obj_gen2</code> are outputs of <code><a href="#topic+phen_model_forecast">phen_model_forecast</a></code>)</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_observed_data">observed_data</code></td>
<td>
<p>an output from the <code><a href="#topic+assign_observed_data">assign_observed_data</a></code> function</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_ylab">ylab</code></td>
<td>
<p>the y-axis label</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_xlab">xlab</code></td>
<td>
<p>the x-axis label</p>
</td></tr>
<tr><td><code id="plot_phen_model_+3A_labels">labels</code></td>
<td>
<p>a vector of strings representing the names of the life-cycle stages</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Visualisation of days until stage completion for different life cycle stages and generations. Plot can incorporate observed data, where available. All dates are counted from the 1st of November of the previous year. The estimated density is based on a Gaussian kernel whose binwidth can be easily modified using argument <code>binwidth</code>. To add observed data points, see <code><a href="#topic+assign_observed_data">assign_observed_data</a></code>.
</p>
<p>Since this is a <code>ggplot</code> object, layers can be easily added by using standard <code>ggplot</code> functions.
</p>


<h3>Value</h3>

<p>A <code>ggplot</code> object.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>References</h3>

<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phen_model">phen_model</a></code>, <code><a href="#topic+phen_model_gen2">phen_model_gen2</a></code>, <code><a href="#topic+phen_model_forecast">phen_model_forecast</a></code>
</p>

<hr>
<h2 id='pvulg_budburst_parameters'>
Estimated Parameters for the Exponential Decay Model for Budburst
</h2><span id='topic+pvulg_budburst_parameters'></span>

<h3>Description</h3>

<p>Vector of estimated parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pvulg_budburst_parameters")</code></pre>


<h3>Format</h3>

<p>The format is:
Named num [1:2] 540.196 -0.016
- attr(*, &quot;names&quot;)= chr [1:2] &quot;b&quot; &quot;m&quot;
</p>


<h3>Details</h3>

<p>The method implied is based on the Alternating Model, which is a degree-day model that accumulates thermal/chilling units above/below a base threshold from a specified date (Cannell and Smith, 1983). The b and m values correspond to the estimates for budburst for Salix viminalis (Pollard et al., submitted).
</p>


<h3>Source</h3>

<p>Chmielewski, F.M., Heider, S., Moryson, S. and Bruns, E. (2013) International phenological observation networks: concept of IPG and GPM. In M. D. Schwartz, ed. Phenology: An integrative environmental science. New York London: Springer, p. 610.
</p>


<h3>References</h3>

<p>Cannell, M.G.R. and Smith, R.I. (1983) Thermal time, chill days and prediction of budburst in Picea sitchensis. Journal of Applied Ecology, 20(3), 951–963.
</p>
<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pvulg_budburst_parameters)
</code></pre>

<hr>
<h2 id='pvulg_lactin_parameters'>
Estimated Parameters for the Lactin Model for P. Vulgatissima
</h2><span id='topic+pvulg_lactin_parameters'></span>

<h3>Description</h3>

<p>Matrix of estimated parameters for each stage of the life-cycle of P. vulgatissima
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pvulg_lactin_parameters")</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:4, 1:6] 0.00864 28.94449 0.52103 -1.06402 0.002 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:4] &quot;rho&quot; &quot;Tmax&quot; &quot;deltaT&quot; &quot;lambda&quot;
..$ : chr [1:6] &quot;post_diapause&quot; &quot;ovipositing&quot; &quot;larva_emergence&quot; &quot;pupa_emergence&quot; ...
</p>


<h3>Details</h3>

<p>The parameters were derived based on constant temperature laboratory experiments (see Pollard, 2014) for different life-cycle stages of P. vulgatissima. Development times were converted to rates and subsequently used as input for the Lactin model (Lactin et al., 1995). The model was fitted to the entire temperature range, including where there was no development rate (at the upper temperature threshold).
</p>


<h3>Source</h3>

<p>Pollard, C. (2014) A Temperature-Dependent Development Model for Willow Beetle Species (Coleoptera: Chrysomelidae) in Ireland: Simulation of Phenology/Voltinism in Response to Climate Change. Unpublished PhD thesis, submitted to the National University of Ireland Maynooth, Maynooth, 1-373.
</p>


<h3>References</h3>

<p>Lactin D.J., Holliday N.J., Johnson D.L. and Craigen R. (1995) Improved rate model of temperature-dependent development by arthropods. Environmental Entomology, 24, 68–75. doi:10.1093/ee/24.1.68
</p>
<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pvulg_lactin_parameters)
</code></pre>

<hr>
<h2 id='pvulg_weibull_parameters'>
Estimated Parameters for the Weibull Model for P. Vulgatissima
</h2><span id='topic+pvulg_weibull_parameters'></span>

<h3>Description</h3>

<p>Matrix of estimated parameters for each stage of the life-cycle of P. vulgatissima
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("pvulg_weibull_parameters")</code></pre>


<h3>Format</h3>

<p>The format is:
num [1:3, 1:6] 0.7207 0.3517 1.7918 -0.0716 0.5117 ...
- attr(*, &quot;dimnames&quot;)=List of 2
..$ : chr [1:3] &quot;gamma&quot; &quot;eta&quot; &quot;beta&quot;
..$ : chr [1:6] &quot;post_diapause&quot; &quot;ovipositing&quot; &quot;larva_emergence&quot; &quot;pupa_emergence&quot; ...
</p>


<h3>Details</h3>

<p>The parameters were derived based on constant temperature laboratory experiments (see Pollard, 2014) for different life-cycle stages of P. vulgatissima. Development times (or rates) were derived as cumulative frequency distributions at each temperature; development times for each percentile were then divided by the respective median value of the distribution to produce a normalised (&quot;same shape&quot;) distribution of development times at each temperature (Wagner et al., 1984; 1991). Based on the &quot;same shape&quot; assumption, a single cumulative distribution representing the normalised distributions for all temperature treatments was produced by averaging all the distributions, weighted by the total frequency of each distribution (Wagner et al., 1984; 1991).
</p>


<h3>Source</h3>

<p>Pollard, C. (2014) A Temperature-Dependent Development Model for Willow Beetle Species (Coleoptera: Chrysomelidae) in Ireland: Simulation of Phenology/Voltinism in Response to Climate Change. Unpublished PhD thesis, submitted to the National University of Ireland Maynooth, Maynooth, 1-373.
</p>


<h3>References</h3>

<p>Wagner T.L., Olson R.L. and Willers J.L. (1991) Modeling arthropod development time. Journal of Agricultural Entomology, 8, 251-270.
</p>
<p>Wagner T.L., Wu H.I., Sharpe P.J.H. and Coulson R.N. (1984) Modeling distributions of insect development time: a literature review and application of the Weibull function. Annals of the Entomological Society of America, 77, 475-487. doi:10.1093/aesa/77.2.208
</p>
<p>Pollard C.P., Griffin C.T., Moral R.A., Duffy C., Chuche J., Gaffney M.T., Fealy R. (submitted) phenModel: a temperature-dependent phenology model for the blue willow beetle, Phratora vulgatissima.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(pvulg_weibull_parameters)
</code></pre>

<hr>
<h2 id='sensitivity'>
Sensitivity Analysis for Evaluated Phenology Model
</h2><span id='topic+sensitivity'></span><span id='topic+sensitivity_Tbase'></span><span id='topic+sensitivity_lactin'></span><span id='topic+sensitivity_weibull'></span><span id='topic+sensitivity_bud_days'></span><span id='topic+sensitivity_bud_parms'></span><span id='topic+sensitivity_cdl'></span><span id='topic+summary_sensitivity'></span><span id='topic+boxplot_sensitivity'></span>

<h3>Description</h3>

<p>Runs a sensitivity analysis on the evaluated phenology model, by simulating random changes to fitted parameters and/or specifying a range of base temperatures to determine a chill day.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sensitivity(Tmax, Tmin, Tbase, lat, day,
            bud_pars, weib_pars, lactin_pars, max_day_length, 
            pop_quantile = .5, data,
            study_type = c("Tbase","lactin","weibull","bud_days","bud_parms","cdl"),
            percent_variation = .1, resolution = 1000)

summary_sensitivity(obj)

boxplot_sensitivity(obj)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sensitivity_+3A_obj">obj</code></td>
<td>
<p>an output from a call to the <code>sensitivity</code> function</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_tmax">Tmax</code></td>
<td>
<p>a vector of daily maximum temperatures</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_tmin">Tmin</code></td>
<td>
<p>a vector of daily minimum temperatures</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_tbase">Tbase</code></td>
<td>
<p>the base temperature</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_lat">lat</code></td>
<td>
<p>the latitude</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_day">day</code></td>
<td>
<p>day of the year (vector)</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_bud_pars">bud_pars</code></td>
<td>
<p>vector of parameters for the budburst model</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_weib_pars">weib_pars</code></td>
<td>
<p>matrix of parameters for the Weibull model for each developmental stage</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_lactin_pars">lactin_pars</code></td>
<td>
<p>matrix of parameters for the lactin model for each developmental stage</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_max_day_length">max_day_length</code></td>
<td>
<p>critical day length threshold</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_pop_quantile">pop_quantile</code></td>
<td>
<p>quantile of the population to be evaluated by the phenology model</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_data">data</code></td>
<td>
<p>a <code>data.frame</code></p>
</td></tr>
<tr><td><code id="sensitivity_+3A_study_type">study_type</code></td>
<td>
<p>a character string indicating what type of sensitivity study to be performed. <code>"Tbase"</code> runs a sensitivity study for the temperature threshold that classifies a chill day; <code>"lactin"</code> runs a sensitivity study on variations of the values for the parameters estimated by the lactin model; <code>"weibull"</code> does the same as the latter, but for the Weibull model; <code>"bud_days"</code> changes the budburst day while <code>"bud_parms"</code> randomly changes the parameter estimates for the exponential decay function associated with budburst prediction; <code>"cdl"</code> changes the critical day length threshold</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_percent_variation">percent_variation</code></td>
<td>
<p>percentage of variation of the values to be changed for the sensitivity analysis</p>
</td></tr>
<tr><td><code id="sensitivity_+3A_resolution">resolution</code></td>
<td>
<p>number of model evaluations to be performed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>list</code> containing the sensitivity analysis results as the first component, and the original model evaluation results as the second component.
</p>


<h3>Author(s)</h3>

<p>Rafael de Andrade Moral (rafael.deandrademoral@mu.ie) and Rowan Fealy
</p>


<h3>See Also</h3>

<p><code><a href="#topic+phen_model">phen_model</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(casement9596)

casement1995 &lt;- data.frame(casement9596, 
                           with(casement9596, 
                                get_total_info(Tmax, Tmin, Tbase = 7, Lat, day)))

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

sens_casement1995 &lt;- sensitivity(Tmax = casement9596$Tmax,
                                 Tmin = casement9596$Tmin,
                                 Tbase = 7,
                                 lat = casement9596$Lat,
                                 day = casement9596$day,
                                 bud_pars = pvulg_budburst_parameters,
                                 weib_pars = pvulg_weibull_parameters,
                                 lactin_pars = pvulg_lactin_parameters,
                                 max_day_length = 14.92, 
                                 pop_quantile = .5,
                                 data = casement9596,
                                 study_type = "lactin",
                                 percent_variation = .1,
                                 resolution = 100)
                                 
summary_sensitivity(sens_casement1995)

boxplot_sensitivity(sens_casement1995)
</code></pre>

<hr>
<h2 id='valentia'>
Valentia Data
</h2><span id='topic+valentia'></span>

<h3>Description</h3>

<p>Daily minimum and maximum temperature data obtained at the Valentia synoptic weather station for the period of 1st November 1939 to 31st October 2000.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("valentia")</code></pre>


<h3>Format</h3>

<p>A data frame with 22281 observations on the following 7 variables.
</p>

<dl>
<dt><code>year</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>month</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>day</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>Lat</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>max_temp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>min_temp</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>day_of_year</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Details</h3>

<p>The data was obtained from the Irish National Meteorological Agency (Met Éireann).
</p>


<h3>Source</h3>

<p>https://www.met.ie/climate/available-data/historical-data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(valentia)

valentia$cycle &lt;- get_cycle(data = valentia, day = "day", month = "month",
                            day.end = 31, month.end = 10)
valentia_split &lt;- split(valentia, valentia$cycle)
valentia_split &lt;- lapply(valentia_split,
                         function(x) data.frame(x,
                                                with(x, get_total_info(Tmax = x$max_temp,
                                                                       Tmin = x$min_temp,
                                                                       Tbase = 7,
                                                                       lat = x$Lat,
                                                                       x$day_of_year))))
valentia &lt;- do.call("rbind", valentia_split)

data(pvulg_budburst_parameters)
data(pvulg_weibull_parameters)
data(pvulg_lactin_parameters)

phen_forecast &lt;- phen_model_forecast(Tmean = "Tmean",
                                     thermal_units = "thermal_units",
                                     chill_days = "chill_days",
                                     day_length = "day_length",
                                     bud_pars = pvulg_budburst_parameters,
                                     weib_pars = pvulg_weibull_parameters,
                                     lactin_pars = pvulg_lactin_parameters,
                                     pop_quantile = .5,
                                     year = "cycle",
                                     data = valentia)

plot_phen_model(obj = phen_forecast[,1:7], obj_gen2 = phen_forecast[,8:12],
                forecast = TRUE)

plot_phen_forecast(obj = phen_forecast, year_from = 1939)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
