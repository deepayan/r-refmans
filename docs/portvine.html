<!DOCTYPE html><html lang="en"><head><title>Help for package portvine</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {portvine}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#default_garch_spec'><p>Default specifications for ARMA-GARCH models</p></a></li>
<li><a href='#est_es'><p>Estimate the Expected Shortfall (ES)</p></a></li>
<li><a href='#est_var'><p>Estimate the Value at Risk (VaR)</p></a></li>
<li><a href='#estimate_risk_roll'><p>(Un-)conditional rolling risk estimation using vine copulas</p></a></li>
<li><a href='#fitted_marginals'><p>Accessor method for the fitted marginal models of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code></p>
objects</a></li>
<li><a href='#fitted_vines'><p>Accessor method for the fitted vine copula models of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code></p>
objects</a></li>
<li><a href='#marginal_settings-class'><p>S4 class for the marginal settings</p></a></li>
<li><a href='#portvine_roll-class'><p>S4 output class for the function <code>estimate_risk_roll()</code></p></a></li>
<li><a href='#risk_estimates'><p>Accessor methods for the risk estimates of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code> objects</p></a></li>
<li><a href='#roll_residuals'><p>Extract fitted standardized residuals from a uGARCHroll object</p></a></li>
<li><a href='#sample_returns_small'><p>A sample of log returns for 3 assets.</p></a></li>
<li><a href='#vine_settings-class'><p>S4 class for the vine settings</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Vine Based (Un)Conditional Portfolio Risk Measure Estimation</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Following Sommer (2022) <a href="https://mediatum.ub.tum.de/1658240">https://mediatum.ub.tum.de/1658240</a>
    portfolio level risk estimates (e.g. Value at Risk, Expected
    Shortfall) are estimated by modeling each asset univariately by an
    ARMA-GARCH model and then their cross dependence via a Vine Copula
    model in a rolling window fashion. One can even condition on
    variables/time series at certain quantile levels to stress test the
    risk measure estimates.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/EmanuelSommer/portvine">https://github.com/EmanuelSommer/portvine</a>,
<a href="https://emanuelsommer.github.io/portvine/">https://emanuelsommer.github.io/portvine/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/EmanuelSommer/portvine/issues">https://github.com/EmanuelSommer/portvine/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>checkmate, data.table, dplyr, dtplyr, future.apply, methods,
ppcor, Rcpp (&ge; 0.12.12), rlang, rugarch, rvinecopulib, tidyr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, future, ggplot2, ggtext, knitr, patchwork, rmarkdown,
scales, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, kde1d, Rcpp, RcppEigen, RcppThread, rvinecopulib, wdm</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Collate:</td>
<td>'RcppExports.R' 'default_garch_spec.R' 'S4_classes.R'
'datadoc_and_rcpp.R' 'dvine_ordering.R' 'risk_measures.R'
'rcondvinecop.R' 'estimate_dependence_and_risk.R'
'estimate_marginal_models.R' 'estimate_risk_roll.R' 'utils.R'</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-01-18 16:00:15 UTC; emanuel</td>
</tr>
<tr>
<td>Author:</td>
<td>Emanuel Sommer [cre, aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emanuel Sommer &lt;emanuel_sommer@gmx.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-01-18 16:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='default_garch_spec'>Default specifications for ARMA-GARCH models</h2><span id='topic+default_garch_spec'></span>

<h3>Description</h3>

<p>This function is used as the default for the univariate model fitting i.e.
the marginal models and can be used to easily specify a different
individual marginal model specification or default in
<code><a href="#topic+marginal_settings">marginal_settings()</a></code>.
The ARMA(<code>ar</code>,<code>ma</code>)-GARCH(<code>arch</code>,<code>garch</code>) is fitted  with the distribution
given by <code>dist</code> that specifies the conditional density used for the
innovations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>default_garch_spec(ar = 1, ma = 1, arch = 1, garch = 1, dist = "sstd")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="default_garch_spec_+3A_ar">ar</code></td>
<td>
<p>integer for the autoregressive order</p>
</td></tr>
<tr><td><code id="default_garch_spec_+3A_ma">ma</code></td>
<td>
<p>integer for the moving average order</p>
</td></tr>
<tr><td><code id="default_garch_spec_+3A_arch">arch</code></td>
<td>
<p>integer for the ARCH order</p>
</td></tr>
<tr><td><code id="default_garch_spec_+3A_garch">garch</code></td>
<td>
<p>integer for the GARCH order</p>
</td></tr>
<tr><td><code id="default_garch_spec_+3A_dist">dist</code></td>
<td>
<p>a single character value of the possible distributions allowed in
<code><a href="rugarch.html#topic+ugarchspec-methods">rugarch::ugarchspec</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class <code><a href="rugarch.html#topic+ugarchspec-methods">rugarch::ugarchspec</a></code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+marginal_settings">marginal_settings()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the default is then just using
default_garch_spec()
# to specify a ARMA(2,2)-GARCH(1,1) model with normal residual distribution
default_garch_spec(ar = 2, ma = 2, dist = "norm")
</code></pre>

<hr>
<h2 id='est_es'>Estimate the Expected Shortfall (ES)</h2><span id='topic+est_es'></span>

<h3>Description</h3>

<p>The Expected Shortfall at level <code class="reqn">\alpha</code> is defined as the expected value
of the returns under the condition that the returns are smaller than the
Value at Risk for the same <code class="reqn">\alpha</code> level. Note that an absolutely
continuous distribution of the returns is assumed.
The three estimation methods are:
</p>

<ul>
<li> <p><code>mean</code> the mean of the samples that fall under the corresponding VaR.
</p>
</li>
<li> <p><code>median</code> the median of the samples that fall under the corresponding VaR.
</p>
</li>
<li> <p><code>mc</code> Calculation of the expected value using Monte Carlo integration over
the <code class="reqn">\alpha</code> levels. One draws <code>mc_samples</code> Monte Carlo samples .
</p>
</li></ul>



<h3>Usage</h3>

<pre><code class='language-R'>est_es(sample, alpha, method = c("mean", "median", "mc"), mc_samples = 100)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_es_+3A_sample">sample</code></td>
<td>
<p>Numeric vector representing the sample upon which the Expected
Shortfall is calculated.</p>
</td></tr>
<tr><td><code id="est_es_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector with entries in (0,1) specifying the levels at
which the ES is calculated.</p>
</td></tr>
<tr><td><code id="est_es_+3A_method">method</code></td>
<td>
<p>Method of estimation one of <code>mean</code>, <code>median</code>, <code>mc</code>. For more
information see the Description section.</p>
</td></tr>
<tr><td><code id="est_es_+3A_mc_samples">mc_samples</code></td>
<td>
<p>Number of Monte Carlo samples used for the <code>mc</code> method.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with Expected Shortfall estimates
(same length as <code>alpha</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+est_var">est_var()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>est_es(0:100, c(0.1, 0.2, 0.3))
</code></pre>

<hr>
<h2 id='est_var'>Estimate the Value at Risk (VaR)</h2><span id='topic+est_var'></span>

<h3>Description</h3>

<p>The VaR is defined as the empirical <code class="reqn">\alpha</code> level quantile of the
empirical distribution based on a return sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est_var(sample, alpha)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est_var_+3A_sample">sample</code></td>
<td>
<p>Numeric vector representing the sample upon which the Value at
Risk is calculated.</p>
</td></tr>
<tr><td><code id="est_var_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector with entries in (0,1) specifying the levels at
which the VaR is calculated.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector with VaR estimates
(same length as <code>alpha</code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+est_es">est_es()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>est_var(0:100, c(0.1, 0.2, 0.3))
</code></pre>

<hr>
<h2 id='estimate_risk_roll'>(Un-)conditional rolling risk estimation using vine copulas</h2><span id='topic+estimate_risk_roll'></span>

<h3>Description</h3>

<p>As this is the main workhorse function with a lot going on under the hood it
is advised to have a look at the vignettes or even better the package website
as they provide a detailed hands on and theoretical documentation of what
this function is doing and how it is intended to be used. For a short
summarized explanation have a look at the Details section below.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate_risk_roll(
  data,
  weights = NULL,
  marginal_settings,
  vine_settings,
  alpha = 0.05,
  risk_measures = c("VaR", "ES_mean"),
  n_samples = 1000,
  cond_vars = NULL,
  cond_u = 0.05,
  n_mc_samples = 1000,
  trace = FALSE,
  cutoff_depth = NULL,
  prior_resid_strategy = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimate_risk_roll_+3A_data">data</code></td>
<td>
<p>Matrix, data.frame or other object coercible to a data.table
storing the numeric asset returns in the named columns (at least 3).
Moreover missing values must be imputed beforehand.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_weights">weights</code></td>
<td>
<p>Corresponding named non-negative weights of the assets
(conditioning variables must have weight 0). Default <code>NULL</code> gives equal
weight of 1 to each non conditional asset. Alternatively one can use a matrix
with as many rows as vine windows for changing weights. The matrix must have
column names corresponding to the assets and conditional assets have to have
weight 0.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_marginal_settings">marginal_settings</code></td>
<td>
<p><code><a href="#topic+marginal_settings">marginal_settings</a></code> S4 object containing the
needed information for the ARMA-GARCH i.e. marginal models fitting. Note
that the <code>marginal_settings</code> and <code>vine_settings</code> objects have to match as
described further below.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_vine_settings">vine_settings</code></td>
<td>
<p><code><a href="#topic+vine_settings">vine_settings</a></code> S4 object containing the
needed information for the vine copula model fitting. Note
that the <code>marginal_settings</code> and <code>vine_settings</code> objects have to match as
described further below.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_alpha">alpha</code></td>
<td>
<p>Numeric vector specifying the confidence levels in (0,1) at
which the risk measures should be calculated.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_risk_measures">risk_measures</code></td>
<td>
<p>Character vector with valid choices for risk
measures to estimate. Currently available are the Value at Risk <code>VaR</code> which
is implemented in <code><a href="#topic+est_var">est_var()</a></code> and 3 estimation methods of the Expected
Shortfall <code>ES_mean</code>, <code>ES_median</code> and <code>ES_mc</code> all implemented in <code><a href="#topic+est_es">est_es()</a></code>
.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_n_samples">n_samples</code></td>
<td>
<p>Positive count of samples to be used at the base of the risk
measure estimation.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_cond_vars">cond_vars</code></td>
<td>
<p>Names of the variables to sample conditionally from
(currently <code class="reqn">\le 2</code> variables).</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_cond_u">cond_u</code></td>
<td>
<p>Numeric vector specifying the corresponding quantiles
in (0,1) of the conditional variable(s) conditioned on which the conditional
risk measures should be calculated. Additionally always the conditioning
values corresponding to the residual of one time unit prior are used as
conditional variables (<code>cond_u</code> = 'prior_resid' in the risk measure output)
if the flag<code>prior_resid</code> is set to TRUE, otherwise the conditioning values
corresponding to the realized residual are used (<code>cond_u</code> = 'resid'
in the risk measure output). The latter case corresponds to the default.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_n_mc_samples">n_mc_samples</code></td>
<td>
<p>Positive count of samples for the Monte Carlo integration
if the risk measure <code>ES_mc</code> is used. (See <code><a href="#topic+est_es">est_es()</a></code>)</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_trace">trace</code></td>
<td>
<p>If set to TRUE the algorithm will print a little information
while running.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_cutoff_depth">cutoff_depth</code></td>
<td>
<p>Positive count that specifies the depth up to which the
edges of the to be constructed D-vine copula are considered in the algorithm
that determines the ordering for the D-vine fitting using partial
correlations. The default <code>NULL</code>
considers all edges and seems in most use cases reasonable. This argument is
only relevant if D-vines are used.</p>
</td></tr>
<tr><td><code id="estimate_risk_roll_+3A_prior_resid_strategy">prior_resid_strategy</code></td>
<td>
<p>Logical flag that indicates whether as the
additionally
used conditioning values the prior day residual (if this flag is TRUE) or the
realized residuals are used. The default are the realized residuals. Note
that the resulting conditional risk measures use realized data so they are
only for comparisons as they suffer from information leakage.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Roughly speaking the function performs the following steps for the
<strong>unconditional risk measure estimation</strong>:
</p>

<ul>
<li><p> Fit for each asset marginal time series models i.e. ARMA-GARCH models in
a rolling window fashion. The models as well as the rolling window size and
training size are specified via the <code>marginal_settings</code> argument.
</p>
</li>
<li><p> Model the dependence between the assets with a vine copula model trained on
the standardized residuals transformed to the copula scale via the
probability integral transform. This is also performed in a rolling window
fashion where one can use the same window size for the vine windows
as used for the marginal ones or a smaller window size. This window size, the
training size for the vine copula as well as the copula fitting arguments are
specified via the <code>vine_settings</code> argument.
</p>
</li>
<li><p> Using the copula and the forecasted means and volatilities of the assets
one simulates <code>n_samples</code> many forecasted portfolio level log returns for
every time unit in every specified rolling window.
</p>
</li>
<li><p> Based on these samples one estimates portfolio level risk measures.
</p>
</li></ul>

<p>Additionally one can perform <strong>conditional risk measure estimation</strong> with up
to two conditional log return series like market indices. Using this approach
does not change the marginal models part but for the copula a D-vine with a
special ordering i.e. the index or the indices are fixed as the rightmost
leafs is fitted. One then simulates conditional forecasted portfolio log
returns which then
results in conditional risk measure estimates that can be particularly
interesting in stress testing like situations. One conditions on a
pre-specified quantile level (<code>cond_u</code>) of the conditioning assets
(<code>cond_vars</code>) and for comparison one also conditions either on the behavior
of the conditioning asset one time unit before
(<code>prior_resid_strategy = TRUE</code>) or the realized behavior of the
conditioning asset (<code>prior_resid_strategy = FALSE</code>).
</p>


<h3>Value</h3>

<p>In the unconditional case an S4 object of class <code>portvine_roll</code> and
in the conditional case its child class <code>cond_portvine_roll</code>. For details
see <code><a href="#topic+portvine_roll-class">portvine_roll</a></code>.
</p>


<h3>Matching marginal and vine settings</h3>

<p>First of all there must be at least 2 marginal windows. Thus <code>train_size</code> +
<code>refit_size</code> slot in the <code><a href="#topic+marginal_settings">marginal_settings</a></code> class object must be smaller
than the overall input data size. Moreover the <code>refit_size</code> of the marginal
models must be dividable by the <code>refit_size</code> of the vine copula models e.g.
possible combinations are 50 and 50, 50 and 25, 50 and 10. Furthermore the
<code>train_size</code> of the vines must be smaller or equal to the <code>train_size</code> of
the marginal models.
</p>


<h3>Parallel processing</h3>

<p>This function uses the <a href="https://www.futureverse.org/"><code>future</code></a>
framework for parallelization that allows maximum flexibility for the user
while having safe speedups for example regarding random number generation.
The default is of course the standard non parallel sequential evaluation.
The user has to do nothing in order for this default to work. If the user
wants to run the code in parallel there are many options from parallel on a
single machine up to a high performance compute (HPC) cluster, all of this
with just one setting switch i.e. by calling the function <code><a href="future.html#topic+plan">future::plan()</a></code>
with the respective argument before the function call. Common options are
<code>future::plan("multisession")</code> which works on all major operating systems
and uses all available cores to run the code in parallel local R sessions.
To specify the number of workers use
<code>future::plan("multisession", workers = 2)</code>. To go back to sequential
processing and to shut down the parallel sessions use
<code>future::plan("sequential")</code>.
For more information have a look at <code><a href="future.html#topic+plan">future::plan()</a></code>. The two following
loops are processed in parallel by default if a parallel <code><a href="future.html#topic+plan">future::plan()</a></code>
is set:
</p>

<ul>
<li><p> The marginal model fitting i.e. all assets individually in parallel.
</p>
</li>
<li><p> The vine windows i.e. the risk estimates and the corresponding vine copula
models are computed in parallel for each rolling vine window.
</p>
</li></ul>

<p>In addition the function allows for nested parallelization which has to
be done with care. So in addition to the 2 loops above one can further
run each computation for each time unit in the vine windows in parallel which
might be especially interesting if the <code>n_samples</code> argument is large. Then
the default parallelization has to be tweaked to not only parallelize the
first level of parallelization which are the 2 loops above. This can be
achieved e.g. via <code>future::plan(list(future::tweak(future::multisession, workers = 4), future::tweak(future::multisession, workers = 2)))</code>. This
setting would run the 2 primary loops in 4 parallel R sessions and in
addition each of the 4 primary parallel sessions would itself use 2 sessions
within the nested parallel loop over the time units in the vine window. This
results in a need for at least 2 times 4 so 8 threads on the hardware side.
More details can be found in the extensive documentation of the
<a href="https://www.futureverse.org/"><code>future</code></a> framework.
</p>


<h3>Author(s)</h3>

<p>Emanuel Sommer
</p>


<h3>See Also</h3>

<p><code><a href="#topic+portvine_roll-class">portvine_roll</a></code>, <code><a href="#topic+marginal_settings">marginal_settings</a></code>, <code><a href="#topic+vine_settings">vine_settings</a></code>,
<code><a href="#topic+est_var">est_var()</a></code>, <code><a href="#topic+est_es">est_es()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># For better illustrated examples have a look at the vignettes
# and/or the package website.

data("sample_returns_small")
ex_marg_settings &lt;- marginal_settings(
  train_size = 900,
  refit_size = 50
)
ex_vine_settings &lt;- vine_settings(
  train_size = 100,
  refit_size = 50,
  family_set = c("gaussian", "gumbel"),
  vine_type = "dvine"
)
# unconditionally
risk_roll &lt;- estimate_risk_roll(
  sample_returns_small,
  weights = NULL,
  marginal_settings = ex_marg_settings,
  vine_settings = ex_vine_settings,
  alpha = c(0.01, 0.05),
  risk_measures = c("VaR", "ES_mean"),
  n_samples = 10,
  trace = FALSE
)
# conditional on one asset
risk_roll_cond &lt;- estimate_risk_roll(
  sample_returns_small,
  weights = NULL,
  marginal_settings = ex_marg_settings,
  vine_settings = ex_vine_settings,
  alpha = c(0.01, 0.05),
  risk_measures = c("VaR", "ES_mean"),
  n_samples = 10,
  cond_vars = "GOOG",
  cond_u = c(0.05, 0.5),
  trace = FALSE,
  prior_resid_strategy = TRUE
)

# have a superficial look
risk_roll_cond
# a slightly more detailed look
summary(risk_roll_cond)

# actually use the results by extracting important fitted quantities
fitted_vines(risk_roll_cond)
fitted_marginals(risk_roll_cond)

# and of course most importantly the risk measure estimates
risk_estimates(
  risk_roll,
  risk_measures = "ES_mean",
  alpha = 0.05, exceeded = TRUE
)
risk_estimates(
  risk_roll_cond,
  risk_measures = "ES_mean",
  alpha = 0.05, exceeded = TRUE,
  cond_u = c("prior_resid", 0.5)
)

</code></pre>

<hr>
<h2 id='fitted_marginals'>Accessor method for the fitted marginal models of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code>
objects</h2><span id='topic+fitted_marginals'></span><span id='topic+fitted_marginals+2Cportvine_roll-method'></span>

<h3>Description</h3>

<p>Extract the marginal models that are ARMA-GARCH models which were fitted
in a rolling
window fashion using <code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code>. For the residual analysis of
the models encompassed in such a <code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code> class object one
can have a look at the utility function <code><a href="#topic+roll_residuals">roll_residuals()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_marginals(roll, ...)

## S4 method for signature 'portvine_roll'
fitted_marginals(roll)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted_marginals_+3A_roll">roll</code></td>
<td>
<p>Object of class <code>portvine_roll</code> or a child class</p>
</td></tr>
<tr><td><code id="fitted_marginals_+3A_...">...</code></td>
<td>
<p>Additional parameters for child class methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named list with an entry for each asset containing a
<code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code> class object that encompasses the marginal model fit.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+portvine_roll-class">portvine_roll</a></code>, <code><a href="#topic+roll_residuals">roll_residuals()</a></code>
</p>

<hr>
<h2 id='fitted_vines'>Accessor method for the fitted vine copula models of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code>
objects</h2><span id='topic+fitted_vines'></span><span id='topic+fitted_vines+2Cportvine_roll-method'></span>

<h3>Description</h3>

<p>Accessor method for the fitted vine copula models of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code>
objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_vines(roll, ...)

## S4 method for signature 'portvine_roll'
fitted_vines(roll)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted_vines_+3A_roll">roll</code></td>
<td>
<p>Object of class <code>portvine_roll</code> or a child class</p>
</td></tr>
<tr><td><code id="fitted_vines_+3A_...">...</code></td>
<td>
<p>Additional parameters for child class methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List of <code><a href="rvinecopulib.html#topic+vinecop">rvinecopulib::vinecop</a></code> class objects each entry
corresponds to one fitted vine copula model for the respective vine window.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+portvine_roll-class">portvine_roll</a></code>
</p>

<hr>
<h2 id='marginal_settings-class'>S4 class for the marginal settings</h2><span id='topic+marginal_settings-class'></span><span id='topic+marginal_settings'></span><span id='topic+show+2Cmarginal_settings-method'></span>

<h3>Description</h3>

<p>Specify which marginal models (<code>individual_spec</code> &amp; <code>default_specs</code>) are
fitted and how often they are refit as well as how big the training data
set is. Remember that the forecasting is done in a rolling window fashion
and the arguments (train and refit size) will have to match with
the arguments of the also to be specified <code><a href="#topic+vine_settings">vine_settings</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_settings(
  train_size,
  refit_size,
  individual_spec = list(),
  default_spec = default_garch_spec()
)

## S4 method for signature 'marginal_settings'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="marginal_settings-class_+3A_train_size">train_size</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="marginal_settings-class_+3A_refit_size">refit_size</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="marginal_settings-class_+3A_individual_spec">individual_spec</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="marginal_settings-class_+3A_default_spec">default_spec</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="marginal_settings-class_+3A_object">object</code></td>
<td>
<p>An object of class <code>marginal_settings</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For specifying the list for <code>individual_spec</code> or the argument <code>default_spec</code>
the function <code><a href="#topic+default_garch_spec">default_garch_spec()</a></code> might
come in handy.
</p>


<h3>Value</h3>

<p>Object of class <code>marginal_settings</code>
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>marginal_settings()</code>: Class constructor taking the arguments
specified in the slots below
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>train_size</code></dt><dd><p>Positive count specifying the training data size.</p>
</dd>
<dt><code>refit_size</code></dt><dd><p>Positive count specifying size of the forecasting
window.</p>
</dd>
<dt><code>individual_spec</code></dt><dd><p>A named list. Specify ARMA-GARCH models for individual
assets by naming the list entry as the asset and providing a
<code><a href="rugarch.html#topic+ugarchspec-methods">rugarch::ugarchspec</a></code> object.</p>
</dd>
<dt><code>default_spec</code></dt><dd><p><code><a href="rugarch.html#topic+ugarchspec-methods">rugarch::ugarchspec</a></code>
object specifying the default marginal model (used if the marginal model
is not specified through <code>individual_spec</code>)</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+default_garch_spec">default_garch_spec()</a></code>, <code><a href="#topic+vine_settings">vine_settings</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the most basic initialization
marginal_settings(train_size = 100, refit_size = 10)
# some individualism
marginal_settings(
  train_size = 100, refit_size = 10,
  individual_spec = list("GOOG" = default_garch_spec(ar = 3)),
  default_spec = default_garch_spec(dist = "norm")
)
</code></pre>

<hr>
<h2 id='portvine_roll-class'>S4 output class for the function <code>estimate_risk_roll()</code></h2><span id='topic+portvine_roll-class'></span><span id='topic+cond_portvine_roll-class'></span><span id='topic+show+2Cportvine_roll-method'></span><span id='topic+show+2Ccond_portvine_roll-method'></span><span id='topic+summary+2Cportvine_roll-method'></span><span id='topic+summary+2Ccond_portvine_roll-method'></span>

<h3>Description</h3>

<p>The main output class for the function <code><a href="#topic+estimate_risk_roll">estimate_risk_roll()</a></code>is
<code>portvine_roll</code> but in the conditional case
the child class <code>cond_portvine_roll</code> with some extra slots (below visible
by the !C!) is returned.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'portvine_roll'
show(object)

## S4 method for signature 'cond_portvine_roll'
show(object)

## S4 method for signature 'portvine_roll'
summary(object)

## S4 method for signature 'cond_portvine_roll'
summary(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="portvine_roll-class_+3A_object">object</code></td>
<td>
<p>An object of class <code>portvine_roll</code> or <code>cond_portvine_roll</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>For easy access for the most important slots and some filtering functionality
have a look at the accessor methods <code><a href="#topic+risk_estimates">risk_estimates()</a></code>, <code><a href="#topic+fitted_vines">fitted_vines()</a></code>,
<code><a href="#topic+fitted_marginals">fitted_marginals()</a></code>.
</p>


<h3>Value</h3>

<p>object of class <code>portvine_roll</code>
</p>
<p>object of class <code>cond_portvine_roll</code>
</p>


<h3>Slots</h3>


<dl>
<dt><code>risk_estimates</code></dt><dd><p>data.table with the columns <code>risk_measure</code>,
<code>risk_est</code>, <code>alpha</code>, <code>row_num</code>, <code>vine_window</code> and <code>realized</code> (here all
samples also in the conditional case are used)</p>
</dd>
<dt><code>fitted_marginals</code></dt><dd><p>named list with an entry for each asset containing a
<code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code> class object that encompasses the marginal model fit.</p>
</dd>
<dt><code>fitted_vines</code></dt><dd><p>list of <code><a href="rvinecopulib.html#topic+vinecop">rvinecopulib::vinecop</a></code> class objects each entry
corresponds to one vine window.</p>
</dd>
<dt><code>marginal_settings</code></dt><dd><p>containing the specification used for the ARMA-GARCH
fitting i.e. marginal models. Is of class <code>marginal_settings</code>.</p>
</dd>
<dt><code>vine_settings</code></dt><dd><p>containing the specifications used for the vine fitting.
Is of class <code>vine_settings</code>.</p>
</dd>
<dt><code>risk_measures</code></dt><dd><p>a character vector displaying the estimated risk
measures.</p>
</dd>
<dt><code>alpha</code></dt><dd><p>numeric vector in (0,1) displaying the confidence levels used
when estimating the risk measures.</p>
</dd>
<dt><code>weights</code></dt><dd><p>the numeric positive weights of the assets. (Matrix with each
row corresponding to one vine window) The weights of conditional variables
are always 0.</p>
</dd>
<dt><code>cond_estimation</code></dt><dd><p>logical value indicating whether the conditional
estimation approach for the risk measures was used.</p>
</dd>
<dt><code>n_samples</code></dt><dd><p>positive numeric count displaying how many return samples
were used for the risk measure estimation.</p>
</dd>
<dt><code>time_taken</code></dt><dd><p>numeric value displaying how many minutes the whole
estimation process took.</p>
</dd>
<dt><code>cond_risk_estimates</code></dt><dd><p>!C! data.table with the same columns as the
<code>risk_estimate</code> slot has + the additional conditional columns with the
respective conditioning value and the column character <code>cond_u</code> that
indicates the used conditional quantile level or the conditional value
corresponding to the residual one time unit prior with &quot;prior_resid&quot; or
the realized residual with &quot;resid&quot;.</p>
</dd>
<dt><code>cond_vars</code></dt><dd><p>!C! character vector with the names of the variables that
were used to sample conditionally from.</p>
</dd>
<dt><code>cond_u</code></dt><dd><p>!C! a numeric vector specifying the corresponding quantiles
in (0,1) of the conditional variable(s) conditioned on which the conditional
risk measures were calculated.</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+estimate_risk_roll">estimate_risk_roll()</a></code>, <code><a href="#topic+risk_estimates">risk_estimates()</a></code>, <code><a href="#topic+fitted_vines">fitted_vines()</a></code>,
<code><a href="#topic+fitted_marginals">fitted_marginals()</a></code>
</p>

<hr>
<h2 id='risk_estimates'>Accessor methods for the risk estimates of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code> objects</h2><span id='topic+risk_estimates'></span><span id='topic+risk_estimates+2Cportvine_roll-method'></span><span id='topic+risk_estimates+2Ccond_portvine_roll-method'></span>

<h3>Description</h3>

<p>Accessor methods for the risk estimates of <code style="white-space: pre;">&#8288;(cond_)portvine_roll&#8288;</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_estimates(
  roll,
  risk_measures = NULL,
  alpha = NULL,
  df = TRUE,
  exceeded = FALSE,
  ...
)

## S4 method for signature 'portvine_roll'
risk_estimates(
  roll,
  risk_measures = NULL,
  alpha = NULL,
  df = TRUE,
  exceeded = FALSE
)

## S4 method for signature 'cond_portvine_roll'
risk_estimates(
  roll,
  risk_measures = NULL,
  alpha = NULL,
  df = TRUE,
  exceeded = FALSE,
  cond = TRUE,
  cond_u = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="risk_estimates_+3A_roll">roll</code></td>
<td>
<p>Object of class <code>portvine_roll</code> or a child class</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_risk_measures">risk_measures</code></td>
<td>
<p>Character vector of risk measures to filter for. Note
that they must be fitted in the <code>roll</code> argument. The default will return all
fitted risk measures</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_alpha">alpha</code></td>
<td>
<p>Numeric <code class="reqn">\alpha</code> levels of the estimated risk measures to
filter
for. Note that they must be fitted in the <code>roll</code> argument. The default will
return all fitted <code class="reqn">\alpha</code> levels</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_df">df</code></td>
<td>
<p>Logical value if <code>TRUE</code> a <code>data.frame</code> is returned otherwise a
<code>data.table</code> is returned.</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_exceeded">exceeded</code></td>
<td>
<p>Logical value. If set to <code>TRUE</code> a column named <code>exceeded</code>
will be appended that contains logical values telling whether the realized
portfolio value exceeded the estimated risk.</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_...">...</code></td>
<td>
<p>Additional parameters for child class methods</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_cond">cond</code></td>
<td>
<p>If set to TRUE returns the conditional risk estimates and
otherwise returns the overall risk estimates.</p>
</td></tr>
<tr><td><code id="risk_estimates_+3A_cond_u">cond_u</code></td>
<td>
<p>Numeric or character vector specifying the corresponding
quantiles
in (0,1) of the conditional variable(s) conditioned on which the conditional
risk measures were calculated to filter for and/or the class
&quot;prior_resid&quot;/&quot;resid&quot;.
Note that they must be fitted in the <code>roll</code> argument.
The default will return all fitted risk measures.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(Un-)filtered <code>data.frame</code> or <code>data.table</code> (see <code>df</code> argument) with
at least the columns
<code>risk_measure</code>, <code>risk_est</code>, <code>alpha</code>, <code>row_num</code>, <code>vine_window</code> and <code>realized</code>.
<code>exceeded</code> column if the corresponding argument is set to <code>TRUE</code>.
In the conditional case further columns are available (see:
<code><a href="#topic+portvine_roll-class">portvine_roll</a></code>).
</p>


<h3>See Also</h3>

<p><code><a href="#topic+portvine_roll-class">portvine_roll</a></code>
</p>

<hr>
<h2 id='roll_residuals'>Extract fitted standardized residuals from a uGARCHroll object</h2><span id='topic+roll_residuals'></span>

<h3>Description</h3>

<p>The <code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code> class object encompasses fitting information
about a number of
models fitted in a rolling window fashion. This utility function gives an
easy interface to extract the fitted residuals from one of these models.
This can be especially helpful for assessing the model quality with a
residual analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roll_residuals(ugarchroll, roll_num = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="roll_residuals_+3A_ugarchroll">ugarchroll</code></td>
<td>
<p>Object of class <code><a href="rugarch.html#topic+ugarchroll-methods">rugarch::ugarchroll</a></code>.</p>
</td></tr>
<tr><td><code id="roll_residuals_+3A_roll_num">roll_num</code></td>
<td>
<p>Count that specifies the fitted model to extract the
residuals from.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector of the fitted standardized residuals.
</p>

<hr>
<h2 id='sample_returns_small'>A sample of log returns for 3 assets.</h2><span id='topic+sample_returns_small'></span>

<h3>Description</h3>

<p>Data extracted from Yahoo Finance representing the daily log returns for
Google, Apple, and Amazon stocks between 2014-01-13 and 2018-01-01 which
results in exactly 1000 observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(sample_returns_small)
</code></pre>


<h3>Format</h3>

<p>data.table with 3 columns and 1000 rows, columns <code>GOOG</code>, <code>AAPL</code>,
<code>AMZN</code> contain the daily log return of the 3 stocks.
</p>


<h3>Source</h3>

<p><a href="https://finance.yahoo.com">Yahoo Finance</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sample_returns_small)
head(sample_returns_small)
</code></pre>

<hr>
<h2 id='vine_settings-class'>S4 class for the vine settings</h2><span id='topic+vine_settings-class'></span><span id='topic+vine_settings'></span><span id='topic+show+2Cvine_settings-method'></span>

<h3>Description</h3>

<p>Specify which vine copula models are
fitted and how often they are refit as well as how big the training data
set is. Remember that the estimation process is done in a rolling window
fashion and the arguments (train and refit size) will have to match with
the arguments of the also to be specified <code><a href="#topic+marginal_settings">marginal_settings</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vine_settings(train_size, refit_size, family_set = "all", vine_type = "rvine")

## S4 method for signature 'vine_settings'
show(object)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="vine_settings-class_+3A_train_size">train_size</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="vine_settings-class_+3A_refit_size">refit_size</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="vine_settings-class_+3A_family_set">family_set</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="vine_settings-class_+3A_vine_type">vine_type</code></td>
<td>
<p>equivalent to the slot definition below</p>
</td></tr>
<tr><td><code id="vine_settings-class_+3A_object">object</code></td>
<td>
<p>An object of class <code>vine_settings</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Object of class <code>vine_settings</code>
</p>


<h3>Functions</h3>


<ul>
<li> <p><code>vine_settings()</code>: Class constructor taking the arguments
specified in the slots below
</p>
</li></ul>


<h3>Slots</h3>


<dl>
<dt><code>train_size</code></dt><dd><p>Positive count specifying the training data size.</p>
</dd>
<dt><code>refit_size</code></dt><dd><p>Positive count specifying for how many periods a vine is
used</p>
</dd>
<dt><code>family_set</code></dt><dd><p>Character vector specifying the family of copulas that are
used. For possible choices see <code><a href="rvinecopulib.html#topic+bicop">rvinecopulib::bicop</a></code>. Note for conditional
sampling just parametric copula families are possible so do not use the
family arguments <code>all</code> and <code>tll</code>.</p>
</dd>
<dt><code>vine_type</code></dt><dd><p>character value that specifies which vine class should be
fitted. Possible choices right now are <code>rvine</code> (regular vine) and <code>dvine</code>
(drawable vine).</p>
</dd>
</dl>


<h3>See Also</h3>

<p><code><a href="#topic+marginal_settings">marginal_settings</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># the most basic initialization
vine_settings(100, 25)
# some individual note
vine_settings(
  train_size = 100, refit_size = 20,
  family_set = c("gumbel", "joe"),
  vine_type = "dvine"
)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
