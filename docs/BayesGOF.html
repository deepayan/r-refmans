<!DOCTYPE html><html><head><title>Help for package BayesGOF</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayesGOF}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayesGOF-package'>
<p>Bayesian Modeling via Frequentist Goodness-of-Fit</p></a></li>
<li><a href='#arsenic'><p> Arsenic levels in oyster tissue</p></a></li>
<li><a href='#AutoIns'><p>Number of claims on an insurance policy</p></a></li>
<li><a href='#ChildIll'><p>Frequency of child illness</p></a></li>
<li><a href='#CorbBfly'><p> Corbet's Butterfly data</p></a></li>
<li><a href='#DS.entropy'>
<p>Full and Excess Entropy of DS(G,m) prior</p></a></li>
<li><a href='#DS.Finite.Bayes'>
<p>Conduct Finite Bayes Inference on a DS object</p></a></li>
<li><a href='#DS.macro.inf'>
<p>Execute MacroInference (mean or mode) on a DS object</p></a></li>
<li><a href='#DS.micro.inf'><p> MicroInference for DS Prior Objects</p></a></li>
<li><a href='#DS.posterior.reduce'>
<p>Posterior Expectation and Modes of DS object</p></a></li>
<li><a href='#DS.prior'><p>Prior Diagnostics and Estimation</p></a></li>
<li><a href='#DS.sampler'>
<p>Samples data from DS(G,m) distribution.</p></a></li>
<li><a href='#galaxy'><p> Galaxy Data</p></a></li>
<li><a href='#gLP.basis'>
<p>Determine LP basis functions for prior distribution <code class="reqn">g</code></p></a></li>
<li><a href='#gMLE.bb'><p> Beta-Binomial Parameter Estimation</p></a></li>
<li><a href='#gMLE.nn'><p> Normal-Normal Parameter Estimation</p></a></li>
<li><a href='#gMLE.pg'><p> Negative-Binomial Parameter Estimation</p></a></li>
<li><a href='#NorbergIns'><p> Norberg life insurance data</p></a></li>
<li><a href='#rat'><p> Rat Tumor Data</p></a></li>
<li><a href='#ship'>
<p>Portsmouth Navy Shipyard Data</p></a></li>
<li><a href='#steroid'>
<p>Nasal Steroid Data</p></a></li>
<li><a href='#surg'><p>Intestinal surgery data</p></a></li>
<li><a href='#tacks'><p> Rolling Tacks Data</p></a></li>
<li><a href='#terb'><p> Terbinafine trial data</p></a></li>
<li><a href='#ulcer'>
<p>Recurrent Bleeding of Ulcers</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Bayesian Modeling via Frequentist Goodness-of-Fit</td>
</tr>
<tr>
<td>Version:</td>
<td>5.2</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-10-09</td>
</tr>
<tr>
<td>Author:</td>
<td>Subhadeep Mukhopadhyay, Douglas Fletcher</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Doug Fletcher &lt;tug25070@temple.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A Bayesian data modeling scheme that performs four interconnected tasks: (i) characterizes the uncertainty of the elicited parametric prior; (ii) provides exploratory diagnostic for checking prior-data conflict; (iii) computes the final statistical prior density estimate; and (iv) executes macro- and micro-inference. Primary reference is Mukhopadhyay, S. and Fletcher, D. 2018 paper "Generalized Empirical Bayes via Frequentist Goodness of Fit" (&lt;https://www.nature.com/articles/s41598-018-28130-5 &gt;). </td>
</tr>
<tr>
<td>Depends:</td>
<td>orthopolynom, VGAM, Bolstad2, nleqslv</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-10-09 19:42:06 UTC; dougf</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-10-09 21:50:09 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayesGOF-package'>
Bayesian Modeling via Frequentist Goodness-of-Fit
</h2><span id='topic+BayesGOF-package'></span><span id='topic+BayesGOF'></span>

<h3>Description</h3>

<p>A Bayesian data modeling scheme that performs four interconnected tasks: (i) characterizes the uncertainty of the elicited parametric prior; (ii) provides exploratory diagnostic for checking prior-data conflict; (iii) computes the final statistical prior density estimate; and (iv) executes macro- and micro-inference.  
</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>

<hr>
<h2 id='arsenic'> Arsenic levels in oyster tissue
</h2><span id='topic+arsenic'></span>

<h3>Description</h3>

<p>Results from an inter-laboratory study involving <code class="reqn">k = 28</code> measurements for the level of arsenic in oyster tissue. <code>y</code> is the mean level of arsenic from a lab and <code>se</code> is the standard error of the measurement.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("arsenic")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, se_i)</code> for <code class="reqn">i = 1,...,28</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>mean level of arsenic in the tissue measured by the <code class="reqn">i^{th}</code> lab</p>
</dd>
<dt><code>se</code></dt><dd><p>the standard error of the measurement by <code class="reqn">i^{th}</code> lab</p>
</dd>
</dl>



<h3>Source</h3>

 
<p>Wille, S. and Berman, S., 1995. &quot;Ninth round intercomparison for trace metals in marine sediments and biological tissues,&quot; <em>NRC/NOAA</em>.
</p>

<hr>
<h2 id='AutoIns'>Number of claims on an insurance policy</h2><span id='topic+AutoIns'></span>

<h3>Description</h3>

<p>The number of claims on an automobile insurance policy made by <code class="reqn">k = 9461</code> individuals during a single year. </p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AutoIns")</code></pre>


<h3>Format</h3>

<p>A vector of length 9461.
</p>

<dl>
<dt><code>value</code></dt><dd><p>number of auto insurance claims by the <code class="reqn">i^{th}</code> person</p>
</dd>
</dl>



<h3>Source</h3>

<p>Efron, B. and Hastie, T., 2016. <em>Computer Age Statistical Inference</em> (Vol. 5). Cambridge University Press.
</p>

<hr>
<h2 id='ChildIll'>Frequency of child illness</h2><span id='topic+ChildIll'></span>

<h3>Description</h3>

<p> Results of a study that followed <code class="reqn">k = 602</code> pre-school children in north-east Thailand from June 1982 through September 1985.  Researchers recorded the number of times a child became ill during every 2-week period.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ChildIll")</code></pre>


<h3>Format</h3>

<p>A vector of length <code class="reqn">k=602</code>.
</p>

<dl>
<dt><code>value</code></dt><dd><p>number of times the <code class="reqn">i^{th}</code> child became ill during the study</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bohning, D., 2000. <em>Computer-assisted Analysis of Mixtures and Applications: Meta-analysis, Disease Mapping, and Others</em> (Vol. 81). CRC press.
</p>

<hr>
<h2 id='CorbBfly'> Corbet's Butterfly data
</h2><span id='topic+CorbBfly'></span>

<h3>Description</h3>

<p>The number of times Alexander Corbet captured a species of butterfly during a two-year period in Malaysia.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("CorbBfly")</code></pre>


<h3>Format</h3>

<p>A vector of length <code class="reqn">k = 501</code>.
</p>

<dl>
<dt><code>value</code></dt><dd><p>number of times Corbet captured the <code class="reqn">i^{th}</code> species</p>
</dd>
</dl>



<h3>Source</h3>

<p>Fisher, R.A., Corbet, A.S. and Williams, C.B., 1943. &quot;The relation between the number of species and the number of individuals in a random sample of an animal population.&quot; <em>The Journal of Animal Ecology</em>, pp.42-58.</p>


<h3>References</h3>

<p>Efron, B. and Hastie, T., 2016. <em>Computer Age Statistical Inference</em> (Vol. 5). Cambridge University Press.
</p>

<hr>
<h2 id='DS.entropy'>
Full and Excess Entropy of DS(G,m) prior
</h2><span id='topic+DS.entropy'></span>

<h3>Description</h3>

<p> A function that calculates the full entropy of a DS(G,m) prior.  For DS(G,m) with <code class="reqn">m &gt; 0</code>, also returns the excess entropy <code class="reqn">q</code>LP.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.entropy(DS.GF.obj)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.entropy_+3A_ds.gf.obj">DS.GF.obj</code></td>
<td>
<p>Object resulting from running DS.prior function on a data set.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>ent</code></td>
<td>
<p>The total entropy of the DS(G,m) prior where <code class="reqn">m \geq 0</code>.</p>
</td></tr>
<tr><td><code>qLP</code></td>
<td>
<p>The excess entropy when <code class="reqn">m &gt; 0</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher
</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start, family = "Binomial")
DS.entropy(rat.ds)
</code></pre>

<hr>
<h2 id='DS.Finite.Bayes'>
Conduct Finite Bayes Inference on a DS object
</h2><span id='topic+DS.Finite.Bayes'></span><span id='topic+plot.DS_FB_obj'></span><span id='topic+print.DS_FB_obj'></span>

<h3>Description</h3>

<p>A function that generates the finite Bayes prior and posterior distribution, along with the Bayesian credible interval for the posterior mean.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.Finite.Bayes(DS.GF.obj, y.0, n.0 = NULL, 
             cred.interval = 0.9, iters = 25)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.Finite.Bayes_+3A_ds.gf.obj">DS.GF.obj</code></td>
<td>
<p>Object from <code>DS.prior</code>.</p>
</td></tr>
<tr><td><code id="DS.Finite.Bayes_+3A_y.0">y.0</code></td>
<td>
<p> For Binomial family, number of success <code class="reqn">y_i</code> for new study.  In the Poisson family, it is the number of counts.  Represents the study mean for the Normal family.</p>
</td></tr>
<tr><td><code id="DS.Finite.Bayes_+3A_n.0">n.0</code></td>
<td>
<p> For the Binomial family, the total number of trials for the new study.  In the Normal family, <code>n.0</code> is the standard error of <code>y.0</code>.  Not used for the Poisson family.</p>
</td></tr>
<tr><td><code id="DS.Finite.Bayes_+3A_cred.interval">cred.interval</code></td>
<td>
<p>The desired probability for the credible interval of the posterior mean; the default is 0.90 (<code>90%</code>).</p>
</td></tr>
<tr><td><code id="DS.Finite.Bayes_+3A_iters">iters</code></td>
<td>
<p>Integer value of total number of iterations.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>prior.fit</code></td>
<td>
<p>Fitted values for the estimated parametric, DS, and finite Bayes prior distributions.</p>
</td></tr>
<tr><td><code>post.fit</code></td>
<td>
<p>Dataframe with <code class="reqn">\theta</code>, <code class="reqn">\pi_G(\theta | y_0)</code>, and <code class="reqn">\pi_{LP}(\theta | y_0)</code>.</p>
</td></tr>  
<tr><td><code>interval</code></td>
<td>
<p>The <code>100*cred.interval</code>% Bayesian credible interval for the posterior mean.</p>
</td></tr>
<tr><td><code>post.vec</code></td>
<td>
<p>Vector containing the PEB posterior mean (<code>PEB.mean</code>), DS posterior mean (<code>DS.mean</code>), PEB posterior mode (<code>PEB.mode</code>), and the DS posterior mode (<code>DS.mode</code>).</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>
<p>Efron, B., 2018. &quot;Bayes, Oracle Bayes, and Empirical Bayes,&quot; Technical Report.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### Finite Bayes: Rat with theta_71 (y_71 = 4, n_71 = 14)
data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start. family = "Binomial")
rat.FB &lt;- DS.FiniteBayes(rat.ds, y.0 = 4, n.0 = 14)
plot(rat.FB)

## End(Not run)
</code></pre>

<hr>
<h2 id='DS.macro.inf'>
Execute MacroInference (mean or mode) on a DS object
</h2><span id='topic+DS.macro.inf'></span><span id='topic+DS.macro.inf.pge'></span><span id='topic+DS.macro.inf.pgu'></span><span id='topic+DS.macro.inf.bbu'></span><span id='topic+DS.macro.inf.nnu'></span><span id='topic+Local.Mode'></span><span id='topic+plot.DS_GF_macro_mean'></span><span id='topic+plot.DS_GF_macro_mode'></span><span id='topic+print.DS_GF_macro_mean'></span><span id='topic+print.DS_GF_macro_mode'></span><span id='topic+DS.GF.macro.obj'></span>

<h3>Description</h3>

<p>A function that generates macro-estimates with their uncertainty (standard error).</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.macro.inf(DS.GF.obj, num.modes = 1, 
             method = c("mean", "mode"), 
             iters = 25, exposure = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.macro.inf_+3A_ds.gf.obj">DS.GF.obj</code></td>
<td>
<p>Object from <code>DS.prior</code>.</p>
</td></tr>
<tr><td><code id="DS.macro.inf_+3A_num.modes">num.modes</code></td>
<td>
<p>The number of modes indicated by <code>DS.prior</code> object.</p>
</td></tr>
<tr><td><code id="DS.macro.inf_+3A_method">method</code></td>
<td>
<p>Returns mean or mode(s) (based on user choice) along with the associated standard error(s).</p>
</td></tr>
<tr><td><code id="DS.macro.inf_+3A_iters">iters</code></td>
<td>
<p>Integer value of total number of iterations.</p>
</td></tr>
<tr><td><code id="DS.macro.inf_+3A_exposure">exposure</code></td>
<td>
<p>In the case where <code>DS.GF.obj</code> is from a Poisson family with exposure, <code>exposure</code> is the vector of exposures.  Otherwise, the default is <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>DS.GF.macro.obj</code></td>
<td>
<p>Object of class <code>DS.GF.macro</code> associated with either mean or mode.</p>
</td></tr>
<tr><td><code>model.modes</code></td>
<td>
<p>For <code>method = "mode"</code>, returns mode(s) of estimated DS prior.</p>
</td></tr>
<tr><td><code>mode.sd</code></td>
<td>
<p>For <code>method = "mode"</code>, provides the bootstrapped standard error for each mode.</p>
</td></tr>
<tr><td><code>boot.modes</code></td>
<td>
<p>For <code>method = "mode"</code>, returns all generated mode(s).</p>
</td></tr>
<tr><td><code>model.mean</code></td>
<td>
<p>For <code>method = "mean"</code>, returns mean of estimated DS prior.</p>
</td></tr>
<tr><td><code>mean.sd</code></td>
<td>
<p>For <code>method = "mean"</code>, provides the bootstrapped standard error for the mean.</p>
</td></tr>
<tr><td><code>boot.mean</code></td>
<td>
<p>For <code>method = "mean"</code>, returns all generated means.</p>
</td></tr>
<tr><td><code>prior.fit</code></td>
<td>
<p>Fitted values of estimated prior imported from the <code>DS.prior</code> object.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
### MacroInference: Mode
data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start. family = "Binomial")
rat.ds.macro &lt;- DS.macro.inf(rat.ds, num.modes = 2, method = "mode", iters = 5)
rat.ds.macro
plot(rat.ds.macro)
### MacroInference: Mean
data(ulcer)
ulcer.start &lt;- gMLE.nn(ulcer$y, ulcer$se)$estimate
ulcer.ds &lt;- DS.prior(ulcer, max.m = 4, ulcer.start)
ulcer.ds.macro &lt;- DS.macro.inf(ulcer.ds, num.modes = 1, method = "mean", iters = 5)
ulcer.ds.macro
plot(ulcer.ds.macro)
## End(Not run)
</code></pre>

<hr>
<h2 id='DS.micro.inf'> MicroInference for DS Prior Objects</h2><span id='topic+DS.micro.inf'></span><span id='topic+DS.micro.inf.pgu'></span><span id='topic+DS.micro.inf.pge'></span><span id='topic+DS.micro.inf.bbu'></span><span id='topic+DS.micro.inf.nnu'></span><span id='topic+plot.DS_GF_micro'></span><span id='topic+print.DS_GF_micro'></span><span id='topic+DS.GF.micro.obj'></span>

<h3>Description</h3>

<p> Provides DS nonparametric adaptive Bayes and parametric estimate for a specific observation <code class="reqn">y_0</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.micro.inf(DS.GF.obj, y.0, n.0, e.0 = NULL)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.micro.inf_+3A_ds.gf.obj">DS.GF.obj</code></td>
<td>
<p>Object resulting from running DS.prior function on a data set.</p>
</td></tr>
<tr><td><code id="DS.micro.inf_+3A_y.0">y.0</code></td>
<td>
<p> For Binomial family, number of success <code class="reqn">y_i</code> for new study.  In the Poisson family, it is the number of counts.  Represents the study mean for the Normal family.</p>
</td></tr>
<tr><td><code id="DS.micro.inf_+3A_n.0">n.0</code></td>
<td>
<p> For the Binomial family, the total number of trials for the new study.  In the Normal family, <code>n.0</code> is the standard error of <code>y.0</code>.  Not used for the Poisson family.</p>
</td></tr>
<tr><td><code id="DS.micro.inf_+3A_e.0">e.0</code></td>
<td>
<p> In the case of the Poisson family with exposure, represents the exposure value for a given count value <code>y.0</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns an object of class <code>DS.GF.micro</code> that can be used in conjunction with plot command to display the DS posterior distribution for the new study.</p>


<h3>Value</h3>

<table>
<tr><td><code>DS.mean</code></td>
<td>
<p>Posterior mean for <code class="reqn">\pi_{LP}(\theta | y_0)</code>.</p>
</td></tr>
<tr><td><code>DS.mode</code></td>
<td>
<p>Posterior mode for <code class="reqn">\pi_{LP}(\theta | y_0)</code>.</p>
</td></tr>
<tr><td><code>PEB.mean</code></td>
<td>
<p>Posterior mean for <code class="reqn">\pi_G(\theta | y_0)</code>.</p>
</td></tr>
<tr><td><code>PEB.mode</code></td>
<td>
<p>Posterior mode for <code class="reqn">\pi_G(\theta | y_0)</code>.</p>
</td></tr>
<tr><td><code>post.vec</code></td>
<td>
<p>Vector containing <code>PEB.mean</code>, <code>DS.mean</code>, <code>PEB.mode</code>, and <code>DS.mode</code>.</p>
</td></tr>
<tr><td><code>study</code></td>
<td>
<p>User-provided <code class="reqn">y_0</code> and <code class="reqn">n_0</code>.</p>
</td></tr>
<tr><td><code>post.fit</code></td>
<td>
<p>Dataframe with <code class="reqn">\theta</code>, <code class="reqn">\pi_G(\theta | y_0)</code>, and <code class="reqn">\pi_{LP}(\theta | y_0)</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>### MicroInference for Naval Shipyard Data: sample where y = 0 and n = 5
data(ship)
ship.ds &lt;- DS.prior(ship, max.m = 2, c(.5,.5), family = "Binomial")
ship.ds.micro &lt;- DS.micro.inf(ship.ds, y.0 = 0, n.0 = 5)
ship.ds.micro
plot(ship.ds.micro)
</code></pre>

<hr>
<h2 id='DS.posterior.reduce'>
Posterior Expectation and Modes of DS object
</h2><span id='topic+DS.posterior.reduce'></span>

<h3>Description</h3>

<p> A function that determines the posterior expectations <code class="reqn">E(\theta_0 | y_0)</code> and posterior modes for a set of observed data.</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.posterior.reduce(DS.GF.obj, exposure)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.posterior.reduce_+3A_ds.gf.obj">DS.GF.obj</code></td>
<td>
<p>Object resulting from running DS.prior function on a data set.</p>
</td></tr>
<tr><td><code id="DS.posterior.reduce_+3A_exposure">exposure</code></td>
<td>
<p>In the case of the Poisson family with exposure, represents the exposure values for the count data.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Returns <code class="reqn">k \times 4</code> matrix with the columns indicating PEB mean, DS mean, PEB mode, and DS modes for <code class="reqn">k</code> observations in the data set.</p>


<h3>Author(s)</h3>

<p>Doug Fletcher
</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start, family = "Binomial")
DS.posterior.reduce(rat.ds)
</code></pre>

<hr>
<h2 id='DS.prior'>Prior Diagnostics and Estimation
</h2><span id='topic+DS.prior'></span><span id='topic+DS.prior.nnu'></span><span id='topic+DS.prior.pgu'></span><span id='topic+DS.prior.bbu'></span><span id='topic+plot.DS_GF'></span><span id='topic+print.DS_GF'></span><span id='topic+Reduce.LP.coef.univ'></span><span id='topic+DS.GF.obj'></span><span id='topic+LP.smooth'></span><span id='topic+maxent.LP.par'></span><span id='topic+maxent.obj.convert'></span><span id='topic+EXP.score'></span><span id='topic+weight.fun.univ'></span>

<h3>Description</h3>

<p>A function that generates the uncertainty diagnostic function (<code>U-function</code>) and estimates DS<code class="reqn">(G,m)</code> prior model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.prior(input, max.m = 8, g.par, 
         family = c("Normal","Binomial", "Poisson"), 
         LP.type = c("L2", "MaxEnt"), 
         smooth.crit = "BIC", iters = 200, B = 1000,
		 max.theta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.prior_+3A_input">input</code></td>
<td>
<p>For <code>"Binomial"</code>, a dataframe that contains the <code class="reqn">k</code> pairs of successes <code class="reqn">y</code> and the corresponding total number of trials <code class="reqn">n</code>.  For <code>"Normal"</code>, a dataframe that has the <code class="reqn">k</code> means <code class="reqn">y_i</code> in the first column and their respective standard errors <code class="reqn">s_i</code> in the second.  For the <code>"Poisson"</code>, a vector of that includes the untabled count data.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_max.m">max.m</code></td>
<td>
<p>The truncation point <code class="reqn">m</code> reflects the concentration of true unknown <code class="reqn">\pi</code> around known <code class="reqn">g</code>. </p>
</td></tr>
<tr><td><code id="DS.prior_+3A_g.par">g.par</code></td>
<td>
<p>Vector with estimated parameters for specified conjugate prior distribution <code class="reqn">g</code> (i.e beta prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>; normal prior: <code class="reqn">\mu</code> and <code class="reqn">\tau^2</code>; gamma prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>). </p>
</td></tr>
<tr><td><code id="DS.prior_+3A_family">family</code></td>
<td>
<p>The distribution of <code class="reqn">y_i</code>. Currently accommodates three families: <code>Normal</code>, <code>Binomial</code>, and <code>Poisson</code>.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_lp.type">LP.type</code></td>
<td>
<p>User selects either <code>"L2"</code> for LP-orthogonal series representation of <code>U-function</code> or <code>"MaxEnt"</code> for the maximum entropy representation.  Default is <code>L2</code>.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_smooth.crit">smooth.crit</code></td>
<td>
<p>User selects either <code>"BIC"</code> or <code>"AIC"</code> as criteria to both determine optimal <code class="reqn">m</code> and smooth final LP parameters; default is <code>"BIC"</code>.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_iters">iters</code></td>
<td>
<p>Integer value that gives the maximum number of iterations allowed for convergence; default is 200.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_b">B</code></td>
<td>
<p>Integer value for number of grid points used for distribution output; default is 1000.</p>
</td></tr>
<tr><td><code id="DS.prior_+3A_max.theta">max.theta</code></td>
<td>
<p>For <code>"Poisson"</code>, user can provide a maximum theta value for prior; default is the maximum count value in <code>input</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p> Function can take <code class="reqn">m=0</code> and will return the Bayes estimate with given starting parameters.  Returns an object of class <code>DS.GF.obj</code>; this object can be used with plot command to plot the U-function (<code>Ufunc</code>), Deviance Plots (<code>mDev</code>), and DS-G comparison (<code>DS_G</code>).
</p>


<h3>Value</h3>

<table>
<tr><td><code>LP.par</code></td>
<td>
<p><code class="reqn">m</code> smoothed LP-Fourier coefficients, where <code class="reqn">m</code> is determined by maximum deviance.</p>
</td></tr>
<tr><td><code>g.par</code></td>
<td>
<p>Parameters for <code class="reqn">g</code>.</p>
</td></tr>
<tr><td><code>LP.max.uns</code></td>
<td>
<p>Vector of all LP-Fourier coefficients prior to smoothing, where the length is the same as <code>max.m</code>.</p>
</td></tr>
<tr><td><code>LP.max.smt</code></td>
<td>
<p>Vector of all smoothed LP-Fourier coefficients, where the length is the same as <code>max.m</code>.</p>
</td></tr>
<tr><td><code>prior.fit</code></td>
<td>
<p>Fitted values for the estimated prior.</p>
</td></tr>
<tr><td><code>UF.data</code></td>
<td>
<p>Dataframe that contains values required for plotting the U-function.</p>
</td></tr>
<tr><td><code>dev.df</code></td>
<td>
<p>Dataframe that contains deviance values for values of <code class="reqn">m</code> up to <code>max.m</code>.</p>
</td></tr>
<tr><td><code>m.val</code></td>
<td>
<p>The value of <code class="reqn">m</code> (less than or equal to the maximum <code class="reqn">m</code> from user) that has the maximum deviance and represents the appropriate number of LP-Fourier coefficients.</p>
</td></tr>
<tr><td><code>sm.crit</code></td>
<td>
<p>Smoothing criteria; either <code>"BIC"</code> or <code>"AIC"</code>.</p>
</td></tr>
<tr><td><code>fam</code></td>
<td>
<p>The user-selected family.</p>
</td></tr>
<tr><td><code>LP.type</code></td>
<td>
<p>User-selected representation of <code>U-function</code>.</p>
</td></tr>
<tr><td><code>obs.data</code></td>
<td>
<p>Observed data provided by user for <code>input</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>
<p>Mukhopadhyay, S., 2017. &quot;Large-Scale Mode Identification and Data-Driven Sciences,&quot; <em>Electronic Journal of Statistics, 11</em>(1), pp.215-240.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rat)
rat.start &lt;- gMLE.bb(rat$y, rat$n)$estimate
rat.ds &lt;- DS.prior(rat, max.m = 4, rat.start, family = "Binomial")
rat.ds
plot(rat.ds, plot.type = "Ufunc")
plot(rat.ds, plot.type = "DSg")
plot(rat.ds, plot.type = "mDev")
</code></pre>

<hr>
<h2 id='DS.sampler'>
Samples data from DS(G,m) distribution.
</h2><span id='topic+DS.sampler'></span><span id='topic+DS.sampler.post'></span><span id='topic+rPPD.ds'></span>

<h3>Description</h3>

<p>Generates samples of size <code class="reqn">k</code> from DS<code class="reqn">(G,m)</code> prior distribution.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DS.sampler(k, g.par, LP.par, con.prior, LP.type, B)

DS.sampler.post(k, g.par, LP.par, y.0, n.0, 
                con.prior, LP.type, B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DS.sampler_+3A_k">k</code></td>
<td>
<p>Total number of samples requested.</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_g.par">g.par</code></td>
<td>
<p>Estimated parameters for specified conjugate prior distribution (i.e beta prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>; normal prior: <code class="reqn">\mu</code> and <code class="reqn">\tau^2</code>; gamma prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_lp.par">LP.par</code></td>
<td>
<p>LP coefficients for DS prior.</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_con.prior">con.prior</code></td>
<td>
<p>The distribution type of conjugate prior <code class="reqn">g</code>; either  <code>"Beta"</code>, <code>"Normal"</code>, or <code>"Gamma"</code>.</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_lp.type">LP.type</code></td>
<td>
<p>The type of LP means, either <code>"L2"</code> or <code>"MaxEnt"</code>.</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_y.0">y.0</code></td>
<td>
<p>Depending on <code class="reqn">g</code>, <code class="reqn">y_0</code> is either (i) the sample mean (<code>"Normal"</code>), (ii) the number of successes (<code>"Beta"</code>), or (iii) the specific count value (<code>"Gamma"</code>) for desired posterior distribution(<code>DS.sampler.post</code> only).</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_n.0">n.0</code></td>
<td>
<p>Depending on <code class="reqn">g</code>,  <code class="reqn">n_0</code> is either (i) the sample standard error (<code>"Normal"</code>), or (ii) the total number of trials in the sample (<code>"Beta"</code>).  Not used for <code>"Gamma"</code>.  (<code>DS.sampler.post</code> only).</p>
</td></tr>
<tr><td><code id="DS.sampler_+3A_b">B</code></td>
<td>
<p>The number of grid points, default is 250.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>DS.sampler.post</code> uses the same type of sampling as <code>DS.sampler</code> to generate random values from a DS posterior distribution.</p>


<h3>Value</h3>

<p>Vector of length <code class="reqn">k</code> containing sampled values from DS prior or DS posterior.</p>


<h3>Author(s)</h3>

<p>Doug Fletcher, Subhadeep Mukhopadhyay</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>
<p>Mukhopadhyay, S., 2017. &quot;Large-Scale Mode Identification and Data-Driven Sciences,&quot; <em>Electronic Journal of Statistics, 11</em>(1), pp.215-240.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##Extracted parameters from rat.ds object
rat.g.par &lt;- c(2.3, 14.1)
rat.LP.par &lt;- c(0, 0, -0.5)
samps.prior &lt;- DS.sampler(25, rat.g.par, rat.LP.par, con.prior = "Beta")
hist(samps.prior,15)
##Posterior for rat data
samps.post &lt;- DS.sampler.post(25, rat.g.par, rat.LP.par, 
							y.0 = 4, n.0 = 14, con.prior = "Beta")
hist(samps.post, 15)
</code></pre>

<hr>
<h2 id='galaxy'> Galaxy Data
</h2><span id='topic+galaxy'></span>

<h3>Description</h3>

<p>The observed rotation velocities and their uncertainties of Low Surface Brightness (LSB) galaxies, along with the physical radius of the galaxy.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("galaxy")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, se_i, X_i)</code> for <code class="reqn">i = 1,...,318</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>actual observed (smoothed) velocity</p>
</dd>
<dt><code>se</code></dt><dd><p>uncertainty of observed velocity</p>
</dd>
<dt><code>X</code></dt><dd><p>physical radius of the galaxy</p>
</dd>
</dl>



<h3>Source</h3>

<p>De Blok, W.J.G., McGaugh, S.S., and Rubin, V. C., 2001. &quot;High-resolution rotation curves of low surface brightness galaxies. II. Mass models,&quot; <em>The Astronomical Journal, 122</em>(5), p. 2396. 
</p>

<hr>
<h2 id='gLP.basis'>
Determine LP basis functions for prior distribution <code class="reqn">g</code>
</h2><span id='topic+gLP.basis'></span>

<h3>Description</h3>

<p>Determines the LP basis for a given parametric prior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gLP.basis(x, g.par, m, con.prior, ind)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gLP.basis_+3A_x">x</code></td>
<td>
 <p><code>x</code> values (integer or vector) from 0 to 1.</p>
</td></tr>
<tr><td><code id="gLP.basis_+3A_g.par">g.par</code></td>
<td>
<p> Estimated parameters for specified prior distribution (i.e beta prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>; normal prior: <code class="reqn">\mu</code> and <code class="reqn">\tau^2</code>; gamma prior: <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>).</p>
</td></tr>
<tr><td><code id="gLP.basis_+3A_m">m</code></td>
<td>
<p>Number of LP-Polynomial basis.</p>
</td></tr>
<tr><td><code id="gLP.basis_+3A_con.prior">con.prior</code></td>
<td>
<p>Specified conjugate prior distribution for basis functions.  Options are <code>"Beta"</code>, <code>"Normal"</code>, and <code>"Gamma"</code>.</p>
</td></tr>
<tr><td><code id="gLP.basis_+3A_ind">ind</code></td>
<td>
<p>Default is NULL which returns matrix with <code class="reqn">m</code> columns that consists of LP-basis functions; user can provide a specific choice through <code>ind</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p> Matrix with <code>m</code> columns of values for the LP-Basis functions evaluated at <code>x</code>-values.</p>


<h3>Author(s)</h3>

<p>  Subhadeep Mukhopadhyay, Doug Fletcher</p>


<h3>References</h3>

<p>Mukhopadhyay, S. and Fletcher, D., 2018. &quot;Generalized Empirical Bayes via Frequentist Goodness of Fit,&quot; <em>Nature Scientific Reports</em>, 8(1), p.9983, <a href="https://www.nature.com/articles/s41598-018-28130-5">https://www.nature.com/articles/s41598-018-28130-5</a>.
</p>
<p>Mukhopadhyay, S., 2017. &quot;Large-Scale Mode Identification and Data-Driven Sciences,&quot; <em>Electronic Journal of Statistics, 11</em>(1), pp.215-240.
</p>
<p>Mukhopadhyay, S. and Parzen, E., 2014. &quot;LP Approach to Statistical Modeling,&quot; arXiv: 1405.2601.
</p>

<hr>
<h2 id='gMLE.bb'> Beta-Binomial Parameter Estimation </h2><span id='topic+gMLE.bb'></span><span id='topic+mom.est'></span>

<h3>Description</h3>

<p>Computes type-II Maximum likelihood estimates <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code> for Beta prior <code class="reqn">g\sim</code>Beta<code class="reqn">(\alpha,\beta)</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gMLE.bb(success, trials, start = NULL, optim.method = "default", 
        lower = 0, upper = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gMLE.bb_+3A_success">success</code></td>
<td>
<p>Vector containing the number of successes.</p>
</td></tr>
<tr><td><code id="gMLE.bb_+3A_trials">trials</code></td>
<td>
<p>Vector containing the total number of trials that correspond to the successes.</p>
</td></tr>
<tr><td><code id="gMLE.bb_+3A_start">start</code></td>
<td>
<p>initial parameters; default is NULL which allows function to determine MoM estimates as initial parameters.</p>
</td></tr>
<tr><td><code id="gMLE.bb_+3A_optim.method">optim.method</code></td>
<td>
<p>optimization method in <code>optim()</code>stats.</p>
</td></tr>
<tr><td><code id="gMLE.bb_+3A_lower">lower</code></td>
<td>
<p> lower bound for parameters; default is 0.</p>
</td></tr>
<tr><td><code id="gMLE.bb_+3A_upper">upper</code></td>
<td>
<p> upper bound for parameters; default is infinity.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>estimate</code></td>
<td>
<p>MLE estimate for beta parameters.</p>
</td></tr>
<tr><td><code>convergence</code></td>
<td>
<p>Convergence code from <code>optim()</code>;  0 means convergence.</p>
</td></tr>
<tr><td><code>loglik</code></td>
<td>
<p>Loglikelihood that corresponds with MLE estimated parameters.</p>
</td></tr>
<tr><td><code>initial</code></td>
<td>
<p>Initial parameters, either user-defined or determined from method of moments.</p>
</td></tr>
<tr><td><code>hessian</code></td>
<td>
<p>Estimated Hessian matrix at the given solution.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aleksandar Bradic</p>


<h3>References</h3>

<p><a href="https://github.com/SupplyFrame/EmpiricalBayesR/blob/master/EmpiricalBayesEstimation.R">https://github.com/SupplyFrame/EmpiricalBayesR/blob/master/EmpiricalBayesEstimation.R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(rat)
### MLE estimate of alpha and beta
rat.mle &lt;- gMLE.bb(rat$y, rat$N)$estimate
rat.mle
### MoM estimate of alpha and beta
rat.mom &lt;- gMLE.bb(rat$y, rat$N)$initial
rat.mom
</code></pre>

<hr>
<h2 id='gMLE.nn'> Normal-Normal Parameter Estimation </h2><span id='topic+gMLE.nn'></span>

<h3>Description</h3>

<p>Computes type-II Maximum likelihood estimates <code class="reqn">\hat{\mu}</code> and <code class="reqn">\hat{\tau}^2</code> for Normal prior <code class="reqn">g\sim</code>Normal<code class="reqn">(\mu, \tau^2)</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gMLE.nn(value, se, fixed = FALSE, method = c("DL","SJ","REML","MoM"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gMLE.nn_+3A_value">value</code></td>
<td>
<p>Vector of values.</p>
</td></tr>
<tr><td><code id="gMLE.nn_+3A_se">se</code></td>
<td>
<p>Standard error for each value.</p>
</td></tr>
<tr><td><code id="gMLE.nn_+3A_fixed">fixed</code></td>
<td>
<p>When <code>FALSE</code>, treats the input as if from a random effects model; otherwise, will treat it as if it a fixed effect.</p>
</td></tr>
<tr><td><code id="gMLE.nn_+3A_method">method</code></td>
<td>
<p>Determines the method to find <code class="reqn">\tau^2</code>: <code>"DL"</code> uses Dersimonian and Lard technique, <code>"SJ"</code> uses Sidik-Jonkman, <code>"REML"</code> uses restricted maximum likelihood, and <code>"MoM"</code> uses a method of moments technique.
</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>estimate</code></td>
<td>
<p>Vector with both estimated <code class="reqn">\hat{\mu}</code> and <code class="reqn">\hat{\tau}^2</code>.</p>
</td></tr>
<tr><td><code>mu.hat</code></td>
<td>
<p>Estimated <code class="reqn">\hat{\mu}</code>.</p>
</td></tr>
<tr><td><code>tau.sq</code></td>
<td>
<p>Estimated <code class="reqn">\hat{\tau}^2</code>.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>User-selected method.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Doug Fletcher
</p>


<h3>References</h3>

<p>Marin-Martinez, F. and Sanchez-Meca, J., 2010. &quot;Weighting by inverse variance or by sample size in random-effects meta-analysis,&quot; <em>Educational and Psychological Measurement, 70</em>(1), pp. 56-73.
</p>
<p>Brown, L.D., 2008. &quot;In-season prediction of batting averages: A field test of empirical Bayes and Bayes methodologies,&quot; <em>The Annals of Applied Statistics</em>, pp. 113-152.
</p>
<p>Sidik, K. and Jonkman, J.N., 2005. &quot;Simple heterogeneity variance estimation for meta-analysis,&quot; <em>Journal of the Royal Statistical Society: Series C (Applied Statistics)</em>, 54(2), pp. 367-384.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ulcer)
### MLE estimate of alpha and beta
ulcer.mle &lt;- gMLE.nn(ulcer$y, ulcer$se, method = "DL")$estimate
ulcer.mle
ulcer.reml &lt;- gMLE.nn(ulcer$y, ulcer$se, method = "REML")$estimate
ulcer.reml
</code></pre>

<hr>
<h2 id='gMLE.pg'> Negative-Binomial Parameter Estimation </h2><span id='topic+gMLE.pg'></span>

<h3>Description</h3>

<p>Computes Type-II Maximum likelihood estimates <code class="reqn">\hat{\alpha}</code> and <code class="reqn">\hat{\beta}</code> for gamma prior <code class="reqn">g\sim</code> Gamma<code class="reqn">(\alpha, \beta)</code>.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gMLE.pg(cnt.vec, exposure = NULL, start.par = c(1,1))

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gMLE.pg_+3A_cnt.vec">cnt.vec</code></td>
<td>
<p>Vector containing Poisson counts.</p>
</td></tr>
<tr><td><code id="gMLE.pg_+3A_exposure">exposure</code></td>
<td>
<p>Vector containing exposures for each count.  The default is no exposure, thus <code>exposure = NULL</code>.</p>
</td></tr>
<tr><td><code id="gMLE.pg_+3A_start.par">start.par</code></td>
<td>
<p>Initial values that will pass to <code>optim</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector where the first component is <code class="reqn">\alpha</code> and the second component is the scale parameter <code class="reqn">\beta</code> for the gamma distribution: <code class="reqn">\frac{1}{\Gamma(\alpha)\beta^\alpha} \theta^{\alpha-1}e^{-\frac{\theta}{\beta}}.</code>
</p>


<h3>Author(s)</h3>

<p>Doug Fletcher
</p>


<h3>References</h3>

<p>Koenker, R. and Gu, J., 2017. &quot;REBayes: An R Package for Empirical Bayes Mixture Methods,&quot; <em>Journal of Statistical Software, Articles, 82</em>(8), pp. 1-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>### without exposure
data(ChildIll)
ill.start &lt;- gMLE.pg(ChildIll)
ill.start
### with exposure
data(NorbergIns)
X &lt;- NorbergIns$deaths
E &lt;- NorbergIns$exposure/344
norb.start &lt;- gMLE.pg(X, exposure = E)
norb.start
</code></pre>

<hr>
<h2 id='NorbergIns'> Norberg life insurance data 
</h2><span id='topic+NorbergIns'></span>

<h3>Description</h3>

<p>The number of claims <code class="reqn">y_i</code> on a life insurance policy for each of <code class="reqn">k=72</code> Norwegian occupational categories and the total number of years the workers in each category were exposed to risk (<code class="reqn">E_i</code>).</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("NorbergIns")</code></pre>


<h3>Format</h3>

<p>A data frame of the occupational group number (<code>group</code>), the number of deaths (<code>deaths</code>), and the years of exposure (<code>exposure</code>) for <code class="reqn">i = 1,...,72</code>.
</p>

<dl>
<dt><code>group</code></dt><dd><p>Occupational group number</p>
</dd>
<dt><code>deaths</code></dt><dd><p>The number of deaths in the occupational group resulting in a claim on a life insurance policy.</p>
</dd>
<dt><code>exposure</code></dt><dd><p>The total number of years of exposure to risk for those who passed.</p>
</dd>
</dl>



<h3>Source</h3>

 
<p>Norberg, R., 1989. &quot;Experience rating in group life insurance,&quot; <em>Scandinavian Actuarial Journal, 1989</em>(4), pp. 194-224.
</p>


<h3>References</h3>

<p>Koenker, R. and Gu, J., 2017. &quot;REBayes: An R Package for Empirical Bayes Mixture Methods,&quot; <em>Journal of Statistical Software, Articles, 82</em>(8), pp. 1-26.
</p>

<hr>
<h2 id='rat'> Rat Tumor Data
</h2><span id='topic+rat'></span>

<h3>Description</h3>

<p>Incidence of endometrial stromal polyps in <code class="reqn">k=70</code> studys of female rats in control group of a 1977 study on the carcinogenic effects of a diabetic drug phenformin.  For each of the <code class="reqn">k</code> groups, <code class="reqn">y</code> represents the number of rats who developed the tumors out of <code class="reqn">n</code> total rats in the group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("rat")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, n_i)</code> for <code class="reqn">i = 1,...,70</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>number of female rats in the <code class="reqn">i^{th}</code> study who developed polyps/tumors</p>
</dd>
<dt><code>n</code></dt><dd><p>total number of rats in the <code class="reqn">i^{th}</code> study</p>
</dd>
</dl>



<h3>Source</h3>

 
<p>National Cancer Institute (1977), &quot;Bioassay of phenformin for possible carcinogenicity,&quot; <em>Technical Report No. 7</em>.
</p>


<h3>References</h3>

<p>Gelman, A., Carlin, J.B., Stern, H.S., Dunson, D.B., Vehtari, A., and Rubin, D.B., 2014. <em>Bayesian Data Analysis</em> (Vol. 3). Boca Raton, FL: CRC press.
</p>
<p>Tarone, R.E., 1982. &quot;The use of historical control information in testing for a trend in proportions,&quot; <em>Biometrics</em>, pp. 215-220.
</p>

<hr>
<h2 id='ship'>
Portsmouth Navy Shipyard Data
</h2><span id='topic+ship'></span>

<h3>Description</h3>

<p>Data represents results of quality-control inspections executed by Portsmouth Naval Shipyard on lots of welding materials.  The data has <code class="reqn">k=5</code> observations of number of defects <code class="reqn">y</code> out of the total number of tested <code class="reqn">n=5</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ship")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, n_i)</code> for <code class="reqn">i = 1,...,5</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>number of defects found in the <code class="reqn">i^{th}</code> inspection</p>
</dd>
<dt><code>n</code></dt><dd><p>total samples tested in the <code class="reqn">i^{th}</code> inspection</p>
</dd>
</dl>



<h3>Source</h3>

<p> Martz, H.F. and Lian, M.G., 1974. &quot;Empirical Bayes estimation of the binomial parameter,&quot; <em>Biometrika, 61</em>(3), pp. 517-523.</p>

<hr>
<h2 id='steroid'>
Nasal Steroid Data
</h2><span id='topic+steroid'></span>

<h3>Description</h3>

<p>The standardized mean difference <code class="reqn">y_i</code> and standard errors <code class="reqn">se_i</code> for seven randomised studies on the use of topical steroids in treatment of chronic rhinosinusitis with nasal polyps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("steroid")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, se_i)</code> for <code class="reqn">i = 1,...,7</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>standard mean difference of clinical trials for topical steroids found in the <code class="reqn">i^{th}</code> study</p>
</dd>
<dt><code>se</code></dt><dd><p>standard error of the standard mean difference for the <code class="reqn">i^{th}</code> study</p>
</dd>
</dl>



<h3>Source</h3>

<p> IntHout, J., Ioannidis, J. P., Rovers, M. M., &amp; Goeman, J. J., 2016. &quot;Plea for routinely presenting prediction intervals in meta-analysis,&quot; <em>BMJ open, 6</em>(7), e010247.</p>

<hr>
<h2 id='surg'>Intestinal surgery data
</h2><span id='topic+surg'></span>

<h3>Description</h3>

<p> Data involves the number of malignant lymph nodes removed during intestinal surgery for <code class="reqn">k=844</code> cancer patients.  For each patient, <code class="reqn">n</code> is the total number of satellite nodes removed during surgery from a patient and <code class="reqn">y</code> is the number of malignant nodes.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("surg")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, n_i)</code> for <code class="reqn">i = 1,...,844</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>number of malignant lymph nodes removed from the <code class="reqn">i^{th}</code> patient</p>
</dd>
<dt><code>n</code></dt><dd><p>total number of lymph nodes removed from the <code class="reqn">i^{th}</code> patient</p>
</dd>
</dl>



<h3>Source</h3>

<p>Efron, B., 2016. &quot;Empirical Bayes deconvolution estimates,&quot; <em>Biometrika, 103</em>(1), pp. 1-20.
</p>

<hr>
<h2 id='tacks'> Rolling Tacks Data
</h2><span id='topic+tacks'></span>

<h3>Description</h3>

<p>An experiment that requires a common thumbtack to be &quot;flipped&quot; <code class="reqn">n=9</code> times.  Out of these total number of flips, <code class="reqn">y</code> is the total number of times that the thumbtack landed point up.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("tacks")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, n_i)</code> for <code class="reqn">i = 1,...,320</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>number of times a thumbtack landed point up in the <code class="reqn">i^{th}</code> trial</p>
</dd>
<dt><code>n</code></dt><dd><p>total number of flips for the thumbtack in the <code class="reqn">i^{th}</code> trial</p>
</dd>
</dl>



<h3>Source</h3>

<p>Beckett, L. and Diaconis, P., 1994. &quot;Spectral analysis for discrete longitudinal data,&quot; <em>Advances in Mathematics, 103</em>(1), pp. 107-128.
</p>

<hr>
<h2 id='terb'> Terbinafine trial data
</h2><span id='topic+terb'></span>

<h3>Description</h3>

<p> During several studies of the oral antifungal agent terbinafine, a proportion of the patients in the trial terminated treatment due to some adverse effects.  In the data set, <code class="reqn">y_i</code> is the number of terminated treatments and <code class="reqn">n_i</code> is the total number of patients in the in the <code class="reqn">i^{th}</code> trial.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("terb")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i, n_i)</code> for <code class="reqn">i = 1,...,41</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>number of patients who terminated treatment early in the <code class="reqn">i^{th}</code> trial</p>
</dd>
<dt><code>n</code></dt><dd><p>total number of patients in the <code class="reqn">i^{th}</code> clinical trial</p>
</dd>
</dl>



<h3>Source</h3>

<p> Young-Xu, Y. and Chan, K.A., 2008. &quot;Pooling overdispersed binomial data to estimate event rate,&quot; <em>BMC Medical Research Methodology, 8</em>(1), p. 58.
</p>

<hr>
<h2 id='ulcer'>
Recurrent Bleeding of Ulcers</h2><span id='topic+ulcer'></span>

<h3>Description</h3>

<p>The data consist of <code class="reqn">k=40</code> randomized trials between 1980 and 1989 of a surgical treatment for stomach ulcers.  Each of the trials has an estimated log-odds ratio that measures the rate of occurrence of recurrent bleeding given the surgical treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ulcer")</code></pre>


<h3>Format</h3>

<p>A data frame of <code class="reqn">(y_i,</code> se<code class="reqn">_i)</code> for <code class="reqn">i = 1,...,40</code>.
</p>

<dl>
<dt><code>y</code></dt><dd><p>log-odds of the occurrence of recurrent bleeding in the <code class="reqn">i^{th}</code> study</p>
</dd>
<dt><code>se</code></dt><dd><p>standard error of the log-odds for the <code class="reqn">i^{th}</code> study</p>
</dd>
</dl>



<h3>Source</h3>

 
<p>Sacks, H.S., Chalmers, T.C., Blum, A.L., Berrier, J., and Pagano, D., 1990. &quot;Endoscopic hemostasis: an effective therapy for bleeding peptic ulcers,&quot; <em>Journal of the American Medical Association, 264</em>(4), pp. 494-499.
</p>


<h3>References</h3>

<p>Efron, B., 1996. &quot;Empirical Bayes methods for combining likelihoods,&quot; <em>Journal of the American Statistical Association, 91</em>(434), pp. 538-550.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
