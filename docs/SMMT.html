<!DOCTYPE html><html lang="en"><head><title>Help for package SMMT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {SMMT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#smmt'><p>SMMT - The Swiss Municipal Data Merger Tool Maps Municipalities Over Time</p></a></li>
<li><a href='#date_of_last_update'><p>Get date of last municipal inventory update</p></a></li>
<li><a href='#download_municipality_inventory'><p>Download municipality inventory</p></a></li>
<li><a href='#filter_date'><p>Filter by date</p></a></li>
<li><a href='#get_current_url'><p>Get URL of current XML data set</p></a></li>
<li><a href='#get_irreversible_municipality_mutations'><p>Get irreversible municipality mutations</p></a></li>
<li><a href='#import_CH_municipality_inventory'><p>Import the Swiss Municipality inventory</p></a></li>
<li><a href='#map_old_to_new_state'><p>Map municipalities of old state to municipalities of new state</p></a></li>
<li><a href='#most_recent_changes'><p>Most recent changes</p></a></li>
<li><a href='#municipality_counter'><p>Municipality counter</p></a></li>
<li><a href='#mutation_count'><p>Mutation count</p></a></li>
<li><a href='#territorial_mutation_count'><p>Territorial mutation coutn</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>The Swiss Municipal Data Merger Tool Maps Municipalities Over
Time</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>In Switzerland, the landscape of municipalities is changing rapidly
  mainly due to mergers. The Swiss Municipal Data Merger Tool 
  automatically detects these mutations and maps municipalities over time, i.e. municipalities of an old state
  to municipalities of a new state. This functionality is helpful when working 
  with datasets that are based on different spatial references. The package's idea and use 
  case is discussed in the following article: &lt;<a href="https://doi.org/10.1111%2Fspsr.12487">doi:10.1111/spsr.12487</a>&gt;.</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, XML, tibble, curl, rvest, xml2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, roxygen2, knitr, rmarkdown</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/ValValetl/SMMT">https://github.com/ValValetl/SMMT</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ValValetl/SMMT/issues">https://github.com/ValValetl/SMMT/issues</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-19 17:29:42 UTC; valentin</td>
</tr>
<tr>
<td>Author:</td>
<td>Valentin Knechtl <a href="https://orcid.org/0000-0002-8545-8883"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Valentin Knechtl &lt;valentinknechtl@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-20 10:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='smmt'>SMMT - The Swiss Municipal Data Merger Tool Maps Municipalities Over Time</h2><span id='topic+SMMT'></span><span id='topic+SMMT-package'></span><span id='topic+smmt'></span>

<h3>Description</h3>

<p>In Switzerland, the landscape of municipalities is changing rapidly mainly
due to mergers. The Swiss Municipal Data Merger Tool automatically detects
these mutations and maps municipalities of an old state to municipalities of
a new state. This functionality is helpful when working with datasets that
are based on different spatial references. The spatial reference in this
context signifies a set of municipalities at a given point in time.
</p>


<h3>Details</h3>

<p>For detailed information and examples, see <code><a href="#topic+map_old_to_new_state">map_old_to_new_state</a></code>
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Valentin Knechtl <a href="mailto:valentinknechtl@gmail.com">valentinknechtl@gmail.com</a> (<a href="https://orcid.org/0000-0002-8545-8883">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/ValValetl/SMMT">https://github.com/ValValetl/SMMT</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/ValValetl/SMMT/issues">https://github.com/ValValetl/SMMT/issues</a>
</p>
</li></ul>


<hr>
<h2 id='date_of_last_update'>Get date of last municipal inventory update</h2><span id='topic+date_of_last_update'></span>

<h3>Description</h3>

<p>Obtain the most recent change in the municipal inventory database. Most but
not all municipal mutations are made at first of january.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>date_of_last_update(mutations)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="date_of_last_update_+3A_mutations">mutations</code></td>
<td>
<p>A tibble with municipality mutations (as created by
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>Date</code> object of length one.
</p>

<hr>
<h2 id='download_municipality_inventory'>Download municipality inventory</h2><span id='topic+download_municipality_inventory'></span>

<h3>Description</h3>

<p>This functions downloads and extracts the municipality inventory form a
defined online source.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>download_municipality_inventory(
  url = get_current_url(),
  path = getwd(),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="download_municipality_inventory_+3A_url">url</code></td>
<td>
<p>Character vector of length one. Link to the zip file containing
the municipality inventory.</p>
</td></tr>
<tr><td><code id="download_municipality_inventory_+3A_path">path</code></td>
<td>
<p>Character vector of length one. Destination of extracted xml
file.</p>
</td></tr>
<tr><td><code id="download_municipality_inventory_+3A_verbose">verbose</code></td>
<td>
<p>Get a message after download about the content of the
inventory.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character vector of length one. File path to the extracted XML file.
</p>

<hr>
<h2 id='filter_date'>Filter by date</h2><span id='topic+filter_date'></span>

<h3>Description</h3>

<p>Filter for existing municipalities at a specific point in time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_date(tbl, date)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="filter_date_+3A_tbl">tbl</code></td>
<td>
<p>A tibble</p>
</td></tr>
<tr><td><code id="filter_date_+3A_date">date</code></td>
<td>
<p>A <code>Date</code> object of length one.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble which is a subset of <code>tbl</code>
</p>

<hr>
<h2 id='get_current_url'>Get URL of current XML data set</h2><span id='topic+get_current_url'></span>

<h3>Description</h3>

<p>Extract the url from the static source web page.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_current_url()
</code></pre>


<h3>Value</h3>

<p>Returns URL to municipality inventory
</p>

<hr>
<h2 id='get_irreversible_municipality_mutations'>Get irreversible municipality mutations</h2><span id='topic+get_irreversible_municipality_mutations'></span>

<h3>Description</h3>

<p>This function detects irreversible mutations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_irreversible_municipality_mutations(mutations)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_irreversible_municipality_mutations_+3A_mutations">mutations</code></td>
<td>
<p>A tibble with municipality mutations (as created by
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Irreversible mutations are defined as mutations during which territories are
split up. There are different types of irreversible mutations drawn from the
below cited document. In contrast, normal mutations signify a simple
merging of territory which accounts for most of the mutations in Switzerland
since 1960 whereas irreversible mutations occurred only rarely. The aim of
this function is to filter for these irreversible mutations. These can then
be treated separatly.
</p>
<p>Definitions for different types of territory split ups are based on:
Erl√§uterungen und Anwendungen - Historisierte Gemeindeverzeichnis der Schweiz
(2017).
</p>


<h3>Value</h3>

<p>A tibble with all the instances of irreversibe mutations. The
irreversibility cause is part of the output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  mutations &lt;- structure(list(hist_id = c(11320L, 13668L, 13669L),
 district_hist_id = c(10024L, 10024L, 10024L),
 kanton_abbr = c("AG", "AG", "AG"),
 bfs_nr = c(4061L, 4061L, 4084L), 
 name = c("Arni-Islisberg", "Arni (AG)", "Islisberg"), 
 admission_nr = c(1000L, 1481L, 1481L), 
 admission_mode = c(20L, 21L, 21L), 
 admission_date = structure(c(-3653, 4748,  4748),
 class = c("Date")), 
 abolition_nr = c(1481L, NA, NA), 
 abolition_mode = c(29L, NA, NA), 
 abolition_date = structure(c(4747, NA, NA),
 class = c("Date")), 
 change_date = structure(c(4747, 4748, 4748),
 class = c("Date"))), 
 row.names = c(NA, -3L), class = c("tbl_df", "tbl", "data.frame"))
   
irreversible_mutations &lt;- get_irreversible_municipality_mutations(mutations)

</code></pre>

<hr>
<h2 id='import_CH_municipality_inventory'>Import the Swiss Municipality inventory</h2><span id='topic+import_CH_municipality_inventory'></span>

<h3>Description</h3>

<p>This function imports the Swiss municipality inventory from the raw XML
resource into R as a <code><a href="tibble.html#topic+tibble">tibble</a></code>. The imported table is the
basis to map the Swiss municipalities from an old to a new state (see
<code><a href="#topic+map_old_to_new_state">map_old_to_new_state</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_CH_municipality_inventory(file_path)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="import_CH_municipality_inventory_+3A_file_path">file_path</code></td>
<td>
<p>Character vector of length one. It contains the file path to
the Swiss municipality inventory XML file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This imported Swiss municipality inventory is a database with the complete
mutation history that occured since 01.01.1960. The Swiss municipality inventory is
made available by the Federal Statistical Office and updated regularly to
keep track of new mutations.
</p>
<p><strong>Download</strong>
</p>
<p>See BfS webpage for infos about Swiss municipality inventory:
<a href="https://www.bfs.admin.ch/bfs/de/home/grundlagen/agvch/historisiertes-gemeindeverzeichnis.assetdetail.11467405.html">Historisiertes
Gemeindeverzeichnis</a>
</p>


<h3>Value</h3>

<p>A list with two tables in the form of tibble objects.
</p>
<ol>
<li><p> Municipality mutations. </p>
</li>
<li><p> Canton mutations</p>
</li></ol>



<h3>See Also</h3>

<p><code><a href="#topic+map_old_to_new_state">map_old_to_new_state</a></code>
</p>

<hr>
<h2 id='map_old_to_new_state'>Map municipalities of old state to municipalities of new state</h2><span id='topic+map_old_to_new_state'></span>

<h3>Description</h3>

<p>This function maps the Swiss municipalities of an old state to municipalities
of a new state.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>map_old_to_new_state(mutations, state_old, state_new)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="map_old_to_new_state_+3A_mutations">mutations</code></td>
<td>
<p>A tibble containing the municipality mutations inventory (see
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
<tr><td><code id="map_old_to_new_state_+3A_state_old">state_old</code></td>
<td>
<p>A <a href="base.html#topic+Date">Date</a> object vector of length one containing the date of
the old state.</p>
</td></tr>
<tr><td><code id="map_old_to_new_state_+3A_state_new">state_new</code></td>
<td>
<p>A <a href="base.html#topic+Date">Date</a> object vector of length one containing the date of
the new state.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Approach</strong>
</p>

<ol>
<li><p> Download the <a href="https://www.bfs.admin.ch/bfsstatic/dam/assets/11467405/master">Swiss municipality inventory</a>
</p>
</li>
<li><p> Import it into R workspace with <code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>
</p>
</li>
<li><p> Set the old state and the new state (see example)
</p>
</li>
<li><p> Get the mapping table with this function
</p>
</li></ol>

<p><strong>Example Daettwil / Baden</strong>
</p>
<p>On 1.1.1962 Daettwil (Bfs Nr. 4025) merged with Baden (Bfs Nr. 4021). 
Let's define </p>
 <ul>
<li><p> old_state &lt;- as.Date(&quot;1961-01-01&quot;) </p>
</li>
<li>
<p>new_state &lt;- as.Date(&quot;1963-01-01&quot;) </p>
</li>
<li><p> Result: </p>

<table>
<tr>
 <td style="text-align: right;">
bfs_nr_new </td><td style="text-align: right;"> name_new </td><td style="text-align: right;"> bfs_nr_old </td><td style="text-align: right;"> name_old </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;">
4025 </td><td style="text-align: right;"> Daettwil </td>
</tr>

</table>
 </li></ul>



<h3>Value</h3>

<p>A list with 4 elements:
</p>

<ol>
<li><p> mapped: A tibble with the mapped municipalities
</p>
</li>
<li><p> unmapped: A tibble with the unmapped municipalities
</p>
</li>
<li><p> state_old: see above
</p>
</li>
<li><p> state_new: see above
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
mutations &lt;- structure(list(hist_id = c(11227L, 11240L, 13189L),
district_hist_id = c(10025L, 10025L, 10025L),
kanton_abbr = c("AG", "AG", "AG"),
bfs_nr = c(4025L, 4021L, 4021L),
name = c("Daettwil", "Baden", "Baden"),
admission_nr = c(1000L, 1000L, 1004L),
admission_mode = c(20L, 20L, 26L),
admission_date = structure(c(-3653, -3653, -2922),
class = c("Date")),
abolition_nr = c(1004L, 1004L, NA),
abolition_mode = c(29L, 26L, NA),
abolition_date = structure(c(-2923, -2923, NA),
class = c("Date")),
change_date = structure(c(-2923, -2923, -2922), class = c("Date"))),
row.names = c(NA, -3L), class = c("tbl_df", "tbl", "data.frame"))

mapping_object &lt;- map_old_to_new_state(mutations,
as.Date("1961-01-01"), as.Date("1963-01-01"))

</code></pre>

<hr>
<h2 id='most_recent_changes'>Most recent changes</h2><span id='topic+most_recent_changes'></span>

<h3>Description</h3>

<p>Returns a table with the most recently changed municipalities.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>most_recent_changes(mutations)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="most_recent_changes_+3A_mutations">mutations</code></td>
<td>
<p>A tibble with municipality mutations (as created by
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
</table>

<hr>
<h2 id='municipality_counter'>Municipality counter</h2><span id='topic+municipality_counter'></span>

<h3>Description</h3>

<p>Count the municipalities for a set of dates. Either at the national or
cantonal level.  See vignette for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>municipality_counter(
  mutations,
  dates,
  geo_level = "ch",
  include_cant_lakes = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="municipality_counter_+3A_mutations">mutations</code></td>
<td>
<p>A tibble containing the municipality mutations inventory
(see <code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
<tr><td><code id="municipality_counter_+3A_dates">dates</code></td>
<td>
<p>A <a href="base.html#topic+Date">Date</a> object vector</p>
</td></tr>
<tr><td><code id="municipality_counter_+3A_geo_level">geo_level</code></td>
<td>
<p>Either &quot;ch&quot; or &quot;cantons&quot;.</p>
</td></tr>
<tr><td><code id="municipality_counter_+3A_include_cant_lakes">include_cant_lakes</code></td>
<td>
<p>Boolean, TRUE to also include lakes in the count.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble with the municipality count per date and specified
geography.
</p>


<h3>Note</h3>

<p>All entities that have a bfs nr are counted (e.g. also Gemeindefreie
Gebiete). This is not exactly what the BfS does in the webtool Applikation
der Schweizer Gemeinden.  However, it is not possible to distinguish
&quot;Gemeinden&quot; und &quot;Gemeindefreie Gebiete&quot; generically, based on the
information in the Gemeindeverzeichnis.
</p>

<hr>
<h2 id='mutation_count'>Mutation count</h2><span id='topic+mutation_count'></span>

<h3>Description</h3>

<p>Count number of mutations in a given time period
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mutation_count(
  mutations,
  start_date,
  end_date = Sys.Date(),
  territorial_changes_only = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mutation_count_+3A_mutations">mutations</code></td>
<td>
<p>A tibble containing the municipality mutations inventory (see
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
<tr><td><code id="mutation_count_+3A_start_date">start_date</code></td>
<td>
<p>Date vector (incl)</p>
</td></tr>
<tr><td><code id="mutation_count_+3A_end_date">end_date</code></td>
<td>
<p>Date vector (excluded)</p>
</td></tr>
<tr><td><code id="mutation_count_+3A_territorial_changes_only">territorial_changes_only</code></td>
<td>
<p>boolean. FALSE if all mutations should be
considered. TRUE if mutations that have an effect on the municipal
territory only should be considered. FALSE includes name changes, Bezirk
number changes etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Approach</strong>
</p>

<ol>
<li><p> Download the <a href="https://www.bfs.admin.ch/bfsstatic/dam/assets/11467405/master">Swiss municipality inventory</a>
</p>
</li>
<li><p> Import it into R workspace with <code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>
</p>
</li>
<li><p> Set the old state and the new state (see example)
</p>
</li>
<li><p> Get the mapping table with this function
</p>
</li></ol>

<p><strong>Example Daettwil / Baden</strong>
</p>
<p>On 1.1.1962 Daettwil (Bfs Nr. 4025) merged with Baden (Bfs Nr. 4021). 
Let's define </p>
 <ul>
<li><p> old_state &lt;- as.Date(&quot;1961-01-01&quot;) </p>
</li>
<li>
<p>new_state &lt;- as.Date(&quot;1963-01-01&quot;) </p>
</li>
<li><p> Result: </p>

<table>
<tr>
 <td style="text-align: right;">
bfs_nr_new </td><td style="text-align: right;"> name_new </td><td style="text-align: right;"> bfs_nr_old </td><td style="text-align: right;"> name_old </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;">
4025 </td><td style="text-align: right;"> Daettwil </td>
</tr>

</table>
 </li></ul>



<h3>Value</h3>

<p>A list with 4 elements:
</p>

<ol>
<li><p> mapped: A tibble with the mapped municipalities
</p>
</li>
<li><p> unmapped: A tibble with the unmapped municipalities
</p>
</li>
<li><p> state_old: see above
</p>
</li>
<li><p> state_new: see above
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
mutations &lt;- structure(list(hist_id = c(11227L, 11240L, 13189L),
district_hist_id = c(10025L, 10025L, 10025L),
kanton_abbr = c("AG", "AG", "AG"),
bfs_nr = c(4025L, 4021L, 4021L),
name = c("Daettwil", "Baden", "Baden"),
admission_nr = c(1000L, 1000L, 1004L),
admission_mode = c(20L, 20L, 26L),
admission_date = structure(c(-3653, -3653, -2922),
class = c("Date")),
abolition_nr = c(1004L, 1004L, NA),
abolition_mode = c(29L, 26L, NA),
abolition_date = structure(c(-2923, -2923, NA),
class = c("Date")),
change_date = structure(c(-2923, -2923, -2922), class = c("Date"))),
row.names = c(NA, -3L), class = c("tbl_df", "tbl", "data.frame"))

mapping_object &lt;- map_old_to_new_state(mutations,
as.Date("1961-01-01"), as.Date("1963-01-01"))

</code></pre>

<hr>
<h2 id='territorial_mutation_count'>Territorial mutation coutn</h2><span id='topic+territorial_mutation_count'></span>

<h3>Description</h3>

<p>Count number of mutations in a given time period
</p>


<h3>Usage</h3>

<pre><code class='language-R'>territorial_mutation_count(mutations, start_date, end_date = Sys.Date())
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="territorial_mutation_count_+3A_mutations">mutations</code></td>
<td>
<p>A tibble containing the municipality mutations inventory (see
<code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>)</p>
</td></tr>
<tr><td><code id="territorial_mutation_count_+3A_start_date">start_date</code></td>
<td>
<p>Date vector (incl)</p>
</td></tr>
<tr><td><code id="territorial_mutation_count_+3A_end_date">end_date</code></td>
<td>
<p>Date vector (excluded)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Approach</strong>
</p>

<ol>
<li><p> Download the <a href="https://www.bfs.admin.ch/bfsstatic/dam/assets/11467405/master">Swiss municipality inventory</a>
</p>
</li>
<li><p> Import it into R workspace with <code><a href="#topic+import_CH_municipality_inventory">import_CH_municipality_inventory</a></code>
</p>
</li>
<li><p> Set the old state and the new state (see example)
</p>
</li>
<li><p> Get the mapping table with this function
</p>
</li></ol>

<p><strong>Example Daettwil / Baden</strong>
</p>
<p>On 1.1.1962 Daettwil (Bfs Nr. 4025) merged with Baden (Bfs Nr. 4021). 
Let's define </p>
 <ul>
<li><p> old_state &lt;- as.Date(&quot;1961-01-01&quot;) </p>
</li>
<li>
<p>new_state &lt;- as.Date(&quot;1963-01-01&quot;) </p>
</li>
<li><p> Result: </p>

<table>
<tr>
 <td style="text-align: right;">
bfs_nr_new </td><td style="text-align: right;"> name_new </td><td style="text-align: right;"> bfs_nr_old </td><td style="text-align: right;"> name_old </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td>
</tr>
<tr>
 <td style="text-align: right;"> 4021 </td><td style="text-align: right;"> Baden </td><td style="text-align: right;">
4025 </td><td style="text-align: right;"> Daettwil </td>
</tr>

</table>
 </li></ul>



<h3>Value</h3>

<p>A list with 4 elements:
</p>

<ol>
<li><p> mapped: A tibble with the mapped municipalities
</p>
</li>
<li><p> unmapped: A tibble with the unmapped municipalities
</p>
</li>
<li><p> state_old: see above
</p>
</li>
<li><p> state_new: see above
</p>
</li></ol>



<h3>Examples</h3>

<pre><code class='language-R'>
mutations &lt;- structure(list(hist_id = c(11227L, 11240L, 13189L),
district_hist_id = c(10025L, 10025L, 10025L),
kanton_abbr = c("AG", "AG", "AG"),
bfs_nr = c(4025L, 4021L, 4021L),
name = c("Daettwil", "Baden", "Baden"),
admission_nr = c(1000L, 1000L, 1004L),
admission_mode = c(20L, 20L, 26L),
admission_date = structure(c(-3653, -3653, -2922),
class = c("Date")),
abolition_nr = c(1004L, 1004L, NA),
abolition_mode = c(29L, 26L, NA),
abolition_date = structure(c(-2923, -2923, NA),
class = c("Date")),
change_date = structure(c(-2923, -2923, -2922), class = c("Date"))),
row.names = c(NA, -3L), class = c("tbl_df", "tbl", "data.frame"))

mapping_object &lt;- map_old_to_new_state(mutations,
as.Date("1961-01-01"), as.Date("1963-01-01"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
