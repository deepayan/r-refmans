<!DOCTYPE html><html><head><title>Help for package Rramas</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {Rramas}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#as.tmatrix'>
<p>Population Transition Matrix</p></a></li>
<li><a href='#coryphanthaA'>
<p>Transition Matrices of Three Coryphantha robbinsorum Populations</p></a></li>
<li><a href='#decline'>
<p>Compute Declination and Explosion Probabilities</p></a></li>
<li><a href='#projectn'>
<p>Demographic Projections</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Matrix Population Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-20</td>
</tr>
<tr>
<td>Depends:</td>
<td>diagram</td>
</tr>
<tr>
<td>Author:</td>
<td>Marcelino de la Cruz</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marcelino de la Cruz &lt;marcelino.delacruz@urjc.es&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzes and predicts from matrix population models (Caswell 2006) &lt;<a href="https://doi.org/10.1002%2F9781118445112.stat07481">doi:10.1002/9781118445112.stat07481</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-22 08:19:00 UTC; marcelino</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-22 09:10:04 UTC</td>
</tr>
</table>
<hr>
<h2 id='as.tmatrix'>
Population Transition Matrix
</h2><span id='topic+as.tmatrix'></span><span id='topic+plot.tmatrix'></span><span id='topic+print.tmatrix'></span><span id='topic+summary.tmatrix'></span><span id='topic+plot.summary.tmatrix'></span><span id='topic+print.summary.tmatrix'></span>

<h3>Description</h3>

<p>Convert a matrix to transition matrix (class <code>tmatrix</code>) and display some of its properties.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as.tmatrix(x, names.st = NULL, ...)
## S3 method for class 'tmatrix'
plot(x, ...)
## S3 method for class 'tmatrix'
print(x, ...)
## S3 method for class 'tmatrix'
summary(object, ...)
## S3 method for class 'summary.tmatrix'
print(x, ...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="as.tmatrix_+3A_x">x</code></td>
<td>
<p>For <code>as.tmatrix</code>, <code>x</code> is a square matrix,; for the plot,
print and summary methods,<code>x</code> is a matrix of class <code>tmatrix</code>.</p>
</td></tr>
<tr><td><code id="as.tmatrix_+3A_object">object</code></td>
<td>
<p>An object of class <code>tmatrix</code>, i.e, resulting from 
<code>as.tmatrix</code>.</p>
</td></tr>
<tr><td><code id="as.tmatrix_+3A_names.st">names.st</code></td>
<td>
<p> A vector of names to rename the rows and columns of 
the transition matrix.</p>
</td></tr>
<tr><td><code id="as.tmatrix_+3A_...">...</code></td>
<td>
<p>Other parameters passed to print and plot methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The purpose of <code>as.tmatrix</code> is to class a transition matrix as an object of
class <code>tmatrix</code>, allowing the use of specific methods for transition
matrices.
</p>


<h3>Value</h3>

<p><code>as.tmatrix</code> returns a matrix of class <code>tmatrix</code>. 
</p>
<p><code>summary.tmatrix</code> prints the main parameters of the transition matrix: 
the finite rate of increase (&quot;lambda&quot;), the stable stage distribution, the 
reproductive value and the sensitivities and elasticities matrices. 
</p>
<p><code>plot.tmatrix</code> draw barplots of the stable stage distribution and the 
reproductive value and plot also a diagram of the life stage cycle.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot
</p>


<h3>References</h3>

<p>Akcakaya, H. R., Burgman, M. A. and Ginzburg L.R. 1999. <em>Applied Population Ecology</em>. Sinauer.
</p>
<p>Caswell, H. 2003. <em>Matrix Population Models: Construction, Analysis, and Interpretation </em>. Sinauer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
  data(coryphanthaA)
  coryphanthaA
  coryphanthaA &lt;- as.tmatrix(coryphanthaA)
  summary(coryphanthaA)
  plot(coryphanthaA) 
  
</code></pre>

<hr>
<h2 id='coryphanthaA'>
Transition Matrices of Three Coryphantha robbinsorum Populations
</h2><span id='topic+coryphanthaA'></span><span id='topic+coryphanthaB'></span><span id='topic+coryphanthaC'></span>

<h3>Description</h3>

<p>Transition matrices of three  <em>Coryphantha robbinsorum</em> populations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(coryphanthaA)</code></pre>


<h3>Format</h3>

<p>3x3 matrix.
</p>


<h3>Source</h3>

<p>Although the original data are from Schmalzel et al (1995), these matrices have
been transcribed from  Gurevitch et al. (2002). 
</p>


<h3>References</h3>

<p>Gurevitch, J., Scheiner, S. M. and Fox, G. A. 2002.
<em>The Ecology of Plants</em>. Sinauer.
</p>
<p>Schmalzel, R.J., F.W. Reichenbacher, and S. Rutman. 1995.
Demographic study of the rare <em>Coryphantha robbinsorum</em> (Cactaceae) 
in southeastern Arizona. <em>Madrono</em> 42:332-348.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(coryphanthaA)

</code></pre>

<hr>
<h2 id='decline'>
Compute Declination and Explosion Probabilities
</h2><span id='topic+decline'></span><span id='topic+explosion'></span><span id='topic+summary.rmas.risk'></span><span id='topic+plot.summary.rmas.risk'></span>

<h3>Description</h3>

<p>Compute declination (or explosion) probabilities for a stage-structured population. From a vector of initial stage abundances and a transition matrix, <code>decline</code> and <code>explosion</code> compute respectively the probability that the population size falls below or surpasses some abundance thresholds during a given time interval.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decline(rmas, bootsp = 1000)
explosion(rmas, bootsp = 1000)
## S3 method for class 'rmas.risk'
summary(object, q = c(0.025, 0.975),...)
## S3 method for class 'summary.rmas.risk'
plot(x, ylim = NULL, col = NULL, xlab = NULL, ylab = NULL, main = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decline_+3A_rmas">rmas</code></td>
<td>
<p>An object of class <code>rmas</code>,i.e., resulting from <a href="#topic+projectn">projectn</a>.</p>
</td></tr>
<tr><td><code id="decline_+3A_bootsp">bootsp</code></td>
<td>
<p>number of botstraped samples.</p>
</td></tr>
<tr><td><code id="decline_+3A_object">object</code></td>
<td>
<p>An object of class <code>rmas.rsik</code>, i.e. resulting from <a href="#topic+decline">decline</a>or <a href="#topic+explosion">explosion</a>.</p>
</td></tr>
<tr><td><code id="decline_+3A_x">x</code></td>
<td>
<p>An object of class <code>summary.rmas.rsik</code>.</p>
</td></tr>
<tr><td><code id="decline_+3A_q">q</code></td>
<td>
<p>vector of quantiles to compute bootstraped confidence intervals.</p>
</td></tr>
<tr><td><code id="decline_+3A_ylim">ylim</code></td>
<td>
<p>Vector with max and min values of the y (abundances) axis.  </p>
</td></tr>
<tr><td><code id="decline_+3A_col">col</code></td>
<td>
<p>Color or vector of colors to draw the trajectories.</p>
</td></tr>
<tr><td><code id="decline_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis.</p>
</td></tr>
<tr><td><code id="decline_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis.</p>
</td></tr>
<tr><td><code id="decline_+3A_main">main</code></td>
<td>
<p>Text to appear as title.</p>
</td></tr>
<tr><td><code id="decline_+3A_...">...</code></td>
<td>
<p>Other parameters passed to plot and other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Both <code>decline</code> and <code>explosion</code> require that some stochastic simulations for a given time interval had been previously constructed (using <a href="#topic+projectn">projectn</a>). Using those simulations <code>decline</code> computes the probability of falling bellow some population threshold (and <code>explosion</code> the probability of surpassing it) as the ratio between the number of times that these threshold has been attained and the number of replications. The set of abundances in each time interval (in all the simulations) are bootstraped (i.e. sampled with replacement) to build a confidence interval.
</p>


<h3>Value</h3>

<p>Both <code>decline</code> and <code>explosion</code> return an object of class <code>rmas.rsik</code>, basically a list with the following elements
</p>
<table>
<tr><td><code>cf.obs</code></td>
<td>
<p>a <code>data.frame</code> with the evaluated thresholds and their probabilities.</p>
</td></tr>
<tr><td><code>cf.boot</code></td>
<td>
<p>a list of data.frames similar to <code>cf.obs</code> for each bootstraped sample.</p>
</td></tr> 
<tr><td><code>abminbot</code></td>
<td>
<p>a list of bootstraped minimum (or maximum for <code>explosion</code>) abundances for each replica in the rmas object.</p>
</td></tr>
<tr><td><code>main</code></td>
<td>
<p>Text to appear as title when plotting the summary.</p>
</td></tr>
</table>
<p>The methods <code>summary</code> and <code>plot.summary</code> summarize the results and print and plot probabilities and bootstraped confidence interval of attainning a particular population threshold.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot
</p>


<h3>References</h3>

<p>Akcakaya, H. R., Burgman, M. A. and Ginzburg L.R. 1999. <em>Applied Population Ecology</em>. Sinauer.
</p>
<p>Caswell, H. 2003. <em>Matrix Population Models: Construction, Analysis, and Interpretation </em>. Sinauer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  
     data(coryphanthaA)
     coryphanthaA &lt;- as.tmatrix(coryphanthaA)
     #initial abundances:
     v0 &lt;- c(100,0,0)
       
     # run 1000 simulations of 20 years with  demographic stochasticity:
     simu20.ds &lt;- projectn(v0=v0, mat=coryphanthaA, time = 20, estdem=TRUE, nrep=1000)
     
     # compute declination probabilities
     simu20.ds.dec &lt;- decline(simu20.ds)
     
     summary(simu20.ds.dec)
     
     
</code></pre>

<hr>
<h2 id='projectn'>
Demographic Projections
</h2><span id='topic+projectn'></span><span id='topic+project1'></span><span id='topic+estambi'></span><span id='topic+estdemo'></span><span id='topic+plot.rmas'></span><span id='topic+plot.summary.rmas'></span><span id='topic+summary.rmas'></span>

<h3>Description</h3>

<p>Make deterministic and stochastic demographic projections according to a transition matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projectn(v0, mat, matsd = NULL, estamb = FALSE, estdem = FALSE,
         equalsign = TRUE,stmat=NULL, fecundity1=TRUE,
        nrep = 1, time = 10, management=NULL, round=TRUE)
project1(v0, mat, matsd=NULL, estamb=FALSE, estdem=FALSE,
         equalsign=TRUE, stmat=NULL, fecundity1=TRUE)
estambi(mat, matsd, equalsign)
estdemo(v0,mat,stmat=NULL, fecundity1=TRUE)
## S3 method for class 'rmas'
plot(x, sum = TRUE, mean=FALSE, type="l", harvest=FALSE, ...)
## S3 method for class 'rmas'
summary(object, stage=NULL, harvest=FALSE,...)
## S3 method for class 'summary.rmas'
plot(x, ylim=NULL, col=NULL, xlab=NULL, ylab=NULL, main=NULL,...)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="projectn_+3A_v0">v0</code></td>
<td>
<p> Vector with the initial abundance of each stage. </p>
</td></tr>
<tr><td><code id="projectn_+3A_mat">mat</code></td>
<td>
<p> Transition matrix.</p>
</td></tr>
<tr><td><code id="projectn_+3A_matsd">matsd</code></td>
<td>
<p>Matrix with the standard deviation of the probabilities in <code>mat</code>.</p>
</td></tr>
<tr><td><code id="projectn_+3A_estamb">estamb</code></td>
<td>
<p> Logical. Should environmental stochasticity be considered to projet the dynamics of the population?</p>
</td></tr>
<tr><td><code id="projectn_+3A_estdem">estdem</code></td>
<td>
<p> Logical. Should demographic stochasticity be employed to project the dynamics of the population?</p>
</td></tr>
<tr><td><code id="projectn_+3A_equalsign">equalsign</code></td>
<td>
<p> Logical. Should the environmental deviations have all the same sign and magnitude? See details section.</p>
</td></tr>
<tr><td><code id="projectn_+3A_stmat">stmat</code></td>
<td>
<p>Matrix indicating for each transition probability in <code>mat</code> which part (i.e. which proportion) should be considered resulting from 
fecundity (and the rest will be considered resulting from survival). See details.  </p>
</td></tr>
<tr><td><code id="projectn_+3A_fecundity1">fecundity1</code></td>
<td>
<p>Logical. Should the first row of <code>mat</code> be considered exclusively as fecundities? See details</p>
</td></tr>
<tr><td><code id="projectn_+3A_nrep">nrep</code></td>
<td>
<p> Number of replications  to evaluate the effects of stochasticity.</p>
</td></tr>
<tr><td><code id="projectn_+3A_time">time</code></td>
<td>
<p> length of the demographic trajectory</p>
</td></tr>
<tr><td><code id="projectn_+3A_management">management</code></td>
<td>
<p>Vector (or matrix) of management actions to be applied each time step.    </p>
</td></tr>  
<tr><td><code id="projectn_+3A_round">round</code></td>
<td>
<p> Logical. Should the projections be rounded to the next integer each time step (i.e. consider finite indiviuals)?</p>
</td></tr>  
<tr><td><code id="projectn_+3A_object">object</code></td>
<td>
<p>An object of class <code>rmas</code>, i.e. resulting from <code>projectn</code>.</p>
</td></tr>
<tr><td><code id="projectn_+3A_x">x</code></td>
<td>
<p>An object resulting from <code>projectn</code> or <code>summary.rmas</code>.</p>
</td></tr>
<tr><td><code id="projectn_+3A_stage">stage</code></td>
<td>
<p>Print only the trajectory of the stage called ...</p>
</td></tr>
<tr><td><code id="projectn_+3A_harvest">harvest</code></td>
<td>
<p> Logical. Should the harvest history be summarized or ploted instead of the population one? </p>
</td></tr>  
<tr><td><code id="projectn_+3A_sum">sum</code></td>
<td>
<p>Logical. If <code>TRUE</code>, print the trajectory of the whole population. If <code>FALSE</code>, print the individual trajectory of all stages. </p>
</td></tr>
<tr><td><code id="projectn_+3A_mean">mean</code></td>
<td>
<p>Logical. If <code>TRUE</code>, print the mean trajectory of all replications. If <code>FALSE</code>, print all the replicated trajectories.</p>
</td></tr>
<tr><td><code id="projectn_+3A_type">type</code></td>
<td>
<p>Type of plot to represent the trajectories. By default, a line.  </p>
</td></tr>
<tr><td><code id="projectn_+3A_ylim">ylim</code></td>
<td>
<p>Vector with max and min values of the y (abundances) axis.  </p>
</td></tr>
<tr><td><code id="projectn_+3A_col">col</code></td>
<td>
<p>Color or vector of colors to draw the trajectories.</p>
</td></tr>
<tr><td><code id="projectn_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x-axis.</p>
</td></tr>
<tr><td><code id="projectn_+3A_ylab">ylab</code></td>
<td>
<p>Label for the y-axis.</p>
</td></tr>
<tr><td><code id="projectn_+3A_main">main</code></td>
<td>
<p>Text to appear as title.</p>
</td></tr>
<tr><td><code id="projectn_+3A_...">...</code></td>
<td>
<p>Other parameters passed to plot and other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function <code>projectn</code> makes demographic proyections by repetedly calling (as long as the time argument) to <code>project1</code>. If no environmental or demographic stochasticity is required, <code>project1</code> will multiply the transition matrix <code>mat</code> by the vector of stage abundances. 
</p>
<p>If demographic stochasticity is required, <code>project1</code> will call to <code>estdemo</code> function, that for each time will assign abundances to each stage based in sampling from both a binomial and a poisson distribution. Sampling from <a href="stats.html#topic+rbinom">rbinom</a> with probability <code>mat[i,j]</code> will assign  &quot;survival&quot; chances to each individual accounted for in the abundance vector, i.e. it would allow some of them to remain in the same stages (for transitions <code>mat[i,i]</code>) or to pass to another stage (for transitions <code>mat[i,j]</code>). Sampling from <a href="stats.html#topic+rpois">rpois</a> with mean <code>mat[i,j]</code> will assign to each individual of <code>stage[j]</code> a random number of offspring of type <code>stage[i]</code>. 
</p>
<p>In the current implementation there are 3 options to generate demographic stochasticity. By deafult ( <code>stmat=NULL</code> and <code>fecundity1=TRUE</code>) probabilities in the first row of the transition matrix (i.e <code>mat[1,j]</code>) are assumed to represent <b>only</b> fecundities, i.e., they would not account for &quot;survival&quot; transitions from stage[j] to stage[1], but only for newborns. This means that these probabilities will only be used as the mean for sampling from <a href="stats.html#topic+rpois">rpois</a>. Transitions in rows others than first row will be assumed to represent &quot;survival&quot; transitions if its value is &lt;=1 and accordingly will be employed to sample from <a href="stats.html#topic+rbinom">rbinom</a>. Transitions &gt;1 will be assumed to represent fecundities and will be employed to sample from <a href="stats.html#topic+rpois">rpois</a>.
</p>
<p>If <code>stmat=NULL</code> and <code>fecundity1=FALSE</code> transition probabilities in all the rows of the matrix <code>mat</code> are treated in the same way, i.e. probabilities &lt;=1 will be sampled from <a href="stats.html#topic+rbinom">rbinom</a> and probabilities &gt;1 will be sampled from <a href="stats.html#topic+rpois">rpois</a>.
</p>
<p>If a <code>stmat</code> matrix (a matrix with values between 0 and 1) is provided, it will be used to divide transition probabilities <code>mat[i,j]</code> into fecundities (<code>mat[i,j] * stmat[i,j]</code>) and survival probabilities (<code>mat[i,j] - (mat[i,j] * stmat[i,j])</code>) and these matrices will be used to sample from <a href="stats.html#topic+rbinom">rbinom</a> and <a href="stats.html#topic+rpois">rpois</a> respectively.
</p>
<p><em>The current implementation of</em> <code>estdemo</code> <em>assumes that reproduction takes place before &quot;survival sorting&quot;</em>, so even for individuals that wouldn't survive (according to its sampled binomial probability) offspring is computed (if approppriate) and accounted for.
</p>
<p>If environmental stochasticity is required (i.e., a <code>matsd</code> matrix is provided), <code>project1</code> will call to <code>estambi</code> function, that for each time will change <code>mat[i,j]</code> probabilities sampling from <a href="stats.html#topic+rnorm">rnorm</a> with <code>mean= mat[i,j]</code> and <code>sd = matsd[i,j]</code>. If <code>equalsign=TRUE</code> the random changes in all cells of <code>mat</code> will have the same sign and the same magnitude (relative to each individual <code>matsd[i,j]</code>). If <code>equalsign=FALSE</code> every transition probability will change independently.
</p>
<p>If both environmental and demographic stochasticity are required <code>project1</code> will call first to <code>estambi</code> and using the modified <code>mat</code> will call to <code>estdemo</code>.
</p>
<p>If management is required, a vector or matrix of magement actions  should be provided. In the simplest case (i.e., a vector), each element in the vector will be interpreted as the management action that will be applied each time step to the corresponding stage. Positive and negative elements in the vector represent respectively the introduction or extraction of individuals from the corresponding stage. Elements whose absolute value is &gt;= 1 will be interpreted as the introduction or extraction of exactly that number of individuals; absolute values &lt; 1 will be interpreted as the introduction or extraction of that proportion of individuals from the existing individuals in the corresponding stage. If &quot;management&quot; is a matrix, each time step the management actions represented by each column of the matrix will be applied sequentially, from first to last.
</p>


<h3>Value</h3>

<p><code>project1</code>, <code>estdemo</code> and <code>estambi</code> return a vector of stage abundances with the same length that <code>v0</code>.
</p>
<p><code>projectn</code> return an object of class <code>rmas</code>, basically a list with four elements: <code>vn</code>, with length = (<code>nrep</code>) where each of its elements represents a replicate simulation and consist of a matrix of dimensions <code>[lengtth(v0), time]</code> representing the abundance of each stage at each time. If the simulation included management actions, <code>harvest</code> will be a list of length (<code>nrep</code>) where each of its elements represents the trajectory of harvest in a replicate simulation and consist of a matrix of dimensions <code>[lengtth(v0), time]</code> representing the number of individuals extracted of each stage at each time. The other two elements, <code>mat</code> and <code>management</code>,  are respectively the transition matrix and the managenet matrix employed in the simulations.
The <code>plot</code> method will draw the demographic trajectory of the population. By default (<code>sum = TRUE, mean=FALSE</code>) it will plot the abundance of the whole population (i.e. the the sum of abundances in each stage) vs. time. If nrep &gt;1 it will plot together the trajectory of each replicated population. If ( <code>sum = TRUE, mean=TRUE</code>) it will plot the mean of all repplicated populations. If (<code>sum = FALSE, mean=TRUE</code>) it wil plot the abundance (or the mean abundance in all the replications) of each stage vs. time.
</p>
<p>The <code>summary</code> and <code>plot.summary</code> methods will print a table and draw a plot respectively with the maximun, mean + 1 sd, mean, mean - 1 sd and minimum values of population abundance in all the simulations.
</p>


<h3>Author(s)</h3>

<p>Marcelino de la Cruz Rot
</p>


<h3>References</h3>

<p>Akcakaya, H. R., Burgman, M. A. and Ginzburg L.R. 1999. <em>Applied Population Ecology</em>. Sinauer.
</p>
<p>Caswell, H. 2003. <em>Matrix Population Models: Construction, Analysis, and Interpretation </em>. Sinauer. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>   
     data(coryphanthaA)
     coryphanthaA &lt;- as.tmatrix(coryphanthaA)
  
     # run a deterministic simulation of 20 years from an initial state of
     # 100 small juveniles:
     v0 &lt;- c(100,0,0)
     simu20 &lt;- projectn(v0=v0, mat=coryphanthaA, time = 20)
     plot(simu20, sum=FALSE)
     summary(simu20)
  
     # run 100 simulations of 20 years with  demographic stochasticity:
     simu20.ds &lt;- projectn(v0=v0, mat=coryphanthaA, time = 20, estdem=TRUE, nrep=100)
     plot(simu20.ds)
     summary(simu20.ds)
     
     # run 100 simulations of 20 years with  demographic stochasticity but 
     # assuming that the first row of the transition matrix represent both
     # fecundity and survival, each with a 50% contribution 
     
     # first generate the stmat matrix:
     stmat &lt;- (coryphanthaA &gt;0)
     stmat &lt;- stmat*c(0.5,0,0)
     stmat
     
     simu20.ds2 &lt;- projectn(v0=v0, mat=coryphanthaA, time = 20, estdem=TRUE,
                             stmat=stmat, nrep=100)
     plot(simu20.ds2)
     summary(simu20.ds2)
          
  
     # run 100 simulations of 20 years with  both demographic and environmental
     # stochasticity:
     # first generate a sd matrix to describe environmental stochasticity:
     sdenv &lt;- coryphanthaA/20 
     sdenv
     
     simu20.eds &lt;- projectn(v0=v0, mat=coryphanthaA, matsd =sdenv,  time = 20,
                            estdem=TRUE,estamb=TRUE, nrep=100)
     plot(simu20.eds)
     summary(simu20.eds)
     
     # Example of management actions
     #    each time step, 10 individuals will be added to the first stage ,10 individuals  
     #    will be added to the second stage, and 50 percent of the individuals in the 
     #    third stage will be extracted
     
        man &lt;- c(10, 10, -0.5)
        p1 &lt;- projectn(v0 = c(100, 100,100), mat= coryphanthaA, management=man)
	
        # summarize and plot population trajectory
        summary(p1) 
	
	# summarizes and plots harvest history
	summary(p1, harvest=TRUE)  
           

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
