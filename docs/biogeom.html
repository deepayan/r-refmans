<!DOCTYPE html><html lang="en"><head><title>Help for package biogeom</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {biogeom}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#adjdata'>
<p>Boundary Data Adjustment of A Polygon</p></a></li>
<li><a href='#areaGE'>
<p>Area Calculation for the Gielis Curve Within <code class="reqn">[0, 2\pi)</code></p></a></li>
<li><a href='#areaovate'>
<p>Area Calculation for an Ovate Polygon</p></a></li>
<li><a href='#bambooleaves'>
<p>Leaf Boundary Data of <em>Phyllostachys incarnata</em> T. H. Wen (Poaceae: Bambusoideae)</p></a></li>
<li><a href='#bilat'>
<p>Measure of the Extent of Bilateral Symmetry of A Polygon</p></a></li>
<li><a href='#biogeom'>
<p>Biological Geometries</p></a></li>
<li><a href='#curveEPE'>
<p>Drawing the Preston Curve Produced by the the Explicit Preston Equation</p></a></li>
<li><a href='#curveETE'>
<p>Drawing the Troscianko Curve Produced by the Explicit Troscianko Equation</p></a></li>
<li><a href='#curveGE'>
<p>Drawing the Gielis Curve</p></a></li>
<li><a href='#curveNRGE'>
<p>Drawing the Egg Shape Predicted by the Narushin-Romanov-Griffin Equation</p></a></li>
<li><a href='#curveovate'>
<p>Drawing the Ovate Leaf-Shape Curve</p></a></li>
<li><a href='#DEPE'>
<p>Calculation of the First-Order Derivative of the Explicit Preston Equation</p></a></li>
<li><a href='#DETE'>
<p>Calculation of the First-Order Derivative of the Explicit Troscianko Equation</p></a></li>
<li><a href='#DNRGE'>
<p>Calculation of the First-Order Derivative of the Narushin-Romanov-Griffin Equation</p></a></li>
<li><a href='#DSGE'>
<p>Calculation of the First-Order Derivative of the Simplified Gielis Equation</p></a></li>
<li><a href='#eggs'>
<p>Egg Boundary Data of Nine Species of Birds</p></a></li>
<li><a href='#EPE'>
<p>Calculation of the Ordinate For an Arbitrary Point on the Preston Curve in the Plane</p></a></li>
<li><a href='#ETE'>
<p>Calculation of the Ordinate For an Arbitrary Point on the Troscianko Curve in the Plane</p></a></li>
<li><a href='#fitEPE'>
<p>Data-Fitting Function for the Explicit Preston Equation</p></a></li>
<li><a href='#fitETE'>
<p>Data-Fitting Function for the Explicit Troscianko Equation</p></a></li>
<li><a href='#fitGE'>
<p>Data-Fitting Function for the Gielis Equation</p></a></li>
<li><a href='#fitLorenz'>
<p>Data-Fitting Function for the Rotated and Right-Shifted Lorenz Curve</p></a></li>
<li><a href='#fitNRGE'>
<p>Parameter Estimation for the Narushin-Romanov-Griffin Equation</p></a></li>
<li><a href='#fitovate'>
<p>Data-Fitting Function for the Ovate Leaf-Shape Equation</p></a></li>
<li><a href='#fitsigmoid'>
<p>Data-Fitting Function for the Sigmoid Growth Equation</p></a></li>
<li><a href='#fitSuper'>
<p>Data-Fitting Function for the Superellipse Equation</p></a></li>
<li><a href='#fracdim'>
<p>Calculation of Fractal Dimension of Lef Veins Based on the Box-Counting Method</p></a></li>
<li><a href='#GE'>
<p>Calculation of the Polar Radius of the Gielis Curve</p></a></li>
<li><a href='#ginkgoseed'>
<p>Boundary Data of the Side Projections of <em>Ginkgo biloba</em> Seeds</p></a></li>
<li><a href='#kp'>
<p>Boundary Data of the Vertical Projections of <em>Koelreuteria paniculata</em> Fruit</p></a></li>
<li><a href='#LeafSizeDist'>
<p>Leaf size distribution of <em>Shibataea chinensis</em></p></a></li>
<li><a href='#lmPE'>
<p>Parameter Estimation for the Todd-Smart Equation</p></a></li>
<li><a href='#lmTE'>
<p>Parameter Estimation for the Troscianko Equation</p></a></li>
<li><a href='#MbetaE'>
<p>Modified Beta Equation</p></a></li>
<li><a href='#MBriereE'>
<p>Modified Briere Equation</p></a></li>
<li><a href='#MLRFE'>
<p>Modified Lobry-Rosso-Flandrois (LRF) Equation</p></a></li>
<li><a href='#MPerformanceE'>
<p>Modified Performance Equation</p></a></li>
<li><a href='#Neocinnamomum'>
<p>Leaf Boundary Data of Seven Species of <em>Neocinnamomum</em></p></a></li>
<li><a href='#NRGE'>
<p>The Narushin-Romanov-Griffin Equation (NRGE)</p></a></li>
<li><a href='#PE'>
<p>Calculation of the Abscissa, Ordinate and Distance From the Origin For an Arbitrary Point on the Preston Curve</p></a></li>
<li><a href='#SarabiaE'>
<p>Sarabia Equation</p></a></li>
<li><a href='#SCSE'>
<p>Sarabia-Castillo-Slottje Equation (SCSE)</p></a></li>
<li><a href='#SHE'>
<p>Sitthiyot-Holasut Equation</p></a></li>
<li><a href='#shoots'>
<p>Height Growth Data of Bamboo Shoots</p></a></li>
<li><a href='#sigmoid'>
<p>Sigmoid Growth Equation</p></a></li>
<li><a href='#starfish'>
<p>Boundary Data of Eight Sea Stars</p></a></li>
<li><a href='#SurfaceAreaEPE'>
<p>Calculation of the Surface Area of An Egg Based on the Explicit Preston Equation</p></a></li>
<li><a href='#SurfaceAreaETE'>
<p>Calculation of the Surface Area of An Egg Based on the Explicit Troscianko Equation</p></a></li>
<li><a href='#SurfaceAreaNRGE'>
<p>Calculation of the Surface Area of An Egg Based on the Narushin-Romanov-Griffin Equation</p></a></li>
<li><a href='#SurfaceAreaSGE'>
<p>Calculation of the Surface Area of An Egg Based on the Simplified Gielis Equation</p></a></li>
<li><a href='#TE'>
<p>The Troscianko Equation (TE)</p></a></li>
<li><a href='#TGE'>
<p>Calculation of the Polar Radius of the Twin Gielis Curve</p></a></li>
<li><a href='#TSE'>
<p>The Todd-Smart Equation (TSE)</p></a></li>
<li><a href='#veins'>
<p>Leaf Vein Data of <em>Michelia compressa</em></p></a></li>
<li><a href='#VolumeEPE'>
<p>Calculation of the Volume of An Egg Based on the Explicit Preston Equation</p></a></li>
<li><a href='#VolumeETE'>
<p>Calculation of the Volume of An Egg Based on the Explicit Troscianko Equation</p></a></li>
<li><a href='#VolumeNRGE'>
<p>Calculation of the Volume of An Egg Based on the Narushin-Romanov-Griffin Equation</p></a></li>
<li><a href='#VolumeSGE'>
<p>Calculation of the Volume of An Egg Based on the Simplified Gielis Equation</p></a></li>
<li><a href='#whitespruce'>
<p>Planar Coordinates of <em>Picea glauca</em> Tree Rings</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Biological Geometries</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-21</td>
</tr>
<tr>
<td>Author:</td>
<td>Peijian Shi [aut, cre],
  Johan Gielis [aut],
  Brady K. Quinn [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Peijian Shi &lt;pjshi@njfu.edu.cn&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>spatstat.geom (&ge; 2.4-0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Is used to simulate and fit biological geometries. 'biogeom' incorporates several novel universal parametric equations that can generate the profiles of bird eggs, flowers, linear and lanceolate leaves, seeds, starfish, and tree-rings (Gielis (2003) &lt;<a href="https://doi.org/10.3732%2Fajb.90.3.333">doi:10.3732/ajb.90.3.333</a>&gt;; Shi et al. (2020) &lt;<a href="https://doi.org/10.3390%2Fsym12040645">doi:10.3390/sym12040645</a>&gt;), three growth-rate curves representing the ontogenetic growth trajectories of animals and plants against time, and the axially symmetrical and integral forms of all these functions (Shi et al. (2017) &lt;<a href="https://doi.org/10.1016%2Fj.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>&gt;; Shi et al. (2021) &lt;<a href="https://doi.org/10.3390%2Fsym13081524">doi:10.3390/sym13081524</a>&gt;). The optimization method proposed by Nelder and Mead (1965) &lt;<a href="https://doi.org/10.1093%2Fcomjnl%2F7.4.308">doi:10.1093/comjnl/7.4.308</a>&gt; was used to estimate model parameters. 'biogeom' includes several real data sets of the boundary coordinates of natural shapes, including avian eggs, fruit, lanceolate and ovate leaves, tree rings, seeds, and sea stars,and can be potentially applied to other natural shapes. 'biogeom' can quantify the conspecific or interspecific similarity of natural outlines, and provides information with important ecological and evolutionary implications for the growth and form of living organisms. Please see Shi et al. (2022) &lt;<a href="https://doi.org/10.1111%2Fnyas.14862">doi:10.1111/nyas.14862</a>&gt; for details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.3.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-21 14:14:58 UTC; PEIJIAN SHI</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-29 06:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='adjdata'>
Boundary Data Adjustment of A Polygon
</h2><span id='topic+adjdata'></span>

<h3>Description</h3>

<p><code>adjdata</code> adjusts the data points in counterclockwise order based on the shortest distance method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>adjdata(x, y, ub.np = 2000, times = 1.2, len.pro = 1/20, index.sp = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="adjdata_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of points on a polygon's boundary.</p>
</td></tr>
<tr><td><code id="adjdata_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of points on a polygon's boundary.</p>
</td></tr>
<tr><td><code id="adjdata_+3A_ub.np">ub.np</code></td>
<td>
<p>the upper bound of the number of points eventually retained on the polygon's boundary.</p>
</td></tr>
<tr><td><code id="adjdata_+3A_times">times</code></td>
<td>
<p>the number of times <code>un.np</code> is initially retained as the number of points.</p>
</td></tr>
<tr><td><code id="adjdata_+3A_len.pro">len.pro</code></td>
<td>
<p>the proportion of the distance between any two points to 
the maximum distance between the points on the polygon's boundary, which is used to 
determine whether the second point needs to be deleted.</p>
</td></tr>
<tr><td><code id="adjdata_+3A_index.sp">index.sp</code></td>
<td>
<p>the index of the starting point of a group of indices that regularly 
divide the number of points on the polygon's boundary into <code>ub.np</code> parts.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>ub.np</code> &gt; <code>length(x)</code>, <code>length(x)</code> points 
on the polygon's boundary are retained. 
The <code><a href="stats.html#topic+quantile">quantile</a></code> function in package <span class="pkg">stats</span> 
is used to carry out the regular division of data points. From the starting point, the second point is the 
one that has the shortest distance from the former. When the distance between the two points 
is larger than <code>len.pro</code> multiplied by the maximum distance between points on the polygon's boundary,   
the second point is deleted from the coordinates. 
Then, the third point that has the shortest distance from the first point is defined as the second point. 
If the distance between the first point and the second point is no more than <code>len.pro</code> multiplied 
by the maximum distance, the first and second points are recorded in a new matrix for the coordinates of the polygon, 
and the second point is defined as the first point in the old matrix for the coordinates of the polygon. 
The shortest distance method is then used to look for a third point that meets the requirement. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of points eventually retained on the polygon's boundary.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of points eventually retained on the polygon's boundary.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The initial boundary data of a polygon can be obtained by running the M-file based on Matlab (version &gt;= 2009a) 
developed by Shi et al. (2018) and Su et al. (2019) for a .bmp black and white image of the polygon. See references below.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Li, Y., Zhang, L., Lin, S., Gielis, J. (2018) General leaf-area geometric 
formula exists for plants - Evidence from the simplified Gielis equation. 
<em>Forests</em> 9, 714. <a href="https://doi.org/10.3390/f9110714">doi:10.3390/f9110714</a>
</p>
<p>Su, J., Niklas, K.J., Huang, W., Yu, X., Yang, Y., Shi, P. (2019) 
Lamina shape does not correlate with lamina surface area: An analysis based on the simplified Gielis equation. 
<em>Global Ecology and Conservation</em> 19, e00666. <a href="https://doi.org/10.1016/j.gecco.2019.e00666">doi:10.1016/j.gecco.2019.e00666</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)
uni.C1 &lt;- sort( unique(eggs$Code) )
ind1   &lt;- 2
Data1  &lt;- eggs[eggs$Code==uni.C1[ind1], ]
x0     &lt;- Data1$x
y0     &lt;- Data1$y

Res1   &lt;- adjdata(x0, y0, ub.np=2000, times=1.2, len.pro=1/20)
x1     &lt;- Res1$x
y1     &lt;- Res1$y

dev.new()
plot( x1, y1, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")),
      pch=1, col=1 ) 

Res2   &lt;- adjdata(x0, y0, ub.np=40, times=1, len.pro=1/2, index.sp=20)
x2     &lt;- Res2$x
y2     &lt;- Res2$y

Res3   &lt;- adjdata(x0, y0, ub.np=100, times=1, len.pro=1/2, index.sp=100)
x3     &lt;- Res3$x
y3     &lt;- Res3$y

dev.new()
plot( x2, y2, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")),
      pch=1, col=4 ) 
points( x3, y3, col=2)


data(starfish)

uni.C2 &lt;- sort( unique(starfish$Code) )
ind2   &lt;- 2
Data2  &lt;- starfish[starfish$Code==uni.C2[ind2], ]
x4     &lt;- Data2$x
y4     &lt;- Data2$y

dev.new()
plot( x4, y4, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )

Res4 &lt;- adjdata(x4, y4, ub.np=500, times=1.2, len.pro=1/20)
x5   &lt;- Res4$x
y5   &lt;- Res4$y

dev.new()
plot( x5, y5, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )

graphics.off()

</code></pre>

<hr>
<h2 id='areaGE'>
Area Calculation for the Gielis Curve Within <code class="reqn">[0, 2\pi)</code>
</h2><span id='topic+areaGE'></span>

<h3>Description</h3>

<p><code>areaGE</code> is used to calculate the area of the polygon 
generated by the Gielis curve within <code class="reqn">[0, 2\pi)</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>areaGE(expr, P, m = 1, simpver = NULL,  
       nval = 1, subdivisions = 100L,
       rel.tol = .Machine$double.eps^0.25, 
       abs.tol = rel.tol, stop.on.error = TRUE, 
       keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="areaGE_+3A_expr">expr</code></td>
<td>
<p>the original (or twin) Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_p">P</code></td>
<td>
<p>the parameters of the original (or twin) Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_m">m</code></td>
<td>
<p>the given <code class="reqn">m</code> value that determines the number of angles of the Gielis curve within <code class="reqn">[0, 2\pi)</code>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original (or twin) Gielis equation.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_nval">nval</code></td>
<td>
<p>the specified value for <code class="reqn">n_{1}</code> or <code class="reqn">n_{2}</code> or <code class="reqn">n_{3}</code> in the simplified versions.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaGE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments of <code>P</code>, <code>m</code>, <code>simpver</code>, and <code>nval</code> should correspond 
to <code>expr</code> (i.e., <code>GE</code> or <code>TGE</code>). Please note the differences in the simplified 
version number and the number of parameters between <code>GE</code> and <code>TGE</code>.
</p>


<h3>Value</h3>

<p>The area of the polygon within <code class="reqn">[0, 2\pi)</code> generated by the original (or twin) Gielis equation 
or one of its simplified versions.
</p>


<h3>Note</h3>

<p><code>simpver</code> in <code>GE</code> is different from that in <code>TGE</code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Gielis, J. (2003) A generic geometric transformation that unifies a wide range of natural 
and abstract shapes. <em>American Journal of Botany</em> 90, 333<code class="reqn">-</code>338. <a href="https://doi.org/10.3732/ajb.90.3.333">doi:10.3732/ajb.90.3.333</a>
</p>
<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric 
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>
<p>Shi, P., Xu, Q., Sandhu, H.S., Gielis, J., Ding, Y., Li, H., Dong, X. (2015) Comparison
of dwarf bamboos (<em>Indocalamus</em> sp.) leaf parameters to determine relationship
between spatial density of plants and total leaf area per plant. <em>Ecology and Evolution</em> 5,
4578<code class="reqn">-</code>4589. <a href="https://doi.org/10.1002/ece3.1728">doi:10.1002/ece3.1728</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveGE">curveGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code>, <code><a href="#topic+TGE">TGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Para1 &lt;- c(1.7170, 5.2258, 7.9802)
areaGE(GE, P = Para1, m=5, simpver=1)

Para2 &lt;- c(2.1066, 3.5449, 0.4619, 10.5697)
areaGE(TGE, P = Para2, m=5, simpver=1)
</code></pre>

<hr>
<h2 id='areaovate'>
Area Calculation for an Ovate Polygon
</h2><span id='topic+areaovate'></span>

<h3>Description</h3>

<p><code>areaovate</code> is used to calculate the area of an ovate polygon made 
from combing two symmetrical curves generated by a performance equation (e.g., <code><a href="#topic+MLRFE">MLRFE</a></code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>areaovate(expr, P, simpver = NULL,  
          subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, 
          abs.tol = rel.tol, stop.on.error = TRUE, 
          keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="areaovate_+3A_expr">expr</code></td>
<td>
<p>a performance equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_p">P</code></td>
<td>
<p>the parameters of the performance equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplfied version of the performance equation.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="areaovate_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The performance equations denote <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, and their simplified versions. 
The arguments of <code>P</code> and <code>simpver</code> should correspond 
to <code>expr</code> (i.e., <code><a href="#topic+MbetaE">MbetaE</a></code> or <code><a href="#topic+MBriereE">MBriereE</a></code> or <code><a href="#topic+MLRFE">MLRFE</a></code>). 
</p>


<h3>Value</h3>

<p>The area of two symmetrical curves along the <code class="reqn">x</code>-axis 
generated by a performance equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>Here, the user can define other performance equations, but new equations or 
their simplified versions should include the lower and upper thresholds in 
the <code class="reqn">x</code>-axis corresponding to <code class="reqn">y = 0</code>, whose indices should 
be the same as those in <code><a href="#topic+MbetaE">MbetaE</a></code> or <code><a href="#topic+MBriereE">MBriereE</a></code> or <code><a href="#topic+MLRFE">MLRFE</a></code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Yu, K., Niklas, K.J., Schrader, J., Song, Y., Zhu, R., Li, Y., Wei, H., Ratkowsky, D.A. (2021)  
A general model for describing the ovate leaf shape. <em>Symmetry</em> 13, 1524. <a href="https://doi.org/10.3390/sym13081524">doi:10.3390/sym13081524</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Par1 &lt;- c(1.8175, 2.7795, 7.1557, 1.6030)
areaovate(MbetaE, P = Par1, simpver = 1)

Par2 &lt;- c(0.0550, 0.3192, 7.1965, 0.5226)
areaovate(MBriereE, P = Par2, simpver = 1)

Par3 &lt;- c(1.8168, 2.7967, 7.2623, 0.9662)
areaovate(MLRFE, P = Par3, simpver = 1)

Par4 &lt;- c(2.4, 0.96, 0.64, 7.75, 1.76, 3.68)
areaovate(MPerformanceE, P = Par4, simpver = 1)
</code></pre>

<hr>
<h2 id='bambooleaves'>
Leaf Boundary Data of <em>Phyllostachys incarnata</em> T. H. Wen (Poaceae: Bambusoideae)
</h2><span id='topic+bambooleaves'></span>

<h3>Description</h3>

<p>The data consist of the boundary data of six leaves of <em>P. incarnata</em> 
sampled at Nanjing Forestry University campus in early December 2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bambooleaves)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are three columns of variables: <code>Code</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual leaves; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the leaf boundary in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the leaf boundary in the Cartesian coordinate system (cm).
</p>


<h3>References</h3>

<p>Lin, S., Shao, L., Hui, C., Song, Y., Reddy, G.V.P., Gielis, J., Li, F., Ding, Y., Wei, Q., 
Shi, P. (2018) Why does not the leaf weight-area allometry of bamboos follow the 3/2-power law? 
<em>Frontiers in Plant Science</em> 9, 583. <a href="https://doi.org/10.3389/fpls.2018.00583">doi:10.3389/fpls.2018.00583</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Li, Y., Zhang, L., Lin, S., Gielis, J. (2018) 
General leaf-area geometric formula exists for plants - Evidence from the simplified Gielis equation. 
<em>Forests</em> 9, 714. <a href="https://doi.org/10.3390/f9110714">doi:10.3390/f9110714</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bambooleaves)

uni.C &lt;- sort( unique(bambooleaves$Code) )
ind   &lt;- 1
Data  &lt;- bambooleaves[bambooleaves$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

dev.new()
plot( x0, y0, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )
length(x0)

Res1 &lt;- adjdata(x0, y0, ub.np=600, len.pro=1/20)
dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )

graphics.off()
</code></pre>

<hr>
<h2 id='bilat'>
Measure of the Extent of Bilateral Symmetry of A Polygon
</h2><span id='topic+bilat'></span>

<h3>Description</h3>

<p><code>bilat</code> is used to measure the extent of bilateral (a)symmetry and other measures for a polygon (e.g., a leaf).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bilat(x, y, strip.num = 200, peri.np = NULL, n.loop = 60,
      auto.search = TRUE, animation.fig = TRUE, time.interval = 0.001,   
      unit = "cm", main = NULL, diff.fig = TRUE, angle = NULL,  
      ratiox = 0.02, ratioy = 0.08, fd.opt = TRUE, frac.fig = TRUE,
      denomi.range = seq(8, 30, by = 1))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bilat_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="bilat_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="bilat_+3A_strip.num">strip.num</code></td>
<td>
<p>the number of equidistant strips intersecting with 
the polygon that are horizontally placed. See Shi et al. (2018, 2020) for details.</p>
</td></tr>  
<tr><td><code id="bilat_+3A_peri.np">peri.np</code></td>
<td>
<p>the number of data points on the boundary retained for calculating the perimeter of the polygon.</p>
</td></tr>
<tr><td><code id="bilat_+3A_n.loop">n.loop</code></td>
<td>
<p>the number of data points to randomly sample for calculating the mean perimeter of the polygon.</p>
</td></tr>
<tr><td><code id="bilat_+3A_auto.search">auto.search</code></td>
<td>
<p>an optional argument to automatically search the maximum distance between two points on the polygon's boundary.</p>
</td></tr>
<tr><td><code id="bilat_+3A_animation.fig">animation.fig</code></td>
<td>
<p>the option of showing the data points on the polygon's boundary in an animation.</p>
</td></tr>
<tr><td><code id="bilat_+3A_time.interval">time.interval</code></td>
<td>
<p>the time interval at which to suspend execution, in seconds.</p>
</td></tr>
<tr><td><code id="bilat_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the polygon.</p>
</td></tr>
<tr><td><code id="bilat_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>  
<tr><td><code id="bilat_+3A_diff.fig">diff.fig</code></td>
<td>
<p>an optional argument to draw the differences in areas between the intersections of the strips 
with the upper part of the polygon and the intersections of the strips with the lower part of the polygon. 
The polygon is divided into the upper and lower parts by the <code class="reqn">x</code>-axis. See Shi et al. (2018, 2020) for details.</p>
</td></tr>
<tr><td><code id="bilat_+3A_angle">angle</code></td>
<td>
<p>the angle between the major axis (i.e., the leaf length axis) and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="bilat_+3A_fd.opt">fd.opt</code></td>
<td>
<p>An optional argument to use the box-counting method to calculate the fractal
dimension of the polygon's boundary on a log-log scale.</p>
</td></tr>
<tr><td><code id="bilat_+3A_ratiox">ratiox</code></td>
<td>
<p>the <code class="reqn">x</code> coordinate of the location parameter for positioning the legend in the plot of the linear fitting.</p>
</td></tr>
<tr><td><code id="bilat_+3A_ratioy">ratioy</code></td>
<td>
<p>the <code class="reqn">y</code> coordinate of the location parameter for positioning the legend in the plot of the linear fitting.</p>
</td></tr>
<tr><td><code id="bilat_+3A_frac.fig">frac.fig</code></td>
<td>
<p>an optional argument to draw the results of the linear fitting using the box-counting method to calculate the fractal
dimension of the polygon's boundary on a log-log scale.</p>
</td></tr>
<tr><td><code id="bilat_+3A_denomi.range">denomi.range</code></td>
<td>
<p>the number of equidistant segments of the maximum range 
between the range of the <code class="reqn">x</code> coordinates and that of the <code class="reqn">y</code> coordinates.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The data of <code>x</code> and <code>y</code> should be the coordinates adjusted using the <code><a href="#topic+adjdata">adjdata</a></code> function. 
If <code>peri.np = NULL</code>, the number of <code>length(x)</code> is used to calculate the perimeter of the polygon; 
if <code>peri.np</code> is a positive integer, the number of data points retained on the polygon's boundary  
is equal to <code>peri.np</code> and random sampling for retaining <code>peri.np</code> data points is carried out 
<code>n.loop</code> times for calculating the mean perimeter of the polygon. That is to say, the final output for 
the perimeter is the mean of the <code>n.loop</code> perimeters (i.e., replicates). If the user wants to get a consistent result 
for the mean perimeter, the <code><a href="base.html#topic+set.seed">set.seed</a></code> function can be used. In addition, if <code>length(x) &lt; peri.np</code>, 
<code>peri.np</code> then becomes <code>length(x)</code> rather than the specified value in Arguments. 
If the polygon apparently has a major axis (e.g., the leaf length axis for an ovate leaf), <code>auto.search</code> 
is appropriate. If the major axis of the polygon is not the straight line through two points on the polygon's 
boundary having the maximum distance, the user can define the major axis using the <code><a href="graphics.html#topic+locator">locator</a></code> 
function in <span class="pkg">graphic</span> by clicking two points on or near the polygon's boundary. The location of the first click 
should be northeast of the location of the second click. This means that the angle between the straight line 
through the locations of the two clicks and the <code class="reqn">x</code>-axis should range from 0 to <code class="reqn">\pi</code>/2. The locations of the 
clicks can be on the boundary or be approximate to the boundary. The function will automatically find the nearest 
data point on the boundary to the location of each click. 
When <code>angle = NULL</code>, the observed polygon will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated <code class="reqn">\pi/4</code> counterclockwise from the <code class="reqn">x</code>-axis. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates retained on the polygon's boundary.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates retained on the polygon's boundary.</p>
</td></tr>
<tr><td><code>phi</code></td>
<td>
<p>the angle between the length axis (i.e., the major axis) of the polygon and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>n1</code></td>
<td>
<p>the number of data points on the upper boundary of the polygon.</p>
</td></tr>
<tr><td><code>n2</code></td>
<td>
<p>the number of data points on the lower boundary of the polygon.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>the number of data points on the whole polygon's boundary.</p>
</td></tr>
<tr><td><code>total.poly</code></td>
<td>
<p>an object of class &quot;ppp&quot; representing a point pattern dataset 
in the two-dimensional plane, representing the polygon's boundary.</p>
</td></tr>
<tr><td><code>upper.poly</code></td>
<td>
<p>an object of class &quot;ppp&quot; representing a point pattern dataset 
in the two-dimensional plane, representing the upper boundary of the polygon along the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>lower.poly</code></td>
<td>
<p>an object of class &quot;ppp&quot; representing a point pattern dataset 
in the two-dimensional plane, representing the lower boundary of the polygon along the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>D</code></td>
<td>
<p>the differences in areas between the upper and lower boundaries of the polygon.</p>
</td></tr>
<tr><td><code>par.upper.area</code></td>
<td>
<p>the area of the upper boundary of the polygon along the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>par.lower.area</code></td>
<td>
<p>the area of the lower boundary of the polygon along the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>SI</code></td>
<td>
<p>the standardized index for bilateral (a)symmetry for the polygon.</p>
</td></tr>
<tr><td><code>AR</code></td>
<td>
<p>the ratio of the areas of the upper to the lower parts of the polygon.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the length of the polygon. The default is the maximum distance between two points on 
the polygon's boundary.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the maximum width of the polygon.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the area of the polygon.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the perimeter of the polygon 
based on all data points or a mean of <code>n.loop</code> 
replicates of perimeters using the <code>peri.np</code> data points retained on the polygon's boundary.</p>
</td></tr>
<tr><td><code>x.width</code></td>
<td>
<p>distance from the base to a point on the major axis 
associated with the maximum width of the polygon.</p>
</td></tr>
<tr><td><code>width.1e</code></td>
<td>
<p>the width associated with 1/8 of <code>scan.length</code> (starting from the base of the polygon).</p>
</td></tr> 
<tr><td><code>width.2e</code></td>
<td>
<p>the width associated with 2/8 of <code>scan.length</code> (starting from the base of the polygon).</p>
</td></tr>
<tr><td><code>width.4e</code></td>
<td>
<p>the width associated with 4/8 of <code>scan.length</code> (starting from the base of the polygon).</p>
</td></tr>
<tr><td><code>width.6e</code></td>
<td>
<p>the width associated with 6/8 of <code>scan.length</code> (starting from the base of the polygon).</p>
</td></tr>
<tr><td><code>width.7e</code></td>
<td>
<p>the width associated with 7/8 of <code>scan.length</code> (starting from the base of the polygon).</p>
</td></tr>
<tr><td><code>bi.test</code></td>
<td>
<p>the testing results for <code>D</code> using the Wilcoxon signed rank test with continuity correction. 
See the <code><a href="stats.html#topic+wilcox.test">wilcox.test</a></code> function in <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code>a</code></td>
<td>
<p>the estimate of the intercept obtained using the box-counting method to calculate the fractal dimension of the polygon's boundary.</p>
</td></tr>
<tr><td><code>sd.a</code></td>
<td>
<p>the standard deviation of the estimated intercept.</p>
</td></tr>
<tr><td><code>lci.a</code></td>
<td>
<p>the lower bound of the 95% confidence interval of the estimated intercept.</p>
</td></tr>
<tr><td><code>uci.a</code></td>
<td>
<p>the upper bound of the 95% confidence interval of the estimated intercept.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>the estimate of the slope obtained using the box-counting method to calculate the fractal dimension of the polygon's boundary.</p>
</td></tr>
<tr><td><code>sd.b</code></td>
<td>
<p>the standard deviation of the estimated slope.</p>
</td></tr>
<tr><td><code>lci.a</code></td>
<td>
<p>the lower bound of the 95% confidence interval of the estimated slope.</p>
</td></tr>
<tr><td><code>uci.a</code></td>
<td>
<p>the upper bound of the 95% confidence interval of the estimated slope.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination obtained when using the box-counting method to calculate the fractal dimension of the polygon's boundary.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>the vector of box sizes used in the box-counting method to calculate the fractal dimension of the polygon's boundary.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the number of boxes that include at least one pixel of the polygon's boundary.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The polygon is expected to have an apparent major axis (e.g., the straight line through two points 
on the polygon's boundary having the maximum distance or one that can be clearly defined to pass by 
two landmarks on the polygon's boundary [i.e., the leaf length axis, the egg length axis, etc.]). 
The polygon is placed with its major axis overlapping the <code class="reqn">x</code>-axis; the base of the polygon is 
located at the origin; the apex of the polygon is located to the right of the base. 
<code>phi</code> is equal to <code>angle</code> when <code>angle</code> is not null. 
In theory, <code>n1 + n2 = n</code>, but in most cases <code>n1 + n2</code> is slightly smaller than <code>n</code>. 
The reason is that very few boundary points fall outside the the lower and upper boundaries of the polygon 
when using the <code>intersect.owin</code> function in <span class="pkg">spatstat.geom</span>. However, this does not considerably affect the results. 
The log-transformed <code>SI</code> and 
the log-transformed <code>AR</code> are demontrated to have a more symmetrical frequency distribution than their original forms. 
This is important when performing an analysis of variance between (or among) groups to compared 
their extents of bilateral (a)symmetry. See Shi et al. (2020) for details. 
The box-counting approach uses a group of boxes (squares for simplicity) with different
sizes (<code class="reqn">\delta</code>) to divide the leaf vein image into different parts. Let <code class="reqn">N</code> represent the number
of boxes that include at least one pixel of the polygon's boundary. 
The maximum of the range of the <code class="reqn">x</code> coordinates and the range of the <code class="reqn">y</code> coordinates 
for the pixels of the polygon's boundary is defined as <code class="reqn">z</code>. Let <code class="reqn">\delta</code> represent the vector of 
<code class="reqn">z</code>/<code>denomi.range</code>. We then used the following equation to calculate the fractal 
dimension of the polygon's boundary: 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{ln } N = a + b\, \mathrm{ln} \left(\delta^{-1}\right),</code>
</p>

<p>where <code class="reqn">b</code> is the theoretical value of the fractal dimension. We can use its estimate as the 
numerical value of the fractal dimension for the polygon's boundary. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Niinemets, Ü., Hui, C., Niklas, K.J., Yu, X., Hölscher, D. (2020) 
Leaf bilateral symmetry and the scaling of the perimeter vs. the surface area in 15 vine species. 
<em>Forests</em> 11, 246. <a href="https://doi.org/10.3390/f11020246">doi:10.3390/f11020246</a>
</p>
<p>Shi, P., Zheng, X., Ratkowsky, D.A., Li, Y., Wang, P., Cheng, L. (2018)  
A simple method for measuring the bilateral symmetry of leaves. 
<em>Symmetry</em> 10, 118. <a href="https://doi.org/10.3390/sym10040118">doi:10.3390/sym10040118</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+adjdata">adjdata</a></code>, <code><a href="#topic+fracdim">fracdim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bambooleaves)

uni.C &lt;- sort( unique(bambooleaves$Code) )
ind   &lt;- 3
Data  &lt;- bambooleaves[bambooleaves$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

dev.new()
plot( x0, y0, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(x)), ylab=expression(italic(y)) )

Res1 &lt;- adjdata(x0, y0, ub.np=2000, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y



  Res2 &lt;- bilat( x=x1, y=y1, time.interval=0.00045, 
                 peri.np=NULL, auto.search=TRUE, 
                 fd.opt=TRUE )
  Res2$scan.perimeter

  set.seed(123)
  Res3 &lt;- bilat( x=x1, y=y1, time.interval=0.00045, 
                 peri.np=500, n.loop=30,
                 auto.search=TRUE, fd.opt=FALSE )
  Res3$scan.perimeter

  set.seed(123)
  Res4 &lt;- bilat( x=x1, y=y1, time.interval=0.00045, 
                 peri.np=500, n.loop=30,
                 auto.search=TRUE, fd.opt=FALSE, angle=pi/4 )
  Res4$scan.perimeter

  set.seed(123)  
  Res5 &lt;- bilat( x=x1, y=y1, time.interval=0.00045, 
                 peri.np=500, n.loop=30,
                 auto.search=TRUE, fd.opt=FALSE, angle=0 )
  Res5$scan.perimeter
  
  if(interactive()){
    # The angle between the leaf length axis (namely the straight 
    # line through the leaf apex and base) and the horizontal axis 
    # should be between 0 and pi/2 for a scanned leaf's profile. 
    # Here, the user needs to first click the leaf apex, 
    # and then click the leaf base. 
    set.seed(123)  
    Res6 &lt;- bilat( x=x1, y=y1, time.interval=0.00045, 
                 peri.np=500, n.loop=30,
                 auto.search=FALSE, fd.opt=FALSE, angle=NULL )
    Res6$scan.perimeter
  }

  set.seed(NULL)


graphics.off()
</code></pre>

<hr>
<h2 id='biogeom'>
Biological Geometries
</h2><span id='topic+biogeom'></span>

<h3>Description</h3>

<p>Is used to simulate and fit biological geometries. 'biogeom' incorporates several novel universal parametric equations 
that can generate the profiles of bird eggs, flowers, linear and lanceolate leaves, seeds, starfish, 
and tree-rings (Gielis, 2003; Shi et al., 2020), three growth-rate curves representing 
the ontogenetic growth trajectories of animals and plants against time, 
and the axially symmetrical and integral forms of all these functions (Shi et al., 2017, 2021). 
The optimization method proposed by Nelder and Mead (1965) was used to estimate model parameters. 
'biogeom' includes several real data sets of the boundary coordinates of natural shapes, 
including avian eggs, fruit, lanceolate and ovate leaves, 
tree rings, seeds, and sea stars,and can be potentially applied to other natural shapes. 
'biogeom' can quantify the conspecific or interspecific similarity of natural outlines, and provides information 
with important ecological and evolutionary implications for the growth and form of living organisms. Please see 
Shi et al. (2022) for details.  
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> biogeom</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Biological Geometries</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.4.3</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2024-03-21</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(given="Peijian", family="Shi", email="pjshi@njfu.edu.cn", role=c("aut", "cre")),
        person(given=c("Johan"), family="Gielis", email="johan.gielis@uantwerpen.be", role=c("aut")),
        person(given=c("Brady K."), family="Quinn", email="brady.quinn@dfo-mpo.gc.ca", role=c("aut")))</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Peijian Shi [aut, cre], Johan Gielis [aut], Brady K. Quinn [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Peijian Shi &lt;pjshi@njfu.edu.cn&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> spatstat.geom (&gt;= 2.4-0)</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Is used to simulate and fit biological geometries. 'biogeom' incorporates several novel universal parametric equations that can generate the profiles of bird eggs, flowers, linear and lanceolate leaves, seeds, starfish, and tree-rings (Gielis (2003) &lt;doi:10.3732/ajb.90.3.333&gt;; Shi et al. (2020) &lt;doi:10.3390/sym12040645&gt;), three growth-rate curves representing the ontogenetic growth trajectories of animals and plants against time, and the axially symmetrical and integral forms of all these functions (Shi et al. (2017) &lt;doi:10.1016/j.ecolmodel.2017.01.012&gt;; Shi et al. (2021) &lt;doi:10.3390/sym13081524&gt;). The optimization method proposed by Nelder and Mead (1965) &lt;doi:10.1093/comjnl/7.4.308&gt; was used to estimate model parameters. 'biogeom' includes several real data sets of the boundary coordinates of natural shapes, including avian eggs, fruit, lanceolate and ovate leaves, tree rings, seeds, and sea stars,and can be potentially applied to other natural shapes. 'biogeom' can quantify the conspecific or interspecific similarity of natural outlines, and provides information with important ecological and evolutionary implications for the growth and form of living organisms. Please see Shi et al. (2022) &lt;doi:10.1111/nyas.14862&gt; for details.</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 4.3.0)</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> no</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
DEPE                    Calculation of the First-Order Derivative of
                        the Explicit Preston Equation
DETE                    Calculation of the First-Order Derivative of
                        the Explicit Troscianko Equation
DNRGE                   Calculation of the First-Order Derivative of
                        the Narushin-Romanov-Griffin Equation
DSGE                    Calculation of the First-Order Derivative of
                        the Simplified Gielis Equation
EPE                     Calculation of the Ordinate For an Arbitrary
                        Point on the Preston Curve in the Plane
ETE                     Calculation of the Ordinate For an Arbitrary
                        Point on the Troscianko Curve in the Plane
GE                      Calculation of the Polar Radius of the Gielis
                        Curve
LeafSizeDist            Leaf size distribution of _Shibataea chinensis_
MBriereE                Modified Briere Equation
MLRFE                   Modified Lobry-Rosso-Flandrois (LRF) Equation
MPerformanceE           Modified Performance Equation
MbetaE                  Modified Beta Equation
NRGE                    The Narushin-Romanov-Griffin Equation (NRGE)
Neocinnamomum           Leaf Boundary Data of Seven Species of
                        _Neocinnamomum_
PE                      Calculation of the Abscissa, Ordinate and
                        Distance From the Origin For an Arbitrary Point
                        on the Preston Curve
SCSE                    Sarabia-Castillo-Slottje Equation (SCSE)
SHE                     Sitthiyot-Holasut Equation
SarabiaE                Sarabia Equation
SurfaceAreaEPE          Calculation of the Surface Area of An Egg Based
                        on the Explicit Preston Equation
SurfaceAreaETE          Calculation of the Surface Area of An Egg Based
                        on the Explicit Troscianko Equation
SurfaceAreaNRGE         Calculation of the Surface Area of An Egg Based
                        on the Narushin-Romanov-Griffin Equation
SurfaceAreaSGE          Calculation of the Surface Area of An Egg Based
                        on the Simplified Gielis Equation
TE                      The Troscianko Equation (TE)
TGE                     Calculation of the Polar Radius of the Twin
                        Gielis Curve
TSE                     The Todd-Smart Equation (TSE)
VolumeEPE               Calculation of the Volume of An Egg Based on
                        the Explicit Preston Equation
VolumeETE               Calculation of the Volume of An Egg Based on
                        the Explicit Troscianko Equation
VolumeNRGE              Calculation of the Volume of An Egg Based on
                        the Narushin-Romanov-Griffin Equation
VolumeSGE               Calculation of the Volume of An Egg Based on
                        the Simplified Gielis Equation
adjdata                 Boundary Data Adjustment of A Polygon
areaGE                  Area Calculation for the Gielis Curve Within
                        [0, 2pi)
areaovate               Area Calculation for an Ovate Polygon
bambooleaves            Leaf Boundary Data of _Phyllostachys incarnata_
                        T. H. Wen (Poaceae: Bambusoideae)
bilat                   Measure of the Extent of Bilateral Symmetry of
                        A Polygon
biogeom                 Biological Geometries
curveEPE                Drawing the Preston Curve Produced by the the
                        Explicit Preston Equation
curveETE                Drawing the Troscianko Curve Produced by the
                        Explicit Troscianko Equation
curveGE                 Drawing the Gielis Curve
curveNRGE               Drawing the Egg Shape Predicted by the
                        Narushin-Romanov-Griffin Equation
curveovate              Drawing the Ovate Leaf-Shape Curve
eggs                    Egg Boundary Data of Nine Species of Birds
fitEPE                  Data-Fitting Function for the Explicit Preston
                        Equation
fitETE                  Data-Fitting Function for the Explicit
                        Troscianko Equation
fitGE                   Data-Fitting Function for the Gielis Equation
fitLorenz               Data-Fitting Function for the Rotated and
                        Right-Shifted Lorenz Curve
fitNRGE                 Parameter Estimation for the
                        Narushin-Romanov-Griffin Equation
fitSuper                Data-Fitting Function for the Superellipse
                        Equation
fitovate                Data-Fitting Function for the Ovate Leaf-Shape
                        Equation
fitsigmoid              Data-Fitting Function for the Sigmoid Growth
                        Equation
fracdim                 Calculation of Fractal Dimension of Lef Veins
                        Based on the Box-Counting Method
ginkgoseed              Boundary Data of the Side Projections of
                        _Ginkgo biloba_ Seeds
kp                      Boundary Data of the Vertical Projections of
                        _Koelreuteria paniculata_ Fruit
lmPE                    Parameter Estimation for the Todd-Smart
                        Equation
lmTE                    Parameter Estimation for the Troscianko
                        Equation
shoots                  Height Growth Data of Bamboo Shoots
sigmoid                 Sigmoid Growth Equation
starfish                Boundary Data of Eight Sea Stars
veins                   Leaf Vein Data of _Michelia compressa_
whitespruce             Planar Coordinates of _Picea glauca_ Tree Rings
</pre>


<h3>Note</h3>

<p>We are deeply thankful to Cang Hui, Yang Li, Uwe Ligges, Valeriy G. Narushin, 
Ülo Niinemets, Karl J. Nikas, Honghua Ruan, 
David A. Ratkowsky, Julian Schrader, Rolf Turner, Lin Wang, and Victoria Wimmer for 
their valuable help during creating this package. This work was supported by 
the National Key Research and Development Program of China (Grant No. 2021YFD02200403) and 
Simon Stevin Institute for Geometry (Antwerpen, Belguim).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi [aut, cre], Johan Gielis [aut], Brady K. Quinn [aut]
</p>
<p>Maintainer: Peijian Shi &lt;pjshi@njfu.edu.cn&gt;
</p>


<h3>References</h3>

<p>Gielis, J. (2003) A generic geometric transformation that unifies a wide range of natural 
and abstract shapes. <em>American Journal of Botany</em> 90, 333<code class="reqn">-</code>338. <a href="https://doi.org/10.3732/ajb.90.3.333">doi:10.3732/ajb.90.3.333</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric 
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>
<p>Shi, P., Yu, K., Niklas, K.J., Schrader, J., Song, Y., Zhu, R., Li, Y., Wei, H., Ratkowsky, D.A. (2021)  
A general model for describing the ovate leaf shape. <em>Symmetry</em>, 13, 1524. <a href="https://doi.org/10.3390/sym13081524">doi:10.3390/sym13081524</a>
</p>

<hr>
<h2 id='curveEPE'>
Drawing the Preston Curve Produced by the the Explicit Preston Equation
</h2><span id='topic+curveEPE'></span>

<h3>Description</h3>

<p><code>curveEPE</code> is used to draw the Preston curve that is produced by the explicit Preston equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveEPE(P, np = 5000, simpver = NULL,
        fig.opt = FALSE, deform.fun = NULL, Par = NULL,
        xlim = NULL, ylim = NULL, unit = NULL, main="")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curveEPE_+3A_p">P</code></td>
<td>
<p>the three location parameters and the parameters of the explicit 
Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_np">np</code></td>
<td>
<p>the number of data points on the Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplfied version of the explicit Preston equation.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_deform.fun">deform.fun</code></td>
<td>
<p>the deformation function used to describe the deviation from a theoretical Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_par">Par</code></td>
<td>
<p>the parameter(s) of the deformation function.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Preston curve.</p>
</td></tr>
<tr><td><code id="curveEPE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first three elements of <code>P</code> are location parameters. The first two are the planar coordinates of the transferred origin, 
and the third is the angle between the major axis of the curve and the <code class="reqn">x</code>-axis. Here, the major axis is a straight line through 
the two ends of an egg's profile (i.e., the mid-line of the egg's profile). The other arguments in <code>P</code> 
(except these first three location parameters), and <code>simpver</code> should correspond to those of <code>P</code> in <code>EPE</code>. 
<code>deform.fun</code> should take the form as: <code>deform.fun &lt;- function(Par, z){...}</code>, where <code>z</code> is 
a two-dimensional matrix related to the <code class="reqn">x</code> and <code class="reqn">y</code> values. 
And the return value of <code>deform.fun</code> should be a <code>list</code> with two variables <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the Preston curve.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the Preston curve.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When the rotation angle is zero (i.e., the third element in <code>P</code> is zero), <code>np</code> data points 
are distributed counterclockwise on the Preston curve from the rightmost end of the egg's profile to itself. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Preston, F.W. (1953) The shapes of birds' eggs. <em>The Auk</em> 70, 160<code class="reqn">-</code>182.
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Todd, P.H., Smart, I.H.M. (1984) The shape of birds' eggs. <em>Journal of Theoretical Biology</em> 
106, 239<code class="reqn">-</code>243. <a href="https://doi.org/10.1016/0022-5193%2884%2990021-3">doi:10.1016/0022-5193(84)90021-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPE">EPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+lmPE">lmPE</a></code>, <code><a href="#topic+PE">PE</a></code>, <code><a href="#topic+TSE">TSE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Para1 &lt;- c(0, 0, 0, 10, 6, 0.325, -0.0415)
  curveEPE(P=Para1, simpver=1, fig.opt=TRUE)
  Para2 &lt;- c(0, 0, pi, 10, 6, -0.325, -0.0415)
  curveEPE(P=Para2, simpver=1, fig.opt=TRUE)

  Para3 &lt;- c(0, 0, 0, 10, 6, 0.325, -0.0415, 0.2)
  curveEPE(P=Para3, simpver=NULL, fig.opt=TRUE)
  Para4 &lt;- c(0, 0, pi, 10, 6, -0.325, -0.0415, 0.2)
  curveEPE(P=Para4, simpver=NULL, fig.opt=TRUE)

  Para5 &lt;- c(0, 0, pi/4, 10, 6, 0.325, -0.0415)
  curveEPE(P=Para5, simpver=1, 
          fig.opt=TRUE, main="A rotated egg shape")

  # There is an example that introduces a deformation function in the egg-shape equation
  myfun &lt;- function(Par, z){
    x  &lt;- z[,1]
    y  &lt;- z[,2]
    k1 &lt;- Par[1]
    k2 &lt;- Par[2]
    y  &lt;- y - k1*(y+k2)^2
    list(x=x, y=y)
  }
  deform.op &lt;- curveEPE(P=Para1, np=5000, simpver=1, 
                       fig.opt=TRUE, deform.fun=myfun, Par=c(0.05, 8))


  graphics.off()
</code></pre>

<hr>
<h2 id='curveETE'>
Drawing the Troscianko Curve Produced by the Explicit Troscianko Equation
</h2><span id='topic+curveETE'></span>

<h3>Description</h3>

<p><code>curveETE</code> is used to draw the Troscianko curve that is produced by the explicit Troscianko equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveETE(P, np = 5000, fig.opt = FALSE, deform.fun = NULL, Par = NULL,
        xlim = NULL, ylim = NULL, unit = NULL, main="")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curveETE_+3A_p">P</code></td>
<td>
<p>the three location parameters and the parameters of the explicit 
Troscianko equation.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_np">np</code></td>
<td>
<p>the number of data points on the Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_deform.fun">deform.fun</code></td>
<td>
<p>the deformation function used to describe the deviation from a theoretical Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_par">Par</code></td>
<td>
<p>the parameter(s) of the deformation function.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Troscianko curve.</p>
</td></tr>
<tr><td><code id="curveETE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first three elements of <code>P</code> are location parameters. The first two are the planar coordinates of the transferred origin, 
and the third is the angle between the major axis of the curve and the <code class="reqn">x</code>-axis. Here, the major axis is a straight line through 
the two ends of an egg's profile (i.e., the mid-line of the egg's profile). The other arguments in <code>P</code> 
(except these first three location parameters) should correspond to those of <code>P</code> in <code>ETE</code>. 
<code>deform.fun</code> should take the form as: <code>deform.fun &lt;- function(Par, z){...}</code>, where <code>z</code> is 
a two-dimensional matrix related to the <code class="reqn">x</code> and <code class="reqn">y</code> values. 
And the return value of <code>deform.fun</code> should be a <code>list</code> with two variables <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the Troscianko curve.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the Troscianko curve.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When the rotation angle is zero (i.e., the third element in <code>P</code> is zero), <code>np</code> data points 
are distributed counterclockwise on the Troscianko curve from the rightmost end of the egg's profile to itself. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston’s universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ETE">ETE</a></code>, <code><a href="#topic+fitETE">fitETE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Para1 &lt;- c(0, 0, 0, 2.25, -0.377, -0.29, -0.16)
  curveETE(P=Para1, fig.opt=TRUE)

  # There is an example that introduces a deformation function in the egg-shape equation
  myfun &lt;- function(Par, z){
    x  &lt;- z[,1]
    y  &lt;- z[,2]
    k1 &lt;- Par[1]
    k2 &lt;- Par[2]
    y  &lt;- y - k1*(y+k2)^2
    list(x=x, y=y)
  }
  deform.op &lt;- curveETE(P=Para1, np=5000, fig.opt=TRUE, deform.fun=myfun, Par=c(0.05, 8))

  graphics.off()
</code></pre>

<hr>
<h2 id='curveGE'>
Drawing the Gielis Curve
</h2><span id='topic+curveGE'></span>

<h3>Description</h3>

<p><code>curveGE</code> is used to draw the Gielis curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveGE(expr, P, phi = seq(0, 2*pi, len = 2000),
        m = 1, simpver = NULL, nval = 1,
        fig.opt = FALSE, deform.fun = NULL, Par = NULL,
        xlim = NULL, ylim = NULL, unit = NULL, main="")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curveGE_+3A_expr">expr</code></td>
<td>
<p>the original (or twin) Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_p">P</code></td>
<td>
<p>the three location parameters and the parameters of the original (or twin) 
Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_phi">phi</code></td>
<td>
<p>the given polar angles at which we want to draw the Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_m">m</code></td>
<td>
<p>the given <code class="reqn">m</code> value that determines the number of angles of the Gielis curve within <code class="reqn">[0, 2\pi)</code>.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplfied version of the original (or twin) Gielis equation.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_nval">nval</code></td>
<td>
<p>the specified value for <code class="reqn">n_{1}</code> or <code class="reqn">n_{2}</code> or <code class="reqn">n_{3}</code> in the simplified versions.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_deform.fun">deform.fun</code></td>
<td>
<p>the deformation function used to describe the deviation from a theoretical Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_par">Par</code></td>
<td>
<p>the parameter(s) of the deformation function.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Gielis curve.</p>
</td></tr>
<tr><td><code id="curveGE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first three elements of <code>P</code> are location parameters. The first two are the planar coordinates of the transferred polar point, 
and the third is the angle between the major axis of the curve and the <code class="reqn">x</code>-axis. The other arguments in <code>P</code> 
(except these first three location parameters), <code>m</code>, <code>simpver</code>, and <code>nval</code> should correspond 
to <code>expr</code> (i.e., <code>GE</code> or <code>TGE</code>).  
Please note the differences in the simplified version number and the 
number of parameters between <code>GE</code> and <code>TGE</code>. 
<code>deform.fun</code> should take the form as: <code>deform.fun &lt;- function(Par, z){...}</code>, where <code>z</code> is 
a two-dimensional matrix related to the <code class="reqn">x</code> and <code class="reqn">y</code> values. 
And the return value of <code>deform.fun</code> should be a <code>list</code> with two variables <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the Gielis curve corresponding to the given polar angles <code>phi</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the Gielis curve corresponding to the given polar angles <code>phi</code>.</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>the polar radii of the Gielis curve corresponding to the given polar angles <code>phi</code>.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code>simpver</code> in <code>GE</code> is different from that in <code>TGE</code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Gielis, J. (2003) A generic geometric transformation that unifies a wide range of natural 
and abstract shapes. <em>American Journal of Botany</em> 90, 333-338. <a href="https://doi.org/10.3732/ajb.90.3.333">doi:10.3732/ajb.90.3.333</a>
</p>
<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>
<p>Shi, P., Gielis, J., Niklas, K.J. (2022) Comparison of a universal (but complex) model for avian egg 
shape with a simpler model. <em>Annals of the New York Academy of Sciences</em> 1514, 34<code class="reqn">-</code>42. <a href="https://doi.org/10.1111/nyas.14799">doi:10.1111/nyas.14799</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>
<p>Shi, P., Xu, Q., Sandhu, H.S., Gielis, J., Ding, Y., Li, H., Dong, X. (2015) Comparison
of dwarf bamboos (<em>Indocalamus</em> sp.) leaf parameters to determine relationship
between spatial density of plants and total leaf area per plant. <em>Ecology and Evolution</em> 5,
4578-4589. <a href="https://doi.org/10.1002/ece3.1728">doi:10.1002/ece3.1728</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaGE">areaGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code>, <code><a href="#topic+TGE">TGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GE.par  &lt;- c(2, 1, 4, 6, 3)
phi.vec &lt;- seq(0, 2*pi, len=2000)
r.theor &lt;- GE(P=GE.par, phi=phi.vec, m=5)

dev.new()
plot( phi.vec, r.theor, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(phi)), ylab=expression(italic("r")),
      type="l", col=4 ) 

curve.par &lt;- c(1, 1, pi/4, GE.par)
GE.res    &lt;- curveGE(GE, P=curve.par, fig.opt=TRUE, deform.fun=NULL, Par=NULL, m=5)
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(0, 0, 0, 2, 4, 20), m=1, simpver=1, fig.opt=TRUE )
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(1, 1, pi/4, 2, 1, 3), m=5, simpver=1, fig.opt=TRUE )
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(1, 1, pi/4, 2, 1, 3), m=2, simpver=1, fig.opt=TRUE )
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(1, 1, pi/4, 2, 0.05), m=1, simpver=2, fig.opt=TRUE )
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(1, 1, pi/4, 2), m=4, simpver=3, nval=2, fig.opt=TRUE )
# GE.res$r

GE.res    &lt;- curveGE( GE, P=c(1, 1, pi/4, 2, 0.6), m=4, simpver=8, nval=2, fig.opt=TRUE )
# GE.res$r

graphics.off()
</code></pre>

<hr>
<h2 id='curveNRGE'>
Drawing the Egg Shape Predicted by the Narushin-Romanov-Griffin Equation
</h2><span id='topic+curveNRGE'></span>

<h3>Description</h3>

<p><code>curveNRGE</code> is used to draw the egg shape predicted by the Narushin-Romanov-Griffin equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveNRGE(P, np = 5000, fig.opt = FALSE, deform.fun = NULL, Par = NULL, 
    xlim = NULL, ylim = NULL, unit = NULL, main = "")
</code></pre>


<h3>Arguments</h3>

 
<table role = "presentation">
<tr><td><code id="curveNRGE_+3A_p">P</code></td>
<td>
<p>the three location parameters and the four parameters of the Narushin-Romanov-Griffin equation (Narushin et al., 2021).</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_np">np</code></td>
<td>
<p>the number of data points on the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_deform.fun">deform.fun</code></td>
<td>
<p>the deformation function used to describe the deviation from a theoretical Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_par">Par</code></td>
<td>
<p>the parameter(s) of the deformation function.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="curveNRGE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first three elements of <code>P</code> are location parameters. The first two are the planar coordinates of the transferred origin, 
and the third is the angle between the major axis of the curve and the <code class="reqn">x</code>-axis. The other arguments in <code>P</code> 
should be the same as those in <code><a href="#topic+NRGE">NRGE</a></code>.  
<code>deform.fun</code> should take the form as: <code>deform.fun &lt;- function(Par, z){...}</code>, where <code>z</code> is 
a two-dimensional matrix related to the <code class="reqn">x</code> and <code class="reqn">y</code> values. 
And the return value of <code>deform.fun</code> should be a <code>list</code> with two variables <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the Narushin-Romanov-Griffin curve.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>When the rotation angle is zero (i.e., the third element in <code>P</code> is zero), <code>np</code> data points 
are distributed counterclockwise on the Narushin-Romanov-Griffin curve from the rightmost end of the egg's profile to itself.       
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Shi, P., Gielis, J., Niklas, K.J. (2022) Comparison of a universal (but complex) model for avian egg 
shape with a simpler model. <em>Annals of the New York Academy of Sciences</em> 1514, 34<code class="reqn">-</code>42. <a href="https://doi.org/10.1111/nyas.14799">doi:10.1111/nyas.14799</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Tian, F., Wang, Y., Sandhu, H.S., Gielis, J., Shi, P. (2020) Comparison of seed morphology of two ginkgo cultivars. 
<em>Journal of Forestry Research</em> 31, 751<code class="reqn">-</code>758. <a href="https://doi.org/10.1007/s11676-018-0770-y">doi:10.1007/s11676-018-0770-y</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitNRGE">fitNRGE</a></code>, <code><a href="#topic+NRGE">NRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>PA   &lt;- c(1, 1, pi/4, 11.5, 7.8, 1.1, 5.6)
resA &lt;- curveNRGE(PA, np=5000, fig.opt=TRUE)
resB &lt;- curveNRGE(PA, np=5000, fig.opt=TRUE, xlim=c(-6, 6), 
                  ylim=c(-6, 6), main="A pear-shaped egg") 
cbind(resB$x, resB$y)

graphics.off()
</code></pre>

<hr>
<h2 id='curveovate'>
Drawing the Ovate Leaf-Shape Curve
</h2><span id='topic+curveovate'></span>

<h3>Description</h3>

<p><code>curveovate</code> is used to draw the ovate leaf-shape curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>curveovate(expr, P, x, fig.opt = FALSE, 
           deform.fun = NULL, Par = NULL,
           xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="curveovate_+3A_expr">expr</code></td>
<td>
<p>the simplified version 1 of a performance equation.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_p">P</code></td>
<td>
<p>the three location parameters and the parameters of the simplified version 1 of a performance equation.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values to draw the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_deform.fun">deform.fun</code></td>
<td>
<p>the deformation function used to describe the deviation 
from a theoretical ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_par">Par</code></td>
<td>
<p>the parameter(s) of the deformation function.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="curveovate_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>P</code> has two types of elements: three location parameters, and model parameters. 
This means that <code>expr</code> is limited to be the simplified version 1 (where <code class="reqn">x_{\mathrm{min}} = 0</code>)  
in <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, and <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>. 
The first three elements of <code>P</code> are location parameters, among which the first two 
are the planar coordinates of the transferred origin, 
and the third is the angle between the major axis of the curve and the <code class="reqn">x</code>-axis. 
<code>deform.fun</code> should take the form as: <code>deform.fun &lt;- function(Par, z){...}</code>, where <code>z</code> is 
a two-dimensional matrix related to the <code class="reqn">x</code> and <code class="reqn">y</code> values. 
And the return value of <code>deform.fun</code> should be a <code>list</code> with two variables <code>x</code> and <code>y</code>.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the ovate leaf-shape curve.</p>
</td></tr> 
</table>


<h3>Note</h3>

<p>The number of elements in <code>P</code> here has additional three location parameters than that 
in <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Huey, R.B., Stevenson, R.D. (1979) Integrating thermal physiology and ecology of ectotherms: 
a discussion of approaches. <em>American Zoologist</em> 19, 357<code class="reqn">-</code>366. <a href="https://doi.org/10.1093/icb/19.1.357">doi:10.1093/icb/19.1.357</a>
</p>
<p>Li, Y., Zheng, Y., Ratkowsky, D.A., Wei, H., Shi, P. (2022) Application of an ovate leaf shape model 
to evaluate leaf bilateral asymmetry and calculate lamina centroid location. 
<em>Frontiers in Plant Science</em> 12, 822907. <a href="https://doi.org/10.3389/fpls.2021.822907">doi:10.3389/fpls.2021.822907</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees - Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Ge, F., Sun, Y., Chen, C. (2011) A simple model for describing 
the effect of temperature on insect developmental rate. <em>Journal of Asia-Pacific Entomology</em> 
14, 15<code class="reqn">-</code>20. <a href="https://doi.org/10.1016/j.aspen.2010.11.008">doi:10.1016/j.aspen.2010.11.008</a> 
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Yu, K., Niklas, K.J., Schrader, J., Song, Y., Zhu, R., Li, Y., Wei, H., Ratkowsky, D.A. (2021)  
A general model for describing the ovate leaf shape. <em>Symmetry</em> 13, 1524. <a href="https://doi.org/10.3390/sym13081524">doi:10.3390/sym13081524</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, 
<code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>P1  &lt;- c(1, 1, pi/4, 2, 3, 10, 4)
RE1 &lt;- curveovate(MLRFE, P=P1, x=seq(0, 10, by=0.1), fig.opt=TRUE)
RE2 &lt;- curveovate(MbetaE, P=P1, x=seq(0, 10, by=0.1), fig.opt=TRUE)

dev.new()
plot(RE1$x, RE1$y, cex.lab=1.5, cex.axis=1.5, type="l", 
  xlab=expression(italic(x)), ylab=expression(italic(y))) 
lines(RE2$x, RE2$y, col=4)

P3  &lt;- c(1, 1, pi/4, 2.4, 0.96, 0.64, 7.75, 1.76, 3.68)
RE3 &lt;- curveovate(MPerformanceE, P=P3, x=seq(0, 7.75, by=0.01), fig.opt=TRUE)

dev.new()
plot(RE3$x, RE3$y, cex.lab=1.5, cex.axis=1.5, type="l", 
  xlab=expression(italic(x)), ylab=expression(italic(y))) 

graphics.off()
</code></pre>

<hr>
<h2 id='DEPE'>
Calculation of the First-Order Derivative of the Explicit Preston Equation  
</h2><span id='topic+DEPE'></span>

<h3>Description</h3>

<p><code>DEPE</code> is used to calculate the first-order derivative of the explicit Preston equation at a given <em>x</em>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEPE(P, x, simpver = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DEPE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="DEPE_+3A_x">x</code></td>
<td>
<p>the <em>x</em>-value used in the explicit Preston equation.</p>
</td></tr>
<tr><td><code id="DEPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the explicit Preston equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the first-order derivative of 
the explicit Preston equation at a given <em>x</em>-value is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{b\left[a^{4}\,c_{1}+a^{3}\left(2\,c_{2}-1\right)x+
a^2\left(3\,c_{3}-2\,c_{1}\right)x^{2}-3\,a\,c_{2}x^3-4\,c_{3}\,x^{4}\right]}{a^4\sqrt{a^2-x^2}}, </code>
</p>

<p>where <code>P</code> has five parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, <code class="reqn">c_{2}</code>, and <code class="reqn">c_{3}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the first-order derivative of the simplified version 1 is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{b\left[a^{4}\,c_{1}+a^{3}\left(2\,c_{2}-1\right)x-
2\,a^2\,c_{1}\,x^{2}-3\,a\,c_{2}x^3\right]}{a^4\sqrt{a^2-x^2}}, </code>
</p>

<p>where <code>P</code> has four parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, and <code class="reqn">c_{2}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the first-order derivative of the simplified version 2 is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{b\left[a^{4}\,c_{1}-a^{3}\,x-
2\,a^2\,c_{1}\,x^{2}\right]}{a^4\sqrt{a^2-x^2}}, </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{1}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the first-order derivative of the simplified version 3 is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> f(x)=\frac{b\left[a^{3}\left(2\,c_{2}-1\right)x-3\,a\,c_{2}x^3\right]}{a^4\sqrt{a^2-x^2}}, </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{2}</code>.
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+DEPE">DEPE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+EPE">EPE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPE">EPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+SurfaceAreaEPE">SurfaceAreaEPE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par3 &lt;- c(4.27, 2.90, 0.0868, 0.0224, -0.0287)
  xx1  &lt;- seq(-4.27, 4.27, by=0.001)
  f1   &lt;- DEPE(P=Par3, x=xx1, simpver=NULL)
  f2   &lt;- -DEPE(P=Par3, x=xx1, simpver=NULL)

  dev.new()
  plot(xx1, f1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlim=c(-5, 5), ylim=c(-35, 35), xlab=expression(italic(x)), 
       ylab=expression(paste(italic(f), "(", italic(x), ")", sep="")))
  lines(xx1, f2, col=2)  

  graphics.off()
</code></pre>

<hr>
<h2 id='DETE'>
Calculation of the First-Order Derivative of the Explicit Troscianko Equation  
</h2><span id='topic+DETE'></span>

<h3>Description</h3>

<p><code>DETE</code> is used to calculate the first-order derivative of the explicit Troscianko equation at a given <em>x</em>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DETE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DETE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Troscianko equation.</p>
</td></tr>
<tr><td><code id="DETE_+3A_x">x</code></td>
<td>
<p>the <em>x</em>-value used in the explicit Troscianko equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first-order derivative of the explicit Troscianko equation at a given <em>x</em>-value is: 
</p>
<p style="text-align: center;"><code class="reqn">h(x) = \left\{\alpha_{1}+\frac{2\,\alpha_{2}}{a}\,x-\frac{x}{a}\,\left[1-\left(\frac{x}{a}\right)^2\right]^{-1}\right\}\,\exp\left\{\alpha_{0}+\alpha_{1}\left(\frac{x}{a}\right)+\alpha_{2}\left(\frac{x}{a}\right)^2\right\}\,\sqrt{ 1-\left(\frac{x}{a}\right)^2 }, </code>
</p>

<p>where <code>P</code> has four parameters: <code class="reqn">a</code>, <code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code>.
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+DETE">DETE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+ETE">ETE</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ETE">ETE</a></code>, <code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+SurfaceAreaETE">SurfaceAreaETE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par5 &lt;- c(2.25, -0.38, -0.29, -0.16)
  xx2  &lt;- seq(-2.25, 2.25, by=0.001)
  h1   &lt;- DETE(P=Par5, x=xx2)
  h2   &lt;- -DETE(P=Par5, x=xx2)
  ind  &lt;- which(is.na(h1) | is.na(h2))
  xx2  &lt;- xx2[-ind]
  h1   &lt;- h1[-ind]
  h2  &lt;- h2[-ind]

  dev.new()
  plot(xx2, h1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlim=c(-2.25, 2.25), ylim=c(-30, 30), xlab=expression(italic(x)), 
       ylab=expression(paste(italic(h), "(", italic(x), ")", sep="")))
  lines(xx2, h2, col=2)  

  graphics.off()
</code></pre>

<hr>
<h2 id='DNRGE'>
Calculation of the First-Order Derivative of the Narushin-Romanov-Griffin Equation  
</h2><span id='topic+DNRGE'></span>

<h3>Description</h3>

<p><code>DNRGE</code> is used to calculate the first-order derivative of the Narushin-Romanov-Griffin equation at a given <em>x</em>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DNRGE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DNRGE_+3A_p">P</code></td>
<td>
<p>the parameters of the Narushin-Romanov-Griffin equation.</p>
</td></tr>
<tr><td><code id="DNRGE_+3A_x">x</code></td>
<td>
<p>the <em>x</em>-value used in the Narushin-Romanov-Griffin equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let us define:
</p>
<p style="text-align: center;"><code class="reqn">f_{1}(x) = \frac{B}{2}\sqrt{\frac{A^2-4x^2}{A^2+8Cx+4C^2}},</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{2}(x) = \sqrt{\frac{A\left(A^{2}+8Cx+4C^{2}\right)}{2(A-2C)x^{2}+\left(A^{2}+8AC-4C^{2}\right)x+2AC^{2}+A^{2}C+A^{3}}},</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{3}(x) = A^2 - 4x,</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{4}(x) = A^2+8Cx+4C^2,</code>
</p>

<p style="text-align: center;"><code class="reqn">E = \frac{\sqrt{5.5A^{2}+11AC+4C^{2}} \cdot \left(\sqrt{3}AB-2D\sqrt{A^{2}+2AC+4C^{2
}}\right)}{\sqrt{3}AB\left(\sqrt{5.5A^{2}+11AC+4C^{2}}-2\sqrt{A^{2}+2AC+4C^{2}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">F = 2\left(A-2C\right),</code>
</p>

<p style="text-align: center;"><code class="reqn">G = A^{2}+8AC-4C^{2},</code>
</p>

<p style="text-align: center;"><code class="reqn">H = 2AC^{2}+A^{2}C+A^{3},</code>
</p>

<p>and then the first-order derivative of the Narushin-Romanov-Griffin equation at a given <em>x</em>-value is:
</p>
<p style="text-align: center;"><code class="reqn">J(x) = -\frac{4\,f_{1}(x)\left[C\,f_{3}(x)+x\,f_{4}(x)\right]}{f_{3}(x) \cdot f_{4}(x)}\left\{1-E \cdot \left[1-f_{2}(x)\right]\right\}-\frac{AE}{2}\frac{f_{1}(x)}{f_{2}(x)}\frac{f_{4}(x) \cdot \left(2Fx+G\right)}{\left(Fx^2+Gx+H\right)^2},</code>
</p>

<p>where <code>P</code> has four parameters: <code class="reqn">A</code>, <code class="reqn">B</code>, <code class="reqn">C</code>, and <code class="reqn">D</code>.
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+DNRGE">DNRGE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+NRGE">NRGE</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitNRGE">fitNRGE</a></code>, <code><a href="#topic+NRGE">NRGE</a></code>, <code><a href="#topic+SurfaceAreaNRGE">SurfaceAreaNRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par6 &lt;- c(4.51, 3.18, 0.1227, 2.2284)
  xx3  &lt;- seq(-4.51/2, 4.51/2, len=2000)
  J1   &lt;- DNRGE(P=Par6, x=xx3)
  J2   &lt;- -DNRGE(P=Par6, x=xx3)
  ind  &lt;- which(is.na(J1) | is.na(J2))
  xx3  &lt;- xx3[-ind]
  J1   &lt;- J1[-ind]
  J2   &lt;- J2[-ind]

  dev.new()
  plot(xx3, J1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlim=c(-4.51/2, 4.51/2), ylim=c(-20, 20), xlab=expression(italic(x)), 
       ylab=expression(paste(italic(J), "(", italic(x), ")", sep="")))
  lines(xx3, J2, col=2)  

  graphics.off()
</code></pre>

<hr>
<h2 id='DSGE'>
Calculation of the First-Order Derivative of the Simplified Gielis Equation  
</h2><span id='topic+DSGE'></span>

<h3>Description</h3>

<p><code>DSGE</code> is used to calculate the first-order derivative of the simplified Gielis equation at a given <code class="reqn">\varphi</code>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DSGE(P, phi)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="DSGE_+3A_p">P</code></td>
<td>
<p>the parameters of the simplified Gielis equation, including <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>.</p>
</td></tr>
<tr><td><code id="DSGE_+3A_phi">phi</code></td>
<td>
<p>the <code class="reqn">\varphi</code>-value used in the simplified Gielis equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The first-order derivative of the simplified Gielis equation with arguments <code>simpver = 1</code> and <code>m = 1</code> at a given <code class="reqn">\varphi</code>-value is: 
</p>
<p style="text-align: center;"><code class="reqn">g(x) = \frac{a}{4}\,\frac{n_{2}}{n_{1}}\,\left[\left(\cos{\frac{\varphi}{4}}\right)^{n_{2}-1}\left(\sin{\frac{\varphi}{4}}\right)-\left(\sin{\frac{\varphi}{4}}\right)^{n_{2}-1}\left(\cos{\frac{\varphi}{4}}\right)\right]\ \left[\left(\cos{\frac{\varphi}{4}}\right)^{n_{2}}+\left(\sin{\frac{\varphi}{4}}\right)^{n_{2}}\right]^{-\frac{1}{n_{1}}-1}, </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>.
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+DSGE">DSGE</a></code> function only has 
the three parameters: <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Chen, Z. (2012) Volume and area of revolution under polar coordinate system. 
<em>Studies in College Mathematics</em> 15(6), 9<code class="reqn">-</code>11.
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+GE">GE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+SurfaceAreaSGE">SurfaceAreaSGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par7 &lt;- c(1.124, 14.86, 49.43)
  phi1 &lt;- seq(0, pi, len=2000)
  g1   &lt;- DSGE(P=Par7, phi=phi1)

  dev.new()
  plot(phi1, g1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlab=expression(italic(varphi)), 
       ylab=expression(paste(italic(g), "(", italic(varphi), ")", sep="")))

  graphics.off()
</code></pre>

<hr>
<h2 id='eggs'>
Egg Boundary Data of Nine Species of Birds
</h2><span id='topic+eggs'></span>

<h3>Description</h3>

<p>The data consist of the egg boundary data of nine species of birds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(eggs)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are four columns of variables: <code>Code</code>, <code>LatinName</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual eggs; 
<code>LatinName</code> saves the Latin names of the nine species of birds; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the egg boundary in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the egg boundary in the Cartesian coordinate system (cm). 
In <code>Code</code>, codes 1-9 represent <em>Strix uralensis</em>, <em>Dromaius novaehollandiae</em>, 
<em>Turdus philomelos</em>, <em>Gallus gallus</em>, <em>Pandion haliaetus</em>, <em>Uria aalge</em>, 
<em>Uria lomvia</em>, <em>Gallinago media</em>, and <em>Aptenodytes patagonicus</em>, respectively. 
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Shi, P., Gielis, J., Niklas, K.J. (2022) Comparison of a universal (but complex) model for avian egg 
shape with a simpler model. <em>Annals of the New York Academy of Sciences</em> 1514, 34<code class="reqn">-</code>42. <a href="https://doi.org/10.1111/nyas.14799">doi:10.1111/nyas.14799</a>
</p>
<p>Tian, F., Wang, Y., Sandhu, H.S., Gielis, J., Shi, P. (2020) Comparison of seed morphology of two ginkgo cultivars. 
<em>Journal of Forestry Research</em> 31, 751<code class="reqn">-</code>758. <a href="https://doi.org/10.1007/s11676-018-0770-y">doi:10.1007/s11676-018-0770-y</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=1000, times=1.2, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y

dev.new()
plot( x1, y1, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      xlab=expression(italic("x")), ylab=expression(italic("y")),
      pch=1, col=1 ) 

Res2 &lt;- adjdata(x0, y0, ub.np=60, times=1, len.pro=1/2, index.sp=20)
x2   &lt;- Res2$x
y2   &lt;- Res2$y

Res3 &lt;- adjdata(x0, y0, ub.np=60, times=1, len.pro=1/2, index.sp=100)
x3   &lt;- Res3$x
y3   &lt;- Res3$y

dev.new()
plot( x2, y2, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")),
      pch=1, col=4 ) 
points( x3, y3, col=2)

graphics.off()
</code></pre>

<hr>
<h2 id='EPE'>
Calculation of the Ordinate For an Arbitrary Point on the Preston Curve in the Plane  
</h2><span id='topic+EPE'></span>

<h3>Description</h3>

<p><code>EPE</code> is used to calculate the <em>y</em>-value for an arbitrary point on the Preston curve 
that was generated by the explicit Preston equation or one of its simplified versions for a given <em>x</em>-value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPE(P, x, simpver = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="EPE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="EPE_+3A_x">x</code></td>
<td>
<p>the <em>x</em>-value used in the explicit Preston equation.</p>
</td></tr>
<tr><td><code id="EPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the explicit Preston equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the explicit Preston equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> y = b\ \sqrt{1-\left(\frac{x}{a}\right)^2}\left(1+c_{1}\ \frac{x}{a}+c_{2}\left(\frac{x}{a}\right)^2+c_{3}\left(\frac{x}{a}\right)^3\right), </code>
</p>

<p>where <code>P</code> has five parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, <code class="reqn">c_{2}</code>, and <code class="reqn">c_{3}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> y = b\ \sqrt{1-\left(\frac{x}{a}\right)^2}\left(1+c_{1}\ \frac{x}{a}+c_{2}\left(\frac{x}{a}\right)^2\right), </code>
</p>

<p>where <code>P</code> has four parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, and <code class="reqn">c_{2}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> y = b\ \sqrt{1-\left(\frac{x}{a}\right)^2}\left(1+c_{1}\ \frac{x}{a}\right), </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{1}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> y = b\ \sqrt{1-\left(\frac{x}{a}\right)^2}\left(1+c_{2}\left(\frac{x}{a}\right)^2\right), </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{2}</code>.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the explicit Preston equation.
</p>


<h3>Note</h3>

<p>We only considered the upper part of the egg-shape curve in the above expressions because 
the lower part is symmetrical to the upper part around the <em>x</em>-axis.  
The mid-line of an egg's profile in <code><a href="#topic+EPE">EPE</a></code> is aligned to 
the <em>x</em>-axis, while the mid-line of an egg's profile in <code><a href="#topic+PE">PE</a></code> 
is aligned to the <em>y</em>-axis. The <code><a href="#topic+EPE">EPE</a></code> function has the same parameters, 
<code>P</code>, as those in the <code><a href="#topic+PE">PE</a></code> function. 
The explicit Preston equation is used for calculating an egg's volume and surface area, 
when the parameters, which are saved in the  <code>P</code> vector, 
are obtained using the <code><a href="#topic+fitEPE">fitEPE</a></code> function 
or the <code><a href="#topic+lmPE">lmPE</a></code> function based on the <code><a href="#topic+TSE">TSE</a></code> function. 
In addition, the values in <code>x</code> &gt; <code class="reqn">a</code> (i.e., the first element in <code>P</code>) 
are forced to be <code class="reqn">a</code>, and the values in 
<code>x</code> &lt; <code class="reqn">-a</code> will be forced to be <code class="reqn">-a</code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveEPE">curveEPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+PE">PE</a></code>, <code><a href="#topic+SurfaceAreaEPE">SurfaceAreaEPE</a></code>, <code><a href="#topic+VolumeEPE">VolumeEPE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par3 &lt;- c(4.27, 2.90, 0.0868, 0.0224, -0.0287)
  xx1  &lt;- seq(-4.27, 4.27, by=0.001)
  yy1  &lt;- EPE(P=Par3, x=xx1, simpver=NULL)
  yy2  &lt;- -EPE(P=Par3, x=xx1, simpver=NULL)

  dev.new()
  plot(xx1, yy1, asp=1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlim=c(-5, 5), ylim=c(-5, 5), 
       xlab=expression(italic(x)), ylab=expression(italic(y)))
  lines(xx1, yy2, col=2) 

  graphics.off() 
</code></pre>

<hr>
<h2 id='ETE'>
Calculation of the Ordinate For an Arbitrary Point on the Troscianko Curve in the Plane  
</h2><span id='topic+ETE'></span>

<h3>Description</h3>

<p><code>ETE</code> is used to calculate the <em>y</em>-value for an arbitrary point on the Troscianko curve 
that was generated by the explicit Troscianko equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ETE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ETE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Troscianko equation, including <code class="reqn">a</code>, <code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code>.</p>
</td></tr>
<tr><td><code id="ETE_+3A_x">x</code></td>
<td>
<p>the <em>x</em>-value used in the explicit Troscianko equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The explicit Troscianko equation is recommended as: 
</p>
<p style="text-align: center;"><code class="reqn"> y = a\,\exp\left\{\alpha_{0}+\alpha_{1}\,\left(\frac{x}{a}\right)+\alpha_{2}\, \left(\frac{x}{a}\right)^2\right\}\sqrt{1-\left(\frac{x}{a}\right)^2}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the explicit Troscianko curve; 
<code class="reqn">a</code>, <code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code> are parameters to be estimated.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the explicit Troscianko equation.
</p>


<h3>Note</h3>

<p>We only considered the upper part of the egg-shape curve in the above expressions because 
the lower part is symmetrical to the upper part around the <em>x</em>-axis.  
The mid-line of an egg's profile in <code><a href="#topic+ETE">ETE</a></code> is aligned to 
the <em>x</em>-axis. The argument, <code>P</code>, in the <code><a href="#topic+ETE">ETE</a></code> function has the same parameters, 
<code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code>, as those in the <code><a href="#topic+TE">TE</a></code> function. 
However, the former has an additional parameter <code class="reqn">a</code> than the latter, which represents half 
the egg's length. The <code><a href="#topic+lmTE">lmTE</a></code> function is based on the <code><a href="#topic+TE">TE</a></code> function, while 
the <code><a href="#topic+fitETE">fitETE</a></code> function is based on the <code><a href="#topic+ETE">ETE</a></code> function here. 
In addition, the values in <code>x</code> &gt; <code class="reqn">a</code> (i.e., the first element in <code>P</code>) 
are forced to be <code class="reqn">a</code>, and the values in <code>x</code> &lt; <code class="reqn">-a</code> will be forced to be <code class="reqn">-a</code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston’s universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Troscianko, J. (2014). A simple tool for calculating egg shape, volume and surface area from digital images. 
<em>Ibis</em>, 156, 874<code class="reqn">-</code>878. <a href="https://doi.org/10.1111/ibi.12177">doi:10.1111/ibi.12177</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveETE">curveETE</a></code>, <code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+SurfaceAreaETE">SurfaceAreaETE</a></code>, <code><a href="#topic+VolumeETE">VolumeETE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par5 &lt;- c(2.25, -0.38, -0.29, -0.16)
  xx2  &lt;- seq(-2.25, 2.25, len=2000)
  yy3  &lt;- ETE(P=Par5, x=xx2)
  yy4  &lt;- -ETE(P=Par5, x=xx2)

  dev.new()
  plot(xx2, yy3, asp=1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlim=c(-3, 3), ylim=c(-3, 3), 
       xlab=expression(italic(x)), ylab=expression(italic(y)))
  lines(xx2, yy4, col=2)  

  graphics.off()
</code></pre>

<hr>
<h2 id='fitEPE'>
Data-Fitting Function for the Explicit Preston Equation
</h2><span id='topic+fitEPE'></span>

<h3>Description</h3>

<p><code>fitEPE</code> is used to estimate the parameters of the explicit Preston equation 
or one of its simplified versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitEPE(x, y, ini.val, simpver = NULL, 
      control = list(), par.list = FALSE, 
      stand.fig = TRUE, angle = NULL, fig.opt = FALSE, np = 2000,
      xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitEPE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of an egg's profile.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of an egg's profile.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_ini.val">ini.val</code></td>
<td>
<p>the list of initial values for the model parameters.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the explicit Preston equation.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_stand.fig">stand.fig</code></td>
<td>
<p>the option of drawing the observed and predicted profiles of an egg at the standard state 
(i.e., the egg's centre is located at (0, 0), and the mid-line is aligned to the <code class="reqn">x</code>-axis).</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_angle">angle</code></td>
<td>
<p>the angle between the mid-line and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument of drawing the observed and predicted profiles of an egg 
at arbitrary angle between the major axis and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted explicit Preston curve.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Preston curve.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Preston curve.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_unit">unit</code></td>
<td>
<p>the unit of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Preston curve.</p>
</td></tr>
<tr><td><code id="fitEPE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>simpver</code> argument should correspond to <code>EPE</code>. Here, the major axis 
(i.e., the mid-line of an egg's profile) is the straight line trhough the two ends of the egg's length. 
The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization of minimizing 
the residual sum of squares (RSS) between the observed and predicted <code class="reqn">y</code> values. 
The <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
When <code>angle = NULL</code>, the observed egg's profile will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated by the amount (<code class="reqn">\pi/4</code>) counterclockwise from the <code class="reqn">x</code>-axis.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the observed length of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the observed width of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the observed area of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the observed perimeter of the egg's profile.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted <code class="reqn">y</code> values 
on the Preston curve.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values 
on the Preston curve.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates of the points 
on the Preston curve at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates of the points 
on the Preston curve at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates of the points 
on the Preston curve at the standard state.</p>
</td></tr> 
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates of the points on the Preston curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates of the points on the Preston curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates of the points on the Preston curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>In the outputs, there are no <code>x.stand.pred</code> and <code>x.pred</code>, because <code>y.stand.obs</code> and 
<code>y.stand.pred</code> share the same <code class="reqn">x</code> values (i.e., <code>x.stand.obs</code>), and <code>y.obs</code> and 
<code>y.pred</code> share the same <code class="reqn">x</code> values (i.e., <code>x.obs</code>).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Preston, F.W. (1953) The shapes of birds' eggs. <em>The Auk</em> 70, 160<code class="reqn">-</code>182.
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a> 
</p>
<p>Todd, P.H., Smart, I.H.M. (1984) The shape of birds' eggs. <em>Journal of Theoretical Biology</em> 
106, 239<code class="reqn">-</code>243. <a href="https://doi.org/10.1016/0022-5193%2884%2990021-3">doi:10.1016/0022-5193(84)90021-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveEPE">curveEPE</a></code>, <code><a href="#topic+PE">PE</a></code>, <code><a href="#topic+lmPE">lmPE</a></code>, <code><a href="#topic+TSE">TSE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=2000, times=1.2, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y

dev.new()
plot( x1, y1, asp=1, cex.lab=1.5, cex.axis=1.5,  type="l", col=4,  
      xlab=expression(italic("x")), ylab=expression(italic("y")) )


  simpver   &lt;- NULL
  res1      &lt;- lmPE( x1, y1, simpver=simpver, dev.angle=seq(-0.05, 0.05, by=0.0001), 
                     unit="cm", fig.opt=FALSE )
  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- res1$theta
  a.ini     &lt;- res1$scan.length / 2
  b.ini     &lt;- res1$scan.width / 2
  c1.ini    &lt;- res1$par[2] / res1$par[1]
  c2.ini    &lt;- res1$par[3] / res1$par[1]
  c3.ini    &lt;- res1$par[4] / res1$par[1]

  ini.val &lt;- list(x0.ini, y0.ini, theta.ini, a.ini, b.ini, c1.ini, c2.ini, c3.ini)

  res0 &lt;- fitEPE( x=x1, y=y1, ini.val=ini.val, 
                 simpver=simpver, unit="cm", par.list=FALSE, 
                 stand.fig=FALSE, angle=NULL, fig.opt=FALSE, 
                 control=list(reltol=1e-30, maxit=50000), 
                 np=2000 ) 

  n.loop &lt;- 12
  Show   &lt;- FALSE
  for(i in 1:n.loop){
    ini.val &lt;- res0$par
    if(i==n.loop) Show &lt;- TRUE
    print(paste(i, "/", n.loop, sep=""))
    res0 &lt;- fitEPE( x=x1, y=y1, ini.val=ini.val, 
                   simpver=simpver, unit="cm", par.list=FALSE, 
                   stand.fig=Show, angle=pi/4, fig.opt=Show,  
                   control=list(reltol=1e-30, maxit=50000), 
                   np=2000 )    
  }

  # The numerical values of the location and model parameters
  res0$par

  # The root-mean-square error (RMSE) between 
  #   the observed and predicted y values
  sqrt(res0$RSS/res0$sample.size)

  sqrt(sum((res0$y.stand.obs-res0$y.stand.pred)^2)/length(res0$y.stand.obs))

  # To calculate the volume of the egg
  VolumeEPE(P=res0$par[4:8])

  # To calculate the surface area of the egg
  SurfaceAreaEPE(P=res0$par[4:8])


graphics.off()
</code></pre>

<hr>
<h2 id='fitETE'>
Data-Fitting Function for the Explicit Troscianko Equation
</h2><span id='topic+fitETE'></span>

<h3>Description</h3>

<p><code>fitETE</code> is used to estimate the parameters of the explicit Troscianko equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitETE(x, y, ini.val, control = list(), par.list = FALSE, 
      stand.fig = TRUE, angle = NULL, fig.opt = FALSE, np = 2000,
      xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitETE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of an egg's profile.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of an egg's profile.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_ini.val">ini.val</code></td>
<td>
<p>the list of initial values for the model parameters.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_stand.fig">stand.fig</code></td>
<td>
<p>the option of drawing the observed and predicted profiles of an egg at the standard state 
(i.e., the egg's centre is located at (0, 0), and the mid-line is aligned to the <code class="reqn">x</code>-axis).</p>
</td></tr>
<tr><td><code id="fitETE_+3A_angle">angle</code></td>
<td>
<p>the angle between the mid-line and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument of drawing the observed and predicted profiles of an egg 
at arbitrary angle between the major axis and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted explicit Troscianko curve.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_unit">unit</code></td>
<td>
<p>the unit of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Troscianko curve.</p>
</td></tr>
<tr><td><code id="fitETE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, the major axis (i.e., the mid-line of an egg's profile) is the straight line trhough the two ends of 
the egg's length. The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization 
of minimizing the residual sum of squares (RSS) between the observed and predicted <code class="reqn">y</code> values. 
The <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
When <code>angle = NULL</code>, the observed egg's profile will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated by the amount (<code class="reqn">\pi/4</code>) counterclockwise from the <code class="reqn">x</code>-axis.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the observed length of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the observed width of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the observed area of the egg's profile.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the observed perimeter of the egg's profile.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted <code class="reqn">y</code> values 
on the Troscianko curve.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values 
on the Troscianko curve.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates of the points 
on the Troscianko curve at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates of the points 
on the Troscianko curve at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates of the points 
on the Troscianko curve at the standard state.</p>
</td></tr> 
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates of the points on the Troscianko curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates of the points on the Troscianko curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates of the points on the Troscianko curve 
at the transferred polar angles as defined by the user.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>In the outputs, there are no <code>x.stand.pred</code> and <code>x.pred</code>, because <code>y.stand.obs</code> and 
<code>y.stand.pred</code> share the same <code class="reqn">x</code> values (i.e., <code>x.stand.obs</code>), and <code>y.obs</code> and 
<code>y.pred</code> share the same <code class="reqn">x</code> values (i.e., <code>x.obs</code>).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston’s universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Troscianko, J. (2014). A simple tool for calculating egg shape, volume and surface area from digital images. 
<em>Ibis</em>, 156, 874<code class="reqn">-</code>878. <a href="https://doi.org/10.1111/ibi.12177">doi:10.1111/ibi.12177</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveETE">curveETE</a></code>, <code><a href="#topic+TE">TE</a></code>, <code><a href="#topic+lmTE">lmTE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=2000, times=1.2, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y

dev.new()
plot( x1, y1, asp=1, cex.lab=1.5, cex.axis=1.5,  type="l", col=4,  
      xlab=expression(italic("x")), ylab=expression(italic("y")) )


  res1      &lt;- lmTE( x1, y1, unit="cm", fig.opt=FALSE )
  
  if(FALSE){
    P0  &lt;- c(res1$scan.length/2, res1$par)
    xx  &lt;- seq(-res1$scan.length/2, res1$scan.length/2, len=2000)
    yy1 &lt;- ETE(P0, xx)
    yy2 &lt;- -ETE(P0, xx)
    dev.new()
    plot( xx, yy1, cex.lab=1.5, cex.axis=1.5, asp=1, col=2, 
          ylim=c(-res1$scan.length/2, res1$scan.length/2),
          type="l", xlab=expression(x), ylab=expression(y) )
    lines( xx, yy2, col=4 )
  }

  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- res1$theta
  a.ini     &lt;- res1$scan.length / 2
  alpha0.ini &lt;- res1$par[1] 
  alpha1.ini &lt;- res1$par[2]
  alpha2.ini &lt;- res1$par[3]

  ini.val &lt;- list(x0.ini, y0.ini, theta.ini, a.ini, alpha0.ini, alpha1.ini, alpha2.ini)

  res0 &lt;- fitETE( x=x1, y=y1, ini.val=ini.val, 
                 unit="cm", par.list=FALSE, 
                 stand.fig=FALSE, angle=NULL, fig.opt=FALSE, 
                 control=list(reltol=1e-30, maxit=50000), 
                 np=2000 ) 

  n.loop &lt;- 12
  Show   &lt;- FALSE
  for(i in 1:n.loop){
    ini.val &lt;- res0$par
    if(i==n.loop) Show &lt;- TRUE
    print(paste(i, "/", n.loop, sep=""))
    res0 &lt;- fitETE( x=x1, y=y1, ini.val=ini.val, 
                   unit="cm", par.list=FALSE, 
                   stand.fig=Show, angle=pi/4, fig.opt=Show,  
                   control=list(reltol=1e-30, maxit=50000), 
                   np=2000 )    
  }

  # The numerical values of the location and model parameters
  res0$par

  # The root-mean-square error (RMSE) between 
  #   the observed and predicted y values
  sqrt(res0$RSS/res0$sample.size)

  sqrt(sum((res0$y.stand.obs-res0$y.stand.pred)^2)/length(res0$y.stand.obs))

  # To calculate the volume of the egg
  VolumeETE(P=res0$par[4:7])

  # To calculate the surface area of the egg
  SurfaceAreaETE(P=res0$par[4:7])


graphics.off()
</code></pre>

<hr>
<h2 id='fitGE'>
Data-Fitting Function for the Gielis Equation
</h2><span id='topic+fitGE'></span>

<h3>Description</h3>

<p><code>fitGE</code> is used to estimate the parameters of the original (or twin) Gielis equation 
or one of its simplified versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitGE(expr, x, y, ini.val, m = 1, simpver = NULL, 
      nval = nval, control = list(), par.list = FALSE, 
      stand.fig = TRUE, angle = NULL, fig.opt = FALSE, np = 2000,
      xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitGE_+3A_expr">expr</code></td>
<td>
<p>the original (or twin) Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_ini.val">ini.val</code></td>
<td>
<p>the list of initial values for the model parameters.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_m">m</code></td>
<td>
<p>the given <code class="reqn">m</code> value that determines the number of angles of the Gielis curve within <code class="reqn">[0, 2\pi)</code>.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original (or twin) Gielis equation.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_nval">nval</code></td>
<td>
<p>the specified value for <code class="reqn">n_{1}</code> or <code class="reqn">n_{2}</code> or <code class="reqn">n_{3}</code> in the simplified versions.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_stand.fig">stand.fig</code></td>
<td>
<p>the option of drawing the observed and predicted polygons at the standard state 
(i.e., the polar point is located at (0, 0), and the major axis overlaps with the <code class="reqn">x</code>-axis).</p>
</td></tr>
<tr><td><code id="fitGE_+3A_angle">angle</code></td>
<td>
<p>the angle between the major axis and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument of drawing the observed and predicted polygons at arbitrary angle 
between the major axis and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted Gielis curve.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Gielis curve.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Gielis curve.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_unit">unit</code></td>
<td>
<p>the unit of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Gielis curve.</p>
</td></tr>
<tr><td><code id="fitGE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The arguments of <code>m</code>, <code>simpver</code>, and <code>nval</code> should correspond 
to <code>expr</code> (i.e., <code>GE</code> or <code>TGE</code>). Please note the differences in the simplified version number and the 
number of parameters between <code>GE</code> and <code>TGE</code>. 
The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization of minimizing 
the residual sum of squares (RSS) between the observed and predicted radii. 
The <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
When <code>angle = NULL</code>, the observed polygon will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated by the amount (<code class="reqn">\pi/4</code>) counterclockwise from the <code class="reqn">x</code>-axis.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the observed length of the polygon.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the observed width of the polygon.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the observed area of the polygon.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted polar radii.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted polar radii.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>phi.stand.obs</code></td>
<td>
<p>the polar angles at the standard state.</p>
</td></tr>
<tr><td><code>phi.trans</code></td>
<td>
<p>the transferred polar angles rotated as defined by the user.</p>
</td></tr>
<tr><td><code>r.stand.obs</code></td>
<td>
<p>the observed polar radii at the standard state.</p>
</td></tr>
<tr><td><code>r.stand.pred</code></td>
<td>
<p>the predicted polar radii at the standard state.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>x.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr> 
<tr><td><code>r.obs</code></td>
<td>
<p>the observed polar radii at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>r.pred</code></td>
<td>
<p>the predicted polar radii at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>x.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p><code>simpver</code> in <code>GE</code> is different from that in <code>TGE</code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Gielis, J. (2003) A generic geometric transformation that unifies a wide range of natural 
and abstract shapes. <em>American Journal of Botany</em> 90, 333<code class="reqn">-</code>338. <a href="https://doi.org/10.3732/ajb.90.3.333">doi:10.3732/ajb.90.3.333</a>
</p>
<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>
<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>
<p>Shi, P., Xu, Q., Sandhu, H.S., Gielis, J., Ding, Y., Li, H., Dong, X. (2015) Comparison
of dwarf bamboos (<em>Indocalamus</em> sp.) leaf parameters to determine relationship
between spatial density of plants and total leaf area per plant. <em>Ecology and Evolution</em> 5,
4578-4589. <a href="https://doi.org/10.1002/ece3.1728">doi:10.1002/ece3.1728</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaGE">areaGE</a></code>, <code><a href="#topic+curveGE">curveGE</a></code>, <code><a href="#topic+DSGE">DSGE</a></code>, <code><a href="#topic+GE">GE</a></code>, 
<code><a href="#topic+SurfaceAreaSGE">SurfaceAreaSGE</a></code>, <code><a href="#topic+TGE">TGE</a></code>, <code><a href="#topic+VolumeSGE">VolumeSGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 1
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=200, times=1.2, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y
Res2 &lt;- adjdata(x0, y0, ub.np=40, times=1, len.pro=1/2, index.sp=20)
x2   &lt;- Res2$x
y2   &lt;- Res2$y
Res3 &lt;- adjdata(x0, y0, ub.np=100, times=1, len.pro=1/2, index.sp=100)
x3   &lt;- Res3$x
y3   &lt;- Res3$y

dev.new()
plot( x2, y2, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")),
      pch=1, col=4 ) 
points( x3, y3, col=2)


  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- pi
  a.ini     &lt;- sqrt(2) * max( y0.ini-min(y1), x0.ini-min(x1) ) 
  n1.ini &lt;- c(5, 25)
  n2.ini &lt;- c(15, 25)
  if(ind == 2){
    n1.ini &lt;- c(0.5, 1)
    n2.ini &lt;- c(6, 12)
  }
  ini.val &lt;- list(x0.ini, y0.ini, theta.ini, a.ini, n1.ini, n2.ini)

  Res4 &lt;- fitGE( GE, x=x1, y=y1, ini.val=ini.val, 
                 m=1, simpver=1, nval=1, unit="cm",  
                 par.list=FALSE, fig.opt=TRUE, angle=NULL, 
                 control=list(reltol=1e-20, maxit=20000), 
                 np=2000 )
  Res4$par
  sqrt(sum((Res4$y.stand.obs-Res4$y.stand.pred)^2)/Res4$sample.size)

  xx    &lt;- Res4$x.stand.obs
  yy    &lt;- Res4$y.stand.obs

  library(spatstat.geom)
  poly0 &lt;- as.polygonal(owin(poly=list(x=xx, y=yy)))
  area(poly0)

  areaGE(GE, P = Res4$par[4:6], 
         m=1, simpver=1)


  # The following code is used to 
  #   calculate the root-mean-square error (RMSE) in the y-coordinates
  ind1  &lt;- which(yy &gt;= 0)
  ind2  &lt;- which(yy &lt; 0)
  xx1   &lt;- xx[ind1] # The upper part of the egg
  yy1   &lt;- yy[ind1]
  xx2   &lt;- xx[ind2] # The lower part of the egg
  yy2   &lt;- yy[ind2]
  Para  &lt;- c(0, 0, 0, Res4$par[4:length(Res4$par)])
  PartU &lt;- curveGE(GE, P=Para, phi=seq(0, pi, len=100000), m=1, simpver=1, fig.opt=FALSE)
  xv1   &lt;- PartU$x
  yv1   &lt;- PartU$y
  PartL &lt;- curveGE(GE, P=Para, phi=seq(pi, 2*pi, len=100000), m=1, simpver=1, fig.opt=FALSE)
  xv2   &lt;- PartL$x
  yv2   &lt;- PartL$y  
  ind3  &lt;- c()
  for(q in 1:length(xx1)){
    ind.temp &lt;- which.min(abs(xx1[q]-xv1))
    ind3     &lt;- c(ind3, ind.temp)
  }  
  ind4  &lt;- c()
  for(q in 1:length(xx2)){
    ind.temp &lt;- which.min(abs(xx2[q]-xv2))
    ind4     &lt;- c(ind4, ind.temp)
  }
  RSS   &lt;- sum((yy1-yv1[ind3])^2) + sum((yy2-yv2[ind4])^2)
  RMSE  &lt;- sqrt( RSS/length(yy) )


  # To calculate the volume of the Gielis egg when simpver=1 &amp; m=1
  VolumeSGE(P=Res4$par[4:6])

  # To calculate the surface area of the Gielis egg when simpver=1 &amp; m=1
  SurfaceAreaSGE(P=Res4$par[4:6])


graphics.off()
</code></pre>

<hr>
<h2 id='fitLorenz'>
Data-Fitting Function for the Rotated and Right-Shifted Lorenz Curve
</h2><span id='topic+fitLorenz'></span>

<h3>Description</h3>

<p><code>fitLorenz</code> is used to estimate the parameters of the rotated and right-shifted Lorenz curve 
using version 4 or 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, or the Lorenz equations including 
<code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, and <code><a href="#topic+SHE">SHE</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitLorenz(expr, z, ini.val, simpver = 4, 
          control = list(), par.list = FALSE, 
          fig.opt = FALSE, np = 2000, 
          xlab=NULL, ylab=NULL, main = NULL, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, 
          abs.tol = rel.tol, stop.on.error = TRUE, 
          keep.xy = FALSE, aux = NULL, par.limit = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitLorenz_+3A_expr">expr</code></td>
<td>
<p>version 4 or 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, or the Lorenz equations including 
<code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, and <code><a href="#topic+SHE">SHE</a></code>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_z">z</code></td>
<td>
<p>the observations of size distribution (i.e., the household income distribution, the leaf size distribution).</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_ini.val">ini.val</code></td>
<td>
<p>the initial values of the model parameters.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use version 4 or 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the original and rotated Lorenz curves.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_np">np</code></td>
<td>
<p>the number of data points to draw the predicted original and rotated Lorenz curves.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_xlab">xlab</code></td>
<td>
<p>the label of the <code class="reqn">x</code>-axis when showing the original Lorenz curve.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_ylab">ylab</code></td>
<td>
<p>the label of the <code class="reqn">y</code>-axis when showing the original Lorenz curve.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitLorenz_+3A_par.limit">par.limit</code></td>
<td>
<p>an optional argument to limit the numerical ranges of model parameters of the three Lorenz 
equations including <code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, and <code><a href="#topic+SHE">SHE</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, <code>ini.val</code> only includes the initial values of the model parameters as a list. 
The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization of minimizing the residual 
sum of squares (RSS) between the observed and predicted <code class="reqn">y</code> values. The <code><a href="stats.html#topic+optim">optim</a></code> 
function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
Here, versions 4 and 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> and the Lorenz equations including 
<code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, and <code><a href="#topic+SHE">SHE</a></code> can be used to fit the rotated 
and right-shifted Lorenz curve.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 4</code>, the simplified version 4 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)^{a}\left(1-e^{K_{2}\left(x-\sqrt{2}\right)}\right)^{b};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are five elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">a</code>, and <code class="reqn">b</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 5</code>, the simplified version 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)\left(1-e^{K_{2}\left(x-\sqrt{2}\right)}\right);</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are three elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, and <code class="reqn">K_{2}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> For the Lorenz functions, the user can define any formulae that follow the below form: 
<code>Lorenz.fun &lt;- function(P, x){...}</code>, where <code>P</code> is the vector of parameter(s), <code>x</code> is the preditor that 
ranges between 0 and 1 representing the cumulative proportion of the number of individuals in a statistical 
unit, and <code>Lorenz.fun</code> is the name of a Lorenz function defined by the user, which also ranges between 0 and 1 
representing the cumulative 
proportion of the income or size in a statistical unit. This package provides three representative Lorenz 
functions: <code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, and <code><a href="#topic+SHE">SHE</a></code>.  
</p>
<p><code class="reqn">\quad</code> Here, the Gini coefficient (GC) is calculated as follows when <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> 
is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{GC} = 2\int_{0}^{\sqrt{2}}y\,dx,</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> are the independent and dependent variables 
in version 4 or 5 of <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, respectively.
</p>
<p><code class="reqn">\quad</code> However, the Gini coefficient (GC) is calculated as follows when a Lorenz function, e.g., 
<code><a href="#topic+SCSE">SCSE</a></code>, is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{GC} = 2\int_{0}^{1}y\,dx,</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> are the independent and dependent variables 
in the Lorenz function, respectively. 
</p>
<p><code class="reqn">\quad</code> For <code><a href="#topic+SarabiaE">SarabiaE</a></code> and <code><a href="#topic+SHE">SHE</a></code>, there are explicit formulae for GC 
(Sarabia, 1997; Sitthiyot and Holasut, 2023). 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x1</code></td>
<td>
<p>the cumulative proportion of the number of an entity of interest, 
i.e., the number of households of a city, the number of leaves of a plant.</p>
</td></tr>
<tr><td><code>y1</code></td>
<td>
<p>the cumulative proportion of the size of an entity of interest.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the rotated and right-shifted <code>y1</code> versus <code>x1</code>.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the rotated and right-shifted <code>y1</code> versus <code>x1</code>.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>GC</code></td>
<td>
<p>the calculated Gini coefficient.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>When <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> is selected, the estimates of the model parameters 
denote those in <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> rather than 
being obtained by directly fitting the <code>y1</code> versus <code>x1</code> data; 
when a Lorenz function is selected, the estimates of the model parameters 
denote those in the Lorenz function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Huey, R.B., Stevenson, R.D. (1979) Integrating thermal physiology and ecology of ectotherms: 
a discussion of approaches. <em>American Zoologist</em> 19, 357<code class="reqn">-</code>366. <a href="https://doi.org/10.1093/icb/19.1.357">doi:10.1093/icb/19.1.357</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Lorenz, M.O. (1905) Methods of measuring the concentration of wealth. 
<em>Journal of the American Statistical Association</em> 9(70), 209<code class="reqn">-</code>219. <a href="https://doi.org/10.2307/2276207">doi:10.2307/2276207</a>
</p>
<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Sarabia, J.-M. (1997) A hierarchy of Lorenz curves based on the generalized Tukey's lambda distribution. 
<em>Econometric Reviews</em> 16, 305<code class="reqn">-</code>320. <a href="https://doi.org/10.1080/07474939708800389">doi:10.1080/07474939708800389</a> 
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Sitthiyot, T., Holasut, K. (2023) A universal model for the Lorenz curve with novel applications 
for datasets containing zeros and/or exhibiting extreme inequality. <em>Scientific Reports</em> 
13, 4729. <a href="https://doi.org/10.1038/s41598-023-31827-x">doi:10.1038/s41598-023-31827-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+LeafSizeDist">LeafSizeDist</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+SarabiaE">SarabiaE</a></code>, 
<code><a href="#topic+SCSE">SCSE</a></code>, <code><a href="#topic+SHE">SHE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(LeafSizeDist)

  CulmNumber &lt;- c()
  for(i in 1:length(LeafSizeDist$Code)){
    temp &lt;- as.numeric( strsplit(LeafSizeDist$Code[i], "-", fixed=TRUE)[[1]][1] )
    CulmNumber &lt;- c(CulmNumber, temp)
  }
  uni.CN &lt;- sort( unique(CulmNumber) )  
  ind    &lt;- CulmNumber==uni.CN[1]
  A0     &lt;- LeafSizeDist$A[ind]

  ini.val1 &lt;- list(0.5, 0.1, c(0.01, 0.1, 1, 5, 10), 1, 1)
  ini.val2 &lt;- list(0.5, 0.1, c(0.01, 0.1, 1, 5, 10))
  resu1 &lt;- fitLorenz(MPerformanceE, z=A0, ini.val=ini.val1, simpver=4, fig.opt=TRUE)
  resu2 &lt;- fitLorenz(MPerformanceE, z=A0, ini.val=ini.val2, simpver=5, fig.opt=TRUE)
  resu1$par
  resu2$par

  ini.val3 &lt;- list(0.9, c(10, 50, 100, 500), 1, 0)   
  resu3 &lt;- fitLorenz( SarabiaE, z=A0, ini.val=ini.val3, par.limit=TRUE, 
                      fig.opt=TRUE, control=list(reltol=1e-20, maxit=10000) )
  resu3$par
  resu3$GC

  graphics.off()
</code></pre>

<hr>
<h2 id='fitNRGE'>
Parameter Estimation for the Narushin-Romanov-Griffin Equation
</h2><span id='topic+fitNRGE'></span>

<h3>Description</h3>

<p><code>fitNRGE</code> is used to estimate the parameters of the Narushin-Romanov-Griffin equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitNRGE(x, y, dev.angle = NULL, ini.C = c(-1, 0.1, 0.5, 1), 
        strip.num = 2000, control = list(), fig.opt = TRUE, np = 2000,
        xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitNRGE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_dev.angle">dev.angle</code></td>
<td>
<p>the angle of deviation for the axis associated with the maximum distance between two points 
on an egg's profile from the mid-line of the egg's profile.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_ini.c">ini.C</code></td>
<td>
<p>the initial value(s) of parameter <code class="reqn">C</code> in the Narushin-Romanov-Griffin equation.</p>
</td></tr>  
<tr><td><code id="fitNRGE_+3A_strip.num">strip.num</code></td>
<td>
<p>the number of equidistant strips intersecting with 
the egg's boundary that are horizontally placed. See Shi et al. (2018, 2020) for details.</p>
</td></tr>  
<tr><td><code id="fitNRGE_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the observed and predicted egg's boundaries.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Narushin-Romanov-Griffin curve.</p>
</td></tr>
<tr><td><code id="fitNRGE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The NRGE (see <code><a href="#topic+NRGE">NRGE</a></code>) has a complex model structure with four parameters (i.e., <code class="reqn">A</code>, <code class="reqn">B</code>, <code class="reqn">C</code>, and <code class="reqn">D</code>). 
Because three out of four parameters of NRGE have clear biological and geometric meanings (i.e., <code class="reqn">A</code>, <code class="reqn">B</code>, and <code class="reqn">D</code>), 
their values could be estimated by means of numerical calculation. After obtaining the numerical values of the three parameters, 
the Nelder-Mead algorithm (Nelder and Mead, 1965) was used to estimate <code class="reqn">C</code>. 
Because of the failure of the optimization method to estimate the major axis (i.e., the mid-line) and model parameters of NRGE, 
it was difficult to define the egg length axis, although it is essential for calculating <code class="reqn">A</code>, <code class="reqn">B</code>, and <code class="reqn">D</code>. 
For this reason, two methods were used to obtain the major axis: the maximum distance method, and 
the longest axis adjustment method. In the first method, the straight line through two points forming the maximum distance 
on the egg's profile is defined as the major axis (i.e., the mid-line). In the second method, we assume that there is an angle 
of deviation for the longest axis (i.e., the axis associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile. That is to say, 
the mid-line of an egg's profile is not the axis associated with the maximum distance between two points on the egg's profile. 
When <code>angle = NULL</code>, the maximum distance method is used; when <code>angle</code> is a numerical value or a numerical vector, 
the longest axis adjustment method is used. Here, the numerical value of <code>dev.angle</code> is not 
the angle of deviation for the major axis of an egg's profile from the <code class="reqn">x</code>-axis, and instead it is the angle of deviation  
for the longest axis (associated with the maximum distance between two points on the egg's profile) from the mid-line of the egg's profile. 
Once the major axis is established, the distance of the major axis can be calculated as the estimate of <code class="reqn">A</code>. 
Using the maximum distance method, <code class="reqn">A</code> equals the maximum distance. Using the longest axis adjustment method, 
<code class="reqn">A</code> may be slightly smaller than the maximum distance. After rotating the major axis to make it overlap with the <code class="reqn">x</code>-axis, 
a large number of equidistant strips can be used (e.g., 2000) from the egg base to egg tip to intersect the egg's boundary. 
This methodology makes it easy to obtain the maximum egg's breadth (i.e., <code class="reqn">B</code>) and <code class="reqn">D</code>. The residual sum of squares (RSS) 
between the observed and predicted <code class="reqn">y</code> values can be minimized using an optimization method (Nelder and Mead, 1965) to estimate <code class="reqn">C</code>. 
Despite the complex structure of NRGE (see <code><a href="#topic+NRGE">NRGE</a></code>), the optimization method for estimating the remaining parameter <code class="reqn">C</code> 
becomes feasible after the other three parameters have been numerically estimated. Please see Shi et al. (2022) for details.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>the angle between the longest axis of an egg's profile (i.e., 
the axis associated with the maximum distance between two points on the egg's profile) and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>the optimal angle of deviation for the longest axis (associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>RSS.vector</code></td>
<td>
<p>the vector of residual sum of squares corresponding to <code>dev.angle</code>, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates corresponding to the the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the estimates of the four model parameters in the Narushin-Romanov-Griffin equation.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the length of the egg's boundary. The default is the maximum distance between two points on 
the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the maximum width of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the area of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the perimeter of the egg's boundary based on all data points on the egg's boundary.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the numerical calculation.</p>
</td></tr>
<tr><td><code>RMSE</code></td>
<td>
<p>the root-mean-square errors between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p><code>theta</code> is the calculated angle between the longest axis (i.e., the axis associated with the maximum distance 
between two points on an egg's profile) and the <code class="reqn">x</code>-axis, and <code>epsilon</code> is the calculated angle of deviation for the longest 
axis from the mid-line of the egg's profile. This means that the angle between the mid-line and the <code class="reqn">x</code>-axis is equal to 
<code>theta</code> + <code>epsilon</code>. In the outputs, there is no <code>x.pred</code>, because <code>y.obs</code> and 
<code>y.pred</code> share the same <code class="reqn">x</code> values (i.e., <code>x.obs</code>).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Gielis, J., Niklas, K.J. (2022) Comparison of a universal (but complex) model for avian egg 
shape with a simpler model. <em>Annals of the New York Academy of Sciences</em> 1514, 34<code class="reqn">-</code>42. <a href="https://doi.org/10.1111/nyas.14799">doi:10.1111/nyas.14799</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Niinemets, Ü., Hui, C., Niklas, K.J., Yu, X., Hölscher, D. (2020) 
Leaf bilateral symmetry and the scaling of the perimeter vs. the surface area in 15 vine species. 
<em>Forests</em> 11, 246. <a href="https://doi.org/10.3390/f11020246">doi:10.3390/f11020246</a>
</p>
<p>Shi, P., Zheng, X., Ratkowsky, D.A., Li, Y., Wang, P., Cheng, L. (2018) 
A simple method for measuring the bilateral symmetry of leaves. 
<em>Symmetry</em> 10, 118. <a href="https://doi.org/10.3390/sym10040118">doi:10.3390/sym10040118</a>
</p>
<p>Tian, F., Wang, Y., Sandhu, H.S., Gielis, J., Shi, P. (2020) Comparison of seed morphology of two ginkgo cultivars. 
<em>Journal of Forestry Research</em> 31, 751<code class="reqn">-</code>758. <a href="https://doi.org/10.1007/s11676-018-0770-y">doi:10.1007/s11676-018-0770-y</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveNRGE">curveNRGE</a></code>, <code><a href="#topic+NRGE">NRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1  &lt;- adjdata(x0, y0, ub.np=3000, len.pro=1/20)
x1    &lt;- Res1$x
y1    &lt;- Res1$y

dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) ) 


  Res2 &lt;- fitNRGE(x1, y1, dev.angle=NULL, ini.C=c(-1, -0.1, seq(0.1, 1, by=0.05)), 
                  strip.num=2000, fig.opt=TRUE) 
         
  dev.new()
  plot(Res2$x.obs, Res2$y.obs, asp=1, cex.lab=1.5, cex.axis=1.5, 
       xlab=expression(italic("x")), ylab=expression(italic("y")),
       type="l", col=4) 
  lines( Res2$x.obs, Res2$y.pred, col=2)

  Res3 &lt;- fitNRGE(x1, y1, dev.angle=seq(-0.05, 0.05, by=0.01), 
                  ini.C=c(-1, -0.1, seq(0.1, 1, by=0.05)), 
                  strip.num=2000, fig.opt=TRUE)   

  zeta &lt;- Res3$theta + Res3$epsilon
  x2   &lt;- x1*cos(zeta) + y1*sin(zeta)
  y2   &lt;- y1*cos(zeta) - x1*sin(zeta)
  plot( x2-min(x2), y2-min(y2), asp=1, col="grey70", cex=1,
        xlab=expression(italic("x")), ylab=expression(italic("y")) )  
  lines(Res3$x.obs-min(Res3$x.obs), Res3$y.obs-min(Res3$y.obs), col=4)
  lines(Res3$x.obs-min(Res3$x.obs), Res3$y.pred-min(Res3$y.obs), col=2)

  RMSE &lt;- sqrt( Res3$RSS / Res3$sample.size )
  RMSE

  # To calculate the volume of the egg 
  VolumeNRGE(P=Res3$par)

  # To calculate the surface area of the egg
  SurfaceAreaNRGE(P=Res3$par)


graphics.off()
</code></pre>

<hr>
<h2 id='fitovate'>
Data-Fitting Function for the Ovate Leaf-Shape Equation
</h2><span id='topic+fitovate'></span>

<h3>Description</h3>

<p><code>fitovate</code> is used to estimate the parameters of a simplified performance equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitovate(expr, x, y, ini.val, 
         par.list = FALSE, stand.fig = TRUE, control = list(), 
         angle = NULL, fig.opt = FALSE, index.xmax = 3, np = 2000, 
         xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitovate_+3A_expr">expr</code></td>
<td>
<p>the simplified version 1 of the performance equations.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_ini.val">ini.val</code></td>
<td>
<p>the initial values of the simplified version 1 of a performance equation.</p>
</td></tr>  
<tr><td><code id="fitovate_+3A_par.list">par.list</code></td>
<td>
<p>an optional argument to show the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_stand.fig">stand.fig</code></td>
<td>
<p>an optional argument to draw the observed and predicted polygons' boundaries at the standard state 
(i.e., the origin is located at (0, 0), and the major axis overlaps with the <code class="reqn">x</code>-axis).</p>
</td></tr>
<tr><td><code id="fitovate_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_angle">angle</code></td>
<td>
<p>the angle between the major axis of the polygon and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the observed and predicted polygons at an arbitrary angle 
between the major axis and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_index.xmax">index.xmax</code></td>
<td>
<p>the specified index in parameters representing <code class="reqn">x_{\mathrm{max}}</code>.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the ovate leaf-shape curve.</p>
</td></tr>
<tr><td><code id="fitovate_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ini.val</code> is a list for two types of parameters: three location parameters, 
and model parameters. This means that <code>expr</code> is limited to 
being the simplified version 1 (where <code class="reqn">x_{\mathrm{min}} = 0</code>)  
in <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, and <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>. 
The initial values for the first three parameters in <code>ini.val</code> are location parameters, 
among which the first two are the planar coordinates of the transferred origin, 
and the third is the angle between the major axis of the polygon and the <code class="reqn">x</code>-axis. 
The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization of minimizing 
the residual sum of squares (RSS) between the observed and predicted <code class="reqn">y</code>-axis. 
The <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
When <code>angle = NULL</code>, the observed polygon will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated by the amount (<code class="reqn">\pi/4</code>) counterclockwise from the <code class="reqn">x</code>-axis.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points on the polygon's boundary in the data fitting.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the observed length of the polygon's boundary.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the observed width of the polygon's boundary.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the observed perimeter of the polygon's boundary.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the observed area of the polygon's boundary.</p>
</td></tr>
<tr><td><code>pred.length</code></td>
<td>
<p>the predicted length of the polygon's boundary.</p>
</td></tr>
<tr><td><code>pred.width</code></td>
<td>
<p>the predicted width of the polygon's boundary.</p>
</td></tr>
<tr><td><code>pred.perimeter</code></td>
<td>
<p>the predicted perimeter of the polygon's boundary.</p>
</td></tr>
<tr><td><code>pred.area</code></td>
<td>
<p>the predicted area of the polygon's boundary.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>x.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr> 
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the transferred angles defined by the user.</p>
</td></tr>
<tr><td><code>x.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the transferred angles defined by the user.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the transferred angles defined by the user.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the transferred angles defined by the user.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>There are two types of parameters (i.e., three location parameters and model parameters) 
for the value of <code>par</code>. The transferred 
angle denotes the angle between the major axis and the <code class="reqn">x</code>-axis. For the argument <code>index.xmax</code>, 
the default is 3, which corresponds to the order of the model parameter of <code class="reqn">x_{\mathrm{max}}</code> in 
<code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, and <code><a href="#topic+MLRFE">MLRFE</a></code>. However, in <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, 
<code>index.xmax</code> should be 4 rather than 3.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Huey, R.B., Stevenson, R.D. (1979) Integrating thermal physiology and ecology of ectotherms: 
a discussion of approaches. <em>American Zoologist</em> 19, 357<code class="reqn">-</code>366. <a href="https://doi.org/10.1093/icb/19.1.357">doi:10.1093/icb/19.1.357</a>
</p>
<p>Li, Y., Zheng, Y., Ratkowsky, D.A., Wei, H., Shi, P. (2022) Application of an ovate leaf shape model 
to evaluate leaf bilateral asymmetry and calculate lamina centroid location. 
<em>Frontiers in Plant Science</em> 12, 822907. <a href="https://doi.org/10.3389/fpls.2021.822907">doi:10.3389/fpls.2021.822907</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Ge, F., Sun, Y., Chen, C. (2011) A simple model for describing 
the effect of temperature on insect developmental rate. <em>Journal of Asia-Pacific Entomology</em> 
14, 15<code class="reqn">-</code>20. <a href="https://doi.org/10.1016/j.aspen.2010.11.008">doi:10.1016/j.aspen.2010.11.008</a> 
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Yu, K., Niklas, K.J., Schrader, J., Song, Y., Zhu, R., Li, Y., Wei, H., Ratkowsky, D.A. (2021)  
A general model for describing the ovate leaf shape. <em>Symmetry</em> 13, 1524. <a href="https://doi.org/10.3390/sym13081524">doi:10.3390/sym13081524</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, 
<code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Neocinnamomum)

uni.C &lt;- sort( unique(Neocinnamomum$Code) )
ind   &lt;- 2
Data  &lt;- Neocinnamomum[Neocinnamomum$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y

dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) ) 


  x0.ini    &lt;- min( x1 )
  y0.ini    &lt;- min( y1 )
  theta.ini &lt;- pi/4
  len.max   &lt;- max( max(y1)-min(y1), max(x1)-min(x1) ) *2/sqrt(2)
  a.ini     &lt;- c(0.1, 0.01, 0.001, 0.0001)
  m.ini     &lt;- c(0.1, 0.5, 1, 2)
  x2.ini    &lt;- len.max
  delta.ini &lt;- c(0.5, 1)
  ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, a.ini, m.ini, x2.ini, delta.ini)

  Res1 &lt;- fitovate(MBriereE, x=x1, y=y1, ini.val=ini.val,            
            par.list=FALSE, fig.opt=TRUE, angle=pi/6, 
            control=list(reltol=1e-20, maxit=20000), 
            np=2000, unit=NULL)
  Res1$RSS

  x0.ini    &lt;- min( x1 )
  y0.ini    &lt;- min( y1 )
  theta.ini &lt;- pi/4
  len.max   &lt;- max( max(y1)-min(y1), max(x1)-min(x1) ) *2/sqrt(2)
  yc.ini    &lt;- len.max/3 
  xc.ini    &lt;- 1/4*len.max
  x2.ini    &lt;- len.max
  delta.ini &lt;- c(0.5, seq(1, 5, by=5))
  ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, yc.ini, xc.ini, x2.ini, delta.ini)

  Res2 &lt;- fitovate( MbetaE, x=x1, y=y1, ini.val=ini.val,            
                    par.list=TRUE, fig.opt=TRUE, angle=pi/3, 
                    control=list(reltol=1e-20, maxit=20000), 
                    np=2000, unit=NULL )
  Res2$RSS

  Res3 &lt;- fitovate( MLRFE, x=x1, y=y1, ini.val=ini.val, 
                    unit=NULL, par.list=FALSE, fig.opt=TRUE, 
                    angle=NULL, control=list(reltol=1e-20, 
                    maxit=20000), np=2000)
  Res3$RSS


  x0.ini    &lt;- min( x1 )
  y0.ini    &lt;- min( y1 )
  theta.ini &lt;- pi/4
  len.max   &lt;- max( max(y1)-min(y1), max(x1)-min(x1) ) *2/sqrt(2)
  c.ini     &lt;- 1/5*len.max
  K1.ini    &lt;- c(0.1, 1, 5, 10)
  K2.ini    &lt;- 1
  x2.ini    &lt;- len.max
  a.ini     &lt;- 1
  b.ini     &lt;- 1
  ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, c.ini, K1.ini, K2.ini, x2.ini, a.ini, b.ini)

  Res4 &lt;- fitovate( MPerformanceE, x=x1, y=y1, ini.val=ini.val,            
                    par.list=TRUE, fig.opt=TRUE, index.xmax=4, angle=pi/3, 
                    control=list(reltol=1e-20, maxit=20000), 
                    np=2000, unit=NULL )
  Res4$RSS


graphics.off()
</code></pre>

<hr>
<h2 id='fitsigmoid'>
Data-Fitting Function for the Sigmoid Growth Equation
</h2><span id='topic+fitsigmoid'></span>

<h3>Description</h3>

<p><code>fitsigmoid</code> is used to estimate the parameters of a sigmoid growth equation based on the integral of 
a performance equation or one of its simplified versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitsigmoid(expr, x, y, ini.val, simpver = 1, 
           control = list(), par.list = FALSE, fig.opt = FALSE,
           xlim = NULL, ylim = NULL, xlab = NULL, ylab = NULL,         
           main = NULL, subdivisions = 100L,
           rel.tol = .Machine$double.eps^0.25, 
           abs.tol = rel.tol, stop.on.error = TRUE, 
           keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitsigmoid_+3A_expr">expr</code></td>
<td>
<p>a performance equation or one of its simplified versions that is used to build a sigmoid growth equation.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_x">x</code></td>
<td>
<p>the observed investigation times.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_y">y</code></td>
<td>
<p>the observed <code class="reqn">y</code> values (i.e., biomass, height, body length, etc.).</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_ini.val">ini.val</code></td>
<td>
<p>the initial values of the model parameters.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the performance equation.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the observations and the predicted sigmoid curve.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot a sigmoid growth curve.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot a sigmoid growth curve.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_xlab">xlab</code></td>
<td>
<p>the label of the <code class="reqn">x</code>-axis when showing a sigmoid growth curve.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_ylab">ylab</code></td>
<td>
<p>the label of the <code class="reqn">y</code>-axis when showing a sigmoid growth curve.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitsigmoid_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Here, <code>ini.val</code> only includes the initial values of the model parameters as a list. 
The Nelder-Mead algorithm (Nelder and Mead, 1965) is used to carry out the optimization of minimizing the residual 
sum of squares (RSS) between the observed and predicted <code class="reqn">y</code> values. The <code><a href="stats.html#topic+optim">optim</a></code> 
function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
The performance equations denote <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code> and their simplified versions. 
The arguments of <code>P</code> and <code>simpver</code> should correspond 
to <code>expr</code> (i.e., <code><a href="#topic+MbetaE">MbetaE</a></code> or <code><a href="#topic+MBriereE">MBriereE</a></code> 
or <code><a href="#topic+MLRFE">MLRFE</a></code> or <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>). 
The sigmoid equation is the integral of a performance equation or one of its simplified versions.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimates of the model parameters.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>the observed <code class="reqn">x</code> values.</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the observed <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> values.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>Here, the user can define other performance equations, but new equations or 
their simplified versions should include the lower and upper thresholds on 
the <code class="reqn">x</code>-axis corresponding to <code class="reqn">y = 0</code>, whose indices should 
be the same as those in <code><a href="#topic+MbetaE">MbetaE</a></code> or <code><a href="#topic+MBriereE">MBriereE</a></code> 
or <code><a href="#topic+MLRFE">MLRFE</a></code> or <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Nelder, J.A., Mead, R. (1965) A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, 
<code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The shrimp growth data(See the supplementary table in West et al., 2001)
# West, G.B., Brown, J.H., Enquist, B.J. (2001) A general model for ontogenetic growth. 
#     Nature 413, 628-631.
t0 &lt;- c(3, 60, 90, 120, 150, 180, 384)
m0 &lt;- c(0.001, 0.005, 0.018, 0.037, 0.06, 0.067, 0.07)

dev.new()
plot( t0, m0, cex.lab=1.5, cex.axis=1.5, col=4,
      xlab=expression(italic(x)), ylab=expression(italic(y)) )

xopt0   &lt;- seq(100, 150, by=5)
ini.val &lt;- list(0.035, xopt0, 200, 1)
resu1   &lt;- fitsigmoid(MLRFE, x=t0, y=m0, ini.val=ini.val, simpver=1, fig.opt=TRUE, par.list=TRUE)


  xopt0   &lt;- seq(100, 150, by=5)
  ini.val &lt;- list(0.035, xopt0, 200, 1)
  resu1   &lt;- fitsigmoid(MbetaE, x=t0, y=m0, ini.val=ini.val, simpver=1, fig.opt=TRUE)

  m.ini   &lt;- c(0.5, 1, 2, 3, 4, 5, 10, 20)
  ini.val &lt;- list(1e-8, m.ini, 200, 1)
  resu2   &lt;- fitsigmoid(MBriereE, x=t0, y=m0, ini.val=ini.val, simpver=1, 
             fig.opt=TRUE, control=list(reltol=1e-20, maxit=20000, trace=FALSE), 
             subdivisions=100L, rel.tol=.Machine$double.eps^0.25, 
             abs.tol=.Machine$double.eps^0.25, stop.on.error=TRUE, 
             keep.xy=FALSE, aux=NULL)

  delta0  &lt;- c(0.5, 1, 2, 5, 10, 20)
  ini.val &lt;- list(0.035, 150, -100, 200, delta0)
  resu3   &lt;- fitsigmoid(MLRFE, x=t0, y=m0, ini.val=ini.val, simpver=NULL, 
               fig.opt=TRUE, control=list(reltol=1e-20, maxit=20000), 
               subdivisions = 100L, rel.tol=.Machine$double.eps^0.25, 
               abs.tol=.Machine$double.eps^0.25, stop.on.error=TRUE, 
               keep.xy=FALSE, aux=NULL)

  a.ini   &lt;- c(0.1, 1, 10, 100, 200)
  b.ini   &lt;- 200
  ini.val &lt;- list(0.001, 0.02, 0.15, 0, 200, a.ini, b.ini)
  resu4   &lt;- fitsigmoid(MPerformanceE, x=t0, y=m0, ini.val=ini.val, simpver=NULL, 
             fig.opt=TRUE, control=list(reltol=1e-20, maxit=20000, trace=FALSE), 
             subdivisions=100L, rel.tol=.Machine$double.eps^0.25, 
             abs.tol=.Machine$double.eps^0.25, stop.on.error=TRUE, 
             keep.xy=FALSE, aux=NULL)
  resu5   &lt;- fitsigmoid(MPerformanceE, x=t0, y=m0, ini.val=resu4$par, simpver=NULL, 
               fig.opt=TRUE, control=list(reltol=1e-30, maxit=200000, trace=FALSE))

  ini.val &lt;- list(0.001, 0.01, c(0.1, 1, 10), 0, 200)
  resu6   &lt;- fitsigmoid(MPerformanceE, x=t0, y=m0, ini.val=ini.val, simpver=2, 
             fig.opt=TRUE, control=list(reltol=1e-20, maxit=20000, trace=FALSE), 
             subdivisions=100L, rel.tol=.Machine$double.eps^0.25, 
             abs.tol=.Machine$double.eps^0.25, stop.on.error=TRUE, 
             keep.xy=FALSE, aux=NULL)


graphics.off()
</code></pre>

<hr>
<h2 id='fitSuper'>
Data-Fitting Function for the Superellipse Equation
</h2><span id='topic+fitSuper'></span>

<h3>Description</h3>

<p><code>fitSuper</code> is used to estimate the parameters of the superellipse equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitSuper(x, y, ini.val, control = list(), par.list = FALSE, 
         stand.fig = TRUE, angle = NULL, fig.opt = FALSE, np = 2000,
         xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitSuper_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of a polygon's boundary.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_ini.val">ini.val</code></td>
<td>
<p>the list of initial values for the model parameters.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_control">control</code></td>
<td>
<p>the list of control parameters for using the <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_par.list">par.list</code></td>
<td>
<p>the option of showing the list of parameters on the screen.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_stand.fig">stand.fig</code></td>
<td>
<p>the option of drawing the observed and predicted polygons at the standard state 
(i.e., the polar point is located at (0, 0), and the major axis overlaps with the <code class="reqn">x</code>-axis).</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_angle">angle</code></td>
<td>
<p>the angle between the major axis and the <code class="reqn">x</code>-axis, which can be defined by the user.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument of drawing the observed and predicted polygons at arbitrary angle 
between the major axis and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_np">np</code></td>
<td>
<p>the number of data points on the predicted superellipse curve.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the superellipse curve.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the superellipse curve.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_unit">unit</code></td>
<td>
<p>the unit of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the superellipse curve.</p>
</td></tr>
<tr><td><code id="fitSuper_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The superellipse equation has its mathematical expression: 
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\varphi\right)\right|^{n}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\varphi\right)\right|^{n}\right)^{-\frac{1}{n}},</code>
</p>

<p>where <code class="reqn">r</code> represents the polar radius at the polar angle <code class="reqn">\varphi</code>. 
<code class="reqn">a</code> represents the semi-major axis of the superellipse; 
<code class="reqn">k</code> is the ratio of the semi-minor axis to the semi-major axis of the superellipse; and <code class="reqn">n</code> determines 
the curvature of the superellipse curve. This function is basically equal to the <code><a href="#topic+fitGE">fitGE</a></code> 
function with the arguments <code>m = 4</code> and <code>simpver = 9</code>. 
However, this function can make the estimated value of the parameter <code class="reqn">k</code> be smaller than or equal to 1. 
Apart from the above three model parameters, there are three additional location parameters, i.e., the 
planar coordinates of the polar point (<code class="reqn">x_{0}</code> and <code class="reqn">y_{0}</code>), and the angle between the major axis 
of the superellipse and the <code class="reqn">x</code>-axis (<code class="reqn">\theta</code>). The input order of <code>ini.val</code> is <code class="reqn">x_{0}</code>, <code class="reqn">y_{0}</code>, 
<code class="reqn">\theta</code>, <code class="reqn">a</code>, <code class="reqn">k</code>, and <code class="reqn">n</code>. The fitted parameters will be shown after running this function 
in the same order. The Nelder-Mead algorithm (Nelder and Mead, 1965) 
is used to carry out the optimization of minimizing the residual sum of squares (RSS) between the observed and predicted radii. 
The <code><a href="stats.html#topic+optim">optim</a></code> function in package <span class="pkg">stats</span> was used to carry out the Nelder-Mead algorithm. 
When <code>angle = NULL</code>, the observed polygon will be shown at its initial angle in the scanned image; 
when <code>angle</code> is a numerical value (e.g., <code class="reqn">\pi/4</code>) defined by the user, it indicates that the major axis 
is rotated by the amount (<code class="reqn">\pi/4</code>) counterclockwise from the <code class="reqn">x</code>-axis.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>par</code></td>
<td>
<p>the estimated values of the parameters in the superellipse equation.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the observed length of the polygon.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the observed width of the polygon.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the observed area of the polygon.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination between the observed and predicted polar radii.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted polar radii.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the data fitting.</p>
</td></tr>
<tr><td><code>phi.stand.obs</code></td>
<td>
<p>the polar angles at the standard state.</p>
</td></tr>
<tr><td><code>phi.trans</code></td>
<td>
<p>the transferred polar angles rotated as defined by the user.</p>
</td></tr>
<tr><td><code>r.stand.obs</code></td>
<td>
<p>the observed polar radii at the standard state.</p>
</td></tr>
<tr><td><code>r.stand.pred</code></td>
<td>
<p>the predicted polar radii at the standard state.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>x.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the standard state.</p>
</td></tr> 
<tr><td><code>r.obs</code></td>
<td>
<p>the observed polar radii at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>r.pred</code></td>
<td>
<p>the predicted polar radii at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>x.pred</code></td>
<td>
<p>the predicted <code class="reqn">x</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates at the transferred polar angles as defined by the user.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p>The output values of running this function can be used as those of running the <code><a href="#topic+fitGE">fitGE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Huang, J., Hui, C., Grissino-Mayer, H.D., Tardif, J., Zhai, L., Wang, F., Li, B. (2015) 
Capturing spiral radial growth of conifers using the superellipse to model tree-ring geometric shape. 
<em>Frontiers in Plant Science</em> 6, 856. <a href="https://doi.org/10.3389/fpls.2015.00856">doi:10.3389/fpls.2015.00856</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaGE">areaGE</a></code>, <code><a href="#topic+curveGE">curveGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(whitespruce)

uni.C &lt;- sort( unique(whitespruce$Code) )  
Data  &lt;- whitespruce[whitespruce$Code==uni.C[12], ]
x0    &lt;- Data$x
y0    &lt;- Data$y
Res1  &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/20)
x1    &lt;- Res1$x
y1    &lt;- Res1$y

plot( x1, y1, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      col="grey73", lwd=2,
      xlab=expression(italic("x")), ylab=expression(italic("y")) )


  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- c(0, pi/4, pi/2)
  a.ini     &lt;- mean(c(max(x1)-min(x1), max(y1)-min(y1)))/2
  k.ini     &lt;- 1
  n.ini     &lt;- c(1.5, 2, 2.5)
  ini.val   &lt;- list( x0.ini, y0.ini, theta.ini, a.ini, k.ini, n.ini )
  Res2      &lt;- fitSuper(x=x1, y=y1, ini.val=ini.val, unit="cm", par.list=FALSE,
                        stand.fig=FALSE, angle=NULL, fig.opt=TRUE,  
                        control=list(reltol=1e-20, maxit=20000), np=2000)
  Res2$par
  Res2$r.sq


graphics.off()
</code></pre>

<hr>
<h2 id='fracdim'>
Calculation of Fractal Dimension of Lef Veins Based on the Box-Counting Method
</h2><span id='topic+fracdim'></span>

<h3>Description</h3>

<p><code>fracdim</code> is used to calculate the fractal dimension of leaf veins 
based on the box-counting method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fracdim(x, y, frac.fig = TRUE, denomi.range = seq(8, 30, by=1), 
        ratiox = 0.02, ratioy = 0.08, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fracdim_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of leaf-vein pixels.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of leaf-vein pixels.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_frac.fig">frac.fig</code></td>
<td>
<p>the option of drawing the results of the linear fitting.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_denomi.range">denomi.range</code></td>
<td>
<p>the number of equidistant segments of the maximum range 
between the range of the <code class="reqn">x</code> coordinates and that of the <code class="reqn">y</code> coordinates.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_ratiox">ratiox</code></td>
<td>
<p>the the <code class="reqn">x</code> coordinate of the location parameter for positioning the legend.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_ratioy">ratioy</code></td>
<td>
<p>the the <code class="reqn">y</code> coordinate of the location parameter for positioning the legend.</p>
</td></tr>
<tr><td><code id="fracdim_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The box-counting approach uses a group of boxes (squares for simplicity) with different
sizes (<code class="reqn">\delta</code>) to divide the leaf vein image into different parts. Let <code class="reqn">N</code> represent the number
of boxes that include at least one pixel of leaf vein. 
The maximum of the range of the <code class="reqn">x</code> coordinates and the range of the <code class="reqn">y</code> coordinates 
for leaf-vein pixels is defined as <code class="reqn">z</code>. Let <code class="reqn">\delta</code> represent the vector of 
<code class="reqn">z</code>/<code>denomi.range</code>. Then, we used the following equation to calculate the fractal 
dimension of leaf veins:
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{ln } N = a + b\,\mathrm{ ln} \left({\delta}^{-1}\right),</code>
</p>

<p>where <code class="reqn">b</code> is the theoretical value of the fractal dimension. We can use its estimate as the 
numerical value of the fractal dimension for a leaf venation network.      
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>a</code></td>
<td>
<p>the estimate of the intercept.</p>
</td></tr>
<tr><td><code>sd.a</code></td>
<td>
<p>the standard deviation of the estimated intercept.</p>
</td></tr>
<tr><td><code>lci.a</code></td>
<td>
<p>the lower bound of the 95% confidence interval of the estimated intercept.</p>
</td></tr>
<tr><td><code>uci.a</code></td>
<td>
<p>the upper bound of the 95% confidence interval of the estimated intercept.</p>
</td></tr>
<tr><td><code>b</code></td>
<td>
<p>the estimate of the slope.</p>
</td></tr>
<tr><td><code>sd.b</code></td>
<td>
<p>the standard deviation of the estimated slope.</p>
</td></tr>
<tr><td><code>lci.a</code></td>
<td>
<p>the lower bound of the 95% confidence interval of the estimated slope.</p>
</td></tr>
<tr><td><code>uci.a</code></td>
<td>
<p>the upper bound of the 95% confidence interval of the estimated slope.</p>
</td></tr>
<tr><td><code>r.sq</code></td>
<td>
<p>the coefficient of determination.</p>
</td></tr>
<tr><td><code>delta</code></td>
<td>
<p>the vector of box sizes.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>the number of boxes that include at least one pixel of leaf vein.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Here, <code>x</code> and <code>y</code> cannot be adjusted by the <code><a href="#topic+adjdata">adjdata</a></code> function 
because the leaf veins are not the leaf's boundary data.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Yu, K., Niinemets, Ü., Gielis, J. (2021) Can leaf shape be represented by the ratio of 
leaf width to length? Evidence from nine species of <em>Magnolia</em> and <em>Michelia</em> (Magnoliaceae). 
<em>Forests</em> 12, 41. <a href="https://doi.org/10.3390/f12010041">doi:10.3390/f12010041</a>
</p>
<p>Vico, P.G., Kyriacos, S., Heymans, O., Louryan, S., Cartilier, L. (1998) 
Dynamic study of the extraembryonic vascular network of the 
chick embryo by fractal analysis. <em>Journal of Theoretical Biology</em> 195, 525<code class="reqn">-</code>532. 
<a href="https://doi.org/10.1006/jtbi.1998.0810">doi:10.1006/jtbi.1998.0810</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+veins">veins</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(veins)

dev.new()
plot(veins$x, veins$y, cex=0.01, asp=1, cex.lab=1.5, cex.axis=1.5, 
     xlab=expression(italic("x")), ylab=expression(italic("y")))

fracdim(veins$x, veins$y)

graphics.off()
</code></pre>

<hr>
<h2 id='GE'>
Calculation of the Polar Radius of the Gielis Curve
</h2><span id='topic+GE'></span>

<h3>Description</h3>

<p><code>GE</code> is used to calculate polar radii of the original Gielis equation  
or one of its simplified versions at given polar angles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>GE(P, phi, m = 1, simpver = NULL, nval = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="GE_+3A_p">P</code></td>
<td>
<p>the parameters of the original Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="GE_+3A_phi">phi</code></td>
<td>
<p>the polar angle(s).</p>
</td></tr>
<tr><td><code id="GE_+3A_m">m</code></td>
<td>
<p>the given <code class="reqn">m</code> value that determines the number of angles of 
the Gielis curve within <code class="reqn">[0, 2\pi)</code>.</p>
</td></tr>
<tr><td><code id="GE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original Gielis equation.</p>
</td></tr>
<tr><td><code id="GE_+3A_nval">nval</code></td>
<td>
<p>the specified value for <code class="reqn">n_{1}</code> or <code class="reqn">n_{2}</code> or <code class="reqn">n_{3}</code> in the simplified versions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the original Gielis equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{3}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">r</code> represents the polar radius at the polar angle <code class="reqn">\varphi</code>; 
<code class="reqn">m</code> determines the number of angles within <code class="reqn">[0, 2\pi)</code>; and <code class="reqn">a</code>, <code class="reqn">k</code>, <code class="reqn">n_{1}</code>, 
<code class="reqn">n_{2}</code>, and <code class="reqn">n_{3}</code> need to be provided in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code> need to be provided in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}}, </code>
</p>

<p>where <code class="reqn">a</code> and <code class="reqn">n_{1}</code> need to be provided in <code>P</code>, and <code class="reqn">n_{2}</code> should be specified in <code>nval</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}\right)^{-\frac{1}{n_{1}}}, </code>
</p>

<p>where <code class="reqn">a</code> needs to be provided in <code>P</code>, and <code class="reqn">n_{1}</code> 
should be specified in <code>nval</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 4</code>, the simplified version 4 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}\right)^{-\frac{1}{n_{1}}}, </code>
</p>

<p>where <code class="reqn">a</code> and <code class="reqn">n_{1}</code> need to be provided in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 5</code>, the simplified version 5 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{3}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, <code class="reqn">n_{2}</code>, and <code class="reqn">n_{3}</code> need to be provided in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 6</code>, the simplified version 6 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code>, <code class="reqn">k</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code> need to be provided in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 7</code>, the simplified version 7 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code>, <code class="reqn">k</code>, and <code class="reqn">n_{1}</code> need to be provided in <code>P</code>, and <code class="reqn">n_{2}</code> 
should be specified in <code>nval</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 8</code>, the simplified version 8 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code> and <code class="reqn">k</code> are parameters that need to be provided in <code>P</code>, and <code class="reqn">n_{1}</code> 
should be specified in <code>nval</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 9</code>, the simplified version 9 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{1}}\right)^{-\frac{1}{n_{1}}},</code>
</p>

<p>where <code class="reqn">a</code>, <code class="reqn">k</code>, and <code class="reqn">n_{1}</code> need to be provided in <code>P</code>.
</p>


<h3>Value</h3>

<p>The polar radii predicted by the original Gielis equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p><code>simpver</code> here is different from that in the <code><a href="#topic+TGE">TGE</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Gielis, J. (2003) A generic geometric transformation that unifies a wide range of natural 
and abstract shapes. <em>American Journal of Botany</em> 90, 333<code class="reqn">-</code>338. <a href="https://doi.org/10.3732/ajb.90.3.333">doi:10.3732/ajb.90.3.333</a>
</p>
<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric 
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>
<p>Shi, P., Xu, Q., Sandhu, H.S., Gielis, J., Ding, Y., Li, H., Dong, X. (2015) Comparison
of dwarf bamboos (<em>Indocalamus</em> sp.) leaf parameters to determine relationship
between spatial density of plants and total leaf area per plant. <em>Ecology and Evolution</em> 5,
4578<code class="reqn">-</code>4589. <a href="https://doi.org/10.1002/ece3.1728">doi:10.1002/ece3.1728</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaGE">areaGE</a></code>, <code><a href="#topic+curveGE">curveGE</a></code>, <code><a href="#topic+DSGE">DSGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, 
<code><a href="#topic+SurfaceAreaSGE">SurfaceAreaSGE</a></code>, <code><a href="#topic+TGE">TGE</a></code>, <code><a href="#topic+VolumeSGE">VolumeSGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>GE.par  &lt;- c(2, 1, 4, 6, 3)
varphi.vec &lt;- seq(0, 2*pi, len=2000)
r.theor &lt;- GE(P=GE.par, phi=varphi.vec, m=5)

dev.new()
plot( varphi.vec, r.theor, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(varphi)), ylab=expression(italic("r")),
      type="l", col=4 ) 

graphics.off()
</code></pre>

<hr>
<h2 id='ginkgoseed'>
Boundary Data of the Side Projections of <em>Ginkgo biloba</em> Seeds
</h2><span id='topic+ginkgoseed'></span>

<h3>Description</h3>

<p>The data consist of the boundary data of four side projections of <em>G. biloba</em> (Cultivar 'Fozhi') seeds 
sampled at Nanjing Forestry University campus on September 23, 2021.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ginkgoseed)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are three columns of variables: <code>Code</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual fruit; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the side projections of seeds in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the side projections of seeds in the Cartesian coordinate system (cm).
</p>


<h3>References</h3>

<p>Tian, F., Wang, Y., Sandhu, H.S., Gielis, J., Shi, P. (2020) Comparison of seed morphology of two ginkgo cultivars. 
<em>Journal of Forestry Research</em> 31, 751<code class="reqn">-</code>758. <a href="https://doi.org/10.1007/s11676-018-0770-y">doi:10.1007/s11676-018-0770-y</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ginkgoseed)

uni.C &lt;- sort( unique(ginkgoseed$Code) )
ind   &lt;- 1
Data  &lt;- ginkgoseed[ginkgoseed$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=2000, len.pro=1/20)
dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )


  x1        &lt;- Res1$x
  y1        &lt;- Res1$y
  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- pi/4
  a.ini     &lt;- 1
  n1.ini    &lt;- seq(0.6, 1, by=0.1)
  n2.ini    &lt;- 1
  n3.ini    &lt;- 1
  ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, 
                    a.ini, n1.ini, n2.ini, n3.ini)

  Res2 &lt;- fitGE( GE, x=x1, y=y1, ini.val=ini.val, 
                 m=2, simpver=5, nval=1, unit="cm",  
                 par.list=FALSE, fig.opt=TRUE, angle=NULL, 
                 control=list(reltol=1e-20, maxit=20000), 
                 np=2000 )


graphics.off()
</code></pre>

<hr>
<h2 id='kp'>
Boundary Data of the Vertical Projections of <em>Koelreuteria paniculata</em> Fruit
</h2><span id='topic+kp'></span>

<h3>Description</h3>

<p>The data consist of the boundary data of four vertical projections of <em>K. paniculata</em> fruit  
sampled at Nanjing Forestry University campus in early October 2021.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(kp)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are three columns of variables: <code>Code</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual fruit; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the vertical projections of fruit in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the vertical projections of fruit in the Cartesian coordinate system (cm).
</p>


<h3>References</h3>

<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kp)

uni.C &lt;- sort( unique(kp$Code) )
ind   &lt;- 1
Data  &lt;- kp[kp$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1 &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/20)
dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )


  x1        &lt;- Res1$x
  y1        &lt;- Res1$y
  x0.ini    &lt;- mean( x1 )
  y0.ini    &lt;- mean( y1 )
  theta.ini &lt;- pi
  a.ini     &lt;- 0.9
  n1.ini    &lt;- c(1, 4)
  n2.ini    &lt;- 5
  n3.ini    &lt;- c(5, 10, 15)
  ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, 
                    a.ini, n1.ini, n2.ini, n3.ini)

  Res2 &lt;- fitGE( GE, x=x1, y=y1, ini.val=ini.val, 
                 m=3, simpver=5, nval=1, unit="cm",  
                 par.list=FALSE, fig.opt=TRUE, angle=NULL, 
                 control=list(reltol=1e-20, maxit=20000), 
                 np=2000 )


graphics.off()
</code></pre>

<hr>
<h2 id='LeafSizeDist'>
Leaf size distribution of <em>Shibataea chinensis</em>
</h2><span id='topic+LeafSizeDist'></span>

<h3>Description</h3>

<p>The data consist of the leaf size measures of 12 individuad culms of <em>Shibataea chinensis</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(LeafSizeDist)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are five columns of variables: <code>Code</code>, <code>L</code>, 
<code>W</code>, <code>A</code>, and <code>M</code>. <code>Code</code> saves the bamboo number (the number before the hyphen) 
and the leaf number (the number after the hyphen) on each bamboo. <code>L</code> saves the length of each 
leaf lamina (cm); <code>W</code> saves the width of each leaf lamina (cm); 
<code>A</code> saves the area of each leaf lamina (<code class="reqn">\mbox{cm}^{2}</code>); and <code>M</code> saves 
the dry mass of each leaf lamina (g).
</p>


<h3>References</h3>

<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(LeafSizeDist)

CulmNumber &lt;- c()
for(i in 1:length(LeafSizeDist$Code)){
  temp &lt;- as.numeric( strsplit(LeafSizeDist$Code[i],"-", fixed=TRUE)[[1]][1] )
  CulmNumber &lt;- c(CulmNumber, temp)
}

uni.CN &lt;- sort( unique(CulmNumber) )  
ind    &lt;- CulmNumber==uni.CN[1]

A0 &lt;- LeafSizeDist$A[ind]
A1 &lt;- sort( A0 )
x1 &lt;- 1:length(A1)/length(A1)
y1 &lt;- cumsum(A1)/sum(A1)
x1 &lt;- c(0, x1)
y1 &lt;- c(0, y1)

M0 &lt;- LeafSizeDist$M[ind]
M1 &lt;- sort( M0 )
x2 &lt;- 1:length(M1)/length(M1)
y2 &lt;- cumsum(M1)/sum(M1)
x2 &lt;- c(0, x2)
y2 &lt;- c(0, y2)

dev.new()
plot(x1, y1, cex.lab=1.5, cex.axis=1.5, type="l",
    xlab="Cumulative proportion of the number of leaves", 
    ylab="Cumulative proportion of leaf area") 
lines(c(0,1), c(0,1), col=4) 

dev.new()
plot(x2, y2, cex.lab=1.5, cex.axis=1.5, type="l",
    xlab="Cumulative proportion of the number of leaves", 
    ylab="Cumulative proportion of leaf dry mass")
lines(c(0,1), c(0,1), col=4)   

graphics.off()
</code></pre>

<hr>
<h2 id='lmPE'>
Parameter Estimation for the Todd-Smart Equation
</h2><span id='topic+lmPE'></span>

<h3>Description</h3>

<p><code>lmPE</code> is used to estimate the parameters of the Todd-Smart equation using the multiple linear regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmPE(x, y, simpver = NULL, dev.angle = NULL, weights = NULL, fig.opt = TRUE, 
     prog.opt = TRUE, xlim = NULL, ylim = NULL, unit = NULL, main = NULL, 
     extr.method = "Shi")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmPE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original Todd-Smart equation.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_dev.angle">dev.angle</code></td>
<td>
<p>the angle of deviation for the axis associated with the maximum distance between two points 
on an egg's profile from the mid-line of the egg's profile.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_weights">weights</code></td>
<td>
<p>the weights for the multiple linear regression.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the observed and predicted egg's boundaries.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_prog.opt">prog.opt</code></td>
<td>
<p>an optional argument to show the running progress for different values of <code>dev.angle</code>, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Todd-Smart curve.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Todd-Smart curve.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Todd-Smart curve.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
<tr><td><code id="lmPE_+3A_extr.method">extr.method</code></td>
<td>
<p>an optional argument to fit the planar coordinate data of an egg's profile extracted using different methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There are two methods to obtain the major axis (i.e., the mid-line) of an egg's profile: the maximum distance method, and 
the longest axis adjustment method. In the first method, the straight line through two points forming the maximum distance 
on the egg's boundary is defined as the major axis. In the second method, we assume that there is an angle 
of deviation for the longest axis (i.e., the axis associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile. That is to say, 
the mid-line of an egg's profile is not the axis associated with the maximum distance between two points on the egg's profile. 
When <code>dev.angle = NULL</code>, the maximum distance method is used; when <code>dev.angle</code> is a numerical value or a numerical vector, 
the longest axis adjustment method is used. Here, the numerical value of <code>dev.angle</code> is not 
the angle of deviation for the major axis of an egg's profile from the <code class="reqn">x</code>-axis, and instead it is the angle of deviation  
for the longest axis (associated with the maximum distance between two points on the egg's profile) from the mid-line of the egg's profile. 
It is better to take the option of <code>extr.method = "Shi"</code> for correctly fitting the planar coordinate data of an egg's profile extracted 
using the protocols proposed by Shi et al. (2015, 2018) (and also see Su et al. (2019)), 
while it is better to take the option of <code>extr.method = "Biggins"</code> for correctly fitting the planar coordinate data 
of an egg's profile extracted using the protocols proposed by Biggins et al. (2018). For the planar coordinate data extracted using 
the protocols of Biggins et al. (2018), there are fewer data points on the two ends of the mid-line than other parts of the egg's profile, 
which means that the range of the observed <code class="reqn">x</code> values might be smaller than the actual egg's length. A group of equidistant <code class="reqn">x</code> 
values are set along the mid-line, and each <code class="reqn">x</code> value corresponds to two <code class="reqn">y</code> values that are respectively located at the upper 
and lower sides of the egg's profile. Because of the difference in the curvature for differnt parts of the egg's profile, 
the equidistant <code class="reqn">x</code> values cannot render the extracted data points on the egg's profile to be regular. For the planar coordinate data 
extracted using the protocols of Shi et al. (2015, 2018), the data points are more regularly distributed on the egg's profile (perimeter) 
than those of Biggins et al. (2018), although the <code class="reqn">x</code> values of the data points along the mid-line are not equidistant. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lm.tse</code></td>
<td>
<p>the fitted results of the multiple linear regression.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the estimates of the four model parameters in the Todd-Smart equation.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>the angle between the longest axis of an egg's profile (i.e., 
the axis associated with the maximum distance between two points on the egg's profile) and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>the optimal angle of deviation for the longest axis (associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>RSS.vector</code></td>
<td>
<p>the vector of residual sum of squares corresponding to <code>dev.angle</code>, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates corresponding to the the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates corresponding to the the observed <code class="reqn">x</code> coordinates, 
when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the length of the egg's boundary. The default is the maximum distance between two points on 
the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the maximum width of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the area of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the perimeter of the egg's boundary based on all data points on the egg's boundary.</p>
</td></tr>
<tr><td><code>RSS.scaled</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values for a scaled egg's profile whose length equals 2.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the numerical calculation.</p>
</td></tr>
<tr><td><code>RMSE.scaled</code></td>
<td>
<p>the root-mean-square errors between the observed and predicted <code class="reqn">y</code> values for a scaled egg's profile whose length equals 2.</p>
</td></tr>      
<tr><td><code>RMSE</code></td>
<td>
<p>the root-mean-square errors between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p><code>theta</code> is the calculated angle between the longest axis (i.e., the axis associated with the maximum distance 
between two points on an egg's profile) and the <code class="reqn">x</code>-axis, and <code>epsilon</code> is the calculated angle of deviation for the longest 
axis from the mid-line of the egg's profile. This means that the angle between the mid-line and the <code class="reqn">x</code>-axis is equal to 
<code>theta</code> + <code>epsilon</code>. 
Here, <code>RSS</code>, and <code>RMSE</code> are for the observed and predicted <code class="reqn">y</code> coordinates of the egg's profile, not for those 
when the egg's length is scaled to 2. There are two figures when <code>fig.opt = TRUE</code>: (i) the observed 
and predicted egg's boundaries when the egg's length is scaled to 2, and (ii) the observed 
and predicted egg's boundaries at their actual scales. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston’s universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Preston, F.W. (1953) The shapes of birds' eggs. <em>The Auk</em> 70, 160<code class="reqn">-</code>182.
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Huang, J., Hui, C., Grissino-Mayer, H.D., Tardif, J., Zhai, L., Wang, F., Li, B. (2015) 
Capturing spiral radial growth of conifers using the superellipse to model tree-ring geometric shape. 
<em>Frontiers in Plant Science</em> 6, 856. <a href="https://doi.org/10.3389/fpls.2015.00856">doi:10.3389/fpls.2015.00856</a>
</p>
<p>Shi, P., Niinemets, Ü., Hui, C., Niklas, K.J., Yu, X., Hölscher, D. (2020) 
Leaf bilateral symmetry and the scaling of the perimeter vs. the surface area in 15 vine species. 
<em>Forests</em> 11, 246. <a href="https://doi.org/10.3390/f11020246">doi:10.3390/f11020246</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Li, Y., Zhang, L., Lin, S., Gielis, J. (2018) General leaf-area geometric 
formula exists for plants - Evidence from the simplified Gielis equation. 
<em>Forests</em> 9, 714. <a href="https://doi.org/10.3390/f9110714">doi:10.3390/f9110714</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Su, J., Niklas, K.J., Huang, W., Yu, X., Yang, Y., Shi, P. (2019) 
Lamina shape does not correlate with lamina surface area: An analysis based on the simplified Gielis equation. 
<em>Global Ecology and Conservation</em> 19, e00666. <a href="https://doi.org/10.1016/j.gecco.2019.e00666">doi:10.1016/j.gecco.2019.e00666</a>
</p>
<p>Todd, P.H., Smart, I.H.M. (1984) The shape of birds' eggs. <em>Journal of Theoretical Biology</em> 
106, 239<code class="reqn">-</code>243. <a href="https://doi.org/10.1016/0022-5193%2884%2990021-3">doi:10.1016/0022-5193(84)90021-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveEPE">curveEPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+PE">PE</a></code>, <code><a href="#topic+TSE">TSE</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1  &lt;- adjdata(x0, y0, ub.np=3000, len.pro=1/20)
x1    &lt;- Res1$x
y1    &lt;- Res1$y

dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) ) 


  Res2 &lt;- lmPE(x1, y1, simpver=NULL, dev.angle=NULL, unit="cm")
  summary( Res2$lm.tse )
  Res2$RMSE.scaled / 2

  if(FALSE){
    dev.new()
    xg1 &lt;- seq(-1, 1, len=1000)
    yg1 &lt;- TSE(P=Res2$par, x=xg1, simpver=NULL)
    xg2 &lt;- seq(1, -1, len=1000)
    yg2 &lt;- -TSE(P=Res2$par, x=xg2, simpver=NULL)
    plot(xg1, yg1, asp=1, type="l", col=2, ylim=c(-1,1), cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(x)), ylab=expression(italic(y)))
    lines(xg2, yg2, col=4)

    dev.new()
    plot(Res2$x.obs, Res2$y.obs, asp=1, cex.lab=1.5, cex.axis=1.5,  
      xlab=expression(italic(x)), ylab=expression(italic(y)), type="l")
    lines(Res2$x.obs, Res2$y.pred, col=2)

    dev.new()
    plot(Res2$x.stand.obs, Res2$y.stand.obs, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(x)), ylab=expression(italic(y)), type="l")
    lines(Res2$x.stand.obs, Res2$y.stand.pred, col=2)
  }

  Res3 &lt;- lmPE(x1, y1, simpver=NULL, dev.angle=seq(-0.05, 0.05, by=0.0001), unit="cm")
  summary( Res3$lm.tse )
  Res3$epsilon
  Res3$RMSE.scaled / 2

  Res4 &lt;- lmPE(x1, y1, simpver=1, dev.angle=NULL, unit="cm")
  summary( Res4$lm.tse )



graphics.off()
</code></pre>

<hr>
<h2 id='lmTE'>
Parameter Estimation for the Troscianko Equation
</h2><span id='topic+lmTE'></span>

<h3>Description</h3>

<p><code>lmTE</code> is used to estimate the parameters of the Troscianko equation using the multiple linear regression, 
and the estimated values of the parameters are only used as the initial values for using the <code><a href="#topic+fitETE">fitETE</a></code> function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lmTE(x, y, dev.angle = NULL, weights = NULL, fig.opt = TRUE, 
     prog.opt = TRUE, xlim = NULL, ylim = NULL, unit = NULL, main = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lmTE_+3A_x">x</code></td>
<td>
<p>the <code class="reqn">x</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_y">y</code></td>
<td>
<p>the <code class="reqn">y</code> coordinates of the edge of an egg's boundary.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_dev.angle">dev.angle</code></td>
<td>
<p>the angle of deviation for the axis associated with the maximum distance between two points 
on an egg's profile from the mid-line of the egg's profile.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_weights">weights</code></td>
<td>
<p>the weights for the multiple linear regression.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_fig.opt">fig.opt</code></td>
<td>
<p>an optional argument to draw the observed and predicted egg's boundaries.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_prog.opt">prog.opt</code></td>
<td>
<p>an optional argument to show the running progress for different values of <code>dev.angle</code>, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_xlim">xlim</code></td>
<td>
<p>the range of the <code class="reqn">x</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_ylim">ylim</code></td>
<td>
<p>the range of the <code class="reqn">y</code>-axis over which to plot the Troscianko curve.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_unit">unit</code></td>
<td>
<p>the units of the <code class="reqn">x</code>-axis and the <code class="reqn">y</code>-axis when showing the Troscianko curve.</p>
</td></tr>
<tr><td><code id="lmTE_+3A_main">main</code></td>
<td>
<p>the main title of the figure.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimated values of the parameters using the <code><a href="#topic+lmTE">lmTE</a></code> function tend to be NOT globally optimal, and the values 
are only used as the initial values for using the <code><a href="#topic+fitETE">fitETE</a></code> function. 
There are two methods to obtain the major axis (i.e., the mid-line) of an egg's profile: the maximum distance method, and 
the longest axis adjustment method. In the first method, the straight line through two points forming the maximum distance 
on the egg's boundary is defined as the major axis. In the second method, we assume that there is an angle 
of deviation for the longest axis (i.e., the axis associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile. That is to say, 
the mid-line of an egg's profile is not the axis associated with the maximum distance between two points on the egg's profile. 
When <code>dev.angle = NULL</code>, the maximum distance method is used; when <code>dev.angle</code> is a numerical value or a numerical vector, 
the longest axis adjustment method is used. Here, the numerical value of <code>dev.angle</code> is not 
the angle of deviation for the major axis of an egg's profile from the <code class="reqn">x</code>-axis, and instead it is the angle of deviation  
for the longest axis (associated with the maximum distance between two points on the egg's profile) from the mid-line of the egg's profile. 
The planar coordinate data of an egg's profile are extracted using the protocols proposed by Shi et al. (2015, 2018) 
(and also see Su et al. (2019)). For the planar coordinate data extracted using the protocols of Shi et al. (2015, 2018), 
the data points are more regularly distributed on the egg's profile (perimeter), 
although the <code class="reqn">x</code> values of the data points along the mid-line are not equidistant. 
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>lm.te</code></td>
<td>
<p>the fitted results of the multiple linear regression.</p>
</td></tr>
<tr><td><code>par</code></td>
<td>
<p>the estimates of the four model parameters in the Troscianko equation.</p>
</td></tr>
<tr><td><code>theta</code></td>
<td>
<p>the angle between the longest axis of an egg's profile (i.e., 
the axis associated with the maximum distance between two points on the egg's profile) and the <code class="reqn">x</code>-axis.</p>
</td></tr>
<tr><td><code>epsilon</code></td>
<td>
<p>the optimal angle of deviation for the longest axis (associated with the maximum distance between two points on an egg's profile) 
from the mid-line of the egg's profile, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>RSS.vector</code></td>
<td>
<p>the vector of residual sum of squares corresponding to <code>dev.angle</code>, when <code>dev.angle</code> is not <code>NULL</code>.</p>
</td></tr>
<tr><td><code>x.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>y.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates.</p>
</td></tr>
<tr><td><code>y.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates corresponding to the the observed <code class="reqn">x</code> coordinates.</p>
</td></tr>
<tr><td><code>x.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">x</code> coordinates when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>y.stand.obs</code></td>
<td>
<p>the observed <code class="reqn">y</code> coordinates when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>y.stand.pred</code></td>
<td>
<p>the predicted <code class="reqn">y</code> coordinates corresponding to the the observed <code class="reqn">x</code> coordinates, 
when the egg length is fixed to be 2 ranging from -1 to 1.</p>
</td></tr>
<tr><td><code>scan.length</code></td>
<td>
<p>the length of the egg's boundary. The default is the maximum distance between two points on 
the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.width</code></td>
<td>
<p>the maximum width of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.area</code></td>
<td>
<p>the area of the egg's boundary.</p>
</td></tr>
<tr><td><code>scan.perimeter</code></td>
<td>
<p>the perimeter of the egg's boundary based on all data points on the egg's boundary.</p>
</td></tr>
<tr><td><code>RSS.scaled</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values for a scaled egg's profile whose length equals 2.</p>
</td></tr>
<tr><td><code>RSS</code></td>
<td>
<p>the residual sum of squares between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>
<tr><td><code>sample.size</code></td>
<td>
<p>the number of data points used in the numerical calculation.</p>
</td></tr>
<tr><td><code>RMSE.scaled</code></td>
<td>
<p>the root-mean-square errors between the observed and predicted <code class="reqn">y</code> values for a scaled egg's profile whose length equals 2.</p>
</td></tr>      
<tr><td><code>RMSE</code></td>
<td>
<p>the root-mean-square errors between the observed and predicted <code class="reqn">y</code> values.</p>
</td></tr>       
</table>


<h3>Note</h3>

<p><code>theta</code> is the calculated angle between the longest axis (i.e., the axis associated with the maximum distance 
between two points on an egg's profile) and the <code class="reqn">x</code>-axis, and <code>epsilon</code> is the calculated angle of deviation for the longest 
axis from the mid-line of the egg's profile. This means that the angle between the mid-line and the <code class="reqn">x</code>-axis is equal to 
<code>theta</code> + <code>epsilon</code>. 
Here, <code>RSS</code>, and <code>RMSE</code> are for the observed and predicted <code class="reqn">y</code> coordinates of the egg's profile, not for those 
when the egg's length is scaled to 2. There are two figures when <code>fig.opt = TRUE</code>: (i) the observed 
and predicted egg's boundaries when the egg's length is scaled to 2, and (ii) the observed 
and predicted egg's boundaries at their actual scales. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston’s universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Huang, J., Hui, C., Grissino-Mayer, H.D., Tardif, J., Zhai, L., Wang, F., Li, B. (2015) 
Capturing spiral radial growth of conifers using the superellipse to model tree-ring geometric shape. 
<em>Frontiers in Plant Science</em> 6, 856. <a href="https://doi.org/10.3389/fpls.2015.00856">doi:10.3389/fpls.2015.00856</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Li, Y., Zhang, L., Lin, S., Gielis, J. (2018) General leaf-area geometric 
formula exists for plants - Evidence from the simplified Gielis equation. 
<em>Forests</em> 9, 714. <a href="https://doi.org/10.3390/f9110714">doi:10.3390/f9110714</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Su, J., Niklas, K.J., Huang, W., Yu, X., Yang, Y., Shi, P. (2019) 
Lamina shape does not correlate with lamina surface area: An analysis based on the simplified Gielis equation. 
<em>Global Ecology and Conservation</em> 19, e00666. <a href="https://doi.org/10.1016/j.gecco.2019.e00666">doi:10.1016/j.gecco.2019.e00666</a>
</p>
<p>Troscianko, J. (2014). A simple tool for calculating egg shape, volume and surface area from digital images. 
<em>Ibis</em>, 156, 874<code class="reqn">-</code>878. <a href="https://doi.org/10.1111/ibi.12177">doi:10.1111/ibi.12177</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+TE">TE</a></code> 
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(eggs)

uni.C &lt;- sort( unique(eggs$Code) )
ind   &lt;- 8
Data  &lt;- eggs[eggs$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

Res1  &lt;- adjdata(x0, y0, ub.np=3000, len.pro=1/20)
x1    &lt;- Res1$x
y1    &lt;- Res1$y

dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) ) 


  Res2 &lt;- lmTE(x1, y1, dev.angle=NULL, unit="cm")
  summary( Res2$lm.te )
  Res2$RMSE.scaled / 2

  if(FALSE){
    dev.new()
    xg1 &lt;- seq(-1, 1, len=1000)
    yg1 &lt;- TE(P=Res2$par, x=xg1)
    xg2 &lt;- seq(1, -1, len=1000)
    yg2 &lt;- -TE(P=Res2$par, x=xg2)
    plot(xg1, yg1, asp=1, type="l", col=2, ylim=c(-1,1), cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(x)), ylab=expression(italic(y)))
    lines(xg2, yg2, col=4)

    dev.new()
    plot(Res2$x.obs, Res2$y.obs, asp=1, cex.lab=1.5, cex.axis=1.5,  
      xlab=expression(italic(x)), ylab=expression(italic(y)), type="l")
    lines(Res2$x.obs, Res2$y.pred, col=2)

    dev.new()
    plot(Res2$x.stand.obs, Res2$y.stand.obs, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(x)), ylab=expression(italic(y)), type="l")
    lines(Res2$x.stand.obs, Res2$y.stand.pred, col=2)
  }

  Res3 &lt;- lmTE(x1, y1, dev.angle=seq(-0.05, 0.05, by=0.0001), unit="cm")
  summary( Res3$lm.te )
  Res3$epsilon
  Res3$RMSE.scaled / 2



graphics.off()
</code></pre>

<hr>
<h2 id='MbetaE'>
Modified Beta Equation
</h2><span id='topic+MbetaE'></span>

<h3>Description</h3>

<p><code>MbetaE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values 
using the modified beta equation or one of its simplified versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MbetaE(P, x, simpver = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MbetaE_+3A_p">P</code></td>
<td>
<p>the parameters of the modified beta equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="MbetaE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values.</p>
</td></tr>
<tr><td><code id="MbetaE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the modified beta equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the modified beta equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}{ \left[\left(\frac{x_{\mathrm{max}}-x}{x_{\mathrm{max}}-x_{\mathrm{opt}}}\right)\left(\frac{x-x_{\mathrm{min}}}{x_{\mathrm{opt}}-x_{\mathrm{min}}}\right)^{\frac{x_{\mathrm{opt}}-x_{\mathrm{min}}}{x_{\mathrm{max}}-x_{\mathrm{opt}}}} \right] }^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
<code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code> are constants to be estimated;  
<code class="reqn">y_{\mathrm{opt}}</code> represents the maximum <code class="reqn">y</code>, and <code class="reqn">x_{\mathrm{opt}}</code> is the <code class="reqn">x</code> value associated with 
the maximum <code class="reqn">y</code> (i.e., <code class="reqn">y_{\mathrm{opt}}</code>); 
and <code class="reqn">x_{\mathrm{min}}</code> and <code class="reqn">x_{\mathrm{max}}</code> represent the 
lower and upper intersections between the curve and the <code class="reqn">x</code>-axis. <code class="reqn">y</code> is defined as 0 
when <code class="reqn">x &lt; x_{\mathrm{min}}</code> or <code class="reqn">x &gt; x_{\mathrm{max}}</code>. There are five elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}{ \left[\left(\frac{x_{\mathrm{max}}-x}{x_{\mathrm{max}}-x_{\mathrm{opt}}}\right)\left(\frac{x}{x_{\mathrm{opt}}}\right)^{\frac{x_{\mathrm{opt}}}{x_{\mathrm{max}}-x_{\mathrm{opt}}}} \right] }^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}{ \left(\frac{x_{\mathrm{max}}-x}{x_{\mathrm{max}}-x_{\mathrm{opt}}}\right)\left(\frac{x-x_{\mathrm{min}}}{x_{\mathrm{opt}}-x_{\mathrm{min}}}\right)^{\frac{x_{\mathrm{opt}}-x_{\mathrm{min}}}{x_{\mathrm{max}}-x_{\mathrm{opt}}}} };</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}{ \left(\frac{x_{\mathrm{max}}-x}{x_{\mathrm{max}}-x_{\mathrm{opt}}}\right)\left(\frac{x}{x_{\mathrm{opt}}}\right)^{\frac{x_{\mathrm{opt}}}{x_{\mathrm{max}}-x_{\mathrm{opt}}}} }; </code>
</p>
 
<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are three elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the modified beta equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>We have added a parameter <code class="reqn">\delta</code> in the original beta equation (i.e., <code>simpver = 2</code>) to increase the flexibility for data fitting.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+fitsigmoid">fitsigmoid</a></code>, 
<code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x1   &lt;- seq(-5, 15, len=2000)
Par1 &lt;- c(3, 3, 10, 2)
y1   &lt;- MbetaE(P=Par1, x=x1, simpver=1)

dev.new()
plot( x1, y1,cex.lab=1.5, cex.axis=1.5, type="l",
      xlab=expression(italic(x)), ylab=expression(italic(y)) )
 
graphics.off()
</code></pre>

<hr>
<h2 id='MBriereE'>
Modified Briere Equation
</h2><span id='topic+MBriereE'></span>

<h3>Description</h3>

<p><code>MBriereE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the modified Brière equation or one of its simplified versions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MBriereE(P, x, simpver = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MBriereE_+3A_p">P</code></td>
<td>
<p>the parameters of the modified Brière equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="MBriereE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values.</p>
</td></tr>
<tr><td><code id="MBriereE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the modified Brière equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the modified Brière equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = a\left|x(x-x_{\mathrm{min}})(x_{\mathrm{max}}-x)^{1/m}\right|^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
and <code class="reqn">a</code>, <code class="reqn">m</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code> are constants to be estimated, 
where <code class="reqn">x_{\mathrm{min}}</code> and <code class="reqn">x_{\mathrm{max}}</code> represents the 
lower and upper intersections between the curve and the <code class="reqn">x</code>-axis. <code class="reqn">y</code> is defined as 0 
when <code class="reqn">x &lt; x_{\mathrm{min}}</code> or <code class="reqn">x &gt; x_{\mathrm{max}}</code>. There are five elements in <code>P</code>, representing 
the values of <code class="reqn">a</code>, <code class="reqn">m</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = a\left|x^{2}(x_{\mathrm{max}}-x)^{1/m}\right|^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code>, representing 
the values of <code class="reqn">a</code>, <code class="reqn">m</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = ax(x-x_{\mathrm{min}})(x_{\mathrm{max}}-x)^{1/m};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code> representing 
the values of <code class="reqn">a</code>, <code class="reqn">m</code>, <code class="reqn">x_{\mathrm{min}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = ax^{2}(x_{\mathrm{max}}-x)^{1/m};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are three elements in <code>P</code> representing 
the values of <code class="reqn">a</code>, <code class="reqn">m</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the modified Brière equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>We have added a parameter <code class="reqn">\delta</code> in the original Brière equation (i.e., <code>simpver = 2</code>) to increase the flexibility for data fitting.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Brière, J.-F., Pracros, P, Le Roux, A.-Y., Pierre, J.-S. (1999) A novel rate
model of temperature-dependent development for arthropods. <em>Environmental 
Entomology</em> 28, 22<code class="reqn">-</code>29. <a href="https://doi.org/10.1093/ee/28.1.22">doi:10.1093/ee/28.1.22</a>
</p>
<p>Cao, L., Shi, P., Li, L., Chen, G. (2019) A new flexible sigmoidal growth model. <em>Symmetry</em> 11, 204.
<a href="https://doi.org/10.3390/sym11020204">doi:10.3390/sym11020204</a>
</p>
<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+fitsigmoid">fitsigmoid</a></code>, 
<code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x2   &lt;- seq(-5, 15, len=2000)
Par2 &lt;- c(0.01, 3, 0, 10, 1)
y2   &lt;- MBriereE(P=Par2, x=x2, simpver=NULL)

dev.new()
plot( x2, y2, cex.lab=1.5, cex.axis=1.5, type="l",
      xlab=expression(italic(x)), ylab=expression(italic(y)) )

graphics.off()
</code></pre>

<hr>
<h2 id='MLRFE'>
Modified Lobry-Rosso-Flandrois (LRF) Equation
</h2><span id='topic+MLRFE'></span>

<h3>Description</h3>

<p><code>MLRFE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values 
using the modified LRF equation or one of its simplified versions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MLRFE(P, x, simpver = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MLRFE_+3A_p">P</code></td>
<td>
<p>the parameters of the modified LRF equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="MLRFE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values.</p>
</td></tr>
<tr><td><code id="MLRFE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the modified LRF equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the modified LRF equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ \frac{x_{\mathrm{min}}+x_{\mathrm{max}}}{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}\left\{\frac{\left(x-x_{\mathrm{min}}\right)\left(x-x_{\mathrm{max}}\right)^{2}}{\left(x_{\mathrm{max}}-x_{\mathrm{opt}}\right)\left[(x_{\mathrm{max}}-x_{\mathrm{opt}})(x-x_{\mathrm{opt}})-(x_{\mathrm{min}}-x_{\mathrm{opt}})(x_{\mathrm{opt}}+x_{\mathrm{max}}-2x)\right]}\right\}^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left[\frac{x_{\mathrm{min}}+x_{\mathrm{max}}}{2}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}\left\{\frac{\left(x-x_{\mathrm{max}}\right)\left(x-x_{\mathrm{min}}\right)^{2}}{\left(x_{\mathrm{opt}}-x_{\mathrm{min}}\right)\left[(x_{\mathrm{opt}}-x_{\mathrm{min}})(x-x_{\mathrm{opt}})-(x_{\mathrm{opt}}-x_{\mathrm{max}})(x_{\mathrm{opt}}+x_{\mathrm{min}}-2x)\right]}\right\}^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
<code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code> are constants to be estimated;  
<code class="reqn">y_{\mathrm{opt}}</code> represents the maximum <code class="reqn">y</code>, and <code class="reqn">x_{\mathrm{opt}}</code> is the <code class="reqn">x</code> value associated with 
the maximum <code class="reqn">y</code> (i.e., <code class="reqn">y_{\mathrm{opt}}</code>); 
and <code class="reqn">x_{\mathrm{min}}</code> and <code class="reqn">x_{\mathrm{max}}</code> represents the 
lower and upper intersections between the curve and the <code class="reqn">x</code>-axis. 
There are five elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \frac{x_{\mathrm{max}}}{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}\left\{\frac{x\left(x-x_{\mathrm{max}}\right)^{2}}{\left(x_{\mathrm{max}}-x_{\mathrm{opt}}\right)\left[(x_{\mathrm{max}}-x_{\mathrm{opt}})(x-x_{\mathrm{opt}})+x_{\mathrm{opt}}(x_{\mathrm{opt}}+x_{\mathrm{max}}-2x)\right]}\right\}^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left[\frac{x_{\mathrm{max}}}{2}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = y_{\mathrm{opt}}\left\{\frac{\left(x-x_{\mathrm{max}}\right)x^{2}}{x_{\mathrm{opt}}\left[x_{\mathrm{opt}}(x-x_{\mathrm{opt}})-(x_{\mathrm{opt}}-x_{\mathrm{max}})(x_{\mathrm{opt}}-2x)\right]}\right\}^{\delta};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, and <code class="reqn">\delta</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ \frac{x_{\mathrm{min}}+x_{\mathrm{max}}}{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \frac{y_{\mathrm{opt}}\left(x-x_{\mathrm{min}}\right)\left(x-x_{\mathrm{max}}\right)^{2}}{\left(x_{\mathrm{max}}-x_{\mathrm{opt}}\right)\left[(x_{\mathrm{max}}-x_{\mathrm{opt}})(x-x_{\mathrm{opt}})-(x_{\mathrm{min}}-x_{\mathrm{opt}})(x_{\mathrm{opt}}+x_{\mathrm{max}}-2x)\right]};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left[\frac{x_{\mathrm{min}}+x_{\mathrm{max}}}{2}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \frac{y_{\mathrm{opt}}\left(x-x_{\mathrm{max}}\right)\left(x-x_{\mathrm{min}}\right)^{2}}{\left(x_{\mathrm{opt}}-x_{\mathrm{min}}\right)\left[(x_{\mathrm{opt}}-x_{\mathrm{min}})(x-x_{\mathrm{opt}})-(x_{\mathrm{opt}}-x_{\mathrm{max}})(x_{\mathrm{opt}}+x_{\mathrm{min}}-2x)\right]};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{min}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \frac{x_{\mathrm{max}}}{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \frac{y_{\mathrm{opt}}x\left(x-x_{\mathrm{max}}\right)^{2}}{\left(x_{\mathrm{max}}-x_{\mathrm{opt}}\right)\left[(x_{\mathrm{max}}-x_{\mathrm{opt}})(x-x_{\mathrm{opt}})+x_{\mathrm{opt}}(x_{\mathrm{opt}}+x_{\mathrm{max}}-2x)\right]};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left[\frac{x_{\mathrm{max}}}{2}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \frac{y_{\mathrm{opt}}\left(x-x_{\mathrm{max}}\right)x^{2}}{x_{\mathrm{opt}}\left[x_{\mathrm{opt}}(x-x_{\mathrm{opt}})-(x_{\mathrm{opt}}-x_{\mathrm{max}})(x_{\mathrm{opt}}-2x)\right]};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are three elements in <code>P</code>, representing 
the values of <code class="reqn">y_{\mathrm{opt}}</code>, <code class="reqn">x_{\mathrm{opt}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the modified LRF equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>We have added n parameter <code class="reqn">\delta</code> in the original LRF equation (i.e., <code>simpver = 2</code>) to increase the flexibility for data fitting.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+fitsigmoid">fitsigmoid</a></code>, 
<code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x3   &lt;- seq(-5, 15, len=2000)
Par3 &lt;- c(3, 3, 10, 2)
y3   &lt;- MbetaE(P=Par3, x=x3, simpver=1)

dev.new()
plot( x3, y3, cex.lab=1.5, cex.axis=1.5, type="l",
      xlab=expression(italic(x)), ylab=expression(italic(y)) )
 
graphics.off()
</code></pre>

<hr>
<h2 id='MPerformanceE'>
Modified Performance Equation
</h2><span id='topic+MPerformanceE'></span>

<h3>Description</h3>

<p><code>MPerformanceE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the modified performance equation or one of its simplified versions. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MPerformanceE(P, x, simpver = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="MPerformanceE_+3A_p">P</code></td>
<td>
<p>the parameters of the modified performance equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="MPerformanceE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values.</p>
</td></tr>
<tr><td><code id="MPerformanceE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the modified performance equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the modified performance equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}\left(x-x_{\mathrm{min}}\right)}\right)^{a}\left(1-e^{K_{2}\left(x-x_{\mathrm{max}}\right)}\right)^{b};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
and <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, <code class="reqn">a</code>, 
and <code class="reqn">b</code> are constants to be estimated, 
where <code class="reqn">x_{\mathrm{min}}</code> and <code class="reqn">x_{\mathrm{max}}</code> represents the 
lower and upper intersections between the curve and the <code class="reqn">x</code>-axis. <code class="reqn">y</code> is defined as 0 
when <code class="reqn">x &lt; x_{\mathrm{min}}</code> or <code class="reqn">x &gt; x_{\mathrm{max}}</code>. There are seven elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">x_{\mathrm{min}}</code>, <code class="reqn">x_{\mathrm{max}}</code>, <code class="reqn">a</code>, and <code class="reqn">b</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)^{a}\left(1-e^{K_{2}\left(x-x_{\mathrm{max}}\right)}\right)^{b};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are six elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">x_{\mathrm{max}}</code>, <code class="reqn">a</code>, and <code class="reqn">b</code> respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}\left(x-x_{\mathrm{min}}\right)}\right)\left(1-e^{K_{2}\left(x-x_{\mathrm{max}}\right)}\right);</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(x_{\mathrm{min}}, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are five elements in <code>P</code> representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">x_{\mathrm{min}}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)\left(1-e^{K_{2}\left(x-x_{\mathrm{max}}\right)}\right);</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ x_{\mathrm{max}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are four elements in <code>P</code> representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, and <code class="reqn">x_{\mathrm{max}}</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 4</code>, the simplified version 4 is selected: 
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)^{a}\left(1-e^{K_{2}\left(x-\sqrt{2}\right)}\right)^{b};</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are five elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, <code class="reqn">K_{2}</code>, <code class="reqn">a</code>, and <code class="reqn">b</code>, respectively.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 5</code>, the simplified version 5 is selected:
</p>
<p style="text-align: center;"><code class="reqn">\mbox{if } x \in{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = c\left(1-e^{-K_{1}x}\right)\left(1-e^{K_{2}\left(x-\sqrt{2}\right)}\right);</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \notin{\left(0, \ \sqrt{2}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>There are three elements in <code>P</code>, representing 
the values of <code class="reqn">c</code>, <code class="reqn">K_{1}</code>, and <code class="reqn">K_{2}</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the modified performance equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>We have added two parameters <code class="reqn">a</code> and <code class="reqn">b</code> in the original performance 
equation (i.e., <code>simpver = 2</code>) to increase the flexibility for data fitting. 
The cases of <code>simpver = 4</code> and <code>simpver = 5</code> are used to describe the rotated and right-shifted 
Lorenz curve (see Lian et al. [2023] for details).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Huey, R.B., Stevenson, R.D. (1979) Integrating thermal physiology and ecology of ectotherms: 
a discussion of approaches. <em>American Zoologist</em> 19, 357<code class="reqn">-</code>366. <a href="https://doi.org/10.1093/icb/19.1.357">doi:10.1093/icb/19.1.357</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Shi, P., Ge, F., Sun, Y., Chen, C. (2011) A simple model for describing 
the effect of temperature on insect developmental rate. <em>Journal of Asia-Pacific Entomology</em> 
14, 15<code class="reqn">-</code>20. <a href="https://doi.org/10.1016/j.aspen.2010.11.008">doi:10.1016/j.aspen.2010.11.008</a> 
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaovate">areaovate</a></code>, <code><a href="#topic+curveovate">curveovate</a></code>, <code><a href="#topic+fitLorenz">fitLorenz</a></code>, 
<code><a href="#topic+fitovate">fitovate</a></code>, <code><a href="#topic+fitsigmoid">fitsigmoid</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, 
<code><a href="#topic+MBriereE">MBriereE</a></code>, <code><a href="#topic+MLRFE">MLRFE</a></code>, <code><a href="#topic+sigmoid">sigmoid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x4   &lt;- seq(0, 40, len=2000)
Par4 &lt;- c(0.117, 0.090, 0.255, 5, 35, 1, 1)
y4   &lt;- MPerformanceE(P=Par4, x=x4, simpver=NULL)

dev.new()
plot( x4, y4, cex.lab=1.5, cex.axis=1.5, type="l",
      xlab=expression(italic(x)), ylab=expression(italic(y)) )

graphics.off()
</code></pre>

<hr>
<h2 id='Neocinnamomum'>
Leaf Boundary Data of Seven Species of <em>Neocinnamomum</em>
</h2><span id='topic+Neocinnamomum'></span>

<h3>Description</h3>

<p>The data consist of the leaf boundary data of seven species of <em>Neocinnamomum</em>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Neocinnamomum)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are four columns of variables: <code>Code</code>, <code>LatinName</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual leaves; 
<code>LatinName</code> saves the Latin names of the seven species of <em>Neocinnamomum</em>; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the leaf boundary in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the leaf boundary in the Cartesian coordinate system (cm).
</p>


<h3>References</h3>

<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Yu, K., Niklas, K.J., Schrader, J., Song, Y., Zhu, R., Li, Y., Wei, H., Ratkowsky, D.A. (2021)  
A general model for describing the ovate leaf shape. <em>Symmetry</em>, 13, 1524. <a href="https://doi.org/10.3390/sym13081524">doi:10.3390/sym13081524</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Neocinnamomum)

uni.C &lt;- sort( unique(Neocinnamomum$Code) )
ind   &lt;- 2
Data  &lt;- Neocinnamomum[Neocinnamomum$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y
length(x0)

Res1  &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/20)
x1    &lt;- Res1$x
y1    &lt;- Res1$y
length(x1)

dev.new()
plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) ) 

graphics.off()
</code></pre>

<hr>
<h2 id='NRGE'>
The Narushin-Romanov-Griffin Equation (NRGE)
</h2><span id='topic+NRGE'></span>

<h3>Description</h3>

<p><code>NRGE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the Narushin-Romanov-Griffin equation (NRGE).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NRGE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="NRGE_+3A_p">P</code></td>
<td>
<p>the four parameters (i.e., <code class="reqn">A</code>, <code class="reqn">B</code>, <code class="reqn">C</code>, and <code class="reqn">D</code>) of the Narushin-Romanov-Griffin equation.</p>
</td></tr>
<tr><td><code id="NRGE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Narushin-Romanov-Griffin equation (Narushin et al., 2021) has four parameters in total, 
among which three parameters have clear geometric meanings. 
</p>
<p style="text-align: center;"><code class="reqn">f_{1}(x)=\frac{B}{2}\sqrt{\frac{A^2-4x^2}{A^2+8Cx+4C^2}},</code>
</p>

<p style="text-align: center;"><code class="reqn">E = \frac{\sqrt{5.5A^{2}+11AC+4C^{2}} \cdot \left(\sqrt{3}AB-2D\sqrt{A^{2}+2AC+4C^{2
}}\right)}{\sqrt{3}AB\left(\sqrt{5.5A^{2}+11AC+4C^{2}}-2\sqrt{A^{2}+2AC+4C^{2}}\right)},</code>
</p>

<p style="text-align: center;"><code class="reqn">f_{2}(x)=\sqrt{\frac{A\left(A^{2}+8Cx+4C^{2}\right)}{2(A-2C)x^{2}+\left(A^{2}+8AC-4C^{2}\right)x+2AC^{2}+A^{2}C+A^{3}}},</code>
</p>

<p style="text-align: center;"><code class="reqn">f(x)=\pm f_{1}(x) \cdot \left\{1-E \cdot \left[1-f_{2}(x)\right]\right\}.</code>
</p>

<p>Here, <code class="reqn">f(x)</code> is the Narushin-Romanov-Griffin equation, which is used to predict the <code class="reqn">y</code> coordinates 
at the given <code class="reqn">x</code> coordinates; 
<code class="reqn">A</code> represents the egg's length; <code class="reqn">B</code> represents the egg's maximum breadth; <code class="reqn">C</code> is a parameter 
to be estimated, and it can be expressed as <code class="reqn">\left(A-B\right)/(2q)</code>, where <code class="reqn">q</code> is a parameter to 
be estimated; <code class="reqn">D</code> represents the egg's breadth associated with <code class="reqn">(3/4)L</code> from the egg base (to the egg tip) 
on the egg length axis (which can be regarded as the major axis of the egg shape).
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Narushin-Romanov-Griffin equation.
</p>


<h3>Note</h3>

<p>Here, parameter <code>C</code> is a parameter to be estimated, which can be directly calculated numerically based on the egg-shape data.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Shi, P., Gielis, J., Niklas, K.J. (2022) Comparison of a universal (but complex) model for avian egg 
shape with a simpler model. <em>Annals of the New York Academy of Sciences</em> 1514, 34<code class="reqn">-</code>42. <a href="https://doi.org/10.1111/nyas.14799">doi:10.1111/nyas.14799</a>
</p>
<p>Tian, F., Wang, Y., Sandhu, H.S., Gielis, J., Shi, P. (2020) Comparison of seed morphology of two ginkgo cultivars. 
<em>Journal of Forestry Research</em> 31, 751<code class="reqn">-</code>758. <a href="https://doi.org/10.1007/s11676-018-0770-y">doi:10.1007/s11676-018-0770-y</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveNRGE">curveNRGE</a></code>, <code><a href="#topic+fitNRGE">fitNRGE</a></code>, <code><a href="#topic+SurfaceAreaNRGE">SurfaceAreaNRGE</a></code>, <code><a href="#topic+VolumeNRGE">VolumeNRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
P0 &lt;- c(11.5, 7.8, 1.1, 5.6)
x  &lt;- seq(-11.5/2, 11.5/2, len=2000)
y1 &lt;- NRGE(P=P0, x=x)
y2 &lt;- -NRGE(P=P0, x=x)

dev.new()
plot(x, y1, cex.lab=1.5, cex.axis=1.5, type="l", 
     col=4, ylim=c(-4, 4), asp=1, 
     xlab=expression(italic(x)), ylab=expression(italic(y)) )
lines(x, y2, col=2)

graphics.off()
</code></pre>

<hr>
<h2 id='PE'>
Calculation of the Abscissa, Ordinate and Distance From the Origin For an Arbitrary Point on the Preston Curve 
</h2><span id='topic+PE'></span>

<h3>Description</h3>

<p><code>PE</code> is used to calculate the abscissa, ordinate and distance from the origin for an arbitrary point on 
the Preston curve that was generated by the original Preston equation or one of its simplified versions at a given angle.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PE(P, zeta, simpver = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PE_+3A_p">P</code></td>
<td>
<p>the parameters of the original Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="PE_+3A_zeta">zeta</code></td>
<td>
<p>the angle(s) used in the Preston equation.</p>
</td></tr>
<tr><td><code id="PE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original Preston equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the original Preston equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">y = a\ \mathrm{sin}\,\zeta, </code>
</p>

<p style="text-align: center;"><code class="reqn">x = b\ \mathrm{cos}\,\zeta\left(1+c_{1}\,\mathrm{sin}\,\zeta+c_{2}\,\mathrm{sin}^{2}\,\zeta+c_{3}\,\mathrm{sin}^{3}\,\zeta\right), </code>
</p>

<p style="text-align: center;"><code class="reqn">r = \sqrt{x^{2}+y^{2}}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Preston curve  
corresponding to an angle <code class="reqn">\zeta</code>; <code class="reqn">r</code> represents the distance of the point from the origin; <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, 
<code class="reqn">c_{2}</code>, and <code class="reqn">c_{3}</code> are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = a\ \mathrm{sin}\,\zeta, </code>
</p>

<p style="text-align: center;"><code class="reqn">x = b\ \mathrm{cos}\,\zeta\left(1+c_{1}\,\mathrm{sin}\,\zeta+c_{2}\,\mathrm{sin}^{2}\,\zeta\right), </code>
</p>

<p style="text-align: center;"><code class="reqn">r = \sqrt{x^{2}+y^{2}}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Preston curve  
corresponding to an angle <code class="reqn">\zeta</code>; <code class="reqn">r</code> represents the distance of the point from the origin; <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, 
and <code class="reqn">c_{2}</code> are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = a\ \mathrm{sin}\,\zeta, </code>
</p>

<p style="text-align: center;"><code class="reqn">x = b\ \mathrm{cos}\,\zeta\left(1+c_{1}\,\mathrm{sin}\,\zeta\right), </code>
</p>

<p style="text-align: center;"><code class="reqn">r = \sqrt{x^{2}+y^{2}}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Preston curve  
corresponding to an angle <code class="reqn">\zeta</code>; <code class="reqn">r</code> represents the distance of the point from the origin; <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{1}</code>  
are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = a\ \mathrm{sin}\,\zeta, </code>
</p>

<p style="text-align: center;"><code class="reqn">x = b\ \mathrm{cos}\,\zeta\left(1+c_{2}\,\mathrm{sin}^{2}\,\zeta\right), </code>
</p>

<p style="text-align: center;"><code class="reqn">r = \sqrt{x^{2}+y^{2}}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Preston curve  
corresponding to an angle <code class="reqn">\zeta</code>; <code class="reqn">r</code> represents the distance of the point from the origin; <code class="reqn">a</code>, <code class="reqn">b</code>, and 
<code class="reqn">c_{2}</code> are parameters to be estimated.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>x</code></td>
<td>
<p>the abscissa(s) of the Preston curve corresponding to the given angle(s).</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>the ordinate(s) of the Preston curve corresponding to the given angle(s).</p>
</td></tr>
<tr><td><code>r</code></td>
<td>
<p>the distance(s) of the Preston curve corresponding to the given angle(s) from the origin.</p>
</td></tr>
</table>


<h3>Note</h3>

<p><code class="reqn">\zeta</code> is NOT the polar angle corresponding to <code class="reqn">r</code>, i.e., 
</p>
<p style="text-align: center;"><code class="reqn">y \neq r\,\mathrm{sin}\,\zeta, </code>
</p>
 
<p style="text-align: center;"><code class="reqn">x \neq r\,\mathrm{cos}\,\zeta. </code>
</p>
 
<p>Let <code class="reqn">\varphi</code> be the polar angle corresponding to <code class="reqn">r</code>. We have: 
</p>
<p style="text-align: center;"><code class="reqn"> \zeta = \mathrm{arc\,sin}\frac{ r\ \mathrm{sin}\,\varphi }{a}. </code>
</p>



<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston's universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Preston, F.W. (1953) The shapes of birds' eggs. <em>The Auk</em> 70, 160<code class="reqn">-</code>182.
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Todd, P.H., Smart, I.H.M. (1984) The shape of birds' eggs. <em>Journal of Theoretical Biology</em> 
106, 239<code class="reqn">-</code>243. <a href="https://doi.org/10.1016/0022-5193%2884%2990021-3">doi:10.1016/0022-5193(84)90021-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPE">EPE</a></code>, <code><a href="#topic+lmPE">lmPE</a></code>, <code><a href="#topic+TSE">TSE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  zeta &lt;- seq(0, 2*pi, len=2000)
  Par1 &lt;- c(10, 6, 0.325, -0.0415)
  Res1 &lt;- PE(P=Par1, zeta=zeta, simpver=1)
  Par2 &lt;- c(10, 6, -0.325, -0.0415)
  Res2 &lt;- PE(P=Par2, zeta=zeta, simpver=1)

  dev.new()
  plot(Res1$x, Res1$y, asp=1, type="l", col=4, cex.lab=1.5, cex.axis=1.5,
       xlab=expression(italic(x)), ylab=expression(italic(y)))
  lines(Res2$x, Res2$y, col=2)

  dev.new()
  plot(Res1$r, Res2$r, asp=1, cex.lab=1.5, cex.axis=1.5,
       xlab=expression(paste(italic(r), ""[1], sep="")), 
       ylab=expression(paste(italic(r), ""[2], sep="")))
  abline(0, 1, col=4)

  graphics.off()
</code></pre>

<hr>
<h2 id='SarabiaE'>
Sarabia Equation
</h2><span id='topic+SarabiaE'></span>

<h3>Description</h3>

<p><code>SarabiaE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the Sarabia equation. The equation describes the <code class="reqn">y</code> coordinates of the Lorenz curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SarabiaE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SarabiaE_+3A_p">P</code></td>
<td>
<p>the parameters of the Sarabia equation.</p>
</td></tr>
<tr><td><code id="SarabiaE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values ranging between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">y = \left(1-\lambda+\eta\right)x+\lambda x^{a_1 + 1}-\eta \left[1-\left(1-x\right)^{a_2 + 1}\right].</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
and <code class="reqn">\lambda</code>, <code class="reqn">\eta</code>, <code class="reqn">a_1</code> and <code class="reqn">a_2</code> are constants to be estimated, where 
<code class="reqn">a_1 \ge 0</code>, <code class="reqn">a_2 + 1 \ge 0</code>, <code class="reqn">\eta\,a_2 + \lambda \le 1</code>, <code class="reqn">\lambda \ge 0</code>, and <code class="reqn">\eta\,a_2 \ge 0</code>.   
There are four elements in <code>P</code>, representing 
the values of <code class="reqn">\lambda</code>, <code class="reqn">\eta</code>, <code class="reqn">a_1</code> and <code class="reqn">a_2</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Sarabia equation.
</p>


<h3>Note</h3>

<p>The numerical range of <code class="reqn">x</code> should range between 0 and 1. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Sarabia, J.-M. (1997) A hierarchy of Lorenz curves based on the generalized Tukey's lambda distribution. 
<em>Econometric Reviews</em> 16, 305<code class="reqn">-</code>320. <a href="https://doi.org/10.1080/07474939708800389">doi:10.1080/07474939708800389</a> 
</p>
<p>Sitthiyot, T., Holasut, K. (2023) A universal model for the Lorenz curve with novel applications 
for datasets containing zeros and/or exhibiting extreme inequality. <em>Scientific Reports</em> 
13, 4729. <a href="https://doi.org/10.1038/s41598-023-31827-x">doi:10.1038/s41598-023-31827-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitLorenz">fitLorenz</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>, <code><a href="#topic+SHE">SHE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- seq(0, 1, len=2000)
Pa1 &lt;- c(0.295, 101.485, 0.705, 0.003762)
Y1  &lt;- SarabiaE(P=Pa1, x=X1)

dev.new()
plot( X1, Y1, cex.lab=1.5, cex.axis=1.5, type="l", asp=1, xaxs="i", 
      yaxs="i", xlim=c(0, 1), ylim=c(0, 1), 
      xlab="Cumulative proportion of the number of infructescences", 
      ylab="Cumulative proportion of the infructescence length" )

graphics.off()
</code></pre>

<hr>
<h2 id='SCSE'>
Sarabia-Castillo-Slottje Equation (SCSE)
</h2><span id='topic+SCSE'></span>

<h3>Description</h3>

<p><code>SCSE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the Sarabia-Castillo-Slottje equation. The equation describes the <code class="reqn">y</code> coordinates of the Lorenz curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCSE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCSE_+3A_p">P</code></td>
<td>
<p>the parameters of the Sarabia-Castillo-Slottje equation.</p>
</td></tr>
<tr><td><code id="SCSE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values ranging between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">y = x^{\gamma}\left[1-\left(1-x\right)^{\alpha}\right]^{\beta}.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
and <code class="reqn">\gamma</code>, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code> are constants to be estimated, where <code class="reqn">\gamma \ge 0</code>, 
<code class="reqn">0 &lt; \alpha \le 1</code>, and <code class="reqn">\beta \ge 1</code>.   
There are three elements in <code>P</code>, representing 
the values of <code class="reqn">\gamma</code>, <code class="reqn">\alpha</code> and <code class="reqn">\beta</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Sarabia-Castillo-Slottje equation.
</p>


<h3>Note</h3>

<p>The numerical range of <code class="reqn">x</code> should range between 0 and 1.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Sarabia, J.-M., Castillo, E., Slottje, D.J. (1999) An ordered family of Lorenz curves. 
<em>Journal of Econometrics</em>. 91, 43<code class="reqn">-</code>60. <a href="https://doi.org/10.1016/S0304-4076%2898%2900048-7">doi:10.1016/S0304-4076(98)00048-7</a>
</p>
<p>Sitthiyot, T., Holasut, K. (2023) A universal model for the Lorenz curve with novel applications 
for datasets containing zeros and/or exhibiting extreme inequality. <em>Scientific Reports</em> 
13, 4729. <a href="https://doi.org/10.1038/s41598-023-31827-x">doi:10.1038/s41598-023-31827-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitLorenz">fitLorenz</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SHE">SHE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- seq(0, 1, len=2000)
Pa2 &lt;- c(0, 0.790, 1.343)
Y2  &lt;- SCSE(P=Pa2, x=X1)

dev.new()
plot( X1, Y2, cex.lab=1.5, cex.axis=1.5, type="l", asp=1, xaxs="i", 
      yaxs="i", xlim=c(0, 1), ylim=c(0, 1), 
      xlab="Cumulative proportion of the number of infructescences", 
      ylab="Cumulative proportion of the infructescence length" )

graphics.off()
</code></pre>

<hr>
<h2 id='SHE'>
Sitthiyot-Holasut Equation
</h2><span id='topic+SHE'></span>

<h3>Description</h3>

<p><code>SHE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the Sitthiyot-Holasut equation. The equation describes the <code class="reqn">y</code> coordinates of the Lorenz curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SHE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SHE_+3A_p">P</code></td>
<td>
<p>the parameters of the Sitthiyot-Holasut equation.</p>
</td></tr>
<tr><td><code id="SHE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values ranging between 0 and 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p style="text-align: center;"><code class="reqn">\mbox{if } x &gt; \delta,</code>
</p>

<p style="text-align: center;"><code class="reqn">y = \left(1-\rho\right)\,\left[\left(\frac{2}{P+1}\right)\left(\frac{x-\delta}{1-\delta}\right)\right] + 
\rho\,\left[\left(1-\omega\right)\left(\frac{x-\delta}{1-\delta}\right)^{P}+\omega\,\left\{1-\left[1-\left(\frac{x-\delta}{1-\delta}\right)\right]^{\frac{1}{P}}\right\}\right];</code>
</p>

<p style="text-align: center;"><code class="reqn">\mbox{if } x \le \delta,</code>
</p>

<p style="text-align: center;"><code class="reqn">y = 0.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the independent and dependent variables, respectively; 
and <code class="reqn">\delta</code>, <code class="reqn">\rho</code>, <code class="reqn">\omega</code> and <code class="reqn">P</code> are constants to be estimated, where <code class="reqn">0 \le \delta &lt; 1</code>, 
<code class="reqn">0 \le \rho \le 1</code>, <code class="reqn">0 \le \omega \le 1</code>, and <code class="reqn">P \ge 1</code>.   
There are four elements in <code>P</code>, representing 
the values of <code class="reqn">\delta</code>, <code class="reqn">\rho</code>, <code class="reqn">\omega</code> and <code class="reqn">P</code>, respectively.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Sitthiyot-Holasut equation.
</p>


<h3>Note</h3>

<p>The numerical range of <code class="reqn">x</code> should range between 0 and 1. 
When <code class="reqn">x &lt; \delta</code>, the <code class="reqn">x</code> value is assigned to be <code class="reqn">\delta</code>. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Sitthiyot, T., Holasut, K. (2023) A universal model for the Lorenz curve with novel applications 
for datasets containing zeros and/or exhibiting extreme inequality. <em>Scientific Reports</em> 
13, 4729. <a href="https://doi.org/10.1038/s41598-023-31827-x">doi:10.1038/s41598-023-31827-x</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitLorenz">fitLorenz</a></code>, <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>, <code><a href="#topic+SarabiaE">SarabiaE</a></code>, <code><a href="#topic+SCSE">SCSE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X1  &lt;- seq(0, 1, len=2000)
Pa3 &lt;- c(0, 1, 0.446, 1.739)
Y3  &lt;- SHE(P=Pa3, x=X1)

dev.new()
plot( X1, Y3, cex.lab=1.5, cex.axis=1.5, type="l", asp=1, xaxs="i", 
      yaxs="i", xlim=c(0, 1), ylim=c(0, 1), 
      xlab="Cumulative proportion of the number of infructescences", 
      ylab="Cumulative proportion of the infructescence length" )

graphics.off()
</code></pre>

<hr>
<h2 id='shoots'>
Height Growth Data of Bamboo Shoots
</h2><span id='topic+shoots'></span>

<h3>Description</h3>

<p>The height data of four species of bamboo at Nanjing Forestry University campus in 2016.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(shoots)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are four columns of variables: <code>Code</code>, <code>LatinName</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the number codes of different bamboo species; 
<code>LatinName</code> saves the Latin names of different bamboo species; 
<code>x</code> saves the investigation times (days from a specific starting time of growth, 
and where every bamboo has a different starting time of growth);  
and <code>y</code> saves the measured aboveground height values (cm).
</p>
<p><code>Code = 1</code> represents <em>Phyllostachys iridescens</em>, and the starting time (namely <code>time = 0</code>) was defined as 12:00, 3rd April, 2016; 
</p>
<p><code>Code = 2</code> represents <em>Phyllostachys mannii</em>, and the starting time (namely <code>time = 0</code>) was defined as 12:00, 4th April, 2016; 
</p>
<p><code>Code = 3</code> represents <em>Pleioblastus maculatus</em>, and the starting time (namely <code>time = 0</code>) was defined as 12:00, 29th April, 2016;
</p>
<p><code>Code = 4</code> represents <em>Sinobambusa tootsik</em>, and the starting time (namely <code>time = 0</code>) was defined as 12:00, 18th April, 2016. 
</p>


<h3>References</h3>

<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(shoots)
attach(shoots)
# Choose a species
# 1: Phyllostachys iridescens; 2: Phyllostachys mannii; 
# 3: Pleioblastus maculatus; 4: Sinobambusa tootsik
ind &lt;- 4
x1  &lt;- x[Code == ind]
y1  &lt;- y[Code == ind] 

dev.new()
plot(x1, y1, cex=1.5, cex.lab=1.5, cex.axis=1.5, xlab="Time (days)", ylab="Height (cm)")


  delta0  &lt;- c(0.5, 1, 2, 5, 10, 20)
  ini.val &lt;- list(600, 25, 0, 40, delta0)
  resu1   &lt;- fitsigmoid(MLRFE, x=x1, y=y1, ini.val=ini.val, simpver=NULL, 
               fig.opt=TRUE, control=list(reltol=1e-20, maxit=20000), 
               subdivisions = 100L, rel.tol=.Machine$double.eps^0.25,                
               abs.tol=.Machine$double.eps^0.25, stop.on.error=TRUE, 
               keep.xy=FALSE, aux=NULL)


graphics.off()
</code></pre>

<hr>
<h2 id='sigmoid'>
Sigmoid Growth Equation
</h2><span id='topic+sigmoid'></span>

<h3>Description</h3>

<p><code>sigmoid</code> is used to calculate the <code class="reqn">y</code> values (e.g., biomass, height, body length, and so on) at given investigation times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmoid(expr, P, x, simpver = 1, subdivisions = 100L,
        rel.tol = .Machine$double.eps^0.25, 
        abs.tol = rel.tol, stop.on.error = TRUE, 
        keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sigmoid_+3A_expr">expr</code></td>
<td>
<p>a performance equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_p">P</code></td>
<td>
<p>the parameters of the performance equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_x">x</code></td>
<td>
<p>the given investigation times.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplfied version of the performance equation.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="sigmoid_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The performance equations denote <code>MbetaE</code>, <code>MBriereE</code>, 
<code>MLRFE</code>, and their simplified versions. 
The arguments of <code>P</code> and <code>simpver</code> should correspond 
to <code>expr</code> (i.e., <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, and <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>). 
The sigmoid curve is the integral of the performance equation or one of its simplified versions.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values (i.e., biomass, height, body length, and so on) at given investigation times.  
The growth euqation is actually an integral of the performance equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p>Here, the user can define other performance equations, but new equations or 
their simplified versions should include the lower and upper thresholds in 
the <code class="reqn">x</code>-axis corresponding to <code class="reqn">y = 0</code>, whose indices of the parameters in <code>P</code> should 
be the same as those in <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, and <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>).
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Jin, J., Quinn, B.K., Shi, P. (2022) The modified Brière equation and its 
applications. <em>Plants</em> 11, 1769. <a href="https://doi.org/10.3390/plants11131769">doi:10.3390/plants11131769</a>
</p>
<p>Lian, M., Shi, P., Zhang, L., Yao, W., Gielis, J., Niklas, K.J. (2023) A generalized performance equation 
and its application in measuring the Gini index of leaf size inequality. 
<em>Trees <code class="reqn">-</code> Structure and Function</em> 37, 1555<code class="reqn">-</code>1565. <a href="https://doi.org/10.1007/s00468-023-02448-8">doi:10.1007/s00468-023-02448-8</a>
</p>
<p>Shi, P., Fan, M., Ratkowsky, D.A., Huang, J., Wu, H., Chen, L., Fang, S., 
Zhang, C. (2017) Comparison of two ontogenetic growth equations for animals and plants. 
<em>Ecological Modelling</em> 349, 1<code class="reqn">-</code>10. <a href="https://doi.org/10.1016/j.ecolmodel.2017.01.012">doi:10.1016/j.ecolmodel.2017.01.012</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitsigmoid">fitsigmoid</a></code>, <code><a href="#topic+MbetaE">MbetaE</a></code>, <code><a href="#topic+MBriereE">MBriereE</a></code>, 
<code><a href="#topic+MLRFE">MLRFE</a></code>, and <code><a href="#topic+MPerformanceE">MPerformanceE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Pa1 &lt;- c(3, 3, 10, 1)
xv1 &lt;- seq(-5, 15, len=2000)
yv1 &lt;- sigmoid(MBriereE, P=Pa1, x=xv1, simpver=1)
Pa2 &lt;- c(3, 3, 2, 12, 1)
yv2 &lt;- sigmoid(MBriereE, P=Pa2, x=xv1, simpver=NULL)
Pa3 &lt;- c(200, 1.32, 0.85, 12, 3.7, 17)
yv3 &lt;- sigmoid(MPerformanceE, P=Pa3, x=xv1, simpver=1)

dev.new()
plot( xv1, yv2, cex.lab=1.5, cex.axis=1.5, type="l", col=4,
      xlab=expression(italic(x)), ylab=expression(italic(y)) )
lines( xv1, yv1, col=2 )
lines( xv1, yv3, col=3 )

graphics.off()
</code></pre>

<hr>
<h2 id='starfish'>
Boundary Data of Eight Sea Stars
</h2><span id='topic+starfish'></span>

<h3>Description</h3>

<p>The data consist of the boundary data of eight sea stars from five species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(starfish)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are four columns of variables: <code>Code</code>, <code>LatinName</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the codes of individual sea stars; 
<code>LatinName</code> saves the Latin names of the eight sea stars; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the eight sea stars in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the eight sea stars in the Cartesian coordinate system (cm). 
In <code>Code</code>, codes 1-9 represent <em>Anthenoides tenuis</em>, <em>Culcita schmideliana</em> sample 1, 
<em>Culcita schmideliana</em> sample 2, <em>Culcita schmideliana</em> sample 3, <em>Stellaster equestris</em>, <em>Tosia australis</em>, 
<em>Tosia magnifica</em> sample 1, and <em>Tosia magnifica</em> sample 2, respectively. See Table A1 published in Shi et al. (2020).
</p>


<h3>References</h3>

<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric 
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(starfish)

uni.C &lt;- sort( unique(starfish$Code) )
ind   &lt;- 2
Data  &lt;- starfish[starfish$Code==uni.C[ind], ]
x0    &lt;- Data$x
y0    &lt;- Data$y

dev.new()
plot( x0, y0, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )
length(x0)

Res1 &lt;- adjdata(x0, y0, ub.np=400, times=1.2, len.pro=1/20)
x1   &lt;- Res1$x
y1   &lt;- Res1$y

dev.new()
plot( x1, y1, asp=1, type="l", cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic("x")), ylab=expression(italic("y")) )
length(x1)

graphics.off()
</code></pre>

<hr>
<h2 id='SurfaceAreaEPE'>
Calculation of the Surface Area of An Egg Based on the Explicit Preston Equation 
</h2><span id='topic+SurfaceAreaEPE'></span>

<h3>Description</h3>

<p><code>SurfaceAreaEPE</code> is used to calculate the surface area of an egg that follows the explicit Preston equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfaceAreaEPE(P, simpver = NULL, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurfaceAreaEPE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the explicit Preston equation.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaEPE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the surface area (<code class="reqn">S</code>) of an egg based on the explicit Preston equation or one of its simplified versions is:
</p>
<p style="text-align: center;"><code class="reqn">S(x)=2\,\pi\int_{-a}^{a}y\,\sqrt{1+\left(\frac{dy}{dx}\right)^2}\,dx,</code>
</p>

<p>where <code class="reqn">y</code> denotes the explicit Preston equation (i.e., <code><a href="#topic+EPE">EPE</a></code>), and 
<code class="reqn">a</code> denotes half the egg's length. 
When <code>simpver = NULL</code>, <code>P</code> has five parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, <code class="reqn">c_{2}</code>, and <code class="reqn">c_{3}</code>; 
when <code>simpver = 1</code>, <code>P</code> has four parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, and <code class="reqn">c_{2}</code>; 
when <code>simpver = 2</code>, <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{1}</code>; 
when <code>simpver = 3</code>, <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{2}</code>.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+SurfaceAreaEPE">SurfaceAreaEPE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+EPE">EPE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DEPE">DEPE</a></code>, <code><a href="#topic+EPE">EPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+VolumeEPE">VolumeEPE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par4 &lt;- c(4.27, 2.90, 0.0868, 0.0224, -0.0287)
  SurfaceAreaEPE(P = Par4, simpver = NULL)
</code></pre>

<hr>
<h2 id='SurfaceAreaETE'>
Calculation of the Surface Area of An Egg Based on the Explicit Troscianko Equation 
</h2><span id='topic+SurfaceAreaETE'></span>

<h3>Description</h3>

<p><code>SurfaceAreaETE</code> is used to calculate the surface area of an egg that follows the explicit Troscianko equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfaceAreaETE(P, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurfaceAreaETE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Troscianko equation.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaETE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the surface area (<code class="reqn">S</code>) of an egg based on the explicit Troscianko equation is:
</p>
<p style="text-align: center;"><code class="reqn">S(x)=2\,\pi\int_{-a}^{a}y\,\sqrt{1+\left(\frac{dy}{dx}\right)^2}\,dx,</code>
</p>

<p>where <code class="reqn">y</code> denotes the explicit Troscianko equation (i.e., <code><a href="#topic+ETE">ETE</a></code>), and 
<code class="reqn">a</code> denotes half the egg's length.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+SurfaceAreaETE">SurfaceAreaETE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+ETE">ETE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DETE">DETE</a></code>, <code><a href="#topic+ETE">ETE</a></code>, <code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+VolumeETE">VolumeETE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par5 &lt;- c(2.25, -0.38, -0.29, -0.16)
  SurfaceAreaETE(P = Par5)
</code></pre>

<hr>
<h2 id='SurfaceAreaNRGE'>
Calculation of the Surface Area of An Egg Based on the Narushin-Romanov-Griffin Equation 
</h2><span id='topic+SurfaceAreaNRGE'></span>

<h3>Description</h3>

<p><code>SurfaceAreaNRGE</code> is used to calculate the surface area of an egg that follows the Narushin-Romanov-Griffin equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfaceAreaNRGE(P, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurfaceAreaNRGE_+3A_p">P</code></td>
<td>
<p>the parameters of the Narushin-Romanov-Griffin equation.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaNRGE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the surface area (<code class="reqn">S</code>) of an egg based on the Narushin-Romanov-Griffin equation is:
</p>
<p style="text-align: center;"><code class="reqn">S(x)=2\,\pi\int_{-A/2}^{A/2}y\,\sqrt{1+\left(\frac{dy}{dx}\right)^2}\,dx,</code>
</p>

<p>where <code class="reqn">y</code> denotes the Narushin-Romanov-Griffin equation (i.e., <code><a href="#topic+NRGE">NRGE</a></code>), and 
<code class="reqn">A</code> denotes the egg's length, which is the first element in the parameter vector, <code>P</code>.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+SurfaceAreaNRGE">SurfaceAreaNRGE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+NRGE">NRGE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveNRGE">curveNRGE</a></code>, <code><a href="#topic+DNRGE">DNRGE</a></code>, <code><a href="#topic+fitNRGE">fitNRGE</a></code>, <code><a href="#topic+NRGE">NRGE</a></code>, <code><a href="#topic+VolumeNRGE">VolumeNRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par6 &lt;- c(4.51, 3.18, 0.1227, 2.2284)
  SurfaceAreaNRGE(P = Par6)
</code></pre>

<hr>
<h2 id='SurfaceAreaSGE'>
Calculation of the Surface Area of An Egg Based on the Simplified Gielis Equation 
</h2><span id='topic+SurfaceAreaSGE'></span>

<h3>Description</h3>

<p><code>SurfaceAreaSGE</code> is used to calculate the surface area of an egg that follows the simplified Gielis equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SurfaceAreaSGE(P, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SurfaceAreaSGE_+3A_p">P</code></td>
<td>
<p>the parameters of the simplified Gielis equation, including <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="SurfaceAreaSGE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the surface area (<code class="reqn">S</code>) of an egg based on the simplified Gielis equation is:
</p>
<p style="text-align: center;"><code class="reqn">S(\varphi)=2\,\pi\int_{0}^{\pi}\sin{\left(\varphi\right)}\ r\,\sqrt{r^2+\left(\frac{dr}{d\varphi}\right)^2}\,d\varphi,</code>
</p>

<p>where the polar raidus (<code class="reqn">r</code>) is the function of the polar angle (<code class="reqn">\varphi</code>):
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}},</code>
</p>
 
<p>namely the simplified Gielis equation (i.e., <code><a href="#topic+GE">GE</a></code>) with arguments 
<code>simpver = 1</code> and <code>m = 1</code>.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+SurfaceAreaSGE">SurfaceAreaSGE</a></code> function only has 
the three parameters: <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Chen, Z. (2012) Volume and area of revolution under polar coordinate system. 
<em>Studies in College Mathematics</em> 15(6), 9<code class="reqn">-</code>11.
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+DSGE">DSGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code>, <code><a href="#topic+VolumeSGE">VolumeSGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par7 &lt;- c(1.124, 14.86, 49.43)
  SurfaceAreaSGE(P = Par7)
</code></pre>

<hr>
<h2 id='TE'>
The Troscianko Equation (TE) 
</h2><span id='topic+TE'></span>

<h3>Description</h3>

<p><code>TE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the re-expression of Troscianko's egg-shape equation, which was proposed by Biggins et al. (2018, 2022).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TE(P, x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TE_+3A_p">P</code></td>
<td>
<p>the parameters of the Troscianko equation, including <code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code>.</p>
</td></tr>
<tr><td><code id="TE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values ranging from <code class="reqn">-</code>1 to 1.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Troscianko equation is recommended as (Biggins et al., 2022): 
</p>
<p style="text-align: center;"><code class="reqn">y = \exp\left(\alpha_{0}+\alpha_{1}\,x+\alpha_{2}\,x^2\right)\sqrt{1-x^2}, </code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Troscianko curve; 
<code class="reqn">\alpha_{0}</code>, <code class="reqn">\alpha_{1}</code>, and <code class="reqn">\alpha_{2}</code> are parameters to be estimated.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Troscianko equation.
</p>


<h3>Note</h3>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> in the Troscianko equation are actually equal to <code class="reqn">y/a</code> 
and <code class="reqn">x/a</code>, respectively, in the explicit Troscianko equation, where <code class="reqn">a</code> 
represents half the egg length (See <code><a href="#topic+ETE">ETE</a></code> for details). 
This means that the egg length is scaled to be 2, 
and the maximum egg width is correspondingly adjusted to keep the same scale.   
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston's universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Wang, L., Quinn, B.K., Gielis, J. (2023) A new program to estimate the parameters 
of Preston's equation, a general formula for describing the egg shape of birds. <em>Symmetry</em> 
15, 231. <a href="https://doi.org/10.3390/sym15010231">doi:10.3390/sym15010231</a>
</p>
<p>Troscianko, J. (2014). A simple tool for calculating egg shape, volume and surface area from digital images. 
<em>Ibis</em>, 156, 874<code class="reqn">-</code>878. <a href="https://doi.org/10.1111/ibi.12177">doi:10.1111/ibi.12177</a> 
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+lmTE">lmTE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par &lt;- c(-0.377, -0.29, -0.16)
  xb1 &lt;- seq(-1, 1, len=20000)
  yb1 &lt;- TE(P=Par, x=xb1)
  xb2 &lt;- seq(1, -1, len=20000)
  yb2 &lt;- -TE(P=Par, x=xb2)

  dev.new()
  plot(xb1, yb1, asp=1, type="l", col=2, ylim=c(-1, 1), cex.lab=1.5, cex.axis=1.5, 
    xlab=expression(italic(x)), ylab=expression(italic(y)))
  lines(xb2, yb2, col=4)

  graphics.off()
</code></pre>

<hr>
<h2 id='TGE'>
Calculation of the Polar Radius of the Twin Gielis Curve
</h2><span id='topic+TGE'></span>

<h3>Description</h3>

<p><code>TGE</code> is used to calculate the polar radii of the twin Gielis equation or 
one of its simplified versions at given polar angles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TGE(P, phi, m = 1, simpver = NULL, nval = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TGE_+3A_p">P</code></td>
<td>
<p>the parameters of the twin Gielis equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="TGE_+3A_phi">phi</code></td>
<td>
<p>the polar angle(s).</p>
</td></tr>
<tr><td><code id="TGE_+3A_m">m</code></td>
<td>
<p>the given <code class="reqn">m</code> value that determines the number of angles of the twin Gielis curve within <code class="reqn">[0, 2\pi)</code>.</p>
</td></tr>
<tr><td><code id="TGE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the twin Gielis equation.</p>
</td></tr>
<tr><td><code id="TGE_+3A_nval">nval</code></td>
<td>
<p>the specified value for <code class="reqn">n_{2}</code> or <code class="reqn">n_{3}</code> in the simplified versions.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The general form of the twin Gielis equation can be represented as follows:
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = \mathrm{exp}\left\{\frac{1}{\alpha+\beta\,\mathrm{ln}\left[r_{e}\left(\varphi\right)\right]}+\gamma\right\},</code>
</p>

<p>where <code class="reqn">r</code> represents the polar radius of the twin Gielis curve at the polar angle <code class="reqn">\varphi</code>, and 
<code class="reqn">r_{e}</code> represents the elementary polar radius at the polar angle <code class="reqn">\varphi</code>. There is a hyperbolic 
link function to link their log-transformations, i.e., 
</p>
<p style="text-align: center;"><code class="reqn">\mathrm{ln}\left[r\left(\varphi\right)\right] = \frac{1}{\alpha+\beta\,\mathrm{ln}\left[r_{e}\left(\varphi\right)\right]}+\gamma.</code>
</p>
  
<p>The first three elements of <code>P</code> are <code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, and <code class="reqn">\gamma</code>, and the remaining element(s) of 
<code>P</code> are the parameters of the elementary polar function, i.e., <code class="reqn">r_{e}\left(\varphi\right)</code>. 
See Shi et al. (2020) for details. 
</p>
<p><code class="reqn">\quad</code> When <code>simpver = NULL</code>, the original twin Gielis equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{3}},</code>
</p>

<p>where <code class="reqn">r_{e}</code> represents the elementary polar radius at the polar angle <code class="reqn">\varphi</code>; 
<code class="reqn">m</code> determines the number of angles of the twin Gielis curve within <code class="reqn">[0, 2\pi)</code>; 
and <code class="reqn">k</code>, <code class="reqn">n_{2}</code>, and <code class="reqn">n_{3}</code> are the fourth to the sixth elements in <code>P</code>. In total, there are 
six elements in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}},</code>
</p>

<p>where <code class="reqn">n_{2}</code> is the fourth element in <code>P</code>. There are 
four elements in total in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}, </code>
</p>

<p>where <code class="reqn">n_{2}</code> should be specified in <code>nval</code>, and <code>P</code> only includes three elements, i.e., 
<code class="reqn">\alpha</code>, <code class="reqn">\beta</code>, and <code class="reqn">\gamma</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{3}},</code>
</p>

<p>where <code class="reqn">n_{2}</code> and <code class="reqn">n_{3}</code> are the fourth and fifth elements in <code>P</code>. There are 
five elements in total in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 4</code>, the simplified version 4 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}},</code>
</p>

<p>where <code class="reqn">k</code> and <code class="reqn">n_{2}</code> are the fourth and fifth elelments in <code>P</code>. There are 
five elements in total in <code>P</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 5</code>, the simplified version 5 is selected:
</p>
<p style="text-align: center;"><code class="reqn">r_{e}\left(\varphi\right) = \left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\frac{1}{k}\,\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}},</code>
</p>

<p>where <code class="reqn">k</code> is the fourth elelment in <code>P</code>. There are 
four elements in total in <code>P</code>. <code class="reqn">n_{2}</code> should be specified in <code>nval</code>.
</p>


<h3>Value</h3>

<p>The polar radii predicted by the twin Gielis equation or one of its simplified versions.
</p>


<h3>Note</h3>

<p><code>simpver</code> here is different from that in the <code><a href="#topic+GE">GE</a></code> function.
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Li, Y., Quinn, B.K., Gielis, J., Li, Y., Shi, P. (2022) Evidence that supertriangles exist 
in nature from the vertical projections of <em>Koelreuteria paniculata</em> fruit. <em>Symmetry</em> 
14, 23. <a href="https://doi.org/10.3390/sym14010023">doi:10.3390/sym14010023</a>
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Shi, P., Ratkowsky, D.A., Gielis, J. (2020) The generalized Gielis geometric 
equation and its application. <em>Symmetry</em> 12, 645. <a href="https://doi.org/10.3390/sym12040645">doi:10.3390/sym12040645</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+areaGE">areaGE</a></code>, <code><a href="#topic+curveGE">curveGE</a></code>, <code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TGE.par    &lt;- c(2.88, 0.65, 1.16, 139)
varphi.vec &lt;- seq(0, 2*pi, len=2000)
r2.theor   &lt;- TGE(P=TGE.par, phi=varphi.vec, simpver=1, m=5)

dev.new()
plot( varphi.vec, r2.theor, cex.lab=1.5, cex.axis=1.5, 
      xlab=expression(italic(varphi)), ylab=expression(italic("r")),
      type="l", col=4 ) 

starfish4 &lt;- curveGE(TGE, P=c(0, 0, 0, TGE.par), simpver=1, m=5, fig.opt=TRUE)

graphics.off()
</code></pre>

<hr>
<h2 id='TSE'>
The Todd-Smart Equation (TSE) 
</h2><span id='topic+TSE'></span>

<h3>Description</h3>

<p><code>TSE</code> is used to calculate <code class="reqn">y</code> values at given <code class="reqn">x</code> values using 
the Todd and Smart's re-expression of Preston's universal egg shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TSE(P, x, simpver = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="TSE_+3A_p">P</code></td>
<td>
<p>the parameters of the original Todd-Smart equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="TSE_+3A_x">x</code></td>
<td>
<p>the given <code class="reqn">x</code> values ranging from -1 to 1.</p>
</td></tr>
<tr><td><code id="TSE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the original Todd-Smart equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the original Preston equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn">y = d_{0}z_{0} + d_{1}z_{1} + d_{2}z_{2} + d_{3}z_{3},</code>
</p>

<p>where 
</p>
<p style="text-align: center;"><code class="reqn">z_{0}=\sqrt{1-x^2},</code>
</p>

<p style="text-align: center;"><code class="reqn">z_{1}=x\sqrt{1-x^2},</code>
</p>

<p style="text-align: center;"><code class="reqn">z_{2}=x^{2}\sqrt{1-x^2},</code>
</p>

<p style="text-align: center;"><code class="reqn">z_{3}=x^{3}\sqrt{1-x^2}.</code>
</p>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Todd-Smart curve; 
<code class="reqn">d_{0}</code>, <code class="reqn">d_{1}</code>, <code class="reqn">d_{2}</code>, and <code class="reqn">d_{3}</code> are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = d_{0}z_{0} + d_{1}z_{1} + d_{2}z_{2},</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Todd-Smart curve; 
<code class="reqn">d_{0}</code>, <code class="reqn">d_{1}</code>, and <code class="reqn">d_{2}</code> are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = d_{0}z_{0} + d_{1}z_{1},</code>
</p>
 
<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Todd-Smart curve; 
<code class="reqn">d_{0}</code>, and <code class="reqn">d_{1}</code> are parameters to be estimated.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn">y = d_{0}z_{0} + d_{2}z_{2},</code>
</p>

<p>where <code class="reqn">x</code> and <code class="reqn">y</code> represent the abscissa and ordinate of an arbitrary point on the Todd-Smart curve; 
<code class="reqn">d_{0}</code>, and <code class="reqn">d_{2}</code> are parameters to be estimated.
</p>


<h3>Value</h3>

<p>The <code class="reqn">y</code> values predicted by the Todd-Smart equation.
</p>


<h3>Note</h3>

<p>Here, <code class="reqn">x</code> and <code class="reqn">y</code> in the Todd-Smart equation are actually equal to <code class="reqn">y/a</code> 
and <code class="reqn">x/a</code>, respectively, in the Preston equation (See <code><a href="#topic+PE">PE</a></code> for details). 
Since <code class="reqn">a</code> represents half the egg length, this means that the egg length is fixed to be 2, 
and the maximum egg width is correspondingly adjusted to keep the same scale.   
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Biggins, J.D., Montgomeries, R.M., Thompson, J.E., Birkhead, T.R. (2022) 
Preston's universal formula for avian egg shape. <em>Ornithology</em> 
139, ukac028. <a href="https://doi.org/10.1093/ornithology/ukac028">doi:10.1093/ornithology/ukac028</a>
</p>
<p>Biggins, J.D., Thompson, J.E., Birkhead, T.R. (2018) Accurately quantifying 
the shape of birds' eggs. <em>Ecology and Evolution</em> 8, 9728<code class="reqn">-</code>9738. <a href="https://doi.org/10.1002/ece3.4412">doi:10.1002/ece3.4412</a>
</p>
<p>Nelder, J.A., Mead, R. (1965). A simplex method for function minimization. 
<em>Computer Journal</em> 7, 308<code class="reqn">-</code>313. <a href="https://doi.org/10.1093/comjnl/7.4.308">doi:10.1093/comjnl/7.4.308</a>
</p>
<p>Preston, F.W. (1953) The shapes of birds' eggs. <em>The Auk</em> 70, 160<code class="reqn">-</code>182.
</p>
<p>Shi, P., Gielis, J., Quinn, B.K., Niklas, K.J., Ratkowsky, D.A., Schrader, J., Ruan, H., 
Wang, L., Niinemets, Ü. (2022) 'biogeom': An R package for simulating and fitting natural 
shapes. <em>Annals of the New York Academy of Sciences</em> 1516, 123<code class="reqn">-</code>134. <a href="https://doi.org/10.1111/nyas.14862">doi:10.1111/nyas.14862</a>
</p>
<p>Todd, P.H., Smart, I.H.M. (1984) The shape of birds' eggs. <em>Journal of Theoretical Biology</em> 
106, 239<code class="reqn">-</code>243. <a href="https://doi.org/10.1016/0022-5193%2884%2990021-3">doi:10.1016/0022-5193(84)90021-3</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lmPE">lmPE</a></code>, <code><a href="#topic+PE">PE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par &lt;- c(0.695320398, -0.210538656, -0.070373518, 0.116839895)
  xb1 &lt;- seq(-1, 1, len=20000)
  yb1 &lt;- TSE(P=Par, x=xb1)
  xb2 &lt;- seq(1, -1, len=20000)
  yb2 &lt;- -TSE(P=Par, x=xb2)

  dev.new()
  plot(xb1, yb1, asp=1, type="l", col=2, ylim=c(-1, 1), cex.lab=1.5, cex.axis=1.5, 
    xlab=expression(italic(x)), ylab=expression(italic(y)))
  lines(xb2, yb2, col=4)

  graphics.off()
</code></pre>

<hr>
<h2 id='veins'>
Leaf Vein Data of <em>Michelia compressa</em>
</h2><span id='topic+veins'></span>

<h3>Description</h3>

<p>The data consist of the leaf vein data of a leaf of <em>M. compressa</em> 
sampled at Nanjing Forestry University campus in late July 2019.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(veins)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are two columns of variables: <code>x</code> and <code>y</code>. 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the leaf veins in the Cartesian coordinate system (cm); 
<code>y</code> saves the <code class="reqn">y</code> coordinates of the leaf veins in the Cartesian coordinate system (cm).
</p>


<h3>Note</h3>

<p>The data cannot be adjusted by the <code><a href="#topic+adjdata">adjdata</a></code> function.
</p>


<h3>References</h3>

<p>Shi, P., Yu, K., Niinemets, Ü., Gielis, J. (2021) Can leaf shape be represented by the ratio of 
leaf width to length? Evidence from nine species of <em>Magnolia</em> and <em>Michelia</em> (Magnoliaceae). 
<em>Forests</em> 12, 41. <a href="https://doi.org/10.3390/f12010041">doi:10.3390/f12010041</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fracdim">fracdim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(veins)

dev.new()
plot(veins$x, veins$y, cex=0.01, asp=1, cex.lab=1.5, cex.axis=1.5, 
     xlab=expression(italic("x")), ylab=expression(italic("y")))

graphics.off()
</code></pre>

<hr>
<h2 id='VolumeEPE'>
Calculation of the Volume of An Egg Based on the Explicit Preston Equation
</h2><span id='topic+VolumeEPE'></span>

<h3>Description</h3>

<p><code>VolumeEPE</code> is used to calculate the volume of an egg that follows the explicit Preston equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VolumeEPE(P, simpver = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VolumeEPE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Preston equation or one of its simplified versions.</p>
</td></tr>
<tr><td><code id="VolumeEPE_+3A_simpver">simpver</code></td>
<td>
<p>an optional argument to use the simplified version of the explicit Preston equation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>simpver = NULL</code>, the volume formula (<code class="reqn">V</code>) of the explicit Preston equation is selected: 
</p>
<p style="text-align: center;"><code class="reqn"> V(x) = \frac{4\,\pi}{315}a\,b^{2}\left(105+21\,c_{1}^{2}+42\,c_{2}+9\,c_{2}^2+18\,c_{1}\,c_{3}+5\,c_{3}^2\right), </code>
</p>

<p>where <code>P</code> has five parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, <code class="reqn">c_{2}</code>, and <code class="reqn">c_{3}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 1</code>, the volume formula of the simplified version 1 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> V(x) = \frac{4\,\pi}{315}a\,b^{2}\left(105+21\,c_{1}^{2}+42\,c_{2}+9\,c_{2}^2\right), </code>
</p>

<p>where <code>P</code> has four parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, <code class="reqn">c_{1}</code>, and <code class="reqn">c_{2}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 2</code>, the volume formula of the simplified version 2 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> V(x) = \frac{4\,\pi}{315}a\,b^{2}\left(105+21\,c_{1}^{2}\right), </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{1}</code>.
</p>
<p><code class="reqn">\quad</code> When <code>simpver = 3</code>, the volume formula of the simplified version 3 is selected:
</p>
<p style="text-align: center;"><code class="reqn"> V(x) = \frac{4\,\pi}{315}a\,b^{2}\left(105+42\,c_{2}+9\,c_{2}^2\right), </code>
</p>

<p>where <code>P</code> has three parameters: <code class="reqn">a</code>, <code class="reqn">b</code>, and <code class="reqn">c_{2}</code>.
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+VolumeEPE">VolumeEPE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+EPE">EPE</a></code> function. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+EPE">EPE</a></code>, <code><a href="#topic+fitEPE">fitEPE</a></code>, <code><a href="#topic+SurfaceAreaEPE">SurfaceAreaEPE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par3 &lt;- c(4.27, 2.90, 0.0868, 0.0224, -0.0287)
  VolumeEPE(P=Par3, simpver=NULL)

  # Test the case when simpver = NULL
  a    &lt;- Par3[1]
  b    &lt;- Par3[2]
  c1   &lt;- Par3[3]
  c2   &lt;- Par3[4]
  c3   &lt;- Par3[5]
  pi*4/315*a*b^2*(105+21*c1^2+42*c2+9*c2^2+18*c1*c3+5*c3^2)

  myfun &lt;- function(x){
    pi*EPE(P=Par3, x=x, simpver=NULL)^2
  }
  integrate(myfun, -4.27, 4.27)$value
</code></pre>

<hr>
<h2 id='VolumeETE'>
Calculation of the Volume of An Egg Based on the Explicit Troscianko Equation
</h2><span id='topic+VolumeETE'></span>

<h3>Description</h3>

<p><code>VolumeETE</code> is used to calculate the volume of an egg that follows the explicit Troscianko equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VolumeETE(P, subdivisions = 100L,
         rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
         stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VolumeETE_+3A_p">P</code></td>
<td>
<p>the parameters of the explicit Troscianko equation.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeETE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the volume (<code class="reqn">V</code>) of an egg based on the explicit Troscianko equation is:
</p>
<p style="text-align: center;"><code class="reqn">V(x)=\pi\int_{-a}^{a}y^2\,dx,</code>
</p>

<p>where <code class="reqn">y</code> denotes the explicit Troscianko equation (i.e., <code><a href="#topic+ETE">ETE</a></code>), and 
<code class="reqn">a</code> denotes half the egg's length.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+VolumeETE">VolumeETE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+ETE">ETE</a></code> function.  
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ETE">ETE</a></code>, <code><a href="#topic+fitETE">fitETE</a></code>, <code><a href="#topic+SurfaceAreaETE">SurfaceAreaETE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par5 &lt;- c(2.25, -0.38, -0.29, -0.16)
  VolumeETE(P=Par5)

  myfun &lt;- function(x){
    pi*ETE(P=Par5, x=x)^2
  }
  integrate(myfun, -2.25, 2.25)$value
</code></pre>

<hr>
<h2 id='VolumeNRGE'>
Calculation of the Volume of An Egg Based on the Narushin-Romanov-Griffin Equation
</h2><span id='topic+VolumeNRGE'></span>

<h3>Description</h3>

<p><code>VolumeNRGE</code> is used to calculate the volume of an egg that follows the Narushin-Romanov-Griffin equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VolumeNRGE(P, subdivisions = 100L,
         rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
         stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VolumeNRGE_+3A_p">P</code></td>
<td>
<p>the parameters of the Narushin-Romanov-Griffin equation.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeNRGE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the volume (<code class="reqn">V</code>) of an egg based on the Narushin-Romanov-Griffin equation is:
</p>
<p style="text-align: center;"><code class="reqn">V(x)=\pi\int_{-A/2}^{A/2}y^2\,dx,</code>
</p>

<p>where <code class="reqn">y</code> denotes the Narushin-Romanov-Griffin equation (i.e., <code><a href="#topic+NRGE">NRGE</a></code>), and 
<code class="reqn">A</code> denotes the egg's length, which is the first element in the parameter vector, <code>P</code>.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+VolumeNRGE">VolumeNRGE</a></code> function has the same parameters, as those in the 
<code><a href="#topic+NRGE">NRGE</a></code> function.  
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Narushin, V.G., Romanov, M.N., Griffin, D.K. (2021) Egg and math: introducing a universal formula for egg shape. 
<em>Annals of the New York Academy of Sciences</em> 1505, 169<code class="reqn">-</code>177. <a href="https://doi.org/10.1111/nyas.14680">doi:10.1111/nyas.14680</a>
</p>
<p>Narushin, V.G., Romanov, M.N., Mishra, B., Griffin, D.K. (2022) Mathematical progression of 
avian egg shape with associated area and volume determinations. 
<em>Annals of the New York Academy of Sciences</em> 1513, 65<code class="reqn">-</code>78. <a href="https://doi.org/10.1111/nyas.14771">doi:10.1111/nyas.14771</a>
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+curveNRGE">curveNRGE</a></code>, <code><a href="#topic+fitNRGE">fitNRGE</a></code>, <code><a href="#topic+NRGE">NRGE</a></code>, <code><a href="#topic+SurfaceAreaNRGE">SurfaceAreaNRGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par6 &lt;- c(4.51, 3.18, 0.1227, 2.2284)
  VolumeNRGE(P=Par6)

  myfun &lt;- function(x){
    pi*NRGE(P=Par6, x=x)^2
  }
  integrate(myfun, -4.51/2, 4.51/2)$value
</code></pre>

<hr>
<h2 id='VolumeSGE'>
Calculation of the Volume of An Egg Based on the Simplified Gielis Equation 
</h2><span id='topic+VolumeSGE'></span>

<h3>Description</h3>

<p><code>VolumeSGE</code> is used to calculate the volume of an egg that follows the simplified Gielis equation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>VolumeSGE(P, subdivisions = 100L,
          rel.tol = .Machine$double.eps^0.25, abs.tol = rel.tol,
          stop.on.error = TRUE, keep.xy = FALSE, aux = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="VolumeSGE_+3A_p">P</code></td>
<td>
<p>the parameters of the simplified Gielis equation, including <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_subdivisions">subdivisions</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_rel.tol">rel.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_abs.tol">abs.tol</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_stop.on.error">stop.on.error</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_keep.xy">keep.xy</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
<tr><td><code id="VolumeSGE_+3A_aux">aux</code></td>
<td>
<p>please see the arguments for the <code><a href="stats.html#topic+integrate">integrate</a></code> function in package <span class="pkg">stats</span>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The formula of the volume (<code class="reqn">V</code>) of an egg based on the simplified Gielis equation is:
</p>
<p style="text-align: center;"><code class="reqn">V\left(\varphi\right)=\frac{2}{3}\,\pi\int_{0}^{\pi}\sin{\left(\varphi\right)}\ r^3\left(\varphi\right)\,d\varphi,</code>
</p>

<p>where the polar raidus (<code class="reqn">r</code>) is the function of the polar angle (<code class="reqn">\varphi</code>):
</p>
<p style="text-align: center;"><code class="reqn">r\left(\varphi\right) = a\left(\left|\mathrm{cos}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}+
\left|\mathrm{sin}\left(\frac{m}{4}\varphi\right)\right|^{n_{2}}\right)^{-\frac{1}{n_{1}}},</code>
</p>
 
<p>namely the simplified Gielis equation (i.e., <code><a href="#topic+GE">GE</a></code>) with arguments 
<code>simpver = 1</code> and <code>m = 1</code>.  
</p>


<h3>Note</h3>

<p>The argument <code>P</code> in the <code><a href="#topic+VolumeSGE">VolumeSGE</a></code> function only has 
the three parameters: <code class="reqn">a</code>, <code class="reqn">n_{1}</code>, and <code class="reqn">n_{2}</code>. 
</p>


<h3>Author(s)</h3>

<p>Peijian Shi <a href="mailto:pjshi@njfu.edu.cn">pjshi@njfu.edu.cn</a>, Johan Gielis <a href="mailto:johan.gielis@uantwerpen.be">johan.gielis@uantwerpen.be</a>, 
Brady K. Quinn <a href="mailto:Brady.Quinn@dfo-mpo.gc.ca">Brady.Quinn@dfo-mpo.gc.ca</a>.
</p>


<h3>References</h3>

<p>Chen, Z. (2012) Volume and area of revolution under polar coordinate system. 
<em>Studies in College Mathematics</em> 15(6), 9<code class="reqn">-</code>11.
</p>
<p>Shi, P., Chen, L., Quinn, B.K., Yu, K., Miao, Q., Guo, X., Lian, M., Gielis, J., Niklas, K.J. (2023) 
A simple way to calculate the volume and surface area of avian eggs. 
<em>Annals of the New York Academy of Sciences</em> 1524, 118<code class="reqn">-</code>131. <a href="https://doi.org/10.1111/nyas.15000">doi:10.1111/nyas.15000</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitGE">fitGE</a></code>, <code><a href="#topic+GE">GE</a></code>, <code><a href="#topic+SurfaceAreaSGE">SurfaceAreaSGE</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  Par7 &lt;- c(1.124, 14.86, 49.43)
  VolumeSGE(P = Par7)
</code></pre>

<hr>
<h2 id='whitespruce'>
Planar Coordinates of <em>Picea glauca</em> Tree Rings
</h2><span id='topic+whitespruce'></span>

<h3>Description</h3>

<p>The data consist of the planar coordinates of <em>Picea glauca</em> tree rings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(whitespruce)
</code></pre>


<h3>Details</h3>

<p>In the data set, there are three columns of variables: <code>Code</code>, <code>x</code>, and <code>y</code>. 
<code>Code</code> saves the age codes of tree rings from the 2nd year to the 44th year; 
<code>x</code> saves the <code class="reqn">x</code> coordinates of the tree rings in the Cartesian coordinate system (cm); 
and <code>y</code> saves the <code class="reqn">y</code> coordinates of the tree rings in the Cartesian coordinate system (cm).
</p>


<h3>References</h3>

<p>Shi, P., Huang, J., Hui, C., Grissino-Mayer, H.D., Tardif, J., Zhai, L., Wang, F., Li, B. (2015) 
Capturing spiral radial growth of conifers using the superellipse to model tree-ring geometric shape. 
<em>Frontiers in Plant Science</em> 6, 856. <a href="https://doi.org/10.3389/fpls.2015.00856">doi:10.3389/fpls.2015.00856</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(whitespruce)

uni.C &lt;- sort( unique(whitespruce$Code) )  
Data  &lt;- whitespruce[whitespruce$Code==uni.C[10], ]
x0    &lt;- Data$x
y0    &lt;- Data$y
Res1  &lt;- adjdata(x0, y0, ub.np=2000, len.pro=1/20)

plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
      xlim=c(3, 13), ylim=c(3, 13), col="grey73", lwd=2,
      xlab=expression(italic(x)), ylab=expression(italic(y)) )



  uni.C &lt;- sort( unique(whitespruce$Code) )  
  for(i in 1:length(uni.C)){
    Data  &lt;- whitespruce[whitespruce$Code==uni.C[i], ]
    x0    &lt;- Data$x
    y0    &lt;- Data$y

    Res1  &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/10)
  
    if(i == 1){
      plot( Res1$x, Res1$y, asp=1, cex.lab=1.5, cex.axis=1.5, type="l", 
            xlim=c(3, 13), ylim=c(3, 13), col=1, lwd=1,
            xlab=expression(italic(x)), ylab=expression(italic(y)) )
    }
    if(i &gt; 1) lines(Res1$x, Res1$y, col=1, lwd=1)
   
  }

  uni.C   &lt;- sort( unique(whitespruce$Code) ) 
  uni.C   &lt;- uni.C[1:12]
  Length  &lt;- c()
  results &lt;- data.frame(Code=c(), x0=c(), y0=c(), theta=c(),
                   a=c(), k=c(), n1=c(), r.sq=c(), RSS=c(), N=c())
  for(i in 1:length(uni.C)){
    Data      &lt;- whitespruce[whitespruce$Code==uni.C[i], ]
    x0        &lt;- Data$x
    y0        &lt;- Data$y
    Res1      &lt;- adjdata(x0, y0, ub.np=200, len.pro=1/10)
    x1        &lt;- Res1$x
    y1        &lt;- Res1$y
    x0.ini    &lt;- mean( x1 )
    y0.ini    &lt;- mean( y1 )
    theta.ini &lt;- c(0, pi/4, pi/2)
    a.ini     &lt;- 0.9
    k.ini     &lt;- 1
    n1.ini    &lt;- c(1.5, 2, 2.5)
    ini.val   &lt;- list(x0.ini, y0.ini, theta.ini, 
                      a.ini, k.ini, n1.ini)

    print(paste("Progress: ", i, "/", length(uni.C), sep=""))
    H &lt;- NULL
    try( H &lt;- fitGE(GE, x=x1, y=y1, ini.val=ini.val, 
                    m=4, simpver=9, unit="cm", par.list=FALSE,
                    stand.fig=FALSE, angle=NULL, fig.opt=FALSE,  
                    control=list(reltol=1e-20, maxit=20000), 
                    np=2000), silent=TRUE )
    if(is.null(H)){
      RE &lt;- data.frame(Code=uni.C[i], x0=NA, y0=NA, theta=NA,
               a=NA, k=NA, n1=NA, r.sq=NA, RSS=NA, N=NA)
    }
    if(!is.null(H)){
      RE     &lt;- data.frame(Code=uni.C[i], x0=H$par[1], y0=H$par[2], 
                  theta=H$par[3], a=H$par[4], k=H$par[5], n1=H$par[6],
                  r.sq=H$r.sq, RSS=H$RSS, N=H$sample.size)
      Length &lt;- c(Length, max(max(H$y.stand.pred)[1]-min(H$y.stand.pred)[1], 
                  max(H$x.stand.pred)[1]-min(H$x.stand.pred)[1])[1])
      if(i == 1){
        plot(H$x.obs, H$y.obs, asp=1, xlim=c(7.4, 8.6), ylim=c(7.4, 8.6),
             cex.lab=1.5, cex.axis=1.5, type="l", lwd=2, col="grey70",
             xlab=expression(italic(x)), ylab=expression(italic(y)))
        lines(H$x.pred, H$y.pred, col=2)         
      } 
      if(i &gt; 1){
        lines(H$x.obs, H$y.obs, lwd=2, col="grey70")
        lines(H$x.pred, H$y.pred, col=2)   
      }
      
    }
    results &lt;- rbind(results, RE)
  }

  # To adjust the estimates of partial parameters to ensure k &lt;= 1
  results2            &lt;- results
  Ind                 &lt;- results$k &gt; 1
  results2$theta[Ind] &lt;- results$theta[Ind] + pi/2
  results2$a[Ind]     &lt;- results$a[Ind] * results$k[Ind]^(1/results$n1[Ind])
  results2$k[Ind]     &lt;- 1/results$k[Ind] 
  results2
  Length/2

  

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
