<!DOCTYPE html><html><head><title>Help for package ewp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ewp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#coef.ewp'><p>Extract coefficients</p></a></li>
<li><a href='#dewp3'><p>Probability mass function of the three-parameter EWP</p></a></li>
<li><a href='#dewp3_cpp'><p>Probability mass function of the three-parameter EWP</p></a></li>
<li><a href='#ewp_reg'><p>Exponentially weighted Poisson regression model</p></a></li>
<li><a href='#fitted.ewp'><p>Extract fitted values</p></a></li>
<li><a href='#linnet'><p>Linnet clutch sizes</p></a></li>
<li><a href='#logLik.ewp'><p>Extract log likelihood</p></a></li>
<li><a href='#predict.ewp'><p>Predict from fitted model</p></a></li>
<li><a href='#print.ewp'><p>Print ewp model object</p></a></li>
<li><a href='#print.summary.ewp'><p>Print ewp model summary</p></a></li>
<li><a href='#rewp3'><p>Random samples from the three-parameter EWP</p></a></li>
<li><a href='#simulate.ewp'><p>simulate from fitted model</p></a></li>
<li><a href='#summary.ewp'><p>Model summary</p></a></li>
<li><a href='#vcov.ewp'><p>Extract estimated variance-covariance matrix</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>An Empirical Model for Underdispersed Count Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Count regression models for underdispersed small counts (lambda &lt; 20) based on the three-parameter exponentially weighted Poisson distribution of Ridout &amp; Besbeas (2004) &lt;<a href="https://doi.org/10.1191%2F1471082X04st064oa">doi:10.1191/1471082X04st064oa</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH, Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>covr, DHARMa, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-25 15:01:44 UTC; philipp.boerschsupan</td>
</tr>
<tr>
<td>Author:</td>
<td>Philipp Boersch-Supan
    <a href="https://orcid.org/0000-0001-6723-6833"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre],
  James Clarke <a href="https://orcid.org/0000-0003-1826-2060"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Philipp Boersch-Supan &lt;pboesu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-26 12:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='coef.ewp'>Extract coefficients</h2><span id='topic+coef.ewp'></span>

<h3>Description</h3>

<p>Extract coefficients
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
coef(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="coef.ewp_+3A_object">object</code></td>
<td>
<p>an object of class ewp</p>
</td></tr>
<tr><td><code id="coef.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of coefficient values. Beware that the lambda parameters are on the log-link scale, whereas the betas are estimated using an identity link.
</p>

<hr>
<h2 id='dewp3'>Probability mass function of the three-parameter EWP</h2><span id='topic+dewp3'></span>

<h3>Description</h3>

<p>Probability mass function of the three-parameter EWP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dewp3(x, lambda, beta1, beta2, sum_limit = max(x) * 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dewp3_+3A_x">x</code></td>
<td>
<p>vector of (positive integer) quantiles.</p>
</td></tr>
<tr><td><code id="dewp3_+3A_lambda">lambda</code></td>
<td>
<p>centrality parameter</p>
</td></tr>
<tr><td><code id="dewp3_+3A_beta1">beta1</code></td>
<td>
<p>lower-tail dispersion parameter</p>
</td></tr>
<tr><td><code id="dewp3_+3A_beta2">beta2</code></td>
<td>
<p>upper tail dispersion parameter</p>
</td></tr>
<tr><td><code id="dewp3_+3A_sum_limit">sum_limit</code></td>
<td>
<p>summation limit for the normalizing factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of probabilities
</p>

<hr>
<h2 id='dewp3_cpp'>Probability mass function of the three-parameter EWP</h2><span id='topic+dewp3_cpp'></span>

<h3>Description</h3>

<p>Probability mass function of the three-parameter EWP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dewp3_cpp(x, lambda, beta1, beta2, sum_limit)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dewp3_cpp_+3A_x">x</code></td>
<td>
<p>vector of (positive integer) quantiles.</p>
</td></tr>
<tr><td><code id="dewp3_cpp_+3A_lambda">lambda</code></td>
<td>
<p>centrality parameter</p>
</td></tr>
<tr><td><code id="dewp3_cpp_+3A_beta1">beta1</code></td>
<td>
<p>lower-tail dispersion parameter</p>
</td></tr>
<tr><td><code id="dewp3_cpp_+3A_beta2">beta2</code></td>
<td>
<p>upper tail dispersion parameter</p>
</td></tr>
<tr><td><code id="dewp3_cpp_+3A_sum_limit">sum_limit</code></td>
<td>
<p>summation limit for the normalizing factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a probability mass
</p>

<hr>
<h2 id='ewp_reg'>Exponentially weighted Poisson regression model</h2><span id='topic+ewp_reg'></span>

<h3>Description</h3>

<p>Exponentially weighted Poisson regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ewp_reg(
  formula,
  family = "ewp3",
  data,
  verbose = TRUE,
  method = "Nelder-Mead",
  hessian = TRUE,
  autoscale = TRUE,
  maxiter = 5000,
  sum_limit = round(max(Y) * 3)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ewp_reg_+3A_formula">formula</code></td>
<td>
<p>an object of class &quot;formula&quot; (or one that can be coerced to that class): a symbolic description of the model to be fitted.</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_family">family</code></td>
<td>
<p>choice of &quot;ewp2&quot; or &quot;ewp3&quot;</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables in the model.</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_verbose">verbose</code></td>
<td>
<p>logical, defaults to TRUE; print model fitting progress</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_method">method</code></td>
<td>
<p>string, passed to optim, defaults to 'BFGS'</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_hessian">hessian</code></td>
<td>
<p>logical, defaults to TRUE; calculate Hessian?</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_autoscale">autoscale</code></td>
<td>
<p>logical, defaults to TRUE; automatically scale model parameters inside the optimisation routine based on initial estimates from a Poisson regression.</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_maxiter">maxiter</code></td>
<td>
<p>numeric, maximum number of iterations for optim</p>
</td></tr>
<tr><td><code id="ewp_reg_+3A_sum_limit">sum_limit</code></td>
<td>
<p>numeric, defaults to 3*maximum count; upper limit for the sum used for the normalizing factor.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an ewp model
</p>

<hr>
<h2 id='fitted.ewp'>Extract fitted values</h2><span id='topic+fitted.ewp'></span>

<h3>Description</h3>

<p>Extract fitted values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
fitted(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitted.ewp_+3A_object">object</code></td>
<td>
<p>an object of class ewp</p>
</td></tr>
<tr><td><code id="fitted.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of fitted values on the response scale
</p>

<hr>
<h2 id='linnet'>Linnet clutch sizes</h2><span id='topic+linnet'></span>

<h3>Description</h3>

<p>A dataset containing the clutch sizes for linnet, recreated from Ridout &amp; Besbeas 2004
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linnet
</code></pre>


<h3>Format</h3>

<p>A data frame with 5414 rows and 3 variables:
</p>

<dl>
<dt>eggs</dt><dd><p>clutch size</p>
</dd>
<dt>cov1</dt><dd><p>a synthetic random noise covariate</p>
</dd>
<dt>cov2</dt><dd><p>a synthetic covariate that is positively correlated with the outcome</p>
</dd>
</dl>



<h3>Source</h3>

<p>Ridout &amp; Besbeas 2004, P. Boersch-Supan
</p>

<hr>
<h2 id='logLik.ewp'>Extract log likelihood</h2><span id='topic+logLik.ewp'></span>

<h3>Description</h3>

<p>Extract log likelihood
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.ewp_+3A_object">object</code></td>
<td>
<p>an object of class ewp</p>
</td></tr>
<tr><td><code id="logLik.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a numeric
</p>

<hr>
<h2 id='predict.ewp'>Predict from fitted model</h2><span id='topic+predict.ewp'></span>

<h3>Description</h3>

<p>Predict from fitted model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
predict(object, newdata, type = c("response"), na.action = na.pass, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.ewp_+3A_object">object</code></td>
<td>
<p>ewp model object</p>
</td></tr>
<tr><td><code id="predict.ewp_+3A_newdata">newdata</code></td>
<td>
<p>optional data.frame</p>
</td></tr>
<tr><td><code id="predict.ewp_+3A_type">type</code></td>
<td>
<p>character; default=&quot;response&quot;, no other type implemented</p>
</td></tr>
<tr><td><code id="predict.ewp_+3A_na.action">na.action</code></td>
<td>
<p>defaults to na.pass()</p>
</td></tr>
<tr><td><code id="predict.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a vector of predictions
</p>

<hr>
<h2 id='print.ewp'>Print ewp model object</h2><span id='topic+print.ewp'></span>

<h3>Description</h3>

<p>Print ewp model object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.ewp_+3A_x">x</code></td>
<td>
<p>ewp model object</p>
</td></tr>
<tr><td><code id="print.ewp_+3A_digits">digits</code></td>
<td>
<p>digits to print</p>
</td></tr>
<tr><td><code id="print.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a summary printout of the ewp model call and fitted coefficients.
</p>

<hr>
<h2 id='print.summary.ewp'>Print ewp model summary</h2><span id='topic+print.summary.ewp'></span>

<h3>Description</h3>

<p>Print ewp model summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.ewp'
print(x, digits = max(3, getOption("digits") - 3), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.ewp_+3A_x">x</code></td>
<td>
<p>ewp model summary</p>
</td></tr>
<tr><td><code id="print.summary.ewp_+3A_digits">digits</code></td>
<td>
<p>number of digits to print</p>
</td></tr>
<tr><td><code id="print.summary.ewp_+3A_...">...</code></td>
<td>
<p>additional arguments to printCoefmat()</p>
</td></tr>
</table>


<h3>Value</h3>

<p>printout of the summary object
</p>

<hr>
<h2 id='rewp3'>Random samples from the three-parameter EWP</h2><span id='topic+rewp3'></span>

<h3>Description</h3>

<p>Random samples from the three-parameter EWP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rewp3(n, lambda, beta1, beta2, sum_limit = 30)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rewp3_+3A_n">n</code></td>
<td>
<p>number of observations</p>
</td></tr>
<tr><td><code id="rewp3_+3A_lambda">lambda</code></td>
<td>
<p>centrality parameter</p>
</td></tr>
<tr><td><code id="rewp3_+3A_beta1">beta1</code></td>
<td>
<p>lower-tail dispersion parameter</p>
</td></tr>
<tr><td><code id="rewp3_+3A_beta2">beta2</code></td>
<td>
<p>upper tail dispersion parameter</p>
</td></tr>
<tr><td><code id="rewp3_+3A_sum_limit">sum_limit</code></td>
<td>
<p>summation limit for the normalizing factor</p>
</td></tr>
</table>


<h3>Value</h3>

<p>random deviates from the EWP_3 distribution
</p>

<hr>
<h2 id='simulate.ewp'>simulate from fitted model</h2><span id='topic+simulate.ewp'></span>

<h3>Description</h3>

<p>simulate from fitted model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
simulate(object, nsim = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.ewp_+3A_object">object</code></td>
<td>
<p>ewp model object</p>
</td></tr>
<tr><td><code id="simulate.ewp_+3A_nsim">nsim</code></td>
<td>
<p>number of response vectors to simulate. Defaults to 1.</p>
</td></tr>
<tr><td><code id="simulate.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with 'nsim' columns.
</p>

<hr>
<h2 id='summary.ewp'>Model summary</h2><span id='topic+summary.ewp'></span>

<h3>Description</h3>

<p>Model summary
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.ewp_+3A_object">object</code></td>
<td>
<p>ewp model fit</p>
</td></tr>
<tr><td><code id="summary.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function 'summary.ewp' computes and returns a list of summary statistics of the fitted ewp model.
</p>

<hr>
<h2 id='vcov.ewp'>Extract estimated variance-covariance matrix</h2><span id='topic+vcov.ewp'></span>

<h3>Description</h3>

<p>Extract estimated variance-covariance matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ewp'
vcov(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vcov.ewp_+3A_object">object</code></td>
<td>
<p>an object of class ewp</p>
</td></tr>
<tr><td><code id="vcov.ewp_+3A_...">...</code></td>
<td>
<p>ignored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
