<!DOCTYPE html><html><head><title>Help for package mccmeiv</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mccmeiv}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#matcdata'>
<p>A sample dataset representing matched case control data.</p></a></li>
<li><a href='#matcdatamult'>
<p>A sample dataset representing matched case control data. Similar to matcdata except with multiple</p>
stratification/instrumental/miscellaneous variables.</a></li>
<li><a href='#mccmeiv-package'>
<p>Analysis of Matched Case Control Data with a Mismeasured Exposure that is Accompanied</p>
by Instrumental Variables</a></li>
<li><a href='#meivm3'>
<p>Two-step methodology for estimating parameters for a matched case control design with a mismeasured exposure using instrumental variables</p></a></li>
<li><a href='#meivm4'>
<p>Efficient procedure for estimating parameters for a matched case control design with a mismeasured exposure using instrumental variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Matched Case Control Data with a Mismeasured
Exposure that is Accompanied by Instrumental Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-02-07</td>
</tr>
<tr>
<td>Author:</td>
<td>Chris M Manuel, Samiran Sinha, and Suojin Wang</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chris M Manuel &lt;cmmanuel@stat.tamu.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Applying the methodology from Manuel et al. to estimate parameters using a matched 
    case control data with a mismeasured exposure variable that is accompanied by 
    instrumental variables (Submitted). </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, survival, MASS</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-02-07 20:52:27 UTC; Chris Matt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-02-11 08:50:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='matcdata'>
A sample dataset representing matched case control data.  
</h2><span id='topic+matcdata'></span>

<h3>Description</h3>

<p>An example data set with 1 binary response (y), 1 stratification variable (sv), 
1 mismeasured binary exposure (w), 1 prognostic factor (z),
and 1 instrumental variable (xs) for use with the meivm3 or meivm4 functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(matcdata)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+meivm3">meivm3</a></code>
<code><a href="#topic+meivm4">meivm4</a></code>
<code><a href="#topic+matcdatamult">matcdatamult</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(matcdata)
out1=with(matcdata,meivm4(y=y,sv=sv,xs=xs,w=w,z=z,alpha=0.1))
</code></pre>

<hr>
<h2 id='matcdatamult'>
A sample dataset representing matched case control data. Similar to matcdata except with multiple 
stratification/instrumental/miscellaneous variables.
</h2><span id='topic+matcdatamult'></span>

<h3>Description</h3>

<p>An example data set with 1 binary response (y), 2 stratification variable (sv1 and sv2), 
1 mismeasured binary exposure (w),  2 prognostic factors (z1 and z2),
and 2 instruments (xs1 and xs2) for use with the meivm3 or meivm4 functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(matcdatamult)
</code></pre>


<h3>See Also</h3>

<p><code><a href="#topic+meivm3">meivm3</a></code>
<code><a href="#topic+meivm4">meivm4</a></code>
<code><a href="#topic+matcdata">matcdata</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(matcdatamult)
out=with(matcdatamult,meivm3(y=y, sv=sv1,xs=xs1, w=w,z=cbind(z1,z2)))
</code></pre>

<hr>
<h2 id='mccmeiv-package'>
Analysis of Matched Case Control Data with a Mismeasured Exposure that is Accompanied
by Instrumental Variables
</h2><span id='topic+mccmeiv-package'></span><span id='topic+mccmeiv'></span>

<h3>Description</h3>


<p>This package implements the methodology found in Manuel et al. to estimate parameters of a logistic model using data from a matched case control design with a mismeasured exposure variable with the help of instrumental variables.
</p>


<h3>Author(s)</h3>

<p>Chris M Manuel, Samiran Sinha, and Suojin Wang
</p>
<p>Maintainer: Chris M Manuel &lt;cmmanuel@stat.tamu.edu&gt;
</p>


<h3>References</h3>

<p>Manuel, CM, Sinha, S and  Wang, S. Matched case-control data with a misclassified exposure: 
What can be done with instrumental variables? (Submitted).
</p>

<hr>
<h2 id='meivm3'>
Two-step methodology for estimating parameters for a matched case control design with a mismeasured exposure using instrumental variables 
</h2><span id='topic+meivm3'></span>

<h3>Description</h3>

<p>Applies the two-step methodology from Manuel et al. to estimate parameters of a logistic model using matched case 
control data with a mismeasured exposure variable that is accompanied by a set of instrumental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meivm3(y, sv, xs, w, z, sv.factor = NULL, xs.factor = NULL, z.factor = NULL, 
alpha = 0.05, scale = TRUE, setalpha0.to.0 = FALSE, setalpha1.to.0 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meivm3_+3A_y">y</code></td>
<td>

<p>A vector of the response variable, representing case (y=1) or control (y=0) for each observation. For a 1:M matched case-control dataset with n matched sets, y will be a vector of length N=nx(1+M), and it is y=rep( c(1, rep(0, M)), n).
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_sv">sv</code></td>
<td>

<p>A data frame or matrix of confounding variables used for matching each case with the control(s). This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_xs">xs</code></td>
<td>

<p>A data frame or matrix of instrumental variables used as proxies for the mismeasured variable. This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_w">w</code></td>
<td>

<p>A vector of the mismeasured binary exposure variables for each observation. The length of this vector must be N.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_z">z</code></td>
<td>

<p>A data frame or matrix of prognostic factors used to study the association between the response and the mismeasured exposure. This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_sv.factor">sv.factor</code></td>
<td>

<p>Specify whether any stratification variables are categorical by using the name of the column(s).  For example if there is a factor variable in the user specified data frame sv, which is labeled as &quot;Political Affiliation&quot;, then sv.factor=&quot;Political Affiliation&quot;. Alternatively if there are two factor variables in sv labeled as &quot;Political Affiliation&quot; and &quot;SES&quot;, then sv.factor=c(&quot;Political Affiliation&quot;,&quot;SES&quot;). Any stratification variable that is numeric binary does not need to be declared as a factor.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_xs.factor">xs.factor</code></td>
<td>

<p>Specify whether any instrumental variables are categorical by using the name of the column(s). For example if there is an instrument in the user specified xs, which is labeled as &quot;Race of Mother&quot;, then xs.factor=&quot;Race of Mother&quot;. Alternatively if there are two factor variables in xs variable labeled as &quot;Race of Mother&quot; and &quot;Race of Mother&quot;, then xs.factor=c(&quot;Race of Mother&quot;,&quot;Race of Father&quot;). Any instrumental variable that is numeric binary does not need to be declared as a factor. 
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_z.factor">z.factor</code></td>
<td>

<p>Specify whether any prognostic variables are categorical by using the name of the column(s).  For example, if there is a factor variable in the user specified z labeled &quot;Season&quot;, then z.factor=&quot;Season&quot;. Alternatively if there are two factor variables in z labeled &quot;Season&quot; and a factor variable labeled Ethnicity , then z.factor=c(&quot;Season&quot;,&quot;Ethnicity&quot;). Any variable that is numeric binary does not need to be declared as a factor.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_alpha">alpha</code></td>
<td>

<p>Specify the level of significance for calculating the (1-alpha)100% Wald confidence intervals of the odds ratio parameter. For example, the default alpha=0.05 generates a 95% confidence interval of the odds ratio.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_scale">scale</code></td>
<td>

<p>By default, all non factors/numeric variables (those that are not specified as either response, mismeasured covariate, or factors specified in xs.factor / sv.factor / z.factor) are automatically scaled and centered unless the user sets scale=FALSE. Moreover, no numeric binary variables are scaled. 
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_setalpha0.to.0">setalpha0.to.0</code></td>
<td>

<p>Sets the misclassification probability Pr(W=1|X=0,Y=0) = Pr(W=1|X=0,Y=1) to 0 so that it is not estimated. By default this set to FALSE. Note that this option and setalpha1.to.0 cannot be both set to TRUE simultaneously.
</p>
</td></tr>
<tr><td><code id="meivm3_+3A_setalpha1.to.0">setalpha1.to.0</code></td>
<td>

<p>Sets the misclassification probability Pr(W=0|X=1,Y=0) = Pr(W=0|X=1,Y=1) to 0 so that it is not estimated. By default this is set to FALSE. Note that this option and setalpha0.to.0 cannot be both set to TRUE simultaneously.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the parameters is done in two steps. In the first step the set of parameters gamma used to model the probability of true exposure status X,
Pr(X=1|SV,XS,Y=0), and the parameters eta0 and eta1 used to model the misclassification probabilities alpha.0 = Pr(W=1|X=0,Y=0) = Pr(W=1|X=0,Y=1)
and alpha.1 = Pr(W=0|X=1,Y=0) = Pr(W=0|X=1,Y=1) are estimated. This information is then used in the second step to calculate  Pr(Y=1|SV,XS,Z). The solution is found via the optim function, using the &quot;L-BFGS-B&quot; method. For the first step, 
the starting values come from a logistic regression of W on the instruments, confounders, and prognostic factors. The starting values for eta 0 and eta 1 are set to 0.
Finally, the starting values for the second step use the naive beta estimates. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>two.step.results</code></td>
<td>
<p>Provides estimates for the beta parameters of the logistic model for the response y using the two step instrumental variable analysis. 
Standard errors, p-values, and the (1-alpha)100% Wald confidence intervals for exp(beta) are also included in the output.</p>
</td></tr>
<tr><td><code>naive.results</code></td>
<td>
<p>Provides estimates for the beta parameters of the logistic model for the response y using the naive approach. 
Standard errors, p-values, and the (1-alpha)100% Wald confidence intervals for exp(beta) are also included in the output.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris M. Manuel, Samiran Sinha, and Suojin Wang  
</p>


<h3>References</h3>

<p>Manuel, CM,  Sinha, S, and Wang, S. Matched case-control data with a misclassified exposure: What can be done with instrumental variables? (Submitted)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meivm4">meivm4</a></code>
<code><a href="#topic+matcdata">matcdata</a></code>
<code><a href="#topic+matcdatamult">matcdatamult</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(matcdata)
out=with(matcdata,meivm3(y=y,sv=sv,xs=xs,w=w,z=z,alpha=0.05))
#For running data with multiple confounders/instruments/prognostic factors see 'matcdatamult'.
</code></pre>

<hr>
<h2 id='meivm4'>
Efficient procedure for estimating parameters for a matched case control design with a mismeasured exposure using instrumental variables 
</h2><span id='topic+meivm4'></span>

<h3>Description</h3>

<p>Apply the efficient procedure from Manuel et al. to estimate parameters of a logistic model for matched case control data with a mismeasured exposure 
that is accompanied by a set of instrumental variables.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meivm4(y, sv, xs, w, z, sv.factor = NULL, xs.factor = NULL, z.factor = NULL, 
alpha = 0.05, scale = TRUE, setalpha0.to.0 = FALSE, setalpha1.to.0 = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="meivm4_+3A_y">y</code></td>
<td>

<p>A vector of the response variable, representing case (y=1) or control (y=0) for each observation. For a 1:M matched case-control dataset with n matched sets, y will be a vector of length N=nx(1+M), and it is y=rep( c(1, rep(0, M)), n).
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_sv">sv</code></td>
<td>

<p>A data frame or matrix of confounding variables used for matching each case with the control(s). This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_xs">xs</code></td>
<td>

<p>A data frame or matrix of instrumental variables used as proxies for the mismeasured variable. This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_w">w</code></td>
<td>

<p>A vector of the mismeasured binary exposure variables for each observation. The length of this vector must be N.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_z">z</code></td>
<td>

<p>A data frame or matrix of prognostic factors used to study the association between the response and the mismeasured exposure. This data frame should have N number of rows.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_sv.factor">sv.factor</code></td>
<td>

<p>Specify whether any stratification variables are categorical by using the name of the column(s).  For example if there is a factor variable in the user specified data frame sv, which is labeled as &quot;Political Affiliation&quot;, then sv.factor=&quot;Political Affiliation&quot;. Alternatively if there are two factor variables in sv labeled as &quot;Political Affiliation&quot; and &quot;SES&quot;, then sv.factor=c(&quot;Political Affiliation&quot;,&quot;SES&quot;). Any stratification variable that is numeric binary does not need to be declared as a factor.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_xs.factor">xs.factor</code></td>
<td>

<p>Specify whether any instrumental variables are categorical by using the name of the column(s). For example if there is an instrument in the user specified xs, which is labeled as &quot;Race of Mother&quot;, then xs.factor=&quot;Race of Mother&quot;. Alternatively if there are two factor variables in xs variable labeled as &quot;Race of Mother&quot; and &quot;Race of Mother&quot;, then xs.factor=c(&quot;Race of Mother&quot;,&quot;Race of Father&quot;). Any instrumental variable that is numeric binary does not need to be declared as a factor. 
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_z.factor">z.factor</code></td>
<td>

<p>Specify whether any prognostic variables are categorical by using the name of the column(s).  For example, if there is a factor variable in the user specified z labeled &quot;Season&quot;, then z.factor=&quot;Season&quot;. Alternatively if there are two factor variables in z labeled &quot;Season&quot; and a factor variable labeled Ethnicity , then z.factor=c(&quot;Season&quot;,&quot;Ethnicity&quot;). Any variable that is numeric binary does not need to be declared as a factor.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_alpha">alpha</code></td>
<td>

<p>Specify the level of significance for calculating the (1-alpha)100% Wald confidence intervals of the odds ratio parameter. For example, the default alpha=0.05 generates a 95% confidence interval of the odds ratio.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_scale">scale</code></td>
<td>

<p>By default, all non factors/numeric variables (those that are not specified as either response, mismeasured covariate, or factors specified in xs.factor / sv.factor / z.factor) are automatically scaled and centered unless the user sets scale=FALSE. Moreover, no numeric binary variables are scaled. 
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_setalpha0.to.0">setalpha0.to.0</code></td>
<td>

<p>Sets the misclassification probability Pr(W=1|X=0,Y=0) = Pr(W=1|X=0,Y=1) to 0 so that it is not estimated. By default this set to FALSE. Note that this option and setalpha1.to.0 cannot be both set to TRUE simultaneously.
</p>
</td></tr>
<tr><td><code id="meivm4_+3A_setalpha1.to.0">setalpha1.to.0</code></td>
<td>

<p>Sets the misclassification probability Pr(W=0|X=1,Y=0) = Pr(W=0|X=1,Y=1) to 0 so that it is not estimated. By default this is set to FALSE. Note that this option and setalpha0.to.0 cannot be both set to TRUE simultaneously.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In comparison to the methodology used in the function meivm3, the efficient estimation approach estimates the parameters in one step. These parameters include gamma used to model the probability of true exposure status X,
Pr(X=1|SV,XS,Y=0), the parameters eta0 and eta1 used to model the misclassification probabilities alpha.0 = Pr(W=1|X=0,Y=0) = Pr(W=1|X=0,Y=1) and alpha.1 = Pr(W=0|X=1,Y=0) = Pr(W=0|X=1,Y=1), and the beta parameters used in modeling Pr(Y=1|SV,XS,Z). The solution is found via the optim function, using the &quot;L-BFGS-B&quot; method.  
The starting values for gamma come from a logistic regression of W on the instruments, confounders, and prognostic factors. The starting values for eta 0 and eta 1 are set to 0, and the starting values for beta are the naive estimates. 
</p>


<h3>Value</h3>

<table>
<tr><td><code>efficient.results</code></td>
<td>
<p>Provides estimates for the beta parameters of the logistic model for the response y using the efficient estimator approach. 
Standard errors, p-values, and the (1-alpha)100% Wald confidence interval for exp(beta) are also included in the output.</p>
</td></tr>
<tr><td><code>naive.results</code></td>
<td>
<p>Provides estimates for the beta parameters of the logistic model for the response y using the naive approach. 
Standard errors, p-values, and the (1-alpha)100% Wald confidence intervals for exp(beta) are also included in the output.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Chris M. Manuel, Samiran Sinha, and Suojin Wang
</p>


<h3>References</h3>

<p>Manuel, CM, Sinha, S, and Wang, S. Matched case-control data with a misclassified exposure: 
What can be done with instrumental variables? (Submitted)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+meivm3">meivm3</a></code>
<code><a href="#topic+matcdata">matcdata</a></code>
<code><a href="#topic+matcdatamult">matcdatamult</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(matcdata)
out2=with(matcdata,meivm4(y=y,sv=sv,xs=xs,w=w,z=z,alpha=0.01))
#For running data with multiple confounders/instruments/prognostic factors see 'matcdatamult'.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
