<!DOCTYPE html><html lang="en"><head><title>Help for package rlmDataDriven</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {rlmDataDriven}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#DD-internal'><p>Internal Functions</p></a></li>
<li><a href='#plasma'><p>plasma</p></a></li>
<li><a href='#rlmDD'>
<p>Data driven robust methods</p></a></li>
<li><a href='#rlmDD_het'>
<p>Robust estimation for autoregressive models with heterogeneity</p></a></li>
<li><a href='#whm'>
<p>Weighted M-estimation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Regression with Data Driven Tuning Parameter</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.0</td>
</tr>
<tr>
<td>Author:</td>
<td>You-Gan Wang, Benoit Liquet, Aurelien Callens and Na Wang.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>You-Gan Wang &lt;you-gan.wang@qut.edu.au&gt;</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, MASS, tseries</td>
</tr>
<tr>
<td>Description:</td>
<td>Data driven approach for robust regression estimation in homoscedastic and heteroscedastic context. See Wang et al. (2007), &lt;<a href="https://doi.org/10.1198%2F106186007X180156">doi:10.1198/106186007X180156</a>&gt; regarding homoscedastic framework.  </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2.0)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-10-03 07:16:41 UTC; aurelien</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-10-03 09:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='DD-internal'>Internal Functions</h2><span id='topic+eff'></span><span id='topic+ESL_O'></span><span id='topic+rho.h'></span><span id='topic+rho.b'></span><span id='topic+rho.e'></span><span id='topic+psi.Huber'></span><span id='topic+dpsi.Huber'></span><span id='topic+psi.Tukey'></span><span id='topic+dpsi.Tukey'></span><span id='topic+psi.Exp'></span><span id='topic+dpsi.Exp'></span><span id='topic+chi'></span><span id='topic+create_lag'></span>

<h3>Description</h3>

<p>Internal functions not to be used by the user.
</p>

<hr>
<h2 id='plasma'>plasma</h2><span id='topic+plasma'></span>

<h3>Description</h3>

<p>The data are collected from 273 female patients.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plasma</code></pre>


<h3>Format</h3>

<p>This data frame contains the following columns:
</p>

<dl>
<dt>y</dt><dd><p>plasma beta-carotene</p>
</dd>
<dt>calories</dt><dd><p>calories in KJ</p>
</dd>
<dt>dietary</dt><dd><p>dietary beta-carotene</p>
</dd>
</dl>



<h3>Source</h3>

<p>Jiang, Y., Wang, Y-G., Fu, L., &amp; Wang, X. (2018). Robust Estimation Using Modified Huber's Functions With New Tails. Technometrics, in press, see &lt;doi:10.1080/00401706.2018.1470037&gt;.
</p>

<hr>
<h2 id='rlmDD'>
Data driven robust methods
</h2><span id='topic+rlmDD'></span>

<h3>Description</h3>

<p>Robust estimation often relies on a dispersion function that is more slowly varying at large values than the squared function. However, the choice of tuning constant in dispersion
function may impact the estimation efficiency to a great extent. For a given family of dispersion functions, we suggest obtaining the &lsquo;best&rsquo; tuning constant from the data so that the asymptotic efficiency is maximized.
</p>
<p>This library provides a robust linear regression with a tuning parameter being automatically chosen  to provide the necessary resistance against outliers. The robust (loss) functions include the Huber, Tukey bisquare and the exponential loss.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlmDD(yy, xx, beta0, betaR, method, plot)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rlmDD_+3A_yy">yy</code></td>
<td>
<p>Vector representing the response variable
</p>
</td></tr>
<tr><td><code id="rlmDD_+3A_xx">xx</code></td>
<td>
<p>Design matrix of the covariates excluding the intercept in the first column
</p>
</td></tr>
<tr><td><code id="rlmDD_+3A_beta0">beta0</code></td>
<td>
<p>Initial parameter estimate using <code>lm</code>
</p>
</td></tr>
<tr><td><code id="rlmDD_+3A_betar">betaR</code></td>
<td>
<p>Robust estimate of beta with a fixed tuning constant using <code>rlm</code>
</p>
</td></tr>
<tr><td><code id="rlmDD_+3A_method">method</code></td>
<td>
<p>Huber, Bisquare or Exponential
</p>
</td></tr>
<tr><td><code id="rlmDD_+3A_plot">plot</code></td>
<td>
<p>&quot;Y&quot; gives a plot: the efficiency factor versus a range of tunning parameter values.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list including
</p>
<table role = "presentation">
<tr><td><code>esti</code></td>
<td>
<p> Value of the robust estimate</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p> Standard error of the robust estimate</p>
</td></tr>
<tr><td><code>tunning</code></td>
<td>
<p> Optimum tunning parameter</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p> R-squared value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>You-Gan Wang, Na Wang
</p>


<h3>References</h3>

<p>Wang, Y-G., Lin, X., Zhu, M., &amp; Bai, Z. (2007). Robust estimation using the Huber function with a data-dependent tuning constant. Journal of Computational and Graphical Statistics, 16(2), 468-481.
</p>
<p>Wang, X., Jiang, Y., Huang, M., &amp; Zhang, H. (2013).  Robust variable selection with exponential squared loss. Journal of the American Statistical Association, 108, 632-643.
</p>
<p>Wang, N., Wang, Y-G., Hu, S., Hu, Z. H., Xu, J., Tang, H., &amp; Jin, G. (2018). Robust Regression with Data-Dependent Regularization Parameters and Autoregressive Temporal Correlations. Environmental Modeling &amp; Assessment, in press.
</p>


<h3>See Also</h3>

<p><code>rlm</code> function from  package <code>MASS</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(stackloss)

LS &lt;- lm(stack.loss ~ stack.x)
RB &lt;- rlm(stack.loss ~ stack.x, psi = psi.huber, k = 1.345)
DD1 &lt;- rlmDD(stack.loss, stack.x, LS$coef, RB$coef, method = "Huber", 
plot = "Y")

LS &lt;- lm(stack.loss ~ stack.x)
RB &lt;- rlm(stack.loss ~ stack.x, psi = psi.bisquare, c = 4.685)
DD2 &lt;- rlmDD(stack.loss, stack.x, LS$coef, RB$coef, method = "Bisquare", 
plot = "Y")

LS &lt;- lm(stack.loss ~ stack.x)
RB &lt;- rlm(stack.loss ~ stack.x, psi = psi.huber, k = 1.345)
DD3 &lt;- rlmDD(stack.loss, stack.x, LS$coef, RB$coef, method = "Exponential",
plot = "Y")


## Plasma dataset


data(plasma)

y &lt;- plasma$y
x &lt;- cbind(plasma$calories, plasma$dietary)

LS &lt;- lm(y ~ x)
RB &lt;- rlm(y ~ x, psi = psi.huber, k = 1.345)
DD.h &lt;- rlmDD(y, x, LS$coef, RB$coef, method = "Huber", plot = "Y")

LS &lt;- lm(y ~ x)
RB &lt;- rlm(y ~ x, psi = psi.bisquare, c = 4.685)
DD.b &lt;- rlmDD(y, x, LS$coef, RB$coef, method = "Bisquare", plot = "Y")

LS &lt;- lm(y ~ x)
RB &lt;- rlm(y ~ x, psi = psi.huber, k = 1.345)
DD.e &lt;- rlmDD(y, x, LS$coef, RB$coef, method = "Exponential", plot = "Y")


</code></pre>

<hr>
<h2 id='rlmDD_het'>
Robust estimation for autoregressive models with heterogeneity
</h2><span id='topic+rlmDD_het'></span>

<h3>Description</h3>

<p>Performs robust regression for autoregressive models with heterogeneity. 
</p>
<p>First, a M-estimation is performed on the data assuming that the variance is constant. The residuals of this model are used to robustly estimate the variance parameter. Then, a weighted M-estimation with variance as weight is used to update the regression parameters. These steps are repeated for different values of tuning parameter. The best tuning parameter is the one which minimizes the variance of the estimator. 
</p>
<p>Finally, lagged term are built and added to the regression model therefore accounting for temporal correlations. The loss function used is Huber's function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rlmDD_het(yy, xx, var.function = c("power", "exponential"),
phi.par = TRUE, tuning.para = NULL, step = 0.1, n.lag = NULL,
print.summary = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rlmDD_het_+3A_yy">yy</code></td>
<td>
<p>Vector representing the response variable
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_xx">xx</code></td>
<td>
<p>Design matrix of the covariates (including the intercept)
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_var.function">var.function</code></td>
<td>
<p>Assumed function for the variance. &quot;<code>power</code>&quot; function corresponds to  <code class="reqn">\sqrt{Var}=\sigma=\phi|x^T \beta|^{\gamma}</code> and &quot;<code>exponential</code>&quot; to <code class="reqn">\sqrt{Var} = \sigma = \phi e^{\gamma |x^T \beta|}</code>.
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_phi.par">phi.par</code></td>
<td>
<p>If <code>TRUE</code>, the function estimate the phi parameter. If <code>FALSE</code>, phi is assumed equal to 1.
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_tuning.para">tuning.para</code></td>
<td>
<p>If <code>NULL</code>, the function will run the estimation procedure for a range of value between 0 and 3 and will select the tuning parameter that minimizes the variance of the estimates. The user can also indicate a value of tuning parameter: in this case the estimation procedure will be evaluated once with the selected value of the tuning parameter.  
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_step">step</code></td>
<td>
<p>Only works when <code>tuning.para = NULL</code>, indicates the increment of the tuning parameter sequence (between 0 and 3) tested by the function. It will determine the precision of the tuning parameter. Caution : a smaller value indicates a larger number of value tested, resulting in a longer computing time.
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_n.lag">n.lag</code></td>
<td>
<p>If <code>NULL</code>, a pAcf plot of the resiuduals will appear and you will have to indicate the number of lags the method has to include. The user can also give an integer corresponding to the number of lags desired.
</p>
</td></tr>
<tr><td><code id="rlmDD_het_+3A_print.summary">print.summary</code></td>
<td>
<p>If <code>TRUE</code>, prints a summary of the estimates.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list including
</p>
<table role = "presentation">
<tr><td><code>coefficients</code></td>
<td>
<p> Value of the robust estimates</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>Residuals of the model.</p>
</td></tr>
<tr><td><code>p_residuals</code></td>
<td>
<p>Pearson residuals of the model.</p>
</td></tr>
<tr><td><code>r_residuals</code></td>
<td>
<p>Robust pearson residuals of the model : <code class="reqn">\psi(p_residuals,c)</code></p>
</td></tr></table>
<p> with 
<code class="reqn">\psi</code> the derivative of the loss function and c the chosen tuning parameter.
</p>
<table role = "presentation">
<tr><td><code>fitted values</code></td>
<td>
<p>Fitted values obtained with the robust method</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>Variance-covariance matrix of the estimates</p>
</td></tr>
<tr><td><code>summary</code></td>
<td>
<p>Summary of the model including: values, standard errors and z-values of the estimates</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>Design matrix of the model</p>
</td></tr>
<tr><td><code>tuningpara</code></td>
<td>
<p>When <code>tuning.para = NULL</code>, list containing the optimal tuning parameter, all the values of tuning parameter tested and their associated variance obtained.</p>
</td></tr>
<tr><td><code>varpara</code></td>
<td>
<p>Estimates of the variance parameters</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aurelien Callens, You-Gan Wang, Benoit Liquet
</p>


<h3>References</h3>

<p>Callens, A., Wang, Y-G., Fu, L. &amp; Liquet, B. (2018). Robust estimation for autoregressive models with heterogeneity. Submitted.
</p>


<h3>See Also</h3>

<p><code>rlm</code> function from  package <code>MASS</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(tseries)
data(ice.river)
xx &lt;- model.matrix(flow.vat ~ prec + temp, data = ice.river)
yy &lt;- flow.jok

least_square &lt;- lm(flow.vat ~ prec + temp, data = ice.river)
pacf(least_square$residuals)
qqnorm(least_square$residuals)
qqline(least_square$residuals, col = "red", lwd = 2)

#With choice of optimal tuning parameter and 2 lags. 
#Note that if lag = NULL, a Pacf plot will appear to help you choose 
#the number of lags, you will need to input this number in the console. 

model_1 &lt;- rlmDD_het(yy, xx, var.function = "exponential", 
                                    tuning.para = NULL, n.lag = 2)

pacf(model_1$p_residuals)     
qqnorm(model_1$r_residuals)
qqline(model_1$r_residuals, col = "red", lwd = 2)

#For fixed number of lags and tuning parameter
model_2 &lt;- rlmDD_het(yy, xx, var.function = "exponential", 
                                  tuning.para = 1.345, n.lag = 2)



</code></pre>

<hr>
<h2 id='whm'>
Weighted M-estimation
</h2><span id='topic+whm'></span>

<h3>Description</h3>

<p>This function performs a weighted M-estimation described by Carroll and Ruppert (1982) with the Huber loss function. First, a M-estimation is performed on the data assuming that the variance is constant. The residuals of this model are used to robustly estimate the variance parameter. Then, a weighted M-estimation with variance as weight is used to update the regression parameters. These steps are iterated until desired convergence. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whm(yy, xx, var.function = "power", tuning.para = 1.345, ite = 5)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="whm_+3A_yy">yy</code></td>
<td>
<p>Vector representing the response variable
</p>
</td></tr>
<tr><td><code id="whm_+3A_xx">xx</code></td>
<td>
<p>Design matrix of the covariates including the intercept in the first column
</p>
</td></tr>
<tr><td><code id="whm_+3A_var.function">var.function</code></td>
<td>
<p>Assumed function for the variance. &quot;<code>power</code>&quot; function corresponds to  <code class="reqn">\sqrt(Var) = \sigma = \phi |x^T \beta|^{\gamma}</code> and &quot;<code>exponential</code>&quot; to <code class="reqn">\sqrt(Var) = \sigma = \phi e^{\gamma |x^T \beta|}</code>.
</p>
</td></tr>
<tr><td><code id="whm_+3A_tuning.para">tuning.para</code></td>
<td>
<p>Value of the tuning parameter associated with the loss function.  
</p>
</td></tr>
<tr><td><code id="whm_+3A_ite">ite</code></td>
<td>
<p>Number of iterations for the estimation procedure. 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a list including
</p>
<table role = "presentation">
<tr><td><code>esti</code></td>
<td>
<p> Value of the robust estimate</p>
</td></tr>
<tr><td><code>Std.Error</code></td>
<td>
<p> Standard error of the robust estimate</p>
</td></tr>
<tr><td><code>tunning</code></td>
<td>
<p> Optimum tunning parameter</p>
</td></tr>
<tr><td><code>R2</code></td>
<td>
<p> R-squared value</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Aurelien Callens, You-Gan Wang, Benoit Liquet.
</p>


<h3>References</h3>

<p>Carroll, R. J., &amp; Ruppert, D. (1982). Robust estimation in heteroscedastic linear models. The annals of statistics, 429-441.
</p>


<h3>See Also</h3>

<p><code>rlm</code> function from  package <code>MASS</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(MASS)
data(stackloss)

LS &lt;- lm(stack.loss ~ stack.x)
RB &lt;- rlm(stack.loss ~ stack.x, psi = psi.huber, k = 1.345)

yy &lt;- stack.loss 
xx &lt;- model.matrix(stack.loss ~ stack.x)

#With power function as variance function
WHM_p &lt;- whm(yy, xx, var.function = "power", tuning.para = 1.345)

#With exponential function as variance function
WHM_e &lt;- whm(yy, xx, var.function = "exponential", tuning.para = 1.345)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
