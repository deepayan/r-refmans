<!DOCTYPE html><html><head><title>Help for package ontoFAST</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ontoFAST}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#annot_all_chars'><p>Annotate all character statements with ontology terms</p></a></li>
<li><a href='#annot_char_grep'><p>Annotate a character statement with ontology terms</p></a></li>
<li><a href='#chars_per_term'><p>Get number of chracters per each ontology term</p></a></li>
<li><a href='#edges2list'><p>Convert edge matrix to list</p></a></li>
<li><a href='#exclude_terms'><p>Ontology terms to exclude for sunburst plot</p></a></li>
<li><a href='#export_annotations'><p>Export annotation data</p></a></li>
<li><a href='#export_cytoscape'><p>Export to Cytoscape format</p></a></li>
<li><a href='#get_ancestors_chars'><p>Get ancestal ontology terms for a set of characters</p></a></li>
<li><a href='#get_descendants_chars'><p>Get characters that descendants of selected ontology term</p></a></li>
<li><a href='#get_onto_id'><p>Get IDs for ontology names</p></a></li>
<li><a href='#get_onto_name'><p>Get names for ontology IDs</p></a></li>
<li><a href='#HAO'><p>Hymenoptera Anatomy Ontology (HAO)</p></a></li>
<li><a href='#list2edges'><p>Convert list to edge matrix</p></a></li>
<li><a href='#make_shiny_in'><p>Make an ontology object for visualization</p></a></li>
<li><a href='#onto_process'><p>Shortcut to process characters and ontology</p></a></li>
<li><a href='#paths_sunburst'><p>Return ontology paths for characters</p></a></li>
<li><a href='#runOntoFast'><p>Run ontoFAST interactively</p></a></li>
<li><a href='#Scarab'><p>A modified Hymenoptera Anatomy Ontology (HAO) to accommodate anatomy of dung beetles</p></a></li>
<li><a href='#Sharkey_2011'><p>Hymenoptera character statements</p></a></li>
<li><a href='#Sharkey_2011_annot'><p>Hymenoptera characters annotated with ontology terms</p></a></li>
<li><a href='#syn_extract'><p>Link synonyms with ontology terms</p></a></li>
<li><a href='#table2list'><p>Converts a table to list</p></a></li>
<li><a href='#Tarasov_2017_annot'><p>Dung beetle characters annotated with ontology terms</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interactive Annotation of Characters with Biological Ontologies</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Author:</td>
<td>Sergei Tarasov</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sergei Tarasov &lt;sergei.tarasov@helsinki.fi&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for annotating characters (character matrices) with anatomical and phenotype ontologies. Includes functions for visualising character annotations and creating simple queries using ontological relationships.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/sergeitarasov/ontoFAST">https://github.com/sergeitarasov/ontoFAST</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.2</td>
</tr>
<tr>
<td>Imports:</td>
<td>shinydashboard, pbapply, stringr, utils, stats, dplyr, plyr,
sunburstR, usethis</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5), shiny, ontologyIndex, visNetwork</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-28 10:01:20 UTC; taravser</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-29 07:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='annot_all_chars'>Annotate all character statements with ontology terms</h2><span id='topic+annot_all_chars'></span>

<h3>Description</h3>

<p>Matches character statement and returns most similar ontology terms using
grep and distance-based matching
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annot_all_chars(ontology, use.synonyms = TRUE, min_set = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annot_all_chars_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object with character names (ontology$name_characters) and ids (ontology$id_characters)</p>
</td></tr>
<tr><td><code id="annot_all_chars_+3A_use.synonyms">use.synonyms</code></td>
<td>
<p>using synonyms list during search. It has to be included in ontology,
see syn_extract()</p>
</td></tr>
<tr><td><code id="annot_all_chars_+3A_min_set">min_set</code></td>
<td>
<p>if TRUE eliminates higher order inferred ontology terms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list of matched ontology terms and their character ids.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#getting ontology
data(HAO)
data(Sharkey_2011)
ontology&lt;-HAO
#parsing synonyms
ontology$parsed_synonyms&lt;-syn_extract(HAO)
# reading in characters
char_et_states&lt;-Sharkey_2011
# embedding characters and character ids into ontology
id_characters&lt;-paste("CHAR:",c(1:392), sep="")
name_characters&lt;-char_et_states[,1]
names(name_characters)&lt;-id_characters
ontology$name_characters&lt;-name_characters
ontology$id_characters&lt;-id_characters
# running annotations

auto_annotations&lt;-annot_all_chars(ontology)

</code></pre>

<hr>
<h2 id='annot_char_grep'>Annotate a character statement with ontology terms</h2><span id='topic+annot_char_grep'></span>

<h3>Description</h3>

<p>Matches character statement and returns most similar ontology terms
</p>


<h3>Usage</h3>

<pre><code class='language-R'>annot_char_grep(ontology, char.statement, use.synonyms = TRUE, min_set = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="annot_char_grep_+3A_ontology">ontology</code></td>
<td>
<p>ontology.</p>
</td></tr>
<tr><td><code id="annot_char_grep_+3A_char.statement">char.statement</code></td>
<td>
<p>character statement</p>
</td></tr>
<tr><td><code id="annot_char_grep_+3A_use.synonyms">use.synonyms</code></td>
<td>
<p>if TRUE then the synonyms are used during search. The synonyms have to be included in the ontology using
syn_extract() function</p>
</td></tr>
<tr><td><code id="annot_char_grep_+3A_min_set">min_set</code></td>
<td>
<p>if TRUE eliminates higher order inferred ontology terms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of matches ontology terms.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
annot_char_grep(HAO, "Mola on right mandible")
</code></pre>

<hr>
<h2 id='chars_per_term'>Get number of chracters per each ontology term</h2><span id='topic+chars_per_term'></span>

<h3>Description</h3>

<p>Returns matrix summarizing  number of characters per each ontology terms in descending order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>chars_per_term(ontology, annotations = "auto")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="chars_per_term_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object with character annatotions included (ontology$annot_characters).</p>
</td></tr>
<tr><td><code id="chars_per_term_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any othe list element containing annotations can be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The matrix of ontology terms IDs, their names and character number.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
ontology&lt;-HAO
ontology$terms_selected_id&lt;-list(`CHAR:1`=c("HAO:0000653"), `CHAR:2`=c("HAO:0000653"))
chars_per_term(ontology, annotations="manual")
</code></pre>

<hr>
<h2 id='edges2list'>Convert edge matrix to list</h2><span id='topic+edges2list'></span>

<h3>Description</h3>

<p>Takes two-column edge matrix (columns from and two) and produces a list
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edges2list(edge.matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="edges2list_+3A_edge.matrix">edge.matrix</code></td>
<td>
<p>Two-column edge matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>annot_list&lt;-list(`CHAR:1`=c("HAO:0000933", "HAO:0000958"), `CHAR:2`=c("HAO:0000833", "HAO:0000258"))
edge.matrix&lt;-list2edges(annot_list)
edges2list(edge.matrix)
</code></pre>

<hr>
<h2 id='exclude_terms'>Ontology terms to exclude for sunburst plot</h2><span id='topic+exclude_terms'></span>

<h3>Description</h3>

<p>List of ontology terms from Hymenoptera Anatomy Ontology that can be considered
redundant and need to be excluded from some operations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exclude_terms
</code></pre>


<h3>Format</h3>

<p>List containing ontological terms.</p>


<h3>Examples</h3>

<pre><code class='language-R'>exclude_terms
</code></pre>

<hr>
<h2 id='export_annotations'>Export annotation data</h2><span id='topic+export_annotations'></span>

<h3>Description</h3>

<p>This function converts character annotations stored in shiny_in object to table format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_annotations(
  ontology,
  annotations = "auto",
  incl.names = FALSE,
  sep.head = ", ",
  sep.tail = NULL,
  collapse = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_annotations_+3A_ontology">ontology</code></td>
<td>
<p>Ontology</p>
</td></tr>
<tr><td><code id="export_annotations_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any othe list element containing annotations can be specified.</p>
</td></tr>
<tr><td><code id="export_annotations_+3A_incl.names">incl.names</code></td>
<td>
<p>if TRUE includes terms' names and IDs, otherwise includes just IDs.</p>
</td></tr>
<tr><td><code id="export_annotations_+3A_sep.head">sep.head</code></td>
<td>
<p>if incl.names=TRUE, this is a separator attached to the begining of term's ID</p>
</td></tr>
<tr><td><code id="export_annotations_+3A_sep.tail">sep.tail</code></td>
<td>
<p>if incl.names=TRUE, this is a separator attached to the end of term's ID</p>
</td></tr>
<tr><td><code id="export_annotations_+3A_collapse">collapse</code></td>
<td>
<p>if NULL all annotations of a term placed in separate columns, if a value is specified (e.g., &quot;; &quot;) then all anotations
are collapsed in one line given that values</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sharkey_2011)
data(HAO)
hao_obo&lt;-onto_process(HAO, Sharkey_2011[,1], do.annot = FALSE)
ontofast &lt;- new.env(parent = emptyenv())
ontofast$shiny_in &lt;- make_shiny_in(hao_obo)
# runOntoFast(is_a = c("is_a"), part_of = c("BFO:0000050"), shiny_in="shiny_in" )
tb&lt;-export_annotations(ontofast$shiny_in, annotations="manual", incl.names=TRUE,collapse="; ")
tb&lt;-export_annotations(ontofast$shiny_in, annotations="auto", incl.names=TRUE,collapse="; ")
tb&lt;-export_annotations(ontofast$shiny_in, annotations="auto", incl.names=TRUE,collapse=NULL)
# save annotations in csv
# write.csv(tb, "annotated_characters.csv")
</code></pre>

<hr>
<h2 id='export_cytoscape'>Export to Cytoscape format</h2><span id='topic+export_cytoscape'></span>

<h3>Description</h3>

<p>This function converts character annotations to Cytoscape format. It returns a table that can be saved as in csv format
and imported in Cytoscape. In Cytoscape choose File -&gt; Import -&gt; Network -&gt; File. Then assign columns to nodes and edges. Do not select
columns that enumerate the tables' rows!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>export_cytoscape(
  ontology,
  annotations = "auto",
  is_a = c("is_a"),
  part_of = c("BFO:0000050")
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="export_cytoscape_+3A_ontology">ontology</code></td>
<td>
<p>Ontology</p>
</td></tr>
<tr><td><code id="export_cytoscape_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any other list containing annotations can be specified.</p>
</td></tr>
<tr><td><code id="export_cytoscape_+3A_is_a">is_a</code></td>
<td>
<p>is_a</p>
</td></tr>
<tr><td><code id="export_cytoscape_+3A_part_of">part_of</code></td>
<td>
<p>part_of</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a table
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(HAO)
data(Sharkey_2011)
data(Sharkey_2011_annot)
ontology&lt;-HAO
# processing ontology to incorporate character statements
ontology&lt;-onto_process(ontology, Sharkey_2011[,1], do.annot = F)
# embedding manual annotations
ontology$annot_characters&lt;-Sharkey_2011_annot
# exporting
cyto&lt;-export_cytoscape(ontology, annotations = ontology$annot_characters,
is_a = c("is_a"), part_of = c("BFO:0000050"))
#write.csv(cyto, file="cyto.csv")

</code></pre>

<hr>
<h2 id='get_ancestors_chars'>Get ancestal ontology terms for a set of characters</h2><span id='topic+get_ancestors_chars'></span>

<h3>Description</h3>

<p>Returns all ontology terms which are ancestors of a given character set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_ancestors_chars(ontology, char_id, annotations = "auto")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_ancestors_chars_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object with character annatotions included (ontology$annot_characters).</p>
</td></tr>
<tr><td><code id="get_ancestors_chars_+3A_char_id">char_id</code></td>
<td>
<p>IDs of character.</p>
</td></tr>
<tr><td><code id="get_ancestors_chars_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any othe list element containing annotations can be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of ontology terms IDs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
ontology&lt;-HAO
ontology$terms_selected_id&lt;-list(`CHAR:1`=c("HAO:0000653"), `CHAR:2`=c("HAO:0000653"))
get_ancestors_chars(ontology, c("CHAR:1","CHAR:2"), annotations="manual")
</code></pre>

<hr>
<h2 id='get_descendants_chars'>Get characters that descendants of selected ontology term</h2><span id='topic+get_descendants_chars'></span>

<h3>Description</h3>

<p>Returns all characters located (associated) with given ontology term(s)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_descendants_chars(ontology, annotations = "auto", terms, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_descendants_chars_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object.</p>
</td></tr>
<tr><td><code id="get_descendants_chars_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any othe list element containing annotations can be specified.</p>
</td></tr>
<tr><td><code id="get_descendants_chars_+3A_terms">terms</code></td>
<td>
<p>IDs of ontology terms for which descendants are queried.</p>
</td></tr>
<tr><td><code id="get_descendants_chars_+3A_...">...</code></td>
<td>
<p>other parameters for ontologyIndex::get_descendants() function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The vector of character IDs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
ontology&lt;-HAO
ontology$terms_selected_id&lt;-list(`CHAR:1`=c("HAO:0000653"), `CHAR:2`=c("HAO:0000653"))
get_descendants_chars(ontology, annotations="manual", "HAO:0000653")
</code></pre>

<hr>
<h2 id='get_onto_id'>Get IDs for ontology names</h2><span id='topic+get_onto_id'></span>

<h3>Description</h3>

<p>Returns IDs of ontology terms given terms' names
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_onto_id(vec_name, ontology, names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_onto_id_+3A_vec_name">vec_name</code></td>
<td>
<p>names od terms</p>
</td></tr>
<tr><td><code id="get_onto_id_+3A_ontology">ontology</code></td>
<td>
<p>ontology</p>
</td></tr>
<tr><td><code id="get_onto_id_+3A_names">names</code></td>
<td>
<p>use element name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of IDs.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
vec_name=c("ventral mesofurco-profurcal muscle", "anatomical entity")
get_onto_id(vec_name, HAO)
</code></pre>

<hr>
<h2 id='get_onto_name'>Get names for ontology IDs</h2><span id='topic+get_onto_name'></span>

<h3>Description</h3>

<p>Returns names of ontology terms for ontology IDs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_onto_name(vec, onto, names = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_onto_name_+3A_vec">vec</code></td>
<td>
<p>ID or a vector of IDs</p>
</td></tr>
<tr><td><code id="get_onto_name_+3A_onto">onto</code></td>
<td>
<p>ontology</p>
</td></tr>
<tr><td><code id="get_onto_name_+3A_names">names</code></td>
<td>
<p>use element name</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
get_onto_name("HAO:0002272", HAO)
</code></pre>

<hr>
<h2 id='HAO'>Hymenoptera Anatomy Ontology (HAO)</h2><span id='topic+HAO'></span>

<h3>Description</h3>

<p>Anatomy ontology of Hymenoptera. This ontology was imported into R using get_OBO() function from ontologyIndex package (see the examples).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>HAO
</code></pre>


<h3>Format</h3>

<p>List containing various ontological relationships and terms.</p>


<h3>References</h3>

<p>Yoder MJ, Mikó I, Seltmann KC, Bertone MA, Deans AR. 2010. A Gross Anatomy Ontology for Hymenoptera. PLoS ONE 5 (12): e15991.
(<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0015991">Read</a>)
</p>
<p><a href="http://portal.hymao.org/projects/32/public/ontology/">Hymenoptera Anatomy Ontology Portal</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
# you can also parse the original .obo file
get_OBO(system.file("data_onto", "HAO.obo", package = "ontoFAST"),
extract_tags="everything", propagate_relationships = c("BFO:0000050", "is_a"))
</code></pre>

<hr>
<h2 id='list2edges'>Convert list to edge matrix</h2><span id='topic+list2edges'></span>

<h3>Description</h3>

<p>Takes a list of character annotations and creates an edge matrix comprising two columns: from and to.
The list to table conversion can be done using ldply function from plyr package: plyr::ldply(list, rbind).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list2edges(annotated.char.list, col_order_inverse = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="list2edges_+3A_annotated.char.list">annotated.char.list</code></td>
<td>
<p>Character list with ontology annotations.</p>
</td></tr>
<tr><td><code id="list2edges_+3A_col_order_inverse">col_order_inverse</code></td>
<td>
<p>The default creates the first columns consisting if character IDs and the second columns consisting of ontology annatotaions.
The inverse order changes the columns order.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two-column matrix.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>annot_list&lt;-list(`CHAR:1`=c("HAO:0000933", "HAO:0000958"), `CHAR:2`=c("HAO:0000833", "HAO:0000258"))
list2edges(annot_list)
# use plyr package and run
plyr::ldply(annot_list, rbind)
</code></pre>

<hr>
<h2 id='make_shiny_in'>Make an ontology object for visualization</h2><span id='topic+make_shiny_in'></span>

<h3>Description</h3>

<p>Make an ontology object for visualization in a separate environment &quot;ontofast&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>make_shiny_in(ontology)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="make_shiny_in_+3A_ontology">ontology</code></td>
<td>
<p>Ontology</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Ontology index object named as shiny_in.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sharkey_2011)
data(HAO)
hao_obo&lt;-onto_process(HAO, Sharkey_2011[,1], do.annot = FALSE)
ontofast &lt;- new.env(parent = emptyenv())
ontofast$shiny_in &lt;- make_shiny_in(hao_obo)
runOntoFast(is_a = c("is_a"), part_of = c("BFO:0000050"), shiny_in="shiny_in" )
</code></pre>

<hr>
<h2 id='onto_process'>Shortcut to process characters and ontology</h2><span id='topic+onto_process'></span>

<h3>Description</h3>

<p>This is a shortcut function to make characters and ontology suitable for visualization using ontoFAST interactive tools.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>onto_process(ontology, name_characters, do.annot = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="onto_process_+3A_ontology">ontology</code></td>
<td>
<p>Ontology</p>
</td></tr>
<tr><td><code id="onto_process_+3A_name_characters">name_characters</code></td>
<td>
<p>a vector of character names</p>
</td></tr>
<tr><td><code id="onto_process_+3A_do.annot">do.annot</code></td>
<td>
<p>specifiees if you need to run automatic annotations or not</p>
</td></tr>
<tr><td><code id="onto_process_+3A_...">...</code></td>
<td>
<p>other arguments for annot_all_chars() function</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Ontology index object named
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sharkey_2011)
data(HAO)
hao_obo&lt;-onto_process(HAO, Sharkey_2011[,1], do.annot = FALSE)
ontofast &lt;- new.env(parent = emptyenv())
ontofast$shiny_in &lt;- make_shiny_in(hao_obo)
runOntoFast(is_a = c("is_a"), part_of = c("BFO:0000050"), shiny_in="shiny_in" )
</code></pre>

<hr>
<h2 id='paths_sunburst'>Return ontology paths for characters</h2><span id='topic+paths_sunburst'></span>

<h3>Description</h3>

<p>Returns ontology paths for all characters. These paths can be used to create a sunburst plot of
ontological dependencies.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paths_sunburst(
  ontology,
  annotations = "auto",
  exclude.terms = NULL,
  include.terms = NULL,
  use.chars = TRUE,
  sep = "-"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paths_sunburst_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object with character annatotions included.</p>
</td></tr>
<tr><td><code id="paths_sunburst_+3A_annotations">annotations</code></td>
<td>
<p>which annotations to use: &quot;auto&quot; means automatic annotations, &quot;manual&quot; means manual ones.
Alternatively, any othe list element containing annotations can be specified.</p>
</td></tr>
<tr><td><code id="paths_sunburst_+3A_exclude.terms">exclude.terms</code></td>
<td>
<p>list of terms to exclude</p>
</td></tr>
<tr><td><code id="paths_sunburst_+3A_include.terms">include.terms</code></td>
<td>
<p>list of terms to include</p>
</td></tr>
<tr><td><code id="paths_sunburst_+3A_use.chars">use.chars</code></td>
<td>
<p>indicate whether character ids should be included in output</p>
</td></tr>
<tr><td><code id="paths_sunburst_+3A_sep">sep</code></td>
<td>
<p>separator used to delimit ontology terms</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Table.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ontology_partof=get_OBO(system.file("data_onto", "HAO.obo", package = "ontoFAST"),
extract_tags="everything", propagate_relationships = c("BFO:0000050"))
ontology_partof&lt;-onto_process(ontology_partof, Sharkey_2011[,1], do.annot = F)
ontology_partof$annot_characters&lt;-Sharkey_2011_annot
tb&lt;-paths_sunburst(ontology_partof,
annotations = ontology_partof$annot_characters, exclude.terms=exclude_terms)
# library(sunburst)
sunburst(tb)

</code></pre>

<hr>
<h2 id='runOntoFast'>Run ontoFAST interactively</h2><span id='topic+runOntoFast'></span>

<h3>Description</h3>

<p>This function runs ontoFAST in interactive mode. Interactive mode allows character annotation and navigation through ontology network.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runOntoFast(
  is_a = c("is_a"),
  part_of = c("BFO:0000050"),
  nchar = "all",
  show.chars = TRUE,
  shiny_in = "shiny_in",
  file2save = "OntoFAST_shiny_in.RData",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runOntoFast_+3A_is_a">is_a</code></td>
<td>
<p>term for is_a relationships</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_part_of">part_of</code></td>
<td>
<p>term for part_of relationships</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_nchar">nchar</code></td>
<td>
<p>number of characters to show</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_show.chars">show.chars</code></td>
<td>
<p>shows character statements</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_shiny_in">shiny_in</code></td>
<td>
<p>a name of ontology (shiny_in) object in &quot;ontofast&quot; enviroment</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_file2save">file2save</code></td>
<td>
<p>a name of the file to which shiny_in object is saved in interactive mode</p>
</td></tr>
<tr><td><code id="runOntoFast_+3A_...">...</code></td>
<td>
<p>other arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>runs ontoFAST interactively using Shiny.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sharkey_2011)
data(HAO)
hao_obo&lt;-onto_process(HAO, Sharkey_2011[,1], do.annot = FALSE)
ontofast &lt;- new.env(parent = emptyenv())
ontofast$shiny_in &lt;- make_shiny_in(hao_obo)
runOntoFast(is_a = c("is_a"), part_of = c("BFO:0000050"), shiny_in="shiny_in" )
</code></pre>

<hr>
<h2 id='Scarab'>A modified Hymenoptera Anatomy Ontology (HAO) to accommodate anatomy of dung beetles</h2><span id='topic+Scarab'></span>

<h3>Description</h3>

<p>Anatomy ontology of Hymenoptera + Dung beetles. This ontology was imported into R using get_OBO() function from ontologyIndex packages (see the examples). The added terms for dung beetle anatomy have prefix &quot;SCR&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Scarab
</code></pre>


<h3>Format</h3>

<p>List containing various ontological relationships and terms.</p>


<h3>References</h3>

<p>Yoder MJ, Mikó I, Seltmann KC, Bertone MA, Deans AR. 2010. A Gross Anatomy Ontology for Hymenoptera. PLoS ONE 5 (12): e15991.
(<a href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0015991">Read</a>)
</p>
<p><a href="http://portal.hymao.org/projects/32/public/ontology/">Hymenoptera Anatomy Ontology Portal</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Scarab)
#you can also parse the original .obo file
get_OBO(system.file("data_onto", "HAO4scarabs.obo", package = "ontoFAST"),
extract_tags="everything", propagate_relationships = c("BFO:0000050", "is_a"))
</code></pre>

<hr>
<h2 id='Sharkey_2011'>Hymenoptera character statements</h2><span id='topic+Sharkey_2011'></span>

<h3>Description</h3>

<p>A table of characters and character states from
Hymenoptera character matrix (Sharkey et al., 2011: Cladistics). The table contains 392 character statements.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sharkey_2011
</code></pre>


<h3>Format</h3>

<p>A data table with 392 rows; each row is a character statement with character states:
</p>

<dl>
<dt>CHARACTER STATEMENTS:</dt><dd><p>Charater statements</p>
</dd>
<dt>STATES</dt><dd><p>sates of the character</p>
</dd>
<dt>STATES</dt><dd><p>....</p>
</dd>
</dl>


<h3>References</h3>

<p>Sharkey, M.J., et al. 2011. Phylogenetic relationships among superfamilies of Hymenoptera. Cladistics 28(1), 80-112.
(<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1096-0031.2011.00366.x">Read</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Sharkey_2011)
# read .csv file directly
char_et_states&lt;-read.csv(system.file("data_onto", "Sharkey_2011.csv",
package = "ontoFAST"), header=TRUE,  stringsAsFactors = FALSE, na.strings = "")
</code></pre>

<hr>
<h2 id='Sharkey_2011_annot'>Hymenoptera characters annotated with ontology terms</h2><span id='topic+Sharkey_2011_annot'></span>

<h3>Description</h3>

<p>List of character IDs and their ontology annotations. The characters are from Hymenoptera phylogeny (Sharkey et al., 2011: Cladistics).
The ontology annotations are from Hymenoptera Anatomy Ontology (HAO).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Sharkey_2011_annot
</code></pre>


<h3>Format</h3>

<p>List containing characters and ontology terms.</p>


<h3>References</h3>

<p>Sharkey, M.J., et al. 2011. Phylogenetic relationships among superfamilies of Hymenoptera. Cladistics 28(1), 80-112.
(<a href="https://onlinelibrary.wiley.com/doi/full/10.1111/j.1096-0031.2011.00366.x">Read</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Sharkey_2011_annot
</code></pre>

<hr>
<h2 id='syn_extract'>Link synonyms with ontology terms</h2><span id='topic+syn_extract'></span>

<h3>Description</h3>

<p>Extracts and parses synonyms from ontology to make them readable and searchable
</p>


<h3>Usage</h3>

<pre><code class='language-R'>syn_extract(ontology, list_id = "synonym")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="syn_extract_+3A_ontology">ontology</code></td>
<td>
<p>ontology_index object.</p>
</td></tr>
<tr><td><code id="syn_extract_+3A_list_id">list_id</code></td>
<td>
<p>ID of list where synonyms are stored</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector of ontology IDs and synonym names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(HAO)
syn_extract(HAO)
</code></pre>

<hr>
<h2 id='table2list'>Converts a table to list</h2><span id='topic+table2list'></span>

<h3>Description</h3>

<p>Takes a table where each row consists of character ID + an ontology annotation and returns a list.
Each character is assigned its own ID CHAR:XXXX
</p>


<h3>Usage</h3>

<pre><code class='language-R'>table2list(table, id_col = c(1), descendants_cols = c(2:ncol(table)))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="table2list_+3A_table">table</code></td>
<td>
<p>A character table with annotations.</p>
</td></tr>
<tr><td><code id="table2list_+3A_id_col">id_col</code></td>
<td>
<p>A column ID corresponding to character</p>
</td></tr>
<tr><td><code id="table2list_+3A_descendants_cols">descendants_cols</code></td>
<td>
<p>IDs of columns corresponding to character annotations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># converting Sharkey_2011 dataset to list of character states
table2list(Sharkey_2011)
</code></pre>

<hr>
<h2 id='Tarasov_2017_annot'>Dung beetle characters annotated with ontology terms</h2><span id='topic+Tarasov_2017_annot'></span>

<h3>Description</h3>

<p>List of character IDs and their ontology annotations. All 232 characters are from Scarabaeinae phylogeny (Tarasov, 2017: Zootaxa).
The ontology annotations are from a modified version Hymenoptera Anatomy Ontology (HAO) that was enriched with additional terms (SCR:) to accommodate anatomy of the dung beetles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Tarasov_2017_annot
</code></pre>


<h3>Format</h3>

<p>List containing characters and ontology terms.</p>


<h3>References</h3>

<p>Tarasov, S., 2017. A cybertaxonomic revision of the new dung beetle tribe Parachoriini (Coleoptera: Scarabaeidae: Scarabaeinae) and its phylogenetic assessment using molecular and morphological data. Zootaxa, 4329(2), pp.101-149.
(<a href="https://www.mapress.com/j/zt/article/view/zootaxa.4329.2.1">Read</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>Tarasov_2017_annot
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
