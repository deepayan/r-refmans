<!DOCTYPE html><html lang="en"><head><title>Help for package mlergm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mlergm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#classes'><p>Polish school classes data set.</p></a></li>
<li><a href='#gof.mlergm'><p>Evaluate the goodness-of-fit of an estimated model.</p></a></li>
<li><a href='#is.gof_mlergm'><p>Check if object is of class <code>gof_mlergm</code></p></a></li>
<li><a href='#is.inCHv3.9'><p>Determine whether a vector is in the closure of the convex hull of some</p>
sample of vectors</a></li>
<li><a href='#is.mlergm'><p>Check if the object is of class <code>mlergm</code></p></a></li>
<li><a href='#is.mlnet'><p>Check if object is of class <code>mlnet</code></p></a></li>
<li><a href='#mlergm'><p>Multilevel Exponential-Family Random Graph Models</p></a></li>
<li><a href='#mlnet'><p>Multilevel Network</p></a></li>
<li><a href='#plot.gof_mlergm'><p>Plot goodness-of-fit results</p></a></li>
<li><a href='#print.gof_mlergm'><p>Print summary of a <code>gof_mlergm</code> object.</p></a></li>
<li><a href='#set_options'><p>Set and adjust options and settings.</p></a></li>
<li><a href='#simulate_mlnet'><p>Simulate a multilevel network</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Multilevel Exponential-Family Random Graph Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.8</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimates exponential-family random graph models for multilevel network data, assuming the multilevel structure is observed. The scope, at present, covers multilevel models where the set of nodes is nested within known blocks. The estimation method uses Monte-Carlo maximum likelihood estimation (MCMLE) methods to estimate a variety of canonical or curved exponential family models for binary random graphs. MCMLE methods for curved exponential-family random graph models can be found in Hunter and Handcock (2006) &lt;<a href="https://doi.org/10.1198%2F106186006X133069">doi:10.1198/106186006X133069</a>&gt;. The package supports parallel computing, and provides methods for assessing goodness-of-fit of models and visualization of networks. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0), ergm (&ge; 3.10.1), network (&ge; 1.15)</td>
</tr>
<tr>
<td>Imports:</td>
<td>parallel, Matrix, stringr, stats, GGally, ggplot2, cowplot,
reshape2, plyr, methods, graphics, lpSolve, sna (&ge; 2.4)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RColorBrewer, knitr, rmarkdown</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-08-23 10:49:59 UTC; jstew</td>
</tr>
<tr>
<td>Author:</td>
<td>Jonathan Stewart [cre, aut],
  Michael Schweinberger [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jonathan Stewart &lt;jrstewart@fsu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-08-23 16:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='classes'>Polish school classes data set.</h2><span id='topic+classes'></span>

<h3>Description</h3>

<p>The Polish school classes data set <code>classes</code> is a subset of a larger data set which was generated as part of a Polish study on adolescent youth. The network data, obtained via a nomination processes, results in a binary, directed random graph where a directed edge from i to j indicates that student i nominated student j as a playmate. A further description of the data as well as a demonstration of an analysis with curved ERGMs can be found in Stewart, Schweinberger, Bojanowski, and Morris (2018).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(classes)
</code></pre>


<h3>Format</h3>

<p>An <code>mlnet</code> object.
</p>


<h3>Details</h3>

<p>A dataset containing network data for 9 school classes as part of a Polish educational study. 
The nodes of the network are students with nodal covariate <code>sex</code> and known
class membership of the students.
</p>


<h3>References</h3>

<p>Dolata, R. (ed). (2014). 
Czy szkoła ma znaczenie? Zróżnicowanie wyników nauczania po pierwszym etapie edukacyjnym oraz jego pozaszkolne i szkolne uwarunkowania. 
Vol. 1. Warsaw: Instytut Badań Edukacyjnych.
</p>
<p>Dolata, R. and Rycielski, P. (2014). 
Wprowadzenie: założenia i cele badania szkolnych uwarunkowań efektywności kształcenia SUEK.
</p>
<p>Stewart, J., Schweinberger, M., Bojanowski, M., and M. Morris (2019).
Multilevel network data facilitate statistical inference for curved ERGMs with geometrically weighted terms.
Social Networks, to appear.
</p>

<hr>
<h2 id='gof.mlergm'>Evaluate the goodness-of-fit of an estimated model.</h2><span id='topic+gof.mlergm'></span>

<h3>Description</h3>

<p>Performs a Goodness-of-Fit procedure along the lines of 
Hunter, Goodreau, and Handcock (2008). Statistics are simulated 
from an fitted <code>mlergm</code> object, which can then be plotted and visualized.  
An example is given in the documentation of <code><a href="#topic+mlergm">mlergm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlergm'
gof(object, ..., options = set_options(), seed = NULL, gof_form = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gof.mlergm_+3A_object">object</code></td>
<td>
<p>An object of class <code><a href="#topic+mlergm">mlergm</a></code>, likely produced by function <code><a href="#topic+mlergm">mlergm</a></code>.</p>
</td></tr>
<tr><td><code id="gof.mlergm_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed if necessary.</p>
</td></tr>
<tr><td><code id="gof.mlergm_+3A_options">options</code></td>
<td>
<p>See <code><a href="#topic+set_options">set_options</a></code> for details.</p>
</td></tr>
<tr><td><code id="gof.mlergm_+3A_seed">seed</code></td>
<td>
<p>A seed to be provided to ensure reproducibility of results.</p>
</td></tr>
<tr><td><code id="gof.mlergm_+3A_gof_form">gof_form</code></td>
<td>
<p>A formula object of the form <code>~ term1 + term2 + ...</code> for statistics to compute for the GOF procedure.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+gof.mlergm">gof.mlergm</a></code> returns an object of class <code>gof_mlergm</code> which is a list containing:
</p>
<table role = "presentation">
<tr><td><code>obs_stats</code></td>
<td>
<p>The GOF statistic values of the observed network.</p>
</td></tr>
<tr><td><code>gof_stats</code></td>
<td>
<p>The GOF statistic values simulated from the the estimated <code>mlergm</code> objeect provided.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Hunter, D. R.,  Goodreau, S. M., and Handcock, M. S. (2008). 
Goodness of fit of social network models. 
Journal of the American Statistical Association, 103(481), 248-258.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.gof_mlergm">plot.gof_mlergm</a></code>
</p>

<hr>
<h2 id='is.gof_mlergm'>Check if object is of class <code>gof_mlergm</code></h2><span id='topic+is.gof_mlergm'></span>

<h3>Description</h3>

<p>Function checks if a provided object is of class <code>gof_mlergm</code> (see <code><a href="#topic+gof.mlergm">gof.mlergm</a></code> for details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.gof_mlergm(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.gof_mlergm_+3A_x">x</code></td>
<td>
<p>An object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the provided object <code>x</code> is of class <code>gof_mlergm</code>, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlergm">mlergm</a></code>, <code><a href="#topic+gof.mlergm">gof.mlergm</a></code>
</p>

<hr>
<h2 id='is.inCHv3.9'>Determine whether a vector is in the closure of the convex hull of some
sample of vectors</h2><span id='topic+is.inCHv3.9'></span>

<h3>Description</h3>

<p><code>is.inCH</code> returns <code>TRUE</code> if and only if <code>p</code> is contained in
the convex hull of the points given as the rows of <code>M</code>. If <code>p</code> is
a matrix, each row is tested individually, and <code>TRUE</code> is returned if
all rows are in the convex hull.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.inCHv3.9(p, M, verbose = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.inCHv3.9_+3A_p">p</code></td>
<td>
<p>A <code class="reqn">d</code>-dimensional vector or a matrix with <code class="reqn">d</code> columns</p>
</td></tr>
<tr><td><code id="is.inCHv3.9_+3A_m">M</code></td>
<td>
<p>An <code class="reqn">r</code> by <code class="reqn">d</code> matrix.  Each row of <code>M</code> is a
<code class="reqn">d</code>-dimensional vector.</p>
</td></tr>
<tr><td><code id="is.inCHv3.9_+3A_verbose">verbose</code></td>
<td>
<p>A logical vector indicating whether to print progress</p>
</td></tr>
<tr><td><code id="is.inCHv3.9_+3A_...">...</code></td>
<td>
<p>arguments passed directly to linear program solver</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code class="reqn">d</code>-vector <code>p</code> is in the convex hull of the <code class="reqn">d</code>-vectors
forming the rows of <code>M</code> if and only if there exists no separating
hyperplane between <code>p</code> and the rows of <code>M</code>.  This condition may be
reworded as follows:
</p>
<p>Letting <code class="reqn">q=(1 p')'</code> and <code class="reqn">L = (1 M)</code>, if the maximum value of
<code class="reqn">z'q</code> for all <code class="reqn">z</code> such that <code class="reqn">z'L \le 0</code> equals zero (the maximum
must be at least zero since z=0 gives zero), then there is no separating
hyperplane and so <code>p</code> is contained in the convex hull of the rows of
<code>M</code>.  So the question of interest becomes a constrained optimization
problem.
</p>
<p>Solving this problem relies on the package <code>lpSolve</code> to solve a linear
program.  We may put the program in &quot;standard form&quot; by writing <code class="reqn">z=a-b</code>,
where <code class="reqn">a</code> and <code class="reqn">b</code> are nonnegative vectors.  If we write <code class="reqn">x=(a'
b')'</code>, we obtain the linear program given by:
</p>
<p>Minimize <code class="reqn">(-q' q')x</code> subject to <code class="reqn">x'(L -L) \le 0</code> and <code class="reqn">x \ge 0</code>.
One additional constraint arises because whenever any strictly negative
value of <code class="reqn">(-q' q')x</code> may be achieved, doubling <code class="reqn">x</code> arbitrarily many
times makes this value arbitrarily large in the negative direction, so no
minimizer exists.  Therefore, we add the constraint <code class="reqn">(q' -q')x \le 1</code>.
</p>
<p>This function is used in the &quot;stepping&quot; algorithm of Hummel et al (2012).
</p>


<h3>Value</h3>

<p>Logical, telling whether <code>p</code> is (or all rows of <code>p</code> are)
in the closed convex hull of the points in <code>M</code>.
</p>


<h3>References</h3>

 
<ul>
<li><p> Hummel, R. M., Hunter, D. R., and Handcock, M. S. (2012), Improving
Simulation-Based Algorithms for Fitting ERGMs, Journal of Computational and
Graphical Statistics, 21: 920-939. </p>
</li></ul>


<hr>
<h2 id='is.mlergm'>Check if the object is of class <code>mlergm</code></h2><span id='topic+is.mlergm'></span>

<h3>Description</h3>

<p>Function checks if a provided object is of class <code>mlergm</code> (see <code><a href="#topic+mlergm">mlergm</a></code> for details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.mlergm(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.mlergm_+3A_x">x</code></td>
<td>
<p>An objected to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the provided object <code>x</code> is of class <code>mlergm</code>, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlergm">mlergm</a></code>
</p>

<hr>
<h2 id='is.mlnet'>Check if object is of class <code>mlnet</code></h2><span id='topic+is.mlnet'></span>

<h3>Description</h3>

<p>Function checks if a provided object is of class <code>mlnet</code> (see <code><a href="#topic+mlnet">mlnet</a></code> for details).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.mlnet(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="is.mlnet_+3A_x">x</code></td>
<td>
<p>An object to be checked.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the provided object <code>x</code> is of class <code>mlnet</code>, <code>FALSE</code> otherwise.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mlnet">mlnet</a></code>
</p>

<hr>
<h2 id='mlergm'>Multilevel Exponential-Family Random Graph Models</h2><span id='topic+mlergm'></span><span id='topic+print.mlergm'></span><span id='topic+summary.mlergm'></span>

<h3>Description</h3>

<p>This function estimates an exponential-family random graph model for multilevel network data. At present, <code>mlergm</code> covers network data where the set of nodes is nested within known blocks (see, e.g., Schweinberger and Handcock, 2015). An example is groups of students nested within classrooms, which is covered in the <code><a href="#topic+classes">classes</a></code> data set. It is assumed that the node membership, that to which block each node is associated, is known (or has been previously estimated).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlergm(
  form,
  node_memb,
  parameterization = "standard",
  options = set_options(),
  theta_init = NULL,
  verbose = 0,
  eval_loglik = TRUE,
  seed = NULL
)

## S3 method for class 'mlergm'
print(x, ...)

## S3 method for class 'mlergm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlergm_+3A_form">form</code></td>
<td>
<p>Formula of the form:  <code>network ~ term1 + term2 + ...</code>; allowable model terms are a subset of those in R package ergm,
see <code><a href="ergm.html#topic+ergm.terms">ergm.terms</a></code>.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_node_memb">node_memb</code></td>
<td>
<p>Vector (length equal to the number of nodes in the network) indicating to which  block or group the nodes belong.
If the network provided in <code>form</code> is an object of class <code>mlnet</code>, 
then <code>node_memb</code> can be exctracted directly from the network and need not be provided.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_parameterization">parameterization</code></td>
<td>
<p>Parameterization options include 'standard', 'offset', or 'size'. 
</p>

<ul>
<li><p> 'standard' : Does not adjust the individual block parameters for size. 
</p>
</li>
<li><p> 'offset' : The offset parameterization uses edge and mutual offsets along the lines of Krivitsky, Handcock, and Morris (2011) and Krivitsky and Kolaczyk (2015). The edge parameter is offset by <code class="reqn">-log n(k)</code> and the mutual parameter is offset by <code class="reqn">+log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.  
</p>
</li>
<li><p> 'size' : Multiplies the block parameters by <code class="reqn">log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.
</p>
</li></ul>
</td></tr>
<tr><td><code id="mlergm_+3A_options">options</code></td>
<td>
<p>See <code><a href="#topic+set_options">set_options</a></code> for details.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_theta_init">theta_init</code></td>
<td>
<p>Parameter vector of initial estimates for theta to be used.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_verbose">verbose</code></td>
<td>
<p>Controls the level of output. A value of <code>0</code> corresponds to no output, except for warnings; a value of <code>1</code> corresponds to minimal output, and a value of <code>2</code> corresponds to full output.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_eval_loglik">eval_loglik</code></td>
<td>
<p>(Logical <code>TRUE</code> or <code>FALSE</code>) If set to <code>TRUE</code>, the bridge estimation procedure of Hunter and Handcock (2006) is used to estimate the loglikelihood for BIC calculations, otherwise the loglikelihood and therefore the BIC is not estimated.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_seed">seed</code></td>
<td>
<p>For reproducibility, an integer-valued seed may be specified.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_x">x</code></td>
<td>
<p>An object of class <code>mlergm</code>, probably produced by <code><a href="#topic+mlergm">mlergm</a></code>.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed if necessary.</p>
</td></tr>
<tr><td><code id="mlergm_+3A_object">object</code></td>
<td>
<p>An object of class <code>mlergm</code>, probably produced by <code><a href="#topic+mlergm">mlergm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation procedures performs Monte-Carlo maximum likelihood for the specified ERGM using a version of the Fisher scoring method detailed by Hunter and Handcock (2006). Settings governing the MCMC procedure (such as <code>burnin</code>, <code>interval</code>, and <code>sample_size</code>) as well as more general settings for the estimation procedure can be adjusted through <code><a href="#topic+set_options">set_options</a></code>. The estimation procedure uses the the stepping algorithm of Hummel, et al., (2012) for added stability.
</p>


<h3>Value</h3>

<p><code><a href="#topic+mlergm">mlergm</a></code> returns an object of class <code><a href="#topic+mlergm">mlergm</a></code> which is a list containing:
</p>
<table role = "presentation">
<tr><td><code>theta</code></td>
<td>
<p>Estimated parameter vector of the exponential-family random graph model.</p>
</td></tr>
<tr><td><code>between_theta</code></td>
<td>
<p>Estimated parameter vector of the between group model.</p>
</td></tr>
<tr><td><code>se</code></td>
<td>
<p>Standard error vector for theta.</p>
</td></tr>
<tr><td><code>between_se</code></td>
<td>
<p>Standard error vector for between_theta.</p>
</td></tr>
<tr><td><code>pvalue</code></td>
<td>
<p>A vector of p-values for the estimated parameter vector.</p>
</td></tr>
<tr><td><code>between_pvalue</code></td>
<td>
<p>A vector of p-values for the estimated parameter vector.</p>
</td></tr>
<tr><td><code>logLikval</code></td>
<td>
<p>The loglikelihood for at the estimated MLE.</p>
</td></tr>
<tr><td><code>bic</code></td>
<td>
<p>The BIC for the estimated model.</p>
</td></tr> 
<tr><td><code>mcmc_chain</code></td>
<td>
<p>The MCMC sample used in the final estimation step, which can be used to diagnose non-convergence.</p>
</td></tr>
<tr><td><code>estimation_status</code></td>
<td>
<p>Indicator of whether the estimation procedure had <code>succcess</code> or <code>failed</code>.</p>
</td></tr>
<tr><td><code>parameterization</code></td>
<td>
<p>The model parameterization (either <code>standard</code> or <code>offset</code>).</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>
<p>The model formula.</p>
</td></tr>
<tr><td><code>network</code></td>
<td>
<p>The network for which the model is estimated.</p>
</td></tr>
<tr><td><code>node_memb</code></td>
<td>
<p>Vector indicating to which group or block the nodes belong.</p>
</td></tr>
<tr><td><code>size_quantiles</code></td>
<td>
<p>The quantiles of the block sizes.</p>
</td></tr>
</table>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>print</code>: Print method for objects of class <code><a href="#topic+mlergm">mlergm</a></code>. Indicates whether the model was succesfully estimated, as well as the model formula provided.
</p>
</li>
<li> <p><code>summary</code>: Prints a summary of the estimated <code>mlergm</code> model.
</p>
</li></ul>


<h3>References</h3>

<p>Schweinberger, M. and Stewart, J. (2019) 
Concentration and consistency results for canonical and curved exponential-family random graphs. 
The Annals of Statistics, to appear.
</p>
<p>Schweinberger, M. and Handcock, M. S. (2015).
Local dependence in random graph models: characterization, properties and statistical inference.
Journal of the Royal Statistical Society: Series B (Statistical Methodology), 77(3), 647-676.
</p>
<p>Hunter, D. R., and Handcock, M. S. (2006). 
Inference in curved exponential family models for networks. 
Journal of Computational and Graphical Statistics, 15(3), 565-583.
</p>
<p>Hummel, R. M., Hunter, D. R., and Handcock, M. S. (2012). 
Improving simulation-based algorithms for fitting ERGMs. 
Journal of Computational and Graphical Statistics, 21(4), 920-939.
</p>
<p>Krivitsky, P. N., Handcock, M. S., &amp; Morris, M. (2011). 
Adjusting for network size and composition effects in exponential-family random graph models. 
Statistical methodology, 8(4), 319-339.
</p>
<p>Krivitsky, P.N, and Kolaczyk, E. D. (2015). 
On the question of effective sample size in network modeling: An asymptotic inquiry. 
Statistical science: a review journal of the Institute of Mathematical Statistics, 30(2), 184.
</p>
<p>Hunter D., Handcock M., Butts C., Goodreau S., and Morris M. (2008).
ergm: A Package to Fit, Simulate and Diagnose Exponential-Family Models for Networks.
Journal of Statistical Software, 24(3), 1-29.
</p>
<p>Butts, C. (2016).
sna: Tools for Social Network Analysis.
R package version 2.4. <a href="https://CRAN.R-project.org/package=sna">https://CRAN.R-project.org/package=sna</a>.
</p>
<p>Butts, C. (2008).
network: a Package for Managing Relational Data in R.
Journal of Statistical Software, 24(2). 
</p>
<p>Stewart, J., Schweinberger, M., Bojanowski, M., and M. Morris (2019). 
Multilevel network data facilitate statistical inference for curved ERGMs with geometrically weighted terms. 
Social Networks, 59, 98-119.
</p>
<p>Schweinberger, M., Krivitsky, P. N., Butts, C.T. and J. Stewart (2018). 
Exponential-family models of random graphs: Inference in finite-, super-, and infinite-population scenarios. 
https://arxiv.org/abs/1707.04800
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gof.mlergm">gof.mlergm</a></code>, <code><a href="#topic+mlnet">mlnet</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
### Load the school classes data-set 
data(classes) 

# Estimate a curved multilevel ergm model with offset parameter 
# Approximate run time (2 cores): 1.2m, Run time (3 cores): 55s 
model_est &lt;- mlergm(classes ~ edges + mutual + nodematch("sex") +  gwesp(fixed = FALSE), 
                    seed = 123, 
                    options = set_options(number_cores = 2))

# To access a summary of the fitted model, call the 'summary' function 
summary(model_est)

# Goodness-of-fit can be run by calling the 'gof.mlergm' method 
# Approximate run time (2 cores): 48s, Run time (3 cores): 34s  
gof_res &lt;- gof(model_est, options = set_options(number_cores = 2))
plot(gof_res, cutoff = 15)
 
</code></pre>

<hr>
<h2 id='mlnet'>Multilevel Network</h2><span id='topic+mlnet'></span><span id='topic+plot.mlnet'></span>

<h3>Description</h3>

<p>Function creates a multilevel network object of class <code>mlnet</code>. The object inherits the <code><a href="network.html#topic+network">network</a></code> class, with additional information concerning the multilevel structure.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mlnet(network, node_memb, directed = FALSE)

## S3 method for class 'mlnet'
plot(
  x,
  node_size = 2.5,
  palette = NULL,
  memb_colors = NULL,
  arrow.gap = 0.015,
  arrow.size = 4,
  color_legend_title = "",
  legend = TRUE,
  legend.position = "right",
  layout_type = "kamadakawai",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mlnet_+3A_network">network</code></td>
<td>
<p>Either a <code><a href="network.html#topic+network">network</a></code> object, an adjacency matrix, or an edge list.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_node_memb">node_memb</code></td>
<td>
<p>Vector (length equal to the number of nodes in the network) indicating to which block or group the nodes belong.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_directed">directed</code></td>
<td>
<p>(<code>TRUE</code> or <code>FALSE</code>) Indicates whether the supplied network is directed or undirected. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_x">x</code></td>
<td>
<p>An object of class <code>mlnet</code>, possibly produced by <code><a href="#topic+mlnet">mlnet</a></code> or <code><a href="#topic+simulate_mlnet">simulate_mlnet</a></code>.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_node_size">node_size</code></td>
<td>
<p>Controls the size of nodes.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_palette">palette</code></td>
<td>
<p>If package <code>RColorBrewer</code> is installed, then the name of an R color brewer pallete can be specified and used for the block colors. See <code>brewer.pal</code> for details on RColorBrewer palletes.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_memb_colors">memb_colors</code></td>
<td>
<p>Specifies the named colors to be used for the membership colors.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_arrow.gap">arrow.gap</code></td>
<td>
<p>(Directed graphs only) Controls the amount of space between arrowheads and the nodes.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_arrow.size">arrow.size</code></td>
<td>
<p>(Directed graphs only) Controls the size of the arrowhead.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_color_legend_title">color_legend_title</code></td>
<td>
<p>Name for the node color legend title.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_legend">legend</code></td>
<td>
<p>(<code>TRUE</code> or <code>FALSE</code>) Controls whether the block membership legend is printed.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_legend.position">legend.position</code></td>
<td>
<p>The position of the legend in the plot. Defaults to the &quot;right&quot; position.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_layout_type">layout_type</code></td>
<td>
<p>Viable layout options. See <code>gplot.layout</code> for options.</p>
</td></tr>
<tr><td><code id="mlnet_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code><a href="GGally.html#topic+ggnet2">ggnet2</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>mlnet</code> function creates an object of class <code>mlnet</code> which is used to access methods designed specifically for multilevel networks, including visualization methods as well as direct interface with some of the main functions, such as <code><a href="#topic+mlergm">mlergm</a></code>. Presently, the <code>mlnet</code> function and object class cover multilevel structure where the set of nodes is nested within known block structure.
</p>


<h3>Value</h3>

<p><code>mlnet</code> returns an object of class <code>mlnet</code> which inherits the <code><a href="network.html#topic+network">network</a></code> class, with the additional vector attribute <code>node_memb</code>, which encodes the block membership of the multilevel netwrok.
</p>


<h3>Methods (by generic)</h3>


<ul>
<li> <p><code>plot</code>: Plots network objects of type <code>mlnet</code>.
</p>
</li></ul>


<h3>Examples</h3>

<pre><code class='language-R'> # Show how the sampson dataset can be turned into an mlnet object 
 data(sampson)
 net &lt;- mlnet(samplike, get.vertex.attribute(samplike, "group"))
</code></pre>

<hr>
<h2 id='plot.gof_mlergm'>Plot goodness-of-fit results</h2><span id='topic+plot.gof_mlergm'></span>

<h3>Description</h3>

<p>Produces goodness-of-fit plots for a <code>gof_mlergm</code> object in order to visualize and assess the fit of an estimated model produced by <code><a href="#topic+mlergm">mlergm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gof_mlergm'
plot(
  x,
  ...,
  individual_plots = FALSE,
  save_plots = FALSE,
  show_plots = TRUE,
  width = 8,
  height = 4.5,
  cutoff = NULL,
  x_labels = NULL,
  x_angle = 0,
  x_axis_label = NULL,
  y_axis_label = "Count",
  plot_title = "",
  title_size = 18,
  axis_label_size = 14,
  axis_size = 10,
  line_size = 1,
  x_axis_label_size = NULL,
  y_axis_label_size = NULL,
  x_axis_size = NULL,
  y_axis_size = NULL,
  pretty_x = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gof_mlergm_+3A_x">x</code></td>
<td>
<p>An object of class <code>gof_mlergm</code>, produced by <code><a href="#topic+gof.mlergm">gof.mlergm</a></code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_...">...</code></td>
<td>
<p>Additional argument to be passed if necessary.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_individual_plots">individual_plots</code></td>
<td>
<p>(Logical <code>TRUE</code> or <code>FALSE</code>) If <code>TRUE</code>, individual gof plots are produced. Defaults to 
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_save_plots">save_plots</code></td>
<td>
<p>(Logical <code>TRUE</code> or <code>FALSE</code>) If <code>TRUE</code>, the individual GOF plots are saved.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_show_plots">show_plots</code></td>
<td>
<p>(Logical <code>TRUE</code> or <code>FALSE</code>) If <code>TRUE</code>, the plots are printed to the screen, and if <code>FALSE</code> no plots are displayed. This may be helpful when the only desire is to save the individual GOF plots.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_width">width</code></td>
<td>
<p>If <code>save_plots == TRUE</code>, controls the plot width dimension saved.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_height">height</code></td>
<td>
<p>If <code>save_plots == TRUE</code>, controls the plot height dimension saved.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_cutoff">cutoff</code></td>
<td>
<p>For statistics that are distributions (e.g., degree distributions), specifies a cutoff point. Dimensions past the cutoff are ignored and not plotted.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_x_labels">x_labels</code></td>
<td>
<p>Character vector specifying the statistic names or labels.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_x_angle">x_angle</code></td>
<td>
<p>Adjusts the angle of the x axis tick labels (typically the statistic names).</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_x_axis_label">x_axis_label</code></td>
<td>
<p>Label for the x axis.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_y_axis_label">y_axis_label</code></td>
<td>
<p>Label for the y aixs.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_plot_title">plot_title</code></td>
<td>
<p>Title for the plot.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_title_size">title_size</code></td>
<td>
<p>Font size for the plot title.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_axis_label_size">axis_label_size</code></td>
<td>
<p>Font size for the axis labels. Individual axes label sizes can be changed using <code>x_axis_label_size</code> and <code>y_axis_label_size</code> which are detailed below.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_axis_size">axis_size</code></td>
<td>
<p>Font size for the axis tick labels. Individual axes tick label sizes can be changed using <code>x_axis_size</code> and <code>y_axis_size</code> which are detailed below.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_line_size">line_size</code></td>
<td>
<p>(Numeric, non-negative) If <code>line_size</code> is positive, then a red line will be plotted to indicate the observed network value of the statistic. If <code>line_size</code> is equal to zero, then the observed data line will not be plotted.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_x_axis_label_size">x_axis_label_size</code></td>
<td>
<p>The font size of the x axis label. When <code>NULL</code>, <code>axis_label_size</code> is used. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_y_axis_label_size">y_axis_label_size</code></td>
<td>
<p>The font size of the y axis label. When <code>NULL</code>, <code>axis_label_size</code> is used. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_x_axis_size">x_axis_size</code></td>
<td>
<p>The font size of the x axis tick labels. When <code>NULL</code>, <code>axis_size</code> is used. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_y_axis_size">y_axis_size</code></td>
<td>
<p>The font size of the y acis tick labels. When <code>NULL</code>, <code>axis_size</code> is used. Defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="plot.gof_mlergm_+3A_pretty_x">pretty_x</code></td>
<td>
<p>(Logical <code>TRUE</code> or <code>FALSE</code>) If set to <code>TRUE</code>, the <code>link{pretty}</code> function will be called to format the x-axis breaks. This can be useful for when the x-axis range is large.</p>
</td></tr>
</table>

<hr>
<h2 id='print.gof_mlergm'>Print summary of a <code>gof_mlergm</code> object.</h2><span id='topic+print.gof_mlergm'></span>

<h3>Description</h3>

<p>Prints a formatted summary output for <code>gof_mlergm</code> object which was produced by <code><a href="#topic+gof.mlergm">gof.mlergm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gof_mlergm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gof_mlergm_+3A_x">x</code></td>
<td>
<p>An object of class <code>gof_mlergm</code>, probably produced by <code><a href="#topic+gof.mlergm">gof.mlergm</a></code>.</p>
</td></tr>
<tr><td><code id="print.gof_mlergm_+3A_...">...</code></td>
<td>
<p>Additional arguments to be passed if necessary.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gof.mlergm">gof.mlergm</a></code>
</p>

<hr>
<h2 id='set_options'>Set and adjust options and settings.</h2><span id='topic+set_options'></span>

<h3>Description</h3>

<p>Function allows for specification of options and settings for simulation and estimation procedures.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>set_options(
  burnin = 10000,
  interval = 1000,
  sample_size = 1000,
  NR_tol = 1e-04,
  NR_max_iter = 50,
  MCMLE_max_iter = 10,
  do_parallel = TRUE,
  number_cores = detectCores(all.tests = FALSE, logical = TRUE) - 1,
  adaptive_step_len = TRUE,
  step_len_multiplier = 0.5,
  step_len = 1,
  bridge_num = 10,
  bridge_burnin = 10000,
  bridge_interval = 500,
  bridge_sample_size = 5000
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="set_options_+3A_burnin">burnin</code></td>
<td>
<p>The burnin length for MCMC chains.</p>
</td></tr>
<tr><td><code id="set_options_+3A_interval">interval</code></td>
<td>
<p>The sampling interval for MCMC chains.</p>
</td></tr>
<tr><td><code id="set_options_+3A_sample_size">sample_size</code></td>
<td>
<p>The number of points to sample from MCMC chains for the MCMLE procedure.</p>
</td></tr>
<tr><td><code id="set_options_+3A_nr_tol">NR_tol</code></td>
<td>
<p>The convergence tolerance for the Newton-Raphson optimization (implemented as Fisher scoring).</p>
</td></tr>
<tr><td><code id="set_options_+3A_nr_max_iter">NR_max_iter</code></td>
<td>
<p>The maximum number of Newton-Raphson updates to perform.</p>
</td></tr>
<tr><td><code id="set_options_+3A_mcmle_max_iter">MCMLE_max_iter</code></td>
<td>
<p>The maximum number of MCMLE steps to perform.</p>
</td></tr>
<tr><td><code id="set_options_+3A_do_parallel">do_parallel</code></td>
<td>
<p>(logical) Whether or not to use parallel processesing (defaults to TRUE).</p>
</td></tr>
<tr><td><code id="set_options_+3A_number_cores">number_cores</code></td>
<td>
<p>The number of parallel cores to use for parallel computations.</p>
</td></tr>
<tr><td><code id="set_options_+3A_adaptive_step_len">adaptive_step_len</code></td>
<td>
<p>(logical) If <code>TRUE</code>, an adaptive steplength procedure is used 
for the Newton-Raphson procedure. Arguments <code>NR_step_len</code> and <code>NR_step_len_multiplier</code> 
are ignored when <code>adaptive_step_len</code> is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="set_options_+3A_step_len_multiplier">step_len_multiplier</code></td>
<td>
<p>The step_len adjustment multplier when convergence fails.</p>
</td></tr>
<tr><td><code id="set_options_+3A_step_len">step_len</code></td>
<td>
<p>The step length adjustment default to be used for the Newton-Raphson updates.</p>
</td></tr>
<tr><td><code id="set_options_+3A_bridge_num">bridge_num</code></td>
<td>
<p>The number of bridges to use for likelihood computations.</p>
</td></tr>
<tr><td><code id="set_options_+3A_bridge_burnin">bridge_burnin</code></td>
<td>
<p>The burnin length for the bridge MCMC chain for approximate likelihood computation.</p>
</td></tr>
<tr><td><code id="set_options_+3A_bridge_interval">bridge_interval</code></td>
<td>
<p>The sampling interval for the brdige MCMC chain for approximate likelihood computation.</p>
</td></tr>
<tr><td><code id="set_options_+3A_bridge_sample_size">bridge_sample_size</code></td>
<td>
<p>The number of points to sample from the bridge MCMC chain for approximate likelihood computation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The main simulation settings are <code>burnin</code>, <code>interval</code>, and <code>sample_size</code>. For estimation of the loglikelihood value, options include <code>bridge_num</code> which controls the number of bridges to be used for approximating the loglikelihood (see, e.g., Hunter and Handcock (2006) for a discussion). The main estimation settings and options include <code>NR_tol</code>, <code>NR_max_iter</code>, <code>MCMLE_max_iter</code>, <code>adaptive_step_len</code>, and <code>step_len</code>. Parameters <code>NR_tol</code> and <code>NR_max_iter</code> control the convergence tolerance and maximum number of iterations for the Newton-Raphson, or Fisher scoring, optimization. When the L2 norm of the incremenet in the Newton-Raphson procedure is under the specified tolerance <code>NR_tol</code> convergence is reached; and, no more than <code>NR_max_iter</code> iterations are performed. The MCMLE procedure uses the stepping algorithn of Hummel, et al., (2012) to give stabiity to the estimation procedure. Each MCMLE iteration draws samples from an MCMC chain, and <code>MCMLE_max_iter</code> controls how many iterations are performed before termination. Most functions support parallel computing for efficiency; by default <code>do_parallel</code> is <code>TRUE</code>. The number of computing cores can be adjusted by <code>number_cores</code>, and the default is one less than the number of cores available.
</p>


<h3>References</h3>

<p>Hunter, D. R., and Handcock, M. S. (2006).
Inference in curved exponential family models for networks.
Journal of Computational and Graphical Statistics, 15(3), 565-583.
</p>
<p>Hummel, R. M., Hunter, D. R., and Handcock, M. S. (2012).
Improving simulation-based algorithms for fitting ERGMs.
Journal of Computational and Graphical Statistics, 21(4), 920-939.
</p>

<hr>
<h2 id='simulate_mlnet'>Simulate a multilevel network</h2><span id='topic+simulate_mlnet'></span>

<h3>Description</h3>

<p>Function simulates a multilevel network by specifying a network size, node block memberships, and within-block and between-block models. The function currently only suppports block-models where between-block edges are dyad-independent.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simulate_mlnet(
  form,
  node_memb,
  theta,
  parameterization = "standard",
  seed = NULL,
  between_form = NULL,
  between_theta = NULL,
  between_prob = NULL,
  options = set_options()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulate_mlnet_+3A_form">form</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object of the form <code>network ~ model terms</code> which specifies how the within-block subgraphs are modeled.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_node_memb">node_memb</code></td>
<td>
<p>Vector of node block memberships.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_theta">theta</code></td>
<td>
<p>A vector of model parameters (coefficients) for the ERGM governing the within-subgraph edges.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_parameterization">parameterization</code></td>
<td>
<p>Parameterization options include 'standard', 'offset', or 'size'.
</p>

<ul>
<li><p> 'standard' : Does not adjust the individual block parameters for size.
</p>
</li>
<li><p> 'offset' : The offset parameterization uses edge and mutual offsets along the lines of Krivitsky, Handcock, and Morris (2011) and Krivitsky and Kolaczyk (2015). The edge parameter is offset by <code class="reqn">-log n(k)</code> and the mutual parameter is offset by <code class="reqn">+log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.
</p>
</li>
<li><p> 'size' : Multiplies the block parameters by <code class="reqn">log n(k)</code>, where <code class="reqn">n(k)</code> is the size of the kth block.
</p>
</li></ul>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_seed">seed</code></td>
<td>
<p>Seed to be provided for reproducibility.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_between_form">between_form</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object of the form <code>~ model terms</code> which specifies how the within-block subgraphs are modeled.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_between_theta">between_theta</code></td>
<td>
<p>A vector of model parameters (coefficients) for the ERGM governing the between-subgraph edges.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_between_prob">between_prob</code></td>
<td>
<p>A probability which specifies how edges between blocks are governerd. An ERGM (<code>between_form</code> and <code>between_theta</code>) cannot be specified together with <code>between_prob</code>.</p>
</td></tr>
<tr><td><code id="simulate_mlnet_+3A_options">options</code></td>
<td>
<p>Use <code><a href="#topic+set_options">set_options</a></code> to change the simulation options. Note that some options are only valid for estimation using <code><a href="#topic+mlergm">mlergm</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Simulation of multilevel block networks is done with a Monte-Carlo Markov chain (MCMC) and can be done in parallel where <code><a href="#topic+set_options">set_options</a></code> can be used to adjust the simulation settings (such as <code>burnin</code>, <code>interval</code>, and <code>sample_size</code>). Each within-block subgraph is given its own Markov chain, and so these settings are the settings to be used for each within-block chain.
</p>


<h3>Value</h3>

<p><code>simulate_mlnet</code> returns an objects of class <code><a href="#topic+mlnet">mlnet</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create a K = 2 block network with edge + gwesp term 
net &lt;- simulate_mlnet(form = network.initialize(30, directed = FALSE) ~ edges + gwesp, 
                      node_memb = c(rep(1, 15), rep(2, 15)),
                      theta = c(-3, 0.5, 1.0), 
                      between_prob = 0.01,
                      options = set_options(number_cores = 2, burnin = 2000))

# Simulate a K = 2 block directed network, specifying a formula for between edges
net &lt;- simulate_mlnet(form = network.initialize(30, directed = TRUE) ~ edges + gwesp,
                      node_memb = c(rep(1, 15), rep(2, 15)),
                      theta = c(-3, 0.5, 1.0),
                      between_form = ~ edges + mutual, 
                      between_theta = c(-4, 2),
                      options = set_options(number_cores = 2, burnin = 2000))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
