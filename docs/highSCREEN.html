<!DOCTYPE html><html><head><title>Help for package highSCREEN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {highSCREEN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#extractplate'>
<p>Extract plate</p></a></li>
<li><a href='#formatRESULT'>
<p>Format results</p></a></li>
<li><a href='#highSCREEN-package'>
<p>High-Throughput Screening for Plate Based Essays</p></a></li>
<li><a href='#hits'>
<p>Identify hits</p></a></li>
<li><a href='#normplate'>
<p>Normalize plate</p></a></li>
<li><a href='#plotcont'>
<p>Plot control density</p></a></li>
<li><a href='#plotplate'>
<p>Plot plate activity</p></a></li>
<li><a href='#qcplate'>
<p>Quality control</p></a></li>
<li><a href='#rankhits'>
<p>Rank hits</p></a></li>
<li><a href='#zfactor.ssmd'>
<p>Compute Z-factor and SSMD</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>High-Throughput Screening for Plate Based Essays</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Can be used to carry out extraction, normalization, quality control (QC), candidate hits identification and visualization for plate based assays, in drug discovery. The package methods were applied in H. W. Choi et al. "Identification of Novel Mast Cell Activators Using Cell-Based High-Throughput Screening", SLAS Discovery 24(6), 2019. This project was funded by the Division of Allergy, Immunology, and Transplantation, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under contract No. HHSN272201400054C entitled "Adjuvant Discovery For Vaccines Against West Nile Virus and Influenza", awarded to Duke University and lead by Drs. Herman Staats and Soman Abraham.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0), gplots (&ge; 3.0.1)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-02-11 18:29:48 UTC; is33</td>
</tr>
<tr>
<td>Author:</td>
<td>Ivo D. Shterev [aut, cre],
  Cliburn Chan [aut],
  Gregory D. Sempowski [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ivo D. Shterev &lt;i.shterev@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-02-12 10:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='extractplate'>
Extract plate
</h2><span id='topic+extractplate'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extractplate(dat0, dat1, plate, replicate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extractplate_+3A_dat0">dat0</code></td>
<td>

<p>A list consisting of the following elements for the t0-specific data set:
<code class="reqn">Replicate1</code>: Data frame containing the first triplicate and 4 additional columns specifying the controls and their plate locations.
<code class="reqn">Replicate2</code>: Data frame containing the second triplicate and 4 additional columns specifying the controls and their plate locations.
<code class="reqn">Replicate3</code>: Data frame containing the third triplicate and 4 additional columns specifying the controls and their plate locations.
</p>
</td></tr>
<tr><td><code id="extractplate_+3A_dat1">dat1</code></td>
<td>

<p>A list consisting of the following elements for the t1-specific data set:
<code class="reqn">Replicate1</code>: Data frame containing the first triplicate and 4 additional columns specifying the controls and their plate locations.
<code class="reqn">Replicate2</code>: Data frame containing the second triplicate and 4 additional columns specifying the controls and their plate locations.
<code class="reqn">Replicate3</code>: Data frame containing the third triplicate and 4 additional columns specifying the controls and their plate locations.
</p>
</td></tr>
<tr><td><code id="extractplate_+3A_plate">plate</code></td>
<td>

<p>Specifies which of the 4 plates to be extracted.
</p>
</td></tr>
<tr><td><code id="extractplate_+3A_replicate">replicate</code></td>
<td>

<p>Specfies which replicate to be extracted.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a list consisting of the following elements:
</p>
<table>
<tr><td><code>dat0</code></td>
<td>
<p>Data frame containing the t0-specific plate of compounds and controls.</p>
</td></tr>
<tr><td><code>dat1</code></td>
<td>
<p>Data frame containing the t1-specific plate of compounds and controls.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicate to create t0-specific data set
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicate to create t1-specific data set
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 3, replicate 2
extractplate(replicates_t0, replicates_t1, plate=3, replicate=2)
</code></pre>

<hr>
<h2 id='formatRESULT'>
Format results
</h2><span id='topic+formatRESULT'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>formatRESULT(dat, replicate="Replicate", score="S", t="Time")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="formatRESULT_+3A_dat">dat</code></td>
<td>

<p>Data frame such as the return data frame of the function <code class="reqn">normplate()</code>.
</p>
</td></tr>
<tr><td><code id="formatRESULT_+3A_replicate">replicate</code></td>
<td>

<p>Specifies the column name of the input data frame that contains the replicate numbers.
</p>
</td></tr>
<tr><td><code id="formatRESULT_+3A_score">score</code></td>
<td>

<p>Specifies the column name of the input data frame that contains the normalized score values.
</p>
</td></tr>
<tr><td><code id="formatRESULT_+3A_t">t</code></td>
<td>

<p>Specifies the column name of the input data frame that contains the time designations (0 or 1).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a data frame with each row corresponding to a compound/control and the following columns:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>Has the complete information to identify a compound or control. It contains information about the main plate, the quadrant/plate and the well.</p>
</td></tr>
<tr><td><code>MainPlate</code></td>
<td>
<p>Specifies the main plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Plate</code></td>
<td>
<p>Specifies the quadrant/plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Norm</code></td>
<td>
<p>Specifies the normalization method that was applied for the specific compound.</p>
</td></tr>
<tr><td><code>well</code></td>
<td>
<p>Specifies the location (row and column) of the compound/control in the quadrant.</p>
</td></tr>
<tr><td><code>row</code></td>
<td>
<p>Specifies the row location in the quadrant.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p>Specifies the column location in the quadrant.</p>
</td></tr>
<tr><td><code>welltype</code></td>
<td>
<p>Specifies if the well is compound or control.</p>
</td></tr>
<tr><td><code>S0</code></td>
<td>
<p>Replicates of the score from the t0-specific data set.</p>
</td></tr>
<tr><td><code>S1</code></td>
<td>
<p>Replicates of the score from the t1-specific data set.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, all replicates
dat1 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)
dat2 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)
dat3 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# normalize data of all replicates
res1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap, 
plate=1, replicate=1, norm="zscore") 
res2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap, 
plate=1, replicate=2, norm="zscore")
res3 = normplate("Main Plate 1", dat3[["dat0"]], dat3[["dat1"]], cmap, 
plate=1, replicate=3, norm="zscore")

# reformat data of all replicates
head(formatRESULT(rbind(res1, res2, res3), replicate="Replicate", t="Time"))
</code></pre>

<hr>
<h2 id='highSCREEN-package'>
High-Throughput Screening for Plate Based Essays
</h2><span id='topic+highSCREEN-package'></span><span id='topic+highSCREEN'></span>

<h3>Description</h3>

<p>This package can be used to carry out extraction, normalization, quality control (QC), candidate hits identification and visualization for plate based essays, in drug discovery.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> highSCREEN</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> High-Throughput Screening for Plate Based Essays</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 0.4</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(person(c("Ivo", "D."), "Shterev", role = c("aut", "cre"),
              email = "i.shterev@gmail.com"),
              person("Cliburn", "Chan", role = "aut"),
              person(c("Gregory", "D."), "Sempowski", role = "aut"))</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Can be used to carry out extraction, normalization, quality control (QC), candidate hits identification and visualization for plate based assays, in drug discovery. The package methods were applied in H. W. Choi et al. "Identification of Novel Mast Cell Activators Using Cell-Based High-Throughput Screening", SLAS Discovery 24(6), 2019. This project was funded by the Division of Allergy, Immunology, and Transplantation, National Institute of Allergy and Infectious Diseases, National Institutes of Health, Department of Health and Human Services, under contract No. HHSN272201400054C entitled "Adjuvant Discovery For Vaccines Against West Nile Virus and Influenza", awarded to Duke University and lead by Drs. Herman Staats and Soman Abraham.</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.4.0), gplots (&gt;= 3.0.1)</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Ivo D. Shterev [aut, cre],
  Cliburn Chan [aut],
  Gregory D. Sempowski [aut]</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Ivo D. Shterev &lt;i.shterev@gmail.com&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
extractplate            Extract plate
formatRESULT            Format results
highSCREEN-package      High-Throughput Screening for Plate Based
                        Essays
hits                    Identify hits
normplate               Normalize plate
plotcont                Plot control density
plotplate               Plot plate activity
qcplate                 Quality control
rankhits                Rank hits
zfactor.ssmd            Compute Z-factor and SSMD
</pre>


<h3>Author(s)</h3>

<p>I. D. Shterev, C. Chan and G. D. Sempowski
</p>
<p>Maintainer: I. D. Shterev &lt;i.shterev@duke.edu&gt;
</p>

<hr>
<h2 id='hits'>
Identify hits
</h2><span id='topic+hits'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hits(dat.raw, dat.norm, s0="S0", s1="S1", 
qc.mainplates, qc1.val=0.225, hit.val=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hits_+3A_dat.raw">dat.raw</code></td>
<td>

<p>Data frame containing raw data as an output from <code class="reqn">formatRESULT()</code>. 
</p>
</td></tr>
<tr><td><code id="hits_+3A_dat.norm">dat.norm</code></td>
<td>

<p>Data frame containing normalized data set as an output from <code class="reqn">formatRESULT()</code>. 
</p>
</td></tr>
<tr><td><code id="hits_+3A_s0">s0</code></td>
<td>

<p>Specifies the name of the columns containing t0-specific scores.
</p>
</td></tr>
<tr><td><code id="hits_+3A_s1">s1</code></td>
<td>

<p>Specifies the name of the columns containing t1-specific scores.
</p>
</td></tr>
<tr><td><code id="hits_+3A_qc.mainplates">qc.mainplates</code></td>
<td>

<p>A vector containing names of main plates that passed QC.
</p>
</td></tr>
<tr><td><code id="hits_+3A_qc1.val">qc1.val</code></td>
<td>

<p>Threshold value for QC1.
</p>
</td></tr>
<tr><td><code id="hits_+3A_hit.val">hit.val</code></td>
<td>

<p>Threshold value for identifying candidate hits, based on the mean of t1-specific scores.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a data frame. Each row corresponds to a compound that passed QC1 and belongs to a plate that passed overall QC. The data frame contains the following columns:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>Has the complete information to identify a compound or control. It contains information about the main plate, the quadrant/plate and the well.</p>
</td></tr>
<tr><td><code>MainPlate</code></td>
<td>
<p>Specifies the main plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Plate</code></td>
<td>
<p>Specifies the quadrant/plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Norm</code></td>
<td>
<p>Specifies the normalization method that was applied for the specific compound.</p>
</td></tr>
<tr><td><code>well</code></td>
<td>
<p>Specifies the location (row and column) of the compound/control in the quadrant.</p>
</td></tr>
<tr><td><code>row</code></td>
<td>
<p>Specifies the row location in the quadrant.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p>Specifies the column location in the quadrant.</p>
</td></tr>
<tr><td><code>welltype</code></td>
<td>
<p>Specifies if the well is compound or control.</p>
</td></tr>
<tr><td><code>S0</code></td>
<td>
<p>Replicates of the score from the t0-specific data set.</p>
</td></tr>
<tr><td><code>S1</code></td>
<td>
<p>Replicates of the score from the t1-specific data set.</p>
</td></tr>
<tr><td><code>IND2</code></td>
<td>
<p>Indicator variable specifying if the compound passes (<code class="reqn">TRUE</code>) or fails (<code class="reqn">FALSE</code>) QC2.</p>
</td></tr>
<tr><td><code>IND3</code></td>
<td>
<p>Indicator variable specifying if the compound passes (<code class="reqn">TRUE</code>) or fails (<code class="reqn">FALSE</code>) QC3.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat1 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)

# extract plate 1, replicate 2
dat2 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)

# extract plate 1, replicate 3
dat3 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# no normalizion
datraw1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
datraw2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
datraw3 = normplate("Main Pltae 1", dat3[["dat0"]], dat3[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicate
datraw = rbind(datraw1, datraw2, datraw3)

# reformat result
datraw = formatRESULT(datraw, replicate="Replicate", t="Time")

# c-score normalization
datnorm1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap,
 plate=1, replicate=1, norm="cscore", 
poscont="Control P", negcont="Control N")
datnorm2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap,
 plate=1, replicate=2, norm="cscore", 
poscont="Control P", negcont="Control N")
datnorm3 = normplate("Main Pltae 1", dat3[["dat0"]], dat3[["dat1"]], cmap,
 plate=1, replicate=3, norm="cscore",
poscont="Control P", negcont="Control N")

# combine 3 replicates
datnorm = rbind(datnorm1, datnorm2, datnorm3)

# reformat result
datnorm = formatRESULT(datnorm, replicate="Replicate", t="Time")

# identify hits
head(hits(datraw, datnorm, qc.mainplates="Main Plate 1", qc1.val=0.225, hit.val=3))
</code></pre>

<hr>
<h2 id='normplate'>
Normalize plate
</h2><span id='topic+normplate'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normplate(mainplate, dat0, dat1, cmap, plate, replicate, norm="bscore",
 poscont=NULL, negcont=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normplate_+3A_mainplate">mainplate</code></td>
<td>

<p>Main Plate designation.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_dat0">dat0</code></td>
<td>

<p>Data frame containing the 96-well t0-specific plate/quadrant to be normalized.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_dat1">dat1</code></td>
<td>

<p>Data frame containing the 96-well t1-specific plate/quadrant to be normalized.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_cmap">cmap</code></td>
<td>

<p>96-well plate control map.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_plate">plate</code></td>
<td>

<p>Plate/quadrant designation. Ranges from 1 to 4.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_replicate">replicate</code></td>
<td>

<p>Replicate designation.
</p>
</td></tr>
<tr><td><code id="normplate_+3A_norm">norm</code></td>
<td>

<p>Normalization method to be applied. Currenlty implemented methods include C-score (<code class="reqn">cscore</code>), B-score (<code class="reqn">bscore</code>), Z-score (eqnzscore) and no normalization (<code class="reqn">raw</code>).
</p>
</td></tr>
<tr><td><code id="normplate_+3A_poscont">poscont</code></td>
<td>

<p>Specifies positive control designation (used in C-score normalization). 
</p>
</td></tr>
<tr><td><code id="normplate_+3A_negcont">negcont</code></td>
<td>

<p>Specifies negative control designation (used in C-score normalization). 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame containing the following columns:
</p>
<table>
<tr><td><code>MainPlate</code></td>
<td>
<p>Specifies the main plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Time</code></td>
<td>
<p>Specifies t0 (0) or t1 (1) specific data.</p>
</td></tr>
<tr><td><code>Plate</code></td>
<td>
<p>Specifies the quadrant/plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Replicate</code></td>
<td>
<p>Specifies replicate.</p>
</td></tr>
<tr><td><code>Norm</code></td>
<td>
<p>Specifies the normalization method that was applied for the specific compound.</p>
</td></tr>
<tr><td><code>well</code></td>
<td>
<p>Specifies the location (row and column) of the compound/control in the quadrant.</p>
</td></tr>
<tr><td><code>row</code></td>
<td>
<p>Specifies the row location in the quadrant.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p>Specifies the column location in the quadrant.</p>
</td></tr>
<tr><td><code>score</code></td>
<td>
<p>Shows the score value.</p>
</td></tr>
<tr><td><code>welltype</code></td>
<td>
<p>Specifies if the well is compound or control.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]
cmap

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicate for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicate for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)

# normalize using c-score
head(normplate("Main Plate 1", dat[["dat0"]], dat[["dat1"]], cmap, 
plate=1, replicate=1, norm="cscore",
 poscont="Control P", negcont="Control N"))

# normalize using b-score (medpolish)
head(normplate("Main Plate 1", dat[["dat0"]], dat[["dat1"]], cmap, 
plate=1, replicate=1, norm="bscore"))

# normalize using z-score
head(normplate("Main Plate 1", dat[["dat0"]], dat[["dat1"]], cmap, 
plate=1, replicate=1, norm="zscore"))
</code></pre>

<hr>
<h2 id='plotcont'>
Plot control density
</h2><span id='topic+plotcont'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotcont(dat, score="S", main, xaxis.marks=seq(0,5,0.025))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotcont_+3A_dat">dat</code></td>
<td>

<p>Data frame as an output from <code class="reqn">normplate()</code>.
</p>
</td></tr>
<tr><td><code id="plotcont_+3A_score">score</code></td>
<td>
<p>Specifies the columns containing the data.
</p>
</td></tr>
<tr><td><code id="plotcont_+3A_main">main</code></td>
<td>

<p>Main title for the plot.
</p>
</td></tr>
<tr><td><code id="plotcont_+3A_xaxis.marks">xaxis.marks</code></td>
<td>

<p>Specifies x-axis mark ticks.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)

nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat11 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)
# extract plate 1, replicate 2
dat12 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)
# extract plate 1, replicate 3
dat13 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# no normalizion (norm="raw")
res11 = normplate("Main Plate 1", dat11[["dat0"]], dat11[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
res12 = normplate("Main Plate 1", dat12[["dat0"]], dat12[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
res13 = normplate("Main Pltae 1", dat13[["dat0"]], dat13[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicates
res1 = rbind(res11, res12, res13)
# reformat result
res1 = formatRESULT(res1, replicate="Replicate", t="Time")

layout(matrix(c(1,2,3), 3, 1, byrow = TRUE))

# plot density of all positive controls
plotcont(subset(res1, welltype=="Control P"), main="Density of Positive Controls",
 xaxis.marks=seq(-1,5,0.025))

# plot density of all negative controls
plotcont(subset(res1, welltype=="Control N"), main="Density of Negative Controls",
 xaxis.marks=seq(-1,5,0.025))

# plot density of controls with low, medium and high concentrations
plotcont(subset(res1, welltype=="Control low" | welltype=="Control med" | 
welltype=="Control high"), main="Density of Controls with Low, 
Medium and High Concentrations", xaxis.marks=seq(-1,5,0.025))
</code></pre>

<hr>
<h2 id='plotplate'>
Plot plate activity
</h2><span id='topic+plotplate'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotplate(dat, score="S", main)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotplate_+3A_dat">dat</code></td>
<td>

<p>Data frame as an output from <code class="reqn">normplate()</code>.
</p>
</td></tr>
<tr><td><code id="plotplate_+3A_score">score</code></td>
<td>

<p>Specifies the columns containing the data.
</p>
</td></tr>
<tr><td><code id="plotplate_+3A_main">main</code></td>
<td>

<p>Main title for the plot.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)

nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicates of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat11 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)
# extract plate 1, replicate 2
dat12 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)
# extract plate 1, replicate 3
dat13 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# no normalizion (norm="raw")
res11 = normplate("Main Plate 1", dat11[["dat0"]], dat11[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
res12 = normplate("Main Plate 1", dat12[["dat0"]], dat12[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
res13 = normplate("Main Pltae 1", dat13[["dat0"]], dat13[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicates
res1 = rbind(res11, res12, res13)
# reformat result
res1 = formatRESULT(res1, replicate="Replicate", t="Time")

# plot single plate activity levels
plotplate(res1, main="Single Plate Activity Levels")
</code></pre>

<hr>
<h2 id='qcplate'>
Quality control
</h2><span id='topic+qcplate'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qcplate(dat, s0="S0", s1="S1", poscont="Control P",
 negcont="Control N", qc1.val=0.225, qc2.val=2, addcont, welltype="welltype")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qcplate_+3A_dat">dat</code></td>
<td>

</td></tr>
<tr><td><code id="qcplate_+3A_s0">s0</code></td>
<td>

<p>Specifies the name of the columns containing t0-specific scores.
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_s1">s1</code></td>
<td>

<p>Specifies the name of the columns containing t1-specific scores.
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_poscont">poscont</code></td>
<td>

<p>Specifies positive control designation (used in C-score normalization). 
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_negcont">negcont</code></td>
<td>

<p>Specifies negative control designation (used in C-score normalization). 
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_qc1.val">qc1.val</code></td>
<td>

<p>Pre-defined threshold value for QC1.
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_qc2.val">qc2.val</code></td>
<td>

<p>Pre-defined threshold value for QC2.
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_addcont">addcont</code></td>
<td>

<p>A vector character names specifying the additional controls for QC3. 
The vignette provides more details on the particular order of specifying the additional controls.
</p>
</td></tr>
<tr><td><code id="qcplate_+3A_welltype">welltype</code></td>
<td>

<p>Specifies the name for the column defining the well type.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>details
</p>


<h3>Value</h3>

<p>value
</p>


<h3>References</h3>

<p>references
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat11 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)

# extract plate 1, replicate 2
dat12 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)

# extract plate 1, replicate 3
dat13 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# no normalizion (norm="raw")
res11 = normplate("Main Plate 1", dat11[["dat0"]], dat11[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
res12 = normplate("Main Plate 1", dat12[["dat0"]], dat12[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
res13 = normplate("Main Pltae 1", dat13[["dat0"]], dat13[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicates
res1 = rbind(res11, res12, res13)

# reformat result
res1 = formatRESULT(res1, replicate="Replicate", t="Time")

# perform QC
qcplate(res1, poscont="Control P", negcont="Control N", qc1.val=0.225, qc2.val=2, 
addcont=c("Control low", "Control med", "Control high"), welltype="welltype")
</code></pre>

<hr>
<h2 id='rankhits'>
Rank hits
</h2><span id='topic+rankhits'></span>

<h3>Description</h3>

<p>This function ranks the candidate compound hits based on the mean of t1-specific scores.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rankhits(dat, score.before="S0", score.after="S1", var="m1")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rankhits_+3A_dat">dat</code></td>
<td>

<p>Data frane as the output of the function <code class="reqn">formatRESULT</code>.
</p>
</td></tr>
<tr><td><code id="rankhits_+3A_score.before">score.before</code></td>
<td>

<p>Specifies the name of the columns containing t0-specific scores.
</p>
</td></tr>
<tr><td><code id="rankhits_+3A_score.after">score.after</code></td>
<td>

<p>Specifies the name of the columns containing t1-specific scores.
</p>
</td></tr>
<tr><td><code id="rankhits_+3A_var">var</code></td>
<td>

<p>Specifies the variable according to which the ranking is done.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data frame with a row for each hit. The columns are as follows:
</p>
<table>
<tr><td><code>ID</code></td>
<td>
<p>Has the complete information to identify a compound or control. It contains information about the main plate, the quadrant/plate and the well.</p>
</td></tr>
<tr><td><code>MainPlate</code></td>
<td>
<p>Specifies the main plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Plate</code></td>
<td>
<p>Specifies the quadrant/plate to wich the compound/control belongs.</p>
</td></tr>
<tr><td><code>Norm</code></td>
<td>
<p>Specifies the normalization method that was applied for the specific compound.</p>
</td></tr>
<tr><td><code>well</code></td>
<td>
<p>Specifies the location (row and column) of the compound/control in the quadrant.</p>
</td></tr>
<tr><td><code>row</code></td>
<td>
<p>Specifies the row location in the quadrant.</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p>Specifies the column location in the quadrant.</p>
</td></tr>
<tr><td><code>welltype</code></td>
<td>
<p>Specifies if the well is compound or control.</p>
</td></tr>
<tr><td><code>S0</code></td>
<td>
<p>Replicates of the score from the t0-specific data set.</p>
</td></tr>
<tr><td><code>S1</code></td>
<td>
<p>Replicates of the score from the t1-specific data set.</p>
</td></tr>
<tr><td><code>IND2</code></td>
<td>
<p>Indicator variable specifying if the compound passes (<code class="reqn">TRUE</code>) or fails (<code class="reqn">FALSE</code>) QC2.</p>
</td></tr>
<tr><td><code>IND3</code></td>
<td>
<p>Indicator variable specifying if the compound passes (<code class="reqn">TRUE</code>) or fails (<code class="reqn">FALSE</code>) QC3.</p>
</td></tr>
<tr><td><code>diff</code></td>
<td>
<p>Difference between mean of t1 and t0 replicates.</p>
</td></tr>
<tr><td><code>m0</code></td>
<td>
<p>Mean of t0-specific replicates (MB).</p>
</td></tr>
<tr><td><code>s0</code></td>
<td>
<p>Standard deviation of t0-specific replicates (SB).</p>
</td></tr>
<tr><td><code>rs0</code></td>
<td>
<p>Coefficient of variation of t0-specific replicates. It is the ratio of S0 and M0.</p>
</td></tr>
<tr><td><code>m1</code></td>
<td>
<p>Mean of t1-specific replicates (MA).</p>
</td></tr>
<tr><td><code>s1</code></td>
<td>
<p>Standard deviation of t1-specific replicates (SA)</p>
</td></tr>
<tr><td><code>rs1</code></td>
<td>
<p>Coefficient of variation of t1-specific replicates. It is the ratio of S1 and M1.</p>
</td></tr>
<tr><td><code>ind_below</code></td>
<td>
<p>see <code class="reqn">ind</code> below</p>
</td></tr>
<tr><td><code>ind_above</code></td>
<td>
<p>see <code class="reqn">ind</code> below</p>
</td></tr>
<tr><td><code>ind</code></td>
<td>
<p><code class="reqn">TRUE</code> (if both <code class="reqn">ind_below</code> and <code class="reqn">ind_above</code> are <code class="reqn">TRUE</code>) if RS1 is within the <code class="reqn">1.5 \times IQR</code>, where interquartile range (<code class="reqn">IQR</code>) is computed based on all hits.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)*0.01), nr, nc)

# combine all replicates for the t0-specific data
replicates_t0 = list(r1, r2, r3)
names(replicates_t0) = c("R1", "R2", "R3")

# create 1st replicate of data matrix with compounds and controls
r1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
r2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
r3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_t1 = list(r1, r2, r3)
names(replicates_t1) = c("R1", "R2", "R3")

# extract plate 1, replicate 1
dat1 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=1)
# extract plate 1, replicate 2
dat2 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=2)
# extract plate 1, replicate 3
dat3 = extractplate(replicates_t0, replicates_t1, plate=1, replicate=3)

# no normalizion
datraw1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
datraw2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
datraw3 = normplate("Main Pltae 1", dat3[["dat0"]], dat3[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicates
datraw = rbind(datraw1, datraw2, datraw3)

# reformat result
datraw = formatRESULT(datraw, replicate="Replicate", t="Time")

# c-score normalization
datnorm1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap,
 plate=1, replicate=1, norm="cscore", 
poscont="Control P", negcont="Control N")
datnorm2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap,
 plate=1, replicate=2, norm="cscore", 
poscont="Control P", negcont="Control N")
datnorm3 = normplate("Main Pltae 1", dat3[["dat0"]], dat3[["dat1"]], cmap,
 plate=1, replicate=3, norm="cscore", 
poscont="Control P", negcont="Control N")

# combine 3 replicates
datnorm = rbind(datnorm1, datnorm2, datnorm3)

# reformat result
datnorm = formatRESULT(datnorm, replicate="Replicate", t="Time")

# identify hits
h = hits(datraw, datnorm, qc.mainplates="Main Plate 1", qc1.val=0.225, hit.val=3)

# rank hits in disending order of mean of t1-specific replicate scores "m1"
head(rankhits(h))
</code></pre>

<hr>
<h2 id='zfactor.ssmd'>
Compute Z-factor and SSMD
</h2><span id='topic+zfactor.ssmd'></span>

<h3>Description</h3>

<p>This function computes the Z-factor and strictly standardized mean difference (SSMD) of a given 96-well plate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zfactor.ssmd(dat, pos.cont, neg.cont, MainPlate, replicate)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zfactor.ssmd_+3A_dat">dat</code></td>
<td>

<p>Data frame as an output of the function <code class="reqn">formatRESULT()</code>.
</p>
</td></tr>
<tr><td><code id="zfactor.ssmd_+3A_pos.cont">pos.cont</code></td>
<td>

<p>Designation of positive control.
</p>
</td></tr>
<tr><td><code id="zfactor.ssmd_+3A_neg.cont">neg.cont</code></td>
<td>

<p>Designation of negative control.
</p>
</td></tr>
<tr><td><code id="zfactor.ssmd_+3A_mainplate">MainPlate</code></td>
<td>

<p>Specifies main plate.
</p>
</td></tr>
<tr><td><code id="zfactor.ssmd_+3A_replicate">replicate</code></td>
<td>

<p>Specifies the replicate.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a data frame with one row and the following columns:
</p>
<table>
<tr><td><code>MainPlate</code></td>
<td>
<p>Specifies the main plate.</p>
</td></tr>
<tr><td><code>replicate</code></td>
<td>
<p>Specifies the replicate.</p>
</td></tr>
<tr><td><code>ZFactor_Before</code></td>
<td>
<p>Specifies the Z-factor computed based on the t0-specific data.</p>
</td></tr>
<tr><td><code>ZFactor_After</code></td>
<td>
<p>Specifies the Z-factor computed based on the t1-specific data.</p>
</td></tr>
<tr><td><code>SSMD_Before</code></td>
<td>
<p>Specifies SSMD computed based on the t0-specific data.</p>
</td></tr>
<tr><td><code>SSMD_After</code></td>
<td>
<p>Specifies SSMD computed based on the t1-specific data.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1234)
nc = 24
nr = 16

# create 1st replicate of data matrix with compounds and controls
replicate1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create control map
cmap = data.frame(X1=c(rep("Control P", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control N", 
floor(nr/3))), X2=c(rep("Control N", floor(nr/3)), 
rep(c("Control low", "Control med", "Control high"), 
(floor(nr/3)+nr-3*floor(nr/3))/3), rep("Control P", floor(nr/3))))
cmap = cmap[seq(1,nr,2),]

# create 2nd replicate of data matrix with compounds and controls
replicate2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
replicate3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t0-specific data
replicates_before = list(replicate1, replicate2, replicate3)
names(replicates_before) = c("Replicate1", "Replicate2", "Replicate3")

# create 1st replicate of data matrix with compounds and controls
replicate1 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 2nd replicate of data matrix with compounds and controls
replicate2 = matrix(abs(rnorm(nr*nc)), nr, nc)

# create 3rd replicate of data matrix with compounds and controls
replicate3 = matrix(abs(rnorm(nr*nc)), nr, nc)

# combine all replicates for the t1-specific data
replicates_after = list(replicate1, replicate2, replicate3)
names(replicates_after) = c("Replicate1", "Replicate2", "Replicate3")

# extract plate 1, replicate 1
dat1 = extractplate(replicates_before, replicates_after, plate=1, replicate=1)
# extract plate 1, replicate 2
dat2 = extractplate(replicates_before, replicates_after, plate=1, replicate=2)
# extract plate 1, replicate 3
dat3 = extractplate(replicates_before, replicates_after, plate=1, replicate=3)

# no normalizion
datraw1 = normplate("Main Plate 1", dat1[["dat0"]], dat1[["dat1"]], cmap,
 plate=1, replicate=1, norm="raw")
datraw2 = normplate("Main Plate 1", dat2[["dat0"]], dat2[["dat1"]], cmap,
 plate=1, replicate=2, norm="raw")
datraw3 = normplate("Main Pltae 1", dat3[["dat0"]], dat3[["dat1"]], cmap,
 plate=1, replicate=3, norm="raw")

# combine 3 replicates
datraw = rbind(datraw1, datraw2, datraw3)

# reformat result
datraw = formatRESULT(datraw, replicate="Replicate", t="Time")

# compute z-factor and ssmd for each raw compound, replicate 1
zfactor.ssmd(datraw, "Control P", "Control N", "Main Plate 1", 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
