<!DOCTYPE html><html lang="en"><head><title>Help for package mratios</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mratios}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mratios-package'>
<p>mratios</p></a></li>
<li><a href='#angina'><p> The angina data set</p></a></li>
<li><a href='#AP'><p> Angina pectoris data</p></a></li>
<li><a href='#ASAT'><p> ASAT data</p></a></li>
<li><a href='#bnct'>
<p>Boron neutron capture therapy (BNCT)</p></a></li>
<li><a href='#BW'><p> Body weights measured in a toxicological study</p></a></li>
<li><a href='#contrMatRatio'><p> Creates numerator and denominator contrast matrices for ratio-based hypotheses for common multiple comparison and trend test problems</p></a></li>
<li><a href='#DiabeticMice'>
<p>Serum albumin of diabetic mice</p></a></li>
<li><a href='#gsci.ratio'><p>Simultaneous confidence intervals for ratios of linear combinations of parameters.</p></a></li>
<li><a href='#mcpqest'>
<p>Point and variance estimation for quantiles of independent groups of samples</p></a></li>
<li><a href='#mcpqrci'>
<p>Simultaneous confidence intervals for contrasts of quantiles</p></a></li>
<li><a href='#Mutagenicity'><p> Mutagenicity assay</p></a></li>
<li><a href='#n.ratio'><p> Sample size computation in simultaneous tests for ratios of means</p></a></li>
<li><a href='#Penicillin'><p>Comparing 6 strains with respect to production of antibiotics</p></a></li>
<li><a href='#plot.sci.ratio'><p> Plot output for sci.ratio and sci.ratio.gen</p></a></li>
<li><a href='#print.sci.ratio'><p> Print function for sci.ratio objects</p></a></li>
<li><a href='#print.simtest.ratio'><p> Print out the results of simtest.ratio</p></a></li>
<li><a href='#rat.weight'><p> Body weight of rats in a toxicity study</p></a></li>
<li><a href='#sci.ratio'><p> Simultaneous confidence intervals for ratios of linear combinations of means</p></a></li>
<li><a href='#sci.ratio.gen'><p> Simultaneous confidence intervals for ratios of coefficients in the general linear model</p></a></li>
<li><a href='#sci.ratioVH'><p> Approximate simultaneous confidence intervals for ratios of means when variances are heterogeneous</p></a></li>
<li><a href='#simtest.ratio'><p> Simultaneous tests for ratios of normal means</p></a></li>
<li><a href='#simtest.ratioVH'><p>Approximate simultaneous tests for ratios of normal means with heterogeneous variances</p></a></li>
<li><a href='#SRAssay'><p> Slope ratio assay of panthotenic acid contents in plant tissues</p></a></li>
<li><a href='#summary.sci.ratio'><p> Summary function for sci.ratio</p></a></li>
<li><a href='#summary.simtest.ratio'><p> Summary function for simtest.ratio</p></a></li>
<li><a href='#ttestratio'><p> t-test for the ratio of two means</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Ratios of Coefficients in the General Linear Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2025-01-08</td>
</tr>
<tr>
<td>Author:</td>
<td>Gemechis Djira [aut],
  Mario Hasler [aut],
  Daniel Gerhard [aut],
  Lawrence Segbehoe [aut],
  Frank Schaarschmidt [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.12.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>nlme</td>
</tr>
<tr>
<td>Imports:</td>
<td>mvtnorm, multcomp, survival, survPresmooth, stats</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs (simultaneous) inferences for ratios of linear combinations of coefficients in the general linear model, linear mixed model, and for quantiles in a one-way layout. Multiple comparisons and simultaneous confidence interval estimations can be performed for ratios of treatment means in the normal one-way layout with homogeneous and heterogeneous treatment variances, according to Dilba et al. (2007) <a href="https://cran.r-project.org/doc/Rnews/Rnews_2007-1.pdf">https://cran.r-project.org/doc/Rnews/Rnews_2007-1.pdf</a> and Hasler and Hothorn (2008) &lt;<a href="https://doi.org/10.1002%2Fbimj.200710466">doi:10.1002/bimj.200710466</a>&gt;. Confidence interval estimations for ratios of linear combinations of linear model parameters like in (multiple) slope ratio and parallel line assays can be carried out. Moreover, it is possible to calculate the sample sizes required in comparisons with a control based on relative margins. For the simple two-sample problem, functions for a t-test for ratio-formatted hypotheses and the corresponding confidence interval are provided assuming homogeneous or heterogeneous group variances.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-09 10:16:37 UTC; Schaarschmidt</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-10 16:10:01 UTC</td>
</tr>
</table>
<hr>
<h2 id='mratios-package'>
mratios
</h2><span id='topic+mratios-package'></span><span id='topic+mratios'></span>

<h3>Description</h3>

<p>With this package, it is possible to perform (simultaneous) inferences for ratios of linear combinations of coefficients in the
general linear model. In particular, tests and confidence interval estimations for ratios of
treatment means in the normal one-way layout and confidence interval estimations like in (multiple) slope ratio
and parallel line assays can be carried out. Moreover, it is possible to calculate the sample sizes required in comparisons
with a control based on relative margins. For the simple two-sample problem, functions for a t-test for ratio-formatted
hypotheses and Fieller confidence intervals are provided assuming homogeneous or
heterogeneous group variances. 
</p>


<h3>Author(s)</h3>

<p>Gemechis Dilba Djira, Mario Hasler, Daniel Gerhard, Frank Schaarschmidt
</p>
<p>Maintainer: Frank Schaarschmidt &lt;schaarschmidt@biostat.uni-hannover.de&gt;
</p>


<h3>References</h3>

<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006).</em>
Simultaneous confidence sets and confidence intervals for multiple ratios.
<em>Journal of Statistical Planning and Inference 136, 2640-2658.</em>
</p>
<p><em> Dilba, G., Bretz, F., Hothorn, L.A., and Guiard, V. (2006).</em>
Power and sample size computations in simultaneous tests for non-inferiority based on relative margins.
<em> Statistics in Medicine 25, 1131-1147.</em>
</p>
<p><em>Dilba, G., Guiard, V., and Bretz, F.</em>
On the efficiency of ratio formatted hypotheses (submitted). 
</p>
<p><em>Kieser, M. and Hauschke, D. (2000).</em>
Statistical methods for demonstrating equivalence in crossover trials based on the ratio of two location parameters.
<em>Drug Information Journal 34, 563-568.</em>
</p>
<p><em>Tamhane, A.C. and Logan, B.R. (2004).</em>
Finding the maximum safe dose level for heteroscedastic data.
<em>Journal of Biopharmaceutical Statistics 14, 843-856.</em>
</p>
<p><em>Hasler, M. and Hothorn, L.A. (2008).</em>
Multiple contrast tests in the presence of heteroscedasticity.
<em>Biometrical Journal 50, 793-800.</em>
</p>


<h3>See Also</h3>

<p>Multiple comparisons for differences of means: <span class="pkg">multcomp</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

############################################################

# # # ttestratio: 
# Two-sample test and confidence interval
# for comparison of means, allowing for heteroscedasticity

data(ASAT)
ASAT
ttestratio(ASAT~group, data=ASAT, alternative="less", base=1,
 rho=1.25, var.equal=TRUE)

data(Mutagenicity)
boxplot(MN~Treatment, data=Mutagenicity)
# It seems to be inappropriate to assume homogeneous variances:

# 1) comparing whether the active control is more effective
# than vehicle control

ttestratio(MN~Treatment,
 data=subset(Mutagenicity, Treatment=="Cyclo25"|Treatment=="Vehicle"),
 alternative="greater", rho=1, var.equal=FALSE)

# 2) lowest dose vs. vehicle control

ttestratio(MN~Treatment,
 data=subset(Mutagenicity, Treatment=="Hydro30"|Treatment=="Vehicle"),
 alternative="greater", rho=1, var.equal=FALSE)


#########################################################

# # # sci.ratio:
# Calculation of simultaneous confidence intervals for ratios
# of linear combinations of treatment means in a one-way ANOVA model

data(BW)
boxplot(Weight~Dose, data=BW)

# Body weights of a 90-day chronic toxicology study on rats
# with a control (1) and three dose groups (2,3,4).

# Calculate upper confidence limits for the ratio of means
# of the three dose groups vs. the control group:
# Which of the doses lead to not more than 90 percent weight loss
# compared to the control group:

m21 &lt;- sci.ratio(Weight~Dose, data=BW, type="Dunnett",
 alternative="greater")

summary(m21)

plot(m21, rho0=0.9)

###########################################################

# # # simtest.ratio: Simultaneous tests for ratios of means 

## Not run: 
data(AP)

boxplot(prepost~treatment, data=AP)

# Test whether the differences of doses 50, 100, 150 vs. Placebo
# are non-inferior to the difference Active Control vs. Placebo 

NC &lt;- rbind(
"(D100-D0)" = c(0,-1,1,0,0),
"(D150-D0)" = c(0,-1,0,1,0),
 "(D50-D0)" = c(0,-1,0,0,1))

DC &lt;- rbind(
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0))

NC
DC

stAP &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 Num.Contrast=NC, Den.Contrast=DC, Margin.vec=c(0.9,0.9,0.9))
summary(stAP)

## End(Not run)

#####################################################################

# # # sci.ratio.gen:
# Simultaneous confidence intervals for ratios of coefficients
# in the general linear model:

# Slope-ratio assay, data from Jensen(1989), Biometrical Journal 31,
# 841-853.

data(SRAssay)
SRAssay

# In this problem, the interest is in simultaneous estimation
# of the ratios of slopes relative to the slope of the standard
# treatment. 

# First it is needed to carefully define the vector of responses 
# and the design matrix of th general linear model:
# The design matrix can be constructed using model.matrix,
# and the vector of the response variable can be extracted
# from the dataframe.

X &lt;- model.matrix(Response~Treatment:Dose, data=SRAssay)
Response &lt;- SRAssay[,"Response"]

# The response vector and the design matrix are:

X
Response

# The following coefficients result:

lm(Response~0+X)

# where the last four coefficients are the estimated slopes
# of the control treatment and the three new treatments

# Contrasts for the ratios of the slopes of the three new treatments
# vs. the control are then defined as:

Num.Contrast &lt;- matrix(c(0,0,1,0,0,
                         0,0,0,1,0,
                         0,0,0,0,1),nrow=3,byrow=TRUE)
Den.Contrast &lt;- matrix(c(0,1,0,0,0,
                         0,1,0,0,0,
                         0,1,0,0,0),nrow=3,byrow=TRUE)


summary(sci.ratio.gen(Y=Response, X=X,
 Num.Contrast=Num.Contrast, Den.Contrast=Den.Contrast))

########################################################################

# # # n.ratio: Sample size computations in comparisons with a
#     control based on relative margins.


  #
  #  Example 1: Sample size calculation in tests for non-inferiority
  #  (two-sample case)(Laster and Johnson (2003),
  #  Statistics in Medicine 22:187-200)

     n.ratio(m=1, rho=0.8, Power=0.8, CV0=0.75, rho.star=1,
     alpha=0.05)


  #
  #  Example 2: Sample size calculation in simultaneous tests for
  #  non-inferiority
  #  (Dilba et al. (2006), Statistics in Medicine 25: 1131-1147)

     n.ratio(m=3, rho=0.7, Power=0.8, CV0=0.5, rho.star=0.95,
     alpha=0.05)

</code></pre>

<hr>
<h2 id='angina'> The angina data set </h2><span id='topic+angina'></span>

<h3>Description</h3>

<p>Dose response study of a drug to treat Angina pectoris. Response variable was the duration of pain-free walking after treatment, relative to the values before treatment. Large values indicate positive effects on patients. 
Data set taken from Westfall et al. (1999), p. 164.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(angina)</code></pre>


<h3>Format</h3>

<p>A data frame with 50 observations on the following 2 variables.
</p>

<dl>
<dt>dose</dt><dd><p>a factor with levels 0, 1, 2, 3, 4</p>
</dd>
<dt>response</dt><dd><p>a numeric vector giving the change from pretreatment as measured
in minutes of pain-free walking.</p>
</dd>
</dl>



<h3>Details</h3>

<p>See Westfall et al. (1999, p. 164)
</p>


<h3>Source</h3>

<p>P. H. Westfall, R. D. Tobias, D. Rom, R. D. Wolfinger, Y. Hochberg
(1999). Multiple Comparisons and Multiple Tests Using the SAS
System. Cary, NC: SAS Institute Inc.
</p>


<h3>References</h3>

<p>angina(multcomp)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(angina)

str(angina)

plot(response~dose, data=angina)

</code></pre>

<hr>
<h2 id='AP'> Angina pectoris data</h2><span id='topic+AP'></span>

<h3>Description</h3>

<p>A data set is generated (from normal distribution) to imitate the summary statistics in Table II of Bauer et al. (1998). 
In the experiment, patients with chronic stable angina pectoris were randomized to five treatment arms (placebo, three doses of a new compound, and an active control).
The primary endpoint is the difference in the duration of an exercise test before and after treatment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(AP)</code></pre>


<h3>Format</h3>

<p>A data frame with 303 observations on the following 2 variables.
</p>

<dl>
<dt>prepost</dt><dd><p>a numeric vector, the difference post treatment measurement minus pre treatment measurement</p>
</dd>
<dt>treatment</dt><dd><p>a factor with levels AC (the active control), D0 (the zero dose, placebo), and D50, D100, D150, the three dose groups of the new compound.</p>
</dd>
</dl>



<h3>Source</h3>

<p><em>Bauer, P., Roehmel, J., Maurer, W., and Hothorn, L. (1998).</em>
Testing strategies in multi-dose experiments including active control.
<em> Statistics in Medicine 17, 2133-2146.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(AP)

str(AP)

boxplot(prepost ~ treatment, data=AP)
by(AP,AP$treatment, function(x){mean(x$prepost)})
by(AP,AP$treatment, function(x){sd(x$prepost)})

</code></pre>

<hr>
<h2 id='ASAT'> ASAT data </h2><span id='topic+ASAT'></span>

<h3>Description</h3>

<p>Data from a toxicity study: ASAT values of the serum of female Wistar rats six months after application </p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ASAT)</code></pre>


<h3>Format</h3>

<p>A data frame with 34 observations on the following 2 variables.
</p>

<dl>
<dt>group</dt><dd><p>a factor with two levels KON, and TREAT, where KON is the control group consisting of 19 subjects and TREAT is the treatment group consisting of only 15 subjects due to mortality </p>
</dd>
<dt>ASAT</dt><dd><p>a numeric vector containing values of the response variable</p>
</dd>
</dl>



<h3>Details</h3>

<p>The objective is to test that ASAT values of treatment group are not relevantly heightened compared to the control group,
where average ASAT value which is more than 25 percent higher than the average of the control group is defined as relevant.
</p>


<h3>Source</h3>

<p><em>Hauschke, D. (1999).</em>
Biometrische Methoden zur Auswertung und Planung von Sicherheitsstudien.
<em> Habilitationsschrift, Fachbereich Statistik, Universtaet Dortmund.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(ASAT)

str(ASAT)
boxplot(ASAT~group, data=ASAT)

</code></pre>

<hr>
<h2 id='bnct'>
Boron neutron capture therapy (BNCT)
</h2><span id='topic+bnct'></span>

<h3>Description</h3>

<p>Death times (in days) from a study to determine the efficacy of BNCT in treating therapeutically refractory F98 glioma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("bnct")</code></pre>


<h3>Format</h3>

<p>A data frame with 30 observations on the following 3 variables.
</p>

<dl>
<dt><code>trt</code></dt><dd><p>a numeric vector: Treatment (1=untreated, 2=radiated, 3=radiated + BPA)</p>
</dd>
<dt><code>time</code></dt><dd><p>a numeric vector: Death time or on-study time, days</p>
</dd>
<dt><code>death</code></dt><dd><p>a numeric vector: Death indicator (1=dead, 0=alive)</p>
</dd>
</dl>



<h3>Details</h3>

<p>A right censored data from a study performed to determine the efficacy of boron neutron capture therapy (BNCT) in treating the therapeutically refractory F98 glioma, using boronophenylalanine (BPA) as the capture agent. F98 glioma cells were implanted into the brains of rats. Three groups of rats each with 10 rats were studied. One group went untreated, another was treated only with radiation, and the third group received radiation plus an appropriate concentration of BPA.
</p>


<h3>Source</h3>

<p>Klein and Moeschberger (2006). <em>Survival Analysis: Techniques for Censored and truncated data,</em> 2nd edition. Springer, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bnct)
 str(bnct)
 
with(bnct, mcpqdci(y = time, f = trt, event = death, TRUE))
with(bnct, mcpqrci(y = time, f = trt, event = death, TRUE))
</code></pre>

<hr>
<h2 id='BW'> Body weights measured in a toxicological study</h2><span id='topic+BW'></span>

<h3>Description</h3>

<p>Body weights of a 90-day chronic toxicological study on rats with a control and three dose groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(BW)</code></pre>


<h3>Format</h3>

<p>A data frame with 60 observations on the following 2 variables.
</p>

<dl>
<dt>Weight</dt><dd><p>a numeric vector containing the bodyweights of rats</p>
</dd>
<dt>Dose</dt><dd><p>a factor with levels 1, 2, 3, 4, specifying the dose groups, where 1 is the control group </p>
</dd>
</dl>



<h3>Source</h3>

<p><em>Hothorn, L.A. (2004):</em>
Statistische Auswerteverfahren. In: <em>Regulatorische Toxikologie (Reichl, F.X., ed.).</em> Springer Verlag Heidelberg, pp. 167-181.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(BW)

str(BW)

boxplot(Weight~Dose, data=BW)


</code></pre>

<hr>
<h2 id='contrMatRatio'> Creates numerator and denominator contrast matrices for ratio-based hypotheses for common multiple comparison and trend test problems </h2><span id='topic+contrMatRatio'></span>

<h3>Description</h3>

<p>Creates numerator and denominator contrast matrices for some common multiple comparison and trend test problems. 
These matrices are internally used by the sci.ratio and simtest.ratio functions. The contrMatRatio function is a modification of the function contrMat (multcomp).
</p>
<p>Whether the given definitions of contrast matrices for trend test problems in terms of ratios make sense and how they are to be interpreted is to be discussed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contrMatRatio(n, type = c("Tukey", "Dunnett", "Sequen",
 "AVE", "GrandMean", "Changepoint", "Marcus", "McDermott", 
 "Williams", "UmbrellaWilliams"), base = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="contrMatRatio_+3A_n">n</code></td>
<td>
<p> integer vector of sample sizes </p>
</td></tr>
<tr><td><code id="contrMatRatio_+3A_type">type</code></td>
<td>
<p>the type of multiple contrasts 
</p>

<ul>
<li> <p><b>&quot;Dunnett&quot;:</b> many to one comparisons, with the control group in the denominator
</p>
</li>
<li> <p><b>&quot;Tukey&quot;:</b> all-pair comparisons 
</p>
</li>
<li> <p><b>&quot;Sequen&quot;:</b> comparison of consecutive groups, where the groups of lower order is the denominator 
</p>
</li>
<li> <p><b>&quot;AVE&quot;:</b> comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li> <p><b>&quot;GrandMean&quot;:</b> comparison of each group with grand mean of all groups, where the grand mean is taken as denominator
</p>
</li>
<li> <p><b>&quot;Changepoint&quot;:</b> ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li> <p><b>&quot;Marcus&quot;:</b> Marcus contrasts defined for ratios 
</p>
</li>
<li> <p><b>&quot;McDermott&quot;:</b> McDermott contrasts for ratios 
</p>
</li>
<li> <p><b>&quot;Williams&quot;:</b> Williams contrasts for ratios 
</p>
</li>
<li> <p><b>&quot;UmbrellaWilliams&quot;:</b> Umbrella-protected Williams contrasts for ratios, i.e.a sequence of Williams-type contrasts with groups of higher order stepwise omitted 
</p>
</li></ul>

</td></tr>
<tr><td><code id="contrMatRatio_+3A_base">base</code></td>
<td>
<p>a single integer specifying the control (i.e. denominator) group for &quot;Dunnett&quot;-type contrasts for calculating the ratios to the control </p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a simple adaption of the contrMat function in the package multcomp for ratio hypotheses.
</p>


<h3>Value</h3>

<p>A list containing:
</p>
<table role = "presentation">
<tr><td><code>numC</code></td>
<td>
<p>the (named) numerator contrast where rows correspond to contrasts </p>
</td></tr> 
<tr><td><code>denC</code></td>
<td>
<p>the (named) denominator contrast where rows correspond to contrasts </p>
</td></tr>
<tr><td><code>rnames</code></td>
<td>
<p> a character vector with names of the contrasts </p>
</td></tr>
</table>
<p>and the type of contrast as attr.
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt and Daniel Gerhard by modifying the code of contrMat(multcomp) </p>


<h3>See Also</h3>

<p> contrMat(multcomp) </p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

n=c(A=10,B=20,Z=10,D=10)

contrMatRatio(n=n, type="Dunnett", base=1)
contrMatRatio(n=n, type="Dunnett", base=3)

contrMatRatio(n=n, type="Tukey")
contrMatRatio(n=n, type="Sequen")
contrMatRatio(n=n, type="AVE")
contrMatRatio(n=n, type="GrandMean")
contrMatRatio(n=n, type="Williams")
contrMatRatio(n=n, type="UmbrellaWilliams")
</code></pre>

<hr>
<h2 id='DiabeticMice'>
Serum albumin of diabetic mice
</h2><span id='topic+DiabeticMice'></span>

<h3>Description</h3>

<p>The amounts of nitrogen-bound bovine serum albumen produced by three groups of diabetic mice
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DiabeticMice")</code></pre>


<h3>Format</h3>

<p>A data frame with 57 observations on the following 2 variables.
</p>

<dl>
<dt><code>group</code></dt><dd><p>a factor with levels <code>alloxan</code> <code>insulin</code> <code>normal</code></p>
</dd>
<dt><code>response</code></dt><dd><p>Amounts of nitrogen-bound bovine serum albumen produced by the mice</p>
</dd>
</dl>



<h3>Details</h3>

<p>The 57 observations of the amounts of nitrogen-bound bovine serum albumen produced by three groups of diabetic mice, these being normal, alloxan diabetic and alloxan diabetic treated with insulin.
</p>


<h3>Source</h3>

<p>Hand, D. J., Daly, F., McConway, K., Lunn, D. and Ostrowski, E. (1994). <em>A Handbook of Small Data Sets.</em> Chapman &amp; Hall/CRC, London.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DiabeticMice)
str(DiabeticMice)
boxplot(response~group, data = DiabeticMice)

y &lt;- DiabeticMice$response
f &lt;- DiabeticMice$group
mcpqdci(y, f)
mcpqrci(y, f)

</code></pre>

<hr>
<h2 id='gsci.ratio'>Simultaneous confidence intervals for ratios of linear combinations of parameters.</h2><span id='topic+gsci.ratio'></span>

<h3>Description</h3>

<p>This function calculates simultaneous confidence intervals for ratios of user-defined linear combinations, given a vector parameter estiamtes and a corresponding variance-covariance matrix.
Beside unadjusted intervals, multiplicity adjustments are available using quantiles of a multivariate Normal- or t-distribution. The function provides a more general, but less user-friendly function to calculate ratios of mean parameters from linear (mixed models).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gsci.ratio(est, vcmat, Num.Contrast, Den.Contrast,
 degfree = NULL, conf.level = 0.95, alternative = "two.sided",
 adjusted = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gsci.ratio_+3A_est">est</code></td>
<td>
<p>A numeric vector of parameter estimates, for example coefficients of a linear model</p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_vcmat">vcmat</code></td>
<td>
<p>The corresponding variance-covariance matrix (Number of rows and columns should be the same as the length of the parameter vector)</p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p>Numerator contrast matrix, where the number of columns must be the same as the length of the parameter vector, and each row represents one contrast</p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p>Denominator contrast matrix, where the number of columns must be the same as the length of the parameter vector, and each row represents one contrast</p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_degfree">degfree</code></td>
<td>
<p>Degrees of freedom used for calculating quantiles of a (multivariate) t-distribution. If NULL, Normal approximations are used</p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_conf.level">conf.level</code></td>
<td>
<p>Simultaneous confidence level in case of <kbd>adjusted == TRUE</kbd>, and comparisonwise confidence level in case of <kbd>adjusted == FALSE</kbd></p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_alternative">alternative</code></td>
<td>
<p>a character string: <kbd>"two.sided"</kbd> for two-sided intervals, <kbd>"less"</kbd> for upper confidence limits, <kbd>"greater"</kbd> for lower confidence limits </p>
</td></tr>
<tr><td><code id="gsci.ratio_+3A_adjusted">adjusted</code></td>
<td>
<p>If <kbd>TRUE</kbd>, the simultaneous confidence level is controlled, otherwise the comparisonwise confidence level is used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a parameter vector and its corresponding covariance matrix from a linera model fit, approximate simultaneous confidence intervals for several ratios of linear combinations of these parameters are calculated.
For simultaneous confidence intervals (adjusted=TRUE) the plug-in method is used (plugging the maximum likelihood estimates of the ratios to obtain the correlation matrix for calculating quantiles of a multivariate t or normal distribution).
</p>
<p>Linear combinations can be defined by providing matrices for the nominator and the denominator; some pre-defined contrasts can be constructed by the function contrMatRatio. (These may be weighted for different sample sizes.)
</p>


<h3>Value</h3>

<p>An object of class &quot;sci.ratio&quot; and &quot;gsci.ratio&quot;, containing a list with elements:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>point estimates of the ratios</p>
</td></tr>
<tr><td><code>CorrMat.est</code></td>
<td>
<p>estimate of the correlation matrix</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval estimates of the ratios</p>
</td></tr>
</table>
<p>And some further elements to be passed to print and summary functions.
</p>


<h3>Author(s)</h3>

<p>Daniel Gerhard &amp; Frank Schaarschmidt adapting code of Gemechis Dilba Djira</p>


<h3>References</h3>

<p> The general methodology of constructing inference for ratios of linear model parameters can be found in:
</p>
<p><em>Zerbe G.O., (1978):</em> On Fieller's Theorem and the General Linear Model. The American Statistician 32(3), 103-105.
</p>
<p><em>Young D.A., Zerbe G.O., Hay W.W. (1997):</em> Fieller's Theorem, Scheffe's simultaneous confidence intervals, and ratios of parameters of linear and nonlinear mixed-effect models. Biometrics 53(3), 835-847.
</p>
<p><em>Djira G.D.(2010)</em>: Relative Potency Estimation in Parallel-Line Assays - Method Comparison and Some Extensions. Communications in Statistics - Theory and Methods 39(7), 1180-1189.
</p>
<p>However, when <code>adjusted=TRUE</code>, the quantiles are not obtained as described in Zerbe(1978) or Young et al. (1997), but by adapting the 'plug-in' method described for the completely randomized one-way layout in 
</p>
<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006):</em> Simultaneous confidence sets and confidence intervals for multiple ratios. Journal of Statistical Planning and Inference 136, 2640-2658.
</p>
<p>A simulation study of the performance of these methods in linear mixed models:
</p>
<p><em>Schaarschmidt and Djira(2016):</em> Simultaneous Confidence Intervals for Ratios of Fixed Effect Parameters in Linear Mixed Models.
Communications in Statistics - Simulation and Computation 45:5, 1704-1717. DOI: 10.1080/03610918.2013.849741
</p>


<h3>See Also</h3>

<p>glht(multcomp) for simultaneous CI of differences of means, and function sci.ratio.gen(mratios)</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

##############################################################

# A 90-days chronic toxicity assay:
# Which of the doses (groups 2,3,4) do not show a decrease in
# bodyweight more pronounced than 90 percent of the bodyweight
# in the control group?

#############################################################

data(BW)
boxplot(Weight~Dose,data=BW)

lmfit &lt;- lm(Weight~Dose-1, data=BW)
est &lt;- coefficients(lmfit)
vc &lt;- vcov(lmfit)
CMAT &lt;- contrMatRatio(table(BW$Dose), type="Dunnett")

BWnoninf &lt;- gsci.ratio(est, vc, CMAT$numC, CMAT$denC,
 alternative="greater", degfree=lmfit$df.residual)

BWnoninf

# Plot
plot(BWnoninf, rho0=0.9)

##############################################################

#### Mixed Model Example

##############################################################

library("nlme")
data(Milk)

# Fit a linear mixed model (maybe there are nicer models available!)

lmefit &lt;- lme(protein ~ Diet-1, data=Milk,
 random=~Time|Cow, correlation=corAR1(form=~Time|Cow))

# Extract the parameter estimates and the corresponding
# variance-covariance matrix

estm &lt;- fixef(lmefit)
vcm &lt;- vcov(lmefit)


# Define the matrices defining the ratios of interest for
# all-pair comparisons: CM is the numerator matrix and 
# DM is the denominator matrix.

CM &lt;- rbind(c(1,0,0),
            c(1,0,0),
            c(0,1,0))
DM &lt;- rbind(c(0,1,0),
            c(0,0,1),
            c(0,0,1))

# Add some row names (This is optional!)

rownames(CM) &lt;- c("b/b+l", "b/l", "b+l/l")

# Calculate and plot simultaneous confidence intervals:

gscimix &lt;- gsci.ratio(estm, vcm, CM, DM, degfree=anova(lmefit)[,2])
plot(gscimix)

</code></pre>

<hr>
<h2 id='mcpqest'>
Point and variance estimation for quantiles of independent groups of samples
</h2><span id='topic+mcpqest'></span>

<h3>Description</h3>

<p>Computes the pth quantile and variances for groups of given samples in one-way anova layout. It has option for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcpqest(y, f, event = NULL, 
Right.Censored = FALSE, p = 0.5, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcpqest_+3A_y">y</code></td>
<td>

<p>a numeric vector, the response variable. If Right.Censored = True, y is non-negative follow up time for
right censored in survival data.
</p>
</td></tr>
<tr><td><code id="mcpqest_+3A_f">f</code></td>
<td>

<p>a factor variable of the same length as y, assigning the observations in y into k groups.
</p>
</td></tr>
<tr><td><code id="mcpqest_+3A_event">event</code></td>
<td>

<p>a binary variable indicating status for right censored data. Usually, 1 if event of interest has occurred
(death = 1) and 0 otherwise (alive = 0).
</p>
</td></tr>
<tr><td><code id="mcpqest_+3A_right.censored">Right.Censored</code></td>
<td>

<p>a logical expression indicating right-censored data is being used for constructing simultaneous
confidence interval.
</p>
</td></tr>
<tr><td><code id="mcpqest_+3A_p">p</code></td>
<td>

<p>a single numeric value between 0 and 1 indicating the level of quantile for the contrasts. The default
is p = 0.5 (the median).
</p>
</td></tr>
<tr><td><code id="mcpqest_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to the internal methods, in particular: <code>bw.selec</code> is a single character
string specifying the method of bandwidth selection when using right censored survival data; 
<code>bw.selec= "plug-in"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Mainly for internal use.
</p>


<h3>Value</h3>

<p>a list with elements:
</p>
<table role = "presentation">
<tr><td><code>quantileEST</code></td>
<td>
<p>a numeric vector, the point estimates of quantiles for each factor level.</p>
</td></tr>
<tr><td><code>varEST</code></td>
<td>
<p>a numeric vector, the variance estimates for each factor level.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>a numeric vector, the sample size of each factor level</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lawrence S. Segbehoe, Gemechis Dilba Djira,  Frank Schaarschmidt (package inclusion)
</p>

<hr>
<h2 id='mcpqrci'>
Simultaneous confidence intervals for contrasts of quantiles
</h2><span id='topic+mcpqrci'></span><span id='topic+mcpqdci'></span>

<h3>Description</h3>

<p>The following functions construct simultaneous confidence intervals for multiple constrasts of quantiles (for ratios and differences) in a one-way layout. 
The &quot;mcpqrci&quot; is for ratios and &quot;mcpqdci&quot; is for differences of quantiles. Both functions have also options for right censored data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mcpqrci(y, f, event = NULL, Right.Censored = FALSE,
p = 0.5, conf.level = 0.95, type = "Dunnett",
base = 1, Num.cmat = NULL, Den.cmat = NULL,
method = c("Wald", "Fieller"), ...)

mcpqdci(y, f, event = NULL, Right.Censored = FALSE,
p = 0.5, conf.level = 0.95, type = "Dunnett", 
base = 1 , cmat = NULL,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mcpqrci_+3A_y">y</code></td>
<td>

<p>a numeric vector, the response variable. If <code>Right.Censored = TRUE</code>, y is non-negative follow up time for right censored in survival data.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_f">f</code></td>
<td>

<p>a factor variable of the same length as y, assigning the observations in y into k groups.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_event">event</code></td>
<td>

<p>a binary variable indicating status for right censored data. Usually, 1 if event of interest has occurred (death = 1) and 0 otherwise (alive = 0); (optional: only if y is survival data).
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_right.censored">Right.Censored</code></td>
<td>

<p>a logical expression indicating right-censored data is being used for constructing simultaneous confidence intervals, (optional: only if y is survival data).
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_p">p</code></td>
<td>

<p>a single numeric value between 0 and 1 indicating the level of quantile for the contrasts. The default is p = 0.5 (the median).
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_conf.level">conf.level</code></td>
<td>

<p>a single numeric value between 0 and 1 indicating the level of confidence interval.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_type">type</code></td>
<td>

<p>a single character string, naming a contrast type, see contrMat and contrMatRatio, for the options; this argument is ignored if a contrast matrix is specified in cmat or Num.cmat and Den.cmat.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_base">base</code></td>
<td>

<p>a positive integer specifying the control group for the Dunnett contrasts, ignored otherwise. When base is not given the first group in terms of an alphanumeric order is taken as the control group.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_cmat">cmat</code></td>
<td>

<p>(optional) a matrix with numeric entries, containing contrast coefficients defining differences of quantiles in function <code>mcpqdci</code>; if there are k levels in f, the matrix should have k columns. type is ignored if cmat is specified
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_num.cmat">Num.cmat</code></td>
<td>

<p>(optional) Numerator contrast matrix for ratios of quantiles in function <code>mcpqrci</code>, where the columns correspond to k groups and rows correspond to m contrasts.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_den.cmat">Den.cmat</code></td>
<td>

<p>(optional) Denominator contrast matrix for ratios of quantiles in function <code>mcpqrci</code>, where the columns correspond to k groups and rows correspond to m contrasts. type is ignored if Den.cmat and Den.cmat is specified.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_method">method</code></td>
<td>

<p>a single character string, naming the method by which to compute the confidence intervals for ratios of quantiles. Default is &quot;Wald&quot;. Note if the calculated lower confidence limit is negative and the ratio cannot be negative, set the lower confidence limit to zero.
</p>
</td></tr>
<tr><td><code id="mcpqrci_+3A_...">...</code></td>
<td>

<p>further arguments to be passed to the internal methods, in particular: dist must be a single character string invoking the use of multivariate normal quantiles; <code>dist="MVN"</code> or multivariate normal quantiles; <code>dist="MVT"</code>. <code>bw.selec</code> is a single character string specifying the method of bandwidth selection when using right censored survival data; <code>bw.selec = "plug-in"</code>.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The interest is to construct simultaneous confidence intervals for several contrast of quantiles in a one-way layout. An asymptotic approach is used in estimating the variance of estimated quantiles. The <code>mcpqrci</code> handles ratios of multiple contrasts of quantiles and 
<code>mcpqdci</code> handles differences of multiple contrast of quantiles.
</p>
<p>If <code>event</code> argument is provided and <code>Right.Censored = TRUE</code>, the functions computes simultaneous confidence intervals for right censored data in y. 
The type argument defines the type of contrast matrix to use. Users can also define a preferred contrast matrix, cmat.
</p>


<h3>Value</h3>

<p>a list with elements
</p>
<table role = "presentation">
<tr><td><code>cmat</code></td>
<td>
<p>Matrix of contrast used for contrast differences.</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>Matrix of contrast used for the numerator of ratios.</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>Matrix of contrast used for the denominator of ratios.</p>
</td></tr>
<tr><td><code>conf.level</code></td>
<td>
<p>A numeric value, as input.</p>
</td></tr>
<tr><td><code>estimate</code></td>
<td>
<p>a column vector, containing the point estimates of the contrasts.</p>
</td></tr>
<tr><td><code>std.err</code></td>
<td>
<p>a column vector, containing the standard error of the contrast estimates.</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>a Mx2 matrix of confidence bounds, if M comparisons among the K samples are invoked.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Lawrence S. Segbehoe, Gemechis Dilba Djira, and Frank schaarschmidt (inclusion in the package)
</p>


<h3>See Also</h3>

<p><code>sciratio</code> for simultaneous confidence intervals for ratios of linear combinations of means
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data("DiabeticMice")
response &lt;- DiabeticMice$response
group &lt;- DiabeticMice$group
## Example 1
Num.cmat &lt;- matrix(c(1,1,0,0,0,1,0,0,0),3)
Den.cmat &lt;- matrix(c(0,0,0,1,0,0,0,1,1),3)
mcpqdci(y = response, f = group, cmat = (Num.cmat + -1*Den.cmat))
mcpqdci(y = response, f = group, cmat = (Num.cmat + -1*Den.cmat)[-1,])
mcpqrci(y = response, f = group, Num.cmat = Num.cmat, Den.cmat = Den.cmat )
mcpqrci(y = response, f = group, Num.cmat = Num.cmat[-1,], Den.cmat = Den.cmat[-1,] )


## Example 2 

data("bnct")
mcpqrci(y = bnct$time, f = bnct$trt, event = bnct$death, Right.Censored=TRUE)

## Sampled data:

y &lt;- c(rnorm(20),rnorm(16,3),rnorm(24,7,2))
f &lt;- rep(paste0("group", 1:3), c(20,16, 24))
event &lt;- rbinom(60,1,0.8)

mcpqdci(y=y, f=f, method = "Fieller", base = 3)


# mcpqrci(y=abs(y), f=f, event=event, Right.Censored=TRUE,
# Num.cmat = cbind(c(1,1), 0*diag(2)),
# Den.cmat = cbind(c(0,0), diag(2)))


cmat &lt;- cbind(-c(1,1),diag(2))
mcpqdci(y=y, f=f, method = "Fieller", cmat = cmat)
</code></pre>

<hr>
<h2 id='Mutagenicity'> Mutagenicity assay </h2><span id='topic+Mutagenicity'></span>

<h3>Description</h3>

<p>Mutagenicity assay for 4 doses of a compound (hydroquinone) against a negative (vehicle) control and a positive (active) control (cyclophosphamide). 
Hydroquinone was applied in doses of 30, 50, 70, 100 mg/kg, positive control was applied with 25mg/kg.
Counts of micronuclei in polychromatic erythrocytes after 24h are taken as a measure for the potency to induce chromosome damage. Data of male mice are presented
(Hauschke et al., 2005).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Mutagenicity)</code></pre>


<h3>Format</h3>

<p>A data frame with 31 observations on the following 2 variables.
</p>

<dl>
<dt>Treatment</dt><dd><p>a factor with levels Cyclo25, Hydro100, Hydro30, Hydro50, Hydro75, Vehicle</p>
</dd>
<dt>MN</dt><dd><p>a numeric vector, giving the counts of micronuclei after 24h</p>
</dd>
</dl>



<h3>Source</h3>

<p><em>Adler, ID, and Kliesch, U (1990).</em>
Comparison of single and multiple treatment regiments in the mouse bone marrow micronucleus assay for hydroquinone and cyclophosphamide.
<em>Mutation Research 234, 115-123.</em>
</p>


<h3>References</h3>

<p><em>Hauschke, D, Slacik-Erben, R, Hansen, S, Kaufmann,R (2005).</em>
Biostatistical Assessment of mutagenicity studies by including the positive control.
<em>Biometrical Journal 47, 82-87.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Mutagenicity)

str(Mutagenicity)

boxplot(MN~Treatment, data=Mutagenicity)

</code></pre>

<hr>
<h2 id='n.ratio'> Sample size computation in simultaneous tests for ratios of means </h2><span id='topic+n.ratio'></span>

<h3>Description</h3>

<p>Computes the sample sizes required in simultaneous tests for non-inferiority (or superiority)
based on relative margins in multiple comparisons with a control.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>n.ratio(m, rho, Power, CV0, rho.star, alpha, Min.power = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="n.ratio_+3A_m">m</code></td>
<td>
<p>  number of comparisons with a control group </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_rho">rho</code></td>
<td>
<p> relative non-inferiority (or superiority) margin </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_power">Power</code></td>
<td>
<p> given power (1-beta) </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_cv0">CV0</code></td>
<td>
<p> coefficient of variation of the control group </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_rho.star">rho.star</code></td>
<td>
<p> the percentage (of the mean of the control group) to be detected </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_alpha">alpha</code></td>
<td>
<p> familywise error rate </p>
</td></tr>
<tr><td><code id="n.ratio_+3A_min.power">Min.power</code></td>
<td>
<p> if set to TRUE (by default), the minimal power will be controlled,
otherwise complete power </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The sample sizes are computed at the least favourable configurations, based on the assumption
of no prior information regarding the true configuration of the ratios under the alternative
hypotheses. The formula is
</p>
<p><code class="reqn"> n = ((C_1 + C_2)^2) (1 + \rho^2)/((\rho - \rho^*)^2) CV0^2 </code>,
</p>
<p>where <code class="reqn">C_1</code> is the lower <code class="reqn">1-\alpha</code> equi-coordinate percentage point of an m-variate normal distribution 
and <code class="reqn">C_2</code> is the quantile of univariate (multivariate) normal distribution depending on the type of power 
controlled. In tests for non-inferiority (or superiority) with large response values indicating better
treatment benefit, <code class="reqn">\rho &lt; \rho^* </code>, where <code class="reqn">\rho &lt; 1</code> for non-inferiority and <code class="reqn">\rho &gt; 1</code> for superiority testing. 
Whereas, if small response values indicate better treatment benefit, <code class="reqn">\rho^* &lt; \rho</code>, where <code class="reqn">\rho &gt; 1</code> for non-inferiority 
and <code class="reqn">\rho &lt; 1</code> for superiority testing.                                                                                                  
</p>


<h3>Author(s)</h3>

<p> Gemechis Dilba Djira </p>


<h3>References</h3>

<p><em> Dilba, G., Bretz, F., Hothorn, L.A., and Guiard, V. (2006).</em>
Power and sample size computations in simultaneous tests for non-inferiority based on relative margins.
<em> Statistics in Medicine 25, 1131-1147.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

  #
  #  Example 1: Sample size calculation in tests for non-inferiority
  #  (two-sample case)(Laster and Johnson (2003),
  #  Statistics in Medicine 22:187-200)

     n.ratio(m=1, rho=0.8, Power=0.8, CV0=0.75, rho.star=1,
     alpha=0.05)


  #
  #  Example 2: Sample size calculation in simultaneous tests for
  #  non-inferiority
  #  (Dilba et al. (2006), Statistics in Medicine 25:1131-1147)

     n.ratio(m=3, rho=0.7, Power=0.8, CV0=0.5, rho.star=0.95,
     alpha=0.05)


  #
  #  Example 3: Controlling complete power
  #

     n.ratio(m=5, rho=1.2, Power=0.8, CV0=0.2, rho.star=1.40,
         alpha=0.05, Min.power=FALSE)

</code></pre>

<hr>
<h2 id='Penicillin'>Comparing 6 strains with respect to production of antibiotics </h2><span id='topic+Penicillin'></span>

<h3>Description</h3>

<p>The production of antibiotics of 6 strains (mutants of the same micro organism) was compared. MO were put to holes in agar infected with Bacteria.
The diameter of Baceria-free areas around the colonies of the MO was recorded. Each strain was repeated 8 times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Penicillin)</code></pre>


<h3>Format</h3>

<p>A data frame with 48 observations on the following 2 variables.
</p>

<dl>
<dt>strain</dt><dd><p>a numeric veactor, the number identifying the strains</p>
</dd>
<dt>diameter</dt><dd><p>a numeric vector, size of the diameter of Bacteria-free area around each colony</p>
</dd>
</dl>



<h3>Source</h3>

<p><em> Horn, M, Vollandt, R (1995).</em>
Multiple Tests und Auswahlverfahren in Biomtrie <em>(Lorenz, RJ, Vollmar, J, eds).</em>
Gustav Fischerverlag, Stuttgart Jena New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(Penicillin)

str(Penicillin)

boxplot(diameter ~ strain, data=Penicillin)

</code></pre>

<hr>
<h2 id='plot.sci.ratio'> Plot output for sci.ratio and sci.ratio.gen </h2><span id='topic+plot.sci.ratio'></span>

<h3>Description</h3>

<p>Plot the intervals returned by sci.ratio
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sci.ratio'
plot(x, rho0 = 1, rho0lty=2, rho0lwd=1, rho0col="black",
 CIvert = FALSE, CIlty = 1, CIlwd = 1, CIcex = 1, CIpch=16,
 main = NULL, ylab = NULL, xlab = NULL, sub = NULL, length=NULL,
 sortby=NULL, decreasing=NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sci.ratio_+3A_x">x</code></td>
<td>
<p> an object of class &quot;sci.ratio&quot; as can be obtained by calling the function sci.ratio</p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_rho0">rho0</code></td>
<td>
<p> a single numeric value or vector of values defining the hypothesized ratio </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_rho0lty">rho0lty</code></td>
<td>
<p> integer values to specify the line type for the rho0 line(s) </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_rho0lwd">rho0lwd</code></td>
<td>
<p> integer values to specify the line width for the rho0 line(s) </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_rho0col">rho0col</code></td>
<td>
<p> character vector to specify the colour for the rho0 line(s) </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_civert">CIvert</code></td>
<td>
<p> logical, CI are plotted horizontal if CIvert=FALSE and vertical otherwise </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_cilty">CIlty</code></td>
<td>
<p> numeric value, giving the line type of the plotted confidence interval, see argument lty in ?par </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_cilwd">CIlwd</code></td>
<td>
<p> numeric value, giving the line width of the plotted confidence interval, see argument lwd in ?par </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_cicex">CIcex</code></td>
<td>
<p> a single numeric value: by which amount the symbols in the CI shall be scaled relative to the default (see argument cex in ?par) </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_cipch">CIpch</code></td>
<td>
<p> the symbol to be used for the point estimate, see pch in ?points</p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_main">main</code></td>
<td>
<p> character string to be plotted as main title of the plot </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_ylab">ylab</code></td>
<td>
<p> character string, label of the y axis (ignored if CIvert=TRUE) </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_xlab">xlab</code></td>
<td>
<p> character string, label of the x axis (ignored if CIvert=FALSE)  </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_sub">sub</code></td>
<td>
<p> as in plot </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_length">length</code></td>
<td>
<p> a numeric value, specifying the length/2 of the bars at the ends of the confidence intervals in inches </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_sortby">sortby</code></td>
<td>
<p> a character string, one of &quot;estimate&quot;, &quot;lower, or &quot;upper&quot;; if specified, the results are ordered by magnitude of estimates, lower or upper limits  </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_decreasing">decreasing</code></td>
<td>
<p> logical, to be passed to <code>order</code>, if <code>sortby</code> is specified, ignored otherwise </p>
</td></tr>
<tr><td><code id="plot.sci.ratio_+3A_...">...</code></td>
<td>
<p> further arguments to be passed to <code>axis()</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Too long names of the contrasts/comparisons should be avoided, otherwise use par() to change plot parameters.
</p>


<h3>Value</h3>

<p>A plot of the confidence intervals in the sci.ratio object.
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

<p> plot.hmtest(multcomp) </p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(angina)

aCI&lt;-sci.ratio(response~dose, data=angina, type="Dunnett",
 alternative="greater")

# Visualize testing for superiority

plot(aCI, rho0=1.25, rho0lty=3)



</code></pre>

<hr>
<h2 id='print.sci.ratio'> Print function for sci.ratio objects </h2><span id='topic+print.sci.ratio'></span>

<h3>Description</h3>

<p>A short print out of the value of a sci.ratio object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sci.ratio'
print(x, digits=4,...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.sci.ratio_+3A_x">x</code></td>
<td>
<p> an object of class &quot;sci.ratio&quot; as can be obtained by calling the function sci.ratio</p>
</td></tr>
<tr><td><code id="print.sci.ratio_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the output</p>
</td></tr>
<tr><td><code id="print.sci.ratio_+3A_...">...</code></td>
<td>
<p>arguments to be passed to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out of the confidence intervals computed by sci.ratio.
</p>


<h3>See Also</h3>

 <p><a href="#topic+plot.sci.ratio">plot.sci.ratio</a>, <a href="#topic+summary.sci.ratio">summary.sci.ratio</a> </p>

<hr>
<h2 id='print.simtest.ratio'> Print out the results of simtest.ratio  </h2><span id='topic+print.simtest.ratio'></span>

<h3>Description</h3>

<p>A short print out of the results of simtest.ratio
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simtest.ratio'
print(x, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.simtest.ratio_+3A_x">x</code></td>
<td>
<p> An object of class &quot;simtest.ratio&quot; as obtained by calling simtest.ratio </p>
</td></tr>
<tr><td><code id="print.simtest.ratio_+3A_digits">digits</code></td>
<td>
<p> digits for rounding of the results </p>
</td></tr>
<tr><td><code id="print.simtest.ratio_+3A_...">...</code></td>
<td>
<p>arguments to be passed to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out, containing the margins, estimates, teststatistics, and p.values computed by simtest.ratio. 
</p>

<hr>
<h2 id='rat.weight'> Body weight of rats in a toxicity study </h2><span id='topic+rat.weight'></span>

<h3>Description</h3>

<p>Body weights of male rats were compared between a control group and a group which had received a high dose of a chemical in a toxicity study after a period of recovery
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(rat.weight)</code></pre>


<h3>Format</h3>

<p>A data frame with 20 observations on the following 2 variables.
</p>

<dl>
<dt>group</dt><dd><p>a factor with two levels, Dosis and Kon, where Dosis is the high dose group, consisiting of ten individulas and Kon is the control group, consisting of ten individuals</p>
</dd>
<dt>weight</dt><dd><p>a numeric vector containing the values of response variable, final body weight in gramm</p>
</dd>
</dl>



<h3>Details</h3>

<p>Aim was to test that application of the chemical does not lead to a relevantly lowered or heightened body weight after a time of recovery. 0.8 and 1.25 were defined as relevance boundaries compared to the mean of control group </p>


<h3>Source</h3>

<p><em>Hauschke, D. (1999).</em>
Biometrische Methoden zur Auswertung und Planung von Sicherheitsstudien.
<em>Habilitationsschrift, Fachbereich Statistik, Universtaet Dortmund.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(rat.weight)
boxplot(weight~group, data=rat.weight)

</code></pre>

<hr>
<h2 id='sci.ratio'> Simultaneous confidence intervals for ratios of linear combinations of means </h2><span id='topic+sci.ratio'></span><span id='topic+sci.ratioI'></span>

<h3>Description</h3>

<p>This function constructs simultaneous confidence intervals for ratios of linear combinations of normal means in a one-way ANOVA model.
Different methods are available for multiplicity adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sci.ratio(formula, data, type = "Dunnett", base = 1,
 method = "Plug", Num.Contrast = NULL, Den.Contrast = NULL,
 alternative = "two.sided", conf.level = 0.95, names=TRUE)

</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sci.ratio_+3A_formula">formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor as e.g. <kbd>response ~ treatment</kbd> </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_data">data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_type">type</code></td>
<td>
<p> type of contrast, with the following options:
</p>

<ul>
<li> <p><b>&quot;Dunnett&quot;:</b> many-to-one comparisons, with the control group in the denominator
</p>
</li>
<li> <p><b>&quot;Tukey&quot;:</b> all-pair comparisons 
</p>
</li>
<li> <p><b>&quot;Sequen&quot;:</b> comparison of consecutive groups, where the group with lower order is the denominator
</p>
</li>
<li> <p><b>&quot;AVE&quot;:</b> comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li> <p><b>&quot;GrandMean&quot;:</b> comparison of each group with grand mean of all groups, where the grand mean is taken as denominator
</p>
</li>
<li> <p><b>&quot;Changepoint&quot;:</b> ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li> <p><b>&quot;Marcus&quot;:</b> Marcus contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;McDermott&quot;:</b> McDermott contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;Williams&quot;:</b> Williams contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;UmbrellaWilliams&quot;:</b> Umbrella-protected Williams contrasts as ratios
</p>
</li></ul>

<p>Note: <kbd>type</kbd> is ignored, if <kbd>Num.Contrast</kbd> and <kbd>Den.Contrast</kbd> are specified by the user (See below).
</p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_method">method</code></td>
<td>
 
<p>character string specifying the method to be used for confidence interval construction:
</p>

<ul>
<li> <p><b>&quot;Plug&quot;:</b> Plug-in of ratio estimates in the correlation matrix of the multivariate t distribution. This method is the default.
</p>
</li>
<li> <p><b>&quot;Bonf&quot;:</b> Simple Bonferroni-adjustment of Fieller confidence intervals for the ratios 
</p>
</li>
<li> <p><b>&quot;MtI&quot;:</b> Sidak or Slepian- adjustment for two-sided and one-sided confidence intervals, respectively  
</p>
</li>
<li> <p><b>&quot;Unadj&quot;:</b> Unadjusted Fieller confidence intervals for the ratios (i.e. with comparisonwise confidence level = conf.level) 
</p>
</li></ul>

</td></tr>
<tr><td><code id="sci.ratio_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_alternative">alternative</code></td>
<td>
<p> a character string: &quot;two.sided&quot; for two-sided intervals, &quot;less&quot; for upper confidence limits, &quot;greater&quot; for lower confidence limits </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_conf.level">conf.level</code></td>
<td>
<p> simultaneous confidence level in case of method=&quot;Plug&quot;,&quot;Bonf&quot;, or &quot;MtI&quot;, and comparisonwise confidence level in case of method=&quot;Unadj&quot; </p>
</td></tr>
<tr><td><code id="sci.ratio_+3A_names">names</code></td>
<td>
<p>logical, indicating whether rownames of the contrast matrices shall be retained in the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a one-way ANOVA model, the interest is in simultaneous confidence intervals
for several ratios of linear combinations of the treatment means. It is assumed that the
responses are normally distributed with homogeneous variances. Unlike in multiple testing
for ratios, the joint distribution of the likelihood ratio statistics has a multivariate t-distribution
the correlation matrix of which depends on the unknown ratios. This means that the critical
point needed for CI calculations also depends on the ratios. There are various methods
of dealing with this problem (for example, see Dilba et al., 2006). The methods include (i) the unadjusted
intervals (Fieller confidence intervals without multiplicity adjustments), (ii) Bonferroni (Fieller
intervals with simple Bonferroni adjustments), (iii) MtI (a method based on Sidak and Slepian
inequalities for two- and one-sided confidence intervals, respectively), and (iv) plug-in (plugging
the maximum likelihood estimates of the ratios in the unknown correlation matrix). The latter
method is known to have good simultaneous coverage probabilities. The MtI method consists
of replacing the unknown correlation matrix of the multivariate t by an identity matrix of the
same dimension.
</p>
<p>See the examples for the usage of Numerator and Denominator contrasts.
Note that the argument names Num.Contrast and Den.Contrast need to be specified. If numerator and denominator contrasts are plugged in without
their argument names, they will not be recognized.  
</p>


<h3>Value</h3>

<p>An object of class &quot;sci.ratio&quot;, containing a list with elements:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>point estimates of the ratios</p>
</td></tr>
<tr><td><code>CorrMat.est</code></td>
<td>
<p>estimate of the correlation matrix (for the plug-in approach)</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval estimates of the ratios</p>
</td></tr>
</table>
<p>And some further elements to be passed to print and summary functions.
</p>


<h3>Author(s)</h3>

<p> Gemechis Dilba Djira</p>


<h3>References</h3>

 
<p>Dilba, G., Bretz, F., and Guiard, V. (2006): Simultaneous confidence sets and confidence intervals for multiple ratios. Journal of Statistical Planning and Inference 136, 2640-2658.
</p>


<h3>See Also</h3>

 <p><kbd>glht(multcomp)</kbd> for simultaneous CI of differences of means,
<a href="#topic+plot.sci.ratio">plot.sci.ratio</a> for a plotting function of the intervals </p>


<h3>Examples</h3>

<pre><code class='language-R'>

# # #

# A 90-days chronic toxicity assay: 
# Which of the doses (groups 2,3,4) do not show a decrease in
# bodyweight more pronounced than 90 percent of the bodyweight
# in the control group?

data(BW)

boxplot(Weight~Dose,data=BW)

BWnoninf &lt;- sci.ratio(Weight~Dose, data=BW, type="Dunnett",
 alternative="greater")

plot(BWnoninf, rho0=0.9)

## Not run: 
# # #

# Antibiotic activity of 8 different strains of a micro organisms.
# (Horn and Vollandt, 1995): 

data(Penicillin)

boxplot(diameter~strain, data=Penicillin)

allpairs&lt;-sci.ratio(diameter~strain, data=Penicillin, type="Tukey")
plot(allpairs)
summary(allpairs)


## End(Not run)

</code></pre>

<hr>
<h2 id='sci.ratio.gen'> Simultaneous confidence intervals for ratios of coefficients in the general linear model </h2><span id='topic+sci.ratio.gen'></span>

<h3>Description</h3>

<p>Constructs simultaneous confidence intervals for multiple ratios of linear combinations of coefficients in the general linear model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sci.ratio.gen(Y, X, Num.Contrast, Den.Contrast,
 alternative = "two.sided", conf.level = 0.95,
 method="Plug")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sci.ratio.gen_+3A_y">Y</code></td>
<td>
<p> A numerical vector, containing the values of the response variable </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_x">X</code></td>
<td>
<p> A design matrix for the the linear model, defining the parameters to be estimated, must have same number of rows as Y </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_alternative">alternative</code></td>
<td>
<p> one of &quot;two.sided&quot;, &quot;less&quot;, or &quot;greater&quot; </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_conf.level">conf.level</code></td>
<td>
<p> simultaneous confidence levels </p>
</td></tr>
<tr><td><code id="sci.ratio.gen_+3A_method">method</code></td>
<td>
 
<p>character string, specifying the method for confidence interval calculation:
</p>

<ul>
<li> <p><b>&quot;Plug&quot;:</b> Plug-in of ratio estimates in the correlation matrix of the multivariate t distribution. This method is the default.
</p>
</li>
<li> <p><b>&quot;Bonf&quot;:</b> Simple Bonferroni-adjustment of Fieller confidence intervals for the ratios 
</p>
</li>
<li> <p><b>&quot;MtI&quot;:</b> Sidak or Slepian- adjustment for two-sided and one-sided confidence intervals, respectively  
</p>
</li>
<li> <p><b>&quot;Unadj&quot;:</b> Unadjusted Fieller confidence intervals for the ratios (i.e. with comparisonwise confidence level = conf.level) 
</p>
</li></ul>

</td></tr>
</table>


<h3>Details</h3>

<p>Given a general linear model, the interest is in simultaneous confidence intervals
for several ratios of linear combinations of the coefficients in the model. It is assumed that the
responses are normally distributed with homogeneous variances. In this problem, the joint distribution
of the likelihood ratio statistics has a multivariate t-distribution
the correlation matrix of which depends on the unknown ratios. This means that the critical
point needed for CI calculations also depends on the ratios. There are various methods
of dealing with this problem (for example, see Dilba et al., 2006). The methods include (i) the unadjusted
intervals (Fieller confidence intervals without multiplicity adjustments), (ii) Bonferroni (Fieller
intervals with simple Bonferroni adjustments), (iii) MtI (a method based on Sidak and Slepian
inequalities for two- and one-sided confidence intervals, respectively), and (iv) plug-in (plugging
the maximum likelihood estimates of the ratios in the unknown correlation matrix). The MtI method consists
of replacing the unknown correlation matrix by an identity matrix of the same dimension.
</p>
<p>Applications include relative potency estimations in multiple parallel line or slope-ratio assays.
Users need to define the design matrix of the linear model and the corresponding contrast matrices 
in an appropriate way.
</p>


<h3>Value</h3>

<p>A list containing 
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>point estimates for the ratios</p>
</td></tr>
<tr><td><code>CorrMat.est</code></td>
<td>
<p>estimates of the correlation matrix (for the plug-in approach)</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>confidence interval estimates of the ratios</p>
</td></tr>
<tr><td><code>Y</code></td>
<td>
<p>response vector </p>
</td></tr>
<tr><td><code>X</code></td>
<td>
<p>design matrix</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>
<p> the model fit, an object of class &quot;lm&quot;</p>
</td></tr>
</table>
<p>and some further input arguments, to be passed to print and summary functions.   
</p>


<h3>Author(s)</h3>

<p> Gemechis Dilba Djira </p>


<h3>References</h3>

<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006).</em>
Simultaneous confidence sets and confidence intervals for multiple ratios.
<em>Journal of Statistical Planning and Inference 136, 2640-2658.</em>
</p>


<h3>See Also</h3>

<p> glht(multcomp) for multiple comparisons of parameters from lm, glm,...,
<a href="#topic+sci.ratio">sci.ratio</a> for confidence intervals for ratios of means in a one-way-layout,
<a href="#topic+simtest.ratio">simtest.ratio</a> for simultaneous tests for ratios of means in a one-way-layout,
<a href="#topic+plot.sci.ratio">plot.sci.ratio</a> for plotting the confidence intervals.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
################################################

# Slope-ratio assay on data from Jensen(1989),
# Biometrical Journal 31, 841-853.

# Definition of the vector of responses and
# the design matrix can be done directly as
# follows:

Y0 &lt;- c(1.3, 1.7, 2.4, 2.7, 3.6, 3.6, 4.7, 5.0, 6.1, 6.3)
Y1 &lt;- c(2.8, 2.9, 4.1, 3.7, 5.5, 5.5, 6.4, 6.7)
Y2 &lt;- c(2.2, 2.1, 3.2, 3.2, 3.8, 3.9, 4.7, 4.9)
Y3 &lt;- c(2.3, 2.3, 3.2, 3.0, 4.2, 4.2, 4.6, 5.1)
Y &lt;- c(Y0,Y1,Y2,Y3) # the response vector

xi &lt;- rep(1,34)
x0 &lt;- c(0,0, gl(4,2),rep(0,8*3))
x1 &lt;- c(rep(0,10),gl(4,2), rep(0,8*2))
x2 &lt;- c(rep(0,18),gl(4,2), rep(0,8))
x3 &lt;- c(rep(0,26),gl(4,2))

X &lt;- cbind(xi,x0,x1,x2,x3) # the design matrix

# Have a look at the response vector:
Y

# and the design matrix:

X

# Internally in sci.ratio.gen, the following model is fitted
 
Fiti &lt;- lm(Y ~ X - 1)
Fiti
summary(Fiti)

# In this problem, interest is simultaneous estimation of
# the ratios of slopes relative to the slope of the standard
# treatment. Therefore, the appropriate contrast matrices are:

Num.Contrast &lt;- matrix(c(0,0,1,0,0,
                         0,0,0,1,0,
                         0,0,0,0,1),nrow=3,byrow=TRUE)
Den.Contrast &lt;- matrix(c(0,1,0,0,0,
                         0,1,0,0,0,
                         0,1,0,0,0),nrow=3,byrow=TRUE)



SlopeRatioCI &lt;- sci.ratio.gen(Y=Y, X=X,
 Num.Contrast=Num.Contrast, Den.Contrast=Den.Contrast)

SlopeRatioCI

# Further details of the fitted model and the contrasts used:

summary(SlopeRatioCI)

plot(SlopeRatioCI)


#########################################################

## Not run: 

# If one starts with a dataframe, the function model.matrix
# can be used to create the design matrix:

data(SRAssay)
SRAssay

# Create the design matrix using model.matrix

X &lt;- model.matrix(Response~Treatment:Dose, data=SRAssay)
Response &lt;- SRAssay[,"Response"]

# The response vector and the design matrix are now:

X
Response

# The following coefficients result from fitting this model:

lm(Response~0+X)

# The same contrasts as above are used:

Num.Contrast &lt;- matrix(c(0,0,1,0,0,
                         0,0,0,1,0,
                         0,0,0,0,1),nrow=3,byrow=TRUE)
Den.Contrast &lt;- matrix(c(0,1,0,0,0,
                         0,1,0,0,0,
                         0,1,0,0,0),nrow=3,byrow=TRUE)

summary(sci.ratio.gen(Y=Response, X=X, Num.Contrast, Den.Contrast))


## End(Not run)
</code></pre>

<hr>
<h2 id='sci.ratioVH'> Approximate simultaneous confidence intervals for ratios of means when variances are heterogeneous </h2><span id='topic+sci.ratioVH'></span>

<h3>Description</h3>

<p>This function constructs simultaneous confidence intervals for ratios of linear combinations of normal means in a one-way model,
allowing that the variances differ among groups. Different methods are available for multiplicity adjustment.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sci.ratioVH(formula, data,
 type = "Dunnett", base = 1, method = "Plug",
 Num.Contrast = NULL, Den.Contrast = NULL,
 alternative = "two.sided", conf.level = 0.95,
 names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sci.ratioVH_+3A_formula">formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor as e.g. response ~ treatment </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_data">data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_type">type</code></td>
<td>
<p> type of contrast, with the following options: &quot;Dunnett&quot; for many-to-one comparisons, with control in the denominator; &quot;Tukey&quot; for all-pair comparisons; &quot;Sequen&quot; for comparisons of consecutive groups, where the group with lower order is the denominator; &quot;AVE&quot; for comparison of each group with average of all others, where the average is taken as denominator; &quot;Changepoint&quot;: ratio of averages of groups of higher order divided by averages of groups of lower order; &quot;Marcus&quot;: Marcus contrasts as ratios; &quot;McDermott&quot;:  McDermott contrasts as ratios; &quot;Williams&quot;: Williams contrasts as ratios.
Note that type is ignored, if Num.Contrast and Den.Contrast are specified by the user</p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_method">method</code></td>
<td>
 
<p>a character string, specifying the method to be used for the multiplicity adjustment of the confidence intervals: &quot;Plug&quot;: Plug-in of ratio estimates to obtain the correlation matrix of contrasts (default); &quot;Bonf&quot;: Simple Bonferroni-adjustment of Fieller confidence intervals for the ratios; &quot;MtI&quot;: Sidak- or Slepian- adjustment for two-sided and one-sided confidence intervals, respectively; &quot;Unadj&quot;: Unadjusted Fieller confidence intervals for the ratios</p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_alternative">alternative</code></td>
<td>
 
<p>a character string: &quot;two.sided&quot; for two-sided intervals; &quot;less&quot; for upper confidence limits: &quot;greater&quot; for lower confidence limits</p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_conf.level">conf.level</code></td>
<td>
<p> simultaneous confidence level in case of method=&quot;Plug&quot;,&quot;Bonf&quot;, or &quot;MtI&quot;, and comparisonwise confidence level in case of method=&quot;Unadj&quot; </p>
</td></tr>
<tr><td><code id="sci.ratioVH_+3A_names">names</code></td>
<td>
<p>logical, indicating whether rownames of the contrast matrices shall be retained in the output</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a one-way ANOVA model, the interest is in simultaneous confidence intervals for several ratios of
linear combinations of the treatment means. It is assumed that the responses are normally distributed
with possibly heterogeneous variances. Multivariate t-distributions are applied with a correlation matrix
depending on the unknown ratios and sample variances and degress of freedom according to Satterthwaite
(1946).
</p>
<p>Using <kbd>method="Unadj"</kbd> results in the methods described in Hasler, Vonk and Hothorn (2007).
</p>


<h3>Value</h3>

<p>An object of class &quot;sci.ratio&quot;, containing a list with elements:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p> the point estimates of the ratios</p>
</td></tr>
<tr><td><code>CorrMat.est</code></td>
<td>
<p>the estimated correlation matrix</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>matrix of contrasts used for the numerator of ratios</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>matrix of contrasts used for the denominator of ratios</p>
</td></tr>
<tr><td><code>conf.int</code></td>
<td>
<p>the estimated confidence intervals</p>
</td></tr>
<tr><td><code>NSD</code></td>
<td>
<p>a logical indicating whether any denominator occured, which were not significantly difference from 0</p>
</td></tr>
</table>
<p>and some of the input arguments.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler</p>


<h3>References</h3>

 
<p>Simultaneous confidence intervals:
</p>
<p><em>Hasler, M. and Hothorn, L.A. (2008).</em>
Multiple contrast tests in the presence of heteroscedasticity.
<em> Biometrical Journal 50, 793-800.</em>
</p>
<p>Marginal (unadjusted) confidence intervals:
</p>
<p><em>Hasler M, Vonk R, Hothorn LA (2007).</em>
Assessing non-inferiority of a new treatment in a three-arm trial in the presence of heteroscedasticity.
<em> Statistics in Medicine 27, 490-503.</em>
</p>
<p><em>Satterthwaite, FE (1946).</em>
An approximate distribution of estimates of variance components. 
<em>Biometrics 2, 110-114.</em>
</p>


<h3>See Also</h3>

 <p><a href="#topic+plot.sci.ratio">plot.sci.ratio</a> for plots of confidence intervals and <a href="#topic+simtest.ratioVH">simtest.ratioVH</a> for raw and multiplicity-adjusted p-values </p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Mutagenicity, package="mratios")

boxplot(MN~Treatment, data=Mutagenicity)

# Unless it is hard to assume Gaussian distribution
# in this example this is an attempt to take
# heterogeneous variances into account.

# Comparisons to the vehicle control,
# Proof of Hazard, using multiplicity adjusted 
# confidence intervals:

## Not run: 

sci.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, method="Plug")


# Unadjusted confidence intervals for an 
# intersection union test to proof safety
# for all doses of the compound.

sci.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, method="Unadj", alternative="less")


# # # # 

# User-defined contrasts:

# Mutagenicity of the doses of the new compound,
# expressed as ratio (DoseX-Vehicle)/(Cyclo25-Vehicle):

# Check the order of the factor levels:

levels(Mutagenicity$Treatment)

# numerators:

NC&lt;-rbind(
"Hydro30-Vehicle"=c(0,0,1,0,0,-1),
"Hydro50-Vehicle"=c(0,0,0,1,0,-1),
"Hydro75-Vehicle"=c(0,0,0,0,1,-1),
"Hydro100-Vehicle"=c(0,1,0,0,0,-1)
)

DC&lt;-rbind(
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1)
)

colnames(NC)&lt;-colnames(DC)&lt;-levels(Mutagenicity$Treatment)

NC

DC



CIs&lt;-sci.ratioVH(MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC,
 Den.Contrast=DC)

# # # #

# Unadjusted confidence intervals for multiple ratios
# of means assuming heterogeneous group variances.
# The following code produces the results given in Table
# V of Hasler, Vonk and Hothorn (2007).
# The upper confidence limits in Table V can produced
# by calling:

sci.ratioVH(formula=MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC, Den.Contrast=DC,
 method="Unadj", alternative="less", conf.level=0.95)

## End(Not run)

</code></pre>

<hr>
<h2 id='simtest.ratio'> Simultaneous tests for ratios of normal means  </h2><span id='topic+simtest.ratio'></span><span id='topic+simtest.ratioI'></span>

<h3>Description</h3>

<p>Performs simultaneous tests for several ratios of linear combinations of treatment means in the normal one-way ANOVA model with homogeneous variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simtest.ratio(formula, data, type = "Dunnett", base = 1,
 alternative = "two.sided", Margin.vec = NULL, FWER = 0.05,
 Num.Contrast = NULL, Den.Contrast = NULL, names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simtest.ratio_+3A_formula">formula</code></td>
<td>
<p> A formula specifying a numerical response and a grouping factor (e.g., response ~ treatment) </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_data">data</code></td>
<td>
<p>  A dataframe containing the response and group variable </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_type">type</code></td>
<td>
<p> type of contrast, with the following options:
</p>

<ul>
<li> <p><b>&quot;Dunnett&quot;:</b> many-to-one comparisons, with control in the denominator
</p>
</li>
<li> <p><b>&quot;Tukey&quot;:</b> all-pair comparisons 
</p>
</li>
<li> <p><b>&quot;Sequen&quot;:</b> comparison of consecutive groups, where the group with lower order is the denomniator
</p>
</li>
<li> <p><b>&quot;AVE&quot;:</b> comparison of each group with average of all others, where the average is taken as denominator
</p>
</li>
<li> <p><b>&quot;GrandMean&quot;:</b> comparison of each group with grand mean of all groups, where the grand mean is taken as denominator
</p>
</li>
<li> <p><b>&quot;Changepoint&quot;:</b> ratio of averages of groups of higher order divided by averages of groups of lower order 
</p>
</li>
<li> <p><b>&quot;Marcus&quot;:</b> Marcus contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;McDermott&quot;:</b> McDermott contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;Williams&quot;:</b> Williams contrasts as ratios 
</p>
</li>
<li> <p><b>&quot;UmbrellaWilliams&quot;:</b> Umbrella-protected Williams contrasts as ratios
</p>
</li></ul>

<p>Note: type is ignored if Num.Contrast and Den.Contrast are specified by the user (See below).
</p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_alternative">alternative</code></td>
<td>
<p> a character string:
</p>

<ul>
<li> <p><b>&quot;two.sided&quot;:</b> for two-sided tests 
</p>
</li>
<li> <p><b>&quot;less&quot;:</b> for lower tail tests 
</p>
</li>
<li> <p><b>&quot;greater&quot;:</b> for upper tail tests 
</p>
</li></ul>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_margin.vec">Margin.vec</code></td>
<td>
<p> a single numerical value or vector of Margins under the null hypotheses, default is 1 </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_fwer">FWER</code></td>
<td>
<p> a single numeric value specifying the family-wise error rate to be controlled </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p> Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts  </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p> Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts </p>
</td></tr>
<tr><td><code id="simtest.ratio_+3A_names">names</code></td>
<td>
<p> a logical value: if TRUE, the output will be named according to names of user defined contrast or factor levels </p>
</td></tr>
</table>


<h3>Details</h3>

<p>Given a one-way ANOVA model, the interest is in simultaneous tests for several ratios of linear combinations of the treatment means.
Let us denote the ratios by <code class="reqn">\gamma_i, i=1,...,r</code>, and let <code class="reqn">\psi_i, i=1,...,r</code>, denote the relative margins against which we compare the ratios.
For example, upper-tail simultaneous tests for the ratios are stated as
</p>
<p style="text-align: center;"><code class="reqn">H_0i: \gamma_i &lt;= \psi_i </code>
</p>

<p>versus
</p>
<p style="text-align: center;"><code class="reqn">H_1i: \gamma_i &gt; \psi_i, i=1,...,r</code>
</p>
<p>.
</p>
<p>The associated likelihood ratio test statistic <code class="reqn">T_i</code> has a t-distribution.
For multiplicity adjustments, we use the joint distribution of the <code class="reqn">T_i</code> , <code class="reqn">i=1,...,r</code>,
which under the null hypotheses follows a central r-variate t-distribution.
Adjusted p-values can be calculated by adapting the results of Westfall et al. (1999) for ratio formatted hypotheses.
</p>


<h3>Value</h3>

<p>An object of class simtest.ratio containing:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>a (named) vector of estimated ratios</p>
</td></tr>
<tr><td><code>teststat</code></td>
<td>
<p> a (named) vector of the calculated test statistics</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>the numerator contrast matrix</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>the denominator contrast matrix</p>
</td></tr>
<tr><td><code>CorrMat</code></td>
<td>
<p>the correlation matrix of the multivariate t-distribution calculated under the null hypotheses</p>
</td></tr>
<tr><td><code>critical.pt</code></td>
<td>
<p>the equicoordinate critical value of the multi-variate t-distribution for a specified FWER</p>
</td></tr>
<tr><td><code>p.value.raw</code></td>
<td>
<p>a (named) vector of unadjusted p-values</p>
</td></tr>
<tr><td><code>p.value.adj</code></td>
<td>
<p>a (named) vector of p-values adjusted for multiplicity</p>
</td></tr>
<tr><td><code>Margin.vec</code></td>
<td>
<p>the vector of margins under the null hypotheses</p>
</td></tr>
</table>
<p>and some other input arguments.
</p>


<h3>Author(s)</h3>

<p> Gemechis Dilba Djira </p>


<h3>References</h3>

 
<p><em>Dilba, G., Bretz, F., and Guiard, V. (2006).</em>
Simultaneous confidence sets and confidence intervals for multiple ratios.
<em>Journal of Statistical Planning and Inference 136, 2640-2658.</em>
</p>
<p><em>Westfall, P.H., Tobias, R.D., Rom, D., Wolfinger, R.D., and Hochberg, Y. (1999).</em>
Multiple comparisons and multiple tests using the SAS system. SAS Institute Inc. Cary, NC, 65-81.
</p>


<h3>See Also</h3>

<p> While print.simtest.ratio produces a small default print-out of the results,
</p>
<p>summary.simtest.ratio can be used to produce a more detailed print-out, which is recommended if user-defined contrasts are used,
</p>
<p>sci.ratio for constructing simultaneous confidence intervals for ratios in oneway layout 
</p>
<p>See <kbd>summary.glht(multcomp)</kbd> for multiple tests for parameters of lm, glm.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

########################################################

# User-defined contrasts for comparisons
# between Active control, Placebo and three dosage groups:

data(AP)
AP
boxplot(prepost~treatment, data=AP)

# Test whether the differences of doses 50, 100, 150 vs. Placebo
# are non-inferior to the difference of Active control vs. Placebo 

# User-defined contrasts:

# Numerator Contrasts:

NC &lt;- rbind(
"(D100-D0)" = c(0,-1,1,0,0),
"(D150-D0)" = c(0,-1,0,1,0),
 "(D50-D0)" = c(0,-1,0,0,1))

# Denominator Contrasts:

DC &lt;- rbind(
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0),
"(AC-D0)" = c(1,-1,0,0,0))

NC
DC

noninf &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 Num.Contrast=NC, Den.Contrast=DC, Margin.vec=c(0.9,0.9,0.9),
 alternative="greater")

summary( noninf )


#########################################################

## Not run: 

# Some more examples on standard multiple comparison procedures
# stated in terms of ratio hypotheses:

# Comparisons vs. Control:

many21 &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Dunnett")

summary(many21)

# Let the Placebo be the control group, which is the second level
# in alpha-numeric order. A simultaneous test for superiority of
# the three doses and the Active control vs. Placebo could be
# done as: 

many21P &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Dunnett", base=2, alternative="greater", Margin.vec=1.1)
summary(many21P)

# All pairwise comparisons:

allpairs &lt;- simtest.ratio(prepost ~ treatment, data=AP,
 type="Tukey")

summary(allpairs)

#######################################################

# Comparison to grand mean of all strains
# in the Penicillin example:

data(Penicillin)

CGM &lt;- simtest.ratio(diameter~strain, data=Penicillin, type="GrandMean")
CGM
summary(CGM)


## End(Not run)

</code></pre>

<hr>
<h2 id='simtest.ratioVH'>Approximate simultaneous tests for ratios of normal means with heterogeneous variances</h2><span id='topic+simtest.ratioVH'></span>

<h3>Description</h3>

<p>Performs simultaneous tests for several ratios of linear combinations of treatment means in a normal one-way layout,
assuming normal distribution of the data allowing heterogeneous variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simtest.ratioVH(formula, data,
 type = "Dunnett", base = 1, alternative = "two.sided",
 Margin.vec = NULL, FWER = 0.05,
 Num.Contrast = NULL, Den.Contrast = NULL,
 names = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simtest.ratioVH_+3A_formula">formula</code></td>
<td>
<p>a formula specifying a numerical response and a grouping factor (e.g., response ~ treatment)</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_data">data</code></td>
<td>
<p>a dataframe containing the response and group variable</p>
</td></tr> 
<tr><td><code id="simtest.ratioVH_+3A_type">type</code></td>
<td>
<p>type of contrast, with the following options: &quot;Dunnett&quot; for many-to-one comparisons, with control in the denominator; &quot;Tukey&quot; for all-pair comparisons; &quot;Sequen&quot;: comparison of consecutive groups, where the group with lower order is the denominator; &quot;AVE&quot;: comparison of each group with average of all others, where the average is taken as denominator; &quot;Changepoint&quot;: ratio of averages of groups of higher order divided by averages of groups of lower order; &quot;Marcus&quot;: Marcus contrasts as ratios; &quot;McDermott&quot;: McDermott contrasts as ratios; &quot;Williams&quot;: Williams contrasts as ratios. Note that type is ignored if Num.Contrast and Den.Contrast are specified by the user (See below).</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_base">base</code></td>
<td>
<p> a single integer specifying the control (i.e. denominator) group for the Dunnett contrasts, ignored otherwise</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_alternative">alternative</code></td>
<td>
<p>a character string: &quot;two.sided&quot; for two-sided tests, &quot;less&quot; for lower tail tests,  &quot;greater&quot; for upper tail tests
</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_margin.vec">Margin.vec</code></td>
<td>
<p>a single numerical value or vector of Margins under the null hypotheses, default is 1</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_fwer">FWER</code></td>
<td>
<p>a single numeric value specifying the family-wise error rate to be controlled</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_num.contrast">Num.Contrast</code></td>
<td>
<p>Numerator contrast matrix, where columns correspond to groups and rows correspond to contrasts</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_den.contrast">Den.Contrast</code></td>
<td>
<p>Denominator contrast matrix, where columns correspond to groups and rows correspond to contrasts</p>
</td></tr>
<tr><td><code id="simtest.ratioVH_+3A_names">names</code></td>
<td>
<p>a logical value: if TRUE, the output will be named according to names of user defined contrast or factor levels</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The associated ratio test statistic T[i] has a t-distribution. Multiplicity adjustment is achieved by using quantiles of r r-variate t-distributions, which differ in the degree of freedom and share the correlation structure. The compariso-specific degrees of freedom
are derived using the approximation according to Satterthwaite (1946).
</p>


<h3>Value</h3>

<p>An object of class simtest.ratio containing:
</p>
<table role = "presentation">
<tr><td><code>estimate</code></td>
<td>
<p>a (named) vector of estimated ratios</p>
</td></tr>
<tr><td><code>teststat</code></td>
<td>
<p>a (named) vector of the calculated test statistics</p>
</td></tr>
<tr><td><code>Num.Contrast</code></td>
<td>
<p>the numerator contrast matrix</p>
</td></tr>
<tr><td><code>Den.Contrast</code></td>
<td>
<p>the denominator contrast matrix</p>
</td></tr>
<tr><td><code>CorrMat</code></td>
<td>
<p>the correlation matrix of the multivariate t-distribution calculated under the null hypotheses</p>
</td></tr>
<tr><td><code>critical.pt</code></td>
<td>
<p>the equicoordinate critical value of the multi-variate t-distribution for a specified FWER</p>
</td></tr>
<tr><td><code>p.value.raw</code></td>
<td>
<p>a (named) vector of unadjusted p-values</p>
</td></tr>
<tr><td><code>p.value.adj</code></td>
<td>
<p>a (named) vector of p-values adjusted for multiplicity</p>
</td></tr>
<tr><td><code>Margin.vec</code></td>
<td>
<p>the vector of margins under the null hypotheses</p>
</td></tr>
</table>
<p>and some other input arguments.
</p>


<h3>Author(s)</h3>

<p> Mario Hasler</p>


<h3>References</h3>

<p>Simultaneous tests (adjusted p-values)
</p>
<p><em>Hasler, M. and Hothorn, L.A. (2008):</em>
Multiple contrast tests in the presence of heteroscedasticity.
<em> Biometrical Journal 50, 793-800.</em>
</p>
<p>Unadjusted tests (raw p-values)
</p>
<p><em>Hasler M, Vonk R, Hothorn LA (2007).</em>
Assessing non-inferiority of a new treatment in a three-arm trial in the presence of heteroscedasticity.
<em> Statistics in Medicine 27, 490-503.</em>
</p>
<p><em>Satterthwaite, FE (1946)</em>.
An approximate distribution of estimates of variance components.
<em>Biometrics 2, 110-114</em>.
</p>


<h3>See Also</h3>

 <p><a href="#topic+sci.ratioVH">sci.ratioVH</a> for corresponding confidence intervals </p>


<h3>Examples</h3>

<pre><code class='language-R'>
###############################################

data(Mutagenicity, package="mratios")

boxplot(MN~Treatment, data=Mutagenicity)

## Not run: 

simtest.ratioVH(MN~Treatment, data=Mutagenicity,
 type="Dunnett", base=6, Margin.vec=1.2, alternative="less")

###############################################

# Unadjusted confidence intervals for multiple ratios
# of means assuming heterogeneous group variances.
# The following code produces the results given in Table
# V of Hasler, Vonk and Hothorn (2007).
# The upper confidence limits in Table V can produced
# by calling:

# Mutagenicity of the doses of the new compound,
# expressed as ratio (DoseX-Vehicle)/(Cyclo25-Vehicle):

# Check the order of the factor levels:

levels(Mutagenicity$Treatment)

# numerators:

NC&lt;-rbind(
"Hydro30-Vehicle"=c(0,0,1,0,0,-1),
"Hydro50-Vehicle"=c(0,0,0,1,0,-1),
"Hydro75-Vehicle"=c(0,0,0,0,1,-1),
"Hydro100-Vehicle"=c(0,1,0,0,0,-1)
)

DC&lt;-rbind(
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1),
"Cyclo25-Vehicle"=c(1,0,0,0,0,-1)
)

colnames(NC)&lt;-colnames(DC)&lt;-levels(Mutagenicity$Treatment)

NC

DC

# The raw p-values are those presented in Table V:

simtest.ratioVH(formula=MN~Treatment, data=Mutagenicity,
 Num.Contrast=NC, Den.Contrast=DC,
 alternative="less", Margin.vec=0.5, FWER=0.05)

## End(Not run)
</code></pre>

<hr>
<h2 id='SRAssay'> Slope ratio assay of panthotenic acid contents in plant tissues </h2><span id='topic+SRAssay'></span>

<h3>Description</h3>

<p>Content of panthotenic acid in a standard and three unknown samples were measured. The response variable is the
titer of a sample to pH 6.8.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(SRAssay)</code></pre>


<h3>Format</h3>

<p>A data frame with 34 observations on the following 3 variables.
</p>

<dl>
<dt>Response</dt><dd><p>a numeric vector, containing the response variable (titer to pH 6.8)</p>
</dd>
<dt>Treatment</dt><dd><p>a factor with levels St, U1, U2 and U3, specifying the standard and 3 unknown samples, respectively</p>
</dd>
<dt>Dose</dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p><em>Jensen, D.R. (1989).</em>
Joint confidence sets in multiple dilution assays. 
<em>Biometrical Journal 31, 841-853.</em>
</p>


<h3>References</h3>

<p>Data originally from  <em>Bliss, C.I. (1952).</em> The Statistics of Bioassay. Academic Press, New York.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

data(SRAssay)

str(SRAssay)

plot(Response~Dose, data=SRAssay)

# library(lattice)
# xyplot(Response~Dose|Treatment, data=SRAssay)

# see ?sci.ratio.gen for  the analysis of this dataset

</code></pre>

<hr>
<h2 id='summary.sci.ratio'> Summary function for sci.ratio </h2><span id='topic+summary.sci.ratio'></span><span id='topic+summary.sci.ratio.gen'></span>

<h3>Description</h3>

<p>Detailed print out for sci.ratio objects.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sci.ratio'
summary(object, digits=4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.sci.ratio_+3A_object">object</code></td>
<td>
<p> an object of class &quot;sci.ratio&quot; or &quot;sci.ratio.gen&quot; as can be obtained by calling the function sci.ratio</p>
</td></tr>
<tr><td><code id="summary.sci.ratio_+3A_digits">digits</code></td>
<td>
<p> digits for rounding the output </p>
</td></tr>
<tr><td><code id="summary.sci.ratio_+3A_...">...</code></td>
<td>
<p>arguments to be passed to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A more detailed print output of the results and some computational steps used in sci.ratio. 
</p>


<h3>See Also</h3>

<p> print.sci.ratio, plot.sci.ratio </p>


<h3>Examples</h3>

<pre><code class='language-R'>data(BW)
RES &lt;- sci.ratio(Weight~Dose, data=BW, type="Dunnett", alternative="greater")
summary(RES)
</code></pre>

<hr>
<h2 id='summary.simtest.ratio'> Summary function for simtest.ratio </h2><span id='topic+summary.simtest.ratio'></span>

<h3>Description</h3>

<p>A detailed print out of the results of simtest.ratio</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'simtest.ratio'
summary(object, digits = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.simtest.ratio_+3A_object">object</code></td>
<td>
<p> An object of class &quot;simtest.ratio&quot; as obtained by calling simtest.ratio </p>
</td></tr>
<tr><td><code id="summary.simtest.ratio_+3A_digits">digits</code></td>
<td>
<p> digits for rounding of the results </p>
</td></tr>
<tr><td><code id="summary.simtest.ratio_+3A_...">...</code></td>
<td>
<p>arguments to be passed to print</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A print out, containing the numerator and denominator contrast matrices, the correlation under the null-hypothesis, margins, estimates, teststatistics, and p.values computed by simtest.ratio. 
</p>

<hr>
<h2 id='ttestratio'> t-test for the ratio of two means </h2><span id='topic+ttestratio'></span><span id='topic+ttestratio.default'></span><span id='topic+ttestratio.formula'></span>

<h3>Description</h3>

<p>Performs t-test for the ratio of means of two independent samples from two gaussian distributions.
In case of heterogeneous variances a Satterthwaite approximation of the degrees of freedom
is used (Tamhane &amp; Logan, 2004).
</p>


<h3>Usage</h3>

<pre><code class='language-R'> 
## Default S3 method:
ttestratio(x, y, alternative = "two.sided",
 rho = 1, var.equal = FALSE, conf.level = 0.95,
 iterativeCI=FALSE, ul=1e+10, ll=-1e+10, ...)
## S3 method for class 'formula'
ttestratio(formula, data, base=2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ttestratio_+3A_x">x</code></td>
<td>
<p> A numeric vector (group in the numerator of the ratio) </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_y">y</code></td>
<td>
<p> A numeric vector (group in the denominator of the ratio) </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_formula">formula</code></td>
<td>
<p> A two-sided formula specifying a numeric response variable and a factor with two levels </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_data">data</code></td>
<td>
<p> A dataframe containing the variables specified in formula.
Note: the first group in alpha-numeric order will appear in the denominator of the ratio</p>
</td></tr>
<tr><td><code id="ttestratio_+3A_alternative">alternative</code></td>
<td>
<p> character string defining the alternative hypothesis, one of &quot;two.sided&quot;, &quot;less&quot; or &quot;greater&quot; </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_rho">rho</code></td>
<td>
<p> a single numeric value: the margin or ratio under the null hypothesis </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_var.equal">var.equal</code></td>
<td>
<p> logical, if set TRUE, a ratio-t-test assuming equal group variances is performed, otherwise (default) unequal variances are assumed </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_conf.level">conf.level</code></td>
<td>
<p> confidence level of Fieller's interval for the ratio of two means </p>
</td></tr>
<tr><td><code id="ttestratio_+3A_base">base</code></td>
<td>
<p>if formula is used: a single numeric value specifying whether the first or second group (according to alpha-numeric order) is to be used as denominator</p>
</td></tr>
<tr><td><code id="ttestratio_+3A_iterativeci">iterativeCI</code></td>
<td>
<p>a single logical, indicating whether the confidence limits shall be found with based on Fiellers formula (default) or by iteratively inverting the test (if TRUE); ignored when <kbd>var.equal=TRUE</kbd></p>
</td></tr>
<tr><td><code id="ttestratio_+3A_ul">ul</code></td>
<td>
<p>a single numeric, defining the upper limit for searching the upper confidence bound in uniroot, if iterativeCI=TRUE and var.equal=FALSE, ignored otherwise</p>
</td></tr>
<tr><td><code id="ttestratio_+3A_ll">ll</code></td>
<td>
<p>a single numeric, defining the lower limit for searching the lower confidence bound in uniroot, if iterativeCI=TRUE and var.equal=FALSE, ignored otherwise</p>
</td></tr>
<tr><td><code id="ttestratio_+3A_...">...</code></td>
<td>
<p>arguments to be passed to ttestratio.default</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function implements the t-test for the ratio of two means and Fiellers confidence interval for the ratio of two means assuming mutually independent Gaussian errors with homogeneous variances, e.g. in Hauschke, Kieser, Hothorn (1999), when the argument <kbd>var.equal=TRUE</kbd>. With the argument <kbd>var.equal=FALSE</kbd> (default), the t-test for the ratio of two means assuming mutually independent Gaussian errors and possibly heterogeneous group variances (Tamhane and Logan, 2004) is implemented. When <kbd>iterativeCI = FALSE</kbd> (default) the corresponding confidence limits are obtained by using Fiellers formula with plug-in of the Satterthwaites degree of freedom calculated with the sample estimates for ratio and variances (not published). These bounds perform quite well but do not necessarily exactly coincide with the test decision. Setting <kbd>iterativeCI = TRUE</kbd> invokes interatively searching for the confidence limits by inverting Tamhane and Logans test using the function uniroot. If the confidence set is unbounded or gives irregular upper and/or lower bounds, a warning and NAs for the confidence limits are returned.
</p>
<p>Note that when the mean of the denominator of the ratio is close to zero, confidence intervals might be degenerated and are not returned.
</p>


<h3>Value</h3>

<p>An object of class &quot;htest&quot;
</p>


<h3>Author(s)</h3>

<p> Frank Schaarschmidt </p>


<h3>References</h3>

 
<p><em>Hauschke, D., Kieser, M., Hothorn, L.A. (1999).</em>
Proof of safety in toxicology based on the ratio of two means for normally distributed data.
<em>Biometrical Journal 41, 295-304.</em>
</p>
<p><em>Tamhane, A.C., Logan, B.R. (2004).</em>
Finding the maximum safe dose level for heteroscedastic data.
<em>Journal of Biopharmaceutical Statistics 14, 843-856.</em>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(mratios)

####################################################

# ASAT values of female rats in a toxicity study
#     (Hauschke, 1999).

data(ASAT)
ASAT

ttestratio(ASAT~group, data=ASAT, alternative="less",
 base=1, rho=1.25, var.equal=TRUE)

######################################################

# Bodyweights of male rats in a toxicity study.
# Objective was to show equivalence between the high
# dose group (Dosis) and the control group (Kon).
# Equivalence margins are set to 0.8 and 1.25. The 
# type-I-error to show equivalence is set to alpha=0.05.

data(rat.weight)

# two one-sided tests:

ttestratio(weight~group, data=rat.weight, alternative="less",
 rho=1.25, var.equal=TRUE)

ttestratio(weight~group, data=rat.weight, alternative="greater",
 rho=0.8, var.equal=TRUE)



# For rho=1, ttestratio corresponds to a simple t.test
# with the difference of means under the null set to zero 
# (,i.e. mu=0).


ttestratio(ASAT~group, data=ASAT, alternative="less",
 rho=1, var.equal=TRUE)

t.test(ASAT~group, data=ASAT, alternative="less",
 mu=0, var.equal=TRUE)

# Ratio of means bewtween negative and positive control in the
# mutagenicity data set, allowing heterogeneous variances:

data(Mutagenicity)
DM&lt;-subset(Mutagenicity, Treatment=="Vehicle"|Treatment=="Cyclo25")

# 95%-CI using the Fieller formula, Satterthwaite df with plug-in of 
# ratio estimate 

ttestratio(MN~Treatment, data=DM, alternative="two.sided",
 var.equal=FALSE, iterativeCI=FALSE)

# 95%-CI based on directly inverting Tamhane and Logans test 
# (Satterthwaite df, avoiding simple plug-in of the ratio estimate)

ttestratio(MN~Treatment, data=DM, alternative="two.sided",
 var.equal=FALSE, iterativeCI=TRUE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
