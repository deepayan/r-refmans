<!DOCTYPE html><html lang="en"><head><title>Help for package regmed</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {regmed}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#regmed-package'>
<p>Regularized Mediation Analysis</p></a></li>
<li><a href='#medsim'>
<p>Simulated dataset for regmed package</p></a></li>
<li><a href='#mvregmed.dat.check'>
<p>Helper function to check x, y, mediator for input to mvregmed functions</p></a></li>
<li><a href='#mvregmed.edges'>
<p>For an object of class mvregmed, create edges for a graph object that can be used</p>
for plots, or for creating models input to lavaan function sem</a></li>
<li><a href='#mvregmed.fit'>
<p>Multivariate regularized mediation model</p></a></li>
<li><a href='#mvregmed.graph.attributes'>
<p>Setup attributes of graph object for plotting</p></a></li>
<li><a href='#mvregmed.grid'>
<p>Fit a grid of mvregmed models over a vector of lambda penalty parameters</p></a></li>
<li><a href='#mvregmed.grid.bestfit'>
<p>Choose best fit model from a grid search based on minimum Bayesian</p>
Information Criterion</a></li>
<li><a href='#mvregmed.grid.data'>
<p>Helper function to summarize fits of models across a grid of lambda values</p></a></li>
<li><a href='#mvregmed.grid.update'>
<p>Helper function to update parameters in a grid search</p></a></li>
<li><a href='#mvregmed.init'>
<p>Helper function to setup data and parameters for input to mvregmed.fit</p>
and mvregmed.grid</a></li>
<li><a href='#mvregmed.lavaan.dat'>
<p>Set up data to input to lavaan sem</p></a></li>
<li><a href='#mvregmed.lavaan.model'>
<p>Setup a model for input to lavaan</p></a></li>
<li><a href='#plot.mvregmed.grid'>
<p>Plot penalty parameter lambda versus BIC for model fits</p></a></li>
<li><a href='#plot.regmed.grid'>
<p>Plots for regmed.grid object.</p></a></li>
<li><a href='#regmed.edges'>
<p>For an object of class regmed, create edges for a graph object that can be used</p>
for plots, or for creating models input to lavaan function sem</a></li>
<li><a href='#regmed.fit'>
<p>Regularized Mediation model for a specified lambda penalty value.</p></a></li>
<li><a href='#regmed.grid'>
<p>Regularized mediation models over a vector grid of lambda penalty values.</p></a></li>
<li><a href='#regmed.grid.bestfit'>
<p>Find best fitting regmed model from regmed.grid object.</p></a></li>
<li><a href='#regmed.lavaan.dat'>
<p>Set up data to input to lavaan sem</p></a></li>
<li><a href='#regmed.lavaan.model'>
<p>Create a lavaan model</p></a></li>
<li><a href='#regmed.prefilter'>
<p>Prefilter to reduce the number of mediators for subsequent analyses</p></a></li>
<li><a href='#summary.mvregmed'>
<p>Summary of mvregmed object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regularized Mediation Analysis</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-1-20</td>
</tr>
<tr>
<td>Description:</td>
<td>Mediation analysis for multiple mediators by penalized structural equation models with different types of penalties depending on whether there are multiple mediators and only one exposure and one outcome variable (using sparse group lasso) or multiple exposures, multiple mediators, and multiple outcome variables (using lasso, L1, penalties).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat, rmarkdown</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0), methods, graphics, glasso, igraph</td>
</tr>
<tr>
<td>Imports:</td>
<td>knitr, Rcpp, RcppArmadillo, lavaan, gtools</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cran.r-project.org/package=regmed">https://cran.r-project.org/package=regmed</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-20 20:57:01 UTC; sinnwell</td>
</tr>
<tr>
<td>Author:</td>
<td>Jason Sinnwell <a href="https://orcid.org/0000-0003-1964-5522"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Daniel Schaid <a href="https://orcid.org/0000-0003-1457-6433"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jason Sinnwell &lt;sinnwell.jason@mayo.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-20 21:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='regmed-package'>
Regularized Mediation Analysis
</h2><span id='topic+regmed-package'></span><span id='topic+regmed'></span>

<h3>Description</h3>

<p>Mediation analysis for multiple mediators by penalized structural equation models with different types of penalties depending on whether there are multiple mediators and only one exposure and one outcome variable (using sparse group lasso) or multiple exposures, multiple mediators, and multiple outcome variables (using lasso, L1, penalties).
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> regmed</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Regularized Mediation Analysis</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1.0</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-1-20</td>
</tr>
<tr>
 <td style="text-align: left;">
Authors@R: </td><td style="text-align: left;"> c(
    person("Jason", "Sinnwell", email = "sinnwell.jason@mayo.edu", comment=c(ORCID="0000-0003-1964-5522"), role = c("aut","cre"),),
    person("Daniel", "Schaid", email = "schaid.daniel@mayo.edu", comment=c(ORCID="0000-0003-1457-6433"), role = c("aut"),))</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Mediation analysis for multiple mediators by penalized structural equation models with different types of penalties depending on whether there are multiple mediators and only one exposure and one outcome variable (using sparse group lasso) or multiple exposures, multiple mediators, and multiple outcome variables (using lasso, L1, penalties).</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
Suggests: </td><td style="text-align: left;"> testthat, rmarkdown</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 4.1.0), methods, graphics, glasso, igraph</td>
</tr>
<tr>
 <td style="text-align: left;">
Imports: </td><td style="text-align: left;"> knitr, Rcpp, RcppArmadillo, lavaan, gtools</td>
</tr>
<tr>
 <td style="text-align: left;">
LinkingTo: </td><td style="text-align: left;"> Rcpp, RcppArmadillo</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
VignetteBuilder: </td><td style="text-align: left;"> knitr</td>
</tr>
<tr>
 <td style="text-align: left;">
URL: </td><td style="text-align: left;"> https://cran.r-project.org/package=regmed</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Jason Sinnwell [aut, cre] (&lt;https://orcid.org/0000-0003-1964-5522&gt;),
  Daniel Schaid [aut] (&lt;https://orcid.org/0000-0003-1457-6433&gt;)</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Jason Sinnwell &lt;sinnwell.jason@mayo.edu&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
medsim                  Simulated dataset for regmed package
mvregmed.dat.check      Helper function to check x, y, mediator for
                        input to mvregmed functions
mvregmed.edges          For an object of class mvregmed, create edges
                        for a graph object that can be used for plots,
                        or for creating models input to lavaan function
                        sem
mvregmed.fit            Multivariate regularized mediation model
mvregmed.graph.attributes
                        Setup attributes of graph object for plotting
mvregmed.grid           Fit a grid of mvregmed models over a vector of
                        lambda penalty parameters
mvregmed.grid.bestfit   Choose best fit model from a grid search based
                        on minimum Bayesian Information Criterion
mvregmed.grid.data      Helper function to summarize fits of models
                        across a grid of lambda values
mvregmed.grid.update    Helper function to update parameters in a grid
                        search
mvregmed.init           Helper function to setup data and parameters
                        for input to mvregmed.fit and mvregmed.grid
mvregmed.lavaan.dat     Set up data to input to lavaan sem
mvregmed.lavaan.model   Setup a model for input to lavaan
plot.mvregmed.grid      Plot penalty parameter lambda versus BIC for
                        model fits
plot.regmed.grid        Plots for regmed.grid object.
regmed-package          Regularized Mediation Analysis
regmed.edges            For an object of class regmed, create edges for
                        a graph object that can be used for plots, or
                        for creating models input to lavaan function
                        sem
regmed.fit              Regularized Mediation model for a specified
                        lambda penalty value.
regmed.grid             Regularized mediation models over a vector grid
                        of lambda penalty values.
regmed.grid.bestfit     Find best fitting regmed model from regmed.grid
                        object.
regmed.lavaan.dat       Set up data to input to lavaan sem
regmed.lavaan.model     Create a lavaan model
regmed.prefilter        Prefilter to reduce the number of mediators for
                        subsequent analyses
summary.mvregmed        Summary of mvregmed object
</pre>

<p>Further information is available in the following vignettes:<br /><br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>regmed</code> </td><td style="text-align: left;"> Regularized_Mediation_Examples (source)</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>NA
</p>
<p>Maintainer: NA
</p>


<h3>References</h3>

<p>Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>
<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>

<hr>
<h2 id='medsim'>
Simulated dataset for regmed package
</h2><span id='topic+medsim'></span><span id='topic+med'></span><span id='topic+x'></span><span id='topic+y'></span>

<h3>Description</h3>

<p>Example data simulated from 2 response (y) variables, 10 exposure (x)
variables, and 200 mediators (med). The all variables are generated from
multivariate standard normal, with varying degrees of association
between exposure, mediators, and responses. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("medsim")</code></pre>


<h3>Format</h3>

<p>Three data frames with 100 observsations each:
</p>

<dl>
<dt><code>x</code></dt><dd><p>matrix with 10 columns of continuous exposure variables</p>
</dd>
<dt><code>y</code></dt><dd><p>matrix with 2 columns of continuous response variables</p>
</dd>
<dt><code>med</code></dt><dd><p>numeric matrix of 200 columns of simulated mediators between
exposures and responses</p>
</dd>
</dl>


<hr>
<h2 id='mvregmed.dat.check'>
Helper function to check x, y, mediator for input to mvregmed functions 
</h2><span id='topic+mvregmed.dat.check'></span><span id='topic+regmed.dat.check'></span>

<h3>Description</h3>

<p>Assure that x, y, mediator are matrices, check column names and fill in
if NULL, and reduce x, y, mediator so no missing values among all three matrices.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.dat.check(x, y, mediator, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.dat.check_+3A_x">x</code></td>
<td>

<p>matrix with columns representing &quot;exposure&quot; variable (sometimes called instrumental variable)
</p>
</td></tr>
<tr><td><code id="mvregmed.dat.check_+3A_y">y</code></td>
<td>

<p>matrix with columns representing outcome variables
</p>
</td></tr>
<tr><td><code id="mvregmed.dat.check_+3A_mediator">mediator</code></td>
<td>

<p>matrix with columns representing mediator variables
</p>
</td></tr>
<tr><td><code id="mvregmed.dat.check_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within y, x, or mediators, so fitting is more robust
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with updated x, y, mediator
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.fit">mvregmed.fit</a></code>
<code><a href="#topic+mvregmed.grid">mvregmed.grid</a></code>
</p>

<hr>
<h2 id='mvregmed.edges'>
For an object of class mvregmed, create edges for a graph object that can be used
for plots, or for creating models input to lavaan function sem
</h2><span id='topic+mvregmed.edges'></span><span id='topic+plot.mvregmed.edges'></span>

<h3>Description</h3>

<p>Using the names of the alpha, beta, and delta matrices in the fitted
object, create directed edges 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.edges(fit, eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.edges_+3A_fit">fit</code></td>
<td>

<p>The fit as an object of class mvregmed. This can be output from
either mvregmed.fit or mvregmed.grid.bestfit.
</p>
</td></tr>
<tr><td><code id="mvregmed.edges_+3A_eps">eps</code></td>
<td>

<p>Threshold to determine whether any of alpha, beta, or delta
parameters are close to zero to be rounded to zero.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class mvregmed.edges, which is a list with all.edge which
is a data.frame with directed edges that are the names of x, mediator,
y that are in the fitted model. Also returns data frames for alpha,
beta, delta (each data frame containing vertex
labels, row/col indices from which parameters were selected, and
coefficient values), as well as names of x, mediator, and y.
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.fit">mvregmed.fit</a></code>
<code><a href="#topic+plot.mvregmed.edges">plot.mvregmed.edges</a></code>
</p>

<hr>
<h2 id='mvregmed.fit'>
Multivariate regularized mediation model 
</h2><span id='topic+mvregmed.fit'></span>

<h3>Description</h3>

<p>Fit regularized mediation model for a specified lambda penalty value.
Structural equation models for analysis of multiple exposures (x),
multiple mediators, and multiple outcome variables (y) are fit with a
lasso (L1) penalaty on the model parameters.
The model is x-[alpha] -&gt; mediator-[beta] -&gt; outcome, where
alpha and beta are the parameters for the indirect effect of x on y,
through the mediator. The model also allows a direct effect of x on y: x-[delta]-&gt;y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.fit(x, mediator, y, lambda, x.std = TRUE, med.std = TRUE,
y.std = TRUE, max.outer = 5000, max.inner = 2, step.multiplier = 0.5,
print.iter = FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.fit_+3A_x">x</code></td>
<td>

<p>matrix with columns representing &quot;exposure&quot; variable (sometimes called instrumental variable)
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_mediator">mediator</code></td>
<td>

<p>matrix with columns representing mediator variables
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_y">y</code></td>
<td>

<p>matrix with columns representing outcome variables
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_lambda">lambda</code></td>
<td>

<p>lambda penalty parameter
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_x.std">x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by
standard devation of x. Note that each column of x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediator by dividing by
standard devation of mediator. Note that each column of mediator will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_y.std">y.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize y by dividing by
standard devation of y. Note that each column of y will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_max.outer">max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over several inner loops.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_max.inner">max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each paramemeter in the matrices alpha, beta, delta, and vary.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_step.multiplier">step.multiplier</code></td>
<td>

<p>In inner loop, the step size is shrunk by the step.multiplier to
assure that step size is not too large. Generally, the default of
0.5 works well.
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_print.iter">print.iter</code></td>
<td>

<p>print iteration number during fitting routine
</p>
</td></tr>
<tr><td><code id="mvregmed.fit_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within y, x, or mediators, so fitting is more robust
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mvregmed
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DJ, Dikilitas O, Sinnwell JP,  Kullo I (2022). Penalized Mediation
Models for Multivariate Data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.grid">mvregmed.grid</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(medsim)
  mvfit &lt;- mvregmed.fit(x, med[,1:10], y, lambda=.1)
  summary(mvfit)
</code></pre>

<hr>
<h2 id='mvregmed.graph.attributes'>
Setup attributes of graph object for plotting
</h2><span id='topic+mvregmed.graph.attributes'></span>

<h3>Description</h3>

<p>Setup attributes of graph object for plotting directed acyclic graph
with graph attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.graph.attributes(fit.edges, x.color = "palegreen",
y.color = "palevioletred", med.color = "skyblue", v.size = 30)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.graph.attributes_+3A_fit.edges">fit.edges</code></td>
<td>

<p>A data.frame of edges with 1st column a vertex directed to the
vertex in the 2nd column. This is all.edge from the list
that is output from mvregmed.edges
</p>
</td></tr>
<tr><td><code id="mvregmed.graph.attributes_+3A_x.color">x.color</code></td>
<td>

<p>Color of vertices for x variables
</p>
</td></tr>
<tr><td><code id="mvregmed.graph.attributes_+3A_y.color">y.color</code></td>
<td>

<p>Color of vertices for y variables
</p>
</td></tr>
<tr><td><code id="mvregmed.graph.attributes_+3A_med.color">med.color</code></td>
<td>

<p>Color of vertices for mediators
</p>
</td></tr>
<tr><td><code id="mvregmed.graph.attributes_+3A_v.size">v.size</code></td>
<td>

<p>Size of vertices for plotting
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>User can use this as template for taking advantage of more igraph attributes.
</p>


<h3>Value</h3>

<p>List with items 1) output from graph_from_edgelist (see igraph); 2) vertex names;
3)vertex size; 4) vertex colors
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.edges">mvregmed.edges</a></code>
<code><a href="igraph.html#topic+graph_from_edgelist">graph_from_edgelist</a></code>
</p>

<hr>
<h2 id='mvregmed.grid'>
Fit a grid of mvregmed models over a vector of lambda penalty parameters
</h2><span id='topic+mvregmed.grid'></span><span id='topic+summary.mvregmed.grid'></span>

<h3>Description</h3>

<p>For each lambda in an input vector of values, fit a penalized mvregmed
model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.grid(x, mediator, y, lambda.vec, max.outer = 5000,
max.inner = 2, x.std = TRUE, med.std = TRUE, y.std = TRUE,
step.multiplier = 0.5, print.iter = FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.grid_+3A_x">x</code></td>
<td>

<p>matrix with columns representing &quot;exposure&quot; variable (sometimes called instrumental variable)
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_mediator">mediator</code></td>
<td>

<p>matrix with columns representing mediator variables
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_y">y</code></td>
<td>

<p>matrix with columns representing outcome variables
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_lambda.vec">lambda.vec</code></td>
<td>

<p>Vector of values of penalty parameter lambda's
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_max.outer">max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over several inner loops.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_max.inner">max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each paramemeter in the matrices alpha, beta, delta, and vary.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_x.std">x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by
standard devation of x. Note that each column of x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediator by dividing by
standard devation of mediator. Note that each column of mediator will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_y.std">y.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize y by dividing by
standard devation of y. Note that each column of y will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_step.multiplier">step.multiplier</code></td>
<td>

<p>In inner loop, the step size is shrunk by the step.multiplier to
assure that step size is not too large. Generally, the default of
0.5 works well.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_print.iter">print.iter</code></td>
<td>

<p>print iteration number during fitting routine
</p>
</td></tr>
<tr><td><code id="mvregmed.grid_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within y, x, or mediators, so fitting is more robust
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mvregmed.grid
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.fit">mvregmed.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(medsim)
  mvfit.grid &lt;- mvregmed.grid(x, med[,1:10], y, lambda.vec=seq(.3, .04, by=-.01))
  summary(mvfit.grid)
  ## plot(mvfit.grid)
</code></pre>

<hr>
<h2 id='mvregmed.grid.bestfit'>
Choose best fit model from a grid search based on minimum Bayesian
Information Criterion
</h2><span id='topic+mvregmed.grid.bestfit'></span>

<h3>Description</h3>

<p>Search over all models fit in a grid and choose model with min BIC as
best model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.grid.bestfit(fit.grid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.grid.bestfit_+3A_fit.grid">fit.grid</code></td>
<td>

<p>An object of class mvregmed.grid, output from function mvregmed.grid
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class mvregmed, a single best fitting model.
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.grid">mvregmed.grid</a></code>
</p>

<hr>
<h2 id='mvregmed.grid.data'>
Helper function to summarize fits of models across a grid of lambda values
</h2><span id='topic+mvregmed.grid.data'></span>

<h3>Description</h3>

<p>elper function to summarize fits of models across a grid of lambda values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.grid.data(fit.lst, lambda.vec)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.grid.data_+3A_fit.lst">fit.lst</code></td>
<td>

<p>A list of model fits over a grid of lambda values; length of list is
length of vector of lambdas.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid.data_+3A_lambda.vec">lambda.vec</code></td>
<td>

<p>A vector of penalty lambda values/
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create a data.frame of summmary information for each model fit in a grid.
</p>


<h3>Value</h3>

<p>data.frame of summary information
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.grid">mvregmed.grid</a></code>
</p>

<hr>
<h2 id='mvregmed.grid.update'>
Helper function to update parameters in a grid search
</h2><span id='topic+mvregmed.grid.update'></span>

<h3>Description</h3>

<p>After a model is fit with a specific lambda, use the output of the
fitted parameters as initial values for the next lambda value, thus
using warm starts at each successive lambda value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.grid.update(fit.obj, inits)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.grid.update_+3A_fit.obj">fit.obj</code></td>
<td>

<p>A fitted model of class mvregmed.
</p>
</td></tr>
<tr><td><code id="mvregmed.grid.update_+3A_inits">inits</code></td>
<td>

<p>Initial values from mvregmed.init that are subsequently updated with
new values from fit.obj
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the same components as output from mvregmed.init
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.init">mvregmed.init</a></code>
</p>

<hr>
<h2 id='mvregmed.init'>
Helper function to setup data and parameters for input to mvregmed.fit
and mvregmed.grid
</h2><span id='topic+mvregmed.init'></span>

<h3>Description</h3>

<p>Helper function to setup data and parameters for input to mvregmed.fit
and mvregmed.grid
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.init(dat.obj, x.std = TRUE, med.std = TRUE, y.std = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.init_+3A_dat.obj">dat.obj</code></td>
<td>

<p>A list that is output from mvregmed.dat.check that contains x, mediator, and y.
</p>
</td></tr>
<tr><td><code id="mvregmed.init_+3A_x.std">x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by
standard devation of x. Note that each column of x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.init_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediator by dividing by
standard devation of mediator. Note that each column of mediator will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="mvregmed.init_+3A_y.std">y.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize y by dividing by
standard devation of y. Note that each column of y will be centered on its mean.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Center and scale (if declared) x, mediator and y. Then regress each
mediator on all x to create residuals that are used to create the
residual variance matrix for mediators. This variance matrix is
penalized by glasso to obtain a matrix of full rank. Variance matrices
for x and y variables are also created. Initial values of paramemeter
matrices alpha, beta, and delta are created (all intital values = 0).
</p>


<h3>Value</h3>

<p>A list of items used as input to model fitting.
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized
mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.fit">mvregmed.fit</a></code>
<code><a href="#topic+mvregmed.grid">mvregmed.grid</a></code>
</p>

<hr>
<h2 id='mvregmed.lavaan.dat'>
Set up data to input to lavaan sem
</h2><span id='topic+mvregmed.lavaan.dat'></span>

<h3>Description</h3>

<p>Set up data to input to lavaan structural equation model (sem)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.lavaan.dat(x, mediator, y, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.lavaan.dat_+3A_x">x</code></td>
<td>

<p>matrix of exposure variables
</p>
</td></tr>
<tr><td><code id="mvregmed.lavaan.dat_+3A_mediator">mediator</code></td>
<td>

<p>matrix of mediators
</p>
</td></tr>
<tr><td><code id="mvregmed.lavaan.dat_+3A_y">y</code></td>
<td>

<p>matrix of outcome variables
</p>
</td></tr>
<tr><td><code id="mvregmed.lavaan.dat_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within mediators, so that fitting is more robust
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the function regmed.dat.check to standardize all variables and subset to subjects without missing data
</p>


<h3>Value</h3>

<p>A dataframe with updated x, mediator, and y
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>

<hr>
<h2 id='mvregmed.lavaan.model'>
Setup a model for input to lavaan
</h2><span id='topic+mvregmed.lavaan.model'></span>

<h3>Description</h3>


<p>Set up a model statement (string formula) from mvregmed object for input to lavaan
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvregmed.lavaan.model(fit.edge, fit.mvregmed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="mvregmed.lavaan.model_+3A_fit.edge">fit.edge</code></td>
<td>

<p>Output from mvregmed.edges
</p>
</td></tr>
<tr><td><code id="mvregmed.lavaan.model_+3A_fit.mvregmed">fit.mvregmed</code></td>
<td>

<p>A mvregmed object, either from mvregmed.fit or from mvregmed.grid.bestfit
</p>
</td></tr>
</table>


<h3>Details</h3>


<p>Loop through all relationships determined important from mrregmed edges
object, and create model statement for lavaan, while also specifying
covariances pre-estimated by mvregmed. See vignette for examples. The
summary method for lavaan supersedes the summary from the lavaan
package by simplifying the output to only return the coefficient
table, as the covariance estimates were fixd from mvregmed.
</p>


<h3>Value</h3>

<p>Text string to define a model as input to sem
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>

<hr>
<h2 id='plot.mvregmed.grid'>
Plot penalty parameter lambda versus BIC for model fits
</h2><span id='topic+plot.mvregmed.grid'></span>

<h3>Description</h3>

<p>Plot penalty parameter lambda versus BIC for model fits
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvregmed.grid'
plot(x, xlab="lambda", ylab="BIC", pch="*", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.mvregmed.grid_+3A_x">x</code></td>
<td>

<p>An object created by mvregmed.grid
</p>
</td></tr>
<tr><td><code id="plot.mvregmed.grid_+3A_xlab">xlab</code></td>
<td>

<p>x axis label, by default set to 'lambda'
</p>
</td></tr>
<tr><td><code id="plot.mvregmed.grid_+3A_ylab">ylab</code></td>
<td>

<p>y axis label, by default set to 'BIC' for this plot
</p>
</td></tr>
<tr><td><code id="plot.mvregmed.grid_+3A_pch">pch</code></td>
<td>

<p>plot character, by default set to a star (*)
</p>
</td></tr>
<tr><td><code id="plot.mvregmed.grid_+3A_...">...</code></td>
<td>

<p>optional plot arguments
</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>

<hr>
<h2 id='plot.regmed.grid'>
Plots for regmed.grid object.
</h2><span id='topic+plot.regmed.grid'></span>

<h3>Description</h3>

<p>Creates 2 plots: (1) BIC vs. lambda, and (2) Coefficients Alpha and Beta of mediator vs. lambda.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'regmed.grid'
plot(x, as.log=FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.regmed.grid_+3A_x">x</code></td>
<td>
<p> regmed.grid object, returned by the <code>regmed.grid()</code> function </p>
</td></tr>
<tr><td><code id="plot.regmed.grid_+3A_as.log">as.log</code></td>
<td>
<p>Logical; if TRUE,  plot lambda on the log scale</p>
</td></tr>
<tr><td><code id="plot.regmed.grid_+3A_...">...</code></td>
<td>
<p>optional arguments for plot method</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing is returned</p>


<h3>Author(s)</h3>

<p>Dan Schaid, Greg Jenkins, Jason Sinnwell
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regmed.grid">regmed.grid</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medsim)
fit.grid &lt;- regmed.grid(x[,1], med[,1:10], y[,1],
  lambda.vec= c(seq(from=1, to=0, by = -.1)), frac.lasso=.8)
summary(fit.grid)
</code></pre>

<hr>
<h2 id='regmed.edges'>
For an object of class regmed, create edges for a graph object that can be used
for plots, or for creating models input to lavaan function sem
</h2><span id='topic+regmed.edges'></span><span id='topic+plot.regmed.edges'></span>

<h3>Description</h3>

<p>Using the names of the alpha, beta, and delta matrices in the fitted
object, create directed edges 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.edges(fit, type="mediators", eps = 0.001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.edges_+3A_fit">fit</code></td>
<td>

<p>The fit as an object of class mvregmed. This can be output from
either mvregmed.fit or mvregmed.grid.bestfit.
</p>
</td></tr>
<tr><td><code id="regmed.edges_+3A_type">type</code></td>
<td>

<p>Character string specifying whether to only keep edges for mediators
that have a non-zero coefficient with exposure and response
variables (&quot;mediator&quot;) or all edges (&quot;all&quot;).
</p>
</td></tr>
<tr><td><code id="regmed.edges_+3A_eps">eps</code></td>
<td>

<p>Threshold to determine whether any of alpha, beta, or delta
parameters are close to zero to be rounded to zero.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list with class &quot;regmed.edges&quot; containing all.edge which is a
data.framewith directed edges that are
the names of x, mediator, y that are in the fitted model, with the
coefficient for that edge. The plot method will plot the edges using
igraph plotting options.
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regmed.fit">regmed.fit</a></code>
<code><a href="#topic+plot.regmed.edges">plot.regmed.edges</a></code>
</p>

<hr>
<h2 id='regmed.fit'>
Regularized Mediation model for a specified lambda penalty value.
</h2><span id='topic+regmed.fit'></span><span id='topic+print.regmed'></span><span id='topic+summary.regmed'></span>

<h3>Description</h3>

<p>Fit regularized mediation model for a specified lambda penalty value.
Structural equation models for analysis of multiple mediators
are extended by creating a sparse group lasso penalized model such that
the penalty considers the natural groupings of the pair of parameters
that determine mediation, as well as encourages sparseness of the model
parameters. The model is x-[alpha] -&gt; mediator-[beta] -&gt; outcome, where
alpha and beta are the parameters for the indirect effect of x on y,
through the mediator. The model also allows a direct effect of x on y: x-[delta] -&gt; y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.fit(x, mediator, y, lambda, frac.lasso=0.8, x.std=TRUE, med.std=TRUE,
max.outer=5000, max.inner=100, step.multiplier = 0.5, wt.delta = .5,
print.iter=FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.fit_+3A_x">x</code></td>
<td>

<p>vector representing &quot;exposure&quot; variable (sometimes called instrumental variable)
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_mediator">mediator</code></td>
<td>

<p>matrix of mediators, rows are observations, columns are different mediators
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_y">y</code></td>
<td>

<p>vector representing outcome
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_lambda">lambda</code></td>
<td>

<p>lambda penalty parameter
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_frac.lasso">frac.lasso</code></td>
<td>

<p>fraction of penalty (lambda) that is allocated to L1 penalty
(lasso). The remaining fraction, (1-frac.lasso) is allocated to
group-lasso penalty, where the group is the pair of parameters alpha and
beta that determine mediation (x [alpha] -&gt; mediator -&gt; [beta] y).
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_x.std">x.std</code></td>
<td>
 
<p>logical (TRUE/FALSE) whether to standardize x by dividing by standard
devation of x. Note that x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediators by dividing each
mediator by its standard deviation. Note that mediators will be centered on their means.
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_max.outer">max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over several inner loops.
</p>
</td></tr> 
<tr><td><code id="regmed.fit_+3A_max.inner">max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each pair of alpha-beta parameters for each mediator, an inner loop 
for direct effect (delta), and inner loops for residual variances for x
and for y.
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_step.multiplier">step.multiplier</code></td>
<td>

<p>a value between 0 and 1 for backtracking, to shrink step size. Value of
0.5 is typical default.
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_wt.delta">wt.delta</code></td>
<td>

<p>a weight &gt;=0 for how much weight should be given to shrinking delta
parameter, by penalaty lambda*wt.delta.
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_print.iter">print.iter</code></td>
<td>

<p>print iteration history during fitting routine
</p>
</td></tr>
<tr><td><code id="regmed.fit_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within mediators, so that fitting is more robust
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>regmed object, with S3 methods available: plot, print, summary
</p>


<h3>Author(s)</h3>

<p>Dan Schaid, Greg Jenkins, Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regmed.edges">regmed.edges</a></code>
<code><a href="#topic+summary.regmed">summary.regmed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data(medsim)
  filter5 &lt;- regmed.prefilter(x[,1], med, y[,1], k=5)
  fit.regmed &lt;- regmed.fit(x[,1], med[,1:5], y[,1], lambda = 0.2, frac.lasso=.8)
  summary(fit.regmed)
</code></pre>

<hr>
<h2 id='regmed.grid'>
Regularized mediation models over a vector grid of lambda penalty values.
</h2><span id='topic+regmed.grid'></span><span id='topic+print.regmed.grid'></span><span id='topic+summary.regmed.grid'></span>

<h3>Description</h3>

<p>Fit regularized mediation models over a vector grid of lambda penalty
values. Structural equation models for analysis of multiple mediators
are extended by creating a sparse group lasso penalized model such that
the penalty considers the natural groupings of the pair of parameters
that determine mediation, as well as encourages sparseness of the model
parameters. The model is x-[alpha] -&gt; mediator-[beta] -&gt; outcome, where
alpha and beta are the parameters for the indirect effect of x on y,
through the mediator. The model also allows a direct effect of x on
y: x-[delta] -&gt; y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.grid(x, mediator, y, lambda.vec, frac.lasso=0.8, max.outer=5000,
max.inner=100, x.std=TRUE, med.std=TRUE, step.multiplier = 0.5,
wt.delta = .5, print.iter=FALSE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.grid_+3A_x">x</code></td>
<td>

<p>vector representing &quot;exposure&quot; variable (sometimes called instrumental
variable)  
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_mediator">mediator</code></td>
<td>

<p>matrix of mediators, rows are observations, columns are different
mediators 
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_y">y</code></td>
<td>

<p>vector representing outcome
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_lambda.vec">lambda.vec</code></td>
<td>

<p>vector of lambda penalty parameters
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_frac.lasso">frac.lasso</code></td>
<td>

<p>fraction of penalty (lambda) that is allocated to L1 penalty
(lasso). The remaining fraction, (1-frac.lasso) is allocated to
group-lasso penalty, where the group is the pair of parameters alpha and
beta that determine mediation (x [alpha] -&gt; mediator -&gt; [beta] y).
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_max.outer">max.outer</code></td>
<td>

<p>maximum number of outer loop iterations. The outer loop cycles over
several inner loops.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_max.inner">max.inner</code></td>
<td>

<p>maximum number of iterations for each inner loop. There is an inner loop
for each pair of alpha-beta parameters for each mediator, an inner loop
for direct effect (delta), and inner loops for residual variances for x
and for y.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_x.std">x.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize x by dividing by standard
devation of x. Note that x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediators by dividing each mediator by its standard
deviation. Note that mediators will be centered on their means.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_step.multiplier">step.multiplier</code></td>
<td>

<p>a value between 0 and 1 for backtracking, to shrink step size. Value of
0.5 is typical default.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_wt.delta">wt.delta</code></td>
<td>

<p>a weight &gt;=0 for how much weight should be given to shrinking delta
parameter, by penalaty lambda*wt.delta.
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_print.iter">print.iter</code></td>
<td>

<p>print iteration history during fitting routine 
</p>
</td></tr>
<tr><td><code id="regmed.grid_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within mediators, so fitting is more robust
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Altough outcome y is not required to be scaled by its standard
deviation, it can be beneficial to scale y. This helps with setting
range of lambda penalty parameters, because when all x, y, and mediators
are scaled, it is reasonable to consider lambda values within the range
of 0 to 1. See reference for details of algorithm.
</p>


<h3>Value</h3>

<p>regmed.grid object
</p>


<h3>Author(s)</h3>

<p>Dan Schaid,  Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot.regmed.grid">plot.regmed.grid</a></code>
<code><a href="#topic+regmed.fit">regmed.fit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medsim)
fit.grid &lt;- regmed.grid(x[,1], med[,1:5], y[,1],
lambda.vec= c(seq(from=1, to=0, by = -.1)),
frac.lasso=.8)
print(fit.grid)
</code></pre>

<hr>
<h2 id='regmed.grid.bestfit'>
Find best fitting regmed model from regmed.grid object.
</h2><span id='topic+regmed.grid.bestfit'></span>

<h3>Description</h3>

<p>Find best fitting regmed model from regmed.grid object using minimum
BIC to select model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.grid.bestfit(fit.grid)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.grid.bestfit_+3A_fit.grid">fit.grid</code></td>
<td>
<p> a regmed.grid object
</p>
</td></tr>
</table>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>fit</code></td>
<td>
<p>best fit regmed object based on minimum BIC</p>
</td></tr>
<tr><td><code>grid</code></td>
<td>
<p>row out of grid.data of regmed.grid object corresponding to best fit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Dan Schaid, Greg Jenkins, Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regmed.grid">regmed.grid</a></code>
</p>

<hr>
<h2 id='regmed.lavaan.dat'>
Set up data to input to lavaan sem
</h2><span id='topic+regmed.lavaan.dat'></span>

<h3>Description</h3>

<p>Set up data to input to lavaan structural equation model (sem)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.lavaan.dat(x, mediator, y)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.lavaan.dat_+3A_x">x</code></td>
<td>

<p>vector of exposure variables
</p>
</td></tr>
<tr><td><code id="regmed.lavaan.dat_+3A_mediator">mediator</code></td>
<td>

<p>matrix of mediator variables
</p>
</td></tr>
<tr><td><code id="regmed.lavaan.dat_+3A_y">y</code></td>
<td>

<p>vector of outcome variable
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Use the function regmed.dat.check to standardize all variables and subset to subjects without missing data
</p>


<h3>Value</h3>

<p>A dataframe with updated x, mediator, and y
</p>


<h3>Author(s)</h3>

<p>Dan Schaid, Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>

<hr>
<h2 id='regmed.lavaan.model'>
Create a lavaan model
</h2><span id='topic+regmed.lavaan.model'></span><span id='topic+summary.lavaan'></span>

<h3>Description</h3>

<p>Create a lavaan model for input to lavan::sem()
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.lavaan.model(fit.edge, fit.regmed)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.lavaan.model_+3A_fit.edge">fit.edge</code></td>
<td>

<p>object created by regmed.edges function
</p>
</td></tr>
<tr><td><code id="regmed.lavaan.model_+3A_fit.regmed">fit.regmed</code></td>
<td>

<p>object created by regmed.fit from which the fit.edge object was made
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The fit.regmed object is needed for the fixed covariance estimates to
be put into the model statement. The summary method supersedes the
default summary from the lavaan package to only return the table of
coefficients, as the covariances are fixed from regmed.fit.
</p>


<h3>Value</h3>

<p>a character string that descibes the mediation model in format of lavaan model
</p>


<h3>Author(s)</h3>

<p>Dan Schaid, Greg Jenkins, Jason Sinnwell
</p>

<hr>
<h2 id='regmed.prefilter'>
Prefilter to reduce the number of mediators for subsequent analyses
</h2><span id='topic+regmed.prefilter'></span>

<h3>Description</h3>

<p>Use sure independence screening (Fan &amp; Lv, 2008)to reduce the number of
potential mediators when the number of potential mediators is
large. This is based on ranking marginal correlations and then selecting
the highest ranked values such that the number of parameters is less
than the sample size. Because mediation depends on the two correlations,
cor(x,med) and cor(med, y) we rank the absolute values of their
products, |cor(x, med) * cor(med, y)|, and choose the highest k ranked
values to determine which potential mediators to include in penalized
mediation models. If k is not specified, the default value of k is n/2,
where n is the sample size, because each mediator results in two
parameters alpha and beta.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>regmed.prefilter(x, mediator, y, k = NULL, x.std = TRUE,
med.std = TRUE, y.std=TRUE, max.cor=0.99)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="regmed.prefilter_+3A_x">x</code></td>
<td>

<p>vector representing &quot;exposure&quot; variable (sometimes called instrumental variable)
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_mediator">mediator</code></td>
<td>

<p>matrix of mediators, rows are observations, columns are different mediators
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_y">y</code></td>
<td>

<p>vector representing outcome
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_k">k</code></td>
<td>

<p>Number of potential mediators to select. Default is n/2, where n is sample size.
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_x.std">x.std</code></td>
<td>
 
<p>logical (TRUE/FALSE) whether to standardize x by dividing by standard
devation of x. Note that x will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_med.std">med.std</code></td>
<td>

<p>logical (TRUE/FALSE) whether to standardize mediators by dividing each
mediator by its standard deviation. Note that mediators will be centered on their means.
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_y.std">y.std</code></td>
<td>
 
<p>logical (TRUE/FALSE) whether to standardize y by dividing by standard
devation of y. Note that y will be centered on its mean.
</p>
</td></tr>
<tr><td><code id="regmed.prefilter_+3A_max.cor">max.cor</code></td>
<td>

<p>maximum correlation within mediators, so that fitting is more robust
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with x, mediator, and y, after subsetting to no missing values,
applying x.std and med.std, and subsetting mediators to k top choices.
</p>


<h3>Author(s)</h3>

<p>Dan Schaid, Jason Sinnwell
</p>


<h3>References</h3>

<p>Fan, J., &amp; Lv, J. (2008). Sure independence screening for ultrahigh dimensional feature space. J. R. Statist. Soc.B, 70, 849-911. 
Schaid, DJ, Sinnwell JP. (2020) Penalized Models for Analysis of
Multiple Mediators. Genet Epidemiol 44:408-424.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+regmed">regmed</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(medsim)
dim(med)
filtered &lt;- regmed.prefilter(x[,1], med, y[,1], k=10)
dim(filtered$med)
</code></pre>

<hr>
<h2 id='summary.mvregmed'>
Summary of mvregmed object
</h2><span id='topic+summary.mvregmed'></span>

<h3>Description</h3>

<p>Summary of non-zero parameter estimates. Optional epsilon (eps) parameter controls
rounding to 0.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mvregmed'
summary(object, eps=1e-3, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.mvregmed_+3A_object">object</code></td>
<td>

<p>mvregmed object returned from mvregmed.fit or mvregmed.grid.bestfit
</p>
</td></tr>
<tr><td><code id="summary.mvregmed_+3A_eps">eps</code></td>
<td>

<p>parameters smaller than epsilon (eps) are rounded to zero. 
</p>
</td></tr>
<tr><td><code id="summary.mvregmed_+3A_...">...</code></td>
<td>

<p>optional arguments 
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing is returned
</p>


<h3>Author(s)</h3>

<p>Daniel Schaid and Jason Sinnwell
</p>


<h3>References</h3>

<p>Schaid DS, Dikilitas O, Sinnwell JP, Kullo I (2022). Penalized mediation models for multivariate data. Genet Epidemiol 46:32-50.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mvregmed.fit">mvregmed.fit</a></code>
<code><a href="#topic+mvregmed.grid.bestfit">mvregmed.grid.bestfit</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
