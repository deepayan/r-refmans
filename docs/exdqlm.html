<!DOCTYPE html><html><head><title>Help for package exdqlm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {exdqlm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BTflow'><p>Monthly time-series of water flow at Big Tree water gauge.</p></a></li>
<li><a href='#combineMods'><p>Combines state space blocks of an exDQLM</p></a></li>
<li><a href='#compPlot'><p>Plot a component of an exDQLM</p></a></li>
<li><a href='#dlmMod'><p>Create state space model of exDQLM from DLM</p></a></li>
<li><a href='#ELIanoms'><p>Daily time-series of ELI anomalies.</p></a></li>
<li><a href='#exdqlmChecks'><p>exDQLM Diagnostics</p></a></li>
<li><a href='#exdqlmForecast'><p>k-step-ahead Forecast</p></a></li>
<li><a href='#exdqlmISVB'><p>exDQLM - ISVB algorithm</p></a></li>
<li><a href='#exdqlmMCMC'><p>exDQLM - MCMC algorithm</p></a></li>
<li><a href='#exdqlmPlot'><p>Plot exDQLM</p></a></li>
<li><a href='#nino34'><p>Monthly Niño 3.4 Index.</p></a></li>
<li><a href='#polytrendMod'><p>Create an n-th order polynomial exDQLM component</p></a></li>
<li><a href='#scIVTmag'><p>Time series of daily average magnitude IVT in Santa Cruz, CA.</p></a></li>
<li><a href='#seasMod'><p>Create Fourier representation of a periodic exDQLM component</p></a></li>
<li><a href='#transfn_exdqlmISVB'><p>Transfer Function exDQLM - ISVB algorithm</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Extended Dynamic Quantile Linear Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3</td>
</tr>
<tr>
<td>Author:</td>
<td>Raquel Barata [aut, cre],
  Raquel Prado [ths],
  Bruno Sanso [ths]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Raquel Barata &lt;raquel.a.barata@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Routines for Bayesian estimation and analysis of dynamic quantile linear models utilizing the extended asymmetric Laplace error distribution, also known as extended dynamic quantile linear models (exDQLM) described in Barata et al (2020) &lt;<a href="https://doi.org/10.1214%2F21-AOAS1497">doi:10.1214/21-AOAS1497</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, methods, graphics, dlm, coda, tictoc, magic, crch,
truncnorm, HyperbolicDist, GeneralizedHyperbolic, brms, FNN,
LaplacesDemon, grDevices</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-16 03:28:19 UTC; raquel</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-16 12:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='BTflow'>Monthly time-series of water flow at Big Tree water gauge.</h2><span id='topic+BTflow'></span>

<h3>Description</h3>

<p>Average monthly natural water flow (cubic feet per second) at the Big Tree gauge of the San Lorenzo river in Santa Cruz County, CA from 1937 through 2014.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BTflow
</code></pre>


<h3>Format</h3>

<p>A time series of length 936.
</p>


<h3>Source</h3>

<p><a href="https://waterdata.usgs.gov/nwis/">https://waterdata.usgs.gov/nwis/</a>
</p>


<h3>References</h3>

<p>U.S. Geological Survey (2016). National Water Information System data available on the World Wide Web (USGS Water Data for the Nation). <a href="https://waterdata.usgs.gov/nwis/">https://waterdata.usgs.gov/nwis/</a>.
</p>

<hr>
<h2 id='combineMods'>Combines state space blocks of an exDQLM</h2><span id='topic+combineMods'></span>

<h3>Description</h3>

<p>The function combines two models into a single state space model for an exDQLM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineMods(m1, m2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combineMods_+3A_m1">m1</code></td>
<td>
<p>List containing the first model to be combined.</p>
</td></tr>
<tr><td><code id="combineMods_+3A_m2">m2</code></td>
<td>
<p>List containing the second model to be combined.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing the new combined state space model components.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>trend.comp = polytrendMod(2,rep(0,2),10*diag(2))
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
# using dlm package
library(dlm)
model = combineMods(dlmModPoly(order=2,C0=10*diag(2)),dlmModTrig(365,2,C0=10*diag(4)))

</code></pre>

<hr>
<h2 id='compPlot'>Plot a component of an exDQLM</h2><span id='topic+compPlot'></span>

<h3>Description</h3>

<p>The function plots the dynamic MAP estimates and 95% credible intervals (CrIs) of a specified component of an exDQLM. Alternatively, if <code>just.theta=TRUE</code> the MAP estimates and 95% credible intervals (CrIs) of a single element of the dynamic state vector are plotted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compPlot(
  y,
  m1,
  index,
  add = FALSE,
  col = "purple",
  just.theta = FALSE,
  cr.percent = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compPlot_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_m1">m1</code></td>
<td>
<p>An object of class &quot;<code>exdqlm</code>&quot;.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_index">index</code></td>
<td>
<p>Index of the component or element of the state vector to be plotted.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, the dynamic component will be added to existing plot.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_col">col</code></td>
<td>
<p>Color of dynamic component to be plotted. Default is <code>purple</code>.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_just.theta">just.theta</code></td>
<td>
<p>If <code>TRUE</code>, the function plots the dynamic distribution of the <code>index</code> element of the state vector. If <code>just.theta=TRUE</code>, <code>index</code> must have length 1.</p>
</td></tr>
<tr><td><code id="compPlot_+3A_cr.percent">cr.percent</code></td>
<td>
<p>Percentage used in the calculation of the credible intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>map.comp</code> - MAP estimate of the dynamic component (or element of the state vector).
</p>
</li>
<li> <p><code>lb.comp</code> - Lower bound of the 95% CrIs of the dynamic component (or element of the state vector).
</p>
</li>
<li> <p><code>ub.comp</code> - Upper bound of the 95% CrIs of the dynamic component (or element of the state vector).
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:365]
trend.comp = polytrendMod(2,rep(0,2),10*diag(2))
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
M0 = exdqlmISVB(y,p0=0.85,model,df=c(0.98,1),dim.df = c(2,6),
                   gam.init=-3.5,sig.init=15,tol=0.05)
# plot first harmonic component
compPlot(y,M0,index=c(3,4),col="blue")


</code></pre>

<hr>
<h2 id='dlmMod'>Create state space model of exDQLM from DLM</h2><span id='topic+dlmMod'></span>

<h3>Description</h3>

<p>The function creates a state space model of an exDQLM from &quot;<code>dlm</code>&quot; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dlmMod(m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dlmMod_+3A_m">m</code></td>
<td>
<p>An object of class &quot;<code>dlm</code>&quot; representing the DLM version of the desired exDQLM state space model. Only time-invariant <code>dlm</code> objects are currently considered.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List containing only the components of <code>m</code> needed for the exDQLM state space model.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(dlm)
m = dlmModPoly(order=2,C0=10*diag(2)) + dlmModTrig(365,2,C0=10*diag(4))
model = dlmMod(m)

</code></pre>

<hr>
<h2 id='ELIanoms'>Daily time-series of ELI anomalies.</h2><span id='topic+ELIanoms'></span>

<h3>Description</h3>

<p>ELI anomalies on the daily time-scale from January 1, 1979 to December 31, 2019 with all February 29ths omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ELIanoms
</code></pre>


<h3>Format</h3>

<p>A time series of length 14965.
</p>


<h3>Source</h3>

<p><a href="https://portal.nersc.gov/archive/home/projects/cascade/www/ELI">https://portal.nersc.gov/archive/home/projects/cascade/www/ELI</a>
</p>


<h3>References</h3>

<p>Patricola, C.M., O’Brien, J.P., Risser, M.D. et al. <em>Maximizing ENSO as a source of western US hydroclimate predictability.</em> Clim Dyn 54, 351–372 (2020). doi: <a href="https://doi.org/10.1007/s00382-019-05004-8">10.1007/s00382-019-05004-8</a>
</p>

<hr>
<h2 id='exdqlmChecks'>exDQLM Diagnostics</h2><span id='topic+exdqlmChecks'></span>

<h3>Description</h3>

<p>The function computes the following for the model(s) provided: the posterior predictive loss criterion based off the check loss, the one-step-ahead distribution sequence and its KL divergence from normality. The function also plots the following: the qq-plot and ACF plot corresponding to the one-step-ahead distribution sequence, and a time series plot of the MAP standard forecast errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exdqlmChecks(
  y,
  m1,
  m2 = NULL,
  plot = TRUE,
  cols = c("grey", "grey"),
  ref = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exdqlmChecks_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="exdqlmChecks_+3A_m1">m1</code></td>
<td>
<p>An object of class &quot;<code>exdqlm</code>&quot;.</p>
</td></tr>
<tr><td><code id="exdqlmChecks_+3A_m2">m2</code></td>
<td>
<p>An optional additional object of class &quot;<code>exdqlm</code>&quot; to compare with <code>m1</code>.</p>
</td></tr>
<tr><td><code id="exdqlmChecks_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, the following will be plotted for <code>m1</code> and <code>m2</code> (if provided): a qq-plot and ACF plot of the MAP one-step-ahead distribution sequence, and a time series plot of the standardized forecast errors.</p>
</td></tr>
<tr><td><code id="exdqlmChecks_+3A_cols">cols</code></td>
<td>
<p>Color(s) used to plot diagnostics.</p>
</td></tr>
<tr><td><code id="exdqlmChecks_+3A_ref">ref</code></td>
<td>
<p>Reference sample of size <code>length(y)</code> from a standard normal distribution used to compute the KL divergence.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following is returned:
</p>

<ul>
<li> <p><code>m1.uts</code> - The one-step-ahead distribution sequence of <code>m1</code>.
</p>
</li>
<li> <p><code>m1.KL</code> - The KL divergence of <code>m1.uts</code> and a standard normal.
</p>
</li>
<li> <p><code>m1.pplc</code> - The posterior predictive loss criterion of <code>m1</code> based off the check loss function.
</p>
</li>
<li> <p><code>m1.qq</code> - The ordered pairs of the qq-plot comparing <code>m1.uts</code> with a standard normal distribution.
</p>
</li>
<li> <p><code>m1.acf</code> - The autocorrelations of <code>m1.uts</code> by lag.
</p>
</li></ul>

<p>If <code>m2</code> is provided, analogous results for <code>m2</code> are also included in the list.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:100]
model = polytrendMod(1,mean(y),10)
M0 = exdqlmISVB(y,p0=0.85,model,df=c(0.95),dim.df = c(1),
                  gam.init=-3.5,sig.init=15)
check.out = exdqlmChecks(y,M0,plot=FALSE)
check.out$m1.KL
check.out$m1


</code></pre>

<hr>
<h2 id='exdqlmForecast'>k-step-ahead Forecast</h2><span id='topic+exdqlmForecast'></span>

<h3>Description</h3>

<p>The function estimates and plots the k-step-ahead forecasted quantile distribution from the filtered quantile estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exdqlmForecast(
  y,
  start.t,
  k,
  m1,
  fFF = NULL,
  fGG = NULL,
  plot = TRUE,
  add = FALSE,
  cols = c("purple", "magenta"),
  cr.percent = 0.95
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exdqlmForecast_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_start.t">start.t</code></td>
<td>
<p>Time index at which to start the forecast.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_k">k</code></td>
<td>
<p>Number of k-steps-ahead to forecast.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_m1">m1</code></td>
<td>
<p>An object of class &quot;<code>exdqlm</code>&quot;.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_fff">fFF</code></td>
<td>
<p>State vector for the forecast steps. <code>fFF</code> must have either 1 (non-time-varying) or k (time-varying) columns. The dimension of <code>fFF</code> must match the estimated exdqlm in <code>m1</code>.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_fgg">fGG</code></td>
<td>
<p>Evolution matrix for the forecast steps. <code>fGG</code> must be either a matrix (non-time-varying) or an array of depth k (time-varying). The dimensions of <code>fGG</code> must match the estimated exdqlm in <code>m1</code>.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_plot">plot</code></td>
<td>
<p>If <code>TRUE</code> the forecasted quantile estimates and 95% credible intervals are plotted, along with the filtered quantile estimates and 95% credible intervals for reference. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, the forecasted quantile will be added to the existing plot. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_cols">cols</code></td>
<td>
<p>Two colors used to plot filtered and forecasted quantile estimates respectively. Default is <code>c("purple","magenta")</code>.</p>
</td></tr>
<tr><td><code id="exdqlmForecast_+3A_cr.percent">cr.percent</code></td>
<td>
<p>Percentage used in the calculation of the credible intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the following is returned:
</p>

<ul>
<li> <p><code>fa</code> - The forecasted state mean vectors.
</p>
</li>
<li> <p><code>fR</code> - The forecasted state covariance matrices.
</p>
</li>
<li> <p><code>ff</code> - The forecasted quantile mean estimates.
</p>
</li>
<li> <p><code>fQ</code> - The forecasted quantile variances.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:100]
model = polytrendMod(1,quantile(y,0.85),10)
M0 = exdqlmISVB(y,p0=0.85,model,df=c(0.98),dim.df = c(1),
                   gam.init=-3.5,sig.init=15)
exdqlmForecast(y,start.t=90,k=10,M0)


</code></pre>

<hr>
<h2 id='exdqlmISVB'>exDQLM - ISVB algorithm</h2><span id='topic+exdqlmISVB'></span>

<h3>Description</h3>

<p>The function applies an Importance Sampling Variational Bayes (ISVB) algorithm to estimate the posterior of an exDQLM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exdqlmISVB(
  y,
  p0,
  model,
  df,
  dim.df,
  fix.gamma = FALSE,
  gam.init = NA,
  fix.sigma = TRUE,
  sig.init = NA,
  dqlm.ind = FALSE,
  exps0,
  tol = 0.1,
  n.IS = 500,
  n.samp = 200,
  PriorSigma = NULL,
  PriorGamma = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exdqlmISVB_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_p0">p0</code></td>
<td>
<p>The quantile of interest, a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_model">model</code></td>
<td>
<p>List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_df">df</code></td>
<td>
<p>Discount factors for each block.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_dim.df">dim.df</code></td>
<td>
<p>Dimension of each block of discount factors.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_fix.gamma">fix.gamma</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>gam.init</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_gam.init">gam.init</code></td>
<td>
<p>Initial value for gamma (skewness parameter), or value at which gamma will be fixed if <code>fix.gamma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_fix.sigma">fix.sigma</code></td>
<td>
<p>Logical value indicating whether to fix sigma at <code>sig.init</code>. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_sig.init">sig.init</code></td>
<td>
<p>Initial value for sigma (scale parameter), or value at which sigma will be fixed if <code>fix.sigma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_dqlm.ind">dqlm.ind</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>0</code>, reducing the exDQLM to the special case of the DQLM. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_exps0">exps0</code></td>
<td>
<p>Initial value for dynamic quantile. If <code>exps0</code> is not specified, it is set to the DLM estimate of the <code>p0</code> quantile.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence of dynamic quantile estimates. Default is <code>tol=0.1</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_n.is">n.IS</code></td>
<td>
<p>Number of particles for the importance sampling of joint variational distribution of sigma and gamma. Default is <code>n.IS=500</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_n.samp">n.samp</code></td>
<td>
<p>Number of samples to draw from the approximated posterior distribution. Default is <code>n.samp=200</code>.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_priorsigma">PriorSigma</code></td>
<td>
<p>List of parameters for inverse gamma prior on sigma; shape <code>a_sig</code> and scale <code>b_sig</code>. Default is an inverse gamma with mean 1 (or <code>sig.init</code> if provided) and variance 10.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_priorgamma">PriorGamma</code></td>
<td>
<p>List of parameters for truncated student-t prior on gamma; center <code>m_gam</code>, scale <code>s_gam</code> and degrees of freedom <code>df_gam</code>. Default is a standard student-t with 1 degree of freedom, truncated to the support of gamma.</p>
</td></tr>
<tr><td><code id="exdqlmISVB_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether progress should be displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>run.time</code> - Algorithm run time in seconds.
</p>
</li>
<li> <p><code>iter</code> - Number of iterations until convergence was reached.
</p>
</li>
<li> <p><code>dqlm.ind</code> - Logical value indicating whether gamma was fixed at <code>0</code>, reducing the exDQLM to the special case of the DQLM.
</p>
</li>
<li> <p><code>model</code> - List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.
</p>
</li>
<li> <p><code>p0</code> - The quantile which was estimated.
</p>
</li>
<li> <p><code>df</code> - Discount factors used for each block.
</p>
</li>
<li> <p><code>dim.df</code> - Dimension used for each block of discount factors.
</p>
</li>
<li> <p><code>sig.init</code> - Initial value for sigma, or value at which sigma was fixed if <code>fix.sigma=TRUE</code>.
</p>
</li>
<li> <p><code>seq.sigma</code> - Sequence of sigma estimated by the algorithm until convergence.
</p>
</li>
<li> <p><code>samp.theta</code> - Posterior sample of the state vector variational distribution.
</p>
</li>
<li> <p><code>samp.post.pred</code> - Sample of the posterior predictive distributions.
</p>
</li>
<li> <p><code>map.standard.forecast.errors</code> - MAP standardized one-step-ahead forecast errors.
</p>
</li>
<li> <p><code>samp.sigma</code> - Posterior sample of scale parameter sigma variational distribution.
</p>
</li>
<li> <p><code>samp.vts</code> - Posterior sample of latent parameters, v_t, variational distributions.
</p>
</li>
<li> <p><code>theta.out</code> - List containing the variational distribution of the state vector including filtered distribution parameters (<code>fm</code> and <code>fC</code>) and smoothed distribution parameters (<code>sm</code> and <code>sC</code>).
</p>
</li>
<li> <p><code>vts.out</code> - List containing the variational distributions of latent parameters v_t.
</p>
</li></ul>

<p>If <code>dqlm.ind=FALSE</code>, the list also contains:
</p>

<ul>
<li> <p><code>gam.init</code> - Initial value for gamma, or value at which gamma was fixed if <code>fix.gamma=TRUE</code>.
</p>
</li>
<li> <p><code>seq.gamma</code> - Sequence of gamma estimated by the algorithm until convergence.
</p>
</li>
<li> <p><code>samp.gamma</code> - Posterior sample of skewness parameter gamma variational distribution.
</p>
</li>
<li> <p><code>samp.sts</code> - Posterior sample of latent parameters, s_t, variational distributions.
</p>
</li>
<li> <p><code>gammasig.out</code> - List containing the IS estimate of the variational distribution of sigma and gamma.
</p>
</li>
<li> <p><code>sts.out</code> - List containing the variational distributions of latent parameters s_t.
</p>
</li></ul>

<p>Or if <code>dqlm.ind=TRUE</code>, the list also contains:
</p>

<ul>
<li> <p><code>sig.out</code> - List containing the IS estimate of the variational distribution of sigma.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:1095]
trend.comp = polytrendMod(1,mean(y),10)
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
M0 = exdqlmISVB(y,p0=0.85,model,df=c(1,1),dim.df = c(1,6),
                 gam.init=-3.5,sig.init=15,tol=0.05)


</code></pre>

<hr>
<h2 id='exdqlmMCMC'>exDQLM - MCMC algorithm</h2><span id='topic+exdqlmMCMC'></span>

<h3>Description</h3>

<p>The function applies a Markov chain Monte Carlo (MCMC) algorithm to sample the posterior of an exDQLM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exdqlmMCMC(
  y,
  p0,
  model,
  df,
  dim.df,
  fix.gamma = FALSE,
  gam.init = NA,
  fix.sigma = FALSE,
  sig.init = NA,
  dqlm.ind = FALSE,
  Sig.mh,
  joint.sample = FALSE,
  n.burn = 2000,
  n.mcmc = 1500,
  init.from.isvb = TRUE,
  PriorSigma = NULL,
  PriorGamma = NULL,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exdqlmMCMC_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_p0">p0</code></td>
<td>
<p>The quantile of interest, a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_model">model</code></td>
<td>
<p>List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_df">df</code></td>
<td>
<p>Discount factors for each block.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_dim.df">dim.df</code></td>
<td>
<p>Dimension of each block of discount factors.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_fix.gamma">fix.gamma</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>gam.init</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_gam.init">gam.init</code></td>
<td>
<p>Initial value for gamma (skewness parameter), or value at which gamma will be fixed if <code>fix.gamma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_fix.sigma">fix.sigma</code></td>
<td>
<p>Logical value indicating whether to fix sigma at <code>sig.init</code>. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_sig.init">sig.init</code></td>
<td>
<p>Initial value for sigma (scale parameter), or value at which sigma will be fixed if <code>fix.sigma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_dqlm.ind">dqlm.ind</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>0</code>, reducing the exDQLM to the special case of the DQLM. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_sig.mh">Sig.mh</code></td>
<td>
<p>Covariance matrix used in the random walk MH step to jointly sample sigma and gamma.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_joint.sample">joint.sample</code></td>
<td>
<p>Logical value indicating whether or not to recompute <code>Sig.mh</code> based off the initial burn-in samples of gamma and sigma. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_n.burn">n.burn</code></td>
<td>
<p>Number of MCMC iterations to burn. Default is <code>n.burn = 2000</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_n.mcmc">n.mcmc</code></td>
<td>
<p>Number of MCMC iterations to sample. Default is <code>n.mcmc = 1500</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_init.from.isvb">init.from.isvb</code></td>
<td>
<p>Logical value indicating whether or not to initialize the MCMC using the ISVB algorithm. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_priorsigma">PriorSigma</code></td>
<td>
<p>List of parameters for inverse gamma prior on sigma; shape <code>a_sig</code> and scale <code>b_sig</code>. Default is an inverse gamma with mean 1 (or <code>sig.init</code> if provided) and variance 10.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_priorgamma">PriorGamma</code></td>
<td>
<p>List of parameters for truncated student-t prior on gamma; center <code>m_gam</code>, scale <code>s_gam</code> and degrees of freedom <code>df_gam</code>. Default is a standard student-t with 1 degree of freedom, truncated to the support of gamma.</p>
</td></tr>
<tr><td><code id="exdqlmMCMC_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether progress should be displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>run.time</code> - Algorithm run time in seconds.
</p>
</li>
<li> <p><code>model</code> - List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.
</p>
</li>
<li> <p><code>p0</code> - The quantile which was estimated.
</p>
</li>
<li> <p><code>df</code> - Discount factors used for each block.
</p>
</li>
<li> <p><code>dim.df</code> - Dimension used for each block of discount factors.
</p>
</li>
<li> <p><code>samp.theta</code> - Posterior sample of the state vector.
</p>
</li>
<li> <p><code>samp.post.pred</code> - Sample of the posterior predictive distributions.
</p>
</li>
<li> <p><code>map.standard.forecast.errors</code> - MAP standardized one-step-ahead forecast errors.
</p>
</li>
<li> <p><code>samp.sigma</code> - Posterior sample of scale parameter sigma.
</p>
</li>
<li> <p><code>samp.vts</code> - Posterior sample of latent parameters, v_t.
</p>
</li>
<li> <p><code>theta.out</code> - List containing the distributions of the state vector including filtered distribution parameters (<code>fm</code> and <code>fC</code>) and smoothed distribution parameters (<code>sm</code> and <code>sC</code>).
</p>
</li></ul>

<p>If <code>dqlm.ind=FALSE</code>, the list also contains the following:
</p>

<ul>
<li> <p><code>samp.gamma</code> - Posterior sample of skewness parameter gamma.
</p>
</li>
<li> <p><code>samp.sts</code> - Posterior sample of latent parameters, s_t.
</p>
</li>
<li> <p><code>init.log.sigma</code> - Burned samples of log sigma from the random walk MH joint sampling of sigma and gamma.
</p>
</li>
<li> <p><code>init.logit.gamma</code> - Burned samples of logit gamma from the random walk MH joint sampling of sigma and gamma.
</p>
</li>
<li> <p><code>accept.rate</code> - Acceptance rate of the MH step.
</p>
</li>
<li> <p><code>Sig.mh</code> - Covariance matrix used in MH step to jointly sample sigma and gamma.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:100]
trend.comp = polytrendMod(1,mean(y),10)
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
M2 = exdqlmMCMC(y,p0=0.85,model,df=c(1,1),dim.df = c(1,6),
                gam.init=-3.5,sig.init=15,
                n.burn=100,n.mcmc=150)


</code></pre>

<hr>
<h2 id='exdqlmPlot'>Plot exDQLM</h2><span id='topic+exdqlmPlot'></span>

<h3>Description</h3>

<p>The function plots the MAP estimates and 95% credible intervals (CrIs) of the dynamic quantile of an exDQLM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exdqlmPlot(y, m1, add = FALSE, col = "purple", cr.percent = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exdqlmPlot_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="exdqlmPlot_+3A_m1">m1</code></td>
<td>
<p>An object of class &quot;<code>exdqlm</code>&quot;.</p>
</td></tr>
<tr><td><code id="exdqlmPlot_+3A_add">add</code></td>
<td>
<p>If <code>TRUE</code>, the dynamic quantile will be added to existing plot.</p>
</td></tr>
<tr><td><code id="exdqlmPlot_+3A_col">col</code></td>
<td>
<p>Color of dynamic quantile to be plotted. Default is <code>purple</code>.</p>
</td></tr>
<tr><td><code id="exdqlmPlot_+3A_cr.percent">cr.percent</code></td>
<td>
<p>Percentage used in the calculation of the credible intervals.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>map.quant</code> - MAP estimate of the dynamic quantile.
</p>
</li>
<li> <p><code>lb.quant</code> - Lower bound of the 95% CrIs of the dynamic quantile.
</p>
</li>
<li> <p><code>ub.quant</code> - Upper bound of the 95% CrIs of the dynamic quantile.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:100]
model = polytrendMod(1,quantile(y,0.85),10)
M0 = exdqlmISVB(y,p0=0.85,model,df=c(0.98),dim.df = c(1),
                   gam.init=-3.5,sig.init=15)
exdqlmPlot(y,M0,col="blue")


</code></pre>

<hr>
<h2 id='nino34'>Monthly Niño 3.4 Index.</h2><span id='topic+nino34'></span>

<h3>Description</h3>

<p>Monthly Niño 3.4 sea surface temperature (SST) Index time series.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nino34
</code></pre>


<h3>Format</h3>

<p>A time series of length 936.
</p>


<h3>Source</h3>

<p><a href="https://psl.noaa.gov/gcos_wgsp/Timeseries/Nino34/">https://psl.noaa.gov/gcos_wgsp/Timeseries/Nino34/</a>
</p>


<h3>References</h3>

<p>Rayner N. A., D. E. Parker, E. B. Horton, C. K. Folland, L. V. Alexander, D. P. Rowell, E. C. Kent, A. Kaplan. <em>Global analyses of sea surface temperature, sea ice, and night marine air temperature since the late nineteenth century</em>. J. Geophys. Res., 108 (D14), 4407 (2003). doi: <a href="https://doi.org/10.1029/2002JD002670">10.1029/2002JD002670</a>
</p>

<hr>
<h2 id='polytrendMod'>Create an n-th order polynomial exDQLM component</h2><span id='topic+polytrendMod'></span>

<h3>Description</h3>

<p>The function creates an n-th order polynomial exDQLM component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>polytrendMod(order, m0, C0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="polytrendMod_+3A_order">order</code></td>
<td>
<p>The order of the polynomial model.</p>
</td></tr>
<tr><td><code id="polytrendMod_+3A_m0">m0</code></td>
<td>
<p>Prior mean of the state vector. Default is <code>m0 = rep(0,order)</code>.</p>
</td></tr>
<tr><td><code id="polytrendMod_+3A_c0">C0</code></td>
<td>
<p>Prior covariance of the state vector. Default is <code>C0 = 1e3*diag(order)</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following:
</p>

<ul>
<li><p> FF - Observational vector.
</p>
</li>
<li><p> GG - Evolution matrix.
</p>
</li>
<li><p> m0 - Prior mean of the state vector.
</p>
</li>
<li><p> C0 - Prior covariance of the state vector.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># create a second order polynomial component
trend.comp = polytrendMod(2,rep(0,2),10*diag(2))
</code></pre>

<hr>
<h2 id='scIVTmag'>Time series of daily average magnitude IVT in Santa Cruz, CA.</h2><span id='topic+scIVTmag'></span>

<h3>Description</h3>

<p>ECMWF Re-Analysis 5 (ERA5) daily average magnitude IVT in Santa Cruz, CA (approximately 22 N, 122 W)
from January 1, 1979 to December 31, 2019 with all February 29ths omitted.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>scIVTmag
</code></pre>


<h3>Format</h3>

<p>A time series of length 14965.
</p>


<h3>Source</h3>

<p><a href="https://cds.climate.copernicus.eu">https://cds.climate.copernicus.eu</a>
</p>


<h3>References</h3>

<p>Hersbach, H, Bell, B, Berrisford, P, et al. <em>The ERA5 global reanalysis.</em> Q J R Meteorol Soc. 2020; 146: 1999– 2049. doi: <a href="https://doi.org/10.1002/qj.3803">10.1002/qj.3803</a>
</p>

<hr>
<h2 id='seasMod'>Create Fourier representation of a periodic exDQLM component</h2><span id='topic+seasMod'></span>

<h3>Description</h3>

<p>The function creates a Fourier form periodic component for given period and harmonics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasMod(p, h, m0, C0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seasMod_+3A_p">p</code></td>
<td>
<p>The period.</p>
</td></tr>
<tr><td><code id="seasMod_+3A_h">h</code></td>
<td>
<p>Vector of harmonics to be included.</p>
</td></tr>
<tr><td><code id="seasMod_+3A_m0">m0</code></td>
<td>
<p>Prior mean of the state vector.</p>
</td></tr>
<tr><td><code id="seasMod_+3A_c0">C0</code></td>
<td>
<p>Prior covariance of the state vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following:
</p>

<ul>
<li><p> FF - Observational vector.
</p>
</li>
<li><p> GG - Evolution matrix.
</p>
</li>
<li><p> m0 - Prior mean of the state vector.
</p>
</li>
<li><p> C0 - Prior covariance of the state vector.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'># create a seasonal component with first, second and fourth harmonics of a period of 365
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))

</code></pre>

<hr>
<h2 id='transfn_exdqlmISVB'>Transfer Function exDQLM - ISVB algorithm</h2><span id='topic+transfn_exdqlmISVB'></span>

<h3>Description</h3>

<p>The function applies an Importance Sampling Variational Bayes (ISVB) algorithm to estimate the posterior of an exDQLM with exponential decay transfer function component.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transfn_exdqlmISVB(
  y,
  p0,
  model,
  X,
  df,
  dim.df,
  lam,
  tf.df,
  fix.gamma = FALSE,
  gam.init = NA,
  fix.sigma = TRUE,
  sig.init = NA,
  dqlm.ind = FALSE,
  exps0,
  tol = 0.1,
  n.IS = 500,
  n.samp = 200,
  PriorSigma = NULL,
  PriorGamma = NULL,
  tf.m0 = rep(0, 2),
  tf.C0 = diag(1, 2),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="transfn_exdqlmISVB_+3A_y">y</code></td>
<td>
<p>A univariate time-series.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_p0">p0</code></td>
<td>
<p>The quantile of interest, a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_model">model</code></td>
<td>
<p>List of the state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_x">X</code></td>
<td>
<p>A univariate time-series which will be the input of the transfer function component.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_df">df</code></td>
<td>
<p>Discount factors for each block.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_dim.df">dim.df</code></td>
<td>
<p>Dimension of each block of discount factors.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_lam">lam</code></td>
<td>
<p>Transfer function rate parameter lambda, a value between 0 and 1.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_tf.df">tf.df</code></td>
<td>
<p>Discount factor(s) used for the transfer function component.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_fix.gamma">fix.gamma</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>gam.init</code>. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_gam.init">gam.init</code></td>
<td>
<p>Initial value for gamma (skewness parameter), or value at which gamma will be fixed if <code>fix.gamma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_fix.sigma">fix.sigma</code></td>
<td>
<p>Logical value indicating whether to fix sigma at <code>sig.init</code>. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_sig.init">sig.init</code></td>
<td>
<p>Initial value for sigma (scale parameter), or value at which sigma will be fixed if <code>fix.sigma=TRUE</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_dqlm.ind">dqlm.ind</code></td>
<td>
<p>Logical value indicating whether to fix gamma at <code>0</code>, reducing the exDQLM to the special case of the DQLM. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_exps0">exps0</code></td>
<td>
<p>Initial value for dynamic quantile. If <code>exps0</code> is not specified, it is set to the DLM estimate of the <code>p0</code> quantile.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_tol">tol</code></td>
<td>
<p>Tolerance for convergence of dynamic quantile estimates. Default is <code>tol=0.1</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_n.is">n.IS</code></td>
<td>
<p>Number of particles for the importance sampling of joint variational distribution of sigma and gamma. Default is <code>n.IS=500</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_n.samp">n.samp</code></td>
<td>
<p>Number of samples to draw from the approximated posterior distribution. Default is <code>n.samp=200</code>.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_priorsigma">PriorSigma</code></td>
<td>
<p>List of parameters for inverse gamma prior on sigma; shape <code>a_sig</code> and scale <code>b_sig</code>. Default is an inverse gamma with mean 1 (or <code>sig.init</code> if provided) and variance 10.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_priorgamma">PriorGamma</code></td>
<td>
<p>List of parameters for truncated student-t prior on gamma; center <code>m_gam</code>, scale <code>s_gam</code> and degrees of freedom <code>df_gam</code>. Default is a standard student-t with 1 degree of freedom, truncated to the support of gamma.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_tf.m0">tf.m0</code></td>
<td>
<p>Prior mean of the transfer function component.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_tf.c0">tf.C0</code></td>
<td>
<p>Prior covariance of the transfer function component.</p>
</td></tr>
<tr><td><code id="transfn_exdqlmISVB_+3A_verbose">verbose</code></td>
<td>
<p>Logical value indicating whether progress should be displayed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of the following is returned:
</p>

<ul>
<li> <p><code>run.time</code> - Algorithm run time in seconds.
</p>
</li>
<li> <p><code>iter</code> - Number of iterations until convergence was reached.
</p>
</li>
<li> <p><code>dqlm.ind</code> - Logical value indicating whether gamma was fixed at <code>0</code>, reducing the exDQLM to the special case of the DQLM.
</p>
</li>
<li> <p><code>model</code> - List of the augmented state-space model including <code>GG</code>, <code>FF</code>, prior parameters <code>m0</code> and <code>C0</code>.
</p>
</li>
<li> <p><code>p0</code> - The quantile which was estimated.
</p>
</li>
<li> <p><code>df</code> - Discount factors used for each block, including transfer function component.
</p>
</li>
<li> <p><code>dim.df</code> - Dimension used for each block of discount factors, including transfer function component.
</p>
</li>
<li> <p><code>lam</code> - Transfer function rate parameter lambda.
</p>
</li>
<li> <p><code>sig.init</code> - Initial value for sigma, or value at which sigma was fixed if <code>fix.sigma=TRUE</code>.
</p>
</li>
<li> <p><code>seq.sigma</code> - Sequence of sigma estimated by the algorithm until convergence.
</p>
</li>
<li> <p><code>samp.theta</code> - Posterior sample of the state vector variational distribution.
</p>
</li>
<li> <p><code>samp.post.pred</code> - Sample of the posterior predictive distributions.
</p>
</li>
<li> <p><code>map.standard.forecast.errors</code> - MAP standardized one-step-ahead forecast errors.
</p>
</li>
<li> <p><code>samp.sigma</code> - Posterior sample of scale parameter sigma variational distribution.
</p>
</li>
<li> <p><code>samp.vts</code> - Posterior sample of latent parameters, v_t, variational distributions.
</p>
</li>
<li> <p><code>theta.out</code> - List containing the variational distribution of the state vector including filtered distribution parameters (<code>fm</code> and <code>fC</code>) and smoothed distribution parameters (<code>sm</code> and <code>sC</code>).
</p>
</li>
<li> <p><code>vts.out</code> - List containing the variational distributions of latent parameters v_t.
</p>
</li>
<li> <p><code>median.kt</code> - Median number of time steps until the effect of X_t is less than or equal to 1e-3.
</p>
</li></ul>

<p>If <code>dqlm.ind=FALSE</code>, the list also contains:
</p>

<ul>
<li> <p><code>gam.init</code> - Initial value for gamma, or value at which gamma was fixed if <code>fix.gamma=TRUE</code>.
</p>
</li>
<li> <p><code>seq.gamma</code> - Sequence of gamma estimated by the algorithm until convergence.
</p>
</li>
<li> <p><code>samp.gamma</code> - Posterior sample of skewness parameter gamma variational distribution.
</p>
</li>
<li> <p><code>samp.sts</code> - Posterior sample of latent parameters, s_t, variational distributions.
</p>
</li>
<li> <p><code>gammasig.out</code> - List containing the IS estimate of the variational distribution of sigma and gamma.
</p>
</li>
<li> <p><code>sts.out</code> - List containing the variational distributions of latent parameters s_t.
</p>
</li></ul>

<p>Or if <code>dqlm.ind=TRUE</code>, the list also contains:
</p>

<ul>
<li> <p><code>sig.out</code> - List containing the IS estimate of the variational distribution of sigma.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
y = scIVTmag[1:1095]
X = ELIanoms[1:1095]
trend.comp = polytrendMod(1,mean(y),10)
seas.comp = seasMod(365,c(1,2,4),C0=10*diag(6))
model = combineMods(trend.comp,seas.comp)
M1 = transfn_exdqlmISVB(y,p0=0.85,model=model,
                          X,df=c(1,1),dim.df = c(1,6),
                          gam.init=-3.5,sig.init=15,
                          lam=0.38,tf.df=c(0.97,0.97))


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
