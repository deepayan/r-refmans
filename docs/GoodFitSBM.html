<!DOCTYPE html><html><head><title>Help for package GoodFitSBM</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {GoodFitSBM}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#get_mle_BetaSBM'><p>Maximum Likelihood Estimation of edge probabilities between blocks of a graph, under beta-SBM</p></a></li>
<li><a href='#get_mle_ERSBM'><p>Maximum Likelihood Estimation of edge probabilities between blocks of a graph, under ERSBM</p></a></li>
<li><a href='#goftest_BetaSBM'><p>Monte Carlo goodness-of-fit test for a beta stochastic blockmodel (beta-SBM)</p></a></li>
<li><a href='#goftest_ERSBM'><p>Monte Carlo goodness-of-fit test for an Erdős-Rényi stochastic blockmodel (ERSBM)</p></a></li>
<li><a href='#graphchi_BetaSBM'><p>Computation of the chi-square test statistic for goodness-of-fit, under beta-SBM</p></a></li>
<li><a href='#graphchi_ERSBM'><p>Computation of the chi-square test statistic for goodness-of-fit, under ERSBM</p></a></li>
<li><a href='#sample_a_move_BetaSBM'><p>Sampling a graph through a Markov move (basis) for beta-SBM</p></a></li>
<li><a href='#sample_a_move_ERSBM'><p>Sampling a graph through a Markov move (basis) for ERSBM</p></a></li>
<li><a href='#zachary'><p>Zachary Karate Club Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Monte Carlo Goodness-of-Fit Tests for Stochastic Block Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Performing goodness-of-fit tests for stochastic block models used to fit network data. Among the three variants discussed in Karwa et al. (2023) &lt;<a href="https://doi.org/10.1093%2Fjrsssb%2Fqkad084">doi:10.1093/jrsssb/qkad084</a>&gt;, goodness-of-fit test has been performed for the Erdos-Renyi (ER) and Beta versions. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Roy-SR-007/GoodFitSBM">https://github.com/Roy-SR-007/GoodFitSBM</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/Roy-SR-007/GoodFitSBM/issues">https://github.com/Roy-SR-007/GoodFitSBM/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, igraph, utils, irlba</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Collate:</td>
<td>'Bipartite_Walk.R' 'Estimation_BetaSBM.R' 'Estimation_Block.R'
'Estimation_ERSBM.R' 'Get_Directed_Piece.R'
'Get_Directed_Move_p1_ed.R'
'Get_Between_Blocks_Move_beta_SBM.R' 'as_arbitrary_directed.R'
'Get_Bidirected_Piece.R' 'Get_Bidirected_Move.R'
'Get_Induced_Subgraph.R' 'Get_Within_Blocks_beta_SBM.R'
'Get_Move_Beta_SBM.R' 'Get_Next_Network.R'
'Sampling_Graph_BetaSBM.R' 'TestStatistic_BetaSBM.R'
'GoFTest_BetaSBM.R' 'Sampling_Graph_ERSBM.R'
'TestStatistic_ERSBM.R' 'GoFTest_ERSBM.R' 'zachary.R'</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-22 18:09:10 UTC; sohamghosh</td>
</tr>
<tr>
<td>Author:</td>
<td>Soham Ghosh [aut, cre],
  Somjit Roy [aut],
  Debdeep Pati [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Soham Ghosh &lt;sohamghosh@tamu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-23 19:10:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='get_mle_BetaSBM'>Maximum Likelihood Estimation of edge probabilities between blocks of a graph, under beta-SBM</h2><span id='topic+get_mle_BetaSBM'></span>

<h3>Description</h3>

<p><code>get_mle_BetaSBM</code> obtains MLE for the probability of edges between blocks in a graph, used in calculating the goodness-of-fit test statistic for the beta-SBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mle_BetaSBM(G, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mle_BetaSBM_+3A_g">G</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
<tr><td><code id="get_mle_BetaSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of maximum likelihood estimates
</p>
<table>
<tr><td><code>mleMatr</code></td>
<td>
<p>a matrix containing the estimated edge probabilities between blocks in a graph</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_BetaSBM">goftest_BetaSBM()</a></code> performs the goodness-of-fit test for the beta-SBM, where the MLE of the edge probabilities are required
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 &lt;- 2
n2 &lt;- 2
n3 &lt;- 2

# Generating block assignments for each of the nodes
n &lt;- n1 + n2 + n3
class &lt;- rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat &lt;- matrix(
  c(
    0.80, 0.50, 0.50,
    0.50, 0.80, 0.50,
    0.50, 0.50, 0.80
  ),
  ncol = 3,
  byrow = TRUE
)
pmat &lt;- cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p &lt;- pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] &lt;- rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm &lt;- adj + t(adj)

# graph from the adjacency matrix
G &lt;- igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# mle of the edge probabilities
get_mle_BetaSBM(G, class)

</code></pre>

<hr>
<h2 id='get_mle_ERSBM'>Maximum Likelihood Estimation of edge probabilities between blocks of a graph, under ERSBM</h2><span id='topic+get_mle_ERSBM'></span>

<h3>Description</h3>

<p><code>get_mle_ERSBM</code> obtains MLE for the probability of edges between blocks in a graph, used in calculating the goodness-of-fit test statistic for the ERSBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_mle_ERSBM(G, C)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_mle_ERSBM_+3A_g">G</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
<tr><td><code id="get_mle_ERSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of maximum likelihood estimates
</p>
<table>
<tr><td><code>mleMatr</code></td>
<td>
<p>a matrix containing the estimated edge probabilities between blocks in a graph</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_ERSBM">goftest_ERSBM()</a></code> performs the goodness-of-fit test for the ERSBM, where the MLE of the edge probabilities are required
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 2
n2 = 2
n3 = 2

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    0.80, 0.05, 0.05,
    0.05, 0.80, 0.05,
    0.05, 0.05, 0.80
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# graph from the adjacency matrix
G = igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# mle of the edge probabilities
get_mle_ERSBM(G, class)

</code></pre>

<hr>
<h2 id='goftest_BetaSBM'>Monte Carlo goodness-of-fit test for a beta stochastic blockmodel (beta-SBM)</h2><span id='topic+goftest_BetaSBM'></span>

<h3>Description</h3>

<p><code>goftest_BetaSBM</code> performs chi square goodness-of-fit test for network data considering the model as beta-SBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goftest_BetaSBM(A, K = NULL, C = NULL, numGraphs = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goftest_BetaSBM_+3A_a">A</code></td>
<td>
<p>n by n binary symmetric adjacency matrix representing an undirected graph where n is the number of nodes in the graph</p>
</td></tr>
<tr><td><code id="goftest_BetaSBM_+3A_k">K</code></td>
<td>
<p>positive integer scalar representing the number of blocks; K&gt;1</p>
</td></tr>
<tr><td><code id="goftest_BetaSBM_+3A_c">C</code></td>
<td>
<p>positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="goftest_BetaSBM_+3A_numgraphs">numGraphs</code></td>
<td>
<p>number of graphs to be sampled; default value is 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the values of the chi-square test statistics on each sampled graph</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 10
n2 = 10
n3 = 10

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    0.80, 0.05, 0.05,
    0.05, 0.80, 0.05,
    0.05, 0.05, 0.80
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# When class assignment is known
out = goftest_BetaSBM(adjsymm, C = class, numGraphs = 10)

chi_sq_seq = out$statistic
pvalue = out$p.value
print(pvalue)

# Plotting histogram of the sequence of the test statistics
hist(chi_sq_seq, 20, xlab = "chi-square test statistics", main = NULL)
abline(v = chi_sq_seq[1], col = "red", lwd = 5) # adding test statistic on the observed network
legend("topleft", legend = paste("observed GoF = ", chi_sq_seq[1]))

</code></pre>

<hr>
<h2 id='goftest_ERSBM'>Monte Carlo goodness-of-fit test for an Erdős-Rényi stochastic blockmodel (ERSBM)</h2><span id='topic+goftest_ERSBM'></span>

<h3>Description</h3>

<p><code>goftest_ERSBM</code> performs chi square goodness-of-fit test for network data considering the model as  ERSBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>goftest_ERSBM(A, K = NULL, C = NULL, numGraphs = 100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="goftest_ERSBM_+3A_a">A</code></td>
<td>
<p>n by n binary symmetric adjacency matrix representing an undirected graph where n is the number of nodes in the graph</p>
</td></tr>
<tr><td><code id="goftest_ERSBM_+3A_k">K</code></td>
<td>
<p>positive integer scalar representing the number of blocks; K&gt;1</p>
</td></tr>
<tr><td><code id="goftest_ERSBM_+3A_c">C</code></td>
<td>
<p>positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="goftest_ERSBM_+3A_numgraphs">numGraphs</code></td>
<td>
<p>number of graphs to be sampled; default value is 100</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the elements
</p>
<table>
<tr><td><code>statistic</code></td>
<td>
<p>the values of the chi-square test statistics on each sampled graph</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>the p-value for the test</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 10
n2 = 10
n3 = 10

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    0.80, 0.05, 0.05,
    0.05, 0.80, 0.05,
    0.05, 0.05, 0.80
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# When class assignment is known
out = goftest_ERSBM(adjsymm, C = class, numGraphs = 10)

chi_sq_seq = out$statistic
pvalue = out$p.value
print(pvalue)

# Plotting histogram of the sequence of the test statistics
hist(chi_sq_seq, 20, xlab = "chi-square test statistics", main = NULL)
abline(v = chi_sq_seq[1], col = "red", lwd = 5) # adding test statistic on the observed network
legend("topleft", legend = paste("observed GoF = ", chi_sq_seq[1]))

</code></pre>

<hr>
<h2 id='graphchi_BetaSBM'>Computation of the chi-square test statistic for goodness-of-fit, under beta-SBM</h2><span id='topic+graphchi_BetaSBM'></span>

<h3>Description</h3>

<p><code>graphchi_BetaSBM</code> obtains the value of the chi-square test statistic required for the goodness-of-fit of a beta-SBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphchi_BetaSBM(G, C, p_mle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphchi_BetaSBM_+3A_g">G</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
<tr><td><code id="graphchi_BetaSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="graphchi_BetaSBM_+3A_p_mle">p_mle</code></td>
<td>
<p>a matrix with the MLE estimates of the edge probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value
</p>
<table>
<tr><td><code>teststat_val</code></td>
<td>
<p>The value of the chi-square test statistic</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_BetaSBM">goftest_BetaSBM()</a></code> performs the goodness-of-fit test for the beta-SBM, where the values of the chi-square test statistics are required
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 2
n2 = 2
n3 = 2

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    0.80, 0.5, 0.5,
    0.5, 0.80, 0.5,
    0.5, 0.5, 0.80
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# graph from the adjacency matrix
G = igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# mle of the edge probabilities
p.hat = get_mle_BetaSBM (G, class)

# chi-square test statistic values
graphchi_BetaSBM(G, class, p.hat)
</code></pre>

<hr>
<h2 id='graphchi_ERSBM'>Computation of the chi-square test statistic for goodness-of-fit, under ERSBM</h2><span id='topic+graphchi_ERSBM'></span>

<h3>Description</h3>

<p><code>graphchi_ERSBM</code> obtains the value of the chi-square test statistic required for the goodness-of-fit of a ERSBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>graphchi_ERSBM(G, C, p_mle)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="graphchi_ERSBM_+3A_g">G</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
<tr><td><code id="graphchi_ERSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="graphchi_ERSBM_+3A_p_mle">p_mle</code></td>
<td>
<p>a matrix with the MLE estimates of the edge probabilities</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value
</p>
<table>
<tr><td><code>teststat_val</code></td>
<td>
<p>The value of the chi-square test statistic</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_ERSBM">goftest_ERSBM()</a></code> performs the goodness-of-fit test for the ERSBM, where the values of the chi-square test statistics are required
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 2
n2 = 2
n3 = 2

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    0.8, 0.5, 0.5,
    0.5, 0.8, 0.5,
    0.5, 0.5, 0.8
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# graph from the adjacency matrix
G = igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# mle of the edge probabilities
p.hat = get_mle_ERSBM(G, class)

# chi-square test statistic values
graphchi_ERSBM(G, class, p.hat)
</code></pre>

<hr>
<h2 id='sample_a_move_BetaSBM'>Sampling a graph through a Markov move (basis) for beta-SBM</h2><span id='topic+sample_a_move_BetaSBM'></span>

<h3>Description</h3>

<p><code>sample_a_move_BetaSBM</code> to sample a graph in the same fiber; sampling according to the beta-SBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_a_move_BetaSBM(C, G_current)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_a_move_BetaSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="sample_a_move_BetaSBM_+3A_g_current">G_current</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graph
</p>
<table>
<tr><td><code>sampled graph</code></td>
<td>
<p>the sampled graph after one move as per the beta-SBM</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_BetaSBM">goftest_BetaSBM()</a></code> performs the goodness-of-fit test for the beta-SBM, where graphs are being sampled
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 5
n2 = 5
n3 = 5

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    10, 0.05, 0.05,
    0.05, 10, 0.05,
    0.05, 0.05, 10
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# graph from the adjacency matrix
G = igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# sampling a Markov move for the beta-SBM
G_sample = sample_a_move_BetaSBM(class, G)

# plotting the sampled graph
plot(G_sample, main = "The sampled graph after one Markov move for beta-SBM")

</code></pre>

<hr>
<h2 id='sample_a_move_ERSBM'>Sampling a graph through a Markov move (basis) for ERSBM</h2><span id='topic+sample_a_move_ERSBM'></span>

<h3>Description</h3>

<p><code>sample_a_move_ERSBM</code> to sample a graph in the same fiber; sampling according to the ERSBM (Karwa et al. (2023))
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sample_a_move_ERSBM(C, G_current)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sample_a_move_ERSBM_+3A_c">C</code></td>
<td>
<p>a positive integer vector of size n for block assignments of each node; from 1 to K (no of blocks)</p>
</td></tr>
<tr><td><code id="sample_a_move_ERSBM_+3A_g_current">G_current</code></td>
<td>
<p>an igraph object which is an undirected graph with no self loop</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A graph
</p>
<table>
<tr><td><code>sampled graph</code></td>
<td>
<p>the sampled graph after one move as per the ERSBM</p>
</td></tr>
</table>


<h3>References</h3>

<p>Karwa et al. (2023). &quot;Monte Carlo goodness-of-fit tests for degree corrected and related stochastic blockmodels&quot;,
<em>Journal of the Royal Statistical Society Series B: Statistical Methodology</em>,
<a href="https://doi.org/10.1093/jrsssb/qkad084">doi:10.1093/jrsssb/qkad084</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+goftest_ERSBM">goftest_ERSBM()</a></code> performs the goodness-of-fit test for the ERSBM, where graphs are being sampled
</p>


<h3>Examples</h3>

<pre><code class='language-R'>RNGkind(sample.kind = "Rounding")
set.seed(1729)

# We model a network with 3 even classes
n1 = 5
n2 = 5
n3 = 5

# Generating block assignments for each of the nodes
n = n1 + n2 + n3
class = rep(c(1, 2, 3), c(n1, n2, n3))

# Generating the adjacency matrix of the network
# Generate the matrix of connection probabilities
cmat = matrix(
  c(
    10, 0.05, 0.05,
    0.05, 10, 0.05,
    0.05, 0.05, 10
  ),
  ncol = 3,
  byrow = TRUE
)
pmat = cmat / n

# Creating the n x n adjacency matrix
adj &lt;- matrix(0, n, n)
for (i in 2:n) {
  for (j in 1:(i - 1)) {
    p = pmat[class[i], class[j]] # We find the probability of connection with the weights
    adj[i, j] = rbinom(1, 1, p) # We include the edge with probability p
  }
}

adjsymm = adj + t(adj)

# graph from the adjacency matrix
G = igraph::graph_from_adjacency_matrix(adjsymm, mode = "undirected", weighted = NULL)

# sampling a Markov move for the ERSBM
G_sample = sample_a_move_ERSBM(class, G)

# plotting the sampled graph
plot(G_sample, main = "The sampled graph after one Markov move for ERSBM")

</code></pre>

<hr>
<h2 id='zachary'>Zachary Karate Club Data</h2><span id='topic+zachary'></span>

<h3>Description</h3>

<p>Zachary’s Karate club data is a classic, well-studied social network of friendships between 34 members of a Karate club at a US university, collected by Wayne Zachary in 1977. Each node represents a member of the club, and each edge represents a tie between two members of the club. The network is undirected. An often discussed problem using this dataset is to find the two groups of people into which the karate club split after an argument between two teachers. Refer to the example in README.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zachary
</code></pre>


<h3>Format</h3>

<p>Two 34 by 34 matrices:
</p>

<dl>
<dt>ZACHE</dt><dd><p>symmetric, binary 34 by 34 adjacency matrix.</p>
</dd>
<dt>ZACHC</dt><dd><p>symmetric, valued 34 by 34 matrix, indicating the relative strength of the associations</p>
</dd>
</dl>



<h3>Source</h3>

<p>(Zachary, 1977),
<a href="http://vlado.fmf.uni-lj.si/pub/networks/data/Ucinet/UciData.htm#zachary">http://vlado.fmf.uni-lj.si/pub/networks/data/Ucinet/UciData.htm#zachary</a>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
