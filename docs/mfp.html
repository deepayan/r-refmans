<!DOCTYPE html><html><head><title>Help for package mfp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mfp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bodyfat'><p> percentage of body fat determined by underwater weighing</p></a></li>
<li><a href='#cox'><p>Family Objects for Cox Proportional Regression Models</p></a></li>
<li><a href='#fp'><p>Fractional Polynomial Transformation</p></a></li>
<li><a href='#GBSG'><p> German Breast Cancer Study Group</p></a></li>
<li><a href='#mfp'><p>Fit a Multiple Fractional Polynomial Model</p></a></li>
<li><a href='#mfp.object'><p>Multiple Fractional Polynomial Model Object</p></a></li>
<li><a href='#predict.mfp'>
<p>Predict method for mfp fits</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.5.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-07-18</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariable Fractional Polynomials</td>
</tr>
<tr>
<td>Depends:</td>
<td>survival</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv</td>
</tr>
<tr>
<td>Description:</td>
<td>Fractional polynomials are used to represent curvature in regression models. A key reference is Royston and Altman, 1994.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/georgheinze/mfp/issues/">https://github.com/georgheinze/mfp/issues/</a></td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-07-19 07:27:33 UTC; Gregor</td>
</tr>
<tr>
<td>Author:</td>
<td>Georg Heinze [cre],
  Gareth Ambler [aut],
  Axel Benner [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Georg Heinze &lt;georg.heinze@meduniwien.ac.at&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-07-19 14:30:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='bodyfat'> percentage of body fat determined by underwater weighing </h2><span id='topic+bodyfat'></span>

<h3>Description</h3>

<p>A data frame containing the estimates of the percentage of body fat 
determined by underwater weighing and various body circumference 
measurements for 252 men.
</p>
<p>Source: Roger W. Johnson (1996), &rdquo;Fitting Percentage of Body Fat to 
Simple Body Measurements&rdquo;, Journal of Statistics Education. 
Original data are from K. Penrose, A. Nelson, and A. Fisher (1985), 
&rdquo;Generalized Body Composition Prediction Equation for Men Using 
Simple Measurement Techniques&rdquo; (abstract), Medicine and Science in 
Sports and Exercise, 17(2), 189. 
</p>
<p>Data were supplied by Dr. A. Garth Fisher, Human Performance Research 
Center, Brigham Young University, who gave permission to freely distribute 
the data and use them for non-commercial purposes. 
Note, however, that there seem to be a few errors.  
For instance, body densities for cases 48, 76, and 96 seem to have one digit 
in error in the two body fat percentage values.  
Also note a man (case 42) over 200 pounds in weight who is less than 3 feet tall 
(the height should presumably be 69.5 inches, not 29.5 inches).  
Percent body fat estimates are truncated to zero when negative (case 182).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bodyfat)</code></pre>


<h3>Format</h3>

<p>This data frame contains the observations of 252 men:
</p>

<dl>
<dt>case</dt><dd><p>Case number.</p>
</dd>
<dt>brozek</dt><dd><p>Percent body fat using Brozek's equation: 457/Density - 414.2</p>
</dd>
<dt>siri</dt><dd><p>Percent body fat using Siri's equation: 495/Density - 450</p>
</dd>
<dt>density</dt><dd><p>Density determined from underwater weighing (gm/cm**3).</p>
</dd>
<dt>age</dt><dd><p>Age (years).</p>
</dd>
<dt>weight</dt><dd><p>Weight (lbs).</p>
</dd>
<dt>height</dt><dd><p>Height (inches).</p>
</dd>
<dt>neck</dt><dd><p>Neck circumference (cm).</p>
</dd>
<dt>chest</dt><dd><p>Chest circumference (cm).</p>
</dd>
<dt>abdomen</dt><dd><p>Abdomen circumference (cm) &rdquo;at the umbilicus and level 
with the iliac crest&rdquo;.</p>
</dd>
<dt>hip</dt><dd><p>Hip circumference (cm).</p>
</dd>
<dt>thigh</dt><dd><p>Thigh circumference (cm).</p>
</dd>
<dt>knee</dt><dd><p>Knee circumference (cm).</p>
</dd>
<dt>ankle</dt><dd><p>Ankle circumference (cm).</p>
</dd>
<dt>biceps</dt><dd><p>Biceps (extended) circumference (cm).</p>
</dd>
<dt>forearm</dt><dd><p>Forearm circumference (cm).</p>
</dd>
<dt>wrist</dt><dd><p>Wrist circumference (cm) &rdquo;distal to the styloid processes&rdquo;.</p>
</dd>
</dl>



<h3>Source</h3>

<p>e.g. <a href="http://lib.stat.cmu.edu/datasets/bodyfat">http://lib.stat.cmu.edu/datasets/bodyfat</a>
</p>


<h3>References</h3>

<p>R.W. Johnson (1996). Fitting percentage of body fat to simple body measurements.
<em>Journal of Statistics Education [Online]</em>, <b>4(1)</b>.
</p>
<p>K.W. Penrose, A.G. Nelson, A.G. Fisher (1985). Generalized body composition prediction
equation for men using simple measurement techniques. <em>Medicine and Science 
in Sports and Exercise</em>, <b>17</b>, 189.
</p>
<p>P. Royston, W. Sauerbrei (2004). Improving the robustness of fractional polynomial models 
by preliminary covariate transformation. Submitted.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(bodyfat)
    bodyfat$height[bodyfat$case==42] &lt;- 69.5   # apparent error
    bodyfat &lt;- bodyfat[-which(bodyfat$case==39),]  # cp. Royston $\amp$ Sauerbrei, 2004
    mfp(siri ~ fp(age, df = 4, select = 0.1) + fp(weight, df = 4, select = 0.1)
                 + fp(height, df = 4, select = 0.1), family = gaussian, data = bodyfat)
</code></pre>

<hr>
<h2 id='cox'>Family Objects for Cox Proportional Regression Models</h2><span id='topic+cox'></span>

<h3>Description</h3>

<p>Family objects provide a convenient way to specify the details of
the models used by functions such as 'glm'. See the documentation
for 'glm' for details. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cox()</code></pre>

<hr>
<h2 id='fp'>Fractional Polynomial Transformation</h2><span id='topic+fp'></span>

<h3>Description</h3>

<p>This function defines a fractional polynomial object for a quantitative input variable x. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fp(x, df = 4, select = NA, alpha = NA, scale=TRUE)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fp_+3A_x">x</code></td>
<td>

<p>quantitative input variable.</p>
</td></tr>
<tr><td><code id="fp_+3A_df">df</code></td>
<td>

<p>degrees of freedom of the FP model. 
df=4: FP model with maximum permitted degree m=2 (default),
df=2: FP model with maximum permitted degree m=1,
df=1: Linear FP model.</p>
</td></tr>
<tr><td><code id="fp_+3A_select">select</code></td>
<td>

<p>sets the variable selection level for the input variable.</p>
</td></tr>
<tr><td><code id="fp_+3A_alpha">alpha</code></td>
<td>

<p>sets the FP selection level for the input variable.</p>
</td></tr>
<tr><td><code id="fp_+3A_scale">scale</code></td>
<td>

<p>use pre-transformation scaling to avoid numerical problems (default=TRUE).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
	fp(x, df = 4, select = 0.05, scale = FALSE)

## End(Not run)
</code></pre>

<hr>
<h2 id='GBSG'> German Breast Cancer Study Group </h2><span id='topic+GBSG'></span>

<h3>Description</h3>

<p>A data frame containing the observations from the GBSG study.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(GBSG)</code></pre>


<h3>Format</h3>

<p>This data frame contains the observations of 686 women:
</p>

<dl>
<dt>id</dt><dd><p>patient id 1...686.</p>
</dd>
<dt>htreat</dt><dd><p>hormonal therapy, a factor at two levels <code>0</code> (no) and <code>1</code> (yes).</p>
</dd>
<dt>age</dt><dd><p>of the patients in years.</p>
</dd>
<dt>menostat</dt><dd><p>menopausal status, a factor at two levels <code>1</code> 
(premenopausal) and <code>2</code> (postmenopausal).</p>
</dd>
<dt>tumsize</dt><dd><p>tumor size (in mm).</p>
</dd>
<dt>tumgrad</dt><dd><p>tumor grade, a ordered factor at levels <code>1 &lt; 2 &lt; 3</code>.</p>
</dd>
<dt>posnodal</dt><dd><p>number of positive nodes.</p>
</dd>
<dt>prm</dt><dd><p>progesterone receptor (in fmol).</p>
</dd>
<dt>esm</dt><dd><p>estrogen receptor (in fmol).</p>
</dd>
<dt>rfst</dt><dd><p>recurrence free survival time (in days).</p>
</dd>
<dt>cens</dt><dd><p>censoring indicator (<code>0</code> censored, <code>1</code> event).</p>
</dd>
</dl>



<h3>References</h3>

<p>M. Schumacher, G. Basert, H. Bojar,  K. Huebner, M. Olschewski, 
W. Sauerbrei, C. Schmoor, C. Beyerle, R.L.A. Neumann and H.F. Rauschecker
for the German Breast Cancer Study Group (1994).
Randomized <code class="reqn">2 \times 2</code> trial evaluating hormonal treatment
and the duration of chemotherapy in node-positive breast cancer patients.
<em>Journal of Clinical Oncology</em>, <b>12</b>, 2086&ndash;2093.
</p>
<p>W. Sauerbrei and P. Royston (1999). Building multivariable prognostic
and diagnostic models: transformation of the predictors by using 
fractional polynomials. <em>Journal of the Royal Statistics Society
Series A</em>, Volume <b>162</b>(1), 71&ndash;94.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    data(GBSG)
    mfp(Surv(rfst, cens) ~ fp(age, df = 2, select = 0.05)
                 + fp(prm, df = 4, select = 0.05), family = cox, data = GBSG)

</code></pre>

<hr>
<h2 id='mfp'>Fit a Multiple Fractional Polynomial Model</h2><span id='topic+mfp'></span>

<h3>Description</h3>

<p>Selects the multiple fractional polynomial (MFP) model which best predicts 
the outcome. The model may be a generalized linear model or a proportional
hazards (Cox) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>	mfp(formula, data, family = gaussian, method = c("efron", "breslow"),
	    subset = NULL, na.action = na.omit, init = NULL, alpha=0.05, 
	    select = 1, maxits = 20, keep = NULL, rescale = FALSE, 
	    verbose = FALSE, x = TRUE, y = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mfp_+3A_formula">formula</code></td>
<td>

<p>a formula object, with the response of the left of a ~ operator, and
the terms, separated by + operators, on the right. Fractional
polynomial terms are indicated by fp.  If a Cox PH model is required
then the outcome should be specified using the Surv() notation used
by coxph.</p>
</td></tr>
<tr><td><code id="mfp_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables occurring in the formula. If this
is missing, the variables should be on the search list.</p>
</td></tr>
<tr><td><code id="mfp_+3A_family">family</code></td>
<td>

<p>a family object - a list of functions and expressions for defining the
link and variance functions, initialization and iterative weights.
Families supported are gaussian, binomial, poisson, Gamma,
inverse.gaussian and quasi.  Additionally Cox models are specified
using &quot;cox&quot;.</p>
</td></tr>
<tr><td><code id="mfp_+3A_method">method</code></td>
<td>

<p>a character string specifying the method for tie handling. This argument is 
used for Cox models only and has no effect for other model families.
See 'coxph' for details.</p>
</td></tr>
<tr><td><code id="mfp_+3A_subset">subset</code></td>
<td>

<p>expression saying which subset of the rows of the data should be used
in the fit.  All observations are included by default.</p>
</td></tr>
<tr><td><code id="mfp_+3A_na.action">na.action</code></td>
<td>

<p>function to filter missing data. This is applied to the model.frame
after any subset argument has been used. The default (with na.fail) is
to create an error if any missing values are found.</p>
</td></tr>
<tr><td><code id="mfp_+3A_init">init</code></td>
<td>

<p>vector of initial values of the iteration (in Cox models only).</p>
</td></tr>
<tr><td><code id="mfp_+3A_alpha">alpha</code></td>
<td>

<p>sets the FP selection level for all predictors.  Values for individual
predictors may be changed via the fp function in the formula.</p>
</td></tr>
<tr><td><code id="mfp_+3A_select">select</code></td>
<td>

<p>sets the variable selection level for all predictors.  Values for
individual predictors may be changed via the fp function in the formula.</p>
</td></tr>
<tr><td><code id="mfp_+3A_maxits">maxits</code></td>
<td>

<p>maximum number of iterations for the backfitting stage.</p>
</td></tr>
<tr><td><code id="mfp_+3A_keep">keep</code></td>
<td>

<p>keep one or more variables in the model. The selection level for these variables will be set to 1.</p>
</td></tr>
<tr><td><code id="mfp_+3A_rescale">rescale</code></td>
<td>

<p>logical; uses re-scaling to show the parameters for covariates on their original scale (default TRUE). Should only be used if no non-linear terms are selected.</p>
</td></tr>
<tr><td><code id="mfp_+3A_verbose">verbose</code></td>
<td>

<p>logical; run in verbose mode (default FALSE).</p>
</td></tr>
<tr><td><code id="mfp_+3A_x">x</code></td>
<td>

<p>logical; return the design matrix in the model object?</p>
</td></tr>
<tr><td><code id="mfp_+3A_y">y</code></td>
<td>

<p>logical; return the response in the model object?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The estimation algorithm processes the predictors in turn. Initially, 
mfp silently arranges the predictors in order of increasing P-value
(i.e. of decreasing statistical significance) for omitting each predictor
from the model comprising all the predictors with each term linear. The
aim is to model relatively important variables before unimportant ones.
</p>
<p>At the initial cycle, the best-fitting FP function for the first predictor
is determined, with all the other variables assumed linear. The FP
selection  procedure is described below. The functional form (but NOT the
estimated regression coefficients) for this predictor is kept, and the 
process is repeated for the other predictors in turn. The first iteration
concludes when all the variables have been processed in this way. The next
cycle is similar, except that the functional forms from the initial cycle
are retained for all variables excepting the one currently being processed.
</p>
<p>A variable whose functional form is prespecified to be linear (i.e. to 
have 1 df) is tested only for exclusion within the above procedure when 
its nominal P-value (selection level) according to select() is less than 1.
</p>
<p>Updating of FP functions and candidate variables continues until the functions
and variables included in the overall model do not change (convergence).
Convergence is usually achieved within 1-4 cycles.
</p>
<p><em>Model Selection</em>
</p>
<p>mfp uses a form of backward elimination. It start from a most complex 
permitted FP model and attempt to simplify it by reducing the df. The 
selection algorithm is inspired by the so-called &quot;closed test procedure&quot;,
a sequence of tests in each of which the &quot;familywise error rate&quot; or
P-value is maintained at a prespecified nominal value such as 0.05. 
</p>
<p>The &quot;closed test&quot; algorithm for choosing an FP model with maximum 
permitted degree m=2 (4 df) for a single continuous predictor, x, is as
follows:
</p>
<p>1. Inclusion: test the FP in x for possible omission of x (4 df test,
significance level determined by select). If x is significant,
continue, otherwise drop x from the model.
</p>
<p>2. Non-linearity: test the FP in x against a straight line in x (3 df
test, significance level determined by alpha). If significant,
continue, otherwise the chosen model is a straight line.
</p>
<p>3. Simplification: test the FP with m=2 (4 df) against the best FP with
m=1 (2 df) (2 df test at alpha level). If significant, choose m=2,
otherwise choose m=1.
</p>
<p>All significance tests are carried out using an approximate P-value
calculation based on a difference in deviances (-2 x log likelihood) 
having a chi-squared or F distribution, depending on the regression in 
use. Therefore, each of the tests in the procedure maintains a 
significance level only approximately equal to select. The algorithm is 
thus not truly a closed procedure. However, for a given significance level
it does provide some protection against over-fitting, that is against
choosing over-complex MFP models.</p>


<h3>Value</h3>

<p>an object of class <code>mfp</code> is returned which either inherits from both glm
and lm or coxph.</p>


<h3>Side Effects</h3>

<p>details are produced on the screen regarding the progress of the 
backfitting routine. At completion of the algorithm a table is displayed
showing the final powers selected for each variable along with other
details.</p>


<h3>Known Bugs</h3>

   
<p>glm models should not be specified without an intercept term as the
software does not yet allow for that possibility.</p>


<h3>Author(s)</h3>

<p> Gareth Ambler and Axel Benner  </p>


<h3>References</h3>

<p>Ambler G, Royston P (2001) Fractional polynomial model selection procedures: 
investigation of Type I error rate. <em>Journal of Statistical Simulation 
and Computation</em> 69: 89&ndash;108.
</p>
<p>Benner A (2005) mfp: Multivariable fractional polynomials. <em>R News</em> 5(2): 20&ndash;23.
</p>
<p>Royston P, Altman D (1994) Regression using fractional polynomials
of continuous covariates. <em>Appl Stat.</em> 3: 429&ndash;467.
</p>
<p>Sauerbrei W, Royston P (1999) Building multivariable prognostic and diagnostic models: 
transformation of the predictors by using fractional polynomials. <em>Journal 
of the Royal Statistical Society (Series A)</em> 162: 71&ndash;94.
</p>


<h3>See Also</h3>

<p>mfp.object, fp, glm</p>


<h3>Examples</h3>

<pre><code class='language-R'>	data(GBSG)
	f &lt;- mfp(Surv(rfst, cens) ~ fp(age, df = 4, select = 0.05)
                 + fp(prm, df = 4, select = 0.05), family = cox, data = GBSG)
	print(f)
	survfit(f$fit)  # use proposed coxph model fit for survival curve estimation
</code></pre>

<hr>
<h2 id='mfp.object'>Multiple Fractional Polynomial Model Object</h2><span id='topic+mfp.object'></span>

<h3>Description</h3>

<p>Objects returned by fitting fractional polynomial model objects.
</p>
<p>These are objects representing fitted <code>mfp</code> models. 
Class <code>mfp</code> inherits from either glm or coxph depending on the type of model fitted.
</p>


<h3>Value</h3>

<p>In addition to the standard glm/coxph components the following components are 
included in a <code>mfp</code> object.
</p>
<table>
<tr><td><code>x</code></td>
<td>

<p>the final FP transformations that are contained in the design matrix x. 
The predictor &quot;z&quot; with 4 df would have corresponding columns &quot;z.1&quot; and 
&quot;z.2&quot; in x.</p>
</td></tr>
<tr><td><code>powers</code></td>
<td>

<p>a matrix containing the best FP powers for each predictor. If a predictor
has less than two powers a NA will fill the appropriate cell of the
matrix.</p>
</td></tr>
<tr><td><code>pvalues</code></td>
<td>

<p>a matrix containing the P-values from the closed tests. Briefly p.null is
the P-value for the test of inclusion (see mfp), p.lin corresponds to
the test of nonlinearity and p.FP the test of simplification. The best m=1
power (power2) and best m=2 powers (power4.1 and power4.2) are also given.</p>
</td></tr>
<tr><td><code>scale</code></td>
<td>

<p>all predictors are shifted and rescaled before being power transformed if
nonpositive values are encountered or the range of the predictor is 
reasonably large. If x' would be used instead of x where
x' = (x+a)/b
the parameters a (shift) and b (scale) are contained in the matrix scale.</p>
</td></tr>
<tr><td><code>df.initial</code></td>
<td>

<p>a vector containing the degrees of freedom allocated to each predictor.</p>
</td></tr>
<tr><td><code>df.final</code></td>
<td>

<p>a vector containing the degrees of freedom of each predictor at
convergence of the backfitting algorithm.</p>
</td></tr>
<tr><td><code>dev</code></td>
<td>

<p>the deviance of the final model.</p>
</td></tr>
<tr><td><code>dev.lin</code></td>
<td>

<p>the deviance of the model that has every predictor included with 1 df
(i.e. linear).</p>
</td></tr>
<tr><td><code>dev.null</code></td>
<td>

<p>the deviance of the null model.</p>
</td></tr>
<tr><td><code>fptable</code></td>
<td>

<p>the table of the final fp transformations.</p>
</td></tr>
<tr><td><code>formula</code></td>
<td>

<p>the proposed formula for a call of glm/coxph.</p>
</td></tr>
<tr><td><code>fit</code></td>
<td>

<p>the fitted glm/coxph model using the proposed formula. This component can be used for prediction, etc.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p>mfp, glm.object</p>

<hr>
<h2 id='predict.mfp'>
Predict method for mfp fits
</h2><span id='topic+predict.mfp'></span>

<h3>Description</h3>

<p>Obtains predictions from an &quot;mfp&quot; object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ## S3 method for class 'mfp'
predict(object, newdata,
  type = c("link", "response", "lp", "risk", "expected", "terms"), terms,
  ref = NULL, seq = NULL, se.fit = FALSE, dispersion = NULL,
  na.action = na.pass, collapse, safe = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.mfp_+3A_object">object</code></td>
<td>

<p>an &quot;mfp&quot; object.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_newdata">newdata</code></td>
<td>

<p>optionally, a data frame in which to look for variables with which to predict. If omitted, the fitted linear predictors are used.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_type">type</code></td>
<td>

<p>the type of prediction required. The default is on the scale of the linear predictors; the alternative &quot;response&quot; is on the scale of the response variable. The &quot;terms&quot; option returns fitted values of each term on the linear predictor scale. This is useful for visualizing the effects for fractional polynomials.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_terms">terms</code></td>
<td>

<p>A character vector specifiying the variables for which to return fitted values. The default is all non-factor selected terms. Only relevant if <code>type = "terms"</code>.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_ref">ref</code></td>
<td>

<p>a list of reference values for each term. This is the value relative to which contrasts are computed. Defaults to the mean value of the variable.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_seq">seq</code></td>
<td>

<p>a list of numeric vectors for each term specifiying the input values for which contrasts should be computed.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_se.fit">se.fit</code></td>
<td>

<p>logical switch indicating if standard errors are required.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_dispersion">dispersion</code></td>
<td>

<p>the dispersion of the GLM fit to be assumed in computing the standard errors. If omitted, that returned by summary applied to the object is used.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_na.action">na.action</code></td>
<td>

<p>function determining what should be done with missing values in newdata. The default is to predict NA.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_collapse">collapse</code></td>
<td>

<p>optional vector of subject identifiers. If specified, the output will contain one entry per subject rather than one entry per observation.
</p>
</td></tr>
<tr><td><code id="predict.mfp_+3A_safe">safe</code></td>
<td>

</td></tr>
<tr><td><code id="predict.mfp_+3A_...">...</code></td>
<td>

<p>further arguments used by <code>predict.glm</code> or <code>predict.coxph</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>type = "terms"</code>, a list with term predictions for each variable including the contrast to the reference value, standard errors, and contrasts of the first and second derivative.
</p>
<p>Otherwise, a prediction object based on <code>predict.glm</code> or <code>predict.coxph</code>.
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+predict.glm">predict.glm</a></code>, <code><a href="survival.html#topic+predict.coxph">predict.coxph</a></code>
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
