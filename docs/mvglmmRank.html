<!DOCTYPE html><html><head><title>Help for package mvglmmRank</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mvglmmRank}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#binary_cre'>
<p>Internal function for binary model.</p></a></li>
<li><a href='#f2008'>
<p>2008 FBS College Football Regular Season Data</p></a></li>
<li><a href='#f2009'>
<p>2009 FBS College Football Regular Season Data</p></a></li>
<li><a href='#f2010'>
<p>2010 FBS College Football Regular Season Data</p></a></li>
<li><a href='#f2011'>
<p>2011 FBS College Football Regular Season Data</p></a></li>
<li><a href='#f2012'>
<p>2012 FBS College Football Regular Season Data</p></a></li>
<li><a href='#game.pred'>
<p>Predict outcomes of games.</p></a></li>
<li><a href='#mvglmmRank'>
<p>mvglmmRank</p></a></li>
<li><a href='#mvglmmRank-package'>
<p>Multivariate Generalized Linear Mixed Models for Ranking Sports Teams</p></a></li>
<li><a href='#N_mov'>
<p>Internal Function for Normal MOV model</p></a></li>
<li><a href='#NB_cre'>
<p>Internal Function for Normal-Binary Model</p></a></li>
<li><a href='#NB_mov'>
<p>Internal Function for Normal-Binary Model</p></a></li>
<li><a href='#nba2013'>
<p>2013 NBA Data</p></a></li>
<li><a href='#ncaab2012'>
<p>2012 NCAA Division I Basketball Results</p></a></li>
<li><a href='#nfl2012'>
<p>2012 NFL Regular Season Data</p></a></li>
<li><a href='#normal_cre'>
<p>Internal Function for Normal Model</p></a></li>
<li><a href='#PB_cre'>
<p>Internal Function for Poisson-binary Model</p></a></li>
<li><a href='#poisson_cre'>
<p>Internal Function for Poisson Model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multivariate Generalized Linear Mixed Models for Ranking Sports
Teams</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2-4</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), Matrix</td>
</tr>
<tr>
<td>Imports:</td>
<td>numDeriv, methods, stats, utils, MASS</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-01-06</td>
</tr>
<tr>
<td>Description:</td>
<td>Maximum likelihood estimates are obtained via an EM algorithm with either a first-order or a fully exponential Laplace approximation as documented by Broatch and Karl (2018) &lt;<a href="https://doi.org/10.48550%2FarXiv.1710.05284">doi:10.48550/arXiv.1710.05284</a>&gt;,
    Karl, Yang, and Lohr (2014) &lt;<a href="https://doi.org/10.1016%2Fj.csda.2013.11.019">doi:10.1016/j.csda.2013.11.019</a>&gt;, and by 
	Karl (2012) &lt;<a href="https://doi.org/10.1515%2F1559-0410.1471">doi:10.1515/1559-0410.1471</a>&gt;. Karl and Zimmerman &lt;<a href="https://doi.org/10.1016%2Fj.jspi.2020.06.004">doi:10.1016/j.jspi.2020.06.004</a>&gt; use this package to illustrate how the home field effect estimator from a mixed model can be biased under nonrandom scheduling. </td>
</tr>
<tr>
<td>ByteCompile:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>LazyData:</td>
<td>yes</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-07 02:53:54 UTC; andre</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew T. Karl <a href="https://orcid.org/0000-0002-5933-8706"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [cre, aut],
  Jennifer Broatch [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew T. Karl &lt;akarl@asu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-08 00:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='binary_cre'>
Internal function for binary model.
</h2><span id='topic+binary_cre'></span>

<h3>Description</h3>

<p>An internal function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>binary_cre(Z_mat = Z_mat, first.order = first.order, 
          home.field, control = control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="binary_cre_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame.
</p>
</td></tr>
<tr><td><code id="binary_cre_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="binary_cre_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="binary_cre_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
</table>

<hr>
<h2 id='f2008'>
2008 FBS College Football Regular Season Data
</h2><span id='topic+f2008'></span>

<h3>Description</h3>

<p>2008 FBS College Football Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(f2008)</code></pre>


<h3>Format</h3>

<p>A data frame with 772 observations on the following 9 variables.
</p>

<dl>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>Game.Date</code></dt><dd><p>a POSIXlt date variable</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.ncaa.org/mfb/download.jsp?year=2008&amp;div=IA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(f2008)
## maybe str(f2008) ; plot(f2008) ...
</code></pre>

<hr>
<h2 id='f2009'>
2009 FBS College Football Regular Season Data
</h2><span id='topic+f2009'></span>

<h3>Description</h3>

<p>2009 FBS College Football Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(f2009)</code></pre>


<h3>Format</h3>

<p>A data frame with 772 observations on the following 7 variables.
</p>

<dl>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>Game.Date</code></dt><dd><p>a POSIXlt date variable</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.ncaa.org/mfb/download.jsp?year=2009&amp;div=IA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(f2009)
## maybe str(f2009) ; plot(f2009) ...
</code></pre>

<hr>
<h2 id='f2010'>
2010 FBS College Football Regular Season Data
</h2><span id='topic+f2010'></span>

<h3>Description</h3>

<p>2010 FBS College Football Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(f2010)</code></pre>


<h3>Format</h3>

<p>A data frame with 770 observations on the following 9 variables.
</p>

<dl>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>Game.Date</code></dt><dd><p>a POSIXlt</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.ncaa.org/mfb/download.jsp?year=2010&amp;div=IA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(f2010)
## maybe str(f2010) ; plot(f2010) ...
</code></pre>

<hr>
<h2 id='f2011'>
2011 FBS College Football Regular Season Data
</h2><span id='topic+f2011'></span>

<h3>Description</h3>

<p>2011 FBS College Football Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(f2011)</code></pre>


<h3>Format</h3>

<p>A data frame with 781 observations on the following 9 variables.
</p>

<dl>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>Game.Date</code></dt><dd><p>a POSIXlt</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.ncaa.org/mfb/download.jsp?year=2011&amp;div=IA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(f2011)
## maybe str(f2011) ; plot(f2011) ...
</code></pre>

<hr>
<h2 id='f2012'>
2012 FBS College Football Regular Season Data
</h2><span id='topic+f2012'></span>

<h3>Description</h3>

<p>2012 FBS College Football Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(f2012)</code></pre>


<h3>Format</h3>

<p>A data frame with 809 observations on the following 9 variables.
</p>

<dl>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>Game.Date</code></dt><dd><p>a POSIXlt</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://web1.ncaa.org/mfb/download.jsp?year=2012&amp;div=IA
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(f2012)
## maybe str(f2012) ; plot(f2012) ...
</code></pre>

<hr>
<h2 id='game.pred'>
Predict outcomes of games.
</h2><span id='topic+game.pred'></span>

<h3>Description</h3>

<p>After fitting a model with <code><a href="#topic+mvglmmRank">mvglmmRank</a></code>, <code>game.pred</code> uses that model to predict outcomes of future matchups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>game.pred(res, home, away, neutral.site = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="game.pred_+3A_res">res</code></td>
<td>

<p>an object of class mvglmmRank
</p>
</td></tr>
<tr><td><code id="game.pred_+3A_home">home</code></td>
<td>

<p>a character string for the home team (use quotation marks!)
</p>
</td></tr>
<tr><td><code id="game.pred_+3A_away">away</code></td>
<td>

<p>a character string for the away team (use quotation marks!)
</p>
</td></tr>
<tr><td><code id="game.pred_+3A_neutral.site">neutral.site</code></td>
<td>

<p>logical. If TRUE, uses the neutral site mean score, assuming some of the games in the training data occured at neutral sites.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints predicted scores and/or predicted probability of a home team win, depending on the type of model specified by <code>res</code>.
</p>


<h3>Author(s)</h3>

<p>Andrew T. Karl and Jennifer Broatch
</p>


<h3>References</h3>

<p>Karl, A.T., Broatch, J. (2014). mvglmmRank: An R Package Providing Multivariate Generalized Linear Mixed Models for Evaluating Sporting Teams. <em>Submitted.</em> 
</p>
<p>Karl, A.T., Yang, Y. and Lohr, S. (2013). Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to 
Educational Value-Added Assessments. <em>Computational Statistics and Data Analysis</em>,  59, 13-27.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A.T. (2012). The Sensitivity of College Football Rankings to Several Modeling Choices, <em>Journal of Quantitative Analysis in Sports</em>, 
Volume 8, Issue 3, DOI 10.1515/1559-0410.1471
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nfl2012)
mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE,max.iter.EM=1)

result &lt;- mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE)
print(result)
game.pred(result,home="Denver Broncos",away="Green Bay Packers")

</code></pre>

<hr>
<h2 id='mvglmmRank'>
mvglmmRank
</h2><span id='topic+mvglmmRank'></span>

<h3>Description</h3>

<p>This function fits a (multivariate) generalized linear mixed model to team scores and/or win/loss indicators.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mvglmmRank(game.data, method = "PB0", first.order = FALSE, 
home.field = TRUE, max.iter.EM = 1000, tol1 = 1e-04, 
tol2 = 1e-04, tolFE = 0, tol.n = 1e-07, verbose = TRUE, OT.flag = FALSE, 
Hessian = FALSE, REML.N=TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mvglmmRank_+3A_game.data">game.data</code></td>
<td>

<p>a data frame that contains a column &quot;home&quot; of team names, a column &quot;away&quot; of team names,
a column &quot;home.response&quot; containing the scores (or other response) of the &quot;home&quot; teams, a column &quot;away.response&quot;
containing the scores (or other response) of the &quot;away&quot; teams, (optionally) a column &quot;binary.response&quot; that contains a column of binary responses (0's and 1's), and (optionally) a column &quot;neutral.site&quot; which 
takes the value 1 for neutral site games and 0 otherwise. 
NOTE: If game.data does not contain a &quot;binary.response&quot; column, then an indicator will be created
for whether the home team won.
NOTE: For neutral site games, randomly assign the teams as &quot;home&quot; or &quot;away&quot;. As noted below, the data frame may optionally contain a column,
OT, which indicates how many overtime periods were played. 
NOTE: the game.data$OT column should not contain missing data. If there was no overtime, specify &quot;none&quot; or 0.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_method">method</code></td>
<td>

<p>a character (remember to use quotation marks!). Choices are &quot;N&quot;, &quot;P0&quot;, &quot;P1&quot;, &quot;B&quot;,
&quot;NB&quot;, &quot;PB0&quot;, &quot;PB1&quot;, &quot;NB.mov&quot;, or &quot;N.mov&quot;. &quot;N&quot; indicates the scores are fit with a normal distribution with intra-game
correlation between the home and away teams accounted for in an unstructured 2x2 error covariance matrix.
&quot;P&quot; indicates the scores are fit with a Poisson distribution. &quot;B&quot; indicates the home win/loss indicators are
fit using a binary distribution with a probit link. The presence of a &quot;1&quot; with a &quot;P&quot; indicates
potential intra-game correlation is modeled with an additional game-level random effect. A &quot;0&quot;
indicates no such random effects are included. &quot;NB.mov&quot; fits the margin of victory of the &quot;home&quot; team (under an assumed normal distribution) 
jointly with the binary win/loss indicators.  &quot;N.mov&quot; fits only the margin of victory of the &quot;home&quot; team (under an assumed normal distribution). See the NOTES section below 
for further details.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_first.order">first.order</code></td>
<td>

<p>logical. TRUE requests that only a first order Laplace approximation be used, FALSE
requests a fully exponential Laplace approximation. See the references.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_home.field">home.field</code></td>
<td>

<p>logical. TRUE requests that seperate home and away mean scores be modeled (along with a mean 
neutral site score, if applicable) along with a single home field effect in the binary model. 
FALSE requests only a single mean be calculated for the scores, and no fixed effects are fit for the
binary win/loss indicators. Note that the estimator for the home field effect may be biased, depending on the scheduling structure; see the Karl and Zimmerman (2021) reference.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_max.iter.em">max.iter.EM</code></td>
<td>

<p>a number giving the maximum number of EM iterations.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_tol1">tol1</code></td>
<td>

<p>refers to the maximum relative change in parameters between iterations. This is the convergence criterion for the 
first order Laplace approximation. The first order Laplace approximation runs 
until tol1 signals, at which point the fully exponential corrections for the random effects vector begin
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_tol2">tol2</code></td>
<td>

<p>The fully exponential iterations run until the maximum relative change in model paramters is less than tol2. N/A when first.order==TRUE. 
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_tolfe">tolFE</code></td>
<td>

<p>intermediate convergence criterion for fully exponential approximations. The algorithm runs with the fully exponential corrections only to the random
effects vector until tolFE signals (maximum relative change in parameters). 
After this, the fully exponential corrections for both the random efffects vector and the random effects covariance matrix are calculated 
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_tol.n">tol.n</code></td>
<td>

<p>convergence tolerance for EM algorithm with method=&quot;N&quot;. Convergence is declared when <code class="reqn">(l_k-l_{k-1})/l_k &lt; tol.n</code>, where <code class="reqn">l_k</code> is the log-likelihood 
at iteration <code class="reqn">k</code>.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_verbose">verbose</code></td>
<td>

<p>logical. If TRUE, model information will be printed after each iteration.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_ot.flag">OT.flag</code></td>
<td>

<p>logical. If TRUE, then there should be a continuous column OT in game.data that indicates how many overtime periods there were for each game. The information will not be used for the binary models. NOTE: the game.data$OT column should not contain  missing data. If there was no overtime, specify 0.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_hessian">Hessian</code></td>
<td>

<p>logical. If TRUE, the Hessian of the model parameters is calculated via a central difference approximation.
</p>
</td></tr>
<tr><td><code id="mvglmmRank_+3A_reml.n">REML.N</code></td>
<td>
<p>logical. If TRUE and if method==&quot;N.mov&quot; or method==&quot;N&quot;, then REML estimation is used instead of ML.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Setting first.order=TRUE will yield the first order Laplace approximation. A partial fully exponential Laplace approximation can be obtained by setting tol1 &gt; tol2 and tolFE=0. This
will apply fully exponential corrections to the vector of team ratings (the EBLUPs), but not to the covariance matrix of this vector. Karl, Yang, and Lohr (2014) show that this approach
produces a large portion of the benefit of the fully exponential Laplace approximation in only a fraction of the time. Using the default tolerances of mvglmmRank leads to this behavior.
</p>
<p>To summarize, the models (except for method=&quot;N&quot;) run with the first order Laplace approximation until the relative change between parameteres is &lt;= tol1. If first.order=TRUE, the program stops.
Otherwise, the program continues with the Laplace approximation, applying fully exponential corrections to the random effects vector until the maximum of the relative parameter
changes is &lt;= tolFE. At this point, the program continues using the complete fully exponential Laplace approximation (corrections to both the random effects vector and its covariance matrix) 
until the maximum relative parameter change is &lt;= tol2. If tolFE &lt; tol2, then the program will finish without applying fully exponential corrections to the random effects covariance matrix.
</p>
<p>method=&quot;PB1&quot; is the least scalable, as the memory and computational requirements for this model are at least O((teams+number of games)^2). In the example data included with the package, the
NCAA basketball data is slow with the fully exponential approximation and method=&quot;PB1&quot;.
</p>


<h3>Value</h3>

<p>mvglmmRank returns an object of class <code>mvglmmRank</code>
</p>
<p>An object of class <code>mvglmmRank</code> is a list containing the following components:
</p>
<table>
<tr><td><code>n.ratings.offense</code></td>
<td>
<p>The vector of offensive ratings from the normal model, or <code>NULL</code> if the normal model was not fit.</p>
</td></tr>
<tr><td><code>n.ratings.defense</code></td>
<td>
<p>The vector of defensive ratings from the normal model, or <code>NULL</code> if the normal model was not fit.</p>
</td></tr>
<tr><td><code>p.ratings.offense</code></td>
<td>
<p>The vector of offensive ratings from the Poisson model, or <code>NULL</code> if the Poisson model was not fit.</p>
</td></tr>
<tr><td><code>p.ratings.defense</code></td>
<td>
<p>The vector of defensive ratings from the Poisson model, or <code>NULL</code> if the Poisson model was not fit.</p>
</td></tr>
<tr><td><code>b.offense</code></td>
<td>
<p>The vector of win-propensity ratings from the binary model, or <code>NULL</code> if the binary model was not fit.</p>
</td></tr>
<tr><td><code>n.mean</code></td>
<td>
<p>Mean scores from the normal model.</p>
</td></tr>
<tr><td><code>p.mean</code></td>
<td>
<p>Mean scores from the Poisson model.</p>
</td></tr>
<tr><td><code>b.mean</code></td>
<td>
<p>Home field effect from the binary model.</p>
</td></tr>
<tr><td><code>G</code></td>
<td>
<p>Single block of random effects covariance matrix.</p>
</td></tr>
<tr><td><code>G.cor</code></td>
<td>
<p>Correlation matrix corresponding to covariance matrix <code>G</code>.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>Error covariance matrix for normal model, or NULL if normal model not used.</p>
</td></tr>
<tr><td><code>R.cor</code></td>
<td>
<p>Error correlation matrix for normal model, or NULL if normal model not used.</p>
</td></tr>
<tr><td><code>home.field</code></td>
<td>
<p>Logical indicating whether or not a home field effect was modeled.</p>
</td></tr>
<tr><td><code>Hessian</code></td>
<td>
<p>The Hessian of the model parameters, if requested.</p>
</td></tr>
<tr><td><code>parameters</code></td>
<td>
<p>A vector of fitted model parameters.</p>
</td></tr>
<tr><td><code>N.output</code></td>
<td>
<p><code>NULL</code>, or a list if <code>method="N"</code> or <code>method="N.mov"</code>. In the later cases, the list contains the random effect design matrix <code>Z</code>,
the fixed effects design matrix <code>X</code>, the esitmated random effects covariance matrix <code>G</code>, the estimated error covariance matrix <code>R</code>, the predicted random effects <code>eta</code>, the joint covariance matrix of fixed and random effects <code>ybetas_eblup_asycov</code>, the covariance matrix of the fixed effects only <code>ybetas_asycov</code>, and the standard errrors of the fixed effects <code>ybetas_stderror</code>.</p>
</td></tr>
<tr><td><code>fixed.effect.model.output</code></td>
<td>
<p><code>NULL</code>, or a list if <code>method="N.mov"</code>. In the later case, the list contains information about the results of fitting the margin of victory model with fixed (instead of random) team effects: the fixed effect design matrix <code>X</code>, the fixed effect parameter estimates <code>beta</code>, logical indicating whether or not the home field effect is estimable <code>is.mean.estimable</code> (see Notes), the predicted margins of victory <code>pred</code>, the residuals <code>resid</code>, the fitted model variance <code>sigma.sq</code>, and the covariance matrix of the random effects <code>beta.covariance</code>. This can provide an unbiased estimate when the estimator from the mixed model is biased (Karl and Zimmerman, 2021). </p>
</td></tr>
</table>
<p>The function  <code><a href="#topic+game.pred">game.pred</a></code> may be used to predict the outcome of future games.
</p>


<h3>Author(s)</h3>

<p>Andrew T. Karl <a href="mailto:akarl@asu.edu">akarl@asu.edu</a>, Jennifer Broatch
</p>


<h3>References</h3>

<p>Broatch, J.E. and Karl, A.T. (2018). Multivariate Generalized Linear Mixed Models for Joint Estimation of Sporting Outcomes. <em>Italian Journal of Applied Statistics</em>. Vol.30, No.2, 189-211. Also available from https://arxiv.org/abs/1710.05284.
</p>
<p>Karl, A.T., Zimmerman, D.L. (2021). A Diagnostic for Bias in Linear Mixed Model Estimators Induced by Dependence Between the Random Effects and the Corresponding Model Matrix. <em>Journal of Statistical Planning and Inference</em>,  211, 107-118. https://doi.org/10.1016/j.jspi.2020.06.004. 
</p>
<p>Karl, A.T., Yang, Y. and Lohr, S. (2013). Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to 
Educational Value-Added Assessments. <em>Computational Statistics and Data Analysis</em>,  59, 13-27.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects. <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A.T. (2012). The Sensitivity of College Football Rankings to Several Modeling Choices, <em>Journal of Quantitative Analysis in Sports</em>, 
Volume 8, Issue 3, DOI 10.1515/1559-0410.1471
</p>


<h3>See Also</h3>

<p>See also <code><a href="#topic+game.pred">game.pred</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nfl2012)
mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE,max.iter.EM=1)

result &lt;- mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE)
print(result)
game.pred(result,home="Denver Broncos",away="Green Bay Packers")

</code></pre>

<hr>
<h2 id='mvglmmRank-package'>
Multivariate Generalized Linear Mixed Models for Ranking Sports Teams
</h2><span id='topic+mvglmmRank-package'></span>

<h3>Description</h3>

<p>Maximum likelihood estimates are obtained via an EM algorithm with either a first-order or a fully exponential Laplace approximation as documented by Broatch and Karl (2018), Karl, Yang, and Lohr (2014), and by Karl (2012). Karl and Zimmerman use this package to illustrate how the home field effect estimator from a mixed model can be biased under nonrandom scheduling.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> mvglmmRank</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.2-4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2023-01-06</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>See the help pages for mvglmmRank and game.pred
</p>


<h3>Author(s)</h3>

<p>Andrew T. Karl and Jennifer Broatch
</p>
<p>Maintainer: Andrew T. Karl &lt;akarl@asu.edu&gt;
</p>


<h3>References</h3>

<p>Broatch, J.E. and Karl, A.T. (2018). Multivariate Generalized Linear Mixed Models for Joint Estimation of Sporting Outcomes. <em>Italian Journal of Applied Statistics</em>. Vol.30, No.2, 189-211. Also available from https://arxiv.org/abs/1710.05284.
</p>
<p>Karl, A.T., Zimmerman, D.L. (2021). A Diagnostic for Bias in Linear Mixed Model Estimators Induced by Dependence Between the Random Effects and the Corresponding Model Matrix. <em>Journal of Statistical Planning and Inference</em>,  211, 107-118. https://doi.org/10.1016/j.jspi.2020.06.004. 
</p>
<p>Karl, A.T., Yang, Y. and Lohr, S. (2013). Efficient Maximum Likelihood Estimation of Multiple Membership Linear Mixed Models, with an Application to 
Educational Value-Added Assessments. <em>Computational Statistics and Data Analysis</em>,  59, 13-27.
</p>
<p>Karl, A., Yang, Y. and Lohr, S. (2014) Computation of Maximum Likelihood Estimates for Multiresponse Generalized Linear Mixed Models with Non-nested, Correlated Random Effects <em>Computational Statistics &amp; Data Analysis</em> <b>73</b>, 146&ndash;162.
</p>
<p>Karl, A.T. (2012). The Sensitivity of College Football Rankings to Several Modeling Choices, <em>Journal of Quantitative Analysis in Sports</em>, 
Volume 8, Issue 3, DOI 10.1515/1559-0410.1471
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nfl2012)
mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE,max.iter.EM=1)

result &lt;- mvglmmRank(nfl2012,method="PB0",first.order=TRUE,verbose=TRUE)
print(result)
game.pred(result,home="Denver Broncos",away="Green Bay Packers")

</code></pre>

<hr>
<h2 id='N_mov'>
Internal Function for Normal MOV model
</h2><span id='topic+N_mov'></span>

<h3>Description</h3>

<p>Internal Function for Normal MOV model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>N_mov(Z_mat = Z_mat, first.order = TRUE, 
   home.field = home.field, control = control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="N_mov_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="N_mov_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="N_mov_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="N_mov_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
</table>

<hr>
<h2 id='NB_cre'>
Internal Function for Normal-Binary Model
</h2><span id='topic+NB_cre'></span>

<h3>Description</h3>

<p>Internal Function for Normal-Binary Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NB_cre(Z_mat = Z_mat, first.order = first.order, 
   home.field = home.field, control = control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NB_cre_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="NB_cre_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="NB_cre_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="NB_cre_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
</table>

<hr>
<h2 id='NB_mov'>
Internal Function for Normal-Binary Model
</h2><span id='topic+NB_mov'></span>

<h3>Description</h3>

<p>Internal Function for Normal-Binary Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NB_mov(Z_mat = Z_mat, first.order = first.order, 
   home.field = home.field, control = control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NB_mov_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="NB_mov_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="NB_mov_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="NB_mov_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
</table>

<hr>
<h2 id='nba2013'>
2013 NBA Data
</h2><span id='topic+nba2013'></span>

<h3>Description</h3>

<p>2013 NBA Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nba2013)</code></pre>


<h3>Format</h3>

<p>A data frame with 1229 observations on the following 11 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a factor</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>OT</code></dt><dd><p>a factor</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>ot.count</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://masseyratings.com/data.php
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nba2013)
## maybe str(nba2013) ; plot(nba2013) ...
</code></pre>

<hr>
<h2 id='ncaab2012'>
2012 NCAA Division I Basketball Results
</h2><span id='topic+ncaab2012'></span>

<h3>Description</h3>

<p>2012 NCAA Division I Basketball Results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ncaab2012)</code></pre>


<h3>Format</h3>

<p>A data frame with 5253 observations on the following 10 variables.
</p>

<dl>
<dt><code>date</code></dt><dd><p>a factor</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd>
<dt><code>home</code></dt><dd><p>a factor</p>
</dd>
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home_win</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://masseyratings.com/data.php
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ncaab2012)
## maybe str(ncaab2012) ; plot(ncaab2012) ...
</code></pre>

<hr>
<h2 id='nfl2012'>
2012 NFL Regular Season Data
</h2><span id='topic+nfl2012'></span>

<h3>Description</h3>

<p>2012 NFL Regular Season Data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(nfl2012)</code></pre>


<h3>Format</h3>

<p>A data frame with 256 observations on the following 9 variables.
</p>

<dl>
<dt><code>Date</code></dt><dd><p>a factor</p>
</dd>
<dt><code>away</code></dt><dd><p>a factor</p>
</dd> 
<dt><code>home</code></dt><dd><p>a factor</p>
</dd> 
<dt><code>neutral.site</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>home.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.response</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>away.score</code></dt><dd><p>a numeric vector</p>
</dd>
<dt><code>partition</code></dt><dd><p>a numeric vector</p>
</dd>
</dl>



<h3>Source</h3>

<p>http://masseyratings.com/data.php
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(nfl2012)
## maybe str(nfl2012) ; plot(nfl2012) ...
</code></pre>

<hr>
<h2 id='normal_cre'>
Internal Function for Normal Model
</h2><span id='topic+normal_cre'></span>

<h3>Description</h3>

<p>Internal Function for Normal Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normal_cre(Z_mat = Z_mat, first.order = first.order, 
   home.field = home.field, control = control)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normal_cre_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="normal_cre_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="normal_cre_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="normal_cre_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
</table>

<hr>
<h2 id='PB_cre'>
Internal Function for Poisson-binary Model
</h2><span id='topic+PB_cre'></span>

<h3>Description</h3>

<p>Internal Function for Poisson-binary Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PB_cre(Z_mat = Z_mat, first.order = first.order,
   home.field = home.field, control = control, 
   game.effect = game.effect)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PB_cre_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="PB_cre_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="PB_cre_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="PB_cre_+3A_control">control</code></td>
<td>

<p>list
</p>
</td></tr>
<tr><td><code id="PB_cre_+3A_game.effect">game.effect</code></td>
<td>

<p>logical
</p>
</td></tr>
</table>

<hr>
<h2 id='poisson_cre'>
Internal Function for Poisson Model
</h2><span id='topic+poisson_cre'></span>

<h3>Description</h3>

<p>Internal Function for Poisson Model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>poisson_cre(Z_mat = Z_mat, first.order = first.order, 
   control = control, game.effect = game.effect, 
   home.field = home.field)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="poisson_cre_+3A_z_mat">Z_mat</code></td>
<td>

<p>data frame
</p>
</td></tr>
<tr><td><code id="poisson_cre_+3A_first.order">first.order</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="poisson_cre_+3A_control">control</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="poisson_cre_+3A_game.effect">game.effect</code></td>
<td>

<p>logical
</p>
</td></tr>
<tr><td><code id="poisson_cre_+3A_home.field">home.field</code></td>
<td>

<p>logical
</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
