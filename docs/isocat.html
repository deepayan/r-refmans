<!DOCTYPE html><html lang="en-US"><head><title>Help for package isocat</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {isocat}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#.assignmentMaker'><p>Make probability-of-origin surfaces</p></a></li>
<li><a href='#.compareMyRasters'><p>Compare rasters by checking whether they can stack.</p></a></li>
<li><a href='#.findProductThenNormalize'><p>Find Product Then Normalize Function</p></a></li>
<li><a href='#clusterSimmatrix'><p>Hierarchical clustering analysis of similarity matrix</p></a></li>
<li><a href='#cumsumAtSamplingLocation'><p>Cumulative sum at coordinates</p></a></li>
<li><a href='#cumsumbelow'><p>Cumulative sum below value</p></a></li>
<li><a href='#getPrecisionPar'><p>Calculate model precision at given threshold values (in parallel).</p></a></li>
<li><a href='#isoscape'><p>Example isoscape data</p></a></li>
<li><a href='#isoscape_sd'><p>Example isoscape standard deviation data</p></a></li>
<li><a href='#isotopeAssignmentModel'><p>Isotope assignment model function</p></a></li>
<li><a href='#makecumsumSurface'><p>Create cumulative sum probability surface</p></a></li>
<li><a href='#makeMultiMonthIsoscape'><p>Make mean multi-month isoscape and error surfaces.</p></a></li>
<li><a href='#makeOddsSurfaces'><p>Convert probability surface to odds-ratio surface</p></a></li>
<li><a href='#makeQuantileSimulationSurface'><p>Create quantile-simulation surfaces</p></a></li>
<li><a href='#makeQuantileSurfaces'><p>Convert probability surface to probability-quantile surface</p></a></li>
<li><a href='#meanAggregateClusterProbability'><p>Create mean aggregate probability-of-origin surfaces for each cluster.</p></a></li>
<li><a href='#oddsAtSamplingLocation'><p>Odds ratio at coordinates function</p></a></li>
<li><a href='#projectSummaryMaxSurface'><p>Project probability-of-origin surfaces into one summary surface.</p></a></li>
<li><a href='#quantileAtSamplingLocation'><p>Quantile at coordinates function</p></a></li>
<li><a href='#schoenersD'><p>Calculates Schoener's D-value between two RasterLayers.</p></a></li>
<li><a href='#simmatrixMaker'><p>Generates similarity matrix for RasterStack</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Isotope Origin Clustering and Assignment Tools</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>This resource provides tools to create, compare, and post-process 
    spatial isotope assignment models of animal origin. It generates 
    probability-of-origin maps for individuals based on user-provided tissue and 
    environment isotope values (e.g., as generated by IsoMAP, Bowen et al. [2013] 
    &lt;<a href="https://doi.org/10.1111%2F2041-210X.12147">doi:10.1111/2041-210X.12147</a>&gt;) using the framework established in Bowen et al.
    (2010) &lt;<a href="https://doi.org/10.1146%2Fannurev-earth-040809-152429">doi:10.1146/annurev-earth-040809-152429</a>&gt;). The package 'isocat' can then 
    quantitatively compare and cluster these maps to group individuals by 
    similar origin. It also includes techniques for applying four approaches 
    (cumulative sum, odds ratio, quantile only, and quantile simulation) with 
    which users can summarize geographic origins and probable distance traveled 
    by individuals. Campbell et al. [2020] establishes several of the functions
    included in this package &lt;<a href="https://doi.org/10.1515%2Fami-2020-0004">doi:10.1515/ami-2020-0004</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0), utils, raster</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, plyr, sp, magrittr, methods, foreach,</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dendextend, doParallel, dplyr, ggplot2, gridExtra,
kableExtra, knitr, parallel, pvclust, rmarkdown, rasterVis,
viridisLite</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-15 23:52:01 UTC; cjcampbell</td>
</tr>
<tr>
<td>Author:</td>
<td>Caitlin Campbell <a href="https://orcid.org/0000-0002-8199-7775"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Caitlin Campbell &lt;caitjcampbell@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 00:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='.assignmentMaker'>Make probability-of-origin surfaces</h2><span id='topic+.assignmentMaker'></span>

<h3>Description</h3>

<p>Make probability-of-origin surfaces
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.assignmentMaker(.ID, .isotopeValue, .SD_indv, precip_raster, precip_SD_raster)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id=".assignmentMaker_+3A_.id">.ID</code></td>
<td>
<p>ID value or vector of values (for naming assignment model layers). If missing, will count from 1.</p>
</td></tr>
<tr><td><code id=".assignmentMaker_+3A_.isotopevalue">.isotopeValue</code></td>
<td>
<p>Isotope precipitation value or vector of values.</p>
</td></tr>
<tr><td><code id=".assignmentMaker_+3A_.sd_indv">.SD_indv</code></td>
<td>
<p>error associated with transfer function fit. Value or vector of values. If missing, will assume value of 0.</p>
</td></tr>
<tr><td><code id=".assignmentMaker_+3A_precip_raster">precip_raster</code></td>
<td>
<p>precipitation isoscape raster.</p>
</td></tr>
<tr><td><code id=".assignmentMaker_+3A_precip_sd_raster">precip_SD_raster</code></td>
<td>
<p>precipitation isoscape standard deviation raster.</p>
</td></tr>
</table>

<hr>
<h2 id='.compareMyRasters'>Compare rasters by checking whether they can stack.</h2><span id='topic+.compareMyRasters'></span>

<h3>Description</h3>

<p>Compare rasters by checking whether they can stack.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.compareMyRasters(...)
</code></pre>

<hr>
<h2 id='.findProductThenNormalize'>Find Product Then Normalize Function</h2><span id='topic+.findProductThenNormalize'></span>

<h3>Description</h3>

<p>Find Product Then Normalize Function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>.findProductThenNormalize(...)
</code></pre>

<hr>
<h2 id='clusterSimmatrix'>Hierarchical clustering analysis of similarity matrix</h2><span id='topic+clusterSimmatrix'></span>

<h3>Description</h3>

<p>Function applies hierarchical clustering analysis to similarity matrix, such as one output by 'simmatrixMaker' function. Just a wrapper for pvclust. Output is a pvclust object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clusterSimmatrix(
  simmatrix,
  dist_mthd = "correlation",
  hclust_mthd = "average",
  nBoot = 1000,
  nClusters = FALSE,
  r = seq(0.7, 1.4, by = 0.1)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="clusterSimmatrix_+3A_simmatrix">simmatrix</code></td>
<td>
<p>symmetric similarity matrix object.</p>
</td></tr>
<tr><td><code id="clusterSimmatrix_+3A_dist_mthd">dist_mthd</code></td>
<td>
<p>Distance measure to be used. Defaults to &quot;correlation&quot;. See help(pvclust).</p>
</td></tr>
<tr><td><code id="clusterSimmatrix_+3A_hclust_mthd">hclust_mthd</code></td>
<td>
<p>Method of clustering. Defaults to &quot;average&quot;. See help(pvclust).</p>
</td></tr>
<tr><td><code id="clusterSimmatrix_+3A_nboot">nBoot</code></td>
<td>
<p>number of bootstrap replications. Defaults to 1000. See help(pvclust).</p>
</td></tr>
<tr><td><code id="clusterSimmatrix_+3A_nclusters">nClusters</code></td>
<td>
<p>number of clusters to run in parallel using 'doParallel'. Defaults to FALSE (non-parallel).</p>
</td></tr>
<tr><td><code id="clusterSimmatrix_+3A_r">r</code></td>
<td>
<p>Relative size of bootstrap replications.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create probability-of-origin maps to compare.
myiso &lt;- rasterFromXYZ(isoscape)
raster::plot(myiso)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
n &lt;- 5
set.seed(42)
df &lt;- data.frame(
         ID = LETTERS[1:n],
         isotopeValue = sample(-120:-40, n),
         SD_indv = rep(5, n)
         )
assignmentModels &lt;- isotopeAssignmentModel(
                        ID = df$ID,
                        isotopeValue = df$isotopeValue,
                        SD_indv = df$SD_indv,
                        precip_raster = myiso,
                        precip_SD_raster = myiso_sd,
                        nClusters = FALSE
                        )
raster::plot(assignmentModels)
# Compare maps with simmatrixMaker.
mymatrix &lt;- simmatrixMaker(assignmentModels, nClusters = FALSE, csvSavePath = FALSE)
# Cluster similarity matrix.
clust_results &lt;- clusterSimmatrix(mymatrix, dist_mthd = "correlation",
    hclust_mthd = "average", nBoot = 1000,  nClusters = FALSE,
    r = seq(.7,1.4,by=.1) )
clust_results


</code></pre>

<hr>
<h2 id='cumsumAtSamplingLocation'>Cumulative sum at coordinates</h2><span id='topic+cumsumAtSamplingLocation'></span><span id='topic+cumsum_at_point'></span>

<h3>Description</h3>

<p>Function estimates cumulative sum of all values in a surface below the value at a specified longitude and latitude.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsumAtSamplingLocation(indivraster, Lat, Lon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumsumAtSamplingLocation_+3A_indivraster">indivraster</code></td>
<td>
<p>RasterLayer representing normalized probability of origin surface</p>
</td></tr>
<tr><td><code id="cumsumAtSamplingLocation_+3A_lat">Lat</code></td>
<td>
<p>Integer latitude</p>
</td></tr>
<tr><td><code id="cumsumAtSamplingLocation_+3A_lon">Lon</code></td>
<td>
<p>Integer longitude</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+makecumsumSurface">makecumsumSurface</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surface.
myiso &lt;- raster::rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
exampleSurface &lt;- isotopeAssignmentModel(
         ID = "A",
         isotopeValue = -100,
         SD_indv = 5,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )
# Calculate odds ratio at specific point.
set.seed(1)
x &lt;- sample( which( !is.na(exampleSurface[]) ), size = 1)
pt &lt;- raster::xyFromCell(exampleSurface, x)
cumsumAtSamplingLocation(indivraster = exampleSurface, Lat = pt[2], Lon = pt[1])

</code></pre>

<hr>
<h2 id='cumsumbelow'>Cumulative sum below value</h2><span id='topic+cumsumbelow'></span>

<h3>Description</h3>

<p>Function that calculates the cumulative sum of values less than or equal to a given value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cumsumbelow(vals)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cumsumbelow_+3A_vals">vals</code></td>
<td>
<p>Object of numeric or integer class.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns list of values representing cumulative sum of 'val' values less than or equal to the input.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>vals &lt;- 1:10
cumsumbelow(vals)

</code></pre>

<hr>
<h2 id='getPrecisionPar'>Calculate model precision at given threshold values (in parallel).</h2><span id='topic+getPrecisionPar'></span>

<h3>Description</h3>

<p>Function that counts cells (number and proportion) above given values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPrecisionPar(rasterstack, checkVals, method = FALSE, nCluster = 20)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="getPrecisionPar_+3A_rasterstack">rasterstack</code></td>
<td>
<p>RasterStack of probability surfaces</p>
</td></tr>
<tr><td><code id="getPrecisionPar_+3A_checkvals">checkVals</code></td>
<td>
<p>vector of numeric 'threshold' values against which to calculate precision</p>
</td></tr>
<tr><td><code id="getPrecisionPar_+3A_method">method</code></td>
<td>
<p>is FALSE by default. If character vector, appends a column recording 'method' used.</p>
</td></tr>
<tr><td><code id="getPrecisionPar_+3A_ncluster">nCluster</code></td>
<td>
<p>is a numeric object specifying how many clusters to form and run in parallel.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a dataframe of precision values at given threshold.
</p>

<hr>
<h2 id='isoscape'>Example isoscape data</h2><span id='topic+isoscape'></span>

<h3>Description</h3>

<p>Example isoscape data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isoscape
</code></pre>


<h3>Format</h3>

<p>A dataframe containing 1800 observations, derived from a cropped raster object.
</p>


<h3>References</h3>

<p>Campbell C. J. (2018) IsoMAP job 66100, Isoscapes Modeling, Analysis and Prediction (version 1.0). The IsoMAP Project. http://isomap.org
</p>
<p>Bowen G. J., West J.B., Miller C. C., Zhao L. and Zhang T. (2018) IsoMAP: Isoscapes Modeling, Analysis and Prediction (version 1.0). IsoMAP job 66100, Caitlin J. Campbell. Isoscapes Modeling, Analysis and Prediction (version 1.0). The IsoMAP Project. http://isomap.org
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iso &lt;- rasterFromXYZ(isoscape)
</code></pre>

<hr>
<h2 id='isoscape_sd'>Example isoscape standard deviation data</h2><span id='topic+isoscape_sd'></span>

<h3>Description</h3>

<p>Example isoscape standard deviation data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isoscape_sd
</code></pre>


<h3>Format</h3>

<p>A dataframe containing 1800 observations, derived from a cropped raster object.
</p>


<h3>References</h3>

<p>Campbell C. J. (2018) IsoMAP job 66100, Isoscapes Modeling, Analysis and Prediction (version 1.0). The IsoMAP Project. http://isomap.org
</p>
<p>Bowen G. J., West J.B., Miller C. C., Zhao L. and Zhang T. (2018) IsoMAP: Isoscapes Modeling, Analysis and Prediction (version 1.0). IsoMAP job 66100, Caitlin J. Campbell. Isoscapes Modeling, Analysis and Prediction (version 1.0). The IsoMAP Project. http://isomap.org
</p>


<h3>Examples</h3>

<pre><code class='language-R'>iso_sd &lt;- rasterFromXYZ(isoscape_sd)
</code></pre>

<hr>
<h2 id='isotopeAssignmentModel'>Isotope assignment model function</h2><span id='topic+isotopeAssignmentModel'></span>

<h3>Description</h3>

<p>Creates isotope assignment models projections of probable origin. Results returned as a RasterStack, with layer names corresponding to individual ID.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotopeAssignmentModel(
  ID,
  isotopeValue,
  SD_indv = 0,
  precip_raster,
  precip_SD_raster,
  additionalModels = FALSE,
  additionalModel_name = "CombinedIsotope-OtherModelAssignments",
  savePath = FALSE,
  nClusters = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="isotopeAssignmentModel_+3A_id">ID</code></td>
<td>
<p>ID value or vector of values (for naming assignment model layers). If missing, will count from 1.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_isotopevalue">isotopeValue</code></td>
<td>
<p>Isotope precipitation value or vector of values.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_sd_indv">SD_indv</code></td>
<td>
<p>error associated with transfer function fit. Value or vector of values. If missing, will assume value of 0.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_precip_raster">precip_raster</code></td>
<td>
<p>precipitation isoscape raster.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_precip_sd_raster">precip_SD_raster</code></td>
<td>
<p>precipitation isoscape standard deviation raster.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_additionalmodels">additionalModels</code></td>
<td>
<p>optional additional model raster object (e.g. an SDM, rasterized range map, or stack thereof). If specified, function will return isotope assignment rasters and the product of these additionalModels and each assignmentRaster.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_additionalmodel_name">additionalModel_name</code></td>
<td>
<p>optional filename for additionalModel .grd savepath</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_savepath">savePath</code></td>
<td>
<p>If specified, function will save results to this path as a '.grd' file.</p>
</td></tr>
<tr><td><code id="isotopeAssignmentModel_+3A_nclusters">nClusters</code></td>
<td>
<p>integer of cores to run in parallel with doParallel. Default FALSE.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>myiso &lt;- rasterFromXYZ(isoscape)
raster::plot(myiso)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
         ID = paste0("Example.", 1:3),
         isotopeValue = c(-100, -80, -50),
         SD_indv = rep(5, 3)
         )
assignmentModels &lt;- isotopeAssignmentModel(
                        ID = df$ID,
                        isotopeValue = df$isotopeValue,
                        SD_indv = df$SD_indv,
                        precip_raster = myiso,
                        precip_SD_raster = myiso_sd
                        )
raster::plot(assignmentModels)

# Add additionalModels:
range_raster &lt;- myiso
range_raster[] &lt;- as.numeric( 1:ncell(myiso) %% 60 &gt;= 10)
plot(range_raster)

sdm_raster &lt;- myiso
sdm_raster[] &lt;- (1:ncell(sdm_raster))^2
sdm_raster &lt;- sdm_raster / raster::cellStats(sdm_raster, "sum")
plot(sdm_raster)

extraModels &lt;- raster::stack(range_raster, sdm_raster)
assignmentModels &lt;- isotopeAssignmentModel(
                        ID = paste0("Combo.",df$ID),
                        isotopeValue = df$isotopeValue,
                        SD_indv = df$SD_indv,
                        precip_raster = myiso,
                        precip_SD_raster = myiso_sd,
                        additionalModels = extraModels
                        )
raster::plot(assignmentModels)



</code></pre>

<hr>
<h2 id='makecumsumSurface'>Create cumulative sum probability surface</h2><span id='topic+makecumsumSurface'></span><span id='topic+cumsum_surface'></span>

<h3>Description</h3>

<p>Converts normalized probability surface (e.g. one layer output of isotopeAssignmentModel function) to cumulative sum surfaces, i.e., one where the new value of a given cell is equal to the sum of all old values less than or equal to the old value of the cell.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makecumsumSurface(indivraster, rescale = FALSE, rename = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makecumsumSurface_+3A_indivraster">indivraster</code></td>
<td>
<p>Normalized probability surface RasterLayer</p>
</td></tr>
<tr><td><code id="makecumsumSurface_+3A_rescale">rescale</code></td>
<td>
<p>Rescale between 0 and 1? Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="makecumsumSurface_+3A_rename">rename</code></td>
<td>
<p>Character value to append to raster name (e.g. &quot;_odds&quot;). Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns RasterLayer rescaled to Cumulative Sum values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cumsumAtSamplingLocation">cumsumAtSamplingLocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surfaces.
myiso &lt;- rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
        ID = c(-100, -80, -50),
        isotopeValue = c(-100, -80, -50),
        SD_indv = rep(5, 3)
        )
assignmentModels &lt;- isotopeAssignmentModel(
        ID = df$ID,
        isotopeValue = df$isotopeValue,
        SD_indv = df$SD_indv,
        precip_raster = myiso,
        precip_SD_raster = myiso_sd,
        nClusters = FALSE
        )

# Convert to cumulative sum surface.
cumulative_sum_surface &lt;- stack(
     lapply( unstack( assignmentModels ), makecumsumSurface )
     )
plot(cumulative_sum_surface)

</code></pre>

<hr>
<h2 id='makeMultiMonthIsoscape'>Make mean multi-month isoscape and error surfaces.</h2><span id='topic+makeMultiMonthIsoscape'></span>

<h3>Description</h3>

<p>Converts a stack of monthly isoscape maps, monthly isoscape standard error
maps, and optionally a precipitation (amount) stack. Each stack must contain
layers corresponding to each of the target months.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeMultiMonthIsoscape(iso_stack, iso_se_stack, precip_stack = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeMultiMonthIsoscape_+3A_iso_stack">iso_stack</code></td>
<td>
<p>A RasterStack containing n layers corresponding to isoscape models for n months.</p>
</td></tr>
<tr><td><code id="makeMultiMonthIsoscape_+3A_iso_se_stack">iso_se_stack</code></td>
<td>
<p>A RasterStack containing n layers corresponding to isoscape standard error maps for n months.</p>
</td></tr>
<tr><td><code id="makeMultiMonthIsoscape_+3A_precip_stack">precip_stack</code></td>
<td>
<p>Either a RasterStack containing n layers corresponding to precipitation amounts for n months, or NULL (assumes equal precipitation amounts.)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If precip_stack is NULL, model will assume equal precipitation amounts per month.
</p>


<h3>Value</h3>

<p>A list containing a mean isoscape and root-sum-of-square error map
</p>

<hr>
<h2 id='makeOddsSurfaces'>Convert probability surface to odds-ratio surface</h2><span id='topic+makeOddsSurfaces'></span><span id='topic+odds_surface'></span>

<h3>Description</h3>

<p>Converts normalized probability surface (e.g. one layer output of isotopeAssignmentModel function) to Odds Ratio surfaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeOddsSurfaces(probabilitySurface, rename = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeOddsSurfaces_+3A_probabilitysurface">probabilitySurface</code></td>
<td>
<p>Normalized probability surface RasterLayer</p>
</td></tr>
<tr><td><code id="makeOddsSurfaces_+3A_rename">rename</code></td>
<td>
<p>Character value to append to raster name (e.g. &quot;_odds&quot;). Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns RasterLayer rescaled to Odds Ratio values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+oddsAtSamplingLocation">oddsAtSamplingLocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surfaces.
myiso &lt;- rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
         ID = c(-100, -80, -50),
         isotopeValue = c(-100, -80, -50),
         SD_indv = rep(5, 3)
         )
assignmentModels &lt;- isotopeAssignmentModel(
         ID = df$ID,
         isotopeValue = df$isotopeValue,
         SD_indv = df$SD_indv,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )

# Convert to odds ratio surfaces.
odds_ratio_surface &lt;- stack(
   lapply( unstack(assignmentModels), makeOddsSurfaces )
   )
plot(odds_ratio_surface)

</code></pre>

<hr>
<h2 id='makeQuantileSimulationSurface'>Create quantile-simulation surfaces</h2><span id='topic+makeQuantileSimulationSurface'></span>

<h3>Description</h3>

<p>Converts normalized probability surfaces (e.g. one layer output of
isotopeAssignmentModel function) to quantile surfaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeQuantileSimulationSurface(
  probabilitySurface,
  ValidationQuantiles,
  rename = FALSE,
  rescale = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeQuantileSimulationSurface_+3A_probabilitysurface">probabilitySurface</code></td>
<td>
<p>Normalized probability surface RasterLayer.</p>
</td></tr>
<tr><td><code id="makeQuantileSimulationSurface_+3A_validationquantiles">ValidationQuantiles</code></td>
<td>
<p>Vector of quantile values from known-origin individuals, against which to compare each value within the probability surface. Each value must be between 0 and 1.</p>
</td></tr>
<tr><td><code id="makeQuantileSimulationSurface_+3A_rename">rename</code></td>
<td>
<p>Character value to append to raster name (e.g. &quot;_quantileSimulation&quot;). Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="makeQuantileSimulationSurface_+3A_rescale">rescale</code></td>
<td>
<p>If rescale = TRUE, returns surface showing proportion of times each surface cell value fell within the validation quantiles distribution. If rescale = FALSE, returns discrete number of times the cell fell within the distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns RasterLayer rescaled to quantile values.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surfaces.
library(isocat)
myiso &lt;- raster::rasterFromXYZ(isoscape)
myiso_sd &lt;- raster::rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
         ID = c(-100, -80, -50),
         isotopeValue = c(-100, -80, -50),
         SD_indv = rep(5, 3)
         )
assignmentModels &lt;- isotopeAssignmentModel(
         ID = df$ID,
         isotopeValue = df$isotopeValue,
         SD_indv = df$SD_indv,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd
         )

# Example known-origin quantile data.
q &lt;- rweibull(20000, 6, .98)
q &lt;- sample( q[ q &gt;=0 &amp; q &lt;= 1 ], 10000, replace = TRUE)
hist(q)

# Convert to quantile surfaces.
quantileSimulation_surface &lt;-  raster::stack(
                  lapply(
                            unstack(assignmentModels),
                            makeQuantileSimulationSurface,
                            ValidationQuantiles = q)
                        )
plot(quantileSimulation_surface)

</code></pre>

<hr>
<h2 id='makeQuantileSurfaces'>Convert probability surface to probability-quantile surface</h2><span id='topic+makeQuantileSurfaces'></span><span id='topic+quantile_surface'></span>

<h3>Description</h3>

<p>Converts normalized probability surface (e.g. one layer output of
isotopeAssignmentModel function) to quantile surfaces.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeQuantileSurfaces(probabilitySurface, rename = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="makeQuantileSurfaces_+3A_probabilitysurface">probabilitySurface</code></td>
<td>
<p>Normalized probability surface RasterLayer</p>
</td></tr>
<tr><td><code id="makeQuantileSurfaces_+3A_rename">rename</code></td>
<td>
<p>Character value to append to raster name (e.g. &quot;_quantile&quot;). Defaults to FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns RasterLayer rescaled to quantile values.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+quantileAtSamplingLocation">quantileAtSamplingLocation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surfaces.
myiso &lt;- rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
         ID = c(-100, -80, -50),
         isotopeValue = c(-100, -80, -50),
         SD_indv = rep(5, 3)
         )
assignmentModels &lt;- isotopeAssignmentModel(
         ID = df$ID,
         isotopeValue = df$isotopeValue,
         SD_indv = df$SD_indv,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )

# Convert to quantile surfaces.
quantile_surface &lt;-  raster::stack( lapply( unstack(assignmentModels), makeQuantileSurfaces) )
plot(quantile_surface)

</code></pre>

<hr>
<h2 id='meanAggregateClusterProbability'>Create mean aggregate probability-of-origin surfaces for each cluster.</h2><span id='topic+meanAggregateClusterProbability'></span>

<h3>Description</h3>

<p>Subset probability-of-origin surfaces by cluster assignment and find mean aggregate probability-of-origin surface for each clustered group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>meanAggregateClusterProbability(indivIDs, clusters, surfaces, nClust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="meanAggregateClusterProbability_+3A_individs">indivIDs</code></td>
<td>
<p>Vector of individual ID variables corresponding to surface names.</p>
</td></tr>
<tr><td><code id="meanAggregateClusterProbability_+3A_clusters">clusters</code></td>
<td>
<p>Vector of cluster IDs, in an order corresponding to 'indivIDs'.</p>
</td></tr>
<tr><td><code id="meanAggregateClusterProbability_+3A_surfaces">surfaces</code></td>
<td>
<p>Stack of probability-of-origin surfaces for all individuals. Object of class 'RasterStack.'</p>
</td></tr>
<tr><td><code id="meanAggregateClusterProbability_+3A_nclust">nClust</code></td>
<td>
<p>Create and apply a multi-core cluster for faster processing using 'raster' and 'parallel' packages. Defaults to 'FALSE' (i.e., no clustering).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# Create and cluster example assignment surfaces.
myiso &lt;- rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
        ID = LETTERS[1:9],
        isotopeValue = seq(-120,-25,length.out = 9),
        SD_indv = rep(5, 9)
        )
assignmentModels &lt;- isotopeAssignmentModel(
         ID = df$ID,
         isotopeValue = df$isotopeValue,
         SD_indv = df$SD_indv,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )
mySimilarityMatrix &lt;- simmatrixMaker(assignmentModels)
cS &lt;- clusterSimmatrix(
         simmatrix = mySimilarityMatrix,
         r = seq(.7,1.4,by=.1)
         )
# Cut clusters.
myheight &lt;- 0.25
df$cluster &lt;- dendextend::cutree(cS$hclust, h = myheight)
# Create mean aggregate surfaces.r p
meanSurfaces &lt;- meanAggregateClusterProbability(
         indivIDs = df$ID,
         clusters = df$cluster,
         surfaces = assignmentModels,
         nClust = FALSE
         )

</code></pre>

<hr>
<h2 id='oddsAtSamplingLocation'>Odds ratio at coordinates function</h2><span id='topic+oddsAtSamplingLocation'></span><span id='topic+odds_at_point'></span>

<h3>Description</h3>

<p>Function estimates percentile of each non-NA value within a RasterLayer using the empirical cumulative distribution function, and extracts value at location specified. For more information, see help(ecdf).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>oddsAtSamplingLocation(indivraster, Lat, Lon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="oddsAtSamplingLocation_+3A_indivraster">indivraster</code></td>
<td>
<p>RasterLayer representing normalized probability of origin surface</p>
</td></tr>
<tr><td><code id="oddsAtSamplingLocation_+3A_lat">Lat</code></td>
<td>
<p>Integer latitude</p>
</td></tr>
<tr><td><code id="oddsAtSamplingLocation_+3A_lon">Lon</code></td>
<td>
<p>Integer longitude</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+makeOddsSurfaces">makeOddsSurfaces</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surface.
myiso &lt;- raster::rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
exampleSurface &lt;- isotopeAssignmentModel(
         ID = "A",
         isotopeValue = -100,
         SD_indv = 5,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )
# Calculate odds ratio at specific point.
set.seed(1)
x &lt;- sample( which( !is.na(exampleSurface[]) ), size = 1)
pt &lt;- raster::xyFromCell(exampleSurface, x)
oddsAtSamplingLocation(exampleSurface, Lat = pt[2], Lon = pt[1])

</code></pre>

<hr>
<h2 id='projectSummaryMaxSurface'>Project probability-of-origin surfaces into one summary surface.</h2><span id='topic+projectSummaryMaxSurface'></span>

<h3>Description</h3>

<p>Create a summary surface showing which RasterLayer in a Stack has the highest value at a given location.
For each cell in a RasterStack, this function returns the identity of the RasterLayer with the highest value at that cell.
This surface is intended as a visual summary of common origins, not a basis for quantitative analysis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>projectSummaryMaxSurface(surfaces, nClust = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="projectSummaryMaxSurface_+3A_surfaces">surfaces</code></td>
<td>
<p>Object of class &quot;RasterStack&quot;, where each layer represents a probability-of-origin surface</p>
</td></tr>
<tr><td><code id="projectSummaryMaxSurface_+3A_nclust">nClust</code></td>
<td>
<p>Create and apply a multi-core cluster for faster processing using 'raster' and 'parallel' packages. Defaults to 'FALSE' (i.e., no clustering).</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Create and cluster example assignment surfaces.
myiso &lt;- rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
assignmentModels &lt;- isotopeAssignmentModel(
        ID = LETTERS[1:4],
        isotopeValue = seq(-120,-25,length.out = 4),
        SD_indv = rep(5,4),
        precip_raster = myiso,
        precip_SD_raster = myiso_sd,
        nClusters = FALSE
        )
raster::plot(assignmentModels)

# Project mean aggregate surfaces into space.
summaryMap &lt;- projectSummaryMaxSurface(
        surfaces = assignmentModels,
        nClust = FALSE
        )
raster::plot(summaryMap)

</code></pre>

<hr>
<h2 id='quantileAtSamplingLocation'>Quantile at coordinates function</h2><span id='topic+quantileAtSamplingLocation'></span><span id='topic+quantile_at_point'></span>

<h3>Description</h3>

<p>Function estimates percentile of each non-NA value within a RasterLayer using the empirical cumulative distribution function, and extracts value at location specified.
For more information, see help(ecdf).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileAtSamplingLocation(indivraster, Lat, Lon)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="quantileAtSamplingLocation_+3A_indivraster">indivraster</code></td>
<td>
<p>A RasterLayer representing normalized probability of origin surface</p>
</td></tr>
<tr><td><code id="quantileAtSamplingLocation_+3A_lat">Lat</code></td>
<td>
<p>Integer latitude</p>
</td></tr>
<tr><td><code id="quantileAtSamplingLocation_+3A_lon">Lon</code></td>
<td>
<p>Integer longitude</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+makeQuantileSurfaces">makeQuantileSurfaces</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surface.
myiso &lt;- raster::rasterFromXYZ(isoscape)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
exampleSurface &lt;- isotopeAssignmentModel(
         ID = "A",
         isotopeValue = -100,
         SD_indv = 5,
         precip_raster = myiso,
         precip_SD_raster = myiso_sd,
         nClusters = FALSE
         )
# Calculate quantile probability value at specific point.
set.seed(1)
x &lt;- sample( which( !is.na(exampleSurface[]) ), size = 1)
pt &lt;- raster::xyFromCell(exampleSurface, x)
quantileAtSamplingLocation(exampleSurface, Lat = pt[2], Lon = pt[1])


</code></pre>

<hr>
<h2 id='schoenersD'>Calculates Schoener's D-value between two RasterLayers.</h2><span id='topic+schoenersD'></span>

<h3>Description</h3>

<p>RasterLayers must have identical resolutions and extents. The function will
automatically normalize surfaces to sum to 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>schoenersD(rast1, rast2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="schoenersD_+3A_rast1">rast1</code></td>
<td>
<p>Input RasterLayer</p>
</td></tr>
<tr><td><code id="schoenersD_+3A_rast2">rast2</code></td>
<td>
<p>Input RasterLayer 2</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates similarity value of two RasterLayers using Schoener's D-metric.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate example probability surfaces.
myiso &lt;- raster::rasterFromXYZ(isoscape)
myiso_sd &lt;- raster::rasterFromXYZ(isoscape_sd)
df &lt;- data.frame(
        ID = c(-100, -80, -50),
        isotopeValue = c(-100, -80, -50),
        SD_indv = rep(5, 3)
        )
assignmentModels &lt;- isotopeAssignmentModel(
        ID = df$ID,
        isotopeValue = df$isotopeValue,
        SD_indv = df$SD_indv,
        precip_raster = myiso,
        precip_SD_raster = myiso_sd,
        nClusters = FALSE
        )

# Calculate Schoener's D-metric of spatial similarity between two of the
# example probability surfaces.
schoenersD(assignmentModels[[1]], assignmentModels[[2]])
## 0.969156

</code></pre>

<hr>
<h2 id='simmatrixMaker'>Generates similarity matrix for RasterStack</h2><span id='topic+simmatrixMaker'></span>

<h3>Description</h3>

<p>Applies pairwise comparisons of Schoener's D-metric between each RasterLayer in a RasterStack to populate a similarity matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmatrixMaker(assignmentRasters, nClusters = FALSE, csvSavePath = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simmatrixMaker_+3A_assignmentrasters">assignmentRasters</code></td>
<td>
<p>Input RasterStack</p>
</td></tr>
<tr><td><code id="simmatrixMaker_+3A_nclusters">nClusters</code></td>
<td>
<p>Clusters to create run in parallel using 'doParallel'. Defaults to FALSE.</p>
</td></tr>
<tr><td><code id="simmatrixMaker_+3A_csvsavepath">csvSavePath</code></td>
<td>
<p>Optional savepath to write similarity matrix to csv file. Defaults to FALSE, will not create csv.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Create probability-of-origin maps to compare.
myiso &lt;- rasterFromXYZ(isoscape)
raster::plot(myiso)
myiso_sd &lt;- rasterFromXYZ(isoscape_sd)
n &lt;- 5
set.seed(42)
df &lt;- data.frame(
         ID = LETTERS[1:n],
         isotopeValue = sample(-120:-40, n),
         SD_indv = rep(5, n)
         )
assignmentModels &lt;- isotopeAssignmentModel(
                        ID = df$ID,
                        isotopeValue = df$isotopeValue,
                        SD_indv = df$SD_indv,
                        precip_raster = myiso,
                        precip_SD_raster = myiso_sd,
                        nClusters = FALSE
                        )
raster::plot(assignmentModels)
# Compare maps with simmatrixMaker.
simmatrixMaker(assignmentModels, nClusters = FALSE, csvSavePath = FALSE)


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
