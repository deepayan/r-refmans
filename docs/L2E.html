<!DOCTYPE html><html><head><title>Help for package L2E</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {L2E}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bank'><p>Bank data</p></a></li>
<li><a href='#CV_L2E_sparse_dist'><p>Cross validation for L2E sparse regression with distance penalization</p></a></li>
<li><a href='#CV_L2E_sparse_ncv'><p>Cross validation for L2E sparse regression with existing penalization methods</p></a></li>
<li><a href='#CV_L2E_TF_dist'><p>Cross validation for L2E trend filtering regression with distance penalization</p></a></li>
<li><a href='#CV_L2E_TF_lasso'><p>Cross validation for L2E trend filtering regression with Lasso penalization</p></a></li>
<li><a href='#L2E'><p>L2E</p></a></li>
<li><a href='#L2E_convex'><p>L2E convex regression</p></a></li>
<li><a href='#L2E_isotonic'><p>L2E isotonic regression</p></a></li>
<li><a href='#L2E_multivariate'><p>L2E multivariate regression</p></a></li>
<li><a href='#l2e_regression'><p>L2E multivariate regression - PG</p></a></li>
<li><a href='#l2e_regression_convex'><p>L2E convex regression - PG</p></a></li>
<li><a href='#l2e_regression_convex_MM'><p>L2E convex regression - MM</p></a></li>
<li><a href='#l2e_regression_isotonic'><p>L2E isotonic regression - PG</p></a></li>
<li><a href='#l2e_regression_isotonic_MM'><p>L2E isotonic regression - MM</p></a></li>
<li><a href='#l2e_regression_MM'><p>L2E multivariate regression - MM</p></a></li>
<li><a href='#l2e_regression_sparse_dist'><p>L2E sparse regression with distance penalization</p></a></li>
<li><a href='#l2e_regression_sparse_ncv'><p>L2E sparse regression with existing penalization methods</p></a></li>
<li><a href='#l2e_regression_TF_dist'><p>L2E trend filtering regression with distance penalization</p></a></li>
<li><a href='#l2e_regression_TF_lasso'><p>L2E trend filtering regression with Lasso penalization</p></a></li>
<li><a href='#L2E_sparse_dist'><p>Solution path of L2E sparse regression with distance penalization</p></a></li>
<li><a href='#L2E_sparse_ncv'><p>Solution path of L2E sparse regression with existing penalization methods</p></a></li>
<li><a href='#L2E_TF_dist'><p>Solution path of the L2E trend filtering regression with distance penalization</p></a></li>
<li><a href='#L2E_TF_lasso'><p>Solution path of the L2E trend filtering regression with Lasso</p></a></li>
<li><a href='#myGetDkn'><p>Compute kth order differencing matrix</p></a></li>
<li><a href='#objective'><p>Objective function of the L2E regression - eta</p></a></li>
<li><a href='#objective_tau'><p>Objective function of the L2E regression - tau</p></a></li>
<li><a href='#update_beta_convex'><p>Beta update in L2E convex regression - PG</p></a></li>
<li><a href='#update_beta_isotonic'><p>Beta update in L2E isotonic regression - PG</p></a></li>
<li><a href='#update_beta_MM_convex'><p>Beta update in L2E convex regression - MM</p></a></li>
<li><a href='#update_beta_MM_isotonic'><p>Beta update in L2E isotonic regression - MM</p></a></li>
<li><a href='#update_beta_MM_ls'><p>Beta update in L2E multivariate regression - MM</p></a></li>
<li><a href='#update_beta_MM_sparse'><p>Beta update in L2E sparse regression - MM</p></a></li>
<li><a href='#update_beta_MM_TF'><p>Beta update in L2E trend filtering regression - MM</p></a></li>
<li><a href='#update_beta_qr'><p>Beta update in L2E multivariate regression - PG</p></a></li>
<li><a href='#update_beta_sparse_ncv'><p>Beta update in L2E sparse regression - NCV</p></a></li>
<li><a href='#update_beta_TF_lasso'><p>Beta update in L2E trend filtering regression using Lasso</p></a></li>
<li><a href='#update_eta_bktk'><p>Eta update using Newton's method with backtracking</p></a></li>
<li><a href='#update_tau_R'><p>Tau update function</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Robust Structured Regression via the L2 Criterion</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>An implementation of a computational framework for performing robust structured regression with the L2 criterion 
             from Chi and Chi (2021+). Improvements using the majorization-minimization (MM) principle from Liu, Chi, and 
             Lange (2022+) added in Version 2.0.</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jocelyn Chi &lt;jocetchi@gmail.com&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), osqp</td>
</tr>
<tr>
<td>Imports:</td>
<td>isotone, cobs, ncvreg, Matrix, signal, robustbase</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2, latex2exp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-09-08 16:33:38 UTC; jtc</td>
</tr>
<tr>
<td>Author:</td>
<td>Xiaoqian Liu [aut, ctb],
  Jocelyn Chi [aut, cre],
  Lisa Lin [ctb],
  Kenneth Lange [aut],
  Eric Chi [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-09-08 21:13:00 UTC</td>
</tr>
</table>
<hr>
<h2 id='bank'>Bank data</h2><span id='topic+bank'></span>

<h3>Description</h3>

<p>Data from an Italian bank on 1,949 customers. The response y is the amount of money made over a year.
The 13 covariates are possible macroservices the customers can sign up for.
</p>


<h3>Format</h3>

<p>A data frame with 1949 rows and 14 variables
</p>


<h3>References</h3>

<p>Marco Riani, Andrea Cerioli, and Anthony C. Atkinson (2014).
Monitoring robust regression. Electronic Journal of Statistics, Volume 8, 646-677.
</p>

<hr>
<h2 id='CV_L2E_sparse_dist'>Cross validation for L2E sparse regression with distance penalization</h2><span id='topic+CV_L2E_sparse_dist'></span>

<h3>Description</h3>

<p><code>CV_L2E_sparse_dist</code> performs k-fold cross-validation for robust sparse regression under the L2 criterion with
distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV_L2E_sparse_dist(
  y,
  X,
  beta0,
  tau0,
  kSeq,
  rhoSeq,
  nfolds = 5,
  seed = 1234,
  method = "median",
  max_iter = 100,
  tol = 1e-04,
  trace = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CV_L2E_sparse_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_kseq">kSeq</code></td>
<td>
<p>A sequence of tuning parameter k, the number of nonzero entries in the estimated coefficients</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_rhoseq">rhoSeq</code></td>
<td>
<p>A sequence of tuning parameter rho, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of cross-validation folds. Default is 5.</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_seed">seed</code></td>
<td>
<p>Users can set the seed of the random number generator to obtain reproducible results.</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_method">method</code></td>
<td>
<p>Median or mean to compute the objective</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_dist_+3A_trace">trace</code></td>
<td>
<p>Whether to trace the progress of the cross-validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the mean and standard error of the cross-validation error (vectors) &ndash; CVE and CVSE &ndash; for each value of k,
the index of the k value with the minimum CVE and the k value itself (scalars),
the index of the k value with the 1SE CVE and the k value itself (scalars),
the sequence of rho and k used in the regression (vectors), and
a vector listing which fold each element of y was assigned to
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 15 seconds

set.seed(12345)
n &lt;- 100
tau &lt;- 1
f &lt;- matrix(c(rep(2,5), rep(0,45)), ncol = 1)
X &lt;- X0 &lt;- matrix(rnorm(n*50), nrow = n)
y &lt;- y0 &lt;- X0 %*% f + (1/tau)*rnorm(n)

## Clean Data
k &lt;- c(6,5,4)
# (not run)
# cv &lt;- CV_L2E_sparse_dist(y=y, X=X, kSeq=k, nfolds=2, seed=1234)
# (k_min &lt;- cv$k.min) ## selected number of nonzero entries

# sol &lt;- L2E_sparse_dist(y=y, X=X, kSeq=k_min)
# r &lt;- y - X %*% sol$Beta
# ix &lt;- which(abs(r) &gt; 3/sol$Tau)
# l2e_fit &lt;- X %*% sol$Beta

# plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
# points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

## Contaminated Data
i &lt;- 1:5
y[i] &lt;- 2 + y0[i]
X[i,] &lt;- 2 + X0[i,]

# (not run)
# cv &lt;- CV_L2E_sparse_dist(y=y, X=X, kSeq=k, nfolds=2, seed=1234)
# (k_min &lt;- cv$k.min) ## selected number of nonzero entries

# sol &lt;- L2E_sparse_dist(y=y, X=X, kSeq=k_min)
# r &lt;- y - X %*% sol$Beta
# ix &lt;- which(abs(r) &gt; 3/sol$Tau)
# l2e_fit &lt;- X %*% sol$Beta

# plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
# points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='CV_L2E_sparse_ncv'>Cross validation for L2E sparse regression with existing penalization methods</h2><span id='topic+CV_L2E_sparse_ncv'></span>

<h3>Description</h3>

<p><code>CV_L2E_sparse_ncv</code> performs k-fold cross-validation for robust sparse regression under the L2 criterion.
Available penalties include lasso, MCP and SCAD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV_L2E_sparse_ncv(
  y,
  X,
  beta0,
  tau0,
  lambdaSeq,
  penalty = "MCP",
  nfolds = 5,
  seed = 1234,
  method = "median",
  max_iter = 100,
  tol = 1e-04,
  trace = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_lambdaseq">lambdaSeq</code></td>
<td>
<p>A decreasing sequence of tuning parameter lambda, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_penalty">penalty</code></td>
<td>
<p>Available penalties include lasso, MCP and SCAD.</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of cross-validation folds. Default is 5.</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_seed">seed</code></td>
<td>
<p>Users can set the seed of the random number generator to obtain reproducible results.</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_method">method</code></td>
<td>
<p>Median or mean to compute the objective</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="CV_L2E_sparse_ncv_+3A_trace">trace</code></td>
<td>
<p>Whether to trace the progress of the cross-validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the mean and standard error of the cross-validation error &ndash; CVE and CVSE &ndash; for each value of k (vectors),
the index of the lambda with the minimum CVE and the lambda value itself (scalars),
the index of the lambda value with the 1SE CVE and the lambda value itself (scalars),
the sequence of lambda used in the regression (vector), and
a vector listing which fold each element of y was assigned to
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 20 seconds

set.seed(12345)
n &lt;- 100
tau &lt;- 1
f &lt;- matrix(c(rep(2,5), rep(0,45)), ncol = 1)
X &lt;- X0 &lt;- matrix(rnorm(n*50), nrow = n)
y &lt;- y0 &lt;- X0 %*% f + (1/tau)*rnorm(n)

## Clean Data
lambda &lt;- 10^seq(-1, -2, length.out=20)
# (not run)
# cv &lt;- CV_L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda, penalty="SCAD", seed=1234, nfolds=2)
# (lambda_min &lt;- cv$lambda.min)

# sol &lt;- L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda_min, penalty="SCAD")
# r &lt;- y - X %*% sol$Beta
# ix &lt;- which(abs(r) &gt; 3/sol$Tau)
# l2e_fit &lt;- X %*% sol$Beta

# plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
# points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

## Contaminated Data
i &lt;- 1:5
y[i] &lt;- 2 + y0[i]
X[i,] &lt;- 2 + X0[i,]

# (not run)
# cv &lt;- CV_L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda, penalty="SCAD", seed=1234, nfolds=2)
# (lambda_min &lt;- cv$lambda.min)

# sol &lt;- L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda_min, penalty="SCAD")
# r &lt;- y - X %*% sol$Beta
# ix &lt;- which(abs(r) &gt; 3/sol$Tau)
# l2e_fit &lt;- X %*% sol$Beta

# plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
# points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='CV_L2E_TF_dist'>Cross validation for L2E trend filtering regression with distance penalization</h2><span id='topic+CV_L2E_TF_dist'></span>

<h3>Description</h3>

<p><code>CV_L2E_TF_dist</code> performs k-fold cross-validation for robust trend filtering regression under the L2 criterion with distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV_L2E_TF_dist(
  y,
  X,
  beta0,
  tau0,
  D,
  kSeq,
  rhoSeq,
  nfolds = 5,
  seed = 1234,
  method = "median",
  max_iter = 100,
  tol = 1e-04,
  trace = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CV_L2E_TF_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_x">X</code></td>
<td>
<p>Design matrix. Default is the identity matrix.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_kseq">kSeq</code></td>
<td>
<p>A sequence of tuning parameter k, the number of nonzero entries in Dbeta</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_rhoseq">rhoSeq</code></td>
<td>
<p>A sequence of tuning parameter rho, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of cross-validation folds. Default is 5.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_seed">seed</code></td>
<td>
<p>Users can set the seed of the random number generator to obtain reproducible results.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_method">method</code></td>
<td>
<p>Median or mean to calculate the objective value</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_dist_+3A_trace">trace</code></td>
<td>
<p>Whether to trace the progress of the cross-validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the mean and standard error of the cross-validation error &ndash; CVE and CVSE &ndash; for each value of k (vectors),
the index of the k value with the minimum CVE and the k value itself (scalars),
the index of the k value with the 1SE CVE and the k value itself (scalars),
the sequence of rho and k used in the regression (vectors), and
a vector listing which fold each element of y was assigned to
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 20 seconds

set.seed(12345)
n &lt;- 100
x &lt;- 1:n
f &lt;- matrix(rep(c(-2,5,0,-10), each=n/4), ncol=1)
y &lt;- y0 &lt;- f + rnorm(length(f))

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

D &lt;- myGetDkn(1, n)
k &lt;- c(4,3,2)
rho &lt;- 10^8
# (not run)
# cv &lt;- CV_L2E_TF_dist(y=y0, D=D, kSeq=k, rhoSeq=rho, nfolds=2, seed=1234)
# (k_min &lt;- cv$k.min)

# sol &lt;- L2E_TF_dist(y=y0, D=D, kSeq=k_min, rhoSeq=rho)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta, col='blue', lwd=3)

## Contaminated Data
ix &lt;- sample(1:n, 10)
y[ix] &lt;- y0[ix] + 2

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

# (not run)
# cv &lt;- CV_L2E_TF_dist(y=y, D=D, kSeq=k, rhoSeq=rho, nfolds=2, seed=1234)
# (k_min &lt;- cv$k.min)

# sol &lt;- L2E_TF_dist(y=y, D=D, kSeq=k_min, rhoSeq=rho)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta, col='blue', lwd=3)

</code></pre>

<hr>
<h2 id='CV_L2E_TF_lasso'>Cross validation for L2E trend filtering regression with Lasso penalization</h2><span id='topic+CV_L2E_TF_lasso'></span>

<h3>Description</h3>

<p><code>CV_L2E_TF_lasso</code> performs k-fold cross-validation for robust trend filtering regression under the L2 criterion with the Lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV_L2E_TF_lasso(
  y,
  X,
  beta0,
  tau0,
  D,
  lambdaSeq,
  nfolds = 5,
  seed = 1234,
  method = "median",
  max_iter = 100,
  tol = 1e-04,
  trace = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CV_L2E_TF_lasso_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_x">X</code></td>
<td>
<p>Design matrix. Default is the identity matrix.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_lambdaseq">lambdaSeq</code></td>
<td>
<p>A decreasing sequence of tuning parameter lambda, can be omitted</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_nfolds">nfolds</code></td>
<td>
<p>The number of cross-validation folds. Default is 5.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_seed">seed</code></td>
<td>
<p>Users can set the seed of the random number generator to obtain reproducible results.</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_method">method</code></td>
<td>
<p>Median or mean to calculate the objective value</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="CV_L2E_TF_lasso_+3A_trace">trace</code></td>
<td>
<p>Whether to trace the progress of the cross-validation</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the mean and standard error of the cross-validation error &ndash; CVE and CVSE &ndash; for each value of k (vectors),
the index of the lambda with the minimum CVE and the lambda value itself (scalars),
the index of the lambda value with the 1SE CVE and the lambda value itself (scalars),
the sequence of lambda used in the regression (vector), and
a vector listing which fold each element of y was assigned to
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 30 seconds

set.seed(12345)
n &lt;- 100
x &lt;- 1:n
f &lt;- matrix(rep(c(-2,5,0,-10), each=n/4), ncol=1)
y &lt;- y0 &lt;- f + rnorm(length(f))

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

D &lt;- myGetDkn(1, n)
lambda &lt;- 10^seq(-1, -2, length.out=20)
# (not run)
# cv &lt;- CV_L2E_TF_lasso(y=y0, D=D, lambdaSeq=lambda, nfolds=2, seed=1234)
# (lambda_min &lt;- cv$lambda.min)

# sol &lt;- L2E_TF_lasso(y=y0, D=D, lambdaSeq=lambda_min)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta, col='blue', lwd=3)

## Contaminated Data
ix &lt;- sample(1:n, 10)
y[ix] &lt;- y0[ix] + 2

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

# (not run)
# cv &lt;- CV_L2E_TF_lasso(y=y, D=D, lambdaSeq=lambda, nfolds=2, seed=1234)
# (lambda_min &lt;- cv$lambda.min)

# sol &lt;- L2E_TF_lasso(y=y, D=D, lambdaSeq=lambda_min)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta, col='blue', lwd=3)

</code></pre>

<hr>
<h2 id='L2E'>L2E</h2><span id='topic+L2E'></span>

<h3>Description</h3>

<p>The L2E package is an R implementation of a user-friendly 
computational framework for performing a wide variety of
robust structured regression methods via the L2 criterion.
</p>


<h3>Details</h3>

<p>Please refer to the vignette for examples of how to use
this package.
</p>

<hr>
<h2 id='L2E_convex'>L2E convex regression</h2><span id='topic+L2E_convex'></span>

<h3>Description</h3>

<p><code>L2E_convex</code> performs convex regression under the L2 criterion. Available methods include proximal gradient descent (PG) and majorization-minimization (MM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_convex(
  y,
  beta,
  tau,
  method = "MM",
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_convex_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_method">method</code></td>
<td>
<p>Available methods include PG and MM. MM by default.</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_convex_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta (vector) and tau or eta (vector)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2, 2, length.out=n)
f &lt;- x^4 + x
y &lt;- f + (1/tau) * rnorm(n)

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
## Least Squares method
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
## MM method
sol_mm &lt;- L2E_convex(y, b, tau)
## PG method
sol_pg &lt;- L2E_convex(y, b, tau, method='PG')

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, cvx, col='blue', lwd=3) ## LS
lines(x, sol_mm$beta, col='red', lwd=3) ## MM
lines(x, sol_pg$beta, col='dark green', lwd=3) ## PG

## Contaminated Data
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
sol_mm &lt;- L2E_convex(y, b, tau)
sol_pg &lt;- L2E_convex(y, b, tau, method='PG')

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, cvx, col='blue', lwd=3) ## LS
lines(x, sol_mm$beta, col='red', lwd=3) ## MM
lines(x, sol_pg$beta, col='dark green', lwd=3) ## PG
</code></pre>

<hr>
<h2 id='L2E_isotonic'>L2E isotonic regression</h2><span id='topic+L2E_isotonic'></span>

<h3>Description</h3>

<p><code>L2E_isotonic</code> performs isotonic regression under the L2 criterion. Available methods include proximal gradient descent (PG) and majorization-minimization (MM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_isotonic(
  y,
  beta,
  tau,
  method = "MM",
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_isotonic_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_method">method</code></td>
<td>
<p>Available methods include PG and MM. MM by default.</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_isotonic_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta (vector) and tau or eta (vector)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2.5, 2.5, length.out=n)
f &lt;- x^3
y &lt;- f + (1/tau) * rnorm(n)

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
## Least Squares method
iso &lt;- isotone::gpava(1:n, y)$x
## MM method
sol_mm &lt;- L2E_isotonic(y, b, tau)
## PG method
sol_pg &lt;- L2E_isotonic(y, b, tau, method='PG')

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, iso, col='blue', lwd=3) ## LS
lines(x, sol_mm$beta, col='red', lwd=3) ## MM
lines(x, sol_pg$beta, col='dark green', lwd=3) ## PG

## Contaminated Data
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
iso &lt;- isotone::gpava(1:n, y)$x
sol_mm &lt;- L2E_isotonic(y, b, tau)
sol_pg &lt;- L2E_isotonic(y, b, tau, method='PG')

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, iso, col='blue', lwd=3) ## LS
lines(x, sol_mm$beta, col='red', lwd=3) ## MM
lines(x, sol_pg$beta, col='dark green', lwd=3) ## PG

</code></pre>

<hr>
<h2 id='L2E_multivariate'>L2E multivariate regression</h2><span id='topic+L2E_multivariate'></span>

<h3>Description</h3>

<p><code>L2E_multivariate</code> performs multivariate regression under the L2 criterion. Available methods include proximal gradient descent (PG) and majorization-minimization (MM).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_multivariate(
  y,
  X,
  beta,
  tau,
  method = "MM",
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_multivariate_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_method">method</code></td>
<td>
<p>Available methods include PG and MM. MM by default.</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_multivariate_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta (vector) and tau or eta (vector)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Bank data example
y &lt;- bank$y
X &lt;- as.matrix(bank[,1:13])
X0 &lt;- as.matrix(cbind(rep(1,length(y)), X))

tau &lt;- 1/mad(y)
b &lt;- matrix(0, 14, 1)

# MM method
sol_mm &lt;- L2E_multivariate(y, X0, b, tau)
r_mm &lt;- y - X0 %*% sol_mm$beta
ix_mm &lt;- which(abs(r_mm) &gt; 3/sol_mm$tau)
l2e_fit_mm &lt;- X0 %*% sol_mm$beta

# PG method
sol_pg &lt;- L2E_multivariate(y, X0, b, tau, method="PG")
r_pg &lt;- y - X0 %*% sol_pg$beta
ix_pg &lt;- which(abs(r_pg) &gt; 3/sol_pg$tau)
l2e_fit_pg &lt;- X0 %*% sol_pg$beta

plot(y, l2e_fit_mm, ylab='Predicted values', main='MM', pch=16, cex=0.8) # MM
points(y[ix_mm], l2e_fit_mm[ix_mm], pch=16, col='blue', cex=0.8) # MM
plot(y, l2e_fit_pg, ylab='Predicted values', main='PG', pch=16, cex=0.8) # PG
points(y[ix_pg], l2e_fit_pg[ix_pg], pch=16, col='blue', cex=0.8) # PG

</code></pre>

<hr>
<h2 id='l2e_regression'>L2E multivariate regression - PG</h2><span id='topic+l2e_regression'></span>

<h3>Description</h3>

<p><code>l2e_regression</code> performs L2E multivariate regression via block coordinate descent
with proximal gradient for updating both beta and tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression(y, X, b, tau, max_iter = 100, tol = 1e-04, Show.Time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_b">b</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and tau (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Bank data example
y &lt;- bank$y
X &lt;- as.matrix(bank[,1:13])
X0 &lt;- as.matrix(cbind(rep(1,length(y)), X))
tauinit &lt;- 1/mad(y)
binit &lt;- matrix(0, 14, 1)

sol &lt;- l2e_regression(y, X0, binit, tauinit)
r &lt;- y - X0 %*% sol$beta
ix &lt;- which(abs(r) &gt; 3/sol$tau)
l2e_fit &lt;- X0 %*% sol$beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='l2e_regression_convex'>L2E convex regression - PG</h2><span id='topic+l2e_regression_convex'></span>

<h3>Description</h3>

<p><code>l2e_regression_convex</code> performs L2E convex regression via block coordinate descent
with proximal gradient for updating both beta and tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_convex(y, b, tau, max_iter = 100, tol = 1e-04, Show.Time = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_convex_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_+3A_b">b</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and tau (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2, 2, length.out=n)
f &lt;- x^4 + x
y &lt;- f + (1/tau) * rnorm(n)

## Clean data example
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_convex(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
lines(x, cvx, col='blue', lwd=3)
lines(x, sol$beta, col='dark green', lwd=3)

## Contaminated data example
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_convex(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
lines(x, cvx, col='blue', lwd=3)
lines(x, sol$beta, col='dark green', lwd=3)

</code></pre>

<hr>
<h2 id='l2e_regression_convex_MM'>L2E convex regression - MM</h2><span id='topic+l2e_regression_convex_MM'></span>

<h3>Description</h3>

<p><code>l2e_regression_convex_MM</code> performs L2E convex regression via block coordinate descent
with MM for updating beta and modified Newton for updating tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_convex_MM(
  y,
  beta,
  tau,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_convex_MM_+3A_y">y</code></td>
<td>
<p>response</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_MM_+3A_beta">beta</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_MM_+3A_tau">tau</code></td>
<td>
<p>initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_MM_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_MM_+3A_tol">tol</code></td>
<td>
<p>relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_convex_MM_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and eta (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2, 2, length.out=n)
f &lt;- x^4 + x
y &lt;- f + (1/tau)*rnorm(n)

## Clean
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_convex_MM(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
lines(x, cvx, col='blue', lwd=3)
lines(x, sol$beta, col='red', lwd=3)

## Contaminated
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_convex_MM(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
cvx &lt;- fitted(cobs::conreg(y, convex=TRUE))
lines(x, cvx, col='blue', lwd=3)
lines(x, sol$beta, col='red', lwd=3)

</code></pre>

<hr>
<h2 id='l2e_regression_isotonic'>L2E isotonic regression - PG</h2><span id='topic+l2e_regression_isotonic'></span>

<h3>Description</h3>

<p><code>l2e_regression_isotonic</code> performs L2E isotonic regression via block coordinate descent
with proximal gradient for updating both beta and tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_isotonic(
  y,
  b,
  tau,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_isotonic_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_+3A_b">b</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and tau (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2.5, 2.5, length.out=n)
f &lt;- x^3
y &lt;- f + (1/tau)*rnorm(n)

# Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_isotonic(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
iso &lt;- isotone::gpava(1:n, y)$x
lines(x, iso, col='blue', lwd=3)
lines(x, sol$beta, col='dark green', lwd=3)

# Contaminated Data
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_isotonic(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
iso &lt;- isotone::gpava(1:n, y)$x
lines(x, iso, col='blue', lwd=3)
lines(x, sol$beta, col='dark green', lwd=3)

</code></pre>

<hr>
<h2 id='l2e_regression_isotonic_MM'>L2E isotonic regression - MM</h2><span id='topic+l2e_regression_isotonic_MM'></span>

<h3>Description</h3>

<p><code>l2e_regression_isotonic_MM</code> performs L2E isotonic regression via block coordinate descent
with MM for updating beta and modified Newton for updating tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_isotonic_MM(
  y,
  beta,
  tau,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_isotonic_MM_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and eta (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 200
tau &lt;- 1
x &lt;- seq(-2.5, 2.5, length.out=n)
f &lt;- x^3
y &lt;- f + (1/tau)*rnorm(n)

## Clean
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_isotonic_MM(y, b, tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
iso &lt;- isotone::gpava(1:n, y)$x
lines(x, iso, col='blue', lwd=3)
lines(x,sol$beta,col='red',lwd=3)

## Contaminated
ix &lt;- 0:9
y[45 + ix] &lt;- 14 + rnorm(10)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

tau &lt;- 1
b &lt;- y
sol &lt;- l2e_regression_isotonic_MM(y,b,tau)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
iso &lt;- isotone::gpava(1:n, y)$x
lines(x, iso, col='blue', lwd=3)
lines(x,sol$beta,col='red',lwd=3)

</code></pre>

<hr>
<h2 id='l2e_regression_MM'>L2E multivariate regression - MM</h2><span id='topic+l2e_regression_MM'></span>

<h3>Description</h3>

<p><code>l2e_regression_MM</code> performs L2E multivariate regression via block coordinate descent
with MM for updating beta and modified Newton for updating tau.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_MM(
  y,
  X,
  beta,
  tau,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_MM_+3A_y">y</code></td>
<td>
<p>response</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_beta">beta</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_tau">tau</code></td>
<td>
<p>initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_tol">tol</code></td>
<td>
<p>relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_MM_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (vector) and tau (scalar),
the number of outer block descent iterations until convergence (scalar),
and the number of inner iterations per outer iteration for updating beta and eta (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Bank data example
y &lt;- bank$y
X &lt;- as.matrix(bank[,1:13])
X0 &lt;- as.matrix(cbind(rep(1,length(y)), X))
tau &lt;- 1/mad(y)
b &lt;- matrix(0, 14, 1)

sol &lt;- l2e_regression_MM(y, X0, b, tau)
r &lt;- y - X0 %*% sol$beta
ix &lt;- which(abs(r) &gt; 3/sol$tau)
l2e_fit &lt;- X0 %*% sol$beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='l2e_regression_sparse_dist'>L2E sparse regression with distance penalization</h2><span id='topic+l2e_regression_sparse_dist'></span>

<h3>Description</h3>

<p><code>l2e_regression_sparse_dist</code> performs robust sparse regression under the L2 criterion with the distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_sparse_dist(
  y,
  X,
  beta,
  tau,
  k,
  rho = 1,
  stepsize = 0.9,
  sigma = 0.5,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_sparse_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_k">k</code></td>
<td>
<p>The number of nonzero entries in the estimated coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_rho">rho</code></td>
<td>
<p>The parameter in the proximal distance algorithm</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_stepsize">stepsize</code></td>
<td>
<p>The stepsize parameter for the MM algorithm (0, 1)</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_sigma">sigma</code></td>
<td>
<p>The halving parameter sigma (0, 1)</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_dist_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>

<hr>
<h2 id='l2e_regression_sparse_ncv'>L2E sparse regression with existing penalization methods</h2><span id='topic+l2e_regression_sparse_ncv'></span>

<h3>Description</h3>

<p><code>l2e_regression_sparse_ncv</code> performs robust sparse regression under the L2 criterion. Available penalties include lasso, MCP and SCAD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_sparse_ncv(
  y,
  X,
  beta,
  tau,
  lambda,
  penalty,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_lambda">lambda</code></td>
<td>
<p>Tuning parameter</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_penalty">penalty</code></td>
<td>
<p>Available penalties include lasso, MCP and SCAD.</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_sparse_ncv_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>

<hr>
<h2 id='l2e_regression_TF_dist'>L2E trend filtering regression with distance penalization</h2><span id='topic+l2e_regression_TF_dist'></span>

<h3>Description</h3>

<p><code>l2e_regression_TF_dist</code> performs robust trend filtering regression under the L2 criterion with distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_TF_dist(
  y,
  X,
  beta,
  tau,
  D,
  k,
  rho = 1,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_TF_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_k">k</code></td>
<td>
<p>The number of nonzero entries in D*beta</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_rho">rho</code></td>
<td>
<p>The parameter in the proximal distance algorithm</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_dist_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>

<hr>
<h2 id='l2e_regression_TF_lasso'>L2E trend filtering regression with Lasso penalization</h2><span id='topic+l2e_regression_TF_lasso'></span>

<h3>Description</h3>

<p><code>l2e_regression_TF_lasso</code> performs robust trend filtering regression under the L2 criterion with Lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2e_regression_TF_lasso(
  y,
  X,
  beta,
  tau,
  D,
  lambda = 1,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2e_regression_TF_lasso_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_lambda">lambda</code></td>
<td>
<p>The tuning parameter</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="l2e_regression_TF_lasso_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>

<hr>
<h2 id='L2E_sparse_dist'>Solution path of L2E sparse regression with distance penalization</h2><span id='topic+L2E_sparse_dist'></span>

<h3>Description</h3>

<p><code>L2E_sparse_dist</code> computes the solution path of the robust sparse regression under the L2 criterion with distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_sparse_dist(
  y,
  X,
  beta0,
  tau0,
  kSeq,
  rhoSeq,
  stepsize = 0.9,
  sigma = 0.5,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_sparse_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_kseq">kSeq</code></td>
<td>
<p>A sequence of tuning parameter k, the number of nonzero entries in the estimated coefficients</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_rhoseq">rhoSeq</code></td>
<td>
<p>An increasing sequence of tuning parameter rho, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_stepsize">stepsize</code></td>
<td>
<p>The stepsize parameter for the MM algorithm (0, 1)</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_sigma">sigma</code></td>
<td>
<p>The halving parameter sigma (0, 1)</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_sparse_dist_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (matrix) and
tau (vector) for each value of the tuning parameter k,
the path of estimates for beta (list of matrices) and tau (matrix) for each value of rho,
the run time (vector) for each k,
and the sequence of rho and k used in the regression (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 100
tau &lt;- 1
f &lt;- matrix(c(rep(2,5), rep(0,45)), ncol = 1)
X &lt;- X0 &lt;- matrix(rnorm(n*50), nrow = n)
y &lt;- y0 &lt;- X0 %*% f + (1/tau)*rnorm(n)

## Clean Data
k &lt;- 5
sol &lt;- L2E_sparse_dist(y=y, X=X, kSeq=k)
r &lt;- y - X %*% sol$Beta
ix &lt;- which(abs(r) &gt; 3/sol$Tau)
l2e_fit &lt;- X %*% sol$Beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

## Contaminated Data
i &lt;- 1:5
y[i] &lt;- 2 + y0[i]
X[i,] &lt;- 2 + X0[i,]

sol &lt;- L2E_sparse_dist(y=y, X=X, kSeq=k)
r &lt;- y - X %*% sol$Beta
ix &lt;- which(abs(r) &gt; 3/sol$Tau)
l2e_fit &lt;- X %*% sol$Beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='L2E_sparse_ncv'>Solution path of L2E sparse regression with existing penalization methods</h2><span id='topic+L2E_sparse_ncv'></span>

<h3>Description</h3>

<p><code>L2E_sparse_ncv</code> computes the solution path of robust sparse regression under the L2 criterion. Available penalties include lasso, MCP and SCAD.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_sparse_ncv(
  y,
  X,
  b,
  tau,
  lambdaSeq,
  penalty = "MCP",
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_sparse_ncv_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_b">b</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_lambdaseq">lambdaSeq</code></td>
<td>
<p>A decreasing sequence of values for the tuning parameter lambda, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_penalty">penalty</code></td>
<td>
<p>Available penalties include lasso, MCP and SCAD.</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_sparse_ncv_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (matrix) and
tau (vector) for each value of the tuning parameter lambda,
the run time (vector) for each lambda,
and the sequence of lambda used in the regression (vector)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(12345)
n &lt;- 100
tau &lt;- 1
f &lt;- matrix(c(rep(2,5), rep(0,45)), ncol = 1)
X &lt;- X0 &lt;- matrix(rnorm(n*50), nrow = n)
y &lt;- y0 &lt;- X0 %*% f + (1/tau)*rnorm(n)

## Clean Data
lambda &lt;- 10^(-1)
sol &lt;- L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda, penalty="SCAD")
r &lt;- y - X %*% sol$Beta
ix &lt;- which(abs(r) &gt; 3/sol$Tau)
l2e_fit &lt;- X %*% sol$Beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

## Contaminated Data
i &lt;- 1:5
y[i] &lt;- 2 + y0[i]
X[i,] &lt;- 2 + X0[i,]

sol &lt;- L2E_sparse_ncv(y=y, X=X, lambdaSeq=lambda, penalty="SCAD")
r &lt;- y - X %*% sol$Beta
ix &lt;- which(abs(r) &gt; 3/sol$Tau)
l2e_fit &lt;- X %*% sol$Beta

plot(y, l2e_fit, ylab='Predicted values', pch=16, cex=0.8)
points(y[ix], l2e_fit[ix], pch=16, col='blue', cex=0.8)

</code></pre>

<hr>
<h2 id='L2E_TF_dist'>Solution path of the L2E trend filtering regression with distance penalization</h2><span id='topic+L2E_TF_dist'></span>

<h3>Description</h3>

<p><code>L2E_TF_dist</code> computes the solution path of the robust trend filtering regression under the L2 criterion with distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_TF_dist(
  y,
  X,
  beta0,
  tau0,
  D,
  kSeq,
  rhoSeq,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_TF_dist_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_x">X</code></td>
<td>
<p>Design matrix. Default is the identity matrix.</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_kseq">kSeq</code></td>
<td>
<p>A sequence of tuning parameter k, the number of nonzero entries in D*beta</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_rhoseq">rhoSeq</code></td>
<td>
<p>An increasing sequence of tuning parameter rho, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_TF_dist_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (matrix) and
tau (vector) for each value of the tuning parameter k,
the path of estimates for beta (list of matrices) and tau (matrix) for each value of rho,
the run time (vector) for each k,
and the sequence of rho and k used in the regression (vectors)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 15 seconds

set.seed(12345)
n &lt;- 100
x &lt;- 1:n
f &lt;- matrix(rep(c(-2,5,0,-10), each=n/4), ncol=1)
y &lt;- y0 &lt;- f + rnorm(length(f))

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

D &lt;- myGetDkn(1, n)
k &lt;- c(4,3,2)
rho &lt;- 10^8
# (not run)
# sol &lt;- L2E_TF_dist(y=y, D=D, kSeq=k, rhoSeq=rho)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta[,3], col='blue', lwd=3) ## k=2
# lines(x, sol$Beta[,2], col='red', lwd=3) ## k=3
# lines(x, sol$Beta[,1], col='dark green', lwd=3) ## k=4

## Contaminated Data
ix &lt;- sample(1:n, 10)
y[ix] &lt;- y0[ix] + 2

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

# (not run)
# sol &lt;- L2E_TF_dist(y=y, D=D, kSeq=k, rhoSeq=rho)

# plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
# lines(x, f, lwd=3)
# lines(x, sol$Beta[,3], col='blue', lwd=3) ## k=2
# lines(x, sol$Beta[,2], col='red', lwd=3) ## k=3
# lines(x, sol$Beta[,1], col='dark green', lwd=3) ## k=4

</code></pre>

<hr>
<h2 id='L2E_TF_lasso'>Solution path of the L2E trend filtering regression with Lasso</h2><span id='topic+L2E_TF_lasso'></span>

<h3>Description</h3>

<p><code>L2E_TF_lasso</code> computes the solution path of the robust trend filtering regression under the L2 criterion with Lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>L2E_TF_lasso(
  y,
  X,
  beta0,
  tau0,
  D,
  lambdaSeq,
  max_iter = 100,
  tol = 1e-04,
  Show.Time = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="L2E_TF_lasso_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_x">X</code></td>
<td>
<p>Design matrix. Default is the identity matrix.</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_beta0">beta0</code></td>
<td>
<p>Initial vector of regression coefficients, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_tau0">tau0</code></td>
<td>
<p>Initial precision estimate, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_lambdaseq">lambdaSeq</code></td>
<td>
<p>A decreasing sequence of values for the tuning parameter lambda, can be omitted</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
<tr><td><code id="L2E_TF_lasso_+3A_show.time">Show.Time</code></td>
<td>
<p>Report the computing time</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the estimates for beta (matrix) and
tau (vector) for each value of the tuning parameter lambda,
the run time (vector) for each lambda,
and the sequence of lambda used in the regression (vector)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Completes in 10 seconds

set.seed(12345)
n &lt;- 100
x &lt;- 1:n
f &lt;- matrix(rep(c(-2,5,0,-10), each=n/4), ncol=1)
y &lt;- y0 &lt;- f + rnorm(length(f))

## Clean Data
plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

D &lt;- myGetDkn(1, n)
lambda &lt;- 10^seq(-1, -2, length.out=20)
sol &lt;- L2E_TF_lasso(y=y, D=D, lambdaSeq=lambda)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, sol$Beta[,1], col='blue', lwd=3) ## 1st lambda

## Contaminated Data
ix &lt;- sample(1:n, 10)
y[ix] &lt;- y0[ix] + 2

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)

sol &lt;- L2E_TF_lasso(y=y, D=D, lambdaSeq=lambda)

plot(x, y, pch=16, cex.lab=1.5, cex.axis=1.5, cex.sub=1.5, col='gray')
lines(x, f, lwd=3)
lines(x, sol$Beta[,1], col='blue', lwd=3) ## 1st lambda

</code></pre>

<hr>
<h2 id='myGetDkn'>Compute kth order differencing matrix</h2><span id='topic+myGetDkn'></span>

<h3>Description</h3>

<p><code>myGetDkn</code> computes the kth order differencing matrix for use in
trend filtering regression
</p>


<h3>Usage</h3>

<pre><code class='language-R'>myGetDkn(k, n)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="myGetDkn_+3A_k">k</code></td>
<td>
<p>Order of the differencing matrix</p>
</td></tr>
<tr><td><code id="myGetDkn_+3A_n">n</code></td>
<td>
<p>Number of time points</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a Matrix object as the kth order differencing matrix
</p>

<hr>
<h2 id='objective'>Objective function of the L2E regression - eta</h2><span id='topic+objective'></span>

<h3>Description</h3>

<p><code>objective</code> computes the objective of the L2E regression in terms of eta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>objective(eta, r, method = "mean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="objective_+3A_eta">eta</code></td>
<td>
<p>The current estimate of eta</p>
</td></tr>
<tr><td><code id="objective_+3A_r">r</code></td>
<td>
<p>Vector of residuals</p>
</td></tr>
<tr><td><code id="objective_+3A_method">method</code></td>
<td>
<p>Mean or median</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the output of the objective function (scalar)
</p>

<hr>
<h2 id='objective_tau'>Objective function of the L2E regression - tau</h2><span id='topic+objective_tau'></span>

<h3>Description</h3>

<p><code>objective_tau</code> computes the objective of the L2E regression in terms of tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>objective_tau(tau, r, method = "mean")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="objective_tau_+3A_tau">tau</code></td>
<td>
<p>The current estimate of tau</p>
</td></tr>
<tr><td><code id="objective_tau_+3A_r">r</code></td>
<td>
<p>Vector of residuals</p>
</td></tr>
<tr><td><code id="objective_tau_+3A_method">method</code></td>
<td>
<p>Mean or median</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the output of the objective function (scalar)
</p>

<hr>
<h2 id='update_beta_convex'>Beta update in L2E convex regression - PG</h2><span id='topic+update_beta_convex'></span>

<h3>Description</h3>

<p><code>update_beta_convex</code> updates beta for L2E convex regression using PG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_convex(y, b, tau, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_convex_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_convex_+3A_b">b</code></td>
<td>
<p>Current estimate for beta</p>
</td></tr>
<tr><td><code id="update_beta_convex_+3A_tau">tau</code></td>
<td>
<p>Current estimate for tau</p>
</td></tr>
<tr><td><code id="update_beta_convex_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_convex_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_isotonic'>Beta update in L2E isotonic regression - PG</h2><span id='topic+update_beta_isotonic'></span>

<h3>Description</h3>

<p><code>update_beta_isotonic</code> updates beta for L2E isotonic regression using PG
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_isotonic(y, b, tau, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_isotonic_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_isotonic_+3A_b">b</code></td>
<td>
<p>Current estimate for beta</p>
</td></tr>
<tr><td><code id="update_beta_isotonic_+3A_tau">tau</code></td>
<td>
<p>Current estimate for tau</p>
</td></tr>
<tr><td><code id="update_beta_isotonic_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_isotonic_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_MM_convex'>Beta update in L2E convex regression - MM</h2><span id='topic+update_beta_MM_convex'></span>

<h3>Description</h3>

<p><code>update_beta_MM_convex</code> updates beta for L2E convex regression using MM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_MM_convex(y, beta, tau, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_MM_convex_+3A_y">y</code></td>
<td>
<p>Response</p>
</td></tr>
<tr><td><code id="update_beta_MM_convex_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_convex_+3A_tau">tau</code></td>
<td>
<p>Precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_MM_convex_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_MM_convex_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_MM_isotonic'>Beta update in L2E isotonic regression - MM</h2><span id='topic+update_beta_MM_isotonic'></span>

<h3>Description</h3>

<p><code>update_beta_MM_isotonic</code> updates beta for L2E isotonic regression using MM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_MM_isotonic(y, beta, tau, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_MM_isotonic_+3A_y">y</code></td>
<td>
<p>response</p>
</td></tr>
<tr><td><code id="update_beta_MM_isotonic_+3A_beta">beta</code></td>
<td>
<p>initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_isotonic_+3A_tau">tau</code></td>
<td>
<p>precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_MM_isotonic_+3A_max_iter">max_iter</code></td>
<td>
<p>maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_MM_isotonic_+3A_tol">tol</code></td>
<td>
<p>relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_MM_ls'>Beta update in L2E multivariate regression - MM</h2><span id='topic+update_beta_MM_ls'></span>

<h3>Description</h3>

<p><code>update_beta_MM_ls</code> updates beta for L2E multivariate regression using MM
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_MM_ls(y, X, beta, tau, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_MM_ls_+3A_y">y</code></td>
<td>
<p>Response</p>
</td></tr>
<tr><td><code id="update_beta_MM_ls_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_MM_ls_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_ls_+3A_tau">tau</code></td>
<td>
<p>Precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_MM_ls_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_MM_ls_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_MM_sparse'>Beta update in L2E sparse regression - MM</h2><span id='topic+update_beta_MM_sparse'></span>

<h3>Description</h3>

<p><code>update_beta_MM_sparse</code> updates beta for L2E sparse regression using the distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_MM_sparse(
  y,
  X,
  beta,
  tau,
  k,
  rho,
  stepsize = 0.9,
  sigma = 0.5,
  max_iter = 100,
  tol = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_MM_sparse_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_k">k</code></td>
<td>
<p>The number of nonzero entries in the estimated coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_rho">rho</code></td>
<td>
<p>The parameter in the proximal distance algorithm</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_stepsize">stepsize</code></td>
<td>
<p>The stepsize parameter for the MM algorithm (0, 1)</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_sigma">sigma</code></td>
<td>
<p>The halving parameter sigma (0, 1)</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_MM_sparse_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_MM_TF'>Beta update in L2E trend filtering regression - MM</h2><span id='topic+update_beta_MM_TF'></span>

<h3>Description</h3>

<p><code>update_beta_MM_TF</code> updates beta in L2E trend filtering regression using the distance penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_MM_TF(y, X, beta, tau, D, k, rho, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_MM_TF_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_k">k</code></td>
<td>
<p>The number of nonzero entries in D*beta</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_rho">rho</code></td>
<td>
<p>The parameter in the proximal distance algorithm</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_MM_TF_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_qr'>Beta update in L2E multivariate regression - PG</h2><span id='topic+update_beta_qr'></span>

<h3>Description</h3>

<p><code>update_beta_qr</code> updates beta for L2E multivariate regression via a QR solve
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_qr(y, X, QRF, tau, b, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_qr_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_qrf">QRF</code></td>
<td>
<p>QR factorization object for X (obtained via 'QRF=qr(X)')</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_tau">tau</code></td>
<td>
<p>Current estimate for tau</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_b">b</code></td>
<td>
<p>Current estimate for beta</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_qr_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_sparse_ncv'>Beta update in L2E sparse regression - NCV</h2><span id='topic+update_beta_sparse_ncv'></span>

<h3>Description</h3>

<p><code>update_beta_sparse_ncv</code> updates beta for L2E sparse regression using existing penalization methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_sparse_ncv(
  y,
  X,
  beta,
  tau,
  lambda,
  penalty,
  max_iter = 100,
  tol = 1e-04
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_sparse_ncv_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_lambda">lambda</code></td>
<td>
<p>Tuning parameter</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_penalty">penalty</code></td>
<td>
<p>Available penalties include lasso, MCP and SCAD.</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_sparse_ncv_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_beta_TF_lasso'>Beta update in L2E trend filtering regression using Lasso</h2><span id='topic+update_beta_TF_lasso'></span>

<h3>Description</h3>

<p><code>update_beta_TF_lasso</code> updates beta in L2E trend filtering regression using the Lasso penalty
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_beta_TF_lasso(y, X, beta, tau, D, lambda, max_iter = 100, tol = 1e-04)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_beta_TF_lasso_+3A_y">y</code></td>
<td>
<p>Response vector</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_x">X</code></td>
<td>
<p>Design matrix</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_beta">beta</code></td>
<td>
<p>Initial vector of regression coefficients</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_tau">tau</code></td>
<td>
<p>Initial precision estimate</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_d">D</code></td>
<td>
<p>The fusion matrix</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_lambda">lambda</code></td>
<td>
<p>The tuning parameter</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_beta_TF_lasso_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for beta (vector) and the number of iterations (scalar) the update step utilized
</p>

<hr>
<h2 id='update_eta_bktk'>Eta update using Newton's method with backtracking</h2><span id='topic+update_eta_bktk'></span>

<h3>Description</h3>

<p><code>update_eta_bktk</code> updates the precision parameter tau = e^eta for L2E regression using Newton's method
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_eta_bktk(r, eta, max_iter = 100, tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_eta_bktk_+3A_r">r</code></td>
<td>
<p>Vector of residual</p>
</td></tr>
<tr><td><code id="update_eta_bktk_+3A_eta">eta</code></td>
<td>
<p>Initial estimate of eta</p>
</td></tr>
<tr><td><code id="update_eta_bktk_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_eta_bktk_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for eta (scalar),
the number of iterations (scalar) the update step utilized,
the eta and objective function solution paths (vectors), and
the first and second derivatives calculated via Newton's method (vectors)
</p>

<hr>
<h2 id='update_tau_R'>Tau update function</h2><span id='topic+update_tau_R'></span>

<h3>Description</h3>

<p><code>update_tau_R</code> updates the precision parameter tau
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_tau_R(r, tau, sd_y, max_iter = 100, tol = 1e-10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_tau_R_+3A_r">r</code></td>
<td>
<p>Residual vector</p>
</td></tr>
<tr><td><code id="update_tau_R_+3A_tau">tau</code></td>
<td>
<p>Current estimate for tau</p>
</td></tr>
<tr><td><code id="update_tau_R_+3A_sd_y">sd_y</code></td>
<td>
<p>Standard deviation of y</p>
</td></tr>
<tr><td><code id="update_tau_R_+3A_max_iter">max_iter</code></td>
<td>
<p>Maximum number of iterations</p>
</td></tr>
<tr><td><code id="update_tau_R_+3A_tol">tol</code></td>
<td>
<p>Relative tolerance</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list object containing the new estimate for tau (scalar) and the number of iterations (scalar) the update step utilized
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
