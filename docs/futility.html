<!DOCTYPE html><html><head><title>Help for package futility</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {futility}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#completeTrial.byArm'><p>Treatment Arm-Specific Simulation-Based Completion of a Randomized Efficacy Trial with a Time-to-Event Endpoint and Fixed Follow-up Using an Interim Data-set</p></a></li>
<li><a href='#completeTrial.pooledArms'><p>Treatment Arm-Pooled Simulation-Based Completion of a Randomized Efficacy Trial with a Time-to-Event Endpoint and Fixed Follow-up Using an Interim Data-set</p></a></li>
<li><a href='#plotRCDF.byArm'><p>Plot Characteristics of the Estimated Distribution of the Treatment Arm-Specific Number of Endpoints</p></a></li>
<li><a href='#plotRCDF.pooledArms'><p>Plot Characteristics of the Estimated Distribution of the Treatment Arm-Pooled Number of Endpoints</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Interim Analysis of Operational Futility in Randomized Trials
with Time-to-Event Endpoints and Fixed Follow-Up</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-04-10</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/mjuraska/futility/issues">https://github.com/mjuraska/futility/issues</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Randomized clinical trials commonly follow participants for a time-to-event efficacy endpoint for a fixed period of time. Consequently, at the time when the last enrolled participant completes their follow-up, the number of observed endpoints is a random variable. Assuming data collected through an interim timepoint, simulation-based estimation and inferential procedures in the standard right-censored failure time analysis framework are conducted for the distribution of the number of endpoints&ndash;in total as well as by treatment arm&ndash;at the end of the follow-up period. The future (i.e., yet unobserved) enrollment, endpoint, and dropout times are generated according to mechanisms specified in the simTrial() function in the 'seqDesign' package. A Bayesian model for the endpoint rate, offering the option to specify a robust mixture prior distribution, is used for generating future data (see the vignette for details). Inference can be restricted to participants who received treatment according to the protocol and are observed to be at risk for the endpoint at a specified timepoint. Plotting functions are provided for graphical display of results.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/mjuraska/futility">https://github.com/mjuraska/futility</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-10 17:44:30 UTC; mjuraska</td>
</tr>
<tr>
<td>Author:</td>
<td>Yingying Zhuang [aut],
  Michal Juraska [aut, cre],
  Doug Grove [ctb],
  Peter Gilbert [ctb],
  Alexander Luedtke [ctb],
  Sanne Roels [ctb],
  An Vandebosch [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michal Juraska &lt;mjuraska@fredhutch.org&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-11 04:45:39 UTC</td>
</tr>
</table>
<hr>
<h2 id='completeTrial.byArm'>Treatment Arm-Specific Simulation-Based Completion of a Randomized Efficacy Trial with a Time-to-Event Endpoint and Fixed Follow-up Using an Interim Data-set</h2><span id='topic+completeTrial.byArm'></span>

<h3>Description</h3>

<p>Considers MITT data collected through an interim timepoint and generates independent time-to-event data-sets, by treatment arm, to assess the distribution of the number of treatment arm-specific endpoints
at the end of the follow-up period. A Bayesian model for treatment arm-specific endpoint rates is used for generating future data (see the vignette).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>completeTrial.byArm(interimData, nTrials, trtNames, N, enrollRate = NULL,
  enrollRatePeriod, eventPriorWeight, eventPriorRate,
  fixedDropOutRate = NULL, ppAnalysis = FALSE, missVaccProb = NULL,
  ppAtRiskTimePoint = NULL, fuTime, visitSchedule,
  visitSchedule2 = NULL, saveFile = NULL, saveDir = NULL,
  randomSeed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="completeTrial.byArm_+3A_interimdata">interimData</code></td>
<td>
<p>a data frame capturing observed MITT data at an interim timepoint that contains one row per enrolled participant in the MITT cohort and the following variables: <code>arm</code> (treatment arm), <code>schedule2</code> (an indicator that a participant follows the <code>visitSchedule2</code> schedule, e.g., participants who discontinue study product administration may remain in primary follow-up on a different schedule), <code>entry</code> (number of weeks since the reference date until the enrollment date), <code>exit</code> (number of weeks since the reference date until the trial exit date defined as the date of either infection diagnosis, dropout, or primary follow-up completion, whichever occurs first; <code>NA</code> for participants still in primary follow-up), <code>last_visit_dt</code> (number of weeks since the reference date until the last visit date), <code>event</code> (event indicator), <code>dropout</code> (dropout indicator), <code>complete</code> (indicator of completed follow-up), <code>followup</code> (indicator of being in primary follow-up). The reference date is defined as the enrollment date of the first participant. The variables <code>entry</code>, <code>exit</code>, and <code>last_visit_dt</code> use week as the unit of time. Month is defined as 52/12 weeks.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_ntrials">nTrials</code></td>
<td>
<p>the number of trials to be simulated</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_trtnames">trtNames</code></td>
<td>
<p>a character vector of treatment labels as specified in <code>interimData$arm</code> determining the order of treatment arms in other input arguments</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_n">N</code></td>
<td>
<p>a numeric vector specifying the target number of enrolled participants in each treatment arm, with the arms in the same order as in <code>trtNames</code></p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_enrollrate">enrollRate</code></td>
<td>
<p>a treatment arm-pooled weekly enrollment rate used for completing enrollment if <code>interimData</code>'s enrollment is incomplete. If <code>NULL</code> (default), the rate is calculated as the average over the last <code>enrollRatePeriod</code> weeks of enrollment in <code>interimData</code>. If equal to a numeric value, then <code>enrollRatePeriod</code> is ignored.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_enrollrateperiod">enrollRatePeriod</code></td>
<td>
<p>the length (in weeks) of the time period preceding the time of the last enrolled participant in <code>interimData</code> that the average weekly enrollment rate will be based on and used for completing enrollment. If <code>NULL</code> (default), then <code>enrollRate</code> must be specified.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_eventpriorweight">eventPriorWeight</code></td>
<td>
<p>a numeric value in <code class="reqn">[0,1]</code> representing a weight assigned to the prior gamma distribution of the treatment arm-specific event rates at the time when 50% of the estimated person-time at risk in each arm has been accumulated (see the vignette)</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_eventpriorrate">eventPriorRate</code></td>
<td>
<p>a numeric vector of treatment arm-specific prior mean incidence rates for the endpoint, expressed as numbers of events per person-year at risk, with the arms in the same order as in <code>trtNames</code></p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_fixeddropoutrate">fixedDropOutRate</code></td>
<td>
<p>the pre-trial assumed annual treatment arm-pooled dropout rate. If <code>NULL</code> (default), then the observed treatment arm-pooled dropout rate is used.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_ppanalysis">ppAnalysis</code></td>
<td>
<p>a logical value (<code>FALSE</code> by default) indicating whether an indicator of membership in the per-protocol cohort shall be generated based on complete MITT data. If <code>TRUE</code>, then <code>interimData</code> must include two additional variables: <code>missVacc</code> (an indicator of a missed vaccination) and <code>pp</code> (an indicator of membership in the per-protocol cohort; <code>NA</code> for participants with an indeterminate status).</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_missvaccprob">missVaccProb</code></td>
<td>
<p>a probability that a participant misses at least one vaccination. If <code>NULL</code> (default) and <code>ppAnalysis=TRUE</code>, then <code>missVaccProb</code> is calculated as the sample proportion of MITT participants in <code>interimData</code> with a missed vaccination using the <code>missVacc</code> variable. If <code>ppAnalysis=TRUE</code>, then the indicator of a missed vaccination for participants in <code>interimData</code> with <code>pp=NA</code> and future enrolled participants is sampled from the Bernoulli distribution with probability <code>missVaccProb</code>.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_ppatrisktimepoint">ppAtRiskTimePoint</code></td>
<td>
<p>a minimal follow-up time (in weeks) for a participant to qualify for inclusion in the per-protocol cohort (<code>NULL</code> by default)</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_futime">fuTime</code></td>
<td>
<p>a follow-up time (in weeks) of each participant</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_visitschedule">visitSchedule</code></td>
<td>
<p>a numeric vector of visit weeks at which testing for the endpoint is conducted</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_visitschedule2">visitSchedule2</code></td>
<td>
<p>a numeric vector of visit weeks at which testing for the endpoint is conducted in a subset of participants (e.g., those who discontinue administration of the study product but remain in follow-up). If <code>NULL</code> (default), everyone is assumed to follow <code>visitSchedule</code>.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_savefile">saveFile</code></td>
<td>
<p>a character string specifying an <code>.RData</code> file storing the output list. If <code>NULL</code> and <code>saveDir</code> is specified, the file name will be generated. If, in turn, <code>saveFile</code> is specified but <code>saveDir</code> equals <code>NULL</code>, then <code>saveFile</code> is ignored, and the output list will be returned.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_savedir">saveDir</code></td>
<td>
<p>a character string specifying a path for the output directory. If supplied, the output is saved as an <code>.RData</code> file in the directory; otherwise the output is returned as a list.</p>
</td></tr>
<tr><td><code id="completeTrial.byArm_+3A_randomseed">randomSeed</code></td>
<td>
<p>seed of the random number generator for simulation reproducibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>saveDir</code> is specified, the output list (named <code>trialObj</code>) is saved as an <code>.RData</code> file; otherwise it is returned. The output object is a list with the following components:
</p>

<ul>
<li> <p><code>trialData</code>: a list with <code>nTrials</code> components each of which is a <code>data.frame</code> with the variables <code>arm</code>, <code>entry</code>, <code>exit</code>, <code>event</code>, and <code>dropout</code> storing the treatment assignments, enrollment times, study exit times, event indicators, and dropout indicators, respectively. The observed follow-up times can be recovered as <code>exit</code> - <code>entry</code>. If <code>ppAnalysis=TRUE</code>, then the indicators of belonging to the per-protocol cohort (named <code>pp</code>) are included.
</p>
</li>
<li> <p><code>nTrials</code>: the number of simulated trials
</p>
</li>
<li> <p><code>N</code>: the total number of enrolled trial participants
</p>
</li>
<li> <p><code>rates</code>: a list with three components:
</p>

<ul>
<li> <p><code>enrollRate</code>: the treatment arm-pooled <em>weekly</em> enrollment rate
</p>
</li>
<li> <p><code>dropRate</code>: <code>fixedDropOutRate</code>, or, if <code>NULL</code>, the <em>annual</em> treatment arm-pooled dropout rate in <code>interimData</code>
</p>
</li>
<li> <p><code>eventPostRate</code>: a list with <code>length(trtNames)</code> components (labeled by the levels of the <code>arm</code> variable in <code>interimData</code>) each of which is a numeric vector of length <code>nTrials</code> of the sampled treatment arm-specific posterior <em>annual</em> event rates
</p>
</li></ul>

</li>
<li> <p><code>BetaOverBetaPlusTk</code>: a list with <code>length(trtNames)</code> components (labeled by the levels of the <code>arm</code> variable in <code>interimData</code>) each of which is the arm-specific weight placed on the prior mean event rate
</p>
</li>
<li> <p><code>TkOverTstar</code>: a list with <code>length(trtNames)</code> components (labeled by the levels of the <code>arm</code> variable in <code>interimData</code>) each of which is the ratio of the observed arm-specific person-time at risk to the estimated total arm-specific person-time at risk, with the arm-specific event rates set equal to the components of <code>eventPriorRate</code> in the estimator for the total arm-specific person-time at risk
</p>
</li>
<li> <p><code>randomSeed</code>: seed of the random number generator for simulation reproducibility
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+completeTrial.pooledArms">completeTrial.pooledArms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm &lt;- rep(c("C3","T1","T2"), each=250)
schedule &lt;- rbinom(length(arm), 1, 0.01)
entry &lt;- rpois(length(arm), lambda=60)
entry &lt;- entry - min(entry)
last_visit_dt &lt;- entry + runif(length(arm), min=0, max=80)
event &lt;- rbinom(length(arm), 1, 0.01)
dropout &lt;- rbinom(length(arm), 1, 0.02)
dropout[event==1] &lt;- 0
exit &lt;- rep(NA, length(arm))
exit[event==1] &lt;- last_visit_dt[event==1] + 5
exit[dropout==1] &lt;- last_visit_dt[dropout==1] + 5
followup &lt;- ifelse(event==1 | dropout==1, 0, 1)
interimData &lt;- data.frame(arm=arm, schedule2=schedule, entry=entry, exit=exit,
last_visit_dt=last_visit_dt, event=event, dropout=dropout, complete=0, followup=followup)

completeData &lt;- completeTrial.byArm(interimData=interimData, nTrials=5,
trtNames=c("C3","T1","T2"), N=c(500,500,500), enrollRatePeriod=24, eventPriorWeight=0.5,
eventPriorRate=c(0.001,0.0004,0.0004), fuTime=80, visitSchedule=seq(0, 80, by=4),
visitSchedule2=c(0,seq(from=8,to=80,by=12)), randomSeed=9)
### alternatively, to save the .RData output file (no '&lt;-' needed):
completeTrial.byArm(interimData=interimData, nTrials=5, trtNames=c("C3","T1","T2"),
N=c(500,500,500), enrollRatePeriod=24, eventPriorWeight=0.5,
eventPriorRate=c(0.001,0.0004,0.0004), fuTime=80, visitSchedule=seq(0, 80, by=4),
visitSchedule2=c(0,seq(from=8,to=80,by=12)), saveDir="./", randomSeed=9)

</code></pre>

<hr>
<h2 id='completeTrial.pooledArms'>Treatment Arm-Pooled Simulation-Based Completion of a Randomized Efficacy Trial with a Time-to-Event Endpoint and Fixed Follow-up Using an Interim Data-set</h2><span id='topic+completeTrial.pooledArms'></span>

<h3>Description</h3>

<p>Considers MITT data collected through an interim timepoint and generates independent time-to-event data-sets, ignoring treatment assignments, to assess the distribution of the number of treatment arm-pooled endpoints
at the end of the follow-up period. A Bayesian model for the treatment arm-pooled endpoint rate, offering the option to specify a robust mixture prior distribution, is used for generating future data (see the vignette).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>completeTrial.pooledArms(interimData, nTrials, N, enrollRate = NULL,
  enrollRatePeriod = NULL, eventPriorWeight, eventPriorRate = NULL,
  fixedDropOutRate = NULL, ppAnalysis = FALSE, missVaccProb = NULL,
  ppAtRiskTimePoint = NULL, fuTime, mixture = FALSE,
  mix.weights = NULL, eventPriorWeightRobust = NULL, visitSchedule,
  visitSchedule2 = NULL, saveFile = NULL, saveDir = NULL,
  randomSeed = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="completeTrial.pooledArms_+3A_interimdata">interimData</code></td>
<td>
<p>a data frame capturing observed MITT data at an interim timepoint that contains one row per enrolled participant in the MITT cohort and the following variables: <code>arm</code> (treatment arm), <code>schedule2</code> (an indicator that a participant follows the <code>visitSchedule2</code> schedule, e.g., participants who discontinue study product administration may remain in primary follow-up on a different schedule), <code>entry</code> (number of weeks since the reference date until the enrollment date), <code>exit</code> (number of weeks since the reference date until the trial exit date defined as the date of either infection diagnosis, dropout, or primary follow-up completion, whichever occurs first; <code>NA</code> for participants still in primary follow-up), <code>last_visit_dt</code> (number of weeks since the reference date until the last visit date), <code>event</code> (event indicator), <code>dropout</code> (dropout indicator), <code>complete</code> (indicator of completed follow-up), <code>followup</code> (indicator of being in primary follow-up). The reference date is defined as the enrollment date of the first participant. The variables <code>entry</code>, <code>exit</code>, and <code>last_visit_dt</code> use week as the unit of time. Month is defined as 52/12 weeks.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_ntrials">nTrials</code></td>
<td>
<p>the number of trials to be simulated</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_n">N</code></td>
<td>
<p>the total target number of enrolled participants</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_enrollrate">enrollRate</code></td>
<td>
<p>a treatment arm-pooled weekly enrollment rate used for completing enrollment if fewer than <code>N</code> participants were enrolled in <code>interimData</code>. If <code>NULL</code> (default), the rate is calculated as the average over the last <code>enrollRatePeriod</code> weeks of enrollment in <code>interimData</code>. If equal to a numerical value, then <code>enrollRatePeriod</code> is ignored.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_enrollrateperiod">enrollRatePeriod</code></td>
<td>
<p>the length (in weeks) of the time period preceding the time of the last enrolled participant in <code>interimData</code> that the average weekly enrollment rate will be based on and used for completing enrollment. If <code>NULL</code> (default), then <code>enrollRate</code> must be specified.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_eventpriorweight">eventPriorWeight</code></td>
<td>
<p>a numeric value in <code class="reqn">[0,1]</code> representing a weight assigned to the prior gamma distribution of the treatment arm-pooled event rate at the time when 50% of the estimated total person-time at risk has been accumulated (see the vignette)</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_eventpriorrate">eventPriorRate</code></td>
<td>
<p>a numeric value of a treatment arm-pooled prior mean incidence rate for the endpoint, expressed as the number of events per person-year at risk. If <code>NULL</code> (default), then use the observed rate in <code>interimData</code>.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_fixeddropoutrate">fixedDropOutRate</code></td>
<td>
<p>the pre-trial assumed annual dropout rate. If <code>NULL</code> (default), then the observed treatment arm-pooled dropout rate is used.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_ppanalysis">ppAnalysis</code></td>
<td>
<p>a logical value (<code>FALSE</code> by default) indicating whether an indicator of membership in the per-protocol cohort shall be generated based on complete MITT data. If <code>TRUE</code>, then <code>interimData</code> must include two additional variables: <code>missVacc</code> (an indicator of a missed vaccination) and <code>pp</code> (an indicator of membership in the per-protocol cohort; <code>NA</code> for participants with an indeterminate status).</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_missvaccprob">missVaccProb</code></td>
<td>
<p>a probability that a participant misses at least one vaccination. If <code>NULL</code> (default) and <code>ppAnalysis=TRUE</code>, then <code>missVaccProb</code> is calculated as the sample proportion of MITT participants in <code>interimData</code> with a missed vaccination using the <code>missVacc</code> variable. If <code>ppAnalysis=TRUE</code>, then the indicator of a missed vaccination for participants in <code>interimData</code> with <code>pp=NA</code> and future enrolled participants is sampled from the Bernoulli distribution with probability <code>missVaccProb</code>.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_ppatrisktimepoint">ppAtRiskTimePoint</code></td>
<td>
<p>a minimal follow-up time (in weeks) for a participant to qualify for inclusion in the per-protocol cohort (<code>NULL</code> by default)</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_futime">fuTime</code></td>
<td>
<p>a follow-up time (in weeks) of each participant</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_mixture">mixture</code></td>
<td>
<p>a logical value indicating whether to use the robust mixture approach (see the vignette). If equal to <code>FALSE</code> (default), then <code>mix.weights</code> and <code>eventPriorWeightRobust</code> are ignored.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_mix.weights">mix.weights</code></td>
<td>
<p>a numeric vector of length 2 representing prior weights (values in <code class="reqn">[0,1]</code>) of the informative and the weakly informative component, respectively, of the prior gamma-mixture distribution of the treatment arm-pooled event rate. The two weights must sum up to 1. If <code>NULL</code> (default) and <code>mixture=TRUE</code>, then <code>c(0.8,0.2)</code> is used.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_eventpriorweightrobust">eventPriorWeightRobust</code></td>
<td>
<p>a numeric value representing the weight <code class="reqn">w</code> used to calculate the <code class="reqn">\beta</code> parameter of the weakly informative gamma distribution in the mixture prior. If <code>NULL</code> (default) and <code>mixture=TRUE</code>, then <code class="reqn">1/200</code> is used.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_visitschedule">visitSchedule</code></td>
<td>
<p>a numeric vector of visit weeks at which testing for the endpoint is conducted</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_visitschedule2">visitSchedule2</code></td>
<td>
<p>a numeric vector of visit weeks at which testing for the endpoint is conducted in a subset of participants (e.g., those who discontinue administration of the study product but remain in follow-up). If <code>NULL</code> (default), everyone is assumed to follow <code>visitSchedule</code>.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_savefile">saveFile</code></td>
<td>
<p>a character string specifying an <code>.RData</code> file storing the output list. If <code>NULL</code> and <code>saveDir</code> is specified, the file name will be generated. If, in turn, <code>saveFile</code> is specified but <code>saveDir</code> equals <code>NULL</code>, then <code>saveFile</code> is ignored, and the output list will be returned.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_savedir">saveDir</code></td>
<td>
<p>a character string specifying a path for the output directory. If supplied, the output is saved as an <code>.RData</code> file in the directory; otherwise the output is returned as a list.</p>
</td></tr>
<tr><td><code id="completeTrial.pooledArms_+3A_randomseed">randomSeed</code></td>
<td>
<p>seed of the random number generator for simulation reproducibility</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>saveDir</code> is specified, the output list (named <code>trialObj</code>) is saved as an <code>.RData</code> file; otherwise it is returned. The output object is a list with the following components:
</p>

<ul>
<li> <p><code>trialData</code>: a list with <code>nTrials</code> components each of which is a <code>data.frame</code> with the variables <code>arm</code>, <code>entry</code>, <code>exit</code>, <code>event</code>, and <code>dropout</code> storing the treatment assignments, enrollment times, study exit times, event indicators, and dropout indicators respectively. The observed follow-up times can be recovered as <code>exit</code> - <code>entry</code>. If <code>ppAnalysis=TRUE</code>, then the indicators of belonging to the per-protocol cohort (named <code>pp</code>) are included.
</p>
</li>
<li> <p><code>nTrials</code>: the number of simulated trials
</p>
</li>
<li> <p><code>N</code>: the total number of enrolled trial participants
</p>
</li>
<li> <p><code>rates</code>: a list with three components:
</p>

<ul>
<li> <p><code>enrollRate</code>: the treatment arm-pooled <em>weekly</em> enrollment rate
</p>
</li>
<li> <p><code>dropRate</code>: <code>fixedDropOutRate</code>, or, if <code>NULL</code>, the <em>annual</em> treatment arm-pooled dropout rate in <code>interimData</code>
</p>
</li>
<li> <p><code>eventPostRate</code>: a numeric vector of length <code>nTrials</code> of the treatment arm-pooled <em>annual</em> event rates sampled from the posterior distribution
</p>
</li></ul>

</li>
<li> <p><code>BetaOverBetaPlusTk</code>: the weight placed on the prior mean event rate
</p>
</li>
<li> <p><code>TkOverTstar</code>: the ratio of the observed person-time at risk to the estimated total person-time at risk, with the event rate set equal to <code>eventPriorRate</code> in the estimator for the total person-time at risk
</p>
</li>
<li> <p><code>randomSeed</code>: seed of the random number generator for simulation reproducibility
</p>
</li>
<li> <p><code>w.post</code>: the weights, summing up to 1, of the gamma components of the posterior mixture distribution of the treatment arm-pooled event rate. If <code>mixture=FALSE</code>, then <code>w.post=NA</code>.
</p>
</li></ul>



<h3>See Also</h3>

<p><code><a href="#topic+completeTrial.byArm">completeTrial.byArm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm &lt;- rep(c("C3","T1","T2"), each=250)
schedule &lt;- rbinom(length(arm), 1, 0.01)
entry &lt;- rpois(length(arm), lambda=60)
entry &lt;- entry - min(entry)
last_visit_dt &lt;- entry + runif(length(arm), min=0, max=80)
event &lt;- rbinom(length(arm), 1, 0.01)
dropout &lt;- rbinom(length(arm), 1, 0.02)
dropout[event==1] &lt;- 0
exit &lt;- rep(NA, length(arm))
exit[event==1] &lt;- last_visit_dt[event==1] + 5
exit[dropout==1] &lt;- last_visit_dt[dropout==1] + 5
followup &lt;- ifelse(event==1 | dropout==1, 0, 1)
interimData &lt;- data.frame(arm=arm, schedule2=schedule, entry=entry, exit=exit,
last_visit_dt=last_visit_dt, event=event, dropout=dropout, complete=0,
followup=followup)

completeData &lt;- completeTrial.pooledArms(interimData=interimData, nTrials=5, N=1500,
enrollRatePeriod=24, eventPriorWeight=0.5, eventPriorRate=0.001, fuTime=80,
visitSchedule=seq(0, 80, by=4),
visitSchedule2=c(0,seq(from=8,to=80,by=12)), randomSeed=9)
### alternatively, to save the .RData output file (no '&lt;-' needed):
completeTrial.pooledArms(interimData=interimData, nTrials=5, N=1500,
enrollRatePeriod=24, eventPriorWeight=0.5, eventPriorRate=0.001, fuTime=80,
visitSchedule=seq(0, 80, by=4),
visitSchedule2=c(0,seq(from=8,to=80,by=12)), saveDir="./", randomSeed=9)

</code></pre>

<hr>
<h2 id='plotRCDF.byArm'>Plot Characteristics of the Estimated Distribution of the Treatment Arm-Specific Number of Endpoints</h2><span id='topic+plotRCDF.byArm'></span>

<h3>Description</h3>

<p>Takes the output from the <code><a href="#topic+completeTrial.byArm">completeTrial.byArm</a></code> function and generates a plot describing characteristics of the estimated distribution of the treatment arm-specific number of endpoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRCDF.byArm(armLabel, trtNames, eventTimeFrame = NULL,
  eventPPcohort = FALSE, eventPriorRate, eventPriorWeight, xlim = NULL,
  xlab = NULL, ylab = NULL, fileDir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRCDF.byArm_+3A_armlabel">armLabel</code></td>
<td>
<p>a character string matching a treatment label in the <code>arm</code> variable in <code>interimData</code> that indicates the treatment arm for which the plot will be generated</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_trtnames">trtNames</code></td>
<td>
<p>a character vector of all treatment labels listed in the same order as in <code>trtNames</code> in <code><a href="#topic+completeTrial.byArm">completeTrial.byArm</a></code></p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_eventtimeframe">eventTimeFrame</code></td>
<td>
<p>a time frame within which endpoints are counted, specified in weeks as <code>c(start, end)</code>. If <code>NULL</code> (default), then all endpoints are counted.</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_eventppcohort">eventPPcohort</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, only endpoints in the per-protocol cohort are counted. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_eventpriorrate">eventPriorRate</code></td>
<td>
<p>a numeric vector of treatment arm-specific prior mean incidence rates for the endpoint, expressed as numbers of events per person-year at risk, matching the order of treatment arms in <code>trtNames</code></p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_eventpriorweight">eventPriorWeight</code></td>
<td>
<p>a numeric vector in which each value represents a weight (i.e., a separate scenario) assigned to the prior gamma distribution of the treatment arm-specific event rate at the time when 50% of the estimated person-time at risk in the given <code>arm</code> has been accumulated</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector of the form <code>c(xmin, xmax)</code> for the user-specified x-axis limits. If <code>NULL</code> (default), then the computed range of x-axis values will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_xlab">xlab</code></td>
<td>
<p>a character string for the user-specified x-axis label. If <code>NULL</code> (default), then the label &quot;Number of Infections in Group <code>armLabel</code> (n)&quot; will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_ylab">ylab</code></td>
<td>
<p>a character string for the user-specified y-axis label. If <code>NULL</code> (default), then the label &quot;P(Number of Infections in Group <code>armLabel</code> &gt;= n ) x 100&quot; will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.byArm_+3A_filedir">fileDir</code></td>
<td>
<p>a character string specifying a path for the input directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+completeTrial.byArm">completeTrial.byArm</a></code> and <code><a href="#topic+plotRCDF.pooledArms">plotRCDF.pooledArms</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm &lt;- rep(c("C3","T1","T2"), each=250)
schedule &lt;- rbinom(length(arm), 1, 0.01)
entry &lt;- rpois(length(arm), lambda=60)
entry &lt;- entry - min(entry)
last_visit_dt &lt;- entry + runif(length(arm), min=0, max=80)
event &lt;- rbinom(length(arm), 1, 0.01)
dropout &lt;- rbinom(length(arm), 1, 0.02)
dropout[event==1] &lt;- 0
exit &lt;- rep(NA, length(arm))
exit[event==1] &lt;- last_visit_dt[event==1] + 5
exit[dropout==1] &lt;- last_visit_dt[dropout==1] + 5
followup &lt;- ifelse(event==1 | dropout==1, 0, 1)
interimData &lt;- data.frame(arm=arm, schedule2=schedule, entry=entry, exit=exit,
last_visit_dt=last_visit_dt, event=event, dropout=dropout, complete=0, followup=followup)

weights &lt;- c(0.2, 0.4, 0.6)
for (j in 1:length(weights)){
  completeTrial.byArm(interimData=interimData, nTrials=50,
  trtNames=c("C3","T1","T2"),N=c(500,500,500),
  enrollRatePeriod=24, eventPriorWeight=weights[j], eventPriorRate=c(0.06,0.03,0.03),
  fuTime=80, visitSchedule=seq(0, 80, by=4), visitSchedule2=c(0,seq(from=8,to=80,by=12)),
  saveDir="./", randomSeed=9)
}

pdf(file=paste0("./","rcdf_byArm_arm=T1_",
"eventPriorRateC3=0.06_eventPriorRateT1=0.03_eventPriorRateT2=0.03.pdf"), width=6,
height=5)
plotRCDF.byArm(armLabel="T1", trtNames=c("C3","T1","T2"), eventPriorRate=c(0.06,0.03,0.03),
eventPriorWeight=weights, fileDir="./")
dev.off()

</code></pre>

<hr>
<h2 id='plotRCDF.pooledArms'>Plot Characteristics of the Estimated Distribution of the Treatment Arm-Pooled Number of Endpoints</h2><span id='topic+plotRCDF.pooledArms'></span>

<h3>Description</h3>

<p>Takes the output from the <code><a href="#topic+completeTrial.pooledArms">completeTrial.pooledArms</a></code> function and generates a plot describing characteristics of the estimated distribution of the treatment arm-pooled number of endpoints.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotRCDF.pooledArms(eventTimeFrame = NULL, eventPPcohort = FALSE,
  target, power.axis = TRUE, power.TE = NULL, eventPriorRate,
  eventPriorWeight, xlim = NULL, xlab = NULL, ylab = NULL,
  power.lab = NULL, xPosLegend = 0.67, fileDir)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotRCDF.pooledArms_+3A_eventtimeframe">eventTimeFrame</code></td>
<td>
<p>a time frame within which endpoints are counted, specified in weeks as <code>c(start, end)</code>. If <code>NULL</code> (default), then all endpoints are counted.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_eventppcohort">eventPPcohort</code></td>
<td>
<p>a logical value. If <code>TRUE</code>, only endpoints in the per-protocol cohort are counted. The default value is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_target">target</code></td>
<td>
<p>a vector of target numbers of endpoints for reporting of the estimated probability that the total number of endpoints will be <code class="reqn">\ge</code> <code>target</code>, with a 95% credible interval</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_power.axis">power.axis</code></td>
<td>
<p>a logical value. If <code>TRUE</code> (default), then a top axis is added to the plot, showing power to reject <code class="reqn">H_0</code>: TE <code class="reqn">\le</code> 0% using a 1-sided 0.025-level Wald test if TE = <code>power.TE</code> throughout the trial.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_power.te">power.TE</code></td>
<td>
<p>a numeric value of treatment efficacy for which power is shown on the top axis. If <code>power.axis</code> is <code>FALSE</code>, then <code>power.TE</code> is ignored.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_eventpriorrate">eventPriorRate</code></td>
<td>
<p>a numeric value of the treatment arm-pooled prior mean incidence rate for the endpoint, expressed as the number of events per person-year at risk</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_eventpriorweight">eventPriorWeight</code></td>
<td>
<p>a numeric vector in which each value represents a weight (i.e., a separate scenario) assigned to the prior gamma distribution of the treatment arm-pooled event rate at the time when 50% of the estimated total person-time at risk has been accumulated</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_xlim">xlim</code></td>
<td>
<p>a numeric vector of the form <code>c(xmin, xmax)</code> for the user-specified x-axis limits. If <code>NULL</code> (default), then the computed range of x-axis values will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_xlab">xlab</code></td>
<td>
<p>a character string for the user-specified x-axis label. If <code>NULL</code> (default), then the label &quot;Total Number of Infections (n)&quot; will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_ylab">ylab</code></td>
<td>
<p>a character string for the user-specified y-axis label. If <code>NULL</code> (default), then the label &quot;P( Total Number of Infections &gt;= n ) x 100&quot; will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_power.lab">power.lab</code></td>
<td>
<p>a character string for the user-specified power-axis label. If <code>NULL</code> (default), then the label &quot;Power for TE = <code>power.TE</code> (x 100)&quot; will be used.</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_xposlegend">xPosLegend</code></td>
<td>
<p>a numeric value in <code class="reqn">[0,1]</code> (0.67 by default) specifying the x-coordinate for the position of the legend</p>
</td></tr>
<tr><td><code id="plotRCDF.pooledArms_+3A_filedir">fileDir</code></td>
<td>
<p>a character string specifying a path for the input directory</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. The function is called solely for plot generation.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+completeTrial.pooledArms">completeTrial.pooledArms</a></code> and <code><a href="#topic+plotRCDF.byArm">plotRCDF.byArm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>arm &lt;- rep(c("C3","T1","T2"), each=250)
schedule &lt;- rbinom(length(arm), 1, 0.01)
entry &lt;- rpois(length(arm), lambda=60)
entry &lt;- entry - min(entry)
last_visit_dt &lt;- entry + runif(length(arm), min=0, max=80)
event &lt;- rbinom(length(arm), 1, 0.01)
dropout &lt;- rbinom(length(arm), 1, 0.02)
dropout[event==1] &lt;- 0
exit &lt;- rep(NA, length(arm))
exit[event==1] &lt;- last_visit_dt[event==1] + 5
exit[dropout==1] &lt;- last_visit_dt[dropout==1] + 5
followup &lt;- ifelse(event==1 | dropout==1, 0, 1)
interimData &lt;- data.frame(arm=arm, schedule2=schedule, entry=entry, exit=exit,
last_visit_dt=last_visit_dt, event=event, dropout=dropout, complete=0,
followup=followup)

weights &lt;- c(0.2, 0.4, 0.6)
for (j in 1:length(weights)){
  completeTrial.pooledArms(interimData=interimData, nTrials=50, N=1500, enrollRatePeriod=24,
  eventPriorWeight=weights[j], eventPriorRate=0.06, fuTime=80, visitSchedule=seq(0, 80, by=4),
  visitSchedule2=c(0,seq(from=8,to=80,by=12)), saveDir="./", randomSeed=9)
}

pdf(file=paste0("./","rcdf_pooled_eventPriorRate=",0.06,".pdf"), width=6, height=5)
plotRCDF.pooledArms(target=c(60,30), power.axis=FALSE, eventPriorRate=0.06,
eventPriorWeight=weights, fileDir="./")
dev.off()

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
