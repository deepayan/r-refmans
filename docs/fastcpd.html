<!DOCTYPE html><html><head><title>Help for package fastcpd</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {fastcpd}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bitcoin'><p>Bitcoin Market Price (USD)</p></a></li>
<li><a href='#fastcpd'><p>Find change points efficiently</p></a></li>
<li><a href='#fastcpd_ar'><p>Find change points efficiently in AR(p) models</p></a></li>
<li><a href='#fastcpd_arima'><p>Find change points efficiently in ARIMA(p, d, q) models</p></a></li>
<li><a href='#fastcpd_arma'><p>Find change points efficiently in ARMA(p, q) models</p></a></li>
<li><a href='#fastcpd_binomial'><p>Find change points efficiently in logistic regression models</p></a></li>
<li><a href='#fastcpd_garch'><p>Find change points efficiently in GARCH(p, q) models</p></a></li>
<li><a href='#fastcpd_lasso'><p>Find change points efficiently in penalized linear regression models</p></a></li>
<li><a href='#fastcpd_lm'><p>Find change points efficiently in linear regression models</p></a></li>
<li><a href='#fastcpd_ma'><p>Find change points efficiently in MA(q) models</p></a></li>
<li><a href='#fastcpd_mean'><p>Find change points efficiently in mean change models</p></a></li>
<li><a href='#fastcpd_meanvariance'><p>Find change points efficiently in variance change models</p></a></li>
<li><a href='#fastcpd_poisson'><p>Find change points efficiently in Poisson regression models</p></a></li>
<li><a href='#fastcpd_ts'><p>Find change points efficiently in time series data</p></a></li>
<li><a href='#fastcpd_var'><p>Find change points efficiently in VAR(p) models</p></a></li>
<li><a href='#fastcpd_variance'><p>Find change points efficiently in variance change models</p></a></li>
<li><a href='#fastcpd-class'><p>An S4 class to store the output created with fastcpd</p></a></li>
<li><a href='#occupancy'><p>Occupancy Detection Data Set</p></a></li>
<li><a href='#plot.fastcpd'><p>Plot the data and the change points for a <code>fastcpd</code> object</p></a></li>
<li><a href='#print.fastcpd'><p>Print the call and the change points for a <code>fastcpd</code> object</p></a></li>
<li><a href='#show.fastcpd'><p>Show the available methods for a <code>fastcpd</code> object</p></a></li>
<li><a href='#summary.fastcpd'><p>Show the summary of a <code>fastcpd</code> object</p></a></li>
<li><a href='#transcriptome'><p>Transcription Profiling of 57 Human Bladder Carcinoma Samples</p></a></li>
<li><a href='#uk_seatbelts'><p>UK Seatbelts Data</p></a></li>
<li><a href='#variance_arma'><p>Variance estimation for ARMA model with change points</p></a></li>
<li><a href='#variance_lm'><p>Variance estimation for linear models with change points</p></a></li>
<li><a href='#variance_mean'><p>Variance estimation for mean change models</p></a></li>
<li><a href='#variance_median'><p>Variance estimation for median change models</p></a></li>
<li><a href='#well_log'><p>Well-log Dataset from Numerical Bayesian Methods Applied to Signal Processing</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast Change Point Detection via Sequential Gradient Descent</td>
</tr>
<tr>
<td>Version:</td>
<td>0.12.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Implements fast change point detection algorithm based on the
    paper "Sequential Gradient Descent and Quasi-Newton's Method for
    Change-Point Analysis" by Xianyang Zhang, Trisha Dawn
    <a href="https://proceedings.mlr.press/v206/zhang23b.html">https://proceedings.mlr.press/v206/zhang23b.html</a>. The algorithm is
    based on dynamic programming with pruning and sequential gradient
    descent. It is able to detect change points a magnitude faster than
    the vanilla Pruned Exact Linear Time(PELT). The package includes
    examples of linear regression, logistic regression, Poisson
    regression, penalized linear regression data, and whole lot more
    examples with custom cost function in case the user wants to use their
    own cost function.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://fastcpd.xingchi.li">https://fastcpd.xingchi.li</a>, <a href="https://github.com/doccstat/fastcpd">https://github.com/doccstat/fastcpd</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/doccstat/fastcpd/issues">https://github.com/doccstat/fastcpd/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>fastglm, forecast, glmnet, Matrix, methods, Rcpp (&ge; 0.11.0),
stats, tseries, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>abind, breakfast, changepoint, cpm, CptNonPar, ecp, fpop,
gfpop, ggplot2, gridExtra, InspectChangepoint, jointseg, knitr,
lubridate, matrixStats, mcp, mockthat, mosum, mvtnorm, not,
numDeriv, Rbeast, rmarkdown, segmented, stepR, strucchange,
testthat (&ge; 3.0.0), VARDetect, wbs, xml2, zoo</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>progress, Rcpp, RcppArmadillo, testthat</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Config/testthat/parallel:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/start-first:</td>
<td>vignettes-comparison-pelt, fastcpd_ts</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-18 16:04:39 UTC; ivan</td>
</tr>
<tr>
<td>Author:</td>
<td>Xingchi Li <a href="https://orcid.org/0009-0006-2493-0853"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Xianyang Zhang [aut, cph],
  Trisha Dawn [aut, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Xingchi Li &lt;anthony.li@stat.tamu.edu&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-19 13:50:11 UTC</td>
</tr>
</table>
<hr>
<h2 id='bitcoin'>Bitcoin Market Price (USD)</h2><span id='topic+bitcoin'></span>

<h3>Description</h3>

<p>The average USD market price across major bitcoin exchanges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bitcoin
</code></pre>


<h3>Format</h3>

<p>A data frame with 1354 rows and 2 variables:
</p>

<dl>
<dt>date</dt><dd><p>POSIXct,POSIXt (TZ: &quot;UTC&quot;) from 2019-01-02 to 2023-10-28</p>
</dd>
<dt>price</dt><dd><p>The average USD market price across major bitcoin exchanges</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.blockchain.com/explorer/charts/market-price&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

ggplot2::ggplot(bitcoin, ggplot2::aes(x = date, y = price)) +
  ggplot2::geom_line()

result &lt;- suppressWarnings(
  fastcpd.garch(diff(log(bitcoin$price[200:500])), c(1, 1), beta = "BIC")
)
summary(result)
bitcoin$date[result@cp_set + 200]
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd'>Find change points efficiently</h2><span id='topic+fastcpd'></span>

<h3>Description</h3>

<p><code>fastcpd</code> takes in formulas, data, families and extra
parameters and returns a <code>fastcpd</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd(
  formula = y ~ . - 1,
  data,
  beta = "MBIC",
  cost_adjustment = "MBIC",
  family = NULL,
  convexity_coef = 0,
  cost = NULL,
  cost_gradient = NULL,
  cost_hessian = NULL,
  line_search = c(1),
  lower = rep(-Inf, p),
  upper = rep(Inf, p),
  segment_count = 10,
  trim = 0.02,
  momentum_coef = 0,
  multiple_epochs = function(x) 0,
  epsilon = 1e-10,
  order = c(0, 0, 0),
  p = ncol(data) - 1,
  pruning = TRUE,
  cp_only = FALSE,
  vanilla_percentage = 0,
  warm_start = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_+3A_formula">formula</code></td>
<td>
<p>A formula object specifying the model to be fitted. The
optional response variable should be on the left hand side of the formula
while the covariates should be on the right hand side. The intercept term
should be removed from the formula. The response variable is not
necessary if the data considered is not of regression type. For example,
a mean or variance change model does not necessarily have response
variables. By default an intercept column will be added to the data
similar to the <code>lm</code> function in R. Thus it is suggested
that user should remove the intercept term from the formula by appending
<code>- 1</code> to the formula. The default formula is suitable for regression
data sets with one-dimensional response variable and the rest being
covariates without intercept. The naming of variables used in the formula
should be consistent with the column names in the data frame provided in
<code>data</code>.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_data">data</code></td>
<td>
<p>A data frame containing the data to be segmented where each row
denotes each data point. In one-dimensional response variable regression
settings, the first column is the response variable while the rest are
covariates. The response is not necessary in the case of mean change or
variance change, in which case the formula will need to be adjusted
accordingly.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_beta">beta</code></td>
<td>
<p>Penalty criterion for the number of change points.
Take a string value of <code>"MBIC"</code>, <code>"BIC"</code>, <code>"MDL"</code>
or a numeric value. If a numeric value is provided, the value will be
used as the penalty criterion for the number of change points in the
traditional Bayesian Information Criterion. By default, Modified BIC
criterion is used to obtain a proper value, i.e.,
<code>beta = (p + 2) * log(nrow(data)) / 2</code> with adjusted cost
function.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_cost_adjustment">cost_adjustment</code></td>
<td>
<p>Cost adjustment criterion for the number of change
points. Can be <code>"BIC"</code>, <code>"MBIC"</code>, <code>"MDL"</code> or NULL.
By default, the cost adjustment criterion is set to be <code>"MBIC"</code>.
MBIC and MDL modifies the cost function by adding a small negative
term to the cost function. MDL then transforms the cost function to
log2 based. BIC or NULL does not modify the cost function.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_family">family</code></td>
<td>
<p>Family of the model. Can be <code>"lm"</code>, <code>"binomial"</code>,
<code>"poisson"</code>, <code>"lasso"</code>, <code>"custom"</code>, <code>"ar"</code>,
<code>"var"</code>, <code>"ma"</code>, <code>"arima"</code>, <code>"garch"</code> or
<code>NULL</code>. For simplicity, user can also omit this parameter,
indicating that they will be using their own cost functions. Omitting the
parameter is the same as specifying the parameter to be <code>"custom"</code>
or <code>NULL</code>, in which case, users must specify the cost function, with
optional gradient and corresponding Hessian matrix functions.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_convexity_coef">convexity_coef</code></td>
<td>
<p>Convexity coefficient used in the pruning condition.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_cost">cost</code></td>
<td>
<p>Cost function to be used. This and the following two parameters
should not be specified at the same time with <code>family</code>. If not
specified, the default is the negative log-likelihood for the
corresponding family. Custom cost functions can be provided in the
following two formats:
</p>

<ul>
<li> <p><code>cost = function(data) {...}</code>
</p>
</li>
<li> <p><code>cost = function(data, theta) {...}</code>
</p>
</li></ul>

<p>In both methods, users should implement the cost value calculation based
on the data provided, where the data parameter can be considered as a
segment of the original data frame in the form of a matrix. The first
method is used when the cost function has an explicit solution, in which
case the cost function value can be calculated directly from the data.
The second method is used when the cost function does not have an
explicit solution, in which case the cost function value can be
calculated from the data and the estimated parameters. In the case of
only one <code>data</code> argument is provided, <code>fastcpd</code> performs the
vanilla PELT algorithm since no parameter updating is performed.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_cost_gradient">cost_gradient</code></td>
<td>
<p>Gradient function for the custom cost function.
Example usage:
</p>
<div class="sourceCode r"><pre>  cost_gradient = function(data, theta) {
    ...
    return(gradient)
  }
</pre></div>
<p>The gradient function should take two parameters, the first one being a
segment of the data in the format of a matrix, the second one being the
estimated parameters. The gradient function should return the gradient of
the cost function with respect to the data and parameters.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_cost_hessian">cost_hessian</code></td>
<td>
<p>Hessian function for the custom cost function. Similar to
the gradient function, the Hessian function should take two parameters,
the first one being a segment of the data in the format of a matrix, the
second one being the estimated parameters. The Hessian function should
return the Hessian matrix of the cost function with respect to the data
and parameters.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_line_search">line_search</code></td>
<td>
<p>If a vector of numeric values are provided, line
search will be performed to find the optimal step size for each update.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_lower">lower</code></td>
<td>
<p>Lower bound for the parameters. Used to specify the
domain of the parameter after each gradient descent step. If not specified,
the lower bound will be set to be <code>-Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_upper">upper</code></td>
<td>
<p>Upper bound for the parameters. Used to specify the
domain of the parameter after each gradient descent step. If not specified,
the upper bound will be set to be <code>Inf</code> for all parameters.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_segment_count">segment_count</code></td>
<td>
<p>Number of segments for initial guess. If not specified,
the initial guess on the number of segments is 10.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_trim">trim</code></td>
<td>
<p>Trimming for the boundary change points so that a change point
close to the boundary will not be counted as a change point. This
parameter also specifies the minimum distance between two change points.
If.   several change points have mutual distances smaller than
<code>trim * nrow(data)</code>, those change points will be merged into one
single change point. The value of this parameter should be between
0 and 1.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_momentum_coef">momentum_coef</code></td>
<td>
<p>Momentum coefficient to be applied to each update. This
parameter is used when the loss function is bad-shaped so that
maintaining a momentum from previous update is desired. Default value is
0, meaning the algorithm doesn't maintain a momentum by default.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_multiple_epochs">multiple_epochs</code></td>
<td>
<p>Function on number of epochs in SGD.
<code>multiple_epochs</code> should be a function taking only a parameter
<code>segment_length</code> meaning the current number of data
points considered since last segmentaion. The return value of the
function should be an integer indicating how many epochs should be
performed apart from the default update. By default the function returns
0, meaning no multiple epochs will be used to update the parameters.
Example usage:
</p>
<div class="sourceCode r"><pre>  multiple_epochs = function(segment_length) {
    if (segment_length &lt; n / segment_count / 4 * 1) 3
    else if (segment_length &lt; n / segment_count / 4 * 2) 2
    else if (segment_length &lt; n / segment_count / 4 * 3) 1
    else 0
  }
</pre></div>
<p>This function will perform 3 epochs for the first quarter of the data, 2
epochs for the second quarter of the data, 1 epoch for the third quarter
of the data and no multiple epochs for the last quarter of the data.
Experiments show that performing multiple epochs will significantly
affect the performance of the algorithm. This parameter is left for the
users to tune the performance of the algorithm if the result is not
ideal. Details are discussed in the paper.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_epsilon">epsilon</code></td>
<td>
<p>Epsilon to avoid numerical issues. Only used for the Hessian
computation in Logistic Regression and Poisson Regression.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_order">order</code></td>
<td>
<p>Order of the AR(p), VAR(p) or ARIMA(p, d, q) model.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_p">p</code></td>
<td>
<p>Number of covariates in the model. If not specified, the number of
covariates will be inferred from the data, i.e.,
<code>p = ncol(data) - 1</code>. This parameter is superseded by <code>order</code> in the
case of time series models: &quot;ar&quot;, &quot;var&quot;, &quot;arima&quot;.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_pruning">pruning</code></td>
<td>
<p>If <code>TRUE</code>, the algorithm will perform pruning on the
change points. By default, the value is set to be <code>TRUE</code>. Pruning
should be set to be <code>FALSE</code> if the pruning condition is not
satisfied.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_cp_only">cp_only</code></td>
<td>
<p>If <code>TRUE</code>, only the change points are returned.
Otherwise, the cost function values together with the estimated
parameters for each segment are also returned. By default the value is
set to be <code>FALSE</code> so that <code>plot</code> can be used to visualize the
results for a built-in model. <code>cp_only</code> has some performance impact
on the algorithm, since the cost values and estimated parameters for each
segment need to be calculated and stored. If the users are only
interested in the change points, setting <code>cp_only</code> to be <code>TRUE</code>
will help with the computational cost.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_vanilla_percentage">vanilla_percentage</code></td>
<td>
<p>How many of the data should be processed through
vanilla PELT. Range should be between 0 and 1. The <code>fastcpd</code>
algorithm is based on gradient descent and thus a starting estimate can
be crucial. At the beginning of the algorithm, vanilla PELT can be
performed to obtain a relatively accurate estimate of the parameters
despite the small amount of the data being used. If set to be 0, all data
will be processed through sequential gradient descnet. If set to be 1,
all data will be processed through vaniall PELT. If the cost function
have an explicit solution, i.e. does not depend on coefficients like the
mean change case, this parameter will be set to be 1. If the value is set
to be between 0 and 1, the first <code>vanilla_percentage * nrow(data)</code>
data points will be processed through vanilla PELT and the rest will be
processed through sequential gradient descent.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_warm_start">warm_start</code></td>
<td>
<p>If <code>TRUE</code>, the algorithm will use the estimated
parameters from the previous segment as the initial value for the
current segment. This parameter is only used for <code>"glm"</code> families.</p>
</td></tr>
<tr><td><code id="fastcpd_+3A_...">...</code></td>
<td>
<p>Parameters specifically used for time series models. The following
parameters will not be ignored:
</p>

<ul>
<li> <p><code>include.mean</code> is used for ARIMA and GARCH modes.
</p>
</li>
<li> <p><code>r.progress</code> is used to control the progress bar. By default the
progress bar will be shown. To disable it, set <code>r.progress = FALSE</code>.
</p>
</li>
<li> <p><code>p.response</code> is used to specify the number of response variables.
</p>
</li></ul>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Gallery</h3>

<p><a href="https://fastcpd.xingchi.li/articles/gallery.html">https://fastcpd.xingchi.li/articles/gallery.html</a>
</p>


<h3>References</h3>

<p>Zhang X, Dawn T (2023). &ldquo;Sequential Gradient Descent and Quasi-Newton's
Method for Change-Point Analysis.&rdquo; In Ruiz, Francisco, Dy, Jennifer,
van de Meent, Jan-Willem (eds.), <em>Proceedings of The 26th International
Conference on Artificial Intelligence and Statistics</em>, volume 206 series
Proceedings of Machine Learning Research, 1129-1143.
<a href="https://proceedings.mlr.press/v206/zhang23b.html">https://proceedings.mlr.press/v206/zhang23b.html</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for (package in c("ggplot2", "mvtnorm")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

set.seed(1)
p &lt;- 1
x &lt;- mvtnorm::rmvnorm(300, rep(0, p), diag(p))
theta_0 &lt;- matrix(c(1, -1, 0.5))
y &lt;- c(
  x[1:100, ] * theta_0[1, ] + rnorm(100, 0, 1),
  x[101:200, ] * theta_0[2, ] + rnorm(100, 0, 1),
  x[201:300, ] * theta_0[3, ] + rnorm(100, 0, 1)
)
result &lt;- fastcpd.lm(cbind(y, x))
summary(result)
plot(result)
if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 600
p &lt;- 4
d &lt;- 2
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta_1 &lt;- matrix(runif(8, -3, -1), nrow = p)
theta_2 &lt;- matrix(runif(8, -1, 3), nrow = p)
y &lt;- rbind(
  x[1:350, ] %*% theta_1 + mvtnorm::rmvnorm(350, rep(0, d), 3 * diag(d)),
  x[351:n, ] %*% theta_2 + mvtnorm::rmvnorm(250, rep(0, d), 3 * diag(d))
)
result_mlm &lt;- fastcpd(
  cbind(y.1, y.2) ~ . - 1, cbind.data.frame(y = y, x = x), family = "lm"
)
summary(result_mlm)

if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
p &lt;- 5
x &lt;- matrix(rnorm(375 * p, 0, 1), ncol = p)
theta &lt;- rbind(rnorm(p, 0, 1), rnorm(p, 2, 1))
y &lt;- c(
  rbinom(200, 1, 1 / (1 + exp(-x[1:200, ] %*% theta[1, ]))),
  rbinom(175, 1, 1 / (1 + exp(-x[201:375, ] %*% theta[2, ])))
)
data &lt;- data.frame(y = y, x = x)
result_builtin &lt;- suppressWarnings(fastcpd.binomial(data))
logistic_loss &lt;- function(data, theta) {
  x &lt;- data[, -1]
  y &lt;- data[, 1]
  u &lt;- x %*% theta
  nll &lt;- -y * u + log(1 + exp(u))
  nll[u &gt; 10] &lt;- -y[u &gt; 10] * u[u &gt; 10] + u[u &gt; 10]
  sum(nll)
}
logistic_loss_gradient &lt;- function(data, theta) {
  x &lt;- data[nrow(data), -1]
  y &lt;- data[nrow(data), 1]
  c(-(y - 1 / (1 + exp(-x %*% theta)))) * x
}
logistic_loss_hessian &lt;- function(data, theta) {
  x &lt;- data[nrow(data), -1]
  prob &lt;- 1 / (1 + exp(-x %*% theta))
  (x %o% x) * c((1 - prob) * prob)
}
result_custom &lt;- fastcpd(
  formula = y ~ . - 1,
  data = data,
  epsilon = 1e-5,
  cost = logistic_loss,
  cost_gradient = logistic_loss_gradient,
  cost_hessian = logistic_loss_hessian
)
cat(
  "Change points detected by built-in logistic regression model: ",
  result_builtin@cp_set, "\n",
  "Change points detected by custom logistic regression model: ",
  result_custom@cp_set, "\n",
  sep = ""
)
result_custom_two_epochs &lt;- fastcpd(
  formula = y ~ . - 1,
  data = data,
  multiple_epochs = function(segment_length) 1,
  epsilon = 1e-5,
  cost = logistic_loss,
  cost_gradient = logistic_loss_gradient,
  cost_hessian = logistic_loss_hessian
)
summary(result_custom_two_epochs)

if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 400 + 300 + 500
p &lt;- 5
x &lt;- mvtnorm::rmvnorm(n, mean = rep(0, p), sigma = diag(p))
theta &lt;- rbind(
  mvtnorm::rmvnorm(1, mean = rep(0, p - 3), sigma = diag(p - 3)),
  mvtnorm::rmvnorm(1, mean = rep(5, p - 3), sigma = diag(p - 3)),
  mvtnorm::rmvnorm(1, mean = rep(9, p - 3), sigma = diag(p - 3))
)
theta &lt;- cbind(theta, matrix(0, 3, 3))
theta &lt;- theta[rep(seq_len(3), c(400, 300, 500)), ]
y_true &lt;- rowSums(x * theta)
factor &lt;- c(
  2 * stats::rbinom(400, size = 1, prob = 0.95) - 1,
  2 * stats::rbinom(300, size = 1, prob = 0.95) - 1,
  2 * stats::rbinom(500, size = 1, prob = 0.95) - 1
)
y &lt;- factor * y_true + stats::rnorm(n)
data &lt;- cbind.data.frame(y, x)
huber_threshold &lt;- 1
huber_loss &lt;- function(data, theta) {
  residual &lt;- data[, 1] - data[, -1, drop = FALSE] %*% theta
  indicator &lt;- abs(residual) &lt;= huber_threshold
  sum(
    residual^2 / 2 * indicator +
      huber_threshold * (
        abs(residual) - huber_threshold / 2
      ) * (1 - indicator)
  )
}
huber_loss_gradient &lt;- function(data, theta) {
  residual &lt;- c(data[nrow(data), 1] - data[nrow(data), -1] %*% theta)
  if (abs(residual) &lt;= huber_threshold) {
    -residual * data[nrow(data), -1]
  } else {
    -huber_threshold * sign(residual) * data[nrow(data), -1]
  }
}
huber_loss_hessian &lt;- function(data, theta) {
  residual &lt;- c(data[nrow(data), 1] - data[nrow(data), -1] %*% theta)
  if (abs(residual) &lt;= huber_threshold) {
    outer(data[nrow(data), -1], data[nrow(data), -1])
  } else {
    0.01 * diag(length(theta))
  }
}
huber_regression_result &lt;- fastcpd(
  formula = y ~ . - 1,
  data = data,
  beta = (p + 1) * log(n) / 2,
  cost = huber_loss,
  cost_gradient = huber_loss_gradient,
  cost_hessian = huber_loss_hessian
)
summary(huber_regression_result)
</code></pre>

<hr>
<h2 id='fastcpd_ar'>Find change points efficiently in AR(p) models</h2><span id='topic+fastcpd_ar'></span><span id='topic+fastcpd.ar'></span>

<h3>Description</h3>

<p><code>fastcpd_ar</code> and <code>fastcpd.ar</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
AR(p) models. The function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code>
except that the data is by default a one-column matrix or univariate vector
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_ar(data, order = 0, ...)

fastcpd.ar(data, order = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_ar_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_ar_+3A_order">order</code></td>
<td>
<p>A positive integer specifying the order of the AR model.</p>
</td></tr>
<tr><td><code id="fastcpd_ar_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>. One special argument can be passed here is
<code>include.mean</code>, which is a logical value indicating whether the
mean should be included in the model. The default value is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 1000
x &lt;- rep(0, n + 3)
for (i in 1:600) {
  x[i + 3] &lt;- 0.6 * x[i + 2] - 0.2 * x[i + 1] + 0.1 * x[i] + rnorm(1, 0, 3)
}
for (i in 601:1000) {
  x[i + 3] &lt;- 0.3 * x[i + 2] + 0.4 * x[i + 1] + 0.2 * x[i] + rnorm(1, 0, 3)
}
result &lt;- fastcpd.ar(x[3 + seq_len(n)], 3)
summary(result)
plot(result)
</code></pre>

<hr>
<h2 id='fastcpd_arima'>Find change points efficiently in ARIMA(p, d, q) models</h2><span id='topic+fastcpd_arima'></span><span id='topic+fastcpd.arima'></span>

<h3>Description</h3>

<p><code>fastcpd_arima</code> and <code>fastcpd.arima</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
ARIMA(p, d, q) models. The function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code>
except that the data is by default a one-column matrix or univariate vector
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_arima(data, order = 0, ...)

fastcpd.arima(data, order = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_arima_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_arima_+3A_order">order</code></td>
<td>
<p>A vector of length three specifying the order of the ARIMA
model.</p>
</td></tr>
<tr><td><code id="fastcpd_arima_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>. One special argument can be passed here is
<code>include.mean</code>, which is a logical value indicating whether the
mean should be included in the model. The default value is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 271
w &lt;- rnorm(n + 1, 0, 3)
dx &lt;- rep(0, n + 1)
x &lt;- rep(0, n + 1)
for (i in 1:180) {
  dx[i + 1] &lt;- 0.8 * dx[i] + w[i + 1] - 0.5 * w[i]
  x[i + 1] &lt;- x[i] + dx[i + 1]
}
for (i in 181:n) {
  dx[i + 1] &lt;- -0.6 * dx[i] + w[i + 1] + 0.3 * w[i]
  x[i + 1] &lt;- x[i] + dx[i + 1]
}
result &lt;- fastcpd.arima(
  diff(x[1 + seq_len(n)]),
  c(1, 0, 1),
  segment_count = 3,
  include.mean = FALSE
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_arma'>Find change points efficiently in ARMA(p, q) models</h2><span id='topic+fastcpd_arma'></span><span id='topic+fastcpd.arma'></span>

<h3>Description</h3>

<p><code>fastcpd_arma</code> and <code>fastcpd.arma</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
ARMA(p, q) models. The function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code>
except that the data is by default a one-column matrix or univariate vector
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_arma(data, order = c(0, 0), ...)

fastcpd.arma(data, order = c(0, 0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_arma_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_arma_+3A_order">order</code></td>
<td>
<p>A vector of length two specifying the order of the ARMA
model.</p>
</td></tr>
<tr><td><code id="fastcpd_arma_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 300
w &lt;- rnorm(n + 3, 0, 3)
x &lt;- rep(0, n + 3)
for (i in 1:200) {
  x[i + 3] &lt;- 0.1 * x[i + 2] - 0.3 * x[i + 1] + 0.1 * x[i] +
    0.1 * w[i + 2] + 0.5 * w[i + 1] + w[i + 3]
}
for (i in 201:n) {
  x[i + 3] &lt;- 0.3 * x[i + 2] + 0.1 * x[i + 1] - 0.3 * x[i] -
    0.6 * w[i + 2] - 0.1 * w[i + 1] + w[i + 3]
}
result &lt;- suppressWarnings(
  fastcpd.arma(
    data = x[3 + seq_len(n)],
    order = c(3, 2),
    segment_count = 3,
    lower = c(rep(-1, 3 + 2), 1e-10),
    upper = c(rep(1, 3 + 2), Inf),
    line_search = c(1, 0.1, 1e-2)
  )
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_binomial'>Find change points efficiently in logistic regression models</h2><span id='topic+fastcpd_binomial'></span><span id='topic+fastcpd.binomial'></span>

<h3>Description</h3>

<p><code>"fastcpd_binomial"</code> and <code>"fastcpd.binomial"</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
logistic regression models. The function is similar to <code>"fastcpd"</code>
except that the data is by default a matrix or data frame with the response
variable as the first column and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_binomial(data, ...)

fastcpd.binomial(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_binomial_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td></tr>
<tr><td><code id="fastcpd_binomial_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for (package in c("ggplot2", "mvtnorm")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

set.seed(1)
n &lt;- 500
p &lt;- 4
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta &lt;- rbind(rnorm(p, 0, 1), rnorm(p, 2, 1))
y &lt;- c(
  rbinom(300, 1, 1 / (1 + exp(-x[1:300, ] %*% theta[1, ]))),
  rbinom(200, 1, 1 / (1 + exp(-x[301:n, ] %*% theta[2, ])))
)
result &lt;- suppressWarnings(fastcpd.binomial(cbind(y, x)))
summary(result)
plot(result)
</code></pre>

<hr>
<h2 id='fastcpd_garch'>Find change points efficiently in GARCH(p, q) models</h2><span id='topic+fastcpd_garch'></span><span id='topic+fastcpd.garch'></span>

<h3>Description</h3>

<p><code>"fastcpd_garch"</code> and <code>"fastcpd.garch"</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
GARCH(p, q) models. The function is similar to <code>"fastcpd"</code>
except that the data is by default a one-column matrix or univariate vector
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_garch(data, order = c(0, 0), ...)

fastcpd.garch(data, order = c(0, 0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_garch_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_garch_+3A_order">order</code></td>
<td>
<p>A positive integer vector of length two specifying the order of
the GARCH model.</p>
</td></tr>
<tr><td><code id="fastcpd_garch_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 400
sigma_2 &lt;- rep(1, n + 1)
x &lt;- rep(0, n + 1)
for (i in seq_len(200)) {
  sigma_2[i + 1] &lt;- 20 + 0.5 * x[i]^2 + 0.1 * sigma_2[i]
  x[i + 1] &lt;- rnorm(1, 0, sqrt(sigma_2[i + 1]))
}
for (i in 201:400) {
  sigma_2[i + 1] &lt;- 1 + 0.1 * x[i]^2 + 0.5 * sigma_2[i]
  x[i + 1] &lt;- rnorm(1, 0, sqrt(sigma_2[i + 1]))
}
result &lt;- suppressWarnings(
  fastcpd.garch(x[-1], c(1, 1), include.mean = FALSE)
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_lasso'>Find change points efficiently in penalized linear regression models</h2><span id='topic+fastcpd_lasso'></span><span id='topic+fastcpd.lasso'></span>

<h3>Description</h3>

<p><code>"fastcpd_lasso"</code> and <code>"fastcpd.lasso"</code> are wrapper
functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in penalized
linear regression models. The function is similar to <code>"fastcpd"</code>
except that the data is by default a matrix or data frame with the response
variable as the first column and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_lasso(data, ...)

fastcpd.lasso(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_lasso_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td></tr>
<tr><td><code id="fastcpd_lasso_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
for (package in c("ggplot2", "mvtnorm")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

set.seed(1)
n &lt;- 480
p_true &lt;- 6
p &lt;- 50
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta_0 &lt;- rbind(
  runif(p_true, -5, -2),
  runif(p_true, -3, 3),
  runif(p_true, 2, 5),
  runif(p_true, -5, 5)
)
theta_0 &lt;- cbind(theta_0, matrix(0, ncol = p - p_true, nrow = 4))
y &lt;- c(
  x[1:80, ] %*% theta_0[1, ] + rnorm(80, 0, 1),
  x[81:200, ] %*% theta_0[2, ] + rnorm(120, 0, 1),
  x[201:320, ] %*% theta_0[3, ] + rnorm(120, 0, 1),
  x[321:n, ] %*% theta_0[4, ] + rnorm(160, 0, 1)
)
result &lt;- fastcpd.lasso(
  cbind(y, x),
  multiple_epochs = function(segment_length) if (segment_length &lt; 30) 1 else 0
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_lm'>Find change points efficiently in linear regression models</h2><span id='topic+fastcpd_lm'></span><span id='topic+fastcpd.lm'></span>

<h3>Description</h3>

<p><code>"fastcpd_lm"</code> and <code>"fastcpd.lm"</code> are wrapper
functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in linear
regression models. The function is similar to <code>"fastcpd"</code> except that
the data is by default a matrix or data frame with the response variable
as the first column and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_lm(data, ...)

fastcpd.lm(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_lm_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td></tr>
<tr><td><code id="fastcpd_lm_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for (package in c("ggplot2", "mvtnorm")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

set.seed(1)
n &lt;- 300
p &lt;- 4
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta_0 &lt;- rbind(c(1, 3.2, -1, 0), c(-1, -0.5, 2.5, -2), c(0.8, 0, 1, 2))
y &lt;- c(
  x[1:100, ] %*% theta_0[1, ] + rnorm(100, 0, 3),
  x[101:200, ] %*% theta_0[2, ] + rnorm(100, 0, 3),
  x[201:n, ] %*% theta_0[3, ] + rnorm(100, 0, 3)
)
result_lm &lt;- fastcpd.lm(cbind(y, x))
summary(result_lm)
plot(result_lm)

set.seed(1)
n &lt;- 600
p &lt;- 4
d &lt;- 2
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta_1 &lt;- matrix(runif(8, -3, -1), nrow = p)
theta_2 &lt;- matrix(runif(8, -1, 3), nrow = p)
y &lt;- rbind(
  x[1:350, ] %*% theta_1 + mvtnorm::rmvnorm(350, rep(0, d), 3 * diag(d)),
  x[351:n, ] %*% theta_2 + mvtnorm::rmvnorm(250, rep(0, d), 3 * diag(d))
)
result_mlm &lt;- fastcpd.lm(cbind.data.frame(y = y, x = x), p.response = 2)
summary(result_mlm)
</code></pre>

<hr>
<h2 id='fastcpd_ma'>Find change points efficiently in MA(q) models</h2><span id='topic+fastcpd_ma'></span><span id='topic+fastcpd.ma'></span>

<h3>Description</h3>

<p><code>fastcpd_ma</code> and <code>fastcpd.ma</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
MA(q) models. The function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code>
except that the data is by default a one-column matrix or univariate vector
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_ma(data, order = 0, ...)

fastcpd.ma(data, order = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_ma_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_ma_+3A_order">order</code></td>
<td>
<p>A positive integer or a vector of length three with the first
two elements being zeros specifying the order of the MA model.</p>
</td></tr>
<tr><td><code id="fastcpd_ma_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>. One special argument can be passed here is
<code>include.mean</code>, which is a logical value indicating whether the
mean should be included in the model. The default value is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 400
w &lt;- rnorm(n + 4, 0, 0.1)
x &lt;- rep(NA, n)
for (i in 1:200) {
  x[i] &lt;- w[i + 4] - 5 / 3 * w[i + 3] + 11 / 12 * w[i + 2] - 5 / 12 * w[i + 1] +
    1 / 6 * w[i]
}
for (i in 201:n) {
  x[i] &lt;- w[i + 4] - 4 / 3 * w[i + 3] + 7 / 9 * w[i + 2] - 16 / 27 * w[i + 1] +
    4 / 27 * w[i]
}
result &lt;- suppressMessages(
  fastcpd.ma(x, 4, include.mean = FALSE, trim = 0)
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_mean'>Find change points efficiently in mean change models</h2><span id='topic+fastcpd_mean'></span><span id='topic+fastcpd.mean'></span>

<h3>Description</h3>

<p><code>"fastcpd_mean"</code> and <code>"fastcpd.mean"</code> are wrapper
functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find the mean change. The function is
similar to <code>"fastcpd"</code> except that the data is by default a matrix or
data frame or a vector with each row / element as an observation and thus a
formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_mean(data, ...)

fastcpd.mean(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_mean_+3A_data">data</code></td>
<td>
<p>A matrix, a data frame or a vector.</p>
</td></tr>
<tr><td><code id="fastcpd_mean_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
p &lt;- 3
data &lt;- rbind(
  mvtnorm::rmvnorm(300, mean = rep(0, p), sigma = diag(100, p)),
  mvtnorm::rmvnorm(400, mean = rep(50, p), sigma = diag(100, p)),
  mvtnorm::rmvnorm(300, mean = rep(2, p), sigma = diag(100, p))
)
result &lt;- fastcpd.mean(data)
summary(result)
# Test `fastcpd.mean()` running time. The running time is expected to be less
# than 1.5 seconds.
set.seed(1)
data &lt;- c(rnorm(10000), rnorm(1000) + 1)
(result_time &lt;- system.time(
  result &lt;- fastcpd.mean(data, r.progress = FALSE, cp_only = TRUE)
))
result@cp_set
</code></pre>

<hr>
<h2 id='fastcpd_meanvariance'>Find change points efficiently in variance change models</h2><span id='topic+fastcpd_meanvariance'></span><span id='topic+fastcpd.meanvariance'></span><span id='topic+fastcpd_mv'></span><span id='topic+fastcpd.mv'></span>

<h3>Description</h3>

<p><code>fastcpd_meanvariance</code>, <code>fastcpd.meanvariance</code>,
<code>fastcpd_mv</code>, <code>fastcpd.mv</code> are wrapper
functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find the meanvariance change. The
function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code> except that the data is by
default a matrix or data frame or a vector with each row / element as an
observation and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_meanvariance(data, ...)

fastcpd.meanvariance(data, ...)

fastcpd_mv(data, ...)

fastcpd.mv(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_meanvariance_+3A_data">data</code></td>
<td>
<p>A matrix, a data frame or a vector.</p>
</td></tr>
<tr><td><code id="fastcpd_meanvariance_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
p &lt;- 3
result &lt;- fastcpd.mv(
  rbind(
    mvtnorm::rmvnorm(300, mean = rep(0, p), sigma = diag(1, p)),
    mvtnorm::rmvnorm(400, mean = rep(10, p), sigma = diag(1, p)),
    mvtnorm::rmvnorm(300, mean = rep(0, p), sigma = diag(50, p)),
    mvtnorm::rmvnorm(300, mean = rep(0, p), sigma = diag(1, p)),
    mvtnorm::rmvnorm(400, mean = rep(10, p), sigma = diag(1, p)),
    mvtnorm::rmvnorm(300, mean = rep(10, p), sigma = diag(50, p))
  )
)
summary(result)
</code></pre>

<hr>
<h2 id='fastcpd_poisson'>Find change points efficiently in Poisson regression models</h2><span id='topic+fastcpd_poisson'></span><span id='topic+fastcpd.poisson'></span>

<h3>Description</h3>

<p><code>"fastcpd_poisson"</code> and <code>"fastcpd.poisson"</code> are
wrapper functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find change points in
Poisson regression models. The function is similar to <code>"fastcpd"</code>
except that the data is by default a matrix or data frame with the response
variable as the first column and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_poisson(data, ...)

fastcpd.poisson(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_poisson_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td></tr>
<tr><td><code id="fastcpd_poisson_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
for (package in c("ggplot2", "mvtnorm")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

set.seed(1)
n &lt;- 1100
p &lt;- 3
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
delta &lt;- rnorm(p)
theta_0 &lt;- c(1, 0.3, -1)
y &lt;- c(
  rpois(500, exp(x[1:500, ] %*% theta_0)),
  rpois(300, exp(x[501:800, ] %*% (theta_0 + delta))),
  rpois(200, exp(x[801:1000, ] %*% theta_0)),
  rpois(100, exp(x[1001:1100, ] %*% (theta_0 - delta)))
)
result &lt;- fastcpd.poisson(cbind(y, x))
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_ts'>Find change points efficiently in time series data</h2><span id='topic+fastcpd_ts'></span><span id='topic+fastcpd.ts'></span>

<h3>Description</h3>

<p><code>fastcpd_ts</code> is a wrapper function for <code>fastcpd</code> to find
change points in time series data. The function is similar to <code>fastcpd</code>
except that the data is a time series data and the family is one of
<code>"ar"</code>, <code>"var"</code>, <code>"arima"</code> or <code>"garch"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_ts(data, family = NULL, order = c(0, 0, 0), ...)

fastcpd.ts(data, family = NULL, order = c(0, 0, 0), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_ts_+3A_data">data</code></td>
<td>
<p>A numeric vector, a matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_ts_+3A_family">family</code></td>
<td>
<p>A character string specifying the family of the time series.
The value should be one of <code>"ar"</code>, <code>"var"</code>, <code>"arima"</code> or
<code>"garch"</code>.</p>
</td></tr>
<tr><td><code id="fastcpd_ts_+3A_order">order</code></td>
<td>
<p>A positive integer or a vector of length less than four
specifying the order of the time series. Possible combinations with
<code>family</code> are:
</p>

<ul>
<li><p> ar, NUMERIC(1): AR(p) model using linear regression.
</p>
</li>
<li><p> var, NUMERIC(1): VAR(p) model using linear regression.
</p>
</li>
<li><p> ma, NUMERIC(1): MA(q) model using <code>forecast::Arima</code>.
</p>
</li>
<li><p> ma, NUMERIC(3): ARIMA(0, 0, q) model using <code>forecast::Arima</code>, where
<code>q</code> is the third element of the vector.
</p>
</li>
<li><p> arima, NUMERIC(3): ARIMA(p, d, q) model using <code>forecast::Arima</code>.
</p>
</li>
<li><p> garch, NUMERIC(2): GARCH(p, q) model using <code>tseries::garch</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="fastcpd_ts_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>. One special argument can be passed here is
<code>include.mean</code>, which is a logical value indicating whether the
mean should be included in the model. The default value is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 250
x &lt;- rep(0, n + 1)
for (i in 1:180) {
  x[i + 1] &lt;- 0.8 * x[i] + rnorm(1, 0, 2)
}
for (i in 181:n) {
  x[i + 1] &lt;- 0.1 * x[i] + rnorm(1, 0, 2)
}
result &lt;- fastcpd.ts(
  x[1 + seq_len(n)],
  "arima",
  c(1, 0, 0),
  include.mean = FALSE,
  trim = 0,
  beta = (1 + 1 + 1) * log(n) / 2 * 3
)
summary(result)
plot(result)

</code></pre>

<hr>
<h2 id='fastcpd_var'>Find change points efficiently in VAR(p) models</h2><span id='topic+fastcpd_var'></span><span id='topic+fastcpd.var'></span>

<h3>Description</h3>

<p><code>fastcpd_var</code> and <code>fastcpd.var</code> are
wrapper functions of <code><a href="#topic+fastcpd.ts">fastcpd.ts</a></code> to find change points in
VAR(p) models. The function is similar to <code><a href="#topic+fastcpd.ts">fastcpd.ts</a></code>
except that the data is by default a matrix with row as an observation
and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_var(data, order = 0, ...)

fastcpd.var(data, order = 0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_var_+3A_data">data</code></td>
<td>
<p>A matrix, a data frame or a time series object.</p>
</td></tr>
<tr><td><code id="fastcpd_var_+3A_order">order</code></td>
<td>
<p>A positive integer specifying the order of the VAR model.</p>
</td></tr>
<tr><td><code id="fastcpd_var_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 300
p &lt;- 2
theta_1 &lt;- matrix(c(-0.3, 0.6, -0.5, 0.4, 0.2, 0.2, 0.2, -0.2), nrow = p)
theta_2 &lt;- matrix(c(0.3, -0.4, 0.1, -0.5, -0.5, -0.2, -0.5, 0.2), nrow = p)
x &lt;- matrix(0, n + 2, p)
for (i in 1:200) {
  x[i + 2, ] &lt;- theta_1 %*% c(x[i + 1, ], x[i, ]) + rnorm(p, 0, 1)
}
for (i in 201:n) {
  x[i + 2, ] &lt;- theta_2 %*% c(x[i + 1, ], x[i, ]) + rnorm(p, 0, 1)
}
result &lt;- fastcpd.var(x, 2, pruning = FALSE)
summary(result)
</code></pre>

<hr>
<h2 id='fastcpd_variance'>Find change points efficiently in variance change models</h2><span id='topic+fastcpd_variance'></span><span id='topic+fastcpd.variance'></span>

<h3>Description</h3>

<p><code>fastcpd_variance</code> and <code>fastcpd.variance</code> are wrapper
functions of <code><a href="#topic+fastcpd">fastcpd</a></code> to find the variance change. The
function is similar to <code><a href="#topic+fastcpd">fastcpd</a></code> except that the data is by
default a matrix or data frame or a vector with each row / element as an
observation and thus a formula is not required here.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fastcpd_variance(data, ...)

fastcpd.variance(data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fastcpd_variance_+3A_data">data</code></td>
<td>
<p>A matrix, a data frame or a vector.</p>
</td></tr>
<tr><td><code id="fastcpd_variance_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="#topic+fastcpd">fastcpd</a></code>, for example,
<code>segment_count</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>fastcpd</code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
p &lt;- 3
result &lt;- fastcpd.variance(
  rbind(
    mvtnorm::rmvnorm(300, rep(0, p), crossprod(matrix(runif(p^2) * 2 - 1, p))),
    mvtnorm::rmvnorm(400, rep(0, p), crossprod(matrix(runif(p^2) * 2 - 1, p))),
    mvtnorm::rmvnorm(300, rep(0, p), crossprod(matrix(runif(p^2) * 2 - 1, p)))
  )
)
summary(result)
</code></pre>

<hr>
<h2 id='fastcpd-class'>An S4 class to store the output created with <a href="#topic+fastcpd">fastcpd</a></h2><span id='topic+fastcpd-class'></span>

<h3>Description</h3>

<p>This S4 class stores the output from <a href="#topic+fastcpd">fastcpd</a>. A fastcpd object consist
of several slots including the call to <a href="#topic+fastcpd">fastcpd</a>, the data used, the
family of the model, the change points, the cost values, the residuals, the
estimated parameters and a boolean indicating whether the model was fitted
with only change points or with change points and parameters, which you can
select using <code>@</code>.
</p>


<h3>Slots</h3>


<dl>
<dt><code>call</code></dt><dd><p>The call of the function.</p>
</dd>
<dt><code>data</code></dt><dd><p>The data passed to the function.</p>
</dd>
<dt><code>order</code></dt><dd><p>The order of the time series model.</p>
</dd>
<dt><code>family</code></dt><dd><p>The family of the model.</p>
</dd>
<dt><code>cp_set</code></dt><dd><p>The set of change points.</p>
</dd>
<dt><code>cost_values</code></dt><dd><p>The cost function values for each segment.</p>
</dd>
<dt><code>residuals</code></dt><dd><p>The residuals of the model with change points.
Used only for built-in families.</p>
</dd>
<dt><code>thetas</code></dt><dd><p>The estimated parameters for each segment. Used only for
built-in families.</p>
</dd>
<dt><code>cp_only</code></dt><dd><p>A boolean indicating whether 'fastcpd' was run to return
only the change points or the change points with the estimated parameters
and cost values for each segment.</p>
</dd>
</dl>

<hr>
<h2 id='occupancy'>Occupancy Detection Data Set</h2><span id='topic+occupancy'></span>

<h3>Description</h3>

<p>Data set for binary classification of room occupancy from temperature,
humidity, light and CO2 measurements. Ground-truth occupancy was obtained
from time stamped pictures that were taken every minute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>occupancy
</code></pre>


<h3>Format</h3>

<p>A data frame with 9752 rows and 7 variables:
</p>

<dl>
<dt>date</dt><dd><p>Character in the format &quot;YYYY-MM-DD hh:mm:ss&quot; from
2015-02-11 14:48:00 to 2015-02-18 09:19:00</p>
</dd>
<dt>Temperature</dt><dd><p>Temperature in Celsius</p>
</dd>
<dt>Humidity</dt><dd><p>Humidity</p>
</dd>
<dt>Light</dt><dd><p>Light</p>
</dd>
<dt>CO2</dt><dd><p>CO2</p>
</dd>
<dt>HumidityRatio</dt><dd><p>Humidity Ratio</p>
</dd>
<dt>Occupancy</dt><dd><p>Binary variable with values 0 (unoccupied) and 1</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://github.com/LuisM78/Occupancy-detection-data&gt;
</p>

<hr>
<h2 id='plot.fastcpd'>Plot the data and the change points for a <code>fastcpd</code> object</h2><span id='topic+plot.fastcpd'></span><span id='topic+plot+2Cfastcpd+2Cmissing-method'></span>

<h3>Description</h3>

<p>Plot the data and the change points for a <code>fastcpd</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fastcpd'
plot(x, ...)

## S4 method for signature 'fastcpd,missing'
plot(x, y, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.fastcpd_+3A_x">x</code></td>
<td>
<p><code>fastcpd</code> object.</p>
</td></tr>
<tr><td><code id="plot.fastcpd_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
<tr><td><code id="plot.fastcpd_+3A_y">y</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for plotting.
</p>

<hr>
<h2 id='print.fastcpd'>Print the call and the change points for a <code>fastcpd</code> object</h2><span id='topic+print.fastcpd'></span><span id='topic+print+2Cfastcpd-method'></span>

<h3>Description</h3>

<p>Print the call and the change points for a <code>fastcpd</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fastcpd'
print(x, ...)

## S4 method for signature 'fastcpd'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.fastcpd_+3A_x">x</code></td>
<td>
<p><code>fastcpd</code> object.</p>
</td></tr>
<tr><td><code id="print.fastcpd_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a (temporarily) invisible copy of the <code>fastcpd</code> object.
Called primarily for printing the change points in the model.
</p>

<hr>
<h2 id='show.fastcpd'>Show the available methods for a <code>fastcpd</code> object</h2><span id='topic+show.fastcpd'></span><span id='topic+show+2Cfastcpd-method'></span>

<h3>Description</h3>

<p>Show the available methods for a <code>fastcpd</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fastcpd'
show(object)

## S4 method for signature 'fastcpd'
show(object)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="show.fastcpd_+3A_object">object</code></td>
<td>
<p><code>fastcpd</code> object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, called for showing a list of available methods
for a <code>fastcpd</code> object.
</p>

<hr>
<h2 id='summary.fastcpd'>Show the summary of a <code>fastcpd</code> object</h2><span id='topic+summary.fastcpd'></span><span id='topic+summary+2Cfastcpd-method'></span>

<h3>Description</h3>

<p>Show the summary of a <code>fastcpd</code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fastcpd'
summary(object, ...)

## S4 method for signature 'fastcpd'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.fastcpd_+3A_object">object</code></td>
<td>
<p><code>fastcpd</code> object.</p>
</td></tr>
<tr><td><code id="summary.fastcpd_+3A_...">...</code></td>
<td>
<p>Ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a (temporarily) invisible copy of the <code>fastcpd</code> object.
Called primarily for printing the summary of the model including the
call, the change points, the cost values and the estimated parameters.
</p>

<hr>
<h2 id='transcriptome'>Transcription Profiling of 57 Human Bladder Carcinoma Samples</h2><span id='topic+transcriptome'></span>

<h3>Description</h3>

<p>Transcriptome analysis of 57 bladder carcinomas on Affymetrix HG-U95A and
HG-U95Av2 microarrays
</p>


<h3>Usage</h3>

<pre><code class='language-R'>transcriptome
</code></pre>


<h3>Format</h3>

<p>A data frame with 2215 rows and 43 variables:
</p>

<dl>
<dt>3</dt><dd><p>Individual 3</p>
</dd>
<dt>4</dt><dd><p>Individual 4</p>
</dd>
<dt>5</dt><dd><p>Individual 5</p>
</dd>
<dt>6</dt><dd><p>Individual 6</p>
</dd>
<dt>7</dt><dd><p>Individual 7</p>
</dd>
<dt>8</dt><dd><p>Individual 8</p>
</dd>
<dt>9</dt><dd><p>Individual 9</p>
</dd>
<dt>10</dt><dd><p>Individual 10</p>
</dd>
<dt>14</dt><dd><p>Individual 14</p>
</dd>
<dt>15</dt><dd><p>Individual 15</p>
</dd>
<dt>16</dt><dd><p>Individual 16</p>
</dd>
<dt>17</dt><dd><p>Individual 17</p>
</dd>
<dt>18</dt><dd><p>Individual 18</p>
</dd>
<dt>19</dt><dd><p>Individual 19</p>
</dd>
<dt>21</dt><dd><p>Individual 21</p>
</dd>
<dt>22</dt><dd><p>Individual 22</p>
</dd>
<dt>24</dt><dd><p>Individual 24</p>
</dd>
<dt>26</dt><dd><p>Individual 26</p>
</dd>
<dt>28</dt><dd><p>Individual 28</p>
</dd>
<dt>30</dt><dd><p>Individual 30</p>
</dd>
<dt>31</dt><dd><p>Individual 31</p>
</dd>
<dt>33</dt><dd><p>Individual 33</p>
</dd>
<dt>34</dt><dd><p>Individual 34</p>
</dd>
<dt>35</dt><dd><p>Individual 35</p>
</dd>
<dt>36</dt><dd><p>Individual 36</p>
</dd>
<dt>37</dt><dd><p>Individual 37</p>
</dd>
<dt>38</dt><dd><p>Individual 38</p>
</dd>
<dt>39</dt><dd><p>Individual 39</p>
</dd>
<dt>40</dt><dd><p>Individual 40</p>
</dd>
<dt>41</dt><dd><p>Individual 41</p>
</dd>
<dt>42</dt><dd><p>Individual 42</p>
</dd>
<dt>43</dt><dd><p>Individual 43</p>
</dd>
<dt>44</dt><dd><p>Individual 44</p>
</dd>
<dt>45</dt><dd><p>Individual 45</p>
</dd>
<dt>46</dt><dd><p>Individual 46</p>
</dd>
<dt>47</dt><dd><p>Individual 47</p>
</dd>
<dt>48</dt><dd><p>Individual 48</p>
</dd>
<dt>49</dt><dd><p>Individual 49</p>
</dd>
<dt>50</dt><dd><p>Individual 50</p>
</dd>
<dt>51</dt><dd><p>Individual 51</p>
</dd>
<dt>53</dt><dd><p>Individual 53</p>
</dd>
<dt>54</dt><dd><p>Individual 54</p>
</dd>
<dt>57</dt><dd><p>Individual 57</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-TABM-147&gt;
</p>
<p>&lt;https://github.com/cran/ecp/tree/master/data&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
for (package in c("ggplot2", "gridExtra")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

result &lt;- fastcpd.mean(transcriptome$"10", trim = 0.005)
summary(result)
plot(result)

result_all &lt;- fastcpd.mean(
  transcriptome,
  beta = (ncol(transcriptome) + 1) * log(nrow(transcriptome)) / 2 * 5,
  trim = 0
)

plots &lt;- lapply(
  seq_len(ncol(transcriptome)), function(i) {
    ggplot2::ggplot(
      data = data.frame(
        x = seq_along(transcriptome[, i]), y = transcriptome[, i]
      ),
      ggplot2::aes(x = x, y = y)
    ) +
      ggplot2::geom_line(color = "blue") +
      ggplot2::geom_vline(
        xintercept = result_all@cp_set,
        color = "red",
        linetype = "dotted",
        linewidth = 0.5,
        alpha = 0.7
      ) +
      ggplot2::theme_void()
  }
)

gridExtra::grid.arrange(grobs = plots, ncol = 1, nrow = ncol(transcriptome))

</code></pre>

<hr>
<h2 id='uk_seatbelts'>UK Seatbelts Data</h2><span id='topic+uk_seatbelts'></span>

<h3>Description</h3>

<p>Road Casualties in Great Britain 1969–84.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>uk_seatbelts
</code></pre>


<h3>Format</h3>

<p><code>uk_seatbelts</code> is a multiple time series, with columns
</p>

<dl>
<dt>DriversKilled</dt><dd><p>car drivers killed.</p>
</dd>
<dt>front</dt><dd><p>front-seat passengers killed or seriously injured.</p>
</dd>
<dt>rear</dt><dd><p>rear-seat passengers killed or seriously injured.</p>
</dd>
<dt>kms</dt><dd><p>distance driven.</p>
</dd>
<dt>PetrolPrice</dt><dd><p>petrol price.</p>
</dd>
<dt>VanKilled</dt><dd><p>number of van (‘light goods vehicle’) drivers.</p>
</dd>
<dt>law</dt><dd><p>0/1: was the law in effect that month?</p>
</dd>
</dl>



<h3>Source</h3>

<p>R package <span class="pkg">datasets</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>for (package in c("ggplot2", "lubridate", "zoo")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

result_ar &lt;- fastcpd.ar(diff(uk_seatbelts[, "drivers"], 12), 1, beta = "BIC")
summary(result_ar)
plot(result_ar)

result_lm &lt;- suppressMessages(fastcpd.lm(
  diff(uk_seatbelts[, c("drivers", "kms", "PetrolPrice", "law")], lag = 12)
))
cp_dates &lt;- as.Date("1969-01-01", format = "%Y-%m-%d")
cp_dates &lt;- cp_dates + lubridate::period(month = 1 + result_lm@cp_set + 12)
cp_dates &lt;- zoo::as.yearmon(cp_dates)

uk_seatbelts_df &lt;- data.frame(
  dates = zoo::as.yearmon(time(uk_seatbelts)),
  drivers = c(uk_seatbelts[, "drivers"])
)

ggplot2::ggplot() +
  ggplot2::geom_line(
    data = uk_seatbelts_df,
    mapping = ggplot2::aes(x = dates, y = drivers)
  ) +
  ggplot2::geom_vline(
    xintercept = cp_dates,
    linetype = "dashed",
    color = "red"
  ) +
  zoo::scale_x_yearmon() +
  ggplot2::annotate(
    "text",
    x = cp_dates,
    y = 1025,
    label = as.character(cp_dates),
    color = "blue"
  )
</code></pre>

<hr>
<h2 id='variance_arma'>Variance estimation for ARMA model with change points</h2><span id='topic+variance_arma'></span><span id='topic+variance.arma'></span>

<h3>Description</h3>

<p>Estimate the variance for each block and then take the average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_arma(data, p, q, max_order = p * q)

variance.arma(data, p, q, max_order = p * q)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_arma_+3A_data">data</code></td>
<td>
<p>A one-column matrix or a vector.</p>
</td></tr>
<tr><td><code id="variance_arma_+3A_p">p</code></td>
<td>
<p>The order of the autoregressive part.</p>
</td></tr>
<tr><td><code id="variance_arma_+3A_q">q</code></td>
<td>
<p>The order of the moving average part.</p>
</td></tr>
<tr><td><code id="variance_arma_+3A_max_order">max_order</code></td>
<td>
<p>The maximum order of the AR model to consider.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the variance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(1)
n &lt;- 300
w &lt;- rnorm(n + 3, 0, 10)
x &lt;- rep(0, n + 3)
for (i in 1:200) {
  x[i + 3] &lt;- 0.1 * x[i + 2] - 0.3 * x[i + 1] + 0.1 * x[i] +
    0.1 * w[i + 2] + 0.5 * w[i + 1] + w[i + 3]
}
for (i in 201:n) {
  x[i + 3] &lt;- 0.3 * x[i + 2] + 0.1 * x[i + 1] - 0.3 * x[i] -
    0.6 * w[i + 2] - 0.1 * w[i + 1] + w[i + 3]
}
(result &lt;- variance.arma(x[-seq_len(3)], p = 3, q = 2))
</code></pre>

<hr>
<h2 id='variance_lm'>Variance estimation for linear models with change points</h2><span id='topic+variance_lm'></span><span id='topic+variance.lm'></span>

<h3>Description</h3>

<p>Estimate the variance for each block and then take the average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_lm(data, d = 1, block_size = ncol(data) - d + 1, outlier_iqr = Inf)

variance.lm(data, d = 1, block_size = ncol(data) - d + 1, outlier_iqr = Inf)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_lm_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with the response variable as the first
column.</p>
</td></tr>
<tr><td><code id="variance_lm_+3A_d">d</code></td>
<td>
<p>The dimension of the response variable.</p>
</td></tr>
<tr><td><code id="variance_lm_+3A_block_size">block_size</code></td>
<td>
<p>The size of the blocks to use for variance estimation.</p>
</td></tr>
<tr><td><code id="variance_lm_+3A_outlier_iqr">outlier_iqr</code></td>
<td>
<p>The number of interquartile ranges to use as a threshold
for outlier detection.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the variance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
n &lt;- 300
p &lt;- 4
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta &lt;- rbind(c(1, 3.2, -1, 0), c(-1, -0.5, 2.5, -2), c(0.8, 0, 1, 2))
y &lt;- c(
  x[1:100, ] %*% theta[1, ] + rnorm(100, 0, 3),
  x[101:200, ] %*% theta[2, ] + rnorm(100, 0, 3),
  x[201:300, ] %*% theta[3, ] + rnorm(100, 0, 3)
)
(sigma2 &lt;- variance.lm(cbind(y, x)))

set.seed(1)
n &lt;- 300
p &lt;- 4
d &lt;- 2
x &lt;- mvtnorm::rmvnorm(n, rep(0, p), diag(p))
theta &lt;- cbind(c(1, 3.2, -1, 0), c(-1, -0.5, 2.5, -2), c(0.8, 0, 1, 2))
theta &lt;- cbind(theta, theta)
y &lt;- rbind(
  x[1:100, ] %*% theta[, 1:2] + mvtnorm::rmvnorm(100, rep(0, d), 3 * diag(d)),
  x[101:200, ] %*% theta[, 3:4] + mvtnorm::rmvnorm(100, rep(0, d), 3 * diag(d)),
  x[201:300, ] %*% theta[, 5:6] + mvtnorm::rmvnorm(100, rep(0, d), 3 * diag(d))
)
(sigma &lt;- variance.lm(cbind(y, x), d = d))
</code></pre>

<hr>
<h2 id='variance_mean'>Variance estimation for mean change models</h2><span id='topic+variance_mean'></span><span id='topic+variance.mean'></span>

<h3>Description</h3>

<p>Implement Rice estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_mean(data)

variance.mean(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_mean_+3A_data">data</code></td>
<td>
<p>A matrix or a data frame with data points as each row.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix representing the variance-covariance matrix or a numeric
value representing the variance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("mvtnorm", quietly = TRUE)) utils::install.packages(
  "mvtnorm", repos = "https://cloud.r-project.org", quiet = TRUE
)

set.seed(1)
p &lt;- 3
data &lt;- rbind(
  mvtnorm::rmvnorm(300, mean = rep(0, p), sigma = diag(100, p)),
  mvtnorm::rmvnorm(400, mean = rep(50, p), sigma = diag(100, p)),
  mvtnorm::rmvnorm(300, mean = rep(2, p), sigma = diag(100, p))
)
(sigma &lt;- variance.mean(data))
</code></pre>

<hr>
<h2 id='variance_median'>Variance estimation for median change models</h2><span id='topic+variance_median'></span><span id='topic+variance.median'></span>

<h3>Description</h3>

<p>Implement Rice estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variance_median(data)

variance.median(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variance_median_+3A_data">data</code></td>
<td>
<p>A vector of data points.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric value representing the variance.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>(sigma2 &lt;- variance.median(well_log))
</code></pre>

<hr>
<h2 id='well_log'>Well-log Dataset from Numerical Bayesian Methods Applied to Signal Processing</h2><span id='topic+well_log'></span>

<h3>Description</h3>

<p>This is the well-known well-log dataset used in many changepoint papers
obtained from Alan Turing Institute GitHub repository and licensed under
the MIT license. Outliers with value less or equal to 1e5 are removed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>well_log
</code></pre>


<h3>Format</h3>

<p>A Time-Series of length 3989.
</p>


<h3>Source</h3>

<p>&lt;https://github.com/alan-turing-institute/TCPD&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

result &lt;- fastcpd.mean(well_log, trim = 0.003)
summary(result)
plot(result)
if (!requireNamespace("ggplot2", quietly = TRUE)) utils::install.packages(
  "ggplot2", repos = "https://cloud.r-project.org", quiet = TRUE
)

result &lt;- fastcpd.mean(
  well_log, beta = (1 + 2) * log(length(well_log)) / 2 * 6, trim = 0.002
)
summary(result)
plot(result)

for (package in c("ggplot2", "matrixStats")) {
  if (!requireNamespace(package, quietly = TRUE)) utils::install.packages(
    package, repos = "https://cloud.r-project.org", quiet = TRUE
  )
}

sigma2 &lt;- variance.median(well_log)
median_loss &lt;- function(data) {
  sum(abs(data - matrixStats::colMedians(data))) / sqrt(sigma2) / 2
}
result &lt;- fastcpd(
  formula = ~ x - 1,
  data = cbind.data.frame(x = well_log),
  cost = median_loss,
  trim = 0.002
)
summary(result)

segment_starts &lt;- c(1, result@cp_set)
segment_ends &lt;- c(result@cp_set - 1, length(well_log))
residual &lt;- NULL
for (segment_index in seq_along(segment_starts)) {
  segment &lt;- well_log[segment_starts[segment_index]:segment_ends[segment_index]]
  residual &lt;- c(residual, segment - median(segment))
}

p &lt;- ggplot2::ggplot() +
  ggplot2::geom_vline(xintercept = result@cp_set, color = "red") +
  ggplot2::geom_point(
    data = data.frame(
      x = seq_along(well_log), y = c(well_log), label = "well_log"
    ),
    ggplot2::aes(x = x, y = y)
  ) +
  ggplot2::geom_point(
    data = data.frame(
      x = seq_along(residual), y = residual, label = "residuals"
    ),
    ggplot2::aes(x = x, y = y)
  ) +
  ggplot2::facet_wrap("label", nrow = 2, scales = "free_y")
print(p)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
