<!DOCTYPE html><html><head><title>Help for package causalBatch</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {causalBatch}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cb.align.kway_match'><p>K-Way matching</p></a></li>
<li><a href='#cb.align.vm_trim'><p>Vector Matching</p></a></li>
<li><a href='#cb.correct.caus_cComBat'><p>Causal Conditional ComBat</p></a></li>
<li><a href='#cb.detect.caus_cdcorr'><p>Causal Conditional Distance Correlation</p></a></li>
<li><a href='#cb.sims.covar_generator'><p>Covariate generator function</p></a></li>
<li><a href='#cb.sims.get_beta_overlap'><p>Compute overlap of two beta distributions</p></a></li>
<li><a href='#cb.sims.sim_impulse'><p>Impulse Simulation</p></a></li>
<li><a href='#cb.sims.sim_impulse_asycov'><p>Impulse Simulation with Asymmetric Covariates</p></a></li>
<li><a href='#cb.sims.sim_linear'><p>Linear Simulation</p></a></li>
<li><a href='#cb.sims.sim_sigmoid'><p>Sigmoidal Simulation</p></a></li>
<li><a href='#covariate.match'><p>Pairwise covariate matching</p></a></li>
<li><a href='#ohe'><p>A utility to one-hot encode a treatment vector.</p></a></li>
<li><a href='#sigmoid'><p>Sigmoid function</p></a></li>
<li><a href='#zero_one_dist'><p>A utility to compute the zero-one distances for a treatment vector.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Causal Batch Effects</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-03-01</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric W. Bridgeford &lt;ericwb95@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Software which provides numerous functionalities for detecting and removing group-level effects from high-dimensional scientific data which, when combined with additional assumptions, allow for causal conclusions, as-described in our manuscripts Bridgeford et al. (2024) &lt;<a href="https://doi.org/10.1101%2F2021.09.03.458920">doi:10.1101/2021.09.03.458920</a>&gt; and Bridgeford et al. (2023) &lt;<a href="https://doi.org/10.48550/arXiv.2307.13868">doi:10.48550/arXiv.2307.13868</a>&gt;. Also provides a number of useful utilities for generating simulations and balancing covariates across multiple groups/batches of data via matching and propensity trimming for more than two groups.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.2.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>cdcsis, sva, MatchIt, nnet, dplyr, magrittr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/neurodata/causal_batch">https://github.com/neurodata/causal_batch</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>tidyr, knitr, rmarkdown, parallel, testthat (&ge; 3.0.0), covr,
roxygen2, ks, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.0</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-01 10:06:54 UTC; eric</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric W. Bridgeford [aut, cre],
  Michael Powell [ctb],
  Brian Caffo [ctb],
  Joshua T. Vogelstein [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-01 10:32:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='cb.align.kway_match'>K-Way matching</h2><span id='topic+cb.align.kway_match'></span>

<h3>Description</h3>

<p>A function for performing k-way matching using the matchIt package. Looks for samples which have corresponding matches across all other treatment levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.align.kway_match(
  Ts,
  Xs,
  match.form,
  reference = NULL,
  match.args = list(method = "nearest", exact = NULL, replace = FALSE, caliper = 0.1),
  retain.ratio = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.align.kway_match_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
<tr><td><code id="cb.align.kway_match_+3A_xs">Xs</code></td>
<td>
<p><code>[n, r]</code> the <code>r</code> covariates/confounding variables, for each of the <code>n</code> samples, as a data frame with named columns.</p>
</td></tr>
<tr><td><code id="cb.align.kway_match_+3A_match.form">match.form</code></td>
<td>
<p>A formula of columns from <code>Xs</code>, to be passed directly to <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for subsequent matching. See <code>formula</code> argument from <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for details.</p>
</td></tr>
<tr><td><code id="cb.align.kway_match_+3A_reference">reference</code></td>
<td>
<p>the name of the reference/control batch, against which to match. Defaults to <code>NULL</code>, which treats the reference batch as the smallest batch.</p>
</td></tr>
<tr><td><code id="cb.align.kway_match_+3A_match.args">match.args</code></td>
<td>
<p>A named list arguments for the <code><a href="MatchIt.html#topic+matchit">matchit</a></code> function, to be used to specify specific matching strategies, where the list names are arguments and the corresponding values the value to be passed to <code>matchit</code>. Defaults to inexact nearest-neighbor caliper (width 0.1) matching without replacement.</p>
</td></tr>
<tr><td><code id="cb.align.kway_match_+3A_retain.ratio">retain.ratio</code></td>
<td>
<p>If the number of samples retained is less than <code>retain.ratio*n</code>, throws a warning. Defaults to <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>[m]</code> vector consisting of the sample ids of the <code>n</code> original samples that were retained after matching.
</p>


<h3>Details</h3>

<p>For more details see the help vignette:
<code>vignette("causal_balancing", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>
<p>Daniel E. Ho, et al. &quot;MatchIt: Nonparametric Preprocessing for Parametric Causal Inference&quot; JSS (2011).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(causalBatch)
sim &lt;- cb.sims.sim_linear(a=-1, n=100, err=1/8, unbalancedness=1.5)
cb.align.kway_match(sim$Ts, data.frame(Covar=sim$Xs), "Covar")
</code></pre>

<hr>
<h2 id='cb.align.vm_trim'>Vector Matching</h2><span id='topic+cb.align.vm_trim'></span>

<h3>Description</h3>

<p>A function for implementing the vector matching procedure, a pre-processing step for
causal conditional distance correlation. Uses propensity scores to strategically include/exclude
samples from subsequent inference, based on whether (or not) there are samples with similar propensity scores
across all treatment levels (conceptually, a k-way &quot;propensity trimming&quot;). 
It is imperative that this function is used in conjunction with domain expertise to ensure that the covariates are not colliders, 
and that the system satisfies the strong ignorability condiiton to derive causal conclusions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.align.vm_trim(Ts, Xs, retain.ratio = 0.05, ddx = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.align.vm_trim_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
<tr><td><code id="cb.align.vm_trim_+3A_xs">Xs</code></td>
<td>
<p><code>[n, r]</code> the <code>r</code> covariates/confounding variables, for each of the <code>n</code> samples.</p>
</td></tr>
<tr><td><code id="cb.align.vm_trim_+3A_retain.ratio">retain.ratio</code></td>
<td>
<p>If the number of samples retained is less than <code>retain.ratio*n</code>, throws a warning. Defaults to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="cb.align.vm_trim_+3A_ddx">ddx</code></td>
<td>
<p>whether to show additional diagnosis messages. Defaults to <code>FALSE</code>. Can help with debugging if unexpected results are obtained.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>[m]</code> vector containing the indices of samples retained after vector matching.
</p>


<h3>Details</h3>

<p>For more details see the help vignette:
<code>vignette("causal_balancing", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Michael J. Lopez, et al. &quot;Estimation of Causal Effects with Multiple Treatments&quot; Statistical Science (2017). 
ran
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(causalBatch)
sim &lt;- cb.sims.sim_linear(a=-1, n=100, err=1/8, unbalancedness=3)
cb.align.vm_trim(sim$Ts, sim$Xs)

</code></pre>

<hr>
<h2 id='cb.correct.caus_cComBat'>Causal Conditional ComBat</h2><span id='topic+cb.correct.caus_cComBat'></span>

<h3>Description</h3>

<p>A function for implementing the causal conditional ComBat (causal cComBat) algorithm.
This algorithm allows users to remove batch effects (in each dimension), while adjusting for known confounding
variables. It is imperative that this function is used in conjunction with domain
expertise (e.g., to ensure that the covariates are not colliders, and that the system satisfies the strong
ignorability condiiton) to derive causal conclusions. See citation for more details as to the conditions
under which conclusions derived are causal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.correct.caus_cComBat(
  Ys,
  Ts,
  Xs,
  match.form,
  reference = NULL,
  match.args = list(method = "nearest", exact = NULL, replace = FALSE, caliper = 0.1),
  retain.ratio = 0.05
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.correct.caus_cComBat_+3A_ys">Ys</code></td>
<td>
<p>an <code>[n, d]</code> matrix, for the outcome variables with <code>n</code> samples in <code>d</code> dimensions.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_xs">Xs</code></td>
<td>
<p><code>[n, r]</code> the <code>r</code> covariates/confounding variables, for each of the <code>n</code> samples, as a data frame with named columns.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_match.form">match.form</code></td>
<td>
<p>A formula of columns from <code>Xs</code>, to be passed directly to <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for subsequent matching. See <code>formula</code> argument from <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for details.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_reference">reference</code></td>
<td>
<p>the name of the reference/control batch, against which to match. Defaults to <code>NULL</code>, which treats the reference batch as the smallest batch.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_match.args">match.args</code></td>
<td>
<p>A named list arguments for the <code><a href="MatchIt.html#topic+matchit">matchit</a></code> function, to be used to specify specific matching strategies, where the list names are arguments and the corresponding values the value to be passed to <code>matchit</code>. Defaults to inexact nearest-neighbor caliper (width 0.1) matching without replacement.</p>
</td></tr>
<tr><td><code id="cb.correct.caus_cComBat_+3A_retain.ratio">retain.ratio</code></td>
<td>
<p>If the number of samples retained is less than <code>retain.ratio*n</code>, throws a warning. Defaults to <code>0.05</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>

<ul>
<li><p><code>Ys.corrected</code> an <code>[m, d]</code> matrix, for the <code>m</code> retained samples in <code>d</code> dimensions, after correction.
</p>
</li>
<li><p><code>Ts</code> <code>[m]</code> the labels of the <code>m</code> retained samples, with <code>K &lt; n</code> levels.
</p>
</li>
<li><p><code>Xs</code> the <code>r</code> covariates/confounding variables for each of the <code>m</code> retained samples.
</p>
</li>
<li><p><code>Retained.Ids</code> a <code>[m]</code> vector consisting of the sample ids of the <code>n</code> original samples that were retained after matching.
</p>
</li></ul>



<h3>Details</h3>

<p>For more details see the help vignette:
<code>vignette("causal_ccombat", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>
<p>Daniel E. Ho, et al. &quot;MatchIt: Nonparametric Preprocessing for Parametric Causal Inference&quot; JSS (2011).
</p>
<p>W Evan Johnson, et al. &quot;Adjusting batch effects in microarray expression data using empirical Bayes methods&quot; Biostatistics (2007).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(causalBatch)
sim &lt;- cb.sims.sim_linear(a=-1, n=100, err=1/8, unbalancedness=3)
cb.correct.caus_cComBat(sim$Ys, sim$Ts, data.frame(Covar=sim$Xs), "Covar")

</code></pre>

<hr>
<h2 id='cb.detect.caus_cdcorr'>Causal Conditional Distance Correlation</h2><span id='topic+cb.detect.caus_cdcorr'></span>

<h3>Description</h3>

<p>A function for implementing the causal conditional distance correlation (causal cDCorr) algorithm.
This algorithm allows users to identify whether a treatment causes changes in an outcome, given assorted
covariates/confounding variables. It is imperative that this function is used in conjunction with domain
expertise (e.g., to ensure that the covariates are not colliders, and that the system satisfies the strong
ignorability condiiton) to derive causal conclusions. See citation for more details as to the conditions
under which conclusions derived are causal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.detect.caus_cdcorr(
  Ys,
  Ts,
  Xs,
  R = 1000,
  dist.method = "euclidean",
  distance = FALSE,
  seed = 1,
  num.threads = 1,
  retain.ratio = 0.05,
  ddx = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_ys">Ys</code></td>
<td>
<p>Either:
</p>

<ul>
<li><p><code>[n, d]</code> matrix the outcome variables with <code>n</code> samples in <code>d</code> dimensions. In this case, <code>distance</code> should be <code>FALSE</code>.
</p>
</li>
<li><p><code>[n, n]</code> <code>dist</code> object a distance object for the <code>n</code> samples. In this case, <code>distance</code> should be <code>TRUE</code>.
</p>
</li></ul>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_xs">Xs</code></td>
<td>
<p><code>[n, r]</code> the <code>r</code> covariates/confounding variables, for each of the <code>n</code> samples.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_r">R</code></td>
<td>
<p>the number of repetitions for permutation testing. Defaults to <code>1000</code>.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_dist.method">dist.method</code></td>
<td>
<p>the method used for computing distance matrices. Defaults to <code>"euclidean"</code>. Other options
can be identified by seeing the appropriate documention for the <code>method</code> argument for the <code><a href="stats.html#topic+dist">dist</a></code> function.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_distance">distance</code></td>
<td>
<p>a boolean for whether (or not) <code>Ys</code> are already distance matrices. Defaults to <code>FALSE</code>, which
will use <code>dist.method</code> parameter to compute an <code>[n, n]</code> pairwise distance matrix for <code>Ys</code>.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_seed">seed</code></td>
<td>
<p>a random seed to set. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_num.threads">num.threads</code></td>
<td>
<p>The number of threads for parallel processing (if desired). Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_retain.ratio">retain.ratio</code></td>
<td>
<p>If the number of samples retained is less than <code>retain.ratio*n</code>, throws a warning. Defaults to <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="cb.detect.caus_cdcorr_+3A_ddx">ddx</code></td>
<td>
<p>whether to show additional diagnosis messages. Defaults to <code>FALSE</code>. Can help with debugging if unexpected results are obtained.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>

<ul>
<li><p><code>Test</code> The outcome of the statistical test, from <code><a href="cdcsis.html#topic+cdcov.test">cdcov.test</a></code>.
</p>
</li>
<li><p><code>Retained.Ids</code> The sample indices retained after vertex matching, which correspond to the samples for which statistical inference is performed.
</p>
</li></ul>



<h3>Details</h3>

<p>For more details see the help vignette:
<code>vignette("causal_cdcorr", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>
<p>Eric W. Bridgeford, et al. &quot;Learning sources of variability from high-dimensional observational studies&quot; arXiv (2023).
</p>
<p>Xueqin Wang, et al. &quot;Conditional Distance Correlation&quot; American Statistical Association (2015).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(causalBatch)
sim &lt;- cb.sims.sim_linear(a=-1, n=100, err=1/8, unbalancedness=3)
cb.detect.caus_cdcorr(sim$Ys, sim$Ts, sim$Xs)

</code></pre>

<hr>
<h2 id='cb.sims.covar_generator'>Covariate generator function</h2><span id='topic+cb.sims.covar_generator'></span>

<h3>Description</h3>

<p>Covariate generator function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.covar_generator(batches, a1, b1, a2, b2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.covar_generator_+3A_batches">batches</code></td>
<td>
<p>an <code>n</code> vector, consisting of the batch labels for each of the <code>n</code> samples.</p>
</td></tr>
<tr><td><code id="cb.sims.covar_generator_+3A_a1">a1</code></td>
<td>
<p>alpha of the first covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.covar_generator_+3A_b1">b1</code></td>
<td>
<p>beta of the first covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.covar_generator_+3A_a2">a2</code></td>
<td>
<p>alpha of the second covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.covar_generator_+3A_b2">b2</code></td>
<td>
<p>beta of the second covariate distribution.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>n</code> vector, consisting of the covariate values for each of the <code>n</code> samples.
</p>

<hr>
<h2 id='cb.sims.get_beta_overlap'>Compute overlap of two beta distributions</h2><span id='topic+cb.sims.get_beta_overlap'></span>

<h3>Description</h3>

<p>Compute overlap of two beta distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.get_beta_overlap(a1, b1, a2, b2, nbreaks = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.get_beta_overlap_+3A_a1">a1</code></td>
<td>
<p>alpha of the first covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.get_beta_overlap_+3A_b1">b1</code></td>
<td>
<p>beta of the first covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.get_beta_overlap_+3A_a2">a2</code></td>
<td>
<p>alpha of the second covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.get_beta_overlap_+3A_b2">b2</code></td>
<td>
<p>beta of the second covariate distribution.</p>
</td></tr>
<tr><td><code id="cb.sims.get_beta_overlap_+3A_nbreaks">nbreaks</code></td>
<td>
<p>the number of breakpoints for approximating the covariate overlap.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the level of covariate overlap, corresponding to the AUC upper-bounded
by the probability density functions for each of the beta distributions.
</p>

<hr>
<h2 id='cb.sims.sim_impulse'>Impulse Simulation</h2><span id='topic+cb.sims.sim_impulse'></span>

<h3>Description</h3>

<p>Impulse Simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.sim_impulse(
  n = 100,
  pi = 0.5,
  eff_sz = 1,
  alpha = 2,
  unbalancedness = 1,
  err = 1/2,
  null = FALSE,
  a = -0.5,
  b = 1/2,
  c = 4,
  nbreaks = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.sim_impulse_+3A_n">n</code></td>
<td>
<p>the number of samples. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_pi">pi</code></td>
<td>
<p>the balance between the classes, where samples will be from group 1
with probability <code>pi</code>, and group 2 with probability <code>1 - pi</code>. Defaults
to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_eff_sz">eff_sz</code></td>
<td>
<p>the treatment effect between the different groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_alpha">alpha</code></td>
<td>
<p>the alpha for the covariate sampling procedure. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_unbalancedness">unbalancedness</code></td>
<td>
<p>the level of covariate dissimilarity between the covariates
for each of the groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_err">err</code></td>
<td>
<p>the level of noise for the simulation. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_null">null</code></td>
<td>
<p>whether to generate a null simulation. Defaults to <code>FALSE</code>. Same behavior can be achieved by setting <code>eff_sz = 0</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_a">a</code></td>
<td>
<p>the first parameter for the covariate/outcome relationship. Defaults to <code>-0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_b">b</code></td>
<td>
<p>the second parameter for the covariate/outcome relationship. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_c">c</code></td>
<td>
<p>the third parameter for the covariate/outcome relationship. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_+3A_nbreaks">nbreaks</code></td>
<td>
<p>the number of breakpoints for computing the expected outcome at a given covariate level
for each batch. Defaults to <code>200</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>
<table>
<tr><td><code>Ys</code></td>
<td>
<p>an <code>[n, 2]</code> matrix, containing the outcomes for each sample. The first dimension contains the &quot;treatment effect&quot;.</p>
</td></tr>
<tr><td><code>Ts</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the group/batch labels for each sample.</p>
</td></tr>
<tr><td><code>Xs</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the covariate values for each sample.</p>
</td></tr>
<tr><td><code>Eps</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the error for each sample.</p>
</td></tr>
<tr><td><code>x.bounds</code></td>
<td>
<p>the theoretical bounds for the covariate values.</p>
</td></tr>
<tr><td><code>Ytrue</code></td>
<td>
<p>an <code>[nbreaks*2, 2]</code> matrix, containing the expected outcomes at a covariate level indicated by <code>Xtrue</code>.</p>
</td></tr>
<tr><td><code>Ttrue</code></td>
<td>
<p>an <code>[nbreaks*2,1]</code> matrix, indicating the group/batch the expected outcomes and covariate breakpoints correspond to.</p>
</td></tr>
<tr><td><code>Xtrue</code></td>
<td>
<p>an <code>[nbreaks*2, 1]</code> matrix, indicating the values of the covariate breakpoints for the theoretical expected outcome in <code>Ytrue</code>.</p>
</td></tr>
<tr><td><code>Overlap</code></td>
<td>
<p>the theoretical degree of overlap between the covariate distributions for each of the two groups/batches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sigmoidal relationship between the covariate and the outcome. The first dimension of the outcome is:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = c \times \phi(X_i, \mu = a, \sigma = b) - \text{eff\_sz} \times T_i + \frac{1}{2} \epsilon_i</code>
</p>

<p>where <code class="reqn">\phi(x, \mu, \sigma)</code> is the probability density function for the normal distribution with
mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>
<p>where the batch/group labels are:
</p>
<p style="text-align: center;"><code class="reqn">T_i \overset{iid}{\sim} Bern(\pi)</code>
</p>

<p>The beta coefficient for the covariate sampling is:
</p>
<p style="text-align: center;"><code class="reqn">\beta = \alpha \times \text{unbalancedness}</code>
</p>

<p>The covariate values for the first batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 0 \overset{ind}{\sim} 2 Beta(\alpha, \beta) - 1</code>
</p>

<p>and the covariate values for the second batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 1 \overset{ind}{\sim} 2 Beta(\beta, \alpha) - 1</code>
</p>

<p>Note that <code class="reqn">X_i | T_i = 0 \overset{D}{=} - X_i | T_i = 1</code>, or that the covariates are symmetric
about the origin in distribution.
</p>
<p>Finally, the error terms are:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_i \overset{iid}{\sim} Norm(0, \text{err}^2)</code>
</p>

<p>For more details see the help vignette:
<code>vignette("causal_simulations", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(causalBatch)
sim = cb.sims.sim_impulse()

</code></pre>

<hr>
<h2 id='cb.sims.sim_impulse_asycov'>Impulse Simulation with Asymmetric Covariates</h2><span id='topic+cb.sims.sim_impulse_asycov'></span>

<h3>Description</h3>

<p>Impulse Simulation with Asymmetric Covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.sim_impulse_asycov(
  n = 100,
  pi = 0.5,
  eff_sz = 1,
  alpha = 2,
  unbalancedness = 1,
  null = FALSE,
  a = -0.5,
  b = 1/2,
  c = 4,
  err = 1/2,
  nbreaks = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_n">n</code></td>
<td>
<p>the number of samples. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_pi">pi</code></td>
<td>
<p>the balance between the classes, where samples will be from group 1
with probability <code>pi</code>, and group 2 with probability <code>1 - pi</code>. Defaults
to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_eff_sz">eff_sz</code></td>
<td>
<p>the treatment effect between the different groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_alpha">alpha</code></td>
<td>
<p>the alpha for the covariate sampling procedure. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_unbalancedness">unbalancedness</code></td>
<td>
<p>the level of covariate dissimilarity between the covariates
for each of the groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_null">null</code></td>
<td>
<p>whether to generate a null simulation. Defaults to <code>FALSE</code>. Same behavior can be achieved by setting <code>eff_sz = 0</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_a">a</code></td>
<td>
<p>the first parameter for the covariate/outcome relationship. Defaults to <code>-0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_b">b</code></td>
<td>
<p>the second parameter for the covariate/outcome relationship. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_c">c</code></td>
<td>
<p>the third parameter for the covariate/outcome relationship. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_err">err</code></td>
<td>
<p>the level of noise for the simulation. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_impulse_asycov_+3A_nbreaks">nbreaks</code></td>
<td>
<p>the number of breakpoints for computing the expected outcome at a given covariate level
for each batch. Defaults to <code>200</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>
<table>
<tr><td><code>Ys</code></td>
<td>
<p>an <code>[n, 2]</code> matrix, containing the outcomes for each sample. The first dimension contains the &quot;treatment effect&quot;.</p>
</td></tr>
<tr><td><code>Ts</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the group/batch labels for each sample.</p>
</td></tr>
<tr><td><code>Xs</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the covariate values for each sample.</p>
</td></tr>
<tr><td><code>Eps</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the error for each sample.</p>
</td></tr>
<tr><td><code>x.bounds</code></td>
<td>
<p>the theoretical bounds for the covariate values.</p>
</td></tr>
<tr><td><code>Ytrue</code></td>
<td>
<p>an <code>[nbreaks*2, 2]</code> matrix, containing the expected outcomes at a covariate level indicated by <code>Xtrue</code>.</p>
</td></tr>
<tr><td><code>Ttrue</code></td>
<td>
<p>an <code>[nbreaks*2,1]</code> matrix, indicating the group/batch the expected outcomes and covariate breakpoints correspond to.</p>
</td></tr>
<tr><td><code>Xtrue</code></td>
<td>
<p>an <code>[nbreaks*2, 1]</code> matrix, indicating the values of the covariate breakpoints for the theoretical expected outcome in <code>Ytrue</code>.</p>
</td></tr>
<tr><td><code>Overlap</code></td>
<td>
<p>the theoretical degree of overlap between the covariate distributions for each of the two groups/batches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sigmoidal relationship between the covariate and the outcome. The first dimension of the outcome is:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = c \times \phi(X_i, \mu = a, \sigma = b) - \text{eff\_sz} \times T_i + \frac{1}{2} \epsilon_i</code>
</p>

<p>where <code class="reqn">\phi(x, \mu, \sigma)</code> is the probability density function for the normal distribution with
mean <code class="reqn">\mu</code> and standard deviation <code class="reqn">\sigma</code>.
</p>
<p>where the batch/group labels are:
</p>
<p style="text-align: center;"><code class="reqn">T_i \overset{iid}{\sim} Bern(\pi)</code>
</p>

<p>The beta coefficient for the covariate sampling is:
</p>
<p style="text-align: center;"><code class="reqn">\beta = \alpha \times \text{unbalancedness}</code>
</p>

<p>The covariate values for the first batch are asymmetric, in that for the first batch:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 0 \overset{ind}{\sim} 2 Beta(\alpha, \alpha) - 1</code>
</p>

<p>and the covariate values for the second batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 1 \overset{ind}{\sim} 2 Beta(\beta, \alpha) - 1</code>
</p>

<p>Finally, the error terms are:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_i \overset{iid}{\sim} Norm(0, \text{err}^2)</code>
</p>

<p>For more details see the help vignette:
<code>vignette("causal_simulations", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(causalBatch)
sim = cb.sims.sim_impulse_asycov()

</code></pre>

<hr>
<h2 id='cb.sims.sim_linear'>Linear Simulation</h2><span id='topic+cb.sims.sim_linear'></span>

<h3>Description</h3>

<p>Linear Simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.sim_linear(
  n = 100,
  pi = 0.5,
  eff_sz = 1,
  alpha = 2,
  unbalancedness = 1,
  err = 1/2,
  null = FALSE,
  a = -2,
  b = -1,
  nbreaks = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.sim_linear_+3A_n">n</code></td>
<td>
<p>the number of samples. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_pi">pi</code></td>
<td>
<p>the balance between the classes, where samples will be from group 1
with probability <code>pi</code>, and group 2 with probability <code>1 - pi</code>. Defaults
to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_eff_sz">eff_sz</code></td>
<td>
<p>the treatment effect between the different groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_alpha">alpha</code></td>
<td>
<p>the alpha for the covariate sampling procedure. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_unbalancedness">unbalancedness</code></td>
<td>
<p>the level of covariate dissimilarity between the covariates
for each of the groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_err">err</code></td>
<td>
<p>the level of noise for the simulation. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_null">null</code></td>
<td>
<p>whether to generate a null simulation. Defaults to <code>FALSE</code>. Same behavior can be achieved by setting <code>eff_sz = 0</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_a">a</code></td>
<td>
<p>the first parameter for the covariate/outcome relationship. Defaults to <code>-2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_b">b</code></td>
<td>
<p>the second parameter for the covariate/outcome relationship. Defaults to <code>-1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_linear_+3A_nbreaks">nbreaks</code></td>
<td>
<p>the number of breakpoints for computing the expected outcome at a given covariate level
for each batch. Defaults to <code>200</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>
<table>
<tr><td><code>Ys</code></td>
<td>
<p>an <code>[n, 2]</code> matrix, containing the outcomes for each sample. The first dimension contains the &quot;treatment effect&quot;.</p>
</td></tr>
<tr><td><code>Ts</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the group/batch labels for each sample.</p>
</td></tr>
<tr><td><code>Xs</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the covariate values for each sample.</p>
</td></tr>
<tr><td><code>Eps</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the error for each sample.</p>
</td></tr>
<tr><td><code>x.bounds</code></td>
<td>
<p>the theoretical bounds for the covariate values.</p>
</td></tr>
<tr><td><code>Ytrue</code></td>
<td>
<p>an <code>[nbreaks*2, 2]</code> matrix, containing the expected outcomes at a covariate level indicated by <code>Xtrue</code>.</p>
</td></tr>
<tr><td><code>Ttrue</code></td>
<td>
<p>an <code>[nbreaks*2,1]</code> matrix, indicating the group/batch the expected outcomes and covariate breakpoints correspond to.</p>
</td></tr>
<tr><td><code>Xtrue</code></td>
<td>
<p>an <code>[nbreaks*2, 1]</code> matrix, indicating the values of the covariate breakpoints for the theoretical expected outcome in <code>Ytrue</code>.</p>
</td></tr>
<tr><td><code>Overlap</code></td>
<td>
<p>the theoretical degree of overlap between the covariate distributions for each of the two groups/batches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A linear relationship between the covariate and the outcome. The first dimension of the outcome is:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = a\times (X_i + b) - \text{eff\_sz} \times T_i + \frac{1}{2} \epsilon_i</code>
</p>

<p>where the batch/group labels are:
</p>
<p style="text-align: center;"><code class="reqn">T_i \overset{iid}{\sim} Bern(\pi)</code>
</p>

<p>The beta coefficient for the covariate sampling is:
</p>
<p style="text-align: center;"><code class="reqn">\beta = \alpha \times \text{unbalancedness}</code>
</p>

<p>The covariate values for the first batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 0 \overset{ind}{\sim} 2 Beta(\alpha, \beta) - 1</code>
</p>

<p>and the covariate values for the second batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 1 \overset{ind}{\sim} 2 Beta(\beta, \alpha) - 1</code>
</p>

<p>Finally, the error terms are:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_i \overset{iid}{\sim} Norm(0, \text{err}^2)</code>
</p>

<p>For more details see the help vignette:
<code>vignette("causal_simulations", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(causalBatch)
sim = cb.sims.sim_linear()

</code></pre>

<hr>
<h2 id='cb.sims.sim_sigmoid'>Sigmoidal Simulation</h2><span id='topic+cb.sims.sim_sigmoid'></span>

<h3>Description</h3>

<p>Sigmoidal Simulation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cb.sims.sim_sigmoid(
  n = 100,
  pi = 0.5,
  eff_sz = 1,
  alpha = 2,
  unbalancedness = 1,
  null = FALSE,
  a = -4,
  b = 8,
  err = 1/2,
  nbreaks = 200
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_n">n</code></td>
<td>
<p>the number of samples. Defaults to <code>100</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_pi">pi</code></td>
<td>
<p>the balance between the classes, where samples will be from group 1
with probability <code>pi</code>, and group 2 with probability <code>1 - pi</code>. Defaults
to <code>0.5</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_eff_sz">eff_sz</code></td>
<td>
<p>the treatment effect between the different groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_alpha">alpha</code></td>
<td>
<p>the alpha for the covariate sampling procedure. Defaults to <code>2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_unbalancedness">unbalancedness</code></td>
<td>
<p>the level of covariate dissimilarity between the covariates
for each of the groups. Defaults to <code>1</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_null">null</code></td>
<td>
<p>whether to generate a null simulation. Defaults to <code>FALSE</code>. Same behavior can be achieved by setting <code>eff_sz = 0</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_a">a</code></td>
<td>
<p>the first parameter for the covariate/outcome relationship. Defaults to <code>-4</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_b">b</code></td>
<td>
<p>the second parameter for the covariate/outcome relationship. Defaults to <code>8</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_err">err</code></td>
<td>
<p>the level of noise for the simulation. Defaults to <code>1/2</code>.</p>
</td></tr>
<tr><td><code id="cb.sims.sim_sigmoid_+3A_nbreaks">nbreaks</code></td>
<td>
<p>the number of breakpoints for computing the expected outcome at a given covariate level
for each batch. Defaults to <code>200</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list, containing the following:
</p>
<table>
<tr><td><code>Y</code></td>
<td>
<p>an <code>[n, 2]</code> matrix, containing the outcomes for each sample. The first dimension contains the &quot;treatment effect&quot;.</p>
</td></tr>
<tr><td><code>Ts</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the group/batch labels for each sample.</p>
</td></tr>
<tr><td><code>Xs</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the covariate values for each sample.</p>
</td></tr>
<tr><td><code>Eps</code></td>
<td>
<p>an <code>[n, 1]</code> matrix, containing the error for each sample.</p>
</td></tr>
<tr><td><code>x.bounds</code></td>
<td>
<p>the theoretical bounds for the covariate values.</p>
</td></tr>
<tr><td><code>Ytrue</code></td>
<td>
<p>an <code>[nbreaks*2, 2]</code> matrix, containing the expected outcomes at a covariate level indicated by <code>Xtrue</code>.</p>
</td></tr>
<tr><td><code>Ttrue</code></td>
<td>
<p>an <code>[nbreaks*2,1]</code> matrix, indicating the group/batch the expected outcomes and covariate breakpoints correspond to.</p>
</td></tr>
<tr><td><code>Xtrue</code></td>
<td>
<p>an <code>[nbreaks*2, 1]</code> matrix, indicating the values of the covariate breakpoints for the theoretical expected outcome in <code>Ytrue</code>.</p>
</td></tr>
<tr><td><code>Overlap</code></td>
<td>
<p>the theoretical degree of overlap between the covariate distributions for each of the two groups/batches.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A sigmoidal relationship between the covariate and the outcome. The first dimension of the outcome is:
</p>
<p style="text-align: center;"><code class="reqn">Y_i = a\times \text{sigmoid}(b \times X_i) - a - \text{eff\_sz} \times T_i + \frac{1}{2} \epsilon_i</code>
</p>

<p>where the batch/group labels are:
</p>
<p style="text-align: center;"><code class="reqn">T_i \overset{iid}{\sim} Bern(\pi)</code>
</p>

<p>The beta coefficient for the covariate sampling is:
</p>
<p style="text-align: center;"><code class="reqn">\beta = \alpha \times \text{unbalancedness}</code>
</p>

<p>The covariate values for the first batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 0 \overset{ind}{\sim} 2 Beta(\alpha, \beta) - 1</code>
</p>

<p>and the covariate values for the second batch are:
</p>
<p style="text-align: center;"><code class="reqn">X_i | T_i = 1 \overset{ind}{\sim} 2 Beta(\beta, \alpha) - 1</code>
</p>

<p>Finally, the error terms are:
</p>
<p style="text-align: center;"><code class="reqn">\epsilon_i \overset{iid}{\sim} Norm(0, \text{err}^2)</code>
</p>

<p>For more details see the help vignette:
<code>vignette("causal_simulations", package = "causalBatch")</code>
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>


<h3>References</h3>

<p>Eric W. Bridgeford, et al. &quot;A Causal Perspective for Batch Effects: When is no answer better than a wrong answer?&quot; Biorxiv (2024).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
library(causalBatch)
sim = cb.sims.sim_sigmoid()

</code></pre>

<hr>
<h2 id='covariate.match'>Pairwise covariate matching</h2><span id='topic+covariate.match'></span>

<h3>Description</h3>

<p>Pairwise covariate matching
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covariate.match(covar.tx, covar.cont, match.form, match.args = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="covariate.match_+3A_covar.tx">covar.tx</code></td>
<td>
<p>the treatment covariate/label matrix.</p>
</td></tr>
<tr><td><code id="covariate.match_+3A_covar.cont">covar.cont</code></td>
<td>
<p>the control covariate/label matrix.</p>
</td></tr>
<tr><td><code id="covariate.match_+3A_match.form">match.form</code></td>
<td>
<p>A formula of columns from <code>Xs</code>, to be passed directly to <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for subsequent matching. See <code>formula</code> argument from <code><a href="MatchIt.html#topic+matchit">matchit</a></code> for details.</p>
</td></tr>
<tr><td><code id="covariate.match_+3A_match.args">match.args</code></td>
<td>
<p>A named list arguments for the <code><a href="MatchIt.html#topic+matchit">matchit</a></code> function, to be used to specify specific matching strategies, where the list names are arguments and the corresponding values the value to be passed to <code>matchit</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing:
</p>

<ul>
<li><p><code>I.mat.k</code> index matrix of control samples that have a match.
</p>
</li>
<li><p><code>M.mat.k</code> match matrix of treatment samples that are correspondingly matched to a control.
</p>
</li></ul>


<hr>
<h2 id='ohe'>A utility to one-hot encode a treatment vector.</h2><span id='topic+ohe'></span>

<h3>Description</h3>

<p>A utility to one-hot encode a treatment vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ohe(Ts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ohe_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>[n, K]</code> a one-hot encoding of <code>Ts</code>.
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>

<hr>
<h2 id='sigmoid'>Sigmoid function</h2><span id='topic+sigmoid'></span>

<h3>Description</h3>

<p>Sigmoid function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sigmoid(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sigmoid_+3A_x">x</code></td>
<td>
<p>the value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sigmoid(x)
</p>

<hr>
<h2 id='zero_one_dist'>A utility to compute the zero-one distances for a treatment vector.</h2><span id='topic+zero_one_dist'></span>

<h3>Description</h3>

<p>A utility to compute the zero-one distances for a treatment vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>zero_one_dist(Ts)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="zero_one_dist_+3A_ts">Ts</code></td>
<td>
<p><code>[n]</code> the labels of the samples, with <code>K &lt; n</code> levels, as a factor variable.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>[n, n]</code> the pairwise zero-one distance matrix.
</p>


<h3>Author(s)</h3>

<p>Eric W. Bridgeford
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
