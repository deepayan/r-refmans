<!DOCTYPE html><html lang="en"><head><title>Help for package sdtmval</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {sdtmval}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#sdtmval-package'><p>sdtmval: Validate SDTM Domains</p></a></li>
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#assign_meta_data'><p>Assign meta data to columns in a SDTM table based on specification file</p></a></li>
<li><a href='#assign_SEQ'><p>Assign SEQ numbers for a SDTM data set</p></a></li>
<li><a href='#calc_DY'><p>Calculate a DY variable (day of study)</p></a></li>
<li><a href='#convert_to_script'><p>Convert SDTM QC code from a .Rmd file to .R script</p></a></li>
<li><a href='#create_BLFL'><p>Create a BLFL column</p></a></li>
<li><a href='#create_EPOCH'><p>Create the EPOCH variable</p></a></li>
<li><a href='#create_STAT'><p>Assign STAT 'NOT DONE' status</p></a></li>
<li><a href='#dm'><p>Example SDTM Domain 'DM'</p></a></li>
<li><a href='#edc_xx'><p>Example EDC data for form/table 'XX'</p></a></li>
<li><a href='#format_chars_and_dates'><p>Format date and character columns for SDTM tables</p></a></li>
<li><a href='#get_codelist'><p>Read in the code list from the specification for a specific domain</p></a></li>
<li><a href='#get_data_spec'><p>Read in the variable specification sheet for a SDTM data set</p></a></li>
<li><a href='#get_key_vars'><p>Read in the key variables for a SDTM domain</p></a></li>
<li><a href='#impute_pdates'><p>Impute start or end dates</p></a></li>
<li><a href='#read_edc_tbls'><p>Import EDC data tables</p></a></li>
<li><a href='#read_sdtm_tbls'><p>Import SDTM data tables</p></a></li>
<li><a href='#reshape_adates'><p>Reshape format of all dates (full and partial)</p></a></li>
<li><a href='#reshape_pdates'><p>Reshape format of partial dates</p></a></li>
<li><a href='#spec_codelists'><p>Example 'Codelists' tab from a SDTM specification .xlsx file</p></a></li>
<li><a href='#spec_datasets'><p>Example 'Datasets' tab from a SDTM specification .xlsx file</p></a></li>
<li><a href='#spec_XX'><p>Example domain specific tab from a SDTM specification .xlsx file</p></a></li>
<li><a href='#trim_and_make_blanks_NA'><p>Trim white space and make blanks NA</p></a></li>
<li><a href='#trim_dates'><p>Trim unknown elements in partial dates</p></a></li>
<li><a href='#vd'><p>Example EDC data for form/table 'VD'</p></a></li>
<li><a href='#write_sessionInfo'><p>Write R session information for a script to a .txt file</p></a></li>
<li><a href='#write_tbl_to_xpt'><p>Write a SAS transport file (.xpt)</p></a></li>
<li><a href='#xx_no_meta_data'><p>Example SDTM domain table XX without meta data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Validate SDTM Domains</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a set of tools to assist statistical programmers 
    in validating Study Data Tabulation Model (SDTM) domain data sets. 
    Statistical programmers are required to validate that a SDTM data set domain 
    has been programmed correctly, per the SDTM Implementation Guide (SDTMIG) by 
    'CDISC' (<a href="https://www.cdisc.org/standards/foundational/sdtmig">https://www.cdisc.org/standards/foundational/sdtmig</a>), 
    study specification, and study protocol using a process called double 
    programming. Double programming involves two different programmers 
    independently converting the raw electronic data cut (EDC) data into a SDTM 
    domain data table and comparing their results to ensure accurate 
    standardization of the data. One of these attempts is termed 'production' 
    and the other 'validation'. Generally, production runs are the official 
    programs for submittals and these are written in 'SAS'. Validation runs can 
    be programmed in another language, in this case 'R'. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/skgithub14/sdtmval">https://github.com/skgithub14/sdtmval</a>,
<a href="https://skgithub14.github.io/sdtmval/">https://skgithub14.github.io/sdtmval/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/skgithub14/sdtmval/issues">https://github.com/skgithub14/sdtmval/issues</a></td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, glue, haven, knitr, lubridate, magrittr, purrr, readxl,
rlang, stats, stringr, tidyr, tidyselect, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-20 17:23:43 UTC; sknapp</td>
</tr>
<tr>
<td>Author:</td>
<td>Stephen Knapp <a href="https://orcid.org/0000-0002-5101-4555"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stephen Knapp &lt;stephen@knappconsultingllc.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-23 16:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='sdtmval-package'>sdtmval: Validate SDTM Domains</h2><span id='topic+sdtmval'></span><span id='topic+sdtmval-package'></span>

<h3>Description</h3>

<p><img src="../help/figures/logo.png" style='float: right' alt='logo' width='120' />
</p>
<p>Provides a set of tools to assist statistical programmers in validating Study Data Tabulation Model (SDTM) domain data sets. Statistical programmers are required to validate that a SDTM data set domain has been programmed correctly, per the SDTM Implementation Guide (SDTMIG) by 'CDISC' (<a href="https://www.cdisc.org/standards/foundational/sdtmig">https://www.cdisc.org/standards/foundational/sdtmig</a>), study specification, and study protocol using a process called double programming. Double programming involves two different programmers independently converting the raw electronic data cut (EDC) data into a SDTM domain data table and comparing their results to ensure accurate standardization of the data. One of these attempts is termed 'production' and the other 'validation'. Generally, production runs are the official programs for submittals and these are written in 'SAS'. Validation runs can be programmed in another language, in this case 'R'.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Stephen Knapp <a href="mailto:stephen@knappconsultingllc.com">stephen@knappconsultingllc.com</a> (<a href="https://orcid.org/0000-0002-5101-4555">ORCID</a>) [copyright holder]
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/skgithub14/sdtmval">https://github.com/skgithub14/sdtmval</a>
</p>
</li>
<li> <p><a href="https://skgithub14.github.io/sdtmval/">https://skgithub14.github.io/sdtmval/</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/skgithub14/sdtmval/issues">https://github.com/skgithub14/sdtmval/issues</a>
</p>
</li></ul>


<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_lhs">lhs</code></td>
<td>
<p>A value or the magrittr placeholder.</p>
</td></tr>
<tr><td><code id="+2B25+2B26gt+2B3B+2B25_+3A_rhs">rhs</code></td>
<td>
<p>A function call using the magrittr semantics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The result of calling <code>rhs(lhs)</code>.
</p>

<hr>
<h2 id='assign_meta_data'>Assign meta data to columns in a SDTM table based on specification file</h2><span id='topic+assign_meta_data'></span>

<h3>Description</h3>

<p>Trims the length of each text and date variable to the length specified in
the spec and then assigns the attributes <code>"label"</code> and <code>"width"</code> to each
column.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_meta_data(
  tbl,
  spec,
  datatype_col = "Data Type",
  var_col = "Variable",
  length_col = "Length",
  label_col = "Label"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign_meta_data_+3A_tbl">tbl</code></td>
<td>
<p>a data frame containing a SDTM table</p>
</td></tr>
<tr><td><code id="assign_meta_data_+3A_spec">spec</code></td>
<td>
<p>a data frame with the columns <code>"Variable"</code> which has a value for
each column in <code>tbl</code>, <code>"Data Type"</code> which specifies data types by column,
<code>"Length"</code> which specifies the character limit for each column, and <code>"Label"</code>
which specifies the label for each column</p>
</td></tr>
<tr><td><code id="assign_meta_data_+3A_datatype_col">datatype_col</code></td>
<td>
<p>a string, the column in <code>spec</code> that contains the data
types (which should include the values <code>"text"</code> and <code>"date"</code>); default is
<code>"Data Type"</code></p>
</td></tr>
<tr><td><code id="assign_meta_data_+3A_var_col">var_col</code></td>
<td>
<p>a string, the column in <code>spec</code> that contains the domain
variable names</p>
</td></tr>
<tr><td><code id="assign_meta_data_+3A_length_col">length_col</code></td>
<td>
<p>a string, the column in <code>spec</code> that contains the character
count limits for each variable</p>
</td></tr>
<tr><td><code id="assign_meta_data_+3A_label_col">label_col</code></td>
<td>
<p>a string, the column in <code>spec</code> that contains the labels for
each variable</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified copy of <code>tbl</code> with the meta data per specification
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_spec">get_data_spec()</a></code>, <code><a href="#topic+get_key_vars">get_key_vars()</a></code>, <code><a href="#topic+get_codelist">get_codelist()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>work_dir &lt;- system.file("extdata", package = "sdtmval")
spec &lt;- get_data_spec(domain = "XX",
                      dir = work_dir,
                      filename = "spec.xlsx")
after_meta_data &lt;- assign_meta_data(sdtmval::xx_no_meta_data, spec = spec)
labels &lt;- colnames(after_meta_data) |&gt;
  purrr::map(~ attr(after_meta_data[[.]], "label")) |&gt;
  unlist()
lengths &lt;- colnames(after_meta_data) |&gt;
  purrr::map(~ attr(after_meta_data[[.]], "width")) |&gt;
  unlist()
data.frame(
  column = colnames(after_meta_data),
  labels = labels,
  lengths = lengths
)

</code></pre>

<hr>
<h2 id='assign_SEQ'>Assign SEQ numbers for a SDTM data set</h2><span id='topic+assign_SEQ'></span>

<h3>Description</h3>

<p>Assigns the <code>"[DOMAIN]SEQ"</code> number by sorting the data set by the specified
variables and then grouping by <code>"USUBJID"</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>assign_SEQ(tbl, key_vars, seq_prefix, USUBJID = "USUBJID")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="assign_SEQ_+3A_tbl">tbl</code></td>
<td>
<p>a data frame, the SDTM table</p>
</td></tr>
<tr><td><code id="assign_SEQ_+3A_key_vars">key_vars</code></td>
<td>
<p>a character vector of the key variables to sort by</p>
</td></tr>
<tr><td><code id="assign_SEQ_+3A_seq_prefix">seq_prefix</code></td>
<td>
<p>a string, the prefix for SEQ as per the spec (usually the
two letter domain abbreviation)</p>
</td></tr>
<tr><td><code id="assign_SEQ_+3A_usubjid">USUBJID</code></td>
<td>
<p>a string, the column for the subject ID, USUBJID, default is
<code>"USUBJID"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a sorted copy of the <code>tbl</code> data frame with the new SEQ column
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  USUBJID = paste("Subject", c(rep(1, 3), rep(2, 3))),
  XXTESTCD = paste("T", rep(c(2, 3, 1), 2))
)
assign_SEQ(df, key_vars = c("USUBJID", "XXTESTCD"), seq_prefix = "XX")

</code></pre>

<hr>
<h2 id='calc_DY'>Calculate a DY variable (day of study)</h2><span id='topic+calc_DY'></span>

<h3>Description</h3>

<p>Utilizes the DY method from the SDTM spec: <code>--DTC-RFSTDTC+1</code> if <code>--DTC</code> is on
or after RFSTDTC. <code>--DTC-RFSTDTC</code> if <code>--DTC</code> precedes <code>RFSTDTC</code>. This
function can also be used for the ENDY method from the spec which has the
same logic.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc_DY(tbl, DY_col, DTC_col, RFSTDTC = "RFSTDTC")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc_DY_+3A_tbl">tbl</code></td>
<td>
<p>a data frame with the date column <code>RFSTDTC</code> and the column
specified by the <code>DTC_col</code> argument</p>
</td></tr>
<tr><td><code id="calc_DY_+3A_dy_col">DY_col</code></td>
<td>
<p>string, the name of the new DY column to create</p>
</td></tr>
<tr><td><code id="calc_DY_+3A_dtc_col">DTC_col</code></td>
<td>
<p>string, the column in <code>tbl</code> which has the dates for which to
calculated the DY value; should either already have a date class or be a
character vector in the format YYYY-MM-DD</p>
</td></tr>
<tr><td><code id="calc_DY_+3A_rfstdtc">RFSTDTC</code></td>
<td>
<p>a string, the column to use for <code>RFSTDTC</code>, default is
<code>"RFSTDTC"</code>; should either already have a date class or be a
character vector in the format YYYY-MM-DD</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified copy of <code>tbl</code> with the new DY column
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_BLFL">create_BLFL()</a></code>, <code><a href="#topic+create_EPOCH">create_EPOCH()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  DTC = c("2023-08-01", "2023-08-02", "2023-08-03", "2023-08-04"),
  RFSTDTC = rep("2023-08-02", 4)
)
calc_DY(df, DY_col = "XXDY", DTC_col = "DTC")

</code></pre>

<hr>
<h2 id='convert_to_script'>Convert SDTM QC code from a .Rmd file to .R script</h2><span id='topic+convert_to_script'></span>

<h3>Description</h3>

<p>Wraps <code><a href="knitr.html#topic+knit">knitr::purl()</a></code> to create an .R script from a .Rmd file. It can also
auto-archive the .Rmd file to a <code style="white-space: pre;">&#8288;[dir]/archive&#8288;</code> sub-directory. This is useful
for turning first-attempt exploratory data analysis into production scripts
once the validation code is complete.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convert_to_script(filename, dir = NULL, archive = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert_to_script_+3A_filename">filename</code></td>
<td>
<p>string, the file name of both the .Rmd file that will be read
and the file name of the .R file to be written (do not include .Rmd or .R
extension)</p>
</td></tr>
<tr><td><code id="convert_to_script_+3A_dir">dir</code></td>
<td>
<p>string, the directory where the .Rmd file is and the .R file will
be written, default is <code>NULL</code> which means the current working directory
will be used</p>
</td></tr>
<tr><td><code id="convert_to_script_+3A_archive">archive</code></td>
<td>
<p>logical, whether to auto-archive the .Rmd file; default is
<code>FALSE</code></p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The resulting script will take the same name as the .Rmd file but with a
different extension (.R)
</p>
</li>
<li><p> If <code style="white-space: pre;">&#8288;[dir]/archive&#8288;</code> does not already exist, it will be created
</p>
</li></ul>



<h3>Value</h3>

<p>nothing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write_sessionInfo">write_sessionInfo()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># get test notebook from the sdtmval/inst/extdata dir and copy it to temp dir
test_file_dir &lt;- system.file("extdata", package = "sdtmval")
filename &lt;- "test_notebook"
temp_path &lt;- tempdir()
file.copy(from = file.path(test_file_dir, paste0(filename, ".Rmd")),
          to = file.path(temp_path, paste0(filename, ".Rmd")))

# create the script and archive the .Rmd file
convert_to_script(dir = temp_path, filename = filename, archive = TRUE)

</code></pre>

<hr>
<h2 id='create_BLFL'>Create a BLFL column</h2><span id='topic+create_BLFL'></span>

<h3>Description</h3>

<p>Utilizes the BLFL method from the SDTM spec to create a baseline flag: Equal
to &quot;Y&quot; for last record with non-missing &ndash;ORRES on or before first dose date
(RFSTDTC); <code>NA</code> otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_BLFL(
  tbl,
  sort_date,
  domain,
  grouping_vars = "USUBJID",
  RFSTDTC = "RFSTDTC",
  compare_date_method = "on or before"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_BLFL_+3A_tbl">tbl</code></td>
<td>
<p>a data frame with the variables <code>USUBJID</code>, <code style="white-space: pre;">&#8288;[domain]ORRES&#8288;</code>,
<code>RFSTDTC</code>, and to column specified in the <code>sort_date</code> argument</p>
</td></tr>
<tr><td><code id="create_BLFL_+3A_sort_date">sort_date</code></td>
<td>
<p>a string, the column name by which to sort records within
each <code>USUBJID</code> entry before assigning the BLFL value. This is also the date
compared against <code>RFSTDTC</code> to determine the BLFL value. This column should
either already have a date class or be a character vector in the format
YYYY-MM-DD</p>
</td></tr>
<tr><td><code id="create_BLFL_+3A_domain">domain</code></td>
<td>
<p>a string, the SDTM domain abbreviation</p>
</td></tr>
<tr><td><code id="create_BLFL_+3A_grouping_vars">grouping_vars</code></td>
<td>
<p>a character vector of columns to group by when assigning
the BLFL, default is <code>"USUBJID"</code>. The order of this vector matters.</p>
</td></tr>
<tr><td><code id="create_BLFL_+3A_rfstdtc">RFSTDTC</code></td>
<td>
<p>a string, the column to use for <code>RFSTDTC</code>, default is
<code>"RFSTDTC"</code>; this columns should either have a date class or a characer class
in the YYYY-MM-DD format</p>
</td></tr>
<tr><td><code id="create_BLFL_+3A_compare_date_method">compare_date_method</code></td>
<td>
<p>a string, one of <code>c("on or before", "before")</code>
indicating where the baseline measurement should be evaluated on or before
the study start date or just before; default is <code>"on or before"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified copy of <code>tbl</code> with the new column <code style="white-space: pre;">&#8288;[domain]BLFL&#8288;</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_EPOCH">create_EPOCH()</a></code>, <code><a href="#topic+calc_DY">calc_DY()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- dplyr::tibble(
  USUBJID = c(
    rep(1, 3),
    rep(2, 3)
  ),
  XXORRES = c(
    1, 2, 2,
    1, 2, NA
  ),
  XXDTC = as.Date(c(
    "2017-02-05", "2017-02-06", "2017-02-07",
    "2017-02-05", "2017-02-06", "2017-02-07"
  )),
  RFSTDTC = as.Date(c(
    rep("2017-02-05", 3),
    rep("2017-02-07", 3)
  ))
)
create_BLFL(df, sort_date = "XXDTC", domain = "XX")

</code></pre>

<hr>
<h2 id='create_EPOCH'>Create the EPOCH variable</h2><span id='topic+create_EPOCH'></span>

<h3>Description</h3>

<p>Utilizes the EPOCH method from the SDTM spec: Missing when <code>--DTC</code> is blank;
equal to <code>'SCREENING'</code> if <code>--DTC</code> if before <code>RFXSTDTC</code>; equal to <code>'TREATMENT'</code>
if <code>--DTC</code> is on or after <code>RFXSTDTC</code> and on or before <code>RFXENDTC</code>; equal to
<code>'FOLLOW-UP'</code> if <code>--DTC</code> is after <code>RFXENDTC</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_EPOCH(tbl, date_col, RFXSTDTC = "RFXSTDTC", RFXENDTC = "RFXENDTC")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_EPOCH_+3A_tbl">tbl</code></td>
<td>
<p>a data frame with date class columns <code>RFXSTDTC</code> and <code>RFXENDTC</code> and
the column given in the <code>date_col</code> argument</p>
</td></tr>
<tr><td><code id="create_EPOCH_+3A_date_col">date_col</code></td>
<td>
<p>a string, the column name of the event date used to determine
the EPOCH; this column can either have a date class or a character class in
the YYYY-MM-DD format</p>
</td></tr>
<tr><td><code id="create_EPOCH_+3A_rfxstdtc">RFXSTDTC</code></td>
<td>
<p>a string, the date column to use for <code>RFXSTDTC</code>, default is
<code>"RFXSTDTC"</code>; this column can either have a date class or a character class in
the YYYY-MM-DD format</p>
</td></tr>
<tr><td><code id="create_EPOCH_+3A_rfxendtc">RFXENDTC</code></td>
<td>
<p>a string, the date column to use for <code>RFXENDTC</code>, default is
<code>"RFXENDTC"</code>; this column can either have a date class or a character class in
the YYYY-MM-DD format</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified copy of <code>tbl</code> with the <code>EPOCH</code> column
</p>


<h3>See Also</h3>

<p><code><a href="#topic+create_BLFL">create_BLFL()</a></code>, <code><a href="#topic+calc_DY">calc_DY()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  DTC = c("2023-08-01", "2023-08-02", "2023-08-03", "2023-08-04"),
  RFXSTDTC = rep("2023-08-02", 4),
  RFXENDTC = rep("2023-08-03", 4)
)
create_EPOCH(df, date_col = "DTC")

</code></pre>

<hr>
<h2 id='create_STAT'>Assign STAT 'NOT DONE' status</h2><span id='topic+create_STAT'></span>

<h3>Description</h3>

<p>Creates a &ndash;STAT variable and, if all measurements for a visit were not done,
also changes all &ndash;TESTCD values as &quot;&ndash;ALL&quot;
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_STAT(
  df,
  domain,
  nd_ind,
  nd_ind_cd = "Yes",
  USUBJID = "USUBJID",
  VISIT = "VISIT"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_STAT_+3A_df">df</code></td>
<td>
<p>a data frame to modify</p>
</td></tr>
<tr><td><code id="create_STAT_+3A_domain">domain</code></td>
<td>
<p>a string, the domain abbreviation in all caps</p>
</td></tr>
<tr><td><code id="create_STAT_+3A_nd_ind">nd_ind</code></td>
<td>
<p>a string, the variable name in <code>df</code> that indicates if a test
was not performed, usually a <code>"Yes"</code>/<code>"No"</code> or <code>"Y"</code>/<code>"N"</code> column</p>
</td></tr>
<tr><td><code id="create_STAT_+3A_nd_ind_cd">nd_ind_cd</code></td>
<td>
<p>a string, the code from the <code>nd_ind</code> column that signifies
a test was not done, default is <code>"Yes"</code></p>
</td></tr>
<tr><td><code id="create_STAT_+3A_usubjid">USUBJID</code></td>
<td>
<p>a string, the variable name in <code>df</code> that contains the subject
identifier, default is <code>"USUBJID"</code></p>
</td></tr>
<tr><td><code id="create_STAT_+3A_visit">VISIT</code></td>
<td>
<p>a string, the variable name in <code>df</code> that indicates a VISIT field,
default is <code>"VISIT"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a modified copy of <code>df</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- dplyr::tibble(
  USUBJID = paste("Subject", c(rep("A", 2), rep("B", 4), rep("C", 2))),
  VISIT = paste("Visit", c(1  , 2  , 1  , 1  , 2  , 2  , 2  , 2)),
  XXTESTCD = paste("Test", c(1  , 2  , 1  , 2  , 1  , 2  , 1  , 2)),
  ND = c("N", "N", "Y", "Y", "N", "N", "Y", "Y")
)
create_STAT(df = df, domain = "XX", nd_ind = "ND", nd_ind_cd = "Y")

</code></pre>

<hr>
<h2 id='dm'>Example SDTM Domain 'DM'</h2><span id='topic+dm'></span>

<h3>Description</h3>

<p>This is an example data set to simulate a SDTM production domain 'DM' which
contains study start and end date information by subject. This can be used to
test <code><a href="#topic+create_BLFL">create_BLFL()</a></code>, <code><a href="#topic+create_EPOCH">create_EPOCH()</a></code>, and <code><a href="#topic+calc_DY">calc_DY()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dm
</code></pre>


<h3>Format</h3>



<h4>'dm'</h4>

<p>A data frame with 2 rows and 4 columns:
</p>

<dl>
<dt>USUBJID</dt><dd><p>Subject identifier</p>
</dd>
<dt>RFSTDTC</dt><dd><p>Study start date</p>
</dd>
<dt>RFXSTDTC</dt><dd><p>First exposure date</p>
</dd>
<dt>RFXENDTC</dt><dd><p>Last exposure date</p>
</dd>
</dl>



<hr>
<h2 id='edc_xx'>Example EDC data for form/table 'XX'</h2><span id='topic+edc_xx'></span>

<h3>Description</h3>

<p>This is an example data set to simulate raw EDC data from the fake form/table
'XX'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>edc_xx
</code></pre>


<h3>Format</h3>



<h4>'edc_xx'</h4>

<p>A data frame with 8 rows and 6 columns:
</p>

<dl>
<dt>STUDYID</dt><dd><p>Study identifier</p>
</dd>
<dt>USUBJID</dt><dd><p>Subject identifier</p>
</dd>
<dt>VISIT</dt><dd><p>Visit name</p>
</dd>
<dt>XXTESTCD</dt><dd><p>Test name, coded</p>
</dd>
<dt>XXORRES</dt><dd><p>Test result</p>
</dd>
</dl>



<hr>
<h2 id='format_chars_and_dates'>Format date and character columns for SDTM tables</h2><span id='topic+format_chars_and_dates'></span>

<h3>Description</h3>

<p>Converts all date columns to character class and replaces all <code>NA</code> values in
character/date columns with <code>""</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>format_chars_and_dates(tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="format_chars_and_dates_+3A_tbl">tbl</code></td>
<td>
<p>a data frame, the SDTM table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be applied as one of the last steps in the data process
but before <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code>.
</p>


<h3>Value</h3>

<p>a modified copy of the <code>tbl</code> data frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+trim_and_make_blanks_NA">trim_and_make_blanks_NA()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(
  dates = as.Date(c("2017-02-05", NA)),
  strings = c(NA_character_, "this"),
  nums = c(1, NA)
)
format_chars_and_dates(df)

</code></pre>

<hr>
<h2 id='get_codelist'>Read in the code list from the specification for a specific domain</h2><span id='topic+get_codelist'></span>

<h3>Description</h3>

<p>Reads-in the <code>"Codelists"</code> sheet from the study's specification MS Excel file
and then filters that code list by the variables in the domain
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_codelist(
  domain,
  dir,
  filename,
  var_col = "Variable",
  codelist_sheet = "Codelists",
  varid_col = "ID"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_codelist_+3A_domain">domain</code></td>
<td>
<p>string, SDTM domain or supplemental domain code</p>
</td></tr>
<tr><td><code id="get_codelist_+3A_dir">dir</code></td>
<td>
<p>string, specification directory</p>
</td></tr>
<tr><td><code id="get_codelist_+3A_filename">filename</code></td>
<td>
<p>string, file name of the specification</p>
</td></tr>
<tr><td><code id="get_codelist_+3A_var_col">var_col</code></td>
<td>
<p>a string, the column name in the domain spec sheet that
contains the variables for that domain, default is <code>"Variable"</code></p>
</td></tr>
<tr><td><code id="get_codelist_+3A_codelist_sheet">codelist_sheet</code></td>
<td>
<p>a string, the sheet name of the spec's code list from
the spec's .xlsx file, default is <code>"Codelists"</code></p>
</td></tr>
<tr><td><code id="get_codelist_+3A_varid_col">varid_col</code></td>
<td>
<p>a string, the column name in the <code>codelist_sheet</code> table
from the spec's .xlsx file that contains the variable names, default is
<code>"ID"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a data frame with the code list
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_spec">get_data_spec()</a></code>, <code><a href="#topic+get_key_vars">get_key_vars()</a></code>, <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>work_dir &lt;- system.file("extdata", package = "sdtmval")
codelists &lt;- get_codelist(domain = 'XX',
                          dir = work_dir,
                          filename = "spec.xlsx")

</code></pre>

<hr>
<h2 id='get_data_spec'>Read in the variable specification sheet for a SDTM data set</h2><span id='topic+get_data_spec'></span>

<h3>Description</h3>

<p>Reads the specified domain variable specification sheet from an MS Excel file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_data_spec(domain, dir, filename, arrange_by = "Order")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_data_spec_+3A_domain">domain</code></td>
<td>
<p>string, SDTM domain or supplemental domain code</p>
</td></tr>
<tr><td><code id="get_data_spec_+3A_dir">dir</code></td>
<td>
<p>string, specification directory</p>
</td></tr>
<tr><td><code id="get_data_spec_+3A_filename">filename</code></td>
<td>
<p>string, file name of the specification</p>
</td></tr>
<tr><td><code id="get_data_spec_+3A_arrange_by">arrange_by</code></td>
<td>
<p>character vector, the column(s) by which to sort the domain
sheet, default is <code>"Order"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code><a href="readxl.html#topic+read_excel">readxl::read_excel()</a></code> function will causes an access denied warning when
reading in a read-only specification file. This does not affect the data
import. Variables will be arranged in descending order per the <code>"Order"</code>
column in the specification.
</p>


<h3>Value</h3>

<p>a data frame of the variable specification for <code>domain</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_key_vars">get_key_vars()</a></code>, <code><a href="#topic+get_codelist">get_codelist()</a></code>, <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>work_dir &lt;- system.file("extdata", package = "sdtmval")
spec &lt;- get_data_spec(domain = "XX",
                      dir = work_dir,
                      filename = "spec.xlsx")

</code></pre>

<hr>
<h2 id='get_key_vars'>Read in the key variables for a SDTM domain</h2><span id='topic+get_key_vars'></span>

<h3>Description</h3>

<p>Reads the <code>"Key Variables"</code> column from the SDTM specification MS Excel
file's <code>"Datasets"</code> sheet for the specified <code>domain</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_key_vars(
  domain,
  dir,
  filename,
  datasets_sheet = "Datasets",
  dataset_col = "Dataset",
  keyvar_col = "Key Variables"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get_key_vars_+3A_domain">domain</code></td>
<td>
<p>string, SDTM domain or supplemental domain code</p>
</td></tr>
<tr><td><code id="get_key_vars_+3A_dir">dir</code></td>
<td>
<p>string, specification directory</p>
</td></tr>
<tr><td><code id="get_key_vars_+3A_filename">filename</code></td>
<td>
<p>string, file name of the specification</p>
</td></tr>
<tr><td><code id="get_key_vars_+3A_datasets_sheet">datasets_sheet</code></td>
<td>
<p>a string, the sheet name in the specification Excel
file that has the key variables, default is <code>"Datasets"</code></p>
</td></tr>
<tr><td><code id="get_key_vars_+3A_dataset_col">dataset_col</code></td>
<td>
<p>a string, the column name of the domains in the table in
<code>datasets_sheet</code>, default is <code>"Dataset"</code></p>
</td></tr>
<tr><td><code id="get_key_vars_+3A_keyvar_col">keyvar_col</code></td>
<td>
<p>a string, the column name of the key variables in the table
in <code>datasets_sheet</code>, default is <code>"Key Variables"</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>readxl::read_excel()</code> function will causes an access denied warning when
reading in a read-only specification file. This does not affect the data
import.
</p>


<h3>Value</h3>

<p>a character vector of key variables for the specified <code>domain</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get_data_spec">get_data_spec()</a></code>, <code><a href="#topic+get_codelist">get_codelist()</a></code>, <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>work_dir &lt;- system.file("extdata", package = "sdtmval")
key_vars &lt;- get_key_vars(domain = "XX",
                         dir = work_dir,
                         filename = "spec.xlsx")

</code></pre>

<hr>
<h2 id='impute_pdates'>Impute start or end dates</h2><span id='topic+impute_pdates'></span>

<h3>Description</h3>

<p>Imputes missing date elements for start or end dates. Partial dates should be
in the format <code>"UNKN-UN-UN"</code> or some combination of those characters and
numbers (ie <code>"2017-UN-UN"</code>). Dates with no information or dates with a
missing year will be converted to <code>NA</code>. For start dates, missing days are
assumed to be the first of the month while missing months are assumed to be
January. For end dates, missing days are assumed to be the last day of the
month and missing months are assumed to be December.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impute_pdates(dates, ptype, input_sep = "-")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="impute_pdates_+3A_dates">dates</code></td>
<td>
<p>a character vector of partial dates (which could also contain
full dates) in the format YYYY-MM-DD</p>
</td></tr>
<tr><td><code id="impute_pdates_+3A_ptype">ptype</code></td>
<td>
<p>a string of either <code>"start"</code> or <code>"end"</code> indicating whether start
or end dates should be imputed, respectively</p>
</td></tr>
<tr><td><code id="impute_pdates_+3A_input_sep">input_sep</code></td>
<td>
<p>the character that separates date components in <code>dates</code>,
default is <code>"-"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a date vector of imputed dates in the format YYYY-MM-DD
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshape_adates">reshape_adates()</a></code>, <code><a href="#topic+reshape_pdates">reshape_pdates()</a></code>, <code><a href="#topic+trim_dates">trim_dates()</a></code>,
<code>vignette("Dates")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c(
  "UNKN-UN-UN",
  "2017-UN-UN",
  "2017-02-UN",
  "2017-UN-05",
  "2017-09-03",
  "UNKN-07-14",
  NA
)
impute_pdates(dates, ptype = "start")
impute_pdates(dates, ptype = "end")

</code></pre>

<hr>
<h2 id='read_edc_tbls'>Import EDC data tables</h2><span id='topic+read_edc_tbls'></span>

<h3>Description</h3>

<p>Reads-in EDC data table .csv files and puts them in a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_edc_tbls(edc_tbls, dir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_edc_tbls_+3A_edc_tbls">edc_tbls</code></td>
<td>
<p>character vector of EDC table file names (without extension)</p>
</td></tr>
<tr><td><code id="read_edc_tbls_+3A_dir">dir</code></td>
<td>
<p>string, EDC data directory</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The file encoding will be UTF-8.
</p>


<h3>Value</h3>

<p>a named list of data frames where the names are taken from <code>edc_tbls</code>
and the data frames are the EDC data tables
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_sdtm_tbls">read_sdtm_tbls()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>edc_tbls &lt;- c("xx", "vd")
edc_dir &lt;- system.file("extdata", package = "sdtmval")
edc_dat &lt;- read_edc_tbls(edc_tbls, dir = edc_dir)

</code></pre>

<hr>
<h2 id='read_sdtm_tbls'>Import SDTM data tables</h2><span id='topic+read_sdtm_tbls'></span>

<h3>Description</h3>

<p>Reads-in SDTM data tables store as .sas7bdat files and puts them in a list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_sdtm_tbls(sdtm_tbls, dir)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_sdtm_tbls_+3A_sdtm_tbls">sdtm_tbls</code></td>
<td>
<p>character vector of SDTM table file names (without extension)</p>
</td></tr>
<tr><td><code id="read_sdtm_tbls_+3A_dir">dir</code></td>
<td>
<p>string, the directory containing the production SDTM tables</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The file encoding will be UTF-8.
</p>


<h3>Value</h3>

<p>a named list of data frames where the names are taken from
<code>sdtm_tbls</code> and the data frames are the SDTM data
</p>


<h3>See Also</h3>

<p><code><a href="#topic+read_edc_tbls">read_edc_tbls()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sdtm_tbls &lt;- "dm"
sdtm_dir &lt;- system.file("extdata", package = "sdtmval")
sdtm_dat &lt;- read_sdtm_tbls(sdtm_tbls, dir = sdtm_dir)

</code></pre>

<hr>
<h2 id='reshape_adates'>Reshape format of all dates (full and partial)</h2><span id='topic+reshape_adates'></span>

<h3>Description</h3>

<p>Re-arranges full and partial dates in the general form of <code>"MM/DD/YYYY"</code> to
the ISO 8601 format (<code>"YYYY-MM-DD"</code>). This function is appropriate for
vectors with mixed full and partial dates because it will not convert the
partial dates to <code>NA</code> which would occur if you used
<code>as.Date("02/UN/2017", format = "%m/%d/%Y")</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_adates(dates)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reshape_adates_+3A_dates">dates</code></td>
<td>
<p>a character vector of full and/or partial dates</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The date component separator in the input vector <code>dates</code> can be any
character.
</p>


<h3>Value</h3>

<p>a character vector of full and/or partial dates in the format
<code>"YYYY-MM-DD"</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshape_pdates">reshape_pdates()</a></code>, <code><a href="#topic+impute_pdates">impute_pdates()</a></code>, <code><a href="#topic+trim_dates">trim_dates()</a></code>,
<code>vignette("Dates")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c("02/05/2017", "UN/UN/2017", "02-05-2017", NA)
reshape_adates(dates)

</code></pre>

<hr>
<h2 id='reshape_pdates'>Reshape format of partial dates</h2><span id='topic+reshape_pdates'></span>

<h3>Description</h3>

<p>Re-arranges partial dates from a format of <code>"UN-UNK-UNKN"</code> (<code>"DD-MMM-YYYY"</code>)
to <code>"UN/UN/UNKN"</code> (<code>"MM/DD/YYYY"</code>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>reshape_pdates(dates, output_sep = "/")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="reshape_pdates_+3A_dates">dates</code></td>
<td>
<p>a character vector of partial dates</p>
</td></tr>
<tr><td><code id="reshape_pdates_+3A_output_sep">output_sep</code></td>
<td>
<p>the date component separator for the output, default is
<code>"/"</code></p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li><p> The separator character between dates components for the input vector
<code>dates</code> can be any commonly used date separator (<code>"/"</code>, <code>"-"</code>, <code>"."</code>,
<code>" "</code>).
</p>
</li>
<li><p> In the starting format, the month (<code>"UNK"</code>) is a three letter abbreviation
but, in the output format, the month is converted to a number
</p>
</li>
<li><p> The output format is a character vector, not a Date vector, to make some
common SDTM date workflow operations easier
</p>
</li>
<li><p> The case of the input month abbreviation does not matter; <code>"Feb"</code>,
<code>"feb"</code>, and <code>"FEB"</code> will yield the same results
</p>
</li></ul>



<h3>Value</h3>

<p>a character vector of partial dates in the format <code>"UN/UN/UNKN"</code>
(<code>"MM/DD/YYYY"</code>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshape_adates">reshape_adates()</a></code>, <code><a href="#topic+impute_pdates">impute_pdates()</a></code>, <code><a href="#topic+trim_dates">trim_dates()</a></code>,
<code>vignette("Dates")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c(
  "UN-UNK-UNKN",
  "UN/UNK/UNKN",
  "UN-UNK-2017",
  "UN-Feb-2017",
  "05-Feb-2017",
  "05-UNK-2017",
  "05-Feb-UNKN",
  NA
)
reshape_pdates(dates)

</code></pre>

<hr>
<h2 id='spec_codelists'>Example 'Codelists' tab from a SDTM specification .xlsx file</h2><span id='topic+spec_codelists'></span>

<h3>Description</h3>

<p>This table simulates an excerpt from a SDTM specification .xlsx file for the
'Codelists' tab which provides coded and decoded values from <code>XXTESTCD</code> and
<code>XXTEST</code> variables, respectively. This data set can be used to test the
<code><a href="#topic+get_codelist">get_codelist()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_codelists
</code></pre>


<h3>Format</h3>



<h4>'spec_codelists'</h4>

<p>A data frame with 3 rows and 3 columns:
</p>

<dl>
<dt>ID</dt><dd><p>The variable identifier/name</p>
</dd>
<dt>Term</dt><dd><p>The coded term</p>
</dd>
<dt>Decoded Value</dt><dd><p>The corresponding decoded value for the coded term</p>
</dd>
</dl>



<hr>
<h2 id='spec_datasets'>Example 'Datasets' tab from a SDTM specification .xlsx file</h2><span id='topic+spec_datasets'></span>

<h3>Description</h3>

<p>This table simulates an excerpt from a SDTM specification .xlsx file for the
'Datasets' tab which provides the key variables for the fake domain XX. This
data set can be used to test the <code><a href="#topic+get_key_vars">get_key_vars()</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_datasets
</code></pre>


<h3>Format</h3>



<h4>'spec_datasets'</h4>

<p>A data frame with 1 row and 4 columns:
</p>

<dl>
<dt>Dataset</dt><dd><p>The domain</p>
</dd>
<dt>Description</dt><dd><p>The domain description</p>
</dd>
<dt>Structure</dt><dd><p>Defines what qualifies as a unique record</p>
</dd>
<dt>Key Variables</dt><dd><p>The domain's key variables</p>
</dd>
</dl>



<hr>
<h2 id='spec_XX'>Example domain specific tab from a SDTM specification .xlsx file</h2><span id='topic+spec_XX'></span>

<h3>Description</h3>

<p>This table simulates an excerpt from a SDTM specification .xlsx file for the
fake domain tab XX which provides the labels, data types, and lengths by
variable. This data set can be used to test the <code><a href="#topic+get_data_spec">get_data_spec()</a></code>
and <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code> functions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spec_XX
</code></pre>


<h3>Format</h3>



<h4>'spec_XX'</h4>

<p>A data frame with 12 rows and 5 columns:
</p>

<dl>
<dt>Order</dt><dd><p>The order of the varibles in the data set</p>
</dd>
<dt>Dataset</dt><dd><p>The domain abbreviation</p>
</dd>
<dt>Varible</dt><dd><p>The domain's variables</p>
</dd>
<dt>Label</dt><dd><p>Variable labels</p>
</dd>
<dt>Data Type</dt><dd><p>Variable data types</p>
</dd>
<dt>Length</dt><dd><p>The maximum allowed length of an entry</p>
</dd>
</dl>



<hr>
<h2 id='trim_and_make_blanks_NA'>Trim white space and make blanks NA</h2><span id='topic+trim_and_make_blanks_NA'></span>

<h3>Description</h3>

<p>Trims the white space on both sides of strings in a character vector and
replaces blank values (<code>""</code> and <code>" "</code>) with <code>NA</code> for all columns in a data
frame that have a character class.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim_and_make_blanks_NA(tbl)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trim_and_make_blanks_NA_+3A_tbl">tbl</code></td>
<td>
<p>a data frame, the SDTM table</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function should be applied as one of the first steps in the data process
to ensure consistent handling of all strings.
</p>


<h3>Value</h3>

<p>a modified copy of the <code>tbl</code> data frame
</p>


<h3>See Also</h3>

<p><code><a href="#topic+format_chars_and_dates">format_chars_and_dates()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>df &lt;- data.frame(one = c("   a", "", " "))
trim_and_make_blanks_NA(df)

</code></pre>

<hr>
<h2 id='trim_dates'>Trim unknown elements in partial dates</h2><span id='topic+trim_dates'></span>

<h3>Description</h3>

<p>Removes unknown elements from a partial date. For example, <code>"2017-UN-UN"</code>
is trimmed to <code>"2017"</code> and <code>"2017-05-UN"</code> is trimmed to <code>"2017-05"</code>.
Values of <code>"UNKN-UN-UN"</code> are converted to <code>NA</code>. Values where only
the year and day are known are converted to just the year, ie <code>"2017-UN-01"</code>
converts to <code>"2017"</code>. Full dates are not modified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>trim_dates(dates, input_sep = "-")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="trim_dates_+3A_dates">dates</code></td>
<td>
<p>a character vector of partial dates in the format <code>"UNKN-UN-UN"</code>
(<code>"YYYY-MM-DD"</code>); full dates can also be included</p>
</td></tr>
<tr><td><code id="trim_dates_+3A_input_sep">input_sep</code></td>
<td>
<p>the character that separates date components in the input
vector <code>dates</code>, default is <code>"-"</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>a character vector of trimmed partial dates and full dates
</p>


<h3>See Also</h3>

<p><code><a href="#topic+reshape_adates">reshape_adates()</a></code>, <code><a href="#topic+reshape_pdates">reshape_pdates()</a></code>, <code><a href="#topic+impute_pdates">impute_pdates()</a></code>,
<code>vignette("Dates")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dates &lt;- c(
  "UNKN-UN-UN",
  "2017-UN-UN",
  "2017-02-UN",
  "2017-UN-05",
  "2017-09-03",
  "UNKN-07-14",
  NA
)
trim_dates(dates)

</code></pre>

<hr>
<h2 id='vd'>Example EDC data for form/table 'VD'</h2><span id='topic+vd'></span>

<h3>Description</h3>

<p>This is an example data set to simulate raw EDC data from the 'VD' form/table
which contains visit date information by subject.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vd
</code></pre>


<h3>Format</h3>



<h4>'vd'</h4>

<p>A data frame with 6 rows and 3 columns:
</p>

<dl>
<dt>USUBJID</dt><dd><p>Subject identifier</p>
</dd>
<dt>VISIT</dt><dd><p>Visit name</p>
</dd>
<dt>VISITDTC</dt><dd><p>Visit date</p>
</dd>
</dl>



<hr>
<h2 id='write_sessionInfo'>Write R session information for a script to a .txt file</h2><span id='topic+write_sessionInfo'></span>

<h3>Description</h3>

<p>Writes a .txt file of the output from <code><a href="utils.html#topic+sessionInfo">utils::sessionInfo()</a></code> with the file
name <code style="white-space: pre;">&#8288;[filename]_sessionInfo.txt&#8288;</code>. By creating a log of the R session
conditions a script was run with, results from the script can be reproduced
in the future.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_sessionInfo(filename, dir = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_sessionInfo_+3A_filename">filename</code></td>
<td>
<p>a string, the script file name (with or without .R extension)</p>
</td></tr>
<tr><td><code id="write_sessionInfo_+3A_dir">dir</code></td>
<td>
<p>a string, the directory to write to, default is <code>NULL</code> which means
the current working directory will be used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>nothing
</p>


<h3>See Also</h3>

<p><code><a href="#topic+convert_to_script">convert_to_script()</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>path &lt;- tempdir()
write_sessionInfo(filename = "test.R", dir = path)

</code></pre>

<hr>
<h2 id='write_tbl_to_xpt'>Write a SAS transport file (.xpt)</h2><span id='topic+write_tbl_to_xpt'></span>

<h3>Description</h3>

<p>Writes a data frame to a SAS transport file (.xpt) named like <code>"[domain].xpt"</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_tbl_to_xpt(tbl, filename, dir = NULL, label = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_tbl_to_xpt_+3A_tbl">tbl</code></td>
<td>
<p>a data frame to write</p>
</td></tr>
<tr><td><code id="write_tbl_to_xpt_+3A_filename">filename</code></td>
<td>
<p>a string, the SDTM domain or supplemental domain name which
will become the file name and the name attribute of the transport file, the
.xpt file extension is optional</p>
</td></tr>
<tr><td><code id="write_tbl_to_xpt_+3A_dir">dir</code></td>
<td>
<p>a string, the directory to write to, default is <code>NULL</code></p>
</td></tr>
<tr><td><code id="write_tbl_to_xpt_+3A_label">label</code></td>
<td>
<p>a string, the data set name/label for the <code><a href="haven.html#topic+read_xpt">haven::write_xpt()</a></code>
<code>name</code> argument. The default is <code>NULL</code> in which case the <code>filename</code> will be
used. <code>label</code> must be 8 characters or less.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Files will be written using version 5 .xpt files
</p>


<h3>Value</h3>

<p>nothing
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tbl &lt;- dplyr::tibble(one = as.numeric(1:3), two = letters[1:3])
path &lt;- tempdir()
write_tbl_to_xpt(tbl, filename = "test.xpt", dir = path)

</code></pre>

<hr>
<h2 id='xx_no_meta_data'>Example SDTM domain table XX without meta data</h2><span id='topic+xx_no_meta_data'></span>

<h3>Description</h3>

<p>This data set is used to test the <code><a href="#topic+assign_meta_data">assign_meta_data()</a></code> function and contains
a fake SDTM domain XX but without label or lengths assigned to the column
attributes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xx_no_meta_data
</code></pre>


<h3>Format</h3>



<h4>'xx_no_meta_data'</h4>

<p>A data frame with 10 rows and 11 columns:
</p>

<dl>
<dt>STUDYID</dt><dd><p>Study identifier</p>
</dd>
<dt>USUBJID</dt><dd><p>Subject identifier</p>
</dd>
<dt>XXSEQ</dt><dd><p>Sequence number</p>
</dd>
<dt>XXTESTCD</dt><dd><p>Coded test name</p>
</dd>
<dt>XXTEST</dt><dd><p>Test name</p>
</dd>
<dt>XXORRES</dt><dd><p>Measurement in original units</p>
</dd>
<dt>XXBLFL</dt><dd><p>Baseline flag</p>
</dd>
<dt>VISIT</dt><dd><p>Visit name</p>
</dd>
<dt>EPOCH</dt><dd><p>EPOCH</p>
</dd>
<dt>XXDTC</dt><dd><p>Measurement date</p>
</dd>
<dt>XXDY</dt><dd><p>Measurement day of study</p>
</dd>
</dl>



</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
