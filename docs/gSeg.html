<!DOCTYPE html><html><head><title>Help for package gSeg</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gSeg}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#E1'><p>An edge matrix representing a similarity graph</p></a></li>
<li><a href='#E2'><p>An edge matrix representing a similarity graph</p></a></li>
<li><a href='#E3'><p>An edge matrix representing a similarity graph</p></a></li>
<li><a href='#E4'><p>An edge matrix representing a similiarity graph</p></a></li>
<li><a href='#E5'><p>An edge matrix representing a similiarity graph</p></a></li>
<li><a href='#gSeg'><p>Graph-Based Change-Point Detection</p></a></li>
<li><a href='#gseg1'><p>Graph-Based Change-Point Detection for Single Change-Point</p></a></li>
<li><a href='#gseg1_discrete'><p>Graph-Based Change-Point Detection for Single Change-Point for Data with Repeated Observations</p></a></li>
<li><a href='#gseg2'><p>Graph-Based Change-Point Detection for Changed Interval</p></a></li>
<li><a href='#gseg2_discrete'><p>Graph-Based Change-Point Detection for Changed Interval for Data with Repeated Observations</p></a></li>
<li><a href='#n'><p>The Number of Observations in the Sequence</p></a></li>
<li><a href='#nnl'><p>Construct the Nearest Neighbor Link (NNL)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-9-21</td>
</tr>
<tr>
<td>Title:</td>
<td>Graph-Based Change-Point Detection (g-Segmentation)</td>
</tr>
<tr>
<td>Author:</td>
<td>Hao Chen, Nancy R. Zhang, Lynna Chu, and Hoseung Song</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hao Chen &lt;hxchen@ucdavis.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.1)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>ade4</td>
</tr>
<tr>
<td>Description:</td>
<td>Using an approach based on similarity graph to estimate change-point(s) and the corresponding p-values.  Can be applied to any type of data (high-dimensional, non-Euclidean, etc.) as long as a reasonable similarity measure is available.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-09-23 16:38:14 UTC; hao</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-09-24 09:10:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='E1'>An edge matrix representing a similarity graph</h2><span id='topic+E1'></span>

<h3>Description</h3>

<p>This is the variable name for an edge matrix in the &quot;Example&quot; data. It is constructed from a sequence of n=200 observations with a change in mean at t = 100. E1 is a matrix with the number of rows the number of edges in the similarity graph and 2 columns.  Each row contains the node indices of an edge.
</p>

<hr>
<h2 id='E2'>An edge matrix representing a similarity graph</h2><span id='topic+E2'></span>

<h3>Description</h3>

<p>This is the variable name for an edge matrix in the &quot;Example&quot; data. It is constructed from a sequence of n=200 observations with a change in mean starting at t=45. E2 is a matrix with the number of rows the number of edges in the similarity graph and 2 columns.  Each row contains the node indices of an edge.
</p>

<hr>
<h2 id='E3'>An edge matrix representing a similarity graph</h2><span id='topic+E3'></span>

<h3>Description</h3>

<p>This is the variable name for an edge matrix in the &quot;Example&quot; data. It is constructed from a sequence of n=200 observations with a change in mean and variance starting at t = 145. E3 is a matrix with the number of rows the number of edges in the similarity graph and 2 columns.  Each row contains the node indices of an edge.
</p>

<hr>
<h2 id='E4'>An edge matrix representing a similiarity graph</h2><span id='topic+E4'></span>

<h3>Description</h3>

<p>This is the variable name for an edge matrix in the &quot;Example&quot; data. It is constructed from a sequence of n=200 observations with a change in mean and variance starting at t=50. E4 is a matrix with the number of rows the number of edges in the similarity graph and 2 columns.  Each row contains the node indices of an edge.
</p>

<hr>
<h2 id='E5'>An edge matrix representing a similiarity graph</h2><span id='topic+E5'></span>

<h3>Description</h3>

<p>This is the variable name for an edge matrix in the &quot;Example&quot; data. It is constructed from a sequence of n=200 observations with a change in mean on the interval t= 155 to t=185. E5 is a matrix with the number of rows the number of edges in the similarity graph and 2 columns.  Each row contains the node indices of an edge.
</p>

<hr>
<h2 id='gSeg'>Graph-Based Change-Point Detection</h2><span id='topic+gSeg'></span>

<h3>Description</h3>

<p>This package can be used to estimate change-points in a sequence of observations, where the observation can be a vector or a data object, e.g., a network.  A similarity graph is required.  It can be a minimum spanning tree, a minimum distance pairing, a nearest neighbor graph, or a graph based on domain knowledge.
</p>
<p>For sequence with no repeated observations, if you believe the sequence has at most one change point, the function <code><a href="#topic+gseg1">gseg1</a></code> should be used;  if you believe an interval of the sequence has a changed distribution, the function <code><a href="#topic+gseg2">gseg2</a></code> should be used.  If you feel the sequence has multiple change-points, you can use <code><a href="#topic+gseg1">gseg1</a></code> and <code><a href="#topic+gseg2">gseg2</a></code> multiple times. See <code><a href="#topic+gseg1">gseg1</a></code> and <code><a href="#topic+gseg2">gseg2</a></code> for the details of these two function.
</p>
<p>If you believe the sequence has repeated observations, the function <code><a href="#topic+gseg1_discrete">gseg1_discrete</a></code> should be used for single change-point. For a changed interval of the sequence, the function <code><a href="#topic+gseg2_discrete">gseg2_discrete</a></code> should be used. The function <code><a href="#topic+nnl">nnl</a></code> can be used to construct the nearest neighbor link.
</p>


<h3>Author(s)</h3>

<p>Hao Chen, Nancy R. Zhang, Lynna Chu, and Hoseung Song
</p>
<p>Maintainer: Hao Chen (hxchen@ucdavis.edu)
</p>


<h3>References</h3>

<p>Chen, Hao, and Nancy Zhang. (2015). Graph-based change-point detection. The Annals of Statistics, 43(1), 139-176.
</p>
<p>Chu, Lynna, and Hao Chen. (2019). Asymptotic distribution-free change-point detection for modern data. The Annals of Statistics, 47(1), 382-414.
</p>
<p>Song, Hoseung, and Hao Chen (2020). Asymptotic distribution-free change-point detection for data with repeated observations. arXiv:2006.10305
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gseg1">gseg1</a></code>, <code><a href="#topic+gseg2">gseg2</a></code>, <code><a href="#topic+gseg1_discrete">gseg1_discrete</a></code>, <code><a href="#topic+gseg2_discrete">gseg2_discrete</a></code>, <code><a href="#topic+nnl">nnl</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Example)
# Five examples, each example is a n-length sequence.
# Ei (i=1,...,5): an edge matrix representing a similarity graph constructed on the
# observations in the ith sequence.  
# The following code shows how the Ei's were constructed.

require(ade4) 
# For illustration, we use 'mstree' in this package to construct the similarity graph.
# You can use other ways to construct the graph.

## Sequence 1: change in mean in the middle of the sequence.
d = 50
mu = 2
tau = 100
n = 200
set.seed(500)
y = rbind(matrix(rnorm(d*tau),tau), matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau))
y.dist = dist(y)
E1 = mstree(y.dist)
# For illustration, we constructed the minimum spanning tree.
# You can use other ways to construct the graph.

r1 = gseg1(n,E1, statistics="all")  
# output results based on all four statistics
# the scan statistics can be found in r1$scanZ

r1_a = gseg1(n,E1, statistics="w")  
# output results based on the weighted edge-count statistic

r1_b = gseg1(n,E1, statistics=c("w","g"))  
# output results based on the weighted edge-count statistic 
# and generalized edge-count statistic

# image(as.matrix(y.dist))  
# run this if you would like to have some idea on the pairwise distance

## Sequence 2: change in mean away from the middle of the sequence.
d = 50
mu = 2
tau = 45
n = 200
set.seed(500)
y = rbind(matrix(rnorm(d*tau),tau), matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau))
y.dist = dist(y)
E2 = mstree(y.dist)
r2 = gseg1(n,E2,statistic="all")
# image(as.matrix(y.dist))  


## Sequence 3: change in both mean and variance away from the middle of the sequence.
d = 50
mu = 2
sigma=0.7
tau = 145
n = 200
set.seed(500)
y = rbind(matrix(rnorm(d*tau),tau), matrix(rnorm(d*(n-tau),mu/sqrt(d),sigma), n-tau))
y.dist = dist(y)
E3 = mstree(y.dist)
r3=gseg1(n,E3,statistic="all")
# image(as.matrix(y.dist)) 


## Sequence 4: change in both mean and variance away from the middle of the sequence.
d = 50
mu = 2
sigma=1.2
tau = 50
n = 200
set.seed(500)
y = rbind(matrix(rnorm(d*tau),tau), matrix(rnorm(d*(n-tau),mu/sqrt(d),sigma), n-tau))
y.dist = dist(y)
E4 = mstree(y.dist)
r4=gseg1(n,E4,statistic="all")
# image(as.matrix(y.dist))  


## Sequence 5: change in both mean and variance happens on an interval.
d = 50
mu = 2
sigma=0.5
tau1 = 155
tau2 = 185
n = 200
set.seed(500)
y1 = matrix(rnorm(d*tau1),tau1)
y2 = matrix(rnorm(d*(tau2-tau1),mu/sqrt(d),sigma), tau2-tau1)
y3 = matrix(rnorm(d*(n-tau2)), n-tau2)
y = rbind(y1, y2, y3)
y.dist = dist(y)
E5 = mstree(y.dist)
r5=gseg2(n,E5,statistics="all")
# image(as.matrix(y.dist))  

## Sequence 6: change in mean away from the middle of the sequence 
## when data has repeated observations.
d = 50
mu = 2
tau = 100
n = 200
set.seed(500)
y1_temp = matrix(rnorm(d*tau),tau)
sam1 = sample(1:tau, replace = TRUE)
y1 = y1_temp[sam1,] 
y2_temp = matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau)
sam2 = sample(1:tau, replace = TRUE)
y2 = y2_temp[sam2,] 
y = rbind(y1, y2)
# Data y has repeated observations
y_uni = unique(y)
E6 = nnl(dist(y_uni), 1)
cha = do.call(paste, as.data.frame(y))    
id = match(cha, unique(cha))
r6 = gseg1_discrete(n, E6, id, statistics="all")
# image(as.matrix(y.dist))  

</code></pre>

<hr>
<h2 id='gseg1'>Graph-Based Change-Point Detection for Single Change-Point</h2><span id='topic+gseg1'></span>

<h3>Description</h3>

<p>This function finds a break point in the sequence where the underlying distribution changes. It provides four graph-based test statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gseg1(n, E, statistics=c("all","o","w","g","m"), n0=0.05*n, n1=0.95*n, pval.appr=TRUE,
 skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gseg1_+3A_n">n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_e">E</code></td>
<td>
<p>The edge matrix (a &quot;number of edges&quot; by 2 matrix) for the similarity graph.  Each row contains the node indices of an edge.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_statistics">statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td></tr>
<tr><td><code id="gseg1_+3A_n0">n0</code></td>
<td>
<p>The starting index to be considered as a candidate for the change-point.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_n1">n1</code></td>
<td>
<p>The ending index to be considered as a candidate for the change-point.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_pval.appr">pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_skew.corr">skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_pval.perm">pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td></tr>
<tr><td><code id="gseg1_+3A_b">B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a vector of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr><td><code>tauhat</code></td>
<td>
<p>An estimate of the location of the change-point.</p>
</td></tr>
<tr><td><code>Zmax</code></td>
<td>
<p>The test statistic (maximum of the scan statistics).</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>A vector of the original scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zw</code></td>
<td>
<p>A vector of the weighted scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>A vector of the generalized scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>A vector of the max-type scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>A vector of raw counts of the original scan statistic. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Rw</code></td>
<td>
<p>A vector of raw counts of the weighted scan statistic. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td></tr>
<tr><td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td></tr>
<tr><td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td></tr>
<tr><td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td></tr>
<tr><td><code>perm.Z</code></td>
<td>
<p>A B by n matrix with each row being the scan statistics from each permutaiton run.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gSeg">gSeg</a></code>, <code><a href="#topic+gseg2">gseg2</a></code>, <code><a href="#topic+gseg1_discrete">gseg1_discrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Example)
# Five examples, each example is a n-length sequence.
# Ei (i=1,...,5): an edge matrix representing a similarity graph constructed on the
# observations in the ith sequence.  
# Check '?gSeg' to see how the Ei's were constructed.


## E1 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in mean 
# in the middle of the sequence (tau = 100).

r1 = gseg1(n,E1, statistics="all")  
# output results based on all four statistics
# the scan statistics can be found in r1$scanZ
r1_a = gseg1(n,E1, statistics="w")  
# output results based on the weighted edge-count statistic
r1_b = gseg1(n,E1, statistics=c("w","g"))  
# output results based on the weighted edge-count statistic 
# and generalized edge-count statistic


## E2 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in mean 
# away from the middle of the sequence (tau=45).
r2 = gseg1(n,E2,statistic="all")


## E3 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in both mean 
# and variance away from the middle of the sequence (tau = 145).
r3=gseg1(n,E3,statistic="all")


## E4 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in both mean 
# and variance away from the middle of the sequence (tau = 50).
r4=gseg1(n,E4,statistic="all")

</code></pre>

<hr>
<h2 id='gseg1_discrete'>Graph-Based Change-Point Detection for Single Change-Point for Data with Repeated Observations</h2><span id='topic+gseg1_discrete'></span>

<h3>Description</h3>

<p>This function finds a break point in the sequence where the underlying distribution changes when data has repeated observations. It provides four graph-based test statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gseg1_discrete(n, E, id, statistics=c("all","o","w","g","m"), n0=0.05*n, n1=0.95*n, 
   pval.appr=TRUE, skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gseg1_discrete_+3A_n">n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_e">E</code></td>
<td>
<p>The edge matrix (a &quot;number of edges&quot; by 2 matrix) for the similarity graph. Each row contains the node indices of an edge.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_id">id</code></td>
<td>
<p>The index of observations (order of observations).</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_statistics">statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_n0">n0</code></td>
<td>
<p>The starting index to be considered as a candidate for the change-point.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_n1">n1</code></td>
<td>
<p>The ending index to be considered as a candidate for the change-point.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_pval.appr">pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_skew.corr">skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_pval.perm">pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td></tr>
<tr><td><code id="gseg1_discrete_+3A_b">B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a vector of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr><td><code>tauhat_a</code></td>
<td>
<p>An estimate of the location of the change-point for averaging approach.</p>
</td></tr>
<tr><td><code>tauhat_u</code></td>
<td>
<p>An estimate of the location of the change-point for union approach.</p>
</td></tr>
<tr><td><code>Z_a_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for averaging approach.</p>
</td></tr>
<tr><td><code>Z_u_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for union approach.</p>
</td></tr>
<tr><td><code>Zo_a</code></td>
<td>
<p>A vector of the original scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zo_u</code></td>
<td>
<p>A vector of the original scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zw_a</code></td>
<td>
<p>A vector of the weighted scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>Zw_u</code></td>
<td>
<p>A vector of the weighted scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>S_a</code></td>
<td>
<p>A vector of the generalized scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>S_u</code></td>
<td>
<p>A vector of the generalized scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>M_a</code></td>
<td>
<p>A vector of the max-type scan statistics (standardized counts) for averaging appraoch if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>M_u</code></td>
<td>
<p>A vector of the max-type scan statistics (standardized counts) for union appraoch if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>Ro_a</code></td>
<td>
<p>A vector of raw counts of the original scan statistic for averaging approach. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Ro_u</code></td>
<td>
<p>A vector of raw counts of the original scan statistic for union approach. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Rw_a</code></td>
<td>
<p>A vector of raw counts of the weighted scan statistic for averaging appraoch. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>Rw_u</code></td>
<td>
<p>A vector of raw counts of the weighted scan statistic for union appraoch. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td></tr>
<tr><td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td></tr>
<tr><td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td></tr>
<tr><td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td></tr>
<tr><td><code>perm.Z</code></td>
<td>
<p>A B by n matrix with each row being the scan statistics from each permutaiton run.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gSeg">gSeg</a></code>, <code><a href="#topic+gseg1">gseg1</a></code>, <code><a href="#topic+nnl">nnl</a></code>, <code><a href="#topic+gseg2_discrete">gseg2_discrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = 50
mu = 2
tau = 100
n = 200

set.seed(500)
y1_temp = matrix(rnorm(d*tau),tau)
sam1 = sample(1:tau, replace = TRUE)
y1 = y1_temp[sam1,] 
y2_temp = matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau)
sam2 = sample(1:tau, replace = TRUE)
y2 = y2_temp[sam2,] 

y = rbind(y1, y2)

# This data y has repeated observations
y_uni = unique(y)
E = nnl(dist(y_uni), 1)

cha = do.call(paste, as.data.frame(y))    
id = match(cha, unique(cha))

r1 = gseg1_discrete(n, E, id, statistics="all")
# output results based on all four statistics
# the scan statistics can be found in r1$scanZ
r1_a = gseg1_discrete(n, E, id, statistics="w")  
# output results based on the weighted edge-count statistic
r1_b = gseg1_discrete(n, E, id, statistics=c("w","g"))  
# output results based on the weighted edge-count statistic 
# and generalized edge-count statistic
</code></pre>

<hr>
<h2 id='gseg2'>Graph-Based Change-Point Detection for Changed Interval</h2><span id='topic+gseg2'></span>

<h3>Description</h3>

<p>This function finds an interval in the sequence where their underlying distribution differs from the rest of the sequence. It provides four graph-based test statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gseg2(n, E, statistics=c("all","o","w","g","m"), l0=0.05*n, l1=0.95*n, pval.appr=TRUE,
 skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gseg2_+3A_n">n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_e">E</code></td>
<td>
<p>The edge matrix (a &quot;number of edges&quot; by 2 matrix) for the similarity graph.  Each row contains the node indices of an edge.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_statistics">statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td></tr>
<tr><td><code id="gseg2_+3A_l0">l0</code></td>
<td>
<p>The minimum length of the interval to be considered as a changed interval.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_l1">l1</code></td>
<td>
<p>The maximum length of the interval to be considered as a changed interval.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_pval.appr">pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_skew.corr">skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_pval.perm">pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td></tr>
<tr><td><code id="gseg2_+3A_b">B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a matrix of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr><td><code>tauhat</code></td>
<td>
<p>An estimate of the two ends of the changed interval.</p>
</td></tr>
<tr><td><code>Zmax</code></td>
<td>
<p>The test statistic (maximum of the scan statistics).</p>
</td></tr>
<tr><td><code>Z</code></td>
<td>
<p>A matrix of the original scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zw</code></td>
<td>
<p>A matrix of the weighted scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>S</code></td>
<td>
<p>A matrix of the generalized scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>M</code></td>
<td>
<p>A matrix of the max-type scan statistics (standardized counts) if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>R</code></td>
<td>
<p>A matrix of raw counts of the original scan statistic. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Rw</code></td>
<td>
<p>A matrix of raw counts of the weighted scan statistic. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td></tr>
<tr><td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td></tr>
<tr><td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td></tr>
<tr><td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td></tr>
<tr><td><code>perm.Z</code></td>
<td>
<p>A B by n-squared matrix with each row being the vectorized scan statistics from each permutaiton run.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gSeg">gSeg</a></code>, <code><a href="#topic+gseg1">gseg1</a></code>, <code><a href="#topic+gseg2_discrete">gseg2_discrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Example)
# Five examples, each example is a n-length sequence.
# Ei (i=1,...,5): an edge matrix representing a similarity graph constructed on the
# observations in the ith sequence.  
# Check '?gSeg' to see how the Ei's were constructed.

## E5 is an edge matrix representing a similarity graph.
# It is constructed on a sequence of length n=200 with a change in both mean
# and variance on an interval (tau1 = 155, tau2 = 185).
r5=gseg2(n,E5,statistics="all")

</code></pre>

<hr>
<h2 id='gseg2_discrete'>Graph-Based Change-Point Detection for Changed Interval for Data with Repeated Observations</h2><span id='topic+gseg2_discrete'></span>

<h3>Description</h3>

<p>This function finds an interval in the sequence where their underlying distribution differs from the rest of the sequence when data has repeated observations. It provides four graph-based test statistics.</p>


<h3>Usage</h3>

<pre><code class='language-R'>gseg2_discrete(n, E, id, statistics=c("all","o","w","g","m"), l0=0.05*n, l1=0.95*n, 
   pval.appr=TRUE, skew.corr=TRUE, pval.perm=FALSE, B=100)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gseg2_discrete_+3A_n">n</code></td>
<td>
<p>The number of observations in the sequence.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_e">E</code></td>
<td>
<p>The edge matrix (a &quot;number of edges&quot; by 2 matrix) for the similarity graph. Each row contains the node indices of an edge.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_id">id</code></td>
<td>
<p>The index of observations (order of observations).</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_statistics">statistics</code></td>
<td>
<p>The scan statistic to be computed. A character indicating the type of of scan statistic desired. The default is <code>"all"</code>.
</p>
<p><code>"all"</code>: specifies to compute <b>a</b>ll of the scan statistics: original, weighted, generalized, and max-type;
</p>
<p><code>"o", "ori"</code> or <code>"original"</code>: specifies the <b>o</b>riginal edge-count scan statistic;
</p>
<p><code>"w"</code> or <code>"weighted"</code>: specifies the <b>w</b>eighted edge-count scan statistic;
</p>
<p><code>"g"</code> or <code>"generalized"</code>: specifies the <b>g</b>eneralized edge-count scan statistic; and
</p>
<p><code>"m"</code> or <code>"max"</code>: specifies the <b>m</b>ax-type edge-count scan statistic.
</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_l0">l0</code></td>
<td>
<p>The minimum length of the interval to be considered as a changed interval.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_l1">l1</code></td>
<td>
<p>The maximum length of the interval to be considered as a changed interval.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_pval.appr">pval.appr</code></td>
<td>
<p>If it is TRUE, the function outputs p-value approximation based on asymptotic properties.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_skew.corr">skew.corr</code></td>
<td>
<p>This argument is useful only when pval.appr=TRUE.  If skew.corr is TRUE, the p-value approximation would incorporate skewness correction.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_pval.perm">pval.perm</code></td>
<td>
<p>If it is TRUE, the function outputs p-value from doing B permutations, where B is another argument that you can specify. Doing permutation could be time consuming, so use this argument with caution as it may take a long time to finish the permutation.</p>
</td></tr>
<tr><td><code id="gseg2_discrete_+3A_b">B</code></td>
<td>
<p>This argument is useful only when pval.perm=TRUE.  The default value for B is 100.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a list <code>scanZ</code> with <code>tauhat</code>, <code>Zmax</code>, and a vector of the scan statistics for each type of scan statistic specified. See below for more details.
</p>
<table>
<tr><td><code>tauhat_a</code></td>
<td>
<p>An estimate of the two ends of the changed interval for averaging approach.</p>
</td></tr>
<tr><td><code>tauhat_u</code></td>
<td>
<p>An estimate of the two ends of the changed interval for union approach.</p>
</td></tr>
<tr><td><code>Z_a_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for averaging approach.</p>
</td></tr>
<tr><td><code>Z_u_max</code></td>
<td>
<p>The test statistic (maximum of the scan statistics) for union approach.</p>
</td></tr>
<tr><td><code>Zo_a</code></td>
<td>
<p>A matrix of the original scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zo_u</code></td>
<td>
<p>A matrix of the original scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Zw_a</code></td>
<td>
<p>A matrix of the weighted scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>Zw_u</code></td>
<td>
<p>A matrix of the weighted scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>S_a</code></td>
<td>
<p>A matrix of the generalized scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>S_u</code></td>
<td>
<p>A matrix of the generalized scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;g&quot;.</p>
</td></tr>
<tr><td><code>M_a</code></td>
<td>
<p>A matrix of the max-type scan statistics (standardized counts) for averaging approach if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>M_u</code></td>
<td>
<p>A matrix of the max-type scan statistics (standardized counts) for union approach if statistic specified is &quot;all&quot; or &quot;m&quot;.</p>
</td></tr>
<tr><td><code>Ro_a</code></td>
<td>
<p>A matrix of raw counts of the original scan statistic for averaging approach. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Ro_u</code></td>
<td>
<p>A matrix of raw counts of the original scan statistic for union approach. This output only exists if the statistic specified is &quot;all&quot; or &quot;o&quot;.</p>
</td></tr>
<tr><td><code>Rw_a</code></td>
<td>
<p>A matrix of raw counts of the weighted scan statistic for averaging approach. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>Rw_a</code></td>
<td>
<p>A matrix of raw counts of the weighted scan statistic for union approach. This output only exists if statistic specified is &quot;all&quot; or &quot;w&quot;.</p>
</td></tr>
<tr><td><code>pval.appr</code></td>
<td>
<p>The approximated p-value based on asymptotic theory for each type of statistic specified.</p>
</td></tr>
<tr><td><code>pval.perm</code></td>
<td>
<p>This output exists only when the argument pval.perm is TRUE . It is the permutation p-value from B permutations and appears for each type of statistic specified (same for perm.curve, perm.maxZs, and perm.Z).</p>
</td></tr>
<tr><td><code>perm.curve</code></td>
<td>
<p>A B by 2 matrix with the first column being critical values corresponding to the p-values in the second column.</p>
</td></tr>
<tr><td><code>perm.maxZs</code></td>
<td>
<p>A sorted vector recording the test statistics in the B permutaitons.</p>
</td></tr>
<tr><td><code>perm.Z</code></td>
<td>
<p>A B by n-squared matrix with each row being the vectorized scan statistics from each permutaiton run.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gSeg">gSeg</a></code>, <code><a href="#topic+gseg2">gseg2</a></code>, <code><a href="#topic+nnl">nnl</a></code>, <code><a href="#topic+gseg1_discrete">gseg1_discrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>d = 50
mu = 2
tau = 100
n = 200

set.seed(500)
y1_temp = matrix(rnorm(d*tau),tau)
sam1 = sample(1:tau, replace = TRUE)
y1 = y1_temp[sam1,] 
y2_temp = matrix(rnorm(d*(n-tau),mu/sqrt(d)), n-tau)
sam2 = sample(1:tau, replace = TRUE)
y2 = y2_temp[sam2,] 

y = rbind(y1, y2)

# This data y has repeated observations
y_uni = unique(y)
E = nnl(dist(y_uni), 1)

cha = do.call(paste, as.data.frame(y))    
id = match(cha, unique(cha))

r1 = gseg2_discrete(n, E, id, statistics="all")
</code></pre>

<hr>
<h2 id='n'>The Number of Observations in the Sequence</h2><span id='topic+n'></span>

<h3>Description</h3>

<p>This is the variable name for the number of observations in the sequences in the &quot;Example&quot; data.
</p>

<hr>
<h2 id='nnl'>Construct the Nearest Neighbor Link (NNL)</h2><span id='topic+nnl'></span>

<h3>Description</h3>

<p>This function provides a method to construct the NNL.</p>


<h3>Usage</h3>

<pre><code class='language-R'>nnl(distance, K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nnl_+3A_distance">distance</code></td>
<td>
<p>The distance matrix on the distinct values (a &quot;number of unique observations&quot; by &quot;number of unique observations&quot; matrix).</p>
</td></tr>
<tr><td><code id="nnl_+3A_k">K</code></td>
<td>
<p>The value of k in &quot;k-MST&quot; or &quot;k-NNL&quot; to construct the similarity graph.</p>
</td></tr>
</table>


<h3>Value</h3>

<table>
<tr><td><code>E</code></td>
<td>
<p>The edge matrix representing the similarity graph on the distinct values with the number of edges in the similarity graph being the number of rows and 2 columns. Each row records the subject indices of the two ends of an edge in the similarity graph.</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="#topic+gSeg">gSeg</a></code>, <code><a href="#topic+gseg1_discrete">gseg1_discrete</a></code>, <code><a href="#topic+gseg2_discrete">gseg2_discrete</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>n = 50
d = 10
dat = matrix(rnorm(d*n),n)
sam = sample(1:n, replace = TRUE)
dat = dat[sam,] 

# This data has repeated observations
dat_uni = unique(dat)
E = nnl(dist(dat_uni), 1)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
