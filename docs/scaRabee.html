<!DOCTYPE html><html lang="en"><head><title>Help for package scaRabee</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {scaRabee}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#scaRabee-package'>
<p>scaRabee toolkit</p></a></li>
<li><a href='#bound.parameters'>
<p>Forces parameter estimates between defined boundaries.</p></a></li>
<li><a href='#compute.secondary'>
<p>Computes secondary parameter values</p></a></li>
<li><a href='#convert.infusion'><p>Process Infusion Information</p></a></li>
<li><a href='#dde.model'>
<p>Delay Differential Equations</p></a></li>
<li><a href='#dde.utils'>
<p>Utility Functions for Delay Differential Equation Systems</p></a></li>
<li><a href='#estimation.plot'>
<p>Create Summary Estimation Plots</p></a></li>
<li><a href='#examples.data'>
<p>Datasets for scaRabee demo.</p></a></li>
<li><a href='#explicit.model'>
<p>Explicit Equations</p></a></li>
<li><a href='#finalize.grid.report'>
<p>Finalize Direct Grid Search Report</p></a></li>
<li><a href='#finalize.report'>
<p>Finalize Estimation Report</p></a></li>
<li><a href='#fitmle'>
<p>Maximum Likelihood Estimator</p></a></li>
<li><a href='#fitmle.cov'>
<p>Computation of the Covariance Matrix</p></a></li>
<li><a href='#get.cov.matrix'>
<p>Computation of the Covariance Matrix</p></a></li>
<li><a href='#get.events'>
<p>Create events from bolus dosing records.</p></a></li>
<li><a href='#get.layout'>
<p>Layout for Lattice Functions</p></a></li>
<li><a href='#get.parms.data'>
<p>Extract data from scaRabee parameter table</p></a></li>
<li><a href='#get.secondary'>
<p>Computation of Secondary Parameter Estimates</p></a></li>
<li><a href='#initialize.report'>
<p>Initialize Report Files</p></a></li>
<li><a href='#ode.model'>
<p>Ordinary Differential Equations</p></a></li>
<li><a href='#ode.utils'>
<p>Utility Functions for Ordinary Differential Equation Systems</p></a></li>
<li><a href='#order.parms.list'>
<p>Sort a scaRabee parameter table</p></a></li>
<li><a href='#pder'>
<p>Compute Matrix of Partial Derivatives</p></a></li>
<li><a href='#problem.eval'>
<p>Evaluation of structural and residual variability models</p></a></li>
<li><a href='#residual.report'>
<p>Creation of Prediction &amp; Residual Report</p></a></li>
<li><a href='#scarabee.analysis'>
<p>Run a scaRabee Analysis</p></a></li>
<li><a href='#scarabee.check.model'>
<p>Check scaRabee Models</p></a></li>
<li><a href='#scarabee.check.reserved'>
<p>Check for Reserved Variable Names</p></a></li>
<li><a href='#scarabee.clean'>
<p>Cleaning of the Run Directory</p></a></li>
<li><a href='#scarabee.directory'>
<p>Creation of the Run Directory</p></a></li>
<li><a href='#scarabee.gridsearch'>
<p>Direct Grid Search Utility</p></a></li>
<li><a href='#scarabee.new'>
<p>Create a scaRabee Analysis Folder</p></a></li>
<li><a href='#scarabee.read.data'>
<p>Read scaRabee Data File</p></a></li>
<li><a href='#scarabee.read.model'>
<p>Read scaRabee Model File</p></a></li>
<li><a href='#scarabee.read.parms'>
<p>Read scaRabee Parameter File</p></a></li>
<li><a href='#simulation.plot'>
<p>Create Simulation Plots</p></a></li>
<li><a href='#simulation.report'>
<p>Simulations</p></a></li>
<li><a href='#weighting'>
<p>Residual Variability</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Optimization Toolkit for Pharmacokinetic-Pharmacodynamic Models</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1-4</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-02-04</td>
</tr>
<tr>
<td>Depends:</td>
<td>neldermead (&ge; 1.0-8), optimsimplex (&ge; 1.0-5), optimbase (&ge;
1.0-8)</td>
</tr>
<tr>
<td>Imports:</td>
<td>lattice, grid, deSolve, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.28),rmarkdown (&ge; 2.2)</td>
</tr>
<tr>
<td>Description:</td>
<td>A port of the Scarabee toolkit originally written as a 
  Matlab-based application. scaRabee provides a framework for simulation and optimization 
  of pharmacokinetic-pharmacodynamic models at the individual and population level.
  It is built on top of the neldermead package, which provides the direct search 
  algorithm proposed by Nelder and Mead for model optimization.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-02-04 11:55:14 UTC; sebastien</td>
</tr>
<tr>
<td>Author:</td>
<td>Sebastien Bihorel [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Sebastien Bihorel &lt;sb.pmlab@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-02-04 13:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='scaRabee-package'>
scaRabee toolkit
</h2><span id='topic+scaRabee-package'></span><span id='topic+scaRabee'></span>

<h3>Description</h3>

<p>Framework for Pharmacokinetic-Pharmacodynamic Model Simulation and 
Optimization
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> scaRabee</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.1-4</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2022-02-04</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-v3 </td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes
</td>
</tr>

</table>

<p><span class="pkg">scaRabee</span> is a toolkit for modeling and simulation primarily intended for
the field of pharmacometrics. This package is a R port of Scarabee, a 
Matlab-based piece of software developed as a fairly simple application for the
simulation and optimization of pharmacokinetic and/or pharmacodynamic models 
specified with explicit solutions, ordinary or delay differential equations.
</p>
<p>The method of optimization used in scaRabee is based upon the Nelder-Mead simplex
algorithm, as implemented by the <code>fminsearch</code> function from the
<span class="pkg">neldermead</span> package.
</p>
<p>Please, refer to the vignette to learn how to run analyses with <span class="pkg">scaRabee</span> 
and read more about the methods used in <span class="pkg">scaRabee</span>.
</p>
<p><span class="pkg">scaRabee</span> is  available on the Comprehensive R Archive Network and also at:
<a href="https://github.com/sbihorel/scaRabee">https://github.com/sbihorel/scaRabee</a>
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="neldermead.html#topic+neldermead">neldermead</a></code>
</p>

<hr>
<h2 id='bound.parameters'>
Forces parameter estimates between defined boundaries.
</h2><span id='topic+bound.parameters'></span>

<h3>Description</h3>

<p><code>bound.parameters</code> is a utility function called during estimation runs. 
It forces the parameter estimates to remain within the boundaries defined in 
the .csv file of initial estimates. <code>bound.parameters</code> is typically not 
called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  bound.parameters(x = NULL,
                   lb = NULL,
                   ub = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="bound.parameters_+3A_x">x</code></td>
<td>
<p>A vector of <em>p</em> parameter estimates.</p>
</td></tr>
<tr><td><code id="bound.parameters_+3A_lb">lb</code></td>
<td>
<p>A vector of <em>p</em> lower boundaries.</p>
</td></tr>
<tr><td><code id="bound.parameters_+3A_ub">ub</code></td>
<td>
<p>A vector of <em>p</em> upper boundaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a vector of <em>p</em> values. The ith element of the returned vector 
is: </p>

<ul>
<li><p> x[i]  if lb[i] &lt; x[i] &lt; ub[i]
</p>
</li>
<li><p> lb[i] if x[i] &lt;= lb[i]
</p>
</li>
<li><p> ub[i] if ub[i] &lt;= x[i]
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
bound.parameters(seq(1:5), lb=rep(3,5), ub=rep(4,5))

# The following call should return an error message
bound.parameters(1, lb=rep(3,5), ub=rep(4,5))

</code></pre>

<hr>
<h2 id='compute.secondary'>
Computes secondary parameter values
</h2><span id='topic+compute.secondary'></span>

<h3>Description</h3>

<p><code>compute.secondary</code> is a secondary function called during estimations
runs. It evaluates the code provided in the $SECONDARY block of the model 
file; all parameters defined in this block are considered as secondary
parameters at the initial and the final estimates of the model parameters. 
<code>compute.secondary</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  compute.secondary(subproblem = NULL,
                    x = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="compute.secondary_+3A_subproblem">subproblem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>ana</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs 
for a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd>
</dl>
</dd>
</dl>

</td></tr>
<tr><td><code id="compute.secondary_+3A_x">x</code></td>
<td>
<p>The vector of <em>p</em> final parameter estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of with the following elements:</p>

<dl>
<dt>init</dt><dd><p>The vector of <em>s</em> secondary parameter estimates derived
from initial structural model parameter estimates.</p>
</dd>
<dt>estimates</dt><dd><p>The vector of <em>s</em> secondary parameter estimates
derived from final structural model parameter estimates.</p>
</dd>
<dt>names</dt><dd><p>The vector of <em>s</em> secondary parameter names.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>,
<code><a href="#topic+weighting">weighting</a></code>,
<code><a href="#topic+fitmle">fitmle</a></code>,
<code><a href="#topic+get.secondary">get.secondary</a></code>
</p>

<hr>
<h2 id='convert.infusion'>Process Infusion Information</h2><span id='topic+convert.infusion'></span>

<h3>Description</h3>

<p><code>convert.infusion</code> is a secondary function, which main purpose is to
transform infusion information provided using NONMEM standards into an object
that can be used by scaRabee model functions. <code>convert.infusion</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  convert.infusion(infusion.data = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="convert.infusion_+3A_infusion.data">infusion.data</code></td>
<td>
<p>A data.frame with the following variables: trt, time, 
cmt, amt, and rate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a data.frame with the following variables: trt, time, state,  bolus, 
and infusion.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.read.data">scarabee.read.data</a></code>
</p>

<hr>
<h2 id='dde.model'>
Delay Differential Equations
</h2><span id='topic+dde.model'></span>

<h3>Description</h3>

<p><code>dde.model</code> is the system evaluation function called when a $DDE block is
detected in the model file, indicating that the model is defined by delay 
differential equations. <code>dde.model</code> is typically not called directly by 
users
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dde.model(parms = NULL,
            derparms = NULL,
            code = NULL,
            bolus = NULL,
            infusion = NULL,
            xdata = NULL,
            covdata = NULL,
            issim = 0,
            check = FALSE,
            options = list(method='lsoda'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dde.model_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_code">code</code></td>
<td>
<p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_bolus">bolus</code></td>
<td>
<p>A data.frame providing the instantaneous inputs  entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_infusion">infusion</code></td>
<td>
<p>A data.frame providing the zero-order inputs entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_covdata">covdata</code></td>
<td>
<p>A data.frame of covariate data for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_issim">issim</code></td>
<td>
<p>An indicator for simulation or estimation runs.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs.</p>
</td></tr>
<tr><td><code id="dde.model_+3A_options">options</code></td>
<td>
<p>A list of delay differential equation solver options. Currently
not modifiable by users.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dde.model</code> evaluates the model for each treatment of each individual 
contained in the dataset using, among other, the dedicated utility functions:
<code>dde.syst</code>, and <code>dde.lags</code>. The actual evaluation of the system is 
performed by <code>dede</code> from the <span class="pkg">deSolve</span> package.
</p>
<p><code>dde.model</code> also make use of utility functions which it shares with the 
other system evaluation functions <code>explicit.model</code>, and <code>ode.model</code>,
such as <code>create.intervals</code>, <code>derived.parms</code>, <code>init.cond</code>, 
<code>input.scaling</code>, <code>make.dosing</code>, <code>init.update</code>, and 
<code>de.output</code>.
</p>


<h3>Value</h3>

<p>Returns a matrix of system predictions.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="deSolve.html#topic+dede">dede</a></code>,
<code><a href="#topic+dde.syst">dde.syst</a></code>, <code><a href="#topic+dde.lags">dde.lags</a></code>, 
<code><a href="#topic+explicit.model">explicit.model</a></code>, <code><a href="#topic+ode.model">ode.model</a></code>,
<code><a href="#topic+init.cond">init.cond</a></code>, <code><a href="#topic+input.scaling">input.scaling</a></code>,
<code><a href="#topic+make.dosing">make.dosing</a></code>, <code><a href="#topic+init.update">init.update</a></code>,
<code><a href="#topic+de.output">de.output</a></code>
</p>

<hr>
<h2 id='dde.utils'>
Utility Functions for Delay Differential Equation Systems
</h2><span id='topic+dde.syst'></span><span id='topic+dde.lags'></span>

<h3>Description</h3>

<p>This is a collection of utility functions called by <code>dde.model</code> when 
a model defined by delay differential equations is evaluated. None of these 
functions is typically called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  dde.syst(t = NULL,
           y = NULL,
           ic = NULL,
           parms = NULL,
           derparms = NULL,
           delags = NULL,
           codedde = NULL,
           dosing = NULL,
           has.dosing = NULL,
           dose.states = NULL,
           xdata = NULL,
           covdata = NULL,
           scale = NULL,
           check = FALSE)
  dde.lags(parms = NULL,
           derparms = NULL,
           codelags = NULL,
           check = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dde.utils_+3A_t">t</code></td>
<td>
<p>A scalar or a vector of numerical time values.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_y">y</code></td>
<td>
<p>A vector of system state values.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_ic">ic</code></td>
<td>
<p>A vector of initial conditions, typically returned by 
<code>init.cond</code>.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_delags">delags</code></td>
<td>
<p>A vector of delay parameters, typically returned by 
<code>dde.lags</code>.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_codedde">codedde</code></td>
<td>
<p>The content of the R code specified within the $DDE block in 
the model file.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_dosing">dosing</code></td>
<td>
<p>A data.frame of dosing information created by <code>make.dosing</code>
from instantaneous and zero-order inputs into the system and containing the 
following columns: </p>

<dl>
<dt>TIME</dt><dd><p>Dosing event times.</p>
</dd>
<dt>CMT</dt><dd><p>State where the input should be assigned to.</p>
</dd>
<dt>AMT</dt><dd><p>Amount that should be assigned to system <code>state</code> at the
corresponding <code>TIME</code>.</p>
</dd>
<dt>RATE</dt><dd><p>Rate of input that should be assigned to system <code>CMT</code> at 
the corresponding <code>TIME</code>. See 
<code>vignette('scaRabee',package='scaRabee')</code> for more details about
the interpolation of the input rate at time not specified in
<code>dosing</code>.</p>
</dd>
<dt>TYPE</dt><dd><p>An indicator of the type of input. <code>TYPE</code> is set to 1 if
the record in <code>dosing</code> correspond an original bolus input; it is 
set to 0 otherwise.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="dde.utils_+3A_has.dosing">has.dosing</code></td>
<td>
<p>A logical variable, indicating whether any input has to
be assigned to a system state.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_dose.states">dose.states</code></td>
<td>
<p>A vector of integers, indicating in which system state one
or more doses have to be assigned to.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_covdata">covdata</code></td>
<td>
<p>A matrix of covariate data extracted from the dataset.</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_scale">scale</code></td>
<td>
<p>A vector of system scale, typically returned by 
<code>input.scaling</code></p>
</td></tr>
<tr><td><code id="dde.utils_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs</p>
</td></tr>
<tr><td><code id="dde.utils_+3A_codelags">codelags</code></td>
<td>
<p>The content of the R code specified within the $LAGS block in
the model file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>dde.syst</code> is the function which actually evaluates the system of delay
differential equations specified in the $DDE block.
</p>
<p><code>dde.lags</code> is the function which evaluates the code specified in the $LAG 
block and defines the delays at which the system needs to be computed.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dde.model">dde.model</a></code>, <code><a href="#topic+make.dosing">make.dosing</a></code>
</p>

<hr>
<h2 id='estimation.plot'>
Create Summary Estimation Plots
</h2><span id='topic+estimation.plot'></span>

<h3>Description</h3>

<p><code>estimation.plot</code> is a secondary function called at the end of the
estimation runs. It generates plots from the iteration log file and the
prediction &amp; residual file. Those plots are: a figure summarizing the changes
in the objective function and the estimated parameter values as a function of
the iteration plus, for each subject and sub-problem (i.e. treatment), a 
figure overlaying model predictions and observed data, and another figure 
showing 4 goodness-of-fit plots (predictions vs observations, weighted 
residuals vs time, weighted residuals vs observations, weighted residuals vs 
predictions). See <code>vignette('scaRabee',package='scaRabee')</code> for more 
details. <code>estimation.plot</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  estimation.plot(problem = NULL,
                  Fit = NULL,
                  files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="estimation.plot_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd>
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="estimation.plot_+3A_fit">Fit</code></td>
<td>
<p>A list containing the following elements:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt><dd><p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt><dd><p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the initial estimates of the primary model parameters.</p>
</dd>
<dt>names</dt><dd><p>The vector of names of the secondary parameter estimates.</p>
</dd>
<dt>pder</dt><dd><p>The matrix of partial derivatives for the secondary
parameter estimates.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>

</dd>
<dt>orderedfixed</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted fixed estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>orderedinitial</dt><dd><p>A data.frame with the same content as
<code>problem$init</code> but sorted by <code>order.param.list</code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="estimation.plot_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='examples.data'>
Datasets for scaRabee demo.
</h2><span id='topic+example1.data'></span><span id='topic+example2.data'></span><span id='topic+example3.data'></span><span id='topic+example4.data'></span><span id='topic+example6.data'></span><span id='topic+example8.data'></span><span id='topic+example1.initials'></span><span id='topic+example2.initials'></span><span id='topic+example3.initials'></span><span id='topic+example4.initials'></span><span id='topic+example6.initials'></span><span id='topic+example8.initials'></span>

<h3>Description</h3>

<p>Datasets for scaRabee demo.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  data(example1.data)
  data(example1.initials)
  
  data(example2.data)
  data(example2.initials)
  
  data(example3.data)
  data(example3.initials)
  
  data(example4.data)
  data(example4.initials)
  
  data(example6.data)
  data(example6.initials)
  
  data(example8.data)
  data(example8.initials)
</code></pre>


<h3>Format</h3>

<p>All example#.data are data.frame of observations and dosing events organized
as typical scaRabee datasets.
</p>
<p>All example#.initials are data.frame of parameter names and values organized
as typical scaRabee parameter files.
</p>


<h3>Details</h3>

<p>These datasets are intended to be used in the scaRabee package demos.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example1.data)
data(example1.initials)
</code></pre>

<hr>
<h2 id='explicit.model'>
Explicit Equations
</h2><span id='topic+explicit.model'></span>

<h3>Description</h3>

<p><code>explicit.model</code> is the system evaluation function called when neither
$ODE or $DDE blocks are detected in the model file, indicating that the model
is defined by explicit equations. <code>explicit.model</code> is typically not 
called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  explicit.model(parms = NULL,
                 derparms = NULL,
                 code = NULL,
                 bolus = NULL,
                 infusion = NULL,
                 xdata = NULL,
                 covdata = NULL,
                 issim = 0,
                 check = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="explicit.model_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code. (NULL for <code>explicit.model</code>).</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_code">code</code></td>
<td>
<p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_bolus">bolus</code></td>
<td>
<p>A data.frame providing the instantaneous inputs  entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_infusion">infusion</code></td>
<td>
<p>A data.frame providing the zero-order inputs entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_covdata">covdata</code></td>
<td>
<p>A data.frame of covariate data for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_issim">issim</code></td>
<td>
<p>An indicator for simulation or estimation runs.</p>
</td></tr>
<tr><td><code id="explicit.model_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>explicit.model</code> evaluates the model for each treatment of each 
individual contained in the dataset, based upon the code specified in the 
$OUTPUT block in the model file.
</p>


<h3>Value</h3>

<p>Returns a matrix of system predictions.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='finalize.grid.report'>
Finalize Direct Grid Search Report
</h2><span id='topic+finalize.grid.report'></span>

<h3>Description</h3>

<p><code>finalize.grid.report</code> is a secondary function called at the end of the 
direct grid search step of the direct grid search runs (this step is actually
by a simulation step). It outputs to the report file the grid search summary 
table produced by <code>scarabee.gridsearch</code>. <code>finalize.grid.report</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  finalize.grid.report(problem = NULL,
                      fgrid = NULL,
                      files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="finalize.grid.report_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="finalize.grid.report_+3A_fgrid">fgrid</code></td>
<td>
<p>A data.frame with pe+2 columns. The last 2 columns report the
value and the feasibility of the objective function at each specific vector of 
parameter estimates which is documented in the first pe columns. This 
data.frame must be ordered by feasibility and increasing value of the objective
function.</p>
</td></tr>
<tr><td><code id="finalize.grid.report_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration. (Not used for
direct grid search runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting the summary tables of ordered 
objective function values for the various tested vectors of model 
parameters.</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for direct grid search 
runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for direct grid search runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for direct grid search runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Does not return any value.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.gridsearch">scarabee.gridsearch</a></code>,
</p>

<hr>
<h2 id='finalize.report'>
Finalize Estimation Report
</h2><span id='topic+finalize.report'></span>

<h3>Description</h3>

<p><code>finalize.report</code> is a secondary function called at the end of the 
estimation runs. It outputs to the report file the final parameter estimates
for structural model parameters, residual variability and secondary parameters
as well as the related statistics (coefficients of variation, confidence
intervals, covariance and correlation matrix). <code>finalize.report</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  finalize.report(problem = NULL,
                  Fit = NULL,
                  files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="finalize.report_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="finalize.report_+3A_fit">Fit</code></td>
<td>
<p>A list containing the following elements:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt><dd><p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt><dd><p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the initial estimates of the primary model parameters.</p>
</dd>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the final estimates of the primary model parameters.</p>
</dd>
<dt>names</dt><dd><p>The vector of names of the secondary parameter estimates.</p>
</dd>
<dt>pder</dt><dd><p>The matrix of partial derivatives for the secondary
parameter estimates.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>

</dd>
</dl>

</td></tr>
<tr><td><code id="finalize.report_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Return a modified version of <code>Fit</code>, containing the following elements:
</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt><dd><p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt><dd><p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt><dd><p>A vector of secondary parameter estimates.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>

</dd>
<dt>orderedfixed</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted fixed estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>orderedinitial</dt><dd><p>A data.frame with the same content as
<code>problem$init</code> but sorted by <code>order.param.list</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+order.parms.list">order.parms.list</a></code>,
</p>

<hr>
<h2 id='fitmle'>
Maximum Likelihood Estimator
</h2><span id='topic+fitmle'></span>

<h3>Description</h3>

<p><code>fitmle</code> is a secondary function called during estimation runs. It 
performs the optimization of the model parameters by the method of the maximum
likelihood, i.e. the minimization of an objective function defined as the 
exact negative log likelihood of the observed data, given the structural 
model, the model of residual variability, and the parameter estimates. This 
minimization is performed by the Nelder-Mead simplex algorithm implemented in 
<code>fminsearch</code> from the <span class="pkg">neldermead</span> package. <code>fitmle</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  fitmle(problem = NULL,
         estim.options = NULL,
         files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitmle_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="fitmle_+3A_estim.options">estim.options</code></td>
<td>
<p>A list of estimation options containing two elements
<code>maxiter</code> (the maximum number of iterations) and <code>maxeval</code> (the
maximum number of function evaluations).
</p>
</td></tr>
<tr><td><code id="fitmle_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with two elements: <code>estimations</code> which contains the vector
of final parameter estimates and <code>fval</code> the minimal value of the
objective function.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>
<p>Pawel Wiczling
</p>


<h3>See Also</h3>

<p><code><a href="neldermead.html#topic+fminsearch">fminsearch</a></code>
</p>

<hr>
<h2 id='fitmle.cov'>
Computation of the Covariance Matrix
</h2><span id='topic+fitmle.cov'></span>

<h3>Description</h3>

<p><code>fitmle.cov</code> is a secondary function called during estimation runs. It 
performs multiple tasks after completion of the model optimization by
<code>fitmle</code>:
</p>
<p>1- It computes the matrix of covariance (as described by D'Argenio and 
Schumitzky) by calling <code>get.cov.matrix</code> and derives some related
statistics: correlation matrix, coefficient of variation of parameter
estimates, confidence intervals and Akaike Information criterion,
</p>
<p>2- It estimates secondary parameters and computes the coefficient of variation
of those estimates, as well as the confidence intervals.
</p>
<p><code>fitmle.cov</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  fitmle.cov(problem = NULL,
             Fit = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitmle.cov_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="fitmle.cov_+3A_fit">Fit</code></td>
<td>
<p>A list of containing the following levels:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Return a list containing the following elements:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt><dd><p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt><dd><p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the initial estimates of the primary model parameters.</p>
</dd>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the final estimates of the primary model parameters.</p>
</dd>
<dt>names</dt><dd><p>The vector of names of the secondary parameter estimates.</p>
</dd>
<dt>pder</dt><dd><p>The matrix of partial derivatives for the secondary
parameter estimates.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>

</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>
<p>Pawel Wiczling
</p>


<h3>References</h3>

<p>D.Z. D'Argenio and A. Schumitzky. ADAPT II User's Guide: Pharmacokinetic/
Pharmacodynamic Systems Analysis Software. Biomedical Simulations Resource,
Los Angeles, 1997.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmle">fitmle</a></code>, <code><a href="#topic+order.parms.list">order.parms.list</a></code>
</p>

<hr>
<h2 id='get.cov.matrix'>
Computation of the Covariance Matrix
</h2><span id='topic+get.cov.matrix'></span>

<h3>Description</h3>

<p><code>get.cov.matrix</code> is a secondary function called during estimation runs by 
<code>fitmle.cov</code>. It computes the covariance matrix for the parameter
estimates. <code>get.cov.matrix</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  get.cov.matrix(problem = NULL,
                 Fit = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.cov.matrix_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="get.cov.matrix_+3A_fit">Fit</code></td>
<td>
<p>A list of containing the following levels:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with the following elements: </p>

<dl>
<dt>covmatrix</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmle.cov">fitmle.cov</a></code>
</p>

<hr>
<h2 id='get.events'>
Create events from bolus dosing records.
</h2><span id='topic+get.events'></span>

<h3>Description</h3>

<p><code>get.events</code> is a secondary function called by <code>dde.model</code>. It 
creates a data.frame of events from the bolus dosing records found in the 
dataset. <code>get.events</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  get.events(bolus = NULL, 
             scale = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.events_+3A_bolus">bolus</code></td>
<td>
<p>b x 4 data.frame providing the instantaneous inputs</p>
</td></tr>
<tr><td><code id="get.events_+3A_scale">scale</code></td>
<td>
<p>s x 1 vector of scaling factors</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a data.frame of events with the following elements: </p>

<dl>
<dt>var</dt><dd><p>A name of the state affected by the event</p>
</dd>
<dt>time</dt><dd><p>The time of the event</p>
</dd>
<dt>value</dt><dd><p>The value associated with the event</p>
</dd>
<dt>method</dt><dd><p>How the event affects the state ('add' by default)</p>
</dd>
</dl>

<p>See <code><a href="deSolve.html#topic+events">events</a></code> for more details
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p>code<a href="deSolve.html#topic+events">events</a>
</p>

<hr>
<h2 id='get.layout'>
Layout for Lattice Functions
</h2><span id='topic+get.layout'></span>

<h3>Description</h3>

<p><code>get.layout</code> is a utility function called by <code>estimation.plot</code> and 
<code>simulation.plot</code>. It provides a layout for <span class="pkg">lattice</span> functions based
upon a user-defined number of plots per page. <code>get.layout</code> is typically 
not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  get.layout(nplot = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.layout_+3A_nplot">nplot</code></td>
<td>
<p>A integer scalar defining the number of plots per page.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a vector of two integers (nx,ny), where nx is the number of rows and
ny the number of columns for the <span class="pkg">lattice</span> layout.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+estimation.plot">estimation.plot</a></code>,
<code><a href="#topic+simulation.plot">simulation.plot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  get.layout(1)
  get.layout(7)
  ## Not run: get.layout(1:5)
  ## Not run: get.layout(NA)
</code></pre>

<hr>
<h2 id='get.parms.data'>
Extract data from scaRabee parameter table
</h2><span id='topic+get.parms.data'></span>

<h3>Description</h3>

<p><code>get.parms.data</code> is a utility function in <span class="pkg">scaRabee</span>. It allows to 
extract from a parameter table <code>x</code> all the data of a given type
<code>which</code> for a set of parameter of type <code>type</code>. <code>get.parms.data</code>
is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  get.parms.data(x = NULL,
                 which = NULL,
                 type = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.parms.data_+3A_x">x</code></td>
<td>
<p>A data.frame of parameter data with the following columns: 'names', 
'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</td></tr>
<tr><td><code id="get.parms.data_+3A_which">which</code></td>
<td>
<p>A single string of characters, either 'names', 'type', 'value' or
'isfix'.</p>
</td></tr>
<tr><td><code id="get.parms.data_+3A_type">type</code></td>
<td>
<p>A single string of characters, either 'P', 'L', 'V' or 'IC'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return as a vector the content of the <code>which</code> column of <code>x</code> 
corresponding to the <code>type</code> parameters.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='get.secondary'>
Computation of Secondary Parameter Estimates
</h2><span id='topic+get.secondary'></span>

<h3>Description</h3>

<p><code>get.secondary</code> is a secondary function called during estimation runs by 
<code>fitmle.cov</code>. It computes estimates of secondary parameters and related
statistics (covariance, coefficient of variations, and confidence intervals).
<code>get.secondary</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get.secondary(subproblem = NULL,
              x = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="get.secondary_+3A_subproblem">subproblem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list containing as many levels as there are treatment levels 
for the subject (or population) being evaluated, plus the <code>trts</code> 
level listing all treatments for this subject (or population), and the 
<code>id</code> level giving the identification number of the subject (or set to
1 if the analysis was run at the level of the population.
</p>
<p>Each treatment-specific level is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="get.secondary_+3A_x">x</code></td>
<td>
<p>The vector of <em>p</em> parameter estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of with the following elements:</p>

<dl>
<dt>init</dt><dd><p>The vector of <em>s</em> secondary parameter estimates derived
from initial structural model parameter estimates.</p>
</dd>
<dt>estimates</dt><dd><p>The vector of <em>s</em> secondary parameter estimates
derived from final structural model parameter estimates.</p>
</dd>
<dt>names</dt><dd><p>The vector of <em>s</em> secondary parameter names.</p>
</dd>
<dt>pder</dt><dd><p>The <em>p</em> x <em>s</em> matrix of partial derivatives for the
secondary parameters.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmle.cov">fitmle.cov</a></code>
</p>

<hr>
<h2 id='initialize.report'>
Initialize Report Files
</h2><span id='topic+initialize.report'></span>

<h3>Description</h3>

<p><code>initialize.report</code> is a secondary function called during direct grid 
search or estimation runs. 
</p>
<p>For direct grid search runs, <code>initialize.report</code> creates the report file 
in the results &amp; backup directory. This report file reports information about 
the run, including a summary table of the grid search which gives the value of 
the objective function for the different vector of estimates tested.
</p>
<p>For estimation runs, <code>initialize.report</code> creates the log file and the 
report file in the results &amp; backup directory. The log file stores, for each 
subject in the analysis, the values of the objective function and the 
parameter estimates at each iteration of the estimation process. The report 
file reports information about the estimation run, including the final 
estimates and some related statistics.
</p>
<p><code>initialize.report</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  initialize.report(problem = NULL,
                   param = NULL,
                   files = NULL,
                   isgrid = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="initialize.report_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="initialize.report_+3A_param">param</code></td>
<td>
<p>A data.frame containing the values of fixed and variable 
parameter estimates. Expected to contain the 'names', 'type', 'value',
'isfix', 'lb', and 'ub' columns.</p>
</td></tr>
<tr><td><code id="initialize.report_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="initialize.report_+3A_isgrid">isgrid</code></td>
<td>
<p>Indicator of direct grid search runs.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='ode.model'>
Ordinary Differential Equations
</h2><span id='topic+ode.model'></span>

<h3>Description</h3>

<p><code>ode.model</code> is the system evaluation function called when an $ODE block
is detected in the model file, indicating that the model is defined by 
ordinary differential equations. <code>ode.model</code> is typically not called 
directly by users
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ode.model(parms = NULL,
            derparms = NULL,
            code = NULL,
            bolus = NULL,
            infusion = NULL,
            xdata = NULL,
            covdata = NULL,
            issim = 0,
            check = FALSE,
            options = list(method='lsoda'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ode.model_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_code">code</code></td>
<td>
<p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_bolus">bolus</code></td>
<td>
<p>A data.frame providing the instantaneous inputs  entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_infusion">infusion</code></td>
<td>
<p>A data.frame providing the zero-order inputs entering the 
system of delay differential equations for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_covdata">covdata</code></td>
<td>
<p>A data.frame of covariate data for the treatment and individual 
being evaluated.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_issim">issim</code></td>
<td>
<p>An indicator for simulation or estimation runs.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs.</p>
</td></tr>
<tr><td><code id="ode.model_+3A_options">options</code></td>
<td>
<p>A list of differential equation solver options. Currently
not modifiable by users.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ode.model</code> evaluates the model for each treatment of each individual 
contained in the dataset using several utility functions: <code>derived.parms</code>,
<code>init.cond</code>, <code>input.scaling</code>, <code>make.dosing</code>, <code>init.update</code>,
and <code>de.output</code>.
</p>
<p>The actual evaluation of the system is performed by <code>ode</code> from the 
<span class="pkg">deSolve</span> package.
</p>


<h3>Value</h3>

<p>Returns a matrix of system predictions.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="deSolve.html#topic+ode">ode</a></code>,
<code><a href="#topic+init.cond">init.cond</a></code>, <code><a href="#topic+input.scaling">input.scaling</a></code>,
<code><a href="#topic+make.dosing">make.dosing</a></code>, <code><a href="#topic+init.update">init.update</a></code>,
<code><a href="#topic+de.output">de.output</a></code>
</p>

<hr>
<h2 id='ode.utils'>
Utility Functions for Ordinary Differential Equation Systems
</h2><span id='topic+create.intervals'></span><span id='topic+de.output'></span><span id='topic+derived.parms'></span><span id='topic+init.cond'></span><span id='topic+init.update'></span><span id='topic+input.scaling'></span><span id='topic+make.dosing'></span><span id='topic+ode.syst'></span>

<h3>Description</h3>

<p>This is a collection of utility functions called by <code>ode.model</code> (and for 
some by <code>dde.model</code> when a model defined by ordinary (or delay)
differential equations is evaluated. None of these functions is typically 
called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ode.syst(t = NULL,
           y = NULL,
           parms = NULL,
           derparms = NULL,
           codeode = NULL,
           dosing = NULL,
           has.dosing = NULL,
           dose.states = NULL,
           covdata = NULL,
           scale = NULL,
           check = FALSE)
  create.intervals(xdata = NULL,
                   bolus = NULL,
                   infusion = NULL)
  de.output(f = NULL,
            parms = NULL,
            derparms = NULL,
            codeoutput = NULL,
            dosing = NULL,
            xdata = NULL,
            check = FALSE)
  derived.parms(parms = NULL,
                covdata,
                codederiv = NULL,
                check = FALSE)
  init.cond(parms = NULL,
            derparms = NULL,
            codeic = NULL,
            dosing = NULL,
            check = FALSE)
  input.scaling(parms = NULL,
                derparms = NULL,
                codescale = NULL,
                ic = NULL,
                check = FALSE)
  make.dosing(allparms = NULL,
              bolus = NULL,
              infusion = NULL,
              check = FALSE)
  init.update(a = NULL,
              t = NULL,
              dosing = NULL,
              scale = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ode.utils_+3A_t">t</code></td>
<td>
<p>A scalar or a vector of numerical time values.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_y">y</code></td>
<td>
<p>A vector of system state values.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_codeode">codeode</code></td>
<td>
<p>The content of the R code specified within the $ODE block 
in the model file.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_dosing">dosing</code></td>
<td>
<p>A data.frame of dosing information created by <code>make.dosing</code>
from instantaneous and zero-order inputs into the system and containing the 
following columns: </p>

<dl>
<dt>TIME</dt><dd><p>Dosing event times.</p>
</dd>
<dt>CMT</dt><dd><p>State where the input should be assigned to.</p>
</dd>
<dt>AMT</dt><dd><p>Amount that should be assigned to system <code>state</code> at the
corresponding <code>TIME</code>.</p>
</dd>
<dt>RATE</dt><dd><p>Rate of input that should be assigned to system <code>CMT</code> at 
the corresponding <code>TIME</code>. See 
<code>vignette('scaRabee',package='scaRabee')</code> for more details about
the interpolation of the input rate at time not specified in
<code>dosing</code>.</p>
</dd>
<dt>TYPE</dt><dd><p>An indicator of the type of input. <code>TYPE</code> is set to 1 if
the record in <code>dosing</code> correspond an original bolus input; it is 
set to 0 otherwise.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="ode.utils_+3A_has.dosing">has.dosing</code></td>
<td>
<p>A logical variable, indicating whether any input has to
be assigned to a system state.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_dose.states">dose.states</code></td>
<td>
<p>A vector of integers, indicating in which system state one
or more doses have to be assigned to.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_covdata">covdata</code></td>
<td>
<p>A matrix of covariate data extracted from the dataset.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_scale">scale</code></td>
<td>
<p>A vector of system scale, typically returned by 
<code>input.scaling</code></p>
</td></tr>
<tr><td><code id="ode.utils_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_bolus">bolus</code></td>
<td>
<p>bij x 4 data.frame providing the instantaneous inputs for a 
treatment and individual.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_infusion">infusion</code></td>
<td>
<p>fij x (4+c) data.frame providing the zero-order inputs for a
treatment and individual.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_f">f</code></td>
<td>
<p>A matrix of time (first row) and system predictions. In the 
<code>de.output</code> function, the first row is deleted so that <code>f</code> has
the same number of rows as in <code>dadt</code> defined in the $ODE or $DDE block.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_codeoutput">codeoutput</code></td>
<td>
<p>The content of the R code specified within the $OUTPUT block 
in the model file.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_codederiv">codederiv</code></td>
<td>
<p>The content of the R code specified within the $DERIVED block 
in the model file.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_codeic">codeic</code></td>
<td>
<p>The content of the R code specified within the $IC block in the 
model file.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_codescale">codescale</code></td>
<td>
<p>The content of the R code specified within the $SCALE block 
in the model file.</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_ic">ic</code></td>
<td>
<p>A vector of initial conditions, typically returned by <code>init.cond</code></p>
</td></tr>
<tr><td><code id="ode.utils_+3A_allparms">allparms</code></td>
<td>
<p>A vector of parameters (primary+derived).</p>
</td></tr>
<tr><td><code id="ode.utils_+3A_a">a</code></td>
<td>
<p>A vector of system state values, similar to <code>y</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ode.syst</code> is the function which actually evaluates the system of
ordinary differential equations specified in the $ODE block.
</p>
<p><code>create.intervals</code> is a function that allows the overall integration 
interval to be split into sub-intervals based upon dosing history.
This allows for the exact implementation of bolus inputs into the system. It
determines the number of unique bolus dosing events there is by system state 
in <code>dosing</code>. It then creates the sub-intervals using these unique event 
times. If the first dosing events occurs after the first observation time, an 
initial sub-interval is added.
</p>
<p><code>de.output</code> is the function which evaluates the code specified in the 
$OUTPUT block and, thus, defines the output of the model.
</p>
<p><code>derived.parms</code> is the function which evaluates the code provided in the
$DERIVED block and calculate derived parameters. It prevents primary 
parameters and covariates from being edited.
</p>
<p><code>init.cond</code> is the function which evaluates the code provided in the $IC
block, and, thus, defines the initial conditions of the system.
</p>
<p><code>input.scaling</code> is the function which evaluates the code provided in the
$SCALE block, and, thus, defines how system inputs are scaled.
</p>
<p><code>make.dosing</code> is the function which processes the instantaneous and 
zero-order inputs provided in the dataset and creates the <code>dosing</code> 
object. This function also implements absorption lags if the user included
ALAGx parameters in <code>parms</code> or <code>derpamrs</code>.
</p>
<p><code>init.update</code> is a function that updates the system states at the 
beginning of each integration interval created by <code>create.intervals</code> to 
provide an exact implementation of bolus inputs into the system.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dde.model">dde.model</a></code>
</p>

<hr>
<h2 id='order.parms.list'>
Sort a scaRabee parameter table
</h2><span id='topic+order.parms.list'></span>

<h3>Description</h3>

<p><code>order.parms.list</code> is a secondary function called during estimation runs.
It reorder a data.frame of initial parameter estimates by type: structural
('P'), delays ('L'), initial conditions ('IC'), and finally variance ('V').
<code>order.parms.list</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  order.parms.list(x = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="order.parms.list_+3A_x">x</code></td>
<td>
<p>A data.frame of parameter data with the following columns: 'names', 
'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame of parameter data with the following columns: 'names', 'type', 
'value', 'isfix', 'lb', and 'ub'.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='pder'>
Compute Matrix of Partial Derivatives 
</h2><span id='topic+pder'></span>

<h3>Description</h3>

<p><code>pder</code> is a secondary function called by <code>get.cov.matrix</code>. It 
computes the matrix of partial derivatives for the model predictions and the
residual variability. <code>pder</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  pder(subproblem = NULL,
       x = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pder_+3A_subproblem">subproblem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
<dt>data</dt><dd><p>A list containing the following levels:</p>

<dl>
<dt>xdata</dt><dd><p>1 x m matrix of time of observations of the dependent
variables.</p>
</dd>
<dt>data</dt><dd><p>m x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators 
of the type of dependent variables (extracted from the CMT variable), 
and the actual dependent variable observations (extracted from the DV 
variable).</p>
</dd>
</dl>

</dd>
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for a
treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for a
treatment and individual.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of the 
dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="pder_+3A_x">x</code></td>
<td>
<p>The vector of <em>p</em> final parameter estimates.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list containing the <em>p</em> x <em>p</em> matrices of partial
derivatives for model predictions (<code>mpder</code>) and residual variability
(<code>wpder</code>).
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+get.cov.matrix">get.cov.matrix</a></code>
</p>

<hr>
<h2 id='problem.eval'>
Evaluation of structural and residual variability models
</h2><span id='topic+problem.eval'></span>

<h3>Description</h3>

<p><code>problem.eval</code> is a secondary function called during estimation runs. It 
evaluates the structural model and the residual variability model at given
point estimates and at given values of the time variable. <code>problem.eval</code> 
is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  problem.eval(subproblem = NULL,
               x = NULL,
               grid = FALSE,
               check = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="problem.eval_+3A_subproblem">subproblem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
<dt>data</dt><dd><p>A list containing the following levels:</p>

<dl>
<dt>xdata</dt><dd><p>1 x m matrix of time of observations of the dependent
variables.</p>
</dd>
<dt>data</dt><dd><p>m x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators 
of the type of dependent variables (extracted from the CMT variable), 
and the actual dependent variable observations (extracted from the DV 
variable).</p>
</dd>
</dl>

</dd>
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for a
treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for a
treatment and individual.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of the 
dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="problem.eval_+3A_x">x</code></td>
<td>
<p>A vector of numerical estimates of numerical parameters.</p>
</td></tr>
<tr><td><code id="problem.eval_+3A_grid">grid</code></td>
<td>
<p>A logical variable, indicating whether the analysis is a direct
grid search or not.</p>
</td></tr>
<tr><td><code id="problem.eval_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list of two elements: </p>

<dl>
<dt>f</dt><dd><p>A vector of model evaluations at all requested time points (all
states values are concatenated into a single vector).</p>
</dd>
<dt>weight</dt><dd><p>A vector of residual variability related to the model
evaluations.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmle">fitmle</a></code>
</p>

<hr>
<h2 id='residual.report'>
Creation of Prediction &amp; Residual Report
</h2><span id='topic+residual.report'></span>

<h3>Description</h3>

<p><code>residual.report</code> is a secondary function called at the end of the 
estimations runs. It creates a file containing the predictions, residuals and
weighted residuals at all observation time points. <code>residual.report</code> is 
typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  residual.report(problem = NULL,
                  Fit = NULL,
                  files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residual.report_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for
a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
</dl>

</td></tr>
<tr><td><code id="residual.report_+3A_fit">Fit</code></td>
<td>
<p>A list containing the following elements:</p>

<dl>
<dt>estimations</dt><dd><p>The vector of final parameter estimates.</p>
</dd>
<dt>fval</dt><dd><p>The minimal value of the objective function.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the parameter estimates.</p>
</dd>
<dt>orderedestimations</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted estimated estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>cor</dt><dd><p>The upper triangle of the correlation matrix for the parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the parameter estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the parameter estimates.</p>
</dd>
<dt>AIC</dt><dd><p>The Akaike Information Criterion.</p>
</dd>
<dt>sec</dt><dd><p>A list of data related to the secondary parameters, containing
the following elements:</p>

<dl>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the initial estimates of the primary model parameters.</p>
</dd>
<dt>estimates</dt><dd><p>The vector of secondary parameter estimates calculated
using the final estimates of the primary model parameters.</p>
</dd>
<dt>names</dt><dd><p>The vector of names of the secondary parameter estimates.</p>
</dd>
<dt>pder</dt><dd><p>The matrix of partial derivatives for the secondary
parameter estimates.</p>
</dd>
<dt>cov</dt><dd><p>The matrix of covariance for the secondary parameter
estimates.</p>
</dd>
<dt>cv</dt><dd><p>The coefficients of variations for the secondary parameter
estimates.</p>
</dd>
<dt>ci</dt><dd><p>The confidence interval for the secondary parameter
estimates.</p>
</dd>
</dl>

</dd>
<dt>orderedfixed</dt><dd><p>A data.frame with the same structure as
<code>problem$init</code> but only containing the sorted fixed estimates.
The sorting is performed by <code>order.param.list</code>.</p>
</dd>
<dt>orderedinitial</dt><dd><p>A data.frame with the same content as
<code>problem$init</code> but sorted by <code>order.param.list</code>.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="residual.report_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Creates the prediction and residual report in the run directory.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='scarabee.analysis'>
Run a scaRabee Analysis
</h2><span id='topic+scarabee.analysis'></span>

<h3>Description</h3>

<p><code>scarabee.analysis</code> is the <em>de facto</em> gateway for running any kind 
of analysis with <span class="pkg">scaRabee</span>. All other functions distributed with this
package are secondary functions called directly or indirectly by
<code>scarabee.analysis</code>.
</p>
<p>Arguments for <code>scarabee.analysis</code> are best defined using the template
distributed with the package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.analysis(files = NULL,
                    method = 'population',
                    runtype = NULL,
                    debugmode = FALSE,
                    estim.options = NULL,
                    npts = NULL,
                    alpha = NULL,
                    solver.options = list(method='lsoda'))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.analysis_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.
</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.analysis_+3A_method">method</code></td>
<td>
<p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_runtype">runtype</code></td>
<td>
<p>A character string, indicating the type of analysis. Should be
'simulation', 'estimation', or 'gridsearch'.</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_debugmode">debugmode</code></td>
<td>
<p>A logical value, indicating the debug mode should be turn on
(<code>TRUE</code>) or off (default). Used only for estimation runs. If turn on,
the user could have access to error message returned when the model and
residual variability are evaluated in <code>fitmle</code> before the likelihood
is computed.</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_estim.options">estim.options</code></td>
<td>
<p>A list of estimation options containing two elements
<code>maxiter</code> (the maximum number of iterations) and <code>maxeval</code> (the
maximum number of function evaluations).</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_npts">npts</code></td>
<td>
<p>Only necessary if <code>runtype</code> is set to 'gridsearch'; <code>npts</code> 
represents the number of points to be created by dimension of the grid 
search.</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_alpha">alpha</code></td>
<td>
<p>Only necessary if <code>runtype</code> is set to 'gridsearch'; 
<code>alpha</code> is a real number, representing the factor applied to the 
initial estimates of the model parameters to determine the lower and upper 
bounds to the grid search space.</p>
</td></tr>
<tr><td><code id="scarabee.analysis_+3A_solver.options">solver.options</code></td>
<td>
<p>A list of differential equation solver options. 
Currently not modifiable by users.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Run an analysis until completion. See 
<code>vignette('scaRabee',package='scaRabee')</code> for more details about the
expected outputs for an estimation, a simulation, or a gird search run.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+fitmle">fitmle</a></code>
</p>

<hr>
<h2 id='scarabee.check.model'>
Check scaRabee Models
</h2><span id='topic+scarabee.check.model'></span>

<h3>Description</h3>

<p><code>scarabee.check.model</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> estimation run. It runs a first set of model evaluation at the 
initial parameter estimates turning all checks on. If all checks are passed,
the estimation starts with all checks turned off. <code>scarabee.check.model</code>
is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.check.model(problem = NULL,
                       files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.check.model_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for a
treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.check.model_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='scarabee.check.reserved'>
Check for Reserved Variable Names
</h2><span id='topic+scarabee.check.reserved'></span>

<h3>Description</h3>

<p><code>scarabee.check.reserved</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> run. It determined whether user-defined parameter names use 
reserved names and if some user-defined parameters are related to the dosing
history. <code>scarabee.check.reserved</code> is typically not called directly by
users. <code>scarabee.check.reserved</code> is typically not called directly by
users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.check.reserved(names = NULL, covnames = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.check.reserved_+3A_names">names</code></td>
<td>
<p>A vector of parameter names, typically extracted from the file
of parameter definition.</p>
</td></tr>
<tr><td><code id="scarabee.check.reserved_+3A_covnames">covnames</code></td>
<td>
<p>A vector of covariate names, typically extracted from the 
data file.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If one or more user-defined parameters are found to use reserved names, the 
run is stopped and the user is ask to update the name(s) of this(ese) 
parameter(s).
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='scarabee.clean'>
Cleaning of the Run Directory
</h2><span id='topic+scarabee.clean'></span>

<h3>Description</h3>

<p><code>scarabee.clean</code> is a secondary function called at each <span class="pkg">scaRabee</span> 
run. It cleans the run directory from unwanted files. <code>scarabee.clean</code> 
is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.clean(files = NULL,
                 analysis = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.clean_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset.</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset.</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.clean_+3A_analysis">analysis</code></td>
<td>
<p>A character string directly following the $ANALYSIS tag in the
model file.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>
</p>

<hr>
<h2 id='scarabee.directory'>
Creation of the Run Directory
</h2><span id='topic+scarabee.directory'></span>

<h3>Description</h3>

<p><code>scarabee.directory</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> run. It creates a directory to store the results of the run and
a sub-directory to backup all files used for the run. This directory is
referred to as the 'run directory' in all <span class="pkg">scaRabee</span> documentation and
help. <code>scarabee.directory</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.directory(curwd = getwd(),
                     files = NULL,
                     runtype = NULL,
                     analysis = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.directory_+3A_curwd">curwd</code></td>
<td>
<p>The current working directory.</p>
</td></tr>
<tr><td><code id="scarabee.directory_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.directory_+3A_runtype">runtype</code></td>
<td>
<p>A character string, indicating the type of analysis. Should be
'simulation', 'estimation', or 'gridsearch'.</p>
</td></tr>
<tr><td><code id="scarabee.directory_+3A_analysis">analysis</code></td>
<td>
<p>A character string directly following the $ANALYSIS tag in the
model file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>When <code>scarabee.directory</code> is called, a new folder is created in the 
working directory. The name of the new folder is a combination of the string
directly following the $ANALYSIS tag in the model file, an abbreviation of the
type of run ('est' for estimation, 'sim' for simulation, or 'grid' for grid 
search) and an incremental integer, e.g. 'test.est.01'. This directory 
contains the text and graph outputs of the run.
</p>
<p>Additionally, a sub-directory called <code>run.config.files</code> is created into
the new folder and all the files defining the run, i.e. the dataset, the file 
of initial model parameters, the model file and the master R script), are
stored.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>
</p>

<hr>
<h2 id='scarabee.gridsearch'>
Direct Grid Search Utility
</h2><span id='topic+scarabee.gridsearch'></span>

<h3>Description</h3>

<p><code>scarabee.gridsearch</code> is a secondary function called during direct grid
search runs. It creates a matrix made of unique vectors of parameter 
estimates set around the vector of initial estimates and evaluates the 
objective function (i.e. minus twice the log of the exact likelihood of the 
observed data, given the structural model, the model of residual variability, 
and the vector of parameter estimates) at each of those vectors at the 
population level. The grid of objective function values is then sorted and the 
best vector is used to simulate the model at the population level. 
<code>scarabee.gridsearch</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.gridsearch(problem = NULL,
                      npts = NULL,
                      alpha = NULL,
                      files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.gridsearch_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for
a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.gridsearch_+3A_npts">npts</code></td>
<td>
<p>An integer greater than 2, defining the number of points that the 
grid should contain per dimension (i.e variable model parameter).
</p>
</td></tr>
<tr><td><code id="scarabee.gridsearch_+3A_alpha">alpha</code></td>
<td>
<p>A vector of numbers greater than 1, which give the factor(s) used
to calculate the evaluation range of each dimension of the search grid (see 
Details). If <code>alpha</code> length is lower than the number of variable 
parameters, elements of <code>alpha</code> are recycled. If its length is higher 
than number of variable parameters, <code>alpha</code> is truncated.
</p>
</td></tr>
<tr><td><code id="scarabee.gridsearch_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration. (Not used for
direct grid search runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting the summary tables of ordered 
objective function values for the various tested vectors of model 
parameters.</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for direct grid search 
runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for direct grid search runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for direct grid search runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Details</h3>

<p>The actual creation of the grid and the evaluation of the objective function
is delegated by <code>scarabee.gridsearch</code> to the <code>fmin.gridsearch</code> 
function of the <span class="pkg">neldermead</span> package.
</p>
<p>This function evaluates the cost function - that is, in the present case, the
objective function - at each point of a grid of <code>npts^length(x0)</code> points,
where <code>x0</code> is the vector of model parameters set as variable. If 
<code>alpha</code> is NULL, the range of the evaluation points is limited by the 
lower and upper bounds of each parameter of <code>x0</code> provided in the 
parameter file. If <code>alpha</code> is not NULL, the range of the evaluation 
points is defined as <code>[x0/alpha,x0*alpha]</code>.
</p>
<p>Because <code>fmin.gridsearch</code> can be applied to the evaluation of constrained 
systems, it also assesses the feasibility of the cost function at each point
of the grid (i.e. whether or not the points satisfy the defined constraints). 
In the context of scaRabee, the objective function is always feasible.
</p>


<h3>Value</h3>

<p>Return a data.frame with pe+2 columns. The last 2 columns report the value 
and the feasibility of the objective function at each specific vector of 
parameter estimates which is documented in the first pe columns. This 
data.frame is ordered by feasibility and increasing value of the objective
function.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="neldermead.html#topic+fmin.gridsearch">fmin.gridsearch</a></code>
</p>

<hr>
<h2 id='scarabee.new'>
Create a scaRabee Analysis Folder
</h2><span id='topic+scarabee.new'></span>

<h3>Description</h3>

<p><code>scarabee.new</code> creates a new <span class="pkg">scaRabee</span> analysis folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.new(name = 'myanalysis',
               path = NULL,
               type = 'simulation',
               method = 'population',
               template = 'ode')
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.new_+3A_name">name</code></td>
<td>
<p>A string of characters defining the name of the master analysis
script; <code>name</code> is also appended to the $ANALYSIS tag in the model file.
Default is 'myanalysis'.</p>
</td></tr>
<tr><td><code id="scarabee.new_+3A_path">path</code></td>
<td>
<p>A path where the analysis files must be created. The path must 
not yet exist.</p>
</td></tr>
<tr><td><code id="scarabee.new_+3A_type">type</code></td>
<td>
<p>A string of characters, either 'simulation', 'estimation', or 
'gridsearch'. Default is 'simulation'.</p>
</td></tr>
<tr><td><code id="scarabee.new_+3A_method">method</code></td>
<td>
<p>A string of characters, either 'population' or 'subject'.
Default is 'population'.</p>
</td></tr>
<tr><td><code id="scarabee.new_+3A_template">template</code></td>
<td>
<p>A string of characters, either 'explicit', 'ode' or 'dde'.
Default is 'ode'.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The content of new <span class="pkg">scaRabee</span> analysis folder <code>path</code>/
is:</p>

<dl>
<dt><code>name</code>.R</dt><dd><p>The template-based <span class="pkg">scaRabee</span> analysis script.</p>
</dd>
<dt>model.txt</dt><dd><p>A template-based txt file for the definition of the
structural model. Depending on <code>template</code>, this text file contains
various tags which delimit blocks of R code needed when models are defined
with closed form solution ('explicit'), ordinary differential equations 
('ode') or delay differential equations ('dde').</p>
</dd>
<dt>data.csv</dt><dd><p>(optional) An empty comma-separated file for dosing, 
observations, and covariate information; contains the following default
headers: OMIT, TRT, ID, TIME, AMT, RATE, CMT, EVID, DV, DVID, and MDV.</p>
</dd>
<dt>initials.csv</dt><dd><p>(optional) An empty comma-separated file for initial
guesses of model parameter estimates; contains the following default
headers: Parameter, Type, Value, Fixed, Lower bound, Upper bound.</p>
</dd>
</dl>

<p>If the <code>path</code> argument is NULL, then it is coerced to <code>name</code>, thus 
creating a new folder in the current working directory.
</p>
<p>See <code>vignette('scaRabee',package='scaRabee')</code> to learn about how to
specify your model based on those template files.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='scarabee.read.data'>
Read scaRabee Data File
</h2><span id='topic+scarabee.read.data'></span>

<h3>Description</h3>

<p><code>scarabee.read.data</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> run. It reads and processes the data contained in the specified
data file.<code>scarabee.read.data</code> is typically not called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.read.data(files = NULL,
                     method = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.read.data_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.read.data_+3A_method">method</code></td>
<td>
<p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with 2 levels: </p>

<dl>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code> 
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd>
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs for
a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd>
</dl>

</dd>
<dt>new</dt><dd><p>A logical indicator defining whether or not a modified data file
has been created based upon the original file. This is the case if and 
if only the time of first data record for one or more individuals in the 
original data file is not 0. The new data file is created such as the
TIME variable is modified so that time of the first data record for all 
individuals is 0; the time of later records is modified accordingly.
</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>
</p>

<hr>
<h2 id='scarabee.read.model'>
Read scaRabee Model File
</h2><span id='topic+scarabee.read.model'></span>

<h3>Description</h3>

<p><code>scarabee.read.model</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> run. It reads and processes the data contained in the specified
model file. This function performs numerous checks to ensure that the model 
file contains the expected information. <code>scarabee.read.model</code> is 
typically not be called directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.read.model(files = NULL, 
                      runtype = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.read.model_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="scarabee.read.model_+3A_runtype">runtype</code></td>
<td>
<p>A single character string, indicating the type of run; either
'estimation', 'simulation', or 'gridsearch'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a list with various levels, depending on the content of the model file
and the type of run:</p>

<dl>
<dt>name</dt><dd><p>The character string which follows the $ANALYSIS tag.</p>
</dd>
<dt>template</dt><dd><p>A character string, indicating which scaRabee function needs
to be called to evaluate the model. This level is set to 'ode.model' if
the $ODE tag is detected, to 'dde.model' if the $DDE tag is detected, and 
to 'explicit.model' otherwise.</p>
</dd>
<dt>derived</dt><dd><p>A character string containing the R code provided within the
$DERIVED block. (Only for models defined with $ODE or $DDE).</p>
</dd>
<dt>ic</dt><dd><p>A character string containing the R code provided within the $IC 
block. (Only for models defined with $ODE or $DDE).</p>
</dd>
<dt>scale</dt><dd><p>A character string containing the R code provided within the
$SCALE block. (Only for models defined with $ODE or $DDE).</p>
</dd>
<dt>de</dt><dd><p>A character string containing the R code provided within the
$ODE or $DDE block. (Only for models defined with $ODE or $DDE).</p>
</dd>
<dt>lags</dt><dd><p>A character string containing the R code provided within the
$LAGS block. (Only for models defined with $DDE).</p>
</dd>
<dt>output</dt><dd><p>A character string containing the R code provided within the
$OUTPUT block.</p>
</dd>
<dt>var</dt><dd><p>A character string containing the R code provided within the
$VARIANCE block.</p>
</dd>
<dt>sec</dt><dd><p>A character string containing the R code provided within the
$SECONDARY block.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>
</p>

<hr>
<h2 id='scarabee.read.parms'>
Read scaRabee Parameter File
</h2><span id='topic+scarabee.read.parms'></span>

<h3>Description</h3>

<p><code>scarabee.read.parms</code> is a secondary function called at each 
<span class="pkg">scaRabee</span> run. It reads and checks the information contained in the 
specified parameter file.<code>scarabee.read.parms</code> is typically not called
directly by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  scarabee.read.parms(files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="scarabee.read.parms_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>If the content of the parameter file is valid, <code>scarabee.read.parms</code>
returns a data.frame with the same content. The names of the data.frame 
columns are: names, type, value, isfix, lb, and ub.
</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+scarabee.analysis">scarabee.analysis</a></code>
</p>

<hr>
<h2 id='simulation.plot'>
Create Simulation Plots
</h2><span id='topic+simulation.plot'></span>

<h3>Description</h3>

<p><code>simulation.plot</code> is a secondary function called at the end of the 
simulation runs. It generates overlay plots of model predictions and
observations for all the output system states and for each subject in the 
analysis. If the analysis is run at the population level, only one set of 
plots is generated. See <code>vignette('scaRabee',package='scaRabee')</code> for 
more details. <code>simulation.plot</code> is typically not called directly by
users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  simulation.plot(problem = NULL,
                  simdf = NULL,
                  files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.plot_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="simulation.plot_+3A_simdf">simdf</code></td>
<td>
<p>A data.frame of simulated and observed data typically created
by <code>simulation.report</code> and containing the following columns: </p>

<dl>
<dt>ID</dt><dd><p>Subject Identifier. If the analysis is run at the population level
and if the original dataset contained multiple subjects distinguished by
a different ID number, please note that the original ID is lost and 
replaced by 1 so that all available data is considered to come from the 
same subject.</p>
</dd>
<dt>TRT</dt><dd><p>Indicator of treatment level (defining the sub-problems).</p>
</dd>
<dt>CMT</dt><dd><p>Indicator of system state to which the simulated or observed 
value is associated.</p>
</dd>
<dt>TIME</dt><dd><p>Time of the observation or model prediction.</p>
</dd>
<dt>SIM</dt><dd><p>Value of the simulated state. NA if DV is not NA.</p>
</dd>
<dt>DV</dt><dd><p>Value of the observed state. NA if SIM is not NA.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="simulation.plot_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay 
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>


<h3>See Also</h3>

<p><code><a href="#topic+simulation.report">simulation.report</a></code>
</p>

<hr>
<h2 id='simulation.report'>
Simulations
</h2><span id='topic+simulation.report'></span>

<h3>Description</h3>

<p><code>simulation.report</code> is a secondary function called to initiate a 
simulation run in <span class="pkg">scaRabee</span>. It evaluates the structural model using the
initial estimates of model parameters and outputs the results to a report file
stored in the run directory. See <code>vignette('scaRabee',package='scaRabee')</code> 
for more details. <code>simulation.report</code> is typically not called directly
by users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  simulation.report(problem = NULL,
                    files = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="simulation.report_+3A_problem">problem</code></td>
<td>
<p>A list containing the following levels:</p>

<dl>
<dt>code</dt><dd><p>A list of R code extracted from the model file. Depending on 
content of the model file, the levels of this list could be: template,
derived, lags, ode, dde, output, variance, and/or secondary.</p>
</dd>
<dt>data</dt><dd><p>A list which content depends on the scope of the analysis. If 
the analysis was run at the level of the subject, <code>data</code> contains as 
many levels as the number of subjects in the dataset, plus the <code>ids</code>
level containing the vector of identification numbers of all subjects 
included in the analysis population. If the analysis was run at the level 
of the population, <code>data</code> contains only one level of data and 
<code>ids</code> is set to 1.
</p>
<p>Each subject-specific level contains as many levels as there are treatment
levels for this subject, plus the <code>trts</code> level listing all treatments
for this subject, and the <code>id</code> level giving the identification number
of the subject. 
</p>
<p>Each treatment-specific levels is a list containing the following levels: 
</p>

<dl>
<dt>cov</dt><dd><p>mij x 3 data.frame containing the times of observations of the
dependent variables (extracted from the TIME variable), the indicators
of the type of dependent variables (extracted from the CMT variable),
and the actual dependent variable observations (extracted from the 
DV variable) for this particular treatment and this particular 
subject.</p>
</dd>
<dt>cov</dt><dd><p>mij x c data.frame containing the times of observations of 
the dependent variables (extracted from the TIME variable) and all the
covariates identified for this particular treatment and this 
particular subject.</p>
</dd> 
<dt>bolus</dt><dd><p>bij x 4 data.frame providing the instantaneous inputs 
for a treatment and individual.</p>
</dd>
<dt>infusion</dt><dd><p>fij x (4+c) data.frame providing the zero-order inputs for
a treatment and individual.</p>
</dd>
<dt>trt</dt><dd><p>the particular treatment identifier.</p>
</dd></dl>

</dd>
<dt>method</dt><dd><p>A character string, indicating the scale of the analysis. Should
be 'population' or 'subject'.</p>
</dd>
<dt>init</dt><dd><p>A data.frame of parameter data with the following columns:
'names', 'type', 'value', 'isfix', 'lb', and 'ub'.</p>
</dd>
<dt>debugmode</dt><dd><p>Logical indicator of debugging mode.</p>
</dd>
<dt>modfun</dt><dd><p>Model function.</p>
</dd>
</dl>

</td></tr>
<tr><td><code id="simulation.report_+3A_files">files</code></td>
<td>
<p>A list of input used for the analysis. The following elements are
expected and none of them could be null: </p>

<dl>
<dt>data</dt><dd><p>A .csv file located in the working directory, which contains
the dosing information, the observations of the dependent variable(s)
to be modeled, and possibly covariate information. The expected format 
of this file is described in details in <code>vignette('scaRabee',
        package='scaRabee')</code>.</p>
</dd>
<dt>param</dt><dd><p>A .csv file located in the working directory, which contains
the initial guess(es) for the model parameter(s) to be optimized or used
for model simulation. The expected format of this file is described in
details in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>model</dt><dd><p>A text file located in the working directory, which defines 
the model. Models specified with explicit, ordinary or delay
differential equations are expected to respect a certain syntax and 
organization detailed in <code>vignette('scaRabee',package='scaRabee')</code>.</p>
</dd>
<dt>iter</dt><dd><p>A .csv file reporting the values of the objective function
and estimates of model parameters at each iteration.  (Not used for 
simulation runs).</p>
</dd>
<dt>report</dt><dd><p>A text file reporting for each individual in the dataset the
final parameter estimates for structural model parameters, residual 
variability and secondary parameters as well as the related statistics 
(coefficients of variation, confidence intervals, covariance and 
correlation matrix). (Not used for simulation runs).</p>
</dd>
<dt>pred</dt><dd><p>A .csv file reporting the predictions and calculated residuals
for each individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>est</dt><dd><p>A .csv file reporting the final parameter estimates for each
individual in the dataset. (Not used for simulation runs).</p>
</dd>
<dt>sim</dt><dd><p>A .csv file reporting the simulated model predictions for each 
individual in the dataset. (Not used for estimation runs).</p>
</dd>
</dl>

</td></tr>
</table>


<h3>Value</h3>

<p>Creates a simulation report and returns a data.frame of simulated and observed
data containing the following columns: </p>

<dl>
<dt>ID</dt><dd><p>Subject Identifier. If the analysis is run at the population level
and if the original dataset contained multiple subjects distinguished by
a different ID number, please note that the original ID is lost and 
replaced by 1 so that all available data is considered to come from the 
same subject.</p>
</dd>
<dt>TRT</dt><dd><p>Indicator of treatment level (defining the sub-problems).</p>
</dd>
<dt>CMT</dt><dd><p>Indicator of system state to which the simulated or observed 
value is associated.</p>
</dd>
<dt>TIME</dt><dd><p>Time of the observation or model prediction.</p>
</dd>
<dt>SIM</dt><dd><p>Value of the simulated state. NA if DV is not NA.</p>
</dd>
<dt>DV</dt><dd><p>Value of the observed state. NA if SIM is not NA.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Sebstien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

<hr>
<h2 id='weighting'>
Residual Variability
</h2><span id='topic+weighting'></span>

<h3>Description</h3>

<p><code>weighting</code> is a secondary function called during estimation run to
evaluate the model(s) of residual variability specified by the code provided
in the $VARIANCE block. <code>weighting</code> is typically not called directly by
users.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>  weighting(parms = NULL,
            derparms = NULL,
            codevar=NULL,
            y=NULL,
            xdata=NULL,
            check=FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weighting_+3A_parms">parms</code></td>
<td>
<p>A vector of primary parameters.</p>
</td></tr>
<tr><td><code id="weighting_+3A_derparms">derparms</code></td>
<td>
<p>A list of derived parameters, specified in the $DERIVED block
of code.</p>
</td></tr>
<tr><td><code id="weighting_+3A_codevar">codevar</code></td>
<td>
<p>The content of the R code specified within the $VARIANCE block 
in the model file.</p>
</td></tr>
<tr><td><code id="weighting_+3A_y">y</code></td>
<td>
<p>The matrix of structural model predictions.</p>
</td></tr>
<tr><td><code id="weighting_+3A_xdata">xdata</code></td>
<td>
<p>A vector of times at which the system is being evaluated.</p>
</td></tr>
<tr><td><code id="weighting_+3A_check">check</code></td>
<td>
<p>An indicator whether checks should be performed to validate 
function inputs</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Return a matrix of numeric values of the same dimension as <code>f</code>.</p>


<h3>Author(s)</h3>

<p>Sebastien Bihorel (<a href="mailto:sb.pmlab@gmail.com">sb.pmlab@gmail.com</a>)
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
