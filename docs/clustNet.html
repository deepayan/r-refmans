<!DOCTYPE html><html><head><title>Help for package clustNet</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {clustNet}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#bestAICsearch'><p>bestAICsearch</p></a></li>
<li><a href='#density_plot'><p>density_plot</p></a></li>
<li><a href='#get_classification'><p>get_classification</p></a></li>
<li><a href='#get_clusters'><p>get_clusters</p></a></li>
<li><a href='#get_clusters_bernoulli'><p>get_clusters_bernoulli</p></a></li>
<li><a href='#nice_DAG_plot'><p>nice_DAG_plot</p></a></li>
<li><a href='#plot_clusters'><p>plot_clusters</p></a></li>
<li><a href='#sampleData'><p>sampleData</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Network-Based Clustering</td>
</tr>
<tr>
<td>Version:</td>
<td>1.2.0</td>
</tr>
<tr>
<td>Description:</td>
<td>Network-based clustering using a Bayesian network mixture model with optional covariate adjustment.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggraph, ggpubr, ggplot2, grDevices,
reshape2, car, ks, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Imports:</td>
<td>BiDAG (&ge; 2.0.2), pcalg, RBGL, parallel, clue, methods, graph,
igraph</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-14 12:23:00 UTC; frbayer</td>
</tr>
<tr>
<td>Author:</td>
<td>Fritz Bayer [aut, cre, cph],
  Jack Kuipers [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Fritz Bayer &lt;frbayer@ethz.ch&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-14 15:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='bestAICsearch'>bestAICsearch</h2><span id='topic+bestAICsearch'></span>

<h3>Description</h3>

<p>best AIC search
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bestAICsearch(
  binaryMatrix,
  minK = 2,
  maxK = 5,
  chiVec = c(0.001, 0.5, 1, 2, 3),
  startseed = 100,
  nIterations = 50,
  AICrange = 100,
  plot_heatmap = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bestAICsearch_+3A_binarymatrix">binaryMatrix</code></td>
<td>
<p>Data to be clustered</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_mink">minK</code></td>
<td>
<p>Min number of clusters</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_maxk">maxK</code></td>
<td>
<p>Max number of clusters</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_chivec">chiVec</code></td>
<td>
<p>Vector of chi values</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_startseed">startseed</code></td>
<td>
<p>Seed</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_niterations">nIterations</code></td>
<td>
<p>Number of iterations</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_aicrange">AICrange</code></td>
<td>
<p>AIC range</p>
</td></tr>
<tr><td><code id="bestAICsearch_+3A_plot_heatmap">plot_heatmap</code></td>
<td>
<p>TRUE if plotting directly</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of AIC scrores
</p>

<hr>
<h2 id='density_plot'>density_plot</h2><span id='topic+density_plot'></span>

<h3>Description</h3>

<p>Create 2d dimensionality reduction of sample fit to Bayesian network clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>density_plot(cluster_results, var_selection = NULL, colourys = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="density_plot_+3A_cluster_results">cluster_results</code></td>
<td>
<p>Cluster results from function get_clusters</p>
</td></tr>
<tr><td><code id="density_plot_+3A_var_selection">var_selection</code></td>
<td>
<p>Selected variables to consider, e.g. c(1:5) for first five only</p>
</td></tr>
<tr><td><code id="density_plot_+3A_colourys">colourys</code></td>
<td>
<p>A vector specifying the colors of each cluster (optional)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A density plot of class recordedplot.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
sampled_data &lt;- sampleData(n_vars = 15, n_samples = c(200,200,200))$sampled_data
# Learn clusters
cluster_results &lt;- get_clusters(sampled_data)
# Load additional pacakges to create a 2d dimensionality reduction
library(car)
library(ks)
library(ggplot2)
library(graphics)
library(stats)
# Plot a 2d dimensionality reduction
density_plot(cluster_results)

</code></pre>

<hr>
<h2 id='get_classification'>get_classification</h2><span id='topic+get_classification'></span>

<h3>Description</h3>

<p>Classification based on clustering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_classification(cluster_results, data_classify)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_classification_+3A_cluster_results">cluster_results</code></td>
<td>
<p>Output from get_clusters()</p>
</td></tr>
<tr><td><code id="get_classification_+3A_data_classify">data_classify</code></td>
<td>
<p>Data that should be classified; colnames need to match the ones of cluster_results$data; missing cols are allowed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the classification as &quot;clustermembership&quot; and the probabilities of belonging to the clusters as &quot;allrelativeprobabs&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# choose data
sampled_data &lt;- sampleData(n_vars = 15, n_samples = c(300,300,300))$sampled_data
# learn clusters
cluster_results &lt;- get_clusters(sampled_data)
# visualize the networks
classification_results &lt;- get_classification(cluster_results, sampled_data)

</code></pre>

<hr>
<h2 id='get_clusters'>get_clusters</h2><span id='topic+get_clusters'></span>

<h3>Description</h3>

<p>Network-based clustering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clusters(
  myData,
  k_clust = 3,
  n_bg = 0,
  quick = TRUE,
  EMseeds = 1,
  edgepmat = NULL,
  blacklist = NULL,
  bdepar = list(chi = 0.5, edgepf = 8),
  newallrelativeprobabs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_clusters_+3A_mydata">myData</code></td>
<td>
<p>Data to be clustered, must be either binary (with levels &quot;0&quot;/&quot;1&quot;) or categorical (with levels &quot;0&quot;/&quot;1&quot;/&quot;2&quot;/...)</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_k_clust">k_clust</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_n_bg">n_bg</code></td>
<td>
<p>Number of covariates to be adjusted for; the position of the covariates must be in the last column of the myData matrix</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_quick">quick</code></td>
<td>
<p>if TRUE, then the runtime is quick but accuracy is lower</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_emseeds">EMseeds</code></td>
<td>
<p>Seeds</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_edgepmat">edgepmat</code></td>
<td>
<p>Matrix of penalized edges in the search space</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_blacklist">blacklist</code></td>
<td>
<p>Matrix of forbidden edges in the search space</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_bdepar">bdepar</code></td>
<td>
<p>Hyperparameters for structure learning (BDE score)</p>
</td></tr>
<tr><td><code id="get_clusters_+3A_newallrelativeprobabs">newallrelativeprobabs</code></td>
<td>
<p>relative probability of cluster assignment of each sample</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the clusterMemberships and &quot;assignprogress&quot;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# choose data
sampled_data &lt;- sampleData(n_vars = 15, n_samples = c(300,300,300))$sampled_data
# learn clusters
cluster_results &lt;- get_clusters(sampled_data)
# visualize the networks
library(ggplot2)
library(ggraph)
library(igraph)
library(ggpubr)
plot_clusters(cluster_results)

</code></pre>

<hr>
<h2 id='get_clusters_bernoulli'>get_clusters_bernoulli</h2><span id='topic+get_clusters_bernoulli'></span>

<h3>Description</h3>

<p>Categorical version of Bernoulli mixture model (binary clustering function BBMMclusterEM)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_clusters_bernoulli(
  binaryMatrix,
  chi = 0.5,
  k_clust = 5,
  startseed = 100,
  nIterations = 10,
  verbose = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_clusters_bernoulli_+3A_binarymatrix">binaryMatrix</code></td>
<td>
<p>Data to be clustered</p>
</td></tr>
<tr><td><code id="get_clusters_bernoulli_+3A_chi">chi</code></td>
<td>
<p>hyperparameter chi</p>
</td></tr>
<tr><td><code id="get_clusters_bernoulli_+3A_k_clust">k_clust</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="get_clusters_bernoulli_+3A_startseed">startseed</code></td>
<td>
<p>Start seed</p>
</td></tr>
<tr><td><code id="get_clusters_bernoulli_+3A_niterations">nIterations</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="get_clusters_bernoulli_+3A_verbose">verbose</code></td>
<td>
<p>set TRUE to display progress</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a list containing the clusterMemberships
</p>

<hr>
<h2 id='nice_DAG_plot'>nice_DAG_plot</h2><span id='topic+nice_DAG_plot'></span>

<h3>Description</h3>

<p>DAG visualization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nice_DAG_plot(
  my_DAG,
  print_direct = TRUE,
  node_size = NULL,
  CPDAG = TRUE,
  node_colours = "#fdae61",
  directed = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nice_DAG_plot_+3A_my_dag">my_DAG</code></td>
<td>
<p>DAG</p>
</td></tr>
<tr><td><code id="nice_DAG_plot_+3A_print_direct">print_direct</code></td>
<td>
<p>print DAG if TRUE</p>
</td></tr>
<tr><td><code id="nice_DAG_plot_+3A_node_size">node_size</code></td>
<td>
<p>node size vector</p>
</td></tr>
<tr><td><code id="nice_DAG_plot_+3A_cpdag">CPDAG</code></td>
<td>
<p>if TRUE, then plot CPDAG instead of DAG</p>
</td></tr>
<tr><td><code id="nice_DAG_plot_+3A_node_colours">node_colours</code></td>
<td>
<p>node colours</p>
</td></tr>
<tr><td><code id="nice_DAG_plot_+3A_directed">directed</code></td>
<td>
<p>TRUE if nodes should be directed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A plot of the DAG of class c(&quot;gg&quot;, &quot;ggplot&quot;).
</p>

<hr>
<h2 id='plot_clusters'>plot_clusters</h2><span id='topic+plot_clusters'></span>

<h3>Description</h3>

<p>Plot clusters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_clusters(
  cluster_results,
  node_colours = "#fdae61",
  scale_entropy = FALSE,
  directed = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_clusters_+3A_cluster_results">cluster_results</code></td>
<td>
<p>Cluster results</p>
</td></tr>
<tr><td><code id="plot_clusters_+3A_node_colours">node_colours</code></td>
<td>
<p>node colours</p>
</td></tr>
<tr><td><code id="plot_clusters_+3A_scale_entropy">scale_entropy</code></td>
<td>
<p>if true, entropy measure will be used to determine size of the nodes</p>
</td></tr>
<tr><td><code id="plot_clusters_+3A_directed">directed</code></td>
<td>
<p>TRUE if nodes should be directed</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary plot of all cluster networks of class c(&quot;gg&quot;, &quot;ggplot&quot;, &quot;ggarrange&quot;).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Simulate data
sampled_data &lt;- sampleData(n_vars = 15, n_bg = 0)$sampled_data
# learn clusters
cluster_results &lt;- get_clusters(sampled_data)
# Load additional pacakges to visualize the networks
library(ggplot2)
library(ggraph)
library(igraph)
library(ggpubr)
# Visualize networks
plot_clusters(cluster_results)

</code></pre>

<hr>
<h2 id='sampleData'>sampleData</h2><span id='topic+sampleData'></span>

<h3>Description</h3>

<p>Sample binary data from different Bayes nets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sampleData(
  k_clust = 3,
  n_vars = 20,
  n_bg = 0,
  n_samples = NULL,
  bgedges = "different",
  equal_cpt_bg = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sampleData_+3A_k_clust">k_clust</code></td>
<td>
<p>Number of clusters</p>
</td></tr>
<tr><td><code id="sampleData_+3A_n_vars">n_vars</code></td>
<td>
<p>Number of variables</p>
</td></tr>
<tr><td><code id="sampleData_+3A_n_bg">n_bg</code></td>
<td>
<p>number of conditioned covariates</p>
</td></tr>
<tr><td><code id="sampleData_+3A_n_samples">n_samples</code></td>
<td>
<p>number of samples</p>
</td></tr>
<tr><td><code id="sampleData_+3A_bgedges">bgedges</code></td>
<td>
<p>type of background edges</p>
</td></tr>
<tr><td><code id="sampleData_+3A_equal_cpt_bg">equal_cpt_bg</code></td>
<td>
<p>specify if conditional probability table of the background edges is constant across clusters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>sampled binary data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# sample data
simulation_data &lt;- sampleData(k_clust = 3, n_vars = 15, n_samples = c(200,200,200))
sampled_data &lt;- simulation_data$sampled_data
head(sampled_data)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
