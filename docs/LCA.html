<!DOCTYPE html><html><head><title>Help for package LCA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LCA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#estimateB'><p>ML Estimation of Laplace Beta</p></a></li>
<li><a href='#evaluateDiffSignificance'><p>Evaluate Statistical Significance of an Observed Difference Between Two Objects</p></a></li>
<li><a href='#fitPTLmodel'><p>Calibrate Polynomial-Tail Laplace (PTL) model prdictions for LCA analysis</p></a></li>
<li><a href='#getPTLExpectedCounts'><p>Predict Distribution of Feature-Wise Differences</p></a></li>
<li><a href='#getPTLparams'><p>Find best values of PTL parameters</p></a></li>
<li><a href='#LCA'><p>Localised Co-dependency Analysis</p></a></li>
<li><a href='#LCD'><p>Localised Co-Dependency Estimates</p></a></li>
<li><a href='#predictPTLparams'><p>Predict Values for PTL Model</p></a></li>
<li><a href='#PTL'><p>Polynomial-Tail Laplace</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2013-09-30</td>
</tr>
<tr>
<td>Title:</td>
<td>Localised Co-Dependency Analysis</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ed Curry &lt;e.curry@imperial.ac.uk&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Performs model fitting and significance estimation for Localised Co-Dependency between pairs of features of a numeric dataset.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.r-project.org">https://www.r-project.org</a>,
<a href="https://www.imperial.ac.uk/people/e.curry">https://www.imperial.ac.uk/people/e.curry</a></td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-04-21 10:25:30 UTC; ripley</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-04-22 06:54:13 UTC</td>
</tr>
<tr>
<td>Author:</td>
<td>Ed Curry [aut, cre]</td>
</tr>
</table>
<hr>
<h2 id='estimateB'>ML Estimation of Laplace Beta</h2><span id='topic+estimateB'></span>

<h3>Description</h3>

<p>Estimates initial value of parameter Beta from the PTL distribution used in LCA analysis.</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimateB(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimateB_+3A_x">x</code></td>
<td>
<p>Numeric vector of differences between the values of each feature, for a pair of objects in the dataset.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Calculates maximum-likelihood estimate for Beta in the Laplace distribution fit to distribution of <code>x</code>. </p>


<h3>Value</h3>

<p>Numeric value for initial estimate of PTL distribution parameter <code>Beta</code></p>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='evaluateDiffSignificance'>Evaluate Statistical Significance of an Observed Difference Between Two Objects</h2><span id='topic+evaluateDiffSignificance'></span>

<h3>Description</h3>

<p>Use PTL model to estimate the significance of a difference between the values of some feature of interest in two selected objects from a dataset.</p>


<h3>Usage</h3>

<pre><code class='language-R'>evaluateDiffSignificance(d,diff,PTLmodel)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="evaluateDiffSignificance_+3A_d">d</code></td>
<td>
<p>Numeric value specifying global dissimilarity between the selected objects</p>
</td></tr>
<tr><td><code id="evaluateDiffSignificance_+3A_diff">diff</code></td>
<td>
<p>Numeric value specifying magnitude of difference between the values of a selected feature of interest in the selected objects</p>
</td></tr>
<tr><td><code id="evaluateDiffSignificance_+3A_ptlmodel">PTLmodel</code></td>
<td>
<p>List, as returned by the function <code>fitPTLmodel</code>, with named elements <code>alpha</code>, <code>beta</code> and <code>gamma</code> specifying linear models for PTL parameter prediction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluates statistical significance of observing as great a difference as that observed between the values of a selected feature of interest in the selected objects, given the global dissimilarity between those objects and the PTL models fitted to characterise these distributions across the whole dataset.</p>


<h3>Value</h3>

<p>Numeric value giving p-value representing significance estimate of the observed difference, given the fitted models.</p>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='fitPTLmodel'>Calibrate Polynomial-Tail Laplace (PTL) model prdictions for LCA analysis</h2><span id='topic+fitPTLmodel'></span>

<h3>Description</h3>

<p>Fits PTL models to randomly sampled pairs of the dataset, to enable prediction of PTL model parameter values based on hyperparameter <code>d</code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitPTLmodel(x,nPairs=10000)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fitPTLmodel_+3A_x">x</code></td>
<td>
<p>Numeric data input array, standardised to range (0,1)</p>
</td></tr>
<tr><td><code id="fitPTLmodel_+3A_npairs">nPairs</code></td>
<td>
<p>Numeric value specifying the number of samplings of pairs of objects to use to obtain hyperparameter fits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Evaluates parameters for PTL model fits to the distributions of feature-wise differences between each of a specified (large) number of pairs of objects represented in dataset <code>x</code>. Obtains subsequent model fits explaining the individual PTL parameters <code>alpha</code>,<code>beta</code>,<code>gamma</code> in terms of the global (Euclidean) distances between the corresponding pairs of objects.</p>


<h3>Value</h3>

<p>List with the following components:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>Object of class <code>lm</code>, which can be used to predict an appropriate value of <code>alpha</code> in the PTL distribution corresponding to a pair of objects in the dataset with a specified global dissimilarity</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Object of class <code>lm</code>, which can be used to predict an appropriate value of <code>alpha</code> in the PTL distribution corresponding to a pair of objects in the dataset with a specified global dissimilarity</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Object of class <code>lm</code>, which can be used to predict an appropriate value of <code>alpha</code> in the PTL distribution corresponding to a pair of objects in the dataset with a specified global dissimilarity</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='getPTLExpectedCounts'>Predict Distribution of Feature-Wise Differences</h2><span id='topic+getPTLExpectedCounts'></span>

<h3>Description</h3>

<p>Predicts the expected number of features with a difference between two objects of a given global dissimilarity lying within a set of specified ranges.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPTLExpectedCounts(alpha,beta,gamma,bin_limits,ntrials)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPTLExpectedCounts_+3A_alpha">alpha</code></td>
<td>
<p>Numeric value specifying the parameter <code>alpha</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
<tr><td><code id="getPTLExpectedCounts_+3A_beta">beta</code></td>
<td>
<p>Numeric value specifying the parameter <code>beta</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
<tr><td><code id="getPTLExpectedCounts_+3A_gamma">gamma</code></td>
<td>
<p>Numeric value specifying the parameter <code>gamma</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
<tr><td><code id="getPTLExpectedCounts_+3A_bin_limits">bin_limits</code></td>
<td>
<p>Numeric vector specifying the limits of each range to be evaluated. Effectively, this gives the breakpoints between cells of the predicted histogram.</p>
</td></tr>
<tr><td><code id="getPTLExpectedCounts_+3A_ntrials">ntrials</code></td>
<td>
<p>Numeric value specifying the number of features being evaluated in the dataset</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses a PTL model with the specified parameters to estimate the expected number of features with differences between specified ranges. Used in calibration of PTL model parameter prediction to the dataset.</p>


<h3>Value</h3>

<p>Numeric vector giving expected counts for numbers of features with a difference lying within the given set of specified ranges.</p>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='getPTLparams'>Find best values of PTL parameters</h2><span id='topic+getPTLparams'></span>

<h3>Description</h3>

<p>Finds parameters <code>alpha</code>, <code>beta</code> and <code>gamma</code> in PTL model to fit an observed distribution of differences in each feature's values between two given objects from a dataset.</p>


<h3>Usage</h3>

<pre><code class='language-R'>getPTLparams(x1,x2)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getPTLparams_+3A_x1">x1</code></td>
<td>
<p>Numeric data input vector, standardised to range (0,1)</p>
</td></tr>
<tr><td><code id="getPTLparams_+3A_x2">x2</code></td>
<td>
<p>Numeric data input vector, standardised to range (0,1)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses iterative NLS fitting to determine parameters of PTL model to represent the distribution of the differences observed between two objects selected from the dataset being analysed with LCA.</p>


<h3>Value</h3>

<p>List with the following elements:
</p>
<table>
<tr><td><code>d</code></td>
<td>
<p>Numeric value specifying pair-wise global distance between objects <code>x1</code> and <code>x2</code></p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Numeric value specifying value of parameter <code>beta</code> in best PTL fit</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>Numeric value specifying value of parameter <code>alpha</code> in best PTL fit</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Numeric value specifying value of parameter <code>gamma</code> in best PTL fit</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='LCA'>Localised Co-dependency Analysis</h2><span id='topic+LCA'></span>

<h3>Description</h3>

<p>Performs Localised Co-dependency Analysis</p>


<h3>Usage</h3>

<pre><code class='language-R'>LCA(x,PTLmodel,clique,seed.row,combine.method="Fisher",
adjust.method="BH",comparison.alpha=0.05)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LCA_+3A_x">x</code></td>
<td>
<p>Numeric data input array, standardised to range (0,1)</p>
</td></tr>
<tr><td><code id="LCA_+3A_ptlmodel">PTLmodel</code></td>
<td>
<p>List with named elements <code>alpha</code>, <code>beta</code> and <code>gamma</code> specifying PTL parameters</p>
</td></tr>
<tr><td><code id="LCA_+3A_clique">clique</code></td>
<td>
<p>Numeric vector specifying which columns of data table represent entities defining the clique across which to evaluate co-dependency</p>
</td></tr>
<tr><td><code id="LCA_+3A_seed.row">seed.row</code></td>
<td>
<p>Numeric value specifying which row of data table to use as 'seed' feature with which to evaluate co-dependency</p>
</td></tr>
<tr><td><code id="LCA_+3A_combine.method">combine.method</code></td>
<td>
<p>Character specifying which method to use for combining individual LCD estimates. One of &quot;Fisher&quot; or &quot;Inverse Product&quot;.</p>
</td></tr>
<tr><td><code id="LCA_+3A_adjust.method">adjust.method</code></td>
<td>
<p>Character specifying which method to use for multiple testing adjustment of significance estimates. See <code>p.adjust</code> for further details.</p>
</td></tr>
<tr><td><code id="LCA_+3A_comparison.alpha">comparison.alpha</code></td>
<td>
<p>Significance level threshold for including objects in the set to be used for evaluating LCD significance estimates for a given pair of features in a given clique.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to evaluate LCD, within the members of <code>clique</code>, for all features in a dataset against the feature represented by <code>seed.row</code>.</p>


<h3>Value</h3>

<p>List with elements:
</p>
<table>
<tr><td><code>LCD</code></td>
<td>
<p>Data frame giving across-clique LCD significance estimates for each feature in the dataset, as both unadjusted p-value and adjusted for multiple testing.</p>
</td></tr>
<tr><td><code>combinations</code></td>
<td>
<p>An array detailing the individual pair-wise LCD tests performed amongst members of the clique, which were combined to give the overall significance estimates</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>


<h3>Examples</h3>

<pre><code class='language-R'>suppressWarnings(RNGversion("3.5.0"))
## create a data matrix

x &lt;- array(runif(1200),dim=c(40,12))

## implant similarity across a 'clique'

clique.cols &lt;- sample(ncol(x),4)
x[,clique.cols] &lt;- x[,clique.cols] + rnorm(nrow(x))

## scale x to (0,1)

x[x&lt;0] &lt;- 0
x[x&gt;1] &lt;- 1

## choose a 'seed' feature and some partner

seed.row &lt;- sample(nrow(x),1)
partner.row &lt;- sample(setdiff(c(1:nrow(x)),seed.row),1)

x[c(seed.row,partner.row),clique.cols] &lt;- x[c(seed.row,partner.row),clique.cols] + 
rep(rnorm(length(clique.cols)),each=2)

## calibrate PTL models to dataset

PTL.fit &lt;- fitPTLmodel(x,nPairs=15)

## evaluate LCD between 'seed' feature and all other features
 
LCA.result &lt;- LCA(x,PTLmodel=PTL.fit,clique=clique.cols,seed.row=seed.row)
## Not run: head(LCA.result$LCD)

</code></pre>

<hr>
<h2 id='LCD'>Localised Co-Dependency Estimates</h2><span id='topic+LCD'></span>

<h3>Description</h3>

<p>Evaluates Statistical Significance of Localised Co-Dependency (LCD)</p>


<h3>Usage</h3>

<pre><code class='language-R'>LCD(x1,x2,seed.row,PTLmodel)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="LCD_+3A_x1">x1</code></td>
<td>
<p>Numeric data vector giving values of all features for one selected object</p>
</td></tr>
<tr><td><code id="LCD_+3A_x2">x2</code></td>
<td>
<p>Numeric data vector giving values of all features for another selected object</p>
</td></tr>
<tr><td><code id="LCD_+3A_seed.row">seed.row</code></td>
<td>
<p>Numeric value specifying which row of data table to use as 'seed' feature with which to evaluate co-dependency</p>
</td></tr>
<tr><td><code id="LCD_+3A_ptlmodel">PTLmodel</code></td>
<td>
<p>List with named elements <code>alpha</code>, <code>beta</code> and <code>gamma</code> specifying PTL parameters</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function to evaluate LCD, between two selected objects, for all features in a dataset against the feature represented by <code>seed.row</code>.</p>


<h3>Value</h3>

<p>Numeric vector giving p-values for significance estimates of localised co-dependency, with the feature specified by <code>seed.row</code>, of all features in the dataset being analysed.</p>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='predictPTLparams'>Predict Values for PTL Model</h2><span id='topic+predictPTLparams'></span>

<h3>Description</h3>

<p>Generates parameter values for PTL model, based on a specified value of the hyperparameter</p>


<h3>Usage</h3>

<pre><code class='language-R'>predictPTLparams(d,PTLmodel)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predictPTLparams_+3A_d">d</code></td>
<td>
<p>Numeric value specifying global dissimilarity between the selected objects</p>
</td></tr>
<tr><td><code id="predictPTLparams_+3A_ptlmodel">PTLmodel</code></td>
<td>
<p>List, as returned by the function <code>fitPTLmodel</code>, with named elements <code>alpha</code>, <code>beta</code> and <code>gamma</code> specifying linear models for PTL parameter prediction.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses hyperparameter-based prediction linear models, calibrated to the dataset being analysed using the <code>fitPTLmodel</code> function, to estimate PTL model parameters for a pair of objects in the dataset with a global dissimilarity <code>d</code>.</p>


<h3>Value</h3>

<p>List with elements:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>Numeric value specifying the parameter <code>alpha</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>Numeric value specifying the parameter <code>beta</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
<tr><td><code>gamma</code></td>
<td>
<p>Numeric value specifying the parameter <code>gamma</code> in the PTL model used to estimate distribution of differences between the given objects</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

<hr>
<h2 id='PTL'>Polynomial-Tail Laplace</h2><span id='topic+PTL'></span><span id='topic+dPTL'></span><span id='topic+pPTL'></span>

<h3>Description</h3>

<p>Probability density and distribution functions for Polynomial-Tail Laplace distribution</p>


<h3>Usage</h3>

<pre><code class='language-R'>dPTL(x,alpha,beta,gamma)
pPTL(q,alpha,beta,gamma)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PTL_+3A_x">x</code>, <code id="PTL_+3A_q">q</code></td>
<td>
<p>Numeric vector of quantiles</p>
</td></tr>
<tr><td><code id="PTL_+3A_alpha">alpha</code></td>
<td>
<p>Linear tail adjustment coefficient for PTL distribution</p>
</td></tr>
<tr><td><code id="PTL_+3A_beta">beta</code></td>
<td>
<p>Exponential decay term for PTL distribution, similar to <code>beta</code> parameter in Laplace distribution</p>
</td></tr>
<tr><td><code id="PTL_+3A_gamma">gamma</code></td>
<td>
<p>Polynomial tail adjustment coefficient for PTL distribution</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The PTL distribution has density
</p>
<p style="text-align: center;"><code class="reqn">
	f(x) =  \left\{\begin{array}{cc}
		0 &amp; x &lt; -2\\
		\displaystyle \frac{\alpha(\frac{x^2}{2}+2x+2) + \beta(e^{\frac{x}{\beta}}-e^{\frac{-2}{\beta}}) + \gamma(\frac{x^3}{3}+4x+\frac{16}{3})}{4\alpha + 2\beta(1-e^{\frac{-2}{\beta}}) + \frac{32\gamma}{3}} &amp; -2 \leq x \leq 0\\
		\displaystyle \frac{\alpha(2x-\frac{x^2}{2}-2) + \beta(e^{\frac{-2}{\beta}}-e^{\frac{x}{\beta}}) + \gamma(4x-\frac{x^3}{3}-\frac{16}{3})}{4\alpha + 2\beta(1-e^{\frac{-2}{\beta}}) + \frac{32\gamma}{3}} &amp; 0 &lt; x \leq 2\\
		1 &amp; x &gt; 2
	\end{array}\right.
</code>
</p>



<h3>Value</h3>

<p><code>dnorm</code> gives the density,
<code>pnorm</code> gives the distribution function.
</p>
<p>The length of the result is the maximum of the lengths of the numerical parameters for the other functions.
The numerical parameters are recycled to the length of the result.
</p>


<h3>Author(s)</h3>

<p>Ed Curry <a href="mailto:e.curry@imperial.ac.uk">e.curry@imperial.ac.uk</a></p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
