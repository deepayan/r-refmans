<!DOCTYPE html><html><head><title>Help for package spANOVA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {spANOVA}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#aovGeo'><p>Analysis of variance using a geostatistical model to handle spatial dependence</p></a></li>
<li><a href='#aovSar.crd'><p>Using a SAR model to handle spatial dependence in a Completely Randomized Design</p></a></li>
<li><a href='#aovSar.gen'><p>Using a SAR model to handle spatial dependence in an aov model.</p></a></li>
<li><a href='#aovSar.rcbd'><p>Using a SAR model to handle spatial dependence in a Randomized Complete Block Design</p></a></li>
<li><a href='#contr.tuk'><p>Tukey's contrast matrix</p></a></li>
<li><a href='#crd_simulated'><p>Simulated data set for CRD</p></a></li>
<li><a href='#rcbd_simulated'><p>Simulated data set for RCBD</p></a></li>
<li><a href='#spANOVAapp'><p>Shiny app for spANOVA</p></a></li>
<li><a href='#spCrossvalid'><p>Cross-validation by kriging</p></a></li>
<li><a href='#spMVT'><p>Multiple comparison test based on multivariate t student distribution</p></a></li>
<li><a href='#spScottKnott'><p>The Scott-Knott Clustering Algorithm</p></a></li>
<li><a href='#spTukey'><p>Compute Tukey Honest Significant Differences for a Spatially Correlated Model</p></a></li>
<li><a href='#spVariofit'><p>Fit a variogram model</p></a></li>
<li><a href='#spVariog'><p>Compute empirical residual variogram for CRD or RCBD.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Analysis of Field Trials with Geostatistics &amp; Spatial AR Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.99.4</td>
</tr>
<tr>
<td>Description:</td>
<td>Perform analysis of variance when the experimental units are spatially correlated. There are two methods to deal with spatial dependence: Spatial autoregressive models (see Rossoni, D. F., &amp; Lima, R. R. (2019) &lt;<a href="https://doi.org/10.28951%2Frbb.v37i2.388">doi:10.28951/rbb.v37i2.388</a>&gt;) and geostatistics (see Pontes, J. M., &amp; Oliveira, M. S. D. (2004) &lt;<a href="https://doi.org/10.1590%2FS1413-70542004000100018">doi:10.1590/S1413-70542004000100018</a>&gt;). For both methods, there are three multicomparison procedure available: Tukey, multivariate T, and Scott-Knott.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), stats, utils, graphics, geoR, shiny</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS, Matrix, ScottKnott, car, gtools, multcomp, multcompView,
mvtnorm, DT, shinyBS, xtable, shinythemes, rmarkdown, knitr,
spdep, ape, spatialreg, shinycssloaders</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-19 06:37:39 UTC; lucas</td>
</tr>
<tr>
<td>Author:</td>
<td>Castro L. R. [aut, cre, cph],
  Renato R. R. [aut, ths],
  Rossoni D. F. [aut],
  Nogueira C.H. [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Castro L. R. &lt;lucasroberto.castro@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-21 14:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='aovGeo'>Analysis of variance using a geostatistical model to handle spatial dependence</h2><span id='topic+aovGeo'></span><span id='topic+aovGeo.spVariofitRCBD'></span>

<h3>Description</h3>

<p>Fit an analysis of variance model using geostatistics for modeling the
spatial dependence among the observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovGeo(model, cutoff = 0.5, tol = 1e-3)

## S3 method for class 'spVariofitRCBD'
aovGeo(model, cutoff = 0.5, tol = 0.001)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aovGeo_+3A_model">model</code></td>
<td>
<p>an object of class spVariofit.</p>
</td></tr>
<tr><td><code id="aovGeo_+3A_cutoff">cutoff</code></td>
<td>
<p>a value in (0,1] interval representing the percentage of the maximum
distance adopted to estimate the variogram in the algorithm suggested by
Pontes &amp; Oliveira (2004). See 'Details'.</p>
</td></tr>
<tr><td><code id="aovGeo_+3A_tol">tol</code></td>
<td>
<p>the desired accuracy.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three assumptions are made about the error in the analysis of variance (ANOVA):
</p>
<p>1. The errors come from a normal distribution.
</p>
<p>2. The errors have the same variance.
</p>
<p>3. The errors are uncorrelated.
</p>
<p>However, in many experiments, especially field trials, there is a type of correlation
generated by the sample locations known as spatial autocorrelation, and this condition
violates the independence assumption.
</p>
<p>In that way, we need to regard this spatial autocorrelation and include it in the final
model. It could be done adopting a geostatistical model to characterize the spatial
variability among the observations directly in the covariance matrix.
</p>
<p>The geostatistical modeling is based on the residuals of the standard model
(where the errors are assumed to be independent, uncorrelated and having a normal
distribution with mean 0 and constant variance). The basic idea is using them to
estimate the residuals of the spatially autocorrelated model in order to fit a
theoretical geostatistic model to build the covariance matrix.
As Pointed by Pontes &amp; Oliveira (2004), this task can be done using the
following algorithm
</p>
<p>1 - Extract the residuals from the standard model
</p>
<p>2 - Fit a variogram based on residuals obtained in step 1.
</p>
<p>3 - Fit a theoretical model to describe the spatial dependence observed in the variogram.
</p>
<p>4 - On basis in the theoretical model fitted in step 3 and its parameter estimates,
create the covariance matrix.
</p>
<p>5 - Estimate the residuals using the covariance matrix obtained in step 4 and use
them to create a variogram.
</p>
<p>6 -  Fit a theoretical model to the residual variogram obtained in step 5 and use
its parameters estimates to build a new covariance matrix.
</p>
<p>7 - Repeat 5 to 6 until convergence.
</p>
<p>Step 1 is implemented in spVariog. Steps 2 and 3 are implemented in spVariofit.
aovGeo implements steps 4 to 7 and needs a cutoff argument to define the maximum
distance in the computation of the residual variogram described in step 6
</p>
<p>In presence of spatial trend, the model is modified
in order to include the effect of the spatial coordinates.
</p>


<h3>Value</h3>

<p><code>aovGeo</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;GEOanova&quot;.
The functions <code><a href="base.html#topic+summary">summary</a></code> and anova are used to obtain and print a summary
and analysis of variance table of the results.
An object of class &quot;GEOanova&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>DF</code></td>
<td>
<p>degrees of freedom of coordinates (in presence of spatial trend), treatments, block (if RCBD), residual and total.</p>
</td></tr>
<tr><td><code>SS</code></td>
<td>
<p>sum of squares of coordinates (in presence of spatial trend), treatments, block (if RCBD), residual and total.</p>
</td></tr>
<tr><td><code>MS</code></td>
<td>
<p>mean of squares of coordinates (in presence of spatial trend), treatments, block (if RCBD), residual and total.</p>
</td></tr>
<tr><td><code>Fc</code></td>
<td>
<p>F statistic calculated for coordinates (in presence of spatial trend), treatment and block (if RCBD).</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value associated to F statistic for coordinates (in presence of spatial trend), treatment and block (if RCBD).</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals extracted from the model</p>
</td></tr>
<tr><td><code>params</code></td>
<td>
<p>variogram parameter estimates from Pontes &amp; Oliveira (2004) algorithm.</p>
</td></tr>
<tr><td><code>type</code></td>
<td>
<p>type of trend in the data. It can be &quot;trend&quot; or &quot;cte&quot;.</p>
</td></tr>
<tr><td><code>model</code></td>
<td>
<p>geostatistical model used to describe the spatial dependence.</p>
</td></tr>
<tr><td><code>data</code></td>
<td>
<p>data set used in the analysis.</p>
</td></tr>
<tr><td><code>des.mat</code></td>
<td>
<p>design matrix.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>parameter estimates of the linear model taking into account the spatial dependence.</p>
</td></tr>
<tr><td><code>n</code></td>
<td>
<p>number of observations.</p>
</td></tr>
<tr><td><code>vcov</code></td>
<td>
<p>covariance matrix built taking into account the spatial dependence.</p>
</td></tr>
<tr><td><code>design</code></td>
<td>
<p>character string indicating the name of the experimental design.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Nogueira, C. H., de Liima, R. R., &amp; de Oliveira, M. S. (2013).
Aprimoramento da Análise de Variância: A Influência da Proximidade Espacial.
Rev. Bras. Biom, 31(3), 408-422.
</p>
<p>Nogueira, C.H., et al. (2015). Modelagem espacial na análise de um plantio
experimental de candeia. Rev. Bras. Biom., São Paulo, v.33, n.1, p.14-29.
</p>
<p>Pontes, J. M., &amp; de Oliveira, M. S. (2004).
An alternative proposal to the analysis of  field experiments using geostatistics.
Ciência e Agrotecnologia, 28(1), 135-141.
</p>
<p>Gotway, C. A., &amp; Cressie, N. A. (1990). A spatial analysis of variance applied
to soil water infiltration. Water Resources Research, 26(11), 2695-703.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")

#Geodata object
geodados &lt;- as.geodata(crd_simulated, coords.col = 1:2, data.col = 3,
                            covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Gaussian Model
ols &lt;- spVariofit(variograma, cov.model = "gaussian", weights = "equal",
                  max.dist = dist)

lines(ols, col = 1)

# Compute the model and get the analysis of variance table
mod &lt;- aovGeo(ols, cutoff = 0.6)
anova(mod)

</code></pre>

<hr>
<h2 id='aovSar.crd'>Using a SAR model to handle spatial dependence in a Completely Randomized Design</h2><span id='topic+aovSar.crd'></span>

<h3>Description</h3>

<p>Fit a completely randomized design when the experimental units have some degree of
spatial dependence using a Spatial Lag Model (SAR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovSar.crd(resp, treat, coord, seq.radius)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aovSar.crd_+3A_resp">resp</code></td>
<td>
<p>Numeric or complex vector containing the values of the response variable.</p>
</td></tr>
<tr><td><code id="aovSar.crd_+3A_treat">treat</code></td>
<td>
<p>Numeric or complex vector containing the treatment applied to each experimental unit.</p>
</td></tr>
<tr><td><code id="aovSar.crd_+3A_coord">coord</code></td>
<td>
<p>Matrix of point coordinates.</p>
</td></tr>
<tr><td><code id="aovSar.crd_+3A_seq.radius">seq.radius</code></td>
<td>
<p>Complex vector containing a radii sequence used to set the neighborhood pattern.
The default sequence has ten numbers from 0 to half of the maximum distance between the samples,
if no sample is found in this interval the sequence upper limit is increased by 10% and so on.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three assumptions are made about the error in the analysis of variance (ANOVA):
</p>
<p>1. the errors are normally distributed and, on average, zero;
</p>
<p>2. the errors all have the same variance (they are homoscedastic), and
</p>
<p>3. the errors are unrelated to each other (they are independent across observations).
</p>
<p>When these assumptions are not satisfied, data transformations in the response variable are
often used to circumvent this problem. For example, in absence of normality, the Box-Cox
transformation can be used.
</p>
<p>However, in many experiments, especially field trials, there is a type of correlation
generated by the sample locations known as spatial correlation, and this condition
violates the independence assumption.
errors are spatially correlated, by using a data transformation discussed in Long (1996)
</p>
<p style="text-align: center;"><code class="reqn">Y_{adj} = Y - (\hat{\rho}WY - \hat{\rho}\beta_0),</code>
</p>

<p>where <code class="reqn">\hat{\rho}</code> denotes the autoregressive spatial parameter of the SAR model
estimated by lagsarlm, <code class="reqn">\beta_0</code> is the overall mean and <code class="reqn">W</code> is
a spatial neighborhood matrix which neighbors are defined as the samples located within
a radius, this radius is specified as a sequence in <code>seq.radius</code>. For each radius
in <code>seq.radius</code> the model is computed as well its AIC, then the radius chosen is the
one that minimizes AIC.
</p>
<p>The aim of this transformation is converting autocorrelated observations into non-correlated
observations in order to apply the analysis of variance and obtain suitable inferences.
</p>


<h3>Value</h3>

<p><code>aovSar.crd</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;SARanova&quot;.
The functions <code><a href="base.html#topic+summary">summary</a></code> and anova are used to obtain and print a summary
and analysis of variance table of the results.
An object of class &quot;SARanova&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>DF</code></td>
<td>
<p>degrees of freedom of rho, treatments, residual and total.</p>
</td></tr>
<tr><td><code>SS</code></td>
<td>
<p>sum of squares of rho, treatments and residual.</p>
</td></tr>
<tr><td><code>MS</code></td>
<td>
<p>mean square of rho, treatments and residual.</p>
</td></tr>
<tr><td><code>Fc</code></td>
<td>
<p>F statistic calculated for treatment.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals of the adjusted model.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value associated to F statistic for treatment.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the autoregressive parameter.</p>
</td></tr>
<tr><td><code>Par</code></td>
<td>
<p>data.frame with the radius tested and its AIC.</p>
</td></tr>
<tr><td><code>y_orig</code></td>
<td>
<p>vector of response.</p>
</td></tr>
<tr><td><code>y_ajus</code></td>
<td>
<p>vector of adjusted response.</p>
</td></tr>
<tr><td><code>treat</code></td>
<td>
<p>vector of treatment applied to each experimental unit.</p>
</td></tr>
<tr><td><code>modelAdj</code></td>
<td>
<p>model of class <code><a href="stats.html#topic+aov">aov</a></code> using the adjusted response.</p>
</td></tr>
<tr><td><code>modelstd</code></td>
<td>
<p>data frame containing the ANOVA table using non-adjusted response.</p>
</td></tr>
<tr><td><code>namey</code></td>
<td>
<p>response variable name.</p>
</td></tr>
<tr><td><code>namex</code></td>
<td>
<p>treatment variable name.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Long, D.S., 1996. Spatial statistics for analysis of variance of agronomic field trials. In:
Arlinghaus, S.L. (Ed.), Practical Handbook of Spatial Statistics. CRC Press, Boca Raton, FL,
pp. 251–278.
</p>
<p>Rossoni, D. F.; Lima, R. R. . Autoregressive analysis of variance for experiments with spatial
dependence between plots: a simulation study. Revista Brasileira de Biometria, 2019.
</p>
<p>Scolforo, Henrique Ferraço, et al. &quot;Autoregressive spatial analysis and individual
tree modeling as strategies for the management of Eremanthus erythropappus.&quot; Journal of
forestry research 27.3 (2016): 595-603.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")
resp &lt;- crd_simulated$y
treat &lt;- crd_simulated$trat
coord &lt;- cbind(crd_simulated$coordX, crd_simulated$coordY)
cv &lt;- aovSar.crd(resp, treat, coord)

#Summary for class SARanova
summary(cv)

#Anova for class SARanova
anova(cv)

</code></pre>

<hr>
<h2 id='aovSar.gen'>Using a SAR model to handle spatial dependence in an aov model.</h2><span id='topic+aovSar.gen'></span>

<h3>Description</h3>

<p>Fit a completely randomized design when the experimental units have some degree of
spatial dependence using a Spatial Lag Model (SAR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovSar.gen(formula, coord, seq.radius, data = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aovSar.gen_+3A_formula">formula</code></td>
<td>
<p>A formula specifying the model.</p>
</td></tr>
<tr><td><code id="aovSar.gen_+3A_coord">coord</code></td>
<td>
<p>A matrix or data.frame of point coordinates.</p>
</td></tr>
<tr><td><code id="aovSar.gen_+3A_seq.radius">seq.radius</code></td>
<td>
<p>A complex vector containing a radii sequence used to set the neighborhood pattern.
The default sequence has ten numbers from 0 to half of the maximum distance between the samples.</p>
</td></tr>
<tr><td><code id="aovSar.gen_+3A_data">data</code></td>
<td>
<p>A data frame in which the variables specified in the formula will be found.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three assumptions are made about the error in the analysis of variance (ANOVA):
</p>
<p>1. the errors are normally distributed and, on average, zero;
</p>
<p>2. the errors all have the same variance (they are homoscedastic), and
</p>
<p>3. the errors are unrelated to each other (they are independent across observations).
</p>
<p>When these assumptions are not satisfied, data transformations in the response variable are
often used to circumvent this problem. For example, in absence of normality, the Box-Cox
transformation can be used.
</p>
<p>However, in many experiments, especially field trials, there is a type of correlation generated by
the sample locations known as spatial correlation, and this condition violates the independence assumption.
In this setting, this function provides an alternative for using ANOVA when the errors are spatially
correlated, by using a data transformation discussed in Long (1996)
</p>
<p style="text-align: center;"><code class="reqn">Y_{adj} = Y - (\hat{\rho}WY - \hat{\rho}\beta_0),</code>
</p>

<p>where <code class="reqn">\hat{\rho}</code> denotes the autoregressive spatial parameter of the SAR model estimated by
lagsarlm, <code class="reqn">\beta_0</code> is the overall mean and W is a spatial neighborhood matrix which neighbors are defined as the
samples located within a radius, this radius is specified as a sequence in <code>seq.radius</code>. For each radius
in <code>seq.radius</code> the model is computed as well its AIC, then the radius chosen is the one
that minimizes AIC.
</p>
<p>The aim of this transformation is converting autocorrelated observations into non-correlated observations
in order to apply the analysis of variance and obtain suitable inferences.
</p>


<h3>Value</h3>

<p><code>aovSar.gen</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;SARaov&quot;.
The functions summary and anova are used to obtain and print a summary and analysis of variance
table of the results.
An object of class &quot;SARaov&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>DF</code></td>
<td>
<p>degrees of freedom of rho, treatments, residual and total.</p>
</td></tr>
<tr><td><code>SS</code></td>
<td>
<p>sum of squares of residuals and total.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals of the adjusted model.</p>
</td></tr>
<tr><td><code>MS</code></td>
<td>
<p>mean square of residuals and total.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the autoregressive parameter.</p>
</td></tr>
<tr><td><code>Par</code></td>
<td>
<p>data.frame with the radius tested and its AIC.</p>
</td></tr>
<tr><td><code>modelAdj</code></td>
<td>
<p>model of class <code><a href="stats.html#topic+aov">aov</a></code> using the adjusted response.</p>
</td></tr>
<tr><td><code>modelstd</code></td>
<td>
<p>data frame containing the ANOVA table using non-adjusted response.</p>
</td></tr>
<tr><td><code>namey</code></td>
<td>
<p>response variable name.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Long, D. S. &quot;Spatial statistics for analysis of variance of agronomic field trials.&quot;
Practical handbook of spatial statistics. CRC Press, Boca Raton, FL (1996): 251-278.
</p>
<p>Rossoni, D. F.; Lima, R. R. . Autoregressive analysis of variance for experiments with spatial
dependence between plots: a simulation study. Revista Brasileira de Biometria, 2019
</p>
<p>Scolforo, Henrique Ferraço, et al. &quot;Autoregressive spatial analysis and individual
tree modeling as strategies for the management of Eremanthus erythropappus.&quot; Journal of
forestry research 27.3 (2016): 595-603.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")
coord &lt;- cbind(crd_simulated$coordX, crd_simulated$coordY)
cv &lt;- aovSar.gen(y ~ trat, coord, data = crd_simulated)
cv

#Summary for class SARanova
summary(cv)

#Anova for class SARanova
anova(cv)

</code></pre>

<hr>
<h2 id='aovSar.rcbd'>Using a SAR model to handle spatial dependence in a Randomized Complete Block Design</h2><span id='topic+aovSar.rcbd'></span>

<h3>Description</h3>

<p>Fit a randomized complete block design when the experimental units have some degree of
spatial dependence using a Spatial Lag Model (SAR).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>aovSar.rcbd(resp, treat, block, coord, seq.radius)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="aovSar.rcbd_+3A_resp">resp</code></td>
<td>
<p>Numeric or complex vector containing the values of response variable.</p>
</td></tr>
<tr><td><code id="aovSar.rcbd_+3A_treat">treat</code></td>
<td>
<p>Numeric or complex vector containing the treatment applied to each experimental unit.</p>
</td></tr>
<tr><td><code id="aovSar.rcbd_+3A_block">block</code></td>
<td>
<p>Numeric or complex vector specifying the blocks.</p>
</td></tr>
<tr><td><code id="aovSar.rcbd_+3A_coord">coord</code></td>
<td>
<p>Matrix of point coordinates or a SpatialPoints Object.</p>
</td></tr>
<tr><td><code id="aovSar.rcbd_+3A_seq.radius">seq.radius</code></td>
<td>
<p>Complex vector containing a radii sequence used to set the neighborhood pattern.
The default sequence has ten numbers from 0 to half of the maximum distance between the samples.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Three assumptions are made about the error in the analysis of variance (ANOVA):
</p>
<p>1. the errors are normally distributed and, on average, zero;
</p>
<p>2. the errors all have the same variance (they are homoscedastic), and
</p>
<p>3. the errors are unrelated to each other (they are independent across observations).
</p>
<p>When these assumptions are not satisfied, data transformations in the response variable are
often used to circumvent this problem. For example, in absence of normality, the Box-Cox
transformation can be used.
</p>
<p>However, in many experiments, especially field trials, there is a type of correlation generated by
the sample locations known as spatial correlation, and this condition violates the independence assumption.
In this setting, this function provides an alternative for using ANOVA when the errors are spatially
correlated, by using a data transformation discussed in Long (1996)
</p>
<p style="text-align: center;"><code class="reqn">Y_{adj} = Y - (\hat{\rho}WY - \hat{\rho}\beta_0),</code>
</p>

<p>where <code class="reqn">\hat{\rho}</code> denotes the autoregressive spatial parameter of the SAR model estimated by
lagsarlm, <code class="reqn">\beta_0</code> is the overall mean and <code class="reqn">W</code> is a spatial neighborhood matrix which neighbors are defined as the
samples located within a radius, this radius is specified as a sequence in <code>seq.radius</code>. For each radius
in <code>seq.radius</code> the model is computed as well its AIC, then the radius chosen is the one
that minimizes AIC.
</p>
<p>The aim of this transformation is converting autocorrelated observations into non-correlated observations
in order to apply the analysis of variance and obtain suitable inferences.
</p>


<h3>Value</h3>

<p><code>aovSar.rcbd</code> returns an object of <code><a href="base.html#topic+class">class</a></code> &quot;SARanova&quot;.
The functions summary and anova are used to obtain and print a summary and analysis of variance
table of the results.
An object of class &quot;SARanova&quot; is a list containing the following components:
</p>
<table>
<tr><td><code>DF</code></td>
<td>
<p>degrees of freedom of rho, treatments, residual and total.</p>
</td></tr>
<tr><td><code>SS</code></td>
<td>
<p>sum of squares of rho, treatments and residual.</p>
</td></tr>
<tr><td><code>Fc</code></td>
<td>
<p>F statistic calculated for treatment.</p>
</td></tr>
<tr><td><code>residuals</code></td>
<td>
<p>residuals of the adjusted model.</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>p-value associated to F statistic for treatment.</p>
</td></tr>
<tr><td><code>rho</code></td>
<td>
<p>the autoregressive parameter.</p>
</td></tr>
<tr><td><code>Par</code></td>
<td>
<p>data.frame with the radii tested and its AIC.</p>
</td></tr>
<tr><td><code>y_orig</code></td>
<td>
<p>vector of response.</p>
</td></tr>
<tr><td><code>y_ajus</code></td>
<td>
<p>vector of adjusted response.</p>
</td></tr>
<tr><td><code>treat</code></td>
<td>
<p>vector of treatment applied to each experimental unit.</p>
</td></tr>
<tr><td><code>modelAdj</code></td>
<td>
<p>model of class <code><a href="stats.html#topic+aov">aov</a></code> using the adjusted response.</p>
</td></tr>
<tr><td><code>modelstd</code></td>
<td>
<p>data frame containing the ANOVA table using non-adjusted response.</p>
</td></tr>
<tr><td><code>namey</code></td>
<td>
<p>response variable name.</p>
</td></tr>
<tr><td><code>namex</code></td>
<td>
<p>treatment variable name.</p>
</td></tr>
</table>


<h3>References</h3>

<p>Long, D.S., 1996. Spatial statistics for analysis of variance of agronomic field trials. In:
Arlinghaus, S.L. (Ed.), Practical Handbook of Spatial Statistics. CRC Press, Boca Raton, FL,
pp. 251–278.
</p>
<p>Rossoni, D. F.; Lima, R. R. . Autoregressive analysis of variance for experiments with spatial
dependence between plots: a simulation study. Revista Brasileira de Biometria, 2019
</p>
<p>Scolforo, Henrique Ferraço, et al. &quot;Autoregressive spatial analysis and individual
tree modeling as strategies for the management of Eremanthus erythropappus.&quot; Journal of
forestry research 27.3 (2016): 595-603.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("rcbd_simulated")

# Fitting the model
model &lt;- aovSar.rcbd(rcbd_simulated$y, rcbd_simulated$trat, rcbd_simulated$block,
                     cbind(rcbd_simulated$coordX, rcbd_simulated$coordY))

# Summary for class SARanova
summary(model)

# Anova for class SARanova
anova(model)

</code></pre>

<hr>
<h2 id='contr.tuk'>Tukey's contrast matrix</h2><span id='topic+contr.tuk'></span>

<h3>Description</h3>

<p>Compute Tukey's contrast matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>contr.tuk(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="contr.tuk_+3A_x">x</code></td>
<td>
<p>a vector of means.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes the matrix of contrasts for comparisons of mean levels.
</p>


<h3>Value</h3>

<p>The matrix of contrasts with treatments in row names is returned
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x &lt;- c(10, 5, 8, 4, 12, 18)
contr.tuk(x)

</code></pre>

<hr>
<h2 id='crd_simulated'>Simulated data set for CRD</h2><span id='topic+crd_simulated'></span>

<h3>Description</h3>

<p>Simulated data set for CRD
</p>


<h3>Details</h3>

<p>This dataset was simulated under a gaussian random field containing 15 treatments and 8 replication with mean 10.
</p>


<h3>Author(s)</h3>

<p>Lucas Castro <a href="mailto:lrcastro@estudante.ufla.br">lrcastro@estudante.ufla.br</a>
</p>

<hr>
<h2 id='rcbd_simulated'>Simulated data set for RCBD</h2><span id='topic+rcbd_simulated'></span>

<h3>Description</h3>

<p>Simulated data set for RCBD
</p>


<h3>Details</h3>

<p>This dataset was simulated under a gaussian random field containing 15 treatments and 3 blocks with 3 replication.
</p>


<h3>Author(s)</h3>

<p>Lucas Castro <a href="mailto:lrcastro@estudante.ufla.br">lrcastro@estudante.ufla.br</a>
</p>

<hr>
<h2 id='spANOVAapp'>Shiny app for spANOVA</h2><span id='topic+spANOVAapp'></span>

<h3>Description</h3>

<p>Shiny app for analysis of variance with spatially correlated errors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spANOVAapp(external = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spANOVAapp_+3A_external">external</code></td>
<td>
<p>logical. If true, the system's default web browser will be
launched automatically after the app is started.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function does not return any value directly. It launches a Shiny
application for analyzing variance with spatially correlated errors.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
spANOVAapp(external = TRUE)
</code></pre>

<hr>
<h2 id='spCrossvalid'>Cross-validation by kriging</h2><span id='topic+spCrossvalid'></span>

<h3>Description</h3>

<p>Compute cross-validation for an object of class <code><a href="#topic+spVariofit">spVariofit</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spCrossvalid(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spCrossvalid_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+spVariofit">spVariofit</a></code>.</p>
</td></tr>
<tr><td><code id="spCrossvalid_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="geoR.html#topic+xvalid">xvalid</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to <code><a href="geoR.html#topic+xvalid">xvalid</a></code> function of the package geoR.
Please check its documentation for additional information.
</p>


<h3>Value</h3>

<p>An object of the class &quot;xvalid&quot; which is a list with the following components:
</p>
<table>
<tr><td><code>data</code></td>
<td>
<p>the original data.</p>
</td></tr>
<tr><td><code>predicted</code></td>
<td>
<p>the values predicted by cross-validation.</p>
</td></tr>
<tr><td><code>krige.var</code></td>
<td>
<p>the cross-validation prediction variance.</p>
</td></tr>
<tr><td><code>error</code></td>
<td>
<p>the differences data - predicted value.</p>
</td></tr>
<tr><td><code>std.error</code></td>
<td>
<p>the errors divided by the square root of the prediction variances.</p>
</td></tr>
<tr><td><code>prob</code></td>
<td>
<p>the cumulative probability at original value under a normal distribution with parameters given by the cross-validation results.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")
dados &lt;- crd_simulated

#Geodata object
geodados &lt;- as.geodata(dados, coords.col = 1:2, data.col = 3,
                            covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Spherical Model
ols1 &lt;- spVariofit(variograma, cov.model = "spherical", weights = "equal",
                  max.dist = dist)

#Using crossvalidation to assess the error
ols1.cv &lt;- spCrossvalid(ols1)

</code></pre>

<hr>
<h2 id='spMVT'>Multiple comparison test based on multivariate t student distribution</h2><span id='topic+spMVT'></span><span id='topic+spMVT.SARanova'></span><span id='topic+spMVT.GEOanova'></span>

<h3>Description</h3>

<p>Use a multivariate t student distribution to assess the equality of means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spMVT(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'SARanova'
spMVT(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'GEOanova'
spMVT(x, sig.level = 0.05, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spMVT_+3A_x">x</code></td>
<td>
<p>a fitted model object of class SARcrd, SARrcbd or GEOanova.</p>
</td></tr>
<tr><td><code id="spMVT_+3A_sig.level">sig.level</code></td>
<td>
<p>a numeric value between zero and one giving the
significance level to use.</p>
</td></tr>
<tr><td><code id="spMVT_+3A_verbose">verbose</code></td>
<td>
<p>should messages be printed during loading?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For objects of class SARcrd or SARrcbd this function performs the general
linear hypothesis method provided by the function <code><a href="multcomp.html#topic+glht">glht</a></code> on the adjusted
response.
</p>
<p>For objects of class GEOanova, the test is modified to accommodate the
spatial dependence among the observations as pointed out by Nogueira (2017)
</p>


<h3>Value</h3>

<p>a data frame containing the original mean, the spatially filtered mean and its group.
For the class GEOanova, the spatial dependence is filtered out using geostatistics,
while for the class SARanova the adjusted response based on SAR model is employed.
</p>


<h3>References</h3>

<p>Nogueira, C. H. Testes para comparações múltiplas de
médias em experimentos com tendência e dependência espacial.
142 f. Tese (Doutorado em Estatística e Experimentação
Agropecuária) | Universidade Federal de Lavras, Lavras, 2017
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

data("crd_simulated")

#Geodata object
geodados &lt;- as.geodata(crd_simulated, coords.col = 1:2, data.col = 3,
                      covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Gaussian Model
ols &lt;- spVariofit(variograma, cov.model = "gaussian", weights = "equal",
                 max.dist = dist)

lines(ols, col = 1)

# Compute the model and get the analysis of variance table
mod &lt;- aovGeo(ols, cutoff = 0.6)

# Multivariate T test
spMVT(mod)

</code></pre>

<hr>
<h2 id='spScottKnott'>The Scott-Knott Clustering Algorithm</h2><span id='topic+spScottKnott'></span><span id='topic+spScottKnott.SARanova'></span><span id='topic+spScottKnott.GEOanova'></span>

<h3>Description</h3>

<p>This function implements the Scott-Knott Clustering
Algorithm for objects of class SARcrd, SARrcbd, and GEOanova.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spScottKnott(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'SARanova'
spScottKnott(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'GEOanova'
spScottKnott(x, sig.level = 0.05, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spScottKnott_+3A_x">x</code></td>
<td>
<p>a fitted model object of class SARcrd, SARrcbd or GEOanova.</p>
</td></tr>
<tr><td><code id="spScottKnott_+3A_sig.level">sig.level</code></td>
<td>
<p>a numeric value between zero and one giving the significance
level to use.</p>
</td></tr>
<tr><td><code id="spScottKnott_+3A_verbose">verbose</code></td>
<td>
<p>should messages be printed during loading?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For objects of class SARcrd or SARrcbd this function performs the standard Scott-Knott
Clustering Algorithm provided by the function <code><a href="ScottKnott.html#topic+SK">SK</a></code> on the
adjusted response.
</p>
<p>For objects of class GEOanova, the method is modified to take into account the spatial
dependence among the observations. The method is described in Nogueira (2017).
</p>


<h3>Value</h3>

<p>a data frame containing the means and its group
</p>


<h3>References</h3>

<p>Nogueira, C. H. Testes para comparações múltiplas de
médias em experimentos com tendência e dependência espacial.
142 f. Tese (Doutorado em Estatística e Experimentação
Agropecuária) | Universidade Federal de Lavras, Lavras, 2017
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")

#Geodata object
geodados &lt;- as.geodata(crd_simulated, coords.col = 1:2, data.col = 3,
                      covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Gaussian Model
ols &lt;- spVariofit(variograma, cov.model = "gaussian", weights = "equal",
                 max.dist = dist)


# Compute the model and get the analysis of variance table
mod &lt;- aovGeo(ols, cutoff = 0.6)

# Scott-Knott clustering algorithm
spScottKnott(mod)

</code></pre>

<hr>
<h2 id='spTukey'>Compute Tukey Honest Significant Differences for a Spatially Correlated Model</h2><span id='topic+spTukey'></span><span id='topic+spTukey.SARanova'></span><span id='topic+spTukey.GEOanova'></span>

<h3>Description</h3>

<p>Perform multiple comparisons of means treatments based on the Studentized range
statistic when the errors are spatially correlated.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spTukey(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'SARanova'
spTukey(x, sig.level = 0.05, verbose = TRUE)

## S3 method for class 'GEOanova'
spTukey(x, sig.level = 0.05, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spTukey_+3A_x">x</code></td>
<td>
<p>A fitted model object of class SARcrd, SARrcbd or GEOanova.</p>
</td></tr>
<tr><td><code id="spTukey_+3A_sig.level">sig.level</code></td>
<td>
<p>A numeric value between zero and one giving the significance
level to use.</p>
</td></tr>
<tr><td><code id="spTukey_+3A_verbose">verbose</code></td>
<td>
<p>should messages be printed during loading?</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For objects of class SARcrd or SARrcbd this function performs the standard
Tukey's ‘Honest Significant Difference’ method provided by the function
<code><a href="stats.html#topic+TukeyHSD">TukeyHSD</a></code> on the adjusted response.
</p>
<p>For objects of class GEOanova, the method is modified to take into account
the spatial dependence among the observations. First, we estimate a
contrast matrix (<code class="reqn">C</code>) using cont.tuk function and then after estimate the
spatial mean of each treatment (<code class="reqn">\mu_i</code>) we can assess the significance of
the contrast by
</p>
<p style="text-align: center;"><code class="reqn">|c_i \mu_i| &gt; {HSD}_i</code>
</p>

<p>where <code class="reqn">HSD_i = q(\alpha, k, \nu) * sqrt(0.5*{w}_ii)</code> and
<code class="reqn">k</code> is the number of treatments, <code class="reqn">\alpha</code> is the level of significance,
<code class="reqn">\nu</code> is the degree of freedom of the model, <code class="reqn">{w}_ii</code> is the variance of
the i-th contrast.
</p>


<h3>Value</h3>

<p>a data frame containing the original mean, the spatially filtered mean and its group.
For the class GEOanova, the spatial dependence is filtered out using geostatistics,
while for the class SARanova the adjusted response based on SAR model is employed.
</p>


<h3>References</h3>

<p>Nogueira, C. H. Testes para comparações múltiplas de
médias em experimentos com tendência e dependência espacial.
142 f. Tese (Doutorado em Estatística e Experimentação
Agropecuária) | Universidade Federal de Lavras, Lavras, 2017
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")

#Geodata object
geodados &lt;- as.geodata(crd_simulated, coords.col = 1:2, data.col = 3,
                      covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Gaussian Model
ols &lt;- spVariofit(variograma, cov.model = "gaussian", weights = "equal",
                 max.dist = dist)

lines(ols, col = 1)

# Compute the model and get the analysis of variance table
mod &lt;- aovGeo(ols, cutoff = 0.6)

# Tukey's HSD
spTukey(mod)


</code></pre>

<hr>
<h2 id='spVariofit'>Fit a variogram model</h2><span id='topic+spVariofit'></span>

<h3>Description</h3>

<p>Fit a parametric model to a variogram created by the function spVariog.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spVariofit(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spVariofit_+3A_x">x</code></td>
<td>
<p>an object of class <code><a href="#topic+spVariog">spVariog</a></code>.</p>
</td></tr>
<tr><td><code id="spVariofit_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="geoR.html#topic+variofit">variofit</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is a wrapper to <code><a href="geoR.html#topic+variofit">variofit</a></code> and can be used to fit a
parametric model to a variogram using either ordinary least squares or weighted least squares.
It takes as the main argument a spVariog object and others arguments should be passed
to <code>...</code> such as &quot;cov.model&quot; and so on.
</p>


<h3>Value</h3>

<p>an object of class <code>SpVariofit</code> which is a list containing the following
components:
</p>
<table>
<tr><td><code>mod</code></td>
<td>
<p>an object of class <code><a href="geoR.html#topic+variofit">variofit</a></code></p>
</td></tr>
<tr><td><code>data.geo</code></td>
<td>
<p>an object of class geodata</p>
</td></tr>
<tr><td><code>des.mat</code></td>
<td>
<p>the design matrix</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>a character specifying the type of spatial trend</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="geoR.html#topic+variofit">variofit</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")
dados &lt;- crd_simulated

#Geodata object
geodados &lt;- as.geodata(dados, coords.col = 1:2, data.col = 3,
                      covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

# Spherical Model
ols1 &lt;- spVariofit(variograma, cov.model = "spherical", weights = "equal",
                  max.dist = dist)
lines(ols1)


</code></pre>

<hr>
<h2 id='spVariog'>Compute empirical residual variogram for CRD or RCBD.</h2><span id='topic+spVariog'></span>

<h3>Description</h3>

<p>Compute empirical residual variogram for a Completely Randomized
Design (CRD) or a Randomized Complete Block Design (RCBD) by a call to variog function of the
package geoR.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spVariog(geodata, resp = NULL, treat = NULL, block = NULL, coords = NULL,
data = NULL, trend = c("cte", "1st"), scale = FALSE, max.dist,
design = c("crd", "rcbd"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spVariog_+3A_geodata">geodata</code></td>
<td>
<p>an object of class <code>geodata</code> in which the response variable
should be given in 'data.col', the coordinates in 'coords.col', the treatment vector
should be given as the first column of 'covar.col' and block as the second one.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_resp">resp</code></td>
<td>
<p>either a vector of response variables or a character giving
the column name where it can be found in 'data'. Optional argument, just required if
geodata is not provided.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_treat">treat</code></td>
<td>
<p>either a vector of treatment factors or a character giving
the column name where it can be found in 'data'. Optional argument, just required if
geodata is not provided.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_block">block</code></td>
<td>
<p>either a vector of block factors or a character giving the column name where
it can be found in 'data'. Optional argument, just required if geodata is not provided.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_coords">coords</code></td>
<td>
<p>either a 2-column matrix containing the spatial coordinates or a
character vector giving the columns name where the coordinates can be found in 'data'.
Optional argument, just required if geodata is not provided.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_data">data</code></td>
<td>
<p>a data frame in which the variables specified as characters will be found.
Optional argument, just required if geodata is not provided.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_trend">trend</code></td>
<td>
<p>type of spatial trend considered.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_scale">scale</code></td>
<td>
<p>logical argument. Should the coordinates be scaled? We recommend this
argument to be set as TRUE if your spatial coordinates have high values as in
UTM coordinate system otherwise, you could get errors in the calculations.
See ‘Details’.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_max.dist">max.dist</code></td>
<td>
<p>numerical value defining the maximum distance for the variogram.
See <code><a href="geoR.html#topic+variog">variog</a></code> documentation for additional information.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_design">design</code></td>
<td>
<p>type of experimental design. &quot;crd&quot; corresponds to Completely Randomized
Design and &quot;rcbd&quot; corresponds to Randomized Complete Block Design.</p>
</td></tr>
<tr><td><code id="spVariog_+3A_...">...</code></td>
<td>
<p>further arguments to be passed to <code><a href="geoR.html#topic+variog">variog</a></code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function provides a wrapper to variog to compute residual variogram for experimental designs.
The residuals are obtained by
</p>
<p style="text-align: center;"><code class="reqn">\varepsilon = Y-X\beta,</code>
</p>

<p>where Y is the vector of response, X is the design matrix built according to the experimental design
chosen, and <code class="reqn">\beta</code> is the vector of coefficients estimated by the linear model.
</p>
<p>If scale = TRUE the spatial coordinates will be scaled for numerical reasons. The scale is made by
subtracting the minimum spatial coordinate value from all others.
</p>


<h3>Value</h3>

<p>An object of class spVariog which is a list with the following components:
</p>
<table>
<tr><td><code>vario.res</code></td>
<td>
<p>an object of class variogram</p>
</td></tr>
<tr><td><code>data.geo</code></td>
<td>
<p>an object of class geodata</p>
</td></tr>
<tr><td><code>des.mat</code></td>
<td>
<p>the design matrix</p>
</td></tr>
<tr><td><code>trend</code></td>
<td>
<p>a character specifying the type of spatial trend</p>
</td></tr>
</table>


<h3>See Also</h3>

<p><code><a href="geoR.html#topic+variog">variog</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("crd_simulated")
dados &lt;- crd_simulated

#Geodata object
geodados &lt;- as.geodata(dados, coords.col = 1:2, data.col = 3,
                            covar.col = 4)
h_max &lt;- summary(geodados)[[3]][[2]]
dist &lt;- 0.6*h_max

# Computing the variogram
variograma &lt;- spVariog(geodata = geodados,
                      trend = "cte", max.dist = dist, design = "crd",
                      scale = FALSE)

plot(variograma, ylab = "Semivariance", xlab = "Distance")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
