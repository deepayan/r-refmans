<!DOCTYPE html><html lang="en"><head><title>Help for package CompQuadForm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CompQuadForm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#davies'><p>Davies method</p></a></li>
<li><a href='#farebrother'><p>Ruben/Farebrother method</p></a></li>
<li><a href='#imhof'><p>Imhof method.</p></a></li>
<li><a href='#liu'><p>Liu's method</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Distribution Function of Quadratic Forms in Normal Variables</td>
</tr>
<tr>
<td>Version:</td>
<td>1.4.3</td>
</tr>
<tr>
<td>Date:</td>
<td>2017-04-10</td>
</tr>
<tr>
<td>Author:</td>
<td>P. Lafaye de Micheaux</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>P. Lafaye de Micheaux &lt;lafaye@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the distribution function of quadratic forms in normal variables using Imhof's method, Davies's algorithm, Farebrother's algorithm or Liu et al.'s algorithm.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2017-04-10 02:26:43 UTC; lafaye</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2017-04-12 14:28:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='davies'>Davies method</h2><span id='topic+davies'></span>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Davies's method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>davies(q, lambda, h = rep(1, length(lambda)), delta = rep(0,
         length(lambda)), sigma = 0, lim = 10000, acc = 0.0001)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="davies_+3A_q">q</code></td>
<td>
<p>value point at which distribution function is to be evaluated</p>
</td></tr>
<tr><td><code id="davies_+3A_lambda">lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_1, \lambda_2, ..., \lambda_n</code>, i.e. distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code></p>
</td></tr>
<tr><td><code id="davies_+3A_h">h</code></td>
<td>
<p>respective orders of multiplicity <code class="reqn">n_j</code> of the <code class="reqn">\lambda</code>s</p>
</td></tr>
<tr><td><code id="davies_+3A_delta">delta</code></td>
<td>
<p>non-centrality parameters <code class="reqn">\delta_j^2</code> (should be positive)</p>
</td></tr>
<tr><td><code id="davies_+3A_sigma">sigma</code></td>
<td>
<p>coefficient <code class="reqn">\sigma</code> of the standard Gaussian</p>
</td></tr>
<tr><td><code id="davies_+3A_lim">lim</code></td>
<td>
<p>maximum number of integration terms. Realistic values for
'lim' range from 1,000 if the procedure is to be called repeatedly up
to 50,000 if it is to be called only occasionally</p>
</td></tr>
<tr><td><code id="davies_+3A_acc">acc</code></td>
<td>
<p>error bound. Suitable values for 'acc' range from 0.001 to
0.00005 which should be adequate for most statistical purposes.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes <code class="reqn">P[Q&gt;q]</code> where <code class="reqn">Q = \sum_{j=1}^r\lambda_jX_j+\sigma X_0</code> where <code class="reqn">X_j</code> are independent random variables having a non-central <code class="reqn">chi^2</code> distribution with <code class="reqn">n_j</code> degrees of freedom and non-centrality parameter <code class="reqn">delta_j^2</code> for <code class="reqn">j=1,...,r</code> and <code class="reqn">X_0</code> having a standard Gaussian distribution.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>trace</code></td>
<td>
<p>vector, indicating performance of procedure, with the
following components: 1: absolute
value sum, 2: total number of integration terms, 3: number of
integrations, 4: integration interval in main integration,
5: truncation point in initial integration, 6: standard deviation of
convergence factor term, 7: number of cycles to locate integration parameters</p>
</td></tr>
<tr><td><code>ifault</code></td>
<td>
<p>fault indicator: 0: no error, 1: requested accuracy
could not be obtained, 2: round-off error possibly significant, 3:
invalid parameters, 4: unable to locate integration parameters</p>
</td></tr>
<tr><td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>Davies R.B., Algorithm AS 155: The Distribution of a Linear
Combination of chi-2 Random Variables, Journal of the Royal
Statistical Society. Series C (Applied Statistics), 29(3), p. 323-333,
(1980)</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some results from Table 3, p.327, Davies (1980)

 round(1 - davies(1, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 round(1 - davies(7, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 round(1 - davies(20, c(6, 3, 1), c(1, 1, 1))$Qq, 4)
 
 round(1 - davies(2, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 round(1 - davies(20, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 round(1 - davies(60, c(6, 3, 1), c(2, 2, 2))$Qq, 4)
 
 round(1 - davies(10, c(6, 3, 1), c(6, 4, 2))$Qq, 4)
 round(1 - davies(50, c(6, 3, 1), c(6, 4, 2))$Qq, 4)
 round(1 - davies(120, c(6, 3, 1), c(6, 4, 2))$Qq, 4)

 round(1 - davies(20, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)
 round(1 - davies(100, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)
 round(1 - davies(200, c(7, 3), c(6, 2), c(6, 2))$Qq, 4)

 round(1 - davies(10, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)
 round(1 - davies(60, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)
 round(1 - davies(150, c(7, 3), c(1, 1), c(6, 2))$Qq, 4)

 round(1 - davies(70, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)
 round(1 - davies(160, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)
 round(1 - davies(260, c(7, 3, 7, 3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq, 4)

 round(1 - davies(-40, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6,
 2))$Qq, 4)
 round(1 - davies(40, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6, 2))$Qq,
 4)
 round(1 - davies(140, c(7, 3, -7, -3), c(6, 2, 1, 1), c(6, 2, 6,
 2))$Qq, 4)

# You should sometimes play with the 'lim' parameter:
davies(0.00001,lambda=0.2)
imhof(0.00001,lambda=0.2)$Qq
davies(0.00001,lambda=0.2, lim=20000)

</code></pre>

<hr>
<h2 id='farebrother'>Ruben/Farebrother method</h2><span id='topic+ruben'></span><span id='topic+farebrother'></span>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Farebrother's algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>farebrother(q, lambda, h = rep(1, length(lambda)),
            delta = rep(0, length(lambda)), maxit = 100000,
            eps = 10^(-10), mode = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="farebrother_+3A_q">q</code></td>
<td>
<p>value point at which distribution function is to be evaluated</p>
</td></tr>
<tr><td><code id="farebrother_+3A_lambda">lambda</code></td>
<td>
<p>the weights <code class="reqn">\lambda_1, \lambda_2, ..., \lambda_n</code>, i.e. the distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code> </p>
</td></tr>
<tr><td><code id="farebrother_+3A_h">h</code></td>
<td>
<p>vector of the respective orders of multiplicity <code class="reqn">m_i</code> of the <code class="reqn">\lambda</code>s</p>
</td></tr>
<tr><td><code id="farebrother_+3A_delta">delta</code></td>
<td>
<p>the non-centrality parameters <code class="reqn">\delta_i</code> (should be positive)</p>
</td></tr>
<tr><td><code id="farebrother_+3A_maxit">maxit</code></td>
<td>
<p>the maximum number of term K in equation below</p>
</td></tr>
<tr><td><code id="farebrother_+3A_eps">eps</code></td>
<td>
<p>the desired level of accuracy</p>
</td></tr>
<tr><td><code id="farebrother_+3A_mode">mode</code></td>
<td>
<p>if 'mode' &gt; 0 then <code class="reqn">\beta=mode*\lambda_{min}</code> otherwise <code class="reqn">\beta=\beta_B=2/(1/\lambda_{min}+1/\lambda_{max})</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Computes P[Q&gt;q] where <code class="reqn">Q=\sum_{j=1}^n\lambda_j\chi^2(m_j,\delta_j^2)</code>. P[Q&lt;q] is approximated by <code class="reqn">\sum_k=0^{K-1} a_k P[\chi^2(m+2k)&lt;q/\beta]</code> where <code class="reqn">m=\sum_{j=1}^n m_j</code> and <code class="reqn">\beta</code> is an arbitrary constant (as given by argument mode).
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>dnsty</code></td>
<td>
<p>the density of the linear form</p>
</td></tr>
<tr><td><code>ifault</code></td>
<td>
<p>the fault indicator. -i: one or more of the constraints
<code class="reqn">\lambda_i&gt;0</code></p>
</td></tr></table>
<p>, <code class="reqn">m_i&gt;0</code> and <code class="reqn">\delta_i^2\geq0</code> is not
satisfied. 1: non-fatal underflow of <code class="reqn">a_0</code>. 2: one or more of the
constraints <code class="reqn">n&gt;0</code>, <code class="reqn">q&gt;0</code>, <code class="reqn">maxit&gt;0</code> and <code class="reqn">eps&gt;0</code> is not
satisfied. 3: the current estimate of the probability is greater than
2. 4: the required accuracy could not be obtained in 'maxit'
iterations. 5: the value returned by the procedure does not satisfy
<code class="reqn">0\leq RUBEN\leq 1</code>. 6: 'dnsty' is negative. 9: faults 4 and
5. 10: faults 4 and 6. 0: otherwise.
</p>
<table role = "presentation">
<tr><td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>Farebrother R.W., Algorithm AS 204: The distribution of a Positive Linear
Combination of chi-squared random variables, Journal of the Royal
Statistical Society, Series C (applied Statistics), Vol. 33, No. 3
(1984), p. 332-339</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some results from Table 3, p.327, Davies (1980)

 1 - farebrother(1, c(6, 3, 1), c(1, 1, 1), c(0, 0, 0))$Qq

</code></pre>

<hr>
<h2 id='imhof'>Imhof method.</h2><span id='topic+imhof'></span>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in normal variables using Imhof's method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>imhof(q, lambda, h = rep(1, length(lambda)),
      delta = rep(0, length(lambda)),
      epsabs = 10^(-6), epsrel = 10^(-6), limit = 10000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="imhof_+3A_q">q</code></td>
<td>
<p>value point at which the survival function is to be evaluated</p>
</td></tr>
<tr><td><code id="imhof_+3A_lambda">lambda</code></td>
<td>
<p>distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code> </p>
</td></tr>
<tr><td><code id="imhof_+3A_h">h</code></td>
<td>
<p>respective orders of multiplicity of the <code class="reqn">\lambda</code>s</p>
</td></tr>
<tr><td><code id="imhof_+3A_delta">delta</code></td>
<td>
<p>non-centrality parameters (should be positive)</p>
</td></tr>
<tr><td><code id="imhof_+3A_epsabs">epsabs</code></td>
<td>
<p>absolute accuracy requested</p>
</td></tr>
<tr><td><code id="imhof_+3A_epsrel">epsrel</code></td>
<td>
<p>relative accuracy requested</p>
</td></tr>
<tr><td><code id="imhof_+3A_limit">limit</code></td>
<td>
<p>determines the maximum number of subintervals in the partition of the given integration interval</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">\boldsymbol{X}=(X_1,\ldots,X_n)'</code> be a column random vector which follows a multidimensional normal law with mean vector <code class="reqn">\boldsymbol{0}</code> and non-singular covariance matrix <code class="reqn">\boldsymbol{\Sigma}</code>. 
Let <code class="reqn">\boldsymbol{\mu}=(\mu_1,\ldots,\mu_n)'</code> be a constant vector, and consider the quadratic form
</p>
<p style="text-align: center;"><code class="reqn">Q=(\boldsymbol{x}+\boldsymbol{\mu})'\boldsymbol{A}(\boldsymbol{x}+\boldsymbol{\mu})=\sum_{r=1}^m\lambda_r\chi^2_{h_r;\delta_r}.</code>
</p>

<p>The function <code>imhof</code> computes <code class="reqn">P[Q&gt;q]</code>.
</p>
<p>The <code class="reqn">\lambda_r</code>'s are the distinct non-zero characteristic roots of
<code class="reqn">A\Sigma</code>, the <code class="reqn">h_r</code>'s their respective orders of
multiplicity, the <code class="reqn">\delta_r</code>'s  are certain linear combinations
of <code class="reqn">\mu_1,\ldots,\mu_n</code> and the
<code class="reqn">\chi^2_{h_r;\delta_r}</code> are independent
<code class="reqn">\chi^2</code>-variables with <code class="reqn">h_r</code> degrees of freedom and
non-centrality parameter <code class="reqn">\delta_r</code>. The variable
<code class="reqn">\chi^2_{h,\delta}</code> is defined here by the
relation <code class="reqn">\chi^2_{h,\delta}=(X_1 +
  \delta)^2+\sum_{i=2}^hX_i^2</code>, where <code class="reqn">X_1,\ldots,X_h</code> are
independent unit normal deviates.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td></tr>
<tr><td><code>abserr</code></td>
<td>
<p>estimate of the modulus of the absolute error, which
should equal or exceed abs(i - result)</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>J. P. Imhof, Computing the Distribution of Quadratic Forms in Normal Variables, <em>Biometrika</em>, Volume 48, Issue 3/4 (Dec., 1961), 419-426</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some results from Table 1, p.424, Imhof (1961)

# Q1 with x = 2
round(imhof(2, c(0.6, 0.3, 0.1))$Qq, 4)

# Q2 with x = 6
round(imhof(6, c(0.6, 0.3, 0.1), c(2, 2, 2))$Qq, 4)

# Q6 with x = 15
round(imhof(15, c(0.7, 0.3), c(1, 1), c(6, 2))$Qq, 4)

</code></pre>

<hr>
<h2 id='liu'>Liu's method</h2><span id='topic+liu'></span>

<h3>Description</h3>

<p>Distribution function (survival function in fact) of quadratic forms in
normal variables using Liu et al.'s method.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>liu(q, lambda, h = rep(1, length(lambda)),
    delta = rep(0, length(lambda)))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="liu_+3A_q">q</code></td>
<td>
<p>value point at which the survival function is to be evaluated</p>
</td></tr>
<tr><td><code id="liu_+3A_lambda">lambda</code></td>
<td>
<p>distinct non-zero characteristic roots of <code class="reqn">A\Sigma</code>, i.e. the <code class="reqn">\lambda_i</code>'s </p>
</td></tr>
<tr><td><code id="liu_+3A_h">h</code></td>
<td>
<p>respective orders of multiplicity <code class="reqn">h_i</code>'s of the <code class="reqn">\lambda</code>'s</p>
</td></tr>
<tr><td><code id="liu_+3A_delta">delta</code></td>
<td>
<p>non-centrality parameters <code class="reqn">\delta_i</code>'s (should be positive)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>New chi-square approximation to the distribution of non-negative
definite quadratic forms in non-central normal variables. 
</p>
<p>Computes <code class="reqn">P[Q&gt;q]</code> where <code class="reqn">Q=\sum_{j=1}^n\lambda_j\chi^2(h_j,\delta_j)</code>.
</p>
<p>This method does not work as good as the Imhof's method. Thus Imhof's method should be recommended.
</p>


<h3>Value</h3>

<table role = "presentation">
<tr><td><code>Qq</code></td>
<td>
<p><code class="reqn">P[Q&gt;q]</code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Pierre Lafaye de Micheaux (<a href="mailto:lafaye@dms.umontreal.ca">lafaye@dms.umontreal.ca</a>) and
Pierre Duchesne (<a href="mailto:duchesne@dms.umontreal.ca">duchesne@dms.umontreal.ca</a>)</p>


<h3>References</h3>

<p>P. Duchesne, P. Lafaye de Micheaux, Computing the distribution of quadratic forms: Further comparisons between the Liu-Tang-Zhang approximation and exact methods, <em>Computational Statistics and Data Analysis</em>, Volume 54, (2010), 858-862
</p>
<p>H. Liu, Y. Tang, H.H. Zhang, A new chi-square approximation
to the distribution of non-negative definite quadratic forms in
non-central normal variables, <em>Computational Statistics and Data Analysis</em>, Volume 53, (2009), 853-856</p>


<h3>Examples</h3>

<pre><code class='language-R'># Some results from Liu et al. (2009)
# Q1 from Liu et al.
round(liu(2, c(0.5, 0.4, 0.1), c(1, 2, 1), c(1, 0.6, 0.8)), 6)
round(liu(6, c(0.5, 0.4, 0.1), c(1, 2, 1), c(1, 0.6, 0.8)), 6)
round(liu(8, c(0.5, 0.4, 0.1), c(1, 2, 1), c(1, 0.6, 0.8)), 6)

# Q2 from Liu et al.
round(liu(1, c(0.7, 0.3), c(1, 1), c(6, 2)), 6)
round(liu(6, c(0.7, 0.3), c(1, 1), c(6, 2)), 6)
round(liu(15, c(0.7, 0.3), c(1, 1), c(6, 2)), 6)

# Q3 from Liu et al.
round(liu(2, c(0.995, 0.005), c(1, 2), c(1, 1)), 6)
round(liu(8, c(0.995, 0.005), c(1, 2), c(1, 1)), 6)
round(liu(12, c(0.995, 0.005), c(1, 2), c(1, 1)), 6)

# Q4 from Liu et al.
round(liu(3.5, c(0.35, 0.15, 0.35, 0.15), c(1, 1, 6, 2), c(6, 2, 6, 2)),
6)
round(liu(8, c(0.35, 0.15, 0.35, 0.15), c(1, 1, 6, 2), c(6, 2, 6, 2)), 6)
round(liu(13, c(0.35, 0.15, 0.35, 0.15), c(1, 1, 6, 2), c(6, 2, 6, 2)), 6)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
