<!DOCTYPE html><html><head><title>Help for package VIC5</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {VIC5}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#NSE'><p>Several metrics to evaluate the accuracy of hydrological modeling</p></a></li>
<li><a href='#print.vic_output'><p>VIC model run for each gridcells</p></a></li>
<li><a href='#STEHE'><p>Sample datasets of the Stehekin for the running of the VIC model</p>
provided by UW Hydro</a></li>
<li><a href='#veglib_IGBP'><p>IGBP vegetation library for VIC model</p></a></li>
<li><a href='#vic_params'><p>Get or set global parameters of the VIC model.</p></a></li>
<li><a href='#vic_version'><p>Display version of VIC model and this package.</p></a></li>
<li><a href='#VIC5'><p>VIC5: The Variable Infiltration Capacity (VIC) Model version 5 in R</p></a></li>
<li><a href='#XAJ'><p>Run Xinanjiang (XAJ) model (three sources, lumped).</p></a></li>
<li><a href='#XAJ.param.range'><p>XAJ parameters</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>The Variable Infiltration Capacity (VIC) Hydrological Model</td>
</tr>
<tr>
<td>Version:</td>
<td>0.2.6</td>
</tr>
<tr>
<td>Description:</td>
<td>The Variable Infiltration Capacity (VIC) model is a macroscale
    hydrologic model that solves full water and energy balances, originally
    developed by Xu Liang at the University of Washington (UW).
    The version of VIC source code used is of 5.0.1 on <a href="https://github.com/UW-Hydro/VIC/">https://github.com/UW-Hydro/VIC/</a>,
    see Hamman et al. (2018).
    Development and maintenance of the current official version
    of the VIC model at present is led by the UW Hydro (Computational Hydrology
    group) in the Department of Civil and Environmental Engineering at UW. VIC is
    a research model and in its various forms it has been applied to most of the
    major river basins around the world, as well as globally 
    <a href="http://vic.readthedocs.io/en/master/Documentation/References/">http://vic.readthedocs.io/en/master/Documentation/References/</a>. 
    References: "Liang, X., D. P. Lettenmaier, E. F. Wood, and
    S. J. Burges (1994), A simple hydrologically based model of land surface water
    and energy fluxes for general circulation models, J. Geophys. Res., 99(D7),
    14415-14428, &lt;<a href="https://doi.org/10.1029%2F94JD00483">doi:10.1029/94JD00483</a>&gt;"; 
    "Hamman, J. J., Nijssen, B., Bohn, T. J., Gergel, D. R., and Mao, Y. (2018), The
    Variable Infiltration Capacity model version 5 (VIC-5): infrastructure improvements
    for new applications and reproducibility, Geosci. Model Dev., 11, 3481-3496, 
    &lt;<a href="https://doi.org/10.5194%2Fgmd-11-3481-2018">doi:10.5194/gmd-11-3481-2018</a>&gt;".</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Copyright:</td>
<td>file inst/COPYRIGHTS</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/rpkgs/VIC5">https://github.com/rpkgs/VIC5</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, lubridate, Rcpp, foreach</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), doParallel</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>RcppArmadillo, Rcpp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-16 13:26:21 UTC; hydro</td>
</tr>
<tr>
<td>Author:</td>
<td>Ruida Zhong [aut, ctb],
  Dongdong Kong <a href="https://orcid.org/0000-0003-1836-8172"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Xiaohong Chen [aut, ctb],
  Zhaoli Wang [aut, ctb],
  Chengguang Lai [aut, ctb],
  Joseph J Hamman [ctb] (Contributor and maintainer of VIC source code),
  Keith Cherkauer [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dongdong Kong &lt;kongdd.sysu@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-17 08:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='NSE'>Several metrics to evaluate the accuracy of hydrological modeling</h2><span id='topic+NSE'></span><span id='topic+logNSE'></span><span id='topic+rNSE'></span><span id='topic+RB'></span>

<h3>Description</h3>

<p>Calculate several metrics for the evaluating of hydrological
modeling accuracy, including the Nash-Sutcliffe coefficient of efficiency
(NSE), Logarithmic NSE (log-NSE), relative NSE (rNSE), and relative bias
(RB).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NSE(sim, obs)

logNSE(sim, obs)

rNSE(sim, obs)

RB(sim, obs)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="NSE_+3A_sim">sim</code></td>
<td>
<p>Data series to be evaluated, usually are the simulated
streamflow of hydrological model.</p>
</td></tr>
<tr><td><code id="NSE_+3A_obs">obs</code></td>
<td>
<p>Data series as benchmark to evaluate <code>sim</code>, usually
are the observed streamflow.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The Nash-Sutcliffe coefficient of efficiency (NSE) (Nash and Sutcliffe, 1970)
is a widely used indicator of the accuracy of model simulations, or other
estimation method with reference to a benchmark series (usually the
observations), especially the hydrological modeling.
</p>
<p>NSE is equal to one minus the normalized mean square error (ratio between
the mean square error and the variation of observations):
</p>
<p style="text-align: center;"><code class="reqn">NSE=1-\sum(sim-obs)**2/\sum(obs-mean(obs))**2</code>
</p>

<p>1 is the perfect value of NSE, and NSE &lt; 0 indicates that the simulation
results are unusable.
</p>
<p>The conventional NSE is ususlly affected by the accuracy of high values, and
would impact the low flow simulation when be taken as the objective function
in hydrological model calibration. Therefore, some revised NSE were proposed.
</p>
<p>Oudin et al. (2006) proposed the log-NSE to increase the sensitivity to the
accuracy of low flow simulations:
</p>
<p style="text-align: center;"><code class="reqn">log-NSE=1-\sum(log(sim)-log(obs))**2/\sum(log(obs)-log(mean(obs)))**2</code>
</p>

<p>Krause et al. (2005) proposed the relative NSE to reduce the impact of the
magnitude of data:
</p>
<p style="text-align: center;"><code class="reqn">rNSE=1-\sum((sim-obs)obs)**2/\sum((obs-mean(obs))/mean(obs))**2</code>
</p>

<p>Relative bias (RB) is used to quantify the relative systematic bias of the
simulation results:
</p>
<p style="text-align: center;"><code class="reqn">RB=sum(sim)/sum(obs)-1</code>
</p>

<p>Positive or negative value of RB indicate the positive or negative bias of
simulations respectively. Perfect value of RB is 0.
</p>


<h3>Value</h3>

<p>The value of NSE, log-NSE, rNSE and RB.
</p>


<h3>References</h3>

<p>Krause, P., Boyle, D. P., and Base, F., 2005, Comparison of different efficiency
criteria for hydrological model assessment, Advances in Geoscience, 5, 89-97.
doi: 10.5194/adgeo-5-89-2005
</p>
<p>Nash, J. E., Sutcliffe, J. V., 1970. River flow forecasting through conceptual
models part I - A discussion of principles. Journal of Hydrology. 10(3): 282-290.
doi:10.1016/0022-1694(70)90255-6
</p>
<p>Oudin, L., Andreassian, V., Mathevet, T., Perrin, C., Michel, C., 2006. Dynamic
averaging of rainfall-runoff model simulations from complementary model
parameterizations. Water Resources Research, 42(7). doi: 10.1029/2005WR004636
</p>


<h3>See Also</h3>

<p><code style="white-space: pre;">&#8288;[Lohmann_UH()]&#8288;</code>, <code style="white-space: pre;">&#8288;[Lohmann_conv()]&#8288;</code>
</p>

<hr>
<h2 id='print.vic_output'>VIC model run for each gridcells</h2><span id='topic+print.vic_output'></span><span id='topic+vic'></span>

<h3>Description</h3>

<p>Run the VIC model for each gridcells by providing several meteorological
and vegetation (optional) forcing data and land surface parameters (soil,
vegetation, snowband (optional), lake (optional)).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vic_output'
print(x, ...)

vic(
  forcing,
  soil,
  veg,
  output_info = NULL,
  veglib = NULL,
  snowband = NULL,
  lake = NULL,
  forcing_veg = NULL,
  veg_force_types = c("albedo", "LAI", "fcanopy"),
  parall = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.vic_output_+3A_x">x</code></td>
<td>
<p>Return of <code><a href="#topic+vic">vic()</a></code> for print.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_...">...</code></td>
<td>
<p>Other arguments to print.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_forcing">forcing</code></td>
<td>
<p>meteorological forcing data. Must be a list of numeral matrix
with the name of one of &quot;PREC&quot;, &quot;TEMP&quot;, &quot;SW&quot;, &quot;LW&quot;, &quot;WIND&quot;, &quot;VP&quot; and &quot;PRESS&quot;.
See details.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_soil">soil</code></td>
<td>
<p>soil parameter data. Must be a data frame or numeral matrix.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_veg">veg</code></td>
<td>
<p>vegetation parameters. Must be a list containing several matrixs.
See details.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_output_info">output_info</code></td>
<td>
<p>A list containing output contents and timescales
(optional). See details.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_veglib">veglib</code></td>
<td>
<p>Vegetation library parameters (optional). Would using the
library of the NLDAS and GLDAS when not provided.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_snowband">snowband</code></td>
<td>
<p>A data frame or numeral matrix containing snow band
parameters (optional). See details.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_lake">lake</code></td>
<td>
<p>A dataframe or numeric matrix containing lake parameters
(optional).</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_forcing_veg">forcing_veg</code></td>
<td>
<p>Vegetation forcing data (optional). See details.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_veg_force_types">veg_force_types</code></td>
<td>
<p>Type names of vegetation forcing data. Must be
provided when using vegetation forcing data.</p>
</td></tr>
<tr><td><code id="print.vic_output_+3A_parall">parall</code></td>
<td>
<p>Determined if run the VIC parallely. If it is TRUE,
<code>registerDoParallel()</code> in package <span class="pkg">doParallel</span> is
need to be used before run the VIC.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Function <code>vic</code> is used to run the VIC model in a &quot;classic&quot; style
(Run the model gridcell by gridcell). Meteorological forcing data,
soil parameters and vegetation parameters are the basic necessary inputs
for the VIC model.
</p>


<h3>Value</h3>

<p>A list containing output tables, time table and model settings.
</p>
<p>VIC in R supports multiple &quot;output tables&quot; with different output timescales.
For example,
you can put soil moisture and soil temperature in a table with monthly
timescale and put runoff, baseflow in another table with daily timescale.
</p>
<p>You can use <code>print()</code> to print the summary of the returns.
The returns includes:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>output</code> </td><td style="text-align: left;"> One or several "output tables" and each of them containing
several output variables, which is determined by the <code>output_info</code>
parameter. The name of the "table" would also be which <code>output_info</code>
determined. Each "table" containing several numerial matrices corresponding
to the output variables. Each row of the matrices is output data for a
time step while each column is output data for a gridcell. </td>
</tr>
<tr>
 <td style="text-align: left;">

<code>timetable</code> </td><td style="text-align: left;"> Containing initiation time, model running time and
final (orgnizate outputs) time of the VIC model running.</td>
</tr>
<tr>
 <td style="text-align: left;">

<code>global_options</code> </td><td style="text-align: left;"> Global options setted for this model run. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>output_infos</code> </td><td style="text-align: left;"> Output settings determined by the <code>output_info</code>
parameter.
</td>
</tr>

</table>



<h3>Forcing data</h3>

<p>Parameter <code>forcing</code> must be a list containing several numeral matrixs
that containing forcing data. Name of each matrix (similar to key in
dictionary in Python) must be the specific type names including
&quot;PREC&quot;, &quot;TEMP&quot;, &quot;SW&quot;, &quot;LW&quot;, &quot;WIND&quot;, &quot;VP&quot; and &quot;PRESS&quot;, indicating precipitation
<code style="white-space: pre;">&#8288;[mm]&#8288;</code>, air temperature <code style="white-space: pre;">&#8288;[degree C]&#8288;</code>, shortwave radiation <code style="white-space: pre;">&#8288;[W]&#8288;</code>, longwave radiation
<code style="white-space: pre;">&#8288;[W]&#8288;</code>, wind speed <code style="white-space: pre;">&#8288;[m/s]&#8288;</code>, vapor pressure <code style="white-space: pre;">&#8288;[kPa]&#8288;</code>, and atmospheric pressure <code style="white-space: pre;">&#8288;[kPa]&#8288;</code>.
All of those types are necessary to run the VIC model except &quot;LW&quot; and &quot;PRESS&quot;.
Each row of the matrixs is corresponding to a time step while each column of
the matrixs is corresponding to a gridcell, which other must be the same as
those in soil parameter.
</p>
<p>Longwave radiation (LW) and atmospheric pressure (PRESS) could be estimated
via other forcing data when not supplied. Longwave radiation would be
estimated using the Konzelmann formula (Konzelmann et al., 1996) while
atmospheric pressure would be estimated based on the method of VIC 4.0.6,
by assuming the sea level pressure is a constant of 101.3 kPa.
</p>


<h3>Soil parameters</h3>

<p>Parameter <code>soil</code> must be a numeric data frame or matrix that containing
soil parameters. The style of this is the same as the soil parameter file
of the classic VIC, that is, each row restores the parameter of a cell
while each column restores one type of parameter. Detail see
<a href="http://vic.readthedocs.io/en/master/Documentation/Drivers/Classic/SoilParam/">http://vic.readthedocs.io/en/master/Documentation/Drivers/Classic/SoilParam/</a>
in the official VIC documentation webside.
</p>


<h3>Vegetation parameter</h3>

<p>Parameter <code>veg</code> must be a list containing several numeral matrixs that
Those matrixs restore the vegetation parameters that are corresponding
to each gridcells, and those order must be the same as the soil parameters.
Each row of the matrix restores the parameters of a vegetation type
while each column restores a type of parameter.
Each row should be like:
</p>
<pre>
c(veg_type, area_fract, rootzone_1_depth,
  rootzone_1_fract, rootzone_2_depth, rootzone_2_fract, ...)
</pre>
<p>which is similar to the veg param file
of the classic VIC. If the source of LAI, fcanopy or albedo is set
to veg params, it must be follow by a sequence of param value for each
month in a year. The rows of <code>veg</code> would be similar as:
</p>
<pre>
c(veg_type, area_fract, rootzone_1_depth,
  rootzone_1_fract, rootzone_2_depth, rootzone_2_fract,
  LAI_Jan, LAI_Feb, LAI_Mar, ..., LAI_Dec,
  fcan_Jan, fcan_Feb, fcan_Mar, ..., fcan_Dec,
  albedo_Jan, albedo_Feb, albedo_Mar, ..., albedo_Dec)
</pre>


<h3>Output information (Optional)</h3>

<p>Parameter <code>output_info</code> is used to determine the output variables,
output timescale (monthly, daily, sub-daily, or each 6 days, etc.),
aggregration of data (mean, sum, max, min, start or end) when output
timescale is larger than input timescale. It should be a list like that:
</p>
<pre>
output_info &lt;- list(timescale = 'timescale', aggpar = aggpar,
                    outvars = c('OUT_TYPE_1', 'OUT_TYPE_2', 'OUT_TYPE_3', ...),
                    aggtypes = c('aggtype_1', 'aggtype_2', 'aggtype_3'))
</pre>
<p>And a output table (a list containing the output variables in matrix form)
named &quot;output&quot; would be returned. You can obtain the variables use code like
<code>res$output$OUT_...</code>.
Names of the items in the list (e.g. timescale, outvars) must be those
specified as follows:
</p>

<table>
<tr>
 <td style="text-align: left;">
<code>timescale</code> </td><td style="text-align: left;"> Output timescale, including 'never', 'step', 'second',
'minute', 'hour', 'day', 'month', 'year', 'date', and 'end'. 'never'
means never output, 'step' means use the input timestep, 'date'
means output at a specific date, and 'end' means output at the last
timestep.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>aggpar</code> </td><td style="text-align: left;"> If 'timescale' is set to those except 'never', 'date' and
'end', it determined the intervals of the timescale to pass before output.

If 'timescale' is 'day' and 'aggpar' is 6, that means data outputs per 6
days.

If 'timescale' is 'date', it should be a <code>Date</code> type and it could be
generated use <code>as.Date('YYYY-mm-dd')</code>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>outvars</code> </td><td style="text-align: left;"> A sequence of names of output data types. The available
data types please see the VIC official documentation website at
<a href="http://vic.readthedocs.io/en/master/Documentation/OutputVarList/">http://vic.readthedocs.io/en/master/Documentation/OutputVarList/</a>.</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>aggtypes</code> </td><td style="text-align: left;"> Optional. A sequence of string determine how to
aggregrate the output data when output timescale is larger than input
timescale, Including 'avg' (average), 'begin', 'end', 'max', 'min', 'sum',
'default'.
Each string in it must be corresponding to those in 'outvars'.

If input timescale is daily, while output timescale is monthly, and
aggtype is 'begin', it would output the data of the first day of each
month.
</td>
</tr>

</table>

<p>If multiple output timescales are used, the outputs could be divided
into several lists and take them into a list as input, e.g.:
</p>
<pre>
out_info &lt;- list(
  wb = list(timescale = 'hour', aggpar = 6,
            outvars = c('OUT_RUNOFF', 'OUT_BASEFLOW', 'OUT_SOIL_MOIST'),
            aggtypes = c('sum', 'sum', 'end')),
  eb = list(timescale = 'day', aggpar = 1,
            outvars = c('OUT_SWE', 'OUT_SOIL_TEMP'),
            aggtypes = c('avg', 'min'))
)
</pre>
<p>This would return two output tables named &quot;wb&quot; and &quot;eb&quot; respectively.
</p>


<h3>Vegetation library (Optional)</h3>

<p>Parameter <code>veglib</code> is a matrix or a numeric dataframe of a vegetation
parameter library. Each row determines a type of vegetation while each
column determines a parameter, including ovetstory (or not), LAI for each
month in a year, etc. If not provided, it would use the default vegetation
library of the NASA Landsurface Data Assimination System (LDAS) (Rodell
et al., 2004), which contains 11 types of vegetation with the vegetation
classification of UMD.
</p>


<h3>Snowband (elevation band) (Optional)</h3>

<p>Parameter <code>snowband</code> is a matrix or a numeric dataframe determines
the elevation band information for each gridcells. Each row determines
the band information of a gridcell while a column determines the values
of the elevation band parameters.
This devide a single gridcell into several parts with dfferent elevation
to run individually, to further consider the sub-gridcell heterogeneity
of elevation and the resulted heterogeneity air temperature in a gridcell
with higher variation of elevation. The information of elevation bands
includes area fraction, mean elevation and fraction of precipitation
falled to the gridcell of each elevation band of the gridcell.
The order of the rows must be coresponding to the gridcells determined
in the soil parameters. Each row should be like:
</p>
<pre>
c(GRID_ID, AFRAC_1, AFRAC_2, ..., AFRAC_n, ELEV_1, ELEV_2, ..., ELEV_n,
  PFRAC_1, PFRAC_2, ..., PFRAC_n)
</pre>
<p><code>GRID_ID</code> is the id of the grid; AFRAC_i means area fraction of
each elevation band; ELEV_i is their mean elevation; PFRAC_i is there
precipitation fraction. n is the number of elevation bands for each
gridcell and is determined by <code>'nbands'</code> in the global options.
This can be set used <code>veg_param('nbands', n)</code>.
</p>


<h3>Vegetation forcing data (Optional)</h3>

<p>Parameter <code>forcing_veg</code> must be a list containing several 3D numeral
arrays that containing vegetation forcing data such as LAI, albedo and
fraction of canopy. Different to parameter <code>forcing</code>, each 3D array
in the list is the vegetation forcing data for a single gridcell, and the
order of the 3D arrays must be corresponding to the order of the gridcells
determined in the soil parameter.
</p>
<p>The dimensions of a 3D array are represents: <code style="white-space: pre;">&#8288;[timestep, vegetation tile, forcing type]&#8288;</code>
</p>
<p>That is, the first dimension determines the data of the timesteps, the
second dimension determines the data for the different vegetation tiles
in this gridcell that determined by the vegetation parameters, while
the third dimension determined the data of different forcing data type
(LAI, albedo or fcanopy), which should be corresponding to the parameter
<code>veg_force_types</code>.
</p>


<h3>References</h3>

<p>Hamman, J. J., Nijssen, B., Bohn, T. J., Gergel, D. R., and Mao, Y. (2018),
The Variable Infiltration Capacity model version 5 (VIC-5): infrastructure
improvements for new applications and reproducibility, Geosci. Model Dev., 11,
3481-3496, <a href="https://doi.org/10.5194/gmd-11-3481-2018">doi:10.5194/gmd-11-3481-2018</a>.
</p>
<p>Konzelmann, T, Van de Wal, R.S.W., Greuell, W., Bintanja, R., Henneken, E.A.C.,
Abe-Ouchi, A., 1996. Parameterization of global and longwave incoming radiation
for the Greenland Ice Sheet. Global Planet. Change, 9:143-164.
</p>
<p>Liang, X., Lettenmaier, D. P., Wood, E. F., and Burges, S. J. (1994), A
simple hydrologically based model of land surface water and energy
fluxes for general circulation models, J. Geophys. Res., 99(D7),
14415-14428, <a href="https://doi.org/10.1029/94JD00483">doi:10.1029/94JD00483</a>.
</p>
<p>Liang, X., and Xie, Z., 2001: A new surface runoff parameterization
with subgrid-scale soil heterogeneity for land surface models,
Advances in Water Resources, 24(9-10), 1173-1193.
</p>
<p>Rodell, M., Houser, P.R., Jambor, U., Gottschalck, J., Mitchell, K.,
Meng, C.-J., Arsenault, K., Cosgrove, B., Radakovich, J., Bosilovich, M.,
Entin, J.K., Walker, J.P., Lohmann, D., and Toll, D. (2004), The Global
Land Data Assimilation System, Bull. Amer. Meteor. Soc., 85(3), 381-394.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This is a sample data to run VIC.
data(STEHE)

forcing &lt;- STEHE$forcing
soil &lt;- STEHE$soil
veg &lt;- STEHE$veg

# Set the global options for a 7-days run.
vic_params(list(
  date_start = "1949-01-01",
  date_end = "1949-01-10",
  step_per_day = 24,
  snow_step_per_day = 24,
  runoff_step_per_day = 24
))

# Run VIC.
outputs &lt;- vic(forcing, soil, veg)
print(outputs)

# Use user defind outputs and snowband parameters.
vic_param('nbands', 5)
band &lt;- STEHE$snowbands

out_info &lt;- list(
  wb = list(timescale = 'hour', aggpar = 6,
            outvars = c('OUT_RUNOFF', 'OUT_BASEFLOW', 'OUT_SOIL_MOIST'),
            aggtypes = c('sum', 'sum', 'end')),
  eb = list(timescale = 'day', aggpar = 1,
            outvars = c('OUT_SWE', 'OUT_SOIL_TEMP'),
            aggtypes = c('avg', 'min'))
)

outputs &lt;- vic(forcing, soil, veg, snowband = band, output_info = out_info)
print(outputs)

# Example of parallelization
## Not run: 
library(doParallel)
registerDoParallel(cores=4)
outputs &lt;- vic(forcing, soil, veg, snowband = band, parall = TRUE)
stopImplicitCluster()
print(outputs)

## End(Not run)
</code></pre>

<hr>
<h2 id='STEHE'>Sample datasets of the Stehekin for the running of the VIC model
provided by UW Hydro</h2><span id='topic+STEHE'></span>

<h3>Description</h3>

<p>Sample datasets of the Stehekin for the running of the VIC model
provided by UW Hydro
</p>


<h3>Usage</h3>

<pre><code class='language-R'>STEHE
</code></pre>


<h3>Format</h3>

<p>A list including meteorological forcing data, soil parameters,
vegetation parameters, vegetation library, snowband parameters
and vegetation forcing data for 16 0.25 degree gridcells.
The dataset is provided by the
<a href="http://uw-hydro.github.io/">Computational Hydrology group</a>,
Department of Civil and Environmental Engineering at the
University of Washington.
</p>
<p>This is a list containing:
</p>

<dl>
<dt>forcing</dt><dd><p>10-day hourly meteorological forcing data from
1949-01-01 to 1949-01-10, including precipitation, air temperature,
longwave and shortwave radiation, wind speed, vapor pressure, and
air pressure.</p>
</dd>
<dt>soil</dt><dd><p>soil parameters for 16 gridcells.</p>
</dd>
<dt>veg</dt><dd><p>vegetation parameters for 16 gridcells.</p>
</dd>
<dt>snowbands</dt><dd><p>elevation band (snow band) parameters.</p>
</dd>
<dt>veglib</dt><dd><p>vegetation library.</p>
</dd>
<dt>forcing_veg</dt><dd><p>vegetation forcing data including LAI,
fraction of canopy, and albedo. This is generated by simply temporally
repeat the values of <code>veglib</code> according to <code>veg</code>.</p>
</dd>
<dt>runoff_table_daily</dt><dd><p>Three-year daily runoff outputs of the
VIC model from 1949-01-01 to 1951-12-31. This is as the sample input data
of the streamflow routing model of Lohmann in the form of output table
returned by <code><a href="#topic+vic">vic()</a></code>, containing two output variable:
<code>OUT_RUNOFF</code> and <code>OUT_BASEFLOW</code>.</p>
</dd>
<dt>streamflow_obs</dt><dd><p>Observed streamflow series to be the reference to
evaluate the streamflow simulation results.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://github.com/UW-Hydro/VIC_sample_data">https://github.com/UW-Hydro/VIC_sample_data</a>
</p>
<p><a href="http://uw-hydro.github.io/">http://uw-hydro.github.io/</a>
</p>

<hr>
<h2 id='veglib_IGBP'>IGBP vegetation library for VIC model</h2><span id='topic+veglib_IGBP'></span>

<h3>Description</h3>

<p>This library is originated from Python package <code>hydrate</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>veglib_IGBP
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.table</code> (inherits from <code>data.frame</code>) with 17 rows and 58 columns.
</p>


<h3>References</h3>


<ol>
<li><p> https://github.com/KMarkert/hydrate/blob/master/hydrate/lookups/veg_params.py
</p>
</li>
<li><p> https://github.com/KMarkert/hydrate
</p>
</li></ol>


<hr>
<h2 id='vic_params'>Get or set global parameters of the VIC model.</h2><span id='topic+vic_params'></span><span id='topic+vic_param'></span>

<h3>Description</h3>

<p>Get or set global parameters of the VIC model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vic_params(options)

vic_param(par, val = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vic_params_+3A_options">options</code></td>
<td>
<p>List object, see details</p>
</td></tr>
<tr><td><code id="vic_params_+3A_par">par</code></td>
<td>
<p>Name of the VIC global parameter.</p>
</td></tr>
<tr><td><code id="vic_params_+3A_val">val</code></td>
<td>
<p>Value of the parameter to be set. Will return the current setting
value when not provided.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The global paremteres are as follows:
</p>

<dl>
<dt>nlayers</dt><dd><p>Integer. Number of moisture layers used by the model.
Default = 3.</p>
</dd> <dt>nnodes</dt><dd><p>Integer. Number of thermal solution nodes in
the soil column.</p>
</dd> <dt>step_per_day</dt><dd><p>Integer. Number of simulation time
steps per day. Should be &gt; 4 when full_energy=TRUE or frozen_soil=TRUE.</p>
</dd>
<dt>snow_step_per_day</dt><dd><p>Integer. Number of time steps per day used to
solve the snow model (if step_per_day &gt; 1, this should = step_per_day)</p>
</dd>
<dt>runoff_step_per_day</dt><dd><p>Integer. Number of time steps per day used to
solve the runoff model (should be &gt;= step_per_day)</p>
</dd>
<dt>start_year</dt><dd><p>Integer. Year of model simulation starts.</p>
</dd>
<dt>start_month</dt><dd><p>Integer. Month of model simulation starts</p>
</dd>
<dt>start_day</dt><dd><p>Integer. Day of model simulation starts</p>
</dd>
<dt>start_sec</dt><dd><p>Integer. Second of model simulation starts (e.g.,
start_sec = 0 means starting from the beginning of a day; start_sec = 3600
for starting from the beginning of the second hour of a day). Default = 0.</p>
</dd>
<dt>nrecs</dt><dd><p>Integer. Number of time steps over which to run model. The
number of records must be defined such that the model completes the last
day. Either??nrecs or end_year, end_month, and end_day must be specified,
but??not both.</p>
</dd>
<dt>end_year</dt><dd><p>Integer. Year of model simulation ends.</p>
</dd>
<dt>end_month</dt><dd><p>Integer. Month of model simulation ends</p>
</dd>
<dt>end_day</dt><dd><p>Integer. Day of model simulation ends</p>
</dd>
<dt>calendar</dt><dd><p>Boolean. Calendar to use. Calendar to use. Must be one of:
&quot;standard&quot;, &quot;gregorian&quot;, &quot;proleptic_gregorian&quot;, &quot;noleap&quot;, &quot;365_day&quot;,
&quot;360_day&quot;, &quot;julian&quot;, &quot;all_leap&quot;, &quot;366_day.&quot;</p>
</dd>
<dt>time_units</dt><dd><p>Boolean. Units for output time variables. Units for
output time variables. Should be one of &quot;days&quot;, &quot;hours&quot;, &quot;minutes&quot;,
&quot;seconds&quot;. Default = days.</p>
</dd>
<dt>full_energy</dt><dd><p>Boolean. Option for computing land surface temperature
(soil or snowpack surface). TRUE??= compute (via iteration) the temperature
that balances the surface energy budget. FALSE??= set surface temperature
equal to air temperature. Default = False.</p>
</dd>
<dt>close_energy</dt><dd><p>Boolean. Option for controlling links between the
energy balances of the surface and the canopy. TRUE??= iterate between the
canopy and surface energy balances until they are consistent. FALSE??=
compute the surface and canopy energy balances separately, once per time
step.?? Default = FALSE.</p>
</dd>
<dt>frozen_soil</dt><dd><p>Boolean. Option for handling the water/ice phase change
in frozen soils. TRUE = account for water/ice phase change (including
latent heat). FALSE = soil moisture always remains liquid, even when below
0 C; no latent heat effects and ice content is always 0. Default = FALSE.
To activate this option, the user must also set the FS_ACTIVE flag to 1 in
the soil parameters (parameter <code>soil</code> of <code><a href="#topic+vic">vic()</a></code>) for each grid cell where
this option is desired. In other words, the user can choose for some grid
cells (e.g. cold areas) to compute ice contents and for others (e.g. warm
areas) to skip the extra computation.</p>
</dd>
<dt>quick_flux</dt><dd><p>Boolean. Option for computing the soil vertical
temperature profile. TRUE = use the approximate method described by Liang
et al. (1999) to compute soil temperatures and ground heat flux; this
method ignores water/ice phase changes. FALSE = use the finite element
method described in Cherkauer and Lettenmaier (1999) to compute soil
temperatures and ground heat flux; this method is appropriate for
accounting for water/ice phase changes. Default = FALSE (i.e. use Cherkauer
and Lettenmaier, 1999) when running FROZEN_SOIL; and TRUE (i.e. use Liang
et al. ,1999) in all other cases.</p>
</dd>
<dt>implicit</dt><dd><p>Boolean. If TRUE the model will use an implicit solution
for the soil heat flux equation of Cherkauer and Lettenmaier (1999)
(quick_flux is FALSE), otherwise uses original explicit solution. When
quick_flux is TRUE the implicit solution has no effect. The user can
override this option by setting implicit to FALSE in the global parameters.
The implicit solution is guaranteed to be stable for all combinations of
time step and thermal node spacing; the explicit solution is only stable
for some combinations. If the user sets implicit to FALSE, VIC will check
the time step, node spacing, and soil thermal properties to confirm
stability. If the explicit solution will not be stable, VIC will exit with
an error message. Default = TRUE.</p>
</dd>
<dt>quick_solve</dt><dd><p>Boolean. This option is a hybrid of quick_flux. If TRUE,
model will use the method described by Liang et al. (1999) to compute
ground heat flux during the surface energy balance iterations, and then
will use the method described in Cherkauer and Lettenmaier (1999) for the
final solution step. Default = FALSE.</p>
</dd>
<dt>no_flux</dt><dd><p>Boolean. If TRUE model will use a no flux bottom boundary
with the finite difference soil thermal solution (i.e. quick_flux = FALSE
or full_energy = TRUE or frozen_soil = TRUE). Default = FALSE (i.e., use a
constant temperature bottom boundary condition).</p>
</dd>
<dt>exp_trans</dt><dd><p>Boolean. If TRUE the model will exponentially distributes
the thermal nodes in the Cherkauer and Lettenmaier (1999) finite difference
algorithm, otherwise uses linear distribution. (This is only used if
frozen_soil = TRUE). Default = TRUE.</p>
</dd>
<dt>grnd_flux_type</dt><dd><p>Integer. Options for handling ground flux: 0 = use
(flawed) formulas for ground flux, delta H, and fusion as in VIC 4.0.6 and
earlier. 1 = use formulas from VIC 4.1.0. This option exists for backwards
compatibility with earlier releases and likely will be removed in later
releases. Default = 1.</p>
</dd>
<dt>Tfallback</dt><dd><p>Boolean. Options for handling failures of T iterations to
converge. FALSE = if T iteration fails to converge, report an error. TRUE =
if T iteration fails to converge, use the previous time step's T value.
This option affects the temperatures of canopy air, canopy snow, ground
snow pack, ground surface, and soil T nodes. If TFALLBACK is TRUE, VIC will
report the total number of instances in which the previous step's T was
used, at the end of each grid cell's simulation. In addition, a time series
of when these instances occurred (averaged across all veg tile/snow band
combinations) can be written to the outputs, using the following output
variables: OUT_TFOL_FBFLAG = time series of T fallbacks in canopy snow T
solution. OUT_TCAN_FBFLAG = time series of T fallbacks in canopy air T
solution. OUT_SNOWT_FBFLAG = time series of T fallbacks in snow pack
surface T solution. OUT_SURFT_FBFLAG = time series of T fallbacks in ground
surface T solution. OUT_SOILT_FBFLAG = time series of T fallbacks in soil
node T solution (one time series per node). Default = TRUE.</p>
</dd>
<dt>share_layer_moist</dt><dd><p>Boolean. If TRUE, then??if??the soil moisture in
the layer that contains more than half of the roots is above the critical
point, then the plant's roots in the drier layers can access the moisture
of the wetter layer so that the plant does not experience moisture
limitation. If FALSE or all of the soil layer moistures are below the
critical point, transpiration in each layer is limited by the layer's soil
moisture. Default: TRUE.</p>
</dd>
<dt>spatial_frost</dt><dd><p>Integer. Option to allow spatial heterogeneity in soil
temperature. 0 = Assume soil temperature is horizontally constant (only
varies with depth). &gt; 0 = Assume soil temperatures at each given depth are
distributed horizontally with a uniform (linear) distribution and the value
would be the number of frost sub-areas (each having a distinct
temperature). In this case, even when the mean temperature is below
freezing, some portion of the soil within the grid cell at that depth could
potentially be above freezing. This requires specifying a frost slope value
as an extra field in the soil parametes, so that the minimum/maximum
temperatures can be computed from the mean value. The maximum and minimum
temperatures will be set to mean temperature +/- frost_slope. Default = 0.</p>
</dd>
<dt>snow_den</dt><dd><p>Boolean. Options for computing snow density. 0 = Use
algorithm taken from SNTHRM model.1 = Use traditional VIC algorithm taken
from Bras (1990). Default = 0.</p>
</dd>
<dt>blowing</dt><dd><p>Boolean. If TRUE, compute evaporative fluxes due to blowing
snow. Default = FALSE.</p>
</dd>
<dt>blowing_var_threshold</dt><dd><p>Boolean. If TRUE, a variable shear stress
threshold is used to determine the blowing snow flux. If FALSE, then a
fixed threshold is used. See Li and Pomeroy (1997) for details. Default:
TRUE.</p>
</dd>
<dt>blowing_calc_prob</dt><dd><p>Boolean. If TRUE, the probability of occurrence of
blowing snow is calculated as a function of environmental conditions. If
FALSE, then the probability is set to 1. See Lu and Pomeroy (1997) for
details. Default: TRUE.</p>
</dd>
<dt>blowing_simple</dt><dd><p>Boolean. If TRUE, the sublimation flux of blowing
snow is calculated as a function vapor pressure and wind speed. If FALSE,
then additional calculations are made to account for a saltation and
suspension layer. See Lu and Pomeroy (1997) for details. Default: FALSE.</p>
</dd>
<dt>blowing_fetch</dt><dd><p>Boolean. This option is only used when BLOWING_SIMPLE
is set to FALSE. When this option is set to TRUE, the fetch is accounted
for in the calculation of the sublimation flux from blowing snow. If FALSE
then the fetch is not used. See Lu and Pomeroy (1997) for details. Default:
TRUE.</p>
</dd>
<dt>blowing_spatial_wind</dt><dd><p>Boolean. If TRUE, multiple wind speed ranges,
calculated according to a probability distribution, are used to determine
the sublimation flux from blowing snow. If FALSE, then a single wind speed
is used. See Lu and Pomeroy (1997) for details. Default: TRUE.</p>
</dd>
<dt>compute_treeline</dt><dd><p>Integer. Options for handling above-treeline
vegetation. 0 = Do not compute treeline or replace vegetation above the
treeline. &gt; 0 means compute the treeline elevation based on average July
temperatures; for those elevation bands with elevations above the treeline
(or the entire grid cell if nbands = 1 when the grid cell elevation is
above the tree line), if they contain vegetation tiles having overstory,
replace that vegetation with the vegetation having id that same as the
value of this parameter in the vegetation library. You must supply VIC with
a July average air temperature in the optional July_Tavg field of the soil
parameters (parameter <code>soil</code> of <code><a href="#topic+vic">vic()</a></code>), and set the july_tavg option to
TRUE so that VIC can read the soil parameters correctly. If lakes=TRUE,
compute_treeline must be FALSE. Default = FALSE.</p>
</dd>
<dt>corrprec</dt><dd><p>Boolean. If TRUE correct precipitation for gauge
undercatch. This option is not supported when using snow/elevation bands.
Default = FALSE.</p>
</dd>
<dt>spatial_snow</dt><dd><p>Boolean. Option to allow spatial heterogeneity in snow
water equivalent (yielding partial snow coverage) when the snow pack is
melting. FALSE = Assume snow water equivalent is constant across grid cell.
TRUE = Assume snow water equivalent is distributed horizontally with a
uniform (linear) distribution, so that some portion of the grid cell has 0
snow pack. This requires specifying the max_snow_distrib_slope value as an
extra field in the soil parameters (parameter <code>soil</code> of <code><a href="#topic+vic">vic()</a></code>).
max_snow_distrib_slope should be set to twice the desired minimum spatial
average snow pack depth <code style="white-space: pre;">&#8288;[m]&#8288;</code>. I.e., if we define depth_thresh to be the
minimum spatial average snow depth below which coverage &lt; 1.0, then
max_snow_distrib_slope = 2*depth_thresh. Partial snow coverage is only
computed when the snow pack has started melting and the spatial average
snow pack depth &lt;= max_snow_distrib_slope/2. During the accumulation
season, coverage is 1.0. Even after the pack has started melting and depth
&lt;= max_snow_distrib_slope/2, new snowfall resets coverage to 1.0, and the
previous partial coverage is stored. Coverage remains at 1.0 until the new
snow has melted away, at which point the previous partial coverage is
recovered. Default = FALSE.</p>
</dd>
<dt>AERO_resist_cansnow</dt><dd><p>Integer. Options for aerodynamic resistance in
snow-filled canopy. 0??= Multiply by 10 for latent heat, but do NOT
multiply by 10 for sensible heat. When no snow in canopy, use surface
aero_resist instead of overstory aero_resist. (As in VIC 4.0.6). 1 =
Multiply by 10 for both latent and sensible heat. When no snow in canopy,
use surface aero_resist instead of overstory aero_resist. 2 = Multiply by
10 for both latent and sensible heat. Always use overstory aero_resist
(snow or bare). 3??= Apply stability correction, instead of multiplying by
10, for both latent and sensible heat. Always use overstory aero_resist
(snow or bare).?? NOTE: this option exists for backwards compatibility with
earlier releases and likely will be removed in later releases.??Default =
2.</p>
</dd>
<dt>carbon</dt><dd><p>Boolean. Options for simulating carbon cycle or not. FALSE??=
do not simulate carbon cycle. TRUE??= simulate carbon cycle.??Default =
FALSE.</p>
</dd>
<dt>RC_mode</dt><dd><p>Integer. Determines how canopy resistance is computed. 0??=
VIC computes canopy resistance by applying resistance factors to the veg
class's minimum canopy resistance listed in the veg library. 1??= VIC
computes canopy resistance by applying resistance factors to the canopy
resistance corresponding to photosynthetic demand (in the absence of
moisture limitation).?? Default = 0.</p>
</dd>
<dt>veglib_photo</dt><dd><p>Boolean. Tells VIC about the contents of the veg
library. Options for VEGLIB_PHOTO: FALSE??= veg library does not contain
photosynthesis parameters. TRUE = veg library contains photosynthesis
parameters. Default = FALSE</p>
</dd>
<dt>continue_error</dt><dd><p>Boolean. Options for handling fatal errors. FALSE??=
if simulation of a grid cell encounters an error, exit VIC. TRUE??= if
simulation of a grid cell encounters an error, move to next grid
cell.??Default = TRUE.</p>
</dd>
<dt>wind_h</dt><dd><p>Numeric. Height <code style="white-space: pre;">&#8288;[m]&#8288;</code> of wind speed measurement over bare soil
and snow cover. Wind measurement height over vegetation is now read from
the vegetation library for all types, the value in the global options only
controls the wind height over bare soil and over the snow pack when a
vegetation canopy is not defined.</p>
</dd>
<dt>canopy_layers</dt><dd><p>Integer. Number of canopy layers in the model.
Default: 3.</p>
</dd>
<dt>baseflow</dt><dd><p>Integer. This option describes the form of the baseflow
parameters in the soil parameters (parameter <code>soil</code> of <code><a href="#topic+vic">vic()</a></code>): 0 = fields
5-8 of the soil parameters are the standard VIC baseflow parameters; 1 =
fields 5-8 of the soil parameters are the baseflow parameters from Nijssen
et al (2001) Default = 0.</p>
</dd>
<dt>july_tavg</dt><dd><p>Boolean. If TRUE then VIC will expect an additional column
(July_Tavg) in the soil parameters (parameter <code>soil</code> of <code><a href="#topic+vic">vic()</a></code>) to contain
the gridcell's average July temperature. If your soil parameters contains
this optional column, you MUST set this parameter to TRUE so that VIC can
read the soil parameters correctly. NOTE: Supplying July average
temperature is only required if the compute_treeline option is set to TRUE.
Default = FALSE.</p>
</dd>
<dt>organic</dt><dd><p>Boolean. TRUE = the soil parameters (parameter <code>soil</code> of
<code><a href="#topic+vic">vic()</a></code>) contains 3*Nlayer extra columns. For each layer: the organic
fraction, and the bulk density and soil particle density of the organic
matter in the soil layer. FALSE = the soil parameters do not contain any
information about organic soil, and organic fraction should be assumed to
be 0. Default = FALSE.</p>
</dd>
<dt>nrootzones</dt><dd><p>Integer. Number of defined root zones defined for root
distribution.</p>
</dd>
<dt>vegpar_albedo</dt><dd><p>Boolean. If TRUE the vegetation parameters (parameter
<code>veg</code> of <code><a href="#topic+vic">vic()</a></code>) contains the columns for each vegetation type that
defines monthly albedo values for each vegetation type for each grid cell.
Default = FALSE.</p>
</dd>
<dt>albedo_src</dt><dd><p>Integer. This option tells VIC where to look for ALBEDO
values: 1 = Use the ALBEDO values listed in the vegetation library. 2 = Use
the ALBEDO values listed in the vegetation parameters (parameter <code>veg</code> of
<code><a href="#topic+vic">vic()</a></code>). Note: for this to work, vegpar_albedo must be TRUE. 3= Use the
albedo values in the parameter <code>forcing_veg</code> of <code><a href="#topic+vic">vic()</a></code>. For this to work,
albedo must be supplied in codeforcing_veg. Default = 1.</p>
</dd>
<dt>vegpar_LAI</dt><dd><p>Boolean. If TRUE the vegetation parameters (parameter
<code>veg</code> of <code><a href="#topic+vic">vic()</a></code>) contains an extra line for each vegetation type that
defines monthly LAI values for each vegetation type for each gridcell.
Default = FALSE.</p>
</dd>
<dt>LAI_src</dt><dd><p>Boolean. This option tells VIC where to look for LAI values:
1 = Use the LAI values listed in the vegetation library. 2 = Use the LAI
values listed in the vegetation parameters (parameter <code>veg</code> of <code><a href="#topic+vic">vic()</a></code>).
Note: for this to work, vegpar_LAI must be TRUE. 3= Use the LAI values in
the parameter <code>forcing_veg</code> of <code><a href="#topic+vic">vic()</a></code>. For this to work, albedo must be
supplied in codeforcing_veg. Default = 1.</p>
</dd>
<dt>veglib_fcan</dt><dd><p>Boolean. If TRUE the vegetation library contains monthly
FCANOPY values for each vegetation type for each grid cell (between the LAI
and ALBEDO values). Default = FALSE.</p>
</dd>
<dt>vegpar_fcan</dt><dd><p>Boolean. If TRUE the vegetation parameters (parameter
<code>veg</code> of <code><a href="#topic+vic">vic()</a></code>) contains an extra line for each vegetation type that
defines monthly FCANOPY values for each vegetation type for each grid cell.
Default = FALSE.</p>
</dd>
<dt>fcan_src</dt><dd><p>Boolean. This option tells VIC where to look for FCANOPY
values: 0 = Set FCANOPY to 1.0 for all veg classes, all times, and all
locations. 1 = Use the FCANOPY values listed in the vegetation library.
Note: for this to work, veglib_fcan must be TRUE. 2 = Use the FCANOPY
values listed in the vegetation parameters (parameter <code>veg</code> of <code><a href="#topic+vic">vic()</a></code>).
Note: for this to work, vegpar_fcan must be TRUE. 3= Use the FCANOPY values
in the parameter <code>forcing_veg</code> of <code><a href="#topic+vic">vic()</a></code>. For this to work, FCANOPY must
be supplied in codeforcing_veg Default = 0.</p>
</dd>
<dt>nbands</dt><dd><p>Integer. Maximum number of snow elevation bands to use.
Parameter snowband should be provided for the <code><a href="#topic+vic">vic()</a></code> function when &gt; 1.
Default = 1.</p>
</dd>
<dt>lakes</dt><dd><p>Boolean. Options for if simulate lakes lake parameter or not.
Default = FALSE.</p>
</dd>
<dt>lake_profile</dt><dd><p>Boolean. Options for describing lake profile: FALSE??=
VIC computes a parabolic depth-area profile for the lake basin. TRUE??= VIC
reads user-specified depth-area profile from the lake parameters. Default =
FALSE.</p>
</dd>
<dt>resolution</dt><dd><p>Numeric. Width of grid cells, in decimal degree latitude
or longitude. Default = none, but must be set by the user to match the grid
cell size if the lake model is running.</p>
</dd>
</dl>



<h3>Value</h3>

<p>No return value. Set global options for VIC model.
</p>


<h3>References</h3>

<p>Bras, R. F., 1990: Hydrology, an introduction to hydrologic science,
Addison-Wesley.
</p>
<p>Cherkauer, K. A. and D. P. Lettenmaier, 1999: Hydrologic effects of frozen
soils in the upper Mississippi River basin, J. Geophys. Res., 104(D16),
19,599-19,610.
</p>
<p>Liang, X., E. F. Wood, and D. P. Lettenmaier, 1999: Modeling ground heat flux
in land surface parameterization schemes, J. Geophys. Res., 104(D8),
9581-9600.
</p>
<p>Nijssen, B.N., R. Schnur and D.P. Lettenmaier, 2001: Global retrospective
estimation of soil moisture using the Variable Infiltration Capacity land
surface model, 1980-1993, J. Clim., 14(8), 1790-1808,
doi:10.1175/1520-0442(2001)014&lt;1790:GREOSM&gt;2.0.CO;2.
</p>

<hr>
<h2 id='vic_version'>Display version of VIC model and this package.</h2><span id='topic+vic_version'></span>

<h3>Description</h3>

<p>Display version of VIC model and this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vic_version()
</code></pre>

<hr>
<h2 id='VIC5'>VIC5: The Variable Infiltration Capacity (VIC) Model version 5 in R</h2><span id='topic+VIC5'></span><span id='topic+VIC5-package'></span>

<h3>Description</h3>

<p>The Variable Infiltration Capacity (VIC) model is a macroscale hydrologic model that solves full water and energy balances, originally developed by Xu Liang at the University of Washington (UW). The version of VIC source code used is of 5.0.1 on <a href="https://github.com/UW-Hydro/VIC/">https://github.com/UW-Hydro/VIC/</a>, see Hamman et al. (2018). Development and maintenance of the current official version of the VIC model at present is led by the UW Hydro (Computational Hydrology group) in the Department of Civil and Environmental Engineering at UW. VIC is a research model and in its various forms it has been applied to most of the major river basins around the world, as well as globally <a href="http://vic.readthedocs.io/en/master/Documentation/References/">http://vic.readthedocs.io/en/master/Documentation/References/</a>. References: &quot;Liang, X., D. P. Lettenmaier, E. F. Wood, and S. J. Burges (1994), A simple hydrologically based model of land surface water and energy fluxes for general circulation models, J. Geophys. Res., 99(D7), 14415-14428, <a href="https://doi.org/10.1029/94JD00483">doi:10.1029/94JD00483</a>&quot;; &quot;Hamman, J. J., Nijssen, B., Bohn, T. J., Gergel, D. R., and Mao, Y. (2018), The Variable Infiltration Capacity model version 5 (VIC-5): infrastructure improvements for new applications and reproducibility, Geosci. Model Dev., 11, 3481-3496, <a href="https://doi.org/10.5194/gmd-11-3481-2018">doi:10.5194/gmd-11-3481-2018</a>&quot;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Dongdong Kong <a href="mailto:kongdd.sysu@gmail.com">kongdd.sysu@gmail.com</a> (<a href="https://orcid.org/0000-0003-1836-8172">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Ruida Zhong <a href="mailto:zrd2017@163.com">zrd2017@163.com</a> [contributor]
</p>
</li>
<li><p> Xiaohong Chen <a href="mailto:eescxh@mail.sysu.edu.cn">eescxh@mail.sysu.edu.cn</a> [contributor]
</p>
</li>
<li><p> Zhaoli Wang <a href="mailto:wangzhl@scut.edu.cn">wangzhl@scut.edu.cn</a> [contributor]
</p>
</li>
<li><p> Chengguang Lai <a href="mailto:laichg@scut.edu.cn">laichg@scut.edu.cn</a> [contributor]
</p>
</li></ul>

<p>Other contributors:
</p>

<ul>
<li><p> Joseph J Hamman (Contributor and maintainer of VIC source code) [contributor]
</p>
</li>
<li><p> Keith Cherkauer [contributor]
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/rpkgs/VIC5">https://github.com/rpkgs/VIC5</a>
</p>
</li></ul>


<hr>
<h2 id='XAJ'>Run Xinanjiang (XAJ) model (three sources, lumped).</h2><span id='topic+XAJ'></span>

<h3>Description</h3>

<p>An R implementation of three-source Xinanjiang model
by Renjun Zhao, used for daily streamflow simulation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XAJ(PREC, EVAP, params, area = dt * 3.6, dt = 24, full.UH = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="XAJ_+3A_prec">PREC</code></td>
<td>
<p>Time series of precipitation (daily)</p>
</td></tr>
<tr><td><code id="XAJ_+3A_evap">EVAP</code></td>
<td>
<p>Time series of pan evaporation or potential evapotranspiration
(daily), length must equal to <code>PREC</code></p>
</td></tr>
<tr><td><code id="XAJ_+3A_params">params</code></td>
<td>
<p>parameters <code><a href="#topic+XAJ.param.range">XAJ.param.range()</a></code></p>
</td></tr>
<tr><td><code id="XAJ_+3A_area">area</code></td>
<td>
<p>Basin area (km^2).</p>
</td></tr>
<tr><td><code id="XAJ_+3A_dt">dt</code></td>
<td>
<p>time step (in hour) of the simulation</p>
</td></tr>
<tr><td><code id="XAJ_+3A_full.uh">full.UH</code></td>
<td>
<p>Use the unit hydrograph defined by user, rather than the
instantaneous unit hydrograph (IUH) of Nash, for routing
of surface runoff. Default FALSE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This function returns a data frame of some common variables of the XAJ
model at each time step, such as evaporation, soil moisture, surface and
underground runoff.
</p>


<h4>The variables of the table including:</h4>


<ul>
<li> <p><code>E</code>  : Total evaporation (mm)
</p>
</li>
<li> <p><code>EU</code> : Evaporation (mm) of upper soil layer
</p>
</li>
<li> <p><code>EL</code> : Evaporation (mm) of lower soil layer
</p>
</li>
<li> <p><code>ED</code> : Evaporation (mm) of deep soil layer
</p>
</li>
<li> <p><code>W</code>  : Total soil moisture (mm)
</p>
</li>
<li> <p><code>WU</code> : Soil moisture (mm) of upper soil layer
</p>
</li>
<li> <p><code>WL</code> : Soil moisture (mm) of lower soil layer
</p>
</li>
<li> <p><code>WD</code> : Soil moisture (mm) of deep soil layer
</p>
</li>
<li> <p><code>R</code>  : Total runoff (mm) of each time step
</p>
</li>
<li> <p><code>RS</code> : Surface runoff (mm) of each time step
</p>
</li>
<li> <p><code>RI</code> : Interflow (mm) of each time step
</p>
</li>
<li> <p><code>RG</code> : Underground runoff (mm) of each time step
</p>
</li>
<li> <p><code>Q</code>  : Total runoff (m^3/s) at the outlet of the basin
</p>
</li>
<li> <p><code>QS</code> : Surface runoff (m^3/s) at the outlet of the basin
</p>
</li>
<li> <p><code>QI</code> : Interflow runoff (m^3/s) at the outlet of the basin
</p>
</li>
<li> <p><code>QG</code> : Underground runoff (m^3/s) at the outlet of the basin
</p>
</li></ul>




<h3>References</h3>

<p>Zhao and Liu, 1995. The Xinanjiang model, Computer Models of Watershed Hydrology,
Water Resources Publication, Highlands Ranch, CO (1995), pp. 215-232
</p>

<hr>
<h2 id='XAJ.param.range'>XAJ parameters</h2><span id='topic+XAJ.param.range'></span>

<h3>Description</h3>

<p>The lumped XAJ model has 13 parameters, including:
</p>

<ul>
<li><p> If <code>full.UH = FALSE</code>:
</p>
</li></ul>

<p>The parameter <code>params</code> must be a numeric vector looks like:
<code>c(KC, IM, WUM, WLM, WDM, C, B, SM, EX, KI, KG, CI, CG, N, NK)</code>
</p>

<ul>
<li><p> If <code>full.UH = TRUE</code>:
</p>
</li></ul>

<p>when use the instantaneous unit hydrograph of Nash, or looks like:
<code>c(KC, IM, WUM, WLM, WDM, C, B, SM, EX, KI, KG, CI, CG, UH_1, UH_2, ..., UH_n)</code>
UH_1, UH_2, ..., UH_n means the series of the unit hydrograph.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>XAJ.param.range
</code></pre>


<h3>Format</h3>

<p>An object of class <code>data.frame</code> with 15 rows and 4 columns.
</p>


<h3>Details</h3>



<h4>Parameters:</h4>


<ol>
<li> <p><code>KC</code>  : Ratio of potential evap to pan evap
</p>
</li>
<li> <p><code>IM</code>  : Fraction of impermeable area
</p>
</li>
<li> <p><code>WUM</code> : Soil moisture capacity of upper layer
</p>
</li>
<li> <p><code>WLM</code> : Soil moisture capacity of lower layer
</p>
</li>
<li> <p><code>WDM</code> : Soil moisture capacity of deep layer
</p>
</li>
<li> <p><code>C</code>   : Coefficient of deep evap
</p>
</li>
<li> <p><code>B</code>   : Exponent of the soil moisture storage capacity curve
</p>
</li>
<li> <p><code>SM</code>  : Areal mean free water capacity of the surface soil layer
</p>
</li>
<li> <p><code>EX</code>  : Exponent of the free water capacity curve
</p>
</li>
<li> <p><code>KI</code>  : outflow coefficients of the free water storage to interflow
</p>
</li>
<li> <p><code>KG</code>  : outflow coefficients of the free water storage to groundwater
</p>
</li>
<li> <p><code>CI</code>  : recession constant of the lower interflow storage
</p>
</li>
<li> <p><code>CG</code>  : recession constant of groundwater storage.
</p>
</li>
<li> <p><code>N</code>: (optional) number of reservoirs in the instantaneous unit hydrograph <br />
</p>
</li>
<li> <p><code>NK</code>: (optional) common storage coefficient in the instantaneous unit hydrograph <br />
</p>
</li></ol>

<p><strong>If <code>full.UH = TRUE</code>: 14~end: is the full unit hydrograph defined by user.</strong>
</p>


</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
