<!DOCTYPE html><html><head><title>Help for package FITSio</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {FITSio}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#FITSio-package'><p>FITS file input-output functions</p></a></li>
<li><a href='#axVec'><p>Generate axis vector for image</p></a></li>
<li><a href='#closeHdr'>
<p>Format and close FITS header</p></a></li>
<li><a href='#makeFITSimHdr'>
<p>Generate header for FITS image</p></a></li>
<li><a href='#modifyHeader'>
<p>Modify and edit comments and <code>keyword-value</code> pairs in FITS header</p></a></li>
<li><a href='#parseHdr'>
<p>Parse FITS header</p></a></li>
<li><a href='#readFITS'><p>Read a single data set from a FITS file</p></a></li>
<li><a href='#readFITSarray'><p>Read an image (multi-dimensional array) from a FITS file</p></a></li>
<li><a href='#readFITSbintable'><p>Read a FITS binary table</p></a></li>
<li><a href='#readFITSheader'><p>Read a FITS header</p></a></li>
<li><a href='#readFITStable'><p>Read a FITS ASCII table</p></a></li>
<li><a href='#readFrameFromFITS'><p>Read a single data set from a FITS file into a data frame</p></a></li>
<li><a href='#writeFITSim'><p>Write a FITS image (multi-dimensional numeric array) to disk</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>FITS (Flexible Image Transport System) Utilities</td>
</tr>
<tr>
<td>Version:</td>
<td>2.1-6</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-04-03</td>
</tr>
<tr>
<td>Author:</td>
<td>Andrew Harris</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew Harris &lt;harris@astro.umd.edu&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Description:</td>
<td>Utilities to read and write files in the FITS (Flexible
  Image Transport System) format, a standard format in astronomy (see
  e.g. <a href="https://en.wikipedia.org/wiki/FITS">https://en.wikipedia.org/wiki/FITS</a> for more information).
  Present low-level routines allow: reading, parsing, and modifying
  FITS headers; reading FITS images (multi-dimensional arrays);
  reading FITS binary and ASCII tables; and writing FITS images
  (multi-dimensional arrays).  Higher-level functions allow: reading
  files composed of one or more headers and a single (perhaps
  multidimensional) image or single table; reading tables into
  data frames; generating vectors for image array axes; scaling and
  writing images as 16-bit integers.  Known incompletenesses are
  reading random group extensions, as well as
  complex and array descriptor data types in binary tables.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-04-03 18:28:20 UTC; Andy</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-04-03 19:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='FITSio-package'>FITS file input-output functions
</h2><span id='topic+FITSio-package'></span><span id='topic+FITSio'></span>

<h3>Description</h3>

<p>FITS, the Flexible
Image Transport System, is
a standard data format for astronomy.
This package contains
functions to read files with FITS file image and binary and ASCII table formats
and to write FITS image files.  The functions comply with the standards
defined by the International Astronomical Union's FITS Working Group.
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> FITSio</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 2.1-6</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2021-03-28</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL (&gt;= 2)</td>
</tr>
<tr>
 <td style="text-align: left;">
LazyLoad: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>At the high level, this package contains functions to read
single FITS Header and Data Units (HDUs) containing image and binary
table extensions, and one to write FITS image
files.  <code>readFITS</code> automatically
recognizes
image (multi-dimensional arrays) and binary table extensions, returning a
list with data, header, and scaling information.
<code>readFrameFromFITS</code> returns an <span class="rlang"><b>R</b></span> data frame from a single binary
table HDU.  Both functions accept an argument to pick out the
<em>n</em>th HDU in a larger file.
Binary table complex, and array
descriptor data types are not implemented in this release due to a lack
of examples for testing.  8, 16, 24, and 32-bit bit arrays return as integers.  Other lengths
are not supported.
</p>
<p>For writing, the package contains the high-level function
<code>writeFITSim</code> to write FITS
images, along with a minor extension to efficiently write
data in 16-bit integers, <code>writeFITSim16i</code>.
</p>
<p>A set of mid-level functions enables reading files with
combinations of HDUs: <code>readFITSheader</code> reads headers,
<code>readFITSarray</code> reads image extensions, and
<code>readFITSbintable</code> reads binary table extensions.
<code>readFITStable</code> reads ASCII table extensions.
<code>readFITS</code> and <code>readFrameFromFITS</code> invoke these functions to
do the actual reading.
</p>
<p>Function <code>axVec</code> generates a vector for image axis labeling from
data in an image FITS file.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris &lt;harris@astro.umd.edu&gt;, with contributions from
Eric H. Neilsen, Jr. and Bi Cheng Wu
</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)
## Make test image with axis information, write to disk
Z &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(Z, file = filename, c1 = "Test FITS file",
            crpix = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c("Distance", "Time"),
            cunitn = c("Furlongs", "Fortnights"))

## Read image back and display
X &lt;-  readFITS(filename)
ax1 &lt;- axVec(1, X$axDat)          # Make axis vector for image
ax2 &lt;- axVec(2, X$axDat)
xlab &lt;- X$axDat$ctype[1]
ylab &lt;- paste(X$axDat$ctype[2], " [", X$axDat$cunit[2], "]", sep = "")
image(ax1, ax2, X$imDat, xlab = xlab, ylab = ylab)
str(X)
X$axDat                           # Display data frame with axis data
X$hdr[1:10]                       # Header sample
X$hdr[which(X$hdr=="BITPIX")+1]   # BITPIX value from header

### Read back in, modify data, header, and axis data information,
## then write modified version as new file
Z &lt;-  readFITS(filename)
  Z$imDat &lt;- Z$imDat + 300
  Z$header &lt;- addKwv('SCALE', 1.03, 'test header mod', header=Z$header)
  # Z$axDat &lt;- edit(Z$axDat)  # interactive edit
  Z$axDat$cdelt[2] &lt;- 20
filename2 &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(Z$imDat, file=filename2, axDat=Z$axDat, header=Z$header)

## Clean up files to avoid clutter
unlink(filename)
unlink(filename2)
</code></pre>

<hr>
<h2 id='axVec'>Generate axis vector for image</h2><span id='topic+axVec'></span>

<h3>Description</h3>

<p><code>axVec</code> generates a vector of axis values from variables
contained in a FITS image file header.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>axVec(nax = 1, axDat)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="axVec_+3A_nax">nax</code></td>
<td>
<p>index number of the axis.</p>
</td></tr>
<tr><td><code id="axVec_+3A_axdat">axDat</code></td>
<td>
<p>data table axis variables produced by
<code>readFITSarray</code> (which is also contained in <code>readFITS</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Run once for each axis needed.
</p>


<h3>Value</h3>

<p>A vector with length equal to the number of pixels along the axis.
Vector values <code class="reqn">v[i]</code> for <code class="reqn">i = 1:NAXISn</code> (<code class="reqn">NAXISn = len</code>,
the vector length, in
the axDat data frame) are:
</p>
<p style="text-align: center;"><code class="reqn"> v[i] = (i - CRPIXn) CDELTn + CRVALn</code>
</p>

<p>where <code class="reqn">CRPIXn</code>, <code class="reqn">CDELTn</code>, and <code class="reqn">CVALn</code> are the reference
pixel, pixel increment, and reference pixel value for each axis
<code class="reqn">n</code>, following the FITS standard.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSarray">readFITSarray</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)
Z &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(Z, file = filename, c1 = 'Test FITS file',
            crpix = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c('Distance', 'Time'),
            cunitn = c('Furlongs', 'Fortnights'))
X &lt;-  readFITS(filename)
ax1 &lt;- axVec(1, X$axDat)
ax2 &lt;- axVec(2, X$axDat)
xlab &lt;- X$axDat$ctype[1]
ylab &lt;- paste(X$axDat$ctype[2], " [", X$axDat$cunit[2], "]", sep = "")
image(ax1, ax2, X$imDat, xlab = xlab, ylab = ylab)

## Clean up files to avoid clutter
unlink(filename)
</code></pre>

<hr>
<h2 id='closeHdr'>
Format and close FITS header
</h2><span id='topic+closeHdr'></span>

<h3>Description</h3>

<p>Function adds END statement and closes FITS header
</p>


<h3>Usage</h3>

<pre><code class='language-R'>closeHdr(headerName)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="closeHdr_+3A_headername">headerName</code></td>
<td>

<p>Header card images (vector)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Adds <code>END</code> to header and pads with spaces to length defined in FITS
standard.
</p>


<h3>Value</h3>

<p>Character vector to write to FITS file as header.
</p>


<h3>Author(s)</h3>

<p>A. Harris
</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+modifyHeader">modifyHeader</a></code>, <code><a href="#topic+makeFITSimHdr">makeFITSimHdr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(1:15, ncol = 3)
# extra header lines (optional)
header &lt;- newKwv('KEYWORD', 'VALUE', 'NOTE') # initialize header
header &lt;- addComment('Add these lines to auto-generated header', header=header)
header &lt;- delKwv('KEYWORD', header=header)  # kill first line
header &lt;- addKwv('test1', 'plot size', header=header)
header &lt;- addKwv('test2', 4294.95397809807, 'number', header=header)
header &lt;- addKwv('test3', 4.29495397809807e50, 'big number', header=header)
# make main header
header &lt;- makeFITSimHdr(X, crpixn = c(1,1), crvaln = c(10, 100),
                        cdeltn = c(8, 2), ctypen = c("Distance", "Time"),
                        cunitn = c("Furlongs", "Fortnights"),
                        header = header)
# finish and close out header
tmp &lt;- closeHdr(header) 
</code></pre>

<hr>
<h2 id='makeFITSimHdr'>
Generate header for FITS image
</h2><span id='topic+makeFITSimHdr'></span>

<h3>Description</h3>

<p>Function generates the header for a FITS image.  It determines much of
the header information from the file itself and can merge header
information with error checking and removal of conflicting reserved keywords.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>makeFITSimHdr(X, primaryhdu = TRUE, type = "double", c1 = NA, c2 = NA,
bscale = 1, bzero = 0, crpixn = NA, crvaln = NA, cdeltn = NA, ctypen =
NA, cunitn = NA, axDat = NA, header = "")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="makeFITSimHdr_+3A_x">X</code></td>
<td>
<p>Multi-dimensional numeric data array; see Details.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_primaryhdu">primaryhdu</code></td>
<td>
<p>Logical: TRUE for stand-alone file, FALSE if
subordinate header.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_type">type</code></td>
<td>
<p>Type to write: single or double precision.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_c1">c1</code></td>
<td>
<p>Character string comment line for header.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_c2">c2</code></td>
<td>
<p>Character string comment line for header.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_bscale">bscale</code></td>
<td>
<p>Global scaling factor, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_bzero">bzero</code></td>
<td>
<p>Global shift, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_crpixn">crpixn</code></td>
<td>
<p>Vector of reference pixel numbers for axes, FITS
standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_crvaln">crvaln</code></td>
<td>
<p>Vector of values at reference pixels, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_cdeltn">cdeltn</code></td>
<td>
<p>Vector of axis increments per pixel, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_ctypen">ctypen</code></td>
<td>
<p>String vector of descriptive labels for axis, FITS
standard meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_cunitn">cunitn</code></td>
<td>
<p>String vector of physical units for axis, FITS standard
meaning.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_axdat">axDat</code></td>
<td>
<p>Data frame with axis data, see details.</p>
</td></tr>
<tr><td><code id="makeFITSimHdr_+3A_header">header</code></td>
<td>
<p>Optional header of 80-character card images.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>String with format and length matching FITS header standard for an image.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris
</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+writeFITSim">writeFITSim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X &lt;- matrix(1:15, ncol = 3)
# extra header lines (optional)
header &lt;- newKwv('KEYWORD', 'VALUE', 'NOTE') # initialize header
header &lt;- addComment('Add these lines to auto-generated header', header=header)
header &lt;- delKwv('KEYWORD', header=header)  # kill first line
header &lt;- addKwv('test1', 'plot size', header=header)
header &lt;- addKwv('test2', 4294.95397809807, 'number', header=header)
header &lt;- addKwv('test3', 4.29495397809807e50, 'big number', header=header)
# make main header
header &lt;- makeFITSimHdr(X, crpixn = c(1,1), crvaln = c(10, 100),
                        cdeltn = c(8, 2), ctypen = c("Distance", "Time"),
                        cunitn = c("Furlongs", "Fortnights"),
                        header = header)
# finish and close out header
tmp &lt;- closeHdr(header) 
</code></pre>

<hr>
<h2 id='modifyHeader'>
Modify and edit comments and <code>keyword-value</code> pairs in FITS header
</h2><span id='topic+modifyHeader'></span><span id='topic+newKwv'></span><span id='topic+addKwv'></span><span id='topic+delKwv'></span><span id='topic+modVal'></span><span id='topic+addComment'></span><span id='topic+addHistory'></span>

<h3>Description</h3>

<p>Functions to modify and edit <code>keyword = value</code> pairs in FITS header:
<code>newKwv</code> creates <code>keyword = value / comment</code> line for
header;
<code>addKwv</code> adds <code>keyword = value / comment</code> to header;
<code>delKwv</code> deletes <code>keyword = value / comment</code> from header;
<code>modVal</code> modifies value in <code>keyword = value / comment</code> in
header;
<code>addComment</code> adds COMMENT line to header;
<code>addHistory</code> adds HISTORY line to header.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newKwv(keyw, val, note)

addKwv(keyw, val, note, headerName)

delKwv(keyw, headerName)

modVal(keyw, val, note, headerName)

addComment(comment, headerName)

addHistory(history, headerName)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="modifyHeader_+3A_keyw">keyw</code></td>
<td>

<p>Keyword, 8 character limit (FITS specification)
</p>
</td></tr>
<tr><td><code id="modifyHeader_+3A_val">val</code></td>
<td>

<p>Value for keyword
</p>
</td></tr>
<tr><td><code id="modifyHeader_+3A_note">note</code></td>
<td>

<p>Optional descriptive note following <code>keyword = value</code>
</p>
</td></tr>
<tr><td><code id="modifyHeader_+3A_comment">comment</code></td>
<td>

<p>Comment text string
</p>
</td></tr>
<tr><td><code id="modifyHeader_+3A_history">history</code></td>
<td>

<p>History text string
</p>
</td></tr>
<tr><td><code id="modifyHeader_+3A_headername">headerName</code></td>
<td>

<p>Header card images (vector)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>All keywords will be converted to upper case (FITS convention) and
truncated to 8 characters.  There is no checking for duplicate keywords.
The default numerical format for values is 20.14g; if other formats are
needed, format separately and write the text string as the value (see
examples).  Similar work-arounds may be necessary for long note
strings (see examples).
</p>


<h3>Value</h3>

<p>New card image for <code>newKwv</code>, otherwise modified header card images.
</p>


<h3>Note</h3>

<p>It is also possible to operate directly on the vector of header card
images.  These functions are simply for convenience in maintaining the
correct header formatting.  No <code>END</code> card is needed in the header card
images; that is added by <code><a href="#topic+closeHdr">closeHdr</a></code>, which must be run to
complete the header formatting.
</p>


<h3>Author(s)</h3>

<p>A. Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSheader">readFITSheader</a></code>, <code><a href="#topic+closeHdr">closeHdr</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Make header from scratch, then add, modify, delete card images.
header &lt;- newKwv('KEYWORD', 'VALUE', 'NOTE')
header &lt;- addKwv('test1', 'plot size', header=header)
header &lt;- addKwv('test2', 4294.95397809807, 'number', header=header)
header &lt;- addKwv('test3', 4.29495397809807e50, 'big number', header=header)
header &lt;- addKwv('test4', -4.29495397809807e50, 'big number', header=header)
header &lt;- addKwv('test5', 'this is a very long value', 'number', header=header)
header &lt;- addKwv('test6',
   'this is a very very very very very very very very long value',
   'note', header=header)
header &lt;- addKwv('test7', 'value',
   'very very very very very very very very very very long comment',
   header=header)
header &lt;- addKwv('test8', '0123456789112345678921234567893123456',
   'format long number as string', header=header)
header &lt;- addKwv('apostrophe', 'o\'\'malley',
   'apostrophes are doubled in value strings', header=header)
for (i in 1:4) {
   header &lt;- addKwv(paste('test', 100+i, sep=''), 100+i, header=header)
}
header &lt;- delKwv('test103', header=header)
header &lt;- addComment('TEST103 should be missing from header', header=header)
header &lt;- addHistory('This header generated by modifyHeader example',
   header=header)

# show header
header

</code></pre>

<hr>
<h2 id='parseHdr'>
Parse FITS header
</h2><span id='topic+parseHdr'></span>

<h3>Description</h3>

<p>Parse FITS header to extract <code>keyword = variable</code> pairs.  Mostly
useful for finding values given keyword name.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parseHdr(headerName)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parseHdr_+3A_headername">headerName</code></td>
<td>

<p>Header card images (vector)
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses strict FITS convention to identify  <code>keyword = variable</code>
pairs: a string '= ' in card image columns 9 and 10.
</p>


<h3>Value</h3>

<p>Vector with elements <code>keyword, variable</code> for all pairs.
</p>


<h3>Note</h3>

<p>Function eliminates leading and trailing spaces.
</p>


<h3>Author(s)</h3>

<p>A. Harris
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITSheader">readFITSheader</a></code>, <code><a href="#topic+modifyHeader">modifyHeader</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>header &lt;- newKwv('KEYWORD', 'VALUE', 'NOTE')
header &lt;- addKwv('test1', 'plot size', header=header)
header &lt;- addKwv('test2', 4294.95397809807, 'number', header=header)
header &lt;- addKwv('test3', 4.29495397809807e50, 'big number', header=header)
header &lt;- addKwv('test4', -4.29495397809807e50, 'big number', header=header)
parseHdr(header)
</code></pre>

<hr>
<h2 id='readFITS'>Read a single data set from a FITS file</h2><span id='topic+readFITS'></span>

<h3>Description</h3>

<p>Read a single image (multi-dimensional array) or binary table
from a FITS file.  The source code <code>readFITS.r</code> is a model for
creating code to read more complex FITS files.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFITS(file = "R.fits", hdu = 1, maxLines = 5000,
fixHdr = c('none', 'remove', 'substitute'), phdu = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFITS_+3A_file">file</code></td>
<td>
<p>Existing FITS file name, or remote file; see examples.</p>
</td></tr>
<tr><td><code id="readFITS_+3A_hdu">hdu</code></td>
<td>
<p>Position of Header and Data Unit (HDU) in FITS file: 1 for
the first HDU, 2 for the second HDU, etc.</p>
</td></tr>
<tr><td><code id="readFITS_+3A_maxlines">maxLines</code></td>
<td>
<p>Integer: maximum number of header lines to read.</p>
</td></tr>
<tr><td><code id="readFITS_+3A_fixhdr">fixHdr</code></td>
<td>
<p>Deal with (illegal) nonprinting characters in the
header.</p>
</td></tr>
<tr><td><code id="readFITS_+3A_phdu">phdu</code></td>
<td>
<p>Rarely needed; see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFITS</code> is a simple but complete FITS file reader,
automatically detecting image and binary table data extensions
(random groups are
not supported in this
release).  It reads a single Header and Data Unit
(HDU) pair from a file and returns a list with data, header, and axis
information.   Files with more complicated structures or
isolated header units can be read with an appropriate combination of
<code>readFITSheader</code>, <code>readFITSarray</code>, and
<code>readFITSbintable</code>.  See the Example section for
<code>readFITSimage</code> for a step-by-step
example that includes file opening and closing.
</p>
<p><var>phdu</var> = 0 forces a read of a secondary HDU in a
fairly pathological case (specifically: indicating
a read of a secondary HDU by setting NAXISn = 0 for n &gt; 1, but NAXIS != 0
and NAXIS1 != 0.)  This does not seem to be forbidden by the FITS
standard but would be unlikely coding.
</p>
<p><var>...</var> passes additional values for file reading.  The only use at
present is to pass values to <var>fixHdr</var> in <code><a href="#topic+readFITSheader">readFITSheader</a></code>.
<var>fixHdr</var> attempts to fix headers with non-printing characters,
either by removing them with <code>fixHdr = 'remove'</code>, reading further
into the file until 2880 valid characters are present, or by
substituting spaces for non-printing characters with <code>fixHdr =
  'substitute'</code>.  This option should be used with caution, as non-printing
characters should not be in the header in the first place, so this
option may or may not corrupt the following data.  The default is
<code>fixHdr = 'none'</code>.  Partial matching is allowed.
</p>
<p>Binary table complex, and array
descriptor data types are not implemented in this release due to a lack
of examples for testing. 8, 16, 24, and 32-bit bit arrays return as integers.  Other lengths
are not supported.
</p>


<h3>Value</h3>

<p>Return values from <code>readFITS</code> are in a list. Depending on the
data type, list entries are:
</p>
<table>
<tr><td><code>header</code></td>
<td>
<p>Vector with input file header up to END statement.</p>
</td></tr>
<tr><td><code>hdr</code></td>
<td>
<p>Vector with <code>keyword = value</code> pairs parsed from header.</p>
</td></tr>
<tr><td><code>imDat</code></td>
<td>
<p>Data array (image).</p>
</td></tr>
<tr><td><code>axDat</code></td>
<td>
<p>Data frame with axis scaling and labels (image).</p>
</td></tr>
<tr><td><code>F</code></td>
<td>
<p>Data frame containing a table (table).</p>
</td></tr>
<tr><td><code>col</code></td>
<td>
<p>Data from each column (bintable).</p>
</td></tr>
<tr><td><code>colNames</code></td>
<td>
<p>Vector of column names, TTYPEn FITS variable
(bintable, table).</p>
</td></tr>
<tr><td><code>colUnits</code></td>
<td>
<p>Vector of column units, TUNITn FITS variable
(bintable, table).</p>
</td></tr>
<tr><td><code>TNULLn</code></td>
<td>
<p>Vector of undefined value definitions, FITS variable
(bintable, table).</p>
</td></tr>
<tr><td><code>TSCALn</code></td>
<td>
<p>Vector of multipliers for scaling, FITS variable
(bintable, table).</p>
</td></tr>
<tr><td><code>TZEROn</code></td>
<td>
<p>Vector of zeros for scaling, FITS variable (bintable, table).</p>
</td></tr>
<tr><td><code>TDISPn</code></td>
<td>
<p>Vector of format information, FITS variable (bintable).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active development
with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>
<p>See <code>readFrameFromFITS</code> to read a binary table
directly into an <span class="rlang"><b>R</b></span> data frame.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a></p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITSarray">readFITSarray</a></code>,
<code><a href="#topic+readFITSbintable">readFITSbintable</a></code>,
<code><a href="#topic+readFITSheader">readFITSheader</a></code>,
<code><a href="#topic+readFrameFromFITS">readFrameFromFITS</a></code>,
<code><a href="#topic+modifyHeader">modifyHeader</a></code>,
<code><a href="graphics.html#topic+image">image</a></code>, <code><a href="graphics.html#topic+par">par</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)

### Image example
## Make test image with axis information, write to disk
Z &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(Z, file = filename, c1 = "Test FITS file",
            crpix = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c("Distance", "Time"),
            cunitn = c("Furlongs", "Fortnights"))
## Read back in and display
X &lt;-  readFITS(filename)
ax1 &lt;- axVec(1, X$axDat)          # Make axis vector for image
ax2 &lt;- axVec(2, X$axDat)
xlab &lt;- X$axDat$ctype[1]
ylab &lt;- paste(X$axDat$ctype[2], " [", X$axDat$cunit[2], "]", sep = "")
image(ax1, ax2, X$imDat, xlab = xlab, ylab = ylab)
str(X)
X$axDat                           # Display data frame with axis data
X$hdr[1:10]                       # Header sample
X$hdr[which(X$hdr=="BITPIX")+1]   # BITPIX value from header
## No axis scale markings
image(X$imDat, xlab = xlab, ylab = ylab, xaxt = "n", yaxt = "n")
## Clean up to avoid clutter
unlink(filename)

### Binary table examples
## Bintable with one row and differently multi-dimensional columns
## Either download example file from
## &lt;https://fits.gsfc.nasa.gov/fits_samples.html&gt;
## and use
## Not run: filename &lt;- "IUElwp25637mxlo.fits"
## or, for local example use
filename &lt;- system.file("fitsExamples", "IUElwp25637mxlo.fits",
                        package = "FITSio")

Y &lt;- readFITS(filename)
## Look at contents
str(Y)
Y$colNames
str(Y$col)
Y$hdr[which(Y$hdr=="BITPIX")+1]   # BITPIX value from header
plot(Y$col[[5]], ylab = "Value", main = Y$colNames[5], type = "l")

### Simple flat file example
filename &lt;- system.file("fitsExamples", "2008_03_11_203150.fits",
                        package = "FITSio")
Z &lt;- readFITS(filename)
str(Z)
Z$colNames
str(Z$col)
attach(Z)
xc &lt;- which(colNames == "DMJD")
yc &lt;- which(colNames == "TiltX")
xlab &lt;- paste(colNames[xc], " [", colUnits[xc], "]", sep = "")
ylab &lt;- paste(colNames[yc], " [", colUnits[yc], "]", sep = "")
plot(col[[xc]], col[[yc]], xlab = xlab, ylab = ylab, type = "l")
detach(Z)

### Read FITS file directly from URL (thanks to Bi Cheng Wu)
## Not run: 
  require(httr)      # provides RETRY() and content()
  require(magrittr)  # provides %&gt;% pipe operator, (part of tidyverse)
#
  fits &lt;- RETRY(verb="GET", url=fits_url) %&gt;% 
    content(type="raw") %&gt;% 
    rawConnection %&gt;% 
    readFITS

## End(Not run)

</code></pre>

<hr>
<h2 id='readFITSarray'>Read an image (multi-dimensional array) from a FITS file</h2><span id='topic+readFITSarray'></span>

<h3>Description</h3>

<p>Read an image (multi-dimensional array) from an open
connection to a FITS file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFITSarray(zz, hdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFITSarray_+3A_zz">zz</code></td>
<td>
<p>File handle; see Example.</p>
</td></tr>
<tr><td><code id="readFITSarray_+3A_hdr">hdr</code></td>
<td>
<p>Header card images, raw or parsed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFITSarray</code> reads the data from the image part of a FITS
Header and Data Unit (hdu) containing image data.  The header must be
read first by <code><a href="#topic+readFITS">readFITS</a></code> or <code><a href="#topic+readFITSheader">readFITSheader</a></code>;
either this header or the
parsed version from <code><a href="#topic+parseHdr">parseHdr</a></code> are valid for the <var>hdr</var>
variable.
</p>


<h3>Value</h3>

<p>A list containing
</p>
<table>
<tr><td><code>imDat</code></td>
<td>
<p>Data array.</p>
</td></tr>
<tr><td><code>axDat</code></td>
<td>
<p>Data frame with axis scaling and labels.</p>
</td></tr>
<tr><td><code>hdr</code></td>
<td>
<p>Vector with the parsed header.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Function assigns values of 1 to CRPIX, CRVAL, and CDELT if they are
unspecified in the header.
</p>
<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSheader">readFITSheader</a></code>,
<code><a href="#topic+readFITSbintable">readFITSbintable</a></code>, <code><a href="base.html#topic+file">file</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>    require(FITSio)
    ## Make a test file.
    Z &lt;- matrix(1:15, ncol = 3)
    filename &lt;- paste(tempdir(), "test.fits", sep="")
    writeFITSim(Z, filename)
    ## Open file, read header and array, close file and delete.
    zz &lt;- file(description = filename, open = "rb")
    header &lt;- readFITSheader(zz)  # image data off primary header
    D &lt;- readFITSarray(zz, header)
    close(zz)
    ## Look at data list, header file, and parsed header
    str(D)
    image(D$imDat)
    str(header)
    str(parseHdr(header))
</code></pre>

<hr>
<h2 id='readFITSbintable'>Read a FITS binary table</h2><span id='topic+readFITSbintable'></span>

<h3>Description</h3>

<p>Read a FITS binary table from an open connection to a
FITS file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFITSbintable(zz, hdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFITSbintable_+3A_zz">zz</code></td>
<td>
<p>File handle; see Example.</p>
</td></tr>
<tr><td><code id="readFITSbintable_+3A_hdr">hdr</code></td>
<td>
<p>Header card images, raw or parsed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFITSbintable</code> reads the data from the binary table part of a FITS
Header and Data Unit (hdu) containing binary table data.  The header must be
read first by <code><a href="#topic+readFITSheader">readFITSheader</a></code>; either this header or the
parsed version from <code><a href="#topic+parseHdr">parseHdr</a></code> are valid for the <var>hdr</var>
variable.  Binary tables are multi-column files with one or more rows.  Each
column has an individual data type and number of entries per cell
(i.e., a cell may contain a scalar or vector).
</p>
<p>64-bit integers are read as pairs of 32-bit integers, for a vector
twice the length of most other vectors.  Files read properly, but
reconstructing the 64-bit representation is untested.  The
CRAN package <code>int64</code> may be of use here.
</p>
<p>8, 16, 24, and 32-bit bit arrays return as integers.  Other lengths
are not supported.
</p>
<p>Binary table complex and array
descriptor data types are not implemented in this release due to a lack
of examples for testing.
</p>


<h3>Value</h3>

<table>
<tr><td><code>col</code></td>
<td>
<p>Data from each column, either a vector or an array.</p>
</td></tr>
<tr><td><code>hdr</code></td>
<td>
<p>Vector with parsed header.</p>
</td></tr>
<tr><td><code>colNames</code></td>
<td>
<p>Vector of column names, TTYPEn FITS variable.</p>
</td></tr>
<tr><td><code>colUnits</code></td>
<td>
<p>Vector of column units, TUNITn FITS variable.</p>
</td></tr>
<tr><td><code>TNULLn</code></td>
<td>
<p>Vector of undefined value definitions, FITS variable.</p>
</td></tr>
<tr><td><code>TSCALn</code></td>
<td>
<p>Vector of multipliers for scaling, FITS variable.</p>
</td></tr>
<tr><td><code>TZEROn</code></td>
<td>
<p>Vector of zeros for scaling, FITS variable.</p>
</td></tr>
<tr><td><code>TDISPn</code></td>
<td>
<p>Vector of format information, FITS variable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSheader">readFITSheader</a></code>,
<code><a href="#topic+readFITSarray">readFITSarray</a></code>, <code><a href="base.html#topic+file">file</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)

## Either download example file from
## &lt;https://fits.gsfc.nasa.gov/fits_samples.html&gt;
## and use
## Not run: filename &lt;- "IUElwp25637mxlo.fits"
## or, for local example use
filename &lt;- system.file("fitsExamples", "IUElwp25637mxlo.fits",
                        package = "FITSio")

## Open file, read header and table, close file.
zz &lt;- file(description = filename, open = "rb")
header0 &lt;- readFITSheader(zz) # read primary header
header &lt;- readFITSheader(zz) # read extension header
D &lt;- readFITSbintable(zz, header)
close(zz)

## Look at contents
str(D)
str(header)
str(parseHdr(header))
D$hdr[which(D$hdr=="BITPIX")+1]   # BITPIX value from header
D$colNames
plot(D$col[[5]], ylab = "Value", main = D$colNames[5], type = "l")

</code></pre>

<hr>
<h2 id='readFITSheader'>Read a FITS header</h2><span id='topic+readFITSheader'></span>

<h3>Description</h3>

<p>Read a FITS header from an open connection to a FITS file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFITSheader(zz, maxLines = 5000, fixHdr = 'none')
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFITSheader_+3A_zz">zz</code></td>
<td>
<p>file handle; see Example.</p>
</td></tr>
<tr><td><code id="readFITSheader_+3A_maxlines">maxLines</code></td>
<td>
<p>maximum number of header lines to read; see Details.</p>
</td></tr>
<tr><td><code id="readFITSheader_+3A_fixhdr">fixHdr</code></td>
<td>
<p>deal with non-printing characters in header; see Details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFITSheader</code> reads the data from the header part of a FITS
Header and Data Unit.  In addition to general header information, it
provides parameters needed to read image and binary table files by
functions <code>readFITSarray</code> and <code>readFITSbintable</code>.  A header
unit may exist without a corresponding data unit, for instance to
carry additional coordinate information.
</p>
<p>The <var>maxLines</var> variable limits the number of header lines
<code>readFITSheader</code> will read to prevent endless reading if the
header is flawed and the END
statement is missing.  The function generates a message an halts when the
number of reads exceeds  <var>maxLines</var>.  Increase the value as
needed for very large headers.
</p>
<p><var>fixHdr</var> attempts to fix headers with non-printing characters,
either by removing them with <code>fixHdr = 'remove'</code>, reading further
into the file until 2880 valid characters are present, or by
substituting spaces for non-printing characters with <code>fixHdr =
  'substitute'</code>.  This option should be used with caution, as non-printing
characters should not be in the header in the first place, so this
option may or may not corrupt the following data.  The default is
<code>fixHdr = 'none'</code>.  Partial matching is allowed.
</p>
<p>The header vector does not have an easy format for
people to read (graphical FITS viewers like <em>fv</em> and
<em>SAOImage DS9</em> are good for this),
but is designed for further processing
by <span class="rlang"><b>R</b></span>.  The header vector has a kind of
<em>keyword value keyword value ...</em>
format, where keywords without values are simply followed by the next
keyword.  This means a search for a keyword will give the corresponding
value as the next element in the vector; see the Examples.
</p>


<h3>Value</h3>

<p><var>hdr</var> is a character vector <var>hdr</var>
containing the header information in a format that is easy for
<span class="rlang"><b>R</b></span> to parse further.  See Details.
</p>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active development with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parseHdr">parseHdr</a></code>, the usual complement to <code>readFITSheader</code>;
<code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSarray">readFITSarray</a></code>,
<code><a href="#topic+readFITSbintable">readFITSbintable</a></code>, <code><a href="base.html#topic+file">file</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)
## Make test image with axis information, write to disk
Z &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(Z, file = filename, c1 = "Test FITS file",
            crpix = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c("Distance", "Time"),
            cunitn = c("Furlongs", "Fortnights"))
## Read back in
## Open file, read header and array.
    zz &lt;- file(description = filename, open = "rb")
    header &lt;- readFITSheader(zz)
    hdr &lt;- parseHdr(header)
    D &lt;- readFITSarray(zz, hdr)
    close(zz)
    hdr[1:10]                       # Header sample
    hdr[which(hdr=="BITPIX")+1]   # BITPIX value from header

## Clean up files to avoid clutter
unlink(filename)

</code></pre>

<hr>
<h2 id='readFITStable'>Read a FITS ASCII table</h2><span id='topic+readFITStable'></span>

<h3>Description</h3>

<p>Read a FITS ASCII table from an open connection to a
FITS file.</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFITStable(zz, hdr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFITStable_+3A_zz">zz</code></td>
<td>
<p>File handle; see Example.</p>
</td></tr>
<tr><td><code id="readFITStable_+3A_hdr">hdr</code></td>
<td>
<p>Header card images, raw or parsed.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFITStable</code> reads the data from the ASCII table part of a FITS
Header and Data Unit (hdu) containing ASCII table data.  The header must be
read first by <code><a href="#topic+readFITSheader">readFITSheader</a></code>; either this header or the
parsed version from <code><a href="#topic+parseHdr">parseHdr</a></code> are valid for the <var>hdr</var>
variable.  ASCII tables are multi-column files with one or more rows.  
</p>


<h3>Value</h3>

<table>
<tr><td><code>hdr</code></td>
<td>
<p>Vector with parsed header.</p>
</td></tr>
<tr><td><code>DF</code></td>
<td>
<p>Data frame containing table data.</p>
</td></tr>
<tr><td><code>colNames</code></td>
<td>
<p>Vector of column names, TTYPEn FITS variable.</p>
</td></tr>
<tr><td><code>colUnits</code></td>
<td>
<p>Vector of column units, TUNITn FITS variable.</p>
</td></tr>
<tr><td><code>TNULLn</code></td>
<td>
<p>Vector of undefined value definitions, FITS variable.</p>
</td></tr>
<tr><td><code>TSCALn</code></td>
<td>
<p>Vector of multipliers for scaling, FITS variable.</p>
</td></tr>
<tr><td><code>TZEROn</code></td>
<td>
<p>Vector of zeros for scaling, FITS variable.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSheader">readFITSheader</a></code>,
<code><a href="#topic+readFITSarray">readFITSarray</a></code>, <code><a href="base.html#topic+file">file</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)

filename &lt;- system.file("fitsExamples", "vizier.fits",
                        package = "FITSio")

## Simple read
D &lt;- readFITS(filename)

## Explicit read: open file, read header and table, close file.
zz &lt;- file(description = filename, open = "rb")
header0 &lt;- readFITSheader(zz) # read primary header
header &lt;- readFITSheader(zz) # read extension header
D &lt;- readFITStable(zz, header)
close(zz)

## Either way, look at contents
str(D)
str(D$DF)
str(header)
str(parseHdr(header))
D$hdr[which(D$hdr=="BITPIX")+1]   # BITPIX value from header
D$colNames

</code></pre>

<hr>
<h2 id='readFrameFromFITS'>Read a single data set from a FITS file into a data frame</h2><span id='topic+readFrameFromFITS'></span>

<h3>Description</h3>

<p>Read a binary table
from a FITS file directly into an <span class="rlang"><b>R</b></span> data frame.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readFrameFromFITS(file, hdu = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readFrameFromFITS_+3A_file">file</code></td>
<td>
<p>existing FITS file name.</p>
</td></tr>
<tr><td><code id="readFrameFromFITS_+3A_hdu">hdu</code></td>
<td>
<p>position of Header and Data Unit (HDU) in FITS file: 1 for
the first HDU, 2 for the second HDU, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>readFrameFromFITS</code> reads a single binary table Header and Data Unit
(HDU) pair from a file and returns the values as a data table.
</p>
<p>Binary table bit, complex, and array
descriptor data types are not implemented in this release due to a lack
of examples for testing.  8,
16, 24, and 32-bit bit arrays return as integers.  Other lengths are
not supported. 
</p>


<h3>Value</h3>

<p>An <span class="rlang"><b>R</b></span> data frame with the contents of the
requested binary table.
</p>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>) 
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Eric H.\ Neilsen, Jr.</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>require(FITSio)

## Either download example file from
## &lt;https://fits.gsfc.nasa.gov/fits_samples.html&gt;
## and use
## Not run: filename &lt;- "IUElwp25637mxlo.fits"
## or, for local example use
filename &lt;- system.file("fitsExamples", "IUElwp25637mxlo.fits",
                        package = "FITSio")

## Get data and display
F &lt;- readFrameFromFITS(filename) 
names(F)
plot(F$NET, ylab = "Value", main = names(F)[5], type = "l")

### Simple flat file example
filename &lt;- system.file("fitsExamples", "2008_03_11_203150.fits",
                        package = "FITSio")  
F &lt;- readFrameFromFITS(filename) 
names(F)
attach(F)
plot(DMJD, TiltX, xlab = "Time [DMJD]", ylab = "X Tilt [degr]", type = "l")
detach(F)

</code></pre>

<hr>
<h2 id='writeFITSim'>Write a FITS image (multi-dimensional numeric array) to disk</h2><span id='topic+writeFITSim'></span><span id='topic+writeFITSim16i'></span>

<h3>Description</h3>

<p>Write a FITS image (multi-dimensional numeric array) to disk.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>writeFITSim(X, file = "R.fits", type = "double",
bscale = 1, bzero = 0, c1 = NA, c2 = NA,
crpixn = NA, crvaln = NA, cdeltn = NA, ctypen = NA, cunitn = NA,
axDat = NA, header = '')

writeFITSim16i(X, file = "R.fits", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="writeFITSim_+3A_x">X</code></td>
<td>
<p>Multi-dimensional numeric data array; see Details.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_file">file</code></td>
<td>
<p>Output filename.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_type">type</code></td>
<td>
<p>Type to write: single or double precision.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_bscale">bscale</code></td>
<td>
<p>Global scaling factor, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_bzero">bzero</code></td>
<td>
<p>Global shift, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_c1">c1</code></td>
<td>
<p>Character string comment line for header.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_c2">c2</code></td>
<td>
<p>Character string comment line for header.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_crpixn">crpixn</code></td>
<td>
<p>Vector of reference pixel numbers for axes, FITS
standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_crvaln">crvaln</code></td>
<td>
<p>Vector of values at reference pixels, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_cdeltn">cdeltn</code></td>
<td>
<p>Vector of axis increments per pixel, FITS standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_ctypen">ctypen</code></td>
<td>
<p>String vector of descriptive labels for axis, FITS
standard meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_cunitn">cunitn</code></td>
<td>
<p>String vector of physical units for axis, FITS standard
meaning.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_axdat">axDat</code></td>
<td>
<p>Data frame with axis data (optional), see details.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_header">header</code></td>
<td>
<p>Header (optional) as 80-character card images.</p>
</td></tr>
<tr><td><code id="writeFITSim_+3A_...">...</code></td>
<td>
<p>Arguments as defined above, as needed, for
<code>writeFITSim16i</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>writeFITSim</code> and <code>writeFITSim16i</code> write multi-dimensional
data arrays and
header information to FITS-format files.  A single image is a
two-dimensional array; data cubes contain two dimensions plus one
additional dimension for each (often velocity) plane.
</p>
<p>Axis data may be given as a data frame <code>axDat</code>, typically from
<code><a href="#topic+readFITS">readFITS</a></code> or, if that is missing, by individual vectors for
<code>crpixn, crvaln</code>, etc.  <code>axDat</code> has priority over individual
vectors.  <code>axDat</code> may be edited easily with e.g.
<code>axDat &lt;- edit(axDat)</code>.
</p>
<p>Header data may be added to that the function automatically generates.
No or little editing is needed if the header is taken from an existing
file by e.g. <code><a href="#topic+readFITSheader">readFITSheader</a></code>: <code>writeFITSim</code> will
remove reserved keywords in the header that conflict with those
generated and add the END statement.  See <code><a href="#topic+modifyHeader">modifyHeader</a></code>
for functions to add to or modify the header.
</p>
<p><code>writeFITSim</code> writes integer or float data matching the data type in
the input array.  <code>writeFITSim16i</code> scales and shifts
the input to write
16-bit integer data with the maximum precision allowed by word
length.  FITS variables BSCALE and BZERO are automatically updated to
allow reconstruction of the original data values.  In cases where full
precision is not needed, this can reduce file sizes by a factor of
about four compared with a double-precision float.
</p>


<h3>Value</h3>

<p>FITS file written to disk.
</p>


<h3>Note</h3>

<p>Graphical FITS viewers such as <em>fv</em>
(<a href="https://heasarc.gsfc.nasa.gov/ftools/fv/">https://heasarc.gsfc.nasa.gov/ftools/fv/</a>) and <em>SAOImage DS9</em>
(<a href="http://ds9.si.edu/">http://ds9.si.edu/</a>)
have excellent facilities for displaying FITS data, headers, and file
structure.  Having one or more graphical viewers available will
prove extremely
useful
for working with FITS
files, even when the data are read into <span class="rlang"><b>R</b></span> for further processing.
<em>fv</em> and <em>SAOImage DS9</em> are in active devlopement with support for
unix, Windows, and Mac OS-X operating systems, and are available at no cost.
</p>


<h3>Author(s)</h3>

<p>Andrew Harris</p>


<h3>References</h3>

<p>Hanisch et al., <em>Astron.\ Astrophys.</em> 376, 359-380 (2001)
</p>
<p><a href="https://fits.gsfc.nasa.gov/">https://fits.gsfc.nasa.gov/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+readFITS">readFITS</a></code>, <code><a href="#topic+readFITSheader">readFITSheader</a></code>,
<code><a href="#topic+modifyHeader">modifyHeader</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Make data array with axis information, write to disk
X &lt;- matrix(1:15, ncol = 3)
filename &lt;- paste(tempdir(), "test.fits", sep="")
writeFITSim(X, file = filename, c1 = "Test FITS file",
            crpixn = c(1,1), crvaln = c(10, 100), cdeltn = c(8, 2),
            ctypen = c("Distance", "Time"),
            cunitn = c("Furlongs", "Fortnights"))
## Read back in, modify data offset, header, and axis data information,
## then write modified version as new file
Z &lt;-  readFITS(filename)
Z$imDat &lt;- Z$imDat + 300
Z$header &lt;- addKwv('SCALE', 1.03, 'test header mod', header=Z$header)
# Z$axDat &lt;- edit(Z$axDat)  # interactive edits
Z$axDat$cdelt
Z$axDat$cdelt[2] &lt;- 20
Z$axDat$cdelt
writeFITSim(Z$imDat, file=filename, axDat=Z$axDat, header=Z$header)


### 3-dimensional array example
## Write sample file
X &lt;- array(1:210, dim = c(10, 7, 3))
writeFITSim(X, filename)
## Read back in and display plane 2, no axis scale markings
Z &lt;-  readFITS(filename)
dim(Z$imDat[,,2])
image(Z$imDat[,,2], xaxt = "n", yaxt = "n")
str(Z)
print(Z$axDat)

## Clean up files after examples to avoid clutter
unlink(filename)

### Note: either of the writeFITSim() calls here could be replaced
###       with writeFITSim16i() calls with the identical argument.
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
