<!DOCTYPE html><html><head><title>Help for package visit</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {visit}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#parameters'><p>Parameters</p></a></li>
<li><a href='#plot.VTDEC'><p>Plot decision map</p></a></li>
<li><a href='#plot.VTTRUEPS'><p>Plot true parameters</p></a></li>
<li><a href='#summary.VTSIMU'><p>Summarize simulation results</p></a></li>
<li><a href='#summary.VTTRUEPS'><p>Print true probabilities</p></a></li>
<li><a href='#summary2'><p>S3 Summary function</p></a></li>
<li><a href='#summary2.VTSIMU'><p>Summarize simulation results</p></a></li>
<li><a href='#summary2.VTTRUEPS'><p>Print true probabilities in latex format</p></a></li>
<li><a href='#visit-package'><p>cancer Vaccine phase I design with Simultaneous evaluation of Immunogenecity and Toxicity</p></a></li>
<li><a href='#vtDecMap'><p>Obtain decision map information</p></a></li>
<li><a href='#vtInterim'><p>Conduct interim analysis</p></a></li>
<li><a href='#vtPost'><p>Postetrior sampling for given observed samples</p></a></li>
<li><a href='#vtPriorPar'><p>Get prior distribution parameters</p></a></li>
<li><a href='#vtScenario'><p>Set simulation scenario</p></a></li>
<li><a href='#vtShiny'><p>Run Web-Based <code>visit</code> application</p></a></li>
<li><a href='#vtSimu'><p>Conduct simulation study</p></a></li>
<li><a href='#vtSingleTrial'><p>Simulate a single trial</p></a></li>
<li><a href='#vtStan'><p>Call STAN models for MCMC sampling</p></a></li>
<li><a href='#vtTrack'><p>Plot the track plot of dose escalation</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Vaccine Phase I Design with Simultaneous Evaluation of
Immunogenicity and Toxicity</td>
</tr>
<tr>
<td>Version:</td>
<td>2.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Zilu Wang [aut, cre]
    Chenguang Wang [aut, cre]
    Gary L Rosner [aut]
    Richard BS Roden  [aut]
    Trustees of Columbia University [cph] (tools/make_cpp.R, R/stanmodels.R)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Chenguang Wang &lt;cwang68@jhmi.edu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>
    Phase I clinical trials are the first step in drug development to test
    a new drug or drug combination on humans. Typical designs of Phase I 
    trials use toxicity as the primary endpoint and aim to find the maximum 
    tolerable dosage. However, these designs are poorly applicable for the 
    development of cancer therapeutic vaccines because the expected safety 
    concerns for these vaccines are not as much as cytotoxic agents. The 
    primary objectives of a cancer therapeutic vaccine phase I trial thus 
    often include determining whether the vaccine shows biologic activity 
    and the minimum dose necessary to achieve a full immune or even clinical 
    response. This package implements a Bayesian Phase I cancer vaccine
    trial design that allows simultaneous evaluation of safety and
    immunogenicity outcomes. See Wang et al. (2019) &lt;<a href="https://doi.org/10.1002%2Fsim.8021">doi:10.1002/sim.8021</a>&gt;
    for further details.</td>
</tr>
<tr>
<td>Depends:</td>
<td>methods, R (&ge; 3.5.0), rstan (&ge; 2.19.2), Rcpp (&ge; 1.0.2)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>BH (&ge; 1.69.0-1), Rcpp (&ge; 1.0.2), rstan (&ge; 2.14),
RcppEigen (&ge; 0.3.3.5.0), StanHeaders (&ge; 2.18.1-10),
RcppParallel (&ge; 5.0.2)</td>
</tr>
<tr>
<td>Imports:</td>
<td>sqldf (&ge; 0.4), parallel (&ge; 3.2), rstantools (&ge; 2.1.1),
RcppParallel (&ge; 5.0.2)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>GNU make</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, shiny, rmarkdown, pander, xtable</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-08 01:28:04 UTC; zilu</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-09 10:30:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='parameters'>Parameters</h2><span id='topic+parameters'></span>

<h3>Description</h3>

<p>Parameters that are shared by multiple functions
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="parameters_+3A_obs.y">obs.y</code></td>
<td>
<p>Observed data matrix with <code class="reqn">l</code> rows and 4 columns. Row <code class="reqn">k</code> in the matrix
represents the observed data from dose level <code class="reqn">k</code>. The columns are
</p>

<ul>
<li><p>column 1: number of patient with no DLT, no immune response
</p>
</li>
<li><p>column 2: number of patient with no DLT, immune response
</p>
</li>
<li><p>column 3: number of patient with DLT, no immune response
</p>
</li>
<li><p>column 4: number of patient with DLT, immune response
</p>
</li></ul>
</td></tr>
<tr><td><code id="parameters_+3A_prob.mdl">prob.mdl</code></td>
<td>
<p>Option of the probability models:
</p>
<ul>
<li><p>NONPARA: non-parametric+ model
</p>
</li>
<li><p>NONPARA+: non-parametric model
</p>
</li>
<li><p>PARA: partially parametric model
</p>
</li>
<li><p>PARA+: partially parametric+ model </p>
</li></ul>

<p>Default value is <code>NONPARA</code>. See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="parameters_+3A_priors">priors</code></td>
<td>
<p>A class <code>VTPRIOR</code> object created by
<code><a href="#topic+vtPriorPar">vtPriorPar</a></code> for <code>PARA</code> and <code>PARA+</code> model.</p>
</td></tr>
<tr><td><code id="parameters_+3A_etas">etas</code></td>
<td>
<p>Vector of length 2 representing <code class="reqn">(p_L, p_U)</code>. <code class="reqn">p_L</code>: lower
bound of DLT risk, below which the current dose is considered absolutely
safe; <code class="reqn">p_U</code>: upper bound of DLT risk above which the current dose is
considered too toxic</p>
</td></tr>
<tr><td><code id="parameters_+3A_prev.res">prev.res</code></td>
<td>
<p>Response rate from the next lower dose level, say, <code class="reqn">l-1</code>.
This can be a scalar representing the mean of the response rate
<code class="reqn">E(q^{(l-1)})</code>, or a vector of posterior samples of the response rate
<code class="reqn">q^{(l-1)}</code>. For <code class="reqn">l=1</code>, this value is set to <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="parameters_+3A_dec.cut">dec.cut</code></td>
<td>
<p>Thresholds <code class="reqn">C_1,C_2,C_3</code>. If the vector length is shorter
than <code class="reqn">3</code>, it is repeated to have <code class="reqn">3</code> elements. See
<code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="parameters_+3A_digits">digits</code></td>
<td>
<p>Digits for print</p>
</td></tr>
<tr><td><code id="parameters_+3A_seed">seed</code></td>
<td>
<p>Random seed</p>
</td></tr>
<tr><td><code id="parameters_+3A_...">...</code></td>
<td>
<p>Reserved parameters</p>
</td></tr>
</table>

<hr>
<h2 id='plot.VTDEC'>Plot decision map</h2><span id='topic+plot.VTDEC'></span>

<h3>Description</h3>

<p>Plot a decision map based on a class <code>VTDEC</code> object that contains the
current posterior analysis results
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTDEC'
plot(x, margin = 0.003, nms = c("TT", "NME", "SE",
  "UN"), col.reg = "pink", col.prob = "blue", cex.prob = 0.9,
  cex.nms = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.VTDEC_+3A_x">x</code></td>
<td>
<p>A class <code>VTDEC</code> list generated by <code><a href="#topic+vtDecMap">vtDecMap</a></code></p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_margin">margin</code></td>
<td>
<p>Margin between regions in the decision map</p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_nms">nms</code></td>
<td>
<p>Labels of the regions on a decision map. Defaults are:
</p>

<ul>
<li><p><code>TT</code>:Too Toxic
</p>
</li>
<li><p><code>NME</code>:No More Effective
</p>
</li>
<li><p><code>SE</code>:Safe and Effective
</p>
</li>
<li><p><code>UN</code>:Uncertain
</p>
</li></ul>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_col.reg">col.reg</code></td>
<td>
<p>Background color of the selected region</p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_col.prob">col.prob</code></td>
<td>
<p>Text color of the selected region.</p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_cex.prob">cex.prob</code></td>
<td>
<p>Text size of the probabilities</p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_cex.nms">cex.nms</code></td>
<td>
<p>Text size of the region labels</p>
</td></tr>
<tr><td><code id="plot.VTDEC_+3A_...">...</code></td>
<td>
<p>Optional arguments for <code>plot</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
etas       &lt;- c(0.1, 0.3)
dec.cut    &lt;- c(0.6,0.6,0.6)
cur.obs.y  &lt;- c(3, 2, 1, 1)
prev.obs.y &lt;- c(5, 2, 0, 0)
rst.inter  &lt;- vtInterim(cur.obs.y,  prev.obs.y = prev.obs.y,
                        prob.mdl = "NONPARA", etas = etas, dec.cut = dec.cut,
                        nsmp = 2000);
plot(rst.inter)

</code></pre>

<hr>
<h2 id='plot.VTTRUEPS'>Plot true parameters</h2><span id='topic+plot.VTTRUEPS'></span>

<h3>Description</h3>

<p>Plot true DLT risk rates and response rates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTTRUEPS'
plot(x, draw.levels = NULL, draw.curves = 1:6,
  legends = NULL, ltys = c(1, 1, 2, 2, 2, 2), pch = 19:24,
  ylim = c(0, 1), cols = c("red", "blue", "brown", "black", "gray",
  "green"), add.legend = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.VTTRUEPS_+3A_x">x</code></td>
<td>
<p>A class <code>VTTRUEPS</code> matrix generated by <code><a href="#topic+vtScenario">vtScenario</a></code></p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_draw.levels">draw.levels</code></td>
<td>
<p>Select dose levels to draw. Default <code>NULL</code> draws all
levels.</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_draw.curves">draw.curves</code></td>
<td>
<p>Indicate which curves to plot. The options are
</p>

<ul>
<li><p>1:p: DLT risk rate
</p>
</li>
<li><p>2:q: Response rate
</p>
</li>
<li><p>3:<code class="reqn">\theta_{00}</code>
</p>
</li>
<li><p>4:<code class="reqn">\theta_{01}</code>
</p>
</li>
<li><p>5:<code class="reqn">\theta_{10}</code>
</p>
</li>
<li><p>6:<code class="reqn">\theta_{11}</code>
</p>
</li></ul>

<p>See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_legends">legends</code></td>
<td>
<p>Line legends</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_ltys">ltys</code></td>
<td>
<p>Line types</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_pch">pch</code></td>
<td>
<p>Line PCH</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_ylim">ylim</code></td>
<td>
<p>Y limits</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_cols">cols</code></td>
<td>
<p>Line colors</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_add.legend">add.legend</code></td>
<td>
<p>Include legends (TRUE) or not (FALSE)</p>
</td></tr>
<tr><td><code id="plot.VTTRUEPS_+3A_...">...</code></td>
<td>
<p>optional arguments for plot</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
plot(rst.sce, draw.levels = 1:2, draw.curves=1:6)

</code></pre>

<hr>
<h2 id='summary.VTSIMU'>Summarize simulation results</h2><span id='topic+summary.VTSIMU'></span>

<h3>Description</h3>

<p>Summarize the simulation results with numerous statistical measures
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTSIMU'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.VTSIMU_+3A_object">object</code></td>
<td>
<p>A class <code>VTSIMU</code> list generated by <code><a href="#topic+vtSimu">vtSimu</a></code></p>
</td></tr>
<tr><td><code id="summary.VTSIMU_+3A_...">...</code></td>
<td>
<p>Reserved parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing
</p>

<ul>
<li><p>dose: Frequency for each dose level being selected as the optimal dose level
</p>
</li>
<li><p>npat: Average number of patients for each cohort and each dose level
</p>
</li>
<li><p>samples: Average number of DLT risks and responses for each cohort on each dose level
</p>
</li>
<li><p>decision: Frequency each region in the decision map is selected for each cohort on each dose level
</p>
</li>
<li><p>prob: Average conditional probabilities corresponding to each region in
the decision map for each cohort on each dose level
</p>
</li>
<li><p>ptox: Mean and credible interval of DLT risk rates for each cohort on each dose level
</p>
</li>
<li><p>pres: Mean and credible interval of immune response rates for each cohort on each dose level
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
rst.simu  &lt;- vtSimu(n.rep = 50, n.cors = 2, trueps = rst.sce,
                    size.cohort=3, size.level=12,
                    prob.mdl="NONPARA");
sum.simu &lt;- summary(rst.simu)

</code></pre>

<hr>
<h2 id='summary.VTTRUEPS'>Print true probabilities</h2><span id='topic+summary.VTTRUEPS'></span>

<h3>Description</h3>

<p>Print the true probabilities, with probabilities of toxicity and resistance,
and <code class="reqn">\rho</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTTRUEPS'
summary(object, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.VTTRUEPS_+3A_object">object</code></td>
<td>
<p>A class <code>VTTRUEPS</code> matrix generated by <code><a href="#topic+vtScenario">vtScenario</a></code></p>
</td></tr>
<tr><td><code id="summary.VTTRUEPS_+3A_digits">digits</code></td>
<td>
<p>Digits for print</p>
</td></tr>
<tr><td><code id="summary.VTTRUEPS_+3A_...">...</code></td>
<td>
<p>Reserved parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A table showing the summary of the <code>VTTRUEPS</code> object. The first
four columns are individual probability, fifth and sixth are probability
for toxicity and resistance, and seventh is rho, the correlation.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
summary(rst.sce)

</code></pre>

<hr>
<h2 id='summary2'>S3 Summary function</h2><span id='topic+summary2'></span>

<h3>Description</h3>

<p>S3 Summary function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summary2(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary2_+3A_x">x</code></td>
<td>
<p>object</p>
</td></tr>
<tr><td><code id="summary2_+3A_...">...</code></td>
<td>
<p>reserved parameters</p>
</td></tr>
</table>

<hr>
<h2 id='summary2.VTSIMU'>Summarize simulation results</h2><span id='topic+summary2.VTSIMU'></span>

<h3>Description</h3>

<p>Summarize simulation results to get the frequency of a dose level is identified
as the optimal dose level and the number of DLT's and responses
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTSIMU'
summary2(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary2.VTSIMU_+3A_x">x</code></td>
<td>
<p>A class <code>VTSIMU</code> list generated by <code><a href="#topic+vtSimu">vtSimu</a></code></p>
</td></tr>
<tr><td><code id="summary2.VTSIMU_+3A_...">...</code></td>
<td>
<p>Reserved parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric array that shows 1: number of times each level is selected,
2. total number of times any level is selected, 3. frequency each
level is selected, 4. frequency any level is selected, 5. average number
of DLT's and responders for each level, 6. average total number of DLT's
and responders
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
rst.simu  &lt;- vtSimu(n.rep = 20, n.cors = 2, trueps = rst.sce,
                    size.cohort=3, size.level=12,
                    prob.mdl="NONPARA");
sum.simu &lt;- summary2(rst.simu)


</code></pre>

<hr>
<h2 id='summary2.VTTRUEPS'>Print true probabilities in latex format</h2><span id='topic+summary2.VTTRUEPS'></span>

<h3>Description</h3>

<p>Print the true probabilities, with probabilities of toxicity and resistance,
and <code class="reqn">\rho</code>, in latex format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'VTTRUEPS'
summary2(x, rp2d = -1, digits = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary2.VTTRUEPS_+3A_x">x</code></td>
<td>
<p>A class <code>VTTRUEPS</code> matrix generated by <code><a href="#topic+vtScenario">vtScenario</a></code></p>
</td></tr>
<tr><td><code id="summary2.VTTRUEPS_+3A_rp2d">rp2d</code></td>
<td>
<p>Columns to be in bold font</p>
</td></tr>
<tr><td><code id="summary2.VTTRUEPS_+3A_digits">digits</code></td>
<td>
<p>Digits for print</p>
</td></tr>
<tr><td><code id="summary2.VTTRUEPS_+3A_...">...</code></td>
<td>
<p>Reserved parameters</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A summary of the true probabilities in latex format.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
ltx.ps &lt;- summary2(rst.sce)


</code></pre>

<hr>
<h2 id='visit-package'>cancer Vaccine phase I design with Simultaneous evaluation of Immunogenecity and Toxicity</h2><span id='topic+visit-package'></span><span id='topic+visit'></span>

<h3>Description</h3>

<p>This package contains the functions for implementing the <strong>visit</strong> design for
Phase I cancer vaccine trials.
</p>


<h3>Background</h3>

<p>Phase I clinical trials are the first step in drug development to apply a new
drug or drug combination on humans. Typical designs of Phase I trials use
toxicity as the primary endpoint and aim to find the maximum tolerable
dosage. However, these designs are generally inapplicable for the development
of cancer vaccines because the primary objectives of a cancer vaccine Phase I
trial often include determining whether the vaccine shows biologic activity.
</p>
<p>The <strong>visit</strong> design allows dose escalation to simultaneously account
for immunogenicity and toxicity. It uses lower dose levels as the reference
for determining if the current dose level is optimal in terms of immune
response. It also ensures subject safety by capping the toxicity rate with a
given upper bound. These two criteria are simultaneously evaluated using an
intuitive decision region that avoids complicated safety and immunogenicity
trade-off elicitation from physicians.
</p>
<p>There are several considerations that are clinically necessary for developing
the design algorithm. First, we assume that there is a non-decreasing
relationship that exists between toxicity and dosage, i.e., the toxicity risk
does not decrease as dose level increases. Second, the immune response rate
may reach a plateau or even start to decline as the dose level increases.
</p>


<h3>Notation</h3>

<p>For subject <code class="reqn">s</code>, let <code class="reqn">D_s=l</code> (<code class="reqn">l=1,\ldots,L</code>) denote the received
dose level, <code class="reqn">T_s=1</code> if any DLT event is observed from the subject and
<code class="reqn">0</code> otherwise, <code class="reqn">R_s=1</code> if immune response is achieved for the subject
and <code class="reqn">0</code> otherwise.
</p>
<p>Let <code class="reqn">\theta^{(l)}_{ij}=P(T=i, R=j|D=l)</code> for <code class="reqn">i,j=0,1</code>,
<code class="reqn">\theta^{(l)}=\{\theta_{ij}^{(l)}:i,j=0,1\}</code> and <code class="reqn">\Theta =
\{\theta^{(l)}: l=1,\ldots,L\}</code>. Furthermore, for dose level <code class="reqn">l</code>, let
<code class="reqn">p^{(l)}=P(T=1|D=l)=\theta_{10}^{(l)}+\theta_{11}^{(l)}</code> be the DLT risk,
<code class="reqn">q^{(l)}=P(R=1|D=l)=\theta_{01}^{(l)}+\theta_{11}^{(l)}</code> be the immune
response probability, and
<code class="reqn">r^{(l)}=\theta_{00}^{(l)}\theta_{11}^{(l)}/\theta_{01}^{(l)}\theta_{10}^{(l)}</code>
be the odds ratio. Let <code class="reqn">n_{ij}^{(l)}</code> be the observed number of subjects
with <code class="reqn">T=i</code> and <code class="reqn">R=j</code> at dose level <code class="reqn">l</code>,
<code class="reqn">n^{(l)}=\{n_{ij}^{(l)}:i,j=0,1\}</code> and <code class="reqn">H</code> denote all the data
observed by the time the current analysis is conducted.
</p>


<h3>Dose escalation algorithm</h3>

<p>The dose escalation algorithm is based on the posterior probability
distribution of <code class="reqn">\pi(p^{(l)}, q^{(l)}|H)</code>, where <code class="reqn">p^{(l)}</code> and
<code class="reqn">q^{(l)}</code> represent the DLT risk and immune response rate, respectively,
of the current dose level <code class="reqn">l</code>, and <code class="reqn">H</code> denotes the cumulative data at
the time of interim analysis.
</p>
<p>Let <code class="reqn">p_l</code> denote the lower boundary of DLT risk below which the dose is
considered absolutely safe, <code class="reqn">p_u</code> denote the upper boundary of DLT risk
above which the dose is considered toxic. <strong>visit</strong> implements a sequential
identification approach based on conditional probabilities derived from
<code class="reqn">\pi(p^{(l)}, q^{(l)}|H)</code>. Let <code class="reqn">C_1, C_2, C_3</code> be fixed cut-off
values in <code class="reqn">[0,1]</code>. The steps are as follows:
</p>

<dl>
<dt>Step 1.</dt><dd><p>If <code class="reqn">Prob(p^{(l)} &gt; p_U|H) &gt; C_1</code>, then the current dose level is
considered to be <strong>too toxic</strong>. The trial should be stopped and the next lower
dose level should be reported as the recommended dose.</p>
</dd>
<dt>Step 2.</dt><dd><p><code class="reqn">Prob(q^{(l)} \leq q_L| p^{(l)} \leq p_U, H) &gt; C_2</code>, then the
current dose level is considered to be <strong>no more effective than its lower dose</strong>
levels. The trial should be stopped and the next lower dose level should be
reported as the recommended dose.</p>
</dd>
<dt>Step 3.</dt><dd><p>If <code class="reqn">Prob(p^{(l)} \leq p_L| p^{(l)} \leq p_U, q^{(l)} &gt;
q_L, H) &gt; C_3</code>, then the current dose level is considered to be <strong>safe and
effective</strong>. The trial will escalate to dose level <code class="reqn">l+1</code>.</p>
</dd>
<dt>Step 4.</dt><dd><p>The current dose level is considered to be <strong>uncertain</strong>. The
trial should continue to treat more patients at dose level <code class="reqn">l</code>.</p>
</dd>
</dl>

<p>The values of should be chosen <code class="reqn">C_1, C_2, C_3</code> prior to study initiation
and reflect the considerations of the investigators and patients. These
thresholds should also give reasonable overall study operating
characteristics.
</p>
<p>We can see that, based on the posterior distribution of <code class="reqn">\pi(p^{(l)},
q^{(l)}|H)</code>, the currently dose level is in one of the four regions:
<strong>1: too toxic</strong>, <strong>2: no more effective than its lower dose</strong>,
<strong>3: safe and effective</strong>, and <strong>4: uncertain</strong>. These regions are termed
as a <code>Decision Map</code>.
</p>


<h3>Probability models</h3>

<p><strong>visit</strong> provides several options for the probability models that can
be considered for Bayesian inference. The models are non-decreasing with
respect to the dose-toxicity relationship and avoid monotonic assumptions for
the dose-immune response curve.
</p>


<h4>Non-parametric model</h4>

<p>As one of the simplest models, we posit
no assumptions on the dose-toxicity or dose-immune response relationships and
assume the outcome data <code class="reqn">n_{00}, n_{01}, n_{10}, n_{11}</code> follow a
multinomial distribution.
</p>



<h4>Non-parametric+ model</h4>

<p>This is the simplified
<strong>non-parametric</strong> model with the odds ratios <code class="reqn">r=1</code>. </p>



<h4>Partially parametric model</h4>

<p>Compared to non-parametric models, a
parametric model may allow the incorporation of dose-toxicity, dose-efficacy,
and toxicity-efficacy relationships in dose escalation. In the context of
evaluating cancer vaccines, however, it is difficult to posit assumptions on
the dose-efficacy relationship, since the immune response rate may even
decrease as the dose level increases. On the other hand, it remains
reasonable to assume that the dose-toxicity curve is non-decreasing.
Therefore, we propose a partially parametric model that only makes
assumptions about dose-toxicities but leaves the dose-immune response
relationship unspecified.
</p>
<p>Specifically, we construct the dose-toxicity model as: </p>
<p style="text-align: center;"><code class="reqn"> \log p^{(l)}=
e^\alpha \log \tau^{(l)}. </code>
</p>
<p> The <code class="reqn">\tau^{(l)}</code>'s are deterministic design
parameters reflecting the expectation of the DLT risk at dose level <code class="reqn">l</code>
with <code class="reqn">\tau^{(l)} &gt; \tau^{(l')}</code> for <code class="reqn">l&gt; l'</code>.
</p>
<p>For the immune response and the odds ratio, we assume <code class="reqn">q^{(l)}</code> and
<code class="reqn">r^{(l)}</code> at different dose levels are independent a priori.
</p>



<h4>Partially parametric+ model</h4>

<p>This is the simplified
<strong>partially parametric</strong> model with the odds ratios <code class="reqn">r=1</code>.</p>



<h3>Graphical user interface</h3>

<p>This package provides a web-based graphical user interface developed using R
Shiny. See <code><a href="#topic+vtShiny">vtShiny</a></code> for details.
</p>


<h3>References</h3>

<p>Wang, C., Rosner, G. L., &amp; Roden, R. B. (2019). A Bayesian design for phase I cancer
therapeutic vaccine trials. Statistics in medicine, 38(7), 1170-1189.
</p>

<hr>
<h2 id='vtDecMap'>Obtain decision map information</h2><span id='topic+vtDecMap'></span>

<h3>Description</h3>

<p>Summarize the posterior distribution of <code class="reqn">\theta^{(l)}_{00},
    \theta^{(l)}_{01}, \theta^{(l)}_{10}, \theta^{(l)}_{11}</code> and get
information for making dose escalation decisions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtDecMap(thetas, etas, prev.res = 0, dec.cut = 0.6)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtDecMap_+3A_thetas">thetas</code></td>
<td>
<p>Posterior samples of <code class="reqn">\theta</code>, a class <code>VTPOST</code> matrix
generated by <code><a href="#topic+vtPost">vtPost</a></code></p>
</td></tr>
<tr><td><code id="vtDecMap_+3A_etas">etas</code></td>
<td>
<p>Vector of length 2 representing <code class="reqn">(p_L, p_U)</code>. <code class="reqn">p_L</code>: lower
bound of DLT risk, below which the current dose is considered absolutely
safe; <code class="reqn">p_U</code>: upper bound of DLT risk above which the current dose is
considered too toxic</p>
</td></tr>
<tr><td><code id="vtDecMap_+3A_prev.res">prev.res</code></td>
<td>
<p>Response rate from the next lower dose level, say, <code class="reqn">l-1</code>.
This can be a scalar representing the mean of the response rate
<code class="reqn">E(q^{(l-1)})</code>, or a vector of posterior samples of the response rate
<code class="reqn">q^{(l-1)}</code>. For <code class="reqn">l=1</code>, this value is set to <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="vtDecMap_+3A_dec.cut">dec.cut</code></td>
<td>
<p>Thresholds <code class="reqn">C_1,C_2,C_3</code>. If the vector length is shorter
than <code class="reqn">3</code>, it is repeated to have <code class="reqn">3</code> elements. See
<code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function summarizes the posterior distribution of the
<code class="reqn">\theta^{(l)}_{00}, \theta^{(l)}_{01}, \theta^{(l)}_{10},
    \theta^{(l)}_{11}</code> and sequentially get the conditional probabilities of
each decision map region. See <code><a href="#topic+visit">visit</a></code> for details of the
decision map regions.
</p>


<h3>Value</h3>

<p>A class <code>VTDEC</code> list. See the return value from <code><a href="#topic+vtInterim">vtInterim</a></code>
for details.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>etas     &lt;- c(0.1, 0.3)
dec.cut  &lt;- c(0.6,0.6,0.6)
obs.y    &lt;- rbind(c(5, 2, 0, 0))
rst.post &lt;- vtPost(obs.y,  prob.mdl = "NONPARA", nsmp = 2000)
dec.map  &lt;- vtDecMap(rst.post, etas = etas, dec.cut = dec.cut)

</code></pre>

<hr>
<h2 id='vtInterim'>Conduct interim analysis</h2><span id='topic+vtInterim'></span>

<h3>Description</h3>

<p>Conduct an interim analysis for determining dose escalation actions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtInterim(cur.obs.y, prev.obs.y = NULL, prev.res = NULL,
  etas = c(0.1, 0.3), dec.cut = 0.65, priors = NULL,
  prob.mdl = c("NONPARA", "NONPARA+", "PARA", "PARA+"), seed = NULL,
  ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtInterim_+3A_cur.obs.y">cur.obs.y</code></td>
<td>
<p>Observed data from the current level, which is a vector of
length 4. The numbers correspond to <code>obs.y</code> in <code><a href="#topic+vtPost">vtPost</a></code>.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_prev.obs.y">prev.obs.y</code></td>
<td>
<p>Observed data from previous levels, which has the same
structure as <code>obs.y</code> in <code><a href="#topic+vtPost">vtPost</a></code>.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_prev.res">prev.res</code></td>
<td>
<p>Response rate from the next lower dose level, say, <code class="reqn">l-1</code>.
This can be a scalar representing the mean of the response rate
<code class="reqn">E(q^{(l-1)})</code>, or a vector of posterior samples of the response rate
<code class="reqn">q^{(l-1)}</code>. For <code class="reqn">l=1</code>, this value is set to <code class="reqn">0</code>.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_etas">etas</code></td>
<td>
<p>Vector of length 2 representing <code class="reqn">(p_L, p_U)</code>. <code class="reqn">p_L</code>: lower
bound of DLT risk, below which the current dose is considered absolutely
safe; <code class="reqn">p_U</code>: upper bound of DLT risk above which the current dose is
considered too toxic</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_dec.cut">dec.cut</code></td>
<td>
<p>Thresholds <code class="reqn">C_1,C_2,C_3</code>. If the vector length is shorter
than <code class="reqn">3</code>, it is repeated to have <code class="reqn">3</code> elements. See
<code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_priors">priors</code></td>
<td>
<p>A class <code>VTPRIOR</code> object created by
<code><a href="#topic+vtPriorPar">vtPriorPar</a></code> for <code>PARA</code> and <code>PARA+</code> model.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_prob.mdl">prob.mdl</code></td>
<td>
<p>Option of the probability models:
</p>
<ul>
<li><p>NONPARA: non-parametric+ model
</p>
</li>
<li><p>NONPARA+: non-parametric model
</p>
</li>
<li><p>PARA: partially parametric model
</p>
</li>
<li><p>PARA+: partially parametric+ model </p>
</li></ul>

<p>Default value is <code>NONPARA</code>. See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_seed">seed</code></td>
<td>
<p>Random seed</p>
</td></tr>
<tr><td><code id="vtInterim_+3A_...">...</code></td>
<td>
<p>Additional arguments for <code><a href="#topic+vtPost">vtPost</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using data from previous levels and the current level to conduct Bayesian
analysis, get the decision map information and make decision about dose
escalation actions. The actions include stop the trial, escalate to the next
higher dose level, or enroll more patients in the current level. See <code><a href="#topic+visit">visit</a></code>
for details.
</p>


<h3>Value</h3>

<p>A class <code>VTDEC</code> list containing
</p>

<ul>
<li><p>prob: Probabilities of each decision map region
</p>
</li>
<li><p>region: The region selected based on the sequential procedure described in <code><a href="#topic+visit">visit</a></code> 
</p>
</li>
<li><p>ptox: Mean risk of DLT, <code class="reqn">E(p^{(l)})</code>
</p>
</li>
<li><p>pres: Mean immune response rate, <code class="reqn">E(q^{(l)})</code>
</p>
</li>
<li><p>con.prob: Conditional probabilities of each decision map region
</p>
</li>
<li><p>prev.res: Function parameter
</p>
</li>
<li><p>etas: Function parameter
</p>
</li>
<li><p>dec.cut: Function parameter
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
etas       &lt;- c(0.1, 0.3)
dec.cut    &lt;- c(0.6,0.6,0.6)
cur.obs.y  &lt;- c(3, 2, 1, 1)
prev.obs.y &lt;- c(5, 2, 0, 0)
rst.inter  &lt;- vtInterim(cur.obs.y,  prev.obs.y = prev.obs.y,
                        prob.mdl = "NONPARA", etas = etas,
                        dec.cut = dec.cut,
                        nsmp = 2000);

</code></pre>

<hr>
<h2 id='vtPost'>Postetrior sampling for given observed samples</h2><span id='topic+vtPost'></span>

<h3>Description</h3>

<p>Call STAN to draw posterior samples of the joint distribution of
immunogenicity rate and toxicity risk
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtPost(obs.y, prob.mdl = c("NONPARA", "NONPARA+", "PARA", "PARA+"),
  priors = NULL, ..., nsmp = 4000, prior.const = 0.5)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtPost_+3A_obs.y">obs.y</code></td>
<td>
<p>Observed data matrix with <code class="reqn">l</code> rows and 4 columns. Row <code class="reqn">k</code> in the matrix
represents the observed data from dose level <code class="reqn">k</code>. The columns are
</p>

<ul>
<li><p>column 1: number of patient with no DLT, no immune response
</p>
</li>
<li><p>column 2: number of patient with no DLT, immune response
</p>
</li>
<li><p>column 3: number of patient with DLT, no immune response
</p>
</li>
<li><p>column 4: number of patient with DLT, immune response
</p>
</li></ul>
</td></tr>
<tr><td><code id="vtPost_+3A_prob.mdl">prob.mdl</code></td>
<td>
<p>Option of the probability models:
</p>
<ul>
<li><p>NONPARA: non-parametric+ model
</p>
</li>
<li><p>NONPARA+: non-parametric model
</p>
</li>
<li><p>PARA: partially parametric model
</p>
</li>
<li><p>PARA+: partially parametric+ model </p>
</li></ul>

<p>Default value is <code>NONPARA</code>. See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtPost_+3A_priors">priors</code></td>
<td>
<p>A class <code>VTPRIOR</code> object created by
<code><a href="#topic+vtPriorPar">vtPriorPar</a></code> for <code>PARA</code> and <code>PARA+</code> model.</p>
</td></tr>
<tr><td><code id="vtPost_+3A_...">...</code></td>
<td>
<p>additional parameters for package rstan's sampling method. These
options include <code>warmup</code>, <code>thin</code>, <code>algorithm</code>. See
<code>rstan::sampling</code> for details.</p>
</td></tr>
<tr><td><code id="vtPost_+3A_nsmp">nsmp</code></td>
<td>
<p>number of iterations</p>
</td></tr>
<tr><td><code id="vtPost_+3A_prior.const">prior.const</code></td>
<td>
<p>Specify <code class="reqn">\alpha</code> for a Beta(<code class="reqn">\alpha</code>,
<code class="reqn">\alpha</code>) prior. The Beta prior is used for <code>NONPARA</code> and
<code>NONPARA+</code> models. Default value <code class="reqn">0.5</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>VTPOST</code> matrix of posterior samples with <code>nsmp</code>
rows and 4 columns. Columns 1-4 correspond to<code class="reqn">\theta^{(l)}_{00},
    \theta^{(l)}_{01}, \theta^{(l)}_{10}, \theta^{(l)}_{11}</code>. See
<code><a href="#topic+visit">visit</a></code> for details about <code class="reqn">\theta</code>'s.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>obs.y    &lt;- rbind(c(5, 2, 0, 0), c(3, 4, 0, 0), c(1, 6, 0, 0))
prior &lt;- vtPriorPar(prior.y = NULL, tau = c(0.1, 0.3, 0.6), sdalpha=10, sdrho=10, vtheta=NULL)
rst.post &lt;- vtPost(obs.y, priors = prior, warmup = 100, prob.mdl = "PARA", nsmp = 200)

</code></pre>

<hr>
<h2 id='vtPriorPar'>Get prior distribution parameters</h2><span id='topic+vtPriorPar'></span>

<h3>Description</h3>

<p>Get prior distribution parameters for partially parametric or partially parametric+ models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtPriorPar(prior.y = NULL, tau = NULL, sdalpha = 10, sdrho = 10,
  vtheta = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtPriorPar_+3A_prior.y">prior.y</code></td>
<td>
<p>Historical data for generating prior parameters. It has the
same structure as <code>obs.y</code> in <code><a href="#topic+vtPost">vtPost</a></code>.</p>
</td></tr>
<tr><td><code id="vtPriorPar_+3A_tau">tau</code></td>
<td>
<p>Vector of <code class="reqn">\tau</code> values. See <code><a href="#topic+visit">visit</a></code> for details.
Can not be <code>NULL</code> if <code>prior.y</code> is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="vtPriorPar_+3A_sdalpha">sdalpha</code></td>
<td>
<p><code class="reqn">\sigma_\alpha</code>. See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtPriorPar_+3A_sdrho">sdrho</code></td>
<td>
<p><code class="reqn">\sigma_\rho</code>.</p>
</td></tr>
<tr><td><code id="vtPriorPar_+3A_vtheta">vtheta</code></td>
<td>
<p>Additional variance term for eliciting prior parameters from
<code>prior.y</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The priors are specified as <code class="reqn">q^{(l)} \sim Beta(a_q^{(l)}, b_q^{(l)})</code>,
and <code class="reqn">\log\rho^{(l)} \sim N(0, \sigma_\rho^2)</code>.
</p>


<h3>Value</h3>

<p>A <code>VTPRIOR</code> list with
</p>

<ul>
<li><p>TAU:vector of <code class="reqn">\tau</code>'s for each level
</p>
</li>
<li><p>ABCD:A matrix of 4 columns: <code class="reqn">a_q</code>, <code class="reqn">b_q</code>, <code class="reqn">a_\rho</code>,
<code class="reqn">{\sigma_\rho}</code>. Each row represents a dose level.</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
par.prior &lt;- vtPriorPar(tau = c(0.2, 0.4, 0.6), sdalpha = 10);

</code></pre>

<hr>
<h2 id='vtScenario'>Set simulation scenario</h2><span id='topic+vtScenario'></span>

<h3>Description</h3>

<p>Simulation function. Get true <code class="reqn">\theta</code>'s using marginal probabilities and
odds ratio <code class="reqn">\rho</code> for all dose levels.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtScenario(tox = c(0.05, 0.05, 0.08), res = c(0.2, 0.3, 0.5),
  rho = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtScenario_+3A_tox">tox</code></td>
<td>
<p>Vector of marginal DLT risk rates for all levels</p>
</td></tr>
<tr><td><code id="vtScenario_+3A_res">res</code></td>
<td>
<p>Vector of marginal immune response rates for all levels</p>
</td></tr>
<tr><td><code id="vtScenario_+3A_rho">rho</code></td>
<td>
<p>Vector of odds ratio for all levels. If length of <code>rho</code> is
shorter than the length of <code>tox</code> or <code>res</code>, vector <code>rho</code> is
repeated to have the same length as <code>tox</code> and <code>res</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The calculation is as following. If <code class="reqn">\rho = 1</code>, then <code class="reqn">\theta_{11} =
pq</code>, <code class="reqn">\theta_{01} = (1-p)q</code>, <code class="reqn">\theta_{10} = p(1-q)</code>, and
<code class="reqn">\theta_{00} = (1-p)(1-q)</code>. Otherwise, <code class="reqn"> \theta_{11} = -(\sqrt{A+B}</code>,
<code class="reqn">\theta_{01} = q-\theta_{11}</code>, <code class="reqn">\theta_{10} = p-\theta_{11}</code>, and
<code class="reqn">\theta_{00} = \theta_{01}\theta_{10}\rho/\theta_{11}</code>, where
<code class="reqn">A=(p+q-p \rho-q\rho-1)^2-4(\rho-1)pq\rho)</code> and
<code class="reqn">B=(p+q-p\rho-q\rho-1))/2/(\rho-1)</code>.
</p>


<h3>Value</h3>

<p>a <code>VTTRUEPS</code> object containing all <code class="reqn">\theta</code>'s in a matrix
with its number of rows equaling the number of dose levels and its number
of columns being 4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> rst.sce &lt;- vtScenario(tox=c(0.05, 0.05, 0.08), res=c(0.2, 0.3, 0.5), rho=1)

</code></pre>

<hr>
<h2 id='vtShiny'>Run Web-Based <code>visit</code> application</h2><span id='topic+vtShiny'></span>

<h3>Description</h3>

<p>Call Shiny to run <code>visit</code> as a web-based application.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtShiny()
</code></pre>


<h3>Details</h3>

<p>A web browser will be brought up for users to access the GUI of <code><a href="#topic+visit">visit</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
vtShiny()
## End(Not run)

</code></pre>

<hr>
<h2 id='vtSimu'>Conduct simulation study</h2><span id='topic+vtSimu'></span>

<h3>Description</h3>

<p>Simulate clinical trials with given settings for multiple times to evaluate
the study operating characteristics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtSimu(n.rep = 100, seed = NULL, ..., n.cores = 1,
  update.progress = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtSimu_+3A_n.rep">n.rep</code></td>
<td>
<p>Number of repetitions</p>
</td></tr>
<tr><td><code id="vtSimu_+3A_seed">seed</code></td>
<td>
<p>Seed</p>
</td></tr>
<tr><td><code id="vtSimu_+3A_...">...</code></td>
<td>
<p>Optional parameters for <code><a href="#topic+vtSingleTrial">vtSingleTrial</a></code></p>
</td></tr>
<tr><td><code id="vtSimu_+3A_n.cores">n.cores</code></td>
<td>
<p>Number of cores for parallel computations</p>
</td></tr>
<tr><td><code id="vtSimu_+3A_update.progress">update.progress</code></td>
<td>
<p>Reserved parameter for Shiny GUI</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A class <code>VTSIMU</code> list with length <code>n.rep</code> of results. Each item is
a list return from <code><a href="#topic+vtSingleTrial">vtSingleTrial</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)

rst.simu  &lt;- vtSimu(n.rep = 100, n.cors = 2, trueps = rst.sce,
                    size.cohort=3, size.level=12, prob.mdl="NONPARA");


</code></pre>

<hr>
<h2 id='vtSingleTrial'>Simulate a single trial</h2><span id='topic+vtSingleTrial'></span>

<h3>Description</h3>

<p>Simulation function for simulating a single trial
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtSingleTrial(trueps, size.cohort = 3, size.level = NULL,
  etas = c(0.1, 0.3), dec.cut = 0.65, prob.mdl = c("NONPARA",
  "NONPARA+", "PARA", "PARA+"), priors = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtSingleTrial_+3A_trueps">trueps</code></td>
<td>
<p>True <code class="reqn">\theta</code>'s. A <code>VTTRUEPS</code> object made from
<code><a href="#topic+vtScenario">vtScenario</a></code></p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_size.cohort">size.cohort</code></td>
<td>
<p>Size of each cohort</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_size.level">size.level</code></td>
<td>
<p>Maximum number of patients for each dose level</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_etas">etas</code></td>
<td>
<p>Vector of length 2 representing <code class="reqn">(p_L, p_U)</code>. <code class="reqn">p_L</code>: lower
bound of DLT risk, below which the current dose is considered absolutely
safe; <code class="reqn">p_U</code>: upper bound of DLT risk above which the current dose is
considered too toxic</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_dec.cut">dec.cut</code></td>
<td>
<p>Thresholds <code class="reqn">C_1,C_2,C_3</code>. If the vector length is shorter
than <code class="reqn">3</code>, it is repeated to have <code class="reqn">3</code> elements. See
<code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_prob.mdl">prob.mdl</code></td>
<td>
<p>Option of the probability models:
</p>
<ul>
<li><p>NONPARA: non-parametric+ model
</p>
</li>
<li><p>NONPARA+: non-parametric model
</p>
</li>
<li><p>PARA: partially parametric model
</p>
</li>
<li><p>PARA+: partially parametric+ model </p>
</li></ul>

<p>Default value is <code>NONPARA</code>. See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_priors">priors</code></td>
<td>
<p>A class <code>VTPRIOR</code> object created by
<code><a href="#topic+vtPriorPar">vtPriorPar</a></code> for <code>PARA</code> and <code>PARA+</code> model.</p>
</td></tr>
<tr><td><code id="vtSingleTrial_+3A_...">...</code></td>
<td>
<p>Optional arguments for <code>vtPost</code></p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li><p><code>dose</code>: Optimal dose level
</p>
</li>
<li><p><code>n.patients</code>: Number of patients for each dose level and each cohort
</p>
</li>
<li><p><code>ptox</code>: Posterior mean of DLT risk rate after each interim analysis
</p>
</li>
<li><p><code>pres</code>: Posterior mean of immune response rate after each interim analysis
</p>
</li>
<li><p><code>region</code>: Identified region in the decision map after each interim analysis
</p>
</li>
<li><p><code>prob</code>: Posterior mean of <code class="reqn">\theta</code>'s after each interim analysis
</p>
</li>
<li><p><code>smps</code>: Observed data after each cohort
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>rst.sce &lt;- vtScenario(tox = c(0.05, 0.05, 0.08),
                      res = c(0.2, 0.3, 0.5),
                      rho = 1)
rst.simu  &lt;- vtSingleTrial(trueps = rst.sce, size.cohort=3, size.level=12,
                           prob.mdl="NONPARA");

</code></pre>

<hr>
<h2 id='vtStan'>Call STAN models for MCMC sampling</h2><span id='topic+vtStan'></span>

<h3>Description</h3>

<p>Call STAN to draw posterior samples of the joint distribution of
immunogenicity rate and toxicity risk for parametric and parametric+ model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtStan(obs.y, priors, model = 0, iter = 4000, chains = 4,
  warmup = 2000, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtStan_+3A_obs.y">obs.y</code></td>
<td>
<p>Observed data matrix with <code class="reqn">l</code> rows and 4 columns. Row <code class="reqn">k</code> in the matrix
represents the observed data from dose level <code class="reqn">k</code>. The columns are
</p>

<ul>
<li><p>column 1: number of patient with no DLT, no immune response
</p>
</li>
<li><p>column 2: number of patient with no DLT, immune response
</p>
</li>
<li><p>column 3: number of patient with DLT, no immune response
</p>
</li>
<li><p>column 4: number of patient with DLT, immune response
</p>
</li></ul>
</td></tr>
<tr><td><code id="vtStan_+3A_priors">priors</code></td>
<td>
<p>A class <code>VTPRIOR</code> object created by
<code><a href="#topic+vtPriorPar">vtPriorPar</a></code> for <code>PARA</code> and <code>PARA+</code> model.</p>
</td></tr>
<tr><td><code id="vtStan_+3A_model">model</code></td>
<td>
<p>option of the probability models:
</p>

<dl>
<dt>0:</dt><dd><p>parametric model</p>
</dd>
<dt>1:</dt><dd><p>parametric+ model</p>
</dd>
</dl>

<p>See <code><a href="#topic+visit">visit</a></code> for details.</p>
</td></tr>
<tr><td><code id="vtStan_+3A_iter">iter</code></td>
<td>
<p>STAN option: number of iterations</p>
</td></tr>
<tr><td><code id="vtStan_+3A_chains">chains</code></td>
<td>
<p>STAN option: number of chains</p>
</td></tr>
<tr><td><code id="vtStan_+3A_warmup">warmup</code></td>
<td>
<p>STAN option: number of warmup</p>
</td></tr>
<tr><td><code id="vtStan_+3A_...">...</code></td>
<td>
<p>additional parameters for package rstan's sampling method. These
options include <code>iter</code>, <code>warmup</code>, <code>thin</code>,
<code>algorithm</code>. See <code>rstan::sampling</code> for details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>rstan</code> object that contains the posterior sampling results
</p>

<hr>
<h2 id='vtTrack'>Plot the track plot of dose escalation</h2><span id='topic+vtTrack'></span>

<h3>Description</h3>

<p>Generate a plot representing the observed data and dose escalation decisions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vtTrack(obs.all, cex.txt = 0.9, decision = 1, max.level = NULL,
  letters = c("E", "C", "S"), colors = c("green", "yellow", "red"),
  height = 0.5, end.width = 2, end.height = height,
  cex.roman = 0.9, cex.end = 0.9, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vtTrack_+3A_obs.all">obs.all</code></td>
<td>
<p>All observations collected in a matrix with 5 columns. Column
1 is the index of interim analysis starting from 1. Columns 2-5
correspond to columns 1-4 in <code>obs.y</code> for <code><a href="#topic+vtPost">vtPost</a></code>.</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_cex.txt">cex.txt</code></td>
<td>
<p>Text size of numbers in the plot</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_decision">decision</code></td>
<td>
<p>Dose escalation decision. The options are
</p>

<ul>
<li><p><code>1</code>: Escalate
</p>
</li>
<li><p><code>2</code>: Continue at the same level
</p>
</li>
<li><p><code>3</code>: Stop the trial
</p>
</li></ul>
</td></tr>
<tr><td><code id="vtTrack_+3A_max.level">max.level</code></td>
<td>
<p>Maximum number of dose levels shown in the plot</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_letters">letters</code></td>
<td>
<p>Labels for dose escalation actions 1-3. Default values are
&quot;E&quot;, &quot;C&quot;, &quot;S&quot;</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_colors">colors</code></td>
<td>
<p>Possible colors in the last action box</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_height">height</code></td>
<td>
<p>Height of each individual box</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_end.width">end.width</code></td>
<td>
<p>Width of the last action box</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_end.height">end.height</code></td>
<td>
<p>Height of the last action box</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_cex.roman">cex.roman</code></td>
<td>
<p>Text size of the roman numerals</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_cex.end">cex.end</code></td>
<td>
<p>Text size of the letter in the last action box</p>
</td></tr>
<tr><td><code id="vtTrack_+3A_...">...</code></td>
<td>
<p>Optional arguments for <code>plot</code>.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
obs.all  &lt;- rbind(c(1, 5, 2, 0, 0),
                  c(2, 3, 4, 0, 0),
                  c(3, 1, 6, 0, 0));
vtTrack(obs.all, end.width = 0.8, max.level = 3, decision = 3);

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
