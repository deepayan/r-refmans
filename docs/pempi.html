<!DOCTYPE html><html><head><title>Help for package pempi</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {pempi}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#conditional_mle'><p>Compute MLE based on the full information R1, R2, R3 and R4.</p></a></li>
<li><a href='#covid19_austria'><p>COVID-19 Data from Statistics Austria</p></a></li>
<li><a href='#get_prob'><p>Compute sucess probabilities (tau_j's)</p></a></li>
<li><a href='#log_modified'><p>Modified log function (internal function)</p></a></li>
<li><a href='#marginal_mle'><p>Compute (marginalized) MLE based on the partial information R1 and R3.</p></a></li>
<li><a href='#moment_estimator'><p>Compute moment-based estimator.</p></a></li>
<li><a href='#neg_log_lik'><p>Negative Log-Likelihood function</p></a></li>
<li><a href='#neg_log_lik_integrated'><p>Negative marginalized log-likelihood function based on R0 and R</p></a></li>
<li><a href='#neg_log_wlik'><p>Negative Weighted Log-Likelihood function</p></a></li>
<li><a href='#print.cpreval'><p>Print estimation results</p></a></li>
<li><a href='#print.cpreval_sim'><p>Print (simulated) sample</p></a></li>
<li><a href='#sim_Rs'><p>Simulate data (R, R0, R1, R2, R3 and R4)</p></a></li>
<li><a href='#survey_mle'><p>Compute proportion in the survey sample (standard estimator)</p></a></li>
<li><a href='#update_prevalence'><p>Update prevalence using new case prevalence rates</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Proportion Estimation with Marginal Proxy Information</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-09-15</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Stéphane Guerrier &lt;stef.guerrier@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>A system contains easy-to-use tools for the conditional estimation of the prevalence of an emerging or rare infectious diseases using the methods proposed in Guerrier et al. (2023) &lt;<a href="https://doi.org/10.48550/arXiv.2012.10745">doi:10.48550/arXiv.2012.10745</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/AGPL-3">AGPL-3</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stephaneguerrier/pempi">https://github.com/stephaneguerrier/pempi</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stephaneguerrier/pempi/issues">https://github.com/stephaneguerrier/pempi/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-10-06 10:37:38 UTC; stephaneguerrier</td>
</tr>
<tr>
<td>Author:</td>
<td>Stéphane Guerrier [aut, cre],
  Maria-Pia Victoria-Feser [aut],
  Christoph Kuzmics [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-10-09 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='conditional_mle'>Compute MLE based on the full information R1, R2, R3 and R4.</h2><span id='topic+conditional_mle'></span>

<h3>Description</h3>

<p>Proportion estimated using the MLE and confidence intervals based the asymptotic distribution of the estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>conditional_mle(
  R1 = NULL,
  R2 = NULL,
  R3 = NULL,
  R4 = NULL,
  n = R1 + R2 + R3 + R4,
  pi0,
  gamma = 0.05,
  alpha0 = 0,
  alpha = 0,
  beta = 0,
  V = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="conditional_mle_+3A_r1">R1</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that were tested positive with both (medical) testing devices (and are, thus, members of the sub-population).</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_r2">R2</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that are tested positive only with the first testing device (and are, thus,  members of the sub-population).</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_r3">R3</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that are tested positive only with the second testing device.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_r4">R4</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants that are tested negative with the second testing device (and are either members of the sub-population and have tested negative with the first testing device or are not members of the sub-population).</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size. Default value R1 + R2 + R3 + R4. If this value is provided it is used to verify that R1 + R2 + R3 + R4 = n.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_gamma">gamma</code></td>
<td>
<p>A <code>numeric</code> that is used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_v">V</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the average of squared sampling weights. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="conditional_mle_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cpreval</code> object with the structure:
</p>

<ul>
<li><p> estimate:    Estimated proportion.
</p>
</li>
<li><p> sd:          Estimated standard error of the estimator.
</p>
</li>
<li><p> ci_asym:     Asymptotic confidence interval at the 1 - gamma confidence level.
</p>
</li>
<li><p> gamma:       Confidence level (i.e. 1 - gamma) for confidence intervals.
</p>
</li>
<li><p> method:      Estimation method (in this case mle).
</p>
</li>
<li><p> measurement: A vector with (alpha0, alpha, beta).
</p>
</li>
<li><p> beta0:       Estimated false negative rate of the official procedure.
</p>
</li>
<li><p> ci_beta0:    Asymptotic confidence interval (1 - gamma confidence level) for beta0.
</p>
</li>
<li><p> boundary:    A boolean variable indicating if the estimates falls at the boundary of the parameter space.
</p>
</li>
<li><p> pi0:         Value of pi0 (input value).
</p>
</li>
<li><p> sampling:    Type of sampling considered (&quot;random&quot; or &quot;weighted&quot;).
</p>
</li>
<li><p> V:           Average sum of squared sampling weights if weighted/stratified is used (otherwise NULL).
</p>
</li>
<li><p> n:           Sample size.
</p>
</li>
<li><p> avar_beta0:  Estimated asymptotic variance of beta0
</p>
</li>
<li><p> ...:         Additional parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Stephane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)
conditional_mle(R1 = X$R1, R2 = X$R2, R3 = X$R3, R4 = X$R4, pi0 = X$pi0)

# With measurement error
X = sim_Rs(theta = 30/1000, pi0 = 10/1000, n = 1500, alpha0 = 0.001,
alpha = 0.01, beta0 = 0.05, beta = 0.05, seed = 18)
conditional_mle(R1 = X$R1, R2 = X$R2, R3 = X$R3, R4 = X$R4, pi0 = X$pi0)
conditional_mle(R1 = X$R1, R2 = X$R2, R3 = X$R3, R4 = X$R4, pi0 = X$pi0,
alpha0 = 0.001, alpha = 0.01, beta = 0.05)
</code></pre>

<hr>
<h2 id='covid19_austria'>COVID-19 Data from Statistics Austria</h2><span id='topic+covid19_austria'></span>

<h3>Description</h3>

<p>Data collected in Austria in 2020 (see e.g. SORA, 2020; Kowarik et al., 2021, for more details),
allowing to estimate COVID-19 prevalence.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>covid19_austria
</code></pre>


<h3>Format</h3>

<p>A <code>matrix</code> with 2290 rows and 3 variables:
</p>

<dl>
<dt>Y</dt><dd><p>Binary variable, 1 if participant i is tested positive in the survey sample, 0 otherwise.</p>
</dd>
<dt>Z</dt><dd><p>Binary variable, 1 if participant i was declared positive with the official procedure, 0 otherwise.</p>
</dd>
<dt>weights</dt><dd><p>Sampling weights.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Statistics Austria. 2020. &quot;Prävalenz von SARS-CoV-2-Infektionen liegt bei 0.031.&quot;
</p>

<hr>
<h2 id='get_prob'>Compute sucess probabilities (tau_j's)</h2><span id='topic+get_prob'></span>

<h3>Description</h3>

<p>Compute joint probabilities of P(W = j, Y = k) for j, k = 0, 1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_prob(theta, pi0, alpha, beta, alpha0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="get_prob_+3A_theta">theta</code></td>
<td>
<p>A <code>numeric</code> that provides the true prevalence of a given disease.</p>
</td></tr>
<tr><td><code id="get_prob_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="get_prob_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R.</p>
</td></tr>
<tr><td><code id="get_prob_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R.</p>
</td></tr>
<tr><td><code id="get_prob_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>vector</code> containing tau1, tau2, tau3 and tau4.
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>prob1 = get_prob(theta = 0.02, pi0 = 0.01, alpha = 0, beta = 0, alpha0 = 0)
prob1
sum(prob1)

prob2 = get_prob(theta = 0.02, pi0 = 0.01, alpha = 0.001, beta = 0, alpha0 = 0.001)
prob2
sum(prob2)
</code></pre>

<hr>
<h2 id='log_modified'>Modified log function (internal function)</h2><span id='topic+log_modified'></span>

<h3>Description</h3>

<p>Simple function that return log(x) if x &gt; 0 and 0 otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>log_modified(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="log_modified_+3A_x">x</code></td>
<td>
<p>A <code>numeric</code> value assumed such that x &gt;= 0.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Modified log function
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>

<hr>
<h2 id='marginal_mle'>Compute (marginalized) MLE based on the partial information R1 and R3.</h2><span id='topic+marginal_mle'></span>

<h3>Description</h3>

<p>Proportion estimated using the MLE and confidence intervals based the asymptotic distribution of the estimator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marginal_mle(
  R1,
  R3,
  n,
  pi0,
  gamma = 0.05,
  alpha = 0,
  beta = 0,
  alpha0 = 0,
  V = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marginal_mle_+3A_r1">R1</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that were tested positive with both (medical) testing devices (and are, thus, members of the sub-population).</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_r3">R3</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that are tested positive only with the second testing device.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_gamma">gamma</code></td>
<td>
<p>A <code>numeric</code> that is used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_v">V</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the average of squared sampling weights. Default value is <code>NULL</code> and
for the moment this method is currently only implemented for random sampling.</p>
</td></tr>
<tr><td><code id="marginal_mle_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cpreval</code> object with the structure:
</p>

<ul>
<li><p> estimate:    Estimated proportion.
</p>
</li>
<li><p> sd:          Estimated standard error of the estimator.
</p>
</li>
<li><p> ci_asym:     Asymptotic confidence interval at the 1 - gamma confidence level.
</p>
</li>
<li><p> gamma:       Confidence level (i.e. 1 - gamma) for confidence intervals.
</p>
</li>
<li><p> method:      Estimation method (in this case marginal mle).
</p>
</li>
<li><p> measurement: A vector with (alpha0, alpha, beta).
</p>
</li>
<li><p> beta0:       Estimated false negative rate of the official procedure.
</p>
</li>
<li><p> ci_beta0:    Asymptotic confidence interval (1 - gamma confidence level) for beta0.
</p>
</li>
<li><p> boundary:    A boolean variable indicating if the estimates falls at the boundary of the parameter space.
</p>
</li>
<li><p> pi0:         Value of pi0 (input value).
</p>
</li>
<li><p> sampling:    Type of sampling considered (&quot;random&quot; or &quot;weighted&quot;).
</p>
</li>
<li><p> V:           Average sum of squared sampling weights if weighted/stratified is used (otherwise NULL).
</p>
</li>
<li><p> n:           Sample size.
</p>
</li>
<li><p> avar_beta0:  Estimated asymptotic variance of beta0
</p>
</li>
<li><p> ...:         Additional parameters
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Stephane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)
conditional_mle(R1 = X$R1, R2 = X$R2, R3 = X$R3, R4 = X$R4, n = X$n, pi0 = X$pi0)

# With measurement error
X = sim_Rs(theta = 30/1000, pi0 = 10/1000, n = 1500, alpha0 = 0.001,
alpha = 0.01, beta0 = 0.05, beta = 0.05, seed = 18)
marginal_mle(R1 = X$R1, R3 = X$R3, n = X$n, pi0 = X$pi0)
marginal_mle(R1 = X$R1, R3 = X$R3, n = X$n, pi0 = X$pi0,
alpha0 = 0.001, alpha = 0.01, beta0 = 0.05, beta = 0.05)
</code></pre>

<hr>
<h2 id='moment_estimator'>Compute moment-based estimator.</h2><span id='topic+moment_estimator'></span>

<h3>Description</h3>

<p>Proportion estimated using the moment-based estimator and confidence intervals based the asymptotic distribution of the estimator as well as
the Clopper-Pearson approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>moment_estimator(
  R3,
  n,
  pi0,
  gamma = 0.05,
  alpha = 0,
  beta = 0,
  alpha0 = 0,
  V = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="moment_estimator_+3A_r3">R3</code></td>
<td>
<p>A <code>numeric</code> that provides the number of participants in the survey sample that are tested positive only with the second testing device.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_gamma">gamma</code></td>
<td>
<p>A <code>numeric</code> that is used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_v">V</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the average of squared sampling weights. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="moment_estimator_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cpreval</code> object with the structure:
</p>

<ul>
<li><p> estimate:    Estimated proportion.
</p>
</li>
<li><p> sd:          Estimated standard error of the estimator.
</p>
</li>
<li><p> ci_asym:     Asymptotic confidence interval at the 1 - gamma confidence level.
</p>
</li>
<li><p> ci_cp:       Confidence interval (1 - gamma confidence level) based on the Clopper-Pearson approach.
</p>
</li>
<li><p> gamma:       Confidence level (i.e. 1 - gamma) for confidence intervals.
</p>
</li>
<li><p> method:      Estimation method (in this case moment estimator).
</p>
</li>
<li><p> measurement: A vector with (alpha0, alpha, beta).
</p>
</li>
<li><p> beta0:       Estimated false negative rate of the official procedure.
</p>
</li>
<li><p> ci_beta0:    Asymptotic confidence interval (1 - gamma confidence level) for beta0.
</p>
</li>
<li><p> boundary:    A boolean variable indicating if the estimates falls at the boundary of the parameter space.
</p>
</li>
<li><p> pi0:         Value of pi0 (input value).
</p>
</li>
<li><p> sampling:    Type of sampling considered (&quot;random&quot; or &quot;weighted&quot;).
</p>
</li>
<li><p> V:           Average sum of squared sampling weights if weighted/stratified is used (otherwise NULL).
</p>
</li>
<li><p> n:           Sample size.
</p>
</li>
<li><p> avar_beta0:  Estimated asymptotic variance of beta0
</p>
</li>
<li><p> ...:         Additional parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Stephane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0)

# With measurement error
X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, alpha0 = 0.001,
alpha = 0.01, beta = 0.05, seed = 18)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0)
moment_estimator(R3 = X$R3, n = X$n, pi0 = X$pi0, alpha0 = 0.001,
alpha = 0.01, beta = 0.05)
</code></pre>

<hr>
<h2 id='neg_log_lik'>Negative Log-Likelihood function</h2><span id='topic+neg_log_lik'></span>

<h3>Description</h3>

<p>Log-Likelihood function based on R1, R2, R3 and R4 multiplied by -1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neg_log_lik(theta, Rvect, n, pi0, alpha, beta, alpha0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neg_log_lik_+3A_theta">theta</code></td>
<td>
<p>A <code>numeric</code> value for the paramerer of interest.</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_rvect">Rvect</code></td>
<td>
<p>A <code>vector</code> of observations, i.e. (R1, R2, R3, R4).</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero.</p>
</td></tr>
<tr><td><code id="neg_log_lik_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Negative log-likelihood.
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>

<hr>
<h2 id='neg_log_lik_integrated'>Negative marginalized log-likelihood function based on R0 and R</h2><span id='topic+neg_log_lik_integrated'></span>

<h3>Description</h3>

<p>Log-Likelihood function based on R1 and R3 multiplied by -1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neg_log_lik_integrated(theta, Rvect, n, pi0, alpha0, alpha, beta, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neg_log_lik_integrated_+3A_theta">theta</code></td>
<td>
<p>A <code>numeric</code> value for the paramerer of interest.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_rvect">Rvect</code></td>
<td>
<p>A <code>vector</code> of observations, i.e. (R1, R2, R3, R4), but R2 and R4 are NOT used.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_lik_integrated_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Negative marginalized log-likelihood.
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>

<hr>
<h2 id='neg_log_wlik'>Negative Weighted Log-Likelihood function</h2><span id='topic+neg_log_wlik'></span>

<h3>Description</h3>

<p>Log-Likelihood function based on R1, R2, R3 and R4 with sampling weights multiplied by -1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>neg_log_wlik(theta, Rvect, n, pi0, alpha, beta, alpha0, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="neg_log_wlik_+3A_theta">theta</code></td>
<td>
<p>A <code>numeric</code> value for the paramerer of interest.</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_rvect">Rvect</code></td>
<td>
<p>A <code>vector</code> of observations, i.e. (R1, R2, R3, R4).</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R.</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero.</p>
</td></tr>
<tr><td><code id="neg_log_wlik_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Negative log-likelihood.
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>

<hr>
<h2 id='print.cpreval'>Print estimation results</h2><span id='topic+print.cpreval'></span>

<h3>Description</h3>

<p>Simple print function for the four estimators (i.e. mle, conditional mle, moment based and survey sample).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cpreval'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cpreval_+3A_x">x</code></td>
<td>
<p>A <code>cpreval</code> object</p>
</td></tr>
<tr><td><code id="print.cpreval_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints object
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>


<h3>Examples</h3>

<pre><code class='language-R'>X = sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)
survey_mle(X$R, X$n)
</code></pre>

<hr>
<h2 id='print.cpreval_sim'>Print (simulated) sample</h2><span id='topic+print.cpreval_sim'></span>

<h3>Description</h3>

<p>Simple print function for the <code>cpreval_sim</code> objects
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cpreval_sim'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.cpreval_sim_+3A_x">x</code></td>
<td>
<p>A <code>cpreval_sim</code> object</p>
</td></tr>
<tr><td><code id="print.cpreval_sim_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints object
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)

# With measurement error
sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, alpha0 = 0,
alpha = 0.01, beta = 0.05, seed = 18)
</code></pre>

<hr>
<h2 id='sim_Rs'>Simulate data (R, R0, R1, R2, R3 and R4)</h2><span id='topic+sim_Rs'></span>

<h3>Description</h3>

<p>Simulation function for random variables of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim_Rs(theta, pi0, n, alpha0 = 0, alpha = 0, beta = 0, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sim_Rs_+3A_theta">theta</code></td>
<td>
<p>A <code>numeric</code> that provides the true prevalence of a given disease.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection).</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the sample size.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_alpha0">alpha0</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the probability that a random participant
has been incorrectly declared positive through the nontransparent procedure. In most applications,
this probability is likely very close to zero. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_seed">seed</code></td>
<td>
<p>A <code>numeric</code> that provides the simulation seed. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="sim_Rs_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cpreval_sim</code> object (<code>list</code>) with the structure:
</p>

<ul>
<li><p> R:      the number of participants in the survey sample that were tested positive.
</p>
</li>
<li><p> R0:     the number of participants in the survey sample that were tested positive with the first testing device (and are, thus,  members of the sub-population).
</p>
</li>
<li><p> R1:     the number of participants in the survey sample that were tested positive with both (medical) testing devices (and are, thus, members of the sub-population).
</p>
</li>
<li><p> R2:     the number of participants in the survey sample that are tested positive only with the first testing device (and are, thus,  members of the sub-population).
</p>
</li>
<li><p> R3:     the number of participants in the survey sample that are tested positive only with the second testing device.
</p>
</li>
<li><p> R4:     the number of participants that are tested negative with the second testing device (and are either members of the sub-population and have tested negative with the first testing device or are not members of the sub-population).
</p>
</li>
<li><p> n:      the sample size.
</p>
</li>
<li><p> alpha:  the False Negative (FN) rate for the sample R.
</p>
</li>
<li><p> beta:   the False Positive (FP) rate for the sample R.
</p>
</li>
<li><p> alpha0: the alpha0 probability (as defined above).
</p>
</li>
<li><p> ...:    additional arguments.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, seed = 18)

# With measurement error
sim_Rs(theta = 3/100, pi0 = 1/100, n = 1500, alpha0 = 0,
alpha = 0.01, beta = 0.05, seed = 18)
</code></pre>

<hr>
<h2 id='survey_mle'>Compute proportion in the survey sample (standard estimator)</h2><span id='topic+survey_mle'></span>

<h3>Description</h3>

<p>Proportion estimated using the survey sample and confidence intervals based on the Clopper-Pearson and the standard
asymptotic approach.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>survey_mle(R, n, pi0 = 0, alpha = 0, beta = 0, gamma = 0.05, V = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="survey_mle_+3A_r">R</code></td>
<td>
<p>A <code>numeric</code> that provides the people of positive people in the sample.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_n">n</code></td>
<td>
<p>A <code>numeric</code> that provides the sample size.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_pi0">pi0</code></td>
<td>
<p>A <code>numeric</code> that provides the prevalence or proportion of people (in the whole population) who are positive, as measured through a non-random,
but systematic sampling (e.g. based on medical selection). Default value is <code>0</code> and in this case this information is not used in the estimation procedure.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_alpha">alpha</code></td>
<td>
<p>A <code>numeric</code> that provides the False Negative (FN) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_beta">beta</code></td>
<td>
<p>A <code>numeric</code> that provides the False Positive (FP) rate for the sample R. Default value is <code>0</code>.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_gamma">gamma</code></td>
<td>
<p>A <code>numeric</code> that is used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_v">V</code></td>
<td>
<p>A <code>numeric</code> that corresponds to the average of squared sampling weights. Default value is <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="survey_mle_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>cpreval</code> object with the structure:
</p>

<ul>
<li><p> estimate:    Estimated proportion.
</p>
</li>
<li><p> sd:          Estimated standard error of the estimator.
</p>
</li>
<li><p> ci_asym:     Asymptotic confidence interval at the 1 - gamma confidence level.
</p>
</li>
<li><p> gamma:       Confidence level (i.e. 1 - gamma) for confidence intervals.
</p>
</li>
<li><p> method:      Estimation method (in this case sample survey).
</p>
</li>
<li><p> measurement: A vector with (alpha0, alpha, beta).
</p>
</li>
<li><p> boundary:    A boolean variable indicating if the estimates falls at the boundary of the parameter space.
</p>
</li>
<li><p> pi0:         Value of pi0 (input value).
</p>
</li>
<li><p> sampling:    Type of sampling considered (&quot;random&quot; or &quot;weighted&quot;).
</p>
</li>
<li><p> V:           Average sum of squared sampling weights if weighted/stratified is used (otherwise NULL).
</p>
</li>
<li><p> ...:         Additional parameters.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Stephane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Samples without measurement error
X = sim_Rs(theta = 30/1000, pi0 = 10/1000, n = 1500, seed = 18)
survey_mle(R = X$R, n = X$n)

# With measurement error
X = sim_Rs(theta = 30/1000, pi0 = 10/1000, n = 1500, alpha = 0.01, beta = 0.05, seed = 18)
survey_mle(R = X$R, n = X$n)
survey_mle(R = X$R, n = X$n, alpha = 0.01, beta = 0.05)
</code></pre>

<hr>
<h2 id='update_prevalence'>Update prevalence using new case prevalence rates</h2><span id='topic+update_prevalence'></span>

<h3>Description</h3>

<p>Updated prevalence and confidence intervals using new case prevalence rates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>update_prevalence(
  pi0_new,
  x,
  gamma = 0.05,
  print = NULL,
  plot = NULL,
  col_line = "#2e5dc1",
  col_ci = "#2E5DC133",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="update_prevalence_+3A_pi0_new">pi0_new</code></td>
<td>
<p>A <code>numeric</code> or <code>vector</code> of new case prevalence rates</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_x">x</code></td>
<td>
<p>A <code>cpreval</code> object.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_gamma">gamma</code></td>
<td>
<p>A <code>numeric</code> that used to compute a (1 - gamma) confidence region for the proportion. Default value is <code>0.05</code>.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_print">print</code></td>
<td>
<p>A <code>boolean</code> indicating whether or not the output should be print.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_plot">plot</code></td>
<td>
<p>A <code>boolean</code> indicating whether or not a plot should be made.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_col_line">col_line</code></td>
<td>
<p>Color of the estimated prevalence.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_col_ci">col_ci</code></td>
<td>
<p>Color of the estimated prevalence confidence interval.</p>
</td></tr>
<tr><td><code id="update_prevalence_+3A_...">...</code></td>
<td>
<p>Additional arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>matrix</code> object whose colunms corresponds to pi0, estimate, sd and CI.
</p>


<h3>Author(s)</h3>

<p>Stephane Guerrier
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Austrian data (November 2020)
pi0 = 93914/7166167
data("covid19_austria")

# Weighted sampling
n = nrow(covid19_austria)
R1w = sum(covid19_austria$weights[covid19_austria$Y == 1 &amp; covid19_austria$Z == 1])
R2w = sum(covid19_austria$weights[covid19_austria$Y == 0 &amp; covid19_austria$Z == 1])
R3w = sum(covid19_austria$weights[covid19_austria$Y == 1 &amp; covid19_austria$Z == 0])
R4w = sum(covid19_austria$weights[covid19_austria$Y == 0 &amp; covid19_austria$Z == 0])

# Assumed measurement errors
alpha0 = 0
alpha = 1/100
beta = 10/100

# MME
mme = moment_estimator(R3 = R3w, n = n, pi0 = pi0, alpha = alpha, beta = beta,
                       alpha0 = alpha0, V = mean(covid19_austria$weights^2))

mme

# Update prevalence using a new pi0, say = 1.5%, instead of 1.31%
update_prevalence(1.5/100, mme)

pi0_new = seq(from = 0.005, to = 0.03, length.out = 100)
update_prevalence(pi0_new, mme)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
