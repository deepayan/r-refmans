<!DOCTYPE html><html lang="en"><head><title>Help for package cosimmr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {cosimmr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cosimmr'><p>cosimmr: An R package for Stable Isotope Mixing Models</p></a></li>
<li><a href='#alligator_data'><p>Alligator Data</p></a></li>
<li><a href='#cladocera_data'><p>Cladocera data from Galloway et al 2015.</p></a></li>
<li><a href='#cosimmr_ffvb'><p>Run a <code>cosimmr_input</code> object through the Fixed Form Variational</p>
Bayes(FFVB) function</a></li>
<li><a href='#cosimmr_load'><p>Function to load in cosimmr data and check for errors</p></a></li>
<li><a href='#geese_data'><p>Geese stable isotope mixing data set</p></a></li>
<li><a href='#geese_data_day1'><p>A smaller version of the Geese stable isotope mixing data set</p></a></li>
<li><a href='#iso_data'><p>Isopod Data</p></a></li>
<li><a href='#plot.cosimmr_input'><p>Plot the <code>cosimmr_input</code> data created from <code>cosimmr_load</code></p></a></li>
<li><a href='#plot.cosimmr_output'><p>Plot different features of an object created from  <code>cosimmr_ffvb</code>.</p></a></li>
<li><a href='#plot.cosimmr_pred_out'><p>Plot different features of an object created from  <code>cosimmr_ffvb</code>.</p></a></li>
<li><a href='#posterior_predictive'><p>Plot the posterior predictive distribution for a cosimmr run</p></a></li>
<li><a href='#predict.cosimmr_output'><p>Predicts proportion of each source in a mixture, based on values provided for covariates</p></a></li>
<li><a href='#print.cosimmr_input'><p>Print simmr input object</p></a></li>
<li><a href='#print.cosimmr_output'><p>Print a simmr output object</p></a></li>
<li><a href='#prior_viz'><p>Plot the prior distribution for a cosimmr run</p></a></li>
<li><a href='#simmr_data_1'><p>A simple fake stable isotope mixing data set</p></a></li>
<li><a href='#simmr_data_2'><p>A 3-isotope fake stable isotope mixing data set</p></a></li>
<li><a href='#square_data'><p>An artificial data set used to indicate effect of priors</p></a></li>
<li><a href='#summary.cosimmr_output'><p>Summarises the output created with <code>cosimmr_ffvb</code></p></a></li>
<li><a href='#summary.cosimmr_pred_out'><p>Summarises the output created with <code>cosimmr_ffvb</code></p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fast Fitting of Stable Isotope Mixing Models with Covariates</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.12</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-05-31</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/emmagovan/cosimmr">https://github.com/emmagovan/cosimmr</a>,
<a href="https://emmagovan.github.io/cosimmr/">https://emmagovan.github.io/cosimmr/</a></td>
</tr>
<tr>
<td>Description:</td>
<td>Fast fitting of Stable Isotope Mixing Models in R. Allows for the inclusion of covariates. Also has built-in summary functions and plot functions which allow for the creation of isospace plots. Variational Bayes is used to fit these models, methods as described in: Tran et al., (2021) &lt;<a href="https://doi.org/10.48550%2FarXiv.2103.01327">doi:10.48550/arXiv.2103.01327</a>&gt;. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 1.0.10), R2jags, bayesplot, checkmate, ggplot2,
viridis, reshape2, stats, ggnewscale</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo, RcppDist</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, readxl</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-05-31 12:14:41 UTC; emmagovan</td>
</tr>
<tr>
<td>Author:</td>
<td>Emma Govan [cre, aut],
  Andrew Parnell [aut],
  Ahmed Shalaby [ctb],
  Alan Inglis [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Emma Govan &lt;emmagovan@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-05-31 13:50:23 UTC</td>
</tr>
</table>
<hr>
<h2 id='cosimmr'>cosimmr: An R package for Stable Isotope Mixing Models</h2><span id='topic+cosimmr'></span><span id='topic+cosimmr-package'></span>

<h3>Description</h3>

<p>cosimmr is a package that has been developed to allow for running of Stable 
Isotope Mixing Models in R. It allows for the inclusion of covariates and 
has been designed to be easy to use for non-expert users. cosimmr uses Fixed
Form Variational Bayes to run SIMMs, instead of MCMC. This allows for faster
running of models without any issues with convergence
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell
</p>

<hr>
<h2 id='alligator_data'>Alligator Data</h2><span id='topic+alligator_data'></span>

<h3>Description</h3>

<p>Dataset from Nifong et al 2015 which contains 2 food sources, 181 individuals and 2 isotopes. This dataset includes multiple covariates as well as TDF means and sds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alligator_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>ID</dt><dd><p>A character vector of unique ID values</p>
</dd>
<dt>tag_ID</dt><dd><p>A character vector of tag ID</p>
</dd>
<dt>lat</dt><dd><p>A numeric vector of latitude</p>
</dd>
<dt>long</dt><dd><p>A numeric vector of longitude</p>
</dd>
<dt>date</dt><dd><p>A character vector of date</p>
</dd>
<dt>year</dt><dd><p>A numeric vector of year</p>
</dd>
<dt>habitat</dt><dd><p>A character vector of habitat</p>
</dd>
<dt>sex</dt><dd><p>A character vector of sex</p>
</dd>
<dt>length</dt><dd><p>A numeric vector of length in cm</p>
</dd>
<dt>s_class</dt><dd><p>A character vector of size class</p>
</dd>
<dt>sex_sclass</dt><dd><p>A character vector for sex times size class</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of source names</p>
</dd>
<dt>source_means</dt><dd><p>A data frame of source means for same tracers as in Mixtures</p>
</dd>
<dt>source_sds</dt><dd><p>A data frame of standard deviations of sources for same tracers as in Mixtures</p>
</dd>
<dt>n_sources</dt><dd><p>A numeric vector of number of sources</p>
</dd>
<dt>TEF_means</dt><dd><p>A data frame of means for TEFs for same tracers as in Mixtures</p>
</dd>
<dt>TEF_sds</dt><dd><p>A data frame of sds for TEFs for same tracers as in Mixtures</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;doi:10.1111/1365-2656.12306&gt;
</p>

<hr>
<h2 id='cladocera_data'>Cladocera data from Galloway et al 2015.</h2><span id='topic+cladocera_data'></span>

<h3>Description</h3>

<p>Cladocera data from Galloway et al 2015. This dataset has 14 individuals on 7 food sources and 22 tracers. The id column can be used as a covariate. This dataset includes TDFs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cladocera_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>id</dt><dd><p>numeric vector of ID number</p>
</dd>
<dt>group</dt><dd><p>character vector of group ID</p>
</dd>
<dt>mixtures</dt><dd><p>Data frame of tracer values. There are 22 fatty acids as tracers in this dataset.</p>
</dd>
<dt>tracer_names</dt><dd><p>character vector of tracer names</p>
</dd>
<dt>source_means</dt><dd><p>data frame of tracer means for each of the 7 food sources</p>
</dd>
<dt>source_sds</dt><dd><p>data frame of tracer sds for each of the 7 food sources</p>
</dd>
<dt>n_sources</dt><dd><p>numeric vector of the number of each food source collected</p>
</dd>
<dt>correction_means</dt><dd><p>data frame with TDF means for each food source on each tracer</p>
</dd>
<dt>correction_sds</dt><dd><p>data frame with TDF sds for each food source on each tracer</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;doi:10.1111/fwb.12394&gt;
</p>

<hr>
<h2 id='cosimmr_ffvb'>Run a <code>cosimmr_input</code> object through the Fixed Form Variational
Bayes(FFVB) function</h2><span id='topic+cosimmr_ffvb'></span>

<h3>Description</h3>

<p>This is the main function of cosimmr. It takes a <code>cosimmr_input</code> object
created via <code><a href="#topic+cosimmr_load">cosimmr_load</a></code>, runs it in fixed form
Variational Bayes to determine the dietary proportions, and then
outputs a <code>cosimmr_output</code> object for further analysis and plotting
via <code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosimmr_ffvb(
  cosimmr_in,
  prior_control = list(mu_0 = rep(0, (cosimmr_in$n_sources * cosimmr_in$n_covariates)),
    mu_log_sig_sq_0 = rep(0, cosimmr_in$n_tracers), sigma_0 = 1, tau_shape = rep(1,
    cosimmr_in$n_tracers), tau_rate = rep(1, cosimmr_in$n_tracers)),
  ffvb_control = list(n_output = 3600, S = 500, P = 50, beta_1 = 0.75, beta_2 = 0.75, tau
    = 500, eps_0 = 0.0011, t_W = 500)
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cosimmr_ffvb_+3A_cosimmr_in">cosimmr_in</code></td>
<td>
<p>An object created via the function <code><a href="#topic+cosimmr_load">cosimmr_load</a></code></p>
</td></tr>
<tr><td><code id="cosimmr_ffvb_+3A_prior_control">prior_control</code></td>
<td>
<p>A list of values including arguments named <code>mu_0</code>
(prior for mu), and <code>sigma_0</code> (prior for sigma).</p>
</td></tr>
<tr><td><code id="cosimmr_ffvb_+3A_ffvb_control">ffvb_control</code></td>
<td>
<p>A list of values including arguments named <code>n_output</code>
(number of rows in theta output), <code>S</code> (number of samples taken at each
iteration of the algorithm), <code>P</code> (patience parameter), <code>beta_1</code>
and <code>beta_2</code> (adaptive learning weights), <code>tau</code> (threshold for
exploring learning space), <code>eps_0</code> (fixed learning rate),
<code>t_W</code> (rolling window size)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>cosimmr_output</code> with two named top-level
components: </p>
<table role = "presentation">
<tr><td><code>input</code></td>
<td>
<p>The <code>cosimmr_input</code> object given to the
<code>cosimmr_ffvb</code> function</p>
</td></tr> <tr><td><code>output</code></td>
<td>
<p>A set of outputs produced by
the FFVB function. These can be analysed using the
<code><a href="#topic+summary.cosimmr_output">summary.cosimmr_output</a></code> and <code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code>
functions.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell
</p>


<h3>References</h3>

<p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.
</p>
<p>Andrew C Parnell, Richard Inger, Stuart Bearhop, and Andrew L Jackson.
Source partitioning using stable isotopes: coping with too much variation.
PLoS ONE, 5(3):5, 2010.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating objects suitable for this
function, <code><a href="#topic+plot.cosimmr_input">plot.cosimmr_input</a></code> for creating isospace plots,
<code><a href="#topic+summary.cosimmr_output">summary.cosimmr_output</a></code> for summarising output, and
<code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See the package vignette for a detailed run through of these examples

# Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep
data(geese_data_day1)
x = c(1,2,3,2,1,3,2,1,2)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ x,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)

# Print
cosimmr_1

# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

# Print it
print(cosimmr_1_out)

# Summary
summary(cosimmr_1_out, type = "correlations")
summary(cosimmr_1_out, type = "statistics")
ans &lt;- summary(cosimmr_1_out, type = c("quantiles", "statistics"))

# Plot
plot(cosimmr_1_out, type = "beta_boxplot", cov_name = "x")
plot(cosimmr_1_out, type = "beta_histogram", cov_name = "x")


</code></pre>

<hr>
<h2 id='cosimmr_load'>Function to load in cosimmr data and check for errors</h2><span id='topic+cosimmr_load'></span>

<h3>Description</h3>

<p>This function takes in the mixture data, food source means and standard
deviations, and (optionally) correction factor means and standard
deviations, and concentration proportions. It performs some (non-exhaustive)
checking of the data to make sure it will run through simmr. It outputs an
object of class <code>cosimmr_input</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cosimmr_load(
  formula,
  source_names,
  source_means,
  source_sds,
  correction_means = NULL,
  correction_sds = NULL,
  concentration_means = NULL,
  scale_x = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cosimmr_load_+3A_formula">formula</code></td>
<td>
<p>Formula giving in form y ~ x where y is a vector or matrix
of mixture values and x is a vector or matrix of covariates</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_source_names">source_names</code></td>
<td>
<p>The names of the sources given as a character string</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_source_means">source_means</code></td>
<td>
<p>The means of the source values, given as a matrix where
the number of rows is the number of sources and the number of columns is the
number of tracers</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_source_sds">source_sds</code></td>
<td>
<p>The standard deviations of the source values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_correction_means">correction_means</code></td>
<td>
<p>The means of the correction values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers. If not provided these are set to 0.</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_correction_sds">correction_sds</code></td>
<td>
<p>The standard deviations of the correction values,
given as a matrix where the number of rows is the number of sources and the
number of columns is the number of tracers. If not provided these are set to
0.</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_concentration_means">concentration_means</code></td>
<td>
<p>The means of the concentration values, given as a
matrix where the number of rows is the number of sources and the number of
columns is the number of tracers. These should be between 0 and 1. If not
provided these are all set to 1.</p>
</td></tr>
<tr><td><code id="cosimmr_load_+3A_scale_x">scale_x</code></td>
<td>
<p>Whether or not you wish to scale the x values provided, or run 
the model using the original x values. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For standard stable isotope mixture modelling, the mixture matrix will
contain a row for each individual and a column for each isotopic value.
<code>cosimmr</code> will allow for any number of isotopes and any number of
observations, within computational limits. The source means/sds should be
provided for each food source on each isotope. The correction means (usually
trophic enrichment factors) can be set as zero if required, and should be of
the same shape as the source values. The concentration dependence means
should be estimated values of the proportion of each element in the food
source in question and should be given in proportion format between 0 and 1.
At present there is no means to include concentration standard deviations.
</p>


<h3>Value</h3>

<p>An object of class <code>cosimmr_input</code> with the following elements:
</p>
<table role = "presentation">
<tr><td><code>mixtures</code></td>
<td>
<p>The mixture data</p>
</td></tr> <tr><td><code>source_names</code></td>
<td>
<p>Source means</p>
</td></tr>
<tr><td><code>sources_sds</code></td>
<td>
<p>Source standard deviations</p>
</td></tr> <tr><td><code>correction_means</code></td>
<td>
<p>Correction means</p>
</td></tr> <tr><td><code>correction_sds</code></td>
<td>
<p>Correction standard deviations</p>
</td></tr>
<tr><td><code>concentration_means</code></td>
<td>
<p>Concentration dependence means</p>
</td></tr> <tr><td><code>n_obs</code></td>
<td>
<p>The number of observations</p>
</td></tr> <tr><td><code>n_tracers</code></td>
<td>
<p>The number of
tracers/isotopes</p>
</td></tr> <tr><td><code>n_sources</code></td>
<td>
<p>The number of sources</p>
</td></tr> <tr><td><code>n_groups</code></td>
<td>
<p>The number of groups</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for complete examples.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# A simple example with 10 observations, 2 tracers and 4 sources
data(geese_data_day1)
simmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means,
    scale_x = TRUE
  )
)



print(simmr_1)

</code></pre>

<hr>
<h2 id='geese_data'>Geese stable isotope mixing data set</h2><span id='topic+geese_data'></span>

<h3>Description</h3>

<p>A real Geese data set with 251 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means. Taken from Inger et al (2016). See link for paper
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geese_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;doi:10.1111/j.1365-2656.2006.01142.x&gt;
</p>

<hr>
<h2 id='geese_data_day1'>A smaller version of the Geese stable isotope mixing data set</h2><span id='topic+geese_data_day1'></span>

<h3>Description</h3>

<p>A real Geese data set with 9 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means. Taken from Inger et al (2016). See link for paper
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geese_data_day1
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>
<p>...
</p>



<h3>Source</h3>

<p>&lt;doi:10.1111/j.1365-2656.2006.01142.x&gt;
</p>

<hr>
<h2 id='iso_data'>Isopod Data</h2><span id='topic+iso_data'></span>

<h3>Description</h3>

<p>Isopod data from Galloway et al 2014. This dataset has 8 tracers (fatty acids), 30 individuals and 3 food sources. This dataset includes TDFs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>iso_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>site</dt><dd><p>A character vector with name of site for each individual</p>
</dd>
<dt>mixtures</dt><dd><p>Data frame with 8 tracer values for 30 individuals</p>
</dd>
<dt>tracer_names</dt><dd><p>character vector of tracer names</p>
</dd>
<dt>source_names</dt><dd><p>character vector of food source names</p>
</dd>
<dt>source_means</dt><dd><p>Data frame of source means with values for each food source on each tracer</p>
</dd>
<dt>source_sds</dt><dd><p>Data frame of source sds with values for each food source on each tracer</p>
</dd>
<dt>n_sources</dt><dd><p>numeric vector of number of each source obtained</p>
</dd>
<dt>correction_means</dt><dd><p>Data frame of TDF means for each food source on each tracer</p>
</dd>
<dt>correction_sds</dt><dd><p>Data frame of TDF sds for each food source on each tracer</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;doi:10.3354/meps10860&gt;
</p>

<hr>
<h2 id='plot.cosimmr_input'>Plot the <code>cosimmr_input</code> data created from <code>cosimmr_load</code></h2><span id='topic+plot.cosimmr_input'></span>

<h3>Description</h3>

<p>This function creates iso-space (AKA tracer-space or delta-space) plots.
They are vital in determining whether the data are suitable for running in a
SIMM.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_input'
plot(
  x,
  tracers = c(1, 2),
  title = "Tracers plot",
  xlab = colnames(x$mixtures)[tracers[1]],
  ylab = colnames(x$mixtures)[tracers[2]],
  sigmas = 1,
  mix_name = "Mixtures",
  colour = TRUE,
  colour_by_cov = FALSE,
  cov_name = NULL,
  ggargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cosimmr_input_+3A_x">x</code></td>
<td>
<p>An object created via the function <code><a href="#topic+cosimmr_load">cosimmr_load</a></code></p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_tracers">tracers</code></td>
<td>
<p>The choice of tracers to plot. If there are more than two
tracers, it is recommended to plot every pair of tracers to determine
whether the mixtures lie in the mixing polygon defined by the sources</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_title">title</code></td>
<td>
<p>A title for the graph</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_xlab">xlab</code></td>
<td>
<p>The x-axis label. By default this is assumed to be delta-13C but
can be made richer if required. See examples below.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_ylab">ylab</code></td>
<td>
<p>The y-axis label. By default this is assumed to be delta-15N in
per mil but can be changed as with the x-axis label</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_sigmas">sigmas</code></td>
<td>
<p>The number of standard deviations to plot on the source
values. Defaults to 1.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_mix_name">mix_name</code></td>
<td>
<p>A optional string containing the name of the mixture
objects, e.g. Geese.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_colour">colour</code></td>
<td>
<p>If TRUE (default) creates a plot. If not, puts the plot in
black and white</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_colour_by_cov">colour_by_cov</code></td>
<td>
<p>if TRUE this allows users to colour the mixtures on the 
isospace plot by a specified covariate. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_cov_name">cov_name</code></td>
<td>
<p>The name of the covariate the user wishes to colour the 
mixture points on the plot by</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_ggargs">ggargs</code></td>
<td>
<p>Extra arguments to be included in the ggplot (e.g. axis limits)</p>
</td></tr>
<tr><td><code id="plot.cosimmr_input_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is desirable to have the vast majority of the mixture observations to be
inside the convex hull defined by the food sources. When there are more than
two tracers (as in one of the examples below) it is recommended to plot all
the different pairs of the food sources. See the vignette for further
details of richer plots.
</p>


<h3>Value</h3>

<p>isospace plot
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code> for plotting the output of a
simmr run. See <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for running a cosimmr object once the
iso-space is deemed acceptable.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 4 food sources and 2 tracers
data(geese_data_day1)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ c(1,2,3,2,3,1,2,3,1),
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)

### A more complicated example with 30 obs, 3 tracers and 4 sources
data(simmr_data_2)
cosimmr_3 &lt;- with(
  simmr_data_2,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot 3 times - first default d13C vs d15N
plot(cosimmr_3)
# Now plot d15N vs d34S
plot(cosimmr_3, tracers = c(2, 3))
# and finally d13C vs d34S
plot(cosimmr_3, tracers = c(1, 3))

</code></pre>

<hr>
<h2 id='plot.cosimmr_output'>Plot different features of an object created from  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>.</h2><span id='topic+plot.cosimmr_output'></span>

<h3>Description</h3>

<p>This function allows for 4 different types of plots of the simmr output
created from <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>. The 
types are: plot of beta values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_output'
plot(
  x,
  type = c("isospace", "beta_histogram", "beta_boxplot", "prop_histogram",
    "prop_density", "covariates_plot"),
  obs = 1,
  cov_name = NULL,
  binwidth = 0.05,
  alpha = 0.5,
  title = NULL,
  n_output = 3600,
  source = NULL,
  one_plot = FALSE,
  n_pred = 1000,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cosimmr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>cosimmr_output</code> created via
<code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_type">type</code></td>
<td>
<p>The type of plot required. Can be one or more of 'isospace', 
'beta_histogram', 'beta_boxplot', 'prob_histogram', 'prob_density', 'covariates_plot'</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_obs">obs</code></td>
<td>
<p>The observation number you wish to plot</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_cov_name">cov_name</code></td>
<td>
<p>The name of the covariate you wish to plot (for beta and covariates plot)</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_binwidth">binwidth</code></td>
<td>
<p>The width of the bins for the histogram. Defaults to 0.05</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_alpha">alpha</code></td>
<td>
<p>The degree of transparency of the plots. Not relevant for
matrix plots</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_n_output">n_output</code></td>
<td>
<p>The number of theta samples you wish to plot with. Defaults to 3600</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_source">source</code></td>
<td>
<p>The number or name of the source you wish to plot over for 
'covariates_plot', defaults to NULL which means all sources are used</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_one_plot">one_plot</code></td>
<td>
<p>Whether to plot line covariates plot on one plot. Defaults to FALSE</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_n_pred">n_pred</code></td>
<td>
<p>Number of points to use when plotting line covariates plot. Defaults to 1000.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_output_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix plot should form a necessary part of any SIMM analysis since it
allows the user to judge which sources are identifiable by the model.
Further detail about these plots is provided in the vignette.
</p>


<h3>Value</h3>

<p>one or more of 'isospace', 'beta_histogram', 'beta_boxplot', 'prop_histogram', 'prop_density', or 'covariates_plot'
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;, Andrew Parnell
</p>


<h3>See Also</h3>

<p>See  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for 
creating objects suitable for this function, and many more examples. See 
also <code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating simmr objects, 
<code><a href="#topic+plot.cosimmr_input">plot.cosimmr_input</a></code> for creating isospace plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data_day1)

# Load into simmr
simmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)
# Plot
plot(simmr_1)


# FFVB run
simmr_1_out &lt;- cosimmr_ffvb(simmr_1)

plot(simmr_1_out, type = c("isospace", "beta_hist"))

</code></pre>

<hr>
<h2 id='plot.cosimmr_pred_out'>Plot different features of an object created from  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>.</h2><span id='topic+plot.cosimmr_pred_out'></span>

<h3>Description</h3>

<p>This function allows for 4 different types of plots of the simmr output
created from <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>. The 
types are: plot of beta values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_pred_out'
plot(
  x,
  type = c("beta_histogram", "beta_boxplot", "prop_obs", "prop_density"),
  obs = 1,
  cov_name = NULL,
  binwidth = 0.05,
  alpha = 0.5,
  title = NULL,
  n_output = 3600,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cosimmr_pred_out_+3A_x">x</code></td>
<td>
<p>An object of class <code>cosimmr_output</code> created via
<code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_type">type</code></td>
<td>
<p>The type of plot required. Can be one or more of 'isospace', 
'beta_histogram', 'beta_boxplot', 'prob_histogram', 'prob_density', 'covariates_plot'</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_obs">obs</code></td>
<td>
<p>The observation you wish to plot</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_cov_name">cov_name</code></td>
<td>
<p>The name of the covariate you wish to plot (for beta and covariate plots)</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_binwidth">binwidth</code></td>
<td>
<p>The width of the bins for the histogram. Defaults to 0.05</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_alpha">alpha</code></td>
<td>
<p>The degree of transparency of the plots. Not relevant for
matrix plots</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_n_output">n_output</code></td>
<td>
<p>The number of theta samples you wish to plot with. Defaults to 3600</p>
</td></tr>
<tr><td><code id="plot.cosimmr_pred_out_+3A_...">...</code></td>
<td>
<p>Currently not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The matrix plot should form a necessary part of any SIMM analysis since it
allows the user to judge which sources are identifiable by the model.
Further detail about these plots is provided in the vignette.
</p>


<h3>Value</h3>

<p>one or more of 'isospace', 'beta_histogram', 'beta_boxplot', 'prop_histogram', 'prop_density', or 'covariates_plot'
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt;&gt;, Andrew Parnell
</p>


<h3>See Also</h3>

<p>See  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for 
creating objects suitable for this function, and many more examples. See 
also <code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating simmr objects, 
<code><a href="#topic+plot.cosimmr_input">plot.cosimmr_input</a></code> for creating isospace plots.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data_day1)

# Load into simmr
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)
# Plot
plot(cosimmr_1)


# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

plot(cosimmr_1_out, type = c("isospace", "beta_hist"))

</code></pre>

<hr>
<h2 id='posterior_predictive'>Plot the posterior predictive distribution for a cosimmr run</h2><span id='topic+posterior_predictive'></span>

<h3>Description</h3>

<p>This function takes the output from  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> and plots 
the posterior predictive distribution to enable visualisation of model fit.
The simulated posterior predicted values are returned as part of the object 
and can be saved for external use
</p>


<h3>Usage</h3>

<pre><code class='language-R'>posterior_predictive(
  cosimmr_out,
  prob = 0.5,
  plot_ppc = TRUE,
  n_samples = 3600,
  sort_data = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="posterior_predictive_+3A_cosimmr_out">cosimmr_out</code></td>
<td>
<p>A run of the cosimmr model from <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>.</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_prob">prob</code></td>
<td>
<p>The probability interval for the posterior predictives. The default is 0.5 (i.e. 50pc intervals)</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_plot_ppc">plot_ppc</code></td>
<td>
<p>Whether to create a bayesplot of the posterior predictive or not.</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_n_samples">n_samples</code></td>
<td>
<p>The number of samples you wish to generate for y_pred. Defaults to 3600.</p>
</td></tr>
<tr><td><code id="posterior_predictive_+3A_sort_data">sort_data</code></td>
<td>
<p>Whether to order the data from lowest to highest predicted mean or not. Defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>plot of posterior predictives and simulated values
</p>
<p>#' @author Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for creating objects suitable for this
function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geese_data_day1)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ c(1,2,3,2,1,2,3,2,1),
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)

# Print
cosimmr_1

# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

# Prior predictive
post_pred &lt;- posterior_predictive(cosimmr_1_out)

</code></pre>

<hr>
<h2 id='predict.cosimmr_output'>Predicts proportion of each source in a mixture, based on values provided for covariates</h2><span id='topic+predict.cosimmr_output'></span>

<h3>Description</h3>

<p>Predicts proportion of each source in a mixture, based on values provided for covariates
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_output'
predict(object, x_pred, n_output = 3600, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.cosimmr_output_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosimmr_output</code> created via the 
function <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="predict.cosimmr_output_+3A_x_pred">x_pred</code></td>
<td>
<p>A data.frame of covariate values that the user wishes
to predict source proportions for, provided in the same order that the 
original covariance matrix was. Important for this to be a data.frame otherwise 
numeric values can be set as characters and this causes incorrect calculations.</p>
</td></tr>
<tr><td><code id="predict.cosimmr_output_+3A_n_output">n_output</code></td>
<td>
<p>the number of posterior samples to generate. Defaults to 3600.</p>
</td></tr>
<tr><td><code id="predict.cosimmr_output_+3A_...">...</code></td>
<td>
<p>Other arguments (not used)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>object of class 'cosimmr_pred_out'
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell
</p>


<h3>References</h3>

<p>Andrew C. Parnell, Donald L. Phillips, Stuart Bearhop, Brice X.
Semmens, Eric J. Ward, Jonathan W. Moore, Andrew L. Jackson, Jonathan Grey,
David J. Kelly, and Richard Inger. Bayesian stable isotope mixing models.
Environmetrics, 24(6):387–399, 2013.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating objects suitable for this
function,  and
<code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## See the package vignette for a detailed run through of these 4 examples

# Data set 1: 10 obs on 2 isos, 4 sources, with tefs and concdep
data(geese_data_day1)
cov_1 = c(1,2,3,2,3,1,1,1,2)
simmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ cov_1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(simmr_1)

# Print
simmr_1

# FFVB run
simmr_1_out &lt;- cosimmr_ffvb(simmr_1)

# Print it
print(simmr_1_out)


# Plot
plot(simmr_1_out, type = "isospace")
plot(simmr_1_out, type = "beta_histogram", cov_name = "cov_1")

x_pred = data.frame(cov_1 = c(1,5))

pred_array&lt;-predict(simmr_1_out, x_pred)


</code></pre>

<hr>
<h2 id='print.cosimmr_input'>Print simmr input object</h2><span id='topic+print.cosimmr_input'></span>

<h3>Description</h3>

<p>Print simmr input object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_input'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cosimmr_input_+3A_x">x</code></td>
<td>
<p>An object of class <code>cosimmr_input</code></p>
</td></tr>
<tr><td><code id="print.cosimmr_input_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)
</p>
<p>#' @author Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A neat presentation of your simmr object.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating objects suitable for this
function
</p>

<hr>
<h2 id='print.cosimmr_output'>Print a simmr output object</h2><span id='topic+print.cosimmr_output'></span>

<h3>Description</h3>

<p>Print a simmr output object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_output'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cosimmr_output_+3A_x">x</code></td>
<td>
<p>An object of class <code>cosimmr_output</code></p>
</td></tr>
<tr><td><code id="print.cosimmr_output_+3A_...">...</code></td>
<td>
<p>Other arguments (not supported)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a neat summary of the object
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for creating
<code>cosimmr_output</code> objects
</p>

<hr>
<h2 id='prior_viz'>Plot the prior distribution for a cosimmr run</h2><span id='topic+prior_viz'></span>

<h3>Description</h3>

<p>This function takes the output from <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> and plots the 
prior distribution to enable visual
inspection. This can be used by itself or together with
<code><a href="#topic+posterior_predictive">posterior_predictive</a></code> to visually evaluate the influence of
the prior on the posterior distribution.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>prior_viz(
  cosimmr_out,
  plot = TRUE,
  include_posterior = TRUE,
  n_sims = 10000,
  scales = "free"
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="prior_viz_+3A_cosimmr_out">cosimmr_out</code></td>
<td>
<p>A run of the cosimmr model from <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="prior_viz_+3A_plot">plot</code></td>
<td>
<p>Whether to create a density plot of the prior or not. The simulated prior values are returned as part of the object</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_include_posterior">include_posterior</code></td>
<td>
<p>Whether to include the posterior distribution on top of the priors. Defaults to TRUE. The posterior returned is of the mean value of covariates</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_n_sims">n_sims</code></td>
<td>
<p>The number of simulations from the prior distribution</p>
</td></tr>
<tr><td><code id="prior_viz_+3A_scales">scales</code></td>
<td>
<p>The type of scale from <code>facet_wrap</code> allowing for <code>fixed</code>, <code>free</code>, <code>free_x</code>, <code>free_y</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing <code>plot</code>: the ggplot object (useful if requires customisation), and <code>sim</code>: the simulated prior values which can be compared with the posterior densities
</p>
<p>#' @author Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code> for creating objects suitable for this
function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(geese_data_day1)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)

# Print
cosimmr_1

# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

# Prior predictive
prior &lt;- prior_viz(cosimmr_1_out)
head(prior$p_prior_sim)
summary(prior$p_prior_sim)

</code></pre>

<hr>
<h2 id='simmr_data_1'>A simple fake stable isotope mixing data set</h2><span id='topic+simmr_data_1'></span>

<h3>Description</h3>

<p>A simple fake data set with 10 observations on 2 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_data_1
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C and d15N)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>


<hr>
<h2 id='simmr_data_2'>A 3-isotope fake stable isotope mixing data set</h2><span id='topic+simmr_data_2'></span>

<h3>Description</h3>

<p>A fake data set with 30 observations on 3 isotopes, with 4 sources, and with corrections/trophic enrichment factors (TEFs or TDFs), and concentration dependence means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simmr_data_2
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A three column matrix containing delta 13C, delta 15N, and delta 34S values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N, d34S)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>


<hr>
<h2 id='square_data'>An artificial data set used to indicate effect of priors</h2><span id='topic+square_data'></span>

<h3>Description</h3>

<p>A fake box data set identified by Fry (2014) as a failing of SIMMs
See the link for more interpretation of these data and the output
</p>


<h3>Usage</h3>

<pre><code class='language-R'>square_data
</code></pre>


<h3>Format</h3>

<p>A list with the following elements
</p>

<dl>
<dt>mixtures</dt><dd><p>A two column matrix containing delta 13C and delta 15N values respectively</p>
</dd>
<dt>source_names</dt><dd><p>A character vector of the food source names</p>
</dd>
<dt>tracer_names</dt><dd><p>A character vector of the tracer names (d13C, d15N)</p>
</dd>
<dt>source_means</dt><dd><p>A matrix of source mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>source_sds</dt><dd><p>A matrix of source sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_means</dt><dd><p>A matrix of TEFs mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>correction_sds</dt><dd><p>A matrix of TEFs sd values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
<dt>concentration_means</dt><dd><p>A matrix of concentration dependence mean values for the tracers in the same order as <code>mixtures</code> above</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;doi:10.3354/meps10535&gt;
</p>

<hr>
<h2 id='summary.cosimmr_output'>Summarises the output created with <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code></h2><span id='topic+summary.cosimmr_output'></span>

<h3>Description</h3>

<p>Produces textual summaries and convergence diagnostics for an object created
with  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>. The different
options are: 'quantiles' which produces credible intervals
for the parameters, 'statistics' which produces means and standard
deviations, and 'correlations' which produces correlations between the
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_output'
summary(
  object,
  type = c("quantiles", "statistics", "correlations"),
  obs = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cosimmr_output_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosimmr_output</code> produced by the
function <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code></p>
</td></tr>
<tr><td><code id="summary.cosimmr_output_+3A_type">type</code></td>
<td>
<p>The type of output required. At least none of quantiles', 
'statistics', or 'correlations'.</p>
</td></tr>
<tr><td><code id="summary.cosimmr_output_+3A_obs">obs</code></td>
<td>
<p>The observation to generate a summary for. Defaults to 1.</p>
</td></tr>
<tr><td><code id="summary.cosimmr_output_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile output allows easy calculation of 95 per cent credible
intervals of the posterior dietary proportions. The correlations allow the 
user to judge which sources are non-identifiable.
</p>


<h3>Value</h3>

<p>A list containing the following components: 
</p>
<table role = "presentation">
<tr><td><code>quantiles</code></td>
<td>
<p>The quantiles of each parameter from the posterior 
distribution</p>
</td></tr> <tr><td><code>statistics</code></td>
<td>
<p>The means and standard
deviations of each parameter</p>
</td></tr> <tr><td><code>correlations</code></td>
<td>
<p>The posterior
correlations between the parameters</p>
</td></tr></table>
<p> Note that this object is reported
silently so will be discarded unless the function is called with an object
as in the example below.
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>for creating objects suitable for 
this function, and many more examples.
See also <code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating cosimmr objects,
<code><a href="#topic+plot.cosimmr_input">plot.cosimmr_input</a></code> for creating isospace plots,
<code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data_day1)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ 1,
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)


# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

# Summarise
summary(cosimmr_1_out) # This outputs all the summaries
summary(cosimmr_1_out, type = "quantiles") # Just the diagnostics
# Store the output in an
ans &lt;- summary(cosimmr_1_out,
  type = c("quantiles", "statistics")
)

</code></pre>

<hr>
<h2 id='summary.cosimmr_pred_out'>Summarises the output created with <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code></h2><span id='topic+summary.cosimmr_pred_out'></span>

<h3>Description</h3>

<p>Produces textual summaries and convergence diagnostics for an object created
with  <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>. The different
options are: 'quantiles' which produces credible intervals
for the parameters, 'statistics' which produces means and standard
deviations, and 'correlations' which produces correlations between the
parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cosimmr_pred_out'
summary(
  object,
  type = c("quantiles", "statistics", "correlations"),
  obs = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cosimmr_pred_out_+3A_object">object</code></td>
<td>
<p>An object of class <code>cosimmr_pred_output</code> produced by the
function  <code><a href="#topic+predict.cosimmr_output">predict.cosimmr_output</a></code></p>
</td></tr>
<tr><td><code id="summary.cosimmr_pred_out_+3A_type">type</code></td>
<td>
<p>The type of output required. At least none of quantiles', 
'statistics', or 'correlations'.</p>
</td></tr>
<tr><td><code id="summary.cosimmr_pred_out_+3A_obs">obs</code></td>
<td>
<p>The observation to generate a summary for. Defaults to 1.</p>
</td></tr>
<tr><td><code id="summary.cosimmr_pred_out_+3A_...">...</code></td>
<td>
<p>Not used</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The quantile output allows easy calculation of 95 per cent credible
intervals of the posterior dietary proportions. The correlations allow the 
user to judge which sources are non-identifiable.
</p>


<h3>Value</h3>

<p>A list containing the following components: 
</p>
<table role = "presentation">
<tr><td><code>quantiles</code></td>
<td>
<p>The quantiles of each parameter from the posterior 
distribution</p>
</td></tr> <tr><td><code>statistics</code></td>
<td>
<p>The means and standard
deviations of each parameter</p>
</td></tr> <tr><td><code>correlations</code></td>
<td>
<p>The posterior
correlations between the parameters</p>
</td></tr></table>
<p> Note that this object is reported
silently so will be discarded unless the function is called with an object
as in the example below.
</p>


<h3>Author(s)</h3>

<p>Emma Govan &lt;emmagovan@gmail.com&gt; Andrew Parnell
</p>


<h3>See Also</h3>

<p>See <code><a href="#topic+cosimmr_ffvb">cosimmr_ffvb</a></code>for creating objects suitable for 
this function, and many more examples.
See also <code><a href="#topic+cosimmr_load">cosimmr_load</a></code> for creating cosimmr objects,
<code><a href="#topic+plot.cosimmr_input">plot.cosimmr_input</a></code> for creating isospace plots,
<code><a href="#topic+plot.cosimmr_output">plot.cosimmr_output</a></code> for plotting output.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# A simple example with 10 observations, 2 tracers and 4 sources

# The data
data(geese_data_day1)
cosimmr_1 &lt;- with(
  geese_data_day1,
  cosimmr_load(
    formula = mixtures ~ c(1,2,3,3,2,3,1,2,1),
    source_names = source_names,
    source_means = source_means,
    source_sds = source_sds,
    correction_means = correction_means,
    correction_sds = correction_sds,
    concentration_means = concentration_means
  )
)

# Plot
plot(cosimmr_1)


# FFVB run
cosimmr_1_out &lt;- cosimmr_ffvb(cosimmr_1)

# Summarise
summary(cosimmr_1_out) # This outputs all the summaries
summary(cosimmr_1_out, type = "quantiles") # Just the diagnostics
# Store the output in ans
ans &lt;- summary(cosimmr_1_out,
  type = c("quantiles", "statistics")
)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
