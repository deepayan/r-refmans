<!DOCTYPE html><html><head><title>Help for package mFD</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {mFD}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#mFD-package'><p>mFD: Compute and Illustrate the Multiple Facets of Functional Diversity</p></a></li>
<li><a href='#alpha.fd.fe'><p>Compute the set of indices based on number of species in Functional Entities</p></a></li>
<li><a href='#alpha.fd.fe.plot'><p>Illustrate Functional Diversity indices based on Functional Entities</p></a></li>
<li><a href='#alpha.fd.hill'><p>Compute Functional alpha-Diversity indices based on Hill Numbers</p></a></li>
<li><a href='#alpha.fd.multidim'><p>Compute a set of alpha functional indices for a set of assemblages</p></a></li>
<li><a href='#alpha.multidim.plot'><p>Plot functional space and chosen functional indices</p></a></li>
<li><a href='#asb.sp.summary'><p>Summarize Assemblage x Species data frame</p></a></li>
<li><a href='#background.plot'><p>Plot background of multidimensional plots</p></a></li>
<li><a href='#baskets_fruits_weights'><p>Dataset: Baskets Composition in Fruits Species</p></a></li>
<li><a href='#beta.fd.hill'><p>Compute Functional beta-Diversity indices based on Hill Numbers</p></a></li>
<li><a href='#beta.fd.multidim'><p>Compute Functional beta-Diversity indices for pairs of assemblages in a</p>
multidimensional space</a></li>
<li><a href='#beta.multidim.plot'><p>Illustrate Functional beta-Diversity indices for pairs of assemblages in a</p>
multidimensional space</a></li>
<li><a href='#dist.nearneighb'><p>Compute distance of a given point to its nearest neighbor in the functional</p>
space and the identity of the nearest neighbor</a></li>
<li><a href='#dist.point'><p>Compute distances of all points to a given point in the functional space</p></a></li>
<li><a href='#dist.to.df'><p>Merge distance object(s) into a single data frame</p></a></li>
<li><a href='#fdis.plot'><p>Plot FDis index</p></a></li>
<li><a href='#fdiv.plot'><p>Plot FDiv indice</p></a></li>
<li><a href='#feve.plot'><p>Plot FEve index</p></a></li>
<li><a href='#fide.plot'><p>Plot FIde index</p></a></li>
<li><a href='#fnnd.plot'><p>Plot FNND index</p></a></li>
<li><a href='#fori.plot'><p>Plot FOri</p></a></li>
<li><a href='#fric.plot'><p>Plot FRic index</p></a></li>
<li><a href='#fruits_traits'><p>Dataset: Traits Values of Fruits Species</p></a></li>
<li><a href='#fruits_traits_cat'><p>Dataset: Fruits Traits Informations</p></a></li>
<li><a href='#fspe.plot'><p>Plot FSpe</p></a></li>
<li><a href='#funct.dist'><p>Compute functional distance between species</p></a></li>
<li><a href='#funct.space.plot'><p>Plot species position in a functional space</p></a></li>
<li><a href='#fuse'><p>Compute FUSE (Functionally Unique, Specialized and Endangered)</p></a></li>
<li><a href='#mst.computation'><p>Compute the Minimum Spanning Tree (MST) linking species of a given</p>
assemblage</a></li>
<li><a href='#panels.to.patchwork'><p>Plot individual plots along a pair of functional axes into a unique graph</p></a></li>
<li><a href='#pool.plot'><p>Plot species from the pool</p></a></li>
<li><a href='#quality.fspaces'><p>Compute functional spaces and their quality</p></a></li>
<li><a href='#quality.fspaces.plot'><p>Plot functional space quality with a chosen quality metric</p></a></li>
<li><a href='#sp.filter'><p>Retrieve information about species in a given assemblage</p></a></li>
<li><a href='#sp.to.fe'><p>Compute Functional Entities composition based on a Species x Traits matrix</p></a></li>
<li><a href='#sp.tr.summary'><p>Summarize Species x Traits data frame</p></a></li>
<li><a href='#tr.cont.fspace'><p>Build a functional space based on continuous traits only</p></a></li>
<li><a href='#tr.cont.scale'><p>Scale continuous traits</p></a></li>
<li><a href='#traits.faxes.cor'><p>Correlation between Traits and Axes</p></a></li>
<li><a href='#vertices'><p>Compute vertices of the Minimal Convex Hull shaping species from a single</p>
assemblage in a multidimensional functional space</a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Compute and Illustrate the Multiple Facets of Functional
Diversity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Computing functional traits-based distances between pairs of 
    species for species gathered in assemblages allowing to build several
    functional spaces. The package allows to compute functional diversity
    indices assessing the distribution of species (and of their dominance) in a
    given functional space for each assemblage and the overlap between
    assemblages in a given functional space, see: Chao et al. (2018)
    &lt;<a href="https://doi.org/10.1002%2Fecm.1343">doi:10.1002/ecm.1343</a>&gt;, Maire et al. (2015) &lt;<a href="https://doi.org/10.1111%2Fgeb.12299">doi:10.1111/geb.12299</a>&gt;,
    Mouillot et al. (2013) &lt;<a href="https://doi.org/10.1016%2Fj.tree.2012.10.004">doi:10.1016/j.tree.2012.10.004</a>&gt;, Mouillot et al.
    (2014) &lt;<a href="https://doi.org/10.1073%2Fpnas.1317625111">doi:10.1073/pnas.1317625111</a>&gt;, Ricotta and Szeidl (2009)
    &lt;<a href="https://doi.org/10.1016%2Fj.tpb.2009.10.001">doi:10.1016/j.tpb.2009.10.001</a>&gt;. Graphical outputs are included.
    Visit the 'mFD' website for more information, documentation and examples.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://cmlmagneville.github.io/mFD/">https://cmlmagneville.github.io/mFD/</a>,
<a href="https://github.com/CmlMagneville/mFD">https://github.com/CmlMagneville/mFD</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/CmlMagneville/mFD/issues">https://github.com/CmlMagneville/mFD/issues</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5)</td>
</tr>
<tr>
<td>Imports:</td>
<td>ade4, ape, betapart (&ge; 1.5.4), cluster, dendextend,
FactoMineR, gawdis, geometry, ggplot2, ggrepel, grid, Hmisc,
patchwork, reshape2, rstatix, stats, utils, vegan</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr (&ge; 1.0.6), knitr, magrittr, rmarkdown (&ge; 2.6),
stringr, tibble, tidyr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 10:43:42 UTC; au749321</td>
</tr>
<tr>
<td>Author:</td>
<td>Camille Magneville
    <a href="https://orcid.org/0000-0003-0489-3822"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre,
    cph],
  Nicolas Loiseau <a href="https://orcid.org/0000-0002-2469-1980"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Camille Albouy <a href="https://orcid.org/0000-0003-1629-2389"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Nicolas Casajus <a href="https://orcid.org/0000-0002-5537-5294"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Thomas Claverie <a href="https://orcid.org/0000-0002-6258-4991"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Arthur Escalas <a href="https://orcid.org/0000-0002-6450-5716"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fabien Leprieur <a href="https://orcid.org/0000-0001-6869-342X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Eva Maire <a href="https://orcid.org/0000-0002-1032-3394"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  David Mouillot <a href="https://orcid.org/0000-0003-0402-2605"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Sebastien Villeger
    <a href="https://orcid.org/0000-0002-2362-7178"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Camille Magneville &lt;camille.magneville@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 14:00:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='mFD-package'>mFD: Compute and Illustrate the Multiple Facets of Functional Diversity</h2><span id='topic+mFD'></span><span id='topic+mFD-package'></span>

<h3>Description</h3>

<p>Computing functional traits-based distances between pairs of species for species gathered in assemblages allowing to build several functional spaces. The package allows to compute functional diversity indices assessing the distribution of species (and of their dominance) in a given functional space for each assemblage and the overlap between assemblages in a given functional space, see: Chao et al. (2018) <a href="https://doi.org/10.1002/ecm.1343">doi:10.1002/ecm.1343</a>, Maire et al. (2015) <a href="https://doi.org/10.1111/geb.12299">doi:10.1111/geb.12299</a>, Mouillot et al. (2013) <a href="https://doi.org/10.1016/j.tree.2012.10.004">doi:10.1016/j.tree.2012.10.004</a>, Mouillot et al. (2014) <a href="https://doi.org/10.1073/pnas.1317625111">doi:10.1073/pnas.1317625111</a>, Ricotta and Szeidl (2009) <a href="https://doi.org/10.1016/j.tpb.2009.10.001">doi:10.1016/j.tpb.2009.10.001</a>. Graphical outputs are included. Visit the 'mFD' website for more information, documentation and examples.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Camille Magneville <a href="mailto:camille.magneville@gmail.com">camille.magneville@gmail.com</a> (<a href="https://orcid.org/0000-0003-0489-3822">ORCID</a>) [copyright holder]
</p>
<p>Authors:
</p>

<ul>
<li><p> Nicolas Loiseau <a href="mailto:nicolas.loiseau1@gmail.com">nicolas.loiseau1@gmail.com</a> (<a href="https://orcid.org/0000-0002-2469-1980">ORCID</a>)
</p>
</li>
<li><p> Camille Albouy <a href="mailto:albouycamille@gmail.com">albouycamille@gmail.com</a> (<a href="https://orcid.org/0000-0003-1629-2389">ORCID</a>)
</p>
</li>
<li><p> Nicolas Casajus <a href="mailto:nicolas.casajus@fondationbiodiversite.fr">nicolas.casajus@fondationbiodiversite.fr</a> (<a href="https://orcid.org/0000-0002-5537-5294">ORCID</a>)
</p>
</li>
<li><p> Thomas Claverie <a href="mailto:tclaverie@gmail.com">tclaverie@gmail.com</a> (<a href="https://orcid.org/0000-0002-6258-4991">ORCID</a>)
</p>
</li>
<li><p> Arthur Escalas <a href="mailto:arthur.escalas@gmail.com">arthur.escalas@gmail.com</a> (<a href="https://orcid.org/0000-0002-6450-5716">ORCID</a>)
</p>
</li>
<li><p> Fabien Leprieur <a href="mailto:fabien.leprieur@umontpellier.fr">fabien.leprieur@umontpellier.fr</a> (<a href="https://orcid.org/0000-0001-6869-342X">ORCID</a>)
</p>
</li>
<li><p> Eva Maire <a href="mailto:emg.maire@gmail.com">emg.maire@gmail.com</a> (<a href="https://orcid.org/0000-0002-1032-3394">ORCID</a>)
</p>
</li>
<li><p> David Mouillot <a href="mailto:david.mouillot@umontpellier.fr">david.mouillot@umontpellier.fr</a> (<a href="https://orcid.org/0000-0003-0402-2605">ORCID</a>)
</p>
</li>
<li><p> Sebastien Villeger <a href="mailto:sebastien.villeger@cnrs.fr">sebastien.villeger@cnrs.fr</a> (<a href="https://orcid.org/0000-0002-2362-7178">ORCID</a>)
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://cmlmagneville.github.io/mFD/">https://cmlmagneville.github.io/mFD/</a>
</p>
</li>
<li> <p><a href="https://github.com/CmlMagneville/mFD">https://github.com/CmlMagneville/mFD</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/CmlMagneville/mFD/issues">https://github.com/CmlMagneville/mFD/issues</a>
</p>
</li></ul>


<hr>
<h2 id='alpha.fd.fe'>Compute the set of indices based on number of species in Functional Entities</h2><span id='topic+alpha.fd.fe'></span>

<h3>Description</h3>

<p>This function computes the set of indices based on number of species in
Functional Entities (FEs) following Mouillot <em>et al.</em> (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.fd.fe(
  asb_sp_occ,
  sp_to_fe,
  ind_nm = c("fred", "fored", "fvuln"),
  check_input = TRUE,
  details_returned = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.fd.fe_+3A_asb_sp_occ">asb_sp_occ</code></td>
<td>
<p>a matrix linking occurrences (coded as 0/1) of
species (columns) in a set of assemblages (rows). Warning: <strong>An
assemblage must contain at least one species</strong>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe_+3A_sp_to_fe">sp_to_fe</code></td>
<td>
<p>a list with details of species clustering into FE
from <code><a href="#topic+sp.to.fe">sp.to.fe</a></code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe_+3A_ind_nm">ind_nm</code></td>
<td>
<p>a vector of character strings with the names of
functional diversity indices to compute among 'fred', 'fored' and 'fvuln'.
<b>Indices names must be written in lower case letters</b>. Default: all
the indices are computed.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe_+3A_details_returned">details_returned</code></td>
<td>
<p>a logical value indicating whether details
about indices computation should be returned. These details are required
by <code><a href="#topic+alpha.fd.fe.plot">alpha.fd.fe.plot</a></code> to plot FEs indices.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>

<ul>
<li> <p><em>asb_fdfe</em> a matrix containing for each assemblage (rows),
values of functional diversity indices (same names than in 'ind_nm')
as well as the number of species ('nb_sp') and the number of FE
(nb_fe);
</p>
</li>
<li><p> if <em>details_returned</em> is <code>TRUE</code>,
</p>
</li>
<li> <p><em>details_fdfe</em> a list with <em>asb_fe_nbsp</em> a matrix with
number of species per FE in each assemblage.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Camille Magneville
</p>


<h3>References</h3>

<p>Mouillot <em>et al.</em> (2014) Functional over-redundancy and high functional
vulnerability in global fish faunas on tropical reefs. <em>PNAS</em>, <strong>38</strong>,
13757-13762.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data('fruits_traits', package = 'mFD')

# Load Traits categories dataframe:
data('fruits_traits_cat', package = 'mFD')

# Load Assemblages*Species matrix:
data('baskets_fruits_weights', package = 'mFD')

# Remove continuous trait:
fruits_traits &lt;- fruits_traits[, -5]
fruits_traits_cat &lt;- fruits_traits_cat[-5, ]

# Compute gathering species into FEs:
sp_to_fe_fruits &lt;- mFD::sp.to.fe(sp_tr = fruits_traits, 
 tr_cat = fruits_traits_cat, 
 fe_nm_type = 'fe_rank', check_input = TRUE)
 
# Get the occurrence dataframe:
asb_sp_fruits_summ &lt;- mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights) 
asb_sp_fruits_occ &lt;- asb_sp_fruits_summ$'asb_sp_occ'

# Compute alpha fd indices:
alpha.fd.fe(
   asb_sp_occ       = asb_sp_fruits_occ, 
   sp_to_fe         = sp_to_fe_fruits,
   ind_nm           = c('fred', 'fored', 'fvuln'),
   check_input      = TRUE, 
   details_returned = TRUE)
</code></pre>

<hr>
<h2 id='alpha.fd.fe.plot'>Illustrate Functional Diversity indices based on Functional Entities</h2><span id='topic+alpha.fd.fe.plot'></span>

<h3>Description</h3>

<p>Graphical representation of distribution of species in Functional
Entities (FE) and of indices from Mouillot <em>et al.</em> (2014). <strong>To plot
functional indices, functional indices values must have been computed first
through the use of the</strong> <code><a href="#topic+alpha.fd.fe">alpha.fd.fe</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.fd.fe.plot(
  alpha_fd_fe,
  plot_asb_nm,
  plot_ind_nm = c("fred", "fored", "fvuln"),
  name_file = NULL,
  color_fill_fored = "darkolivegreen2",
  color_line_fred = "darkolivegreen4",
  color_fill_bar = "grey80",
  color_fill_fvuln = "lightcoral",
  color_arrow_fvuln = "indianred4",
  size_line_fred = 1.5,
  size_arrow_fvuln = 1,
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.fd.fe.plot_+3A_alpha_fd_fe">alpha_fd_fe</code></td>
<td>
<p>output from the function <code><a href="#topic+alpha.fd.fe">alpha.fd.fe</a></code>
applied on assemblage of interest with <code>details_returned = TRUE</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_plot_asb_nm">plot_asb_nm</code></td>
<td>
<p>a vector containing the name of the assemblage to plot.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_plot_ind_nm">plot_ind_nm</code></td>
<td>
<p>a vector containing the names of the indices to plot. It
can be <code>'fred'</code> to plot functional redundancy (FRed), <code>'fored'</code> to
plot functional over-redundancy (FOred) and/or <code>'fvuln'</code> to plot
functional vulnerability (FVuln). Default is all <code>3</code> indices.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_name_file">name_file</code></td>
<td>
<p>a character string with name of file to save the figure
(without extension). Default: <code>name_file = NULL</code> which means plot is
displayed.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_color_fill_fored">color_fill_fored</code></td>
<td>
<p>a R color name or an hexadecimal code referring to
the color used to fill the part of barplots that contain species in excess
in species-rich FEs. It refers to the FORed value. Default:
<code>color_fill_fored = "darkolivegreen2"</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_color_line_fred">color_line_fred</code></td>
<td>
<p>a R color name or an hexadecimal code referring to
the color used to draw the horizontal line referring to the FRed value.
Default: <code>color_line_fred = "darkolivegreen4"</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_color_fill_bar">color_fill_bar</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color used to draw barplots. Default: <code>color_fill_bar = "grey80"</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_color_fill_fvuln">color_fill_fvuln</code></td>
<td>
<p>a R color name or an hexadecimal code referring to
the color used to fill barplot containing only one species for
illustrating FVuln. Default: <code>color_fill_fvuln = "lightcoral"</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_color_arrow_fvuln">color_arrow_fvuln</code></td>
<td>
<p>a R color name or an hexadecimal code referring to
the color used to draw the horizontal arrow showing the proportion of FEs
containing only one species for illustrating FVuln. If there is only
one FE containing one species, the arrow will be a point. Default:
<code>color_arrow_fvuln = "indianred4"</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_size_line_fred">size_line_fred</code></td>
<td>
<p>a numeric value referring to the size of the
horizontal line illustrating FRed. Default: <code style="white-space: pre;">&#8288;size_line_fred = 1.5.&#8288;</code></p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_size_arrow_fvuln">size_arrow_fvuln</code></td>
<td>
<p>a numeric value referring to the size of the arrow
showing the proportion of FEs containing only one species. Default:
<code>size_arrow_fvuln = 1</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.fe.plot_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check_input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>patchwork</code> object with a barplot of number of species per
FE. Indices names provided in 'plot_ind_nm' are illustrated. Functional
Redundancy (average number of species per FE) is illustrated with a
horizontal line. Functional Over-redundancy (proportion of species in
excess in FE richer than average) is illustrated with top part of these
bars filled with 'color_fill_fored'. Functional Vulnerability (proportion
of FE with a single species) is illustrated with bars of these vulnerable
FE filled with 'color_fill_fvuln' and the double-head arrow highlighting
their number. FE-based indices values on top of the plot. if
<code>name_file</code> is provided, plot saved as a 300dpi png file in the
working directory.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>References</h3>

<p>Mouillot <em>et al.</em> (2014) Functional over-redundancy and high functional
vulnerability in global fish faunas on tropical reefs. <em>PNAS</em>, <strong>111</strong>,
13757-13762.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe
data("fruits_traits", package = "mFD")

# Load Traits categories dataframe
data("fruits_traits_cat", package = "mFD")

# Load Assemblages*Species matrix
data("baskets_fruits_weights", package = "mFD")

# Remove continuous trait
fruits_traits  &lt;- fruits_traits[ , -5]
fruits_traits_cat &lt;- fruits_traits_cat[-5, ]

# Compute gathering species into FEs
sp_to_fe_fruits &lt;- mFD::sp.to.fe(
  sp_tr       = fruits_traits, 
  tr_cat      = fruits_traits_cat, 
  fe_nm_type  = "fe_rank", 
  check_input = TRUE)
 
# Get the occurrence matrix
asb_sp_fruits_summ &lt;- mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights) 
asb_sp_fruits_occ &lt;- asb_sp_fruits_summ$"asb_sp_occ"

# Compute alpha fd indices
alpha_fd_fe_fruits &lt;- mFD::alpha.fd.fe(
  asb_sp_occ       = asb_sp_fruits_occ, 
  sp_to_fe         = sp_to_fe_fruits,
  ind_nm           = c("fred", "fored", "fvuln"),
  check_input      = TRUE, 
  details_returned = TRUE)
  
# Plot fd fe indices
mFD::alpha.fd.fe.plot(
  alpha_fd_fe       = alpha_fd_fe_fruits, 
  plot_asb_nm       = c("basket_1"), 
  plot_ind_nm       = c("fred", "fored", "fvuln"),
  name_file         = NULL,
  color_fill_fored  = "darkolivegreen2",
  color_line_fred   = "darkolivegreen4",
  color_fill_bar    = "grey80",
  color_fill_fvuln  = "lightcoral",
  color_arrow_fvuln = "indianred4",
  size_line_fred    = 1.5,
  size_arrow_fvuln  = 1,
  check_input       = TRUE) 
</code></pre>

<hr>
<h2 id='alpha.fd.hill'>Compute Functional alpha-Diversity indices based on Hill Numbers</h2><span id='topic+alpha.fd.hill'></span>

<h3>Description</h3>

<p>Compute functional alpha diversity applied to distance between species
following the framework from Chao <em>et al.</em>(2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.fd.hill(
  asb_sp_w,
  sp_dist,
  q = c(0, 1, 2),
  tau = "mean",
  check_input = TRUE,
  details_returned = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.fd.hill_+3A_asb_sp_w">asb_sp_w</code></td>
<td>
<p>a matrix with weight of species (columns) in a set
of assemblages (rows). Rows and columns should have names. NA are not
allowed.</p>
</td></tr>
<tr><td><code id="alpha.fd.hill_+3A_sp_dist">sp_dist</code></td>
<td>
<p>a matrix or dist object with distance between
species. Species names should be provided and match those in 'asb_sp_w'.
NA are not allowed.</p>
</td></tr>
<tr><td><code id="alpha.fd.hill_+3A_q">q</code></td>
<td>
<p>a vector containing values referring to the order of
diversity to consider, could be 0, 1 and/or 2.</p>
</td></tr>
<tr><td><code id="alpha.fd.hill_+3A_tau">tau</code></td>
<td>
<p>a character string with name of function to apply to
distance matrix (i.e. among all pairs of species) to get the threshold
used to define 'functionally indistinct set of species'. Could be 'mean'
(default), 'min' or 'max'. If tau = 'min' and there are null values in
<code>sp_dist</code>, the threshold is the lowest strictly positive value and a
warning message is displayed.</p>
</td></tr>
<tr><td><code id="alpha.fd.hill_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.hill_+3A_details_returned">details_returned</code></td>
<td>
<p>a logical value indicating whether the user
want to store values used for computing indices (see list below)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with: </p>

<ul>
<li> <p><em>asb_FD_Hill</em> a matrix containing indices values for each level
of q (columns, named as 'FD_qx') for each assemblage (rows, named as in
<strong>asb_sp_w</strong>)
</p>
</li>
<li> <p><em>tau_dist</em> the threshold value applied to distance between
species to compute diversity according to function provided in <strong>tau</strong>
</p>
</li>
<li><p> if <strong>details_returned</strong> turned to TRUE a list <em>details</em>
with
</p>

<ul>
<li> <p><em>asb_totw</em> a vector with total weight of each assemblage
</p>
</li>
<li> <p><em>asb_sp_relw</em> a matrix with relative weight of species in
assemblages
</p>
</li></ul>

</li></ul>



<h3>Note</h3>

<p>FD is computed applying the special case where function 'f' in
equation 3c is linear:f(dij(tau)) = dij(tau)/tau, hence f(0) = 0
and f(tau) = 1. FD computed with q=2 and tau = 'max' is equivalent to
the Rao's quadratic entropy from Ricotta &amp; Szeidl (2009, J Theor Biol).
FD computed with tau = 'min' is equivalent to Hill number taxonomic
diversity, thus with q=0 it is species richness (S), with q = 1 it is
exponential of Shannon entropy (H) and with q = 2 it is 1/(1-D) where D is
Simpson diversity.  Note that even when q=0, weights of species are
accounted for in FD. Hence to compute FD based only on distance between
species present in an assemblage (i.e. a richness-like index) , asb_sp_w
has to contain only species presence/absence coded as 0/1 with q=0 and
tau = 'mean'. If asb_sp_w contains only 0/1 and q&gt;0, it means that all
species have the same contribution to FD.
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>References</h3>

<p>Chao <em>et al.</em> (2019) An attribute diversity approach to functional
diversity, functional beta diversity, and related (dis)similarity
measures. <em>Ecological Monographs</em>, <strong>89</strong>, e01343.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data('fruits_traits', package = 'mFD')

# Load Assemblages*Species dataframe:      
data('baskets_fruits_weights', package = 'mFD') 
  
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute alpha fd hill indices:
alpha.fd.hill(
   asb_sp_w         = baskets_fruits_weights, 
   sp_dist          = sp_dist_fruits, 
   q                = c(0, 1, 2),
   tau              = 'mean', 
   check_input      = TRUE, 
   details_returned = TRUE)
</code></pre>

<hr>
<h2 id='alpha.fd.multidim'>Compute a set of alpha functional indices for a set of assemblages</h2><span id='topic+alpha.fd.multidim'></span>

<h3>Description</h3>

<p>This function computes a set of multidimensional space based indices of
alpha functional diversity. The user can choose which functional indices to
compute.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.fd.multidim(
  sp_faxes_coord,
  asb_sp_w,
  ind_vect = c("fide", "fdis", "fmpd", "fnnd", "feve", "fric", "fdiv", "fori", "fspe"),
  scaling = TRUE,
  check_input = TRUE,
  details_returned = TRUE,
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.fd.multidim_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a chosen
functional space. Species coordinates have been retrieved thanks to
<code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_asb_sp_w">asb_sp_w</code></td>
<td>
<p>a matrix linking weight of species (columns) and a
set of assemblages (rows).</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_ind_vect">ind_vect</code></td>
<td>
<p>a vector of character string of the name of
functional indices to compute. <strong>Indices names must be written in
lower case letters</strong>. Possible indices to compute are: 'fide', fdis',
'fmpd', 'fnnd', 'feve', 'fric', 'fdiv', 'fori' and 'fspe'. Default: all
the indices are computed.</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_scaling">scaling</code></td>
<td>
<p>a logical value indicating if scaling is to be done
(TRUE) or not (FALSE) on functional indices. Scaling is used to be able to
compare indices values between assemblages. Default: scaling = TRUE.</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_details_returned">details_returned</code></td>
<td>
<p>a logical value indicating whether the user
want to store details. Details are used in graphical functions and thus
must be kept if the user want to have graphical outputs for the computed
indices.</p>
</td></tr>
<tr><td><code id="alpha.fd.multidim_+3A_verbose">verbose</code></td>
<td>
<p>a logical value indicating whether progress details should be
printed in the console. If <code>FALSE</code> does not provide percent progress when
computing diversity indices.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The following list is returned: </p>

<ul>
<li> <p><em>functional_diversity_indices</em> matrix containing indices values
(columns) for each assemblage (rows)
</p>
</li>
<li> <p><em>details</em> list: a <strong>asb_sp_occ</strong> data.frame of species
occurrences in each assemblage ; a <strong>asb_sp_relatw</strong> matrix of
relative weight of species in each assemblage ; a <strong>sp_coord_all_asb</strong>
list of matrices of species coordinates along functional axes for species
present in each assemblage ; a <strong>vert_nm_all_asb</strong> list of vectors of
species names being vertices of the convex hull for each assemblage ; a
<strong>mst_all_asb</strong> list of data.frames summarizing link between species
in the minimum spanning tree of each assemblage ; a
<strong>grav_center_vert_coord_all_asb</strong> list of vectors of coordinates of
the vertices gravity center for each assemblage ; a
<strong>mean_dtogravcenter_all_asb</strong> list of vectors containing mean
distance to the species gravity center for each assemblage ; a
<strong>dist_gravcenter_global_pool</strong> vector containing the distance of each
species to the gravity center of all species from the global pool ; a
<strong>dist_nn_global_pool</strong> data.frame showing the distances of each
species from the global pool to its nearest neighbor ; a
<strong>nm_nn_all_asb</strong> data.frame containing the name of each nearest
neighbor of each species present in a given assemblage ; a
<strong>dist_nn_all_asb</strong> data.frame containing distance of each species
present in a given assemblage to its nearest neighbor.</p>
</li></ul>



<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data('fruits_traits', package = 'mFD')

# Load Assemblages*Species dataframe:      
data('baskets_fruits_weights', package = 'mFD')

# Load Traits categories dataframe:
data('fruits_traits_cat', package = 'mFD')  
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
 
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits, 
  maxdim_pcoa         = 10,
  deviation_weighting = 'absolute',
  fdist_scaling       = FALSE,
  fdendro             = 'average')
  
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute alpha diversity indices
alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c('PC1', 'PC2', 'PC3', 'PC4')],
  asb_sp_w         = baskets_fruits_weights, 
  ind_vect         = c('fdis', 'fmpd', 'fnnd', 'feve', 'fric', 'fdiv', 
                       'fori', 'fspe'),
  scaling          = TRUE, 
  check_input      = TRUE, 
  details_returned = TRUE)
  
# Retrieve alpha diversity indices table
fd_ind_values_fruits &lt;- alpha_fd_indices_fruits$functional_diversity_indices
fd_ind_values_fruits
</code></pre>

<hr>
<h2 id='alpha.multidim.plot'>Plot functional space and chosen functional indices</h2><span id='topic+alpha.multidim.plot'></span>

<h3>Description</h3>

<p>Compute a graphical representation of functional indices. <strong>To plot
functional indices, functional indices values must have been retrieve
through the use of the</strong> <code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code> <strong>function</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha.multidim.plot(
  output_alpha_fd_multidim,
  plot_asb_nm,
  ind_nm = c("fide", "fric", "fdiv", "fdis", "feve", "fori", "fspe", "fnnd"),
  faxes = NULL,
  faxes_nm = NULL,
  range_faxes = c(NA, NA),
  color_bg = "grey95",
  shape_sp = c(pool = 3, asb1 = 21, asb2 = 21),
  size_sp = c(pool = 0.7, asb1 = 1, asb2 = 1),
  color_sp = c(pool = "grey50", asb1 = "#0072B2", asb2 = "#D55E00"),
  color_vert = c(pool = "grey50", asb1 = "#0072B2", asb2 = "#D55E00"),
  fill_sp = c(pool = NA, asb1 = "#FFFFFF30", asb2 = "#FFFFFF30"),
  fill_vert = c(pool = NA, asb1 = "#0072B2", asb2 = "#D55E00"),
  color_ch = c(pool = NA, asb1 = "#0072B2", asb2 = "#D55E00"),
  fill_ch = c(pool = "white", asb1 = "#0072B2", asb2 = "#D55E00"),
  alpha_ch = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
  shape_centroid_fdis = c(asb1 = 22, asb2 = 22),
  shape_centroid_fdiv = c(asb1 = 24, asb2 = 25),
  shape_centroid_fspe = 23,
  color_centroid_fspe = "black",
  size_sp_nm = 3,
  color_sp_nm = "black",
  plot_sp_nm = NULL,
  fontface_sp_nm = "plain",
  save_file = FALSE,
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha.multidim.plot_+3A_output_alpha_fd_multidim">output_alpha_fd_multidim</code></td>
<td>
<p>a list of objects retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code> function.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_plot_asb_nm">plot_asb_nm</code></td>
<td>
<p>a vector containing name(s) of assemblage(s) to plot.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_ind_nm">ind_nm</code></td>
<td>
<p>a vector of character string of the name of functional
indices to plot. <strong>Indices names must be written in lower case
letters</strong>. Possible indices to compute are: &quot;fdis&quot;, &quot;feve&quot;, &quot;fric&quot;, &quot;fdiv&quot;,
&quot;fori&quot; and &quot;fspe&quot;. Default: all the indices are computed.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_faxes">faxes</code></td>
<td>
<p>a vector with names of axes to plot. <strong>You can only plot
from 2 to 4 axes for graphical reasons: vector length should be between 2
and 4</strong>. Default: faxes = NULL (the four first axes will be plotted).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_faxes_nm">faxes_nm</code></td>
<td>
<p>a vector with axes labels if the user want different axes
labels than <code>faxes</code> ones. Default: faxes_nm = faxes (labels will the
the same that <code>faxes</code> ones).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_range_faxes">range_faxes</code></td>
<td>
<p>a vector with minimum and maximum for values for axes.
Note that to have a fair representation of position of species in all
plots, all axes must have the same range. Default: faxes_lim = c(NA, NA)
(the range is computed according to the range of values among all axes, all
axes having the same range).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_bg">color_bg</code></td>
<td>
<p>a R color name  or an hexadecimal code used to fill plot
background. Default: <code>color_bg = "grey95"</code>.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a vector gathering numeric values referring to the symbol
used to draw species from the global pool and the plotted assemblage(s).
It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).
(0 = high transparency, 1 = no transparency).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_size_sp">size_sp</code></td>
<td>
<p>a vector gathering numeric values referring to the size of
species belonging to the global pool and the plotted assemblage(s).
It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the color of species from the global pool and studied
assemblage(s). It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_vert">color_vert</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the color of vertices from the global pool and studied
assemblage(s). It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the filled color of species from the global pool and studied
assemblage(s). It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the filled color of vertices from the global pool and studied
assemblage(s). It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_ch">color_ch</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the color of the convex pool of the global pool and studied
assemblage(s). It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_fill_ch">fill_ch</code></td>
<td>
<p>a vector gathering R color names or hexadecimal codes
referring to the color to fill the convex pool of the global pool and
studied assemblage(s).
It should be written as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_alpha_ch">alpha_ch</code></td>
<td>
<p>a vector gathering numeric values referring to the opacity
of convex hulls of the global pool and the plotted assemblage(s).
It should be written  as c(pool = &quot;...&quot;, asb1 = &quot;...&quot;, ...).
(0 = high transparency, 1 = no transparency).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_shape_centroid_fdis">shape_centroid_fdis</code></td>
<td>
<p>a vector gathering numeric value(s) used to draw
FDis centroid size.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_shape_centroid_fdiv">shape_centroid_fdiv</code></td>
<td>
<p>a vector gathering numeric value(s) used to draw
FDiv centroid size.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_shape_centroid_fspe">shape_centroid_fspe</code></td>
<td>
<p>a vector gathering numeric value used to draw
FSpe centroid (i.e. center of the functional space) size.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_centroid_fspe">color_centroid_fspe</code></td>
<td>
<p>a vector gathering R color name or
hexadecimal code used to draw FSpe centroid (i.e. center of the
functional space) color.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_size_sp_nm">size_sp_nm</code></td>
<td>
<p>a numeric value referring to the size of species names
if plotted.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_color_sp_nm">color_sp_nm</code></td>
<td>
<p>a R color name or hexadecimal code referring to the
color of names of species if plotted.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_plot_sp_nm">plot_sp_nm</code></td>
<td>
<p>a vector containing species names that are to be plotted.
Default: <code>plot_nm_sp = NULL</code> (no name plotted).</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_fontface_sp_nm">fontface_sp_nm</code></td>
<td>
<p>a character string for font of species labels (e.g.
&quot;italic&quot;, &quot;bold&quot;). Default: <code>fontface_sp_nm = 'plain'</code>.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_save_file">save_file</code></td>
<td>
<p>a logical value telling if plots should be locally
saved or not.</p>
</td></tr>
<tr><td><code id="alpha.multidim.plot_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If  <code>name_file</code> is <code>NULL</code>, it returns a list of one
<code>ggplot2</code> plots per functional index containing plots for combinations
of up to four axes, a <code>patchwork</code> figure gathering all combinations of
axes and a <code>ggplot2</code> figure showing the plot caption. If
<code>name_file</code> is not <code>NULL</code>, then those plots are saved locally.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>

# Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD")

# Compute functional distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits,
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")

# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute alpha diversity indices:
alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fdis", "fmpd", "fnnd", "feve", "fric", "fdiv",
                       "fori", "fspe"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)

# Plot all fd alpha indices:
plots_alpha &lt;- mFD::alpha.multidim.plot(
output_alpha_fd_multidim = alpha_fd_indices_fruits,
plot_asb_nm              = c("basket_1", "basket_5"),
ind_nm                   = c("fdis", "fide", "fnnd", "feve", 
                             "fric", "fdiv", "fori", 
                             "fspe"),
faxes                    = NULL,
faxes_nm                 = NULL,
range_faxes              = c(NA, NA),
color_bg                 = "grey95",
shape_sp                 = c(pool = 3, asb1 = 21, 
                             asb2 = 21),
size_sp                  = c(pool = 0.7, asb1 = 1, 
                             asb2 = 1),
color_sp                 = c(pool = "grey50", 
                             asb1 = "#1F968BFF",
                             asb2 = "#DCE319FF"),
color_vert               = c(pool = "grey50", 
                             asb1 = "#1F968BFF",
                             asb2 = "#DCE319FF"),
fill_sp                 = c(pool =  NA, 
                            asb1 = "#1F968BFF",
                            asb2 = "#DCE319FF"),
fill_vert               = c(pool = NA, 
                            asb1 = "#1F968BFF",
                            asb2 = "#DCE319FF"),
color_ch                = c(pool = NA, 
                            asb1 = "#1F968BFF",
                            asb2 = "#DCE319FF"),
fill_ch                 = c(pool = "white", 
                            asb1 = "#1F968BFF",
                            asb2 = "#DCE319FF"),
alpha_ch                = c(pool = 1, asb1 = 0.3, 
                            asb2 = 0.3),
shape_centroid_fdis     = c(asb1 = 22,  asb2 = 24),
shape_centroid_fdiv     = c(asb1 = 22,  asb2 = 24),
shape_centroid_fspe     = 23,
color_centroid_fspe     = "black",
size_sp_nm              = 3, 
color_sp_nm             = "black",
plot_sp_nm              = NULL,
fontface_sp_nm          = "plain",
save_file               = FALSE,
check_input             = TRUE) 

# Check FRic plot:
plots_alpha$fric$patchwork

</code></pre>

<hr>
<h2 id='asb.sp.summary'>Summarize Assemblage x Species data frame</h2><span id='topic+asb.sp.summary'></span>

<h3>Description</h3>

<p>This function computes a summary helping you to picture assemblages. For
this function to work, there must be no NA in your <code>asb_sp_w</code> data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>asb.sp.summary(asb_sp_w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="asb.sp.summary_+3A_asb_sp_w">asb_sp_w</code></td>
<td>
<p>a matrix showing assemblages (rows) composition in species
(columns). Note that species names <strong>must be</strong> the names of rows.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>
<table>
<tr><td><code>asb_sp_w_occ</code></td>
<td>
<p>a matrix with species occurrences in each
assemblage.</p>
</td></tr>
<tr><td><code>sp_tot_w</code></td>
<td>
<p>a vector gathering species biomass/abundance per
species.</p>
</td></tr>
<tr><td><code>asb_tot_w</code></td>
<td>
<p>a vector gathering total abundance/biomass per
assemblage.</p>
</td></tr>
<tr><td><code>asb_sp_richn</code></td>
<td>
<p>a vector gathering species richness per
assemblage.</p>
</td></tr>
<tr><td><code>asb_sp_nm</code></td>
<td>
<p>a list gathering the names of species of each
assemblage.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Assemblages x Species Matrix
data('baskets_fruits_weights', package = 'mFD')

# Summarize Assemblages Data
mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights)
</code></pre>

<hr>
<h2 id='background.plot'>Plot background of multidimensional plots</h2><span id='topic+background.plot'></span>

<h3>Description</h3>

<p>This function creates a ggplot object with customized axes range
(same for both), names and background
</p>


<h3>Usage</h3>

<pre><code class='language-R'>background.plot(range_faxes, faxes_nm, color_bg)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="background.plot_+3A_range_faxes">range_faxes</code></td>
<td>
<p>a vector with minimum and maximum values of axes. Note
that to have a fair representation of position of species in all plots,
they should have the same range. Default: <code>range_faxes = c(NA, NA)</code> (the
range is computed according to the range of values among all axes).</p>
</td></tr>
<tr><td><code id="background.plot_+3A_faxes_nm">faxes_nm</code></td>
<td>
<p>a vector with axes labels for figure.</p>
</td></tr>
<tr><td><code id="background.plot_+3A_color_bg">color_bg</code></td>
<td>
<p>a R color name  or an hexadecimal code used to fill plot
background. Default: <code>color_bg = "grey95"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object plotting background of multidimensional graphs.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'> background &lt;- background.plot(range_faxes = c(-1, 2), 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90")
 background 
</code></pre>

<hr>
<h2 id='baskets_fruits_weights'>Dataset: Baskets Composition in Fruits Species</h2><span id='topic+baskets_fruits_weights'></span>

<h3>Description</h3>

<p>This dataset represents the abundance of 25 fruits species in 10 baskets.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>baskets_fruits_weights
</code></pre>


<h3>Format</h3>

<p>A matrix of integers with 10 rows (baskets) and 25 columns
(species).
</p>


<h3>See Also</h3>

<p><code>fruits_traits</code>, <code>fruits_traits_cat</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Assemblages x Species Matrix
data("baskets_fruits_weights", package = "mFD")
baskets_fruits_weights[1:5, 1:5]

# Summarize Assemblages Data
mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights)

## End(Not run)
</code></pre>

<hr>
<h2 id='beta.fd.hill'>Compute Functional beta-Diversity indices based on Hill Numbers</h2><span id='topic+beta.fd.hill'></span>

<h3>Description</h3>

<p>Compute functional beta-diversity indices based on Hill numbers applied to
distance between species following the framework from Chao <em>et al.</em> (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.fd.hill(
  asb_sp_w,
  sp_dist,
  q = c(0, 1, 2),
  tau = "mean",
  beta_type = "Jaccard",
  check_input = TRUE,
  details_returned = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta.fd.hill_+3A_asb_sp_w">asb_sp_w</code></td>
<td>
<p>a matrix with weight of species (columns) in a set
of assemblages (rows). Rows and columns should have names. NA are not
allowed.</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_sp_dist">sp_dist</code></td>
<td>
<p>a matrix or dist object with distance between
species. Species names should be provided and match those in 'asb_sp_w'.
NA are not allowed.</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_q">q</code></td>
<td>
<p>a vector containing values referring to the order of
diversity to use</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_tau">tau</code></td>
<td>
<p>a character string with name of function to apply to
distance matrix (i.e. among all pairs of species) to get the threshold
used to define 'functionally indistinct set of species'. Could be qet to
'mean' (default), 'min' or 'max'.</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_beta_type">beta_type</code></td>
<td>
<p>a character string with name of framework used for
computing beta-diversity, either 'Jaccard' (default) or 'Sorensen'.</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check_input = TRUE</code>.</p>
</td></tr>
<tr><td><code id="beta.fd.hill_+3A_details_returned">details_returned</code></td>
<td>
<p>a logical value indicating whether the user
want to store values used for computing indices (see list below)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>

<ul>
<li> <p><em>asb_FDbeta</em> a list with for each value of q a <em>dist</em>
object with beta functional diversity indices for all pairs of assemblages
item if <strong>store.details</strong> turned to TRUE a list <em>details</em> with
</p>

<ul>
<li> <p><em>malpha_fd_q</em> a list with for each value of q a <em>dist</em>
object with mean alpha functional diversity indices for all pairs of
assemblages
</p>
</li>
<li> <p><em>gamma_fd_q</em> a list with for each value of q a <em>dist</em>
object with gamma functional diversity indices for all pairs of assemblages
</p>
</li></ul>

</li></ul>



<h3>Note</h3>

<p>When q=1 Jaccard-like and Sorensen-like beta-diversity are identical.
FD computed with tau='min' is equivalent to Hill number taxonomic beta
diversity. If tau='min' and there are species with null distance, tau is
set to the minimum non-null value and a warning message is displayed.
Indices values are stored as <em>dist</em> objects to optimize memory.
See below example of how merging distance values in a <em>dataframe</em> with
<code><a href="#topic+dist.to.df">dist.to.df</a></code>
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>References</h3>

<p>Chao <em>et al.</em> (2019) An attribute diversity approach to functional
diversity, functional beta diversity, and related (dis)similarity
measures. <em>Ecological Monographs</em>, <strong>89</strong>, e01343.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data('fruits_traits', package = 'mFD')

# Load Traits types dataframe:      
data('fruits_traits_cat', package = 'mFD')
   
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute beta functional hill indices:
baskets_beta &lt;- beta.fd.hill(
      asb_sp_w         = baskets_fruits_weights, 
      sp_dist          = sp_dist_fruits, 
      q                = c(0,1,2), 
      tau              = 'mean',
      beta_type        = 'Jaccard', 
      check_input      = TRUE, 
      details_returned = TRUE)
 
# Then use the mFD::dist.to.df function to ease visualizing result:
## for q = 0:
mFD::dist.to.df(list_dist = list(FDq2 = baskets_beta$beta_fd_q$q0))
## for q = 1:
mFD::dist.to.df(list_dist = list(FDq2 = baskets_beta$beta_fd_q$q1))
## for q = 2:
mFD::dist.to.df(list_dist = list(FDq2 = baskets_beta$beta_fd_q$q2))
</code></pre>

<hr>
<h2 id='beta.fd.multidim'>Compute Functional beta-Diversity indices for pairs of assemblages in a
multidimensional space</h2><span id='topic+beta.fd.multidim'></span>

<h3>Description</h3>

<p>Computes a set of indices of pairwise functional beta-diversity
(dissimilarity and its turnover and nestedness-resultant components) based
on overlap between convex hulls in a multidimensional space. For details
about indices formulas see Villeger <em>et al.</em> (2013). This functions stands
on <code><a href="betapart.html#topic+functional.betapart.core.pairwise">functional.betapart.core.pairwise</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.fd.multidim(
  sp_faxes_coord,
  asb_sp_occ,
  check_input = TRUE,
  beta_family = "Jaccard",
  details_returned = TRUE,
  betapart_step = TRUE,
  betapart_chullopt = list(conv1 = "Qt", conv2 = "QJ"),
  betapart_para = FALSE,
  betapart_para_opt = betapart::beta.para.control()
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta.fd.multidim_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix with coordinates of species (rows) on
functional axes (columns). Species coordinates have been retrieved thanks
to <code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_asb_sp_occ">asb_sp_occ</code></td>
<td>
<p>a matrix with presence/absence (coded as 0/1)
of species (columns) in a set of assemblages (rows).</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_check_input">check_input</code></td>
<td>
<p>a logical value defining whether inputs are
checked before computation of indices. Possible error messages will thus
may be more understandable for the user than R error messages. Default:
<code>check_input = TRUE</code>.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_beta_family">beta_family</code></td>
<td>
<p>a character string for the type of beta-diversity
index to use, 'Jaccard' (default) and/or 'Sorensen'.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_details_returned">details_returned</code></td>
<td>
<p>a logical value indicating whether the user
wants to details_returned. Details are used in the graphical function
<code>beta.multidim.plot</code> and thus must be kept if the user want to have
graphical outputs for the computed indices.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_betapart_step">betapart_step</code></td>
<td>
<p>a logical value indicating whether the
computation progress should be displayed in the R console. Default:
<code>betapart_step = TRUE</code>.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_betapart_chullopt">betapart_chullopt</code></td>
<td>
<p>a A list of two named vectors of character conv1
and conv2 defining the options that will be used to compute the convex
hulls (through the options of geometry::convhulln function). For further
details  see help of
<code><a href="betapart.html#topic+functional.betapart.core.pairwise">functional.betapart.core.pairwise</a></code>.
Default: <code>betapart_chullopt = c(conv1 = 'Qt', conv2 = 'QJ')</code>.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_betapart_para">betapart_para</code></td>
<td>
<p>a logical value indicating whether internal
parallelization should be used to compute pairwise dissimilarities.
Default: <code>betapart_para = FALSE</code>.</p>
</td></tr>
<tr><td><code id="beta.fd.multidim_+3A_betapart_para_opt">betapart_para_opt</code></td>
<td>
<p>a list with details about parallelization.
Default value means those parameters are set according to computer
specifications. <code>nc</code> is the number of cores (default = 4),
<code>type</code> is a character string with code of method used
(default PSOCK), <code>LB</code> is a boolean specifying whether load-balancing
is applied (default is TRUE) and <code>size</code> is a numeric value for number
of tasks performed at each time (default is 1). See help of
<code><a href="betapart.html#topic+functional.betapart.core.pairwise">functional.betapart.core.pairwise</a></code> for more
details.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with: </p>
 <ul>
<li> <p><em>pairasb_fbd_indices</em> a list with
for each
index a <em>dist</em> object with values for all pairs of assemblages.
Indices names start with the abbreviation of the type of dissimilarity
index ('jac' for Jaccard-like and 'sor' for Sorensen-like dissimilarity)
and end with abbreviation of component ('diss': dissimilarity, 'turn' its
turnover component, and 'nest' its nestedness-resultant component).
</p>
</li>
<li><p> if <em>store_details</em> is TRUE, </p>
</li>
<li> <p><em>details_beta</em> list:
<strong>inputs</strong> a list with <em>sp_faxes_coord</em> and <em>asb_sp_occ</em>
on which indices were computed (required for drawing graphics),
<strong>pool_vertices</strong> a list of vectors (1 per assemblage) with names of
species being vertices of the convex hull shaping all species;
<strong>asb_FRic</strong> a vector with volume of the convex hull shaping each
assemblage (relative to volume filled by all species) ;
<strong>asb_vertices</strong> a list of vectors (1 per assemblage) with names of
species being vertices of the convex hull</p>
</li></ul>



<h3>Note</h3>

<p>All assemblages should have a number of species strictly higher than
the number of functional axes.
Computing intersection of convex hulls in space of &gt;5 dimensions is yet
impossible with most computers.
This function uses R libraries 'betapart' (&gt; =1.5.4) for indices
computation.
Indices values are stored as <em>dist</em> objects to optimize memory.
See below example of how merging distance values in a <em>dataframe</em> with
<code>dist.to.df</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>References</h3>

<p>Villeger <em>et al.</em> (2013) Decomposing functional beta-diversity reveals that
low functional beta-diversity is driven by low functional turnover in
European fish assemblages. <em>Global Ecology and Biogeography</em>, <strong>22</strong>,
671-681.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
 # Load Species*Traits dataframe:
data('fruits_traits', package = 'mFD')

# Load Assemblages*Species dataframe:      
data('baskets_fruits_weights', package = 'mFD') 

# Load Traits categories dataframe:
data('fruits_traits_cat', package = 'mFD') 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
 sp_dist             = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = 'absolute',
 fdist_scaling       = FALSE,
 fdendro             = 'average')
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Get the occurrence dataframe:
asb_sp_fruits_summ &lt;- mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights) 
asb_sp_fruits_occ &lt;- asb_sp_fruits_summ$'asb_sp_occ'

# Compute beta diversity indices:
beta_fd_fruits &lt;- mFD::beta.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c('PC1', 'PC2', 'PC3', 'PC4')], 
  asb_sp_occ       = asb_sp_fruits_occ,
  check_input      = TRUE,
  beta_family      = c('Jaccard'),
  details_returned = TRUE)

# merging pairwise beta-diversity indices in a data.frame
dist.to.df(beta_fd_fruits$pairasb_fbd_indices)

## End(Not run)
</code></pre>

<hr>
<h2 id='beta.multidim.plot'>Illustrate Functional beta-Diversity indices for pairs of assemblages in a
multidimensional space</h2><span id='topic+beta.multidim.plot'></span>

<h3>Description</h3>

<p>Illustrate overlap between convex hulls shaping species assemblages in a
multidimensional functional space.<strong>Before plotting beta functional
diversity indices should have been computed using the</strong>
<code><a href="#topic+beta.fd.multidim">beta.fd.multidim</a></code> <strong>function</strong>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>beta.multidim.plot(
  output_beta_fd_multidim,
  plot_asb_nm,
  beta_family,
  plot_sp_nm = NULL,
  faxes = NULL,
  name_file = NULL,
  faxes_nm = NULL,
  range_faxes = c(NA, NA),
  color_bg = "grey95",
  shape_sp = c(pool = 3, asb1 = 22, asb2 = 21),
  size_sp = c(pool = 0.7, asb1 = 1.2, asb2 = 1),
  color_sp = c(pool = "grey50", asb1 = "blue", asb2 = "red"),
  fill_sp = c(pool = NA, asb1 = "white", asb2 = "white"),
  fill_vert = c(pool = NA, asb1 = "blue", asb2 = "red"),
  color_ch = c(pool = NA, asb1 = "blue", asb2 = "red"),
  fill_ch = c(pool = "white", asb1 = "blue", asb2 = "red"),
  alpha_ch = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
  nm_size = 3,
  nm_color = "black",
  nm_fontface = "plain",
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="beta.multidim.plot_+3A_output_beta_fd_multidim">output_beta_fd_multidim</code></td>
<td>
<p>the list returned by
<code><a href="#topic+beta.fd.multidim">beta.fd.multidim</a></code> when <code>details_returned = TRUE</code>.
Thus, even if this function will illustrate functional beta-diversity for
a single pair of assemblages, plots will be scaled according to all
assemblages for which indices were computed.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_plot_asb_nm">plot_asb_nm</code></td>
<td>
<p>a vector with names of the 2 assemblages for which
functional beta-diversity will be illustrated.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_beta_family">beta_family</code></td>
<td>
<p>a character string for the type of beta-diversity index
for which values will be printed, <code>'Jaccard'</code> (default) and/or
<code>'Sorensen'</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_plot_sp_nm">plot_sp_nm</code></td>
<td>
<p>a vector containing species names that are to be plotted.
Default: <code>plot_nm_sp = NULL</code> (no name plotted).</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_faxes">faxes</code></td>
<td>
<p>a vector with names of axes to plot (as columns names in
<code>output_beta_fd_multidim$details$input$sp_faxes_coord</code> ). <strong>You
can only plot from 2 to 4 axes for graphical reasons</strong>.
Default: <code>faxes = NULL</code> (the four first axes will be plotted).</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_name_file">name_file</code></td>
<td>
<p>a character string with name of file to save the figure
(without extension). Default: <code>name_file = NULL</code> which means plot is
displayed.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_faxes_nm">faxes_nm</code></td>
<td>
<p>a vector with axes labels for figure. Default: as
<code>faxes</code>).</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_range_faxes">range_faxes</code></td>
<td>
<p>a vector with minimum and maximum values of axes. Note
that to have a fair representation of position of species in all plots,
they should have the same range. Default: <code>faxes_lim = c(NA, NA)</code> (the
range is computed according to the range of values among all axes).</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_color_bg">color_bg</code></td>
<td>
<p>a R color name or an hexadecimal code used to fill
plot background. Default: <code>color_bg = "grey95"</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a vector with 3 numeric values referring to the shape of
symbol used for species from the 'pool' absent from the 2 assemblages, and
for species present in the 2 assemblages ('asb1', and 'asb2'),
respectively. Default: <code>shape_sp = c(pool = 3, asb1 = 22, asb2 = 21)</code> so
cross, square and circle.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_size_sp">size_sp</code></td>
<td>
<p>a numeric value referring to the size of symbols for
species. Default: <code style="white-space: pre;">&#8288;is size_sp = c(pool = 0.8, asb1 = 1, asb2 = 1)&#8288;</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
colour of symbol for species. Default is:
<code>color_sp = c(pool = "grey50", asb1 = "blue", asb2 = "red")</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
color to fill symbol (if <code>shape_sp</code> &gt; 20) for species of the pool and
of the 2 assemblages. Default is:
<code>fill_sp = c(pool = NA, asb1 = "white", asb2 = "white")</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes
referring to the colour to fill symbol (if <code>shape_sp</code> &gt; 20) for
species being vertices of the convex hulls of the pool of species and of
the 2 assemblages. Default is:
<code>fill_vert = c(pool = NA, asb1 = "blue", asb2 = "red")</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_color_ch">color_ch</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
border of the convex hulls of the pool of species and by the 2 assemblages.
Default is: <code>color_ch = c(pool = NA, asb1 = "blue", asb2 = "red")</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_fill_ch">fill_ch</code></td>
<td>
<p>a vector with 3 names or hexadecimal codes referring to the
filling of the convex hull of the pool of species and of the 2 assemblages.
Default is <code>fill_ch = c(pool = "white", asb1 = "blue", asb2 = "red")</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_alpha_ch">alpha_ch</code></td>
<td>
<p>a vector with 3 numeric value for transparency of
the filling of the convex hulls (0 = high transparency, 1 = no
transparency). Default is:
<code>alpha_ch = c(pool = 1, asb1 = 0.3, asb2 = 0.3)</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_nm_size">nm_size</code></td>
<td>
<p>a numeric value for size of species label. Default is <code>3</code>
(in points).</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_nm_color">nm_color</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species label. Default is <code>black.</code></p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_nm_fontface">nm_fontface</code></td>
<td>
<p>a character string for font of species labels (e.g.
&quot;italic&quot;, &quot;bold&quot;). Default is <code>'plain'</code>.</p>
</td></tr>
<tr><td><code id="beta.multidim.plot_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>name_file</code> is <code>NULL</code>, it returns a <code>patchwork</code>
figure with overlap between convex hulls projected in 2-dimensional spaces
for the given pair of assemblages. Values of functional beta-diversity
indices are shown on top-right corner of the figure. If <code>name_file</code> is
not <code>NULL</code>, the plot is saved locally.
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
 data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD")

# Compute functional distance
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits,
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")

# Retrieve species coordinates matrix:
 sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Get the occurrence dataframe:
 asb_sp_fruits_summ &lt;- mFD::asb.sp.summary(asb_sp_w = baskets_fruits_weights)
 asb_sp_fruits_occ &lt;- asb_sp_fruits_summ$"asb_sp_occ"

# Compute beta diversity indices:
 beta_fd_fruits &lt;- mFD::beta.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_occ       = asb_sp_fruits_occ,
  check_input      = TRUE,
  beta_family      = c("Jaccard"),
  details_returned = TRUE)

# Compute beta fd plots:
 beta.multidim.plot(
   output_beta_fd_multidim = beta_fd_fruits,
   plot_asb_nm             = c("basket_1", "basket_6"),
   beta_family             = c("Jaccard"),
   plot_sp_nm              = c("apple", "cherry", "lemon"),
   faxes                   = paste0("PC", 1:4),
   name_file               = NULL,
   faxes_nm                = NULL,
   range_faxes             = c(NA, NA),
   color_bg                = "grey95",
   shape_sp                = c(pool = 3, asb1 = 22, asb2 = 21),
   size_sp                 = c(pool = 0.8, asb1 = 1, asb2 = 1),
   color_sp                = c(pool = "grey50", asb1 = "blue",
                               asb2 = "red"),
   fill_sp                 = c(pool = NA, asb1 = "white", asb2 = "white"),
   fill_vert               = c(pool = NA, asb1 = "blue", asb2 = "red"),
   color_ch                = c(pool = NA, asb1 = "blue", asb2 = "red"),
   fill_ch                 = c(pool = "white", asb1 = "blue",
                               asb2 = "red"),
   alpha_ch                = c(pool = 1, asb1 = 0.3, asb2 = 0.3),
   nm_size                 = 3,
   nm_color                = "black",
   nm_fontface             = "plain",
   check_input             = TRUE)

</code></pre>

<hr>
<h2 id='dist.nearneighb'>Compute distance of a given point to its nearest neighbor in the functional
space and the identity of the nearest neighbor</h2><span id='topic+dist.nearneighb'></span>

<h3>Description</h3>

<p>This function is used in functional indices computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.nearneighb(sp_faxes_coord, ref_sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.nearneighb_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a chosen
functional space. Species coordinates have been retrieved thanks to
<code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="dist.nearneighb_+3A_ref_sp">ref_sp</code></td>
<td>
<p>a character string referring to the name of the reference
species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing the nearest neighbor identity <code>nn_id</code> and a
list of the distance of the reference point to its nearest neighbor
<code>nn_ref_sp_dist</code>.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
 data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits, 
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")
 
# Retrieve species coordinates matrix:
 sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute the distance of "pear" to its nearest neighbor(s):
 dist_nn_pear &lt;- dist.nearneighb(sp_faxes_coord_fruits, ref_sp = "pear")
 dist_nn_pear
</code></pre>

<hr>
<h2 id='dist.point'>Compute distances of all points to a given point in the functional space</h2><span id='topic+dist.point'></span>

<h3>Description</h3>

<p>This function computes the distances of all species to a reference species.
It is used in FSpe, FOri and FNND computation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.point(sp_faxes_coord, ref_sp)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.point_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a chosen functional
space. Species coordinates have been retrieved thanks to
<code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="dist.point_+3A_ref_sp">ref_sp</code></td>
<td>
<p>a character string referring to the name of the reference
species.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of species distances to the reference species.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
 data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits, 
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")
 
# Retrieve species coordinates matrix:
 sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Retrieve the distances of all species to "pear":
 dist_pear &lt;- dist.point(sp_faxes_coord_fruits, ref_sp = "pear")
 dist_pear
</code></pre>

<hr>
<h2 id='dist.to.df'>Merge distance object(s) into a single data frame</h2><span id='topic+dist.to.df'></span>

<h3>Description</h3>

<p>This function merges distance object(s) into a single data frame which rows
are pairs of elements and column(s) distance metric(s). It stands on the
<code><a href="dendextend.html#topic+dist_long">dist_long</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dist.to.df(list_dist)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dist.to.df_+3A_list_dist">list_dist</code></td>
<td>
<p>a list of dist object(s). All dist objects should have a
name (e.g. name of distance metric) and the same labels (i.e. names of
sets between which distance was computed).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame which first and second columns (names <code>x1</code> and <code>x2</code>)
contain names of the 2 sets involved in each pair, and with one column for
each dist object (named after its name in <code>list_dist</code>.
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create dist objects: 
dist_A &lt;- round(dist(matrix(runif(10, 0, 1), 5, 2, 
                      dimnames = list(letters[1:5], NULL))), 2)
dist_B &lt;- round(dist(matrix(runif(10, 0, 1), 5, 2, 
                      dimnames = list(letters[1:5], NULL))), 2)
dist_C &lt;- round(dist(matrix(runif(10, 0, 1), 5, 2, 
                      dimnames = list(letters[1:5], NULL))), 2)

# First example with only 1 distance:
dist.to.df(list(dA = dist_A))

# Second example with 3 distances:
dist.to.df(list(d1 = dist_A, d2 = dist_B, d3 = dist_C))
</code></pre>

<hr>
<h2 id='fdis.plot'>Plot FDis index</h2><span id='topic+fdis.plot'></span>

<h3>Description</h3>

<p>This function plots FDis index for a given pair of functional axes and for
one or several assemblages. It adds segments between species relative
weights and assemblage cenntroid on the background plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdis.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_fide_coord2D,
  plot_sp = TRUE,
  shape_sp,
  color_sp,
  fill_sp,
  shape_fide,
  size_fide,
  color_fide,
  fill_fide,
  color_segment,
  width_segment,
  linetype_segment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdis.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_asb_fide_coord2d">asb_fide_coord2D</code></td>
<td>
<p>a list (with names as in <code>asb_sp_coord2D</code>) of
vectors with coordinates of the fide centroid of species for each assemblage
for a given pair of axes.</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_shape_fide">shape_fide</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used
for fide centroid if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_size_fide">size_fide</code></td>
<td>
<p>a numeric value referring to the size of the symbol used for
fide centroid plotting if one assemblage to plot or a vector numeric values
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 = &quot;secondRsize&quot;,
...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_color_fide">color_fide</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color
of fide centroid if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_fill_fide">fill_fide</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
to fill assemblage centroid symbol (if <code>shape_sp</code> &gt; 20) if one
assemblage to plot or a vector of R color names or hexadecimal codes if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 =
&quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_color_segment">color_segment</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of of the segment linking axes and centroid from the studied
assemblage if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_width_segment">width_segment</code></td>
<td>
<p>a numeric value referring to the width of the segment
linking fide centroid and functional axes if one assemblage to plot or a
vector numeric values if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRsize&quot;, asb2 = &quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdis.plot_+3A_linetype_segment">linetype_segment</code></td>
<td>
<p>a numeric value referring to the linetype of the
segment linking fide centroid and functional axes if one assemblage to plot
or a vector numeric values if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRlinetype&quot;, asb2 = &quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing FDis index for one or several assemblage(s)
and a given pair of functional axes.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm         = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
 sp_faxes_coord    = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fdis"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve fide values through alpha.fd.multidim outputs:
 fruits_asb_fide_coord2D &lt;- 
  alpha_fd_indices_fruits$functional_diversity_indices[c("fide_PC1", 
                                                         "fide_PC2")]
 fruits_asb_fide_coord2D_b1 &lt;- fruits_asb_fide_coord2D[c("basket_1"), ]
 fruits_asb_sp_relatw_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_sp_relatw["basket_1", ]

 # Retrieve FDis plot:
 fdis_plot &lt;- fdis.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_fide_coord2D = list(basket_1 = fruits_asb_fide_coord2D_b1),
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           shape_fide = list(basket_1 = 18),
           size_fide = list(basket_1 = 5),
           color_fide = list(basket_1 = "blue"),
           fill_fide = list(basket_1 = "blue"),
           color_segment = list(basket_1 = "red"),
           width_segment = list(basket_1 = 1),
           linetype_segment = list(basket_1 = "dashed"))
           
 fdis_plot
</code></pre>

<hr>
<h2 id='fdiv.plot'>Plot FDiv indice</h2><span id='topic+fdiv.plot'></span>

<h3>Description</h3>

<p>This plot fDiv indice for a given pair of functional axes and one or several
assemblages. This function adds mean distance to center of gravity of
vertices, points and vertices of 1:N assemblages on the background plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fdiv.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_vertices_nD,
  asb_vertG_coord2D,
  plot_sp = TRUE,
  shape_sp,
  color_sp,
  fill_sp,
  shape_vert,
  color_vert,
  fill_vert,
  shape_vertG,
  size_vertG,
  color_vertG,
  fill_vertG
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fdiv.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_asb_vertices_nd">asb_vertices_nD</code></td>
<td>
<p>a list (with names as in asb_sp_coord2D) of vectors
with names of species being vertices in n dimensions.</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_asb_vertg_coord2d">asb_vertG_coord2D</code></td>
<td>
<p>a list (with names as in asb_sp_coord2D) containing
for each assemblage the coordinates of center of gravity of vertices for a
given pair of axes</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code>.</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_shape_vert">shape_vert</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used
for vertices plotting if one assemblage to plot or a vector numeric values
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_color_vert">color_vert</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of vertices if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...). If color_vert = NA,
vertices are not plotted (for shapes only defined by color, ie shape
inferior to 20. Otherwise <code>fill</code> must also be set to NA).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of vertices symbol filling  (if <code>shape_vert</code> &gt;20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...). If <code>fill = NA</code> and <code>color = NA</code>, vertices are not plotted (if
<code>shape_vert</code> superior to 20</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_shape_vertg">shape_vertG</code></td>
<td>
<p>a numeric value referring to the shape to use to plot the
center of gravity of vertices if one assemblage to plot or a vector numeric
values if several assemblages to plot. If more than one assemblage to plot,
the vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_size_vertg">size_vertG</code></td>
<td>
<p>a numeric value referring to the size of the symbol used
for the center of gravity of vertices if one assemblage to plot or a vector
numeric values if several assemblages to plot. If more than one assemblage
to plot, the vector should be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 =
&quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_color_vertg">color_vertG</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the center of gravity of vertices. if one assemblage to plot or a
vector of R color names or hexadecimal codes if several assemblages to
plot. If more than one assemblage to plot, the vector should be formatted
as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fdiv.plot_+3A_fill_vertg">fill_vertG</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color to fill the center of gravity of vertices (if <code>shape_vert</code> &gt;20)
if one assemblage to plot or a vector of R color names or hexadecimal codes
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 =
&quot;secondRcolorname&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object plotting background of multidimensional graphs and
FDiv indice.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FDiv:
 alpha_fd_ind &lt;- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_faxes_coord_fruits[ , c("PC1", "PC2", "PC3", "PC4")],
asb_sp_w         = baskets_fruits_weights,
ind_vect         = c("fdiv"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)
  
 # Retrieve inputs of the fdiv.plot() function for "basket_1" and PC1, PC2
 # ... through alpha.fd.multidim outputs:
 fruits_asb_sp_relatw_b1 &lt;- 
         alpha_fd_ind$details$asb_sp_relatw["basket_1", ]
 fruits_asb_vertices_nD_b1_2D &lt;- 
                     alpha_fd_ind$details$asb_vert_nm["basket_1"]
 fruits_asb_vertG_coord_b1 &lt;- 
                     alpha_fd_ind$details$asb_G_coord["basket_1"]
 fruits_asb_vertG_coord_b1_2D &lt;- 
             fruits_asb_vertG_coord_b1[[1]][c("PC1", "PC2")]
 
 # Retrieve FDiv plot:
 fdiv_plot &lt;- fdiv.plot(
           ggplot_bg         = ggplot_bg_fruits,
           asb_sp_coord2D    = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw     = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_vertices_nD   = fruits_asb_vertices_nD_b1_2D,
           asb_vertG_coord2D = list(basket_1 = fruits_asb_vertG_coord_b1_2D),
           plot_sp           = TRUE,
           shape_sp          = 16,
           color_sp          = c(basket_1 = "red"),
           fill_sp           = "red",
           color_vert        = "red",
           fill_vert         = "red",
           shape_vert        = 16,
           shape_vertG       = list(basket_1 = 18),
           size_vertG        = list(basket_1 = 2),
           color_vertG       = list(basket_1 = "blue"),
           fill_vertG        = list(basket_1 = "blue"))
 fdiv_plot
</code></pre>

<hr>
<h2 id='feve.plot'>Plot FEve index</h2><span id='topic+feve.plot'></span>

<h3>Description</h3>

<p>This function plots FEve index for a given pair of functional axes and one
or several assemblages. It adds Minimum Spanning Tree (MST) of a given
assemblage on the background plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>feve.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_mst,
  plot_sp = TRUE,
  shape_sp,
  color_sp,
  fill_sp,
  color_mst,
  width_mst,
  linetype_mst
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="feve.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_asb_mst">asb_mst</code></td>
<td>
<p>a list (with names as in <code>asb_sp_coord2D</code>) of
vectors with names of species linked in the MST of the
studied assemblage.</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="feve.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_color_mst">color_mst</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
the MST if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_width_mst">width_mst</code></td>
<td>
<p>a numeric value referring to the width of segments of the
MST if one assemblage to plot or a vector numeric values if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 = &quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="feve.plot_+3A_linetype_mst">linetype_mst</code></td>
<td>
<p>a numeric value referring to the linetype of the segments
representing the MST if one assemblage to plot or a vector numeric values
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRlinetype&quot;, asb2 =
&quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object showing FEve index on the background plot.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("feve"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve fide values through alpha.fd.multidim outputs:
 fruits_asb_mst_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_mst["basket_1"]
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
 fruits_asb_sp_relatw_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_sp_relatw["basket_1", ]
         
 # Retrieve FEve plot:
 feve_plot &lt;- feve.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_mst = fruits_asb_mst_b1,
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           color_mst = list(basket_1 = "blue"),
           width_mst = list(basket_1 = 1),
           linetype_mst = list(basket_1 = "solid"))
           
 feve_plot
</code></pre>

<hr>
<h2 id='fide.plot'>Plot FIde index</h2><span id='topic+fide.plot'></span>

<h3>Description</h3>

<p>Plot FIde index given a pair of functional axes for one or several
assemblages. It adds the centroid of species for each assemblage and
segments showing centroid coordinates on functional axes on the background
plot.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fide.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_fide_coord2D,
  plot_sp = TRUE,
  shape_sp,
  color_sp,
  fill_sp,
  shape_fide,
  size_fide,
  color_fide,
  fill_fide,
  color_segment,
  width_segment,
  linetype_segment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fide.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_asb_fide_coord2d">asb_fide_coord2D</code></td>
<td>
<p>a list (with names as in asb_sp_coord2D) of
vectors with coordinates of the centroid of species for each assemblage
for a given pair of axes.</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="fide.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_shape_fide">shape_fide</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used
for fide centroid plotting if one assemblage to plot or a vector numeric
values if several assemblages to plot. If more than one assemblage to plot,
the vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_size_fide">size_fide</code></td>
<td>
<p>a numeric value referring to the size of the symbol used for
fide centroid plotting if one assemblage to plot or a vector numeric values
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 = &quot;secondRsize&quot;,
...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_color_fide">color_fide</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of species centroid for agiven assemblage if one assemblage to plot
or a vector of R color names or hexadecimal codes if several assemblages to
plot. If more than one assemblage to plot, the vector should be formatted
as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_fill_fide">fill_fide</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
to fill assemblage centroid symbol (if <code>shape_sp</code> &gt; 20) if one
assemblage to plot or a vector of R color names or hexadecimal codes if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 =
&quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_color_segment">color_segment</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of of the segment linking axes and centroid from the studied
assemblage if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_width_segment">width_segment</code></td>
<td>
<p>a numeric value referring to the width of the segment
linking fide centroid and functional axes if one assemblage to plot or a
vector numeric values if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRsize&quot;, asb2 = &quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="fide.plot_+3A_linetype_segment">linetype_segment</code></td>
<td>
<p>a numeric value referring to the linetype of the
segment linking fide centroid and functional axes if one assemblage to plot
or a vector numeric values if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRlinetype&quot;, asb2 = &quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object with FIde index, species and background.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
 sp_faxes_coord    = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fide"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve fide values through alpha.fd.multidim outputs:
 fruits_asb_fide_coord2D &lt;- 
  alpha_fd_indices_fruits$functional_diversity_indices[c("fide_PC1", 
                                                         "fide_PC2")]
 fruits_asb_fide_coord2D_b1 &lt;- fruits_asb_fide_coord2D[c("basket_1"), ]
 fruits_asb_sp_relatw_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_sp_relatw["basket_1", ]
 
 # Retrieve FIde plot:
 fide_plot &lt;- fide.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_fide_coord2D = list(basket_1 = fruits_asb_fide_coord2D_b1),
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           shape_fide = list(basket_1 = 18),
           size_fide = list(basket_1 = 5),
           color_fide = list(basket_1 = "blue"),
           fill_fide = list(basket_1 = "blue"),
           color_segment = list(basket_1 = "red"),
           width_segment = list(basket_1 = 1),
           linetype_segment = list(basket_1 = "dashed"))
           
 fide_plot
</code></pre>

<hr>
<h2 id='fnnd.plot'>Plot FNND index</h2><span id='topic+fnnd.plot'></span>

<h3>Description</h3>

<p>This function plots FNND index for a given pair of functional axes and for
one or several assemblages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fnnd.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_nn_asb,
  plot_sp = TRUE,
  shape_sp,
  color_sp,
  fill_sp,
  color_segment,
  width_segment,
  linetype_segment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fnnd.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_asb_nn_asb">asb_nn_asb</code></td>
<td>
<p>a list gathering for each species of a studied assemblage
its nearest neighbour(s) in the assemblage.</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape used to plot species
belonging to the studied assemblage.</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_color_segment">color_segment</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of of the segment linking nearest neighbors in a given assemblage or
a vector of R color names or hexadecimal codes if several assemblages to
plot. If more than one assemblage to plot, the vector should be formatted
as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_width_segment">width_segment</code></td>
<td>
<p>a numeric value referring to the size of the segment
linking nearest neighbors in a given assemblage or a vector of numeric
values if several assemblages to plot. If more than one assemblage to plot,
the vector should be formatted as: c(asb1 = &quot;firstRwidth&quot;, asb2 =
&quot;secondRwidth&quot;, ...).</p>
</td></tr>
<tr><td><code id="fnnd.plot_+3A_linetype_segment">linetype_segment</code></td>
<td>
<p>a character string referring to the linetype used to
link nearest neighbors in the studied assemblages or a vector of character
strings if several assemblages to plot. If more than one assemblage to
plot, the vector should be formatted as: c(asb1 = &quot;firstRlinetype&quot;, asb2 =
&quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object with FNND index.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fnnd"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve nearest neighbor(s) names and relative weights ...
 # ... through alpha.fd.multidim outputs:
 fruits_asb_nn_asb_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_nm_nn_asb["basket_1"]
 fruits_asb_sp_relatw_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_sp_relatw["basket_1", ]

 # Retrieve FNND plot:
 fnnd_plot &lt;- fnnd.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_nn_asb = fruits_asb_nn_asb_b1 ,
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           color_segment = list(basket_1 = "blue"),
           width_segment = list(basket_1 = 1),
           linetype_segment = list(basket_1 = "solid"))
           
 fnnd_plot
</code></pre>

<hr>
<h2 id='fori.plot'>Plot FOri</h2><span id='topic+fori.plot'></span>

<h3>Description</h3>

<p>This function plots FOri index for a given pair of functional axes and for
one or several assemblages. It adds the distance of species from the studied
to their nearest neighbour(s) from the global pool.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fori.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  asb_nn_pool,
  pool_coord2D,
  plot_pool = TRUE,
  plot_sp = TRUE,
  shape_pool,
  size_pool,
  color_pool,
  fill_pool,
  shape_sp,
  color_sp,
  fill_sp,
  color_segment,
  width_segment,
  linetype_segment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fori.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_asb_nn_pool">asb_nn_pool</code></td>
<td>
<p>a list gathering for each species of a studied assemblage
its nearest neighbour(s) in the global pool.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_pool_coord2d">pool_coord2D</code></td>
<td>
<p>a matrix (ncol = 2) with coordinates of
species present in the global pool for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_plot_pool">plot_pool</code></td>
<td>
<p>a logical value indicating whether species of each
assemblage should be plotted or not. Default: <code>plot_pool = TRUE</code>.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="fori.plot_+3A_shape_pool">shape_pool</code></td>
<td>
<p>a numeric value referring to the shape used to plot species
pool.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_size_pool">size_pool</code></td>
<td>
<p>a numeric value referring to the size of species belonging
to the global pool.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_color_pool">color_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the pool.  This color is also used for FRic convex hull color.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_fill_pool">fill_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
colour to fill species symbol (if <code>shape_sp</code> &gt; 20) and the assemblage
convex hull.</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_color_segment">color_segment</code></td>
<td>
<p>color_segment a R color name or an hexadecimal code
referring to the color of of the segment linking nearest neighbors in the
global pool or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_width_segment">width_segment</code></td>
<td>
<p>a numeric value referring to the size of the segment
linking nearest neighbors in the global pool or a vector of numeric
values if several assemblages to plot. If more than one assemblage to plot,
the vector should be formatted as: c(asb1 = &quot;firstRwidth&quot;, asb2 =
&quot;secondRwidth&quot;, ...).</p>
</td></tr>
<tr><td><code id="fori.plot_+3A_linetype_segment">linetype_segment</code></td>
<td>
<p>a character string referring to the linetype used to
link nearest neighbors in the global pool or a vector of character
strings if several assemblages to plot. If more than one assemblage to
plot, the vector should be formatted as: c(asb1 = &quot;firstRlinetype&quot;, asb2 =
&quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object with FOri index.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fori"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve nearest neighbor(s) names through alpha.fd.multidim outputs:
 fruits_asb_nn_pool_b1 &lt;- 
         alpha_fd_indices_fruits$details$asb_nm_nn_pool["basket_1"]

 # Retrieve FNND plot:
 fori_plot &lt;- fori.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           asb_nn_pool = fruits_asb_nn_pool_b1,
           pool_coord2D = sp_faxes_coord_fruits[, c("PC1", "PC2")],
           plot_pool = TRUE,
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           shape_pool = 4,
           size_pool = 2,
           color_pool = "grey",
           fill_pool = "grey",
           color_segment = list(basket_1 = "red"),
           width_segment = list(basket_1 = 1),
           linetype_segment = list(basket_1 = "solid"))
           
 fori_plot

## End(Not run)
</code></pre>

<hr>
<h2 id='fric.plot'>Plot FRic index</h2><span id='topic+fric.plot'></span>

<h3>Description</h3>

<p>This function plots FRic index for a given pair of functional axes and one
or several assemblages. It adds convex hull(s), points and vertices of
1:N assemblages on the background plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fric.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_vertices_nD,
  plot_sp = TRUE,
  color_ch,
  fill_ch,
  alpha_ch,
  shape_sp,
  size_sp,
  color_sp,
  fill_sp,
  shape_vert,
  size_vert,
  color_vert,
  fill_vert
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fric.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of axes for a given pair
of functional axes.</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_asb_vertices_nd">asb_vertices_nD</code></td>
<td>
<p>a list (with names as in asb_sp_coord2D) of vectors
with names of species being vertices in n dimensions.</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: plot_sp = TRUE.</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_color_ch">color_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of the border of the convex hull filled by the pool of species if one
assemblage to plot or a vector of R color names or hexadecimal codes if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 =
&quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_fill_ch">fill_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of convex hull filling if one assemblage to plot or a vector of R color
names or hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_alpha_ch">alpha_ch</code></td>
<td>
<p>a numeric value referring to the value of transparency of
the convex hull filling (0 = high transparency, 1 = no
transparency) if one assemblage to
plot or a vector numeric values if several assemblages to plot. If more
than one assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRtransparency&quot;, asb2 = &quot;secondRtransparency&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_size_sp">size_sp</code></td>
<td>
<p>a numeric value referring to the size of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 =
&quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_shape_vert">shape_vert</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used
for vertices plotting if one assemblage to plot or a vector numeric values
if several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_size_vert">size_vert</code></td>
<td>
<p>a numeric value referring to the size of the symbol used for
vertices plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRsize&quot;, asb2 =
&quot;secondRsize&quot;, ...).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_color_vert">color_vert</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of vertices if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...). If color_vert = NA,
vertices are not plotted (for shapes only defined by color, ie shape
inferior to 20. Otherwise <code>fill</code> must also be set to NA).</p>
</td></tr>
<tr><td><code id="fric.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of vertices symbol filling  (if <code>shape_vert</code> &gt;20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...). If <code>fill = NA</code> and <code>color = NA</code>, vertices are not plotted (if
<code>shape_vert</code> superior to 20</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object plotting background of multidimensional graphs and
FRic convex hulls.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
  sp_faxes_coord_fruits &lt;- 
    fspaces_quality_fruits$details_fspaces$sp_pc_coord
    
 # Retrieve species coordinates matrix for the assemblage "basket_1":
  sp_filter &lt;- mFD::sp.filter(asb_nm          = c("basket_1"), 
                              sp_faxes_coord = sp_faxes_coord_fruits, 
                              asb_sp_w       = baskets_fruits_weights)
  sp_faxes_coord_fruits_b1 &lt;- sp_filter$`species coordinates`
 
 # Reduce it to the two studid axes: PC1 and PC2:
 sp_faxes_coord_fruits_b1_2D &lt;- sp_faxes_coord_fruits_b1[, c("PC1", "PC2")]

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve vertices names:
 vert_nm_fruits &lt;- vertices(sp_faxes_coord_fruits_b1_2D, 
  order_2D = TRUE, check_input = TRUE)
                               
 # Plot in white the convex hull of all fruits species:
 ggplot_fric &lt;- mFD::fric.plot(
           ggplot_bg       = ggplot_bg_fruits,
           asb_sp_coord2D  = list(basket_1 = sp_faxes_coord_fruits_b1_2D),
           asb_vertices_nD = list(basket_1 = vert_nm_fruits),
           plot_sp         = TRUE,
           color_ch        = c("basket_1" = "black"), 
           fill_ch         = c("basket_1" = "white"), 
           alpha_ch        = c("basket_1" = 0.3),
           size_sp = c("basket_1" = 1),
           shape_sp = c("basket_1" = 16),
           color_sp = c("basket_1" = "red"),
           fill_sp = c("basket_1" = "red"),
           size_vert = c("basket_1" = 1),
           color_vert = c("basket_1" = "red"),
           fill_vert = c("basket_1" = "red"),
           shape_vert = c("basket_1" = 16))
 ggplot_fric
</code></pre>

<hr>
<h2 id='fruits_traits'>Dataset: Traits Values of Fruits Species</h2><span id='topic+fruits_traits'></span>

<h3>Description</h3>

<p>This dataset represents the value of 6 traits for 15 fruits species.
<strong>Important:</strong> Species names must be specified as the data frame row names
(not in an additional column).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fruits_traits
</code></pre>


<h3>Format</h3>

<p>A data frame with 25 rows (species) and the following columns
(traits):
</p>

<dl>
<dt>Size</dt><dd><p>an ordered factor describing the size of fruits species</p>
</dd>
<dt>Plant</dt><dd><p>an unordered factor describing the type of plant</p>
</dd>
<dt>Climate</dt><dd><p>an ordered factor describing the climate regions</p>
</dd>
<dt>Seed</dt><dd><p>an ordered factor describing the type of seed</p>
</dd>
<dt>Sugar</dt><dd><p>a numeric describing the quantity of sugar</p>
</dd>
<dt>Use.raw</dt><dd><p>an integer (percentage) describing the proportion of a raw
use (fuzzy trait) of the fruit</p>
</dd>
<dt>Use.pastry</dt><dd><p>an integer (percentage) describing the proportion of a
pastry use (fuzzy trait) of the fruit</p>
</dd>
<dt>Use.jam</dt><dd><p>an integer (percentage) describing the proportion of a
jam use (fuzzy trait) of the fruit</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code>fruits_traits_cat</code>, <code>baskets_fruits_weights</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Species x Traits Data Frame
data("fruits_traits", package = "mFD")
fruits_traits

# Load Traits Information
data("fruits_traits_cat", package = "mFD")
fruits_traits_cat

# Summarize Species x Traits Data
mFD::sp.tr.summary(tr_cat = fruits_traits_cat, sp_tr = fruits_traits)

## End(Not run)
</code></pre>

<hr>
<h2 id='fruits_traits_cat'>Dataset: Fruits Traits Informations</h2><span id='topic+fruits_traits_cat'></span>

<h3>Description</h3>

<p>This dataset summarizes information about the 6 traits used in the
<code>fruits_traits</code> dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fruits_traits_cat
</code></pre>


<h3>Format</h3>

<p>A data frame with 8 rows (traits) and the following three columns:
</p>

<dl>
<dt>trait_name</dt><dd><p>a character giving the trait name</p>
</dd>
<dt>trait_type</dt><dd><p>a character giving the trait type (<strong>O</strong> for Ordinal
trait, <strong>N</strong> for Nominal trait, <strong>Q</strong> for Quantitative trait, and <strong>F</strong>
for Fuzzy-coded trait)</p>
</dd>
<dt>fuzzy_name</dt><dd><p>a character giving the name of fuzzy-coded traits
(i.e. <code>Use</code>) to  which 'sub-traits' (i.e. <code>raw</code>, <code>pastry</code>, and <code>jam</code>)
belongs</p>
</dd>
</dl>



<h3>Note</h3>

<p>If your dataset does not contain fuzzy trait, the column <code>fuzzy_name</code>
can be ignored but the first two columns are mandatory.
</p>
<p>Traits in this dataset correspond to columns (traits) of the <code>fruits_traits</code>
dataset.
</p>


<h3>See Also</h3>

<p><code>fruits_traits</code>, <code>baskets_fruits_weights</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Traits Information
data("fruits_traits_cat", package = "mFD")
fruits_traits_cat

# Load Species x Traits Data Frame
data("fruits_traits", package = "mFD")

# Summarize Species x Traits Data
mFD::sp.tr.summary(tr_cat = fruits_traits_cat, sp_tr = fruits_traits)

## End(Not run)
</code></pre>

<hr>
<h2 id='fspe.plot'>Plot FSpe</h2><span id='topic+fspe.plot'></span>

<h3>Description</h3>

<p>This function plots FSpe index for a given pair of functional axes and for
one or several assemblages. It adds the mean position of species from the
global pool and the distance of each species from the studied assemblage(s)
on the background plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fspe.plot(
  ggplot_bg,
  asb_sp_coord2D,
  asb_sp_relatw,
  center_coord2D,
  pool_coord2D,
  plot_pool = TRUE,
  plot_sp = TRUE,
  shape_pool,
  size_pool,
  color_pool,
  fill_pool,
  shape_sp,
  color_sp,
  fill_sp,
  color_center,
  fill_center,
  shape_center,
  size_center,
  color_segment,
  width_segment,
  linetype_segment
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fspe.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_asb_sp_coord2d">asb_sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in each assemblage for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_asb_sp_relatw">asb_sp_relatw</code></td>
<td>
<p>a list of vector gathering species relative weight in
each assemblage. It can be retrieved through the
<code><a href="#topic+alpha.fd.multidim">alpha.fd.multidim</a></code>.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_center_coord2d">center_coord2D</code></td>
<td>
<p>a list containing the coordinates of the center of the
global pool for two given functional axes</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_pool_coord2d">pool_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in the global pool for a given pair of functional axes.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_plot_pool">plot_pool</code></td>
<td>
<p>a logical value indicating whether species of each
assemblage should be plotted or not. Default: <code>plot_pool = TRUE</code>.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_plot_sp">plot_sp</code></td>
<td>
<p>a logical value indicating whether species of each assemblage
should be plotted or not. Default: <code>plot_sp = TRUE</code></p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_shape_pool">shape_pool</code></td>
<td>
<p>a numeric value referring to the shape used to plot
species pool.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_size_pool">size_pool</code></td>
<td>
<p>a numeric value referring to the size of species belonging
to the global pool.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_color_pool">color_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the pool.  This color is also used for FRic convex hull color.
Default: <code>color_pool = "#0072B2"</code>.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_fill_pool">fill_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
colour to fill species symbol (if <code>shape_sp</code> &gt; 20) and the assemblage
convex hull.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_shape_sp">shape_sp</code></td>
<td>
<p>a numeric value referring to the shape of the symbol used for
species plotting if one assemblage to plot or a vector numeric values if
several assemblages to plot. If more than one assemblage to plot, the
vector should be formatted as: c(asb1 = &quot;firstRshape&quot;, asb2 =
&quot;secondRshape&quot;, ...).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_color_sp">color_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species if one assemblage to plot or a vector of R color names or
hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_fill_sp">fill_sp</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species symbol filling (if <code>shape_sp</code> &gt; 20) if one assemblage to
plot or a vector of R color names or hexadecimal codes if several
assemblages to plot. If more than one assemblage to plot, the vector should
be formatted as: c(asb1 = &quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;,
...).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_color_center">color_center</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the center of the global pool.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_fill_center">fill_center</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
colour to fill the center of the global pool (if <code>shape_sp</code> &gt; 20).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_shape_center">shape_center</code></td>
<td>
<p>a numeric value referring to the shape used to plot the
center of the global pool.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_size_center">size_center</code></td>
<td>
<p>a numeric value referring to the size of the center of
the global pool.</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_color_segment">color_segment</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the segments linking each species of a given assemblage to the
center of functional space if one assemblage to plot or a vector of R color
names or hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRcolorname&quot;, asb2 = &quot;secondRcolorname&quot;, ...).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_width_segment">width_segment</code></td>
<td>
<p>a numeric value referring to the
width of the segments linking each species of a given assemblage to the
center of functional space if one assemblage to plot or a vector of R color
names or hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRwidth&quot;, asb2 = &quot;secondRwidth&quot;, ...).</p>
</td></tr>
<tr><td><code id="fspe.plot_+3A_linetype_segment">linetype_segment</code></td>
<td>
<p>a character string referring to the
linetype of the segment linking each species of a given assemblage to the
center of functional space if one assemblage to plot or a vector of R color
names or hexadecimal codes if several assemblages to plot. If more than one
assemblage to plot, the vector should be formatted as: c(asb1 =
&quot;firstRlinetype&quot;, asb2 = &quot;secondRlinetype&quot;, ...).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object with FSpe index on the background plot.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
# Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
 c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve the matrix of species coordinates for "basket_1" and PC1 and PC2
 sp_filter &lt;- mFD::sp.filter(asb_nm          = "basket_1", 
                             sp_faxes_coord = sp_faxes_coord_fruits, 
                             asb_sp_w       = baskets_fruits_weights)
 fruits_asb_sp_coord_b1 &lt;- sp_filter$`species coordinates`
 fruits_asb_sp_coord2D_b1 &lt;- fruits_asb_sp_coord_b1[, c("PC1", "PC2")]
                               
 # Use alpha.fd.multidim() function to get inputs to plot FIde:
 alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
  sp_faxes_coord   = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  asb_sp_w         = baskets_fruits_weights,
  ind_vect         = c("fspe"),
  scaling          = TRUE,
  check_input      = TRUE,
  details_returned = TRUE)
  
 # Retrieve nearest neighbor(s) names through alpha.fd.multidim outputs:
 fruits_center_coord2D &lt;- 
         alpha_fd_indices_fruits$details$pool_O_coord[c("PC1", "PC2")]

 
 # Retrieve FNND plot:
 fspe_plot &lt;- fspe.plot(ggplot_bg = ggplot_bg_fruits,
           asb_sp_coord2D = list(basket_1 = fruits_asb_sp_coord2D_b1),
           asb_sp_relatw = list(basket_1 = fruits_asb_sp_relatw_b1),
           center_coord2D = fruits_center_coord2D,
           pool_coord2D = sp_faxes_coord_fruits[, c("PC1", "PC2")],
           plot_pool = TRUE,
           plot_sp = TRUE,
           shape_sp = 16,
           color_sp = "red",
           fill_sp = "red",
           shape_pool = 4,
           size_pool = 2,
           color_pool = "grey",
           fill_pool = "grey",
           color_center = "blue", 
           fill_center = "blue",
           shape_center = 18, 
           size_center = 3,
           color_segment = list(basket_1 = "red"),
           width_segment = list(basket_1 = 1),
           linetype_segment = list(basket_1 = "solid"))
           
 fspe_plot

## End(Not run)
</code></pre>

<hr>
<h2 id='funct.dist'>Compute functional distance between species</h2><span id='topic+funct.dist'></span>

<h3>Description</h3>

<p>For a given combination of traits, this function returns the functional
distance matrix between species.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funct.dist(
  sp_tr,
  tr_cat,
  metric,
  scale_euclid = "scale_center",
  ordinal_var = "classic",
  weight_type = "equal",
  stop_if_NA = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funct.dist_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame of traits values (columns) for each species
(rows).</p>
</td></tr>
<tr><td><code id="funct.dist_+3A_tr_cat">tr_cat</code></td>
<td>
<p>a data frame containing three columns for each trait (rows):
</p>

<ul>
<li> <p><strong>trait_name</strong>: the name of all traits as in <code>sp_tr</code> data
frame;
</p>
</li>
<li> <p><strong>trait_type</strong>: the category code for each trait as followed:
<code>N</code> for Nominal traits (factor variable), <code>O</code> for Ordinal traits
(ordered variable), <code>C</code> for Circular traits (integer values),
<code>Q</code> for quantitative traits (numeric values) that is allowed
<strong>only</strong> if there are at least 2 species with the same value, and
<code>F</code> for fuzzy traits (i.e. described with several values defined with
several column); </p>
</li>
<li> <p><strong>fuzzy_name</strong>: name of fuzzy-coded trait to
which 'sub-trait' belongs (if trait is not fuzzy, ignored so could be
trait name or NA). </p>
</li>
<li> <p><strong>trait_weight</strong>: Optional, a numeric vector
of length n (traits number) to specify a weight for each trait.
</p>
</li></ul>
</td></tr>
<tr><td><code id="funct.dist_+3A_metric">metric</code></td>
<td>
<p>the distance to be computed:
<code>euclidean</code>, the Euclidean distance,
<code>gower</code>, the Classical Gower distance as defined by Gower (1971), extent
by de Bello <em>et al.</em> (2021) and based on the <code><a href="gawdis.html#topic+gawdis">gawdis</a></code>
function.</p>
</td></tr>
<tr><td><code id="funct.dist_+3A_scale_euclid">scale_euclid</code></td>
<td>
<p>only when computing euclidean distance a string value to
compute (or not) scaling of quantitative traits using the
<code><a href="#topic+tr.cont.scale">tr.cont.scale</a></code> function.
Possible options are:
<code>range</code> (standardize by the range:
<code class="reqn">({x' = x - min(x) )} / (max(x) - min (x))</code>)
<code>center</code> (use the center transformation: <code class="reqn">x' = x - mean(x)</code>),
<code>scale</code> (use the scale transformation: <code class="reqn">x' = \frac{x}{sd(x)}</code>),
<code>scale_center</code> (use the scale-center transformation:
<code class="reqn">x' = \frac{x - mean(x)}{sd(x)}</code>), or
<code>noscale</code> traits are not scaled
Default is <code>scale_center</code>.</p>
</td></tr>
<tr><td><code id="funct.dist_+3A_ordinal_var">ordinal_var</code></td>
<td>
<p>a character string specifying the method to be used for
ordinal variables (i.e. ordered).
<code>classic</code> simply treats ordinal variables as continuous variables;
<code>metric</code> refers to Eq. 3 of Podani (1999);
<code>podani</code> refers to Eqs. 2a-b of Podani (1999),
Both options convert ordinal variables to ranks. Default is <code>classic</code>.</p>
</td></tr>
<tr><td><code id="funct.dist_+3A_weight_type">weight_type</code></td>
<td>
<p>the type of used method to weight traits.
<code>user</code> user defined weights in tr_cat,
<code>equal</code> all traits having the same weight.
More methods are available using <code><a href="gawdis.html#topic+gawdis">gawdis</a></code> from
<code>gawdis</code> package. To compute gower distance with fuzzy trait and
weight please refer to <code><a href="gawdis.html#topic+gawdis">gawdis</a></code>. Default is <code>equal</code>.</p>
</td></tr>
<tr><td><code id="funct.dist_+3A_stop_if_na">stop_if_NA</code></td>
<td>
<p>a logical value to stop or not the process if the
<code>sp_tr</code> data frame contains NA. Functional measures are sensitive to
missing traits. For further explanations, see the Note section.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>dist</code> object containing distance between each pair of species.
</p>


<h3>Note</h3>

<p>If the <code>sp_tr</code> data frame contains <code>NA</code> you can either
chose to compute anyway functional distances (but keep in mind that
<strong>Functional measures are sensitive to missing traits!</strong>) or you can
delete species with missing or extrapolate missing traits (see
Johnson <em>et al.</em> (2020)).
</p>


<h3>Author(s)</h3>

<p>Nicolas Loiseau and Sebastien Villeger
</p>


<h3>References</h3>

<p>de Bello <em>et al.</em> (2021) Towards a more balanced combination of multiple
traits when computing functional differences between species.
<em>Method in Ecology and Evolution</em>, <strong>12</strong>, 443-448.<br />
Gower (1971 ) A general coefficient of similarity and some of its
properties. <em>Biometrics</em>, <strong>27</strong>, 857-871.<br />
Johnson <em>et al.</em> (2020) Handling missing values in trait data.
<em>Global Ecology and Biogeography</em>, <strong>30</strong>, 51-62.<br />
Podani (1999) Extending Gower's general coefficient of similarity to ordinal
characters, <em>Taxon</em>, <strong>48</strong>, 331-340.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species x Traits data
data("fruits_traits", package = "mFD")

# Load Traits x Categories data
data("fruits_traits_cat", package = "mFD")

# Remove fuzzy traits for this example and thus remove lat column:
fruits_traits     &lt;- fruits_traits[ , -c(6:8)]
fruits_traits_cat &lt;- fruits_traits_cat[-c(6:8), ]
fruits_traits_cat &lt;- fruits_traits_cat[ , -3]

# Compute Functional Distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
sp_dist_fruits
</code></pre>

<hr>
<h2 id='funct.space.plot'>Plot species position in a functional space</h2><span id='topic+funct.space.plot'></span>

<h3>Description</h3>

<p>This function illustrates the position of species along pairs of axes of a
functional space
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funct.space.plot(
  sp_faxes_coord,
  faxes = NULL,
  name_file = NULL,
  faxes_nm = NULL,
  range_faxes = c(NA, NA),
  color_bg = "grey95",
  color_pool = "darkturquoise",
  fill_pool = "white",
  shape_pool = 21,
  size_pool = 1,
  plot_ch = TRUE,
  color_ch = "darkblue",
  fill_ch = "white",
  alpha_ch = 1,
  plot_vertices = TRUE,
  color_vert = "darkturquoise",
  fill_vert = "darkturquoise",
  shape_vert = 22,
  size_vert = 1,
  plot_sp_nm = NULL,
  nm_size = 3,
  nm_color = "black",
  nm_fontface = "plain",
  check_input = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funct.space.plot_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a
multidimensional functional space. Species coordinates have been retrieved
thanks to <code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_faxes">faxes</code></td>
<td>
<p>a vector with names of axes to plot (as columns names in
<code>sp_faxes_coord</code>). <strong>You can only plot from 2 to 4 axes for
graphical reasons</strong>. Default: <code>faxes = NULL</code> (the four first axes will be
plotted).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_name_file">name_file</code></td>
<td>
<p>a character string with name of file to save the
figure (without extension). Default: <code>name_file = NULL</code> which means plot
is displayed.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_faxes_nm">faxes_nm</code></td>
<td>
<p>a vector with axes labels for figure. Default: as
<code>faxes</code>).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_range_faxes">range_faxes</code></td>
<td>
<p>a vector with minimum and maximum values of axes
used for all plots to have a fair representation of position of species.
Default: <code>range_faxes = c(NA, NA)</code> (the range is computed
according to the range of values among all axes). If at least one of the
value provided is within the range of coordinates, then convex hull could
not be plotted so <code>plot_ch</code> should be <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_color_bg">color_bg</code></td>
<td>
<p>a R color name or an hexadecimal code used to fill plot
background. Default: <code>color_bg = "grey95"</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_color_pool">color_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of symbol for species. Default: <code>color_pool = 'darkgreen'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_fill_pool">fill_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color to fill species symbol (if <code>shape_pool</code> &gt;20). Default:
<code>fill_pool = 'white'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_shape_pool">shape_pool</code></td>
<td>
<p>a numeric value referring to the shape of symbol used for
species. Default: <code>shape_pool = 21</code> (filled circle).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_size_pool">size_pool</code></td>
<td>
<p>a numeric value referring to the size of symbol for
species. Default: <code>size_pool = 1</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_plot_ch">plot_ch</code></td>
<td>
<p>a logical value indicating whether the convex hull shaping
the pool of species should be illustrated. If <code>plot_ch = TRUE</code>, convex
hull of all species in the multidimensional space described in
<code>sp_faxes_coord</code> is computed and its projection in 2D spaces are
drawn as polygons. Default: <code>plot_ch = TRUE</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_color_ch">color_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
border of the convex hull filled by the pool of species. Default:
<code>color_ch = "darkblue"</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_fill_ch">fill_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
filling of the convex hull filled by the pool of species. Default:
<code>fill_ch = "white"</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_alpha_ch">alpha_ch</code></td>
<td>
<p>a numeric value for transparency of the filling of the
convex hull (0 = high transparency, 1 = no transparency). Default:
<code>alpha_ch = 1</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_plot_vertices">plot_vertices</code></td>
<td>
<p>a logical value defining whether vertices of the convex
hull shaping the pool of species should be illustrated. If
<code>plot_vertices = TRUE</code>, vertices of convex hull computed in the
multidimensional space from <code>sp_faxes_coord</code> and are plotted with
aesthetics listed below '..._vert' (species not being vertices are plotted
with aesthetics described above for '.._sp'. Default:
<code>plot_vertices = TRUE</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_color_vert">color_vert</code></td>
<td>
<p>a character value referring to the color of symbol for
vertices if <code>plot_vertices = TRUE</code>.
Default: <code>color_vert = 'darkturquoise'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a character value referring to the color for filling symbol
for vertices  (if <code>shape_vert</code> &gt;20). Default:
<code>fill_vert = 'darkturquoise'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_shape_vert">shape_vert</code></td>
<td>
<p>a numeric value referring to the symbol used to show
vertices position if <code>plot_vertices = TRUE</code>. Default: <code>shape_vert = 23</code>
(filled diamond).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_size_vert">size_vert</code></td>
<td>
<p>a numeric value referring to the size of symbol for
vertices Default: <code>size_vert = 1</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_plot_sp_nm">plot_sp_nm</code></td>
<td>
<p>a vector containing species names that are to be printed
near their position. Default: <code>plot_nm_sp = NULL</code> (no name plotted).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_nm_size">nm_size</code></td>
<td>
<p>a numeric value for size of species label. Default is <code>3</code>
(in points).</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_nm_color">nm_color</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the color
of species label. Default: <code>nm_color = 'black'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_nm_fontface">nm_fontface</code></td>
<td>
<p>a character string for font of species labels (e.g.
&quot;italic&quot;, &quot;bold&quot;). Default: <code>nm_fontface = 'plain'</code>.</p>
</td></tr>
<tr><td><code id="funct.space.plot_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check_input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>name_file</code> is <code>NULL</code>, a list containing <code>ggplot2</code>
objects is returned: plots of functional space along all pairs of axes
(named according to axes names, e.g. &quot;PC1_PC2&quot;), figure 'caption', and the
full figure 'patchwork' built using the library <code>patchwork</code>.
If <code>name_file</code> is not <code>NULL</code> a 300dpi png file
is saved in the working directory. Ranges of axes are the same for all
panels and if required projection of the convex hull computed in the
multidimensional space provided as input <code>sp_faxes_coord</code> is
illustrated with a polygon. Species being vertices of this convex hull are
shown with aesthetics provided as inputs <code>..._vert</code>. Labels for
species listed in <code>plot_sp_nm</code> are added with if required arrows
using <code>ggrepel</code>. Summary about species and dimensionality are printed
on top-right corner of the figure.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
 data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD")

# Compute functional distance
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat         = fruits_traits_cat,
                                  metric         = "gower",
                                  scale_euclid   = "scale_center",
                                  ordinal_var    = "classic",
                                  weight_type    = "equal",
                                  stop_if_NA     = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits,
  maxdim_pcoa         = 10,
  deviation_weighting = "absolute",
  fdist_scaling       = FALSE,
  fdendro             = "average")

# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Plot functional spaces:
mFD::funct.space.plot(
 sp_faxes_coord    = sp_faxes_coord_fruits[, c("PC1", "PC2", "PC3", "PC4")],
  faxes             = NULL,
  name_file         = NULL,
  faxes_nm          = NULL,
  range_faxes       = c(NA, NA),
  color_bg          = "grey95",
  color_pool          = "darkturquoise",
  fill_pool           = "white",
  shape_pool          = 21,
  size_pool           = 1,
  plot_ch           = TRUE,
  color_ch          = "darkblue",
  fill_ch           = "white",
  alpha_ch          = 1,
  plot_vertices     = TRUE,
  color_vert        = "darkturquoise",
  fill_vert         = "darkturquoise",
  shape_vert        = 22,
  size_vert         = 1,
 plot_sp_nm         = NULL,
 nm_size            = 3,
 nm_color           = "black",
 nm_fontface        = "plain",
 check_input        = TRUE)
</code></pre>

<hr>
<h2 id='fuse'>Compute FUSE (Functionally Unique, Specialized and Endangered)</h2><span id='topic+fuse'></span>

<h3>Description</h3>

<p>This index takes into account species functional uniqueness (also called
Functional Originality), species specialisation and species IUCN status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fuse(sp_dist, sp_faxes_coord, nb_NN = 5, GE, standGE = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fuse_+3A_sp_dist">sp_dist</code></td>
<td>
<p>a dist object provided by <code><a href="#topic+funct.dist">funct.dist</a></code>,
<code><a href="cluster.html#topic+daisy">daisy</a></code> or <code><a href="ade4.html#topic+dist.ktab">dist.ktab</a></code>.</p>
</td></tr>
<tr><td><code id="fuse_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a data frame with the coordinates of the species on a
multidimensional space based on a selected number of axes derived from a
Principal Coordinate Analysis (PCoA). The species are in rows and the PCOA
axes are in column.</p>
</td></tr>
<tr><td><code id="fuse_+3A_nb_nn">nb_NN</code></td>
<td>
<p>a numerical value giving the number of nearest neighbor to
consider. Default: <code>nb_NN = 5</code>.</p>
</td></tr>
<tr><td><code id="fuse_+3A_ge">GE</code></td>
<td>
<p>a numerical vector giving the IUCN status rank (DD = NA, LC = 0,
NT = 1, VU = 2, EN = 3, CR = 4) or the IUCN extinction probability
associated with each status. See Mooers <em>et al.</em> (2008) for further
information. For example, DD = NA, LC = 0, NT = 0.1, VU = 0.4, EN = 0.666,
and CR = 0.999).</p>
</td></tr>
<tr><td><code id="fuse_+3A_standge">standGE</code></td>
<td>
<p>a logical value to standardize the GE values.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame with species in rows and the following metrics in
columns:
</p>

<ul>
<li><p> FUSE: functionally unique, specialized and endangered (see
Pimiento <em>et al.</em> (2020);
</p>
</li>
<li><p> FUn_std: functional uniqueness standardized between 0 and 1 (see
Mouillot <em>et al.</em> (2013);
</p>
</li>
<li><p> FSp_std: functional specialization standardized between 0 and 1
(see Mouillot <em>et al.</em> (2013);
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Fabien Leprieur and Camille Albouy
</p>


<h3>References</h3>

<p>Mouillot <em>et al.</em> (2013) Rare species support vulnerable functions in
high-diversity ecosystems. <em>PLoS Biology</em>, <strong>11</strong>, e1001569.<br />
Pimiento <em>et al.</em> (2020) Functional diversity of marine megafauna in the
Anthropocene. <em>Science Advances</em>, <strong>6</strong>, eaay7650.<br />
Violle <em>et al.</em> (2007) Let the concept of trait be functional! <em>Oikos</em>,
<strong>116</strong>, 882-892.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load species traits data:
sp_tr &lt;- read.csv(system.file('extdata', 'data_traits_MMA_ursus.csv', 
  package = 'mFD'), dec = ',', sep = ';', header = TRUE, row.names = 1,
  na.strings='NA')

# Trait compilation and ordination:
dimorphism      &lt;- ordered(sp_tr$dimorphism)
breeding_site   &lt;- ordered(sp_tr$breeding_site)
social_behavior &lt;- ordered(sp_tr$social_behavior)
weight_max      &lt;- log(sp_tr$adult_weight_max)
social_group    &lt;- log(sp_tr$social_group_mean)
 
# Trait Matrix construction:
sp_tr_end &lt;- data.frame(
  main_diet = sp_tr$main_diet, 
  foraging_water_depth = sp_tr$foraging_water_depth,
  foraging_location = sp_tr$foraging_location, 
  fasting_strategy = sp_tr$fasting_strategy,
  female_sexual_maturity = sp_tr$female_sexual_maturity, 
  weaning = sp_tr$weaning,
  gestation = sp_tr$gestation, inter_litter = sp_tr$inter_litter,
  breeding_site = sp_tr$breeding_site, 
  social_group = sp_tr$social_group_mean,
  social_behavior = sp_tr$social_behavior, 
  weight_max = sp_tr$adult_weight_max,
  dimorphism = sp_tr$dimorphism)
  
rownames(sp_tr_end) &lt;- rownames(sp_tr)
 
# Function weigthing vector:
v &lt;- c(0.25, 0.25, 0.25, 0.25, 0.20, 0.20, 0.20, 0.20, 0.20, 0.5, 0.5, 0.5, 
  0.5)
   
# Gower distance calculation:
sp_tr_end$main_diet &lt;- as.factor(sp_tr_end$main_diet)
sp_tr_end$foraging_water_depth &lt;- as.factor(sp_tr_end$foraging_water_depth)
sp_tr_end$foraging_location &lt;- as.factor(sp_tr_end$foraging_location)
sp_tr_end$breeding_site &lt;- as.factor(sp_tr_end$breeding_site)
sp_tr_end$social_behavior &lt;- as.factor(sp_tr_end$social_behavior)

sp_dist_tr &lt;- cluster::daisy(sp_tr_end, metric = c('gower'), 
  type = list(symm = c(4)), weights = v)
  
# Principal coordinate analyses
Pcoa &lt;- ade4::dudi.pco(ade4::quasieuclid(sp_dist_tr), scann = FALSE, 
                       nf = 40)

sp_faxes_coord &lt;- Pcoa$li[1:40]
 
# FUSE calculation:
 FUSE_res &lt;- mFD::fuse(
    sp_dist        = sp_dist_tr, 
    sp_faxes_coord = as.matrix(sp_faxes_coord), 
    nb_NN          = 5,  
    GE             = sp_tr$IUCN_num,
    standGE        = TRUE)
 FUSE_res
    
 FUSE_res2 &lt;- mFD::fuse(
    sp_dist        = sp_dist_tr, 
    sp_faxes_coord = as.matrix(sp_faxes_coord), 
    nb_NN          = 5,
    GE             = sp_tr$IUCN_50,
    standGE        = TRUE)
 FUSE_res2
    
 FUSE_res3 &lt;- mFD::fuse(
    sp_dist        = sp_dist_tr, 
    sp_faxes_coord = as.matrix(sp_faxes_coord), 
    nb_NN          = 5, 
    GE             = sp_tr$IUCN_100,
    standGE        = TRUE)
 FUSE_res3
</code></pre>

<hr>
<h2 id='mst.computation'>Compute the Minimum Spanning Tree (MST) linking species of a given
assemblage</h2><span id='topic+mst.computation'></span>

<h3>Description</h3>

<p>This function computes the MST linking species of a given assemblage and is
used to compute FEve index.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mst.computation(sp_faxes_coord_k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mst.computation_+3A_sp_faxes_coord_k">sp_faxes_coord_k</code></td>
<td>
<p>a matrix relating species coordinates for species
present in a given assemblage.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A dist object summarizing the MST for all species of a given
assemblage <code>mst_asb_k</code>.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
 data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits, 
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")
 
# Retrieve species coordinates matrix:
 sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute the distance of "pear" to its nearest neighbor(s):
 mst_fruits &lt;- mst.computation(sp_faxes_coord_fruits)
 mst_fruits
</code></pre>

<hr>
<h2 id='panels.to.patchwork'>Plot individual plots along a pair of functional axes into a unique graph</h2><span id='topic+panels.to.patchwork'></span>

<h3>Description</h3>

<p>This function gathers panels into a unique <code>patchwork</code> graph
with caption.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panels.to.patchwork(panels, plot_caption)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panels.to.patchwork_+3A_panels">panels</code></td>
<td>
<p>a list of ggplot objects illustrating an index on two given
functional axes. There must be either one, three or six ggplot objects given
the number of studied functional axes.</p>
</td></tr>
<tr><td><code id="panels.to.patchwork_+3A_plot_caption">plot_caption</code></td>
<td>
<p>a ggplot object illustrating the caption of the
final patchwork plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A unique ggplot object gathering functional panels and caption.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Retrieve FRic plot:
# Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
  sp_faxes_coord_fruits &lt;- 
    fspaces_quality_fruits$details_fspaces$sp_pc_coord
    
 # Retrieve species coordinates matrix for the assemblage "basket_1":
  sp_filter &lt;- mFD::sp.filter(asb_nm          = c("basket_1"), 
                              sp_faxes_coord = sp_faxes_coord_fruits, 
                              asb_sp_w       = baskets_fruits_weights)
  sp_faxes_coord_fruits_b1 &lt;- sp_filter$`species coordinates`
 
 # Reduce it to the two studed axes: PC1 and PC2:
 sp_faxes_coord_fruits_b1_2D &lt;- sp_faxes_coord_fruits_b1[, c("PC1", "PC2")]

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits)
 range_faxes_lim &lt;- range_sp_coord_fruits + c(-1, 1)*(range_sp_coord_fruits[2] - 
 range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve vertices names:
 vert_nm_fruits &lt;- vertices(sp_faxes_coord_fruits_b1_2D, 
  order_2D = TRUE, check_input = TRUE)
                               
 # Plot in white the convex hull of all fruits species:
 ggplot_fric &lt;- mFD::fric.plot(
           ggplot_bg       = ggplot_bg_fruits,
           asb_sp_coord2D  = list(basket_1 = sp_faxes_coord_fruits_b1_2D),
           asb_vertices_nD = list(basket_1 = vert_nm_fruits),
           plot_sp         = TRUE,
           color_ch        = c("basket_1" = "black"), 
           fill_ch         = c("basket_1" = "white"), 
           alpha_ch        = c("basket_1" = 0.3),
           size_sp = c("basket_1" = 1),
           shape_sp = c("basket_1" = 16),
           color_sp = c("basket_1" = "red"),
           fill_sp = c("basket_1" = "red"),
           size_vert = c("basket_1" = 1),
           color_vert = c("basket_1" = "red"),
           fill_vert = c("basket_1" = "red"),
           shape_vert = c("basket_1" = 16))
 ggplot_fric
 
## Create a caption summing up FRic values 
# retrieve values to plot:
top_fric &lt;- c("Functional richness", "basket_1", "")

asb_fd_ind &lt;- alpha_fd_indices_fruits &lt;- mFD::alpha.fd.multidim(
sp_faxes_coord   = sp_faxes_coord_fruits[ , c("PC1", "PC2", "PC3", "PC4")],
asb_sp_w         = baskets_fruits_weights,
ind_vect         = c("fric"),
scaling          = TRUE,
check_input      = TRUE,
details_returned = TRUE)

values_fric &lt;- c(round(asb_fd_ind$functional_diversity_indices["basket_1", 
"fric"], 3), "")

# customize position of texts in the plot:
spread_faxes &lt;- (range_sp_coord_fruits[2] - range_sp_coord_fruits[1])
hh &lt;- c(1, 2.5, 4, 5.5)
vv &lt;- 0.3

# plot window:
x &lt;- NULL
y &lt;- NULL
plot_caption &lt;- ggplot2::ggplot(data.frame(x = range_sp_coord_fruits, 
                                          y = range_sp_coord_fruits),
                               ggplot2::aes(x = x, y = y)) +
 ggplot2::scale_x_continuous(limits = range_sp_coord_fruits, 
 expand = c(0, 0)) +
 ggplot2::scale_y_continuous(limits = range_sp_coord_fruits, 
 expand = c(0, 0)) +
 ggplot2::theme_void() + ggplot2::theme(legend.position = "none") +
 ggplot2::geom_rect(xmin = range_sp_coord_fruits[1], 
                    xmax = range_sp_coord_fruits[2],
                    ymin = range_sp_coord_fruits[1], 
                    ymax = range_sp_coord_fruits[2],
                    fill = "white", colour ="black")

# plot names of index and of assemblages:
h   &lt;- NULL
v   &lt;- NULL
top &lt;- NULL
x &lt;- NULL
y &lt;- NULL
plot_caption &lt;- plot_caption +
 ggplot2::geom_text(data = data.frame(
   h = range_sp_coord_fruits[1] + spread_faxes * 0.15 * hh[c(1,3:4)],
   v = range_sp_coord_fruits[2] - spread_faxes * rep(0.2, 3),
   top = top_fric),
   ggplot2::aes(x = h, y = v, label = top),
   size = 3, hjust = 0.5, fontface = "bold")

# plot FRic values:
values_lab &lt;- NULL
data_caption &lt;- data.frame(
  h = range_sp_coord_fruits[1] + spread_faxes * 0.15 * hh[2:4],
  v = range_sp_coord_fruits[2] - spread_faxes*rep(vv, 3),
  values_lab = c("FRic", values_fric))
plot_caption &lt;- plot_caption +
  ggplot2::geom_text(data = data_caption,
                    ggplot2::aes(x = h, y = v, label = values_lab),
                    size = 3, hjust = 0.5, fontface = "plain")

## Create patchwork:
patchwork_fric &lt;- mFD::panels.to.patchwork(list(ggplot_fric), plot_caption)
patchwork_fric
</code></pre>

<hr>
<h2 id='pool.plot'>Plot species from the pool</h2><span id='topic+pool.plot'></span>

<h3>Description</h3>

<p>Plot all species from the study case and associated convex hull
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pool.plot(
  ggplot_bg,
  sp_coord2D,
  vertices_nD,
  plot_pool = TRUE,
  shape_pool = 3,
  size_pool = 0.8,
  color_pool = "grey95",
  fill_pool = NA,
  color_ch = NA,
  fill_ch = "white",
  alpha_ch = 1,
  shape_vert = 3,
  size_vert = 1,
  color_vert = "black",
  fill_vert = NA
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pool.plot_+3A_ggplot_bg">ggplot_bg</code></td>
<td>
<p>a ggplot object of the plot background retrieved through
the <code><a href="#topic+background.plot">background.plot</a></code> function.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_sp_coord2d">sp_coord2D</code></td>
<td>
<p>a list of matrix (ncol = 2) with coordinates of
species present in the pool for a given pair of axes</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_vertices_nd">vertices_nD</code></td>
<td>
<p>a list (with names as in sp_coord2D) of vectors with
names of species being vertices in n dimensions.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_plot_pool">plot_pool</code></td>
<td>
<p>a logical value indicating whether species of each
assemblage should be plotted or not. Default: plot_pool = TRUE.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_shape_pool">shape_pool</code></td>
<td>
<p>a numeric value referring to the shape used to plot
species pool. Default: <code>shape_pool = 16</code>(filled circle).</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_size_pool">size_pool</code></td>
<td>
<p>a numeric value referring to the size of species belonging
to the global pool. Default: <code>size_pool = 1</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_color_pool">color_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of the pool.  This color is also used for FRic convex hull color.
Default: <code>color_pool = "#0072B2"</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_fill_pool">fill_pool</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
colour to fill species symbol (if <code>shape_sp</code> &gt; 20) and the assemblage
convex hull. Default: <code>fill_pool = '#0072B2'</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_color_ch">color_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
border of the convex hull filled by the pool of species. Default:
<code>color_ch = "black"</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_fill_ch">fill_ch</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
filling of the convex hull filled by the pool of species. Default is:
<code>fill_ch = "white"</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_alpha_ch">alpha_ch</code></td>
<td>
<p>a numeric value for transparency of the filling of the
convex hull (0 = high transparency, 1 = no transparency). Default:
<code>alpha_ch = 0.3</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_shape_vert">shape_vert</code></td>
<td>
<p>a numeric value referring to the shape used to plot
vertices if vertices should be plotted in a different way than other
species. If <code>shape_vert = NA</code>, no vertices plotted. Default:
<code>shape_vert = NA</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_size_vert">size_vert</code></td>
<td>
<p>a numeric value referring to the size of symbol for
vertices. Default: <code>size_vert = 1</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_color_vert">color_vert</code></td>
<td>
<p>a R color name or an hexadecimal code referring to the
color of vertices if plotted. If color_vert = NA, vertices are not plotted
(for shapes only defined by color, ie shape inferior to 20. Otherwise fill
must also be set to NA). Default: <code>color_vert =  NA</code>.</p>
</td></tr>
<tr><td><code id="pool.plot_+3A_fill_vert">fill_vert</code></td>
<td>
<p>a character value referring to the color for filling symbol
for vertices (if <code>shape_vert</code> &gt;20). If <code>fill = NA</code> and <code>color = NA</code>,
vertices are not plotted (if <code>shape_vert</code> superior to 20. Otherwise
<code>color_vert = NULL</code> is enough). Default is <code>NA</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot object plotting background of multidimensional graphs and
species from the global pool (associated convex hull if asked).
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(sp_dist = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits_2D &lt;- 
  fspaces_quality_fruits$details_fspaces$sp_pc_coord[ , c("PC1", "PC2")]

# Set faxes limits:
# set range of axes if c(NA, NA):
 range_sp_coord_fruits  &lt;- range(sp_faxes_coord_fruits_2D)
 range_faxes_lim &lt;- range_sp_coord_fruits + 
   c(-1, 1)*(range_sp_coord_fruits[2] - 
   range_sp_coord_fruits[1]) * 0.05
 
 # Retrieve the background plot:
 ggplot_bg_fruits &lt;- mFD::background.plot(
                               range_faxes = range_faxes_lim, 
                               faxes_nm    = c("PC 1", "PC 2"), 
                               color_bg    = "grey90") 
                               
 # Retrieve vertices names:
 vert_nm_fruits &lt;- vertices(sp_faxes_coord_fruits_2D, 
  order_2D = TRUE, check_input = TRUE)
  
 # Plot the pool:
 plot_pool_fruits &lt;- pool.plot(ggplot_bg   = ggplot_bg_fruits,
           sp_coord2D    = sp_faxes_coord_fruits_2D,
           vertices_nD   = vert_nm_fruits,
           plot_pool     = TRUE,
           shape_pool    = 3, 
           size_pool     = 0.8, 
           color_pool    = "grey95", 
           fill_pool     = NA, 
           color_ch      = NA, 
           fill_ch       = "white", 
           alpha_ch      = 1, 
           shape_vert    = 3, 
           size_vert     = 1, 
           color_vert    = "black", 
           fill_vert     = NA) 
 plot_pool_fruits
</code></pre>

<hr>
<h2 id='quality.fspaces'>Compute functional spaces and their quality</h2><span id='topic+quality.fspaces'></span>

<h3>Description</h3>

<p>Compute a Principal Coordinates Analysis (PCoA) using functional distance
between species. Then the function evaluates the quality of spaces built
using an increasing number of principal components. Quality is evaluated as
the (absolute or squared) deviation between trait-based distance (input) and
distance in the PCoA-based space (raw Euclidean distance or scaled distance
according to its maximum value and maximum of trait-based distance). Option
to compute a functional dendrogram and its quality. This function is based
on the framework presented in Maire <em>et al.</em> (2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quality.fspaces(
  sp_dist,
  fdendro = NULL,
  maxdim_pcoa = 10,
  deviation_weighting = "absolute",
  fdist_scaling = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quality.fspaces_+3A_sp_dist">sp_dist</code></td>
<td>
<p>a dist object with pairwise distance among all species (at
least 3 species needed). Functional distance matrix from trait values can
be computed using <code><a href="#topic+funct.dist">funct.dist</a></code> function.</p>
</td></tr>
<tr><td><code id="quality.fspaces_+3A_fdendro">fdendro</code></td>
<td>
<p>a character string indicating the clustering
algorithm to use to compute dendrogram. Should be one of the method
recognized by <code><a href="stats.html#topic+hclust">hclust</a></code> (e.g. 'average' for UPGMA).
Default: <code>fdendro = NULL</code> (so no dendrogram computed).</p>
</td></tr>
<tr><td><code id="quality.fspaces_+3A_maxdim_pcoa">maxdim_pcoa</code></td>
<td>
<p>a single numeric value with maximum number of PCoA axes
to consider to build multidimensional functional spaces. Default:
<code>maxdim_pcoa = 10</code>. See below about number of axes actually considered.</p>
</td></tr>
<tr><td><code id="quality.fspaces_+3A_deviation_weighting">deviation_weighting</code></td>
<td>
<p>a character string referring to the
method(s) used to weight the differences between species pairwise distance
in the functional space and trait-based distance. <code>'absolute'</code>
(default) means absolute differences are used to compute mean absolute
deviation <em>mad</em> index; <code>'squared'</code> means squared differences are
used to compute root of mean squared deviation <em>rmsd</em> index. Both
values could be provided to compare quality metrics.</p>
</td></tr>
<tr><td><code id="quality.fspaces_+3A_fdist_scaling">fdist_scaling</code></td>
<td>
<p>a vector with logical value(s) specifying
whether distances in the functional space should be scaled before
computing differences with trait-based distances. Scaling ensures that
trait-based distances and distances in the functional space have the same
maximum.
Default: <code>FALSE</code>. Both values could be provided to compare quality metrics.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with:
</p>

<ul>
<li> <p><code>$quality_fspaces</code>: a data frame with quality metric(s) for
each functional space. Functional spaces are named as 'pcoa_.d' and if
required 'tree_clustering method'. Quality metrics are named after
deviation_weighting ('mad' for 'absolute' and and 'rmsd' for 'squared')
and if fdist_scaling is TRUE with suffix '_scaled'.
</p>
</li>
<li> <p><code>$details_trdist</code> a list with 2 elements:
<code>$trdist_summary</code>
a vector with minimum (min), maximum (max), mean (mean) and standard
deviation (sd) of <code>sp_dist</code>; <code>$trdist_euclidean</code> a logical
value indicating whether <code>sp_dist</code> checks Euclidean properties.
</p>
</li>
<li> <p><code>$details_fspaces</code> a list with 4 elements: <code>$sp_pc_coord</code>
a matrix with coordinates of species (rows) along Principal Components
(columns) with positive eigenvalues ; <code>$pc_eigenvalues</code> a matrix
with eigenvalues of axes from PCoA ; <code>$dendro</code> a hclust
object with the dendrogram details (null if no dendrogram computed) ;
<code>$pairsp_fspaces_dist</code> a dataframe containing for each pair of
species (rows), their names in the 2 first columns ('sp.x' and 'sp.y'),
their distance based on trait-values ('tr'), and their Euclidean
(for PCoA) or cophenetic (for dendrogram if computed) distance in each
of the functional space computed ('pcoa_1d', 'pcoa_2d', ... ,
'tree_clust');
if <code>fdist_scaling = TRUE</code>, <code>$pairsp_fspaces_dist_scaled</code> a data
frame with scaled values of distances in functional spaces.
</p>
</li>
<li> <p><code>$details_deviation</code> a list of data frames:
<code>$dev_distsp</code> a dataframe containing for each space (columns) the
difference for all species pairs (rows) of the distance in the
functional space and trait-based distance (i.e. positive deviation
indicates overestimation of actual distance) ; <code>$abs_dev_distsp</code>
and/or
<code>$sqr_dev_distsp</code>, dataframes with for each space (columns) and all
species pairs (rows) the absolute or squared deviation of distance ; if
<code>fdist_scaling = TRUE</code> <code>$dev_distsp_scaled</code>, and
<code>$abs_dev_distsp_scaled</code> and/or <code>$sqr_dev_distsp_scaled</code>, data
frames with deviation computed on scaled distance in functional spaces.
</p>
</li></ul>



<h3>Note</h3>

<p>The maximum number of dimensions considered for assessing quality of
functional spaces depends on number of PC axes with positive eigenvalues
(i.e. axes with negative eigenvalues are not considered); so it could be
lower than <code>$maxdim_pcoa</code>.
The quality metric obtained with deviation_weighting = 'squared' and
<code>fdist_scaling = TRUE</code> is equivalent to the square-root of the 'mSD'
originally suggested in Maire <em>et al.</em> (2015).
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger, Eva Maire, and Camille Magneville
</p>


<h3>References</h3>

<p>Maire <em>et al.</em> (2015) How many dimensions are needed to accurately assess
functional diversity? A pragmatic approach for assessing the quality of
functional spaces <em>Global Ecology and Biogeography</em>, <strong>24</strong>, 728-740.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species x Traits Data
data("fruits_traits", package = "mFD")

# Load Traits x Categories Data
data("fruits_traits_cat", package = "mFD")

# Compute Functional Distance
sp_dist_fruits &lt;- mFD::funct.dist(
  sp_tr         = fruits_traits,
  tr_cat        = fruits_traits_cat,
  metric        = "gower",
  scale_euclid  = "scale_center",
  ordinal_var   = "classic",
  weight_type   = "equal",
  stop_if_NA    = TRUE)

# Compute Functional Spaces Quality (to retrieve species coordinates)
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits,
  maxdim_pcoa         = 10,
  deviation_weighting = "absolute",
  fdist_scaling       = FALSE,
  fdendro             = "average")
 fspaces_quality_fruits
  
# Retrieve Species Coordinates
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord
sp_faxes_coord_fruits
</code></pre>

<hr>
<h2 id='quality.fspaces.plot'>Plot functional space quality with a chosen quality metric</h2><span id='topic+quality.fspaces.plot'></span>

<h3>Description</h3>

<p>Plot functional space quality with a chosen quality metric
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quality.fspaces.plot(
  fspaces_quality,
  quality_metric,
  fspaces_plot,
  name_file = NULL,
  range_dist = NULL,
  range_dev = NULL,
  range_qdev = NULL,
  gradient_deviation = c(neg = "darkblue", nul = "grey80", pos = "darkred"),
  gradient_deviation_quality = c(low = "yellow", high = "red"),
  x_lab = "Trait-based distance"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quality.fspaces.plot_+3A_fspaces_quality">fspaces_quality</code></td>
<td>
<p>output from the <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>
function, that is a list with all data needed to illustrate quality of
functional spaces based on deviation between species trait-based distance
and distance in functional spaces built using PCoA (and dendrogram).</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_quality_metric">quality_metric</code></td>
<td>
<p>a character string with the name of the quality metric
to illustrate. Should be one of the column names of
<code>fspaces_quality$quality_fspaces</code>. See help of
<code><a href="#topic+quality.fspaces">quality.fspaces</a></code> for the meaning of these names regarding
type of deviation and scaling of distance in functional space. Default:
<code>'mad'</code> (Mean absolute deviation).</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_fspaces_plot">fspaces_plot</code></td>
<td>
<p>a vector with names of functional spaces to consider.
Should be a subset of the row names of
<code>quality_fspaces$quality_fspaces</code>. Maximum of 10 spaces allowed to
keep decent plot size.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_name_file">name_file</code></td>
<td>
<p>a character string with name of file to save the
figure (without extension). Default: <code>NULL</code> which means plot is displayed.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_range_dist">range_dist</code></td>
<td>
<p>a vector with minimum and maximum values to
display for species pairwise distances (x-axis for all panels and y-axes
of top panel). Default: NULL, which means range is 0 to maximum distance
among all the functional spaces to plot.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_range_dev">range_dev</code></td>
<td>
<p>a vector with minimum and maximum values to display
for deviation to trait-based distance (y-axis of middle panel). Default:
NULL, which means range is set to range of deviation among all the
functional spaces to plot.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_range_qdev">range_qdev</code></td>
<td>
<p>a vector with minimum and maximum values to
display for deviation to trait-based distance (y-axis of bottom panel).
Default:NULL, which means range is from 0 to the maximum of (transformed)
deviation among all the functional spaces to plot.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_gradient_deviation">gradient_deviation</code></td>
<td>
<p>a vector of 3 colors for illustrating raw
deviation with <code><a href="ggplot2.html#topic+scale_colour_gradient2">scale_colour_gradient2</a></code>. The first
value ('neg') is for the lowest negative deviation, the second value
('nul')is for null deviation and the third value ('pos') is for the
highest positive deviation. Default gradient is from darkblue to grey to
red.</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_gradient_deviation_quality">gradient_deviation_quality</code></td>
<td>
<p>2 colors (named 'low' and 'high') for
illustrating transformed deviation used to compute quality metric with
<code><a href="ggplot2.html#topic+scale_colour_gradient2">scale_colour_gradient2</a></code> (default gradient is from
yellow to red).</p>
</td></tr>
<tr><td><code id="quality.fspaces.plot_+3A_x_lab">x_lab</code></td>
<td>
<p>a character string with title to display below X axis.
Default is 'Trait-based distance'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A png file (resolution 300dpi) saved in the current working
directory. Quality of each functional space is illustrated with three
panels : - top row shows trait-based distance between species vs.
space-based distance. - middle row shows trait-based distance vs.
deviation between space-based and trait-based distances - bottom row shows
trait-based distance between species vs. transformed deviation used to
compute the quality metric All plots have the same X axis. All plots on a
given row have the same Y axis and color palette. Type of distance in
functional space (Euclidean in PCoA, Cophenetic on tree) are abbreviated,
as well as type of transformation of distance (scaling) and of deviation
(Absolute or Squared)
</p>


<h3>Author(s)</h3>

<p>Sebastien Villeger and Camille Magneville
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:
data("baskets_fruits_weights", package = "mFD")

# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD")

# Compute functional distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                  tr_cat        = fruits_traits_cat,
                                  metric        = "gower",
                                  scale_euclid  = "scale_center",
                                  ordinal_var   = "classic",
                                  weight_type   = "equal",
                                  stop_if_NA    = TRUE)

# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
 sp_dist             = sp_dist_fruits,
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")

 # Illustrate the quality of functional spaces:
 mFD::quality.fspaces.plot(
  fspaces_quality            = fspaces_quality_fruits,
  quality_metric             = "mad",
  fspaces_plot               = c("tree_average", "pcoa_2d", "pcoa_3d", 
                              "pcoa_4d", "pcoa_5d"),
  name_file                  = NULL, 
  range_dist                 = NULL, 
  range_dev                  = NULL, 
  range_qdev                 = NULL,
  gradient_deviation         = c(neg = "darkblue", nul = "grey80", 
                                 pos = "darkred"),
  gradient_deviation_quality = c(low ="yellow", high = "red"),
  x_lab                      = "Trait-based distance")
</code></pre>

<hr>
<h2 id='sp.filter'>Retrieve information about species in a given assemblage</h2><span id='topic+sp.filter'></span>

<h3>Description</h3>

<p>This function computes names of species present in an given assemblage,
their coordinates in the functional space and their weights. It is used in
the <code>alpha_FD_multidim</code> function to filter species and compute each
functional indices for each community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp.filter(asb_nm, sp_faxes_coord, asb_sp_w)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp.filter_+3A_asb_nm">asb_nm</code></td>
<td>
<p>a string object referring to the name of a given community.</p>
</td></tr>
<tr><td><code id="sp.filter_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a chosen functional
space. Species coordinates have been retrieved thanks to
<code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="sp.filter_+3A_asb_sp_w">asb_sp_w</code></td>
<td>
<p>a matrix linking weight of species (columns) and a
set of assemblages (rows).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing names of species present in a given assemblage
<code>sp_name_asb_k</code>, a matrix containing coordinates of species present
in a given assemblage <code>sp_faxes_coord_k</code>, a matrix containing weight
of species present in a given assemblage <code>asb_sp_w_k</code>, a matrix
containing relative weight of species present in a given assemblage
<code>asb_sp_relatw_k</code>.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
data("baskets_fruits_weights", package = "mFD")
 
# Load Traits categories dataframe:
data("fruits_traits_cat", package = "mFD")  

# Compute functional distance 
sp_dist_fruits &lt;- mFD::funct.dist(
 sp_tr         = fruits_traits,
 tr_cat        = fruits_traits_cat,
 metric        = "gower",
 scale_euclid  = "scale_center",
 ordinal_var   = "classic",
 weight_type   = "equal",
 stop_if_NA    = TRUE)
 
# Compute functional spaces quality to retrieve species coordinates matrix:
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
 sp_dist             = sp_dist_fruits, 
 maxdim_pcoa         = 10,
 deviation_weighting = "absolute",
 fdist_scaling       = FALSE,
 fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Filter species of basket_1 assemblage:
sp.filter(asb_nm         = "basket_1", 
          sp_faxes_coord = sp_faxes_coord_fruits, 
          asb_sp_w       = baskets_fruits_weights)
</code></pre>

<hr>
<h2 id='sp.to.fe'>Compute Functional Entities composition based on a Species x Traits matrix</h2><span id='topic+sp.to.fe'></span>

<h3>Description</h3>

<p>Compute Functional Entities composition based on a Species x Traits matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp.to.fe(sp_tr, tr_cat, fe_nm_type = "fe_rank", check_input = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp.to.fe_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame containing species as rows and traits as columns.</p>
</td></tr>
<tr><td><code id="sp.to.fe_+3A_tr_cat">tr_cat</code></td>
<td>
<p>a data frame containing three columns for each trait (rows):
</p>

<ul>
<li> <p><strong>trait_name</strong>: names of all traits as in <code>sp_tr</code> data
frame;
</p>
</li>
<li> <p><strong>trait_type</strong>: category codes for each trait as followed:
<em>N</em> for Nominal traits (factor variable),
<em>O</em> for Ordinal traits (ordered variable),
<em>C</em> for Circular traits (integer values),
<em>Q</em> for Quantitative traits (numeric values) that is allowed
<strong>only</strong> if there are at least 2 species with the same value, and
<em>F</em> for fuzzy-coded traits (i.e. described with several
'sub-traits');
</p>
</li>
<li> <p><strong>fuzzy_name</strong> name of fuzzy-coded trait to which 'sub-trait'
belongs (if trait is not fuzzy, ignored so could be trait name or NA).
</p>
</li></ul>
</td></tr>
<tr><td><code id="sp.to.fe_+3A_fe_nm_type">fe_nm_type</code></td>
<td>
<p>a character string referring to the type of naming
functional entities. Two possible values: <em>&quot;fe_rank&quot;</em> (FE are named
after their decreasing rank in term of number of species <em>i.e.</em> fe_1
is the one gathering most species) and <em>&quot;tr_val&quot;</em> (FE are named after
names of traits and of trait values for each FE, if possible, <em>see
details below</em>). Default: <code>fe_nm_type = "fe_rank"</code>.</p>
</td></tr>
<tr><td><code id="sp.to.fe_+3A_check_input">check_input</code></td>
<td>
<p>a logical value indicating whether key features the
inputs are checked (e.g. class and/or mode of objects, names of rows
and/or columns, missing values). If an error is detected, a detailed
message is returned. Default: <code>check.input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>fe_nm_type = "tr_val"</code> is allowed <strong>only</strong> if:
</p>

<ul>
<li><p> there are less than 7 traits;
</p>
</li>
<li><p> none of them is fuzzy-coded (so that names are not too long)
</p>
</li>
<li><p> all trait names and all trait values have different 2 first letters
</p>
</li></ul>

<p>If these 3 conditions are met, names of Functional Entities are made as a
character string of up to 2 letters for trait name in upper case font then
up to 2 letters for trait value in lower case font, separated by &quot;_&quot; between
traits. Trait names are abbreviated to a single letter whenever possible.
<em>Examples:</em> (&quot;TAc2_TBxx_TCyy&quot;, &quot;TAc3_TBff_TCyy&quot;) or
(&quot;A2_Bx_Cy&quot;, &quot;A3_Bf_Cy&quot;)
</p>


<h3>Value</h3>

<p>A list of objects containing:
</p>

<ul>
<li> <p><strong>fe_nm</strong>: a vector with names of all FE (following
fe_nm_type). FE are ordered according to the decreasing number of
species they gather.
</p>
</li>
<li> <p><strong>sp_fe</strong>: a vector containing for each species the name of the
FE it belongs to. FE order is done according to decreasing number of
species.
</p>
</li>
<li> <p><strong>fe_tr</strong>: a data frame containing traits values (variables in
columns) for each FE (rows). FE order is done according to decreasing
number of species.
</p>
</li>
<li> <p><strong>fe_nb_sp</strong>: a vector with species number per FE. If all FE
have only one species, a warning message is returned. FE are ordered
according to the decreasing number of species they gather.
</p>
</li>
<li> <p><strong>details_fe</strong>: a list containing: <em>fe_codes</em> a vector
containing character referring to traits values (like a barcode) with
names as in <code>fe_nm_type</code> and sorted according to <code>fe_nb_sp</code>;
<em>tr_uval</em> a list containing for each trait a vector of its unique
values or a data frame for fuzzy-coded traits; <em>fuzzy_E</em> a list
with for each fuzzy-coded trait a data frame with names of entities (E)
and names of species (sp); <em>tr_nb_uval</em> a vector with number of
unique values per trait (or combinations for fuzzy-coded traits);
<em>max_nb_fe</em> the maximum number of FE possible given number of
unique values per trait.
</p>
</li></ul>



<h3>Author(s)</h3>

<p>Sebastien Villeger, Nicolas Loiseau, and Camille Magneville
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load species traits data:
 data("fruits_traits", package = "mFD")

# Transform species traits data:
# Only keep the first 4 traits to illustrate FEs:
 fruits_traits &lt;- fruits_traits[ , c(1:4)]   

# Load trait types data:
 data("fruits_traits_cat", package = "mFD")

# Transform the trait types data to only keep traits 1 - 4:
 fruits_traits_cat &lt;- fruits_traits_cat[c(1:4), ]

# Gather species into FEs:
## gathering species into FEs (FEs named according to the decreasing...
## ...  number of species they gather):
 sp_FEs &lt;- mFD::sp.to.fe(
      sp_tr      = fruits_traits, 
      tr_cat     = fruits_traits_cat, 
      fe_nm_type = "fe_rank")

## display FEs names:
sp_FEs$fe_nm

## display for each species the name of the FE it belongs to:
sp_FEs$sp_fe

## display trait values for each FE:
sp_FEs$fe_tr
 
## display the number of species per FEs:
sp_FEs$fe_nb_sp
</code></pre>

<hr>
<h2 id='sp.tr.summary'>Summarize Species x Traits data frame</h2><span id='topic+sp.tr.summary'></span>

<h3>Description</h3>

<p>This function computes a summary data helping to choose the type of analysis
you can do with your data. For this function to work, there must be no NA in
your <code>sp_tr</code> data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sp.tr.summary(tr_cat, sp_tr, stop_if_NA = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sp.tr.summary_+3A_tr_cat">tr_cat</code></td>
<td>
<p>a data frame containing three columns for each trait (rows):
</p>

<ul>
<li> <p><strong>trait_name</strong>: the name of all traits as in <code>sp_tr</code> data
frame;
</p>
</li>
<li> <p><strong>trait_type</strong>: the category code for each trait as followed:
<code>N</code> for Nominal traits (factor variable), <code>O</code> for Ordinal traits
(ordered variable), <code>C</code> for Circular traits (integer values)(circular
traits can not be used in mFD function used to compute functional distance
but ok for summary function and function to group species into Functional
Entities), <code>Q</code>
for quantitative traits (numeric values), and <code>F</code> for
fuzzy traits (i.e. described with several values defined with several
column);
</p>
</li>
<li> <p><strong>fuzzy_name</strong>: name of fuzzy-coded trait to which 'sub-trait'
belongs (if trait is not fuzzy, ignored so could be trait name or NA).
</p>
</li>
<li> <p><strong>trait_weight</strong>: weights of each traits if the user wants to
specify a weight for each trait.
</p>
</li></ul>
</td></tr>
<tr><td><code id="sp.tr.summary_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame of traits values (columns) for each species
(rows). Note that species names <strong>must be</strong> specified in the row names.</p>
</td></tr>
<tr><td><code id="sp.tr.summary_+3A_stop_if_na">stop_if_NA</code></td>
<td>
<p>a logical value indicating whether the process should stop
if there is some NA in the <code>sp_tr</code> dataframe. If you continue with
functional analysis, we remind you that functional measures, are
sensitive to missing traits</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If there is no fuzzy-coded trait, a three-elements list with:
</p>
<table>
<tr><td><code>tr_summary_list</code></td>
<td>
<p>a table summarizing for each trait the
number of species per modality for non-continuous trait and min, max,
mean, median, and quartiles for continuous traits.</p>
</td></tr>
<tr><td><code>tr_types</code></td>
<td>
<p>a list containing traits type.</p>
</td></tr>
<tr><td><code>mod_list</code></td>
<td>
<p>a list containing modalities for all traits.</p>
</td></tr>
</table>
<p>If there is fuzzy-coded trait, a four-elements list with:
</p>
<table>
<tr><td><code>tr_summary_non_fuzzy_list</code></td>
<td>
<p>a table summarizing for each trait the
number of species per modality for non-continuous trait and min, max,
mean, median, and quartiles for continuous traits.</p>
</td></tr>
<tr><td><code>tr_summary_fuzzy_list</code></td>
<td>
<p>a table summarizing for each subtrait min,
max, mean, median and quartiles</p>
</td></tr>
<tr><td><code>tr_types</code></td>
<td>
<p>a list containing traits type.</p>
</td></tr>
<tr><td><code>mod_list</code></td>
<td>
<p>a list containing modalities for non-continuous trait.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species x Traits data
data('fruits_traits', package = 'mFD')

# Load Traits x Categories data
data('fruits_traits_cat', package = 'mFD')

# Summarize Species x Traits data
mFD::sp.tr.summary(tr_cat = fruits_traits_cat, sp_tr = fruits_traits)
</code></pre>

<hr>
<h2 id='tr.cont.fspace'>Build a functional space based on continuous traits only</h2><span id='topic+tr.cont.fspace'></span>

<h3>Description</h3>

<p>This function computes a functional space based on continuous standardized
traits or continuous raw traits matrix. User can either choose to compute
functional space based on PCA analysis or using one trait for one functional
axis. For PCA analysis, center and scale arguments are considered <code>FALSE</code>:
if you want to center, scale or standardize by any mean your data, please
use <code><a href="#topic+tr.cont.scale">tr.cont.scale</a></code> function. Option makes it possible to
compute correlation between traits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr.cont.fspace(
  sp_tr,
  pca = TRUE,
  nb_dim = 7,
  scaling = "scale_center",
  compute_corr = "pearson"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr.cont.fspace_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame of traits values (columns) for each species
(rows). Note that species names <strong>must be</strong> specified in the row names and
traits must be <strong>continuous</strong> (raw or standardized).</p>
</td></tr>
<tr><td><code id="tr.cont.fspace_+3A_pca">pca</code></td>
<td>
<p>a logical value. If <code>TRUE</code> a PCA analysis is computed, elsewhere
the functional space is computed with one trait for each dimension.
Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="tr.cont.fspace_+3A_nb_dim">nb_dim</code></td>
<td>
<p>an integer referring to the maximum number of dimensions for
multidimensional functional spaces. Final number of dimensions depends
on the number of positive eigenvalues obtained with the PCA. High value
for <code>nb_dim</code> can increase computation time. Default is <code>nb_dim = 7</code>.</p>
</td></tr>
<tr><td><code id="tr.cont.fspace_+3A_scaling">scaling</code></td>
<td>
<p>a string value to compute (or not) scaling of traits using
the <code><a href="#topic+tr.cont.scale">tr.cont.scale</a></code> function. Possible options are:
<code>range</code> (standardize by the range),
<code>center</code> (use the center transformation: <code class="reqn">x' = x - mean(x)</code>),
<code>scale</code> (use the scale transformation: <code class="reqn">x' = \frac{x}{sd(x)}</code>),
<code>scale_center</code> (use the scale-center transformation:
<code class="reqn">x' = \frac{x - mean(x)}{sd(x)}</code>), or
<code>no_scale</code>
Default is <code>scale_center</code>.</p>
</td></tr>
<tr><td><code id="tr.cont.fspace_+3A_compute_corr">compute_corr</code></td>
<td>
<p>a string value to compute Pearson correlation
coefficients between traits (<code>compute_corr = 'pearson'</code>). You can choose
not to compute correlation coefficient by setting <code>compute_corr</code> to
<code>none</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list containing a matrix with <code>mAD</code> and <code>mSD</code> values for each
functional space to assess the quality of functional spaces), a matrix
containing eigenvalues for each axis, the percentage of variance explained
by each axis and the cumulative percentage of variance, a data frame
containing species coordinates on each functional axis, list of distance
matrices in the functional space (Euclidean distances based on trait values
and coordinates in the functional spaces), a dist object containing initial
euclidean distances based on traits and a matrix of correlation coefficients
between traits (if required).
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>load(system.file('extdata', 'sp_tr_cestes_df', package = 'mFD'))

mFD::tr.cont.fspace(
    sp_tr        = sp_tr, 
    pca          = TRUE, 
    nb_dim       = 7, 
    scaling      = 'scale_center',
    compute_corr = 'pearson')
</code></pre>

<hr>
<h2 id='tr.cont.scale'>Scale continuous traits</h2><span id='topic+tr.cont.scale'></span>

<h3>Description</h3>

<p>This function standardizes continuous traits. It can be useful before
computing functional space. You will have to choose which standardized
method to use based on your data. For this function to work, there must be
no NA in your <code>sp_tr</code> data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tr.cont.scale(sp_tr, std_method = "scale_center")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tr.cont.scale_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame of traits values (columns) for each species
(rows). Note that species names <strong>must be</strong> specified in the row names and
traits must be <strong>continuous</strong>.</p>
</td></tr>
<tr><td><code id="tr.cont.scale_+3A_std_method">std_method</code></td>
<td>
<p>a character string referring to the standardization
method. Possible values:
<code>range</code> (standardize by the range),
<code>center</code> (use the center transformation: <code class="reqn">x' = x - mean(x)</code>),
<code>scale</code> (use the scale transformation: <code class="reqn">x' = \frac{x}{sd(x)}</code>), or
<code>scale_center</code> (use the scale-center transformation:
<code class="reqn">x' = \frac{x - mean(x)}{sd(x)}</code>).
Default is <code>scale_center</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of standardized trait values (columns) for each species
(rows).
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'>load(system.file('extdata', 'sp_tr_cestes_df', package = 'mFD'))

mFD::tr.cont.scale(sp_tr = sp_tr, std_method = 'scale_center')
</code></pre>

<hr>
<h2 id='traits.faxes.cor'>Correlation between Traits and Axes</h2><span id='topic+traits.faxes.cor'></span>

<h3>Description</h3>

<p>Compute relationship between all traits and all axes of the functional
space. For continuous trait a linear model is computed and r2 and p-value
are returned. For other types of traits, a Kruskal-Wallis test is computed
and eta2 statistics is returned.
Option allows to plot trait-axis relationships with scatterplot and boxplot
for continuous and non-continuous traits, respectively.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traits.faxes.cor(
  sp_tr,
  sp_faxes_coord,
  tr_nm = NULL,
  faxes_nm = NULL,
  plot = FALSE,
  name_file = NULL,
  color_signif = "darkblue",
  color_non_signif = "gray80",
  stop_if_NA = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traits.faxes.cor_+3A_sp_tr">sp_tr</code></td>
<td>
<p>a data frame containing species as rows and traits as columns.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a multidimensional
functional space. Species coordinates have been retrieved
thanks to <code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_tr_nm">tr_nm</code></td>
<td>
<p>a vector gathering the names of traits (as in <code>sp_tr</code>) to
consider. If <code>NULL</code> all traits are considered.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_faxes_nm">faxes_nm</code></td>
<td>
<p>a vector gathering the names of PCoA axes (as in
<code>sp_faxes_coord</code>) to consider.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_plot">plot</code></td>
<td>
<p>a logical value indicating whether plot illustrating relations
between trait and axes should be drawn. <strong>You can only plot relationships
for up to 10 traits and/or 10 axes</strong>.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_name_file">name_file</code></td>
<td>
<p>the file name (without extension) to save the plot as a 300
dpi JPEG file. Default is <code>NULL</code> which means plot is only displayed. If
<code>plot = FALSE</code> this argument is ignored.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_color_signif">color_signif</code></td>
<td>
<p>an R color name or an hexadecimal code referring to
the color of points when relationships between the trait and the axis is
significant. Default is <code>darkblue</code>.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_color_non_signif">color_non_signif</code></td>
<td>
<p>an R color name or an hexadecimal code referring to
the
color of points when relationships between the trait and the axis are not
significant. Default is <code>gray80</code>.</p>
</td></tr>
<tr><td><code id="traits.faxes.cor_+3A_stop_if_na">stop_if_NA</code></td>
<td>
<p>a logical value to stop or not the process if the
<code>sp_tr</code> data frame contains NA. Functional measures are sensitive to
missing traits. For further explanations, see the Note section.
Default is <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>1 data frame with for each combination of trait and axis (rows), the
name of the test performed, and the corresponding statistics and p-value.
If <code>plot = TRUE</code> a multi-panel figure with traits as columns and axes as
rows is also plotted. When relationships between trait and axis is
significant the points are colored, else they remain grayish.
</p>


<h3>Author(s)</h3>

<p>Nicolas Loiseau and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species x Traits Data
data("fruits_traits", package = "mFD")

# Load Traits categories dataframe
data("fruits_traits_cat", package = "mFD")

# Compute Functional Distance
sp_dist_fruits &lt;- mFD::funct.dist(sp_tr  = fruits_traits,
 tr_cat = fruits_traits_cat,
 metric = "gower",
 scale_euclid  = "scale_center",
 ordinal_var = "classic",
 weight_type = "equal",
 stop_if_NA  = TRUE)
  
# Compute Functional Spaces Quality (to retrieve species coordinates)
fspaces_quality_fruits &lt;- mFD::quality.fspaces(
  sp_dist             = sp_dist_fruits, 
  maxdim_pcoa         = 10,
  deviation_weighting = "absolute",
  fdist_scaling       = FALSE,
  fdendro             = "average")
  
# Retrieve Species Coordinates
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute Correlation between Traits and Functional Axes
mFD::traits.faxes.cor(
  sp_tr          = fruits_traits, 
  sp_faxes_coord = sp_faxes_coord_fruits, 
  tr_nm          = NULL, 
  faxes_nm       = NULL,
  name_file      = NULL, 
  color_signif   = "darkblue",
  color_non_signif = "gray80")
</code></pre>

<hr>
<h2 id='vertices'>Compute vertices of the Minimal Convex Hull shaping species from a single
assemblage in a multidimensional functional space</h2><span id='topic+vertices'></span>

<h3>Description</h3>

<p>This function identifies species that are vertices of the minimal convex
hull enclosing a community in a multidimensional functional space. This
function is using the <code><a href="geometry.html#topic+convhulln">convhulln</a></code> function.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vertices(sp_faxes_coord, order_2D = FALSE, check_input = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vertices_+3A_sp_faxes_coord">sp_faxes_coord</code></td>
<td>
<p>a matrix of species coordinates in a chosen functional
space. Species coordinates have been retrieved thanks to
<code><a href="#topic+tr.cont.fspace">tr.cont.fspace</a></code> or <code><a href="#topic+quality.fspaces">quality.fspaces</a></code>.</p>
</td></tr>
<tr><td><code id="vertices_+3A_order_2d">order_2D</code></td>
<td>
<p>a logical value defining whether vertices names are
reordered so that they define a convex polygon in 2D which is convenient
for plotting. Default is <code>FALSE</code>, vertices ordered as in row names of
'sp_faxes_coord'.</p>
</td></tr>
<tr><td><code id="vertices_+3A_check_input">check_input</code></td>
<td>
<p>a logical value defining whether inputs are checked
before computation: species names must be put as row.names, there must be
no NA and species number must be superior to (axes number + 1). Default:
<code>check_input = TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector containing names of species being vertices <code>vert_nm</code>.
</p>


<h3>Author(s)</h3>

<p>Camille Magneville and Sebastien Villeger
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Load Species*Traits dataframe:
 data("fruits_traits", package = "mFD")

# Load Assemblages*Species dataframe:      
 data("baskets_fruits_weights", package = "mFD") 

# Load Traits categories dataframe:
 data("fruits_traits_cat", package = "mFD") 
 
# Compute functional distance 
 sp_dist_fruits &lt;- mFD::funct.dist(sp_tr         = fruits_traits,
                                   tr_cat        = fruits_traits_cat,
                                   metric        = "gower",
                                   scale_euclid  = "scale_center",
                                   ordinal_var   = "classic",
                                   weight_type   = "equal",
                                   stop_if_NA    = TRUE)
  
# Compute functional spaces quality to retrieve species coordinates matrix:
 fspaces_quality_fruits &lt;- mFD::quality.fspaces(
                                  sp_dist             = sp_dist_fruits, 
                                  maxdim_pcoa         = 10,
                                  deviation_weighting = "absolute",
                                  fdist_scaling       = FALSE,
                                  fdendro             = "average")
 
# Retrieve species coordinates matrix:
sp_faxes_coord_fruits &lt;- fspaces_quality_fruits$details_fspaces$sp_pc_coord

# Compute vertices and order them clockwise:
 vert_nm &lt;- vertices(sp_faxes_coord_fruits[ , c("PC1", "PC2")], 
  order_2D = TRUE, check_input = TRUE)
 vert_nm

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
