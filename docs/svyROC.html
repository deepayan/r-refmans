<!DOCTYPE html><html lang="en"><head><title>Help for package svyROC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {svyROC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#corrected.wauc'><p>Corrected estimate of the AUC based on replicate weights.</p></a></li>
<li><a href='#example_data_wroc'><p>Simulated data</p></a></li>
<li><a href='#example_variables_wroc'><p>Simulated data</p></a></li>
<li><a href='#wauc'><p>Estimation of the AUC of logistic regression models with complex survey data.</p></a></li>
<li><a href='#wocp'><p>Optimal cut-off points for complex survey data</p></a></li>
<li><a href='#wroc'><p>Estimation of the ROC curve of logistic regression models with complex survey data</p></a></li>
<li><a href='#wroc.plot'><p>Estimation of the ROC curve of logistic regression models with complex survey data</p></a></li>
<li><a href='#wse'><p>Estimation of the sensitivity with complex survey data</p></a></li>
<li><a href='#wsp'><p>Estimation of the specificity with complex survey data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Estimation of the ROC Curve and the AUC for Complex Survey Data</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Amaia Iparragirre &lt;amaia.iparragirre@ehu.eus&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimate the receiver operating characteristic (ROC) curve, area under the curve (AUC) and optimal cut-off points for individual classification taking into account complex sampling designs when working with complex survey data. Methods implemented in this package are described in: A. Iparragirre, I. Barrio, I. Arostegui (2024) &lt;<a href="https://doi.org/10.1002%2Fsta4.635">doi:10.1002/sta4.635</a>&gt;; A. Iparragirre, I. Barrio, J. Aramendi, I. Arostegui (2022) &lt;<a href="https://doi.org/10.2436%2F20.8080.02.121">doi:10.2436/20.8080.02.121</a>&gt;; A. Iparragirre, I. Barrio (2024) &lt;<a href="https://doi.org/10.1007%2F978-3-031-65723-8_7">doi:10.1007/978-3-031-65723-8_7</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>survey, svyVarSel</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-10-22 17:58:24 UTC; amaiaiparragirre</td>
</tr>
<tr>
<td>Author:</td>
<td>Amaia Iparragirre <a href="https://orcid.org/0000-0002-0660-6535"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph],
  Irantzu Barrio [aut],
  Inmaculada Arostegui [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-10-25 07:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='corrected.wauc'>Corrected estimate of the AUC based on replicate weights.</h2><span id='topic+corrected.wauc'></span>

<h3>Description</h3>

<p>Optimism correction of the AUC of logistic regression models
with complex survey data based on replicate weights methods.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>corrected.wauc(
  data = NULL,
  formula,
  tag.event = NULL,
  tag.nonevent = NULL,
  weights.var = NULL,
  strata.var = NULL,
  cluster.var = NULL,
  design = NULL,
  method = c("dCV", "JKn", "RB"),
  dCV.method = c("average", "pooling"),
  RB.method = c("subbootstrap", "bootstrap"),
  k = 10,
  R = 1,
  B = 200
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="corrected.wauc_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, the sampling design must be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_formula">formula</code></td>
<td>
<p>Formula of the model for which the AUC needs to be corrected.
The models are fitted by means of <code>survey::svyglm()</code> function.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_tag.event">tag.event</code></td>
<td>
<p>A character string indicating the label used to indicate the event of interest in <code>response.var</code>.
The default option is <code>tag.event = NULL</code>, which selects the class with the lowest number of units as event.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_tag.nonevent">tag.nonevent</code></td>
<td>
<p>A character string indicating the label used for non-event in <code>response.var</code>.
The default option is <code>tag.nonevent = NULL</code>, which selects the class with the greatest number of units as non-event.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_strata.var">strata.var</code></td>
<td>
<p>A character string indicating the name of the column with strata identifiers.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_cluster.var">cluster.var</code></td>
<td>
<p>A character string indicating the name of the column with cluster identifiers.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument
or the sampling design does not have considered clustering.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by <code>survey::svydesign()</code>.
It could be <code>NULL</code> if information about <code>cluster.var</code>, <code>strata.var</code>, <code>weights.var</code> and <code>data</code> are given.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_method">method</code></td>
<td>
<p>A character string indicating the method to be applied to define replicate weights and correct the AUC.
Choose between: <code>JKn</code> (for the Jackknife Repeated Replication), <code>dCV</code> (for the design-based cross-validation),
<code>RB</code> (for the Rescaling Bootstrap).</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_dcv.method">dCV.method</code></td>
<td>
<p>Only applies for the <code>dCV</code> method.
Choose between: <code>average</code> (for the averaging cross-validation) or <code>pooling</code> (for the pooling cross-validation).
Note: <code>pooling</code> is recommended over <code>average</code> (see, Iparragirre and Barrio (2024))</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_rb.method">RB.method</code></td>
<td>
<p>Only applies for the <code>RB</code> method.
Choose between: <code>subbootstrap</code> or <code>bootstrap</code> (see the documentation of <code>svyVarSel::replicate.weights()</code> for help).</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_k">k</code></td>
<td>
<p>A numeric value indicating the number of folds to be defined.
Default is <code>k=10</code>. Only applies for the <code>dCV</code> method.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_r">R</code></td>
<td>
<p>A numeric value indicating the number of times the sample is partitioned. Default is <code>R=1</code>. Only applies for <code>dCV</code>, <code>split</code> or <code>extrapolation</code> methods.</p>
</td></tr>
<tr><td><code id="corrected.wauc_+3A_b">B</code></td>
<td>
<p>A numeric value indicating the number of bootstrap resamples. Default is <code>B=200</code>. Only applies for <code>bootstrap</code> and  <code>subbootstrap</code> methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>See Iparragirre and Barrio (2024) for more information on the AUC correction methods and their performance.
</p>


<h3>Value</h3>

<p>The output object of this function is a list of 5 elements containing the following information:
</p>

<ul>
<li> <p><code>corrected.AUCw</code>: the corrected estimate of the weighted AUC.
</p>
</li>
<li> <p><code>correction.method</code>: the selected correction method.
</p>
</li>
<li> <p><code>formula</code>: formula of the model that has been fitted.
</p>
</li>
<li> <p><code>tags</code>: a list containing two elements with the following information:
</p>

<ul>
<li> <p><code>tag.event</code>: a character string indicating the event of interest.
</p>
</li>
<li> <p><code>tag.nonevent</code>: a character string indicating the non-event.
</p>
</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I. (2024).
Optimism Correction of the AUC with Complex Survey Data.
In: Einbeck, J., Maeng, H., Ogundimu, E., Perrakis, K. (eds)
Developments in Statistical Modelling. IWSM 2024. Contributions to Statistics.
Springer, Cham. https://doi.org/10.1007/978-3-031-65723-8_7
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_variables_wroc)
mydesign &lt;- survey::svydesign(ids = ~cluster, strata = ~strata,
                              weights = ~weights, nest = TRUE,
                              data = example_variables_wroc)
m &lt;- survey::svyglm(y ~ x1 + x2 + x3 + x4 + x5 + x6, design = mydesign,
                    family = quasibinomial())
phat &lt;- predict(m, newdata = example_variables_wroc, type = "response")
myaucw &lt;- wauc(response.var = example_variables_wroc$y, phat.var = phat,
               weights.var = example_variables_wroc$weights)

# Correction of the AUCw:
set.seed(1)
res &lt;- corrected.wauc(data = example_variables_wroc,
                      formula = y ~ x1 + x2 + x3 + x4 + x5 + x6,
                      tag.event = 1, tag.nonevent = 0,
                      weights.var = "weights", strata.var = "strata", cluster.var = "cluster",
                      method = "dCV", dCV.method = "pooling", k = 10, R = 20)
# Or equivalently:

set.seed(1)
res &lt;- corrected.wauc(design = mydesign,
                      formula = y ~ x1 + x2 + x3 + x4 + x5 + x6,
                      tag.event = 1, tag.nonevent = 0,
                      method = "dCV", dCV.method = "pooling", k = 10, R = 20)


</code></pre>

<hr>
<h2 id='example_data_wroc'>Simulated data</h2><span id='topic+example_data_wroc'></span>

<h3>Description</h3>

<p>This dataset has been simulated in order to provide the users with an example dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_data_wroc
</code></pre>


<h3>Format</h3>



<h4><code>example_data_wroc</code></h4>

<p>A data frame with 740 rows and 3 columns:
</p>

<dl>
<dt>y</dt><dd><p>Response variable</p>
</dd>
<dt>phat</dt><dd><p>Predicted probabilities</p>
</dd>
<dt>weights</dt><dd><p>Sampling weights</p>
</dd>
</dl>
<p>...

</p>


<hr>
<h2 id='example_variables_wroc'>Simulated data</h2><span id='topic+example_variables_wroc'></span>

<h3>Description</h3>

<p>This dataset has been simulated in order to provide the users with an example dataset.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_variables_wroc
</code></pre>


<h3>Format</h3>



<h4><code>example_variables_wroc</code></h4>

<p>A data frame with 1720 rows and 10 columns:
</p>

<dl>
<dt>y</dt><dd><p>Response variable</p>
</dd>
<dt>x1,...,x6</dt><dd><p>Covariates</p>
</dd>
<dt>strata</dt><dd><p>Strata variable</p>
</dd>
<dt>cluster</dt><dd><p>Cluster variable</p>
</dd>
<dt>weights</dt><dd><p>Sampling weights</p>
</dd>
</dl>
<p>...

</p>


<hr>
<h2 id='wauc'>Estimation of the AUC of logistic regression models with complex survey data.</h2><span id='topic+wauc'></span>

<h3>Description</h3>

<p>Calculate the AUC of a logistic regression model
considering sampling weights with complex survey data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wauc(
  response.var,
  phat.var,
  weights.var = NULL,
  tag.event = NULL,
  tag.nonevent = NULL,
  data = NULL,
  design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wauc_+3A_response.var">response.var</code></td>
<td>
<p>A character string with the name of the column indicating the response variable in the data set
or a vector (either numeric or character string) with information of the response variable for all the units.</p>
</td></tr>
<tr><td><code id="wauc_+3A_phat.var">phat.var</code></td>
<td>
<p>A character string with the name of the column indicating the estimated probabilities in the data set
or a numeric vector containing estimated probabilities for all the units.</p>
</td></tr>
<tr><td><code id="wauc_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights or
a numeric vector containing information of the sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.
For unweighted estimates, set all the sampling weight values to 1.</p>
</td></tr>
<tr><td><code id="wauc_+3A_tag.event">tag.event</code></td>
<td>
<p>A character string indicating the label used to indicate the event of interest in <code>response.var</code>.
The default option is <code>tag.event = NULL</code>, which selects the class with the lowest number of units as event.</p>
</td></tr>
<tr><td><code id="wauc_+3A_tag.nonevent">tag.nonevent</code></td>
<td>
<p>A character string indicating the label used for non-event in <code>response.var</code>.
The default option is <code>tag.nonevent = NULL</code>, which selects the class with the greatest number of units as non-event.</p>
</td></tr>
<tr><td><code id="wauc_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, then specific numerical vectors must be included in
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>,
or the sampling design should be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="wauc_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by
<code>survey::svydesign</code> indicating the complex sampling design of the data.
If <code>design = NULL</code>, information on the data set (argument <code>data</code>)
and/or sampling weights (argument <code>weights.var</code>) must be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">S</code> indicate a sample of <code class="reqn">n</code> observations of the vector of random variables <code class="reqn">(Y,\pmb X)</code>, and <code class="reqn">\forall i=1,\ldots,n,</code> <code class="reqn">y_i</code> indicate the <code class="reqn">i^{th}</code> observation of the response variable <code class="reqn">Y</code>,
and <code class="reqn">\pmb x_i</code> the observations of the vector covariates <code class="reqn">\pmb X</code>. Let <code class="reqn">w_i</code> indicate the sampling weight corresponding to the unit <code class="reqn">i</code> and <code class="reqn">\hat p_i</code> the estimated probability of event.
Let <code class="reqn">S_0</code> and <code class="reqn">S_1</code> be subsamples of <code class="reqn">S</code>, formed by the units without the event of interest (<code class="reqn">y_i=0</code>) and with the event of interest (<code class="reqn">y_i=1</code>), respectively.
Then, the AUC is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{AUC}_w=\dfrac{\sum_{j\in S_0}\sum_{k\in S_1}w_jw_k \{I(\hat p_j &lt; \hat p_k) + 0.5\cdot I(\hat p_j = \hat p_k)\}}{\sum_{j\in S_0}\sum_{k\in S_1}w_jw_k}.</code>
</p>

<p>See Iparragirre et al (2023) for more information.
</p>


<h3>Value</h3>

<p>The output object of this function is a list of 4 elements containing the following information:
</p>

<ul>
<li> <p><code>AUCw</code>: the weighted estimate of the AUC.
</p>
</li>
<li> <p><code>tags</code>: a list containing two elements with the following information:
</p>

<ul>
<li> <p><code>tag.event</code>: a character string indicating the event of interest.
</p>
</li>
<li> <p><code>tag.nonevent</code>: a character string indicating the non-event.
</p>
</li></ul>

</li>
<li> <p><code>basics</code>: a list containing information of the following 4 elements:
</p>

<ul>
<li> <p><code>n.event</code>: number of units with the event of interest in the data set.
</p>
</li>
<li> <p><code>n.nonevent</code>: number of units without the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.event</code>: number of units with the event of interest represented in the population by all the event units in the data set, i.e., the sum of the sampling weights of the units with the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.nonevent</code>: a numeric value indicating the number of non-event units in the population represented by means of the non-event units in the data set, i.e., the sum of the sampling weights of the non-event units in the data set.
</p>
</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I. and Arostegui, I. (2023).
Estimation of the ROC curve and the area under it with complex survey data.
<em>Stat</em> <strong>12</strong>(1), e635. (https://doi.org/10.1002/sta4.635)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

auc.obj &lt;- wauc(response.var = "y",
                phat.var = "phat",
                weights.var = "weights",
                tag.event = 1,
                tag.nonevent = 0,
                data = example_data_wroc)

# Or equivalently
auc.obj &lt;- wauc(response.var = example_data_wroc$y,
                phat.var = example_data_wroc$phat,
                weights.var = example_data_wroc$weights,
                tag.event = 1, tag.nonevent = 0)

</code></pre>

<hr>
<h2 id='wocp'>Optimal cut-off points for complex survey data</h2><span id='topic+wocp'></span>

<h3>Description</h3>

<p>Calculate optimal cut-off points for complex survey data (Iparragirre et al., 2022).
Some functions of the package OptimalCutpoints (Lopez-Raton et al, 2014) have been used and modified in order them to consider sampling weights.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wocp(
  response.var,
  phat.var,
  weights.var = NULL,
  tag.event = NULL,
  tag.nonevent = NULL,
  method = c("Youden", "MaxProdSpSe", "ROC01", "MaxEfficiency"),
  data = NULL,
  design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wocp_+3A_response.var">response.var</code></td>
<td>
<p>A character string with the name of the column indicating the response variable in the data set
or a vector (either numeric or character string) with information of the response variable for all the units.</p>
</td></tr>
<tr><td><code id="wocp_+3A_phat.var">phat.var</code></td>
<td>
<p>A character string with the name of the column indicating the estimated probabilities in the data set
or a numeric vector containing estimated probabilities for all the units.</p>
</td></tr>
<tr><td><code id="wocp_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights or
a numeric vector containing information of the sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.
For unweighted estimates, set all the sampling weight values to 1.</p>
</td></tr>
<tr><td><code id="wocp_+3A_tag.event">tag.event</code></td>
<td>
<p>A character string indicating the label used to indicate the event of interest in <code>response.var</code>.
The default option is <code>tag.event = NULL</code>, which selects the class with the lowest number of units as event.</p>
</td></tr>
<tr><td><code id="wocp_+3A_tag.nonevent">tag.nonevent</code></td>
<td>
<p>A character string indicating the label used for non-event in <code>response.var</code>.
The default option is <code>tag.nonevent = NULL</code>, which selects the class with the greatest number of units as non-event.</p>
</td></tr>
<tr><td><code id="wocp_+3A_method">method</code></td>
<td>
<p>A character string indicating the method to be used to select the optimal cut-off point.
Choose one of the following methods (Lopez-Raton et al, 2014):
<code>MaxProdSpSe</code>, <code>ROC01</code>, <code>Youden</code>, <code>MaxEfficiency</code>.</p>
</td></tr>
<tr><td><code id="wocp_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, then specific numerical vectors must be included in
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>,
or the sampling design should be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="wocp_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by
<code>survey::svydesign</code> indicating the complex sampling design of the data.
If <code>design = NULL</code>, information on the data set (argument <code>data</code>)
and/or sampling weights (argument <code>weights.var</code>) must be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">S</code> indicate a sample of <code class="reqn">n</code> observations of the vector of random variables <code class="reqn">(Y,\pmb X)</code>, and <code class="reqn">\forall i=1,\ldots,n,</code> <code class="reqn">y_i</code> indicate the <code class="reqn">i^{th}</code> observation of the response variable <code class="reqn">Y</code>,
and <code class="reqn">\pmb x_i</code> the observations of the vector covariates <code class="reqn">\pmb X</code>. Let <code class="reqn">w_i</code> indicate the sampling weight corresponding to the unit <code class="reqn">i</code> and <code class="reqn">\hat p_i</code> the estimated probability of event.
Let <code class="reqn">S_0</code> and <code class="reqn">S_1</code> be subsamples of <code class="reqn">S</code>, formed by the units without the event of interest (<code class="reqn">y_i=0</code>) and with the event of interest (<code class="reqn">y_i=1</code>), respectively.
Then, the optimal cut-off points are obtained as follows:
</p>

<ul>
<li> <p><code>Youden</code>: </p>
<p style="text-align: center;"><code class="reqn">c_w^{\text{Youden}}=argmax_c\{\widehat{Se}_w(c) + \widehat{Sp}_w(c)-1\},</code>
</p>

</li>
<li> <p><code>MaxProdSpSe</code>: </p>
<p style="text-align: center;"><code class="reqn">c_w^{\text{MaxProdSpSe}}=argmax_c\{\widehat{Se}_w(c) * \widehat{Sp}_w(c)\},</code>
</p>

</li>
<li> <p><code>ROC01</code>: </p>
<p style="text-align: center;"><code class="reqn">c_w^{\text{ROC01}}=argmax_c\{(\widehat{Se}_w(c)-1)^2 + (\widehat{Sp}_w(c)-1)^2\},</code>
</p>

</li>
<li> <p><code>MaxEfficiency</code>: </p>
<p style="text-align: center;"><code class="reqn">c_w^{\text{MaxEfficiency}}=argmax_c\{\hat p_{Y,w}\widehat{Se}_w(c) + (1-\hat p_{Y,w})\widehat{Sp}_w(c)\},</code>
</p>

</li></ul>

<p>where, the sensitivity and specificity parameters for a given cut-off point <code class="reqn">c</code> are estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Se}_w(c)=\dfrac{\sum_{i\in S_1}w_i\cdot I (\hat p_i\geq c)}{\sum_{i\in S_1}w_i}\:;\:\widehat{Sp}_w(c)=\dfrac{\sum_{i\in S_0}w_i\cdot I (\hat p_i&lt;c)}{\sum_{i\in S_0}w_i},</code>
</p>

<p>and,
</p>
<p style="text-align: center;"><code class="reqn">\hat p_{Y,w}=\dfrac{\sum_{i\in S} w_i\cdot I(y_i=1)}{\sum_{i\in S} w_i}.</code>
</p>

<p>See Iparragirre et al. (2022) and Lopez-Raton et al. (2014) for more information.
</p>


<h3>Value</h3>

<p>The output of this function is an object of class <code>wocp</code>. This object is a list that contains information about the following 4 elements:
</p>

<ul>
<li> <p><code>tags</code>: a list containing two elements with the following information:
</p>

<ul>
<li> <p><code>tag.event</code>: a character string indicating the event of interest.
</p>
</li>
<li> <p><code>tag.nonevent</code>: a character string indicating the non-event.
</p>
</li></ul>

</li>
<li> <p><code>basics</code>: a list containing information of the following 4 elements:
</p>

<ul>
<li> <p><code>n.event</code>: number of units with the event of interest in the data set.
</p>
</li>
<li> <p><code>n.nonevent</code>: number of units without the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.event</code>: number of units with the event of interest represented in the population by all the event units in the data set, i.e., the sum of the sampling weights of the units with the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.nonevent</code>: a numeric value indicating the number of non-event units in the population represented by means of the non-event units in the data set, i.e., the sum of the sampling weights of the non-event units in the data set.
</p>
</li></ul>

</li>
<li> <p><code>optimal.cutoff</code>: this object is a list of three elements containing the information described below:
</p>

<ul>
<li> <p><code>method</code>: a character string indicating the method implemented to select the optimal cut-off point.
</p>
</li>
<li> <p><code>optimal</code>: a list containing information of the following four elements:
</p>

<ul>
<li> <p><code>cutoff</code>: a numeric vector indicating the optimal cut-off point(s) that optimize(s) the selected criterion.
</p>
</li>
<li> <p><code>Sew</code>: a numeric vector indicating the estimated sensitivity parameter(s) corresponding to the optimal cut-off point(s) that optimize(s) the selected criterion.
</p>
</li>
<li> <p><code>Spw</code>: a numeric vector indicating the estimated specificity parameter(s) corresponding to the optimal cut-off point(s) that optimize(s) the selected criterion.
</p>
</li>
<li> <p><code>criterion</code>: a numeric value indicating the criterion value optimized by means of the selected optimal cut-off point(s).
</p>
</li></ul>

</li>
<li> <p><code>all</code>: a list containing information on the following four elements:
</p>

<ul>
<li> <p><code>cutoff</code>: a numeric vector indicating all the cut-off points considered.
</p>
</li>
<li> <p><code>Sew</code>: a numeric vector indicating the estimated sensitivity parameters corresponding to all the considered cut-off points.
</p>
</li>
<li> <p><code>Spw</code>: a numeric vector indicating the estimated sensitivity parameters corresponding to all the considered cut-off points.
</p>
</li>
<li> <p><code>criterion</code>: a numeric vector indicating the values of the selected criterion corresponding to all the considered cut-off points.
</p>
</li></ul>

</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I., Aramendi, J. and Arostegui, I. (2022). Estimation of cut-off points under complex-sampling design data. <em>SORT-Statistics and Operations Research Transactions</em> <b>46</b>(1), 137&ndash;158.
</p>
<p>Lopez-Raton, M., Rodriguez-Alvarez, M.X, Cadarso-Suarez, C. and Gude-Sampedro, F. (2014). OptimalCutpoints: An R Package for Selecting Optimal Cutpoints in Diagnostic Tests. <em>Journal of Statistical Software</em> <b>61</b>(8), 1&ndash;36.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

myocp &lt;- wocp(response.var = "y", phat.var = "phat", weights.var = "weights",
              tag.event = 1, tag.nonevent = 0,
              method = "Youden",
              data = example_data_wroc)

# Or equivalently
myocp &lt;- wocp(example_data_wroc$y, example_data_wroc$phat, example_data_wroc$weights,
              tag.event = 1, tag.nonevent = 0, method = "Youden")


</code></pre>

<hr>
<h2 id='wroc'>Estimation of the ROC curve of logistic regression models with complex survey data</h2><span id='topic+wroc'></span>

<h3>Description</h3>

<p>Calculate the ROC curve of a logistic regression model
considering sampling weights with complex survey data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wroc(
  response.var,
  phat.var,
  weights.var = NULL,
  tag.event = NULL,
  tag.nonevent = NULL,
  data = NULL,
  design = NULL,
  cutoff.method = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wroc_+3A_response.var">response.var</code></td>
<td>
<p>A character string with the name of the column indicating the response variable in the data set
or a vector (either numeric or character string) with information of the response variable for all the units.</p>
</td></tr>
<tr><td><code id="wroc_+3A_phat.var">phat.var</code></td>
<td>
<p>A character string with the name of the column indicating the estimated probabilities in the data set
or a numeric vector containing estimated probabilities for all the units.</p>
</td></tr>
<tr><td><code id="wroc_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights or
a numeric vector containing information of the sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.
For unweighted estimates, set all the sampling weight values to 1.</p>
</td></tr>
<tr><td><code id="wroc_+3A_tag.event">tag.event</code></td>
<td>
<p>A character string indicating the label used to indicate the event of interest in <code>response.var</code>.
The default option is <code>tag.event = NULL</code>, which selects the class with the lowest number of units as event.</p>
</td></tr>
<tr><td><code id="wroc_+3A_tag.nonevent">tag.nonevent</code></td>
<td>
<p>A character string indicating the label used for non-event in <code>response.var</code>.
The default option is <code>tag.nonevent = NULL</code>, which selects the class with the greatest number of units as non-event.</p>
</td></tr>
<tr><td><code id="wroc_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, then specific numerical vectors must be included in
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>,
or the sampling design should be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="wroc_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by
<code>survey::svydesign</code> indicating the complex sampling design of the data.
If <code>design = NULL</code>, information on the data set (argument <code>data</code>)
and/or sampling weights (argument <code>weights.var</code>) must be included.</p>
</td></tr>
<tr><td><code id="wroc_+3A_cutoff.method">cutoff.method</code></td>
<td>
<p>A character string indicating the method to be used to select the optimal cut-off point.
If <code>cutoff.method = NULL</code>, then no optimal cut-off point is calculated.
If an optimal cut-off point is to be calculated, one of the following methods needs to be selected:
<code>Youden</code>, <code>MaxProdSpSe</code>, <code>ROC01</code>, <code>MaxEfficiency</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">S</code> indicate a sample of <code class="reqn">n</code> observations of the vector of random variables <code class="reqn">(Y,\pmb X)</code>, and <code class="reqn">\forall i=1,\ldots,n,</code> <code class="reqn">y_i</code> indicate the <code class="reqn">i^{th}</code> observation of the response variable <code class="reqn">Y</code>,
and <code class="reqn">\pmb x_i</code> the observations of the vector covariates <code class="reqn">\pmb X</code>. Let <code class="reqn">w_i</code> indicate the sampling weight corresponding to the unit <code class="reqn">i</code> and <code class="reqn">\hat p_i</code> the estimated probability of event.
Let <code class="reqn">S_0</code> and <code class="reqn">S_1</code> be subsamples of <code class="reqn">S</code>, formed by the units without the event of interest (<code class="reqn">y_i=0</code>) and with the event of interest (<code class="reqn">y_i=1</code>), respectively.
Then, the ROC curve is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{ROC}_w(\cdot)=\{(1-\widehat{Sp}_w(c),\widehat{Se}_w(c)),\:c\in (-\infty, \infty)\}</code>
</p>
<p>,
where, the sensitivity and specificity parameters for a given cut-off point <code class="reqn">c</code> are estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Se}_w(c)=\dfrac{\sum_{i\in S_1}w_i\cdot I (\hat p_i\geq c)}{\sum_{i\in S_1}w_i}\:;\:\widehat{Sp}_w(c)=\dfrac{\sum_{i\in S_0}w_i\cdot I (\hat p_i&lt;c)}{\sum_{i\in S_0}w_i}.</code>
</p>

<p>See Iparragirre et al (2023) for more information. More information of the rest of the elements is given in the documentation of the functions <code>wauc()</code> and <code>wocp()</code>.
</p>


<h3>Value</h3>

<p>The output object of this function is a list of class <code>wroc</code>, which contains information about the weighted ROC curve of a logistic regression model and some of its components. In particular, this list contains a total of 5 or 6 elements (depending on the selected arguments) with the following information:
</p>

<ul>
<li> <p><code>wroc.curve</code>: this element is a list that contains three numerical vectors. Specifically,
</p>

<ul>
<li> <p><code>Sew.values</code>: a vector of all the different values for the weighted estimate of the sensitivity across all the possible cut-off points.
</p>
</li>
<li> <p><code>Spw.values</code>: a vector of all the different values for the weighted estimate of the specificity across all the possible cut-off points.
</p>
</li>
<li> <p><code>cutoffs</code>: this vector contains all the cut-off points that have been considered to estimate sensitivity and specificity parameters.
</p>
</li></ul>

</li>
<li> <p><code>wauc</code>: a numeric value indicating the area under the weighted estimate of the ROC curve.
</p>
</li>
<li> <p><code>optimal.cutoff</code>: if the argument <code>cutoff.method != NULL</code>, this object is a list containing the 4 elements described below:
</p>

<ul>
<li> <p><code>method</code>: character string indicating the method implemented to calculate the optimal cut-off point.
</p>
</li>
<li> <p><code>cutoff.value</code>: the optimal cut-off point value.
</p>
</li>
<li> <p><code>Spw</code>: the weighted estimate of the specificity for the optimal cut-off point value (indicated in <code>cutoff.value</code>).
</p>
</li>
<li> <p><code>Sew</code>: the weighted estimate of the sensitivity for the optimal cut-off point value (indicated in <code>cutoff.value</code>).
</p>
</li></ul>

</li>
<li> <p><code>tags</code>: a list containing two elements with the following information:
</p>

<ul>
<li> <p><code>tag.event</code>: a character string indicating the event of interest.
</p>
</li>
<li> <p><code>tag.nonevent</code>: a character string indicating the non-event.
</p>
</li></ul>

</li>
<li> <p><code>basics</code>: a list containing information of the following 4 elements:
</p>

<ul>
<li> <p><code>n.event</code>: number of units with the event of interest in the data set.
</p>
</li>
<li> <p><code>n.nonevent</code>: number of units without the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.event</code>: number of units with the event of interest represented in the population by all the event units in the data set, i.e., the sum of the sampling weights of the units with the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.nonevent</code>: a numeric value indicating the number of non-event units in the population represented by means of the non-event units in the data set, i.e., the sum of the sampling weights of the non-event units in the data set.
</p>
</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I. and Arostegui, I. (2023).
Estimation of the ROC curve and the area under it with complex survey data.
<em>Stat</em> <strong>12</strong>(1), e635. (https://doi.org/10.1002/sta4.635)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

mycurve &lt;- wroc(response.var = "y", phat.var = "phat", weights.var = "weights",
                data = example_data_wroc,
                tag.event = 1, tag.nonevent = 0,
                cutoff.method = "Youden")

# Or equivalently

mycurve &lt;- wroc(response.var = example_data_wroc$y,
                phat.var = example_data_wroc$phat,
                weights.var = example_data_wroc$weights,
                tag.event = 1, tag.nonevent = 0,
                cutoff.method = "Youden")

</code></pre>

<hr>
<h2 id='wroc.plot'>Estimation of the ROC curve of logistic regression models with complex survey data</h2><span id='topic+wroc.plot'></span>

<h3>Description</h3>

<p>Plot the ROC curve of a logistic regression model
considering sampling weights with complex survey data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wroc.plot(
  x,
  print.auc = TRUE,
  print.cutoff = FALSE,
  col.cutoff = "red",
  cex.text = 0.75,
  round.digits = 4
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wroc.plot_+3A_x">x</code></td>
<td>
<p>An object of class <code>wroc</code> obtained by means of the function <code>wroc()</code>.</p>
</td></tr>
<tr><td><code id="wroc.plot_+3A_print.auc">print.auc</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the value of the area under the ROCw curve (AUCw) is printed (default <code>print.auc = TRUE</code>).</p>
</td></tr>
<tr><td><code id="wroc.plot_+3A_print.cutoff">print.cutoff</code></td>
<td>
<p>A logical value. If <code>TRUE</code>, the value of the optimal cut-off point, and the corresponding weighted estimates of the sensitivity and specificity parameters are printed (default <code>print.cutoff = TRUE</code>).</p>
</td></tr>
<tr><td><code id="wroc.plot_+3A_col.cutoff">col.cutoff</code></td>
<td>
<p>A character string indicating the color in which the cut-off point is depicted. The default option is <code>col.cutoff = "red"</code>.</p>
</td></tr>
<tr><td><code id="wroc.plot_+3A_cex.text">cex.text</code></td>
<td>
<p>A numeric value indicating the size with which the information of the AUCw and optimal cut-off point is printed. The default option is <code>cex.text = 0.75</code>.</p>
</td></tr>
<tr><td><code id="wroc.plot_+3A_round.digits">round.digits</code></td>
<td>
<p>A numeric value indicating the number of digits that will be employed when printing the information about the AUCw and optimal cut-off point. The default option is <code>round.digits = 4</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>More information is given in the documentation of the <code>wroc()</code>, <code>wauc{}</code> and <code>wocp()</code> functions.
</p>


<h3>Value</h3>

<p>a graph
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

mycurve &lt;- wroc(response.var = "y", phat.var = "phat", weights.var = "weights",
                data = example_data_wroc,
                tag.event = 1, tag.nonevent = 0,
                cutoff.method = "Youden")
wroc.plot(x = mycurve, print.auc = TRUE, print.cutoff = TRUE)

</code></pre>

<hr>
<h2 id='wse'>Estimation of the sensitivity with complex survey data</h2><span id='topic+wse'></span>

<h3>Description</h3>

<p>Estimate the sensitivity parameter for a given cut-off point
considering sampling weights with complex survey data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wse(
  response.var,
  phat.var,
  weights.var = NULL,
  tag.event = NULL,
  cutoff.value,
  data = NULL,
  design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wse_+3A_response.var">response.var</code></td>
<td>
<p>A character string with the name of the column indicating the response variable in the data set
or a vector (either numeric or character string) with information of the response variable for all the units.</p>
</td></tr>
<tr><td><code id="wse_+3A_phat.var">phat.var</code></td>
<td>
<p>A character string with the name of the column indicating the estimated probabilities in the data set
or a numeric vector containing estimated probabilities for all the units.</p>
</td></tr>
<tr><td><code id="wse_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights or
a numeric vector containing information of the sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.
For unweighted estimates, set all the sampling weight values to 1.</p>
</td></tr>
<tr><td><code id="wse_+3A_tag.event">tag.event</code></td>
<td>
<p>A character string indicating the label used to indicate the event of interest in <code>response.var</code>.
The default option is <code>tag.event = NULL</code>, which selects the class with the lowest number of units as event.</p>
</td></tr>
<tr><td><code id="wse_+3A_cutoff.value">cutoff.value</code></td>
<td>
<p>A numeric value indicating the cut-off point to be used.
No default value is set for this argument, and a numeric value must be indicated necessarily.</p>
</td></tr>
<tr><td><code id="wse_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, then specific numerical vectors must be included in
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>,
or the sampling design should be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="wse_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by
<code>survey::svydesign</code> indicating the complex sampling design of the data.
If <code>design = NULL</code>, information on the data set (argument <code>data</code>)
and/or sampling weights (argument <code>weights.var</code>) must be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">S</code> indicate a sample of <code class="reqn">n</code> observations of the vector of random variables <code class="reqn">(Y,\pmb X)</code>, and <code class="reqn">\forall i=1,\ldots,n,</code> <code class="reqn">y_i</code> indicate the <code class="reqn">i^{th}</code> observation of the response variable <code class="reqn">Y</code>,
and <code class="reqn">\pmb x_i</code> the observations of the vector covariates <code class="reqn">\pmb X</code>. Let <code class="reqn">w_i</code> indicate the sampling weight corresponding to the unit <code class="reqn">i</code> and <code class="reqn">\hat p_i</code> the estimated probability of event.
Let <code class="reqn">S_0</code> and <code class="reqn">S_1</code> be subsamples of <code class="reqn">S</code>, formed by the units without the event of interest (<code class="reqn">y_i=0</code>) and with the event of interest (<code class="reqn">y_i=1</code>), respectively.
Then, the sensitivity parameter for a given cut-off point <code class="reqn">c</code> is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Se}_w(c)=\dfrac{\sum_{i\in S_1}w_i\cdot I (\hat p_i\geq c)}{\sum_{i\in S_1}w_i}.</code>
</p>

<p>See Iparragirre et al. (2022) and Iparragirre et al. (2023) for more details.
</p>


<h3>Value</h3>

<p>The output of this function is a list of 4 elements containing the following information:
</p>

<ul>
<li> <p><code>Sew</code>: a numeric value indicating the weighted estimate of the sensitivity parameter.
</p>
</li>
<li> <p><code>tags</code>: list containing one element with the following information:
</p>

<ul>
<li> <p><code>tag.event</code>: a character string indicating the label used to indicate event of interest.
</p>
</li></ul>

</li>
<li> <p><code>basics</code>: a list containing information of the following 6 elements:
</p>

<ul>
<li> <p><code>n</code>: a numeric value indicating the number of units in the data set.
</p>
</li>
<li> <p><code>n.event</code>: a numeric value indicating the number of units in the data set with the event of interest.
</p>
</li>
<li> <p><code>n.event.class</code>: a numeric value indicating the number of units in the data set with the event of interest that are correctly classified as events based on the selected cut-off point.
</p>
</li>
<li> <p><code>hatN</code>: number of units in the population, represented by all the units in the data set, i.e., the sum of the sampling weights of the units in the data set.
</p>
</li>
<li> <p><code>hatN.event</code>: number of units with the event of interest represented in the population by all the event units in the data set, i.e., the sum of the sampling weights of the units with the event of interest in the data set.
</p>
</li>
<li> <p><code>hatN.event.class</code>: number of event units represented in the population by the event units in the data set that have been correctly classified as events based on the selected cut-off point, i.e., the sum of the sampling weights of the correctly classified event units in the data set.
</p>
</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I., Aramendi, J. and Arostegui, I. (2022).
Estimation of cut-off points under complex-sampling design data.
<em>SORT-Statistics and Operations Research Transactions</em> <strong>46</strong>(1), 137&ndash;158. (https://doi.org/10.2436/20.8080.02.121)
</p>
<p>Iparragirre, A., Barrio, I. and Arostegui, I. (2023).
Estimation of the ROC curve and the area under it with complex survey data.
<em>Stat</em> <strong>12</strong>(1), e635. (https://doi.org/10.1002/sta4.635)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

se.obj &lt;- wse(response.var = "y", phat.var = "phat", weights.var = "weights",
              tag.event = 1, cutoff.value = 0.5, data = example_data_wroc)

# Or equivalently
se.obj &lt;- wse(response.var = example_data_wroc$y,
              phat.var = example_data_wroc$phat,
              weights.var = example_data_wroc$weights,
              tag.event = 1, cutoff.value = 0.5)
</code></pre>

<hr>
<h2 id='wsp'>Estimation of the specificity with complex survey data</h2><span id='topic+wsp'></span>

<h3>Description</h3>

<p>Estimate the specificity parameter for a given cut-off point
considering sampling weights with complex survey data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wsp(
  response.var,
  phat.var,
  weights.var = NULL,
  tag.nonevent = NULL,
  cutoff.value,
  data = NULL,
  design = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="wsp_+3A_response.var">response.var</code></td>
<td>
<p>A character string with the name of the column indicating the response variable in the data set
or a vector (either numeric or character string) with information of the response variable for all the units.</p>
</td></tr>
<tr><td><code id="wsp_+3A_phat.var">phat.var</code></td>
<td>
<p>A character string with the name of the column indicating the estimated probabilities in the data set
or a numeric vector containing estimated probabilities for all the units.</p>
</td></tr>
<tr><td><code id="wsp_+3A_weights.var">weights.var</code></td>
<td>
<p>A character string indicating the name of the column with sampling weights or
a numeric vector containing information of the sampling weights.
It could be <code>NULL</code> if the sampling design is indicated in the <code>design</code> argument.
For unweighted estimates, set all the sampling weight values to 1.</p>
</td></tr>
<tr><td><code id="wsp_+3A_tag.nonevent">tag.nonevent</code></td>
<td>
<p>A character string indicating the label used for non-event in <code>response.var</code>.
The default option is <code>tag.nonevent = NULL</code>, which selects the class with the greatest number of units as non-event.</p>
</td></tr>
<tr><td><code id="wsp_+3A_cutoff.value">cutoff.value</code></td>
<td>
<p>A numeric value indicating the cut-off point to be used.
No default value is set for this argument, and a numeric value must be indicated necessarily.</p>
</td></tr>
<tr><td><code id="wsp_+3A_data">data</code></td>
<td>
<p>A data frame which, at least, must incorporate information on the columns
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>.
If <code>data=NULL</code>, then specific numerical vectors must be included in
<code>response.var</code>, <code>phat.var</code> and <code>weights.var</code>,
or the sampling design should be indicated in the argument <code>design</code>.</p>
</td></tr>
<tr><td><code id="wsp_+3A_design">design</code></td>
<td>
<p>An object of class <code>survey.design</code> generated by
<code>survey::svydesign</code> indicating the complex sampling design of the data.
If <code>design = NULL</code>, information on the data set (argument <code>data</code>)
and/or sampling weights (argument <code>weights.var</code>) must be included.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let <code class="reqn">S</code> indicate a sample of <code class="reqn">n</code> observations of the vector of random variables <code class="reqn">(Y,\pmb X)</code>, and <code class="reqn">\forall i=1,\ldots,n,</code> <code class="reqn">y_i</code> indicate the <code class="reqn">i^{th}</code> observation of the response variable <code class="reqn">Y</code>,
and <code class="reqn">\pmb x_i</code> the observations of the vector covariates <code class="reqn">\pmb X</code>. Let <code class="reqn">w_i</code> indicate the sampling weight corresponding to the unit <code class="reqn">i</code> and <code class="reqn">\hat p_i</code> the estimated probability of event.
Let <code class="reqn">S_0</code> and <code class="reqn">S_1</code> be subsamples of <code class="reqn">S</code>, formed by the units without the event of interest (<code class="reqn">y_i=0</code>) and with the event of interest (<code class="reqn">y_i=1</code>), respectively.
Then, the specificity parameter for a given cut-off point <code class="reqn">c</code> is estimated as follows:
</p>
<p style="text-align: center;"><code class="reqn">\widehat{Sp}_w(c)=\dfrac{\sum_{i\in S_0}w_i\cdot I (\hat p_i&lt;c)}{\sum_{i\in S_0}w_i}.</code>
</p>

<p>See Iparragirre et al. (2022) and Iparragirre et al. (2023) for more details.
</p>


<h3>Value</h3>

<p>The output of this function is a list of 4 elements containing the following information:
</p>

<ul>
<li> <p><code>Spw</code>: a numeric value indicating the weighted estimate of the specificity parameter.
</p>
</li>
<li> <p><code>tags</code>: a list containing one element with the following information:
</p>

<ul>
<li> <p><code>tag.nonevent</code>: a character string indicating the label used for non-events.
</p>
</li></ul>

</li>
<li> <p><code>basics</code>: a list containing information of the following 6 elements:
</p>

<ul>
<li> <p><code>n</code>: a numeric value indicating the number of units in the data set.
</p>
</li>
<li> <p><code>n.nonevent</code>: a numeric value indicating the number of units in the data set without the event of interest.
</p>
</li>
<li> <p><code>n.nonevent.class</code>: a numeric value indicating the number of units in the data set without the event of interest that are correctly classified as non-events based on the selected cut-off point.
</p>
</li>
<li> <p><code>hatN</code>: a numeric value indicating the number of units in the population that are represented by means of the units in the data set, i.e., the sum of the sampling weights of all the units in the data set.
</p>
</li>
<li> <p><code>hatN.nonevent</code>: a numeric value indicating the number of non-event units in the population represented by means of the non-event units in the data set, i.e., the sum of the sampling weights of the non-event units in the data set.
</p>
</li>
<li> <p><code>hatN.nonevent.class</code>: number of non-event units represented in the population by the non-event units in the data set that have been correctly classified as non-events based on the selected cut-off point, i.e., the sum of the sampling weights of the correctly classified non-event units in the data set.
</p>
</li></ul>

</li>
<li> <p><code>call</code>: an object saving the information about the way in which the function has been run.
</p>
</li></ul>



<h3>References</h3>

<p>Iparragirre, A., Barrio, I., Aramendi, J. and Arostegui, I. (2022).
Estimation of cut-off points under complex-sampling design data.
<em>SORT-Statistics and Operations Research Transactions</em> <strong>46</strong>(1), 137&ndash;158. (https://doi.org/10.2436/20.8080.02.121)
</p>
<p>Iparragirre, A., Barrio, I. and Arostegui, I. (2023).
Estimation of the ROC curve and the area under it with complex survey data.
<em>Stat</em> <strong>12</strong>(1), e635. (https://doi.org/10.1002/sta4.635)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(example_data_wroc)

sp.obj &lt;- wsp(response.var = "y",
              phat.var = "phat",
              weights.var = "weights",
              tag.nonevent = 0,
              cutoff.value = 0.5,
              data = example_data_wroc)

# Or equivalently
sp.obj &lt;- wsp(response.var = example_data_wroc$y,
              phat.var = example_data_wroc$phat,
              weights.var = example_data_wroc$weights,
              tag.nonevent = 0,
              cutoff.value = 0.5)
sp.obj
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
