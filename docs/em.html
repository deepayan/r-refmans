<!DOCTYPE html><html><head><title>Help for package em</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {em}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#cstep'><p>C-Step of EM algorithm</p></a></li>
<li><a href='#em'><p>A Generic EM Algorithm</p></a></li>
<li><a href='#em.clogit'><p>The em function for 'survival::clogit'.</p></a></li>
<li><a href='#em.default'><p>The default em function</p></a></li>
<li><a href='#em.fitdist'><p>The default em function</p></a></li>
<li><a href='#em.glmerMod'><p>The em function for glmerMod</p></a></li>
<li><a href='#em.panelmodel'><p>The em function for 'panelmodel' such as 'plm'.</p></a></li>
<li><a href='#estep'><p>This function performs an E-Step of EM Algorithm.</p></a></li>
<li><a href='#fit.den'><p>Fit the density function for a fitted model.</p></a></li>
<li><a href='#fit.den.coxph'><p>Fit the density for the survival::clogit</p></a></li>
<li><a href='#fit.den.fitdist'><p>Fitting the density function using in 'fitdistrplus::fitdist()'</p></a></li>
<li><a href='#fit.den.glm'><p>Fit the density function for a generalized linear regression model.</p></a></li>
<li><a href='#fit.den.glmerMod'><p>Fit the density function for a generalized linear mixed effect model.</p></a></li>
<li><a href='#fit.den.gnm'><p>Fit the density function for a generalized non-linear regression model.</p></a></li>
<li><a href='#fit.den.lm'><p>Fit the density function for a linear regression model.</p></a></li>
<li><a href='#fit.den.multinom'><p>Fit the density function for a multinomial regression model.</p></a></li>
<li><a href='#fit.den.nnet'><p>Fit the density function for a 'nnet' model.</p></a></li>
<li><a href='#fit.den.plm'><p>Fit the density function for a panel regression model.</p></a></li>
<li><a href='#flatten'><p>Flatten a data.frame or matrix by column or row with its name.</p>
The name will be transformed into the number of row/column plus
the name of column/row separated by '.'.</a></li>
<li><a href='#init.em'><p>Initialization of EM algorithm</p></a></li>
<li><a href='#init.em.hc'><p>model-based agglomerative hierarchical clustering</p></a></li>
<li><a href='#init.em.kmeans'><p>K-mean initialization</p></a></li>
<li><a href='#init.em.random'><p>Random initialization</p></a></li>
<li><a href='#init.em.random.weights'><p>Random initialization with weights</p></a></li>
<li><a href='#init.em.sample5'><p>Initialization using sampling 5 times.</p></a></li>
<li><a href='#logLik.em'><p>This function computes logLik of EM Algorithm.</p></a></li>
<li><a href='#mstep'><p>M-Step of EM algorithm</p></a></li>
<li><a href='#mstep.concomitant'><p>The mstep for the concomitant model.</p></a></li>
<li><a href='#mstep.concomitant.refit'><p>The refit of for the concomitant model.</p>
This section was inspired by Flexmix.</a></li>
<li><a href='#multi.em'><p>Multiple run of EM algorithm</p></a></li>
<li><a href='#multi.em.default'><p>Default generic for multi.em</p></a></li>
<li><a href='#plot.em'><p>Plot the fitted results of EM algorithm</p></a></li>
<li><a href='#predict.em'><p>Predict the fitted finite mixture models</p></a></li>
<li><a href='#print.em'><p>Print the 'em' object</p></a></li>
<li><a href='#print.summary.em'><p>Print the 'summary.em' object</p></a></li>
<li><a href='#simbinom'><p>Simulated Data from a logistic regression</p></a></li>
<li><a href='#simclogit'><p>Simulated Data from a conditional logistic regression</p></a></li>
<li><a href='#simreg'><p>Simulated Regression Data</p></a></li>
<li><a href='#sstep'><p>S-step of EM algorithm</p></a></li>
<li><a href='#summary.em'><p>Summaries of fitted finite mixture models using EM algorithm</p></a></li>
<li><a href='#vdummy'><p>Transform a factor variable to a matrix of dummy variables</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Generic EM Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A generic function for running the Expectation-Maximization (EM) algorithm
  within a maximum likelihood framework, based on Dempster, Laird, and Rubin (1977) &lt;<a href="https://doi.org/10.1111%2Fj.2517-6161.1977.tb01600.x">doi:10.1111/j.2517-6161.1977.tb01600.x</a>&gt;
  is implemented. It can be applied after a model fitting using R's existing functions and packages.</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/wudongjie/em">https://github.com/wudongjie/em</a></td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>C++11</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/wudongjie/em/issues">https://github.com/wudongjie/em/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, utils, survival, plm, methods, mclust, dplyr, numDeriv,
nnet, magrittr</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), parallel, fitdistrplus, gnm</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-09 23:27:09 UTC; eastm</td>
</tr>
<tr>
<td>Author:</td>
<td>Dongjie Wu <a href="https://orcid.org/0000-0002-4490-8657"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Dongjie Wu &lt;dwu.jacob@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-11 06:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='cstep'>C-Step of EM algorithm</h2><span id='topic+cstep'></span>

<h3>Description</h3>

<p>Given the posterior probability, generate a matrix to assign
each individual to a class. The assignment is based on which probability is the largest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cstep(postpr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cstep_+3A_postpr">postpr</code></td>
<td>
<p>('matrix()') <br />
The matrix of the posterior probability</p>
</td></tr>
</table>

<hr>
<h2 id='em'>A Generic EM Algorithm</h2><span id='topic+em'></span>

<h3>Description</h3>

<p>This is a generic EM algorithm that can work on specific models/objects.
Currently, it supports 'lm', 'glm', 'gnm' in package gnm,
'clogit' in package survival and 'multinom' in package nnet.
Use '?em.default' to check the manual of the default function of 'em'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm', 'clogit', 'multinom'</p>
</td></tr>
<tr><td><code id="em_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>


<h3>Author(s)</h3>

<p>Dongjie Wu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit.lm &lt;- lm(yn ~ x, data = simreg)
results &lt;- em(fit.lm, latent = 2, verbose = FALSE) 
fmm_fit &lt;- predict(results)
fmm_fit_post &lt;- predict(results, prob = "posterior")

</code></pre>

<hr>
<h2 id='em.clogit'>The em function for 'survival::clogit'.</h2><span id='topic+em.clogit'></span>

<h3>Description</h3>

<p>The em function for 'survival::clogit'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'clogit'
em(
  object,
  latent = 2,
  verbose = FALSE,
  init.method = c("random", "kmeans", "hc"),
  init.prob = NULL,
  algo = c("em", "cem", "sem"),
  cluster.by = NULL,
  max_iter = 500,
  abs_tol = 1e-04,
  concomitant = list(...),
  use.optim = FALSE,
  optim.start = c("random", "sample5"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em.clogit_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm'.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_latent">latent</code></td>
<td>
<p>the number of latent classes.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_verbose">verbose</code></td>
<td>
<p>'True' to print the process of convergence.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_init.method">init.method</code></td>
<td>
<p>the initialization method used in the model.
The default method is 'random'. 'kmeans' is K-means clustering.
'hc' is model-based agglomerative hierarchical clustering.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_init.prob">init.prob</code></td>
<td>
<p>the starting prior probabilities used in classification based method.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_algo">algo</code></td>
<td>
<p>the algorithm used in em: 'em' the default EM algorithm,
the classification em 'cem', or the stochastic em 'sem'.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_cluster.by">cluster.by</code></td>
<td>
<p>a variable to define the level of clustering.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum iteration for em algorithm.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_abs_tol">abs_tol</code></td>
<td>
<p>absolute accuracy requested.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_concomitant">concomitant</code></td>
<td>
<p>the formula to define the concomitant part of the model.
The default is NULL.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_use.optim">use.optim</code></td>
<td>
<p>maximize the complete log likelihood (MLE) by using 'optim' and 'rcpp' code.The default value is 'FALSE'.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_optim.start">optim.start</code></td>
<td>
<p>the initialization method of generating the starting value for MLE.</p>
</td></tr>
<tr><td><code id="em.clogit_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>

<hr>
<h2 id='em.default'>The default em function</h2><span id='topic+em.default'></span>

<h3>Description</h3>

<p>The default em function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
em(
  object,
  latent = 2,
  verbose = FALSE,
  init.method = c("random", "kmeans", "hc"),
  init.prob = NULL,
  algo = c("em", "cem", "sem"),
  cluster.by = NULL,
  max_iter = 500,
  abs_tol = 1e-04,
  concomitant = list(...),
  use.optim = FALSE,
  optim.start = c("random", "sample5"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em.default_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm'.</p>
</td></tr>
<tr><td><code id="em.default_+3A_latent">latent</code></td>
<td>
<p>the number of latent classes.</p>
</td></tr>
<tr><td><code id="em.default_+3A_verbose">verbose</code></td>
<td>
<p>'True' to print the process of convergence.</p>
</td></tr>
<tr><td><code id="em.default_+3A_init.method">init.method</code></td>
<td>
<p>the initialization method used in the model.
The default method is 'random'. 'kmeans' is K-means clustering.
'hc' is model-based agglomerative hierarchical clustering.</p>
</td></tr>
<tr><td><code id="em.default_+3A_init.prob">init.prob</code></td>
<td>
<p>the starting prior probabilities used in classification based method.</p>
</td></tr>
<tr><td><code id="em.default_+3A_algo">algo</code></td>
<td>
<p>the algorithm used in em: 'em' the default EM algorithm,
the classification em 'cem', or the stochastic em 'sem'.</p>
</td></tr>
<tr><td><code id="em.default_+3A_cluster.by">cluster.by</code></td>
<td>
<p>a variable to define the level of clustering.</p>
</td></tr>
<tr><td><code id="em.default_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum iteration for em algorithm.</p>
</td></tr>
<tr><td><code id="em.default_+3A_abs_tol">abs_tol</code></td>
<td>
<p>absolute accuracy requested.</p>
</td></tr>
<tr><td><code id="em.default_+3A_concomitant">concomitant</code></td>
<td>
<p>the formula to define the concomitant part of the model.
The default is NULL.</p>
</td></tr>
<tr><td><code id="em.default_+3A_use.optim">use.optim</code></td>
<td>
<p>maximize the complete log likelihood (MLE) by using 'optim' and 'rcpp' code.The default value is 'FALSE'.</p>
</td></tr>
<tr><td><code id="em.default_+3A_optim.start">optim.start</code></td>
<td>
<p>the initialization method of generating the starting value for MLE.</p>
</td></tr>
<tr><td><code id="em.default_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>

<hr>
<h2 id='em.fitdist'>The default em function</h2><span id='topic+em.fitdist'></span>

<h3>Description</h3>

<p>The default em function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitdist'
em(
  object,
  latent = 2,
  verbose = FALSE,
  init.method = c("random", "kmeans", "hc"),
  init.prob = NULL,
  algo = c("em", "cem", "sem"),
  max_iter = 500,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em.fitdist_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm'.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_latent">latent</code></td>
<td>
<p>the number of latent classes.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_verbose">verbose</code></td>
<td>
<p>'True' to print the process of convergence.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_init.method">init.method</code></td>
<td>
<p>the initialization method used in the model.
The default method is 'random'. 'kmeans' is K-means clustering.
'hc' is model-based agglomerative hierarchical clustering.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_init.prob">init.prob</code></td>
<td>
<p>the starting prior probabilities used in classification based method.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_algo">algo</code></td>
<td>
<p>the algorithm used in em: 'em' the default EM algorithm,
the classification em 'cem', or the stochastic em 'sem'.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum iteration for em algorithm.</p>
</td></tr>
<tr><td><code id="em.fitdist_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>

<hr>
<h2 id='em.glmerMod'>The em function for glmerMod</h2><span id='topic+em.glmerMod'></span>

<h3>Description</h3>

<p>The em function for glmerMod
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmerMod'
em(
  object,
  latent = 2,
  verbose = FALSE,
  init.method = c("random", "kmeans", "hc"),
  algo = c("em", "cem", "sem"),
  max_iter = 500,
  concomitant = list(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em.glmerMod_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm'.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_latent">latent</code></td>
<td>
<p>the number of latent classes.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_verbose">verbose</code></td>
<td>
<p>'True' to print the process of convergence.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_init.method">init.method</code></td>
<td>
<p>the initialization method used in the model.
The default method is 'random'. 'kmeans' is K-means clustering.
'hc' is model-based agglomerative hierarchical clustering.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_algo">algo</code></td>
<td>
<p>the algorithm used in em: 'em' the default EM algorithm,
the classification em 'cem', or the stochastic em 'sem'.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum iteration for em algorithm.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_concomitant">concomitant</code></td>
<td>
<p>the formula to define the concomitant part of the model.
The default is NULL.</p>
</td></tr>
<tr><td><code id="em.glmerMod_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>

<hr>
<h2 id='em.panelmodel'>The em function for 'panelmodel' such as 'plm'.</h2><span id='topic+em.panelmodel'></span>

<h3>Description</h3>

<p>The em function for 'panelmodel' such as 'plm'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'panelmodel'
em(
  object,
  latent = 2,
  verbose = FALSE,
  init.method = c("random", "kmeans"),
  algo = c("em", "cem", "sem"),
  max_iter = 500,
  concomitant = list(...),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="em.panelmodel_+3A_object">object</code></td>
<td>
<p>the model used, e.g. 'lm', 'glm', 'gnm', 'plm'.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_latent">latent</code></td>
<td>
<p>the number of latent classes.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_verbose">verbose</code></td>
<td>
<p>'True' to print the process of convergence.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_init.method">init.method</code></td>
<td>
<p>the initialization method used in the model.
The default method is 'random'.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_algo">algo</code></td>
<td>
<p>the algorithm used in em: the default EM algorithm,
the classification em 'cem', or the stochastic em 'sem'.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_max_iter">max_iter</code></td>
<td>
<p>the maximum iteration for em algorithm.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_concomitant">concomitant</code></td>
<td>
<p>the formula to define the concomitant part of the model.
The default is NULL.</p>
</td></tr>
<tr><td><code id="em.panelmodel_+3A_...">...</code></td>
<td>
<p>arguments used in the 'model'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'em' is a list containing at least the following components:
<code>models</code> a list of models/objects whose class are determined by a model fitting from the previous step.  
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>algorithm</code> the algorithm used (could be either 'em', 'sem' or 'cem').
<code>obs</code> the number of observations.
<code>post_pr</code> the posterior probabilities.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>init.method</code> the initialization method used.
<code>call</code> the matched call.
<code>terms</code> the codeterms object used.
</p>

<hr>
<h2 id='estep'>This function performs an E-Step of EM Algorithm.</h2><span id='topic+estep'></span>

<h3>Description</h3>

<p>This function performs an E-Step of EM Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estep(models, pi_matrix)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estep_+3A_models">models</code></td>
<td>
<p>models used in the EM algorithm,</p>
</td></tr>
<tr><td><code id="estep_+3A_pi_matrix">pi_matrix</code></td>
<td>
<p>the pi matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the fitting result for the model.
</p>

<hr>
<h2 id='fit.den'>Fit the density function for a fitted model.</h2><span id='topic+fit.den'></span>

<h3>Description</h3>

<p>This function generates the probability density of given models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den_+3A_object">object</code></td>
<td>
<p>the fitted model such as 'lm'.</p>
</td></tr>
<tr><td><code id="fit.den_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.coxph'>Fit the density for the survival::clogit</h2><span id='topic+fit.den.coxph'></span>

<h3>Description</h3>

<p>Fit the density for the survival::clogit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'coxph'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.coxph_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.coxph_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.fitdist'>Fitting the density function using in 'fitdistrplus::fitdist()'</h2><span id='topic+fit.den.fitdist'></span>

<h3>Description</h3>

<p>Fitting the density function using in 'fitdistrplus::fitdist()'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'fitdist'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.fitdist_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.fitdist_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.glm'>Fit the density function for a generalized linear regression model.</h2><span id='topic+fit.den.glm'></span>

<h3>Description</h3>

<p>Fit the density function for a generalized linear regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glm'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.glm_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.glm_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.glmerMod'>Fit the density function for a generalized linear mixed effect model.</h2><span id='topic+fit.den.glmerMod'></span>

<h3>Description</h3>

<p>Fit the density function for a generalized linear mixed effect model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'glmerMod'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.glmerMod_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.glmerMod_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.gnm'>Fit the density function for a generalized non-linear regression model.</h2><span id='topic+fit.den.gnm'></span>

<h3>Description</h3>

<p>Fit the density function for a generalized non-linear regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gnm'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.gnm_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.gnm_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.lm'>Fit the density function for a linear regression model.</h2><span id='topic+fit.den.lm'></span>

<h3>Description</h3>

<p>Fit the density function for a linear regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lm'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.lm_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.lm_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.multinom'>Fit the density function for a multinomial regression model.</h2><span id='topic+fit.den.multinom'></span>

<h3>Description</h3>

<p>Fit the density function for a multinomial regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'multinom'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.multinom_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.multinom_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.nnet'>Fit the density function for a 'nnet' model.</h2><span id='topic+fit.den.nnet'></span>

<h3>Description</h3>

<p>Fit the density function for a 'nnet' model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'nnet'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.nnet_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.nnet_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='fit.den.plm'>Fit the density function for a panel regression model.</h2><span id='topic+fit.den.plm'></span>

<h3>Description</h3>

<p>Fit the density function for a panel regression model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plm'
fit.den(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="fit.den.plm_+3A_object">object</code></td>
<td>
<p>the fitted model.</p>
</td></tr>
<tr><td><code id="fit.den.plm_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the density function.
</p>

<hr>
<h2 id='flatten'>Flatten a data.frame or matrix by column or row with its name.
The name will be transformed into the number of row/column plus
the name of column/row separated by '.'.</h2><span id='topic+flatten'></span>

<h3>Description</h3>

<p>Flatten a data.frame or matrix by column or row with its name.
The name will be transformed into the number of row/column plus
the name of column/row separated by '.'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatten(x, by = c("col", "row"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flatten_+3A_x">x</code></td>
<td>
<p>a data.frame or matrix.</p>
</td></tr>
<tr><td><code id="flatten_+3A_by">by</code></td>
<td>
<p>either by column or by row.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a flattened vector with names
</p>

<hr>
<h2 id='init.em'>Initialization of EM algorithm</h2><span id='topic+init.em'></span>

<h3>Description</h3>

<p>Given a matrix with number of rows equal to the number of
observation and number of columns equal to the number of latent classes,
function 'init.em' generate the posterior probability using that matrix
based on the method set by the user.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='init.em.hc'>model-based agglomerative hierarchical clustering</h2><span id='topic+init.em.hc'></span>

<h3>Description</h3>

<p>model-based agglomerative hierarchical clustering
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'hc'
init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em.hc_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em.hc_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='init.em.kmeans'>K-mean initialization</h2><span id='topic+init.em.kmeans'></span>

<h3>Description</h3>

<p>K-mean initialization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'kmeans'
init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em.kmeans_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em.kmeans_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='init.em.random'>Random initialization</h2><span id='topic+init.em.random'></span>

<h3>Description</h3>

<p>Random initialization
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'random'
init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em.random_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em.random_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='init.em.random.weights'>Random initialization with weights</h2><span id='topic+init.em.random.weights'></span>

<h3>Description</h3>

<p>Random initialization with weights
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'random.weights'
init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em.random.weights_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em.random.weights_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='init.em.sample5'>Initialization using sampling 5 times.</h2><span id='topic+init.em.sample5'></span>

<h3>Description</h3>

<p>Initialization using sampling 5 times.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sample5'
init.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="init.em.sample5_+3A_object">object</code></td>
<td>
<p>A matrix.</p>
</td></tr>
<tr><td><code id="init.em.sample5_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The posterior probability matrix
</p>

<hr>
<h2 id='logLik.em'>This function computes logLik of EM Algorithm.</h2><span id='topic+logLik.em'></span>

<h3>Description</h3>

<p>This function computes logLik of EM Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'em'
logLik(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logLik.em_+3A_object">object</code></td>
<td>
<p>an object of 'em'.</p>
</td></tr>
<tr><td><code id="logLik.em_+3A_...">...</code></td>
<td>
<p>other used arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the log-likelihood value
</p>

<hr>
<h2 id='mstep'>M-Step of EM algorithm</h2><span id='topic+mstep'></span>

<h3>Description</h3>

<p>This function performs an M-Step of EM Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstep(models, post_pr = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstep_+3A_models">models</code></td>
<td>
<p>the models used in the EM algorithm</p>
</td></tr>
<tr><td><code id="mstep_+3A_post_pr">post_pr</code></td>
<td>
<p>the posterior probability.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the fitting result for the model.
</p>

<hr>
<h2 id='mstep.concomitant'>The mstep for the concomitant model.</h2><span id='topic+mstep.concomitant'></span>

<h3>Description</h3>

<p>This section was inspired by Flexmix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstep.concomitant(formula, data, postpr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstep.concomitant_+3A_formula">formula</code></td>
<td>
<p>the formula of the concomitant model.</p>
</td></tr>
<tr><td><code id="mstep.concomitant_+3A_data">data</code></td>
<td>
<p>the data or model.frame related to the concomitant model.</p>
</td></tr>
<tr><td><code id="mstep.concomitant_+3A_postpr">postpr</code></td>
<td>
<p>the posterior probability matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function returns a fitted nnet object.
</p>

<hr>
<h2 id='mstep.concomitant.refit'>The refit of for the concomitant model.
This section was inspired by Flexmix.</h2><span id='topic+mstep.concomitant.refit'></span>

<h3>Description</h3>

<p>The refit of for the concomitant model.
This section was inspired by Flexmix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mstep.concomitant.refit(formula, data, postpr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mstep.concomitant.refit_+3A_formula">formula</code></td>
<td>
<p>the formula of the concomitant model.</p>
</td></tr>
<tr><td><code id="mstep.concomitant.refit_+3A_data">data</code></td>
<td>
<p>the data or model.frame related to the concomitant model.</p>
</td></tr>
<tr><td><code id="mstep.concomitant.refit_+3A_postpr">postpr</code></td>
<td>
<p>the posterior probability matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the function returns a fitted multinom object.
</p>

<hr>
<h2 id='multi.em'>Multiple run of EM algorithm</h2><span id='topic+multi.em'></span>

<h3>Description</h3>

<p>Multiple run of EM algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>multi.em(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.em_+3A_object">object</code></td>
<td>
<p>the model to use in em, e.g. 'lm', 'glm', 'gnm'</p>
</td></tr>
<tr><td><code id="multi.em_+3A_...">...</code></td>
<td>
<p>arguments used in em.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return the 'em' object with the maximum log-likelihood.
</p>

<hr>
<h2 id='multi.em.default'>Default generic for multi.em</h2><span id='topic+multi.em.default'></span>

<h3>Description</h3>

<p>Default generic for multi.em
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## Default S3 method:
multi.em(
  object,
  iter = 10,
  parallel = FALSE,
  num.cores = 2,
  random.init = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="multi.em.default_+3A_object">object</code></td>
<td>
<p>the model to use in em, e.g. 'lm', 'glm', 'gnm'</p>
</td></tr>
<tr><td><code id="multi.em.default_+3A_iter">iter</code></td>
<td>
<p>number of iterations for running EM algorithm.</p>
</td></tr>
<tr><td><code id="multi.em.default_+3A_parallel">parallel</code></td>
<td>
<p>whether to use the parallel computing.</p>
</td></tr>
<tr><td><code id="multi.em.default_+3A_num.cores">num.cores</code></td>
<td>
<p>number of cores used in the parallel computing.</p>
</td></tr>
<tr><td><code id="multi.em.default_+3A_random.init">random.init</code></td>
<td>
<p>whether to use a random initialization.</p>
</td></tr>
<tr><td><code id="multi.em.default_+3A_...">...</code></td>
<td>
<p>arguments used in em.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>return the 'em' object with the maximum log-likelihood.
</p>

<hr>
<h2 id='plot.em'>Plot the fitted results of EM algorithm</h2><span id='topic+plot.em'></span>

<h3>Description</h3>

<p>This is the generic plot function for 'em' project. One can produce
three types of graphs using this function
1. A graph of the predicted value distribution for each component.
2. A histogram of posterior probability distributions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'em'
plot(
  x,
  by = c("component", "prob"),
  prior = FALSE,
  cols = rep(1, length(x$models)),
  lwds = rep(3, length(x$models)),
  ltys = c(seq_len(length(x$models))),
  ranges = NULL,
  main = NULL,
  lgd = list(),
  lgd.loc = "topleft",
  hist.args = list(main = "Histograms of posterior probabilities", xlab =
    "Posterior Probabilities"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.em_+3A_x">x</code></td>
<td>
<p>the 'em' model to plot</p>
</td></tr>
<tr><td><code id="plot.em_+3A_by">by</code></td>
<td>
<p>the type of the graph to produce. The default is 'component'.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_prior">prior</code></td>
<td>
<p>whether fit the model using prior probabilities.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_cols">cols</code></td>
<td>
<p>lines' colors.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_lwds">lwds</code></td>
<td>
<p>Lines' widths.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_ltys">ltys</code></td>
<td>
<p>lines' types.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_ranges">ranges</code></td>
<td>
<p>the ranges of the x-axis and the y-axis limits of plots.
It should be a vector of four numeric values. The first two represent the x-axis limits.
The last two represent the y-axis limits</p>
</td></tr>
<tr><td><code id="plot.em_+3A_main">main</code></td>
<td>
<p>the main title.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_lgd">lgd</code></td>
<td>
<p>a list for legend related arguments.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_lgd.loc">lgd.loc</code></td>
<td>
<p>the location of the legend. The default is &quot;topleft&quot;.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_hist.args">hist.args</code></td>
<td>
<p>The list of arguments for the histogram.</p>
</td></tr>
<tr><td><code id="plot.em_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>'NULL'
</p>

<hr>
<h2 id='predict.em'>Predict the fitted finite mixture models</h2><span id='topic+predict.em'></span>

<h3>Description</h3>

<p>Predict the fitted finite mixture models
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'em'
predict(object, prob = c("prior", "posterior"), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.em_+3A_object">object</code></td>
<td>
<p>Output from <code>em</code>, representing a fitted model using EM algorithm.</p>
</td></tr>
<tr><td><code id="predict.em_+3A_prob">prob</code></td>
<td>
<p>the probabilities used to compute the fitted value. It can be either
prior probability ('prior') or posterior probability ('posterior'). 
The default value is 'prior'.</p>
</td></tr>
<tr><td><code id="predict.em_+3A_...">...</code></td>
<td>
<p>other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'predict.em' is a list containing at least the following components:
<code>components</code> a list of fitted values by components with each element 
a matrix/vector of fitted values. 
<code>mean</code> a matrix of predicted values computed by weighted sum of fitted values by components.
The weights used in the computation can be either prior probabilities or posterior probabilities
depending on the parameter 'prob'.
<code>prob</code> the value used in the parameter 'prob'.
</p>

<hr>
<h2 id='print.em'>Print the 'em' object</h2><span id='topic+print.em'></span>

<h3>Description</h3>

<p>Print the 'em' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'em'
print(x, digits = max(3L, getOption("digits") - 3L), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.em_+3A_x">x</code></td>
<td>
<p>the 'em' object.</p>
</td></tr>
<tr><td><code id="print.em_+3A_digits">digits</code></td>
<td>
<p>the maximum digits printed, the default is '3L'.</p>
</td></tr>
<tr><td><code id="print.em_+3A_...">...</code></td>
<td>
<p>other arguments used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the 'em' object on the screen.
</p>

<hr>
<h2 id='print.summary.em'>Print the 'summary.em' object</h2><span id='topic+print.summary.em'></span>

<h3>Description</h3>

<p>Print the 'summary.em' object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.em'
print(
  x,
  digits = max(3L, getOption("digits") - 3L),
  signif.stars = getOption("show.signif.stars"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.summary.em_+3A_x">x</code></td>
<td>
<p>the 'summary.em' object.</p>
</td></tr>
<tr><td><code id="print.summary.em_+3A_digits">digits</code></td>
<td>
<p>the maximum digits printed, the default is '3L'.</p>
</td></tr>
<tr><td><code id="print.summary.em_+3A_signif.stars">signif.stars</code></td>
<td>
<p>logical; if 'TRUE', P-values are additionally encoded visually 
as 'significance stars' in order to help scanning of long coefficient tables. 
It defaults to the 'show.signif.stars' slot of options.</p>
</td></tr>
<tr><td><code id="print.summary.em_+3A_...">...</code></td>
<td>
<p>other augments used in 'printCoefmat'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>print the 'summary.em' object on the screen.
</p>

<hr>
<h2 id='simbinom'>Simulated Data from a logistic regression</h2><span id='topic+simbinom'></span>

<h3>Description</h3>

<p>A data set with simulated data from 
a mixture of a logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simbinom
</code></pre>


<h3>Format</h3>

<p>A data frame with 10000 rows and 2 variables:
</p>

<dl>
<dt>y</dt><dd><p>A dependent variable generated from a mixture of 
a logistic regression with x</p>
</dd>
<dt>x</dt><dd><p>An independent variable</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.github.com/wudongjie/em&gt;
</p>

<hr>
<h2 id='simclogit'>Simulated Data from a conditional logistic regression</h2><span id='topic+simclogit'></span>

<h3>Description</h3>

<p>A data set with simulated data from a mixture of a conditional 
logistic regression.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simclogit
</code></pre>


<h3>Format</h3>

<p>A data frame with 10000 rows and 4 variables:
</p>

<dl>
<dt>x2</dt><dd><p>A dummy variable showing whether x is equal to level 2</p>
</dd>
<dt>x3</dt><dd><p>A dummy variable showing whether x is equal to level 3</p>
</dd>
<dt>a2</dt><dd><p>Whether the alternative choice 2 is chosen</p>
</dd>
<dt>a2_x2</dt><dd><p>Interaction between a2 and x2</p>
</dd>
<dt>a2_x3</dt><dd><p>Interaction between a2 and x3</p>
</dd>
<dt>a3</dt><dd><p>Whether the alternative choice 3 is chosen</p>
</dd>
<dt>a3_x2</dt><dd><p>Interaction between a3 and x2</p>
</dd>
<dt>a3_x3</dt><dd><p>Interaction between a3 and x3</p>
</dd>
<dt>chosen1</dt><dd><p>Whether the observation-alternative combination is 
chosen (Generated by a one-class regression).</p>
</dd>
<dt>chosen2</dt><dd><p>Whether the observation-alternative combination is 
chosen (Generated by a two-class mixed regression).</p>
</dd>
<dt>fid</dt><dd><p>Family ID</p>
</dd>
<dt>id</dt><dd><p>Individual ID</p>
</dd>
<dt>z</dt><dd><p>Other variables</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.github.com/wudongjie/em&gt;
</p>

<hr>
<h2 id='simreg'>Simulated Regression Data</h2><span id='topic+simreg'></span>

<h3>Description</h3>

<p>A data set with simulated data from mixture regression models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simreg
</code></pre>


<h3>Format</h3>

<p>A data frame with 1000 rows and 5 variables:
</p>

<dl>
<dt>yp</dt><dd><p>A dependent variable generated from a mixture 
of a poisson regression with x</p>
</dd>
<dt>yn</dt><dd><p>A dependent variable generated from a mixture 
of a linear regression with x</p>
</dd>
<dt>yc</dt><dd><p>A dependent variable generated from a mixture 
of a linear regression with x and a concomitant variable of z</p>
</dd>
<dt>x</dt><dd><p>An independent variable</p>
</dd>
<dt>z</dt><dd><p>A concomitant variable</p>
</dd>
</dl>



<h3>Source</h3>

<p>&lt;https://www.github.com/wudongjie/em&gt;
</p>

<hr>
<h2 id='sstep'>S-step of EM algorithm</h2><span id='topic+sstep'></span>

<h3>Description</h3>

<p>Given the posterior probability, generate a matrix to assign
each individual to a class. The assignment is randomly sampled based on the posterior probability.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sstep(postpr)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sstep_+3A_postpr">postpr</code></td>
<td>
<p>('matrix()') <br />
The matrix of the posterior probability</p>
</td></tr>
</table>

<hr>
<h2 id='summary.em'>Summaries of fitted finite mixture models using EM algorithm</h2><span id='topic+summary.em'></span>

<h3>Description</h3>

<p>Summaries of fitted finite mixture models using EM algorithm
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'em'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.em_+3A_object">object</code></td>
<td>
<p>Output from <code>em</code>, representing a fitted model using EM algorithm.</p>
</td></tr>
<tr><td><code id="summary.em_+3A_...">...</code></td>
<td>
<p>other arguments used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class 'summary.em' is a list containing at least the following components:
<code>call</code> the matched call.
<code>coefficients</code>
<code>pi</code> the prior probabilities.
<code>latent</code> number of the latent classes.
<code>ll</code> log-likelihood value.
<code>sum.models</code> summaries of models generated by 'summary()' of models from each class.
<code>df</code> degree of freedom.
<code>obs</code> number of observations.
<code>AIC</code> the Akaike information criterion.
<code>BIC</code> the Bayesian information criterion.
<code>concomitant</code> a list of the concomitant model. It is empty if no concomitant model is used.
<code>concomitant.summary</code> summaries of the concomitant model generated by 'summary()'.
</p>

<hr>
<h2 id='vdummy'>Transform a factor variable to a matrix of dummy variables</h2><span id='topic+vdummy'></span>

<h3>Description</h3>

<p>Transform a factor variable to a matrix of dummy variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vdummy(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vdummy_+3A_x">x</code></td>
<td>
<p>a factor vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a matrix of dummy variables
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
