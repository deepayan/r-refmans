<!DOCTYPE html><html lang="en"><head><title>Help for package ncappc</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ncappc}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#calc.stat'><p>Calculates a set of statistics for a given array of numbers.</p></a></li>
<li><a href='#dv.plot'><p>Plots drug plasma concentration vs time data</p></a></li>
<li><a href='#est.nca'><p>Estimate individual NCA metrics.</p></a></li>
<li><a href='#histobs.plot'><p>Plots histogram of selected set of NCA metrics.</p></a></li>
<li><a href='#histpop.plot'><p>Plots population histogram of the NCA metrics selected for model diagnosis.</p></a></li>
<li><a href='#nca_ind_data'><p>Prepare individual PK data</p></a></li>
<li><a href='#nca.check.obs'><p>Check observed data</p></a></li>
<li><a href='#nca.check.sim'><p>Check simulated data</p></a></li>
<li><a href='#nca.deviation.plot'><p>Plot individual deviation of NCA metrics estimated from observed and simulated</p>
data</a></li>
<li><a href='#nca.ind.data'><p>Prepare individual PK data</p></a></li>
<li><a href='#nca.npde'><p>Calculates individual normalized prediction distribution errors (NPDE) from</p>
PDE data.</a></li>
<li><a href='#nca.npde.plot'><p>Plots population histogram of the NCA metrics selected for model diagnosis.</p></a></li>
<li><a href='#nca.pde.deviation.outlier'><p>Calculates individual prediction distribution errors (PDE) and scaled</p>
deviation of NCA metrics estimated from observed and simulated data.
Identifies outlier to population PK model.</a></li>
<li><a href='#nca.read.sim'><p>Check observed data</p></a></li>
<li><a href='#ncappc'><p>Performs NCA calculations and population PK model diagnosis.</p></a></li>
<li><a href='#out.digits'><p>output value with correct digits and trailing zero</p></a></li>
<li><a href='#read_nm_table'><p>Read NONMEM table files produced.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>NCA Calculations and Population Model Diagnosis</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Description:</td>
<td>A flexible tool that can perform
    (i) traditional non-compartmental analysis (NCA) and
    (ii) Simulation-based posterior predictive checks for population
    pharmacokinetic (PK) and/or pharmacodynamic (PKPD) models using NCA metrics. </td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.15.3),</td>
</tr>
<tr>
<td>Imports:</td>
<td>scales, gtable, knitr, xtable, reshape2, dplyr, Cairo, readr
(&ge; 0.2.2), lazyeval, PopED, magrittr, rlang, purrr, tibble,
rmarkdown, tidyr, ggplot2 (&ge; 2.0.0), grid, gridExtra (&ge;
2.0.0), grDevices, stats, bookdown</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.0</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2018-08-24 15:58:33 UTC; ancho179</td>
</tr>
<tr>
<td>Author:</td>
<td>Chayan Acharya [aut],
  Andrew C. Hooker [aut, cre],
  Gulbeyaz Y. Turkyilmaz [aut],
  Siv Jonsson [aut],
  Mats O. Karlsson [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andrew C. Hooker &lt;andrew.hooker@farmbio.uu.se&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2018-08-24 20:30:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='calc.stat'>Calculates a set of statistics for a given array of numbers.</h2><span id='topic+calc.stat'></span>

<h3>Description</h3>

<p><span class="pkg">calc.stat</span> calculates a set of statistics for a given array of numbers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>calc.stat(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="calc.stat_+3A_x">x</code></td>
<td>
<p>a numeric array</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">calc.stat</span> calculates a set of statistics for a given array of numbers.
The calculated statistics are
</p>

<ul>
<li><p> Ntot = length of the array
</p>
</li>
<li><p> Nunique = Number of unique elements
</p>
</li>
<li><p> Min = Minimum value of the array
</p>
</li>
<li><p> Max = Maximum value of the array
</p>
</li>
<li><p> Mean = Mean value of the array
</p>
</li>
<li><p> Median = Median value of the array
</p>
</li>
<li><p> SD = Standard deviation value of the array
</p>
</li>
<li><p> SE = Standard error value of the array
</p>
</li>
<li><p> CVp = Percent coefficient of variation of the array
</p>
</li>
<li><p> CI95u = Upper limit of the 95% confidence interval of the array
</p>
</li>
<li><p> cI95l = Lower limit of the 95% confidence interval of the array
</p>
</li>
<li><p> gMean = Geometric mean value of the array
</p>
</li>
<li><p> gCVp = Geometric percent coefficient of variation of the array
</p>
</li></ul>



<h3>Value</h3>

<p>An array of calculated statistics of a given set of numbers
</p>

<hr>
<h2 id='dv.plot'>Plots drug plasma concentration vs time data</h2><span id='topic+dv.plot'></span>

<h3>Description</h3>

<p><span class="pkg">dv.plot</span> plots DV vs Time data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dv.plot(df, xvar = "Time", yvar = "Conc", obsLog = FALSE,
  myXlab = "Time", myYlab = "Concentration", color = NULL,
  group = NULL, guide = TRUE, onlyLin = FALSE, onlyLog = FALSE,
  XYlog = FALSE, STRATY = ".", STRATX = ".", myYBr = waiver(),
  myXBr = waiver(), myYBrLog = waiver(), myXBrLog = waiver(),
  myYlim = NULL, myXlim = NULL, myYlimLog = NULL, myXlimLog = NULL,
  title = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="dv.plot_+3A_df">df</code></td>
<td>
<p>A data frame to be used for the plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_xvar">xvar</code></td>
<td>
<p>is the independent variable, default is <strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_yvar">yvar</code></td>
<td>
<p>is the dependent variable, default is <strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_obslog">obsLog</code></td>
<td>
<p>is a logical variable (<code>TRUE</code>, <code>FALSE</code>). If
<code>TRUE</code>, concentration in observed data is assumed to be in logarithmic
scale. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myxlab">myXlab</code></td>
<td>
<p>is the x-axis label, default is <strong>&quot;Time&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myylab">myYlab</code></td>
<td>
<p>is the y-axis label, defaults is <strong>&quot;Concentration&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_color">color</code></td>
<td>
<p>is the column name of the color stratification variable, e.g. 
&quot;DOSEF&quot;. Default is <strong>NULL</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_group">group</code></td>
<td>
<p>is the column name of the variable used to group data, default
is <strong>&quot;ID</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_guide">guide</code></td>
<td>
<p>if <strong>TRUE</strong>, show guide, default is <strong>TRUE</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_onlylin">onlyLin</code></td>
<td>
<p>if <strong>TRUE</strong>, presents only the linear version of the
plot, default is <strong>FALSE</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_onlylog">onlyLog</code></td>
<td>
<p>if <strong>TRUE</strong>, presents only the log version of the plot,
default is <strong>FALSE</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_xylog">XYlog</code></td>
<td>
<p>if <strong>TRUE</strong>, both X and Y axes of the log version of the
plot is shown on the logarithmic scale; if <strong>FALSE</strong>, only the Y-axis
is shown on the logarithmic scale. Default is <strong>FALSE</strong>.</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_straty">STRATY</code></td>
<td>
<p>is the row stratification variable, default is <strong>&quot;.&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_stratx">STRATX</code></td>
<td>
<p>is the column stratification variable, default is <strong>&quot;.&quot;</strong></p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myybr">myYBr</code></td>
<td>
<p>are the breaks for the Y-axis for the linear plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myxbr">myXBr</code></td>
<td>
<p>are the breaks for the X-axis for the linear plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myybrlog">myYBrLog</code></td>
<td>
<p>are the breaks for the Y-axis for the log plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myxbrlog">myXBrLog</code></td>
<td>
<p>are the breaks for the X-axis for the log plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myylim">myYlim</code></td>
<td>
<p>sets Y-axis limits for the linear plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myxlim">myXlim</code></td>
<td>
<p>sets X-axis limits for the linear plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myylimlog">myYlimLog</code></td>
<td>
<p>sets the Y-axis limit for the log plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_myxlimlog">myXlimLog</code></td>
<td>
<p>sets the X-axis limit for the log plot</p>
</td></tr>
<tr><td><code id="dv.plot_+3A_title">title</code></td>
<td>
<p>The title of the plot.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">dv.plot</span> plots DV vs Time data
</p>


<h3>Value</h3>

<p>returns a graphical object created by arrangeGrob function
</p>

<hr>
<h2 id='est.nca'>Estimate individual NCA metrics.</h2><span id='topic+est.nca'></span>

<h3>Description</h3>

<p>Estimates a comprehensive set of NCA metrics
for a given individual using concentration vs. time data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>est.nca(time, conc, backExtrp = FALSE, negConcExcl = FALSE,
  doseType = "ns", adminType = "extravascular", doseAmt = NULL,
  method = "linearup-logdown", AUCTimeRange = NULL,
  LambdaTimeRange = NULL, LambdaExclude = NULL, doseTime = doseTime,
  Tau = NULL, TI = NULL, simFile = NULL, dset = "obs",
  onlyNCA = FALSE, extrapolate = FALSE, sparse_compute = FALSE,
  force_extrapolate = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="est.nca_+3A_time">time</code></td>
<td>
<p>Numeric array for time</p>
</td></tr>
<tr><td><code id="est.nca_+3A_conc">conc</code></td>
<td>
<p>Numeric array for concentration</p>
</td></tr>
<tr><td><code id="est.nca_+3A_backextrp">backExtrp</code></td>
<td>
<p>If back-extrapolation is needed for AUC (TRUE or FALSE) 
(<strong>FALSE</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_negconcexcl">negConcExcl</code></td>
<td>
<p>Exclude -ve conc (<strong>FALSE</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_dosetype">doseType</code></td>
<td>
<p>Steady-state (ss) or non-steady-state (ns) dose
(<strong>&quot;ns&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration
(iv-bolus,iv-infusion,extravascular) (<strong>&quot;extravascular&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_doseamt">doseAmt</code></td>
<td>
<p>Dose amounts (<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_method">method</code></td>
<td>
<p>Method to estimate AUC. The <code>"linear"</code> method applies the linear
trapezoidal rule to estimate the area under the curve. The <code>"log"</code> method
applies the logarithmic trapezoidal rule to estimate the area under the
curve. The <code>"linearup-logdown"</code> method applies the linear trapezoidal rule to
estimate the area under the curve for the ascending part of the curve and
the logarithmic trapezoidal rule to estimate the area under the curve for
the descending part of the curve.</p>
</td></tr>
<tr><td><code id="est.nca_+3A_auctimerange">AUCTimeRange</code></td>
<td>
<p>User-defined window of time used to estimate AUC 
(<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_lambdatimerange">LambdaTimeRange</code></td>
<td>
<p>User-defined window of time to estimate elimination 
rate-constant (<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_lambdaexclude">LambdaExclude</code></td>
<td>
<p>User-defined excluded observation time points for
estimation of elimination rate-constant (<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_dosetime">doseTime</code></td>
<td>
<p>Dose time prior to the first observation for steady-state
data (<strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_tau">Tau</code></td>
<td>
<p>Dosing interval for steady-state data (<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_ti">TI</code></td>
<td>
<p>Infusion duration (<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_simfile">simFile</code></td>
<td>
<p>Name of the simulated concentration-time data if present
(<strong>&quot;NULL&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_dset">dset</code></td>
<td>
<p>Type, i.e., observed or simulated concentration-time data set
(&quot;obs&quot; or &quot;sim&quot;) (<strong>&quot;obs&quot;</strong>)</p>
</td></tr>
<tr><td><code id="est.nca_+3A_onlynca">onlyNCA</code></td>
<td>
<p>If <code>TRUE</code> only NCA is performed and ppc part is ignored
although simFile is not <code>NULL</code>. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="est.nca_+3A_extrapolate">extrapolate</code></td>
<td>
<p>Should the function extrapolate from the last observation to infinity?</p>
</td></tr>
<tr><td><code id="est.nca_+3A_sparse_compute">sparse_compute</code></td>
<td>
<p>Should NCA metrics be computed even with only one sample?</p>
</td></tr>
<tr><td><code id="est.nca_+3A_force_extrapolate">force_extrapolate</code></td>
<td>
<p>Extrapolate AUC_inf with sparse data.  Sparse data is defined as 
fewer than 3 points after Cmax for non-bolus input.  In that case, Cmax is included in the extrapolation 
and only one extra point in required for extrapolation.</p>
</td></tr>
<tr><td><code id="est.nca_+3A_...">...</code></td>
<td>
<p>Arguments passed from other functions.  Not used.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">est.nca</span> estimates a comprehensive set of NCA metrics using the
concentration-time profile of an individual. NCA metrics are estimated
according to traditional PK calculations. The names of the various NCA
metrics estimated in this package are assigned mainly following the names
used in WinNonlin. This package accepts any of the three different types of
drug administration, (i) iv-bolus, (ii) iv-infusion and (iii) extravascular;
<span class="pkg">ncappc</span> also can accept both non-steady state and steady-state data. 
The NCA metrics that are estimated and reported by <span class="pkg">ncappc</span> are listed 
below.
</p>

<ul>
<li> <p><strong>C0</strong> is the initial concentration at the dosing time. It is 
the observed concentration at the dosing time, if available. Otherwise 
it is approximated using the following rules.
</p>
</li>
<li> <p><strong>Cmax, Tmax and Cmax_D</strong> are the value and the time of maximum
observed concentration, respectively. If the maximum concentration is not
unique, the first maximum is used. For steady state data, The maximum value
between the dosing intervals is considered. Cmax_D is the dose normalized
maximum observed concentration.
</p>
</li>
<li> <p><strong>Clast and Tlast</strong> are the last measurable positive
concentration and the corresponding time, respectively. 
</p>
</li>
<li> <p><strong>AUClast</strong> is the area under the concentration vs. time curve
from the first observed to last measurable concentration.
</p>
</li>
<li> <p><strong>AUMClast</strong> is the first moment of the concentration vs. time
curve from the first observed to last measurable concentration.
</p>
</li>
<li> <p><strong>MRTlast</strong> is the mean residence time from the first observed 
to last measurable concentration.
</p>
</li>
<li> <p><strong>No_points_Lambda_z</strong> is the number of observed data points 
used to determine the best fitting regression line in the elimination 
phase.
</p>
</li>
<li> <p><strong>AUC_pBack_Ext_obs</strong> is the percentage of AUCINF_obs that is 
contributed by the back extrapolation to estimate C0.
</p>
</li>
<li> <p><strong>AUC_pBack_Ext_pred</strong> is the percentage of AUCINF_pred that is 
contributed by the back extrapolation to estimate C0.
</p>
</li>
<li> <p><strong>AUClower_upper</strong> is the AUC under the concentration-time 
profile within the user-specified window of time provided as the 
&quot;AUCTimeRange&quot; argument. In case of empty &quot;AUCTimeRange&quot; argument, 
AUClower_upper is the same as AUClast.
</p>
</li>
<li> <p><strong>Rsq, Rsq_adjusted and Corr_XY</strong> are regression coefficient 
of the regression line used to estimate the elimination rate constant, the 
adjusted value of Rsq and the square root of Rsq, respectively.
</p>
</li>
<li> <p><strong>Lambda_z</strong> is the elimination rate constant estimated from the 
regression line representing the terminal phase of the concentration-time 
data.
</p>
</li>
<li> <p><strong>Lambda_lower and Lambda_upper</strong> are the lower and upper limit 
of the time values from the concentration-time profile used to estimate 
Lambda_z, respectively, in case the &quot;LambdaTimeRange&quot; is used to specify 
the time range.
</p>
</li>
<li> <p><strong>HL_Lambda_z</strong> is terminal half-life of the drug.
</p>
</li>
<li> <p><strong>AUCINF_obs and AUCINF_obs_D</strong> are AUC estimated from the first 
sampled data extrapolated to infinity and its dose normalized version, 
respectively. The extrapolation in the terminal phase is based on the last 
observed concentration Clast_obs.
</p>
</li>
<li> <p><strong>AUC_pExtrap_obs</strong> is the percentage of the AUCINF_obs that is 
contributed by the extrapolation from the last sampling time to infinity.
</p>
</li>
<li> <p><strong>AUMCINF_obs</strong> is AUMC estimated from the first sampled data 
extrapolated to infinity. The extrapolation in the terminal phase is based 
on the last observed concentration.
</p>
</li>
<li> <p><strong>AUMC_pExtrap_obs</strong> is the percentage of the AUMCINF_obs that 
is contributed by the extrapolation from the last sampling time to infinity.
</p>
</li>
<li> <p><strong>Vz_obs</strong> is the volume of distribution estimated based on 
total AUC
</p>
</li>
<li> <p><strong>Cl_obs</strong> is total body clearance.
</p>
</li>
<li> <p><strong>AUCINF_pred and AUCINF_pred_D</strong> are AUC from the first sampled 
data extrapolated to infinity and its dose normalized version, respectively.
The extrapolation in the terminal phase is based on the last predicted 
concentration obtained from the regression line used to estimate Lambda_z 
(Clast_pred).
</p>
</li>
<li> <p><strong>AUC_pExtrap_pred</strong> is the percentage of the AUCINF_pred that 
is contributed by the extrapolation from the last sampling time to infinity.
</p>
</li>
<li> <p><strong>AUMCINF_pred</strong> is AUMC estimated from the first sampled data 
extrapolated to infinity. The extrapolation in the terminal phase is based 
on the last predicted concentration obtained from the regression line used 
to estimate Lambda_z (Clast_pred).
</p>
</li>
<li> <p><strong>AUMC_pExtrap_pred</strong> is the percentage of the AUMCINF_pred that 
is contributed by the extrapolation from the last sampling time to infinity.
</p>
</li>
<li> <p><strong>Vz_pred</strong> is the volume of distribution estimated based on 
AUCINF_pred.
</p>
</li>
<li> <p><strong>Cl_pred</strong> is the total body clearance estimated based on 
AUCINF_pred.
</p>
</li>
<li> <p><strong>MRTINF_obs</strong> is the mean residence time from the first 
sampled time extrapolated to infinity based on the last observed 
concentration (Clast_obs).
</p>
</li>
<li> <p><strong>MRTINF_pred</strong> is the mean residence time from the first 
sampled time extrapolated to infinity based on the last predicted 
concentration obtained from the regression line used to estimate Lambda_z 
(Clast_pred).
</p>
</li>
<li> <p><strong>Tau</strong> is the dosing interval for steady-state data. 
</p>
</li>
<li> <p><strong>Cmin and Tmin</strong> are the minimum concentration between 0 and 
Tau and the corresponding time, respectively.
</p>
</li>
<li> <p><strong>Cavg</strong> is the average concentration between 0 and Tau for 
steady-state data.
</p>
</li>
<li> <p><strong>AUCtau and AUMCtau</strong> are AUC and AUMC between 0 and Tau for 
steady-state data.
</p>
</li>
<li> <p><strong>Clss</strong> is an estimate of the total body clearance for
steady-state data.
</p>
</li>
<li> <p><strong>Vss_obs and Vss_pred</strong> are estimated volume of distribution at 
steady-state based on Clast_obs and Clast_pred, respectively.
</p>
</li>
<li> <p><strong>p_Fluctuation</strong> is the percentage of the fluctuation of the 
concentration between 0 and Tau for steady-state data.
</p>
</li>
<li> <p><strong>Accumulation_Index</strong> is <code class="reqn">1/(1-e^(-\lambda_z*\tau))</code>
</p>
</li></ul>



<h3>Value</h3>

<p>An array of estimated NCA metrics
</p>

<hr>
<h2 id='histobs.plot'>Plots histogram of selected set of NCA metrics.</h2><span id='topic+histobs.plot'></span>

<h3>Description</h3>

<p><span class="pkg">histobs.plot</span> plots histogram of selected set of NCA metrics (e.g.
AUClast, AUCINF_obs, Cmax and Tmax).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histobs.plot(plotData, figlbl = NULL, param = c("AUClast",
  "AUCINF_obs", "Cmax", "Tmax"), cunit = NULL, tunit = NULL,
  spread = "npi")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="histobs.plot_+3A_plotdata">plotData</code></td>
<td>
<p>A data frame with the estimated NCA metrics</p>
</td></tr>
<tr><td><code id="histobs.plot_+3A_figlbl">figlbl</code></td>
<td>
<p>Figure label based on dose identifier and/or population 
stratifier (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="histobs.plot_+3A_param">param</code></td>
<td>
<p>A character array of the NCA metrics. The allowed NCA metrics 
for this histograms are &quot;AUClast&quot;, &quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;, 
&quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. 
(<strong>c(&quot;AUClast&quot;, &quot;AUCINF_obs&quot;, &quot;Cmax&quot;, &quot;Tmax&quot;)</strong>)</p>
</td></tr>
<tr><td><code id="histobs.plot_+3A_cunit">cunit</code></td>
<td>
<p>Unit for concentration (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="histobs.plot_+3A_tunit">tunit</code></td>
<td>
<p>Unit for time (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="histobs.plot_+3A_spread">spread</code></td>
<td>
<p>Measure of the spread of simulated data (ppi (95% parametric 
prediction interval) or npi (95% nonparametric prediction interval)) 
(<strong>&quot;npi&quot;</strong>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">histobs.plot</span> plots histogram of selected set of NCA metrics. The 
allowed NCA metrics for this histograms are &quot;AUClast&quot;, &quot;AUClower_upper&quot;, 
&quot;AUCINF_obs&quot;, &quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. By
default, this function produces histogram of AUClast, AUCINF_obs, Cmax and 
Tmax.
</p>


<h3>Value</h3>

<p>returns a graphical object created by arrangeGrob function
</p>

<hr>
<h2 id='histpop.plot'>Plots population histogram of the NCA metrics selected for model diagnosis.</h2><span id='topic+histpop.plot'></span>

<h3>Description</h3>

<p><span class="pkg">histpop.plot</span> plots population histogram of the NCA metrics selected 
for model diagnosis (e.g. AUClast, AUCINF_obs, Cmax and Tmax).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>histpop.plot(obsdata = outData, simdata = smedianData, figlbl = NULL,
  param = c("AUClast", "Cmax"), cunit = NULL, tunit = NULL,
  spread = "npi")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="histpop.plot_+3A_obsdata">obsdata</code></td>
<td>
<p>Data frame with the values of the NCA metrics estimated from
the observed data</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_simdata">simdata</code></td>
<td>
<p>Data frame with the values of the NCA metrics estimated from
the simulated data</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_figlbl">figlbl</code></td>
<td>
<p>Figure label based on dose identifier and/or population
stratifier (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_param">param</code></td>
<td>
<p>A character array of the NCA metrics. The allowed NCA metrics 
for this histograms are &quot;AUClast&quot;, &quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;, 
&quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. 
(<strong>c(&quot;AUClast&quot;, &quot;Cmax&quot;)</strong>)</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_cunit">cunit</code></td>
<td>
<p>Unit for concentration (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_tunit">tunit</code></td>
<td>
<p>Unit for time (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="histpop.plot_+3A_spread">spread</code></td>
<td>
<p>Measure of the spread of simulated data (ppi (95% parametric
prediction interval) or npi (95% nonparametric prediction interval))
(<strong>&quot;npi&quot;</strong>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">histpop.plot</span> plots histogram of the NCA metrics selected for the model 
diagnosis and compares with the corresponding metrics estimated from the 
observed data. The allowed NCA metrics for this histograms are &quot;AUClast&quot;, 
&quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;, &quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot; and
&quot;HL_Lambda_z&quot;. By default, this function produces histogram of AUClast and 
Cmax.
</p>


<h3>Value</h3>

<p>returns a graphical object created by arrangeGrob function
</p>

<hr>
<h2 id='nca_ind_data'>Prepare individual PK data</h2><span id='topic+nca_ind_data'></span>

<h3>Description</h3>

<p>Extracts time-conc data for a given individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca_ind_data(pkData, dvLog = FALSE, dataType = "obs", idNm = "ID",
  timeNm = "TIME", concNm = "DV", adminType = "extravascular",
  TI = NULL, dateColNm = NULL, dateFormat = NULL,
  timeFormat = "number")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca_ind_data_+3A_pkdata">pkData</code></td>
<td>
<p>PK concentration-time data.</p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_dvlog">dvLog</code></td>
<td>
<p>If <code>TRUE</code> concentration is in logarithmic scale. Default is
<strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_datatype">dataType</code></td>
<td>
<p>Indicates if the data is observed (&quot;obs&quot;) or simulated 
(&quot;sim&quot;). Since the simulated data is assumed to be obtained from NONMEM 
output, DATE and clock time (<code>dateColNm</code>, <code>dateFormat</code>, 
<code>timeFormat</code>) are not used for time data. Default is <strong>&quot;obs&quot;</strong>.</p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_idnm">idNm</code></td>
<td>
<p>Column name for ID in PK data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_timenm">timeNm</code></td>
<td>
<p>Column name for time in PK data. Default is 
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_concnm">concNm</code></td>
<td>
<p>Column name for concentration in PK data. Default is 
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration. Allowed options are iv-bolus,
iv-infusion or extravascular. Default is <strong>&quot;extravascular&quot;</strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_ti">TI</code></td>
<td>
<p>Infusion duration. If TI is a single numeric value, TI is the same
for all individuals. If TI is the name of a column with numeric data
present in the data set, TI is set to the unique value of the column for a
given individual. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_datecolnm">dateColNm</code></td>
<td>
<p>column name for date if used (e.g. &quot;Date&quot;, &quot;DATE&quot;). Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_dateformat">dateFormat</code></td>
<td>
<p>date format (D-M-Y, D/M/Y or any other combination of
D,M,Y). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca_ind_data_+3A_timeformat">timeFormat</code></td>
<td>
<p>time format (number, H:M, H:M:S). Default is
<strong>&quot;number&quot;</strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Extracts time-conc data for a given individual.
</p>


<h3>Value</h3>

<p>A list of objects with time-conc data and individual infusion
duration for iv-infusion data
</p>

<hr>
<h2 id='nca.check.obs'>Check observed data</h2><span id='topic+nca.check.obs'></span>

<h3>Description</h3>

<p><span class="pkg">nca.check.obs</span> Checks observed data for compatibility with ncappc and
processes the data with various filtering criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.check.obs(obsData, idNmObs = "ID", timeNmObs = "TIME",
  concNmObs = "DV", doseType = "ns", doseTime = NULL, Tau = NULL,
  filterNm = NULL, filterExcl = NULL, str1Nm = NULL, str1 = NULL,
  str2Nm = NULL, str2 = NULL, str3Nm = NULL, str3 = NULL,
  AUCTimeRange = NULL, LambdaTimeRange = NULL,
  adminType = "extravascular", TI = NULL, doseAmtNm = NULL,
  dateColNm = NULL, dateFormat = NULL, timeFormat = "number",
  concUnit = NULL, timeUnit = NULL, doseUnit = NULL, blqNm = NULL,
  blqExcl = 1, evid = TRUE, evidIncl = 0, mdv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.check.obs_+3A_obsdata">obsData</code></td>
<td>
<p>Observed concentration-time data.</p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_idnmobs">idNmObs</code></td>
<td>
<p>Column name for ID in observed data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_timenmobs">timeNmObs</code></td>
<td>
<p>Column name for time in observed data. Default is 
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_concnmobs">concNmObs</code></td>
<td>
<p>Column name for concentration in observed data. Default is 
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_dosetype">doseType</code></td>
<td>
<p>Steady-state (ss) or non-steady-state (ns) dose. Default is 
<strong>&quot;ns&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_dosetime">doseTime</code></td>
<td>
<p>Dose time prior to the first observation for steady-state
data. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_tau">Tau</code></td>
<td>
<p>Dosing interval for steady-state data. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_filternm">filterNm</code></td>
<td>
<p>Column name to filter data. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_filterexcl">filterExcl</code></td>
<td>
<p>Row exclusion criteria based on the column defined by
<code>filterNm</code>. This can be numeric value or logical condition (e.g. c(1,
2, &quot;&lt;20&quot;, &quot;&gt;=100&quot;, &quot;!=100&quot;)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str1nm">str1Nm</code></td>
<td>
<p>Column name for 1st level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str1">str1</code></td>
<td>
<p>Stratification ID of the members within 1st level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str2nm">str2Nm</code></td>
<td>
<p>Column name for 2nd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str2">str2</code></td>
<td>
<p>Stratification ID of the members within 2nd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str3nm">str3Nm</code></td>
<td>
<p>Column name for 3rd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_str3">str3</code></td>
<td>
<p>Stratification ID of the members within 3rd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_auctimerange">AUCTimeRange</code></td>
<td>
<p>User-defined window of time used to estimate AUC. Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_lambdatimerange">LambdaTimeRange</code></td>
<td>
<p>User-defined window of time to estimate elimination
rate-constant. This argument lets the user to choose a specific window of
time to be used to estimate the elimination rate constant (Lambda) in the
elimination phase. The accepted format for the input to this argument is a
numeric array of two elements; <code>c(14,24)</code> will estimate the Lambda
using the data within the time units 14 to 24. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration. Allowed options are iv-bolus,
iv-infusion or extravascular. Default is <strong>&quot;extravascular&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_ti">TI</code></td>
<td>
<p>Infusion duration. If TI is a single numeric value, TI is the same
for all individuals. If TI is the name of a column with numeric data
present in the data set, TI is set to the unique value of the column for a
given individual. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_doseamtnm">doseAmtNm</code></td>
<td>
<p>Column name to specify dose amount. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_datecolnm">dateColNm</code></td>
<td>
<p>column name for date if used (e.g. &quot;Date&quot;, &quot;DATE&quot;). Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_dateformat">dateFormat</code></td>
<td>
<p>date format (D-M-Y, D/M/Y or any other combination of
D,M,Y). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_timeformat">timeFormat</code></td>
<td>
<p>time format (number, H:M, H:M:S). Default is
<strong>&quot;number&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_concunit">concUnit</code></td>
<td>
<p>Unit of concentration (e.g. &quot;ng/mL&quot;). Default is 
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_timeunit">timeUnit</code></td>
<td>
<p>Unit of time (e.g. &quot;h&quot;). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_doseunit">doseUnit</code></td>
<td>
<p>Unit of dose amount (e.g. &quot;ng&quot;). Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_blqnm">blqNm</code></td>
<td>
<p>Name of BLQ column if used to exclude data. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_blqexcl">blqExcl</code></td>
<td>
<p>Excluded BLQ value; either a numeric value or a logical
condition (e.g. 1 or &quot;&gt;=1&quot; or c(1,&quot;&gt;3&quot;)). Used only if the <code>blqNm</code> is
not <code>NULL</code>. Default is <strong>&quot;1&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_evid">evid</code></td>
<td>
<p>If <code>TRUE</code> EVID is used to filter data. Default is
<strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_evidincl">evidIncl</code></td>
<td>
<p>Included values in EVID. Default is <strong>&quot;0&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.obs_+3A_mdv">mdv</code></td>
<td>
<p>If <code>TRUE</code> MDV is used to include data when MDV=0. Default is
<strong><code>FALSE</code></strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.check.obs</span> Checks observed data for compatibility with ncappc.
</p>


<h3>Value</h3>

<p>A list of objects
</p>

<hr>
<h2 id='nca.check.sim'>Check simulated data</h2><span id='topic+nca.check.sim'></span>

<h3>Description</h3>

<p><span class="pkg">nca.check.sim</span> Checks simulated data for compatibility with ncappc and 
processes the data with various filtering criteria.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.check.sim(simData, idNmSim = "ID", timeNmSim = "TIME",
  concNmSim = "DV", filterNm = NULL, filterExcl = NULL,
  str1Nm = NULL, str1 = NULL, str2Nm = NULL, str2 = NULL,
  str3Nm = NULL, str3 = NULL, adminType = "extravascular",
  TI = NULL, doseAmtNm = NULL, blqNm = NULL, blqExcl = 1,
  evid = TRUE, evidIncl = 0, mdv = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.check.sim_+3A_simdata">simData</code></td>
<td>
<p>Simulated concentration-time data.</p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_idnmsim">idNmSim</code></td>
<td>
<p>Column name for ID in simulated data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_timenmsim">timeNmSim</code></td>
<td>
<p>Column name for time in simulated data. Default is 
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_concnmsim">concNmSim</code></td>
<td>
<p>Column name for concentration in simulated data. Default is 
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_filternm">filterNm</code></td>
<td>
<p>Column name to filter data. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_filterexcl">filterExcl</code></td>
<td>
<p>Row exclusion criteria based on the column defined by
<code>filterNm</code>. This can be numeric value or logical condition (e.g. c(1,
2, &quot;&lt;20&quot;, &quot;&gt;=100&quot;, &quot;!=100&quot;)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str1nm">str1Nm</code></td>
<td>
<p>Column name for 1st level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str1">str1</code></td>
<td>
<p>Stratification ID of the members within 1st level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str2nm">str2Nm</code></td>
<td>
<p>Column name for 2nd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str2">str2</code></td>
<td>
<p>Stratification ID of the members within 2nd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str3nm">str3Nm</code></td>
<td>
<p>Column name for 3rd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_str3">str3</code></td>
<td>
<p>Stratification ID of the members within 3rd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration. Allowed options are iv-bolus,
iv-infusion or extravascular. Default is <strong>&quot;extravascular&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_ti">TI</code></td>
<td>
<p>Infusion duration. If TI is a single numeric value, TI is the same
for all individuals. If TI is the name of a column with numeric data
present in the data set, TI is set to the unique value of the column for a
given individual. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_doseamtnm">doseAmtNm</code></td>
<td>
<p>Column name to specify dose amount. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_blqnm">blqNm</code></td>
<td>
<p>Name of BLQ column if used to exclude data. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_blqexcl">blqExcl</code></td>
<td>
<p>Excluded BLQ value; either a numeric value or a logical
condition (e.g. 1 or &quot;&gt;=1&quot; or c(1,&quot;&gt;3&quot;)). Used only if the <code>blqNm</code> is
not <code>NULL</code>. Default is <strong>&quot;1&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_evid">evid</code></td>
<td>
<p>If <code>TRUE</code> EVID is used to filter data. Default is
<strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_evidincl">evidIncl</code></td>
<td>
<p>Included values in EVID. Default is <strong>&quot;0&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.check.sim_+3A_mdv">mdv</code></td>
<td>
<p>If <code>TRUE</code> MDV is used to include data when MDV=0. Default is
<strong><code>FALSE</code></strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.check.sim</span> Checks simulated data for compatibility with ncappc.
</p>


<h3>Value</h3>

<p>A list of objects
</p>

<hr>
<h2 id='nca.deviation.plot'>Plot individual deviation of NCA metrics estimated from observed and simulated
data</h2><span id='topic+nca.deviation.plot'></span>

<h3>Description</h3>

<p><span class="pkg">nca.deviation.plot</span> plots individual deviation of selected NCA metrics
estimated from observed and simulated data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.deviation.plot(plotdata, xvar = NULL, devcol = NULL,
  figlbl = NULL, spread = "npi", cunit = NULL, tunit = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.deviation.plot_+3A_plotdata">plotdata</code></td>
<td>
<p>A data frame containing the scaled deviation values of the
NCA metrics</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_xvar">xvar</code></td>
<td>
<p>x-variable against which the deviation data will be plotted
(<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_devcol">devcol</code></td>
<td>
<p>column names/numbers of the data frame containing deviation
data (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_figlbl">figlbl</code></td>
<td>
<p>Figure label based on dose identifier and/or population
stratifier (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_spread">spread</code></td>
<td>
<p>Measure of the spread of simulated data (ppi (95% parametric
prediction interval) or npi (95% nonparametric prediction interval))
(<strong>&quot;npi&quot;</strong>)</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_cunit">cunit</code></td>
<td>
<p>Unit for concentration (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="nca.deviation.plot_+3A_tunit">tunit</code></td>
<td>
<p>Unit for time (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.deviation.plot</span> plots individual deviation of selected NCA metrics 
estimated from observed and simulated data. This function requires three 
mandatory arguments, (i) deviation data, (ii) independent variable and (iii) 
dependent variables. The deviation of the NCA metrics values estimated from
the observed and simulated data are scaled by the &quot;spread&quot; of the simulated
metrics values. The &quot;speed&quot; of the simulated data is measured either by the
standard deviation or the 95
</p>


<h3>Value</h3>

<p>returns the data frame with the NPDE values based on the input data.
</p>

<hr>
<h2 id='nca.ind.data'>Prepare individual PK data</h2><span id='topic+nca.ind.data'></span>

<h3>Description</h3>

<p><span class="pkg">nca.ind.data</span> Extracts time-conc data for a given individual.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.ind.data(pkData, ID, dvLog = FALSE, dataType = "obs",
  idNm = "ID", timeNm = "TIME", concNm = "DV",
  adminType = "extravascular", TI = NULL, dateColNm = NULL,
  dateFormat = NULL, timeFormat = "number")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.ind.data_+3A_pkdata">pkData</code></td>
<td>
<p>PK concentration-time data.</p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_id">ID</code></td>
<td>
<p>ID number of the individual.</p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_dvlog">dvLog</code></td>
<td>
<p>If <code>TRUE</code> concentration is in logarithmic scale. Default is
<strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_datatype">dataType</code></td>
<td>
<p>Indicates if the data is observed (&quot;obs&quot;) or simulated 
(&quot;sim&quot;). Since the simulated data is assumed to be obtained from NONMEM 
output, DATE and clock time (<code>dateColNm</code>, <code>dateFormat</code>, 
<code>timeFormat</code>) are not used for time data. Default is <strong>&quot;obs&quot;</strong>.</p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_idnm">idNm</code></td>
<td>
<p>Column name for ID in PK data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_timenm">timeNm</code></td>
<td>
<p>Column name for time in PK data. Default is 
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_concnm">concNm</code></td>
<td>
<p>Column name for concentration in PK data. Default is 
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration. Allowed options are iv-bolus,
iv-infusion or extravascular. Default is <strong>&quot;extravascular&quot;</strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_ti">TI</code></td>
<td>
<p>Infusion duration. If TI is a single numeric value, TI is the same
for all individuals. If TI is the name of a column with numeric data
present in the data set, TI is set to the unique value of the column for a
given individual. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_datecolnm">dateColNm</code></td>
<td>
<p>column name for date if used (e.g. &quot;Date&quot;, &quot;DATE&quot;). Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_dateformat">dateFormat</code></td>
<td>
<p>date format (D-M-Y, D/M/Y or any other combination of
D,M,Y). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="nca.ind.data_+3A_timeformat">timeFormat</code></td>
<td>
<p>time format (number, H:M, H:M:S). Default is
<strong>&quot;number&quot;</strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.ind.data</span> Extracts time-conc data for a given individual.
</p>


<h3>Value</h3>

<p>A list of objects with time-conc data and individual infusion
duration for iv-infusion data
</p>

<hr>
<h2 id='nca.npde'>Calculates individual normalized prediction distribution errors (NPDE) from
PDE data.</h2><span id='topic+nca.npde'></span>

<h3>Description</h3>

<p><span class="pkg">nca.npde</span> calculates individual normalized prediction distribution 
errors (NPDE)  of selected NCA metrics from the PDE data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.npde(pdedata, pdecol)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.npde_+3A_pdedata">pdedata</code></td>
<td>
<p>A data frame containing the prediction distribution errors
(PDE) of NCA metrics</p>
</td></tr>
<tr><td><code id="nca.npde_+3A_pdecol">pdecol</code></td>
<td>
<p>The range of column numbers in the data frame containing the
PDE values, which will be used to calculate the corresponding NPDE</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.npde</span> calculates individual normalized prediction distribution 
errors (NPDE) of selected NCA metrics from PDE data. The The deviation of
each estimated NCA metrics is scaled by the &quot;spread&quot; of the simulated values.
By default, this function calculates the NPDE values of all columns of the
input data frame.
</p>


<h3>Value</h3>

<p>returns the data frame with the NPDE values based on the input data.
</p>

<hr>
<h2 id='nca.npde.plot'>Plots population histogram of the NCA metrics selected for model diagnosis.</h2><span id='topic+nca.npde.plot'></span>

<h3>Description</h3>

<p><span class="pkg">nca.npde.plot</span> plots individual NPDE values and histogram of the NPDE
values within a population group
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.npde.plot(plotdata, xvar = NULL, npdecol = NULL, figlbl = NULL,
  cunit = NULL, tunit = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.npde.plot_+3A_plotdata">plotdata</code></td>
<td>
<p>Data frame with the values of the NPDE values of each
individual for the NCA metrics</p>
</td></tr>
<tr><td><code id="nca.npde.plot_+3A_xvar">xvar</code></td>
<td>
<p>Name of the independent variable column against which NPDE values
will be plotted</p>
</td></tr>
<tr><td><code id="nca.npde.plot_+3A_npdecol">npdecol</code></td>
<td>
<p>Column names or column numbers of containing the NPDE values</p>
</td></tr>
<tr><td><code id="nca.npde.plot_+3A_figlbl">figlbl</code></td>
<td>
<p>Figure label based on dose identifier and/or population
stratifier (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="nca.npde.plot_+3A_cunit">cunit</code></td>
<td>
<p>Unit for concentration (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="nca.npde.plot_+3A_tunit">tunit</code></td>
<td>
<p>Unit for time (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.npde.plot</span> individual NPDE values and histogram of the NPDE
values of NCA metrics within a population group.
</p>


<h3>Value</h3>

<p>returns a data frame with the mean and SD of population NPDE values
of each NCA metric and two graphical objects created by arrangeGrob
function for the individual and population histogram of the NPDE values
</p>

<hr>
<h2 id='nca.pde.deviation.outlier'>Calculates individual prediction distribution errors (PDE) and scaled
deviation of NCA metrics estimated from observed and simulated data.
Identifies outlier to population PK model.</h2><span id='topic+nca.pde.deviation.outlier'></span>

<h3>Description</h3>

<p><span class="pkg">nca.pde.deviation.outlier</span> calculates individual prediction distribution
errors (PDE) and scaled deviation of NCA metrics estimated from observed and
simulated data. Identifies outlier to population PK model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.pde.deviation.outlier(obsdata, simdata, idNm = "ID", id = NULL,
  spread = "npi", figlbl = NULL, calcparam = c("AUClast", "Cmax"),
  diagparam = c("AUClast", "Cmax"), cunit = NULL, tunit = NULL,
  noPlot = FALSE, onlyNCA = onlyNCA)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.pde.deviation.outlier_+3A_obsdata">obsdata</code></td>
<td>
<p>A data frame containing the NCA metrics values estimated from
the observed data</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_simdata">simdata</code></td>
<td>
<p>A data frame containing the NCA metrics values estimated from
the simulated data</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_idnm">idNm</code></td>
<td>
<p>Column name for ID (<strong>&quot;ID&quot;</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_id">id</code></td>
<td>
<p>ID of the individual whose data is being evaluated</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_spread">spread</code></td>
<td>
<p>Measure of the spread of simulated data (ppi (95% parametric
prediction interval) or npi (95% nonparametric prediction interval))
(<strong>&quot;npi&quot;</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_figlbl">figlbl</code></td>
<td>
<p>Figure label based on dose identifier and/or population
stratifier, in addition to ID (<strong>NULL</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_calcparam">calcparam</code></td>
<td>
<p>A character array of the NCA metrics used for calculations 
of PDE and deviation. The allowed NCA metrics for this histograms are 
&quot;AUClast&quot;, &quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;, &quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, 
&quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. (<strong>c(&quot;AUClast&quot;, &quot;Cmax&quot;)</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_diagparam">diagparam</code></td>
<td>
<p>A character array of the NCA metrics used for diagnostic 
test to detect outliers. The allowed NCA metrics for this histograms are
&quot;AUClast&quot;, &quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;, &quot;AUCINF_pred&quot;, &quot;AUMClast&quot;,
&quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. (<strong>c(&quot;AUClast&quot;, &quot;Cmax&quot;)</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_cunit">cunit</code></td>
<td>
<p>Unit for concentration (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_tunit">tunit</code></td>
<td>
<p>Unit for time (default is <strong><code>NULL</code></strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_noplot">noPlot</code></td>
<td>
<p>Perform only NCA calculations without any plot generation
(TRUE, FALSE) (<strong>FALSE</strong>)</p>
</td></tr>
<tr><td><code id="nca.pde.deviation.outlier_+3A_onlynca">onlyNCA</code></td>
<td>
<p>If <code>TRUE</code> only NCA is performed and ppc part is ignored
although simFile is not <code>NULL</code>. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.pde.deviation.outlier</span> calculates individual prediction distribution
errors (PDE) and scaled deviation of NCA metrics estimated from observed and 
simulated data. The deviation of each estimated NCA metrics is scaled by the 
&quot;spread&quot; of the simulated values. The &quot;spread&quot; is measured either by the 95%
parametric prediction interval or 95% non-parametric prediction interval.
Any individual yielding an absolute value of the scaled deviation for any of
the selected NCA metrics greater than 1, is assigned as an outlier to the
corresponding population PK model. The allowed NCA metrics for this
diagnostic tests are &quot;AUClast&quot;, &quot;AUClower_upper&quot;, &quot;AUCINF_obs&quot;,
&quot;AUCINF_pred&quot;, &quot;AUMClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot; and &quot;HL_Lambda_z&quot;. By default, this
function uses AUClast and Cmax metrics for the comparison.
</p>


<h3>Value</h3>

<p>returns the observed data frame with added distance and simulation
mean of the nCA metrics, and a data frame with the PDE values of the NCA
metrics. If the individual is identified as an outlier for the PK model,
histograms of the diagnostic NCA metrics are produced and a graphical
object created by arrangeGrob function is returned.
</p>

<hr>
<h2 id='nca.read.sim'>Check observed data</h2><span id='topic+nca.read.sim'></span>

<h3>Description</h3>

<p><span class="pkg">nca.read.sim</span> Reads NONMEM simulation output file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nca.read.sim(simFile = "nca_simulation.1.npctab.dta", MDV.rm = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="nca.read.sim_+3A_simfile">simFile</code></td>
<td>
<p>NONMEM simulation output with the simulated
concentration-time data from an internal data frame or an external table.
Default is <strong>&quot;nca_simulation.1.npctab.dta&quot;</strong>.</p>
</td></tr>
<tr><td><code id="nca.read.sim_+3A_mdv.rm">MDV.rm</code></td>
<td>
<p>If <code>TRUE</code> MDV column is used to remove non-observation
rows. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
</table>


<h3>Details</h3>

<p><span class="pkg">nca.read.sim</span> Reads NONMEM simulation output file.
</p>


<h3>Value</h3>

<p>A list of objects
</p>

<hr>
<h2 id='ncappc'>Performs NCA calculations and population PK model diagnosis.</h2><span id='topic+ncappc'></span>

<h3>Description</h3>

<p><span class="pkg">ncappc</span> is a flexible tool, to
</p>

<ol>
<li><p> perform a traditional NCA
</p>
</li>
<li><p> perform simulation-based posterior predictive checks for a
population PK model using NCA metrics.
</p>
</li></ol>



<h3>Usage</h3>

<pre><code class='language-R'>ncappc(obsFile = "nca_original.npctab.dta",
  simFile = "nca_simulation.1.npctab.dta.zip", str1Nm = NULL,
  str1 = NULL, str2Nm = NULL, str2 = NULL, str3Nm = NULL,
  str3 = NULL, concUnit = NULL, timeUnit = NULL, doseUnit = NULL,
  obsLog = FALSE, simLog = obsLog, psnOut = TRUE, idNmObs = "ID",
  timeNmObs = "TIME", concNmObs = "DV", idNmSim = idNmObs,
  timeNmSim = timeNmObs, concNmSim = concNmObs, onlyNCA = FALSE,
  AUCTimeRange = NULL, backExtrp = FALSE, LambdaTimeRange = NULL,
  LambdaExclude = NULL, doseAmtNm = NULL,
  adminType = "extravascular", doseType = "ns", doseTime = NULL,
  Tau = NULL, TI = NULL, method = "linearup-logdown", blqNm = NULL,
  blqExcl = 1, evid = TRUE, evidIncl = 0, mdv = FALSE,
  filterNm = NULL, filterExcl = NULL, negConcExcl = FALSE,
  param = c("AUClast", "Cmax"), timeFormat = "number",
  dateColNm = NULL, dateFormat = NULL, spread = "npi",
  tabCol = c("AUClast", "Cmax", "Tmax", "AUCINF_obs", "Vz_obs", "Cl_obs",
  "HL_Lambda_z"), figFormat = "tiff", noPlot = FALSE,
  printOut = TRUE, studyName = NULL, new_data_method = TRUE,
  overwrite_SIMDATA = NULL, overwrite_sim_est_file = NULL,
  outFileNm = NULL, out_format = "html", gg_theme = theme_bw(),
  parallel = FALSE, extrapolate = FALSE, timing = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ncappc_+3A_obsfile">obsFile</code></td>
<td>
<p>Observed concentration-time data from an internal data frame
or an external table with comma, tab or space as separators.</p>
</td></tr>
<tr><td><code id="ncappc_+3A_simfile">simFile</code></td>
<td>
<p>NONMEM simulation output with the simulated concentration-time
data from an internal data frame or an external table. <code>NULL</code> produces
just the NCA output, a filename or data frame produces the NCA output as
well as the PopPK diagnosis. If <code>new_data_method=TRUE</code> then this can
be a compressed file as well.</p>
</td></tr>
<tr><td><code id="ncappc_+3A_str1nm">str1Nm</code></td>
<td>
<p>Column name for 1st level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_str1">str1</code></td>
<td>
<p>Stratification ID of the members within 1st level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_str2nm">str2Nm</code></td>
<td>
<p>Column name for 2nd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_str2">str2</code></td>
<td>
<p>Stratification ID of the members within 2nd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_str3nm">str3Nm</code></td>
<td>
<p>Column name for 3rd level population stratifier. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_str3">str3</code></td>
<td>
<p>Stratification ID of the members within 3rd level stratification
(e.g c(1,2)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_concunit">concUnit</code></td>
<td>
<p>Unit of concentration (e.g. &quot;ng/mL&quot;). Default is 
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_timeunit">timeUnit</code></td>
<td>
<p>Unit of time (e.g. &quot;h&quot;). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_doseunit">doseUnit</code></td>
<td>
<p>Unit of dose amount (e.g. &quot;ng&quot;). Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_obslog">obsLog</code></td>
<td>
<p>If <code>TRUE</code> concentration in observed data is in logarithmic
scale. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_simlog">simLog</code></td>
<td>
<p>If <code>TRUE</code> concentration in simulated data is in 
logarithmic scale. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_psnout">psnOut</code></td>
<td>
<p>If <code>TRUE</code> observed data is an output from PsN or in NONMEM
output format. Default is <strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_idnmobs">idNmObs</code></td>
<td>
<p>Column name for ID in observed data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_timenmobs">timeNmObs</code></td>
<td>
<p>Column name for time in observed data. Default is
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_concnmobs">concNmObs</code></td>
<td>
<p>Column name for concentration in observed data. Default is
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_idnmsim">idNmSim</code></td>
<td>
<p>Column name for ID in simulated data. Default is <strong>&quot;ID&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_timenmsim">timeNmSim</code></td>
<td>
<p>Column name for time in simulated data. Default is
<strong>&quot;TIME&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_concnmsim">concNmSim</code></td>
<td>
<p>Column name for concentration in simulated data. Default is
<strong>&quot;DV&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_onlynca">onlyNCA</code></td>
<td>
<p>If <code>TRUE</code> only NCA is performed and ppc part is ignored
although simFile is not <code>NULL</code>. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_auctimerange">AUCTimeRange</code></td>
<td>
<p>User-defined window of time used to estimate AUC. Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_backextrp">backExtrp</code></td>
<td>
<p>If <code>TRUE</code> back-extrapolation is performed while
estimating AUC. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_lambdatimerange">LambdaTimeRange</code></td>
<td>
<p>User-defined window of time to estimate elimination
rate-constant. This argument lets the user to choose a specific window of
time to be used to estimate the elimination rate constant (Lambda) in the
elimination phase. The accepted format for the input to this argument is a
numeric array of two elements; <code>c(14,24)</code> will estimate the Lambda
using the data within the time units 14 to 24. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_lambdaexclude">LambdaExclude</code></td>
<td>
<p>User-defined excluded observation time points for
estimation of Lambda. This can be numeric value or logical condition (e.g.
c(1, 2, &quot;&lt;20&quot;, &quot;&gt;=100&quot;, &quot;!=100&quot;)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_doseamtnm">doseAmtNm</code></td>
<td>
<p>Column name to specify dose amount. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_admintype">adminType</code></td>
<td>
<p>Route of administration. Allowed options are iv-bolus,
iv-infusion or extravascular. Default is <strong>&quot;extravascular&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_dosetype">doseType</code></td>
<td>
<p>Steady-state (ss) or non-steady-state (ns) dose. Default is
<strong>&quot;ns&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_dosetime">doseTime</code></td>
<td>
<p>Dose time prior to the first observation for steady-state
data. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_tau">Tau</code></td>
<td>
<p>Dosing interval for steady-state data. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_ti">TI</code></td>
<td>
<p>Infusion duration. If TI is a single numeric value, TI is the same
for all individuals. If TI is the name of a column with numeric data
present in the data set, TI is set to the unique value of the column for a
given individual. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_method">method</code></td>
<td>
<p>Method to estimate AUC. <code>linear</code> method applies the linear
trapezoidal rule to estimate the area under the curve. <code>log</code> method 
applies the logarithmic trapezoidal rule to estimate the area under the 
curve. <code>linearup-logdown</code> method applies the linear trapezoidal rule
to estimate the area under the curve for the ascending part of the curve
and the logarithmic trapezoidal rule to estimate the area under the curve
for the descending part of the curve. Default is
<strong>&quot;linearup-logdown&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_blqnm">blqNm</code></td>
<td>
<p>Name of BLQ column if used to exclude data. Default is
<strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_blqexcl">blqExcl</code></td>
<td>
<p>Excluded BLQ value; either a numeric value or a logical
condition (e.g. 1 or &quot;&gt;=1&quot; or c(1,&quot;&gt;3&quot;)). Used only if the <code>blqNm</code> is
not <code>NULL</code>. Default is <strong>&quot;1&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_evid">evid</code></td>
<td>
<p>If <code>TRUE</code> EVID is used to filter data. Default is
<strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_evidincl">evidIncl</code></td>
<td>
<p>Included values in EVID. Default is <strong>&quot;0&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_mdv">mdv</code></td>
<td>
<p>If <code>TRUE</code> MDV is used to include data when MDV=0. Default is
<strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_filternm">filterNm</code></td>
<td>
<p>Column name to filter data. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_filterexcl">filterExcl</code></td>
<td>
<p>Row exclusion criteria based on the column defined by
<code>filterNm</code>. This can be numeric value or logical condition (e.g. c(1,
2, &quot;&lt;20&quot;, &quot;&gt;=100&quot;, &quot;!=100&quot;)). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_negconcexcl">negConcExcl</code></td>
<td>
<p>If <code>TRUE</code> negative concentrations are excluded.
Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_param">param</code></td>
<td>
<p>NCA parameters (AUClast, AUClower_upper, AUCINF_obs,
AUCINF_pred, AUMClast, Cmax, Tmax, HL_Lambda_z). Default is
<strong>(c&quot;AUClast&quot;, &quot;Cmax&quot;)</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_timeformat">timeFormat</code></td>
<td>
<p>time format (number, H:M, H:M:S). Default is
<strong>&quot;number&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_datecolnm">dateColNm</code></td>
<td>
<p>column name for date if used (e.g. &quot;Date&quot;, &quot;DATE&quot;). Default
is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_dateformat">dateFormat</code></td>
<td>
<p>date format (D-M-Y, D/M/Y or any other combination of
D,M,Y). Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_spread">spread</code></td>
<td>
<p>Measure of the spread of simulated data (<code>"ppi"</code> (95%
parametric prediction interval) or <code>"npi"</code> (95% nonparametric
prediction interval)). Default is <strong>&quot;npi&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_tabcol">tabCol</code></td>
<td>
<p>Output columns to be printed in the report in addition to ID,
dose and population strata information (list of NCA metrics in a string
array). Default is <strong>c(&quot;AUClast&quot;, &quot;Cmax&quot;, &quot;Tmax&quot;, &quot;AUCINF_obs&quot;,
&quot;Vz_obs&quot;, &quot;Cl_obs&quot;, &quot;HL_Lambda_z&quot;)</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_figformat">figFormat</code></td>
<td>
<p>format of the produced figures (bmp, jpeg, tiff, png).
Default is <strong>&quot;tiff&quot;</strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_noplot">noPlot</code></td>
<td>
<p>If <code>TRUE</code> only NCA calculations are performed without any
plot generation. Default is <strong><code>FALSE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_printout">printOut</code></td>
<td>
<p>If <code>TRUE</code> tabular and graphical outputs are saved on the
disk. Default is <strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_studyname">studyName</code></td>
<td>
<p>Name of the study to be added as a description in the
report. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_new_data_method">new_data_method</code></td>
<td>
<p>If <code>TRUE</code> a faster method of reading data is
tested. Default is <strong><code>TRUE</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_overwrite_simdata">overwrite_SIMDATA</code></td>
<td>
<p>If <code>TRUE</code> new information is created in the
SIMDATA directory. If <code>FALSE</code> the information in the SIMDATA directory
is used. If <code>NULL</code> a dialog will come up to ask the user what to do.
Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_overwrite_sim_est_file">overwrite_sim_est_file</code></td>
<td>
<p>If <code>TRUE</code> The NCA metrics are created again based
on the simulation data.  If <code>FALSE</code> the information in the ncaSimEst file
is used. If <code>NULL</code> a dialog will come up to ask the user what to do.
Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_outfilenm">outFileNm</code></td>
<td>
<p>Additional tag to the name of the output html and pdf output
file hyphenated to the standard ncappc report file name standard ncappc
report file name. Default is <strong><code>NULL</code></strong></p>
</td></tr>
<tr><td><code id="ncappc_+3A_out_format">out_format</code></td>
<td>
<p>What type of output format should the NCA report have? 
Pass &quot;all&quot; to render all formats defined within the rmarkdown file.
Pass &quot;first&quot; to render the first format defined within the rmarkdown file.
Pass &quot;html&quot; to render in HTML.
Pass &quot;pdf&quot; to render in PDF.</p>
</td></tr>
<tr><td><code id="ncappc_+3A_gg_theme">gg_theme</code></td>
<td>
<p>Which ggplot theme should be used for the plots?</p>
</td></tr>
<tr><td><code id="ncappc_+3A_parallel">parallel</code></td>
<td>
<p>Should the nca computations for the simulated data be run in parallel? See
<code><a href="PopED.html#topic+start_parallel">start_parallel</a></code> for a description and additional arguments that can be 
added to this function and passed to <code><a href="PopED.html#topic+start_parallel">start_parallel</a></code>.</p>
</td></tr>
<tr><td><code id="ncappc_+3A_extrapolate">extrapolate</code></td>
<td>
<p>Should the NCA calculations extrapolate from the last observation to infinity?</p>
</td></tr>
<tr><td><code id="ncappc_+3A_timing">timing</code></td>
<td>
<p>Should timings of calculations be reported to the screen?</p>
</td></tr>
<tr><td><code id="ncappc_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to other functions, including <code><a href="PopED.html#topic+start_parallel">start_parallel</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Non-compartmental analysis (NCA) calculates pharmacokinetic (PK) metrics 
related to the systemic exposure to a drug following administration, e.g. 
area under the concentration-time curve and peak concentration. <span class="pkg">ncappc</span> 
performs a traditional NCA using the observed plasma concentration-time data.
In the presence of simulated plasma concentration-time data, <span class="pkg">ncappc</span> 
also performs simulation-based posterior predictive checks (ppc) using NCA 
metrics for the corresponding population PK (PopPK) model used to generate 
the simulated data. The diagnostic analysis is performed at the population as
well as the individual level. The distribution of the simulated population 
means of each NCA metric is compared with the corresponding observed 
population mean. The individual level comparison is performed based on the 
deviation of the mean of any NCA metric based on simulations for an 
individual from the corresponding NCA metric obtained from the observed data.
Additionally, <span class="pkg">ncappc</span> reports the normalized prediction distribution 
error (NPDE) of the simulated NCA metrics for each individual and their 
distribution within a population. <span class="pkg">ncappc</span> produces two default outputs 
depending on the type of analysis performed, i.e., traditional NCA and PopPK 
diagnosis. The PopPK diagnosis feature of <span class="pkg">ncappc</span> produces 7 sets of 
graphical outputs to assess the ability of a population model to simulate the
concentration-time profile of a drug and thereby identify model 
misspecification. In addition, tabular outputs are generated showing the 
values of the NCA metrics estimated from the observed and the simulated data,
along with the deviation, NPDE, regression parameters used to estimate the 
elimination rate constant and the related population statistics. The default 
values of the arguments used in <span class="pkg">ncappc</span> are shown in the <strong>Usage</strong>
section of this document and/or in <strong>bold</strong> in the <strong>Arguments</strong> 
section.
</p>


<h3>Value</h3>

<p>NCA results and diagnostic test results
</p>


<h3>Examples</h3>

<pre><code class='language-R'>out &lt;- ncappc(obsFile=system.file("extdata","pkdata.csv",package="ncappc"), 
  onlyNCA = TRUE,
  extrapolate = TRUE,
  printOut = FALSE,
  evid = FALSE,
  psnOut=FALSE)
  

data_1 &lt;- data.frame(
  ID=1,
  TIME = c(0,0.25,0.5,1,1.5,2,3,4,6,8,12,16,24),
  DV=c(0, 0.07, 0.14, 0.21, 0.24, 0.27, 0.26, 0.25, 0.22, 0.19, 0.13, 0.081, 0.033)
)
out_1 &lt;- ncappc(obsFile=data_1,
                onlyNCA = TRUE,
                extrapolate = TRUE,
                printOut = FALSE,
                evid = FALSE,
                timing=TRUE)


data_2 &lt;- dplyr::filter(data_1,TIME&gt;17|TIME&lt;3)
out_2 &lt;- ncappc(obsFile=data_2,
                onlyNCA = TRUE,
                extrapolate = TRUE,
                printOut = FALSE,
                evid = FALSE,
                force_extrapolate=TRUE)

</code></pre>

<hr>
<h2 id='out.digits'>output value with correct digits and trailing zero</h2><span id='topic+out.digits'></span>

<h3>Description</h3>

<p>Function to present a value with correct digits and trailing zero
</p>


<h3>Usage</h3>

<pre><code class='language-R'>out.digits(x, dig = 3)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="out.digits_+3A_x">x</code></td>
<td>
<p>is the value</p>
</td></tr>
<tr><td><code id="out.digits_+3A_dig">dig</code></td>
<td>
<p>is the number of significant digits</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a function to present a value with correct digits and trailing zero. Numbers &gt;= 10000, or &lt;= 0.0001 will be presented in scientific format
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
out.digits(1234)

## End(Not run)

</code></pre>

<hr>
<h2 id='read_nm_table'>Read NONMEM table files produced.</h2><span id='topic+read_nm_table'></span>

<h3>Description</h3>

<p>The function reads in NONMEM table files.  The files can be created from the 
<code>$EST</code> line or from the <code>$SIM</code> line in a NONMEM model file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_nm_table(nm_table, only_obs = FALSE, method = "default",
  quiet = TRUE, sim_num = FALSE, sim_name = "NSIM")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_nm_table_+3A_nm_table">nm_table</code></td>
<td>
<p>The NONMEM table file to read. A text string. If <code>dplyr</code>
and <code>readr</code> are available and <code>method="default"</code> or
<code>method="readr_*"</code> then <code>nm_table</code> can either a path to a file, a
connection, or literal data (either a single string or a raw vector). Files
ending in .gz, .bz2, .xz, or .zip will be automatically uncompressed. Files
starting with http://, https://, ftp://, or ftps:// will be automatically
downloaded. Remote gz files can also be automatically downloaded &amp;
decompressed.</p>
</td></tr>
<tr><td><code id="read_nm_table_+3A_only_obs">only_obs</code></td>
<td>
<p>Should the non-observation lines in the data set be removed? 
Currently filtered using the expected <code>MDV</code> column. <code>TRUE</code> or 
<code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="read_nm_table_+3A_method">method</code></td>
<td>
<p>Can be one of <code>default</code>, <code>readr_1</code>,  <code>readr_2</code>, 
<code>readr_3</code>, <code>slow</code>. <code>readr_1</code> should be fastest.  All but 
<code>slow</code> require <code><a href="dplyr.html#topic+dplyr">dplyr</a></code> and 
<code>readr</code> (version &gt;= 0.2.2).</p>
</td></tr>
<tr><td><code id="read_nm_table_+3A_quiet">quiet</code></td>
<td>
<p>Should there be verbose messages about what the function is 
doing?</p>
</td></tr>
<tr><td><code id="read_nm_table_+3A_sim_num">sim_num</code></td>
<td>
<p>Should the function add a column to the returned data frame 
that identifies the simulation number (if present)?</p>
</td></tr>
<tr><td><code id="read_nm_table_+3A_sim_name">sim_name</code></td>
<td>
<p>The name of the resulting column in the returned data frame if <code>sim_num</code> is true.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Currently the function searches the <code>$TABLE</code> for multiple header lines, 
and uses that to identify multiple simulations. The function expects at least
one header line  (<code>NOHEADER</code> option is not allowed in NONMEM table 
files).
</p>


<h3>Value</h3>

<p>Returns a data frame of the simulated table with an added column for 
the simulation number. The data frame is given class <code>c("tbl_df", 
  "tbl", "data.frame")</code> for easy use with <code><a href="dplyr.html#topic+dplyr">dplyr</a></code>.
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
