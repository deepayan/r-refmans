<!DOCTYPE html><html><head><title>Help for package micss</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {micss}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#alpha_hill'><p>alpha_hill</p></a></li>
<li><a href='#alpha_nr'><p>alpha_nr</p></a></li>
<li><a href='#cv.kappa'><p>Critical Values</p></a></li>
<li><a href='#data'><p>Data used in the examples</p></a></li>
<li><a href='#estimate.alpha'><p>estimate.alpha</p></a></li>
<li><a href='#icss'><p>Iterative Cumulative Sum of Squares Algorithm</p></a></li>
<li><a href='#kappa_test'><p>CUMSUMQ test to test for changes in the unconditional variance</p></a></li>
<li><a href='#logReturnsRandDollar'><p>Data used in the examples</p></a></li>
<li><a href='#lrv.spc.bartlett'><p>lrv.spc.bartlett</p></a></li>
<li><a href='#micss'><p>Modiffied Iterative Cumulative Sum of Squares Algorithm</p></a></li>
<li><a href='#p.val.kappa'><p>P-values</p></a></li>
<li><a href='#plot.icss'><p>plot.icss</p></a></li>
<li><a href='#print.icss'><p>print.icss</p></a></li>
<li><a href='#print.micss'><p>print.micss</p></a></li>
<li><a href='#sr_loc'><p>sr_loc</p></a></li>
<li><a href='#sr_scale'><p>sr_scale</p></a></li>
<li><a href='#sr_shape'><p>sr_shape</p></a></li>
<li><a href='#step2a'><p>step2a</p></a></li>
<li><a href='#step2b'><p>step2b</p></a></li>
<li><a href='#step2c'><p>step2c</p></a></li>
<li><a href='#step3'><p>step3</p></a></li>
<li><a href='#steps1.to.2b'><p>steps1.to.2b</p></a></li>
<li><a href='#taula.icss'><p>taula.icss</p></a></li>
<li><a href='#taula.micss'><p>taula.micss</p></a></li>
<li><a href='#var.est.icss'><p>var.est.icss</p></a></li>
<li><a href='#whitening'><p>whitening</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Modified Iterative Cumulative Sum of Squares Algorithm</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Andreu Sansó &lt;andreu.sanso@uib.eu&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Companion package of Carrion-i-Silvestre &amp; Sansó (2023): 
  "Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant 
  Unconditional Variance in Heavy-Tailed Time Series". It implements the Modified 
  Iterative Cumulative Sum of Squares Algorithm, which is an extension of 
  the Iterative Cumulative Sum of Squares (ICSS) Algorithm of Inclan and Tiao (1994), and it checks for changes in the 
  unconditional variance of a time series controlling for the tail index of 
  the underlying distribution. The fourth order moment is estimated non-parametrically
  to avoid the size problems when the innovations are non-Gaussian (see, Sansó et al., 2004). 
  Critical values and p-values are generated using a Generalized Extreme Value distribution approach.
  References
  Carrion-i-Silvestre J.J &amp; Sansó A (2023) <a href="https://www.ub.edu/irea/working_papers/2023/202309.pdf">https://www.ub.edu/irea/working_papers/2023/202309.pdf</a>.
  Inclan C &amp; Tiao G.C (1994) &lt;<a href="https://doi.org/10.1080%2F01621459.1994.10476824">doi:10.1080/01621459.1994.10476824</a>&gt;,
  Sansó A &amp; Aragó V &amp; Carrion-i-Silvestre J.L (2004) <a href="https://dspace.uib.es/xmlui/bitstream/handle/11201/152078/524035.pdf">https://dspace.uib.es/xmlui/bitstream/handle/11201/152078/524035.pdf</a>.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), dplyr</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-16 08:02:57 UTC; HP</td>
</tr>
<tr>
<td>Author:</td>
<td>Josep Lluís Carrion-i-Silvestre [aut],
  Andreu Sansó [aut, cre]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-16 09:52:37 UTC</td>
</tr>
</table>
<hr>
<h2 id='alpha_hill'>alpha_hill</h2><span id='topic+alpha_hill'></span>

<h3>Description</h3>

<p>Computes the estimator of the tail index proposed by Hill (1975).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha_hill(x, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha_hill_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="alpha_hill_+3A_k">k</code></td>
<td>
<p>Fraction of the upper tail to be used to estimate of the tail index.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>alpha</code>: Estimated tail index.
</p>
</li>
<li> <p><code>sd.alpha</code>: Standard error.
</p>
</li>
<li> <p><code>s</code>: Number of observations used in the estimation.
</p>
</li></ul>



<h3>References</h3>

<p>B. Hill (1975): A Simple General Approach to Inference About the Tail of a Distribution. The Annals of Mathematical Statistics 3, 1163-1174.
</p>


<h3>See Also</h3>

<p><a href="#topic+alpha_nr">alpha_nr</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha_hill(rnorm(500),k=0.1)
</code></pre>

<hr>
<h2 id='alpha_nr'>alpha_nr</h2><span id='topic+alpha_nr'></span>

<h3>Description</h3>

<p>Computes the estimator of the tail index proposed by Nicolau &amp; Rodrigues (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>alpha_nr(y, k)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="alpha_nr_+3A_y">y</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="alpha_nr_+3A_k">k</code></td>
<td>
<p>Fraction of the upper tail to be used to estimate of the tail index.</p>
</td></tr>
</table>


<h3>Value</h3>


<ul>
<li> <p><code>alpha</code>: Estimated tail index.
</p>
</li>
<li> <p><code>sd.alpha</code>: Standard error.
</p>
</li></ul>



<h3>References</h3>

<p>J. Nicolau and P.M.M. Rodrigues (2019): A new regression-based tail index estimator. The Review of Economics and Statistics 101, 667-680.
</p>


<h3>See Also</h3>

<p><a href="#topic+alpha_hill">alpha_hill</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>alpha_nr(rnorm(500),k=0.1)
</code></pre>

<hr>
<h2 id='cv.kappa'>Critical Values</h2><span id='topic+cv.kappa'></span>

<h3>Description</h3>

<p>Computes critical values for the <a href="#topic+kappa_test">kappa_test</a> statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.kappa(t, alpha, sig.lev)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cv.kappa_+3A_t">t</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="cv.kappa_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4.</p>
</td></tr>
<tr><td><code id="cv.kappa_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Critical value.
</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>


<h3>See Also</h3>

<p><a href="#topic+p.val.kappa">p.val.kappa</a>
</p>

<hr>
<h2 id='data'>Data used in the examples</h2><span id='topic+data'></span>

<h3>Description</h3>

<p>Log returns of the exchange rate South African Rand versus United States Dollar.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(logReturnsRandDollar)</code></pre>


<h3>Value</h3>

<p>Time series with 7705 observations.</p>


<h3>Author(s)</h3>

<p>J.L. Carrion-i-Silvestre and A. Sansó</p>


<h3>Source</h3>

<p>Paulo Rodrigues</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(logReturnsRandDollar)
names(data)
</code></pre>

<hr>
<h2 id='estimate.alpha'>estimate.alpha</h2><span id='topic+estimate.alpha'></span>

<h3>Description</h3>

<p>Computes the estimator of the tail index (alpha) using Hill (1975) or Nicolau &amp; Rodrigues (2019) estimators and
tests both the hypothesis that alpha is bigger or equal to 4, and that alpha is lower or equal to 2.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>estimate.alpha(x, sig.lev = 0.05, tail.est = "Hill", k = 0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="estimate.alpha_+3A_x">x</code></td>
<td>
<p>A numeric vector.</p>
</td></tr>
<tr><td><code id="estimate.alpha_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="estimate.alpha_+3A_tail.est">tail.est</code></td>
<td>
<p>Estimator of the tail index. The default value is &quot;Hill&quot;, which uses Hill's (1975) estimator. &quot;NR&quot; uses Nicolau &amp; Rodrigues (2019) estimator.</p>
</td></tr>
<tr><td><code id="estimate.alpha_+3A_k">k</code></td>
<td>
<p>Fraction of the upper tail to be used to estimate of the tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+micss">micss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>alpha</code>: Value of the tail index (alpha) to be used in <a href="#topic+micss">micss</a>.
</p>
</li>
<li> <p><code>alpha.fit</code>: Estimated tail index.
</p>
</li>
<li> <p><code>t4</code>: Test of the null hypothesis alpha&gt;=4 against alpha&lt;4.
</p>
</li>
<li> <p><code>t2</code>: Test of the null hypothesis alpha&lt;=2 against alpha&gt;2.
</p>
</li></ul>



<h3>References</h3>

<p>B. Hill (1975): A Simple General Approach to Inference About the Tail of a Distribution. The Annals of Mathematical Statistics 3, 1163-1174.
</p>
<p>J. Nicolau and P.M.M. Rodrigues (2019): A new regression-based tail index estimator. The Review of Economics and Statistics 101, 667-680.
</p>

<hr>
<h2 id='icss'>Iterative Cumulative Sum of Squares Algorithm</h2><span id='topic+icss'></span>

<h3>Description</h3>

<p>Implements the ICSS algorithm of Inclan and Tiao (1994) using the CUMSUMQ test detailed in Carrion-i-Silvestre &amp; Sansó (2023)</p>


<h3>Usage</h3>

<pre><code class='language-R'>icss(e,sig.lev=0.05,kmax=NULL,alpha=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="icss_+3A_e">e</code></td>
<td>
<p>A numeric vector. Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="icss_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level. The default value is 0.05</p>
</td></tr>
<tr><td><code id="icss_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the estimation of the long-run fourth order moment. If not reported, an automatic procedure computes it depending on the sample size.</p>
</td></tr>
<tr><td><code id="icss_+3A_alpha">alpha</code></td>
<td>
<p>Tail index. If not reported, it is set at 4, which was the implicit assumption of Inclan &amp; Tiao (1994). Values between 2 and 4 are allowed because this function is used by <a href="#topic+micss">micss</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+micss">micss</a>.
</p>


<h3>Value</h3>

<table>
<tr><td><code>nb</code></td>
<td>
<p>Number of breaks found by the algorithm.</p>
</td></tr>
<tr><td><code>tb</code></td>
<td>
<p>Vector with the time breaks.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.L. Carrion-i-Silvestre and A. Sanso</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>
<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.</p>


<h3>See Also</h3>

<p><code><a href="#topic+micss">micss</a></code>
<code><a href="#topic+print.icss">print.icss</a></code>
<code><a href="#topic+plot.icss">plot.icss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
e &lt;- c(stats::rnorm(200),3*stats::rnorm(200))
o &lt;- icss(e)
print.icss(o)
</code></pre>

<hr>
<h2 id='kappa_test'>CUMSUMQ test to test for changes in the unconditional variance</h2><span id='topic+kappa_test'></span>

<h3>Description</h3>

<p>Computes the CUMSUMQ test to test for changes in the unconditional variance and reports the p-value adapted to the tail index and sample size</p>


<h3>Usage</h3>

<pre><code class='language-R'>kappa_test(e,sig.lev=0.05,alpha=NULL,kmax=NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="kappa_test_+3A_e">e</code></td>
<td>
<p>A numeric vector. Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="kappa_test_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level. The default value is 0.05</p>
</td></tr>
<tr><td><code id="kappa_test_+3A_alpha">alpha</code></td>
<td>
<p>Tail index. Must be a number between 2 and 4. The default value is 4.</p>
</td></tr>
<tr><td><code id="kappa_test_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the estimation of the long-run fourth order moment. If not reported, an automatic procedure computes it depending on the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It is only computed if the sample size is greater than 25 observations.
</p>


<h3>Value</h3>

<table>
<tr><td><code>kappa</code></td>
<td>
<p>CUMSUMQ test.</p>
</td></tr>
<tr><td><code>tb</code></td>
<td>
<p>Possible time of the break (with maximum value of the statistic).</p>
</td></tr>
<tr><td><code>cv</code></td>
<td>
<p>critical value at the specified significance level.</p>
</td></tr>
<tr><td><code>p.val</code></td>
<td>
<p>p-value.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.L. Carrion-i-Silvestre and A. Sanso</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.</p>


<h3>See Also</h3>

<p><code><a href="#topic+micss">micss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(logReturnsRandDollar)
e &lt;- whitening(data$rand.dollar)$e # whitening
kappa_test(e)
</code></pre>

<hr>
<h2 id='logReturnsRandDollar'>Data used in the examples</h2><span id='topic+logReturnsRandDollar'></span>

<h3>Description</h3>

<p>Log returns of the exchange rate South African Rand versus United States Dollar.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(logReturnsRandDollar)</code></pre>


<h3>Value</h3>

<p>Time series with 7705 observations.</p>


<h3>Author(s)</h3>

<p>J.L. Carrion-i-Silvestre and A. Sansó</p>


<h3>Source</h3>

<p>Paulo Rodrigues</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(logReturnsRandDollar)
names(data)
# The following example replicates some of the results of Table 6 in
# Carrion-i-Silvestres &amp; Sanso (2023)

data(logReturnsRandDollar)
e &lt;- whitening(data$rand.dollar)$e  # pre-whitening
m &lt;- micss(e)
print.micss(m)
</code></pre>

<hr>
<h2 id='lrv.spc.bartlett'>lrv.spc.bartlett</h2><span id='topic+lrv.spc.bartlett'></span>

<h3>Description</h3>

<p>Estimation of the long-run variance using the Barlett window.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lrv.spc.bartlett(x, kmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lrv.spc.bartlett_+3A_x">x</code></td>
<td>
<p>Stationary variable. A numeric vector.</p>
</td></tr>
<tr><td><code id="lrv.spc.bartlett_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the variance.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimates the log-run fourth order moment when x are the squares of a variable.
</p>


<h3>Value</h3>

<p>Estimation of the long-run variance.
</p>


<h3>References</h3>

<p>D. Sul, P.C.B. Phillips &amp; C.Y. Choi (2005): Prewhitening Bias in HAC Estimation, Oxford Bulletin of Economics and Statistics 67, 517-546.
</p>
<p>D.W.K. Andrews &amp; J.C. Monahan (1992): An Improved Heteroskedasticity and Autocorrelation Consistent Covariance Matrix Estimator. Econometrica 60, 953-966.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lrv.spc.bartlett(rnorm(100))
</code></pre>

<hr>
<h2 id='micss'>Modiffied Iterative Cumulative Sum of Squares Algorithm</h2><span id='topic+micss'></span>

<h3>Description</h3>

<p>Implements the MICSS algorithm of Carrion-i-Silvestre &amp; Sansó (2023)</p>


<h3>Usage</h3>

<pre><code class='language-R'>micss(e,sig.lev=0.05,kmax=NULL,alpha=NULL,tail.est="NR",k=0.1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="micss_+3A_e">e</code></td>
<td>
<p>A numeric vector. Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="micss_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level. The default value is 0.05.</p>
</td></tr>
<tr><td><code id="micss_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the estimation of the long-run fourth order moment. If not reported, an automatic procedure computes it depending on the sample size.</p>
</td></tr>
<tr><td><code id="micss_+3A_alpha">alpha</code></td>
<td>
<p>Tail index. If not reported, it is estimated automatically.</p>
</td></tr>
<tr><td><code id="micss_+3A_tail.est">tail.est</code></td>
<td>
<p>Estimator of the tail index. The default value is &quot;NR&quot;, which uses Nicolau &amp; Rodrigues (2019) estimator. &quot;Hill&quot; uses the Hill's (1975) estimator.</p>
</td></tr>
<tr><td><code id="micss_+3A_k">k</code></td>
<td>
<p>Fraction of the upper tail to be used to estimate of the tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The tail index is estimated using the absolute values.
</p>


<h3>Value</h3>

<table>
<tr><td><code>icss</code></td>
<td>
<p>An object with the output of the <a href="#topic+icss">icss</a> algorithm.</p>
</td></tr>
<tr><td><code>alpha</code></td>
<td>
<p>An object with the output of the <a href="#topic+estimate.alpha">estimate.alpha</a>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>J.L. Carrion-i-Silvestre and A. Sansó</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>
<p>B. Hill (1975): A Simple General Approach to Inference About the Tail of a Distribution. The Annals of Mathematical Statistics 3, 1163-1174.
</p>
<p>J. Nicolau &amp; P.M.M. Rodrigues (2019): A new regression-based tail index estimator. The Review of Economics and Statistics 101, 667-680.</p>


<h3>See Also</h3>

<p><code><a href="#topic+icss">icss</a></code>
<code><a href="#topic+estimate.alpha">estimate.alpha</a></code>
<code><a href="#topic+print.micss">print.micss</a></code>
<code><a href="#topic+plot.icss">plot.icss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
e &lt;- c(stats::rnorm(200),3*stats::rnorm(200))
o &lt;- micss(e)
print.micss(o)
#
# The following example replicates some of the results of Table 6 in
# Carrion-i-Silvestres &amp; Sanso (2023)

data(logReturnsRandDollar)
e &lt;- whitening(data$rand.dollar)$e  # pre-whitening
m &lt;- micss(e)
print.micss(m)
</code></pre>

<hr>
<h2 id='p.val.kappa'>P-values</h2><span id='topic+p.val.kappa'></span>

<h3>Description</h3>

<p>Computes p-values for the <a href="#topic+kappa_test">kappa_test</a> statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>p.val.kappa(x, t, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="p.val.kappa_+3A_x">x</code></td>
<td>
<p>Value of the statistic.</p>
</td></tr>
<tr><td><code id="p.val.kappa_+3A_t">t</code></td>
<td>
<p>Sample size.</p>
</td></tr>
<tr><td><code id="p.val.kappa_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>p-value.
</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>


<h3>See Also</h3>

<p><a href="#topic+cv.kappa">cv.kappa</a>
</p>

<hr>
<h2 id='plot.icss'>plot.icss</h2><span id='topic+plot.icss'></span>

<h3>Description</h3>

<p>Plots the output of the ICSS algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icss'
plot(x, type = "std", title = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.icss_+3A_x">x</code></td>
<td>
<p>An object with the output of <a href="#topic+icss">icss</a> or <a href="#topic+micss">micss</a>.</p>
</td></tr>
<tr><td><code id="plot.icss_+3A_type">type</code></td>
<td>
<p>Type of graphic. 3 possibilities: &quot;std&quot;, which is the default,
plots the absolute value of the variable and the standard deviation; &quot;var&quot;
plots the squares of the variable and the variance; &quot;res.std&quot; plots
the standardized residuals.</p>
</td></tr>
<tr><td><code id="plot.icss_+3A_title">title</code></td>
<td>
<p>Title of the graphic.</p>
</td></tr>
<tr><td><code id="plot.icss_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. It generates a plot the output of <a href="#topic+micss">micss</a> or <a href="#topic+icss">icss</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
e &lt;- c(stats::rnorm(200),3*stats::rnorm(200))
o &lt;- micss(e)
plot.icss(o,title="Example of the MICSS algorithm")
</code></pre>

<hr>
<h2 id='print.icss'>print.icss</h2><span id='topic+print.icss'></span>

<h3>Description</h3>

<p>Prints the output of <a href="#topic+icss">icss</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'icss'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.icss_+3A_x">x</code></td>
<td>
<p>An object with the output of the <a href="#topic+icss">icss</a> algorithm.</p>
</td></tr>
<tr><td><code id="print.icss_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>

<p>No return value. It prints the output of <a href="#topic+icss">icss</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
e &lt;- c(stats::rnorm(200),3*stats::rnorm(200))
o &lt;- icss(e)
print.icss(o)
</code></pre>

<hr>
<h2 id='print.micss'>print.micss</h2><span id='topic+print.micss'></span>

<h3>Description</h3>

<p>Prints the output of <a href="#topic+micss">micss</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'micss'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.micss_+3A_x">x</code></td>
<td>
<p>An object with the output of the <a href="#topic+micss">micss</a> algorithm.</p>
</td></tr>
<tr><td><code id="print.micss_+3A_...">...</code></td>
<td>
<p>Further arguments passed to or from other methods.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value. It prints the output of <a href="#topic+micss">micss</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>set.seed(2)
e &lt;- c(stats::rnorm(200),3*stats::rnorm(200))
o &lt;- micss(e)
print.micss(o)
</code></pre>

<hr>
<h2 id='sr_loc'>sr_loc</h2><span id='topic+sr_loc'></span>

<h3>Description</h3>

<p>Computes the location parameter for the GEV approximation
to the distribution of <a href="#topic+kappa_test">kappa_test</a> statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sr_loc(t, alpha, lmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sr_loc_+3A_t">t</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="sr_loc_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4</p>
</td></tr>
<tr><td><code id="sr_loc_+3A_lmax">lmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the
innovations. If not specified it is generated automatically depending on the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>used internally by <a href="#topic+cv.kappa">cv.kappa</a> and <a href="#topic+p.val.kappa">p.val.kappa</a>
</p>


<h3>Value</h3>

<p>Location parameter
</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>

<hr>
<h2 id='sr_scale'>sr_scale</h2><span id='topic+sr_scale'></span>

<h3>Description</h3>

<p>Computes the scale parameter for the GEV approximation
to the distribution of <a href="#topic+kappa_test">kappa_test</a> statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sr_scale(t, alpha, lmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sr_scale_+3A_t">t</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="sr_scale_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4</p>
</td></tr>
<tr><td><code id="sr_scale_+3A_lmax">lmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the
innovations. If not specified it is generated automatically depending on the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+cv.kappa">cv.kappa</a> and <a href="#topic+p.val.kappa">p.val.kappa</a>
</p>


<h3>Value</h3>

<p>Scale parameter
</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>

<hr>
<h2 id='sr_shape'>sr_shape</h2><span id='topic+sr_shape'></span>

<h3>Description</h3>

<p>Computes the scale parameter for the GEV approximation
to the distribution of <a href="#topic+kappa_test">kappa_test</a> statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sr_shape(t, alpha, lmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sr_shape_+3A_t">t</code></td>
<td>
<p>Sample size</p>
</td></tr>
<tr><td><code id="sr_shape_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4</p>
</td></tr>
<tr><td><code id="sr_shape_+3A_lmax">lmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the
innovations. If not specified it is generated automatically depending on the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+cv.kappa">cv.kappa</a> and <a href="#topic+p.val.kappa">p.val.kappa</a>
</p>


<h3>Value</h3>

<p>Shape parameter
</p>


<h3>References</h3>

<p>J.L. Carrion-i-Silvestre &amp; A. Sansó (2023): Generalized Extreme Value Approximation to the CUMSUMQ Test for Constant Unconditional Variance in Heavy-Tailed Time Series.
</p>

<hr>
<h2 id='step2a'>step2a</h2><span id='topic+step2a'></span>

<h3>Description</h3>

<p>Computes step 2a of the <a href="#topic+icss">icss</a> Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step2a(e, sig.lev, kmax, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step2a_+3A_e">e</code></td>
<td>
<p>Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="step2a_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="step2a_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the innovations.</p>
</td></tr>
<tr><td><code id="step2a_+3A_alpha">alpha</code></td>
<td>
<p>Tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>tb</code>: Time of the break.
</p>
</li></ul>



<h3>References</h3>

<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.
</p>

<hr>
<h2 id='step2b'>step2b</h2><span id='topic+step2b'></span>

<h3>Description</h3>

<p>Computes step 2b of the <a href="#topic+icss">icss</a> Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step2b(e, sig.lev, kmax, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step2b_+3A_e">e</code></td>
<td>
<p>Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="step2b_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="step2b_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the innovations.</p>
</td></tr>
<tr><td><code id="step2b_+3A_alpha">alpha</code></td>
<td>
<p>Tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>tb</code>: Time of the break.
</p>
</li></ul>



<h3>References</h3>

<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.
</p>

<hr>
<h2 id='step2c'>step2c</h2><span id='topic+step2c'></span>

<h3>Description</h3>

<p>Computes step 2c of the <a href="#topic+icss">icss</a> Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step2c(e, bb, sig.lev, kmax, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step2c_+3A_e">e</code></td>
<td>
<p>Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="step2c_+3A_bb">bb</code></td>
<td>
<p>The output of function <a href="#topic+steps1.to.2b">steps1.to.2b</a>.</p>
</td></tr>
<tr><td><code id="step2c_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="step2c_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the innovations.</p>
</td></tr>
<tr><td><code id="step2c_+3A_alpha">alpha</code></td>
<td>
<p>Tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>nb</code>: Number of breaks.
</p>
</li>
<li> <p><code>tb</code>: Time of the breaks.
</p>
</li></ul>



<h3>References</h3>

<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.
</p>

<hr>
<h2 id='step3'>step3</h2><span id='topic+step3'></span>

<h3>Description</h3>

<p>Computes step 3 of the <a href="#topic+icss">icss</a> Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>step3(e, bb, sig.lev, kmax, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="step3_+3A_e">e</code></td>
<td>
<p>Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="step3_+3A_bb">bb</code></td>
<td>
<p>The output of <a href="#topic+step2c">step2c</a>, A list with the number of break and the time of the breaks.</p>
</td></tr>
<tr><td><code id="step3_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="step3_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the innovations.</p>
</td></tr>
<tr><td><code id="step3_+3A_alpha">alpha</code></td>
<td>
<p>Tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>nb</code>: Number of breaks.
</p>
</li>
<li> <p><code>tb</code>: Time of the breaks.
</p>
</li></ul>



<h3>References</h3>

<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.
</p>

<hr>
<h2 id='steps1.to.2b'>steps1.to.2b</h2><span id='topic+steps1.to.2b'></span>

<h3>Description</h3>

<p>Computes steps 1 to 2b of the <a href="#topic+icss">icss</a> Algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>steps1.to.2b(e, sig.lev, kmax, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="steps1.to.2b_+3A_e">e</code></td>
<td>
<p>Stationary variable on which the constancy of unconditional variance is tested.</p>
</td></tr>
<tr><td><code id="steps1.to.2b_+3A_sig.lev">sig.lev</code></td>
<td>
<p>Significance level.</p>
</td></tr>
<tr><td><code id="steps1.to.2b_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the fourth order moment of the innovations.</p>
</td></tr>
<tr><td><code id="steps1.to.2b_+3A_alpha">alpha</code></td>
<td>
<p>Tail index.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+icss">icss</a>.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>nb</code>: Number of breaks.
</p>
</li>
<li> <p><code>tb</code>: Time of the breaks.
</p>
</li>
<li> <p><code>kappa.max</code>: Maximum value of the <a href="#topic+kappa_test">kappa_test</a> if there is no break.
</p>
</li>
<li> <p><code>p.val</code>: p-value.
</p>
</li></ul>



<h3>References</h3>

<p>C. Inclan &amp; G.C. Tiao (1994): Use of Cumulative Sums of Squares for Retrospective Detection of Changes of Variance. Journal of the American Statistical Association 89, 913-923.
</p>

<hr>
<h2 id='taula.icss'>taula.icss</h2><span id='topic+taula.icss'></span>

<h3>Description</h3>

<p>When there are breaks in the unconditional variance, it
creates a matrix with the different periods and estimated variances.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taula.icss(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taula.icss_+3A_x">x</code></td>
<td>
<p>An object with the output of <a href="#topic+icss">icss</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+print.icss">print.icss</a>. If there are no break returns NA value.
</p>


<h3>Value</h3>

<p>Matrix with the different periods and estimated variances.
</p>

<hr>
<h2 id='taula.micss'>taula.micss</h2><span id='topic+taula.micss'></span>

<h3>Description</h3>

<p>When there are breaks in the unconditional variance, it
creates a matrix with the different periods, estimated variances, values of
<a href="#topic+kappa_test">kappa_test</a> and <a href="#topic+p.val.kappa">p.val.kappa</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>taula.micss(x, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="taula.micss_+3A_x">x</code></td>
<td>
<p>An object with the output of <a href="#topic+icss">icss</a>.</p>
</td></tr>
<tr><td><code id="taula.micss_+3A_alpha">alpha</code></td>
<td>
<p>Value of the tail index between 2 and 4</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Used internally by <a href="#topic+print.micss">print.micss</a>.
</p>


<h3>Value</h3>

<p>Matrix with the different periods, estimated variances, values of
<a href="#topic+kappa_test">kappa_test</a> and <a href="#topic+p.val.kappa">p.val.kappa</a>.
</p>

<hr>
<h2 id='var.est.icss'>var.est.icss</h2><span id='topic+var.est.icss'></span>

<h3>Description</h3>

<p>Computes the variance of each period according to the breaks found with <a href="#topic+icss">icss</a> or <a href="#topic+micss">micss</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>var.est.icss(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="var.est.icss_+3A_x">x</code></td>
<td>
<p>An object with the output of <a href="#topic+icss">icss</a> or <a href="#topic+micss">micss</a>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector with the variances.
</p>

<hr>
<h2 id='whitening'>whitening</h2><span id='topic+whitening'></span>

<h3>Description</h3>

<p>Eliminates the autocorrelation of a variable using an AR model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>whitening(y, kmax = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="whitening_+3A_y">y</code></td>
<td>
<p>A numeric vector. Variable to be whiten.</p>
</td></tr>
<tr><td><code id="whitening_+3A_kmax">kmax</code></td>
<td>
<p>Maximum lag to be used for the long-run estimation of the variance.
If not specified uses [12*(t/100)^(1/4)].</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Selects the model using the Bayes Information Criteria.
</p>


<h3>Value</h3>


<ul>
<li> <p><code>e</code>: Whiten variable.
</p>
</li>
<li> <p><code>rho</code>: Vector of autoregressive parameters.
</p>
</li>
<li> <p><code>lag</code>: number of lags used.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>whitening(rnorm(100))
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
