<!DOCTYPE html><html><head><title>Help for package IPMbook</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {IPMbook}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#IPMbook-package'>
<p>Functions and data for the book 'Integrated Population Models'</p></a></li>
<li><a href='#bats'>
<p>Data for greater horseshoe bats from Switzerland, 1989-2017</p></a></li>
<li><a href='#bear'>
<p>Data for black bears in Louisiana, USA, 2007-2012</p></a></li>
<li><a href='#BetaDist'>
<p>The beta distribution</p></a></li>
<li><a href='#catbird'>
<p>Data for gray catbird from New England/Mid-Atlantic region, USA, 1992-2008</p></a></li>
<li><a href='#ch2matrix'>
<p>Convert capture histories in text format to a matrix</p></a></li>
<li><a href='#cormorant'>
<p>Data from three Danish cormorant breeding colonies, 1991-2004</p></a></li>
<li><a href='#createAge'>
<p>Creates an age matrix</p></a></li>
<li><a href='#demoMCMC'>
<p>Demonstration of a random-walk sampler for a single parameter</p></a></li>
<li><a href='#Discrete uniform'>
<p>Discrete uniform prior distribution</p></a></li>
<li><a href='#elk'>
<p>Data from an elk population in USA, 1988-1993</p></a></li>
<li><a href='#Fix matrices'><p> Quick and dirty specification of matrices</p></a></li>
<li><a href='#GammaDist'>
<p>The gamma distribution</p></a></li>
<li><a href='#grouse'>
<p>Data for black grouse from Italy, 1997-2016</p></a></li>
<li><a href='#Helper functions'>
<p>Various helper functions</p></a></li>
<li><a href='#hoopoe'>
<p>Data for hoopoe from Switzerland, 2002-2017</p></a></li>
<li><a href='#kestrel'>
<p>Data for kestrels from Switzerland, 2002-2016</p></a></li>
<li><a href='#marray'>
<p>Converts capture-histories to an m-array for one age class</p></a></li>
<li><a href='#marrayAge'>
<p>Creates age-dependent m-arrays</p></a></li>
<li><a href='#marrayDead'>
<p>Converts dead-recovery capture histories to an m-array</p></a></li>
<li><a href='#peregrine'>
<p>Data for peregrine falcons from the Jura Mountains, 1965-2007</p></a></li>
<li><a href='#redbacked'>
<p>Data for red-backed shrike from Germany, 1971-2006</p></a></li>
<li><a href='#simCapHist'>
<p>Simulates capture histories from a population</p></a></li>
<li><a href='#simCount'>
<p>Simulates count survey data</p></a></li>
<li><a href='#simMHB'>
<p>Simulates detection and count data with spatial and temporal replication</p></a></li>
<li><a href='#simPop'>
<p>Simulates a population based on demographic parameters</p></a></li>
<li><a href='#simProd'>
<p>Simulates productivity data</p></a></li>
<li><a href='#stork'>
<p>Data on marked white storks in Germany, 1986-2001</p></a></li>
<li><a href='#summaryPop'>
<p>Calculates summary statistics from a subset of a population</p></a></li>
<li><a href='#swallow'>
<p>Data for barn swallows in Switzerland, 1997-2003</p></a></li>
<li><a href='#woodchat10'>
<p>Simulated data for woodchat shrike for use in chapter 10</p></a></li>
<li><a href='#woodchat11'>
<p>Data for woodchat shrike from Germany, 1964-1992</p></a></li>
<li><a href='#woodchat5'>
<p>Simulated data for woodchat shrike for use in chapter 5</p></a></li>
<li><a href='#woodchat6'>
<p>Simulated data for woodchat shrike for use in section 6.3</p></a></li>
<li><a href='#woodchat64'>
<p>Simulated data for woodchat shrike for use in section 6.4</p></a></li>
<li><a href='#woodchat66'>
<p>Simulated data for woodchat shrike for use in section 6.6</p></a></li>
<li><a href='#woodchat7'>
<p>Simulated data for woodchat shrike for use in chapter 7</p></a></li>
<li><a href='#wryneck'>
<p>Data from wrynecks in Switzerland, 2002-2006</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Functions and Data for the Book 'Integrated Population Models'</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2023-08-21</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, abind</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides functions and data sets to accompany the  book 'Integrated Population Models: Theory and Ecological Applications with R and JAGS' by Michael Schaub and Marc Kéry (ISBN: 9780128205648).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://www.vogelwarte.ch/de/projekte/publikationen/ipm/">https://www.vogelwarte.ch/de/projekte/publikationen/ipm/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/kenkellner/IPMbook/issues">https://github.com/kenkellner/IPMbook/issues</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Language:</td>
<td>en-US</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-21 13:48:37 UTC; ken</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael Schaub [aut],
  Marc Kéry [aut],
  Mike Meredith [aut],
  Ken Kellner [cre],
  Raphaël Arlettaz [dtc] (bats),
  Gabriel Banderet [dtc] (peregrine),
  François Biollaz [dtc] (bats),
  Radames Bionda [dtc] (grouse),
  Thomas Bregnballe [dtc] (cormorant),
  Hans Jakober [dtc] (redbacked),
  Ioannis Ntzoufras [ctb],
  Luca Rotelli [dtc] (grouse),
  Antoine Sierro [dtc] (bats),
  Wolfgang Stauber [dtc] (redbacked),
  Bruno Ullrich [dtc] (woodchat11),
  Fonds Sauvegarde Faune Flore Jurassienne - Groupe Pèlerin Jura [dtc]
    (peregrine),
  Idaho Department of Fish and Game [dtc] (elk),
  Louisiana Department of Wildlife and Fisheries [dtc] (bear),
  Monitoring Avian Productivity and Survivorship program (MAPS) [dtc]
    (catbird),
  North American Breeding Bird Survey (BBS) [dtc] (catbird),
  University Bern, Division of Conservation Biology [dtc] (hoopoe),
  Vogelwarte Hiddensee, Germany [dtc] (stork),
  Swiss Ornithological Institute [dtc] (hoopoe, kestrel, peregrine,
    swallow, wryneck)</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Ken Kellner &lt;contact@kenkellner.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-21 18:30:12 UTC</td>
</tr>
</table>
<hr>
<h2 id='IPMbook-package'>
Functions and data for the book 'Integrated Population Models'
</h2><span id='topic+IPMbook-package'></span><span id='topic+IPMbook'></span>

<h3>Description</h3>

<p>Provides functions and data sets to accompany the  book <em>Integrated Population Models</em> by Michael Schaub and Marc Kéry (ISBN: 9780128205648).
</p>


<h3>Details</h3>

<p>The functions are listed by chapter below.
</p>


<h3>Chapter 2</h3>


<dl>
<dt><code><a href="#topic+demoMCMC">demoMCMC</a></code></dt><dd><p> Demonstration of a random-walk sampler for MCMC (section 2.5)</p>
</dd>
</dl>



<h3>Chapter 4</h3>


<dl>
<dt><code><a href="#topic+simMHB">simMHB</a></code></dt><dd><p> Simulates detection and count data with spatial and temporal replication (section 4.3.3)</p>
</dd>
<dt><code><a href="#topic+createAge">createAge</a></code></dt><dd><p> Creates an age matrix (section 4.5.1.1)</p>
</dd>
<dt><code><a href="#topic+marray">marray</a></code></dt><dd><p> Converts single- or multistate capture histories to an m-array for one age class (section 4.5.1.2)</p>
</dd>
<dt><code><a href="#topic+marrayAge">marrayAge</a></code></dt><dd><p> Converts single-state capture histories to age-dependent m-arrays (section 4.5.1.2)</p>
</dd>
</dl>



<h3>Chapter 5</h3>


<dl>
<dt><code><a href="#topic+simPop">simPop</a></code></dt><dd><p> Simulates a population based on demographic parameters (section 5.5.1)</p>
</dd>
<dt><code><a href="#topic+simCapHist">simCapHist</a></code></dt><dd><p> Simulates capture histories from a population (section 5.5.1)</p>
</dd>
<dt><code><a href="#topic+simProd">simProd</a></code></dt><dd><p> Simulates productivity data for a population (section 5.5.1)</p>
</dd>
<dt><code><a href="#topic+simCount">simCount</a></code></dt><dd><p> Simulates population survey data for a population (section 5.5.1)</p>
</dd>
</dl>



<h3>Chapter 12</h3>


<dl>
<dt><code><a href="#topic+marrayDead">marrayDead</a></code></dt><dd><p> Converts dead-recovery capture histories to an m-array (section 12.4.2)</p>
</dd>
</dl>



<h3>DATA SETS</h3>


<dl>
<dt><code><a href="#topic+bats">bats</a></code></dt><dd><p> Data for greater horseshoe bats from Switzerland, 1989-2017, chapter 13.</p>
</dd>
<dt><code><a href="#topic+bear">bear</a></code></dt><dd><p> Data for black bears from USA, 2007-2012, chapter 21.</p>
</dd>
<dt><code><a href="#topic+catbird">catbird</a></code></dt><dd><p> Data for catbirds from USA, 1992-2008, chapter 19.</p>
</dd>
<dt><code><a href="#topic+cormorant">cormorant</a></code></dt><dd><p> Data for cormorants from Denmark, 1991-2004, chapter 18.</p>
</dd>
<dt><code><a href="#topic+elk">elk</a></code></dt><dd><p> Data for elk cows from USA, 1988-1993, chapter 17.</p>
</dd>
<dt><code><a href="#topic+grouse">grouse</a></code></dt><dd><p> Data for black grouse from Italy, 1997-2016, chapter 15.</p>
</dd>
<dt><code><a href="#topic+hoopoe">hoopoe</a></code></dt><dd><p> Data for hoopoe from Switzerland, 2001-2017, chapter 14.</p>
</dd>
<dt><code><a href="#topic+kestrel">kestrel</a></code></dt><dd><p> Data for kestrels from Switzerland, 2002-2016, chapter 20.</p>
</dd>
<dt><code><a href="#topic+peregrine">peregrine</a></code></dt><dd><p> Data for peregrine falcons from France and Switzerland, 1965-2007, chapter 12.</p>
</dd>
<dt><code><a href="#topic+redbacked">redbacked</a></code></dt><dd><p> Data for red-backed shrike from Germany, 1971-2006, section 8.2.</p>
</dd>
<dt><code><a href="#topic+stork">stork</a></code></dt><dd><p> Data for white storks from Germany, 1986-2001, section 4.5.4.</p>
</dd>
<dt><code><a href="#topic+swallow">swallow</a></code></dt><dd><p> Data for barn swallow from Switzerland, 1997-2003, chapter 16.</p>
</dd>
<dt><code><a href="#topic+woodchat5">woodchat5</a></code></dt><dd><p> Simulated data for woodchat shrike for use in chapter 5.</p>
</dd>
<dt><code><a href="#topic+woodchat6">woodchat6</a></code></dt><dd><p> Simulated data for woodchat shrike for use in chapter 6.</p>
</dd>
<dt><code><a href="#topic+woodchat64">woodchat64</a></code></dt><dd><p> Simulated data for woodchat shrike for use in section 6.4.</p>
</dd>
<dt><code><a href="#topic+woodchat66">woodchat66</a></code></dt><dd><p> Simulated data for woodchat shrike for use in section 6.6.</p>
</dd>
<dt><code><a href="#topic+woodchat7">woodchat7</a></code></dt><dd><p> Simulated data for woodchat shrike for use in chapter 7.</p>
</dd>
<dt><code><a href="#topic+woodchat10">woodchat10</a></code></dt><dd><p> Simulated data for woodchat shrike for use in chapter 10.</p>
</dd>
<dt><code><a href="#topic+woodchat11">woodchat11</a></code></dt><dd><p> Data for woodchat shrike from Germany, 1964-1992, chapter 11.</p>
</dd>
<dt><code><a href="#topic+wryneck">wryneck</a></code></dt><dd><p> Nest survival data for wryneck from Switzerland, 2002-2006, section 4.4.6.</p>
</dd>
</dl>



<h3>UTILITY FUNCTIONS</h3>


<dl>
<dt><code><a href="#topic+ch2matrix">ch2matrix</a></code></dt><dd><p> Convert capture histories in text format to a matrix.</p>
</dd>
<dt><code><a href="#topic+cleanCH">cleanCH</a></code></dt><dd><p> Removes all-zero rows from a capture history matrix.</p>
</dd>
<dt><code><a href="#topic+dbeta2">dbeta2</a></code></dt><dd><p> Beta distribution with mean and sd.</p>
</dd>
<dt><code><a href="#topic+dbeta3">dbeta3</a></code></dt><dd><p> Beta distribution with mode and concentration.</p>
</dd>
<dt><code><a href="#topic+dgamma2">dgamma2</a></code></dt><dd><p> Gamma distribution with mean and sd.</p>
</dd>
<dt><code><a href="#topic+getFirst">getFirst</a></code></dt><dd><p> Calculates the occasion of first capture from a capture history matrix.</p>
</dd>
<dt><code><a href="#topic+rmFirst">rmFirst</a></code></dt><dd><p> Removes the records of first capture from a capture history matrix.</p>
</dd>
<dt><code><a href="#topic+zInit">zInit</a></code></dt><dd><p> Converts a capture history matrix to one with 1 after the occasion of first capture, NA elsewhere.</p>
</dd>
<dt><code><a href="#topic+zInitDR">zInitDR</a></code></dt><dd><p> Converts a dead-recovery capture history matrix to one with 1 after the occasion of first capture until the occasion of dead recovery, then 0; NA elsewhere.</p>
</dd>
<dt><code><a href="#topic+zKnown">zKnown</a></code></dt><dd><p> Converts a capture history matrix to one with 1 where the animal is know to be alive, NA elsewhere.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Michael Schaub, Marc Kéry, Mike Meredith
</p>

<hr>
<h2 id='bats'>
Data for greater horseshoe bats from Switzerland, 1989-2017
</h2><span id='topic+bats'></span>

<h3>Description</h3>

<p>Data for greater horseshoe bats (<em>Rhinolophus ferrumequinum</em>) were collected from 1989 to 2017 from a nursery colony in a church in the Swiss Alps (Valais).
</p>
<p>Bats were captured and marked resulting in capture-recapture data, but in some years no capture was performed. Every year the number of adults was counted when they leave the colony at dusk and the number of newborn was recorded in the colony.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bats)</code></pre>


<h3>Format</h3>

<p><code>bats</code> is a list with 7 components:
</p>

<dl>
<dt>ch </dt><dd><p>matrix of capture histories for 574 bats x 29 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each bat at first capture, 1 = juvenile, 2 = 1-year old, 3 = at least 2 years old.</p>
</dd>
<dt>sex </dt><dd><p>sex of bats captured, 1 = female, 2 = male.</p>
</dd>
<dt>J.count </dt><dd><p>annual counts of newborn bats in the roost; in most years these were complete counts.</p>
</dd>
<dt>Jm </dt><dd><p>number of newborn bats recorded as male (not all newborns captured were sexed).</p>
</dd>
<dt>Jf </dt><dd><p>number of newborn bats recorded as female.</p>
</dd>
<dt>A.count </dt><dd><p>annual number of adults counted when the bats leave the colony at dusk; exit counts were not done in 1991 and 2001.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Raphaël Arlettaz, François Biollaz, Antoine Sierro</p>


<h3>References</h3>

<p>Schaub, M., Gimenez, O., Sierro, A., Arlettaz, R. (2007) Use of integrated modeling to enhance estimates of population dynamics obtained from limited data. <em>Conservation Biology</em> 21, 945-955.
</p>
<p>Sierro, A., Lugon, A., Arlettaz, R. (2009) La colonie de grands rhinolophes <em>Rhinolophus ferrumequinum</em> de l'église St-Sylvie à Vex (Valais, Suisse): évolution sur deux décennies (1968-2006). <em>Le Rhinolophe</em> 18, 75-82.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 13.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bats)
str(bats)
</code></pre>

<hr>
<h2 id='bear'>
Data for black bears in Louisiana, USA, 2007-2012
</h2><span id='topic+bear'></span>

<h3>Description</h3>

<p>The data on the Louisiana black bear (<em>Ursus americanus luteolus</em>) were collected during six years (2007-2012) in the Upper Atchafalaya River Basin in South-central Louisiana, USA, using hair snares. Hair samples were collected during eight consecutive weeks in each year and a selection of samples were genotyped resulting in spatial capture-recapture (SCR) data. This data set includes SCR data for 2007, 2009 and 2011, plus simple occupancy data for 2008, 2010 and 2012. See Chandler and Clark (2014) for details.
</p>
<p>Note that not all hair samples were successfully genotyped, and traps were not deployed at all 128 locations in every year, leading to NAs in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(bear)</code></pre>


<h3>Format</h3>

<p><code>bear</code> is a list with 3 components:
</p>

<dl>
<dt>scr </dt><dd><p>an array with SCR data, individuals x traps x occasions x years.</p>
</dd>
<dt>occ </dt><dd><p>an array with detection/nondetection data, locations x occasions x years.</p>
</dd>
<dt>trap.coord </dt><dd><p>a 2-column matrix with the coordinates of the trap locations.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Louisiana Department of Wildlife and Fisheries</p>


<h3>References</h3>

<p>Chandler, R. B., Clark, J. D. (2014) Spatially explicit integrated population models. <em>Methods in Ecology and Evolution</em> 5, 1351-1360.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 21.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(bear)
str(bear)
</code></pre>

<hr>
<h2 id='BetaDist'>
The beta distribution
</h2><span id='topic+BetaDist'></span><span id='topic+dbeta2'></span><span id='topic+pbeta2'></span><span id='topic+qbeta2'></span><span id='topic+rbeta2'></span><span id='topic+getBeta2Par'></span><span id='topic+dbeta3'></span><span id='topic+pbeta3'></span><span id='topic+qbeta3'></span><span id='topic+rbeta3'></span><span id='topic+getBeta3Par'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number generation for the beta distribution with parameters <code>mean</code> and <code>sd</code> OR <code>mode</code> and <code>concentration</code>. These are wrappers for <code>stats::dbeta</code>, etc. <code>getBeta*Par</code> returns the shape parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dbeta2(x, mean, sd)
pbeta2(q, mean, sd, lower.tail=TRUE, log.p=FALSE)
qbeta2(p, mean, sd, lower.tail=TRUE, log.p=FALSE)
rbeta2(n, mean, sd)
getBeta2Par(mean, sd)

dbeta3(x, mode, concentration)
pbeta3(q, mode, concentration, lower.tail=TRUE, log.p=FALSE)
qbeta3(p, mode, concentration, lower.tail=TRUE, log.p=FALSE)
rbeta3(n, mode, concentration)
getBeta3Par(mode, concentration)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BetaDist_+3A_x">x</code></td>
<td>

<p>vector of parameter values.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_n">n</code></td>
<td>

<p>number of random draws required.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_mean">mean</code></td>
<td>

<p>mean of the beta distribution; cannot be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_sd">sd</code></td>
<td>

<p>standard deviation of the beta distribution; this must be less than <code>sqrt(mean * (1-mean))</code>, larger values will return NA, with a warning.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_mode">mode</code></td>
<td>

<p>mode of the beta distribution; may be 0 or 1.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_concentration">concentration</code></td>
<td>

<p>concentration of the beta distribution; concentration = 2 is uniform, and the distribution becomes narrower as concentration increases. It is sometimes referred to as 'sample size', but best thought of as sample size + 2.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), cumulative probabilities up to x, otherwise, above x.
</p>
</td></tr>
<tr><td><code id="BetaDist_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dbeta*</code> gives the density, <code>pbeta*</code> gives the distribution function, <code>qbeta*</code> gives the quantile function, and <code>rbeta*</code> generates random deviates.
</p>
<p><code>getBeta*Par</code> returns a 2-column matrix with the shape parameters corresponding to <code>mean</code> and <code>sd</code> OR <code>mode</code> and <code>concentration</code>.
</p>


<h3>Author(s)</h3>

<p>Mike Meredith
</p>


<h3>See Also</h3>

<p>See the <span class="pkg">stats</span> functions <code><a href="stats.html#topic+dbeta">dbeta</a></code>, <code><a href="stats.html#topic+pbeta">pbeta</a></code>, <code><a href="stats.html#topic+qbeta">qbeta</a></code>, <code><a href="stats.html#topic+rbeta">rbeta</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot some curves with dbeta2
xx &lt;- seq(0, 1, length.out=101)
plot(xx, dbeta2(xx, 0.4, 0.12), xlab="x", ylab="Probability density",
  main="Beta curves with mean = 0.4", type='l', lwd=2)
lines(xx, dbeta2(xx, 0.4, 0.24), col='darkgreen', lwd=2)
lines(xx, dbeta2(xx, 0.4, 0.28), col='red', lwd=2)
lines(xx, dbeta2(xx, 0.4, 0.36), col='blue', lwd=2)
abline(v=0.4, lty=3, lwd=2)
legend('topright', paste("sd =", c(0.12,0.24, 0.28, 0.36)), lwd=2,
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# Get shape and rate parameters for mean = 0.4 and sd = c(0.12,0.24, 0.28, 0.36, 0.49)
# The last value for sd is too big and will produce NAs and a warning
getBeta2Par(mean = 0.4, sd = c(0.12,0.24, 0.28, 0.36, 0.49))

# The parameterisation with mean and sd doesn't seem intuitive,
#   let's try mode and concentration.
# This does not allow 'bathtub' curves, which are bimodal.
plot(xx, dbeta3(xx, 0.4, 16), xlab="x", ylab="Probability density",
  main="Beta curves with mode = 0.4", type='l', lwd=2)
lines(xx, dbeta3(xx, 0.4, 8), col='darkgreen', lwd=2)
lines(xx, dbeta3(xx, 0.4, 4), col='red', lwd=2)
lines(xx, dbeta3(xx, 0.4, 2), col='blue', lwd=2)
abline(v=0.4, lty=3, lwd=2)
legend('topright', , lwd=2, paste("concentration =", c(16, 8, 4, 2)),
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# The mode can be at 0 or 1:
plot(xx, dbeta3(xx, 1, 16), xlab="x", ylab="Probability density",
  main="Beta curves with mode = 1", type='l', lwd=2)
lines(xx, dbeta3(xx, 1, 8), col='darkgreen', lwd=2)
lines(xx, dbeta3(xx, 1, 4), col='red', lwd=2)
lines(xx, dbeta3(xx, 1, 2), col='blue', lwd=2)
legend('topleft', paste("concentration =", c(16, 8, 4, 2)), lwd=2,
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# Cumulative plots with pbeta3
plot(xx, pbeta3(xx, 0.4, 16), xlab="x", ylab="Cumulative probability",
  main="Beta curves with mode = 0.4", type='l', lwd=2)
lines(xx, pbeta3(xx, 0.4, 8), col='darkgreen', lwd=2)
lines(xx, pbeta3(xx, 0.4, 4), col='red', lwd=2)
lines(xx, pbeta3(xx, 0.4, 2), col='blue', lwd=2)
abline(v=0.4, lty=3, lwd=2)
legend('topleft', paste("concentration =", c(16, 8, 4, 2)), lwd=2,
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# Generate random draws and plot a histogram
rnd &lt;- rbeta3(1e5, 0.4, 8)
hist(rnd, freq=FALSE)
# Add the curve:
lines(xx, dbeta3(xx, 0.4, 8), col='darkgreen', lwd=2)

# Get shape and rate parameters for mode = 0.4 and concentration = c(2, 4, 8, 16)
getBeta3Par(mode = 0.4, concentration = c(2, 4, 8, 16))

</code></pre>

<hr>
<h2 id='catbird'>
Data for gray catbird from New England/Mid-Atlantic region, USA, 1992-2008
</h2><span id='topic+catbird'></span>

<h3>Description</h3>

<p>The data set includes sighting data from the North American Breeding Bird Survey (BBS) and mark-recapture data from the Monitoring Avian Productivity and Survivorship program (MAPS) for gray catbirds (<em>Dumetella carolinensis</em>) in the New England/Mid-Atlantic region, USA, for 1992-2008.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(catbird)</code></pre>


<h3>Format</h3>

<p><code>catbird</code> is a list with 9 components:
</p>

<dl>
<dt>y </dt><dd><p>matrix of capture-recapture data from MAPS data, 4276 birds x 17 years.</p>
</dd>
<dt>r </dt><dd><p>residency for each bird, 1 if the bird was captured more than once at least 11 days apart in the same year; 0 otherwise.</p>
</dd>
<dt>station </dt><dd><p>banding station identifier.</p>
</dd>
<dt>count </dt><dd><p>number of individuals detected on each route in the BBS data.</p>
</dd>
<dt>stratum </dt><dd><p>identifier of the stratum of the route.</p>
</dd>
<dt>year </dt><dd><p>year of the count.</p>
</dd>
<dt>observer </dt><dd><p>identifier of the observer making the count.</p>
</dd>
<dt>firstyr </dt><dd><p>1 if the observer counted on the route for the first time, 0 otherwise.</p>
</dd>
<dt>area </dt><dd><p>the area of each stratum.</p>
</dd>
</dl>



<h3>Source</h3>

<p>North American Breeding Bird Survey (BBS) and Monitoring Avian Productivity and Survivorship program (MAPS)</p>


<h3>References</h3>

<p>Ahrestani, F. S., Saracco, J. F., Sauer, J. R., Pardieck, K. L., Royle, J. A. (2017) An integrated population model for bird monitoring in North America. <em>Ecological Applications</em> 27, 916-924.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(catbird)
str(catbird)
</code></pre>

<hr>
<h2 id='ch2matrix'>
Convert capture histories in text format to a matrix
</h2><span id='topic+ch2matrix'></span>

<h3>Description</h3>

<p>The function takes capture histories in any of the following formats and converts it to a matrix of integers with one column for each capture occasion and one row for each capture history.
</p>
<p>Possible formats for <code>ch</code> are:
</p>
<p>1a. a proper CH matrix: numeric, &gt; 1 column &ndash; returned unchanged.<br />
1b. the same, as a data frame.
</p>
<p>2a. a character vector with &quot;100110&quot;, &quot;001100&quot;, etc, consisting entirely of digits (no letters, spaces, or symbols).<br />
2b. the same, as a factor.<br />
2c. a numeric vector with 100110, 1100, etc (leading zeros dropped).
</p>
<p>3a. a 1-column data frame with 2a, b or c.<br />
3b. a 1-column matrix with 2a or 2c.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ch2matrix(ch)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ch2matrix_+3A_ch">ch</code></td>
<td>

<p>capture histories in a suitable format, see Description.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix of integers with one column for each capture occasion and one row for each capture history.
</p>


<h3>Author(s)</h3>

<p>Mike Meredith
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Create some example data
raw &lt;- c("1000", "1000", "1100", "1100", "1100", "1110",
  "0110", "0110", "0111", "0101", "0010", "0011", "0001")

ch1 &lt;- ch2matrix(raw)                 # character vector
cbind(raw, ch1)
ch &lt;- ch2matrix(factor(raw))          # factor
all(ch == ch1)
ch &lt;- ch2matrix(as.numeric(raw))      # numeric
all(ch == ch1)
ch &lt;- ch2matrix(matrix(raw, ncol=1))  # 1 column matrix
all(ch == ch1)
ch &lt;- ch2matrix(data.frame(raw=raw))  # 1 column data frame
all(ch == ch1)

# Error messages:
try(ch2matrix(matrix(rep(raw, 2), ncol=2)))     # 2 column matrix -&gt; error
try(ch2matrix(data.frame(raw=raw, dummy=raw)))  # 2 column data frame -&gt; error

raw[2] &lt;- "11000"          # wrong length
try(ch2matrix(raw))        # error
ch2matrix(as.numeric(raw)) # this works, leading zeros not expected.
</code></pre>

<hr>
<h2 id='cormorant'>
Data from three Danish cormorant breeding colonies, 1991-2004
</h2><span id='topic+cormorant'></span>

<h3>Description</h3>

<p>The data were collected during 14 years from 1991 to 2004 at the three Danish cormorant breeding colonies located in the southwestern Kattegat in the inner Danish waters: Vorsø (labelled V), Mågeøerne (M) and Stavns Fjord (S).
</p>
<p>Counts:  The number of occupied nests in each colony was counted each year in early May.
</p>
<p>Resightings: In all colonies, a large number of nestlings were marked with a standard metal ring on one leg and an alphanumeric colored plastic ring on the other leg; in total 12,659 individuals were marked. Resightings of marked individuals at the breeding colonies by trained field workers from towers, hides or from the ground using a telescope were recorded. Resightings were restricted to breeding individuals. Some individuals appear for the first time in the data set as breeders, having been marked as nestlings prior to 1991.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(cormorant)</code></pre>


<h3>Format</h3>

<p><code>cormorant</code> is a list with 2 components:
</p>

<dl>
<dt>count </dt><dd><p>matrix of counts of active nests in 3 breeding colonies x 14 years.</p>
</dd>
<dt>ms.ch </dt><dd><p>a multistate capture history matrix for 12,659 birds x 14 years. The state codes 1-3 index nestlings in colonies V, M and S, respectively, and the state codes 4-6 do the same for the breeders.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Thomas Bregnballe</p>


<h3>References</h3>

<p>Borysiewicz, R. S., Morgan, B. J. T., Hénaux, V., Bregnballe, T., Lebreton, J. D., Gimenez, O. (2009) An integrated analysis of multisite recruitment, mark-recapture-recovery and multisite census data. Pages 579-591 in D. Thomson, E. Cooch and M. Conroy, editors. <em>Modeling demographic processes in marked populations</em>. Springer, New York.
</p>
<p>McCrea, R. S., Morgan, B. J. T., Gimenez, O., Besbeas, P., Bregnballe, T., Hénaux, V., Lebreton, J. D. (2010) Multi-site integrated population modelling. <em>JABES</em> 15, 539-561.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 18.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cormorant)
str(cormorant)
</code></pre>

<hr>
<h2 id='createAge'>
Creates an age matrix
</h2><span id='topic+createAge'></span>

<h3>Description</h3>

<p>Creates an animals x intervals matrix which gives the age class for each individual at the beginning of each interval, based on the occasion of first capture and the age at first capture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createAge(f, age, nyears, mAge=2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createAge_+3A_f">f</code></td>
<td>

<p>a vector of first capture occasions.
</p>
</td></tr>
<tr><td><code id="createAge_+3A_age">age</code></td>
<td>

<p>a corresponding vector with the age at first capture of each animal.
</p>
</td></tr>
<tr><td><code id="createAge_+3A_nyears">nyears</code></td>
<td>

<p>the number of years of the study; the number of intervals is <code>nyears - 1</code>.
</p>
</td></tr>
<tr><td><code id="createAge_+3A_mage">mAge</code></td>
<td>

<p>the maximum age class; age is incremented by 1 each year up to <code>mAge</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An individuals x intervals matrix with the age of each individual at the beginning of each interval. Cells prior to the first capture are filled with NAs.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Adademic Press, section 4.5.1.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat5)
f &lt;- getFirst(woodchat5$ch)
# Remove animals first captured on the last occasion
last &lt;- which(f==ncol(woodchat5$ch))
f &lt;- f[-last]
age &lt;- woodchat5$age[-last]

x &lt;- createAge(f, age, 20, 2)
head(x)
x[115:120,]
tail(x)
</code></pre>

<hr>
<h2 id='demoMCMC'>
Demonstration of a random-walk sampler for a single parameter
</h2><span id='topic+demoMCMC'></span>

<h3>Description</h3>

<p>Generates an MCMC chain for the probability of success on the logit scale, <code>ltheta = logit(theta)</code>, for binomial data with y successes in N trials. The prior for <code>ltheta</code> is a Normal distribution with mean <code>mu.ltheta</code> and SD <code>sd.ltheta</code>. Proposal values are drawn from a Normal distribution with mean = current value and SD = prop.sd.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>demoMCMC(y = 20, N = 50, niter = 25000, mu.ltheta = 0, sd.ltheta = 100,
    prop.sd = 1, init = 0, quiet = FALSE, show.plots = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="demoMCMC_+3A_y">y</code></td>
<td>

<p>number of successes.
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_n">N</code></td>
<td>

<p>number of trials.
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_niter">niter</code></td>
<td>

<p>the number of MCMC draws required.
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_mu.ltheta">mu.ltheta</code></td>
<td>

<p>the mean of the Normal prior distribution for logit(theta).
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_sd.ltheta">sd.ltheta</code></td>
<td>

<p>the SD of the Normal prior distribution for logit(theta).
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_prop.sd">prop.sd</code></td>
<td>

<p>the SD of the Normal distribution for the proposals.
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_init">init</code></td>
<td>

<p>initial value for logit(theta).
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_quiet">quiet</code></td>
<td>

<p>if TRUE, console output is suppressed.
</p>
</td></tr>
<tr><td><code id="demoMCMC_+3A_show.plots">show.plots</code></td>
<td>

<p>if FALSE, plotting is suppressed.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the values of the input arguments and the following additional elements:
</p>
<table>
<tr><td><code>ltheta</code></td>
<td>
<p>a vector with the MCMC draws.</p>
</td></tr>
<tr><td><code>acc.prob</code></td>
<td>
<p>the proportion of proposed values accepted.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Adapted from code in Ntzoufras (2009), p. 48.
</p>


<h3>References</h3>

<p>Ntzoufras, I. (2009) <em>Bayesian Modeling Using WinBUGS</em>, Wiley, Hoboken NJ.
</p>
<p>Schaub, M., Kéry, M. (2022), <em>Integrated Population Models</em>, Academic Press, section 2.5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>require(graphics)
# Default settings
str(tmp &lt;- demoMCMC(y = 20, N = 50, niter = 25000,
  mu.ltheta = 0, sd.ltheta = 100, prop.sd = 1, init = 0))

# Show convergence
str(tmp &lt;- demoMCMC(prop.sd = 0.1, init = 10))

# Show convergence: no convergence
str(tmp &lt;- demoMCMC(prop.sd = 0.1, init = 100))

# Very, very small step size: very inefficient
str(tmp &lt;- demoMCMC(prop.sd = 0.01))

# Very small step size: inefficient
str(tmp &lt;- demoMCMC(prop.sd = 0.1))

# Default step size: pretty good for this case
str(tmp &lt;- demoMCMC(prop.sd = 1))

# Larger than default step size: efficiency goes down again
str(tmp &lt;- demoMCMC(prop.sd = 10))

# Muuuuch larger ..... brrrrr !
str(tmp &lt;- demoMCMC(prop.sd = 100))
</code></pre>

<hr>
<h2 id='Discrete+20uniform'>
Discrete uniform prior distribution
</h2><span id='topic+dUnif'></span>

<h3>Description</h3>

<p><code>dUnif</code> creates a vector or matrix to be used with the categorical distribution, <code>dcat</code>, in JAGS to generate a discrete uniform prior.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dUnif(lower, upper)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Discrete+2B20uniform_+3A_lower">lower</code>, <code id="Discrete+2B20uniform_+3A_upper">upper</code></td>
<td>

<p>Range of the discrete uniform prior. Either scalars, or vectors of the same length. Values are rounded to integers.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the arguments are scalar, a vector of length equal to <code>upper</code>, with the first <code>lower - 1</code> elements filled with zeros and remainder holding a constant value such that the vector sums to 1.
</p>
<p>Otherwise a matrix with each row constructed as above: the columns from <code>lower</code> to <code>upper</code> have a constant value, other columns hold zeros. See the examples.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub, Marc Kéry, Mike Meredith
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 5.4.4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Both arguments scalar, vector output
(p &lt;-  dUnif(lower = 4, upper = 8))
#  0.0 0.0 0.0 0.2 0.2 0.2 0.2 0.2
sum(p)
# Non-integer arguments are rounded
(p &lt;- dUnif(lower = 3.8, upper = 8.2))  # same as above

# Vector arguments, matrix output
(p &lt;- dUnif(lower = c(4, 2, 5), upper = c(8,11,6)))
# [1,]    0  0.0  0.0  0.2  0.2  0.2  0.2  0.2  0.0   0.0   0.0
# [2,]    0  0.1  0.1  0.1  0.1  0.1  0.1  0.1  0.1   0.1   0.1
# [3,]    0  0.0  0.0  0.0  0.5  0.5  0.0  0.0  0.0   0.0   0.0
rowSums(p) # all 1
</code></pre>

<hr>
<h2 id='elk'>
Data from an elk population in USA, 1988-1993
</h2><span id='topic+elk'></span>

<h3>Description</h3>

<p>All three data sets from an elk (<em>Cervus canadensis</em>) population are from Northern Idaho, 1988 to 1993, and include only females, i.e., the elk cows.
</p>
<p>The age-at-harvest data summarize the number of elk cows harvested and reported in each year stratified by age. All animals reported are sexed and aged based on tooth inspection, discarding records of elk older than 18 years. Not all hunted animals are reported.
</p>
<p>The reporting rate was assessed by a telephone survey of registered hunters, recording in each year the number who said they had killed an elk cow and the number of hunters interviewed.
</p>
<p>Some elk cows were radio-tracked each year, and for these we have data for survival, hunting mortality and other mortality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(elk)</code></pre>


<h3>Format</h3>

<p><code>elk</code> is a list with 3 matrices:
</p>

<dl>
<dt>C </dt><dd><p>age-at-harvest data from cow elk, 17 age classes x 6 years.</p>
</dd>
<dt>H </dt><dd><p>hunter survey results, 2 rows x 6 years.</p>
</dd>
<dt>R </dt><dd><p>data for radio-tagged elk, 3 categories x 6 years.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Idaho Department of Fish and Game, see Gove et al. (2002)</p>


<h3>References</h3>

<p>Gove, N. E., Skalski, J. R., Zager, P., Townsend, R. L. (2002) Statistical models for population reconstruction using age-at-harvest data. <em>Journal of Wildlife Management</em> 66, 310-320.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 17.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(elk)
str(elk)
</code></pre>

<hr>
<h2 id='Fix+20matrices'> Quick and dirty specification of matrices </h2><span id='topic+fixAmatrix'></span><span id='topic+abbreviated'></span>

<h3>Description</h3>

<p>Many of the arguments to functions in the IPMbook package are in the form of matrices, eg, age classes x time. Entering the full matrix is tedious and difficult to read. In many cases, the parameter will be time-invariant or several age classes will share the same values, when input can be abbreviated.
</p>
<p>If all values are equal, a single value can be entered and all elements of the matrix will be set to this.
</p>
<p>For a time-invariant parameter, a vector can be entered, and this will be plugged in to all columns of the matrix. The vector can be shorter than the number of age classes, when the last value will be replicated for the remaining classes.
</p>
<p>If the parameter varies with time, a matrix must be entered, but it does not need a row for every age class. If the matrix has fewer rows than the number of age classes, the last row will be replicated for the remaining classes.
</p>
<p>In most cases, the full matrix is included in the output of the function: check this to make sure the expansion has worked as expected.
</p>

<hr>
<h2 id='GammaDist'>
The gamma distribution
</h2><span id='topic+GammaDist'></span><span id='topic+dgamma2'></span><span id='topic+pgamma2'></span><span id='topic+qgamma2'></span><span id='topic+rgamma2'></span><span id='topic+getGammaPar'></span>

<h3>Description</h3>

<p>Density, distribution function, quantile function and random number generation for the gamma distribution with parameters <code>mean</code> and <code>sd</code>. These are wrappers for <code>stats::dgamma</code>, etc. <code>getGammaPar</code> returns the shape and rate parameters.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dgamma2(x, mean, sd)
pgamma2(q, mean, sd, lower.tail=TRUE, log.p=FALSE)
qgamma2(p, mean, sd, lower.tail=TRUE, log.p=FALSE)
rgamma2(n, mean, sd)
getGammaPar(mean, sd)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="GammaDist_+3A_x">x</code></td>
<td>

<p>vector of parameter values.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_q">q</code></td>
<td>

<p>vector of quantiles.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_p">p</code></td>
<td>

<p>vector of probabilities.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_n">n</code></td>
<td>

<p>number of random draws required.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_mean">mean</code></td>
<td>

<p>mean of the gamma distribution.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_sd">sd</code></td>
<td>

<p>standard deviation of the gamma distribution.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_lower.tail">lower.tail</code></td>
<td>

<p>logical; if TRUE (default), cumulative probabilities up to x, otherwise, above x.
</p>
</td></tr>
<tr><td><code id="GammaDist_+3A_log.p">log.p</code></td>
<td>

<p>logical; if TRUE, probabilities p are given as log(p).
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>dgamma2</code> gives the density, <code>pgamma2</code> gives the distribution function, <code>qgamma2</code> gives the quantile function, and <code>rgamma2</code> generates random deviates.
</p>
<p><code>getGammaPar</code> returns a 2-column matrix with the shape and rate parameters corresponding to <code>mean</code> and <code>sd</code>. </p>


<h3>Author(s)</h3>

<p>Mike Meredith
</p>


<h3>See Also</h3>

<p>See the <span class="pkg">stats</span> functions <code><a href="stats.html#topic+dgamma">dgamma</a></code>, <code><a href="stats.html#topic+pgamma">pgamma</a></code>, <code><a href="stats.html#topic+qgamma">qgamma</a></code>, <code><a href="stats.html#topic+rgamma">rgamma</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Plot some curves with dgamma2
xx &lt;- seq(0, 20, length.out=101)
plot(xx, dgamma2(xx, 5, 1), xlab="x", ylab="Probability density",
  main="Gamma curves with mean = 5", type='l', lwd=2)
lines(xx, dgamma2(xx, 5, 2), col='darkgreen', lwd=2)
lines(xx, dgamma2(xx, 5, 4), col='red', lwd=2)
lines(xx, dgamma2(xx, 5, 8), col='blue', lwd=2)
abline(v=5, lty=3, lwd=2)
legend('topright', paste("sd =", c(1,2,4,8)), lwd=2,
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# Cumulative plots with pgamma2
plot(xx, pgamma2(xx, 5, 1), xlab="x", ylab="Cumulative probability",
  main="Gamma curves with mean = 5", type='l', lwd=2)
lines(xx, pgamma2(xx, 5, 2), col='darkgreen', lwd=2)
lines(xx, pgamma2(xx, 5, 4), col='red', lwd=2)
lines(xx, pgamma2(xx, 5, 8), col='blue', lwd=2)
abline(v=5, lty=3, lwd=2)
legend('bottomright', paste("sd =", c(1,2,4,8)), lwd=2,
  col=c('black', 'darkgreen', 'red', 'blue'), bty='n')

# Generate random draws and plot a histogram
rnd &lt;- rgamma2(1e5, 5, 2)
hist(rnd, freq=FALSE)
# Add the curve:
lines(xx, dgamma2(xx, 5, 2), col='darkgreen', lwd=2)

# Get shape and rate parameters for mean = 5 and sd = c(1,2,4,8)
getGammaPar(mean = 5, sd = c(1,2,4,8))

</code></pre>

<hr>
<h2 id='grouse'>
Data for black grouse from Italy, 1997-2016
</h2><span id='topic+grouse'></span>

<h3>Description</h3>

<p>Data for black grouse (<em>Lyrurus tetrix</em>) from Alpe Devero in the Piemont region of the Alps in Northern Italy from 1997 to 2016.
</p>
<p>The number of displaying cocks was recorded each spring. In late summer, grouse were looked for with the help of pointer dogs and counted. Some grouse were equipped with a radio transmitter and the status of these birds (alive, dead) was regularly recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(grouse)</code></pre>


<h3>Format</h3>

<p><code>grouse</code> is a list with 10 components:
</p>

<dl>
<dt>ch </dt><dd><p>matrix of capture histories for 96 radio-tagged birds x 128 months: 1 if found alive, 0 if found dead, otherwise NA.</p>
</dd>
<dt>age </dt><dd><p>the actual age of each bird: 1 = juvenile, 2 = adult.</p>
</dd>
<dt>sex </dt><dd><p>the sex of each bird: 1 = female, 2 = male.</p>
</dd>
<dt>season </dt><dd><p>the season of the survey: 1 = spring, 2 = summer, 3 = autumn, 4 = winter.</p>
</dd>
<dt>count.sp </dt><dd><p>annual count of displaying males at leks in spring.</p>
</dd>
<dt>count.lsM </dt><dd><p>annual count of flushed adult males in late summer.</p>
</dd>
<dt>count.lsF </dt><dd><p>annual count of flushed adult females in late summer.</p>
</dd>
<dt>count.lsC </dt><dd><p>annual count of flushed chicks in late summer.</p>
</dd>
<dt>v </dt><dd><p>annual total number of chicks in families where chicks could be sexed.</p>
</dd>
<dt>u </dt><dd><p>annual number of female chicks in families where chicks could be sexed.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Luca Rotelli, Radames Bionda</p>


<h3>References</h3>

<p>Rotelli, L., Zbinden, N., Bionda, R., Schaub, M. (in prep.) Chick survival and hunting are important drivers for the dynamics of two Alpine black grouse (<em>Lylurus tetrix</em>) populations. <em>Wildlife Biology</em>.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 15.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(grouse)
str(grouse)
</code></pre>

<hr>
<h2 id='Helper+20functions'>
Various helper functions
</h2><span id='topic+cleanCH'></span><span id='topic+zKnown'></span><span id='topic+zInit'></span><span id='topic+zInitDR'></span><span id='topic+rmFirst'></span><span id='topic+getFirst'></span>

<h3>Description</h3>

<p><code>cleanCH</code> removes histories without any capture (ie, all-zero rows) from a capture-recapture matrix.
</p>
<p><code>rmFirst</code> removes the first capture in each row of a capture history matrix, replacing it with zero.
</p>
<p><code>zKnown</code> takes a capture history and returns a matching matrix with 1 where the individual is know to be alive (ie, between the first and last capture) and NA elsewhere.
</p>
<p><code>zInit</code> takes a capture history and returns a matching matrix with 1 <em>after</em> the occasion of first capture and NA elsewhere.
</p>
<p><code>zInitDR</code> takes a dead-recovery capture history and returns a matching matrix with 1 <em>after</em> the occasion of first capture until the recovery occasion and 0 subsequently; NA elsewhere.
</p>
<p><code>getFirst</code> calculates the occasion of first capture in a capture history matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cleanCH(ch)
zKnown(ch)
zInit(ch)
zInitDR(chDR)
rmFirst(x)
getFirst(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="Helper+2B20functions_+3A_ch">ch</code></td>
<td>

<p>an individuals x time matrix with capture histories.
</p>
</td></tr>
<tr><td><code id="Helper+2B20functions_+3A_chdr">chDR</code></td>
<td>

<p>an individuals x time matrix with dead recovery capture histories: 1 indicates initial capture or dead recovery, 0 otherwise.
</p>
</td></tr>
<tr><td><code id="Helper+2B20functions_+3A_x">x</code></td>
<td>

<p>an individuals x time matrix with capture histories, or a vector of capture/noncapture data, typically 1 row of a capture history.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>cleanCH</code>, <code>zKnown</code>, <code>zInit</code>, <code>zInitDR</code> and <code>rmFirst</code> return the modified capture history matrix.
</p>
<p><code>getFirst</code> returns the occasion of first capture, NA if no capture recorded for an individual.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub, Marc Kéry, Mike Meredith
</p>

<hr>
<h2 id='hoopoe'>
Data for hoopoe from Switzerland, 2002-2017
</h2><span id='topic+hoopoe'></span>

<h3>Description</h3>

<p>The data for the hoopoe (<em>Upupa epops</em>) were collected from 2002 to 2017 in the Swiss Alps (Valais). The nestboxes were checked regularly to record the number of broods and to determine breeding success. Nestlings were ringed and breeding adults captured.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(hoopoe)</code></pre>


<h3>Format</h3>

<p><code>hoopoe</code> is a list with 5 components:
</p>

<dl>
<dt>ch </dt><dd><p>matrix of capture histories for 3,844 female birds x 16 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each female at first capture, 1 = nestling, 2 = at least 1-year old.</p>
</dd>
<dt>count </dt><dd><p>the annual population index (number of breeding pairs recorded).</p>
</dd>
<dt>reproAgg </dt><dd><p>a data frame with annual totals of mothers for which fledglings were recorded (B1 = 1-year-old, B2 = older females) and the corresponding number of fledglings (J1 and J2, respectively).</p>
</dd>
<dt>reproInd </dt><dd><p>a data frame with details of reproduction of individual females: id = mother's ID, f = total annual number of fledglings raised by each mother, including any replacement and second broods, year = year of the record.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute and Institute of Ecology and Evolution (Division of Conservation Biology), University of Bern.</p>


<h3>References</h3>

<p>Arlettaz, R., M. Schaub, J. Fournier, T. S. Reichlin, A. Sierro, J. E. M. Watson, V. Braunisch (2010) From Publications to Public Actions: When Conservation Biologists Bridge the Gap between Research and Implementation. <em>BioScience</em> 60, 835-842.
</p>
<p>Plard, F., R. Arlettaz, A. Jacot, M. Schaub (2020) Disentangling the spatial and temporal causes of decline in a bird population. <em>Ecology and Evolution</em> 10, 6909-6918.
</p>
<p>Schaub, M., T. S. Reichlin, F. Abadi, M. Kéry, L. Jenni, R. Arlettaz (2012) The demographic drivers of local population dynamics in two rare migratory birds. <em>Oecologia</em> 168, 97-108.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 14.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(hoopoe)
str(hoopoe)
</code></pre>

<hr>
<h2 id='kestrel'>
Data for kestrels from Switzerland, 2002-2016
</h2><span id='topic+kestrel'></span>

<h3>Description</h3>

<p>The data sets for kestrels (<em>Falco tinnunculus</em>) were collected between 2002 and 2016 in the north-western quadrant of Switzerland.
</p>
<p>They comprise breeding bird counts from a monitoring program and from the breeding bird atlas, and dead-recoveries of ringed individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(kestrel)</code></pre>


<h3>Format</h3>

<p><code>kestrel</code> is a list with 4 components:
</p>

<dl>
<dt><b>landData </b></dt><dd><p>landscape data, a data frame with rows for 15,734 quadrats (1 x 1km) in the study area and the following columns:
</p>

<ul>
<li><p> x and y : the coordinates of the center of the quadrat.
</p>
</li>
<li><p> elevation : mean elevation of the quadrat (m).
</p>
</li>
<li><p> lakes : proportion of the quadrat covered by water.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>mhbData </b></dt><dd><p>data from Swiss Breeding Bird Monitoring (MHB, Schmid et al., 2004) for 120 quadrats in the study area, a list with the following components:
</p>

<ul>
<li><p> x and y : the coordinates of the center of the quadrat.
</p>
</li>
<li><p> tcount : a quadrats x years matrix, the annual total count of kestrels.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>atlasData </b></dt><dd><p>data from the Swiss atlas survey (Knaus et al., 2018) for 574 atlas quadrats in the study area, a list with the following components:
</p>

<ul>
<li><p> x and y : the coordinates of the center of the quadrat.
</p>
</li>
<li><p> year : the year of the survey, 2013-2015.
</p>
</li>
<li><p> count : a quadrats x surveys matrix, the count of kestrels in the quadrat for up to 3 surveys; quadrats with only 2 surveys have NA in the third column.
</p>
</li></ul>
</dd></dl>


<dl>
<dt><b>drData </b></dt><dd><p>dead-recovery data from a total of 24,561 kestrels ringed at a nest-box in one of 7 ringing areas in the study area (Fay et al., 2019), a list with the following components:
</p>

<ul>
<li><p> site : a matrix with 24,561 rows and columns for site ID and mean x and y coordinates of the nest-boxes at the site.
</p>
</li>
<li><p> deadrecovery : an individual x year (2002-2016) matrix with 1 for the occasions of initial capture and dead recovery, 0 otherwise.
</p>
</li>
<li><p> age : a length 24,561 vector with the age (&quot;juv&quot; or &quot;ad&quot;) of ringing.
</p>
</li></ul>
</dd></dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute</p>


<h3>References</h3>

<p>Fay, R., Michler, S., Laesser, J., Schaub, M. (2019) Integrated population model reveals that kestrels breeding in nest boxes operate as a source population. <em>Ecography</em> 42, 2122-2131.
</p>
<p>Knaus, P., Antoniazza, S., Wechsler, S., Guelat, J., Kéry, M., Strebel, N., Sattler, T. (2018) <em>Schweizer Brutvogelatlas 2013-2016. Verbreitung und Bestandsentwicklung der Vögel in der Schweiz und im Fürstentum Liechtenstein</em>, Sempach.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press. chapter 20.
</p>
<p>Schmid, H., Zbinden, N., Keller, V. (2004) <em>Überwachung der Bestandsentwicklung häufiger Brutvögel in der Schweiz</em>. Schweizerische Vogelwarte, Sempach.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kestrel)
str(kestrel)
</code></pre>

<hr>
<h2 id='marray'>
Converts capture-histories to an m-array for one age class
</h2><span id='topic+marray'></span>

<h3>Description</h3>

<p>Creates an m-array for a single- or multistate capture-recapture data with one age class and optionally more than one group.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marray(ch, unobs = 0, freq = 1, groups = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marray_+3A_ch">ch</code></td>
<td>

<p>an individuals x time matrix with single- or multistate capture histories (0: not captured; 1...X: captured in the 1...X states). See Details.
</p>
</td></tr>
<tr><td><code id="marray_+3A_unobs">unobs</code></td>
<td>

<p>number of unobserved states (default is 0, needs to be given only in specific cases).
</p>
</td></tr>
<tr><td><code id="marray_+3A_freq">freq</code></td>
<td>

<p>a vector with the number of animals with each capture history, or a matrix with a column for each group. If a single value is supplied, it will be used for all rows in the capture history; the default is to assume each row corresponds to a single animal.
</p>
</td></tr>
<tr><td><code id="marray_+3A_groups">groups</code></td>
<td>

<p>a factor (or a vector that can be coerced to a factor) which identifies the group that each row of <code>ch</code> refers to. Ignored if <code>freq</code> is a matrix with &gt; 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>ch</code> can be a matrix of unique capture histories accompanied by a vector or matrix, <code>freq</code>, specifying the number of animals with each capture history. Trap losses can be indicated either by negative values for <code>freq</code>, or by filling the row with NA after the last capture. For other formats, see <code><a href="#topic+ch2matrix">ch2matrix</a></code>.
</p>


<h3>Value</h3>

<p>For single-state capture recapture data, an m-array which is a (years-1) x years x groups array, where element [i, j, g] contains the number of individuals in group g released in year i and recaptured in year j+1 (by definition no recaptures can occur in year 1). If no groups are specified, this will be a (years-1) x years matrix. The last column contains the number of individuals released in year i and never recaptured.
</p>
<p>For multi-state capture-recapture data with s states (including potential unobservable states), an m-array which is a (years-1)*s x (years-1)*2 + 1 x groups array. An element [i, j, g] contains the number of individuals in group g released in year t and state n (i = (t-1)*s + n) and recaptured in year k+1 in state m (j = (k-1)*s + m). If no groups are specified, this will be a matrix. The last column contains the number of individuals released in year t and state s and never recaptured. The labeling of unobserved states starts with the number of observed states + 1.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 4.5.1.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Convert a single state capture history matrix into an m-array
data(woodchat5)
dim(woodchat5$ch)  # 1902 animals x 20 years
ch1 &lt;- cleanCH(woodchat5$ch[, 11:20])  # Use last 10 years only
marray(ch1)

# Convert a multistate capture history into an m-array
data(cormorant)
dim(cormorant$ms.ch) # 12,659 animals x 14 years
ch2 &lt;- cleanCH(cormorant$ms.ch[, 11:14])  # Use last 4 years only
table(ch2) # 6 states
marray(ch2)
</code></pre>

<hr>
<h2 id='marrayAge'>
Creates age-dependent m-arrays
</h2><span id='topic+marrayAge'></span>

<h3>Description</h3>

<p>Converts single-state capture-recapture data to age-dependent m-arrays.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marrayAge(ch, age = 1, mAge = 1, freq = 1, groups = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marrayAge_+3A_ch">ch</code></td>
<td>

<p>an individuals x time matrix with capture histories (0: not captured; 1: captured). See Details.
</p>
</td></tr>
<tr><td><code id="marrayAge_+3A_age">age</code></td>
<td>

<p>vector with the age class at first capture for each individual, or a scalar that will be used for all individuals.
</p>
</td></tr>
<tr><td><code id="marrayAge_+3A_mage">mAge</code></td>
<td>

<p>maximum number of age classes for which m-arrays are constructed; ignored if <code>max(age) &gt; mAge</code>. Only required if the <code>age</code> vector has fewer age classes than we want to separate (e.g. capture histories <code>ch</code> contains only individuals marked as juveniles, and we want 2 age classes).
</p>
</td></tr>
<tr><td><code id="marrayAge_+3A_freq">freq</code></td>
<td>

<p>a vector with the number of animals with each capture history, or a matrix with a column for each group. If a single value is supplied, it will be used for all rows in the capture history; the default is to assume each row corresponds to a single animal.
</p>
</td></tr>
<tr><td><code id="marrayAge_+3A_groups">groups</code></td>
<td>

<p>a factor (or a vector that can be coerced to a factor) which identifies the group that each row of <code>ch</code> refers to. Ignored if <code>freq</code> is a matrix with &gt; 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>ch</code> can be a matrix of unique capture histories accompanied by a vector or matrix, <code>freq</code>, specifying the number of animals with each capture history. Trap losses can be indicated either by negative values for <code>freq</code>, or by filling the row with NA after the last capture. For other formats, see <code><a href="#topic+ch2matrix">ch2matrix</a></code>.
</p>


<h3>Value</h3>

<p>A 4-d array, (years-1) x years x age classes x groups, where element [i, j, k, g] contains the number of individuals in group g of age class k released in year i and recaptured in year j+1 (by definition no recaptures can occur in year 1). If no groups are specified, this will be a 3-d array, (years-1) x years x age classes. The last column contains the number of individuals released in year i and never recaptured.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 4.5.1.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat5)
dim(woodchat5$ch)  # 1902 animals x 20 years
marrayAge(ch=woodchat5$ch, age=woodchat5$age, mAge=2)
</code></pre>

<hr>
<h2 id='marrayDead'>
Converts dead-recovery capture histories to an m-array
</h2><span id='topic+marrayDead'></span>

<h3>Description</h3>

<p>Converts dead-recovery capture histories to an m-array.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>marrayDead(MR, freq = 1, groups = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="marrayDead_+3A_mr">MR</code></td>
<td>

<p>an individuals x time matrix with 1 denoting either the time of marking or the time of recovery; otherwise 0.
</p>
</td></tr>
<tr><td><code id="marrayDead_+3A_freq">freq</code></td>
<td>

<p>a vector with the number of animals with each capture history, or a matrix with a column for each group. If a single value is supplied, it will be used for all rows in the capture history; the default is to assume each row corresponds to a single animal.
</p>
</td></tr>
<tr><td><code id="marrayDead_+3A_groups">groups</code></td>
<td>

<p>a factor (or a vector that can be coerced to a factor) which identifies the group that each row of <code>ch</code> refers to. Ignored if <code>freq</code> is a matrix with &gt; 1 column.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The argument <code>MR</code> can be a matrix of unique capture histories accompanied by a vector or matrix, <code>freq</code>, specifying the number of animals with each capture history. For other formats, see <code><a href="#topic+ch2matrix">ch2matrix</a></code>.
</p>


<h3>Value</h3>

<p>An m-array, a (years-1) x years x groups array, where element [i, j, g] contains the number of individuals in group g marked in year i and recovered in year j+1. The last column contains the number of individuals marked in year i and never recovered. If no groups are specified, this will be a (years-1) x years matrix.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 12.4.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(peregrine)
str(peregrine$recoveries)  # 1810 animals x 43 years
dr &lt;- cleanCH(peregrine$recoveries[, 29:43])  # Use last 15 years of data
marrayDead(dr)
</code></pre>

<hr>
<h2 id='peregrine'>
Data for peregrine falcons from the Jura Mountains, 1965-2007
</h2><span id='topic+peregrine'></span>

<h3>Description</h3>

<p>Data for peregrine falcons (<em>Falco peregrinus</em>) from the Jura Mountains straddling the Franco-Swiss border for 1965 to 2007. We combined data collected by Gaby Banderet and colleagues in Switzerland and René-Jean Monneret, René Ruffinoni and their colleagues in France.
</p>
<p>Data comprise the annual number of breeding pairs, information on productivity and dead-recoveries of marked individuals.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(peregrine)</code></pre>


<h3>Format</h3>

<p><code>peregrine</code> is a list with 3 components:
</p>

<dl>
<dt>count </dt><dd><p>a 2-column matrix with the number of breeding pairs recorded in each year.</p>
</dd>
<dt>productivity </dt><dd><p>a 3-column matrix with the number of broods surveyed and the total number of fledglings for each year.</p>
</dd>
<dt>recoveries </dt><dd><p>an individuals x years matrix, with 1 when an individual was ringed as a nestling and when recovered dead; otherwise 0.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss data from Gabriel Banderet and the Swiss Ornithological Institute. French data from Fonds Sauvegarde Faune Flore Jurassienne - Groupe Pèlerin Jura.</p>


<h3>References</h3>

<p>Kéry, M., Banderet, G., Neuhaus, M., Weggler, M., Schmid, H., Sattler, T., Parish, D. (2018) Population trends of the Peregrine Falcon in Switzerland with special reference to the period 2005-2016. <em>Ornis Hungarica</em> 26, 91-103.
</p>
<p>Monneret, R.-J., Rufinioni, R., Parish, D., Pinaud, D., Kéry, M. (2018) The Peregrine population study in the French Jura mountains 1964-2016: use of occupancy modeling to estimate population size and analyze site persistence and colonization rates. <em>Ornis Hungarica</em> 26, 69-90.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 12.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(peregrine)
str(peregrine)
</code></pre>

<hr>
<h2 id='redbacked'>
Data for red-backed shrike from Germany, 1971-2006
</h2><span id='topic+redbacked'></span>

<h3>Description</h3>

<p>Data for the red-backed shrike (<em>Lanius collurio</em>) were collected from 1971 to 2006 from a study area in southern Germany. They comprise the annual number of breeding pairs, information about productivity from regular checks of nests, and capture-recapture data   of juvenile and adult shrikes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(redbacked)</code></pre>


<h3>Format</h3>

<p><code>redbacked</code> is a list with 5 components:
</p>

<dl>
<dt>marr.a </dt><dd><p>capture histories for females marked as adults in m-array format.</p>
</dd>
<dt>marr.j </dt><dd><p>capture histories for females marked as fledglings in m-array format.</p>
</dd>
<dt>B </dt><dd><p>the number of broods monitored each year.</p>
</dd>
<dt>J </dt><dd><p>the number of fledglings produced each year by the monitored broods.</p>
</dd>
<dt>count </dt><dd><p>the number of active breeding pairs on 15 June each year.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Wolfgang Staube, Hans Jakober
</p>


<h3>References</h3>

<p>Abadi, F., Gimenez, O., Jakober, H., Stauber, W., Arlettaz, R., Schaub, M. (2012) Estimating the strength of density dependence in the presence of observation errors using integrated population models. <em>Ecological Modelling</em> 242, 1-9.
</p>
<p>Schaub, M., Jakober, H., Stauber, W. (2013) Strong contribution of immigration to local population regulation: evidence from a migratory passerine. <em>Ecology</em> 94, 1828-1838.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 8.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(redbacked)
str(redbacked)
</code></pre>

<hr>
<h2 id='simCapHist'>
Simulates capture histories from a population
</h2><span id='topic+simCapHist'></span>

<h3>Description</h3>

<p>Simulates capture histories from a simulated population created by <code>simPop</code>. Capture probabilities may vary among the age classes and with time, and can be different for initial capture vs recapture.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simCapHist(state, cap = c(0.35, 0.4), recap = NULL, maxAge = NULL, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simCapHist_+3A_state">state</code></td>
<td>

<p>an animals x years matrix with the age of each animal in the population (animals born in the current year coded as age = 0), usually the output from <code><a href="#topic+simPop">simPop</a>.</code>
</p>
</td></tr>
<tr><td><code id="simCapHist_+3A_cap">cap</code></td>
<td>

<p>matrix with age- and time-specific probabilities for initial capture; the first row refers to newborns/nestlings.  Input can be <a href="#topic+abbreviated">abbreviated</a>.
</p>
</td></tr>
<tr><td><code id="simCapHist_+3A_recap">recap</code></td>
<td>

<p>matrix with age- and time-specific probabilities probabilities of REcapture: this has 1 less column than <code>cap</code> (no recaptures in the first year) and 1 less row (animals marked in the youngest class will be older when recaptured). Input can be <a href="#topic+abbreviated">abbreviated</a>. If <code>recap = NULL</code>, recapture probabilities will be the same as initial capture probabilities.
</p>
</td></tr>
<tr><td><code id="simCapHist_+3A_maxage">maxAge</code></td>
<td>

<p>maximum number of age classes that can be identified when the individuals are captured for the first time; if NULL, no upper limit is imposed.
</p>
</td></tr>
<tr><td><code id="simCapHist_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, information is displayed in the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments used and the following 2 components:
</p>
<table>
<tr><td><code>ch</code></td>
<td>
<p>matrix with the capture histories.</p>
</td></tr>
<tr><td><code>age</code></td>
<td>
<p>vector with the age class at first capture for each individual; note that animals marked as newborns/nestlings have age = 1, older individuals have ages from 2 to <code>maxAge</code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M.,  Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 5.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated population:
pop &lt;- simPop()
# Simulate capture histories
ch &lt;- simCapHist(pop$state)
str(ch)
ch$cap
ch$recap
ch$age
head(ch$ch)

# Time-varying recapture probabilities, same for all classes:
#  use 1-row matrix
ch &lt;- simCapHist(pop$state, recap=matrix(1:5/10, nrow=1))
ch$recap
</code></pre>

<hr>
<h2 id='simCount'>
Simulates count survey data
</h2><span id='topic+simCount'></span><span id='topic+simCountBin'></span><span id='topic+simCountNorm'></span><span id='topic+simCountPois'></span>

<h3>Description</h3>

<p>Simulates count survey data assuming a binomial, normal, or Poisson sampling process. For the last two, it is assumed that individuals may be double counted and missed at the same rate.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simCountBin(N, pDetect)
simCountNorm(N, sigma)
simCountPois(N)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simCount_+3A_n">N</code></td>
<td>

<p>annual number of individuals at risk of detection, which may be all adults or just those breeding. The length of the vector determines the number of sampling occasions.
</p>
</td></tr>
<tr><td><code id="simCount_+3A_pdetect">pDetect</code></td>
<td>

<p>vector with the annual detection probabilities of the individuals at risk of counting; all individuals have the same probability to be counted; a scalar can be used if probability does not change with time.
</p>
</td></tr>
<tr><td><code id="simCount_+3A_sigma">sigma</code></td>
<td>

<p>vector with the annual observation error (SD); a scalar can be used if error does not change with time.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the parameters entered and <code>count</code> with the number of individuals counted in each year.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 5.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a simulated population:
pop &lt;- simPop()
pop$breeders
# Simulate count data of breeders or of adults
simCountBin(pop$totBreeders, p=0.6)
simCountNorm(pop$totBreeders, sigma=10)
simCountPois(pop$totAdults)
</code></pre>

<hr>
<h2 id='simMHB'>
Simulates detection and count data with spatial and temporal replication
</h2><span id='topic+simMHB'></span>

<h3>Description</h3>

<p>Function simulates MHB (Monitoring häufige Brutvögel) lookalike data. MHB is the Swiss breeding bird survey that is the source of many classic data sets (e.g. Kéry &amp; Royle, 2016, 2021). This survey was launched in 1999 and for a total of 267 1km2 quadrats laid out in an approximate grid over Switzerland. 2 or 3 surveys are conducted in each breeding season (mid-April to early July) on a quadrat-specific, constant route averaging 4-6 km and all birds detected are mapped, thus yielding replicated counts of unmarked individuals.
</p>
<p>The data are simulated under the assumptions of a binomial N-mixture model where for <code>lambda</code> we can specify a log-linear trend over the years and we can account for site-level random effects in both the intercept and the slopes of the log-linear model.
</p>
<p>For detection probability we have currently a constant average or a logit-linear trend over the years, with no further heterogeneity.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simMHB(nsites = 267, nsurveys = 3, nyears = 25,
    mean.lam = 1, mean.beta = 0.03, sd.lam = c(0.5, 0.05),
    mean.p = 0.6, beta.p = 0.1,
    show.plot = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simMHB_+3A_nsites">nsites</code></td>
<td>

<p>number of sites included in the survey.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_nsurveys">nsurveys</code></td>
<td>

<p>number of replicate surveys at each site in each year.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_nyears">nyears</code></td>
<td>

<p>number of years.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_mean.lam">mean.lam</code></td>
<td>

<p>intercept of expected abundance.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_mean.beta">mean.beta</code></td>
<td>

<p>average slope of log(lambda) on year.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_sd.lam">sd.lam</code></td>
<td>

<p>a length 2 vector, the SDs of the Normal distribution from which random site effects for the intercept and the slope in the log-linear model for lambda are drawn randomly.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_mean.p">mean.p</code></td>
<td>

<p>value of constant detection probability per survey (or intercept of the logit-linear model for p).
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_beta.p">beta.p</code></td>
<td>

<p>slope of the logit(p) in year.
</p>
</td></tr>
<tr><td><code id="simMHB_+3A_show.plot">show.plot</code></td>
<td>

<p>if TRUE, the output will be displayed graphically.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the arguments used and the following components:
</p>
<table>
<tr><td><code>alpha</code></td>
<td>
<p>vector with intercept used for the log-linear model for lambda for each site.</p>
</td></tr>
<tr><td><code>beta</code></td>
<td>
<p>vector with slope used for the log-linear model for lambda for each site.</p>
</td></tr>
<tr><td><code>lam</code></td>
<td>
<p>sites x years matrix with the expected number of animals at each site.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>sites x years matrix  with the realized number of animals at each site.</p>
</td></tr>
<tr><td><code>totalN</code></td>
<td>
<p>vector with the total number of animals in each year.</p>
</td></tr>
<tr><td><code>p</code></td>
<td>
<p>vector with the probability of detection in each year.</p>
</td></tr>
<tr><td><code>C</code></td>
<td>
<p>sites x surveys x years array with the counts of animals detected.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Marc Kéry
</p>


<h3>References</h3>

<p>Kéry, M., Royle, A. (2016) <em>Applied Hierarchical Modeling in Ecology</em> Vol 1, Academic Press.
</p>
<p>Kéry, M., Royle, A. (2021) <em>Applied Hierarchical Modeling in Ecology</em> Vol 2, Academic Press.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 4.3.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Explicit default values for all function arguments
str(dat &lt;- simMHB(nsites=267, nsurveys=3, nyears=25, mean.lam=1,
    mean.beta=0.03, sd.lam=c(0.5, 0.05), mean.p=0.6, beta.p=0.1,
    show.plot=TRUE))
str(dat &lt;- simMHB())                # Same, implicit
str(dat &lt;- simMHB(nsites=1000))     # More sites
str(dat &lt;- simMHB(nsurveys=10))     # More surveys
str(dat &lt;- simMHB(nyears=50))       # More years
str(dat &lt;- simMHB(mean.lam=5))      # Higher mean abundance
str(dat &lt;- simMHB(mean.beta=-0.03)) # Population declines
str(dat &lt;- simMHB(sd.lam=c(0, 0)))  # No site variability in lambda
str(dat &lt;- simMHB(mean.p=1))        # Perfect detection
str(dat &lt;- simMHB(mean.p=0.6, beta.p=0)) # Constant p = 0.6
str(dat &lt;- simMHB(mean.p=0.6, beta.p=-0.2)) # Declining p
str(dat &lt;- simMHB(show.plot=FALSE)) # No plots (when used in simulations)
</code></pre>

<hr>
<h2 id='simPop'>
Simulates a population based on demographic parameters
</h2><span id='topic+simPop'></span>

<h3>Description</h3>

<p>The simulation tracks individual females from birth through a series of adult age classes to death, as well as numbers of female and male offspring. The function allows for 1 or more age classes. Once an animal reaches the oldest age class, age does not increase further until death.
</p>
<p>The user specifies the number of females in each age class at the beginning of the simulation, before the first breeding season. Adult females can enter the population as immigrants; the age of immigrants is controlled by <code>ageOfImm</code>.
</p>
<p>Fecundity (the total number of offspring per adult female per year) can vary by age class and year in an age x year matrix. The sex ratio determines the proportion of females among the offspring.
</p>
<p>In some age classes, not all animals may attempt to breed, and the probability of breeding can be specified.
</p>
<p>Probability of survival can also vary by age class and year. The first row of the survival matrix specifies the survival of the animals born in each year and the remaining rows control survival for the respective older age classes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simPop(Ni = c(10, 10), phi = c(0.3, 0.55), f = 3.2, nYears = 6, pBreed = 1,
  sex.ratio = 0.5, Im = 0, ageOfIm = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simPop_+3A_ni">Ni</code></td>
<td>

<p>vector with number of females of each adult age class in the population prior to breeding in the first year. The length of this vector determines the number of age classes. The first age class refers to the individuals born the previous year.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_phi">phi</code></td>
<td>

<p>survival probabilities for new-borns and each age class for each interval between surveys: a (age classes + 1) x (years - 1) matrix. Input can be <a href="#topic+abbreviated">abbreviated</a>.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_f">f</code></td>
<td>

<p>fecundity rates, the number of offspring (male + female) per female in the population, for each adult age class and each year: an age classes x years matrix. Input can be <a href="#topic+abbreviated">abbreviated</a>.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_nyears">nYears</code></td>
<td>

<p>number of years the population is simulated.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_pbreed">pBreed</code></td>
<td>

<p>the probability that a female will attempt to breed for each adult age class and each year: an age classes x years matrix. Input can be <a href="#topic+abbreviated">abbreviated</a>.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_sex.ratio">sex.ratio</code></td>
<td>

<p>sex ratio (probability that a new-born is a female) in each year: either scalar or a vector of length <code>nYears</code>.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_im">Im</code></td>
<td>

<p>number of female immigrants in each year: either scalar or a vector of length <code>nYears</code>.
</p>
</td></tr>
<tr><td><code id="simPop_+3A_ageofim">ageOfIm</code></td>
<td>

<p>the age class of immigrants in each year: either scalar or a vector of length <code>nYears</code>.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the simulation settings and the following components:
</p>
<table>
<tr><td><code>state</code></td>
<td>
<p>an individuals x years matrix, with the state of each individual in each year. States are coded: -1 = died, 0 = newborn, 1,2,... = 1-Year, 2-Year,...</p>
</td></tr>
<tr><td><code>imYear</code></td>
<td>
<p>a vector with the year of immigration for each individual, or NA if not an immigrant.</p>
</td></tr>
<tr><td><code>reprod</code></td>
<td>
<p>an individuals x years x 3 array with the number of female and male offspring and the age of the mother for each individual; NAs indicate individuals not alive or alive but not attempting to breeding.</p>
</td></tr>
<tr><td><code>N</code></td>
<td>
<p>a matrix with a column for each year and rows for numbers surviving in each age class, total adults, number of females born and total births, number of immigrants. (Immigrants are included in the age classes at the top of the table.)</p>
</td></tr>
<tr><td><code>breeders</code></td>
<td>
<p>a matrix with a column for each year and rows for numbers breeding in each age class and total breeders. Note that all animals attempting to breed are classified as breeders, even though no offspring may be produced.</p>
</td></tr>
<tr><td><code>totAdults</code></td>
<td>
<p>a vector with total adults in each year.</p>
</td></tr>
<tr><td><code>totBreeders</code></td>
<td>
<p>a vector with total breeders in each year.</p>
</td></tr>
</table>
<p>The last two are the same as the relevant rows in <code>N</code> and <code>breeders</code>, repeated for ease of extraction with <code>$</code>.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 5.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Simulate a population with the default arguments:
str(pop &lt;- simPop())
pop$N
# Try View, but not available on all platforms
# View(pop$state)
pop$phi
pop$f
pop$reprod[1:5,,]

# Just one (adult) age group:
str(pop &lt;- simPop(Ni=20))
pop$N
pop$phi
pop$f

# Using matrices for time-dependent survival, fecundity
phi &lt;- matrix(c(
  0.3, 0.5, 0.5, 0.2, 0.2,  # newborns
  0.5, 0.7, 0.7, 0.4, 0.4), # adults
  nrow=2, byrow=TRUE)
f &lt;- matrix(c(3, 4, 5, 2, 2, 3), nrow=1)
str(pop &lt;- simPop(phi=phi, f=f))
pop$phi
pop$f    # Matrices expanded to all adult age classes
pop$N

# With immigration
str(pop &lt;- simPop(Im=5))
pop$N
# with ageOfIm = 1 (default) immigrants are included in 1-Year figures.

# Not all 1-Years attempt to breed, and fecundity is lower
str(pop &lt;- simPop(f = c(2, 3.2), pBreed = c(0.7, 1)))
pop$f
pop$pBreed
# Note the difference between numbers of breeders and adults among 1-Years
pop$breeders
pop$N

# Extinction
set.seed(1)
str(pop &lt;- simPop(f = 0.1, phi = c(0.1, 0.2)))
pop$N

# Sink population, rescued by immigration
set.seed(1)
str(pop &lt;- simPop(f = 0.1, phi = c(0.1, 0.2), Im=5))
pop$N
</code></pre>

<hr>
<h2 id='simProd'>
Simulates productivity data
</h2><span id='topic+simProd'></span>

<h3>Description</h3>

<p>Simulates a survey of breeding females, where a proportion of the females are included each year and the number of their offspring (male and female) recorded.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>simProd(reprod, pInclude = 0.3, females.only = FALSE, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simProd_+3A_reprod">reprod</code></td>
<td>

<p>array with the reproductive performance of the population, usually the output from <code><a href="#topic+simPop">simPop</a>.</code>
</p>
</td></tr>
<tr><td><code id="simProd_+3A_pinclude">pInclude</code></td>
<td>

<p>vector with the annual detection probabilities of broods; it can be scalar, used for all years.
</p>
</td></tr>
<tr><td><code id="simProd_+3A_females.only">females.only</code></td>
<td>

<p>if TRUE only the number of females that are produced is recorded. Default: total reproduction is recorded.
</p>
</td></tr>
<tr><td><code id="simProd_+3A_verbose">verbose</code></td>
<td>

<p>if TRUE, information is displayed in the console.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with the following 2 components:
</p>
<table>
<tr><td><code>prod.ind</code></td>
<td>
<p>matrix with the individual reproductive output. The three columns give the output, the year of the brood and the actual age of the mother.</p>
</td></tr>
<tr><td><code>prod.agg</code></td>
<td>
<p>matrix with the same data, but aggregated. The two columns give the year-specific total number of newborn and the year-specific number of surveyed broods.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 5.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Generate a population
pop &lt;- simPop()
# Simulate productivity data
prod &lt;- simProd(pop$reprod)
str(prod)
</code></pre>

<hr>
<h2 id='stork'>
Data on marked white storks in Germany, 1986-2001
</h2><span id='topic+stork'></span>

<h3>Description</h3>

<p>Data for white stork (<em>Ciconia ciconia</em>) during 16 years (1986-2001) in eastern Germany. Chicks were ringed and adults resighted when they raised a brood in the study area. Nineteen ringed storks were recovered dead. The data set only includes birds resighted at least once as &gt; 2 year olds.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(stork)</code></pre>


<h3>Format</h3>

<p><code>stork</code> is a matrix with rows for 691 marked birds and columns for the years 1986 to 2001. 1 indicates ringing or resighting, 2 a dead recovery, otherwise 0.
</p>


<h3>Source</h3>

<p>Vogelwarte Hiddensee, Germany</p>


<h3>References</h3>

<p>Schaub, M., Kania, W., Köppen, U. (2005) Variation of primary production during winter induces synchrony in survival rates in migratory white storks <em>Ciconia ciconia</em>. <em>Journal of Animal Ecology</em> 74, 656-666.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 4.5.4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(stork)
str(stork)
</code></pre>

<hr>
<h2 id='summaryPop'>
Calculates summary statistics from a subset of a population
</h2><span id='topic+summaryPop'></span>

<h3>Description</h3>

<p>Calculates summary statistics from a subset of a population; used if a count survey is to be simulated with a subset of the complete population.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summaryPop(state, subset)

</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summaryPop_+3A_state">state</code></td>
<td>

<p>individuals x years matrix for the population with ages of adult individuals plus newborns (coded 0) and died (-1), usually the output from <code><a href="#topic+simPop">simPop</a></code>.
</p>
</td></tr>
<tr><td><code id="summaryPop_+3A_subset">subset</code></td>
<td>

<p>vector with the indices of the individuals that are to be included for the summary statistics; if missing, all individuals are included.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix with the numbers in each adult age class for each year, total adults, and number  of female juveniles.
</p>


<h3>Author(s)</h3>

<p>Michael Schaub
</p>


<h3>Examples</h3>

<pre><code class='language-R'>pop &lt;- simPop()
summaryPop(pop$state) # default is to include all, compare with
pop$N

# define a subset of 80 drawn at random
sset &lt;- sample(nrow(pop$state), 80)
summaryPop(pop$state, subset=sset)
</code></pre>

<hr>
<h2 id='swallow'>
Data for barn swallows in Switzerland, 1997-2003
</h2><span id='topic+swallow'></span>

<h3>Description</h3>

<p>Demographic data of barn swallows (<em>Hirundo rustica</em>) were collected from nine sites in Switzerland that were between 19 and 224 km apart from 1997 to 2003.
</p>
<p>Each year the number of breeding pairs and detailed information about productivity from regular checks of the nests were recorded. Nestlings were ringed and adults captured, resulting in capture-recapture data. Not all sites were surveyed every year, resulting in NAs in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(swallow)</code></pre>


<h3>Format</h3>

<p><code>swallow</code> is a list with 5 components:
</p>

<dl>
<dt>marr.j </dt><dd><p>an array with capture-recapture data for juvenile females in m-array format, sites x release year x recapture year.</p>
</dd>
<dt>marr.a </dt><dd><p>an array with capture-recapture data for adult females in m-array format, sites x release year x recapture year.</p>
</dd>
<dt>counts </dt><dd><p>a matrix with annual number of breeding pairs observed at each site, sites x years.</p>
</dd>
<dt>productivity </dt><dd><p>an array with productivity variables for monitored broods, brood type (first or second) x sites x years x variable; the variables are total number of eggs and fledglings in monitored broods and the number of broods monitored.</p>
</dd>
<dt>second </dt><dd><p>an array with the number of first broods and second broods observed, sites x years x brood type.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute</p>


<h3>References</h3>

<p>Schaub, M., von Hirschheydt, J., Grüebler, M.U. (2015) Differential contribution of demographic rate synchrony to population synchrony in barn swallows. <em>Journal of Animal Ecology</em> 84, 1530-1541.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 16.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(swallow)
str(swallow)
</code></pre>

<hr>
<h2 id='woodchat10'>
Simulated data for woodchat shrike for use in chapter 10
</h2><span id='topic+woodchat10'></span>

<h3>Description</h3>

<p>Demographic parameters based on the woodchat shrike are introduced in Schaub &amp; Kéry (2021) section 3.2 and details of the simulation are given in section 5.5. This data set has simulated data for use in chapter 10.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat10)</code></pre>


<h3>Format</h3>

<p><code>woodchat10</code> is a list with 4 components:
</p>

<dl>
<dt>marr.a </dt><dd><p>capture histories for females marked as adults in m-array format.</p>
</dd>
<dt>marr.j </dt><dd><p>capture histories for females marked as fledglings in m-array format.</p>
</dd>
<dt>B </dt><dd><p> number of broods monitored each year.</p>
</dd>
<dt>J </dt><dd><p> number of fledglings produced by the monitored broods.</p>
</dd>
<dt>count </dt><dd><p> number of breeding pairs recorded in each year.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 10.5.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat10)
str(woodchat10)
</code></pre>

<hr>
<h2 id='woodchat11'>
Data for woodchat shrike from Germany, 1964-1992
</h2><span id='topic+woodchat11'></span>

<h3>Description</h3>

<p>Real data for the woodchat shrike (<em>Lanius senator</em>) were collected from 1964 to 1992 from a study area in southern Germany.
</p>
<p>They comprise the annual number of breeding pairs, information about productivity from regular checks of nests, and capture, ringing and resighting of juvenile and adult shrikes. In some years, no resighting data were collected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat11)</code></pre>


<h3>Format</h3>

<p><code>woodchat11</code> is a list with 6 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 1079 individuals (males and females) x 29 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture, 1 = nestling (juvenile), 2 = at least 1 year old (adult).</p>
</dd>
<dt>count </dt><dd><p>the annual number of breeding pairs found in the study area.</p>
</dd>
<dt>f </dt><dd><p>the number fledglings (male or female) produced by 365 broods monitored.</p>
</dd>
<dt>d </dt><dd><p>d = 0 if <code>f</code> is an accurate count, d = 1 if it is a lower bound.</p>
</dd>
<dt>year </dt><dd><p>the year the brood was monitored.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Bruno Ullrich
</p>


<h3>References</h3>

<p>Ullrich, B. (2017) Entdeckung und Aussterben einer Population des Rotkopfwürgers <em>Lanius senator</em> in den Streuobstwiesen des Mittleren Albvorlandes, Landkreise Göppingen und Esslingen am Neckar. <em>Ökologie der Vögel</em> 35, 273-335.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 11.4.
</p>
<p>Schaub, M., B. Ullrich (2021) A drop in immigration results in the extinction of a local woodchat shrike population. <em>Animal Conservation</em> 24, accepted &lt;https://doi.org/10.1111/acv.12639&gt;
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat11)
str(woodchat11)
</code></pre>

<hr>
<h2 id='woodchat5'>
Simulated data for woodchat shrike for use in chapter 5
</h2><span id='topic+woodchat5'></span>

<h3>Description</h3>

<p>Demographic parameters based on the woodchat shrike are introduced in Schaub &amp; Kéry (2021) section 3.2 and details of the simulation are given in section 5.5. This data set has simulated data for use in chapter 5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat5)</code></pre>


<h3>Format</h3>

<p><code>woodchat5</code> is a list with 4 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 1902 females x 20 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture: 1 = juvenile, 2 = at least 1 year old (adult).</p>
</dd>
<dt>repro </dt><dd><p>reproduction information for 929 monitored nests: Reproduction = total number of fledglings (male + female), Year = year monitored, Age of mother = 1 = 1 year old, 2 = at least 2 years old.</p>
</dd>
<dt>count </dt><dd><p>total number of breeding pairs observed in each year.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, chapter 5.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat5)
str(woodchat5)
</code></pre>

<hr>
<h2 id='woodchat6'>
Simulated data for woodchat shrike for use in section 6.3
</h2><span id='topic+woodchat6'></span>

<h3>Description</h3>

<p>Demographic parameters based on the woodchat shrike are introduced in Schaub &amp; Kéry (2021) section 3.2 and details of the simulation are given in section 5.5. This data set has simulated data for use in section 6.3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat6)</code></pre>


<h3>Format</h3>

<p><code>woodchat6</code> is a list with 6 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 947 females x 10 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture: 1 = juvenile, 2 = at least 1 year old (adult).</p>
</dd>
<dt>count </dt><dd><p>number of breeding pairs recorded in each year.</p>
</dd>
<dt>J </dt><dd><p>annual number of juveniles (fledglings) per year.</p>
</dd>
<dt>B </dt><dd><p>annual number of broods surveyed from which the fledglings counts are obtained.</p>
</dd>
<dt>f </dt><dd><p>number of fledglings per monitored nest.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 6.3.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat6)
str(woodchat6)
</code></pre>

<hr>
<h2 id='woodchat64'>
Simulated data for woodchat shrike for use in section 6.4
</h2><span id='topic+woodchat64'></span>

<h3>Description</h3>

<p>Demographic parameters based on the woodchat shrike are introduced in Schaub &amp; Kéry (2021) section 3.2 and details of the simulation are given in section 5.5. This data set has simulated data for use in section 6.4.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat64)</code></pre>


<h3>Format</h3>

<p><code>woodchat64</code> is a list with 6 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 947 females x 10 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture: 1 = juvenile, 2 = at least 1 year old (adult).</p>
</dd>
<dt>count </dt><dd><p>number of breeding pairs recorded in each year.</p>
</dd>
<dt>J </dt><dd><p>annual number of juveniles (fledglings) per year.</p>
</dd>
<dt>B </dt><dd><p>annual number of broods surveyed from which the fledglings counts are obtained.</p>
</dd>
<dt>trueN </dt><dd><p>true number of breeding pairs (known because it is a simulated data set).</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 6.4.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat64)
str(woodchat64)
</code></pre>

<hr>
<h2 id='woodchat66'>
Simulated data for woodchat shrike for use in section 6.6
</h2><span id='topic+woodchat66'></span>

<h3>Description</h3>

<p>Demographic parameters based on the woodchat shrike are introduced in Schaub &amp; Kéry (2021) section 3.2 and details of the simulation are given in section 5.5. This data set has simulated data for use in section 6.6.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat66)</code></pre>


<h3>Format</h3>

<p><code>woodchat66</code> is a list with 5 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 947 females x 10 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture: 1 = juvenile, 2 = at least 1 year old (adult).</p>
</dd>
<dt>count </dt><dd><p>number of breeding pairs recorded in each year.</p>
</dd>
<dt>J </dt><dd><p>annual number of juveniles (fledglings) per year.</p>
</dd>
<dt>B </dt><dd><p>annual number of broods surveyed from which the fledglings counts are obtained.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 6.6.2.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat66)
str(woodchat66)
</code></pre>

<hr>
<h2 id='woodchat7'>
Simulated data for woodchat shrike for use in chapter 7
</h2><span id='topic+woodchat7'></span>

<h3>Description</h3>

<p>Simulation of data with demographic parameters based on the woodchat shrike are introduced in section 3.2. This data set has additional simulated data for use in chapter 7. It is the same as <code>woodchat5</code> but with approximately 5 times the number of observations.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(woodchat7)</code></pre>


<h3>Format</h3>

<p><code>woodchat7</code> is a list with 4 components:
</p>

<dl>
<dt>ch </dt><dd><p>capture histories for 9438 females x 20 years.</p>
</dd>
<dt>age </dt><dd><p>the age of each individual at first capture: 1 = juvenile, 2 = at least 1 year old (adult).</p>
</dd>
<dt>repro </dt><dd><p>reproduction information for 6207 monitored nests: Reproduction = total number of fledglings (male + female), Year = year monitored, Age of mother: 1 = 1 year old, 2 = at least 2 years old.</p>
</dd>
<dt>count </dt><dd><p>total number of breeding pairs observed in each year.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Simulated data
</p>


<h3>References</h3>

<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press,  section 7.2.1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(woodchat7)
str(woodchat7)
</code></pre>

<hr>
<h2 id='wryneck'>
Data from wrynecks in Switzerland, 2002-2006
</h2><span id='topic+wryneck'></span>

<h3>Description</h3>

<p>The data contain information about the survival of 181 broods of wrynecks (<em>Jynx torquilla</em>)  collected in the Valais (Swiss Alps) from 2002-2006 in nestboxes. Dates are recorded such that day 1 is May 16.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(wryneck)</code></pre>


<h3>Format</h3>

<p><code>wryneck</code> is a data frame with 5 columns:
</p>

<dl>
<dt>f </dt><dd><p>day of first detection of nestlings.</p>
</dd>
<dt>j </dt><dd><p>day of the latest check when nestlings were present.</p>
</dd>
<dt>k </dt><dd><p>day of the last check; this is the same as 'j' if nestlings fledged successfully, or the day when the nest was found to have failed.</p>
</dd>
<dt>x </dt><dd><p>1 if nestlings fledged successfully, otherwise 0.</p>
</dd>
<dt>age </dt><dd><p>the age of the nestlings on first detection in number of days.</p>
</dd>
</dl>



<h3>Source</h3>

<p>Swiss Ornithological Institute</p>


<h3>References</h3>

<p>Geiser, S., R. Arlettaz, M. Schaub (2008) Impact of weather variation on feeding behaviour, nestling growth and brood survival in Wrynecks <em>Jynx torquilla</em>. <em>Journal of Ornithology</em> 149, 597-606.
</p>
<p>Schaub, M., Kéry, M. (2022) <em>Integrated Population Models</em>, Academic Press, section 4.4.6.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(wryneck)
str(wryneck)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
