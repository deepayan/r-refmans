<!DOCTYPE html><html><head><title>Help for package TP.idm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {TP.idm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#colonTP'>
<p>Chemotherapy for Stage B/C colon cancer</p></a></li>
<li><a href='#plot.TPidm'>
<p>Plot method for a TPidm object</p></a></li>
<li><a href='#print.TPidm'>
<p>Print method for a TPidm object</p></a></li>
<li><a href='#summary.TPidm'>
<p>Summary method for a TPidm object</p></a></li>
<li><a href='#test.nm'>
<p>Graphical tool to check the Markov assumption</p></a></li>
<li><a href='#TP.idm-package'>
<p>Estimation of Transition Probabilities for the Illness-Death</p>
Model</a></li>
<li><a href='#TPidm'>
<p>Transition probabilities for the illness-death model</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Estimation of Transition Probabilities for the Illness-Death
Model</td>
</tr>
<tr>
<td>Version:</td>
<td>1.5.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2018-04-17</td>
</tr>
<tr>
<td>Author:</td>
<td>Vanesa Balboa-Barreiro, Jacobo de Una-Alvarez &lt;jacobo@uvigo.es&gt;
         and Luis Meira-Machado &lt;lmachado@math.uminho.pt&gt;</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Vanesa Balboa-Barreiro &lt;vanesa.balboa@uvigo.es&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1.1), graphics, stats</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Description:</td>
<td>Estimation of transition probabilities for the illness-death model. Both the Aalen-Johansen estimator for a Markov model and a novel non-Markovian estimator by de Una-Alvarez and Meira-Machado (2015) &lt;<a href="https://doi.org/10.1111%2Fbiom.12288">doi:10.1111/biom.12288</a>&gt;, see also Balboa and de Una-Alvarez (2018) &lt;<a href="https://doi.org/10.18637%2Fjss.v083.i10">doi:10.18637/jss.v083.i10</a>&gt;, are included.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-08-17 05:56:44 UTC; hornik</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-08-17 06:27:13 UTC</td>
</tr>
</table>
<hr>
<h2 id='colonTP'>
Chemotherapy for Stage B/C colon cancer
</h2><span id='topic+colonTP'></span>

<h3>Description</h3>

<p>These are data from one of the first successful trials of adjuvant chemotherapy for colon cancer. Levamisole is a low-toxicity compound previously used to treat worm infestations in animals; 5-FU is a moderately toxic (as these things go) chemotherapy agent. This data frame reproduces the information in the <code>colon</code> object of the package <code>survival</code>, organized in a slightly different way (only one row is used for each individual).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("colonTP")</code></pre>


<h3>Format</h3>

<p>A data frame with 929 observations on the following 15 variables.
</p>

<dl>
<dt><code>time1</code></dt><dd><p>Disease free survival time (time to recurrence, death, or censoring, whichever occurs first).</p>
</dd>
<dt><code>event1</code></dt><dd><p>Disease free survival indicator (1=dead or relapsed, 0=alive disease free).</p>
</dd>
<dt><code>Stime</code></dt><dd><p>Time to death or censoring.</p>
</dd>
<dt><code>event</code></dt><dd><p>Death indicator (1=dead, 0=alive).</p>
</dd>
<dt><code>rx</code></dt><dd><p>Treatment - <code>Obs</code>(ervation), <code>Lev</code>(amisole), <code>Lev</code>(amisole)<code>+5-FU</code>.</p>
</dd>
<dt><code>sex</code></dt><dd><p>1=male.</p>
</dd>
<dt><code>age</code></dt><dd><p>Age in years.</p>
</dd>
<dt><code>obstruct</code></dt><dd><p>Obstruction of colon by tumour.</p>
</dd>
<dt><code>perfor</code></dt><dd><p>Perforation of colon.</p>
</dd>
<dt><code>adhere</code></dt><dd><p>Adherence to nearby organs.</p>
</dd>
<dt><code>nodes</code></dt><dd><p>Number of lymph nodes with detectable cancer.</p>
</dd>
<dt><code>differ</code></dt><dd><p>Differentiation of tumour (1=well, 2=moderate, 3=poor).</p>
</dd>
<dt><code>extent</code></dt><dd><p>Extent of local spread (1=submucosa, 2=muscle, 3=seros, 4=contiguous structures).</p>
</dd>
<dt><code>surg</code></dt><dd><p>Time from surgery to registration (0=short, 1=long).</p>
</dd>
<dt><code>node4</code></dt><dd><p>More than 4 positive lymph nodes.</p>
</dd>
</dl>



<h3>Note</h3>

<p>The study is originally described in Laurie et al. (1989). The main report is found in Moertel et al. (1990). This data set is closet to that of the final report in Moertel et al. (1991). A version of the data with less follow-up time was used in the paper by Lin (1994). This data set has been used for illustration purposes in a number of papers, including Meira-Machado et al. (2015) and de Uña-Álvarez and Meira-Machado (2015).
</p>


<h3>References</h3>

<p>de Uña-Álvarez J. and Meira-Machado L. (2015). Nonparametric estimation of transition probabilities in a non-Markov illness-death model: a comparative study. <em>Biometrics</em> <b>71</b>, 364&ndash;375.
</p>
<p>Laurie J. A., Moertel C. G., Fleming T. R., Wieand H. S., Leigh J. E., Rubin J., McCormack G. W., Gerstner J. B., Krook J. E. and Malliard J. (1989). Surgical adjuvant therapy of large-bowel carcinoma: An evaluation of levamisole and the combination of levamisole and fluorouracil: The North Central Cancer Treatment Group and the Mayo Clinic. <em>Journal of Clinical Oncology</em> <b>7(10)</b>, 1447&ndash;1456.
</p>
<p>Lin D. Y. (1994). Cox regression analysis of multivariate failure time data: the marginal approach. <em>Statistics in Medicine</em> <b>13(21)</b>, 2233&ndash;2247.
</p>
<p>Meira-Machado L., de Uña-Álvarez J. and Datta S. (2015). Nonparametric estimation of conditional transition probabilities in a non-Markov illness-death model. Computational Statistics <b>30</b>, 377&ndash;397.
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Goodman P. J., Ungerleider J. S., Emerson W. A., Tormey D. C., Glick J. H., Veeder M. H. and Maillard J. A. (1990). Levamisole and fluorouracil for adjuvant therapy of resected colon carcinoma. <em>New England Journal of Medicine</em> <b>322(6)</b>, 352&ndash;358.
</p>
<p>Moertel C. G., Fleming T. R., MacDonald J. S., Haller D. G., Laurie J. A., Tangen C. M., Ungerleider J. S., Emerson W. A., Tormey D. C., Glick J. H., Veeder M. H. and Maillard J. A. (1991). Fluorouracil plus Levamisole as an effective adjuvant therapy after resection of stage II colon carcinoma: a final report. <em>Annals of Internal Medicine</em> <b>122(5)</b>, 321&ndash;326.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)
## maybe str(colonTP) ; plot(colonTP) ...
</code></pre>

<hr>
<h2 id='plot.TPidm'>
Plot method for a TPidm object
</h2><span id='topic+plot.TPidm'></span>

<h3>Description</h3>

<p>Plot method for an object of class &lsquo;TPidm&rsquo;. It draws the estimated occupation probabilities (if s = 0) or transition probabilities (if s &gt; 0) and confidence intervals (only available if <code>CI</code> is <code>TRUE</code>) in a basic scatterplot or in a multipanel layout.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPidm'
plot(x, chosen.tr = "ALL", col = "black", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.TPidm_+3A_x">x</code></td>
<td>

<p>An object of class &lsquo;TPidm&rsquo;.
</p>
</td></tr>
<tr><td><code id="plot.TPidm_+3A_chosen.tr">chosen.tr</code></td>
<td>

<p>Character vector of the form &lsquo;c(&ldquo;from to&rdquo;, &ldquo;from to&rdquo;)&rsquo; specifying which transitions should be plotted. Default, all the transition probabilities are plotted.
</p>
</td></tr>
<tr><td><code id="plot.TPidm_+3A_col">col</code></td>
<td>
<p>Character vector specifying colors for each curves. Default <code>col</code>=&ldquo;black&rdquo;.
</p>
</td></tr>
<tr><td><code id="plot.TPidm_+3A_...">...</code></td>
<td>

<p>Further arguments to plot.
</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)

# create a TPidm object with s = 0, t = "last" (default),
# CI = FALSE and method = "NM" (default):
nm0 &lt;- TPidm(colonTP, s = 0, CI=FALSE)

# plot all possible transitions without CI:
plot(nm0)

# or 
# create a TPidm object with s = 0, t = "last" (default),
# CI = TRUE (default) and method = "AJ":
aj0ci &lt;- TPidm(colonTP, s = 0, method = "AJ")

# plot transitions "1 2" and "1 3" with CI:
plot(aj0ci, chosen.tr = c("1 2", "1 3"))

# create a TPidm object with s = 365, t = 1095, cov = "rx",
# CI = FALSE and method = "NM" (default):
nm365cov &lt;- TPidm(colonTP, s = 365, t = 1095, cov = "rx", CI=FALSE)

# plot transitions "1 2" and "1 3" without CI:
plot(nm365cov, chosen.tr = c("1 2", "1 3"), col=c("blue","red","green"))
</code></pre>

<hr>
<h2 id='print.TPidm'>
Print method for a TPidm object
</h2><span id='topic+print.TPidm'></span>

<h3>Description</h3>

<p>Print method for an object of class &lsquo;TPidm&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPidm'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.TPidm_+3A_x">x</code></td>
<td>

<p>An object of class &lsquo;TPidm&rsquo;.
</p>
</td></tr>
<tr><td><code id="print.TPidm_+3A_...">...</code></td>
<td>

<p>Further arguments to  print.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame is returned with the following variables:
</p>
<table>
<tr><td><code>transition</code></td>
<td>
<p>The initial and final states &ldquo;i j&rdquo; for each particular transition.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>The transition probabilities <code class="reqn">P_{ij}</code>(s,t).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The print function displays the method used, the user-supplied times s and t, the possible transitions, the estimated transition probabilities and, optionally, confidence limits and variances.
</p>
<p>If <code>cov</code> was specified, the print function provides the transition probabilities <code class="reqn">P_{ij}</code>(s,t) for each level of covariate.
</p>

<hr>
<h2 id='summary.TPidm'>
Summary method for a TPidm object
</h2><span id='topic+summary.TPidm'></span>

<h3>Description</h3>

<p>Summary method for an object of class &lsquo;TPidm&rsquo;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'TPidm'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summary.TPidm_+3A_object">object</code></td>
<td>

<p>An object of class &lsquo;TPidm&rsquo;.
</p>
</td></tr>
<tr><td><code id="summary.TPidm_+3A_...">...</code></td>
<td>

<p>Further arguments to print.
</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame is returned with the following variables:
</p>
<table>
<tr><td><code>transition</code></td>
<td>
<p>The initial and final states &ldquo;i j&rdquo; for each particular transition.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>The transition probabilities <code class="reqn">P_{ij}</code>(s,t).</p>
</td></tr>
</table>


<h3>Note</h3>

<p>The summary function prints the method used, the user-supplied times s and t, the possible transitions, the estimated transition probabilities and, optionally, confidence limits and variances.
</p>
<p>If <code>cov</code> is specified, the summary function provides the transition probabilities <code class="reqn">P_{ij}</code>(s,t) for each level of covariate.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)
# create a TPidm object with s = 365, t = 1095, cov = "rx",
# CI = FALSE and method = "NM" (default):
nm365cov &lt;- TPidm(colonTP, s = 365, t = 1095, cov = "rx", CI=FALSE)
summary(nm365cov) # summarizing the results
</code></pre>

<hr>
<h2 id='test.nm'>
Graphical tool to check the Markov assumption</h2><span id='topic+test.nm'></span>

<h3>Description</h3>

<p>It constructs a PP-plot which compares the transition probabilities reported by the non-Markovian and Aalen-Johansen estimators. Under the Markov assumption the PP-plot should fit the straight line y=x. When the Markov assumption holds the Aalen-Johansen is preferred since it provides a smaller standard error. If the Markov assumption is violated, the Aalen-Johansen may be inconsistent and therefore the non-Markovian method is recommended.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>test.nm(data, s, t = "last")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="test.nm_+3A_data">data</code></td>
<td>

<p>A data.frame including at least four columns named <code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond to disease free survival time, disease free survival indicator, time to death or censoring, and death indicator, respectively.
</p>
</td></tr>
<tr><td><code id="test.nm_+3A_s">s</code></td>
<td>

<p>The current time for the transition probabilities to be computed.
</p>
</td></tr>
<tr><td><code id="test.nm_+3A_t">t</code></td>
<td>

<p>The future time for the transition probabilities to be computed. Default is &ldquo;last&rdquo; which means the largest time among the uncensored entry times for the intermediate state and the final absorbing state.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>It constructs a PP-plot which compares the transition probabilities reported by the non-Markovian and Aalen-Johansen estimators. Under the Markov assumption the PP-plot should fit the straight line y=x. When the Markov assumption holds the Aalen-Johansen is preferred since it provides a smaller standard error. If the Markov assumption is violated, the Aalen-Johansen may be inconsistent and therefore the non-Markovian method is recommended. The PP-plot excludes <code class="reqn">P_{11}</code>(s,t) since both estimators agree in this case. Also, the user-supplied <code>s</code> must be strictly positive, because the Markov assumption is not relevant for the estimation of occupation probabilities (s=0).
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)

test.nm(colonTP, s = 0) 
# nothig is displayed since the Markov condition is not relevant 
# for the case s=0 (occupation probabilities) 

test.nm(colonTP, s = 365, t = 1095)
</code></pre>

<hr>
<h2 id='TP.idm-package'>
Estimation of Transition Probabilities for the Illness-Death
Model
</h2><span id='topic+TP.idm-package'></span><span id='topic+TP.idm'></span>

<h3>Description</h3>

<p>Estimation of transition probabilities for the illness-death model. Both the Aalen-Johansen estimator for a Markov model and a novel non-Markovian estimator by de Uña-Álvarez and Meira-Machado (2015) &lt;doi:10.1111/biom.12288&gt;, see also Balboa and de Uña-Álvarez (2018) 
&lt;doi:10.18637/jss.v083.i10&gt;, are included.
</p>


<h3>Details</h3>

<p>The DESCRIPTION file:
</p>

<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> TP.idm</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Title: </td><td style="text-align: left;"> Estimation of Transition Probabilities for the Illness-Death
Model</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.5.1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2018-04-17</td>
</tr>
<tr>
 <td style="text-align: left;">
Author: </td><td style="text-align: left;"> Vanesa Balboa-Barreiro, Jacobo de Una-Alvarez &lt;jacobo@uvigo.es&gt;
         and Luis Meira-Machado &lt;lmachado@math.uminho.pt&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Maintainer: </td><td style="text-align: left;"> Vanesa Balboa-Barreiro &lt;vanesa.balboa@uvigo.es&gt;</td>
</tr>
<tr>
 <td style="text-align: left;">
Depends: </td><td style="text-align: left;"> R (&gt;= 3.1.1), graphics, stats</td>
</tr>
<tr>
 <td style="text-align: left;">
Repository: </td><td style="text-align: left;"> CRAN</td>
</tr>
<tr>
 <td style="text-align: left;">
Description: </td><td style="text-align: left;"> Estimation of transition probabilities for the illness-death model. Both the Aalen-Johansen estimator for a Markov model and a novel non-Markovian estimator by de Una-Alvarez and Meira-Machado (2015) &lt;doi:10.1111/biom.12288&gt;, see also Balboa and de Una-Alvarez (2018) &lt;doi:10.18637/jss.v083.i10&gt;, are included.</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2</td>
</tr>
<tr>
 <td style="text-align: left;">
Encoding: </td><td style="text-align: left;"> UTF-8</td>
</tr>
<tr>
 <td style="text-align: left;">
NeedsCompilation: </td><td style="text-align: left;"> yes</td>
</tr>
<tr>
 <td style="text-align: left;">
Packaged: </td><td style="text-align: left;"> 2018-04-17 15:43:34 UTC; hp</td>
</tr>
<tr>
 <td style="text-align: left;">
Date/Publication: </td><td style="text-align: left;"> 2018-04-18 23:09:38 UTC</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>


<p>Index of help topics:
</p>
<pre>
TP.idm-package          Estimation of Transition Probabilities for the
                        Illness-Death Model
TPidm                   Transition probabilities for the illness-death
                        model
colonTP                 Chemotherapy for Stage B/C colon cancer
plot.TPidm              Plot method for a TPidm object
print.TPidm             Print method for a TPidm object
summary.TPidm           Summary method for a TPidm object
test.nm                 Graphical tool to check the Markov assumption
</pre>
<p>This package incorporates the function <code>TPidm</code> which can be used to compute a nonparametric transition probability matrix for the illness-death model. For a complete list of functions use <code>library(help=TP.idm)</code>.
</p>


<h3>Author(s)</h3>

<p>Vanesa Balboa-Barreiro, Jacobo de Una-Alvarez &lt;jacobo@uvigo.es&gt;
         and Luis Meira-Machado &lt;lmachado@math.uminho.pt&gt;
</p>
<p>Maintainer: Vanesa Balboa-Barreiro &lt;vanesa.balboa@uvigo.es&gt;
</p>


<h3>References</h3>

<p>Andersen P. K., Borgan O., Gill R. D. and Keiding N. (1993). Statistical models based on counting processes. Springer Series in Statistics. New York, NY: Springer.
</p>
<p>Datta S. and Satten G. A. (2001). Validity of the Aalen-Johansen estimators of stage occupation probabilities and Nelson-Aalen estimators of integrated transition hazards for non-Markov models. <em>Statistics and Probability Letters</em> <b>55(4)</b>, 403&ndash;411.
</p>
<p>de Uña-Álvarez J. and Meira-Machado L. (2015). Nonparametric estimation of transition probabilities in a non-Markov illness-death model: a comparative study. <em>Biometrics</em> <b>71</b>, 364&ndash;375.
</p>
<p>Meira-Machado L. F., de Uña-Álvarez J. and Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Annal</em> <b>12(3)</b>, 325&ndash;344.
</p>
<p>Balboa-Barreiro V., de Uña-Álvarez J. (2018). Estimation of Transition Probabilities for the Illness-Death Model: Package <code>TP.idm</code>. <em>Journal of Statistical Software</em> <b>83(10)</b>, 1&ndash;19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)

# create a TPidm object with s = 0, t = "last" (default),
# CI = TRUE (default) and method = "AJ":
aj0ci &lt;- TPidm(colonTP, s = 0, method = "AJ")
summary(aj0ci) # summarizing the results
plot(aj0ci) # plotting all occupation probabilities
</code></pre>

<hr>
<h2 id='TPidm'>
Transition probabilities for the illness-death model
</h2><span id='topic+TPidm'></span>

<h3>Description</h3>

<p>This function computes the transition probability matrix for the illness-death model, by using the Aalen-Johansen technique (suitable for Markov models) or alternatively a non-Markovian estimator. It creates a &lsquo;TPidm&rsquo; object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TPidm(data, s, t = "last", cov = NULL, CI = TRUE, level = 0.95, 
ci.transformation = "linear", method = "NM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TPidm_+3A_data">data</code></td>
<td>

<p>A data.frame including at least four columns named <code>time1</code>, <code>event1</code>, <code>Stime</code> and <code>event</code>, which correspond to disease free survival time, disease free survival indicator, time to death or censoring, and death indicator, respectively.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_s">s</code></td>
<td>

<p>The current time for the transition probabilities to be computed; <code>s=0</code> reports the occupation probabilities.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_t">t</code></td>
<td>

<p>The future time for the transition probabilities to be computed. Default is &ldquo;last&rdquo; which means the largest time among the uncensored entry times for the intermediate state and the final absorbing state.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_cov">cov</code></td>
<td>

<p>A categorical variable for the optional by-group analysis; this variable must be a <code>factor</code>.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_ci">CI</code></td>
<td>

<p>If <code>TRUE</code> (default), confidence intervals are computed.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_level">level</code></td>
<td>

<p>Level of confidence intervals. Default is <code>0.95</code> (corresponding to 95 %).
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_ci.transformation">ci.transformation</code></td>
<td>

<p>Transformation applied to compute confidence intervals. Possible choices are &ldquo;linear&rdquo;, &ldquo;log&rdquo;, &ldquo;log-log&rdquo; and &ldquo;cloglog&rdquo;. Default is &ldquo;linear&rdquo;.
</p>
</td></tr>
<tr><td><code id="TPidm_+3A_method">method</code></td>
<td>

<p>The method used to compute the transition probabilities. Possible options are &ldquo;AJ&rdquo; (Aalen-Johansen) or &ldquo;NM&rdquo; (non-Markovian). Default is &ldquo;NM&rdquo;.
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If s = 0 this function TPidm reports the state occupation probabilities at time t. For s &gt; 0, the transition probabilities are provided. The default method &ldquo;NM&rdquo; computes the estimator proposed by de Uña-Álvarez and Meira-Machado (2015), which is consistent regardless the Markov assumption. To fit a Markovian transition probability matrix, use the &ldquo;AJ&rdquo; method. Note that the Aalen-Johansen occupation probabilities are consistent even when the process is non-Markov (Datta and Satten, 2001), but this is not true for the Aalen-Johansen transition probabilities (Meira-Machado et al., 2006). If <code>CI</code> is <code>TRUE</code> (default), TPidm calculates the estimated variance and the confidence intervals by using the plug-in variance described in Balboa and de Uña-Álvarez (2018) (method = &ldquo;NM&rdquo;), or the standard formulas for Markovian processes (method = &ldquo;AJ&rdquo;, see Andersen et al., 1993).
</p>


<h3>Value</h3>

<p>An object of class &lsquo;TPidm&rsquo;. It is a list containing the following objects:
</p>
<table>
<tr><td><code>s</code></td>
<td>
<p>The user-supplied current time for the transition probabilities.</p>
</td></tr>
<tr><td><code>t</code></td>
<td>
<p>The user-supplied future time for the transition probabilities.</p>
</td></tr>
<tr><td><code>method</code></td>
<td>
<p>The method used to compute the transition probabilities.</p>
</td></tr>
<tr><td><code>times</code></td>
<td>
<p>The uncensored entry times for the intermediate state and the final absorbing state which fall between s and t.</p>
</td></tr>
<tr><td><code>probs</code></td>
<td>
<p>A matrix with transition probability estimates <code class="reqn">P_{ij}</code>(s,t) for the user-supplied (s, t) and each possible transition from state i (rows) to state j (columns). If <code>CI</code> is <code>TRUE</code> (default), it includes confidence limits and variances.</p>
</td></tr>
<tr><td><code>all.probs</code></td>
<td>
<p>An array with transition probability estimates <code class="reqn">P_{ij}</code>(s, <code class="reqn">t_{k}</code>) for each possible transition, evaluated at all the event times <code class="reqn">t_{k}</code> falling between s and t. If <code>CI</code> is <code>TRUE</code> (default), it includes confidence limits and variances.</p>
</td></tr>
<tr><td><code>p.trans</code></td>
<td>
<p>Possible transitions among the states. If s = 0, possible transitions are &ldquo;1 1&rdquo;, &ldquo;1 2&rdquo; and &ldquo;1 3&rdquo;; if s &gt; 0 possible transitions are &ldquo;1 1&rdquo;, &ldquo;1 2&rdquo;, &ldquo;1 3&rdquo;, &ldquo;2 2&rdquo; and &ldquo;2 3&rdquo;.</p>
</td></tr>
<tr><td><code>CI</code></td>
<td>
<p>A logical value chosen by the user.</p>
</td></tr>
<tr><td><code>ci.transformation</code></td>
<td>
<p>Transformation chosen by the user to compute the confidence intervals.</p>
</td></tr>
</table>


<h3>Note</h3>

<p>If <code>time1=Stime</code> and <code>event1=event=1</code>, the function <code>TPidm</code> assumes that a direct transition from the initial state to the final absorbing state has occurred. That is, zero sojourn times are not allowed for the intermediate state (replacing the zeros by a small positive amount is a way to introduce such cases).
</p>
<p>If <code>cov</code> is specified, the main function provides estimations of transition probabilities for each level of the covariate. 
</p>


<h3>References</h3>

<p>Andersen P. K., Borgan O., Gill R. D. and Keiding N. (1993). Statistical models based on counting processes. Springer Series in Statistics. New York, NY: Springer.
</p>
<p>Datta S. and Satten G. A. (2001). Validity of the Aalen-Johansen estimators of the stage occupation probabilities and Nelson-Aalen estimators of integrated transition hazards for non-Markov models. <em>Statistics and Probability Letters</em> <b>55(4)</b>, 403&ndash;411.
</p>
<p>de Uña-Álvarez J. and Meira-Machado L. (2015). Nonparametric estimation of transition probabilities in a non-Markov illness-death model: a comparative study. <em>Biometrics</em> <b>71</b>, 364&ndash;375.
</p>
<p>Meira-Machado L. F., de Uña-Álvarez J. and Cadarso-Suárez C. (2006). Nonparametric estimation of transition probabilities in a non-Markov illness-death model. <em>Lifetime Data Anal</em> <b>12(3)</b>, 325&ndash;344.
</p>
<p>Balboa-Barreiro V., de Uña-Álvarez J. (2018). Estimation of Transition Probabilities for the Illness-Death Model: Package <code>TP.idm</code>. <em>Journal of Statistical Software</em> <b>83(10)</b>, 1&ndash;19.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(colonTP)

# create a TPidm object with s = 0, t = "last" (default),
# CI = TRUE (default) and method = "AJ":
aj0ci &lt;- TPidm(colonTP, s = 0, method = "AJ")
plot(aj0ci) # plotting all occupation probabilities

#or
# create a TPidm object with s = 365, t = "last" (default),
# CI = FALSE and method = "NM" (default):
nm365 &lt;- TPidm(colonTP, s = 365, CI=FALSE)
summary(nm365) # summarizing the results

# or
# create a TPidm object with cov = "rx":
nm365cov &lt;- TPidm(colonTP, s = 365, t = 1095, cov = "rx", CI=FALSE)
summary(nm365cov) # summarizing the results
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
