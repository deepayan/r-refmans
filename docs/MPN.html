<!DOCTYPE html><html><head><title>Help for package MPN</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {MPN}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#apc'><p>Calculate aerobic plate count (APC)</p></a></li>
<li><a href='#mpn'><p>Calculate most probable number (MPN)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Most Probable Number and Other Microbial Enumeration Techniques</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>John Ihrie &lt;John.Ihrie@fda.hhs.gov&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Calculates the Most Probable Number (MPN) to quantify the
    concentration (density) of microbes in serial dilutions of a laboratory
    sample (described in Jarvis, 2010 &lt;<a href="https://doi.org/10.1111%2Fj.1365-2672.2010.04792.x">doi:10.1111/j.1365-2672.2010.04792.x</a>&gt;).
    Also calculates the Aerobic Plate Count (APC) for similar microbial
    enumeration experiments.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.4.0)</td>
</tr>
<tr>
<td>License:</td>
<td>Unlimited</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://mpncalc.galaxytrakr.org/">https://mpncalc.galaxytrakr.org/</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>6.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats (&ge; 3.4.0)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr (&ge; 1.20), rmarkdown (&ge; 1.10), testthat (&ge; 2.0.0)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-20 18:22:53 UTC; John.Ihrie</td>
</tr>
<tr>
<td>Author:</td>
<td>Martine Ferguson [aut] (original R code),
  John Ihrie [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-20 21:34:52 UTC</td>
</tr>
</table>
<hr>
<h2 id='apc'>Calculate aerobic plate count (APC)</h2><span id='topic+apc'></span>

<h3>Description</h3>

<p><code>apc</code> calculates the Aerobic Plate Count (<em>APC</em>) point estimate
and confidence interval of colony forming units (CFU). Adjusts for
too-numerous-to-count (TNTC) plates using the maximum likelihood method of
Haas et al. (2014).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>apc(count, amount_scor, amount_tntc = NULL, tntc_limit = 250,
  conf_level = 0.95)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="apc_+3A_count">count</code></td>
<td>
<p>A vector of CFU counts in each scorable (countable) plate.</p>
</td></tr>
<tr><td><code id="apc_+3A_amount_scor">amount_scor</code></td>
<td>
<p>A vector of inoculum amounts (in ml) in each scorable
plate. See <em>Details</em> section.</p>
</td></tr>
<tr><td><code id="apc_+3A_amount_tntc">amount_tntc</code></td>
<td>
<p>A vector of inoculum amounts (in ml) in each TNTC plate.</p>
</td></tr>
<tr><td><code id="apc_+3A_tntc_limit">tntc_limit</code></td>
<td>
<p>A vector (or scalar) of the limit above which the plate
counts are considered too-numerous-to-count (often 100, 250, or 300). Each
plate can potentially have a different value. Default is 250.</p>
</td></tr>
<tr><td><code id="apc_+3A_conf_level">conf_level</code></td>
<td>
<p>A scalar value between zero and one for the confidence
level. Typically 0.95 (i.e., a 95 percent confidence interval).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As an example, assume we start with four plates and 1 ml of
undiluted inoculum. For the first two plates we use a 100-fold dilution;
for the other two plates we use a 1,000-fold dilution. The first two plates
were TNTC with limits of 300 and 250. The other plates had CFU counts of
28 and 20. We now have
<code>count = c(28, 20)</code>,
<code>amount_scor = 1 * c(.001, .001)</code>,
<code>amount_tntc = 1 * c(.01, .01)</code>, and
<code>tntc_limit = c(300, 250)</code>.
</p>
<p>Currently, confidence intervals can only be calculated using the
likelihood ratio (LR) approach described in Haas et al. (2014).
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p><strong>APC</strong>: The aerobic plate count point estimate in CFU/ml.
</p>
</li>
<li><p><strong>conf_level</strong>: The confidence level used.
</p>
</li>
<li><p><strong>LB</strong>: The lower bound of the confidence interval.
</p>
</li>
<li><p><strong>UB</strong>: The upper bound of the confidence interval.
</p>
</li></ul>



<h3>Warnings</h3>

<p>The likelihood ratio confidence interval assumptions depend on asymptotic
theory. Therefore, the confidence interval results will be better with
larger experiments.
</p>
<p><code>apc()</code> will fail in certain cases where the TNTC results are
extremely unlikely to occur when taking the scorable (countable) plates
into consideration. In other words, if the countable plates suggest a low
concentration of microbes, then TNTC plates at higher dilution levels are
probably due to experimental error. Mathematically, the probability is so
small that the likelihood function is essentially zero.
</p>


<h3>References</h3>

<p>Bacteriological Analytical Manual, 8th Edition, Chapter 3,
<a href="https://www.fda.gov/food/foodscienceresearch/laboratorymethods/ucm063346.htm">https://www.fda.gov/food/foodscienceresearch/laboratorymethods/ucm063346.htm</a>
</p>
<p>Haas CN, Heller B (1988). &quot;Averaging of TNTC counts.&quot;
<em>Applied and Environmental Microbiology</em>, 54(8), 2069-2072.
<a href="https://aem.asm.org/content/54/8/2069">https://aem.asm.org/content/54/8/2069</a>
</p>
<p>Haas CN, Rose JB, Gerba CP (2014). &quot;Quantitative microbial risk
assessment, Second Ed.&quot; <em>John Wiley &amp; Sons, Inc.</em>,
ISBN 978-1-118-14529-6.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mpn">mpn</a></code> for Most Probable Number
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#------- "Quantitative Microbial Risk Assessment (Haas et al., 2014) --------

# Table 6.1 (Sample A)
my_count &lt;- c(1, 2, 1, 0, 0, 1, 1, 3, 6, 8, 4)
my_amount_scor &lt;- c(1, 1, 1, 1, 1, 2.5, 2.5, 2.5, 2.5, 5, 5)
apc(my_count, my_amount_scor)  #1.08

# Table 6.1 (Sample B)
my_count &lt;- c(1, 0, 5, 1, 0, 5, 0, 1, 5, 1, 8)
my_amount_scor &lt;- c(1, 1, 1, 1, 1, 2.5, 2.5, 2.5, 2.5, 5, 5)
apc(my_count, my_amount_scor)  #1.08

# Table 6.2
my_count &lt;- c(12, 8, 15, 40, 58)
my_amount_scor &lt;- c(1, 1, 1, 10, 10)
my_amount_tntc &lt;- c(10, 100, 100, 100)
my_tntc_limit &lt;- 100
apc(my_count, my_amount_scor, my_amount_tntc, my_tntc_limit) #~7 (6.03, 7.96)


#----------- "Averaging of TNTC Counts" (Haas &amp; Heller, 1988) ---------------
# Note:
#  Results are slightly different due mostly to differences in how the TNTC
#  portion of the likelihood function is formulated (i.e., incomplete gamma
#  function vs. infinite Poisson sum--see Haas et al. (2014) for details of
#  this mathematical relationship).

my_count &lt;- c(10, 12, 23, 48, 63)
my_amount_scor &lt;- c(1, 1, 1, 5, 5)
my_amount_tntc &lt;- c(5, 10, 10)
my_tntc_limit &lt;- 80
apc(my_count, my_amount_scor, my_amount_tntc, my_tntc_limit)
#Haas &amp; Heller: APC = 13.28 CFU/ml

</code></pre>

<hr>
<h2 id='mpn'>Calculate most probable number (MPN)</h2><span id='topic+mpn'></span>

<h3>Description</h3>

<p><code>mpn</code> calculates the Most Probable Number (<em>MPN</em>) point estimate
and confidence interval for microbial concentrations. Also calculates
Blodgett's (2002, 2005, 2010) Rarity Index (<em>RI</em>).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mpn(positive, tubes, amount, conf_level = 0.95, CI_method = c("Jarvis",
  "LR"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mpn_+3A_positive">positive</code></td>
<td>
<p>A vector of number of positive tubes at each dilution level.</p>
</td></tr>
<tr><td><code id="mpn_+3A_tubes">tubes</code></td>
<td>
<p>A vector of total number of tubes at each dilution level.</p>
</td></tr>
<tr><td><code id="mpn_+3A_amount">amount</code></td>
<td>
<p>A vector of the amount of inoculum per tube at each dilution
level. See <em>Details</em> section.</p>
</td></tr>
<tr><td><code id="mpn_+3A_conf_level">conf_level</code></td>
<td>
<p>A scalar value between zero and one for the confidence
level. Typically 0.95 (i.e., a 95 percent confidence interval).</p>
</td></tr>
<tr><td><code id="mpn_+3A_ci_method">CI_method</code></td>
<td>
<p>The method used for calculating the confidence interval.
Choices are <code>"Jarvis"</code> or <code>"LR"</code> (likelihood ratio). See
<em>Details</em> section.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As an example, assume we start with 3g of undiluted inoculum per
tube, then use a 10-fold dilution for 2 dilutions. We now have
<code>amount = 3 * c(1, .1, .01)</code>.
</p>
<p>When all tubes are negative, the point estimate of <em>MPN</em> is
zero (same approach as Jarvis et al.). The point estimate for the BAM
tables &quot;is listed as less than the lowest MPN for an outcome with at least
one positive tube&quot; (App.2).
</p>
<p>When all tubes are positive, the point estimate for <em>MPN</em> is
<code>Inf</code> (same approach as Jarvis et al.) since no finite maximum
likelihood estimate (MLE) exists. The BAM tables &quot;list the MPN for this
outcome as greater than the highest MPN for an outcome with at least one
negative tube&quot; (App.2). Here, the difference is probably trivial since the
sample should be further diluted if all tubes test positive.
</p>
<p>The bias adjustment for the point estimate uses the method of Salama
et al. (1978). Also see Haas (1989).
</p>
<p>Currently, confidence intervals can only be calculated using the
Jarvis (2010) or likelihood ratio (LR) approach (Ridout, 1994). The BAM
tables use an alternate approach. We slightly modified Jarvis' approach
when all tubes are positive or all are negative; we use <code class="reqn">\alpha</code>
instead of <code class="reqn">\alpha / 2</code> since these are one-sided intervals. The Ridout
(1994) LR approach uses the same technique (with <code class="reqn">\alpha</code>) for these
two extreme cases.
</p>
<p>If the Rarity Index is less than <code>1e-04</code>, the experimental
results are highly improbable. The researcher may consider running the
experiment again and/or changing the dilution levels.
</p>


<h3>Value</h3>

<p>A list containing:
</p>

<ul>
<li><p><strong>MPN</strong>: The most probable number point estimate for
microbial density (concentration).
</p>
</li>
<li><p><strong>MPN_adj</strong>: The bias-adjusted point estimate for MPN.
</p>
</li>
<li><p><strong>variance</strong>: The estimated variance (see Jarvis et al.) of
the <em>MPN</em> estimate if <code>CI_method = "Jarvis"</code>. If all tubes
are positive or all negative, <code>variance</code> will be <code>NA</code>. If
<code>CI_method</code> is not <code>"Jarvis"</code>, <code>variance</code> will be
<code>NA</code>.
</p>
</li>
<li><p><strong>var_log</strong>: The estimated variance of the natural log of
the MPN estimate (see Jarvis et al.) using the Delta Method. If all
tubes are positive or all negative, <code>var_log</code> will be <code>NA</code>.
If <code>CI_method</code> is not <code>"Jarvis"</code>, <code>var_log</code> will be
<code>NA</code>.
</p>
</li>
<li><p><strong>conf_level</strong>: The confidence level used.
</p>
</li>
<li><p><strong>CI_method</strong>: The confidence interval method used.
</p>
</li>
<li><p><strong>LB</strong>: The lower bound of the confidence interval.
</p>
</li>
<li><p><strong>UB</strong>: The upper bound of the confidence interval.
</p>
</li>
<li><p><strong>RI</strong>: The rarity index.
</p>
</li></ul>



<h3>Warnings</h3>

<p>The Jarvis confidence interval assumptions of approximate normality (Delta
Method and asymptotic normality of maximum likelihood estimators) depend on
large-sample theory. The likelihood ratio assumptions also depend on
large-sample theory. Therefore, the Jarvis and LR confidence interval
approaches work best with larger experiments.
</p>


<h3>References</h3>

<p>Bacteriological Analytical Manual, 8th Edition, Appendix 2,
<a href="https://www.fda.gov/Food/FoodScienceResearch/LaboratoryMethods/ucm109656.htm">https://www.fda.gov/Food/FoodScienceResearch/LaboratoryMethods/ucm109656.htm</a>
</p>
<p>Blodgett RJ (2002). &quot;Measuring improbability of outcomes from a
serial dilution test.&quot; <em>Communications in Statistics: Theory and
Methods</em>, 31(12), 2209-2223.
<a href="https://www.tandfonline.com/doi/abs/10.1081/STA-120017222">https://www.tandfonline.com/doi/abs/10.1081/STA-120017222</a>
</p>
<p>Blodgett RJ (2005). &quot;Serial dilution with a confirmation step.&quot;
<em>Food Microbiology</em>, 22(6), 547-552.
<a href="https://doi.org/10.1016/j.fm.2004.11.017">https://doi.org/10.1016/j.fm.2004.11.017</a>
</p>
<p>Blodgett RJ (2010). &quot;Does a serial dilution experiment's model
agree with its outcome?&quot; <em>Model Assisted Statistics and Applications</em>,
5(3), 209-215. <a href="https://doi.org/10.3233/MAS-2010-0157">https://doi.org/10.3233/MAS-2010-0157</a>
</p>
<p>Haas CN (1989). &quot;Estimation of microbial densities from dilution
count experiments&quot; <em>Applied and Environmental Microbiology</em> 55(8),
1934-1942.
</p>
<p>Haas CN, Rose JB, Gerba CP (2014). &quot;Quantitative microbial risk
assessment, Second Ed.&quot; <em>John Wiley &amp; Sons, Inc.</em>,
ISBN 978-1-118-14529-6.
</p>
<p>Jarvis B, Wilrich C, Wilrich P-T (2010). &quot;Reconsideration of the
derivation of Most Probable Numbers, their standard deviations, confidence
bounds and rarity values.&quot; <em>Journal of Applied Microbiology</em>, 109,
1660-1667. <a href="https://doi.org/10.1111/j.1365-2672.2010.04792.x">https://doi.org/10.1111/j.1365-2672.2010.04792.x</a>
</p>
<p>Ridout MS (1994). &quot;A comparison of confidence interval methods
for dilution series experiments.&quot; <em>Biometrics</em>, 50(1), 289-296.
</p>
<p>Salama IA, Koch GG, Tolley DH. (1978) &quot;On the estimation of the
most probable number in a serial dilution technique.&quot; <em>Communications
in Statistics - Theory and Methods</em>, 7(13), 1267-1281.
</p>


<h3>See Also</h3>

<p>Shiny app:  <a href="https://mpncalc.galaxytrakr.org/">https://mpncalc.galaxytrakr.org/</a>
</p>
<p><code><a href="#topic+apc">apc</a></code> for Aerobic Plate Count
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Compare MPN, 95% CI, and RI to Jarvis -------------------------------------

# Table 1
mpn(positive = c(3, 1, 1), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: 7.5 (1.9, 30) RI = .209

mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: 0 (0, 1.1) RI = 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(1, .1, .01),
    conf_level = .975)$UB  #alpha / 2

mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(1, .1, .01))
  #Jarvis: Inf (36, Inf) RI = 1
mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(1, .1, .01),
    conf_level = .975)$LB  #alpha / 2

# Table 2
mpn(positive = c(20, 14, 3), tubes = c(20, 20, 20), amount = c(1, .1, .01))
  #Jarvis: 13 (7.6, 21) RI = 0.794

mpn(positive = c(50, 35, 7), tubes = c(50, 50, 50),
    amount = 2 * c(1, .1, .01))
  #Jarvis: 6.3 (4.5, 8.7) RI = .806

mpn(positive = c(1, 5, 3, 1, 1), tubes = c(1, 5, 5, 5, 5),
    amount = c(5, 1, .5, .1, .05))
  #Jarvis: 2.7 (1.3, 5.5) RI = .512

# Compare MPN and 95% CI to BAM tables --------------------------------------

# Table 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: &lt;3.0 (-, 9.5)

mpn(positive = c(0, 0, 1), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: 3.0 (0.15, 9.6)

mpn(positive = c(2, 2, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: 21 (4.5, 42)

mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(.1, .01, .001))
  #BAM: &gt;1100 (420, -)
mpn(positive = c(3, 3, 2), tubes = c(3, 3, 3), amount = c(.1, .01, .001))$MPN


# Table 2
mpn(positive = c(0, 0, 0), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: &lt;1.8 (-, 6.8)
mpn(positive = c(0, 0, 1), tubes = c(5, 5, 5), amount = c(.1, .01, .001))$MPN

mpn(positive = c(4, 0, 2), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: 21 (6.8, 40)

mpn(positive = c(5, 5, 5), tubes = c(5, 5, 5), amount = c(.1, .01, .001))
  #BAM: &gt;1600 (700, -)
mpn(positive = c(5, 5, 4), tubes = c(5, 5, 5), amount = c(.1, .01, .001))$MPN

# Compare MPN and 95% LR CI to Ridout (1994) --------------------------------

# Table 1
mpn(positive = c(0, 0, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: 0 (0, 9.0)
mpn(positive = c(2, 2, 0), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: 21.1 (6.2, 54.3)
mpn(positive = c(3, 3, 3), tubes = c(3, 3, 3), amount = c(.1, .01, .001),
    CI_method = "LR")
  #Ridout: Inf (465.1, Inf)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
