<!DOCTYPE html><html lang="en"><head><title>Help for package xmlwriter</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {xmlwriter}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#xmlwriter-package'><p>Fast and elegant XML generation</p></a></li>
<li><a href='#add_child_fragment'><p>Add a child fragment to an existing xml_fragment</p></a></li>
<li><a href='#as_frag'><p>Convert a list to an xml fragment</p></a></li>
<li><a href='#as_xml_nodeset'><p>Transforms an xml_fragment into an xml_nodeset</p></a></li>
<li><a href='#as.character.xml_fragment'><p>Turn an xml_fragment into a character</p></a></li>
<li><a href='#data_frag'><p>Create an xml_fragment from a data.frame</p></a></li>
<li><a href='#elem'><p>add an element to an xmlbuilder object</p></a></li>
<li><a href='#frag'><p>Create a frag xml_fragment</p></a></li>
<li><a href='#list_as_xml_document'><p>Convert a list to an xml_document</p></a></li>
<li><a href='#list_as_xml_string'><p>Convert a list to an xml string</p></a></li>
<li><a href='#read_fragment'><p>Read an XML fragment from a string</p></a></li>
<li><a href='#tag'><p>Create a tag fragment</p></a></li>
<li><a href='#xml_doc'><p>Create an xml_fragment with a root element, (kind of tag)</p></a></li>
<li><a href='#xml_fragment'><p>Create an XML fragment</p></a></li>
<li><a href='#xmlbuilder'><p>Create a fast feed-forward XML builder</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Fast and Elegant XML Generation</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.1</td>
</tr>
<tr>
<td>Description:</td>
<td>Provides a fast and elegant interface for generating XML
 fragments and documents. It can be used in companion with R packages 'XML'
 or 'xml2' to generate XML documents. The fast XML generation is implemented using the
 'Rcpp' package. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>xml2, tinytest</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://edwindj.github.io/xmlwriter/">https://edwindj.github.io/xmlwriter/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-09-25 07:05:36 UTC; edwin</td>
</tr>
<tr>
<td>Author:</td>
<td>Edwin de Jonge <a href="https://orcid.org/0000-0002-6580-4718"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Edwin de Jonge &lt;edwindjonge@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-09-25 10:20:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='xmlwriter-package'>Fast and elegant XML generation</h2><span id='topic+xmlwriter'></span><span id='topic+xmlwriter-package'></span>

<h3>Description</h3>

<p><code>xmlwriter</code> is an R package that provides a simple interface for creating XML documents
and fragments from R. It provides a simple elegant syntax for creating <code>xml_fragment</code>s and furthermore
contains a feed-forward API that allows you to write xml.
</p>


<h3>Details</h3>

<p><code>xmlwriter</code>'s xml generation from R lists is fast, implemented in C++ using <a href="https://cran.r-project.org/package=Rcpp"><code>Rcpp</code></a>.
</p>
<p><code>xmlwriter</code> provides two different ways to create xml documents:
</p>

<ul>
<li><p> a light weight R syntax using <code><a href="#topic+xml_doc">xml_doc()</a></code>, <code><a href="#topic+xml_fragment">xml_fragment()</a></code> and <code><a href="#topic+frag">frag()</a></code>, creating an xml fragment
that can be easily translated into a xml string or <code>xml2::xml_document</code> object
</p>
</li>
<li><p> a feed-forward API using <code><a href="#topic+xmlbuilder">xmlbuilder()</a></code> that allows you to create xml documents in a feed-forward manner.
</p>
</li></ul>

<p>It implements several <code>xml2</code> methods:
</p>

<ul>
<li> <p><code>as_xml_document.xml_fragment()</code>
</p>
</li>
<li> <p><code>as_list.xml_fragment()</code>
</p>
</li>
<li> <p><code>write_xml.xml_fragment()</code>
</p>
</li></ul>



<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Edwin de Jonge <a href="mailto:edwindjonge@gmail.com">edwindjonge@gmail.com</a> (<a href="https://orcid.org/0000-0002-6580-4718">ORCID</a>)
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://edwindj.github.io/xmlwriter/">https://edwindj.github.io/xmlwriter/</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>doc &lt;- xml_fragment(
  study = frag(
    .attr = c(id="1"),
    person = frag(
      .attr = c(id = "p1"),
      name = "John Doe",
      age = 30
    ),
    person = frag(
      name = "Jane Doe",
      age = 25,
      address = frag(street = "123 Main St", city = "Springfield"),
      "This is a text node"
    )
  )
)

print(doc)
if (require("xml2")){
  as_xml_document(doc)
}

# you can create a function to generate an xml fragment:
person_frag &lt;- function(name, age, id){
  tag("person", id = id) / frag(
    name = name,
    age  = age,
    address = frag(
      street = "123 Main St",
      city = "Springfield"
    )
  )
}

# xml_doc is a xml_fragment with the restriction of having one root element
doc2 &lt;- xml_doc("study") / (
  person_frag("John Doe", 30, "p1") +
  person_frag("Jane Doe", 25, "p2")
)

print(doc2)

if (require("xml2")){
  as_xml_document(doc2)
}

# a fragment can have multiple root elements
fgmt &lt;- person_frag("John Doe", 30, id = "p1") +
  person_frag("Jane Doe", 25, id = "p2")


print(fgmt)

if (require("xml2")){
  # as_xml_document won't work because it expects a single root element,
  # so we retrieve a nodeset instead
  as_xml_nodeset(fgmt)
}

iris_xml &lt;- xml_doc("fieldstudy", id = "iris", doi ="10.1111/j.1469-1809.1936.tb02137.x") /
  frag(
    source = "Fisher, R. A. (1936) The use of multiple measurements in
taxonomic problems. Annals of Eugenics, 7, Part II, 179–188.",
    data = data_frag(iris, row_tag = "obs")
  )

print(iris_xml, max_characters = 300)

if (require("xml2")){
  as_xml_document(iris_xml)
}
</code></pre>

<hr>
<h2 id='add_child_fragment'>Add a child fragment to an existing xml_fragment</h2><span id='topic+add_child_fragment'></span>

<h3>Description</h3>

<p>Add a child fragment to an existing xml_fragment.
The child fragment can be a named <code>frag</code> element in which case the name
is used as the tag name, an unnamed element in which case the element
is added as a text node. This functionality is equivalent with the <code>/</code> operator.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_child_fragment(x, ..., .frag = frag(...))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_child_fragment_+3A_x">x</code></td>
<td>
<p>an <code><a href="#topic+xml_fragment">xml_fragment()</a></code> object</p>
</td></tr>
<tr><td><code id="add_child_fragment_+3A_...">...</code></td>
<td>
<p>nest named elements and characters to include in the fragment (see example)</p>
</td></tr>
<tr><td><code id="add_child_fragment_+3A_.frag">.frag</code></td>
<td>
<p>an xml_fragment to add as a child, overrides the ... argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the original <code><a href="#topic+xml_fragment">xml_fragment()</a></code> with the child added.
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>

<hr>
<h2 id='as_frag'>Convert a list to an xml fragment</h2><span id='topic+as_frag'></span>

<h3>Description</h3>

<p>As frag is a helper function to convert a named list to an xml fragment, it
transforms all values to character, and recursively transforms nested lists.
<code>as_frag</code> can be used for flexible list created xml fragments, names of a
list turn into tags, and values into text nodes.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_frag(x, ..., .attr = list(...))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_frag_+3A_x">x</code></td>
<td>
<p>named list that will be transformed into a fragment</p>
</td></tr>
<tr><td><code id="as_frag_+3A_...">...</code></td>
<td>
<p>optional attributes to be set on the parent of the fragment</p>
</td></tr>
<tr><td><code id="as_frag_+3A_.attr">.attr</code></td>
<td>
<p>a list of attributes to add to the parent of the fragment, overrides the <code>...</code> argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+xml_fragment">xml_fragment()</a></code> object as if specified with <code><a href="#topic+frag">frag()</a></code>.
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>

<hr>
<h2 id='as_xml_nodeset'>Transforms an xml_fragment into an xml_nodeset</h2><span id='topic+as_xml_nodeset'></span>

<h3>Description</h3>

<p>Using the <code>xml2</code> package, this function transforms an <code>xml_fragment</code> into an <code>xml_nodeset</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>as_xml_nodeset(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as_xml_nodeset_+3A_x">x</code></td>
<td>
<p>an object created with <code><a href="#topic+xml_fragment">xml_fragment()</a></code></p>
</td></tr>
<tr><td><code id="as_xml_nodeset_+3A_...">...</code></td>
<td>
<p>reserved for future use</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>xml2::xml_nodeset</code> object
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>
<p>Other xml2: 
<code><a href="#topic+list_as_xml_document">list_as_xml_document</a>()</code>,
<code><a href="#topic+list_as_xml_string">list_as_xml_string</a>()</code>
</p>

<hr>
<h2 id='as.character.xml_fragment'>Turn an xml_fragment into a character</h2><span id='topic+as.character.xml_fragment'></span><span id='topic+as.character.xml_doc'></span>

<h3>Description</h3>

<p>This function turns an <code>xml_fragment</code> into a character string, using
a performant c++ implementation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'xml_fragment'
as.character(x, ...)

## S3 method for class 'xml_doc'
as.character(x, use_prolog = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="as.character.xml_fragment_+3A_x">x</code></td>
<td>
<p>object to be coerced or tested.</p>
</td></tr>
<tr><td><code id="as.character.xml_fragment_+3A_...">...</code></td>
<td>
<p>further arguments passed to or from other methods.</p>
</td></tr>
<tr><td><code id="as.character.xml_fragment_+3A_use_prolog">use_prolog</code></td>
<td>
<p>if <code>TRUE</code> the xml prolog with be included.
To suppress the prolog string either remove set <code>use_prolog = FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>a <code>character</code> with the xml representation of the fragment.
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>

<hr>
<h2 id='data_frag'>Create an xml_fragment from a data.frame</h2><span id='topic+data_frag'></span>

<h3>Description</h3>

<p>Create a <code><a href="#topic+xml_fragment">xml_fragment()</a></code> from a data.frame, in which each row is a set of xml elements (columns).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data_frag(df, row_tags = "row", .attr = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="data_frag_+3A_df">df</code></td>
<td>
<p>data frame that will be stored as set of xml elements</p>
</td></tr>
<tr><td><code id="data_frag_+3A_row_tags">row_tags</code></td>
<td>
<p><code>character</code> the tag name that is used for each row. Note that
this can be a single value or a vector of length equal to the number of rows in the data.frame.</p>
</td></tr>
<tr><td><code id="data_frag_+3A_.attr">.attr</code></td>
<td>
<p>optional <code>data.frame</code> with xml row attributes</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="#topic+xml_fragment">xml_fragment()</a></code> object
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>persons &lt;- data.frame(
  name = c("John Doe", "Jane Doe"),
  age = c(30, 25),
  stringsAsFactors = FALSE
)

df &lt;- data_frag(persons, row_tag = "person")
print(df)

# setting ids on rows
persons &lt;- data.frame(
  name = c("John Doe", "Jane Doe"),
  age = c(30, 25),
  id = c("p1", "p2"),
  stringsAsFactors = FALSE
)

df &lt;- data_frag(
  persons[1:2],
  row_tag = "person",
  .attr = persons[3]
)

print(df)

# turning it into a document
doc &lt;- xml_doc("study", id = "1") / frag(
  source = "homeless db",
  data = df
)

cat(as.character(doc))
</code></pre>

<hr>
<h2 id='elem'>add an element to an xmlbuilder object</h2><span id='topic+elem'></span>

<h3>Description</h3>

<p>add an element to an xmlbuilder object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>elem(tag, text = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="elem_+3A_tag">tag</code></td>
<td>
<p>name of element</p>
</td></tr>
<tr><td><code id="elem_+3A_text">text</code></td>
<td>
<p>text contents of element</p>
</td></tr>
<tr><td><code id="elem_+3A_...">...</code></td>
<td>
<p>additional xml. attributes to be set</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an xmlbuilder object
</p>


<h3>Examples</h3>

<pre><code class='language-R'>xb &lt;- elem("homeless") /
  elem("person") / (
     elem("name","John Doe") +
     elem("age",35)
  ) +
  elem("person") /(
    elem("name","Jane Doe") +
    elem("age", 30)
  ) +
  elem("person") / (
    elem("name","Jim Doe") +
    elem("age", 25) +
    elem("address") / (
      elem("street", "123 Main St") +
      elem("city", "Anytown") +
      elem("state", "CA") +
      elem("zip", 12345)
    )
  )

print(xb)
xb$end()
xb$end()


doc &lt;- xb |&gt; xml2::as_xml_document()
doc |&gt; as.character() |&gt; cat()
</code></pre>

<hr>
<h2 id='frag'>Create a frag xml_fragment</h2><span id='topic+frag'></span>

<h3>Description</h3>

<p>Create a <code>frag</code> xml_fragment, that allows for multiple elements and nested
<code>frag</code>s.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>frag(..., .attr = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="frag_+3A_...">...</code></td>
<td>
<p>nest named elements and characters to include in the fragment (see example)</p>
</td></tr>
<tr><td><code id="frag_+3A_.attr">.attr</code></td>
<td>
<p>a list of attributes to add to the parent of the fragment</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code><a href="#topic+xml_fragment">xml_fragment()</a></code> object
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+xml_fragment">xml_fragment</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doc &lt;- xml_fragment(
  study = frag(
    .attr = c(id="1"),
    person = frag(
      .attr = c(id = "p1"),
      name = "John Doe",
      age = 30
    ),
    person = frag(
      name = "Jane Doe",
      age = 25,
      address = frag(street = "123 Main St", city = "Springfield"),
      "This is a text node"
    )
  )
)

print(doc)
if (require("xml2")){
  as_xml_document(doc)
}

# you can create a function to generate an xml fragment:
person_frag &lt;- function(name, age, id){
  tag("person", id = id) / frag(
    name = name,
    age  = age,
    address = frag(
      street = "123 Main St",
      city = "Springfield"
    )
  )
}

# xml_doc is a xml_fragment with the restriction of having one root element
doc2 &lt;- xml_doc("study") / (
  person_frag("John Doe", 30, "p1") +
  person_frag("Jane Doe", 25, "p2")
)

print(doc2)

if (require("xml2")){
  as_xml_document(doc2)
}

# a fragment can have multiple root elements
fgmt &lt;- person_frag("John Doe", 30, id = "p1") +
  person_frag("Jane Doe", 25, id = "p2")


print(fgmt)

if (require("xml2")){
  # as_xml_document won't work because it expects a single root element,
  # so we retrieve a nodeset instead
  as_xml_nodeset(fgmt)
}

iris_xml &lt;- xml_doc("fieldstudy", id = "iris", doi ="10.1111/j.1469-1809.1936.tb02137.x") /
  frag(
    source = "Fisher, R. A. (1936) The use of multiple measurements in
taxonomic problems. Annals of Eugenics, 7, Part II, 179–188.",
    data = data_frag(iris, row_tag = "obs")
  )

print(iris_xml, max_characters = 300)

if (require("xml2")){
  as_xml_document(iris_xml)
}
</code></pre>

<hr>
<h2 id='list_as_xml_document'>Convert a list to an xml_document</h2><span id='topic+list_as_xml_document'></span>

<h3>Description</h3>

<p><code>list_as_xml_document</code> is fast and efficient way to convert a list to an <code>xml2::xml_document</code>.
The preferred interface is to use <code><a href="#topic+xml_fragment">xml_fragment()</a></code> and <code><a href="#topic+xml_doc">xml_doc()</a></code> to create xml fragments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_as_xml_document(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_as_xml_document_+3A_x">x</code></td>
<td>
<p>a list as returned by <code><a href="xml2.html#topic+as_list">xml2::as_list()</a></code></p>
</td></tr>
<tr><td><code id="list_as_xml_document_+3A_...">...</code></td>
<td>
<p>reserved for future use</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>list_to_xml_document</code> is a much faster implementation of <code>xml2::as_xml_document.list()</code> method.
It writes the xml directly to a string buffer and then reads it back into an <code>xml2::xml_document</code>.
</p>
<p>The function can be used in tandem with <code><a href="xml2.html#topic+as_list">xml2::as_list()</a></code> to convert R data structures.
</p>


<h3>Value</h3>

<p>an <code>xml2::xml_document</code>
</p>


<h3>See Also</h3>

<p>Other xml2: 
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+list_as_xml_string">list_as_xml_string</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;-
  list(
    study = list(
      person = list(
        name = "John Doe",
        age = "30"
      ),
      person = list(
        name = "Jane Doe",
        age = "25"
      )
    )
  )

list_as_xml_string(data)
if (require("xml2")){
  list_as_xml_document(data)
}

#note the xml_fragment function is more powerful to create lists

data &lt;- xml_doc("study", id = "1") /
  frag(
    person = frag(
      name = "John Doe",
      age = "30"
    ),
    person = frag(
      name = "Jane Doe",
      age = "25"
    ),
    "This is a text node"
)

list_as_xml_string(data)
</code></pre>

<hr>
<h2 id='list_as_xml_string'>Convert a list to an xml string</h2><span id='topic+list_as_xml_string'></span>

<h3>Description</h3>

<p><code>list_to_xml_string</code> is fast and efficient way to convert a specific list to an xml string.
The preferred interface is to use <code><a href="#topic+xml_fragment">xml_fragment()</a></code> and <code><a href="#topic+xml_doc">xml_doc()</a></code> to create xml fragments.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>list_as_xml_string(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="list_as_xml_string_+3A_x">x</code></td>
<td>
<p>a list as returned by <code><a href="xml2.html#topic+as_list">xml2::as_list()</a></code></p>
</td></tr>
<tr><td><code id="list_as_xml_string_+3A_...">...</code></td>
<td>
<p>reserved for future use</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function is the working horse for turning <code><a href="#topic+xml_fragment">xml_fragment()</a></code>, <code><a href="#topic+xml_doc">xml_doc()</a></code> and list
object into <code>character</code> xml strings and <code>xml2::xml_document</code> objects.
</p>
<p>The input list format is identical to the format returned by <code><a href="xml2.html#topic+as_list">xml2::as_list()</a></code> function,
but much faster in generating an xml string from it. It writes the xml directly to a string buffer.
</p>
<p>This function allows for easy conversion of R data structures
into xml format by creating the list structures in R and then converting them to xml.
The function can be used in tandem with <code><a href="xml2.html#topic+as_list">xml2::as_list()</a></code> to convert R data structures.
</p>


<h3>Value</h3>

<p>a character string with the xml representation of the list
</p>


<h3>See Also</h3>

<p>Other xml2: 
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+list_as_xml_document">list_as_xml_document</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;-
  list(
    study = list(
      person = list(
        name = "John Doe",
        age = "30"
      ),
      person = list(
        name = "Jane Doe",
        age = "25"
      )
    )
  )

list_as_xml_string(data)
if (require("xml2")){
  list_as_xml_document(data)
}

#note the xml_fragment function is more powerful to create lists

data &lt;- xml_doc("study", id = "1") /
  frag(
    person = frag(
      name = "John Doe",
      age = "30"
    ),
    person = frag(
      name = "Jane Doe",
      age = "25"
    ),
    "This is a text node"
)

list_as_xml_string(data)
</code></pre>

<hr>
<h2 id='read_fragment'>Read an XML fragment from a string</h2><span id='topic+read_fragment'></span>

<h3>Description</h3>

<p>Reads a xml fragment from a string, a connection or a raw vector using
<code><a href="xml2.html#topic+read_xml">xml2::read_xml()</a></code>, and turns it into a <code><a href="#topic+xml_fragment">xml_fragment()</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_fragment(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_fragment_+3A_x">x</code></td>
<td>
<p>A string, a connection or a raw vector</p>
</td></tr>
<tr><td><code id="read_fragment_+3A_...">...</code></td>
<td>
<p>passed to <code><a href="xml2.html#topic+read_xml">xml2::read_xml()</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>an object of class <code>xml_fragment</code>
</p>

<hr>
<h2 id='tag'>Create a tag fragment</h2><span id='topic+tag'></span>

<h3>Description</h3>

<p>Create a tag fragment with optional text and attributes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tag(tag, text = NULL, ..., .attr = list(...))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="tag_+3A_tag">tag</code></td>
<td>
<p>character, the name of the tag</p>
</td></tr>
<tr><td><code id="tag_+3A_text">text</code></td>
<td>
<p>character, the text to include in the tag</p>
</td></tr>
<tr><td><code id="tag_+3A_...">...</code></td>
<td>
<p>additional attributes to add to the tag</p>
</td></tr>
<tr><td><code id="tag_+3A_.attr">.attr</code></td>
<td>
<p>a list of additional attributes to add to the tag, overrides the <code>...</code> argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an xml_fragment with the new tag added
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tag("greeting", "hi", id = "hi")

tag("person", id = "1") / (tag("name", "John Doe") + tag("age", 35))

xml_fragment(person = frag(
  .attr = c(id = 1),
  name = "John Doe",
  age = 30
))   / tag("address", "Unknown")


a &lt;- tag("person", id = 1) /
  xml_fragment(
    name ="John Doe",
    age = 30,
    address = frag(
      street = "123 Main St",
      city = "Springfield"
    )
  )

cat(as.character(a))
</code></pre>

<hr>
<h2 id='xml_doc'>Create an xml_fragment with a root element, (kind of tag)</h2><span id='topic+xml_doc'></span>

<h3>Description</h3>

<p>Create an xml_fragment with a root element, (kind of tag)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_doc(root, ..., .attr = list(...))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xml_doc_+3A_root">root</code></td>
<td>
<p>the name of the root element</p>
</td></tr>
<tr><td><code id="xml_doc_+3A_...">...</code></td>
<td>
<p>additional attributes to add to the tag</p>
</td></tr>
<tr><td><code id="xml_doc_+3A_.attr">.attr</code></td>
<td>
<p>a list of additional attributes to add to the tag, overrides the <code>...</code> argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>an <code>xml_fragment</code> with the root element
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
tag("greeting", "hi", id = "hi")

tag("person", id = "1") / (tag("name", "John Doe") + tag("age", 35))

xml_fragment(person = frag(
  .attr = c(id = 1),
  name = "John Doe",
  age = 30
))   / tag("address", "Unknown")


a &lt;- tag("person", id = 1) /
  xml_fragment(
    name ="John Doe",
    age = 30,
    address = frag(
      street = "123 Main St",
      city = "Springfield"
    )
  )

cat(as.character(a))
</code></pre>

<hr>
<h2 id='xml_fragment'>Create an XML fragment</h2><span id='topic+xml_fragment'></span>

<h3>Description</h3>

<p>Create an XML fragment using readable R syntax, that can be used to create
a string, an <code>xml2::xml_document</code> or as a building block for more complex XML documents.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xml_fragment(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xml_fragment_+3A_...">...</code></td>
<td>
<p>nest named elements and characters to include in the fragment (see example)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>An <code>xml_fragment</code> is built using:
</p>

<ul>
<li><p> named <code>frag</code> elements, each name is a tag name, and the value is the contents
of the tag, e.g. <code>name = "value"</code> becomes <code style="white-space: pre;">&#8288;&lt;name&gt;value&lt;/name&gt;&#8288;</code>. The value
can be a nested <code>frag</code> object, a character string or a numeric value.
</p>
</li>
<li> <p><code>.attr</code> attributes, which is set on current element, or on the <code>frag</code> where
it is specified
</p>
</li>
<li><p> unnamed elements, which are added as text nodes.
</p>
</li>
<li> <p><code><a href="#topic+data_frag">data_frag()</a></code> function that can be used to convert a data.frame to an xml fragment,
in which each row is a set of xml elements (columns).
</p>
</li>
<li> <p><code><a href="#topic+tag">tag()</a></code> function that can be used to create a tag with attributes and (optional) text.
</p>
</li></ul>

<p>An <code>xml_doc</code> is a special case of an <code>xml_fragment</code> that contains exactly one
root element, and errors when this is not the case.
</p>
<p>A resulting <code>xml_fragment</code> object can be converted to an <code>xml2::xml_document</code> with
<code><a href="xml2.html#topic+as_xml_document">xml2::as_xml_document()</a></code> or to a character string with <code><a href="base.html#topic+as.character">as.character()</a></code>. Both
methods are fast using a performant c++ implementation.
</p>


<h3>Value</h3>

<p>an <code>xml_fragment</code>, list object that can be converted to an <code>xml2::xml_document</code>
or <code>character</code> string
</p>


<h3>See Also</h3>

<p>Other xml_fragment: 
<code><a href="#topic+add_child_fragment">add_child_fragment</a>()</code>,
<code><a href="#topic+as.character.xml_fragment">as.character.xml_fragment</a>()</code>,
<code><a href="#topic+as_frag">as_frag</a>()</code>,
<code><a href="#topic+as_xml_nodeset">as_xml_nodeset</a>()</code>,
<code><a href="#topic+data_frag">data_frag</a>()</code>,
<code><a href="#topic+frag">frag</a>()</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>doc &lt;- xml_fragment(
  study = frag(
    .attr = c(id="1"),
    person = frag(
      .attr = c(id = "p1"),
      name = "John Doe",
      age = 30
    ),
    person = frag(
      name = "Jane Doe",
      age = 25,
      address = frag(street = "123 Main St", city = "Springfield"),
      "This is a text node"
    )
  )
)

print(doc)
if (require("xml2")){
  as_xml_document(doc)
}

# you can create a function to generate an xml fragment:
person_frag &lt;- function(name, age, id){
  tag("person", id = id) / frag(
    name = name,
    age  = age,
    address = frag(
      street = "123 Main St",
      city = "Springfield"
    )
  )
}

# xml_doc is a xml_fragment with the restriction of having one root element
doc2 &lt;- xml_doc("study") / (
  person_frag("John Doe", 30, "p1") +
  person_frag("Jane Doe", 25, "p2")
)

print(doc2)

if (require("xml2")){
  as_xml_document(doc2)
}

# a fragment can have multiple root elements
fgmt &lt;- person_frag("John Doe", 30, id = "p1") +
  person_frag("Jane Doe", 25, id = "p2")


print(fgmt)

if (require("xml2")){
  # as_xml_document won't work because it expects a single root element,
  # so we retrieve a nodeset instead
  as_xml_nodeset(fgmt)
}

iris_xml &lt;- xml_doc("fieldstudy", id = "iris", doi ="10.1111/j.1469-1809.1936.tb02137.x") /
  frag(
    source = "Fisher, R. A. (1936) The use of multiple measurements in
taxonomic problems. Annals of Eugenics, 7, Part II, 179–188.",
    data = data_frag(iris, row_tag = "obs")
  )

print(iris_xml, max_characters = 300)

if (require("xml2")){
  as_xml_document(iris_xml)
}
</code></pre>

<hr>
<h2 id='xmlbuilder'>Create a fast feed-forward XML builder</h2><span id='topic+xmlbuilder'></span>

<h3>Description</h3>

<p>This function creates an XML builder that allows you to create XML documents in a feed-forward manner.
<code>xmlbuilder</code> returns an object that has methods to create XML elements, text nodes, comments, and more.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>xmlbuilder(
  allow_fragments = TRUE,
  use_prolog = !allow_fragments,
  strict = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="xmlbuilder_+3A_allow_fragments">allow_fragments</code></td>
<td>
<p>logical. Should a warning be issued if the XML document has multiple root elements?
Set to <code>FALSE</code> to suppress when creating multiple xml fragments.</p>
</td></tr>
<tr><td><code id="xmlbuilder_+3A_use_prolog">use_prolog</code></td>
<td>
<p>logical. Should the XML prolog be included in the output?
Default is <code>TRUE</code>, which generate an UTF-8 xml prolog.
Set to <code>FALSE</code> if you want to generate an xml fragment or manually prepend the prolog.</p>
</td></tr>
<tr><td><code id="xmlbuilder_+3A_strict">strict</code></td>
<td>
<p>logical. Should the builder check for dangling nodes, default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Details</h3>


<ul>
<li> <p><code style="white-space: pre;">&#8288;$start(tag, ...)&#8288;</code> (or <code style="white-space: pre;">&#8288;$start_element&#8288;</code>) starts an element with a given tag and attributes.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$end()&#8288;</code> (or <code style="white-space: pre;">&#8288;$end_element&#8288;</code>) ends the current element.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$element(tag, text, ...)&#8288;</code> creates an element with a given tag, text, and attributes.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$text(text)&#8288;</code> creates a text node.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$fragment(..., .attr)&#8288;</code> writes an xml fragment to the.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$comment(comment)&#8288;</code> creates a comment node.
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;$to_xml_string()&#8288;</code> returns the XML document or fragments(s) as a character vector.
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class 'xmlbuilder
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b &lt;-xmlbuilder()

b$start("root")
  b$element("child1", "text1", attr1 = "value1")
  b$element("child2", "text2", attr2 = "value2")
  b$start("child3", attr3 = "value3")
    b$text("text3")
    b$element("child4", "text3", attr4 = "value4")
  b$end("child3")
b$end("root")

print(b)

if (require("xml2")) {
  # a builder can be converted to an xml_document using
  doc &lt;- as_xml_document(b)

  # or equivalentlty
  doc &lt;-
    b$to_xml_string() |&gt;
    read_xml()
}

# build some xml fragments
fms &lt;- xmlbuilder(allow_fragments = TRUE)

fms$start("person", id = "1")
  fms$element("name", "John Doe")
  fms$element("age", 30)
fms$end("person")

fms$start("person", id = "2")
  fms$element("name", "Jane Doe")
  fms$element("age", 25)
fms$end("person")

fms$start("person", id = "3")
  fms$element("name", "Jim Doe")
  fms$element("age", 35)
fms$end("person")

s &lt;- fms$to_xml_string()
as.character(fms)
length(s) # three fragments

# print xml string of the second fragment
print(s[2])

if (require("xml2")){
  # convert to xml_nodes
  nodes &lt;- fms$to_xml_node_list()
  length(nodes) # three nodes
  # show the second xml_node
  print(nodes[[2]])
}

# use fragments
xb &lt;- xmlbuilder()

xb$start("study")
xb$fragment(
  person = frag(
    name = "John Doe",
    age = 30
  ),
  person = frag(
    name = "Jane Doe",
    age = 25
  )
)
xb$end("study")
xb
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
