<!DOCTYPE html><html><head><title>Help for package LMfilteR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {LMfilteR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#EPF_L_compl'><p>Parameter Estimation Of Linear Models Using Evolutionary Particle Filters (EPF) Method</p></a></li>
<li><a href='#EPF_logist_compl'><p>Parameter Estimation Of Logistic Linear Models Using Evolutionary Particle Filters (EPF) Method</p></a></li>
<li><a href='#PF_lm'><p>Parameter Estimation Of Linear Regression Using Particle Filters</p></a></li>
<li><a href='#PF_lm_ss'><p>Parameter Estimation Of Linear Regression Using Particle Filters With Simple Sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Filter Methods for Parameter Estimation in Linear and Non Linear
Regression Models</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.3.1</td>
</tr>
<tr>
<td>Description:</td>
<td>We present a method based on filtering algorithms to estimate the parameters of linear, i.e. the coefficients and the variance of the error term. The proposed algorithms make use of Particle Filters following Ristic, B., Arulampalam, S., Gordon, N. (2004, ISBN: 158053631X) resampling methods. Parameters of logistic regression models are also estimated using an evolutionary particle filter method.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>MASS (&ge; 7.3-50), stats (&ge; 3.5.1)</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/ChrissCod/LMfilteR/issues">https://github.com/ChrissCod/LMfilteR/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-02-01 02:31:01 UTC; codcp</td>
</tr>
<tr>
<td>Author:</td>
<td>Christian Llano Robayo [aut, cre],
  Nazrul Shaikh [aut],
  Pegu Nilutpal [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Christian Llano Robayo &lt;info@cecareus.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-02-02 09:10:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='EPF_L_compl'>Parameter Estimation Of Linear Models Using Evolutionary Particle Filters (EPF) Method</h2><span id='topic+EPF_L_compl'></span>

<h3>Description</h3>

<p>Estimation of the parameters of a linear regression model using a particle filter method that includes two evolutionary algorithm-based steps. See <em>Details</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPF_L_compl(
  Data,
  Y,
  nPart = 1000L,
  p_mut = 0.01,
  p_cross = 0.5,
  sigma_l = 1,
  lmbd = 3,
  count = 10,
  initDisPar,
  resample_met = syst_rsmpl
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EPF_L_compl_+3A_data">Data</code></td>
<td>
<p>matrix. The matrix containing the independent variables of the linear model</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_y">Y</code></td>
<td>
<p>numeric. The dependent variable</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_npart">nPart</code></td>
<td>
<p>integer. The number of particles, by default 1000L</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_p_mut">p_mut</code></td>
<td>
<p>numeric. The mutation probability in EPF, by default 0.01</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_p_cross">p_cross</code></td>
<td>
<p>numeric. The cross-over probability in EPF, by default 0.5</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_sigma_l">sigma_l</code></td>
<td>
<p>The value of the variance in the likelihood normal, 1 by default</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_lmbd">lmbd</code></td>
<td>
<p>numeric. A number to be added and subtracted from the priors when <code>initDisPar</code> is not provided, by default 3</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_count">count</code></td>
<td>
<p>numeric. The number of replications within EPF, by default 10</p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_initdispar">initDisPar</code></td>
<td>
<p>matrix. Values a, b of the uniform distribution (via <code>runif</code>) for each parameter to be estimated, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="EPF_L_compl_+3A_resample_met">resample_met</code></td>
<td>
<p>function. The resampling method used in EPF, by default <code>syst_rsmpl</code>, see <em>Details</em></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the coefficients of a linear regression:
</p>
<p><code class="reqn">Y = \beta_0  + \beta_1*X_1 + ... + \beta_n*X_n  + \epsilon</code>,  (<code class="reqn">\epsilon \sim N(0,1)</code>)
</p>
<p>using Evolutionary Particle Filter. EPF includes additional steps within PF-base algorithm to avoid degeneracy of particles and prevent the curse of dimensionality.
One step is the inclusion of two evolutionary algorithm - based processes: mutation and cross-over. In mutation, <code>p_mut * nPart</code> particles are selected at random from the set of particles obtained in <code>k-1</code> PF-iteration.
This particles will be replaced by fresh new particles taken from a uniform distribution.
In cross-over, a pair of random particles is selected from the <code>k-1</code> propagated particles. The pair is combined into one particle (using the mean function) and the result replaces a particle selected at random from the <code>k-1</code> propagated particles.
This cross-over process is replicated <code>prob_cross * N</code> times on each iteration.
<code>EPF_L_compl</code> uses all the information to estimate the parameters, differs from function <code>EPF_L_MovH</code> by using <code>movH</code> equals <code>nrows(Data)</code>
</p>
<p>Similarly as in PF_lm and PF_lm_ss, the state-space equations of the linear model are:
</p>
<p><code class="reqn">(Eq. 1) X_{k} = a_0 + a_1 * X1_{k-1} + ... + a_n * Xn_{k-1}</code>
</p>
<p><code class="reqn">(Eq. 2) Y_{k} = X_{k} + \epsilon,  \epsilon \sim N(0,\sigma)</code>
</p>
<p>where, k = 2, ... , number of observations; <code class="reqn">a_0, ... , a_n</code> are the parameters to be estimated (coefficients), and <code class="reqn">\sigma = 1 </code>.
</p>
<p>The priors of the parameters are assumed uniformly distributed. <code>initDisPar</code> is a matrix; the number of rows is the number of independent variables plus one since the constant term of the regression is also estimated.
The first and second column of <code>initDisPar</code> are the corresponding arguments <code>a</code> and <code>b</code> of the uniform distribution (<code>stats::runif</code>) for each parameter prior.
The first row of <code>initDisPar</code> is the prior guess of the constant term. The following rows are the prior guesses of the coefficients.
If <code>initDisPar</code> is missing, the initial priors are taken using <code>lm()</code> and <code>coeff()</code> plus-minus <code>lmbd</code> as a reference.
</p>
<p>For <code>resample_met</code>, several resampling methods are used following Li, T., Bolic, M., &amp; Djuric, P. M. (2015). Resampling methods for particle filtering: classification, implementation, and strategies. IEEE Signal processing magazine, 32(3), 70-86.
Currently available resampling methods are: <code>syst_rsmpl</code> - systematic resampling (default), <code>multin_rsmpl</code> - multinomial resampling,
<code>strat_rsmpl</code> - stratified resampling, and <code>simp_rsmpl</code> - simple resampling (similar to PF_lm_ss)
</p>


<h3>Value</h3>

<p>A list with the following elements:
<code>smmry</code>: A summary matrix of the estimated parameters; first column is the OLS estimation, and second column is the EPF estimation.
<code>SSE</code>: The sum of squared errors of the EPF estimation.
<code>Yhat</code>: Estimation of the observation Y.
<code>sttp</code>: A matrix with the last iteration particles.
<code>estm</code>: A vector with the final parameter EPF estimation.
<code>c_time</code>: The time in seconds it takes to complete EPF.
</p>


<h3>Author(s)</h3>

<p>Christian Llano Robayo, Nazrul Shaikh.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#Example using linear model with 5 variables
#Using rcorrmatrix from cluterGeneration to generate a random correlation matrix
realval_coef &lt;- c(2, -1.25, 2.6, -0.7, -1.8, 0.6)
Data1 &lt;-  MASS::mvrnorm(100, mu = rep(0, 5),
                        Sigma = clusterGeneration::rcorrmatrix(5),
                        empirical = TRUE)
eps &lt;- stats::rnorm(100) # error term
Y_ &lt;- colSums(t(cbind(1,Data1)) * realval_coef) + eps
#run EPF
Res1 &lt;- EPF_L_compl(Data = Data1, Y = Y_)
#Summary EPF estimation
Res1$smmry

## End(Not run)
</code></pre>

<hr>
<h2 id='EPF_logist_compl'>Parameter Estimation Of Logistic Linear Models Using Evolutionary Particle Filters (EPF) Method</h2><span id='topic+EPF_logist_compl'></span>

<h3>Description</h3>

<p>Estimation of the parameters of a logistic regression using a particle filter method that includes
two evolutionary algorithm-based steps. See <em>Details</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EPF_logist_compl(
  Data,
  Y,
  nPart = 1000L,
  p_mut = 0.01,
  p_cross = 0.5,
  thr = 0.5,
  lmbd = 3,
  count = 10,
  initDisPar,
  resample_met = syst_rsmpl
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EPF_logist_compl_+3A_data">Data</code></td>
<td>
<p>matrix. The matrix containing the independent variables of the linear model</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_y">Y</code></td>
<td>
<p>numeric. The dependent variable</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_npart">nPart</code></td>
<td>
<p>integer. The number of particles, by default 1000L</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_p_mut">p_mut</code></td>
<td>
<p>numeric. The mutation probability in EPF, by default 0.01</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_p_cross">p_cross</code></td>
<td>
<p>numeric. The cross-over probability in EPF, by default 0.5</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_thr">thr</code></td>
<td>
<p>numeric. The threshold after which the estimated Y is classified as 1</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_lmbd">lmbd</code></td>
<td>
<p>numeric. A number to be added and subtracted from the priors when <code>initDisPar</code> is not provided, by default 3</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_count">count</code></td>
<td>
<p>numeric. The number of replications within EPF, by default 10</p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_initdispar">initDisPar</code></td>
<td>
<p>matrix. Values a, b of the uniform distribution (via <code>runif</code>) for each parameter to be estimated, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="EPF_logist_compl_+3A_resample_met">resample_met</code></td>
<td>
<p>function. The resampling method used in EPF, by default <code>syst_rsmpl</code>, see <em>Details</em></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the coefficients of a logistic linear regression using the  evolutionary particle filter.
EPF includes evolutionary algorithms (mutation and cross-over) within PF-base algorithm to avoid degeneracy of particles and prevent the curse of dimensionality.
In mutation, <code>p_mut * nPart</code> particles are selected at random from the set of particles obtained in <code>k-1</code> PF-iteration.
This particles will be replaced by fresh new particles taken from a uniform distribution.
In cross-over, a pair of random particles is selected from the <code>k-1</code> propagated particles. The pair is combined into one particle (using the mean) and the result replaces a particle selected at random from the <code>k-1</code> propagated particles.
This cross-over process is replicated <code>prob_cross * N</code> times on each iteration.
<code>EPF_logist_compl</code> uses all the information to estimate the parameters.
</p>
<p>The state-space equations of the logistic regression model are:
</p>
<p><code class="reqn">(Eq. 1) X_{k} = a_0 + a_1 * X1_{k-1} + ... + a_n * Xn_{k-1}</code>
</p>
<p><code class="reqn">(Eq. 2) Y_{k} =  1/(1 + exp(- X_{k}))</code>
</p>
<p><code class="reqn">(Eq. 3) Z_{k} \sim  Ber(Y_{k})</code>
</p>
<p>where, k = 1, ... , number of observations; <code class="reqn">a_0, ... , a_n</code> are the parameters to be estimated (coefficients), and <code class="reqn">Ber(\cdot)</code> is the Bernoulli distribution.
</p>
<p>The priors of the parameters are assumed uniformly distributed. In <code>initDisPar</code>, the number of rows is the number of independent variables plus one since the constant term of the regression is also estimated.
The first and second column of <code>initDisPar</code> are the corresponding arguments <code>a</code> and <code>b</code> of the uniform distribution (<code>stats::runif</code>) for each parameter prior.
The first row of <code>initDisPar</code> is the prior guess of the constant term. The following rows are the prior guesses of the coefficients.
If <code>initDisPar</code> is missing, the initial priors are taken using <code>glm()</code> and <code>coeff()</code> plus-minus <code>lmbd</code> as a reference.
</p>
<p>For <code>resample_met</code>, several resampling methods are used following Li, T., Bolic, M., &amp; Djuric, P. M. (2015). Resampling methods for particle filtering: classification, implementation, and strategies. IEEE Signal processing magazine, 32(3), 70-86.
Currently available resampling methods are: <code>syst_rsmpl</code> - systematic resampling (default), <code>multin_rsmpl</code> - multinomial resampling,
<code>strat_rsmpl</code> - stratified resampling, and <code>simp_rsmpl</code> - simple resampling (similar to PF_lm_ss)
</p>


<h3>Value</h3>

<p>A list with the following elements:
<code>smmry</code>: A summary matrix of the estimated parameters; first column is the GLM estimation, and second column is the EPF estimation.
<code>AIC</code>:  Akaike information criteria of the EPF estimation.
<code>Yhat</code>: Estimation of the observation Y.
<code>sttp</code>: A matrix with the last iteration parameters-particles.
<code>estm</code>: A vector with the final parameter EPF estimation.
<code>c_time</code>: The time in seconds it takes to complete EPF.
</p>


<h3>Author(s)</h3>

<p>Christian Llano Robayo, Nazrul Shaikh.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#Simulating logistic regression model
val_coef &lt;- c(2, -1.25, 2.6, -0.7, -1.8)
Data1 &lt;-  MASS::mvrnorm(100, mu = rep(0, 4),
                       Sigma = diag(4),
                       empirical = TRUE)
Y1 &lt;- colSums(t(cbind(1,Data1))*val_coef)
prb &lt;- 1 / (1 + exp(-Y1))
Y_ &lt;- rbinom(100, size = 1, prob = prb) ##
#Run EPF
Res &lt;- EPF_logist_compl(Data = Data1, Y = Y_)
#Summary EPF estimation
Res$smmry

## End(Not run)
</code></pre>

<hr>
<h2 id='PF_lm'>Parameter Estimation Of Linear Regression Using Particle Filters</h2><span id='topic+PF_lm'></span>

<h3>Description</h3>

<p>Estimation of the coefficients of a linear regression based on the particle filters algorithm (PF); given <code>Data1</code>, the function estimates the coefficients of the regression as the samples (particles) of coefficients that are more likely to occur. Optional, the standard deviation of the error term can also be estimated.
Synthetic data is generated in case no provided <code>Data1</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PF_lm(Y, Data1, n = 500L, sigma_l = 1, sigma_est = FALSE, initDisPar, lbd = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PF_lm_+3A_y">Y</code></td>
<td>
<p>numeric. The response variable</p>
</td></tr>
<tr><td><code id="PF_lm_+3A_data1">Data1</code></td>
<td>
<p>matrix. The matrix containing the independent variables</p>
</td></tr>
<tr><td><code id="PF_lm_+3A_n">n</code></td>
<td>
<p>integer. Number of particles, by default 500</p>
</td></tr>
<tr><td><code id="PF_lm_+3A_sigma_l">sigma_l</code></td>
<td>
<p>The value of the variance in the likelihood normal, 1 by default</p>
</td></tr>
<tr><td><code id="PF_lm_+3A_sigma_est">sigma_est</code></td>
<td>
<p>logical. If <code>TRUE</code> takes the last row of <code>initDisPar</code> as prior estimation of the standard deviation, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="PF_lm_+3A_initdispar">initDisPar</code></td>
<td>
<p>matrix. Values a, b of the uniform distribution (via <code>runif</code>) for each parameter to be estimated, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="PF_lm_+3A_lbd">lbd</code></td>
<td>
<p>numeric. A number to be added and substracted from the priors when <code>initDisPar</code> is not provided</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the coefficients of a linear regression:
</p>
<p><code class="reqn">Y = \beta_0  + \beta_1*X_1 + ... + \beta_n*X_n  + \epsilon</code>,  (<code class="reqn">\epsilon \sim N(0,1)</code>)
</p>
<p>using particle filter methods. The implementation follows An, D., Choi, J. H., Kim, N. H. (2013) adapted for the case of linear models.
</p>
<p>The state-space equations are:
</p>
<p><code class="reqn">(Eq. 1) X_{k} = a_0 + a_1 * X1_{k-1} + ... + a_n * Xn_{k-1}</code>
</p>
<p><code class="reqn">(Eq. 2) Y_{k} = X_{k} + \epsilon,  \epsilon \sim N(0,\sigma)</code>
</p>
<p>where, k = 2, ... , number of observations; <code class="reqn">a_0, ... , a_n</code> are the parameters to be estimated (coefficients), and <code class="reqn">\sigma = 1 </code>.
</p>
<p>The priors of the parameters are assumed uniformly distributed. <code>initDisPar</code> is a matrix for which the number of rows is the number of independent variables plus one when <code>sigma_est = FALSE</code>,
(plus one since we also estimate the constant term of the regression), or plus two when <code>sigma_est = TRUE</code> (one for the constant term of the regression, and one for the estimation of sigma).
The first and second column of <code>initDisPar</code> are the corresponding arguments <code>a</code> and <code>b</code> of the uniform distribution (<code>stats::runif</code>) of each parameter prior.
The first row of <code>initDisPar</code> is the prior guess of the constant term. The following rows are the prior guesses of the coefficients.
When sigma is estimated, i.e., if <code>sigma_est = TRUE</code> the last row of <code>initDisPar</code> corresponds to the prior guess for the standard deviation.
If <code>sigma_est = FALSE</code>, then the standard deviation of the likelihood is <code>sigma_l</code>.
If <code>sigma_est = TRUE</code>, the algorithm estimates the standard deviation of <code class="reqn">\epsilon</code> together with the coefficients.
If <code>initDisPar</code> is missing, the initial priors are taken using <code>lm()</code> and <code>coeff()</code> plus-minus <code>lbd</code> as a reference.
</p>
<p>The cumulative density function method is used for resampling.
</p>
<p>In case no <code>Data1</code> is provided, a synthetic data set is generated automatically taking three normal i.i.d. variables, and the dependent variable is computed as in
<code class="reqn">Y = 2 + 1.25*X_1 + 2.6*X_2 - 0.7*X_3 + \epsilon</code>
</p>


<h3>Value</h3>

<p>A list with the following elements:
</p>
<p><code>stateP_res</code>: A list of matrices with the PF estimation of the parameters on each observation; the number of rows is the number of observations in <code>Data1</code> and the number of columns is <code>n</code>.
</p>
<p><code>Likel</code>: A matrix with the likelihood of each particle obtained on each observation.
</p>
<p><code>CDF</code>:  A matrix with the cumulative distribution function for each column of <code>Likel</code>.
</p>
<p><code>summ</code>:  A summary matrix with statistics of the estimated parameters.
</p>


<h3>Author(s)</h3>

<p>Christian Llano Robayo, Nazrul Shaikh.
</p>


<h3>References</h3>

<p>An, D., Choi, J. H., Kim, N. H. (2013). Prognostics 101: A tutorial for particle filter-based prognostics algorithm using Matlab. Reliability Engineering &amp; System Safety, 115, DOI: https://doi.org/10.1016/j.ress.2013.02.019
</p>
<p>Ristic, B., Arulampalam, S., Gordon, N. (2004). Beyond the Kalman filter: particle filters for tracking applications. Boston, MA: Artech House. ISBN: 158053631X.
</p>
<p>West, M., Harrison, J. (1997). Bayesian forecasting and dynamic models (2nd ed.). New York: Springer. ISBN: 0387947256.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#### Using default Data1, no sigma estimation ####
Res &lt;- PF_lm(n=1000L, sigma_est = FALSE)
lapply(Res,class) # Structure of returning list.
###Summary of estimated parameters
Res$summ
par(mfrow=c(2, 2)) #Evolution of the estimated parameters
for (i in 1:4){
plot(apply(Res$stateP_res[[i]],1,mean), main = colnames(Res$summ)[i], col="blue",
      xlab =  "", ylab = "",type="l")
}


#### Using default Data1, with sigma estimation ####
Res2 &lt;- PF_lm(n=1000L, sigma_est = TRUE)
lapply(Res2,class) # Structure of returning list
sumRes2 &lt;- sapply(2:6, function(i)
###Summary of estimated parameters
Res2$summ

par(mfrow=c(2, 3)) #Evolution of the estimated parameters
for (i in 1:5){
plot(apply(Res2$stateP_res[[i]],1,mean), main = colnames(Res2$summ)[i], col="blue",
       xlab =  "", ylab = "",type="l")
}


#### Using default Data1, given initDisPar ####
b0 &lt;- matrix(c( 1.9, 2, # Prior of a_0
                1, 1.5, # Prior of a_1
                2, 3,   # Prior of a_2
                -1, 0)  # Prior of a_3
                ,ncol = 2, byrow = TRUE )
Res3 &lt;- PF_lm(n=500L, sigma_est = FALSE, initDisPar = b0)
lapply(Res3,class) # Structure of returning list.

###Summary of estimated parameters
Res3$summ
par(mfrow=c(2, 2)) #Evolution of the estimated parameters
for (i in 1:4){
plot(apply(Res3$stateP_res[[i]],1,mean), main = colnames(Res3$summ)[i], col="blue",
      xlab =  "", ylab = "",type="l")
}

## End(Not run)

</code></pre>

<hr>
<h2 id='PF_lm_ss'>Parameter Estimation Of Linear Regression Using Particle Filters With Simple Sampling</h2><span id='topic+PF_lm_ss'></span>

<h3>Description</h3>

<p>Estimation of the coefficients of a linear regression based on the particle filters algorithm. This function is similar to <code>PF_lm</code> except for the resampling method which in this case is the simple sampling.
As a result, the user can try higher number of particles.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PF_lm_ss(
  Y,
  Data1,
  n = 500L,
  sigma_l = 1,
  sigma_est = FALSE,
  initDisPar,
  lbd = 2
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="PF_lm_ss_+3A_y">Y</code></td>
<td>
<p>numeric. The response variable</p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_data1">Data1</code></td>
<td>
<p>matrix. The matrix containing the independent variables</p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_n">n</code></td>
<td>
<p>integer. Number of particles, by default 500</p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_sigma_l">sigma_l</code></td>
<td>
<p>The variance of the normal likelihood, 1 by default</p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_sigma_est">sigma_est</code></td>
<td>
<p>logical. If <code>TRUE</code> takes the last row of <code>initDisPar</code> as prior estimation of the standard deviation, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_initdispar">initDisPar</code></td>
<td>
<p>matrix. Values a, b of the uniform distribution (via <code>runif</code>) for each parameter to be estimated, see more in <em>Details</em></p>
</td></tr>
<tr><td><code id="PF_lm_ss_+3A_lbd">lbd</code></td>
<td>
<p>numeric. A number to be added and substracted from the priors when <code>initDisPar</code> is not provided</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Estimation of the coefficients of a linear regression:
</p>
<p><code class="reqn">Y = \beta_0  + \beta_1*X_1 + ... + \beta_n*X_n  + \epsilon</code>,  (<code class="reqn">\epsilon \sim N(0,1)</code>)
</p>
<p>using particle filter methods.
The state-space equations are:
</p>
<p><code class="reqn">(Eq. 1) X_{k} = a_0 + a_1 * X1_{k-1} + ... + a_n * Xn_{k-1}</code>
</p>
<p><code class="reqn">(Eq. 2) Y_{k} = X_{k} + \epsilon,  \epsilon \sim N(0,\sigma)</code>
</p>
<p>where, k = 2, ... , number of observations; <code class="reqn">a_0, ... , a_n</code> are the parameters to be estimated (coefficients), and <code class="reqn">\sigma = 1 </code>.
</p>
<p>The priors of the parameters are assumed uniformly distributed. <code>initDisPar</code> is a matrix for which the number of rows is the number of independent variables plus one when <code>sigma_est = FALSE</code>,
(plus one since we also estimate the constant term of the regression), or plus two when <code>sigma_est = TRUE</code> (one for the constant term of the regression, and one for the estimation of sigma).
The first and second column of <code>initDisPar</code> are the corresponding arguments <code>a</code> and <code>b</code> of the uniform distribution (<code>stats::runif</code>) of each parameter prior.
The first row <code>initDisPar</code> is the prior guess of the constant term. The following rows are the prior guesses of the coefficients.
When sigma is estimated, i.e., if <code>sigma_est = TRUE</code> the last row of <code>initDisPar</code> corresponds to the prior guess for the standard deviation.
If <code>sigma_est = FALSE</code>, then the standard deviation of the likelihood is <code>sigma_l</code>.
If <code>sigma_est = TRUE</code>, the algorithm estimates the standard deviation of <code class="reqn">\epsilon</code> together with the coefficients.
If <code>initDisPar</code> is missing, the initial priors are taken using <code>lm()</code> and <code>coeff()</code> plus-minus <code>lbd</code> as a reference.
</p>
<p>The resampling method used corresponds to the simple sampling, i.e., we take a sample of <code>n</code> particles with probability equals the likelihood computed on each iteration.
In addition, on each iteration white noise is added to avoid particles to degenerate.
</p>
<p>In case no <code>Data1</code> is provided, a synthetic data set is generated automatically taking three normal i.i.d. variables, and the dependent variable is computed as in
<code class="reqn">Y = 2 + 1.25*X_1 + 2.6*X_2 - 0.7*X_3 + \epsilon</code>
</p>


<h3>Value</h3>

<p>A list containing the following elemnts:
</p>
<p><code>stateP_res</code>: A list of matrices with the PF estimation of the parameters on each observation; the number of rows is the number of observations in <code>Data1</code> and the number of columns is <code>n</code>.
</p>
<p><code>Likel</code>: A matrix with the likelihood of each particle obtained on each observation.
</p>


<h3>Author(s)</h3>

<p>Christian Llano Robayo, Nazrul Shaikh.
</p>


<h3>References</h3>

<p>Ristic, B., Arulampalam, S., Gordon, N. (2004). Beyond the Kalman filter: particle filters for tracking applications. Boston, MA: Artech House. ISBN: 158053631X.
</p>
<p>West, M., Harrison, J. (1997). Bayesian forecasting and dynamic models (2nd ed.). New York: Springer. ISBN: 0387947256.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
#### Using default Data1, no sigma estimation ####
Res &lt;- PF_lm_ss(n = 10000L, sigma_est = FALSE) #10 times more than in PF_lm
lapply(Res,class) # Structure of returning list.
###Summary of estimated parameters
Res$summ
#Evolution of the estimated parameters
par(mfrow=c(2, 2))
for (i in 1:4){
plot(apply(Res$stateP_res[[i]],1,mean), main = colnames(Res$summ)[i], col="blue",
      xlab =  "", ylab = "",type="l")
}


#### Using default Data1, with sigma estimation ####
Res2 &lt;- PF_lm_ss(n = 1000L, sigma_est = TRUE)
lapply(Res2,class) # Structure of returning list
###Summary of the estimated parameters
Res2$summ
#Evolution of the estimated parameters
par(mfrow=c(2, 3))
for (i in 1:5){
plot(apply(Res2$stateP_res[[i]],1,mean), main = colnames(Res2$summ)[i], col="blue",
       xlab =  "", ylab = "",type="l")
}


#### Using default Data1, given initDisPar ####
b0 &lt;- matrix(c(1.9, 2, # Prior of a_0
               1, 1.5, # Prior of a_1
               2, 3,   # Prior of a_2
               -1, 0),  # Prior of a_3
               ncol = 2, byrow = TRUE )
Res3 &lt;- PF_lm_ss(n = 10000L, sigma_est = FALSE, initDisPar = b0)
lapply(Res3,class) # Structure of returning list.
###Summary of the estimated parameters
Res3$summ
#Evolution of the estimated parameters
par(mfrow=c(2, 2))
for (i in 1:4){
plot(apply(Res3$stateP_res[[i]],1,mean), main = colnames(Res3$summ)[i], col="blue",
    xlab =  "", ylab = "",type="l")
    }

## End(Not run)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
