<!DOCTYPE html><html lang="en"><head><title>Help for package immcp</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {immcp}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BasicData-class'><p>Class <code>BasicData</code></p>
This class represents the basic input data.</a></li>
<li><a href='#BioDescr-class'><p>Class <code>BioDescr</code></p>
This class represents the biological descriptor data.</a></li>
<li><a href='#CreateBasicData'><p>CreateBasicData</p></a></li>
<li><a href='#CreateDisDrugNet'><p>CreateDisDrugNet</p></a></li>
<li><a href='#diff_network_char'><p>diff_network_char</p></a></li>
<li><a href='#drugdemo'><p>Datasets</p>
Demo dataset</a></li>
<li><a href='#enrich_f'><p>enrich_f</p></a></li>
<li><a href='#exportCytoscape'><p>Export an xlsx file to Cytoscape</p></a></li>
<li><a href='#extr_biodescr'><p>Extract Biological descriptor</p></a></li>
<li><a href='#extr_biodescr+2CBasicData-method'><p>Extract Biological descriptor</p></a></li>
<li><a href='#HerbResult-class'><p>Class <code>HerbResult</code></p>
This class represents the biological descriptor data.</a></li>
<li><a href='#natural_connectivity'><p>natural_connectivity</p></a></li>
<li><a href='#network_char'><p>network_char</p></a></li>
<li><a href='#network_node_ks'><p>network_node_ks</p></a></li>
<li><a href='#plot_BioDescr'><p>Plot Biological descriptor</p></a></li>
<li><a href='#plot_graph'><p>Plot Disease-Drug Network</p></a></li>
<li><a href='#PrepareData'><p>PrepareData</p></a></li>
<li><a href='#read_gmt'><p>write_gmt</p></a></li>
<li><a href='#score_network'><p>score_network</p></a></li>
<li><a href='#score_rule'><p>Mining herb-herb associations with Apriori</p></a></li>
<li><a href='#score_sim'><p>Calculating similarity between drug and disease</p></a></li>
<li><a href='#to_biodescr'><p>to_biodescr</p></a></li>
<li><a href='#to_df'><p>to_df</p></a></li>
<li><a href='#to_list'><p>to_list</p></a></li>
<li><a href='#write_gmt'><p>write_gmt</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Poly-Pharmacology Toolkit for Traditional Chinese Medicine
Research</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.3</td>
</tr>
<tr>
<td>Description:</td>
<td>Toolkit for Poly-pharmacology Research of Traditional Chinese Medicine. Based on the
    biological descriptors and drug-disease interaction networks, it can
    analyze the potential poly-pharmacological mechanisms of Traditional Chinese Medicine and be
    used for drug-repositioning in Traditional Chinese Medicine.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/YuanlongHu/immcp">https://github.com/YuanlongHu/immcp</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/YuanlongHu/immcp/issues">https://github.com/YuanlongHu/immcp/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>igraph, R (&ge; 4.0.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>clusterProfiler, DOSE, dplyr, methods, magrittr, Matrix,
openxlsx, org.Hs.eg.db, pbapply, proxyC, purrr, rlang (&ge;
1.0.2), stats, utils, visNetwork (&ge; 0.3.1), arules, ggplot2,
ggheatmap, factoextra</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.2</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-05-12 05:24:26 UTC; DELL</td>
</tr>
<tr>
<td>Author:</td>
<td>Yuanlong Hu <a href="https://orcid.org/0000-0003-1933-7570"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Yuanlong Hu &lt;huyuanlong1996@163.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-05-12 05:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='BasicData-class'>Class <code>BasicData</code>
This class represents the basic input data.</h2><span id='topic+BasicData-class'></span>

<h3>Description</h3>

<p>Class <code>BasicData</code>
This class represents the basic input data.
</p>


<h3>Slots</h3>


<dl>
<dt><code>drugnet</code></dt><dd><p>A directed graph</p>
</dd>
<dt><code>vertices</code></dt><dd><p>Vertices of drug graph.</p>
</dd>
<dt><code>diseasenet</code></dt><dd><p>Disease network.</p>
</dd>
<dt><code>biomarker</code></dt><dd><p>Disease-related gene.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='BioDescr-class'>Class <code>BioDescr</code>
This class represents the biological descriptor data.</h2><span id='topic+BioDescr-class'></span>

<h3>Description</h3>

<p>Class <code>BioDescr</code>
This class represents the biological descriptor data.
</p>


<h3>Slots</h3>


<dl>
<dt><code>drug_geneset</code></dt><dd><p>from drug to geneset.</p>
</dd>
<dt><code>geneset_gene</code></dt><dd><p>from geneset to gene for each drug.</p>
</dd>
<dt><code>anno</code></dt><dd><p>Geneset ID and description.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='CreateBasicData'>CreateBasicData</h2><span id='topic+CreateBasicData'></span>

<h3>Description</h3>

<p>Create BasicData Object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CreateBasicData(..., diseasenet = NULL, biomarker = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CreateBasicData_+3A_...">...</code></td>
<td>
<p>Drug graph from <code>PrepareData</code>.</p>
</td></tr>
<tr><td><code id="CreateBasicData_+3A_diseasenet">diseasenet</code></td>
<td>
<p>A graph of Disease-related gene from <code>PrepareData</code>.</p>
</td></tr>
<tr><td><code id="CreateBasicData_+3A_biomarker">biomarker</code></td>
<td>
<p>Character vector, the vector of Disease-related gene.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A BasicData object.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
</code></pre>

<hr>
<h2 id='CreateDisDrugNet'>CreateDisDrugNet</h2><span id='topic+CreateDisDrugNet'></span>

<h3>Description</h3>

<p>Create Disease-Drug Network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CreateDisDrugNet(BasicData, drug, disease)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CreateDisDrugNet_+3A_basicdata">BasicData</code></td>
<td>
<p>BasicData object.</p>
</td></tr>
<tr><td><code id="CreateDisDrugNet_+3A_drug">drug</code></td>
<td>
<p>Character vector, the drug.</p>
</td></tr>
<tr><td><code id="CreateDisDrugNet_+3A_disease">disease</code></td>
<td>
<p>Character vector, the disease.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A igraph object.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
DisDrugNet &lt;- CreateDisDrugNet(BasicData, drug = "Drug1", disease = "disease")
</code></pre>

<hr>
<h2 id='diff_network_char'>diff_network_char</h2><span id='topic+diff_network_char'></span>

<h3>Description</h3>

<p>Calculate the difference of network characters in two network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>diff_network_char(graph1, graph2, output_all = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="diff_network_char_+3A_graph1">graph1</code></td>
<td>
<p>A igraph object.</p>
</td></tr>
<tr><td><code id="diff_network_char_+3A_graph2">graph2</code></td>
<td>
<p>A igraph object.</p>
</td></tr>
<tr><td><code id="diff_network_char_+3A_output_all">output_all</code></td>
<td>
<p>FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number vector.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='drugdemo'>Datasets
Demo dataset</h2><span id='topic+drugdemo'></span>

<h3>Description</h3>

<p>Datasets
Demo dataset
</p>

<hr>
<h2 id='enrich_f'>enrich_f</h2><span id='topic+enrich_f'></span>

<h3>Description</h3>

<p>Enrich Analysis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>enrich_f(
  target_character,
  geneset = c("kegg", "mkegg", "go", "wp"),
  arguments = list(minGSSize = 5, maxGSSize = 500, pvalue = 0.05, qvalue = 0.1),
  out_dataframe = TRUE,
  to_ENTREZID = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="enrich_f_+3A_target_character">target_character</code></td>
<td>
<p>Charactor vector of gene.</p>
</td></tr>
<tr><td><code id="enrich_f_+3A_geneset">geneset</code></td>
<td>
<p>Charactor vector, one of &quot;kegg&quot;(KEGG), &quot;mkegg&quot;(KEGG Module), &quot;go&quot;(GO-BP), and &quot;wp&quot;(WikiPathways); a data frame and list.</p>
</td></tr>
<tr><td><code id="enrich_f_+3A_arguments">arguments</code></td>
<td>
<p>A list of the arguments of <code>clusterProfiler</code>, including <code>minGSSize</code>, <code>maxGSSize</code>, <code>pvalue</code>, and <code>qvalue</code>.</p>
</td></tr>
<tr><td><code id="enrich_f_+3A_out_dataframe">out_dataframe</code></td>
<td>
<p>Logical, whether to output data frame,defaults to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="enrich_f_+3A_to_entrezid">to_ENTREZID</code></td>
<td>
<p>Logical, whether to translate to ENTREZID from SYMBOL, defaults to <code>TRUE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='exportCytoscape'>Export an xlsx file to Cytoscape</h2><span id='topic+exportCytoscape'></span>

<h3>Description</h3>

<p>Export an xlsx file to Cytoscape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exportCytoscape(graph, file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="exportCytoscape_+3A_graph">graph</code></td>
<td>
<p>igraph object.</p>
</td></tr>
<tr><td><code id="exportCytoscape_+3A_file">file</code></td>
<td>
<p>file</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A workbook object
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='extr_biodescr'>Extract Biological descriptor</h2><span id='topic+extr_biodescr'></span>

<h3>Description</h3>

<p>Extract Biological descriptor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extr_biodescr(
  BasicData,
  geneset = c("kegg", "mkegg", "go", "wp"),
  arguments = list(minGSSize = 5, maxGSSize = 500, pvalue = 0.05, qvalue = 0.1),
  ref_type = "drug",
  ref = NULL,
  to_ENTREZID = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_biodescr_+3A_basicdata">BasicData</code></td>
<td>
<p>BasicData object.</p>
</td></tr>
<tr><td><code id="extr_biodescr_+3A_geneset">geneset</code></td>
<td>
<p>Charactor vector, one of &quot;kegg&quot;(KEGG), &quot;mkegg&quot;(KEGG Module), &quot;go&quot;(GO-BP), and &quot;wp&quot;(WikiPathways); a data frame and list.</p>
</td></tr>
<tr><td><code id="extr_biodescr_+3A_arguments">arguments</code></td>
<td>
<p>A list of the arguments of <code>clusterProfiler</code>, including <code>minGSSize</code>, <code>maxGSSize</code>, <code>pvalue</code>, and <code>qvalue</code>.</p>
</td></tr>
<tr><td><code id="extr_biodescr_+3A_ref_type">ref_type</code></td>
<td>
<p>Charactor vector, one of &quot;drug&quot;, &quot;herb&quot;, &quot;compound&quot; or &quot;target&quot;, defaults to &quot;drug&quot;.</p>
</td></tr>
<tr><td><code id="extr_biodescr_+3A_ref">ref</code></td>
<td>
<p>Charactor vector, reference drug, herb, compound or target, defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="extr_biodescr_+3A_to_entrezid">to_ENTREZID</code></td>
<td>
<p>Logical, whether to translate to ENTREZID from SYMBOL, defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A BioDescr object.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='extr_biodescr+2CBasicData-method'>Extract Biological descriptor</h2><span id='topic+extr_biodescr+2CBasicData-method'></span>

<h3>Description</h3>

<p>Extract Biological descriptor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S4 method for signature 'BasicData'
extr_biodescr(
  BasicData,
  geneset = c("kegg", "mkegg", "go", "wp"),
  arguments = list(minGSSize = 5, maxGSSize = 500, pvalue = 0.05, qvalue = 0.1),
  ref_type = "drug",
  ref = NULL,
  to_ENTREZID = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_basicdata">BasicData</code></td>
<td>
<p>BasicData object.</p>
</td></tr>
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_geneset">geneset</code></td>
<td>
<p>Charactor vector, one of &quot;kegg&quot;(KEGG), &quot;mkegg&quot;(KEGG Module), &quot;go&quot;(GO-BP), and &quot;wp&quot;(WikiPathways); a data frame and list.</p>
</td></tr>
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_arguments">arguments</code></td>
<td>
<p>A list of the arguments of <code>clusterProfiler</code>, including <code>minGSSize</code>, <code>maxGSSize</code>, <code>pvalue</code>, and <code>qvalue</code>.</p>
</td></tr>
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_ref_type">ref_type</code></td>
<td>
<p>Charactor vector, one of &quot;drug&quot;, &quot;herb&quot;, &quot;compound&quot; or &quot;target&quot;, defaults to &quot;drug&quot;.</p>
</td></tr>
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_ref">ref</code></td>
<td>
<p>Charactor vector, reference drug, herb, compound or target, defaults to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="extr_biodescr+2B2CBasicData-method_+3A_to_entrezid">to_ENTREZID</code></td>
<td>
<p>Logical, whether to translate to ENTREZID from SYMBOL, defaults to TRUE.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A BioDescr object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
biodescr &lt;- extr_biodescr(BasicData, geneset= "kegg")

## End(Not run)
</code></pre>

<hr>
<h2 id='HerbResult-class'>Class <code>HerbResult</code>
This class represents the biological descriptor data.</h2><span id='topic+HerbResult-class'></span>

<h3>Description</h3>

<p>Class <code>HerbResult</code>
This class represents the biological descriptor data.
</p>


<h3>Slots</h3>


<dl>
<dt><code>Drug_Herb</code></dt><dd><p>Data frame, Drug-herb relationship.</p>
</dd>
<dt><code>Herb_Herb</code></dt><dd><p>Herb-herb association Rule Graph, it is a directed graph.</p>
</dd>
</dl>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='natural_connectivity'>natural_connectivity</h2><span id='topic+natural_connectivity'></span>

<h3>Description</h3>

<p>Calculate the natural connectivity
</p>


<h3>Usage</h3>

<pre><code class='language-R'>natural_connectivity(graph)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="natural_connectivity_+3A_graph">graph</code></td>
<td>
<p>A igraph object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='network_char'>network_char</h2><span id='topic+network_char'></span>

<h3>Description</h3>

<p>Calculate the network characters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>network_char(graph, total_network = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="network_char_+3A_graph">graph</code></td>
<td>
<p>The graph.</p>
</td></tr>
<tr><td><code id="network_char_+3A_total_network">total_network</code></td>
<td>
<p>Calculate for total network or each nodes.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number vector or data frame.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='network_node_ks'>network_node_ks</h2><span id='topic+network_node_ks'></span>

<h3>Description</h3>

<p>Kolmogorov-Smirnov tests for node characters between networks
</p>


<h3>Usage</h3>

<pre><code class='language-R'>network_node_ks(graph1, graph2, replicate = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="network_node_ks_+3A_graph1">graph1</code></td>
<td>
<p>A igraph object.</p>
</td></tr>
<tr><td><code id="network_node_ks_+3A_graph2">graph2</code></td>
<td>
<p>A igraph object.</p>
</td></tr>
<tr><td><code id="network_node_ks_+3A_replicate">replicate</code></td>
<td>
<p>Number vector, the number of conduct bootstrapping sampling replications.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='plot_BioDescr'>Plot Biological descriptor</h2><span id='topic+plot_BioDescr'></span>

<h3>Description</h3>

<p>Plot Biological descriptor
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_BioDescr(
  BioDescr,
  type = "heatmap",
  cluster_k = 2,
  colors = c("#2E9FDF", "#E7B800")
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_BioDescr_+3A_biodescr">BioDescr</code></td>
<td>
<p>BioDescr object.</p>
</td></tr>
<tr><td><code id="plot_BioDescr_+3A_type">type</code></td>
<td>
<p>one of &quot;heatmap&quot; and &quot;clusterplot&quot;.</p>
</td></tr>
<tr><td><code id="plot_BioDescr_+3A_cluster_k">cluster_k</code></td>
<td>
<p>Number vector, number of cluster.</p>
</td></tr>
<tr><td><code id="plot_BioDescr_+3A_colors">colors</code></td>
<td>
<p>vector of colors.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns NULL, invisibly.
</p>

<hr>
<h2 id='plot_graph'>Plot Disease-Drug Network</h2><span id='topic+plot_graph'></span><span id='topic+plot_graph+2CBasicData-method'></span><span id='topic+plot_graph+2Cigraph-method'></span><span id='topic+plot_graph+2CHerbResult-method'></span>

<h3>Description</h3>

<p>Plot Disease-Drug Network
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_graph(
  graph,
  drug,
  disease,
  Isolated = TRUE,
  vis = "visNetwork",
  color = c(drug = "#cca4e3", herb = "#ff461f", compound = "#ffc773", target =
    "#70f3ff"),
  width = 1,
  size = 20,
  ...
)

## S4 method for signature 'BasicData'
plot_graph(
  graph,
  drug,
  disease,
  Isolated = TRUE,
  vis = "visNetwork",
  color = c(drug = "#cca4e3", herb = "#ff461f", compound = "#ffc773", target =
    "#70f3ff"),
  width = 1,
  size = 20,
  ...
)

## S4 method for signature 'igraph'
plot_graph(
  graph,
  drug,
  disease,
  Isolated = TRUE,
  vis = "visNetwork",
  color = c(drug = "#cca4e3", herb = "#ff461f", compound = "#ffc773", target =
    "#70f3ff"),
  width = 1,
  size = 20,
  ...
)

## S4 method for signature 'HerbResult'
plot_graph(
  graph,
  drug,
  disease,
  Isolated = TRUE,
  vis = "visNetwork",
  color = c(drug = "#cca4e3", herb = "#ff461f", compound = "#ffc773", target =
    "#70f3ff"),
  width = 1,
  size = 20,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_graph_+3A_graph">graph</code></td>
<td>
<p>graph.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_drug">drug</code></td>
<td>
<p>drug.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_disease">disease</code></td>
<td>
<p>disease.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_isolated">Isolated</code></td>
<td>
<p>Whether to delect Isolated nodes.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_vis">vis</code></td>
<td>
<p>one of &quot;igraph&quot;, &quot;visNetwork&quot; and &quot;shiny&quot;.</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_color">color</code></td>
<td>
<p>Nodes Color</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_width">width</code></td>
<td>
<p>Edges width</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_size">size</code></td>
<td>
<p>Nodes size</p>
</td></tr>
<tr><td><code id="plot_graph_+3A_...">...</code></td>
<td>
<p>Arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns NULL, invisibly.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='PrepareData'>PrepareData</h2><span id='topic+PrepareData'></span>

<h3>Description</h3>

<p>Prepare input format.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>PrepareData(..., from, to, diseaseID, format = "single", sep)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="PrepareData_+3A_...">...</code></td>
<td>
<p>data frame, containing interaction information.</p>
</td></tr>
<tr><td><code id="PrepareData_+3A_from">from</code></td>
<td>
<p>A charactor vector, containing &quot;drug&quot;, &quot;herb&quot;, &quot;compound&quot;, or &quot;target&quot;.</p>
</td></tr>
<tr><td><code id="PrepareData_+3A_to">to</code></td>
<td>
<p>A character vector, containing &quot;drug&quot;, &quot;herb&quot;, &quot;compound&quot;, or &quot;target&quot;.</p>
</td></tr>
<tr><td><code id="PrepareData_+3A_diseaseid">diseaseID</code></td>
<td>
<p>Charactor vector, diseaseID</p>
</td></tr>
<tr><td><code id="PrepareData_+3A_format">format</code></td>
<td>
<p>one of &quot;single&quot; or &quot;basket&quot;.</p>
</td></tr>
<tr><td><code id="PrepareData_+3A_sep">sep</code></td>
<td>
<p>Separator.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A igraph object.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
</code></pre>

<hr>
<h2 id='read_gmt'>write_gmt</h2><span id='topic+read_gmt'></span>

<h3>Description</h3>

<p>parse gmt file to a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_gmt(gmtfile, out_dataframe = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="read_gmt_+3A_gmtfile">gmtfile</code></td>
<td>
<p>A GMT file name or URL containing gene sets.</p>
</td></tr>
<tr><td><code id="read_gmt_+3A_out_dataframe">out_dataframe</code></td>
<td>
<p>TRUE or FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame, list
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

<hr>
<h2 id='score_network'>score_network</h2><span id='topic+score_network'></span>

<h3>Description</h3>

<p>Calculating differences in disease network characteristics before and after removal of drug targets
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_network(BasicData, n = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="score_network_+3A_basicdata">BasicData</code></td>
<td>
<p>A BasicData object.</p>
</td></tr>
<tr><td><code id="score_network_+3A_n">n</code></td>
<td>
<p>Number vector, the number of times random permutation sampling, default to 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
res &lt;- score_network(BasicData, n = 100)
</code></pre>

<hr>
<h2 id='score_rule'>Mining herb-herb associations with Apriori</h2><span id='topic+score_rule'></span>

<h3>Description</h3>

<p>Mine herb-herb association rules of prescription using the Apriori algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_rule(BasicData, drug = NULL, support = 0.1, confidence = 0.8)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="score_rule_+3A_basicdata">BasicData</code></td>
<td>
<p>BasicData object.</p>
</td></tr>
<tr><td><code id="score_rule_+3A_drug">drug</code></td>
<td>
<p>Charactor vector of drug names to analyze, default to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="score_rule_+3A_support">support</code></td>
<td>
<p>A numeric value for the minimal support of an item set, default to 0.1.</p>
</td></tr>
<tr><td><code id="score_rule_+3A_confidence">confidence</code></td>
<td>
<p>A numeric value for the minimal confidence of an item set, default to 0.8.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A HerbResult object.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
res &lt;- score_rule(BasicData, support = 0.1,confidence = 0.8)

## End(Not run)
</code></pre>

<hr>
<h2 id='score_sim'>Calculating similarity between drug and disease</h2><span id='topic+score_sim'></span>

<h3>Description</h3>

<p>Calculating drug-disease similarity based on biological descriptors
</p>


<h3>Usage</h3>

<pre><code class='language-R'>score_sim(BioDescr, method = "jaccard", n = 1000)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="score_sim_+3A_biodescr">BioDescr</code></td>
<td>
<p>BioDescr object.</p>
</td></tr>
<tr><td><code id="score_sim_+3A_method">method</code></td>
<td>
<p>method to compute similarity, default &quot;jaccard&quot;. See <code>proxyC::simil</code>.</p>
</td></tr>
<tr><td><code id="score_sim_+3A_n">n</code></td>
<td>
<p>number.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
data(drugdemo)
drug_herb &lt;- PrepareData(drugdemo$drug_herb, from = "drug", to="herb")
herb_compound &lt;- PrepareData(drugdemo$herb_compound, from = "herb", to="compound")
compound_target &lt;- PrepareData(drugdemo$compound_target, from = "compound", to="target")
disease &lt;- PrepareData(drugdemo$disease, diseaseID = "disease",from = "target", to="target")
BasicData &lt;- CreateBasicData(drug_herb, herb_compound, compound_target, diseasenet = disease)
biodescr &lt;- extr_biodescr(BasicData, geneset= "kegg")
res &lt;- score_sim(biodescr, method="jaccard", n=1000)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_biodescr'>to_biodescr</h2><span id='topic+to_biodescr'></span>

<h3>Description</h3>

<p>Convert BioDescr object to a list of adjacency matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_biodescr(BioDescr)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_biodescr_+3A_biodescr">BioDescr</code></td>
<td>
<p>A BioDescr object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  to_biodescr(BioDescr)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_df'>to_df</h2><span id='topic+to_df'></span>

<h3>Description</h3>

<p>Convert list to data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_df(list)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_df_+3A_list">list</code></td>
<td>
<p>A list containing gene sets.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame.
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  to_df(list)

## End(Not run)
</code></pre>

<hr>
<h2 id='to_list'>to_list</h2><span id='topic+to_list'></span>

<h3>Description</h3>

<p>Create a new list from a data.frame of drug target and disease biomarker as input
</p>


<h3>Usage</h3>

<pre><code class='language-R'>to_list(dataframe, input = "single", sep = ", ")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="to_list_+3A_dataframe">dataframe</code></td>
<td>
<p>a data frame of 2 column with term/drug and gene</p>
</td></tr>
<tr><td><code id="to_list_+3A_input">input</code></td>
<td>
<p>one of the single or basket</p>
</td></tr>
<tr><td><code id="to_list_+3A_sep">sep</code></td>
<td>
<p>When 'input' is 'basket'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
  to_list(dataframe)

## End(Not run)
</code></pre>

<hr>
<h2 id='write_gmt'>write_gmt</h2><span id='topic+write_gmt'></span>

<h3>Description</h3>

<p>prints data frame to a gmt file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_gmt(geneset, gmt_file)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_gmt_+3A_geneset">geneset</code></td>
<td>
<p>A data.frame of 2 column with term/drug and gene.</p>
</td></tr>
<tr><td><code id="write_gmt_+3A_gmt_file">gmt_file</code></td>
<td>
<p>A character of gmt file name.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>gmt file
</p>


<h3>Author(s)</h3>

<p>Yuanlong Hu
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
