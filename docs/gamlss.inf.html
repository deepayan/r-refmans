<!DOCTYPE html><html lang="en"><head><title>Help for package gamlss.inf</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gamlss.inf}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#gamlss.inf-package'>
<p>Models for Mixed (Inflated and Adjusted) Response Variables.</p></a></li>
<li><a href='#centiles.Inf0to1'><p>Plotting centile curves for a <code>gamlssInf0to1</code> and  <code>gamlssZadj</code> object</p></a></li>
<li><a href='#gamlssInf0to1'>
<p>GAMLSS model for a proportion response variable with point(s) mass at 0 and or 1.</p></a></li>
<li><a href='#gamlssZadj'>
<p>Fitting  positive real line response variable with zeros.</p></a></li>
<li><a href='#gen.Inf0to1'>
<p>Functions to generate inflated 0-to-1 distributions from existing continuous gamlss.family distributions defined in (0,1).</p></a></li>
<li><a href='#gen.Zadj'><p>Functions to generate zero adjusted distributions from existing continuous gamlss.family distributions defined on positve real line.</p></a></li>
<li><a href='#predict.gamlssinf0to1'><p>Extract Predictor Values and Standard Errors For New Data In a gamlssinf0to1 Model</p></a></li>
<li><a href='#predict.gamlssZadj'><p>Extract Predictor Values and Standard Errors For New Data in a gamlssZadj Model</p></a></li>
<li><a href='#sda'><p>Data for using for simulation</p></a></li>
<li><a href='#summary.gamlssinf0to1'><p>Summarizes an inflated GAMLSS fitted model</p></a></li>
<li><a href='#term.plotInf0to1'><p>Plot regression terms for a specified parameter of a fitted gamlssInf0to1 object</p></a></li>
<li><a href='#term.plotZadj'><p>Plot regression terms for a specified parameter of a fitted gamlssZadj object</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Fitting Mixed (Inflated and Adjusted) Distributions</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0-1</td>
</tr>
<tr>
<td>Date:</td>
<td>2019-03-12</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.2.1), gamlss, gamlss.dist</td>
</tr>
<tr>
<td>Suggests:</td>
<td>MASS, survival, gamlss.cens, gamlss.tr</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods</td>
</tr>
<tr>
<td>Author:</td>
<td>Marco Enea [aut, cre, cph],
  Mikis Stasinopoulos [aut],
  Bob Rigby [aut],
  Abu Hossain [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Marco Enea  &lt;marco.enea@unipa.it&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>This is an add-on package to 'gamlss'. The purpose of this package is to allow users to fit GAMLSS (Generalised Additive Models for Location Scale and Shape) models when the response variable is defined either in the intervals [0,1), (0,1] and [0,1] (inflated at zero and/or one distributions), or in the positive real line including zero (zero-adjusted distributions). The mass points at zero and/or one are treated as extra parameters with the possibility to include a linear predictor for both. The package also allows transformed or truncated distributions from the GAMLSS family to be used for the continuous part of the distribution. Standard methods and GAMLSS diagnostics can be used with the resulting fitted object. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="http://www.gamlss.com/">http://www.gamlss.com/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2019-03-12 10:11:31 UTC; Marco</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2019-03-12 18:02:56 UTC</td>
</tr>
</table>
<hr>
<h2 id='gamlss.inf-package'>
Models for Mixed (Inflated and Adjusted) Response Variables.
</h2><span id='topic+gamlss.inf-package'></span><span id='topic+gamlss.inf'></span>

<h3>Description</h3>

<p>This package allows mixed distribution fitting in GAMLSS. A mixed distribution is  one containing both continuous and discrete parts, see Chapter 5 of Stasinopoulos et al. (2017).   There are some mixed distribution in the GAMLSS implementation in <span class="rlang"><b>R</b></span> like the <code>BEINF, BEINF0, BEINF1</code> for data defined on [0,1] or <code>ZAGA, ZAIG</code> for data defined on a positive real line but the choice is very limited. This package  enhance the availability of mixed distribution within the GAMLSS framework.
</p>
<p>For historical reasons the authors use the terminology &quot;Inflated&quot; for models on [0,1],
&quot;Adjusted&quot; for models on [0,Inf]. We will follow the same terminology here.
So this package allows the fit of an inflated GAMLSS model when the response variable is defined in the intervals [0,1), (0,1] and [0,1] and  the fit of zero adjusted models when the response variable is defined in the positive real line, (but where there are zeros in the data). 
</p>
<p>For models with inflated proportion response variables the package provides up to two extra parameters, a mass point at zero and a mass point at one. Adding an extra inflation point at zero (or at one), is equivalent to fit two separate GAMLSS models, a GAMLSS model with a continuous distribution defined at the interval (0,1), and a logit model for zero (or ones). 
When both zero and one are present, i.e. [0,1],  a multinomial model  is needed  to fit the non-(0,1) part. 
</p>
<p>For the zero adjusted models with a response defined on the positive real line (but where zeros exist in the data), the actual fitting  can be achieved by fitting two separate GAMLSS models one with a distribution on the real positive line and one binomial model for the zeros and non-zeros.      
</p>
<p>This package uses the two models fitting procedures but the resulting fitted object behaves like a typical GAMLSS object so a lot of standard GAMLSS diagnostics can be used with it.   It also allows transformed or truncated <code>gamlss.family</code> distributions to be used  for the continuous part of the distribution therefore giving a great flexibility of the type of mixed distribution to be used. 
</p>
<p>The functions <code>gamlssInf0to1()</code> and <code>gamlssZadj()</code> can fit the Inflated and Adjusted  models, respectively, and they are described in the two vignettes available with the package. 
</p>


<h3>Details</h3>


<table>
<tr>
 <td style="text-align: left;">
Package: </td><td style="text-align: left;"> gamlss.inf</td>
</tr>
<tr>
 <td style="text-align: left;">
Type: </td><td style="text-align: left;"> Package</td>
</tr>
<tr>
 <td style="text-align: left;">
Version: </td><td style="text-align: left;"> 1.0-1</td>
</tr>
<tr>
 <td style="text-align: left;">
Date: </td><td style="text-align: left;"> 2019-03-12</td>
</tr>
<tr>
 <td style="text-align: left;">
License: </td><td style="text-align: left;"> GPL-2 | GPL-3</td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Author(s)</h3>

<p>Marco Enea &lt;marco.enea@unipa.it&gt;, Mikis Stasinopoulos &lt;mikis.stasinopoulos@gamlss.org&gt;, 
Bob Rigby and Abu Hossain <br /> 
</p>
<p>Maintainer: Marco Enea &lt;marco.enea@unipa.it&gt; 
</p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Ospina R. and Ferrari S. L. P. (2010) Inflated beta distributions, <em>Statistical Papers</em>, 
<b>23</b>,  111-126. 
</p>
<p>Rigby R.A. and Stasinopoulos D.M. (2005). Generalized additive models for location, scale 
and shape,(with discussion), Appl. Statist., 54, part 3, pp 507-554. <br />
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R. Journal of Statistical Software, Vol. 23, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>. 
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
<a href="https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909">https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909</a>.
</p>


<h3>See Also</h3>

<p><code><a href="gamlss.html#topic+gamlss">gamlss</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# An artificial example using simulated data in [0,1)

# Firstly, we use function gen.Family() to create 
# the logit skew student t (logitSST) distribution which is defined in the (0,1) 
# interval. Then we use function gen.Inf0to1() to create the 0-inflated logitSST 
# distribution defined in [0,1).

gen.Family("SST", "logit")
gen.Inf0to1("logitSST","Zero") 

#now we can generate the data and run the model 

set.seed(10)
Y &lt;- rlogitSSTInf0(300,mu=0.5,sigma=0.7,nu=0.5,tau=5,xi0=0.5,log=FALSE)
m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~1,
                    sigma.formula=~1,
                    nu.formula=~1,
                    tau.formula=~1,
                    xi0.formula=~1,
                    family=logitSST,
                    trace = TRUE)
summary(m1)

</code></pre>

<hr>
<h2 id='centiles.Inf0to1'>Plotting centile curves for a <code>gamlssInf0to1</code> and  <code>gamlssZadj</code> object </h2><span id='topic+centiles.Inf0to1'></span><span id='topic+centiles.Zadj'></span>

<h3>Description</h3>

<p>Function <code>centiles.Inf0to1()</code> plots centile curves for distributions belonging to the GAMLSS family of distributions defined in the intervals (0,1],[0,1) and [0,1].  
The function also tabulates the sample percentages below each centile curve (for comparison with the model percentages given by the argument <code>cent</code>).
A restriction of the function is that it applies to models with one explanatory variable only.    
</p>


<h3>Usage</h3>

<pre><code class='language-R'>centiles.Inf0to1(obj, xvar = NULL, cent = c(0.4, 2, 10, 25, 50, 75, 
    90, 98, 99.6), legend = TRUE, ylab = "y", xlab = "x", main = NULL, 
    main.gsub = "@", xleg = min(xvar), yleg = max(obj$y), xlim = range(xvar), 
    ylim = range(obj$y), save = FALSE, plot = TRUE, points = TRUE, 
    pch = 15, cex = 0.5, col = gray(0.7), col.centiles = 1:length(cent) + 
        2, lty.centiles = 1, lwd.centiles = 1, ...)
centiles.Zadj(obj, xvar = NULL, cent = c(0.4, 2, 10, 25, 50, 75, 
   90, 98, 99.6), legend = TRUE, ylab = "y", xlab = "x", main = NULL, 
   main.gsub = "@", xleg = min(xvar), yleg = max(obj$y), xlim = range(xvar), 
   ylim = range(obj$y), save = FALSE, plot = TRUE, points = TRUE, 
   pch = 15, cex = 0.5, col = gray(0.7), col.centiles = 1:length(cent) + 
   2, lty.centiles = 1, lwd.centiles = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="centiles.Inf0to1_+3A_obj">obj</code></td>
<td>
<p>a fitted gamlss object from fitting a gamlss distribution</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_xvar">xvar</code></td>
<td>
<p>the unique explanatory variable</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_cent">cent</code></td>
<td>
<p>a vector with elements the % centile values for which the centile curves have to be evaluated</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_legend">legend</code></td>
<td>
<p>whether a legend is required in the plot or not, the default is <code>legent=TRUE</code>  </p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_ylab">ylab</code></td>
<td>
<p>the y-variable label</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_xlab">xlab</code></td>
<td>
<p>the x-variable label</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_main">main</code></td>
<td>
<p>the main title here as character. 
If NULL the default title &quot;centile curves using  NO&quot; (or the relevant distributions name) is shown</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_main.gsub">main.gsub</code></td>
<td>
<p>if the <code>main.gsub</code> (with default &quot;@&quot;) appears in the <code>main</code> 
title then it is substituted with the default title.</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_xleg">xleg</code></td>
<td>
<p>position of the legend in the x-axis</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_yleg">yleg</code></td>
<td>
<p>position of the legend in the y-axis</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_xlim">xlim</code></td>
<td>
<p>the limits of the x-axis</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_ylim">ylim</code></td>
<td>
<p>the limits of the y-axis</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_save">save</code></td>
<td>
<p>whether to save the sample percentages or not with default equal to <code>FALSE</code>. 
In this case the sample percentages are printed but are not saved </p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_plot">plot</code></td>
<td>
<p>whether to plot the centiles</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_points">points</code></td>
<td>
<p>whether the data points should be plotted, default is <code>TRUE</code></p>
</td></tr> 
<tr><td><code id="centiles.Inf0to1_+3A_pch">pch</code></td>
<td>
<p>the character to be used as the default in plotting points see <code>par</code></p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_cex">cex</code></td>
<td>
<p>size of  character see <code>par</code></p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_col">col</code></td>
<td>
<p>plotting colour see <code>par</code></p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_col.centiles">col.centiles</code></td>
<td>
<p>Plotting colours  for the centile curves</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_lty.centiles">lty.centiles</code></td>
<td>
<p>line type for the centile curves</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_lwd.centiles">lwd.centiles</code></td>
<td>
<p>The line width for the centile curves</p>
</td></tr>
<tr><td><code id="centiles.Inf0to1_+3A_...">...</code></td>
<td>
<p>for extra arguments</p>
</td></tr>          
</table>


<h3>Details</h3>

<p>Centiles are calculated using the fitted values in <code>obj</code> and <code>xvar</code> must
correspond exactly to the predictor in <code>obj</code> to plot correctly.
</p>
<p><code>col.centiles</code>, <code>lty.centiles</code> and <code>lwd.centiles</code> may be vector arguments
and are recycled to the length <code>cent</code> if necessary.
</p>


<h3>Value</h3>

<p>A centile plot is produced and the sample centiles below each centile curve are printed (or saved)
</p>


<h3>Warning </h3>

<p>This function is appropriate only when one continuous explanatory variable is fitted in the model</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby <a href="mailto:r.rigby@londonmet.ac.uk">r.rigby@londonmet.ac.uk</a> with contribution from Steve Ellison</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>). 
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Houssain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. Accepted for publication on <em>Statistics in Medicine</em>.  <br />
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssInf0to1">gamlssInf0to1</a></code>, <code>gamlss</code>, <code>centiles.split</code> , <code>centiles.com</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
gen.Family("SST", "logit")
gen.Inf0to1("logitSST","One") 
set.seed(30)
x &lt;- seq(0,1,l=2000)
dat &lt;- data.frame(x)
dat$Y &lt;- rlogitSSTInf1(2000,mu=-3+10*x-0.7*x^2,sigma=0.9,nu=0.5,
                       tau=5,xi1=plogis(-0.5*ifelse(x&gt;0.7,-1,13)),log=FALSE)

m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~pb(x), sigma.formula=~pb(x),
                    nu.formula=~pb(x), tau.formula=~pb(x),
                    xi1.formula=~pb(x),
                    data=dat, family=logitSST)

centiles.Inf0to1(m1,xvar= dat$x, cent=c(2,10,25,50,75,90,98),
col.centiles=c(1,7:2),
ylab="proportion", xlab="x",legend=FALSE,main="(c) Inf. logitSST")

## End(Not run)
</code></pre>

<hr>
<h2 id='gamlssInf0to1'>
GAMLSS model for a proportion response variable with point(s) mass at 0 and or 1.
</h2><span id='topic+gamlssInf0to1'></span>

<h3>Description</h3>

<p>Function <code>gamlssInf0to1()</code> allows to fit inflated gamlss models when the response variable distribution is defined in the intervals [0,1), (0,1] and [0,1]. 
The <code>gamlssInf0to1</code> model for inflated proportion variables is a <code>gamlss</code> model provided of up to two extra parameters for the mass point(s). In the case of inflation point at zero (one), this is equivalent to fit two separate models, a gamlss model for the (0,1) part, and a logit model for zero (one) vs non-zero (non-one) part. When both zero and one are present, a multinomial model is involved to fit the non-(0,1) part.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamlssInf0to1(y = NULL, mu.formula = ~1, sigma.formula = ~1, 
             nu.formula = ~1,tau.formula = ~1, 
             xi0.formula = ~1,xi1.formula = ~1, data = NULL, 
             family = BE, weights = rep(1, length(Y_)), 
             trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamlssInf0to1_+3A_y">y</code></td>
<td>
<p> the proportion response variable with inflation at zero and/or one</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_mu.formula">mu.formula</code></td>
<td>

<p>a model formula for <code>mu</code>
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_sigma.formula">sigma.formula</code></td>
<td>

<p>a model formula for  <code>sigma</code> 
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_nu.formula">nu.formula</code></td>
<td>

<p>a model formula for <code>nu</code> 
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_tau.formula">tau.formula</code></td>
<td>

<p>a model formula for <code>tau</code> 
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_xi0.formula">xi0.formula</code></td>
<td>

<p>a model formula for the probability at zero
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_xi1.formula">xi1.formula</code></td>
<td>

<p>a model formula for the probability at one
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_data">data</code></td>
<td>

<p>a data frame containing the variables occurring in the formula.
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_family">family</code></td>
<td>

<p>any <code>gamlss</code> distribution family defined in (0,1)
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_weights">weights</code></td>
<td>
<p>a vector of weights as in gamlss 
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_trace">trace</code></td>
<td>

<p>logical, if TRUE information on model estimation will be printed during the fitting
</p>
</td></tr>
<tr><td><code id="gamlssInf0to1_+3A_...">...</code></td>
<td>

<p>for extra parameters
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default family is a Beta distribution (BE), but other (0,1) distributions can be used, e.g.  those generated from existing continuous gamlss family distributions by using <code>gen.Family</code> with link &quot;logit&quot;. 
</p>


<h3>Value</h3>

<p>returns a <code>gamlssInf0to1</code> object which has its own methods  
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Robert Rigby, Abu Hossain and Marco Enea
</p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

<p><code>gamlss.family</code>, <code>BEINF</code>, <code>BE</code>, <code>BEo</code>, <code>BEZI</code>, <code>BEOI</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 1. An artificial example using simulated data

# Firstly, we use function gen.Family() to create the logit skew 
# student t (logitSST) distribution defined in the (0,1) interval, 
# and function gen.Inf0to1() to create the 0-inflated logitSST 
# distribution defined in [0,1).

gen.Family("SST", "logit")
gen.Inf0to1("logitSST","Zero") 

#now we can generate the data and run the model 
set.seed(10)
Y &lt;- rlogitSSTInf0(500,mu=0.5,sigma=0.7,nu=0.5,tau=5,xi0=0.5,log=FALSE)
dat &lt;- data.frame(Y)
dat$x &lt;- rnorm(500)
m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~x, sigma.formula=~x,
                    nu.formula=~x, tau.formula=~x,
                    xi0.formula=~x,data=dat, family=logitSST)
summary(m1)

# 2. Example of equivalent gamlss models for an inflated-at-1 Beta distribution 

Y &lt;- rBEINF1(500,mu=0.5,sigma=0.7,nu=0.5)
m2 &lt;- gamlss(Y~1,sigma.formula=~1,nu.formula=~1,family=BEINF1)
m3.1 &lt;- gamlss(Y[Y&lt;1]~1,sigma.formula=~1,family=BE)
m3.2 &lt;- gamlss(I(Y==1)~1,family=BI)
m4 &lt;- gamlssInf0to1(Y,mu.formula=~1,sigma.formula=~1,xi1=~1,family=BE)
stopifnot(all.equal(deviance(m2),(deviance(m3.1)+deviance(m3.2))), 
          all.equal(deviance(m2),deviance(m4)))
</code></pre>

<hr>
<h2 id='gamlssZadj'>
Fitting  positive real line response variable with zeros.
</h2><span id='topic+gamlssZadj'></span>

<h3>Description</h3>

<p>Function <code>gamlssZadj()</code> allows to fit zero adjusted   gamlss models when the response variable distribution is defined on the  positive real line. 
The <code>gamlssZadj</code> model for adjusted  positive variables is a <code>gamlss</code> model provides one extra parameters for the mass point at zero. This is equivalent to fit two separate models, a gamlss model for the (0,Inf) part, and a logit model for zero part versus the non-zero  part. The function works similarly but provides one fitted object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gamlssZadj(y = NULL, mu.formula = ~1, sigma.formula = ~1, 
         nu.formula = ~1, tau.formula = ~1, 
         xi0.formula = ~1, data = NULL, 
         family = GA, 
         weights = rep(1, length(Y_)), trace = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gamlssZadj_+3A_y">y</code></td>
<td>
<p>the response variable</p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_mu.formula">mu.formula</code></td>
<td>
<p>a model formula for <code>mu</code></p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_sigma.formula">sigma.formula</code></td>
<td>
<p> a model formula for <code>sigma</code></p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_nu.formula">nu.formula</code></td>
<td>
<p> a model formula for <code>nu</code></p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_tau.formula">tau.formula</code></td>
<td>
<p>a model formula for <code>tau</code></p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_xi0.formula">xi0.formula</code></td>
<td>
<p>a model formula for <code>xi0</code></p>
</td></tr> 
<tr><td><code id="gamlssZadj_+3A_data">data</code></td>
<td>
<p>a data frame containing the variables occurring in the formula.</p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_family">family</code></td>
<td>
<p>any <code>gamlss</code> distribution family defined on the rael line</p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_weights">weights</code></td>
<td>
<p>a vector of weights as in gamlss </p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_trace">trace</code></td>
<td>
<p>logical, if TRUE information on model estimation will be printed during the fitting</p>
</td></tr>
<tr><td><code id="gamlssZadj_+3A_...">...</code></td>
<td>
<p>for extra arguments to pass to <code>gamlss</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default family is a gamma distribution (GA), but other  distributions on the positive rael line can be used, e.g.  those generated from existing continuous <code>gamlss.family</code> distributions  using say <code>gen.Family()</code> with &quot;log&quot;
or <code>gen.trun()</code> from package <span class="pkg">gamlss.tr</span></p>


<h3>Value</h3>

<p>.
Returns a <code>gamlssZadj</code> object which has its own methods 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos, Robert Rigby and Marco Enea</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
<a href="https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909">https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909</a>.
</p>


<h3>See Also</h3>

<p><code>gamlss.family</code>, <code>ZAGA</code>, <code>ZAIG</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>  y0 &lt;- rZAGA(1000, mu=.3, sigma=.4, nu=.15)# p0=0.13
  g0 &lt;- gamlss(y0~1, family=ZAGA)
 t0 &lt;- gamlssZadj(y=y0, mu.formula=~1, family=GA, trace=TRUE)
AIC(g0,t0, k=0)
</code></pre>

<hr>
<h2 id='gen.Inf0to1'>
Functions to generate inflated 0-to-1 distributions from existing continuous gamlss.family distributions defined in (0,1).
</h2><span id='topic+gen.Inf0to1'></span><span id='topic+Inf0to1.d'></span><span id='topic+Inf0to1.p'></span><span id='topic+Inf0to1.q'></span><span id='topic+Inf0to1.r'></span><span id='topic+plotInf0to1'></span>

<h3>Description</h3>

<p>There are six functions here. Only the function <code>gen.Inf0to1()</code> should be used. The remaing five functions will be automatically created once <code>gen.Inf0to1()</code> has been run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.Inf0to1(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...)
Inf0to1.d(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...) 
Inf0to1.p(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...) 
Inf0to1.q(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...) 
Inf0to1.r(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...) 
plotInf0to1(family = "BE", type.of.Inflation = c( "Zero&amp;One", "Zero", "One"), 
            ...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.Inf0to1_+3A_family">family</code></td>
<td>
<p>a continuous (0,1) distribution (extremes not included) <code>gamlss.family</code> distribution</p>
</td></tr>
<tr><td><code id="gen.Inf0to1_+3A_type.of.inflation">type.of.Inflation</code></td>
<td>
<p>the type of inflation</p>
</td></tr>
<tr><td><code id="gen.Inf0to1_+3A_...">...</code></td>
<td>
<p>for passing extra arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>Inf0to1.d</code>, <code>Inf0to1.p</code>, <code>Inf0to1.q</code> and <code>Inf0to1.r</code> allow to create the density function, distribution function, quantile function and random generation, respectively. Function <code>plotInf0to1</code> can be used to create the plot the distributions.
</p>
<p>Alternatively, the function <code>gen.Inf0to1</code> creates the all the standard <code>d,p,q,r</code> functions plus the plotting function. 
</p>
<p>For example, let us take the case of the logit SST distribution with inflation at 1. First generate the <code>"logitSST"</code> distribution by using <code>gen.Family("SST", "logit")</code>, and then, by use <code>gen.Inf0to1("logitSST", "One")</code>.
The functins  <code>dlogitSSTInf1</code>, <code>plogitSSTInf1</code>, <code>qlogitSSTInf1</code>, <code>rlogitSSTInf1</code> and <code>plotlogitSSTInf1</code> will be automatically generated.
Note that <code>gen.Inf0to1</code> never creates a fitting function of the type &quot;logitSSTInf1&quot;, but the existing <code>logitSST</code> must be specified instead as an  argument <code>family</code> of function  <code>gamlssInf0to1()</code>. 
</p>


<h3>Value</h3>

<p>The function <code>gen.Inf0to1</code> returns  the <code>d</code>,  <code>p</code>, <code>q</code> and <code>r</code> functions plus the plotting function.  
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
<a href="https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909">https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1.
gen.Inf0to1("BE","Zero&amp;One")
rBETAInf0to1 &lt;- Inf0to1.r("BE","Zero&amp;One") 
all.equal(rBETAInf0to1, rBEInf0to1) 
plotBEInf0to1()
plotBEInf0to1(mu=0.3,sigma=0.35,xi0=0.5,xi1=0.3)

# 2.
gen.Family("SST", "logit")
gen.Inf0to1("logitSST","One") 
set.seed(30)

args(rlogitSSTInf1)
y &lt;- rlogitSSTInf1(1000,mu=0.2,sigma=0.5,nu=1,tau=5,xi1=0.2)
quantile(y,c(0.1,0.25,0.5,0.75,0.9))

args(qlogitSSTInf1)
qlogitSSTInf1(p=c(0.1,0.25,0.5,0.75,0.9),mu=0.2,sigma=0.5,nu=1,tau=5,xi1=0.2)
plotlogitSSTInf1(mu=0.2,sigma=0.5,nu=1,tau=5,xi1=0.2)

</code></pre>

<hr>
<h2 id='gen.Zadj'>Functions to generate zero adjusted distributions from existing continuous gamlss.family distributions defined on positve real line.</h2><span id='topic+gen.Zadj'></span><span id='topic+Zadj.d'></span><span id='topic+Zadj.p'></span><span id='topic+Zadj.q'></span><span id='topic+Zadj.r'></span><span id='topic+plotZadj'></span>

<h3>Description</h3>

<p>There are six functions here. Only the function <code>gen.Zadj()</code> should be used. The remaing four functions will be automatically created once <code>gen.Zadj()</code> has been run.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen.Zadj(family = "GA", ...)
Zadj.d(family = "GA", ...)
Zadj.p(family = "GA", ...)
Zadj.q(family = "GA", ...)
Zadj.r(family = "GA", ...)
plotZadj(family = "GA", ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen.Zadj_+3A_family">family</code></td>
<td>
<p>a continuous positive rael line  distribution</p>
</td></tr>
<tr><td><code id="gen.Zadj_+3A_...">...</code></td>
<td>
<p>for additional arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Functions <code>Zadj.d</code>, <code>Zadj.p</code>, <code>Zadj.q</code> and <code>Zadj.r</code> allow to create the density function, distribution function, quantile function and random generation, respectively. Function <code>plotZadj</code> can be used to create a  plot for the distribution.
</p>
<p>Alternatively, the function <code>gen.Zadj</code> creates the all the standard <code>d,p,q,r</code> functions plus the plotting function.</p>


<h3>Value</h3>

<p>The function <code>gen.Zadj</code> returns  the <code>d</code>,  <code>p</code>, <code>q</code> and <code>r</code> functions plus the plotting function. 
</p>


<h3>Author(s)</h3>

<p>Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea 
</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
<a href="https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909">https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909</a>.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+gamlssZadj">gamlssZadj</a></code>, ~~~
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 1.
gen.Zadj("BCT")

plotBCTZadj()
plotBCTZadj(mu=3,sigma=0.35,xi0=0.5)

# 2.
gen.Family("SST", "log")
gen.Zadj("logSST") 
 plotlogSSTZadj()

</code></pre>

<hr>
<h2 id='predict.gamlssinf0to1'>Extract Predictor Values and Standard Errors For New Data In a gamlssinf0to1 Model </h2><span id='topic+predict.gamlssinf0to1'></span>

<h3>Description</h3>

<p><code>predict.gamlssinf0to1</code> is the gamlssinf0to1 specific method which produce predictors for a new data set   
for a specified parameter from a gamlssinf0to1 objects.  
The <code>predict.gamlssinf0to1</code> can be used to extract the linear predictors, fitted values and specific  terms in the model at new 
data values in the same way that the <code>predict.lm()</code> and <code>predict.glm()</code> functions can be used for 
<code>lm</code> or <code>glm</code> objects. Note that linear predictors, fitted values and specific terms in the model at the current  
data values can also be extracted using the function <code>lpred()</code> (which is called from predict if new data is NULL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamlssinf0to1'
predict(object, parameter = c("mu", "sigma", "nu", "tau", "xi0","xi1"), 
 newdata = NULL, type = c("link", "response", "terms"),                           
   terms = NULL, se.fit = FALSE,data = NULL, ...) 

                                                 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.gamlssinf0to1_+3A_object">object</code></td>
<td>
<p>a gamlssinf0to1 fitted model</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_parameter">parameter</code></td>
<td>
<p> which distribution (or inflation) parameter is required, default <code>parameter="mu"</code></p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing new values for the explanatory variables used in the model</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_type">type</code></td>
<td>
<p>the default, gets the linear predictor for the specified distribution (or inflation) parameter. 
<code>type="response"</code> gets the fitted values for the parameter while <code>type="terms"</code> gets the fitted terms contribution</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_terms">terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms to be selected (default is all terms)</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_se.fit">se.fit</code></td>
<td>
<p>if TRUE the approximate standard errors of the appropriate type are extracted if exist</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_data">data</code></td>
<td>
<p> the data frame used in the original fit if is not defined in the call</p>
</td></tr>
<tr><td><code id="predict.gamlssinf0to1_+3A_...">...</code></td>
<td>
<p> for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predict function  assumes that the object given in <code>newdata</code> is a data frame containing the right x-variables
used in the model. This could possible cause problems if transformed variables are used in the fitting of the original model.
For example, let us assume that a transformation of age is needed in the model i.e. <code>nage&lt;-age^.5</code>. This could be fitted as 
<code>mod&lt;-gamlss(y~cs(age^.5),data=mydata)</code> or as  <code>nage&lt;-age^.5;  mod&lt;-gamlss(y~cs(nage), data=mydata)</code>.
The later could more efficient if the data are in thousands rather in hundreds. In the first case,   
the code <code>predict(mod,newdata=data.frame(age=c(34,56)))</code> would produce the right results.  
In the second case a new data frame has to be created containing the old data plus any new transform data. This data frame has to 
be declared in the <code>data</code> option. The option <code>newdata</code> should 
contain a data.frame with the new names and the transformed values in which prediction is required, (see the last example). </p>


<h3>Value</h3>

<p>A vector or a matrix  depending on the options.
</p>


<h3>Author(s)</h3>

<p>Abu Hossain, Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea </p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssInf0to1">gamlssInf0to1</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
gen.Family("SST", "logit")
gen.Inf0to1("logitSST","Zero") 
set.seed(10)
Y &lt;- rlogitSSTInf0(500,mu=0.5,sigma=0.7,nu=0.5,tau=5,xi0=0.5,log=FALSE)
dat &lt;- data.frame(Y)
dat$x &lt;- rnorm(500)
m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~x, sigma.formula=~x,
                    nu.formula=~x, tau.formula=~x,
                    xi0.formula=~x,data=dat, family=logitSST)
predict(m1)

</code></pre>

<hr>
<h2 id='predict.gamlssZadj'>Extract Predictor Values and Standard Errors For New Data in a gamlssZadj Model </h2><span id='topic+predict.gamlssZadj'></span>

<h3>Description</h3>

<p><code>predict.gamlssZadj</code> is the specific method which produce predictors for a new data set   
for a specified parameter from a gamlssZadj objects.  
The <code>predict.gamlssZadj</code> can be used to extract the linear predictors, fitted values and specific  terms in the model at new 
data values in the same way that the <code>predict.lm()</code> and <code>predict.glm()</code> functions can be used for 
<code>lm</code> or <code>glm</code> objects. Note that linear predictors, fitted values and specific terms in the model at the current  
data values can also be extracted using the function <code>lpred()</code> (which is called from predict if new data is NULL).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamlssZadj'
predict(object, parameter = c("mu", "sigma", "nu", "tau", "xi0"), 
 newdata = NULL, type = c("link", "response", "terms"),                           
   terms = NULL, se.fit = FALSE,data = NULL, ...)                                         
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.gamlssZadj_+3A_object">object</code></td>
<td>
<p>a gamlssZadj fitted model</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_parameter">parameter</code></td>
<td>
<p> which distribution (or inflation) parameter is required, default <code>parameter="mu"</code></p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_newdata">newdata</code></td>
<td>
<p>a data frame containing new values for the explanatory variables used in the model</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_type">type</code></td>
<td>
<p>the default, gets the linear predictor for the specified distribution (or inflation) parameter. 
<code>type="response"</code> gets the fitted values for the parameter while <code>type="terms"</code> gets the fitted terms contribution</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_terms">terms</code></td>
<td>
<p>if <code>type="terms"</code>, which terms to be selected (default is all terms)</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_se.fit">se.fit</code></td>
<td>
<p>if TRUE the approximate standard errors of the appropriate type are extracted if exist</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_data">data</code></td>
<td>
<p> the data frame used in the original fit if is not defined in the call</p>
</td></tr>
<tr><td><code id="predict.gamlssZadj_+3A_...">...</code></td>
<td>
<p> for extra arguments </p>
</td></tr>
</table>


<h3>Details</h3>

<p>The predict function  assumes that the object given in <code>newdata</code> is a data frame containing the right x-variables
used in the model. This could possible cause problems if transformed variables are used in the fitting of the original model.
For example, let us assume that a transformation of age is needed in the model i.e. <code>nage&lt;-age^.5</code>. This could be fitted as 
<code>mod&lt;-gamlss(y~cs(age^.5),data=mydata)</code> or as  <code>nage&lt;-age^.5;  mod&lt;-gamlss(y~cs(nage), data=mydata)</code>.
The later could more efficient if the data are in thousands rather in hundreds. In the first case,   
the code <code>predict(mod,newdata=data.frame(age=c(34,56)))</code> would produce the right results.  
In the second case a new data frame has to be created containing the old data plus any new transform data. This data frame has to 
be declared in the <code>data</code> option. The option <code>newdata</code> should 
contain a data.frame with the new names and the transformed values in which prediction is required, (see the last example). </p>


<h3>Value</h3>

<p>A vector or a matrix  depending on the options.
</p>


<h3>Author(s)</h3>

<p>Abu Hossain, Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea </p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssZadj">gamlssZadj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(3210)
x &lt;- (runif(800)*4)-2
data(sda)
fmu &lt;- splinefun(sda$x, sda$mu)
curve(fmu, -2,2)
fsigma &lt;- splinefun(sda$x, sda$sigma)
curve(fsigma, -2,2)
fnu &lt;- function(x)
  {f &lt;- splinefun(sda$x, sda$nu)
f(x)/6
}
curve(fnu, -2,2)
set.seed(321)
y0 &lt;- rZAGA(800, mu=fmu(x), sigma=fsigma(x), nu=fnu(x))
da &lt;- data.frame(y0,x)
g0p &lt;- gamlss(y0~pb(x), sigma.fo=~pb(x), nu.fo=~pb(x), data=da, family=ZAGA)
t0p &lt;- gamlssZadj(y=y0, mu.fo=~pb(x), sigma.fo=~pb(x),data=da,
                  trace=TRUE, xi0.fo=~pb(x), family="GA")

plot(predict(g0p,"nu",type="link"),
     predict(t0p,"xi0",type="link")) 
</code></pre>

<hr>
<h2 id='sda'>Data for using for simulation</h2><span id='topic+sda'></span>

<h3>Description</h3>

<p>Those data values are used to create simaulated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("sda")</code></pre>


<h3>Format</h3>

<p>A data frame with 120 observations on the following 5 variables.
</p>

<dl>
<dt><code>x</code></dt><dd><p>the explanatory variable</p>
</dd>
<dt><code>mu</code></dt><dd><p>the fitted mu</p>
</dd>
<dt><code>sigma</code></dt><dd><p>the fitted sigma</p>
</dd>
<dt><code>nu</code></dt><dd><p>the fitted nu</p>
</dd>
<dt><code>tau</code></dt><dd><p>the fitted tau</p>
</dd>
</dl>



<h3>Source</h3>

<p>The data are fitted values of model</p>


<h3>References</h3>

<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2006) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>
<p>Stasinopoulos D. M., Rigby R.A., Heller G., Voudouris V., and De Bastiani F., (2017)
<em>Flexible Regression and Smoothing: Using GAMLSS in R</em>,  Chapman and Hall/CRC. 
<a href="https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909">https://www.crcpress.com/Flexible-Regression-and-Smoothing-Using-GAMLSS-in-R/Stasinopoulos-Rigby-Heller-Voudouris-Bastiani/p/book/9781138197909</a>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(sda)
fmu &lt;- splinefun(sda$x, sda$mu)
curve(fmu, -2,2)
fsigma &lt;- splinefun(sda$x, sda$sigma)
curve(fsigma, -2,2)
fnu &lt;- splinefun(sda$x, sda$nu)
curve(fnu, -2,2)
ftau &lt;- splinefun(sda$x, sda$tau)
curve(ftau, -2,2)
</code></pre>

<hr>
<h2 id='summary.gamlssinf0to1'>Summarizes an inflated GAMLSS fitted model</h2><span id='topic+summary.gamlssinf0to1'></span><span id='topic+summary.gamlssZadj'></span>

<h3>Description</h3>

<p>These are specific methods for the generic function <code>summary</code> which summarize objects retuned by <code>gamlssinf0to1</code> or <code>gamlssZadj</code>. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gamlssinf0to1'
summary(object, type = c("vcov", "qr"),
       robust=FALSE, save = FALSE, hessian.fun = c("R", "PB"), 
       digits = max(3, getOption("digits") - 3),...)

## S3 method for class 'gamlssZadj'
summary(object, type = c("vcov", "qr"),
       robust=FALSE, save = FALSE, hessian.fun = c("R", "PB"), 
       digits = max(3, getOption("digits") - 3),...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.gamlssinf0to1_+3A_object">object</code></td>
<td>
<p>a gamlssinf0to1 or gamlssZadj fitted model</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_type">type</code></td>
<td>
<p>the default value <code>vcov</code> uses the <code>vcov()</code> method for gamlss to get the 
variance-covariance  matrix of the estimated beta coefficients, see details below. 
The alternative <code>qr</code> is the original method used in gamlss to 
estimated the standard errors but it is not reliable since it do not take into the account the inter-correlation between
the distributional parameters <code>mu</code>, <code>sigma</code>, <code>nu</code> and <code>tau</code>, while the inflation  parameters <code>xi0</code> and <code>xi1</code> are uncorrelated anywway. 
</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_robust">robust</code></td>
<td>
<p>whether robust (sandwich) standard errors are required</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_save">save</code></td>
<td>
<p>whether to save the environment of the function so to have access to its values</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_hessian.fun">hessian.fun</code></td>
<td>
<p>whether when calculate the Hessian should use the &quot;R&quot; function <code>optimHess()</code> or a function based on Pinheiro and Bates <code>nlme</code> package, &quot;PB&quot;.</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_digits">digits</code></td>
<td>
<p>the number of digits in the output</p>
</td></tr>
<tr><td><code id="summary.gamlssinf0to1_+3A_...">...</code></td>
<td>
<p>for extra arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Using the  default value <code>type="vcov"</code>, the <code>vcov()</code> method is used to get  
the variance covariance matrix (and consequently the standard errors) of the beta parameters. 
The variance covariance matrix is  calculated using the inverse of the numerical second derivatives
of the observed information matrix. This is a more reliable method since it take into the account the 
inter-correlation between the all the parameters. The <code>type="qr"</code> assumes that the parameters are fixed 
at the estimated values. Note that both methods are not appropriate and should be used with caution if smoothing 
terms are used in the fitting. </p>


<h3>Value</h3>

<p>Print summary of a gamlssinf0to1 or a gamlssZadj object
</p>


<h3>Author(s)</h3>

<p>Abu Hossain, Mikis Stasinopoulos <a href="mailto:mikis.stasinopoulos@gamlss.org">mikis.stasinopoulos@gamlss.org</a>, Bob Rigby and Marco Enea </p>


<h3>References</h3>

<p>Houssain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. Accepted for publication on <em>Statistics in Medicine</em>.  <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssInf0to1">gamlssInf0to1</a></code>, <code><a href="#topic+gamlssZadj">gamlssZadj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
# The gamlssZadj example 
set.seed(3210)
x &lt;- (runif(1000)*4)-2
data(sda)
fmu &lt;- splinefun(sda$x, sda$mu)
fsigma &lt;- splinefun(sda$x, sda$sigma)
fnu &lt;- function(x)
  {f &lt;- splinefun(sda$x, sda$nu)
f(x)/6
}
y0 &lt;- rZAGA(1000, mu=fmu(x), sigma=fsigma(x), nu=fnu(x))
da &lt;- data.frame(y0,x)
t0p &lt;- gamlssZadj(y=y0, mu.fo=~pb(x), sigma.fo=~pb(x),data=da,
                  trace=TRUE, xi0.fo=~pb(x), family="GA")
summary(t0p)
</code></pre>

<hr>
<h2 id='term.plotInf0to1'>Plot regression terms for a specified parameter of a fitted gamlssInf0to1 object </h2><span id='topic+term.plotInf0to1'></span>

<h3>Description</h3>

<p>This is a wrapper to function <code><a href="gamlss.html#topic+term.plot">term.plot</a></code>. <code>term.plotInf0to1</code> produces term plots for a specified parameter from a    
gamlssinf0to1 object. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>term.plotInf0to1(object, parameter = c("mu", "sigma", "nu", "tau", 
        "xi0", "xi1"),...) 
                                   
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="term.plotInf0to1_+3A_object">object</code></td>
<td>
<p>a gamlssinf0to1 fitted model</p>
</td></tr>
<tr><td><code id="term.plotInf0to1_+3A_parameter">parameter</code></td>
<td>
<p> which distribution (or inflation) parameter is required, default <code>parameter="mu"</code></p>
</td></tr>
<tr><td><code id="term.plotInf0to1_+3A_...">...</code></td>
<td>
<p> extra arguments, the same of <code><a href="gamlss.html#topic+term.plot">term.plot</a></code> (except 'what')  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> see function <a href="gamlss.html#topic+term.plot">term.plot</a></p>


<h3>Value</h3>

<p>A plot of fitted terms.
</p>


<h3>Author(s)</h3>

<p>Marco Enea, Mikis Stasinopoulos, Bob Rigby and Abu Hossain</p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssInf0to1">gamlssInf0to1</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
gen.Family("SST", "logit")
gen.Inf0to1("logitSST","Zero") 
set.seed(10)
Y &lt;- rlogitSSTInf0(500,mu=0.5,sigma=0.7,nu=0.5,tau=5,xi0=0.5,log=FALSE)
dat &lt;- data.frame(Y)
dat$x &lt;- rnorm(500)
m1 &lt;- gamlssInf0to1(y=Y,mu.formula=~x, sigma.formula=~x,
                    nu.formula=~x, tau.formula=~x,
                    xi0.formula=~x,data=dat, family=logitSST)

# term.plot for the mu parameter
term.plot(m1$dist,parameter="mu")
term.plotInf0to1(m1,parameter="mu",col.shaded = 2)

# term.plot for the binomial parameter
term.plot(m1$multinom,parameter="mu")
term.plotInf0to1(m1,parameter="xi0",col.shaded = 2)

</code></pre>

<hr>
<h2 id='term.plotZadj'>Plot regression terms for a specified parameter of a fitted gamlssZadj object </h2><span id='topic+term.plotZadj'></span>

<h3>Description</h3>

<p>\ This is a wrapper to function <code><a href="gamlss.html#topic+term.plot">term.plot</a></code>. codeterm.plotZadj produces term plots for a specified parameter from a    
gamlssZadjobject. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>term.plotZadj(object, parameter = c("mu", "sigma", "nu", "tau", "xi0"),...) 
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="term.plotZadj_+3A_object">object</code></td>
<td>
<p>a gamlssZadj fitted model</p>
</td></tr>
<tr><td><code id="term.plotZadj_+3A_parameter">parameter</code></td>
<td>
<p> which distribution (or inflation) parameter is required, default <code>parameter="mu"</code></p>
</td></tr>
<tr><td><code id="term.plotZadj_+3A_...">...</code></td>
<td>
<p> extra arguments, the same of <a href="gamlss.html#topic+term.plot">term.plot</a> (except 'what')  </p>
</td></tr>
</table>


<h3>Details</h3>

<p> see function <a href="gamlss.html#topic+term.plot">term.plot</a></p>


<h3>Value</h3>

<p>A plot of fitted terms.
</p>


<h3>Author(s)</h3>

<p>Marco Enea, Mikis Stasinopoulos, Bob Rigby and Abu Hossain</p>


<h3>References</h3>

<p>Hossain, A., Stasinopoulos, M., Rigby, R. and Enea, M. (2015). Centile estimation for a proportion response variable. <em>Statistics in Medicine</em>,  doi: 10.1002/sim.6748. <br />
</p>
<p>Rigby, R. A. and  Stasinopoulos D. M. (2005). Generalized additive models for location, scale and shape,(with discussion), 
<em>Appl. Statist.</em>, <b>54</b>, part 3, pp 507-554.
</p>
<p>Stasinopoulos D. M., Rigby R.A. and Akantziliotou C. (2003) Instructions on how to use the GAMLSS package in R.
Accompanying documentation in the current GAMLSS  help files, (see also  <a href="http://www.gamlss.org/">http://www.gamlss.org/</a>).
</p>
<p>Stasinopoulos D. M. Rigby R.A. (2007) Generalized additive models for location scale and shape (GAMLSS) in R.
<em>Journal of Statistical Software</em>, Vol. <b>23</b>, Issue 7, Dec 2007, <a href="http://www.jstatsoft.org/v23/i07">http://www.jstatsoft.org/v23/i07</a>.
</p>


<h3>See Also</h3>

  <p><code><a href="#topic+gamlssZadj">gamlssZadj</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(3210)
x &lt;- (runif(1000)*4)-2
data(sda)
fmu &lt;- splinefun(sda$x, sda$mu)
curve(fmu, -2,2)
fsigma &lt;- splinefun(sda$x, sda$sigma)
curve(fsigma, -2,2)
fnu &lt;- function(x)
  {f &lt;- splinefun(sda$x, sda$nu)
f(x)/6
}
curve(fnu, -2,2)
set.seed(321)
y0 &lt;- rZAGA(1000, mu=fmu(x), sigma=fsigma(x), nu=fnu(x))
da &lt;- data.frame(y0,x)
g0p &lt;- gamlss(y0~pb(x), sigma.fo=~pb(x), nu.fo=~pb(x), data=da, family=ZAGA)
t0p &lt;- gamlssZadj(y=y0, mu.fo=~pb(x), sigma.fo=~pb(x),data=da,
                  trace=TRUE, xi0.fo=~pb(x), family="GA")

# term.plot for the mu parameter
term.plot(g0p);title("gamlss")
term.plot(t0p$dist,"mu");title("gamlssZadj")
term.plotZadj(t0p,"mu",col.shaded = 3);title("gamlssZadj")



# term.plot for the sigma parameter
term.plot(g0p, "sigma");title("gamlss")
term.plot(t0p$dist,"sigma");title("gamlssZadj")
term.plotZadj(t0p,"sigma",col.shaded = 3);title("gamlssZadj")

# term.plot for the binomial parameter
term.plot(g0p, "nu");title("gamlss")
term.plot(t0p$binom,"mu");title("gamlssZadj")
term.plotZadj(t0p,"xi0",col.shaded = 3);title("gamlssZadj")


</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
