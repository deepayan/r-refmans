<!DOCTYPE html><html lang="en-GB"><head><title>Help for package BayLum</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {BayLum}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#BayLum-package'><p>Chronological Bayesian Models Integrating Optically Stimulated Luminescence and C-14 Dating<br /></p>
</p>

<p><img src="../help/figures/BayLum_logo.png" width="50" alt="BayLum_logo.png" /><br /></p></a></li>
<li><a href='#Age_Computation'><p>Bayesian analysis for the OSL age estimation of one sample</p></a></li>
<li><a href='#Age_OSLC14'><p>Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples</p></a></li>
<li><a href='#AgeC14_Computation'><p>Bayesian analysis for C-14 age estimations of various samples</p></a></li>
<li><a href='#AgeS'><p>Output of <code>AgeS_Computation</code> function for the samples: &quot;GDB5&quot; and &quot;GDB3&quot;</p></a></li>
<li><a href='#AgeS_Computation'><p>Bayesian analysis for OSL age estimation of various samples</p></a></li>
<li><a href='#BayLum-deprecated'><p>Deprecated functions in package <span class="pkg">BayLum</span>.</p></a></li>
<li><a href='#combine_DataFiles'><p>Combine objects</p></a></li>
<li><a href='#create_DataFile'><p>Prepare input data for subsequent BayLum Analysis</p></a></li>
<li><a href='#create_FolderTemplates'><p>Create Folder Templates</p></a></li>
<li><a href='#create_ThetaMatrix'><p>Create Theta Matrix</p></a></li>
<li><a href='#DATA_C14'><p>C14 cal age estiamte and its error</p></a></li>
<li><a href='#DATA1'><p>DATA of sample named GDB3</p></a></li>
<li><a href='#DATA2'><p>DATA on sample named GDB5</p></a></li>
<li><a href='#DATA3'>
<p>DATA of sample named FER1</p></a></li>
<li><a href='#Generate_DataFile_MG-deprecated'><p>Generates, from one (or several) BIN file(s) of Multi-grain OSL measurements a list of luminescence data and information before statistical analysis (DEPRECATED)</p></a></li>
<li><a href='#Generate_DataFile-deprecated'><p>Generates, from one (or several) BIN-file(s) of Single-grain OSL measurements, a list of luminescence data and information before statistical analysis (DEPRECATED)</p></a></li>
<li><a href='#IntCal13'>
<p>Atmospheric North data for calibration of 14C age</p></a></li>
<li><a href='#IntCal20'>
<p>Atmospheric North data for calibration of 14C age</p></a></li>
<li><a href='#LT_RegenDose-deprecated'><p>Plots Lx/Tx as a function of the regenerative dose (DEPRECATED)</p></a></li>
<li><a href='#Marine13'>
<p>Marine data for calibration of 14C age</p></a></li>
<li><a href='#Marine20'>
<p>Marine data for calibration of 14C age</p></a></li>
<li><a href='#MCMCsample'><p>MCMC sample from the posterior distribution of the dataset GDB5</p></a></li>
<li><a href='#Model_Age'><p>JAGS models use in <code>Age_Computation</code></p></a></li>
<li><a href='#Model_AgeC14'><p>JAGS models use in <code>AgeC14_Computation</code></p></a></li>
<li><a href='#Model_AgeS'><p>JAGS models use in <code>AgeS_Computation</code></p></a></li>
<li><a href='#Model_Palaeodose'>
<p>JAGS models use in <code>Palaeodose_Computation</code></p></a></li>
<li><a href='#ModelC14'>
<p>Likelihood of C14 samples for JAGS models use in <code>Age_OSLC14</code></p></a></li>
<li><a href='#ModelOSL'>
<p>Likelihood of OSL samples for JAGS models use in <code>Age_OSLC14</code></p></a></li>
<li><a href='#ModelPrior'>
<p>Prior for JAGS models use in <code>Age_OSLC14</code></p></a></li>
<li><a href='#Palaeodose_Computation'><p>Bayesian analysis for the palaeodose estimation of various samples</p></a></li>
<li><a href='#plot_Ages'><p>Create Age Plot</p></a></li>
<li><a href='#plot_MCMC'><p>Plot MCMC trajectories and posterior distributions</p></a></li>
<li><a href='#plot_RegDosePoints'><p>Plot Regeneration Dose Points</p></a></li>
<li><a href='#plot_Scatterplots'><p>Display Scatter Plot Matrix of the Bayesian Age Results</p></a></li>
<li><a href='#SC_Ordered'><p>Create Stratigraphically Ordered Sample Matrix</p></a></li>
<li><a href='#SCMatrix'><p>Construct the Stratigraphic Constrain Matrix Interactively</p></a></li>
<li><a href='#SHCal13'>
<p>Atmospheric South data for calibration of 14C age</p></a></li>
<li><a href='#SHCal20'>
<p>Atmospheric South data for calibration of 14C age</p></a></li>
<li><a href='#write_BayLumFiles'><p>Write BayLum .csv-files</p></a></li>
<li><a href='#write_YAMLConfigFile'><p>Write Auto Generated YAML BayLum Configuration File to the Disc</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Chronological Bayesian Models Integrating Optically Stimulated
Luminescence and Radiocarbon Age Dating</td>
</tr>
<tr>
<td>Description:</td>
<td>Bayesian analysis of luminescence data and C-14 age estimates. Bayesian models are based on the following publications: Combes, B. &amp; Philippe, A. (2017) &lt;<a href="https://doi.org/10.1016%2Fj.quageo.2017.02.003">doi:10.1016/j.quageo.2017.02.003</a>&gt; and Combes et al. (2015) &lt;<a href="https://doi.org/10.1016%2Fj.quageo.2015.04.001">doi:10.1016/j.quageo.2015.04.001</a>&gt;. This includes, amongst others, data import, export, application of age models and palaeodose model.</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-06-16</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Author:</td>
<td>Claire Christophe [aut],
  Anne Philippe <a href="https://orcid.org/0000-0002-5331-5087"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Sebastian Kreutzer
    <a href="https://orcid.org/0000-0002-0734-2199"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Guillaume Gu√©rin <a href="https://orcid.org/0000-0001-6298-5579"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Frederik Harly Baumgarten
    <a href="https://orcid.org/0000-0002-4374-5948"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Nicolas Frerebeau <a href="https://orcid.org/0000-0001-5759-4944"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Anne Philippe &lt;anne.philippe@univ-nantes.fr&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R(&ge; 4.1), utils, coda (&ge; 0.19)</td>
</tr>
<tr>
<td>Imports:</td>
<td>methods, hexbin (&ge; 1.28.3), cli (&ge; 3.6.1), KernSmooth (&ge;
2.23), rjags (&ge; 4-13), runjags (&ge; 2.2.1), Luminescence (&ge;
0.9.22), yaml (&ge; 2.3.7)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.1.7), R.rsp (&ge; 0.45.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://CRAN.r-project.org/package=BayLum">https://CRAN.r-project.org/package=BayLum</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/crp2a/BayLum/issues">https://github.com/crp2a/BayLum/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>SystemRequirements:</td>
<td>JAGS &gt;= 4.3.2 (https://mcmc-jags.sourceforge.io/)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-06-16 09:54:14 UTC; annephilippe</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-06-16 14:40:06 UTC</td>
</tr>
</table>
<hr>
<h2 id='BayLum-package'>Chronological Bayesian Models Integrating Optically Stimulated Luminescence and C-14 Dating<br />

<img src="../help/figures/BayLum_logo.png" width="50" alt="BayLum_logo.png" /><br />
</h2><span id='topic+BayLum-package'></span><span id='topic+BayLum'></span>

<h3>Description</h3>

<p>A collection of various R functions for Bayesian analysis of luminescence
data and C-14 age estimates. This includes, amongst others, data import, export,
application of age and palaeodose models.
</p>


<h3>Details</h3>

<p>This package is based on the functions: <a href="#topic+Generate_DataFile">Generate_DataFile</a> and <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
to import luminescence data. These functions create a list containing all informations to
compute age of single-grain OSL measurements for the first function and multi-grain OSL
measurements for the second.
</p>
<p>The functions: <a href="#topic+Age_Computation">Age_Computation</a> and <a href="#topic+AgeS_Computation">AgeS_Computation</a> use Bayesian analysis for OSL age
estimation for one or various samples according to difference models
(e.g. different dose-response curves and different equivalent dose distributions around the palaeodose).
</p>
<p>It is possible to consider various BIN/BINX-files per sample, to compute ages of samples in
stratigraphic constraints and to integrate systematic errors.
</p>
<p>It is possible to calibrate C-14 age with the function <a href="#topic+AgeC14_Computation">AgeC14_Computation</a>.
We can also estimate chronology containing 14C age and OSL samples with the function <a href="#topic+Age_OSLC14">Age_OSLC14</a>.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Anne Philippe <a href="mailto:anne.philippe@univ-nantes.fr">anne.philippe@univ-nantes.fr</a> (<a href="https://orcid.org/0000-0002-5331-5087">ORCID</a>)
</p>
<p>Authors:
</p>

<ul>
<li><p> Claire Christophe
</p>
</li>
<li><p> Sebastian Kreutzer (<a href="https://orcid.org/0000-0002-0734-2199">ORCID</a>)
</p>
</li>
<li><p> Guillaume Gu√©rin (<a href="https://orcid.org/0000-0001-6298-5579">ORCID</a>)
</p>
</li>
<li><p> Frederik Harly Baumgarten (<a href="https://orcid.org/0000-0002-4374-5948">ORCID</a>)
</p>
</li>
<li><p> Nicolas Frerebeau (<a href="https://orcid.org/0000-0001-5759-4944">ORCID</a>)
</p>
</li></ul>



<h3>References</h3>

<p>Philippe, A., Gu√©rin, G., Kreutzer, S., 2019. BayLum - An R package for Bayesian analysis of OSL ages:
An introduction. Quaternary Geochronology 49, 16‚Äì24. <a href="https://doi.org/10.1016/j.quageo.2018.05.009">doi:10.1016/j.quageo.2018.05.009</a>
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://CRAN.r-project.org/package=BayLum">https://CRAN.r-project.org/package=BayLum</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/crp2a/BayLum/issues">https://github.com/crp2a/BayLum/issues</a>
</p>
</li></ul>


<hr>
<h2 id='Age_Computation'>Bayesian analysis for the OSL age estimation of one sample</h2><span id='topic+Age_Computation'></span>

<h3>Description</h3>

<p>This function computes the age (in ka) of a sample according to the model developed in Combes and Philippe (2017),
based on an output of <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>.<br />
A sample, for which data is available in several BIN files, can be analysed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Age_Computation(
  DATA,
  SampleName = DATA$SampleNames[1],
  PriorAge = c(0.01, 100),
  BinPerSample = c(1),
  SavePdf = FALSE,
  OutputFileName = c("MCMCplot"),
  OutputFilePath = c(""),
  SaveEstimates = FALSE,
  OutputTableName = c("DATA"),
  OutputTablePath = c(""),
  LIN_fit = TRUE,
  Origin_fit = FALSE,
  distribution = c("cauchy"),
  I = 1,
  Iter = 50000,
  t = 5,
  n.chains = 3,
  quiet = FALSE,
  roundingOfValue = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Age_Computation_+3A_data">DATA</code></td>
<td>
<p><a href="base.html#topic+list">list</a> of objects: <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>, <code>K</code>, <code>Nb_measurement</code>,
provided by the function <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>.
</p>
<p><code>DATA</code> can contain information for more than one sample.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_samplename">SampleName</code></td>
<td>
<p><a href="base.html#topic+character">character</a>: name of the sample.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_priorage">PriorAge</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): lower and upper bounds for the sample age parameter (in ka).
Note that, <code>length(PriorAge)=2</code>.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): vector with the number of BIN files per sample.
If in <code>DATA</code> there is more than one sample,
the <code>BinPerSample</code> vector must be the same as that used to run the function
<a href="#topic+Generate_DataFile">Generate_DataFile</a> or in <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> for generating the <code>DATA</code> object.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_savepdf">SavePdf</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save graph in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_outputfilename">OutputFileName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the pdf file that will be generated by the function if <code>SavePdf = TRUE</code>;
<code style="white-space: pre;">&#8288;length(OutputFileName = 2&#8288;</code>, see <strong>PLOT OUTPUT</strong> in <strong>Value</strong> section for more informations.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_outputfilepath">OutputFilePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the pdf file that will be generated by the function if <code>SavePdf = TRUE</code>.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_saveestimates">SaveEstimates</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save Bayes estimates and credible interval at level 68% and 95%  and
the result of the gelman en Rubin test of convergency, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_outputtablename">OutputTableName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the table that will be generated by the function if <code>SaveEstimates = TRUE</code>.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_outputtablepath">OutputTablePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the table that will be generated by the function if  <code>SaveEstimates = TRUE</code>.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_lin_fit">LIN_fit</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if <code>TRUE</code> (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves.
See details section for more informations on the proposed dose response curves.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_origin_fit">Origin_fit</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if <code>TRUE</code>, forces the dose response curves to pass through the origin.
See details section for more informations on the proposed growth curves.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_distribution">distribution</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose.
Allowed inputs are <code>"cauchy"</code>, <code>"gaussian"</code>, <code>"lognormal_A"</code> and <code>"lognormal_M"</code>, see details section for more informations.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_i">I</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): if <code>DATA</code> contains data from more than one sample,
I indicates the ID number of the sample to be analysed.</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_iter">Iter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of iterations for the MCMC computation (for more information see jags.model).</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_t">t</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see jags.model).</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of independent chains for the model (for more information see jags.model).</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_quiet">quiet</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enables/disables rjags messages</p>
</td></tr>
<tr><td><code id="Age_Computation_+3A_roundingofvalue">roundingOfValue</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default):  Integer indicating the number of decimal places to be used, default = 3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Option on growth curves</strong><br />
</p>
<p>As for <a href="#topic+AgeS_Computation">AgeS_Computation</a> and <a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a>, the user can choose from 4 dose response curves:
</p>

<ul>
<li> <p><strong>Saturating exponential plus linear growth</strong> (<code>AgeMultiBF_EXPLIN</code>):
</p>
<p>for all <code>x</code> in IR+, <code class="reqn">f(x)=a(1-exp(-x/b))+cx+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><strong>Saturating exponential growth</strong> (<code>AgeMultiBF_EXP</code>):
</p>
<p>for all <code>x</code> in IR+, <code class="reqn">f(x)=a(1-exp(-x/b))+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit = FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit = FALSE</code>
</p>
</li></ul>

</li>
<li> <p><strong>Saturating exponential plus linear growth and fitting through the origin</strong> (<code>AgeMultiBF_EXPLINZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code class="reqn">f(x)=a(1-exp(-x/b))+cx</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li>
<li> <p><strong>Saturating exponential growth and fitting through the origin</strong> (<code>AgeMultiBF_EXPZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code class="reqn">f(x)=a(1-exp(-x/b))</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li></ul>

<p><strong>Option on equivalent dose distribution around the palaeodose</strong><br />
</p>
<p>The use can choose between :
</p>

<ul>
<li> <p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_A</code>: a log-normal distribution with mean or <strong>A</strong>verage equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_M</code>: a log-normal distribution with <strong>M</strong>edian equal to the palaeodose of the sample
</p>
</li></ul>



<h3>Value</h3>

<p><strong>NUMERICAL OUTPUT</strong>
</p>

<ol>
<li> <p><strong>A list containing the following objects</strong>:
</p>

<ul>
<li> <p><strong>Sampling</strong> that corresponds to a sample of the posterior distributions
of the age (in ka), palaeodose (in Gy) and equivalent dose dispersion (in Gy) parameters.
</p>
</li>
<li> <p><strong>Model_GrowthCurve</strong>, stating which dose response fitting option was chosen;
</p>
</li>
<li> <p><strong>Distribution</strong>, stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample;
</p>
</li>
<li> <p><strong>PriorAge</strong>, stating the priors used for the age parameter (in ka).
</p>
</li></ul>

</li>
<li> <p><strong>The Gelman and Rubin test of convergency</strong>: prints the result of the Gelman and Rubin test of convergency for the age, palaeodose and equivalent dose dispersion parameters.
A result close to one is expected.<br />
In addition, the user must visually assess the convergency of the trajectories by looking at the graph
generated by the function (see <strong>PLOT OUTPUT</strong> for more informations).<br />
If both convergencies (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the printed estimates as valid. Otherwise, the user may try increasing the number of MCMC interations
(<code>Iter</code>), or being more precise on the <code>PriorAge</code> parameter (for example specify if it is a young sample <code>c(0.01,10)</code> an old sample <code>c(10,100)</code>),
or changing the parameter <code>distribution</code> or the growth curve, to reach convergency.to reach convergency.
</p>
</li>
<li> <p><strong>Credible intervals and Bayes estimates</strong>: prints the Bayes esitmates, the credible intervals at 95% and 68% for
the age, palaeodose and equivalent dose dispersion parameters of the sample.
</p>
</li></ol>

<p><strong>PLOT OUTPUT</strong>
</p>
<p>A graph with the MCMC trajectories and posterior distributions of the age, palaeodose and equivalent dose dispersion parameters is displayed.<br />
The first line of the figure correponds to the age parameter, the second to the palaeodose parameter and the third to the equivalent dose dispersion parameter.
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.
</p>
<p>To give the results in a publication, we recommend to give the Bayes estimate of the parameter as well as the credible interval at 95% or 68%.
</p>


<h3>Note</h3>

<p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>References</h3>

<p>Combes, Benoit and Philippe, Anne, 2017.
Bayesian analysis of multiplicative Gaussian error for multiple ages estimation in optically
stimulated luminescence dating.
Quaternary Geochronology (39, 24-34)
</p>
<p>Combes, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001
</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>, rjags, <a href="#topic+plot_MCMC">plot_MCMC</a>, <a href="#topic+AgeS_Computation">AgeS_Computation</a>, <a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data file generated by the function Generate_DataFile
data(DATA1,envir = environment())
priorage &lt;- c(10,60) # GDB3 is an old sample
Age &lt;- Age_Computation(
 DATA = DATA1,
 SampleName = "GDB3",
 PriorAge = priorage,
 Iter = 100,
 quiet = TRUE)

</code></pre>

<hr>
<h2 id='Age_OSLC14'>Bayesian analysis for age estimation of OSL measurements and C-14 ages of various samples</h2><span id='topic+Age_OSLC14'></span>

<h3>Description</h3>

<p>This function computes an age of OSL data consisting of at least two samples and calibrate
C-14 ages of samples to get an age (in ka).<br />
Ages of OSL data are computed according to the model given in Combes and Philippe (2017).
Single-grain or Multi-grain OSL measurements can be analysed simultaneously
(with output of <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> or both of them using <a href="#topic+combine_DataFiles">combine_DataFiles</a>).
Samples, for which data is available in several BIN files, can be analysed.<br />
For C-14 data, the user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Age_OSLC14(
  DATA,
  Data_C14Cal,
  Data_SigmaC14Cal,
  Nb_sample = DATA$Nb_sample,
  SampleNames = DATA$SampleNames,
  SampleNature,
  PriorAge = rep(c(10, 60), Nb_sample),
  SavePdf = FALSE,
  OutputFileName = c("MCMCplot", "HPD_Cal14CCurve", "summary"),
  OutputFilePath = c(""),
  SaveEstimates = FALSE,
  OutputTableName = c("DATA"),
  OutputTablePath = c(""),
  StratiConstraints = c(),
  sepSC = c(","),
  BinPerSample = rep(1, sum(SampleNature[1, ])),
  THETA = c(),
  sepTHETA = c(","),
  LIN_fit = TRUE,
  Origin_fit = FALSE,
  distribution = c("cauchy"),
  Model_C14 = c("full"),
  CalibrationCurve = c("IntCal20"),
  Iter = 10000,
  burnin = 4000,
  adapt = 1000,
  t = 5,
  n.chains = 3,
  jags_method = "rjags",
  autorun = FALSE,
  quiet = FALSE,
  roundingOfValue = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Age_OSLC14_+3A_data">DATA</code></td>
<td>
<p>Two types of inputs are supported.
(1): a list of objects: <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>,
<code>K</code>, <code>Nb_measurement</code>, provided by the function <a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> or <a href="#topic+combine_DataFiles">combine_DataFiles</a>.
<code>DATA</code> contains information for more than one sample.
If there is stratigraphic relations between samples, informations in DATA must be ordered by order of
increasing ages. See the details section to for more informations.
(2): an object of class <code>BayLum.list</code> which is provided by the output of <a href="#topic+Age_OSLC14">Age_OSLC14</a>. When input of class <code>BayLum.list</code> is identified, no new JAGS model is created. Instead, the JAGS model specified within the <code>BayLum.list</code> is extended. Useful for when convergence was not originally achieved and a complete restart is not desirable.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_data_c14cal">Data_C14Cal</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> vector: corresponding to C-14 age estimate
(in years, conversion in ka is automatically done in the function).
If there is stratigraphic relations between samples, <code>Data_C14Cal</code> must be ordered
by order of increasing ages.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_data_sigmac14cal">Data_SigmaC14Cal</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>: corresponding to the error of C-14 age estimates.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a>: number of samples (OSL data and C-14 age),
(<code>Nb_sample&gt;3</code>, at least to sample of OSL data and one sample of C-14 age).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a>: sample names for both OSL data and C14 data.
The length of this vector is equal to <code>Nb_sample</code>.
If there is stratigraphic relation, this vector must be ordered by increasing
order (to mix OSL samples and C-14 ages if it is needed).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_samplenature">SampleNature</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a>: states the nature of the sample.
Row number of <code>SampleNature</code> matrix is equal to <code>2</code> and column number is equal
to <code>Nb_sample</code>. First line of the matrix: <code>SampleNature[1,i]</code> states if sample
whose number ID is equal to <code>i</code>, is an OSL sample <code>1</code> or not <code>0</code>.
Second line of the matrix: <code>SampleNature[2,i]</code> states if sample whose number ID
is equal to <code>i</code>, is an C-14 sample <code>1</code> or not '0.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_priorage">PriorAge</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): lower and upper bounds for age parameter of each sample <strong>(in ka)</strong>.
Note that, <code>length(PriorAge) = 2*Nb_sample</code> sand <code>PriorAge[2i-1,2i]</code> corresponds
to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_savepdf">SavePdf</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if <code>TRUE</code> save graphs in pdf file
named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_outputfilename">OutputFileName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the pdf file that
will be generated by the function if <code>SavePdf=TRUE</code>, <code>length(OutputFileName)=3</code>,
see <strong>PLOT OUTPUT</strong> in <strong>Value</strong> section for more informations.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_outputfilepath">OutputFilePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the pdf file that will
be generated by the function if <code>SavePdf=TRUE</code>. If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_saveestimates">SaveEstimates</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save Bayes' estimates,
credible interval at level 68% and 95%  and the result of the Gelman en Rubin
test of convergence, in a CSV-table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_outputtablename">OutputTableName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the table that will
be generated by the function if <code>SaveEstimates=TRUE</code>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_outputtablepath">OutputTablePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the table that will
be generated by the function if <code>SaveEstimates=TRUE</code>. If it is not equal to &quot;&quot;,
it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_straticonstraints">StratiConstraints</code></td>
<td>
<p><a href="base.html#topic+matrix">matrix</a> or <a href="base.html#topic+character">character</a> (with default): input object for the
stratigraphic relation between samples. If there is stratigraphic relation between
samples see the details section for instructions regarding how to correctly fill <code>StratiConstraints</code>,
the user can refer to a <a href="base.html#topic+matrix">matrix</a> or to a CSV-file <a href="base.html#topic+character">character</a>. Otherwise, default value is suitable.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_sepsc">sepSC</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> CSV-file.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): vector with the number of BIN-files
per OSL sample. The length of this vector is equal to the number of OSL samples.
<code>BinPerSample[i]</code> corresponds to the number of BIN files for the sample whose
number ID is equal to <code>i</code>.  For more information to fill this vector, we refer
to details in <a href="#topic+Generate_DataFile">Generate_DataFile</a> or in <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_theta">THETA</code></td>
<td>
<p>numeric <a href="base.html#topic+matrix">matrix</a> or <a href="base.html#topic+character">character</a> (with default): input object for
systematic and individual error for OSL samples. If systematic errors are considered,
see the details section for instructions regarding how to correctly fill <code>THETA</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
Otherwise, default value is suitable, and only individual error is considered.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_septheta">sepTHETA</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>THETA</code> is character,
indicate column separator in <code>THETA</code> CSV-file.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_lin_fit">LIN_fit</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if <code>TRUE</code> (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves,
for OSL samples. See details for more informations on the proposed dose response curves.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_origin_fit">Origin_fit</code></td>
<td>
<p>p<a href="base.html#topic+logical">logical</a> (with default): if <code>TRUE</code>, forces the dose response
curves to pass through the origin. See details for more informations on the proposed
growth curves, for OSL samples.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_distribution">distribution</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose, for OSL samples.
Allowed inputs are <code>"cauchy"</code>, <code>"gaussian"</code>, <code>"lognormal_A"</code> and <code>"lognormal_M"</code>,
see details for more informations.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_model_c14">Model_C14</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>"full"</code>, error on estimate calibration
curve is taken account, for C-14 samples.  If <code>"naive"</code> this error is not taken account in the age estimate.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_calibrationcurve">CalibrationCurve</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): calibration curve chosen, for C-14 samples.
Allowed inputs are
</p>

<ul>
<li> <p><b>&quot;Intcal13&quot;</b> or <b>&quot;Intcal13&quot;</b> for Northern Hemisphere atmospheric radiocarbon calibration curve,
</p>
</li>
<li> <p><b>&quot;Marine13&quot;</b> or <b>&quot;Marine13&quot;</b> for Marine radiocarbon calibration curve,
</p>
</li>
<li> <p><b>&quot;SHCal13&quot;</b> or <b>&quot;SHCal20&quot;</b> for Southern Hemisphere atmospheric radiocarbon calibration curve
</p>
</li>
<li> <p><b>a csv file, with tree columns, the first column is dedicated to &quot;Cal.BP&quot;, the second to &quot;XC-14.age&quot;, the third to &quot;Error&quot;.
The decimal of this file must be a dot, and the separator must be a comma. </b>
</p>
</li></ul>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_iter">Iter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations to run and who will be used to assess convergence and ages (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>]).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_burnin">burnin</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations used to &quot;home in&quot; on the stationary posterior distribution. These are not used for assessing convergence (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>]).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_adapt">adapt</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations used in the adaptive phase of the simulation (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>]).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_t">t</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): 1 every <code>t</code> iterations of the MCMC is
considered for sampling the posterior distribution (for more information see [<a href="rjags.html#topic+jags.model">rjags::jags.model</a>.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): number of independent chains for the model
(for more information see [<a href="rjags.html#topic+jags.model">rjags::jags.model</a>).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_jags_method">jags_method</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): select which method to use in order to call JAGS, supported are  <code>"rjags"</code> (the default), <code>rjparallel</code>, <code>simple</code>, <code>interruptible</code>, <code>parallel</code>, and <code>snow</code> (for more information about each of these possibilities, see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>])</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_autorun">autorun</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): choose to automate JAGS processing. JAGS model will be automatically extended until convergence is reached (for more information see <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>).</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_quiet">quiet</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enables/disables rjags messages</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_roundingofvalue">roundingOfValue</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default):  Integer indicating the number of decimal places to be used, default = 3.</p>
</td></tr>
<tr><td><code id="Age_OSLC14_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to control the Bayesian process, see details
for supported arguments</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that there are three types of arguments in the previous list.
There are arguments for information concerning only OSL samples: <code>DATA</code>, <code>BinPerSample</code>, <code>THETA</code>,
<code>sepTHETA</code>, <code>LIN_fit</code>, <code>Origin_fit</code>, <code>distribution</code>.
</p>
<p>There are arguments for information concerning only C14 samples: <code>Data_C14Cal</code>, <code>Data_SigmaC14Cal</code>,
<code>Model_C14</code>, <code>CalibrationCurve</code>.
</p>
<p>There are arguments for information concerning all the samples: <code>Nb_sample</code>, <code>SampleNames</code>, <code>SampleNature</code>,
<code>PriorAge</code>, <code>SavePdf</code>, <code>OutputFileName</code>, <code>OutputFilePath</code>, <code>SaveEstimates</code>, <code>OutputTableName</code>,
<code>OutputTablePath</code>, <code>StratiConstraints</code>, <code>sepSC</code>.<br />
</p>
<p><strong>Supported <code>...</code> arguments</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
ARGUMENT </td><td style="text-align: left;"> INPUT </td><td style="text-align: left;"> METHOD </td><td style="text-align: left;"> DEFAULT </td><td style="text-align: left;"> DESCRIPTION</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>max.time</code> </td><td style="text-align: left;"> <a href="base.html#topic+character">character</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>Inf</code> </td><td style="text-align: left;"> maximum allowed processing time, e.g.,
<code style="white-space: pre;">&#8288;10m&#8288;</code> for 10 minutes (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>interactive</code> </td><td style="text-align: left;"> <a href="base.html#topic+logical">logical</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>FALSE</code> </td><td style="text-align: left;"> enable/disable interactive mode (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>startburnin</code> </td><td style="text-align: left;"> <a href="base.html#topic+integer">integer</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;">  <code>4000</code> </td><td style="text-align: left;"> number of burn-in iterations (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>startsample</code> </td><td style="text-align: left;"> <a href="base.html#topic+integer">integer</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>10000</code> </td><td style="text-align: left;"> total number of samples to assess convergence
(cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>inits</code> </td><td style="text-align: left;"> named <a href="base.html#topic+list">list</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>NA</code> </td><td style="text-align: left;"> fine control over random seeds and random number generator <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>
</td>
</tr>

</table>

<p><strong>How to fill 'StratiConstraints?</strong><br />
</p>
<p>If there are stratigraphic relations between samples, <b>14C estimate age in <code>Data_C14Cal</code> must be ordered by order of increasing ages,
as informations in <code>DATA</code></b>. Names in <code>SampleNames</code> must be ordered and corresponds to the order in <code>Data_C14Cal</code> and in <code>DATA</code>,
also if it is needed to mix names of OSL samples and 14C samples.
</p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.
</p>

<ol>
<li> <p><b>Size of the matrix</b>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.
</p>
</li>
<li> <p><b>First line of the matrix</b>:
for all <code>i in {1,...,Nb_Sample}</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.
</p>
</li>
<li> <p><b>Sample relations</b>: for all  <code>j in {2,...,Nb_Sample+1}</code> and all <code>i in {j,...,Nb_Sample}</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than sample age whose number ID is equal to <code>i</code>.
Otherwise, <code>StratiConstraints[j,i]=0</code>.
</p>
</li></ol>

<p>Note that <code>StratiConstraints_{2:Nb_sample+1,1:Nb_sample}</code> is a upper triangular matrix.
</p>
<p>The user can also use <code><a href="#topic+SCMatrix">SCMatrix</a></code>  or <code><a href="#topic+SC_Ordered">SC_Ordered</a></code> (if all samples are ordered) function to construct
the <code>StratiConstraints</code> matrix.
</p>
<p>The user can also refer to a csv file that contains the relation between samples as defined above.
The user must be careful about which separator is used in the csv file using the argument <code>sepSC</code>.<br />
</p>
<p><strong>How to fill <code>THETA</code> covariance matrix concerning common and individual error?</strong><br />
</p>
<p>If systematic errors are considered, the user can fill the <code>THETA</code> matrix as follow.
</p>

<ul>
<li><p> row number of <code>THETA</code> is equal the column number, equal to <code>Nb_sample</code>.
</p>
</li>
<li><p> For all <code>i in {1,...,Nb_sample}</code>, <code>THETA[i,i]</code> contains individual error
plus systematic error of the sample whose number ID is equal to <code>i</code>.
</p>
</li>
<li><p> For all <code>i,j in {1,...,Nb_sample}</code> and <code>i</code> different from <code>j</code> ,
<code>THETA[i,j]</code> contains common error between samples whose number ID are equal to <code>i</code> and <code>j</code>.
</p>
</li></ul>

<p>Note that <code>THETA[i,j]</code> is a symmetric matrix.
</p>
<p>The user can also refer to a .csv file that contains the errors as defined above.<br />
</p>
<p><strong>Option on growth curves</strong><br />
</p>
<p>As for <code><a href="#topic+Age_Computation">Age_Computation</a></code> and <code><a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a></code>, the user can choose from 4 dose response curves:
</p>

<ul>
<li> <p><b>Saturating exponential plus linear growth</b> (<code>AgesMultiCS2_EXPLIN</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth</b> (<code>AgesMultiCS2_EXP</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential plus linear growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPLINZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li></ul>

<p><strong>Option on equivalent dose distribution around the palaeodose</strong><br />
</p>
<p>The use can choose between :
</p>

<ul>
<li> <p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample
</p>
</li></ul>

<p><strong>More precision on <code>Model</code></strong><br />
</p>
<p>We propose two models &quot;full&quot; or &quot;naive&quot;. If <code>Model='full'</code> that means measurement error and error on calibration curve are taken account in
the Bayesian model; if <code>Model="naive"</code> that means only error on measurement are taken account in the mode.
</p>
<p>More precisely, the model considered here, as the one developed by Christen, JA (1994), assume multiplicative effect of errors to address the
problem of outliers. In addition, to not penalise variables that are not outliers and damage theirs estimation,
we introduce a structure of mixture, that means only variable that are considered as outlier have in addition a multiplicative error.
</p>


<h3>Value</h3>

<p><b>NUMERICAL OUTPUT</b><br />
</p>

<ol>
<li> <p><b>A list containing the following objects:</b>
</p>

<ul>
<li> <p><b>Sampling</b>: that corresponds to a sample of the posterior distributions of the age parameters (in ka for both C14 samples and OSL samples);
</p>
</li>
<li> <p><b>PriorAge</b>: stating the priors used for the age parameter;
</p>
</li>
<li> <p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model;
</p>
</li>
<li> <p><b>Model_OSL_GrowthCurve</b>: stating which dose response fitting option was chosen;
</p>
</li>
<li> <p><b>Model_OSL_Distribution</b>: stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample;
</p>
</li>
<li> <p><b>Model_C14</b>: stating which model was chosen (<code>"full"</code> or <code>"naive"</code>);
</p>
</li>
<li> <p><b>CalibrationCurve</b>: stating which radiocarbon calibration curve was chosen;
</p>
</li>
<li> <p><b>Outlier</b>: stating the names of samples that must be outliers.
</p>
</li></ul>

</li>
<li> <p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergence for the age estimate for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergence of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergences (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC iterations (<code>Iter</code>)
or be more precise on the <code>PriorAge</code> parameter to reach convergence.
</p>
</li>
<li> <p><b>Credible intervals and Bayes estimates</b>: prints the Bayes' estimates, the credible intervals at 95% and 68% for
the age parameters for each sample.
</p>
</li>
<li> <p><b>JAGS model output</b>: returns the JAGS model with class &quot;runjags&quot;.
</p>
</li></ol>

<p><b>PLOT OUTPUT</b>
</p>

<ol>
<li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age parameter is displayed. <br />
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.
</p>
</li>
<li> <p><b>Age estimate and HPD at 95% of 14C samples on calibration curve</b>: plot age estimate and HPD on calibration plot.
</p>
</li>
<li> <p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes estimate of each sample age on a same graph.
</p>
</li></ol>



<h3>Note</h3>

<p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Anne Philippe, Guillaume Guerin, Sebastian Kreutzer, Frederik Harly Baumgarten
, RLum Developer Team</p>


<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M,
Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,
Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013.
IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH.
2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal BP. Radiocarbon 55(4):1889-1903
</p>


<h3>See Also</h3>

<p>runjags, <a href="#topic+plot_MCMC">plot_MCMC</a>, <a href="#topic+SCMatrix">SCMatrix</a>, <a href="#topic+plot_Ages">plot_Ages</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load data
# OSL data
data(DATA1,envir = environment())
data(DATA2,envir = environment())
Data &lt;- combine_DataFiles(DATA2,DATA1)

# 14C data
C14Cal &lt;- DATA_C14$C14[1,1]
SigmaC14Cal &lt;- DATA_C14$C14[1,2]
Names &lt;- DATA_C14$Names[1]

# Prior Age
prior &lt;- rep(c(1,60),3)
samplenature &lt;- matrix(
 data = c(1,0,1,0,1,0),
 ncol = 3,
 nrow = 2,
 byrow = TRUE)

SC &lt;- matrix(
 data = c(1,1,1,0,1,1,0,0,1,0,0,0),
 ncol = 3,
 nrow =4 ,
 byrow = TRUE)

## Age computation of samples
## Not run: 
Age &lt;- Age_OSLC14(
 DATA = Data,
 Data_C14Cal = C14Cal,
 Data_SigmaC14Cal = SigmaC14Cal,
 SampleNames = c("GDB5",Names,"GDB3"),
 Nb_sample = 3,
 SampleNature = samplenature,
 PriorAge = prior,
 StratiConstraints = SC,
 Iter = 20,
 burnin = 20,
 adapt = 20,
 n.chains = 2)

## End(Not run)

</code></pre>

<hr>
<h2 id='AgeC14_Computation'>Bayesian analysis for C-14 age estimations of various samples</h2><span id='topic+AgeC14_Computation'></span>

<h3>Description</h3>

<p>This function calibrates the C-14 age of samples to get an age (in ka).
The user can choose one of the following radiocarbon calibration curve:
Northern or Southern Hemisphere or marine atmospheric. It must be the same curve for all samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AgeC14_Computation(
  Data_C14Cal,
  Data_SigmaC14Cal,
  SampleNames,
  Nb_sample,
  PriorAge = rep(c(10, 50), Nb_sample),
  SavePdf = FALSE,
  OutputFileName = c("MCMCplot", "HPD_CalC-14Curve", "summary"),
  OutputFilePath = c(""),
  SaveEstimates = FALSE,
  OutputTableName = c("DATA"),
  OutputTablePath = c(""),
  StratiConstraints = c(),
  sepSC = c(","),
  Model = c("full"),
  CalibrationCurve = c("IntCal20"),
  Iter = 50000,
  t = 5,
  n.chains = 3,
  quiet = FALSE,
  roundingOfValue = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AgeC14_Computation_+3A_data_c14cal">Data_C14Cal</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<strong>required</strong>): corresponding to C-14 age estimate.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_data_sigmac14cal">Data_SigmaC14Cal</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<strong>required</strong>): corresponding to the error of C-14 age estimates.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): names of sample. The length of this vector is equal to <code>Nb_sample</code>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>: number of samples.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_priorage">PriorAge</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (with default): lower and upper bounds for age parameter of each sample in years (not in ka).
Note that, <code>length(PriorAge) == 2 * Nb_sample</code>
and <code>PriorAge[2i-1,2i]</code> corresponds to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_savepdf">SavePdf</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save graphs in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_outputfilename">OutputFileName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the pdf file that will be generated by the function if <code>SavePd=TRUE</code>,
<code style="white-space: pre;">&#8288;length(OutputFileName) = =3&#8288;</code>, see <b>PLOT OUTPUT</b> in <b>Value</b> section for more informations.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_outputfilepath">OutputFilePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the pdf file that will be generated by the function if <code>SavePdf=TRUE</code>.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_saveestimates">SaveEstimates</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save Bayes' estimates, credible interval at level 68% and 95% and
the result of the Gelman and Rubin test of convergence, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_outputtablename">OutputTableName</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): name of the table that will be generated by the function if <code>SaveEstimates=TRUE</code>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_outputtablepath">OutputTablePath</code></td>
<td>
<p>character (with default): path to the table that will be generated by the function if <code>SaveEstimates=TRUE</code>.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_straticonstraints">StratiConstraints</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> matrix or character(with default): input object for the stratigraphic relation between samples.
If there is stratigraphic relation between samples see the details section for instructions regarding how to correctly fill <code>StratiConstraints</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
If there is no stratigraphic relation default value is suitable.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_sepsc">sepSC</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> csv file.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_model">Model</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <b>&quot;full&quot;</b>, error on estimate calibration curve is taken account.
If <b>&quot;naive&quot;</b> this error is not taken account in the age estimate.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_calibrationcurve">CalibrationCurve</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): calibration curve chosen. Allowed inputs are
</p>

<ul>
<li> <p><b>&quot;Intcal13&quot;</b> or <b>&quot;Intcal13&quot;</b> for Northern Hemisphere atmospheric radiocarbon calibration curve,
</p>
</li>
<li> <p><b>&quot;Marine13&quot;</b> or <b>&quot;Marine13&quot;</b> for Marine radiocarbon calibration curve,
</p>
</li>
<li> <p><b>&quot;SHCal13&quot;</b> or <b>&quot;SHCal20&quot;</b> for Southern Hemisphere atmospheric radiocarbon calibration curve
</p>
</li>
<li> <p><b>a csv file, with tree columns, the first column is dedicated to <code>"Cal.BP"</code>, the second to <code>"XC-14.age"</code>, the third to <code>"Error"</code>.
The decimal of this file must be a dot, and the separator must be a comma. </b>
</p>
</li></ul>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_iter">Iter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of iterations for the MCMC computation (for more information see <a href="rjags.html#topic+jags.model">rjags::jags.model</a>).</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_t">t</code></td>
<td>
<p>integer (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see <a href="rjags.html#topic+jags.model">rjags::jags.model</a>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of independent chains for the model (for more information see <a href="rjags.html#topic+jags.model">rjags::jags.model</a>.</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_quiet">quiet</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enables/disables rjags messages</p>
</td></tr>
<tr><td><code id="AgeC14_Computation_+3A_roundingofvalue">roundingOfValue</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default):  Integer indicating the number of decimal places to be used, default set to 3.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>How to fill <code>StratiConstraints</code>?</strong>
</p>
<p>If there is stratigraphic relations between samples, <em>C-14 age in <code>Data_C14Cal</code> must be ordered by order of increasing ages</em>.
</p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.
</p>

<ol>
<li> <p><strong>Size of the matrix</strong>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.
</p>
</li>
<li> <p><strong>First line of the matrix</strong>:
for all <code style="white-space: pre;">&#8288;i in {1,...,Nb_Sample}&#8288;</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound
of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.
</p>
</li>
<li> <p><strong>Sample relations</strong>: for all  <code style="white-space: pre;">&#8288;j in {2,...,Nb_Sample+1}&#8288;</code> and all <code style="white-space: pre;">&#8288;i in {j,...,Nb_Sample}&#8288;</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than
sample age whose number ID is equal to <code>i</code>. Otherwise, <code>StratiConstraints[j,i]=0</code>.
</p>
</li></ol>

<p>Note that <code style="white-space: pre;">&#8288;StratiConstraints_{2:Nb_sample+1,1:Nb_sample}&#8288;</code> is a upper triangular matrix.
</p>
<p>The user can also use <code>SCMatrix</code> or <a href="#topic+SC_Ordered">SC_Ordered</a> (if all samples are ordered) functions
to construct the <code>StratiConstraints</code> matrix.
</p>
<p>The user can also refer to a .csv file that contains the relation between samples as defined above.
The user must take care about the separator used in the csv file using the argument <code>sepSC</code>.<br />
</p>
<p>** More precision on <code>Model</code> **<br />
</p>
<p>We propose two models &quot;full&quot; or &quot;naive&quot;. If <code>Model = 'full'</code> that means
measurement error and error on calibration curve are taken account in
the Bayesian model; if <code>Model = "naive"</code> that means only error on measurement
are taken account in the mode.
</p>
<p>More precisely, the model considered here, as the one developed by Christen, JA (1994),
assume multiplicative effect of errors to address the problem of outliers.
In addition, to not penalise variables that are not outliers and damage theirs estimation,
we introduce a structure of mixture, that means only variable that are considered
as outlier have in addition a multiplicative error.
</p>


<h3>Value</h3>

<p><b>NUMERICAL OUTPUT</b>
</p>

<ol>
<li> <p><b>A list containing the following objects:</b>
</p>

<ul>
<li> <p><b>Sampling</b>: that corresponds to a sample of the posterior distributions of the age parameters;
</p>
</li>
<li> <p><b>Outlier</b>: stating the names of samples that are considered as outliers;
</p>
</li>
<li> <p><b>Model</b>: stating which model was chosen (<code>"full"</code> or <code>"naive"</code>);
</p>
</li>
<li> <p><b>CalibrationCurve</b>: stating which radiocarbon calibration curve was chosen;
</p>
</li>
<li> <p><b>PriorAge</b>: stating the priors used for the age parameter;
</p>
</li>
<li> <p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model.
</p>
</li></ul>

</li>
<li><p><b>The Gelman and Rubin test of convergency</b>: print the result of the Gelman and Rubin test of convergence for the age estimate for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergence of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergences (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC iterations (<code>Iter</code>)
or being more precise if it is possible on the <code>PriorAge</code> parameter to reach convergence.
</p>
</li>
<li> <p><b>Credible intervals and Bayes estimates</b>: prints the Bayes' estimates, the credible intervals at 95% and 68% for
the age parameters for each sample.
</p>
</li></ol>

<p><b>PLOT OUTPUT</b>
</p>

<ol>
<li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age parameter is displayed. <br />
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.
</p>
</li>
<li> <p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes' estimate of each sample age on one graph.
</p>
</li></ol>

<p>To give the results in a publication, we recommend to give the Bayes' estimate of the parameters as well as the credible interval at 95% or 68%.
</p>


<h3>Note</h3>

<p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Anne Philippe, Guillaume Gu√©rin, Sebastian Kreutzer
, RLum Developer Team</p>


<h3>References</h3>

<p>Christen, JA (1994). Summarizing a set of radiocarbon determinations: a robust approach. Applied Statistics, 489-503.
</p>
<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M,
Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,
Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013.
IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH.
2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal. BP Radiocarbon 55(4):1889-1903
</p>


<h3>See Also</h3>

<p>rjags, <a href="#topic+plot_MCMC">plot_MCMC</a>, <a href="#topic+SCMatrix">SCMatrix</a>, <a href="#topic+plot_Ages">plot_Ages</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load data
data(DATA_C14,envir = environment())
C14Cal &lt;- DATA_C14$C14[,1]
SigmaC14Cal &lt;- DATA_C14$C14[,2]
Names &lt;- DATA_C14$Names
nb_sample &lt;- length(Names)

## Age computation of samples without stratigraphic relations
Age &lt;- AgeC14_Computation(
 Data_C14Cal = C14Cal,
 Data_SigmaC14Cal = SigmaC14Cal,
 SampleNames = Names,
 Nb_sample = nb_sample,
 PriorAge = rep(c(20,60),nb_sample),
 Iter = 500,
 quiet = TRUE,
 roundingOfValue = 3)

</code></pre>

<hr>
<h2 id='AgeS'>Output of <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code> function for the samples: &quot;GDB5&quot; and &quot;GDB3&quot;
</h2><span id='topic+AgeS'></span>

<h3>Description</h3>

<p>Output of <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code> function for the samples: &quot;GDB5&quot; and &quot;GDB3&quot;, there is no stratigraphic relation neither systematic errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("AgeS")</code></pre>


<h3>Format</h3>

<p>A list containing
</p>

<dl>
<dt><code>Sampling</code></dt><dd><p>MCMC.list that corresponds to a sample of the posterior distributions of the ages (in ka), palaeodoses (in Gy) and equivalent dose dispersions (in Gy) parameters of samples &quot;GDB5&quot; and &quot;GDB3&quot;; </p>
</dd>
<dt><code>Model_GrowthCurve</code></dt><dd><p>stating which dose response fitting option was chosen to run the function</p>
</dd>
<dt><code>Distribution</code></dt><dd><p>stating which distribution was chosen to model the dispersion of individual equivalent dose values around the palaeodose of the sample;</p>
</dd>
<dt><code>PriorAge</code></dt><dd><p>stating the priors used for the age parameter (in ka);</p>
</dd>
<dt><code>StratiConstraints</code></dt><dd><p>stating the matrix of stratigraphic relations between samples considered in the model;</p>
</dd>
<dt><code>CovarianceMatrix</code></dt><dd><p>stating the covariance matrix of error used in the model, highlighting  not common errors between samples in our cases (diagonal matrix).</p>
</dd>
</dl>



<h3>References</h3>

<p>Tribolo, C., Asrat, A., Bahain, J. J., Chapon, C., Douville, E., Fragnol, C., Hernandez, M., Hovers, E., Leplongeon, A.,  Martin, L,  Pleurdeau, D,  Pearson, O ,  Puaud, S,  Assefa, Z. (2017). Across the Gap: Geochronological and Sedimentological Analyses from the Late Pleistocene-Holocene Sequence of Goda Buticha, Southeastern Ethiopia. PloS one, 12(1), e0169418.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AgeS)
str(AgeS)
</code></pre>

<hr>
<h2 id='AgeS_Computation'>Bayesian analysis for OSL age estimation of various samples</h2><span id='topic+AgeS_Computation'></span>

<h3>Description</h3>

<p>This function computes the age (in ka) of at least two samples
according to the model developed in Comb√®s and Philippe (2017),
based on outputs of <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
or both of them using <a href="#topic+combine_DataFiles">combine_DataFiles</a>.<br />
Samples, for which data is available in several BIN files, can be analysed.<br />
Single-grain or Multi-grain OSL measurements can be analysed simultaneously.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>AgeS_Computation(
  DATA,
  SampleNames = DATA$SampleNames,
  Nb_sample = DATA$Nb_sample,
  PriorAge = rep(c(0.01, 100), Nb_sample),
  BinPerSample = rep(1, Nb_sample),
  SavePdf = FALSE,
  OutputFileName = c("MCMCplot", "summary"),
  OutputFilePath = c(""),
  SaveEstimates = FALSE,
  OutputTableName = c("DATA"),
  OutputTablePath = c(""),
  THETA = c(),
  sepTHETA = c(","),
  StratiConstraints = c(),
  sepSC = c(","),
  LIN_fit = TRUE,
  Origin_fit = FALSE,
  distribution = c("cauchy"),
  model = NULL,
  Iter = 10000,
  burnin = 4000,
  adapt = 1000,
  t = 5,
  n.chains = 3,
  jags_method = "rjags",
  autorun = FALSE,
  quiet = FALSE,
  roundingOfValue = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="AgeS_Computation_+3A_data">DATA</code></td>
<td>
<p>(<strong>required</strong>) Two inputs are possible:
(1): DATA <a href="base.html#topic+list">list</a> of objects: <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>, <code>K</code>, <code>Nb_measurement</code>,
provided by the function <a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> or <a href="#topic+combine_DataFiles">combine_DataFiles</a>.
<code>DATA</code> contains informations for more than one sample.
If there is stratigraphic relations between samples, informations in DATA must be ordered by order of increasing ages.
See the details section to for more informations.
(2): An object of class <code>BayLum.list</code> which is provided by the output of <a href="#topic+AgeS_Computation">AgeS_Computation</a>. When input of class <code>BayLum.list</code> is identified, no new JAGS model is created. Instead, the JAGS model specified by the <a href="#topic+AgeS_Computation">AgeS_Computation</a> output is extended. Useful for when convergence was not originally achieved and a complete restart is not desirable.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> vector: names of samples. The length of this vector is equal to <code>Nb_sample</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a>: number of samples, <code>Nb_sample&gt;1</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_priorage">PriorAge</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> vector (with default): lower and upper bounds for age parameter of each sample (in ka).
Note that, <code>length(PriorAge)=2*Nb_sample</code>
and <code>PriorAge[2i-1,2i]</code> corresponds to the lower and upper bounds of sample whose number ID is equal to <code>i</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> vector (with default): vector with the number of BIN files per sample.
The length of this vector is equal to <code>Nb_sample</code>.
<code>BinPerSample[i]</code> corresponds to the number of BIN files for the sample whose number ID is equal to <code>i</code>.
For more information to fill this vector, we refer to details in <a href="#topic+Generate_DataFile">Generate_DataFile</a> or in <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_savepdf">SavePdf</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save graphs in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_outputfilename">OutputFileName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the pdf file that will be generated by the function if <code>SavePdf = TRUE</code>;
<code>length(OutputFileName)=2</code>, see <b>PLOT OUTPUT</b> in <b>Value</b> section for more informations.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_outputfilepath">OutputFilePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the pdf file that will be generated by the function if <code>SavePdf</code>=TRUE.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_saveestimates">SaveEstimates</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE save Bayes' estimates, credible interval at level 68% and 95%  and
the result of the Gelman en Rubin test of convergence, in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_outputtablename">OutputTableName</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): name of the table that will be generated by the function if <code>SaveEstimates = TRUE</code>.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_outputtablepath">OutputTablePath</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): path to the table that will be generated by the function if <code>SaveEstimates = TRUE</code>.
If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_theta">THETA</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> <a href="base.html#topic+matrix">matrix</a> or <a href="base.html#topic+character">character</a> (with default): input object for systematic and individual error.
If systematic errors are considered, see the details section for instructions regarding how to correctly fill <code>THETA</code>;
the user can refer to a matrix (numeric matrix) or to a csv file (character).
Otherwise, default value is suitable, and only individual errors are considered.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_septheta">sepTHETA</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>THETA</code> is character,
indicate column separator in <code>THETA</code> CSV-file.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_straticonstraints">StratiConstraints</code></td>
<td>
<p>numeric matrix or character(with default): input object for the stratigraphic relation between samples. If there is stratigraphic relation between samples see the details section for instructions regarding how to correctly fill <code>StratiConstraints</code>; the user can refer to a matrix (numeric matrix) or to a csv file (character).
If there is no stratigraphic relation default value is suitable.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_sepsc">sepSC</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): if <code>StratiConstraints</code> is character,
indicate column separator in <code>StratiConstraints</code> .csv file.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_lin_fit">LIN_fit</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves.
See details section for more informations on the proposed dose response curves.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_origin_fit">Origin_fit</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): if TRUE, forces the dose response curves to pass through the origin.
See details section for more informations on the proposed growth curves.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_distribution">distribution</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose.
Allowed inputs are <code>"cauchy"</code>, <code>"gaussian"</code>, <code>"lognormal_A"</code> and <code>"lognormal_M"</code>,
see details section for more informations.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_model">model</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>): allows to provide a custom model to the function as text string. Please note that if this option is chosen the parameter <code>distribution</code> is ignored and no safety net is applied. If the function crashes it is up to the user.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_iter">Iter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations to run which will be used to assess convergence and ages (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_burnin">burnin</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations used to &quot;home in&quot; on the stationary posterior distribution. These are not used for assessing convergence (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_adapt">adapt</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): the number of iterations used in the adaptive phase of the simulation (see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_t">t</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution.
(for more information see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of independent chains for the model (for more information see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_jags_method">jags_method</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): select which method to use in order to call JAGS. jags_methods <code>"rjags"</code> (the default) and <code>"rjparallel"</code> have been tested. (for more information about these possibilities and others, see <a href="runjags.html#topic+run.jags">runjags::run.jags</a>)</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_autorun">autorun</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): choose to automate JAGS processing. JAGS model will be automatically extended until convergence is reached (for more information see <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>).</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_quiet">quiet</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enables/disables <code>rjags</code> messages</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_roundingofvalue">roundingOfValue</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default):  Integer indicating the number of decimal places to be used, default = 3.</p>
</td></tr>
<tr><td><code id="AgeS_Computation_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to control the Bayesian process. 1) When creating a new JAGS model, see details
for supported arguments. 2) If extending a JAGS model see arguments of <a href="runjags.html#topic+run.jags">runjags::extend.JAGS</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Supported <code>...</code> arguments</strong>
</p>

<table>
<tr>
 <td style="text-align: left;">
ARGUMENT </td><td style="text-align: left;"> INPUT </td><td style="text-align: left;"> METHOD </td><td style="text-align: left;"> DEFAULT </td><td style="text-align: left;"> DESCRIPTION</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>max.time</code> </td><td style="text-align: left;"> <a href="base.html#topic+character">character</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>Inf</code> </td><td style="text-align: left;"> maximum allowed processing time, e.g.,
<code style="white-space: pre;">&#8288;10m&#8288;</code> for 10 minutes (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>interactive</code> </td><td style="text-align: left;"> <a href="base.html#topic+logical">logical</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>FALSE</code> </td><td style="text-align: left;"> enable/disable interactive mode (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>)</td>
</tr>
<tr>
 <td style="text-align: left;">
<code>startburnin</code> </td><td style="text-align: left;"> <a href="base.html#topic+integer">integer</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;">  <code>4000</code> </td><td style="text-align: left;"> number of burn-in iterations (cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>startsample</code> </td><td style="text-align: left;"> <a href="base.html#topic+integer">integer</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>10000</code> </td><td style="text-align: left;"> total number of samples to assess convergence
(cf. <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>inits</code> </td><td style="text-align: left;"> named <a href="base.html#topic+list">list</a> </td><td style="text-align: left;"> <code>rjparallel</code> </td><td style="text-align: left;"> <code>NA</code> </td><td style="text-align: left;"> fine control over random seeds and random number generator <a href="runjags.html#topic+autorun.jags">runjags::autorun.jags</a>
</td>
</tr>

</table>

<p><strong>How to fill <code>StratiConstraints</code></strong><br />
</p>
<p>If there is stratigraphic relations between samples,
<em>informations in DATA must be ordered by order of increasing ages</em>.
To do this the user can either fill right <code>Names</code> in <a href="#topic+Generate_DataFile">Generate_DataFile</a>
or in <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> (as it is indicated in Details section of these function),
or ordered by order of increasing ages outputs of <a href="#topic+Generate_DataFile">Generate_DataFile</a>
or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> in <a href="#topic+combine_DataFiles">combine_DataFiles</a>
</p>
<p>The user can fill the <code>StratiConstraints</code> matrix as follow.
</p>

<ol>
<li> <p><b>Size of the matrix</b>: row number of <code>StratiConstraints</code> matrix is equal to <code>Nb_sample+1</code>,
and column number is equal to <code>Nb_sample</code>.
</p>
</li>
<li> <p><b>First line of the matrix</b>:
for all <code>i in {1,...,Nb_Sample}</code>, <code>StratiConstraints[1,i]=1</code> that means the lower bound of the sample age (given in <code>PriorAge[2i-1]</code>)
for the sample whose number ID is equal to <code>i</code>, is taken into account.
</p>
</li>
<li> <p><b>Sample relations</b>: for all  <code>j in {2,...,Nb_Sample+1}</code> and all <code>i in {j,...,Nb_Sample}</code>,
<code>StratiConstraints[j,i]=1</code> if sample age whose number ID is equal to <code>j-1</code> is lower than sample age whose number ID is equal to <code>i</code>.
Otherwise, <code>StratiConstraints[j,i]=0</code>.
</p>
</li></ol>

<p>Note that <code>StratiConstraints_{2:Nb_sample+A,1:Nb_sample}</code> is a upper triangular matrix.
</p>
<p>The user can also use <code><a href="#topic+SCMatrix">SCMatrix</a></code> or <code><a href="#topic+SC_Ordered">SC_Ordered</a></code> (if all samples are ordered) functions
to construct the <code>StratiConstraints</code> matrix.
</p>
<p>The user can also refer to a csv file that contains the relation between samples as defined above.
The user must take care about the separator used in the csv file using the argument <code>sepSC</code>.<br />
</p>
<p><strong>How to fill <code>THETA</code> covariance matrix concerning common and individual error?</strong><br />
</p>
<p>If systematic errors are considered, the user can fill the <code>THETA</code> matrix as follows.
</p>

<ul>
<li><p> row number of <code>THETA</code> is equal the column number, equal to <code>Nb_sample</code>.
</p>
</li>
<li><p> For all <code>i in {1,...,Nb_sample}</code>, <code>THETA[i,i]</code> contains individual error
plus systematic error of the sample whose number ID is equal to <code>i</code>.
</p>
</li>
<li><p> For all <code>i,j in {1,...,Nb_sample}</code> and <code>i</code> different from <code>j</code> ,
<code>THETA[i,j]</code> contains common error between samples whose number ID are equal to <code>i</code> and <code>j</code>.
</p>
</li></ul>

<p>Note that <code>THETA[i,j]</code> is a symetric matrix.
</p>
<p>The user can also refer to a .csv file that contains the errors as defined above.<br />
</p>
<p>Alternatively you can use the function <a href="#topic+create_ThetaMatrix">create_ThetaMatrix</a>.
</p>
<p><strong>Option on growth curves</strong><br />
</p>
<p>As for <code><a href="#topic+Age_Computation">Age_Computation</a></code> and <code><a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a></code>, the user can choose from 4 dose response curves:
</p>

<ul>
<li> <p><b>Saturating exponential plus linear growth</b> (<code>AgesMultiCS2_EXPLIN</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth</b> (<code>AgesMultiCS2_EXP</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential plus linear growth and fitting
through the origin</b> (<code>AgesMultiCS2_EXPLINZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth and fitting through the origin</b> (<code>AgesMultiCS2_EXPZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li></ul>

<p><strong>Option on equivalent dose distribution around the palaeodose</strong><br />
</p>
<p>The use can choose between :
</p>

<ul>
<li> <p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample;
</p>
</li>
<li> <p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample;
</p>
</li>
<li> <p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample:
</p>
</li>
<li> <p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample.
</p>
</li></ul>



<h3>Value</h3>

<p><strong>NUMERICAL OUTPUT</strong>
</p>

<ol>
<li> <p><strong>A list of type <code>BayLum.list</code> containing the following objects:</strong>
</p>

<ul>
<li> <p><b>Sampling</b>: that corresponds to a sample of the posterior distributions
of the age (in ka), palaeodose (in Gy) and equivalent dose dispersion (in Gy) parameters for each sample;
</p>
</li>
<li> <p><b>Model_GrowthCurve</b>: stating which dose response fitting option was chosen;
</p>
</li>
<li> <p><b>Distribution</b>: stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample;
</p>
</li>
<li> <p><b>PriorAge</b>: stating the priors used for the age parameter (in ka);
</p>
</li>
<li> <p><b>StratiConstraints</b>: stating the stratigraphic relations between samples considered in the model;
</p>
</li>
<li> <p><b>CovarianceMatrix</b>: stating the covariance matrix of error used in the model, highlighting common errors between samples or not.
</p>
</li>
<li> <p><b>model</b>: returns the model that was used for the Bayesian modelling as a <a href="base.html#topic+character">character</a>
</p>
</li>
<li> <p><b>JAGS model output</b>: returns the JAGS model with class &quot;runjags&quot;.
</p>
</li></ul>

</li>
<li><p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergence for
the age, palaeodose and equivalent dose dispersion parameters for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergence of the trajectories by looking at the graph
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergences (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the estimates as valid.
Otherwise, the user may try increasing the number of MCMC iterations (<code>Iter</code>)
or being more precise on the <code>PriorAge</code> parameter (for example specify if it is a young sample <code>c(0.01,10)</code> an old sample <code>c(10,100)</code>),
or changing the parameter <code>distribution</code> or the growth curve, to reach convergence.
</p>
</li>
<li> <p><b>Credible intervals and Bayes estimates</b>: prints the Bayes estimates, the credible intervals at 95% and 68% for
the age, palaeodose and equivalent dose dispersion parameters for each sample.
</p>
</li></ol>

<p><strong>PLOT OUTPUT</strong>
</p>

<ol>
<li><p><b>MCMC trajectories</b>: A graph with the MCMC trajectories and posterior distributions of the age, palaeodose and equivalent dose dispersion parameters
is displayed, there is one page per sample. <br />
The first line of the figure corresponds to the age parameter, the second to the palaeodose parameter
and the third to the equivalent dose dispersion parameter.
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.
</p>
</li>
<li> <p><b>Summary of sample age estimates</b>: plot credible intervals and Bayes estimate of each sample age on a same graph.
</p>
</li></ol>

<p>To give the results in a publication, we recommend to give the Bayes' estimate of the parameters as well as the credible interval at 95% or 68%.
</p>


<h3>Note</h3>

<p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Anne Philippe, Guillaume Gu√©rin, Sebastian Kreutzer
, RLum Developer Team</p>


<h3>References</h3>

<p>Combes, Benoit and Philippe, Anne, 2017.
Bayesian analysis of multiplicative Gaussian error for multiple ages estimation in optically stimulated luminescence dating.
Quaternary Geochronology (39, 24-34)
</p>
<p>Combes, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001
</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>, rjags, <a href="#topic+plot_MCMC">plot_MCMC</a>, <a href="#topic+SCMatrix">SCMatrix</a>, <a href="#topic+Age_Computation">Age_Computation</a>, <a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a>, <a href="#topic+plot_Ages">plot_Ages</a>, <a href="#topic+create_ThetaMatrix">create_ThetaMatrix</a>, runjags
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Age computation of samples GDB5 and GDB3,
## load data
data(DATA2) # GD85
data(DATA1) # GD83

## produce DataFile
Data &lt;- combine_DataFiles(DATA2, DATA1)

## without common error, assuming GDB5 age younger than GDB3 age
Nb_sample &lt;- 2
SC &lt;- matrix(
  data = c(1,1,0,1,0,0),
  ncol = 2,
  nrow = (Nb_sample+1),
  byrow = TRUE)

## Not run: 
## run standard
Age &lt;- AgeS_Computation(
  DATA = Data,
  Nb_sample = Nb_sample,
  SampleNames = c("GDB5","GDB3"),
  PriorAge = rep(c(1,100), 2),
  StratiConstraints = SC,
  Iter = 100,
  quiet = FALSE,
  jags_method = "rjags"
)

## extend model
Age_extended &lt;- AgeS_Computation(
  DATA = Age,
  Nb_sample = Nb_sample,
  SampleNames = c("GDB5","GDB3"),
  PriorAge = rep(c(1,100), 2),
  StratiConstraints = SC,
  adapt = 0,
  burnin = 500,
  Iter = 1000,
  quiet = FALSE,
  jags_method = "rjags"
)

## autorun mode
Age &lt;- AgeS_Computation(
  DATA = Data,
  Nb_sample = Nb_sample,
  SampleNames = c("GDB5","GDB3"),
  PriorAge = rep(c(1,100), 2),
  StratiConstraints = SC,
  Iter = 10000,
  quiet = FALSE,
  jags_method = "rjags",
  autorun = TRUE)

## parallel mode
Age &lt;- AgeS_Computation(
  DATA = Data,
  Nb_sample = Nb_sample,
  SampleNames = c("GDB5","GDB3"),
  PriorAge = rep(c(1,100), 2),
  StratiConstraints = SC,
  Iter = 10000,
  quiet = FALSE,
  jags_method = "rjparallel")

## End(Not run)

</code></pre>

<hr>
<h2 id='BayLum-deprecated'>Deprecated functions in package <span class="pkg">BayLum</span>.</h2><span id='topic+BayLum-deprecated'></span>

<h3>Description</h3>

<p>The functions listed below are deprecated and will be defunct in
the near future. When possible, alternative functions with similar
functionality are also mentioned. Help pages for deprecated functions are
available at <code>help("&lt;function&gt;-deprecated")</code>.
</p>

<hr>
<h2 id='combine_DataFiles'>Combine objects</h2><span id='topic+combine_DataFiles'></span><span id='topic+Concat_DataFile'></span>

<h3>Description</h3>

<p>Combine objects generated by <a href="#topic+Generate_DataFile">Generate_DataFile</a> and <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combine_DataFiles(...)

Concat_DataFile(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="combine_DataFiles_+3A_...">...</code></td>
<td>
<p>list objects generated by <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function allows to combine data already generated by <a href="#topic+Generate_DataFile">Generate_DataFile</a> or
<a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>. The number of input objects is not limited and the function
works similar to the standard base R function <code>c()</code>, but preserves the particular structure of the
objects imported and generated by 'BayLum'. The elements are combined by list
element names.
</p>
<p>Combining such data is rather useful in two scenarios:
</p>

<ul>
<li><p> The data have been already imported and treated and then stored in RData-files. Using the function
<code>combine_DataFiles()</code> will significantly speed up the processing time,
</p>
</li>
<li><p> simultaneous analysis of single and multi-grain OSL measurements.
</p>
</li></ul>



<h3>Value</h3>

<p>A nested list combining the input objects.
</p>


<h3>Function version</h3>

<p>0.1.1
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, IRAMAT-CRP2A, UMR 5060, CNRS - Universit√© Bordeaux Montaigne (France), adapting
the idea from the function 'Concat_DataFile()' by Claire Christophe.
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load data files
data(DATA1,envir = environment())
data(DATA2,envir = environment())

#combine objects
DATA3 &lt;- combine_DataFiles(DATA1, DATA2)
str(DATA3)
</code></pre>

<hr>
<h2 id='create_DataFile'>Prepare input data for subsequent BayLum Analysis</h2><span id='topic+create_DataFile'></span>

<h3>Description</h3>

<p>The function pre-processes input data from BIN/BINX file, XSYG files
or RLum.Analysis objects for <code>'BayLum'</code>. The parameters for
the modelling are controlled by a to be supplied YAML configuration file
(please read package vignette).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_DataFile(config_file, verbose = TRUE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_DataFile_+3A_config_file">config_file</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): path to YAML configuration file; alternatively
the config_file can be a <a href="base.html#topic+list">list</a> similar to the R representation of the imported YAML file.
This enables on-the fly modifications</p>
</td></tr>
<tr><td><code id="create_DataFile_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>): enable/disable terminal feedback</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function uses a single configuration file based on the YAML format and operates
in two modes:
</p>
<p>(1) The YAML file contains the path to the files and the function
attempts to import them. In such a case, all files must be thoroughly prepared
(e.g., strictly follow the SAR protocol etc.).
</p>
<p>(2) Alternatively, the YAML file contains no file paths but the data
were imported and processed before <code>create_DataFile()</code> was called (recommended).
Then the function is searching for objects with the sample name in the global environment.
Example: <code>samp1 &lt;- Luminescence::read_BIN2R(...)</code> with <code>samp1</code> the sample name as specified
in the YAML file.
</p>
<p>For more details, please see the package vignette.
</p>


<h3>Value</h3>

<p>Returns a <a href="base.html#topic+list">list</a> that can be processed by the modelling functions of 'BayLum'
</p>

<ul>
<li> <p><b>LT</b> (one list per sample); each list contains all L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>sLT</b> (one list per sample); each list contains all uncertainties on L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>ITimes</b> (one list per sample); each list contains irradiation time values for the corresponding sample;
</p>
</li>
<li> <p><b>dLab</b>, a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;
</p>
</li>
<li> <p><b>ddot_env</b>, a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;
</p>
</li>
<li> <p><b>regDose</b> (one list per sample); each list contains all regenerated doses;
</p>
</li>
<li> <p><b>J</b>, a vector giving, for each BIN file, the number of aliquots selected for the analysis;
</p>
</li>
<li> <p><b>K</b>, a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;
</p>
</li>
<li> <p><b>Nb_measurement</b>, a vector giving, for each BIN file, the number of measurements;
</p>
</li>
<li> <p><b>SampleNames</b>, a character vector with the sample names;
</p>
</li>
<li> <p><b>Nb_sample</b>, the number of samples in the dataset
</p>
</li></ul>



<h3>Function version</h3>

<p>0.1.0
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Ruprecht-Karl University of Heidelberg (Germany), in parts based on code by Claire Christophe
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+write_YAMLConfigFile">write_YAMLConfigFile</a>, <a href="yaml.html#topic+read_yaml">yaml::read_yaml</a>, <a href="Luminescence.html#topic+read_BIN2R">Luminescence::read_BIN2R</a>, <a href="Luminescence.html#topic+read_XSYG2R">Luminescence::read_XSYG2R</a>, <a href="Luminescence.html#topic+subset_SingleGrainData">Luminescence::subset_SingleGrainData</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##set path to YAML file
yaml_file &lt;- system.file("extdata/example.yml", package = "BayLum")

samp1_file &lt;- system.file("extdata/samp1/bin.bin", package = "BayLum")
samp2_file &lt;- system.file("extdata/samp2/bin.bin", package = "BayLum")

## import BIN files
samp1 &lt;- Luminescence::read_BIN2R(samp1_file, verbose = FALSE) |&gt;
 subset(POSITION == 2 &amp; GRAIN == 32)
samp2 &lt;- Luminescence::read_BIN2R(samp2_file, verbose = FALSE) |&gt;
 subset(POSITION == 2 &amp; GRAIN == 32)

## create file
create_DataFile(yaml_file)

</code></pre>

<hr>
<h2 id='create_FolderTemplates'>Create Folder Templates</h2><span id='topic+create_FolderTemplates'></span>

<h3>Description</h3>

<p>Create file and folder structure templates on the user hard drive
as expected by <a href="#topic+Generate_DataFile">Generate_DataFile</a> and <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>. Files and data in the
folders must then be overwritten manually with user data. The function intends to
minimise the errors going along with the creation of these folder structures.
The function uses the example data of <code>BayLum</code> to create the templates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_FolderTemplates(
  path,
  mode = "SG",
  n_folders = 1,
  names = paste("Sample_", 1:n_folders),
  verbose = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_FolderTemplates_+3A_path">path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): path to the folder where the templates
should be created</p>
</td></tr>
<tr><td><code id="create_FolderTemplates_+3A_mode">mode</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): depending on the dataset you can
create templates or single grain (<code>SG</code>) or multi-grain (<code>MG</code>) data</p>
</td></tr>
<tr><td><code id="create_FolderTemplates_+3A_n_folders">n_folders</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): number of template folders
to be created</p>
</td></tr>
<tr><td><code id="create_FolderTemplates_+3A_names">names</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>): allows give own names to the subfolders.</p>
</td></tr>
<tr><td><code id="create_FolderTemplates_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>): enables/disables verbose mode</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If the templates were created successfully on the hard drive, the function
returns nothing.
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Geography &amp; Earth Sciences, Aberystwyth University
(United Kingdom)
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>create_FolderTemplates(tempdir())


</code></pre>

<hr>
<h2 id='create_ThetaMatrix'>Create Theta Matrix</h2><span id='topic+create_ThetaMatrix'></span>

<h3>Description</h3>

<p>Create the <code class="reqn">\Theta</code> matrix with the shared uncertainties
that can used as input in, e.g., <a href="#topic+AgeS_Computation">AgeS_Computation</a> and <a href="#topic+Age_OSLC14">Age_OSLC14</a> which is used for the
covariance matrix <code class="reqn">\Sigma</code> (Comb√®s &amp; Philippe, 2017)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>create_ThetaMatrix(input, output_file = NULL, sigma_s, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="create_ThetaMatrix_+3A_input">input</code></td>
<td>
<p><a href="base.html#topic+character">character</a> or <a href="base.html#topic+data.frame">data.frame</a> (<em>optional</em>): input data frame or file connection
to import a CSV-file with the needed information. If nothing is provided the function returns
an input template. The argument <code>output_file</code> can be used to write this input template to the file
system</p>
</td></tr>
<tr><td><code id="create_ThetaMatrix_+3A_output_file">output_file</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (optional): file path for the output CSV-file, the field separator
is hard set to <code>","</code>. Please use <a href="utils.html#topic+write.table">utils::write.table</a> for more flexibility.</p>
</td></tr>
<tr><td><code id="create_ThetaMatrix_+3A_sigma_s">sigma_s</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<strong>required</strong>): named character with values for systematic uncertainties. Those values
are lab-specific. Can be set to <code>NULL</code> to remove systematic uncertainties. The order of the <em>named</em>
vector is not important, but the naming!
<strong>Note</strong>: some of the uncertainties have a unit, please check details.</p>
</td></tr>
<tr><td><code id="create_ThetaMatrix_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to <a href="utils.html#topic+read.table">utils::read.table</a> (for the CSV-file import)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function intends to ease the creation of the <code class="reqn">Theta</code> matrix, which cannot be
created straight forward, e.g., base R functions such as <code>stats::cov</code>.
The relationship between the covariance matrix  <code class="reqn">Sigma</code> and <code class="reqn">Theta</code> is given with
</p>
<p style="text-align: center;"><code class="reqn">\Sigma_ij = A_i * A_j * \Theta_ij</code>
</p>

<p>For details see Comb√®s &amp; Philippe, 2017 and Gu√©rin et al. (2021).
</p>
<p><strong>Input modes</strong>
</p>
<p>The function supports two different operation modes:
</p>

<ol>
<li> <p><code>input</code> is left empty: the function returns a <a href="base.html#topic+data.frame">data.frame</a> template that can be used as input (the option <code>output_file</code> works as well)
</p>
</li>
<li> <p><code>input</code> is fed with a <a href="base.html#topic+data.frame">data.frame</a> or a <code>character</code> (file path), the <code class="reqn">\Theta</code> matrix is returned
</p>
</li></ol>

<p><strong>Input format</strong>
</p>
<p>The function expects either a CSV-file or a <a href="base.html#topic+data.frame">data.frame</a> as input. To create template you can
run the function leaving the argument <code>input</code> empty (see example). Please note the format
of the input table (<a href="base.html#topic+data.frame">data.frame</a>) needs to kept as specified in the template.
</p>
<p>The following table lists the meaning of the columns:
</p>

<table>
<tr>
 <td style="text-align: left;">
COLUMN </td><td style="text-align: left;"> DESCRIPTION </td><td style="text-align: left;"> UNIT </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>SAMPLE_ID</code> </td><td style="text-align: left;"> sample name </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_BETA_K</code> </td><td style="text-align: left;">  standard error beta-dose rate K </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_BETA_U</code> </td><td style="text-align: left;">  standard error beta-dose rate U </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_BETA_Th</code> </td><td style="text-align: left;">  standard error beta-dose rate Th </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_GAMMA_K</code> </td><td style="text-align: left;">  standard error gamma-dose rate K </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_GAMMA_U</code> </td><td style="text-align: left;">  standard error gamma-dose rate U </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_GAMMA_Th</code> </td><td style="text-align: left;">  standard error gamma-dose rate Th </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_GAMMA_TOTAL</code> </td><td style="text-align: left;">  standard error total gamma-dose rate </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_TOTAL</code> </td><td style="text-align: left;"> total dose rate  </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>DR_TOTAL_X</code> </td><td style="text-align: left;"> standard error total dose rate  </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p><em>Note: All columns can be set to 0 or <code>NA</code> but no column must be left empty! If a value &gt; 0 is provided
for <code>DR_GAMMA_TOTAL</code> this value is taken and values in, e.g., <code>DR_GAMMA_K</code> are discarded (set to 0)!</em>
</p>
<p><strong>Systematic uncertainties</strong>
</p>
<p>The following table provides information on the named argument
that can be provided via the argument <code>sigma_s</code>. Missing values are not allowed, all
values must be set.
</p>

<table>
<tr>
 <td style="text-align: left;">
ARGUMENT </td><td style="text-align: left;"> DESCRIPTION </td><td style="text-align: left;"> UNIT </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_betaK</code> </td><td style="text-align: left;"> relative uncertainty K concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_betaU</code> </td><td style="text-align: left;"> relative uncertainty U concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_betaTh</code> </td><td style="text-align: left;"> relative uncertainty Th concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_gammaK</code> </td><td style="text-align: left;"> relative uncertainty K concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_gammaU</code> </td><td style="text-align: left;"> relative uncertainty U concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_gammaTh</code> </td><td style="text-align: left;"> relative uncertainty Th concentration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_gammaDR</code> </td><td style="text-align: left;"> relative uncertainty gamma-dose rate  </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_CAL</code> </td><td style="text-align: left;"> relative uncertainty beta-source calibration </td><td style="text-align: left;"> - </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>s_intDR</code> </td><td style="text-align: left;"> absolute uncertainty internal dose rate </td><td style="text-align: left;"> Gy/ka </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>



<h3>Value</h3>

<p>A symmetric <code class="reqn">Theta</code> matrix or if <code>input</code> is missing, a <a href="base.html#topic+data.frame">data.frame</a> with an input
template
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, IRAMAT-CRP2A, UMR 5060, CNRS-Universit√© Bordeaux Montaigne (France), based
on an 'MS Excel' sheet by Guillaume Gu√©rin, IRAMAT-CRP2A, UMR 5060, CNRS-Universit√© Bordeaux Montaigne (France)
, RLum Developer Team</p>


<h3>References</h3>

<p>Comb√®s, B., Philippe, A., 2017. Bayesian analysis of individual and systematic multiplicative errors
for estimating ages with stratigraphic constraints in optically stimulated luminescence dating.
Quaternary Geochronology 39, 24‚Äì34. <a href="https://doi.org/10.1016/j.quageo.2017.02.003">doi:10.1016/j.quageo.2017.02.003</a>
</p>
<p>Gu√©rin, G., Lahaye, C., Heydari, M., Autzen, M., Buylaert, J.-P., Guibert, P., Jain, M., Kreutzer, S., Lebrun, B., Murray, A.S., Thomsen, K.J., Urbanova, P., Philippe, A., 2021. Towards an improvement of optically stimulated luminescence (OSL) age uncertainties: modelling OSL ages with systematic errors, stratigraphic constraints and radiocarbon ages using the R package BayLum. Geochronology 3, 229‚Äî245.
<a href="https://doi.org/10.5194/gchron-3-229-2021">doi:10.5194/gchron-3-229-2021</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+AgeS_Computation">AgeS_Computation</a>, <a href="#topic+Age_OSLC14">Age_OSLC14</a>, <a href="utils.html#topic+read.table">utils::read.table</a>, <a href="utils.html#topic+write.table">utils::write.table</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>##(1) return template data.frame (no file output)
create_ThetaMatrix()

## Not run: 
##(2) return template as data.frame + file
file_path &lt;- tempfile(fileext = ".csv")
create_ThetaMatrix(output_file = file_path )

##NOT RUNNING EXAMPLE for sigma_s
calc_ThetaMatrix(...,
sigma_s =  c(
 s_betaK = 0.010,
 s_betaU = 0.007,
 s_betaTh = 0.006,
 s_gammaK = 0.010,
 s_gammaU = 0.007,
 s_gammaTh = 0.006,
 s_gammaDR = 0.05,
 s_CAL = 0.020,
 s_intDR = 0.030))


## End(Not run)



</code></pre>

<hr>
<h2 id='DATA_C14'>C14 cal age estiamte and its error
</h2><span id='topic+DATA_C14'></span>

<h3>Description</h3>

<p>C14 cal age estiamtes and theirs error of samples S-EVA-26510, S-EVA-26506, S-EVA-26507, S-EVA-26508.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DATA_C14")</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>Names:</code></dt><dd><p>character vector of the sample names;</p>
</dd>
<dt><code>C14:</code></dt><dd><p>numeric matrix, in the first column the 14C Cal age of the samples, and in the second column theirs errors.</p>
</dd>
</dl>



<h3>References</h3>

<p>For more informations on this sample we refer to the following publication:
</p>
<p>Guerin, G., Frouin, M., Talamo, S., Aldeias, V., Bruxelles, L., Chiotti, L., Goldberg, P., Hublin, J.J., Jain, M., Lahaye, C., Madelaine, S., Maureille, B., McPherron, S., Mercier, N., Murray, A., Sandgathe, D., Steele, T., Thomsen, K., Turq, A. (2015). A multi-method luminescence dating of the Palaeolithic sequence of La Ferrassie based on new excavations adjacent to the La Ferrassie 1 and 2 skeletons. Journal of Archaeological Science, 58, 147-166.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DATA_C14)
(DATA_C14)
</code></pre>

<hr>
<h2 id='DATA1'>DATA of sample named GDB3
</h2><span id='topic+DATA1'></span>

<h3>Description</h3>

<p>list of objects: LT, sLT, ITimes, dLab, ddot_env, regDose, J,K,Nb_measurement obtained using <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> function with single-grain OSL measurementsl of the sample GDB3.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DATA1")</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>LT:</code></dt><dd><p>(one list per sample): each list contains all L/T values for the corresponding sample;</p>
</dd>
<dt><code>sLT:</code></dt><dd><p>(one list per sample): each list contains all uncertainties on L/T values for the corresponding sample;</p>
</dd>
<dt><code>ITimes:</code></dt><dd><p>(one list per sample): each list contains irradiation time values for the corresponding sample;</p>
</dd>
<dt><code>dLab=</code></dt><dd><p>a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;</p>
</dd>
<dt><code>ddot_env:</code></dt><dd><p>a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;</p>
</dd>
<dt><code>regDose:</code></dt><dd><p>(one list per sample): each list contains all regenerated doses;</p>
</dd>
<dt><code>J:</code></dt><dd><p>a vector giving, for each BIN file, the number of aliquots selected for the analysis;</p>
</dd>
<dt><code>K:</code></dt><dd><p>a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;</p>
</dd>
<dt><code>Nb_measurement:</code></dt><dd><p>a vector giving, for each BIN file, the number of measurements;</p>
</dd>
</dl>



<h3>References</h3>

<p>For more informations on this sample we refer to the following publication:
</p>
<p>Tribolo, C., Asrat, A., Bahain, J. J., Chapon, C., Douville, E., Fragnol, C., Hernandez, M., Hovers, E., Leplongeon, A.,  Martin, L,  Pleurdeau, D,  Pearson, O ,  Puaud, S,  Assefa, Z. (2017). Across the Gap: Geochronological and Sedimentological Analyses from the Late Pleistocene-Holocene Sequence of Goda Buticha, Southeastern Ethiopia. PloS one, 12(1), e0169418.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DATA1)
str(DATA1)
</code></pre>

<hr>
<h2 id='DATA2'>DATA on sample named GDB5
</h2><span id='topic+DATA2'></span>

<h3>Description</h3>

<p>list of objects: LT, sLT, ITimes, dLab, ddot_env, regDose, J,K,Nb_measurement obtained using <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> function  with single-grain OSL measurementsl of the sample GDB5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DATA2")</code></pre>


<h3>Format</h3>

<p>A data frame containing:
</p>

<dl>
<dt><code>LT:</code></dt><dd><p>(one list per sample): each list contains all L/T values for the corresponding sample;</p>
</dd>
<dt><code>sLT:</code></dt><dd><p>(one list per sample): each list contains all uncertainties on L/T values for the corresponding sample;</p>
</dd>
<dt><code>ITimes:</code></dt><dd><p>(one list per sample): each list contains irradiation time values for the corresponding sample;</p>
</dd>
<dt><code>dLab:</code></dt><dd><p>a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;</p>
</dd>
<dt><code>ddot_env:</code></dt><dd><p>a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;</p>
</dd>
<dt><code>regDose:</code></dt><dd><p>(one list per sample): each list contains all regenerated doses;</p>
</dd>
<dt><code>J:</code></dt><dd><p>a vector giving, for each BIN file, the number of aliquots selected for the analysis;</p>
</dd>
<dt><code>K:</code></dt><dd><p>a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;</p>
</dd>
<dt><code>Nb_measurement:</code></dt><dd><p>, a vector giving, for each BIN file, the number of measurements;</p>
</dd>
</dl>



<h3>References</h3>

<p>For more informations on this sample we refer to the following publication:
</p>
<p>Tribolo, C., Asrat, A., Bahain, J. J., Chapon, C., Douville, E., Fragnol, C., Hernandez, M., Hovers, E., Leplongeon, A.,  Martin, L,  Pleurdeau, D,  Pearson, O ,  Puaud, S,  Assefa, Z. (2017). Across the Gap: Geochronological and Sedimentological Analyses from the Late Pleistocene-Holocene Sequence of Goda Buticha, Southeastern Ethiopia. PloS one, 12(1), e0169418.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DATA2)
str(DATA2)
</code></pre>

<hr>
<h2 id='DATA3'>
DATA of sample named FER1</h2><span id='topic+DATA3'></span>

<h3>Description</h3>

<p>list of objects: LT, sLT, ITimes, dLab, ddot_env, regDose, J,K,Nb_measurement obtained using <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> function with multi-grain OSL measurementsl of the sample FER1.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("DATA3")</code></pre>


<h3>Format</h3>

<p>A list containing:
</p>

<dl>
<dt><code>LT:</code></dt><dd><p>(one list per sample): each list contains all L/T values for the corresponding sample;</p>
</dd>
<dt><code>sLT:</code></dt><dd><p>(one list per sample): each list contains all uncertainties on L/T values for the corresponding sample;</p>
</dd>
<dt><code>ITimes:</code></dt><dd><p>(one list per sample): each list contains irradiation time values for the corresponding sample;</p>
</dd>
<dt><code>dLab=</code></dt><dd><p>a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;</p>
</dd>
<dt><code>ddot_env:</code></dt><dd><p>a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;</p>
</dd>
<dt><code>regDose:</code></dt><dd><p>(one list per sample): each list contains all regenerated doses;</p>
</dd>
<dt><code>J:</code></dt><dd><p>a vector giving, for each BIN file, the number of aliquots selected for the analysis;</p>
</dd>
<dt><code>K:</code></dt><dd><p>a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;</p>
</dd>
<dt><code>Nb_measurement:</code></dt><dd><p>a vector giving, for each BIN file, the number of measurements;</p>
</dd>
</dl>



<h3>References</h3>

<p>For more informations on this sample we refer to the following publication:
</p>
<p>Guerin, G., Frouin, M., Talamo, S., Aldeias, V., Bruxelles, L., Chiotti, L., Goldberg, P., Hublin, J.J., Jain, M., Lahaye, C., Madelaine, S., Maureille, B., McPherron, S., Mercier, N., Murray, A., Sandgathe, D., Steele, T., Thomsen, K., Turq, A. (2015). A multi-method luminescence dating of the Palaeolithic sequence of La Ferrassie based on new excavations adjacent to the La Ferrassie 1 and 2 skeletons. Journal of Archaeological Science, 58, 147-166.</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(DATA3)
str(DATA3)
</code></pre>

<hr>
<h2 id='Generate_DataFile_MG-deprecated'>Generates, from one (or several) BIN file(s) of Multi-grain OSL measurements a list of luminescence data and information before statistical analysis (DEPRECATED)</h2><span id='topic+Generate_DataFile_MG-deprecated'></span><span id='topic+Generate_DataFile_MG'></span>

<h3>Description</h3>

<p>This function is used to generate, from the BIN file(s), a list of values of:
</p>
<p><b>Multi-grain</b> OSL intensities and associated uncertainties, regenerative doses, etc., which will be the input of the Bayesian models.
To be easy-to-use, this function requires a rigorous organisation - all needed files should be arranged in one folder -
of informations concerning each BIN file.<br />
It is possible to process data for various samples simultaneously and to consider more
than one BIN-file per sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Generate_DataFile_MG(
  Path,
  FolderNames,
  Nb_sample,
  Nb_binfile = length(FolderNames),
  BinPerSample = rep(1, Nb_sample),
  sepD = c(","),
  sepDE = c(","),
  sepDS = c(","),
  sepR = c("="),
  verbose = TRUE,
  force_run1_at_a_time = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_path">Path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): the path to the project folder, containing one or more sub folders in which the BIN files
are located. If it is not equal to <code>""</code>, it must end with <code>"/"</code>.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_foldernames">FolderNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>) vector: list of names of the sub-folders containing the BIN files
</p>

<ul>
<li><p> each sub folder must contain a BIN file and associated csv files.
See details for more informations on associated csv files required in the sub folders.
If there is more than one BIN file per sample, see the details section for instructions regarding how to correctly fill the
<code>FolderNames</code> vector.
</p>
</li></ul>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<strong>required</strong>): number of samples</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_nb_binfile">Nb_binfile</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of BIN files. It must be equal to, or greater than <code>Nb_sample</code>.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> vector (with default): vector with the number of BIN files per sample.
The length of this vector must be equal to <code>Nb_sample</code> and the sum of entries of this vector must be equal to <code>Nb_binfile</code>.
If there is more than one BIN file per sample, see the details section for instructions regarding how to correctly fill <code>BinPerSample</code> vector.
Otherwise, this vector must contain a list of 1 values.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_sepd">sepD</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DiscPose.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_sepde">sepDE</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DoseEnv.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_sepds">sepDS</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DoseLab.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_sepr">sepR</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>Rule.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enable/disable verbose mode</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_force_run1_at_a_time">force_run1_at_a_time</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (<em>with default</em>): if set to <code>TRUE</code>, the order of the records is
pushed to follow the one &quot;Run 1 at a time&quot; order (this is, all sequence steps were performed on
one aliquot before moving to the next aliquot), regardless of their original sequence.
The default is <code>FALSE</code> because <code>'BayLum'</code> assumes that the sample was measured with the
&quot;Run 1 at a time&quot; option (only Ris√∏ readers, lexsyg readers do not have another option).
In other words, the argument allows you to automatically correct your input data to follow the order <code>'BayLum'</code> expects.
Why isn't the default value <code>TRUE</code>?. Because this re-ordering must fail
if a measurement position was used more than once for different samples!
This typically happens when different BIN/BINX files are merged.</p>
</td></tr>
<tr><td><code id="Generate_DataFile_MG-deprecated_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to <a href="Luminescence.html#topic+read_BIN2R">Luminescence::read_BIN2R</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code>Path</code> and <code>FolderNames</code>, this function goes to the sub folders containing the BIN files and associated information to compute
the luminescence data.<br />
</p>
<p>** What are the required files in each subfolder? **<br />
</p>
<p>Each subfolder can be named, for example, as the sample name followed by a number; it must contain:
</p>

<ul>
<li> <p><b>bin.bin</b>, the bin file renamed as bin.BIN (note: the name of all files matters);
</p>
</li>
<li> <p><b>Disc.csv</b>, a one columns csv file containing the list of disc number of the previously selected grains
(typically this list will include the position of grains based on their sensitivity, recycling or other properties);
</p>
</li>
<li> <p><b>DoseEnv.csv</b>, a two columns file containing the observation of the natural (or environmental),
dose rate, and its non-shared variance (i.e. after removing all shared errors), both in Gy. Note: the user shall provide the squared value of the error associated
with the dose rate experienced by the sample grains in nature;
</p>
</li>
<li> <p><b>DoseSourve.csv</b>, a two columns file containing the observation of the laboratory dose rate,
and its variance (squared error), both in Gy;
</p>
</li>
<li> <p><b>rule.csv</b>, a csv file containing information on
</p>

<ul>
<li> <p><code style="white-space: pre;">&#8288;beginSignal=&#8288;</code>  the first channel for summing the natural or regenerative OSL signal (typically 1 or 6);
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;endSignal=&#8288;</code> the last channel for summing the natural or regenerative OSL signal (typically 5 or 10);
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;beginBackground=&#8288;</code> the first channel for background estimation of the natural or regenerative OSL signal (typically 76 or 81);
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;endBackground=&#8288;</code> the last channel for background estimation of the natural or regenerative OSL signal (typically 95 or 100);
</p>
</li>
<li> <p><code>beginTest</code>,
</p>
</li>
<li> <p><code>endTest</code>,
</p>
</li>
<li> <p><code>beginTestBackground</code>,
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;endTestBackground=&#8288;</code> same values as above, for the test dose response (typically the same values should be used);
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;inflatePercent=&#8288;</code> uncertainty arising from the instrument reproducibility (typically 0.02, i.e. 2\
</p>
</li>
<li> <p><code style="white-space: pre;">&#8288;nbOfLastCycleToRemove=&#8288;</code> number of cycles at the end of the SAR protocol which should not be included in the dose response curve fitting
(typically 1 if only a recycling test is performed, or 2 if both recycling and IR depletion are tested).<br />
</p>
</li></ul>

</li></ul>

<p>** How to fill the <code>FolderNames</code> vector? **<br />
</p>
<p><code>FolderNames</code> is a vector of length <code>Nb_binfile</code>. <code>FolderNames[i]</code> is the name (e.g., Sample1-File1, or successive names separated by &quot;/&quot; signs,
if BIN files are in subfolders, e.g. Sample1/File1) of the subfolder containing all informations on the BIN file of ID number <code>i</code>.
The names in <code>FolderNames</code> are ordered following two rules:
</p>

<ul>
<li><p> The names in the <code>FolderNames</code> vector must be ordered following the sample order
(the names of subfolders containing BIN files for the same sample should follow each other in the <code>FolderNames</code> vector, e.g.
Sample1, Sample2-File1, Sample2-File2, etc.).
</p>
</li>
<li><p> If stratigraphic constraints apply to samples, and so a <b>Bayesian model with stratigraphic constraints</b> is implemented,
then the names in the <code>FolderNames</code> vector must be ordered by order of increasing ages. <br />
For example, <code>FolderNames=c(noun1,noun2)</code>, in which case <code>noun1</code> (respectively, <code>noun2</code>) corresponds to the subfolder
name containing the BIN file of sample 1 (respectively of sample 2).
In addition, if we know that sample 1 is younger than sample 2, then <code>FolderNames</code> vector is correctly filled. <br />
If conversely, <code>FolderNames=c(noun2,noun1)</code>, the analysis performed by <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code> would not be consistent.<br />
</p>
</li></ul>

<p>** How to fill the <code>BinPerSample</code> vector? **<br />
</p>
<p><code>BinPerSample[i]</code> corresponds to the number of BIN files for the sample whose number ID is equal to <code>i</code>.<br />
For example, let us consider a case with two samples (Sample1 and Sample2), with 2 BIN files for Sample1 and 1 for Sample2.
In this case, <code>Nb_binfile</code>=3 and <code>Nb_sample</code>=2.
The user may then set <code>FolderNames=c("Sample1-File1", "Sample1-File2", "Sample2-File1")</code>, in which case <code>"Sample1-1"</code> is the name of the subfolder containing the first BIN file
for Sample1, <code>"Sample1-File2"</code> the name of the  subfolder for the second BIN file of Sample1; eventually, <code>"Sample2-1"</code> is the name of the subfolder containing the BIN file
for the second sample. In this case, <code>BinPerSample=c(2,1)</code>.
</p>
<p>For the general BIN-file structure, the reader is referred to the following website:  <code style="white-space: pre;">&#8288;http://www.nutech.dtu.dk/&#8288;</code>
</p>
<p>The function <a href="Luminescence.html#topic+read_BIN2R">Luminescence::read_BIN2R</a> is used to read the BIN files.
</p>


<h3>Value</h3>

<p>A list containing the following objects:
</p>

<ul>
<li> <p><b>LT</b> (one list per sample); each list contains all L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>sLT</b> (one list per sample); each list contains all uncertainties on L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>ITimes</b> (one list per sample); each list contains irradiation time values for the corresponding sample;
</p>
</li>
<li> <p><b>dLab</b>, a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;
</p>
</li>
<li> <p><b>ddot_env</b>, a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;
</p>
</li>
<li> <p><b>regDose</b> (one list per sample); each list contains all regenerated doses;
</p>
</li>
<li> <p><b>J</b>, a vector giving, for each BIN file, the number of aliquots selected for the analysis;
</p>
</li>
<li> <p><b>K</b>, a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;
</p>
</li>
<li> <p><b>Nb_measurement</b>, a vector giving, for each BIN file, the number of measurements;
</p>
</li></ul>

<p>** How to save this list **
</p>
<p>You can save this list in a .RData object. To do this, you can use the function <code><a href="base.html#topic+save">save</a></code>.
Then, to load this list you can use the function <code><a href="base.html#topic+load">load</a></code> (see example section fore more details).
</p>


<h3>Note</h3>

<p>The function imports only BIN/BINX-file records which have been previously selected.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>See Also</h3>

<p><code>read_BIN2R</code>, <code><a href="#topic+combine_DataFiles">combine_DataFiles</a></code>, <code><a href="#topic+LT_RegenDose">LT_RegenDose</a></code>
<code><a href="#topic+Age_Computation">Age_Computation</a></code>, <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>, <code><a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
path &lt;- system.file("extdata/FER1", "", package="BayLum")
folder &lt;- ""
# give the number of sample
nbsample &lt;- 1
DATA &lt;- Generate_DataFile_MG(
 Path = path,
 FolderNames = folder,
 Nb_sample = nbsample)
str(DATA)

# to save information in RData object in folder containing bin file
#save(DATA,file=c(paste(path,folder,'DATA.RData',sep="")))
# to load information containing DATA.RData object
#load(file=c(paste(path,folder,"DATA.RData",sep="")))

## End(Not run)
</code></pre>

<hr>
<h2 id='Generate_DataFile-deprecated'>Generates, from one (or several) BIN-file(s) of Single-grain OSL measurements, a list of luminescence data and information before statistical analysis (DEPRECATED)</h2><span id='topic+Generate_DataFile-deprecated'></span><span id='topic+Generate_DataFile'></span>

<h3>Description</h3>

<p>This function is used to generate, from the BIN file(s), a list of values of:
<b>Single-grain</b> OSL intensities and associated uncertainties, regenerative doses, etc., which will be the input of the Bayesian models.
To be easy-to-use, this function requires a rigorous organisation - all needed files should be arranged in one folder -
of informations concerning each BIN file. <br />
It is possible to process data for various samples simultaneously and to consider more than one BIN file per sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Generate_DataFile(
  Path,
  FolderNames,
  Nb_sample,
  Nb_binfile = length(FolderNames),
  BinPerSample = rep(1, Nb_sample),
  sepDP = c(","),
  sepDE = c(","),
  sepDS = c(","),
  sepR = c("="),
  verbose = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Generate_DataFile-deprecated_+3A_path">Path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): the path to the project folder, containing one or more sub folders in which the BIN files
are located. If it is not equal to &quot;&quot;, it must be terminated by &quot;/&quot;.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_foldernames">FolderNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): list of names of the sub-folders containing the BIN files
</p>

<ul>
<li><p> each sub folder must contain a BIN file and associated csv files.
See details for more informations on associated csv files required in the sub folders.
If there is more than one BIN file per sample, see the details section for instructions regarding how to correctly fill the
<code>FolderNames</code> vector.
</p>
</li></ul>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<strong>required</strong>): number of samples.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_nb_binfile">Nb_binfile</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): number of BIN files. It must be equal to, or greater than <code>Nb_sample</code>.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> vector (with default): vector with the number of BIN files per sample.
The length of this vector must be equal to <code>Nb_sample</code> and the sum of entries of this vector must be equal to <code>Nb_binfile</code>.
If there is more than one BIN file per sample, see the details section for instructions regarding how to correctly
fill <code>BinPerSample</code> vector.
Otherwise, this vector must contain a list of 1 values.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_sepdp">sepDP</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DiscPose.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_sepde">sepDE</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DoseEnv.csv</code> files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_sepds">sepDS</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the 'DoseLab.csv&ldquo; files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_sepr">sepR</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the Rule.csv files.</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_verbose">verbose</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): enable/disable verbose mode</p>
</td></tr>
<tr><td><code id="Generate_DataFile-deprecated_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to <a href="Luminescence.html#topic+read_BIN2R">Luminescence::read_BIN2R</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>With <code>Path</code> and <code>FolderNames</code>, this function goes to the sub folders containing the BIN files and associated information to compute
the luminescence data.<br />
</p>
<p><b>** What are the required files in each subfolder? **</b><br />
</p>
<p>Each sub folder can be named, for example, as the sample name followed by a number; it must contain:
</p>

<ul>
<li> <p><b>bin.bin</b>: the bin file renamed as bin.BIN (note: the name of all files matters);
</p>
</li>
<li> <p><b>DiscPos.csv</b>: a two columns csv file containing the list of disc and grain position number of the previously selected grains
(typically this list will include the position of grains based on their sensitivity, recycling or other properties);
</p>
</li>
<li> <p><b>DoseEnv.csv</b>: a two columns file containing the observation of the natural (or environmental),
dose rate, and its non-shared variance (i.e. after removing all shared errors), both in Gy. Note: the user shall provide the squared value of the error associated
with the dose rate experienced by the sample grains in nature;
</p>
</li>
<li> <p><b>DoseSourve.csv</b>: a two columns file containing the observation of the laboratory dose rate,
and its variance (squared error) both in Gy;
</p>
</li>
<li> <p><b>rule.csv</b>: a csv file containing information on
</p>

<ul>
<li> <p><code>beginSignal=</code>  the first channel for summing the natural or regenerative OSL signal (typically 1 or 6);
</p>
</li>
<li> <p><code>endSignal=</code> the last channel for summing the natural or regenerative OSL signal (typically 5 or 10);
</p>
</li>
<li> <p><code>beginBackground=</code> the first channel for background estimation of the natural or regenerative OSL signal (typically 76 or 81);
</p>
</li>
<li> <p><code>endBackground=</code> the last channel for background estimation of the natural or regenerative OSL signal (typically 95 or 100);
</p>
</li>
<li> <p><code>beginTest=</code>,
</p>
</li>
<li> <p><code>endTest=</code>,
</p>
</li>
<li> <p><code>beginTestBackground=</code>,
</p>
</li>
<li> <p><code>endTestBackground=</code> same values as above, for the test dose response (typically the same values should be used);
</p>
</li>
<li> <p><code>inflatePercent=</code> uncertainty arising from the instrument reproducibility (typically 0.02, i.e. 2\
</p>
</li>
<li> <p><code>nbOfLastCycleToRemove=</code> number of cycles at the end of the SAR protocol which should not be included in the dose response curve fitting
(typically 1 if only a recycling test is performed, or 2 if both recycling and IR depletion are tested).<br />
</p>
</li></ul>

</li></ul>

<p><b>** How to fill the</b> <code>FolderNames</code> <b>vector? **</b><br />
</p>
<p><code>FolderNames</code> is a vector of length <code>Nb_binfile</code>. <code>FolderNames[i]</code> is the name (e.g., Sample1-File1, or successive names separated by &quot;/&quot; signs,
if BIN files are in subfolders, e.g. Sample1/File1) of the subfolder containing all informations on the BIN file of ID number <code>i</code>.
The names in <code>FolderNames</code> are ordered following two rules:
</p>

<ul>
<li><p> The names in the <code>FolderNames</code> vector must be ordered following the sample order
(the names of subfolders containing BIN files for the same sample should follow each other in the <code>FolderNames</code> vector, e.g.
Sample1, Sample2-File1, Sample2-File2, etc.).
</p>
</li>
<li><p> If stratigraphic constraints apply to samples, and so a <b>Bayesian model with stratigraphic constraints</b> is implemented,
then the names in the <code>FolderNames</code> vector must be ordered by order of increasing ages. <br />
For example, <code>FolderNames=c(noun1,noun2)</code>, in which case <code>noun1</code> (respectively, <code>noun2</code>) corresponds to the subfolder
name containing the BIN file of sample 1 (respectively of sample 2).
In addition, if we know that sample 1 is younger than sample 2, then <code>FolderNames</code> vector is correctly filled. <br />
If conversely, <code>FolderNames=c(noun2,noun1)</code>, the analysis performed by <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code> would not be consistent.<br />
</p>
</li></ul>

<p><b>** How to fill the</b> <code>BinPerSample</code> <b>vector? **</b><br />
</p>
<p><code>BinPerSample[i]</code> correponds to the number of BIN files for the sample whose number ID is equal to <code>i</code>.<br />
For example, let us consider a case with two samples (Sample1 and Sample2), with 2 BIN files for Sample1 and 1 for Sample2.
In this case, <code>Nb_binfile</code>=3 and <code>Nb_sample</code>=2.
The user may then set <code>FolderNames=c("Sample1-File1", "Sample1-File2", "Sample2-File1")</code>, in which case <code>"Sample1-File1"</code> is the name of the subfolder
containing the first BIN file for Sample1, <code>"Sample1-File2"</code> the name of the  subfolder for the second BIN file of Sample1; eventually,
<code>"Sample2-File1"</code> is the name of the subfolder containing the BIN file for the second sample. In this case, <code>BinPerSample=c(2,1)</code>.
</p>
<p>For the general BIN-file structure, the reader is referred to the following website:
<code>http://www.nutech.dtu.dk/</code>
</p>
<p>The function <code>read_BIN2R</code> developped in <code>Luminescence</code> package is used to read the BIN files.
</p>


<h3>Value</h3>

<p>A list containing the following objects:
</p>

<ul>
<li> <p><b>LT</b> (one list per sample); each list contains all L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>sLT</b> (one list per sample); each list contains all uncertainties on L/T values for the corresponding sample;
</p>
</li>
<li> <p><b>ITimes</b> (one list per sample); each list contains irradiation time values for the corresponding sample;
</p>
</li>
<li> <p><b>dLab</b>, a matrix containing in line <code>i</code>, the laboratory dose rate and its variance for sample <code>i</code>;
</p>
</li>
<li> <p><b>ddot_env</b>, a matrix containing in line <code>i</code>, the environmental dose rate and its variance (excluding the common error terms) for sample <code>i</code>;
</p>
</li>
<li> <p><b>regDose</b> (one list per sample); each list contains all regenerated doses;
</p>
</li>
<li> <p><b>J</b>, a vector giving, for each BIN file, the number of aliquots selected for the analysis;
</p>
</li>
<li> <p><b>K</b>, a vector giving, for each BIN file, the number of regenerative doses in the SAR protocol;
</p>
</li>
<li> <p><b>Nb_measurement</b>, a vector giving, for each BIN file, the number of measurements.<br />
</p>
</li></ul>

<p><b>** How to save this list **</b><br />
</p>
<p>You can save this list in a .RData object. To do this, you can use the fonction <code><a href="base.html#topic+save">save</a></code>.
Then, to load this list you can use the function <code><a href="base.html#topic+load">load</a></code> (see example section fore more details).
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Guerin
, RLum Developer Team</p>


<h3>See Also</h3>

<p><code>read_BIN2R</code>, <code><a href="#topic+combine_DataFiles">combine_DataFiles</a></code>, <code><a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></code>, <code><a href="#topic+LT_RegenDose">LT_RegenDose</a></code>
<code><a href="#topic+Age_Computation">Age_Computation</a></code>, <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>, <code><a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## Example for one sample with one Bin File
path&lt;- system.file("extdata/samp1", "", package="BayLum")
folder=""
nbsample=1  # give the number of sample
Data &lt;- Generate_DataFile(
 Path = path,
 FolderNames = folder,
 Nb_sample = nbsample,
 verbose = FALSE)
str(Data)

## to save information in RData object in folder containing bin file
# save(Data,file=c(paste(path,folder,'Data.RData',sep="")))
## to load information containing Data.RData object
# load(file=c(paste(path,folder,"Data.RData",sep="")))

## End(Not run)

</code></pre>

<hr>
<h2 id='IntCal13'>
Atmospheric North data for calibration of 14C age
</h2><span id='topic+IntCal13'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in AtmosphericNorth_CalC14 allows a calibration for mid-latitude Northern Hemisphere atmospher reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("IntCal13")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B, Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013. IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IntCal13)
## maybe str(IntCal13) ; head(IntCal13) ...
</code></pre>

<hr>
<h2 id='IntCal20'>
Atmospheric North data for calibration of 14C age
</h2><span id='topic+IntCal20'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in AtmosphericNorth_CalC14 allows a calibration for mid-latitude Northern Hemisphere atmospher reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("IntCal20")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer, P., Austin, W., Bard, E., Bayliss, A., Blackwell, P., Bronk Ramsey, C., . . . Talamo, S. (2020). The IntCal20 Northern Hemisphere Radiocarbon Age Calibration Curve (0‚Äì55 cal kBP). Radiocarbon, 62(4), 725-757. doi:10.1017/RDC.2020.41
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(IntCal20)
## maybe str(IntCal20) ; head(IntCal20) ...
</code></pre>

<hr>
<h2 id='LT_RegenDose-deprecated'>Plots Lx/Tx as a function of the regenerative dose (DEPRECATED)</h2><span id='topic+LT_RegenDose-deprecated'></span><span id='topic+LT_RegenDose'></span>

<h3>Description</h3>

<p>This function plots <code>Lx/Tx</code> values as a function of regenerative dose,
for every selected aliquot and for each sample.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>LT_RegenDose(
  DATA,
  Path,
  FolderNames,
  SampleNames = FolderNames,
  Nb_sample,
  BinPerSample = rep(1, Nb_sample),
  SG = rep(TRUE, Nb_sample),
  sepDP = c(","),
  nrow = 3L,
  ncol = nrow
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="LT_RegenDose-deprecated_+3A_data">DATA</code></td>
<td>
<p><a href="base.html#topic+list">list</a> (<strong>required</strong>): list of objects <code>LT</code>, <code>sLT</code>, <code>ITimes</code>, <code>dLab</code>, <code>ddot_env</code>, <code>regDose</code>, <code>J</code>, <code>K</code>, <code>Nb_measurement</code>, #' provided by <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> or <a href="#topic+combine_DataFiles">combine_DataFiles</a>.<code>DATA</code> can contain information from more than one sample.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_path">Path</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): path to the project folder
(the same as the one used in <a href="#topic+Generate_DataFile">Generate_DataFile</a>  or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> to provide <code>DATA</code>)</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_foldernames">FolderNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): vector of names of the sub-folders
containing the BIN-files, which were used by <a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
to generate the <code>DATA</code> object.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): Names of samples. To use if there is more than one bin file per sample.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<strong>required</strong>): ID number (in <code style="white-space: pre;">&#8288;[1,Nb_sample]&#8288;</code>) of the
sample selected for plotting L/T as a function of regenerative doses.
Required if the <code>DATA</code> object contains information for more than one sample.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): integer vector (with default):
vector with the number of BIN files per sample, which was used in <a href="#topic+Generate_DataFile">Generate_DataFile</a> or
<a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> to generate the <code>DATA</code> object.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_sg">SG</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): vector to set the type of measurement for
each sample <code>length(SG)=Nb_sample</code>.If the sample of number ID equal to <code>i</code>, <code>SG[i]=TRUE</code>
if it is a Single-grain OSL measurements,
<code>SG[i]=FALSE</code> if it is a Multi-grain OSL measurements.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_sepdp">sepDP</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): column separator in the <code>DiscPos.csv</code>
file or in Disc.csv file. It must be the same separator for all samples,
for single-grain OSL measurements or multi-grain OSL measurements.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_nrow">nrow</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): controls the arrangement of the plots,
here the number of rows. Can be set to <code>NULL</code>.</p>
</td></tr>
<tr><td><code id="LT_RegenDose-deprecated_+3A_ncol">ncol</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): controls the arrangement of the plots,
here the number of columns. Can be set to <code>NULL</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To fill <code>FolderNames</code> and <code>BinPerSample</code>, we refer to the <b>Detail</b> section from the
<a href="#topic+Generate_DataFile">Generate_DataFile</a> or <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a> function.
As well for a precise description of input <code>DATA</code>.
</p>


<h3>Value</h3>

<p>Lx/Tx plots; there are as many plots as selected aliquots in the <code>DiscPos.csv</code> file.
There are 9 plots per page.
There is not interpolation.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## load data file generated by the function Generate_DataFile
data(DATA3,envir = environment())
path&lt;- system.file("extdata/FER1", "", package="BayLum")
folder=""
samplename &lt;- "FER1"
LT_RegenDose(
 DATA = DATA3,
 Path = path,
 FolderNames = folder,
 SampleNames = samplename,
 Nb_sample = 1,
 SG = FALSE)

## End(Not run)

</code></pre>

<hr>
<h2 id='Marine13'>
Marine data for calibration of 14C age </h2><span id='topic+Marine13'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in marine_CalC14 allows a calibration for hypothetical &quot;global&quot; marine reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Marine13")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B, Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013. IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Marine13)
## maybe str(Marine13) ; head(Marine13) ...
</code></pre>

<hr>
<h2 id='Marine20'>
Marine data for calibration of 14C age </h2><span id='topic+Marine20'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in marine_CalC14 allows a calibration for hypothetical &quot;global&quot; marine reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Marine20")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Heaton, T., K√∂hler, P., Butzin, M., Bard, E., Reimer, R., Austin, W., . . . Skinner, L. (2020). Marine20‚ÄîThe Marine Radiocarbon Age Calibration Curve (0‚Äì55,000 cal BP). Radiocarbon, 62(4), 779-820. doi:10.1017/RDC.2020.68
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Marine20)
## maybe str(Marine20) ; head(Marine20) ...
</code></pre>

<hr>
<h2 id='MCMCsample'>MCMC sample from the posterior distribution of the dataset GDB5
</h2><span id='topic+MCMCsample'></span>

<h3>Description</h3>

<p>MCMC samples from the posterior distribution of &quot;A&quot; for age, &quot;D&quot; for palaeodose and &quot;sD&quot; for dispersion of equivalent doses around &quot;D&quot;, of the data set GDB5.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("MCMCsample")</code></pre>


<h3>Format</h3>

<p>It is a matric with 6000 row and tree column.
</p>

<dl>
<dt><code>A</code></dt><dd><p>The first column of the matrice are sampled from the posterior distribution of the paramete <code>A</code>  </p>
</dd>
<dt><code>D</code></dt><dd><p>The first column of the matrice are sampled from the posterior distribution of the paramete <code>D</code>  </p>
</dd>
<dt><code>sD</code></dt><dd><p>The first column of the matrice are sampled from the posterior distribution of the paramete <code>sD</code>  </p>
</dd>
</dl>



<h3>References</h3>

<p>Tribolo, C., Asrat, A., Bahain, J. J., Chapon, C., Douville, E., Fragnol, C., Hernandez, M., Hovers, E., Leplongeon, A.,  Martin, L,  Pleurdeau, D,  Pearson, O ,  Puaud, S,  Assefa, Z. (2017). Across the Gap: Geochronological and Sedimentological Analyses from the Late Pleistocene-Holocene Sequence of Goda Buticha, Southeastern Ethiopia. PloS one, 12(1), e0169418.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCsample)
## maybe str(MCMCsample) ; plot(MCMCsample[,1],type="l") ...
</code></pre>

<hr>
<h2 id='Model_Age'>JAGS models use in <code>Age_Computation</code>
</h2><span id='topic+Model_Age'></span>

<h3>Description</h3>

<p>A list of JAGS models use to a Bayesian analysis of OSL age of one sample. There are models for various growth curves and various distrubution to describe equivalent dose distribution around the palaeodose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Model_Age")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>AgeMultiBF_EXPLIN</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgeMultiBF_EXP</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgeMultiBF_EXPZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgeMultiBF_EXPLINZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The different distibutions to describe equivalent dose values around the palaeodose are:
</p>

<dl>
<dt><code>cauchy</code></dt><dd><p>a Cauchy distribution with postition parameter equal to the palaeodose of the sample</p>
</dd>
<dt><code>gaussian</code></dt><dd><p>a Gaussian distribution with mean equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_A</code></dt><dd><p>a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_M</code></dt><dd><p>a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p>
</dd>
</dl>

<p>For more information we refer to the function <code><a href="#topic+Age_Computation">Age_Computation</a></code>, section Details.
</p>


<h3>References</h3>

<p>Plummer, M. (2003). JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.
In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, page 125.
Technische Universit at Wien, Austria.
</p>
<p>Plummer, M. (2015). JAGS Version 4.0. 0 user manual.
</p>


<h3>See Also</h3>

<p><code>rjags</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Model_Age)
## Terminal print
## The JAGS model for a saturating exponential plus linear growth
## (a function of the type \code{f(x)=a(1-exp(-x/b))+cx+d})
## and a gaussian distribution of equivalent doses around the palaeodose:
writeLines(Model_Age$AgeMultiBF_EXPLIN$cauchy)
</code></pre>

<hr>
<h2 id='Model_AgeC14'>JAGS models use in <code>AgeC14_Computation</code>
</h2><span id='topic+Model_AgeC14'></span>

<h3>Description</h3>

<p>A list of JAGS models use to a Bayesian analysis of C14 calibration age of various sample.
Stratigraphic relations can be taken in count to calibrate C14 ages.
This ages take into account that some data can be an outlier.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Model_AgeC14")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>full</code></dt><dd><p>a model considering error on calibration curve.</p>
</dd>
<dt><code>naive</code></dt><dd><p>a model not considering error on calibration curve.</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013. IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH. 2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal BP. Radiocarbon 55(4):1889-1903
</p>


<h3>See Also</h3>

<p><code>rjags</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Model_AgeC14)
writeLines(Model_AgeC14$full)
</code></pre>

<hr>
<h2 id='Model_AgeS'>JAGS models use in <code>AgeS_Computation</code></h2><span id='topic+Model_AgeS'></span>

<h3>Description</h3>

<p>A list of JAGS models use to a Bayesian analysis of OSL age of various samples. There are models for various growth curves and various distrubution to describe equivalent dose distribution around the palaeodose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Model_AgeS")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>AgesMultiCS2_EXPLIN</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXP</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXPZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXPLINZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The different distibutions to describe equivalent dose values around the palaeodose are:
</p>

<dl>
<dt><code>cauchy</code></dt><dd><p>a Cauchy distribution with postition parameter equal to the palaeodose of the sample</p>
</dd>
<dt><code>gaussian</code></dt><dd><p>a Gaussian distribution with mean equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_A</code></dt><dd><p>a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_M</code></dt><dd><p>a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p>
</dd>
</dl>

<p>For more information we refer to the function <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>, section Details.
</p>


<h3>References</h3>

<p>Plummer, M. (2003). JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.
In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, page 125.
Technische Universit at Wien, Austria.
</p>
<p>Plummer, M. (2015). JAGS Version 4.0. 0 user manual.
</p>


<h3>See Also</h3>

<p><code>rjags</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Model_AgeS)
## The JAGS model for a saturating exponential plus linear growth
## (a function of the type \code{f(x)=a(1-exp(-x/b))+cx+d})
## and a gaussian distribution of equivalent doses around the palaeodose:
writeLines(Model_AgeS$AgesMultiCS2_EXP$gaussian)
</code></pre>

<hr>
<h2 id='Model_Palaeodose'>
JAGS models use in <code>Palaeodose_Computation</code>
</h2><span id='topic+Model_Palaeodose'></span>

<h3>Description</h3>

<p>A list of JAGS models use to a Bayesian analysis of OSL palaeodose of one or various samples. There are models for various growth curves and various distrubution to describe equivalent dose distribution around the palaeodose.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("Model_Palaeodose")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>PalaeodosesMultiBF_EXPLIN</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>PalaeodosesMultiBF_EXP</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>PalaeodosesMultiBF_EXPZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>PalaeodosesMultiBF_EXPLINZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The different distibutions to describe equivalent dose values around the palaeodose are:
</p>

<dl>
<dt><code>cauchy</code></dt><dd><p>a Cauchy distribution with postition parameter equal to the palaeodose of the sample</p>
</dd>
<dt><code>gaussian</code></dt><dd><p>a Gaussian distribution with mean equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_A</code></dt><dd><p>a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_M</code></dt><dd><p>a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p>
</dd>
</dl>

<p>For more information we refer to the function <code><a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a></code>, section Details.
</p>


<h3>References</h3>

<p>Plummer, M. (2003). JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.
In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, page 125.
Technische Universit at Wien, Austria.
</p>
<p>Plummer, M. (2015). JAGS Version 4.0. 0 user manual.
</p>


<h3>See Also</h3>

<p><code>rjags</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Model_Palaeodose)
writeLines(Model_Palaeodose$PalaeodosesMultiBF_EXPLIN$gaussian)
</code></pre>

<hr>
<h2 id='ModelC14'>
Likelihood of C14 samples for JAGS models use in <code>Age_OSLC14</code>
</h2><span id='topic+ModelC14'></span>

<h3>Description</h3>

<p>A list of models for C14 data to define likelyhood in JAGS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ModelC14")</code></pre>


<h3>Format</h3>

<p>This list contains:  </p>

<dl>
<dt><code>full</code></dt><dd><p>a model considering error on calibration curve.</p>
</dd>
<dt><code>naive</code></dt><dd><p>a model not considering error on calibration curve.</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B,Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013. IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>
<p>Hogg AG, Hua Q, Blackwell PG, Niu M, Buck CE, Guilderson TP, Heaton TJ, Palmer JG, Reimer PJ, Reimer RW, Turney CSM, Zimmerman SRH. 2013. SHCal13 Southern Hemisphere calibration, 0-50000 years cal BP. Radiocarbon 55(4):1889-1903</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Model_AgeC14)
writeLines(Model_AgeC14$full)
</code></pre>

<hr>
<h2 id='ModelOSL'>
Likelihood of OSL samples for JAGS models use in <code>Age_OSLC14</code>
</h2><span id='topic+ModelOSL'></span>

<h3>Description</h3>

<p>A list of models for OSL data to define likelyhood in JAGS models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ModelOSL")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>AgesMultiCS2_EXPLIN</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXP</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXPZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential plus linear growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
<dt><code>AgesMultiCS2_EXPLINZO</code></dt><dd><p>a list of 4 models that all consider a saturating exponential growth and fitting through the origin. These 4 models have different distribution to describe equivalent dose values around the palaeodose.</p>
</dd>
</dl>



<h3>Details</h3>

<p>The different distibutions to describe equivalent dose values around the palaeodose are:
</p>

<dl>
<dt><code>cauchy</code></dt><dd><p>a Cauchy distribution with postition parameter equal to the palaeodose of the sample</p>
</dd>
<dt><code>gaussian</code></dt><dd><p>a Gaussian distribution with mean equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_A</code></dt><dd><p>a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample</p>
</dd>
<dt><code>lognormal_M</code></dt><dd><p>a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample</p>
</dd>
</dl>

<p>For more information we refer to the function <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>, section Details.
</p>


<h3>References</h3>

<p>Plummer, M. (2003). JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.
In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, page 125.
Technische Universit at Wien, Austria.
</p>
<p>Plummer, M. (2015). JAGS Version 4.0. 0 user manual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ModelOSL)
## The JAGS model of the likelyhood for a saturating exponential plus linear growth
## (a function of the type \code{f(x)=a(1-exp(-x/b))+cx+d})
## and a gaussian distribution of equivalent doses around the palaeodose:
writeLines(ModelOSL$AgesMultiOSL_EXPLIN$gaussian)
</code></pre>

<hr>
<h2 id='ModelPrior'>
Prior for JAGS models use in <code>Age_OSLC14</code>
</h2><span id='topic+ModelPrior'></span>

<h3>Description</h3>

<p>A list to define prior in JAGS models, taking acount OSL data and C14 data in stratigraphic constraint.
The difficulty is in the fact that each cases is different. The youngest sample can be a C14 as well as a OSL sample.
To resolve this problem we consider diferent cases thanks to this list.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("ModelPrior")</code></pre>


<h3>Format</h3>

<p>This list contains:
</p>

<dl>
<dt><code>Sample1_C14</code></dt><dd><p>model considering that the youngest sample is a C14 sample</p>
</dd>
<dt><code>Sample1_OSL</code></dt><dd><p>model considering that the youngest sample is a OSL sample</p>
</dd>
<dt><code>C14_OSL</code></dt><dd><p>model considering that the second sample is a C14 sample</p>
</dd>
<dt><code>OSL_C14</code></dt><dd><p>model considering that the second sample is a OSL sample</p>
</dd>
<dt><code>C14</code></dt><dd><p>model considering that the last sample is a C14 sample</p>
</dd>
<dt><code>OSL</code></dt><dd><p>model considering that the last sample is a OSL sample</p>
</dd>
</dl>



<h3>References</h3>

<p>Plummer, M. (2003). JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling.
In Proceedings of the 3rd international workshop on distributed statistical computing, volume 124, page 125.
Technische Universit at Wien, Austria.
</p>
<p>Plummer, M. (2015). JAGS Version 4.0. 0 user manual.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ModelPrior)
## ModelPrior[[OSL]]
writeLines(ModelPrior$OSL)
</code></pre>

<hr>
<h2 id='Palaeodose_Computation'>Bayesian analysis for the palaeodose estimation of various samples</h2><span id='topic+Palaeodose_Computation'></span>

<h3>Description</h3>

<p>This function computes the palaeodose (in Gy) of one or various samples according to the model developed in Combes et al (2015),
based on an output of <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> or <code><a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></code>
or both of them using <code><a href="#topic+combine_DataFiles">combine_DataFiles</a></code>.<br />
Samples, for which data is avalilable in several BIN files, can be analysed.<br />
Single-grain or Multi-grain OSL measurements can be analysed simultaneouly.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>Palaeodose_Computation(
  DATA,
  SampleNames,
  Nb_sample,
  BinPerSample = rep(1, Nb_sample),
  SavePdf = FALSE,
  OutputFileName = c("MCMCplot"),
  OutputFilePath = c(""),
  SaveEstimates = FALSE,
  OutputTableName = c("DATA"),
  OutputTablePath = c(""),
  LIN_fit = TRUE,
  Origin_fit = FALSE,
  distribution = c("cauchy"),
  Iter = 50000,
  t = 5,
  n.chains = 3
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="Palaeodose_Computation_+3A_data">DATA</code></td>
<td>
<p>list of objects: LT, sLT, ITimes, dLab, ddot_env, regDose, J, K, Nb_measurement,
provided by <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> or <code><a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></code>.
<code>DATA</code> contains information for more than one sample.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_samplenames">SampleNames</code></td>
<td>
<p>character vector: names of sample. The length of this vector is equal to <code>Nb_sample</code>.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_nb_sample">Nb_sample</code></td>
<td>
<p>integer: number of samples.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_binpersample">BinPerSample</code></td>
<td>
<p>integer vector (with default): vector with the number of BIN files per sample.
The length of this vector is equal to <code>Nb_sample</code>.
<code>BinPerSample</code>[i] correponds to the number of BIN files for the sample whose number ID is equal to <code>i</code>.
For more information to fill this vector, we refer to detatils in <code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code> or <code><a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></code>.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_savepdf">SavePdf</code></td>
<td>
<p>boolean (with default): if TRUE save graph in pdf file named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_outputfilename">OutputFileName</code></td>
<td>
<p>character (with default): name of the pdf files that will be generated by the function.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_outputfilepath">OutputFilePath</code></td>
<td>
<p>character (with default): path to the pdf files that will be generated by the function.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_saveestimates">SaveEstimates</code></td>
<td>
<p>boolean (with default): if TRUE save Bayes estimates and credible interval at level 68
in a csv table named <code>OutputFileName</code> in folder <code>OutputFilePath</code>.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_outputtablename">OutputTableName</code></td>
<td>
<p>character (with default): name of the table that will be generated by the function if <code>SaveEstimates</code>=TRUE.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_outputtablepath">OutputTablePath</code></td>
<td>
<p>character (with default): path to the table that will be generated by the function if <code>SaveEstimates</code>=TRUE.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_lin_fit">LIN_fit</code></td>
<td>
<p>logical (with default): if TRUE (default) allows a linear component,
on top of the (default) saturating exponential curve, for the fitting of dose response curves.
Please see details for more informations on the proposed dose response curves.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_origin_fit">Origin_fit</code></td>
<td>
<p>logical (with default): if TRUE, forces the dose response curves to pass through the origin.
Please see details for more informations on the proposed growth curves.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_distribution">distribution</code></td>
<td>
<p>character (with default): type of distribution that defines
how individual equivalent dose values are distributed around the palaeodose.
Allowed inputs are <b>&quot;cauchy&quot;</b>, <b>&quot;gaussian&quot;</b>, <b>&quot;lognormal_A&quot;</b> and <b>&quot;lognormal_M&quot;</b>.</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_iter">Iter</code></td>
<td>
<p>integer (with default): number of iterations for the MCMC computation (for more information see <code>jags.model</code>).</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_t">t</code></td>
<td>
<p>integer (with default): 1 every <code>t</code> iterations of the MCMC is considered for sampling the posterior distribution
(for more information see <code>jags.model</code>).</p>
</td></tr>
<tr><td><code id="Palaeodose_Computation_+3A_n.chains">n.chains</code></td>
<td>
<p>integer (with default): number of independent chains for the model (for more information see <code>jags.model</code>).</p>
</td></tr>
</table>


<h3>Details</h3>

<p><b>** Option on growth curves **</b>
</p>
<p>As for <code><a href="#topic+Age_Computation">Age_Computation</a></code> and <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>, the user can choose from 4 dose response curves:
</p>

<ul>
<li> <p><b>Saturating exponential plus linear growth</b> (<code>PalaeodosesMultiBF_EXPLIN</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth</b> (<code>PalaeodosesMultiBF_EXP</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+d</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=FALSE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential plus linear growth and fitting through the origin</b> (<code>PalaeodosesMultiBF_EXPLINZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))+cx</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=TRUE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li>
<li> <p><b>Saturating exponential growth and fitting through the origin</b> (<code>PalaeodosesMultiBF_EXPZO</code>):
</p>
<p>for all <code>x</code> in IR+, <code>f(x)=a(1-exp(-x/b))</code>; select
</p>

<ul>
<li> <p><code>LIN_fit=FALSE</code>
</p>
</li>
<li> <p><code>Origin_fit=TRUE</code>
</p>
</li></ul>

</li></ul>

<p><b>** Option on equivalent dose distribution around the palaeodose **</b>
</p>
<p>The use can choose between :
</p>

<ul>
<li> <p><code>cauchy</code>: a Cauchy distribution with location parameter equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>gaussian</code>: a Gaussian distribution with mean equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_A</code>: a log-normal distribution with mean or <b>A</b>verage equal to the palaeodose of the sample
</p>
</li>
<li> <p><code>lognormal_M</code>: a log-normal distribution with <b>M</b>edian equal to the palaeodose of the sample
</p>
</li></ul>



<h3>Value</h3>

<p><b>NUMERICAL OUTPUT</b><br />
</p>

<ol>
<li> <p><b>A list containing the following objects:</b>
</p>

<ul>
<li> <p><b>Sampling</b> that corresponds to a sample of the posterior distributions
of palaeodose and equivalent dose dispersion parameters (both in Gy).
</p>
</li>
<li> <p><b>Model_GrowthCurve</b>, stating which dose response fitting option was chosen;
</p>
</li>
<li> <p><b>Distribution</b>, stating which distribution was chosen to model the dispersion of
individual equivalent dose values around the palaeodose of the sample.
</p>
</li></ul>

</li>
<li><p><b>The Gelman and Rubin test of convergency</b>: prints the result of the Gelman and Rubin test of convergency for palaeodose and equivalent dose dispersion parameters for each sample.
A result close to one is expected.<br />
In addition, the user must visually assess the convergency of the trajectories by looking at the pdf file
generated by the function (see <b>PLOT OUTPUT</b> for more informations).<br />
If both convergencies (Gelman and Rubin test and plot checking) are satisfactory,
the user can consider the printed estimates as valid. Otherwise, the user may try increasing the number of MCMC interations
(<code>Iter</code>) to reach convergency.
</p>
</li>
<li><p><b>Credible intervals and Bayes estimates</b>: prints the Bayes esitmates, the credible intervals at 95
the palaeodose and equivalent dose dispersion parameters for each sample.
</p>
</li></ol>

<p><b>PLOT OUTPUT</b>
</p>

<ol>
<li><p><b>MCMC trajectories</b>
A graph with the MCMC trajectories and posterior distributions of the palaeodose and equivalent dose dispersion parameters
is displayed, there is one page per sample. <br />
The first line of the figure correponds to the palaeodose parameter and the second to the equivalent dose dispersion parameter.
On each line, the plot on the left represents the MCMC trajectories, and the one on the right the posterior distribution of the parameter.
</p>
</li>
<li> <p><b>Summary of palaeodose estimates</b>: plot credible intervals and Bayes estimate of each sample palaeodose on a same graph.
</p>
</li></ol>

<p>To give result in a publication, we recommend to give the Bayes estimate of the parameters as well as the credible interval at 95
</p>


<h3>Note</h3>

<p>Please note that the initial values for all MCMC are currently all the same for all chains since we rely on the automatic
initial value generation of JAGS. This is not optimal and will be changed in future. However, it does not affect the quality
of the age estimates if the chains have converged.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Sebastian Kreutzer, Anne Philippe, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>References</h3>

<p>Combes, B., Philippe, A., Lanos, P., Mercier, N., Tribolo, C., Guerin, G., Guibert, P., Lahaye, C., 2015.
A Bayesian central equivalent dose model for optically stimulated luminescence dating.
Quaternary Geochronology 28, 62-70. doi:10.1016/j.quageo.2015.04.001
</p>


<h3>See Also</h3>

<p><code><a href="#topic+Generate_DataFile">Generate_DataFile</a></code>, <code><a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a></code>, <code><a href="#topic+combine_DataFiles">combine_DataFiles</a></code>,
<code>rjags</code>, <code><a href="#topic+plot_MCMC">plot_MCMC</a></code>,
<code><a href="#topic+Age_Computation">Age_Computation</a></code>, <code><a href="#topic+AgeS_Computation">AgeS_Computation</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Load data
data(DATA1,envir = environment())
## Palaeodose computation of samples GDB3
P=Palaeodose_Computation(DATA=DATA1,Nb_sample=1,SampleNames=c("GDB5"),Iter=100)

</code></pre>

<hr>
<h2 id='plot_Ages'>Create Age Plot</h2><span id='topic+plot_Ages'></span>

<h3>Description</h3>

<p>Create Age Plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_Ages(
  object,
  sample_names = NULL,
  sample_order = NULL,
  plot_mode = "ages",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_Ages_+3A_object">object</code></td>
<td>
<p><a href="base.html#topic+list">list</a>  or <a href="base.html#topic+data.frame">data.frame</a> (<strong>required</strong>): Output as created by functions like <a href="#topic+AgeC14_Computation">AgeC14_Computation</a>, which
is a list of class <code>BayLum.list</code>. Alternatively the function supports a <a href="base.html#topic+data.frame">data.frame</a> as input, however,
in such a case the <a href="base.html#topic+data.frame">data.frame</a> must resemble the ages <a href="base.html#topic+data.frame">data.frame</a> created by the computation functions
otherwise the input will be silently ignored.</p>
</td></tr>
<tr><td><code id="plot_Ages_+3A_sample_names">sample_names</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (optional): alternative sample names used for the plotting.
If the length of the provided <a href="base.html#topic+character">character</a> vector is shorter than the real number of samples, the names are recycled.</p>
</td></tr>
<tr><td><code id="plot_Ages_+3A_sample_order">sample_order</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (optional): argument to rearrange the sample order, e.g., <code>sample_order = c(4:1)</code> plots
the last sample first.</p>
</td></tr>
<tr><td><code id="plot_Ages_+3A_plot_mode">plot_mode</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): allows to switch from displaying ages as points with lines (<code>"ages"</code>)
for the credible intervals to densities (<code>"density"</code>)</p>
</td></tr>
<tr><td><code id="plot_Ages_+3A_...">...</code></td>
<td>
<p>further arguments to control the plot output,
standard arguments are: <code>cex</code>, <code>xlim</code>, <code>main</code>, <code>xlab</code>, <code>col</code> further (non-standard) arguments
are: <code>grid</code> (<code>TRUE</code>/<code>FALSE</code>), <code>legend</code> (<code>TRUE</code>/<code>FALSE</code>), <code>legend.text</code> (<a href="base.html#topic+character">character</a> input needed), <code>legend.pos</code> <a href="graphics.html#topic+legend">graphics::legend</a>, <code>legend.cex</code>. Additional arguments: <code>d_scale</code> (scales density plots), <code>show_ages</code> (add ages to density  plots)</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function creates an age plot showing the mean ages along with the credible intervals. The function
provides various arguments to modify the plot output, however, for an ultimate control the function returns
the <a href="base.html#topic+data.frame">data.frame</a> extracted from the input object for own plots.
</p>


<h3>Value</h3>

<p>The function returns a plot and the <a href="base.html#topic+data.frame">data.frame</a> used to display the data
</p>


<h3>Function version</h3>

<p>0.1.5
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Ruprecht-Karl-University of Heidelberg (Germany), based on code
written by Claire Christophe
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+AgeC14_Computation">AgeC14_Computation</a>, <a href="#topic+AgeS_Computation">AgeS_Computation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## load data
data(DATA_C14,envir = environment())
C14Cal &lt;- DATA_C14$C14[,1]
SigmaC14Cal &lt;- DATA_C14$C14[,2]
Names &lt;- DATA_C14$Names
nb_sample &lt;- length(Names)

## Age computation
Age &lt;- AgeC14_Computation(
   Data_C14Cal = C14Cal,
   Data_SigmaC14Cal = SigmaC14Cal,
   SampleNames = Names,
   Nb_sample = nb_sample,
   PriorAge = rep(c(20,60),nb_sample),
   Iter = 500,
   quiet = TRUE)

## plot output
plot_Ages(Age)

## plot output
plot_Ages(Age, plot_mode = "density")

</code></pre>

<hr>
<h2 id='plot_MCMC'>Plot MCMC trajectories and posterior distributions</h2><span id='topic+plot_MCMC'></span>

<h3>Description</h3>

<p>This function uses the output of <a href="rjags.html#topic+jags.model">rjags::jags.model</a> to visualise the traces of the MCMC and the
corresponding densities. In particular it displays the posterior distributions of the age, if it is calculated,
palaeodose and the equivalent dose dispersion parameters of the sample. The function output is very
similar to plot output produced with the 'coda' package, but tailored to meet the needs in
the context of the <code>'BayLum'</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_MCMC(
  object,
  sample_names = NULL,
  variables = c("A", "D", "sD"),
  axes_labels = c(A = "Age (ka)", D = "D (Gy)", sD = "sD (Gy)"),
  n.chains = NULL,
  n.iter = 1000,
  smooth = FALSE,
  rug = TRUE,
  plot_single = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_MCMC_+3A_object">object</code></td>
<td>
<p><a href="coda.html#topic+mcmc.list">coda::mcmc.list</a> or <a href="coda.html#topic+mcmc">coda::mcmc</a> (<strong>required</strong>): Output generated by <a href="rjags.html#topic+jags.model">rjags::jags.model</a>,
e.g., in <a href="#topic+Age_Computation">Age_Computation</a>. Alternatively, limited support is provided for <code>BayLum.list</code> object input</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_sample_names">sample_names</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (optional): Names of the used samples. This argument overrides the optional
argument <code>mtext</code>.</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_variables">variables</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): Variables in your <a href="coda.html#topic+mcmc">coda::mcmc</a> object to be plotted.</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_axes_labels">axes_labels</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (with default): Axes labels used for the trace and density plots. The labels should
be provided as named <a href="base.html#topic+character">character</a> <a href="base.html#topic+vector">vector</a> with the parameter names as the names used to assign the axes labelling.
The labelling for the x-axis (trace plots) and y-axis (density plot) cannot be modified.</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (optional): Set the number of chains to visualise, if nothing is provided the
number of chains is determined from the input object</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_n.iter">n.iter</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (with default): Set the number of iterations to be visualised in the trace plots, regardless
of the size of the input dataset as long as the real number of iterations is &gt; <code>n.iter</code>.
Please note that large numbers impact the plot performance.</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_smooth">smooth</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Enable/disables smooth of trace plots using <a href="stats.html#topic+smooth">stats::smooth</a></p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_rug">rug</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Enable/disables <a href="graphics.html#topic+rug">rug</a> under density plots</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_plot_single">plot_single</code></td>
<td>
<p><a href="base.html#topic+logical">logical</a> (with default): Enables/disables the single plot mode of the function, i.e.
if set to <code>TRUE</code> every plot is returned in a single plot and own <a href="graphics.html#topic+par">par</a> settings can be applied.</p>
</td></tr>
<tr><td><code id="plot_MCMC_+3A_...">...</code></td>
<td>
<p>further arguments that can be passed to modify the plot output. Supported arguments are
<code>lwd</code>, <code>lty</code>, <code>col</code>, <code>type</code>, <code>cex</code>,<code>mtext</code>, cf. <a href="graphics.html#topic+mtext">mtext</a> for <code>mtext</code> and <a href="graphics.html#topic+plot.default">plot.default</a> for the other
arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is used in the function <a href="#topic+Age_Computation">Age_Computation</a>, <a href="#topic+AgeS_Computation">AgeS_Computation</a>
and <a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a>, but can be used also as standalone plot function.
</p>


<h3>Value</h3>

<p>Two plots: Traces of the MCMC chains and the corresponding density plots. This plots
are similar to <a href="coda.html#topic+traceplot">coda::traceplot</a> and <a href="coda.html#topic+densplot">coda::densplot</a>.
</p>


<h3>Function version</h3>

<p>0.1.5
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Ruprecht-Karl University of Heidelberg (Germany). This function
is a re-written version of the function 'MCMC_plot()' by Claire Christophe
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Age_Computation">Age_Computation</a>, <a href="#topic+AgeS_Computation">AgeS_Computation</a>, <a href="#topic+Palaeodose_Computation">Palaeodose_Computation</a>,
<a href="rjags.html#topic+coda.samples">rjags::coda.samples</a> and rjags packages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(MCMCsample,envir = environment())
object &lt;- coda::as.mcmc(MCMCsample)
plot_MCMC(object)

</code></pre>

<hr>
<h2 id='plot_RegDosePoints'>Plot Regeneration Dose Points</h2><span id='topic+plot_RegDosePoints'></span>

<h3>Description</h3>

<p>Simple plot functionality to visualise $L_x/T_x$ values against the dose extracted
from data created by <a href="#topic+create_DataFile">create_DataFile</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_RegDosePoints(object, nrow = 3L, ncol = nrow, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_RegDosePoints_+3A_object">object</code></td>
<td>
<p><a href="base.html#topic+list">list</a> (<strong>required</strong>): input object created by <a href="#topic+create_DataFile">create_DataFile</a></p>
</td></tr>
<tr><td><code id="plot_RegDosePoints_+3A_nrow">nrow</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<em>with default</em>): number of rows used for the plot panel</p>
</td></tr>
<tr><td><code id="plot_RegDosePoints_+3A_ncol">ncol</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<em>with default</em>): number of columns in the plot panel</p>
</td></tr>
<tr><td><code id="plot_RegDosePoints_+3A_...">...</code></td>
<td>
<p>further plot arguments passed down to modify the plot output. Supported
arguments are <code>xlab</code>, <code>ylab</code>, <code>type</code>, <code>pch</code>, <code>col</code>, <code>cex</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns a plot
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Heidelberg University (Germany)
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+create_DataFile">create_DataFile</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(DATA3,envir = environment())
plot_RegDosePoints(DATA3)

</code></pre>

<hr>
<h2 id='plot_Scatterplots'>Display Scatter Plot Matrix of the Bayesian Age Results</h2><span id='topic+plot_Scatterplots'></span><span id='topic+ScatterSamples'></span>

<h3>Description</h3>

<p>Create a hexbin plot matrix (<a href="hexbin.html#topic+hexplom">hexbin::hexplom</a>) of age results returned by the Bayesian age calculation.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_Scatterplots(
  object,
  variables = c("A"),
  sample_names = NULL,
  sample_selection = NULL,
  n.chains = NULL,
  plot_type = "hexbin",
  plot_mode = "matrix",
  ...
)

ScatterSamples(...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot_Scatterplots_+3A_object">object</code></td>
<td>
<p><a href="coda.html#topic+mcmc.list">coda::mcmc.list</a> or a <a href="base.html#topic+data.frame">data.frame</a> (<strong>required</strong>): mcmc list objects generated by <a href="rjags.html#topic+jags.model">rjags::jags.model</a> in <a href="#topic+AgeS_Computation">AgeS_Computation</a>,
<a href="#topic+AgeC14_Computation">AgeC14_Computation</a> or <a href="#topic+Age_OSLC14">Age_OSLC14</a>. If a <a href="base.html#topic+data.frame">data.frame</a> is provided, only the first two columns are taken and <code>NA</code> values are automatically
removed. The function can also handle <code>BayLum.list</code> objects directly for certain functions</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_variables">variables</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): variable to be selected for the scatter plot, e.g., <code>"A"</code>. Please note
that you can only select one variable at the time</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_sample_names">sample_names</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>): sample names shown in the plot matrix</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_sample_selection">sample_selection</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): vector of samples to be plotted in the scatter matrix, e.g.,
<code>c(1,2)</code> will plot the first two samples, <code>c(1,3)</code> will plot samples 1 and 3 and <code>c(1:3)</code> will plot the first
three samples</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_n.chains">n.chains</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<em>with default</em>): allows to limit the number of chains shown,
by default the results of all chains are plotted.</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_plot_type">plot_type</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): switch between different plot types, <code>"hexbin"</code> (the default), based on
the function <a href="hexbin.html#topic+hexplom">hexbin::hexplom</a> and <code>smoothScatter</code> (the alternative) based on a highly customised plot function using the
function <a href="graphics.html#topic+smoothScatter">graphics::smoothScatter</a></p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_plot_mode">plot_mode</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): switch between a <code>matrix</code> plot mode and a <code>single</code> plot mode. The plot mode <code>single</code>
only works for <code>plot_type = smoothScatter</code> and creates a single plot panel for each sample. Please note that this cannot be further
combined with other par settings.</p>
</td></tr>
<tr><td><code id="plot_Scatterplots_+3A_...">...</code></td>
<td>
<p>further arguments to control the plot output, standard plot arguments supported are <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>xlim</code>, <code>ylim</code>, <code>cex</code>. For additional
arguments supporting a fine tuning of the plot, see details.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Additional supported plot arguments</strong><br />
</p>
<p>The following table lists additional arguments supported by the function in order to fine tune the
graphical output. Such arguments, can just be added in the function call. Example, for disabling
the <a href="graphics.html#topic+rug">graphics::rug</a> in the plot mode <code>smoothScatter</code> you can type <code>plot_Scatterplots(..., rug = FALSE)</code>
Please note that not all arguments are supported by all plot types.
</p>

<table>
<tr>
 <td style="text-align: left;">
<strong>ARGUMENT</strong> </td><td style="text-align: left;"> <strong>SUPPORTED BY PLOT TYPE</strong> </td><td style="text-align: left;"> <strong>DESCRIPTION</strong> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>colramp</code> </td><td style="text-align: left;"> <code>hexbin</code> and <code>smoothScatter</code> </td><td style="text-align: left;"> Option to define an own colour ramp, by defining an own function, e.g., <code>function(n) heat.colors(n, alpha = 1)</code>. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>pscales</code> </td><td style="text-align: left;"> <code>hexbin</code> and <code>smoothScatter</code> </td><td style="text-align: left;"> Controls the number of ticks shown on the plot axes, please note that the number works proportionally. </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>bw_smoothScatter</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> Controls the bandwidth of the smooth scatter, cf. <a href="graphics.html#topic+smoothScatter">graphics::smoothScatter</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>rug</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> enables/disables rugs </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nlevels</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> controls the number of isolines shown (cf. <a href="graphics.html#topic+contour">graphics::contour</a>) </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>nrpoints</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> defines the number of <code>nrpoints</code> to be plotted <a href="graphics.html#topic+smoothScatter">graphics::smoothScatter</a> </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>col_contour</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> defines the colour of the contour lines </td>
</tr>
<tr>
 <td style="text-align: left;">
<code>col_nrpoints</code> </td><td style="text-align: left;"> <code>smoothScatter</code> </td><td style="text-align: left;"> sets colour of the <code>nrpoints</code> in the scatter plot

</td>
</tr>

</table>



<h3>Value</h3>

<p>A scatter plot based on <a href="hexbin.html#topic+hexplom">hexbin::hexplom</a>
</p>


<h3>Function version</h3>

<p>0.3.2
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Ruprecht-Karl University of Heidelberg (Germany) ,
based on the function 'ScatterSamples()' by Claire Christophe, Anne Philippe, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Age_Computation">Age_Computation</a>, <a href="#topic+AgeS_Computation">AgeS_Computation</a>, <a href="#topic+AgeC14_Computation">AgeC14_Computation</a>,
and rjags packages.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(AgeS,envir = environment())

##hexbin
plot_Scatterplots(
   object = AgeS$Sampling,
   sample_names = c("GDB5", "GDB3"),
   sample_selection = c(1,2)
 )

##scatter smooth (matrix)
plot_Scatterplots(
   object = AgeS$Sampling,
   sample_names = c("GDB5", "GDB3"),
   sample_selection = c(1,2),
   plot_type = "smoothScatter")


##scatter smooth (single)
plot_Scatterplots(
   object = AgeS$Sampling,
   sample_names = c("GDB5", "GDB3"),
   sample_selection = c(1,2),
   plot_type = "smoothScatter",
   plot_mode = "single")

</code></pre>

<hr>
<h2 id='SC_Ordered'>Create Stratigraphically Ordered Sample Matrix</h2><span id='topic+SC_Ordered'></span>

<h3>Description</h3>

<p>Construct the stratigraphic matrix used in the functions <a href="#topic+AgeS_Computation">AgeS_Computation</a> and <a href="#topic+AgeC14_Computation">AgeC14_Computation</a>
for samples that are all ordered by increasing age.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SC_Ordered(Nb_sample)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SC_Ordered_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<strong>required</strong>): the number of samples; alternatively
an object of class <code>BayLum.list</code> can be provided as input (such as produced by <a href="#topic+create_DataFile">create_DataFile</a>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Stratigraphic matrix where each sample are ordered by increasing order.
This matrix can be integrated in the function <a href="#topic+AgeS_Computation">AgeS_Computation</a>.
Please see <a href="#topic+AgeS_Computation">AgeS_Computation</a> for more information on this matrix.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Anne Philippe, Sebastian Kreutzer, Guillaume Gu√©rin
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+AgeS_Computation">AgeS_Computation</a>, <a href="#topic+SCMatrix">SCMatrix</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>SC &lt;- SC_Ordered(Nb_sample = 3)

</code></pre>

<hr>
<h2 id='SCMatrix'>Construct the Stratigraphic Constrain Matrix Interactively</h2><span id='topic+SCMatrix'></span>

<h3>Description</h3>

<p>This function helps to define the stratigraphic relation between samples using questions.
The output of this function can be used in the function <a href="#topic+AgeS_Computation">AgeS_Computation</a>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SCMatrix(DATA = NULL, Nb_sample, SampleNames)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="SCMatrix_+3A_data">DATA</code></td>
<td>
<p><code>BayLum.list</code> (<em>with default</em>): Object of class <code>BayLum.list</code>, if provided
the other parameters are not any longer mandatory.</p>
</td></tr>
<tr><td><code id="SCMatrix_+3A_nb_sample">Nb_sample</code></td>
<td>
<p><a href="base.html#topic+integer">integer</a> (<strong>required</strong>): the sample number, if <code>DATA</code> is provided,
the input is not required</p>
</td></tr>
<tr><td><code id="SCMatrix_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<strong>required</strong>): sample names, if <code>DATA</code> is provided,
the input is not required</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function will ask if sample <code>i</code> is younger than sample <code>j</code> to construct
the stratigraphic constrain matrix.
</p>


<h3>Value</h3>

<p>Returns a <a href="base.html#topic+matrix">matrix</a> that summarise the ordered relation between samples.
This matrix can be integrate in <a href="#topic+AgeS_Computation">AgeS_Computation</a> function.
We refer to detail on <a href="#topic+AgeS_Computation">AgeS_Computation</a> for more information concerning this matrix.
</p>


<h3>Author(s)</h3>

<p>Claire Christophe, Anne Philippe, Guillaume Gu√©rin, Sebastian Kreutzer
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+AgeS_Computation">AgeS_Computation</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
SCMatrix(
 Nb_sample = 2,
 SampleNames = c("sample1","sample2"))

## End(Not run)

</code></pre>

<hr>
<h2 id='SHCal13'>
Atmospheric South data for calibration of 14C age </h2><span id='topic+SHCal13'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in AtmosphericSouth_CalC14 allows a calibration for mid-latitude Southern Hemisphere atmospher reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SHCal13")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years (in ky)  befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Reimer PJ, Bard E, Bayliss A, Beck JW, Blackwell PC, Bronl Ramsey C, Buck CE, Cheng H, Edwards RL, Friedrich M, Grootes PM, Guilderson TP, Haflidason H, Hajdas I, Hatte C, Heaton TJ, Hoffmann DL, Hogg AG, Hughen KA, Kaiser KF, Kromer B, Manning SW, Niu M, Reimer RW, Richards DA, Scott EM, Southon JR, Staff RA, Turney CSM, van der Plicht J. 2013. IntCal13 ans Marine13 radiocarbon age calibration curves 0-50000 years cal BP. Radiocarbon 55(4)=1869-1887.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SHCal13)
## maybe str(SHCal13) ; head(SHCal13) ...
</code></pre>

<hr>
<h2 id='SHCal20'>
Atmospheric South data for calibration of 14C age </h2><span id='topic+SHCal20'></span>

<h3>Description</h3>

<p>As 14C years is not equal to calendar years because atmospheric 14C concentration varies through time. Hence, data in AtmosphericSouth_CalC14 allows a calibration for mid-latitude Southern Hemisphere atmospher reservoir.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("SHCal20")</code></pre>


<h3>Format</h3>

<p>A data frame with 3 variables.
</p>

<dl>
<dt><code>CAL.BP</code></dt><dd><p>a numeric vector correpondig to calendar years (in ky)  befor present</p>
</dd>
<dt><code>X14C.age</code></dt><dd><p>a numeric vector correponding to 14C age</p>
</dd>
<dt><code>Error</code></dt><dd><p>a numeric vector correponding to error arround 14C age measurement</p>
</dd>
</dl>



<h3>References</h3>

<p>Hogg, A., Heaton, T., Hua, Q., Palmer, J., Turney, C., Southon, J., . . . Wacker, L. (2020). SHCal20 Southern Hemisphere Calibration, 0‚Äì55,000 Years cal BP. Radiocarbon, 62(4), 759-778. doi:10.1017/RDC.2020.59
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(SHCal20)
## maybe str(SHCal20) ; head(SHCal20) ...
</code></pre>

<hr>
<h2 id='write_BayLumFiles'>Write BayLum .csv-files</h2><span id='topic+write_BayLumFiles'></span>

<h3>Description</h3>

<p>This function allows the user to write all .csv files expected by
<a href="#topic+Generate_DataFile">Generate_DataFile</a> and <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>. Unlike <a href="#topic+create_FolderTemplates">create_FolderTemplates</a>,
this function makes it possible to write .csv files with all information directly from R.
No further modification of .csv files are required. The purpose of this function is (i) to reduce tedious manual editing of .csv-files and the errors that result
(ii) to introduce an easy way to review information inside .csv-files (by revisiting code rather than opening individual .csv-files) and (iii) to streamline folder
and file creation when preparing data to run BayLum's modelling functions. Note: the user will still need to move the appropriate .bin-files into all the sample folders.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_BayLumFiles(
  folder,
  SampleNames = "Sample_1",
  BinPerSample = rep(1, length(SampleNames)),
  SubSampleNames = NULL,
  DiscPos = NULL,
  DRenv = 1,
  DRenv.error = 0.04,
  DRsource = 0.1,
  DRsource.error = 0.002,
  signal.integral.min = 6,
  signal.integral.max = 10,
  background.integral.min = 346,
  background.integral.max = 395,
  inflatePercent = 0.025,
  nbOfLastCycleToRemove = 2
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_BayLumFiles_+3A_folder">folder</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>required</em>*): The name of the main folder in which all subsequent BayLum files and folders will be located. This could be a path to an already existing folder, or the path/name of a folder to be created.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_samplenames">SampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>required</em>): Vector of sample names.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_binpersample">BinPerSample</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector of numbers indicating the number of .bin-files per sample.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_subsamplenames">SubSampleNames</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>optional</em>): Vector of names to give each subfolder within a sample when the number of .bin-files in a sample counts more than one. If omitted or NULL, the subfolders are named by the subfolder count number.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_discpos">DiscPos</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): List of data frames with each data frame having one or two columns to identify aliquots/grains to be included in the analysis. The first column corresponds to the position number, and the second column corresponds to the grain number. If the data frame has only one column, a Disc.csv will be written. If the data.frame has two columns, a DiscPos.csv will be written. The length of the list should be the number of .bin-files included.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_drenv">DRenv</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>DRenv[i]</code> corresponds to environmental dose rate for <code>.bin-file[i]</code>. Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_drenv.error">DRenv.error</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>DRenv.error[i]</code> corresponds to environmental dose rate error for <code>.bin-file[i]</code>. Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_drsource">DRsource</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>DRsource[i]</code> corresponds to source dose rate for <code>.bin-file[i]</code>. Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_drsource.error">DRsource.error</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>DRsource.error[i]</code> corresponds to source dose rate error for <code>.bin-file[i]</code>. Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_signal.integral.min">signal.integral.min</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>signal.integral.min[i]</code> corresponds to the channel number where the OSL signal should be summed from for<code>bin-file[i]</code> Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_signal.integral.max">signal.integral.max</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>signal.integral.max[i]</code> corresponds to the channel number where the OSL signal should be summed from to for <code>bin-file[i]</code> Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_background.integral.min">background.integral.min</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>background.integral.min[i]</code> corresponds to the channel number where the OSL background signal should be summed from for<code>bin-file[i]</code> Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_background.integral.max">background.integral.max</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>background.integral.max[i]</code> corresponds to the channel number where the OSL background signal should be summed to for <code>.bin-file[i]</code>. Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_inflatepercent">inflatePercent</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>inflatePercent[i]</code> corresponds to uncertainty due to instrumental reproducibility to<code>bin-file[i]</code> Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
<tr><td><code id="write_BayLumFiles_+3A_nboflastcycletoremove">nbOfLastCycleToRemove</code></td>
<td>
<p><a href="base.html#topic+numeric">numeric</a> (<em>with default</em>): Vector where <code>nbOfLastCycleToRemove[i]</code> corresponds to the number of regeneration points to remove in analysis for <code>bin-file[i]</code> Length should be one or the number of .bin-files included in the analysis.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function returns nothing, but writes the folder structure.
</p>


<h3>Function version</h3>

<p>0.1.0
</p>


<h3>Author(s)</h3>

<p>Frederik Baumgarten, RadPhys, DTU Physics, Technical University of Denmark (Denmark)
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+Generate_DataFile">Generate_DataFile</a>, <a href="#topic+Generate_DataFile_MG">Generate_DataFile_MG</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># example samples
SampleNames &lt;- c("OSL-1-MG","OSL-2-SG")

# number of .bin-files for each sample
BinPerSample &lt;- c(1,3)

# List of data.frames of accepted aliquot/grain to be included
# in the analysis for each .bin-file.
DiscPos &lt;- list(
data.frame("position" = 1:48),
data.frame("position" = c(1,1,1,1), "grain" = c(4,67,92,99)),
data.frame("position" = c(2,2,2,2), "grain" = c(7,13,41,72)),
data.frame("position" = c(3,3,3,3), "grain" = c(7,52,67,88)))

# example 1: write to disk (all together)
write_BayLumFiles(
folder = paste(tempdir(),"new_BayLum_folder",sep = "/"),
SampleNames = SampleNames,
BinPerSample = BinPerSample,
DiscPos = DiscPos,
DRenv = c(1.75, 1.52, 1.52, 1.52),
DRenv.error = c(0.04, 0.03, 0.03, 0.03),
DRsource = c(0.2075, 0.1501, 0.1501, 0.1501),
DRsource.error = c(0.0010, 0.0008, 0.0008, 0.0008))

# example 2: write to disk (by sample)
write_BayLumFiles(
folder = paste(tempdir(),"new_BayLum_folder",sep = "/"),
SampleNames = "OSL-1-MG",
BinPerSample = 1,
DiscPos = DiscPos[[1]],
DRenv = 1.75,
DRenv.error = 0.04,
DRsource = 0.2075,
DRsource.error = 0.0010)

write_BayLumFiles(
folder = paste(tempdir(),"new_BayLum_folder",sep = "/"),
SampleNames = "OSL-2-SG",
BinPerSample = 3,
DiscPos = DiscPos[2:4],
DRenv = 1.75,
DRenv.error = 0.04,
DRsource = 0.2075,
DRsource.error = 0.0010)

</code></pre>

<hr>
<h2 id='write_YAMLConfigFile'>Write Auto Generated YAML BayLum Configuration File to the Disc</h2><span id='topic+write_YAMLConfigFile'></span>

<h3>Description</h3>

<p>This little function helps to auto-generate a the BayLum YAML configuration file
or a <a href="base.html#topic+list">list</a> that can be passed to <a href="#topic+create_DataFile">create_DataFile</a>. The YAML file itself can be modified in any
text editor. The allowed parameters are extracted from the reference YAML file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write_YAMLConfigFile(output_file = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="write_YAMLConfigFile_+3A_output_file">output_file</code></td>
<td>
<p><a href="base.html#topic+character">character</a> (<em>with default</em>): valid file path of the output file</p>
</td></tr>
<tr><td><code id="write_YAMLConfigFile_+3A_...">...</code></td>
<td>
<p>parameters to be preset in the YAML file (run <code>write_YAMLConfigFile()</code> to see allowed parameters)
The parameter <code>sample</code> is special, because it can be provided as a <a href="base.html#topic+character">character</a> vector of any length. The number
of elements in the vector (sample names) are then used to multiply the records in the configuration file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The function has two output modes:
</p>

<ul>
<li><p> (1) <code style="white-space: pre;">&#8288;output_file = &lt;file_path&gt;&#8288;</code>: Writes a YAML into the specified path and returns this path.
</p>
</li>
<li><p> (2) <code>output_file = NULL</code>: Returns a list of allowed function parameters that can be passed
to the function <strong>and</strong> it returns a list that can be used a passed on to <a href="#topic+create_DataFile">create_DataFile</a>.
</p>
</li></ul>



<h3>Function version</h3>

<p>0.1.0
</p>


<h3>Author(s)</h3>

<p>Sebastian Kreutzer, Institute of Geography, Ruprecht-Karl University of Heidelberg (Germany)
, RLum Developer Team</p>


<h3>See Also</h3>

<p><a href="#topic+create_DataFile">create_DataFile</a>, <a href="yaml.html#topic+read_yaml">yaml::read_yaml</a>, <a href="Luminescence.html#topic+read_BIN2R">Luminescence::read_BIN2R</a>, <a href="Luminescence.html#topic+read_XSYG2R">Luminescence::read_XSYG2R</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## generate list
write_YAMLConfigFile(
sample = c("samp1", "samp2"),
settings.rules.endTest = 10)

## generate file (here written in tempdir)
write_YAMLConfigFile(
 output_file = tempfile("configuration.yml"),
 sample = c("samp1", "samp2"),
 settings.rules.endTest = 10)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
