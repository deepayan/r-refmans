<!DOCTYPE html><html><head><title>Help for package ctpm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ctpm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#ctpm.fit'><p>Fit models to phylogenetic data.</p></a></li>
<li><a href='#moid_traits'><p>Trait data on 57 species of extant musteloids.</p></a></li>
<li><a href='#musteloids'><p>Musteloidea phylogeny.</p></a></li>
<li><a href='#plot.vg'><p>Plotting methods for variogram objects.</p></a></li>
<li><a href='#variogram'><p>Calculate an empirical variogram from phylogenetic data.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-11-03</td>
</tr>
<tr>
<td>Title:</td>
<td>Continuous-Time Phylogenetic Modeling</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Michael J. Noonan &lt;michael.noonan@ubc.ca&gt;</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/NoonanM/ctpm">https://github.com/NoonanM/ctpm</a>,</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), ape, ctmm</td>
</tr>
<tr>
<td>Imports:</td>
<td>slouch, ClusterR, methods, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>phytools, viridis, knitr, rmarkdown, nlme, progress,
graphics, grDevices,</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions for identifying, fitting, and applying continuous-time stochastic models to phylogenetic data.
  The package is based on methods introduced in
  Noonan et al. (2021) &lt;<a href="https://doi.org/10.1101%2F2021.05.21.445056">doi:10.1101/2021.05.21.445056</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-11-05 05:31:50 UTC; michaelnoonan</td>
</tr>
<tr>
<td>Author:</td>
<td>Michael J. Noonan [aut, cre],
  Christen H. Fleming [aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-11-08 15:30:05 UTC</td>
</tr>
</table>
<hr>
<h2 id='ctpm.fit'>Fit models to phylogenetic data.</h2><span id='topic+ctpm.fit'></span>

<h3>Description</h3>

<p>This function is currently a wrapper for methods implemented in the package <code><a href="slouch.html#topic+slouch">slouch</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ctpm.fit(data, phylo, model = NULL, time.units = "Ma")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ctpm.fit_+3A_data">data</code></td>
<td>
<p>A vector of continuous species trait data. This vector needs to be of the same length and same order as phylo$tip.label. </p>
</td></tr>
<tr><td><code id="ctpm.fit_+3A_phylo">phylo</code></td>
<td>
<p>An object of class 'phylo'.</p>
</td></tr>
<tr><td><code id="ctpm.fit_+3A_model">model</code></td>
<td>
<p>The model to fit. Can be one of <code>"IID"</code>, <code>"BM"</code>, or <code>"OU"</code>.</p>
</td></tr>
<tr><td><code id="ctpm.fit_+3A_time.units">time.units</code></td>
<td>
<p>A character defining the units of the edge lengths of the phylogentic tree. Defaults to &quot;Ma&quot;</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Fits evolutionary models to species trait data using the methods implemented in the package <code><a href="slouch.html#topic+slouch">slouch</a></code> and returns a model fit object (class ctmm) that is used for plotting a fitted model against an emprical variogram.
</p>


<h3>Value</h3>

<p>Returns a model fit object (class ctmm) that is used for plotting a fitted model against an emprical variogram. 
</p>


<h3>Note</h3>

<p> Running <code>summary</code> on the fitted model is not currently meaningful.</p>


<h3>Author(s)</h3>

<p> M. J. Noonan, C. H. Fleming.</p>


<h3>References</h3>

<p>Noonan, M. J., Fagan, W. F., and Fleming C. H. (2021) &ldquo;A semi-variance approach to visualising phylogenetic autocorrelation&rdquo;. Methods in Ecology and Evolution, in press.
</p>


<h3>See Also</h3>

 <p><code>vignette("variogram", package = "ctpm")</code>, <code><a href="ctmm.html#topic+plot.variogram">plot.variogram</a></code>, <code><a href="ctmm.html#topic++25+23+25">%#%</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load package and data
library(ctpm)
data("moid_traits")
data("musteloids")

#Extract the trait of interest from the full dataset
SSD &lt;- moid_traits$SSD

#Calculate variogram
SVF &lt;- variogram(SSD, musteloids)

#Fit the model
FIT &lt;- ctpm.fit(SSD, musteloids, model = "BM")


#Plot the variogram and fitted model
plot(SVF, FIT)
</code></pre>

<hr>
<h2 id='moid_traits'>Trait data on 57 species of extant musteloids.</h2><span id='topic+moid_traits'></span>

<h3>Description</h3>

<p>Morphological and life history data on mean male body mass (kg), mean male body mass (kg), sexual size dimorphism (male mass/female mass), mean male body length (mm), mean female body length (mm), mean litter size (number of offspring), social class (Solitary, Pairs, Variable Groups, Groups), and diet (Carnivorous, Piscivorous, Insectivorous, Omnivorous, Frugivorous/Herbivorous) for 57 species of extant musteloids.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("moid_traits")</code></pre>


<h3>Format</h3>

<p> An object of class &quot;data.frame&quot;.</p>


<h3>References</h3>

<p>Noonan, M. J., Johnson, P. J., Kitchener, A. C., Harrington, L. A., Newman, C., and Macdonald, D. W. (2016). Sexual size dimorphism in musteloids: An anomalous allometric pattern is explained by feeding ecology. Ecology and evolution, 6(23), 8495-8501. doi: <a href="https://doi.org/10.1002/ece3.2480">10.1002/ece3.2480</a>.
Noonan, M. J., Fagan, W. F., and Fleming C. H. (2021) &ldquo;A semi-variance approach to visualising phylogenetic autocorrelation&rdquo;. Methods in Ecology and Evolution, in press.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+musteloids">musteloids</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'># Load package and data
library(ctpm)
data("moid_traits")

# Plot male mass versus female mass
plot(moid_traits$Mass.M ~ moid_traits$Mass.F)
</code></pre>

<hr>
<h2 id='musteloids'>Musteloidea phylogeny.</h2><span id='topic+musteloids'></span>

<h3>Description</h3>

<p>A phylogenetic tree of Musteloidea.</p>


<h3>Usage</h3>

<pre><code class='language-R'>data("musteloids")</code></pre>


<h3>Format</h3>

<p> An object of class &quot;phylo&quot;, from package &quot;ape&quot;.</p>


<h3>References</h3>

<p>Law, Chris J. and Slater, Graham J. and Mehta, Rita S. (2017). Lineage Diversity and Size Disparity in Musteloidea: Testing Patterns of Adaptive Radiation Using Molecular and Fossil-Based Methods. Systematic Biology, 67(1), 127-144. doi: <a href="https://doi.org/10.1093/sysbio/syx047">10.1093/sysbio/syx047</a>.
</p>


<h3>See Also</h3>

 <p><code><a href="#topic+moid_traits">moid_traits</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'># Load package and tree
library(ctpm)
data("musteloids")

# Plot the phylogeny
plot(musteloids)
</code></pre>

<hr>
<h2 id='plot.vg'>Plotting methods for variogram objects.</h2><span id='topic+plot.vg'></span>

<h3>Description</h3>

<p>Produces plots of varigram objects (semi-variance vs. time lag) and model semi-variance functions, with approximate confidence intervals around the semi-variance estimates.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'vg'
plot(x, CTPM = NULL, col="black", col.CTPM = "red", fraction = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot.vg_+3A_x">x</code></td>
<td>
<p>A <code>variogram</code> object calculated using <code><a href="#topic+variogram">variogram</a></code>.</p>
</td></tr>
<tr><td><code id="plot.vg_+3A_ctpm">CTPM</code></td>
<td>
<p>A <code>ctpm</code> evolutionary model object in the same format as the output of <code>ctpm.fit</code>.</p>
</td></tr>
<tr><td><code id="plot.vg_+3A_col">col</code></td>
<td>
<p>Color for the empirical variogram. Can be an array.</p>
</td></tr>
<tr><td><code id="plot.vg_+3A_col.ctpm">col.CTPM</code></td>
<td>
<p>Color for the model. Can be an array.</p>
</td></tr>
<tr><td><code id="plot.vg_+3A_fraction">fraction</code></td>
<td>
<p>The proportion of the variogram object, <code>variogram</code>, that will be plotted.</p>
</td></tr>
<tr><td><code id="plot.vg_+3A_...">...</code></td>
<td>
<p>Additional <code><a href="ctmm.html#topic+plot.variogram">plot.variogram</a></code> function parameters.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For highly irregularly phylogenetic distances with few species, it may be useful to set <code>complete = FALSE</code> to coarsen the variogram. When this is the cases, species are binned across lags, with the number of lags estimated using either <code>kmeans</code> or Gaussian Mixture Modelling <code>GMM</code> clustering with n classes = <code class="reqn">\sqrt(N)</code>.
</p>


<h3>Value</h3>

<p>Returns a plot of semi-variance vs. time lag, with the empirical variogram in black and the <code>ctpm</code> semi-variance function in red if specified.</p>


<h3>Note</h3>

<p>The errors of the empirical variogram are correlated. Smooth trends are not necessarily significant.</p>


<h3>Author(s)</h3>

<p> M. J. Noonan, C. H. Fleming.</p>


<h3>References</h3>

<p>Noonan, M. J., Fagan, W. F., and Fleming C. H. (2021) &ldquo;A semi-variance approach to visualising phylogenetic autocorrelation&rdquo;. Methods in Ecology and Evolution, in press.
</p>


<h3>See Also</h3>

 <p><code>vignette("variogram", package = "ctpm")</code>, <code><a href="#topic+variogram">variogram</a></code>, <code><a href="#topic+ctpm.fit">ctpm.fit</a></code>. </p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load package and data
library(ctpm)
data("moid_traits")
data("musteloids")

#Extract the trait of interest from the full dataset
SSD &lt;- moid_traits$SSD

#Calculate variogram
SVF &lt;- variogram(SSD, musteloids)

#Plot the variogram
plot(SVF)
</code></pre>

<hr>
<h2 id='variogram'>Calculate an empirical variogram from phylogenetic data.</h2><span id='topic+variogram'></span>

<h3>Description</h3>

<p>This function calculates the empirical variogram of phylogenetic data for visualizing stationary (time-averaged) autocorrelation structure.
One of two weighting algorithms can be used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>variogram(data, phylo, weights = "IID", complete = FALSE, time.units = "Ma", 
          trait.units = NULL,  progress = TRUE, algorithm = "GMM")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="variogram_+3A_data">data</code></td>
<td>
<p>A vector of continuous species trait data. This vector needs to be of the same length and same order as <code>phylo$tip.label</code>.</p>
</td></tr>
<tr><td><code id="variogram_+3A_phylo">phylo</code></td>
<td>
<p>An object of class 'phylo'.</p>
</td></tr>
<tr><td><code id="variogram_+3A_weights">weights</code></td>
<td>
<p>The weights to apply when calculating the semi-variances. Can be one of <code>"IID"</code>, or <code>"BM"</code>. Defaults to <code>"IID"</code>.</p>
</td></tr>
<tr><td><code id="variogram_+3A_time.units">time.units</code></td>
<td>
<p>A character string defining the units of the branch lengths. Defaults to <code>"Ma"</code>.</p>
</td></tr>
<tr><td><code id="variogram_+3A_trait.units">trait.units</code></td>
<td>
<p>A character string defining the units of the trait being analysed. Defaults to uniteless.</p>
</td></tr>
<tr><td><code id="variogram_+3A_complete">complete</code></td>
<td>
<p>A logical value indicating whether the semi-variance is to be calculated across all possible lags. Defalts to <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="variogram_+3A_algorithm">algorithm</code></td>
<td>
<p>A character string defining the algorithm to apply when calculating the time-lag bins. Can be one of <code>"kmeans"</code>, or <code>"GMM"</code>.</p>
</td></tr>
<tr><td><code id="variogram_+3A_progress">progress</code></td>
<td>
<p>A logical value indicating whether to include a progress bar.</p>
</td></tr>
</table>


<h3>Details</h3>


<dl>
<dt><code>weights</code></dt><dd><p>The weights for the semi-variance are calculated based on an assumption about the form of the the correlation matrix. If the phylogenetic process is Independent and Identically Distributed (IID), then it is sufficient to consider a correlation matrix, where the diagonal is 1 and the off-diagonal is <code class="reqn">1/4</code> if species pair <code class="reqn">(i,j)</code> and <code class="reqn">(k,l)</code> share one species in common and 0 otherwise.
</p>
<p>If the phylogenetic process is BM, then it is sufficient to consider a correlation matrix where the diagonal is 1 and the off-diagonal is the squared proportion of time lag <code class="reqn">\tau</code> during which the backward-in-time-forward-in-time tip-branch-tip trajectories correspond to the same species.</p>
</dd>
<dt><code>complete</code></dt><dd><p>If calculating all pairwaise phylogenetic distances results in highly irregular time series (which is usually the case), it is more useful to coarsen the variogram. This is the case when <code>complete = FALSE</code>. Species are binned across lags, with the number of lags estimated using either <code>kmeans</code> or Gaussian Mixture Modelling <code>GMM</code> clustering with n classes = <code class="reqn">\sqrt(N)</code>.</p>
</dd>
</dl>



<h3>Value</h3>

<p>Returns a variogram object (class variogram) which is a dataframe containing the time-lag, <code>lag</code>, the semi-variance estimate at that lag, <code>SVF</code>, and the degrees of freedom on the estimated semi-variance <code>DOF</code>.
</p>


<h3>Note</h3>

<p> Can be slow on very large phylogenies.</p>


<h3>Author(s)</h3>

<p> M. J. Noonan, C. H. Fleming.</p>


<h3>References</h3>

<p>Noonan, M. J., Fagan, W. F., and Fleming C. H. (2021) &ldquo;A semi-variance approach to visualising phylogenetic autocorrelation&rdquo;. Methods in Ecology and Evolution, in press.
</p>


<h3>See Also</h3>

<p><code>vignette("variogram", package = "ctpm")</code>, <code><a href="ctmm.html#topic+plot.variogram">plot.variogram</a></code>, <code><a href="ctmm.html#topic++25+23+25">%#%</a></code>, <code><a href="ClusterR.html#topic+KMeans_rcpp">KMeans_rcpp</a></code>, <code><a href="ClusterR.html#topic+GMM">GMM</a></code>.</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Load package and data
library(ctpm)
data("moid_traits")
data("musteloids")

#Extract the trait of interest from the full dataset
SSD &lt;- moid_traits$SSD

#Calculate variogram
SVF &lt;- variogram(SSD, musteloids)

#Plot the variogram
plot(SVF)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
