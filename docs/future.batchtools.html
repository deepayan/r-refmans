<!DOCTYPE html><html><head><title>Help for package future.batchtools</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {future.batchtools}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%resources%'><p>Temporarily tweaks the resources for the current batchtools strategy</p></a></li>
<li><a href='#batchtools_custom'><p>Batchtools futures for custom batchtools configuration</p></a></li>
<li><a href='#batchtools_local'><p>batchtools local and interactive futures</p></a></li>
<li><a href='#batchtools_multicore'><p>batchtools multicore futures</p></a></li>
<li><a href='#batchtools_ssh'><p>batchtools SSH futures</p></a></li>
<li><a href='#batchtools_template'><p>Batchtools futures for LSF, OpenLava, SGE, Slurm, TORQUE etc.</p></a></li>
<li><a href='#BatchtoolsCustomFuture'><p>A batchtools future is a future whose value will be resolved via batchtools</p></a></li>
<li><a href='#BatchtoolsFutureError'><p>FutureError class for errors related to BatchtoolsFuture:s</p></a></li>
<li><a href='#delete.BatchtoolsFuture'><p>Removes a batchtools future</p></a></li>
<li><a href='#future.batchtools'><p>future.batchtools: A Future for batchtools</p></a></li>
<li><a href='#future.batchtools.options'><p>Options used for batchtools futures</p></a></li>
<li><a href='#loggedOutput'><p>Logged output of batchtools future</p></a></li>
<li><a href='#nbrOfWorkers.batchtools'><p>Gets the number of batchtools workers</p></a></li>
<li><a href='#print.BatchtoolsFuture'><p>Prints a batchtools future</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Version:</td>
<td>0.12.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.2.0), parallelly, future (&ge; 1.31.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>batchtools (&ge; 0.9.16), utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>globals, future.apply, listenv, markdown, R.rsp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>R.rsp</td>
</tr>
<tr>
<td>Title:</td>
<td>A Future API for Parallel and Distributed Processing using
'batchtools'</td>
</tr>
<tr>
<td>Description:</td>
<td>Implementation of the Future API on top of the 'batchtools' package.
    This allows you to process futures, as defined by the 'future' package,
    in parallel out of the box, not only on your local machine or ad-hoc
    cluster of machines, but also via high-performance compute ('HPC') job
    schedulers such as 'LSF', 'OpenLava', 'Slurm', 'SGE', and 'TORQUE' / 'PBS',
    e.g. 'y &lt;- future.apply::future_lapply(files, FUN = process)'.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>TRUE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://future.batchtools.futureverse.org">https://future.batchtools.futureverse.org</a>,
<a href="https://github.com/HenrikBengtsson/future.batchtools">https://github.com/HenrikBengtsson/future.batchtools</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/HenrikBengtsson/future.batchtools/issues">https://github.com/HenrikBengtsson/future.batchtools/issues</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-20 03:12:03 UTC; henrik</td>
</tr>
<tr>
<td>Author:</td>
<td>Henrik Bengtsson <a href="https://orcid.org/0000-0002-7579-5165"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre, cph]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Henrik Bengtsson &lt;henrikb@braju.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-20 12:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25resources+25'>Temporarily tweaks the resources for the current batchtools strategy</h2><span id='topic++25resources+25'></span>

<h3>Description</h3>

<p>Temporarily tweaks the resources for the current batchtools strategy
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fassignment %resources% tweaks
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="+2B25resources+2B25_+3A_fassignment">fassignment</code></td>
<td>
<p>The future assignment, e.g.
<code>x %&lt;-% { expr }</code>.</p>
</td></tr>
<tr><td><code id="+2B25resources+2B25_+3A_tweaks">tweaks</code></td>
<td>
<p>A named list (or vector) of resource <span class="pkg">batchtools</span>
parameters (see Section 'Resources' in <code><a href="batchtools.html#topic+submitJobs">batchtools::submitJobs()</a></code>)
that should be changed relative to the current strategy.</p>
</td></tr>
</table>

<hr>
<h2 id='batchtools_custom'>Batchtools futures for custom batchtools configuration</h2><span id='topic+batchtools_custom'></span>

<h3>Description</h3>

<p>Batchtools futures for custom batchtools configuration
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchtools_custom(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  resources = list(),
  workers = NULL,
  conf.file = findConfFile(),
  cluster.functions = NULL,
  registry = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchtools_custom_+3A_expr">expr</code></td>
<td>
<p>The R expression to be evaluated</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_substitute">substitute</code></td>
<td>
<p>Controls whether <code>expr</code> should be
<code>substitute()</code>:d or not.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_globals">globals</code></td>
<td>
<p>(optional) a logical, a character vector, a named list, or a
<a href="globals.html#topic+Globals">Globals</a> object.  If TRUE, globals are identified by code
inspection based on <code>expr</code> and <code>tweak</code> searching from environment
<code>envir</code>.  If FALSE, no globals are used.  If a character vector, then
globals are identified by lookup based their names <code>globals</code> searching
from environment <code>envir</code>.  If a named list or a Globals object, the
globals are used as is.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_label">label</code></td>
<td>
<p>(optional) Label of the future (where applicable, becomes the
job name for most job schedulers).</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_resources">resources</code></td>
<td>
<p>(optional) A named list passed to the <span class="pkg">batchtools</span>
template (available as variable <code>resources</code>).  See Section 'Resources'
in <code><a href="batchtools.html#topic+submitJobs">batchtools::submitJobs()</a></code> more details.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_workers">workers</code></td>
<td>
<p>(optional) The maximum number of workers the batchtools
backend may use at any time.   Interactive and &quot;local&quot; backends can only
process one future at the time (<code>workers = 1L</code>), whereas HPC backends,
where futures are resolved via separate jobs on a scheduler, can have
multiple workers.  In the latter, the default is <code>workers = NULL</code>, which
will resolve to
<code>getOption("<a href="#topic+future.batchtools.workers">future.batchtools.workers</a>")</code>.
If neither are specified, then the default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_conf.file">conf.file</code></td>
<td>
<p>(character) A batchtools configuration file as for
instance returned by <code><a href="batchtools.html#topic+findConfFile">batchtools::findConfFile()</a></code>.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_cluster.functions">cluster.functions</code></td>
<td>
<p>A
<a href="batchtools.html#topic+makeClusterFunctions">ClusterFunctions</a> object.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_registry">registry</code></td>
<td>
<p>(optional) A named list of settings to control the setup
of the batchtools registry.</p>
</td></tr>
<tr><td><code id="batchtools_custom_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+BatchtoolsFuture">BatchtoolsFuture()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>BatchtoolsFuture</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>options(error = function(...) {
  print(traceback())
})

cf &lt;- batchtools::makeClusterFunctionsInteractive(external = TRUE)
print(cf)
str(cf)
plan(batchtools_custom, cluster.functions = cf)
print(plan())
print(nbrOfWorkers())

## Create explicit future
f &lt;- future({
  cat("PID:", Sys.getpid(), "\n")
  42L
})
print(f)
v &lt;- value(f)
print(v)

options(error = NULL)


## Create explicit future
f &lt;- future({
  cat("PID:", Sys.getpid(), "\n")
  42L
})
print(f)
v &lt;- value(f)
print(v)



## Create explicit future
f &lt;- future({
  cat("PID:", Sys.getpid(), "\n")
  42L
})
v &lt;- value(f)
print(v)
</code></pre>

<hr>
<h2 id='batchtools_local'>batchtools local and interactive futures</h2><span id='topic+batchtools_local'></span><span id='topic+batchtools_interactive'></span><span id='topic+batchtools_bash'></span>

<h3>Description</h3>

<p>A batchtools local future is an synchronous uniprocess future that
will be evaluated in a background R session.
A batchtools interactive future is an synchronous uniprocess future
that will be evaluated in the current R session (and variables will
be assigned to the calling environment rather than to a local one).
Both types of futures will block until the futures are resolved.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchtools_local(..., envir = parent.frame())
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchtools_local_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="batchtools_local_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+BatchtoolsUniprocessFuture">BatchtoolsUniprocessFuture()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>batchtools local futures rely on the batchtools backend set up by
<code><a href="batchtools.html#topic+makeClusterFunctionsInteractive">batchtools::makeClusterFunctionsInteractive(external = TRUE)</a></code>
and batchtools interactive futures on the one set up by
<code><a href="batchtools.html#topic+makeClusterFunctionsInteractive">batchtools::makeClusterFunctionsInteractive()</a></code>.
These are supported by all operating systems.
</p>
<p>An alternative to batchtools local futures is to use
<a href="future.html#topic+cluster">cluster</a> futures of the <span class="pkg">future</span>
package with a single local background session, i.e.
<code>plan(cluster, workers = "localhost")</code>.
</p>
<p>An alternative to batchtools interactive futures is to use
<code>plan(sequential, split = TRUE)</code> futures of the <span class="pkg">future</span> package.
</p>


<h3>Value</h3>

<p>An object of class <code>BatchtoolsUniprocessFuture</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Use local batchtools futures
plan(batchtools_local)

## A global variable
a &lt;- 1

## Create explicit future
f &lt;- future({
  b &lt;- 3
  c &lt;- 2
  a * b * c
})
v &lt;- value(f)
print(v)


## Create implicit future
v %&lt;-% {
  b &lt;- 3
  c &lt;- 2
  a * b * c
}
print(v)
</code></pre>

<hr>
<h2 id='batchtools_multicore'>batchtools multicore futures</h2><span id='topic+batchtools_multicore'></span>

<h3>Description</h3>

<p>A batchtools multicore future is an asynchronous multiprocess
future that will be evaluated in a background R session.<br />
<br />
<em>We highly recommend using <a href="future.html#topic+multisession">future::multisession</a>
(sic!) futures of the <span class="pkg">future</span> package instead of
multicore batchtools futures.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchtools_multicore(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  workers = availableCores(constraints = "multicore"),
  registry = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchtools_multicore_+3A_expr">expr</code></td>
<td>
<p>The R expression to be evaluated</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_substitute">substitute</code></td>
<td>
<p>Controls whether <code>expr</code> should be
<code>substitute()</code>:d or not.</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_globals">globals</code></td>
<td>
<p>(optional) a logical, a character vector, a named list, or a
<a href="globals.html#topic+Globals">Globals</a> object.  If TRUE, globals are identified by code
inspection based on <code>expr</code> and <code>tweak</code> searching from environment
<code>envir</code>.  If FALSE, no globals are used.  If a character vector, then
globals are identified by lookup based their names <code>globals</code> searching
from environment <code>envir</code>.  If a named list or a Globals object, the
globals are used as is.</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_label">label</code></td>
<td>
<p>(optional) Label of the future (where applicable, becomes the
job name for most job schedulers).</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_workers">workers</code></td>
<td>
<p>The number of multicore processes to be
available for concurrent batchtools multicore futures.</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_registry">registry</code></td>
<td>
<p>(optional) A named list of settings to control the setup
of the batchtools registry.</p>
</td></tr>
<tr><td><code id="batchtools_multicore_+3A_...">...</code></td>
<td>
<p>Additional arguments passed
to <code><a href="#topic+BatchtoolsFuture">BatchtoolsFuture()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>batchtools multicore futures rely on the batchtools backend set
up by <code><a href="batchtools.html#topic+makeClusterFunctionsMulticore">batchtools::makeClusterFunctionsMulticore()</a></code>.
The batchtools multicore backend only works on operating systems
supporting the <code>ps</code> command-line tool, e.g. Linux and macOS.
</p>


<h3>Value</h3>

<p>An object of class <code>BatchtoolsMulticoreFuture</code>.
</p>

<hr>
<h2 id='batchtools_ssh'>batchtools SSH futures</h2><span id='topic+batchtools_ssh'></span>

<h3>Description</h3>

<p>A batchtools SSH future is an asynchronous multiprocess
future that will be evaluated in a background R session.<br />
<br />
<em>We highly recommend using <a href="future.html#topic+multisession">future::multisession</a>
(sic!) futures of the <span class="pkg">future</span> package instead of
SSH batchtools futures.</em>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchtools_ssh(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  workers = availableWorkers(),
  registry = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchtools_ssh_+3A_expr">expr</code></td>
<td>
<p>The R expression to be evaluated</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_substitute">substitute</code></td>
<td>
<p>Controls whether <code>expr</code> should be
<code>substitute()</code>:d or not.</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_globals">globals</code></td>
<td>
<p>(optional) a logical, a character vector, a named list, or a
<a href="globals.html#topic+Globals">Globals</a> object.  If TRUE, globals are identified by code
inspection based on <code>expr</code> and <code>tweak</code> searching from environment
<code>envir</code>.  If FALSE, no globals are used.  If a character vector, then
globals are identified by lookup based their names <code>globals</code> searching
from environment <code>envir</code>.  If a named list or a Globals object, the
globals are used as is.</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_label">label</code></td>
<td>
<p>(optional) Label of the future (where applicable, becomes the
job name for most job schedulers).</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_workers">workers</code></td>
<td>
<p>The number of SSH processes to be
available for concurrent batchtools SSH futures.</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_registry">registry</code></td>
<td>
<p>(optional) A named list of settings to control the setup
of the batchtools registry.</p>
</td></tr>
<tr><td><code id="batchtools_ssh_+3A_...">...</code></td>
<td>
<p>Additional arguments passed
to <code><a href="#topic+BatchtoolsFuture">BatchtoolsFuture()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>batchtools SSH futures rely on the batchtools backend set
up by <code><a href="batchtools.html#topic+makeClusterFunctionsSSH">batchtools::makeClusterFunctionsSSH()</a></code>.
The batchtools SSH backend only works on operating systems
supporting the <code>ssh</code> and <code>ps</code> command-line tool, e.g. Linux and macOS.
</p>


<h3>Value</h3>

<p>An object of class <code>BatchtoolsMulticoreFuture</code>.
</p>

<hr>
<h2 id='batchtools_template'>Batchtools futures for LSF, OpenLava, SGE, Slurm, TORQUE etc.</h2><span id='topic+batchtools_template'></span><span id='topic+batchtools_lsf'></span><span id='topic+batchtools_openlava'></span><span id='topic+batchtools_sge'></span><span id='topic+batchtools_slurm'></span><span id='topic+batchtools_torque'></span>

<h3>Description</h3>

<p>Batchtools futures for LSF, OpenLava, SGE, Slurm, TORQUE etc. are
asynchronous multiprocess futures that will be evaluated on a compute
cluster via a job scheduler.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>batchtools_lsf(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  template = NULL,
  resources = list(),
  workers = NULL,
  registry = list(),
  ...
)

batchtools_openlava(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  template = NULL,
  resources = list(),
  workers = NULL,
  registry = list(),
  ...
)

batchtools_sge(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  template = NULL,
  resources = list(),
  workers = NULL,
  registry = list(),
  ...
)

batchtools_slurm(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  template = NULL,
  resources = list(),
  workers = NULL,
  registry = list(),
  ...
)

batchtools_torque(
  expr,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  label = NULL,
  template = NULL,
  resources = list(),
  workers = NULL,
  registry = list(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="batchtools_template_+3A_expr">expr</code></td>
<td>
<p>The R expression to be evaluated</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_substitute">substitute</code></td>
<td>
<p>Controls whether <code>expr</code> should be
<code>substitute()</code>:d or not.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_globals">globals</code></td>
<td>
<p>(optional) a logical, a character vector, a named list, or a
<a href="globals.html#topic+Globals">Globals</a> object.  If TRUE, globals are identified by code
inspection based on <code>expr</code> and <code>tweak</code> searching from environment
<code>envir</code>.  If FALSE, no globals are used.  If a character vector, then
globals are identified by lookup based their names <code>globals</code> searching
from environment <code>envir</code>.  If a named list or a Globals object, the
globals are used as is.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_label">label</code></td>
<td>
<p>(optional) Label of the future (where applicable, becomes the
job name for most job schedulers).</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_template">template</code></td>
<td>
<p>(optional) A batchtools template file or a template string
(in <span class="pkg">brew</span> format).  If not specified, it is left to the
<span class="pkg">batchtools</span> package to locate such file using its search rules.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_resources">resources</code></td>
<td>
<p>(optional) A named list passed to the <span class="pkg">batchtools</span>
template (available as variable <code>resources</code>).  See Section 'Resources'
in <code><a href="batchtools.html#topic+submitJobs">batchtools::submitJobs()</a></code> more details.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_workers">workers</code></td>
<td>
<p>(optional) The maximum number of workers the batchtools
backend may use at any time.   Interactive and &quot;local&quot; backends can only
process one future at the time (<code>workers = 1L</code>), whereas HPC backends,
where futures are resolved via separate jobs on a scheduler, can have
multiple workers.  In the latter, the default is <code>workers = NULL</code>, which
will resolve to
<code>getOption("<a href="#topic+future.batchtools.workers">future.batchtools.workers</a>")</code>.
If neither are specified, then the default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_registry">registry</code></td>
<td>
<p>(optional) A named list of settings to control the setup
of the batchtools registry.</p>
</td></tr>
<tr><td><code id="batchtools_template_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="#topic+BatchtoolsFuture">BatchtoolsFuture()</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>These type of batchtools futures rely on batchtools backends set
up using the following <span class="pkg">batchtools</span> functions:
</p>

<ul>
<li> <p><code><a href="batchtools.html#topic+makeClusterFunctionsLSF">batchtools::makeClusterFunctionsLSF()</a></code> for
<a href="https://en.wikipedia.org/wiki/Platform_LSF">Load Sharing Facility (LSF)</a>
</p>
</li>
<li> <p><code><a href="batchtools.html#topic+makeClusterFunctionsOpenLava">batchtools::makeClusterFunctionsOpenLava()</a></code> for
<a href="https://en.wikipedia.org/wiki/OpenLava">OpenLava</a>
</p>
</li>
<li> <p><code><a href="batchtools.html#topic+makeClusterFunctionsSGE">batchtools::makeClusterFunctionsSGE()</a></code> for
<a href="https://en.wikipedia.org/wiki/Oracle_Grid_Engine">Sun/Oracle Grid Engine (SGE)</a>
</p>
</li>
<li> <p><code><a href="batchtools.html#topic+makeClusterFunctionsSlurm">batchtools::makeClusterFunctionsSlurm()</a></code> for
<a href="https://en.wikipedia.org/wiki/Slurm_Workload_Manager">Slurm</a>
</p>
</li>
<li> <p><code><a href="batchtools.html#topic+makeClusterFunctionsTORQUE">batchtools::makeClusterFunctionsTORQUE()</a></code> for
<a href="https://en.wikipedia.org/wiki/TORQUE">TORQUE</a> / PBS
</p>
</li></ul>



<h3>Value</h3>

<p>An object of class <code>BatchtoolsFuture</code>.
</p>

<hr>
<h2 id='BatchtoolsCustomFuture'>A batchtools future is a future whose value will be resolved via batchtools</h2><span id='topic+BatchtoolsCustomFuture'></span><span id='topic+BatchtoolsBashFuture'></span><span id='topic+BatchtoolsFuture'></span><span id='topic+BatchtoolsMultiprocessFuture'></span><span id='topic+BatchtoolsMulticoreFuture'></span><span id='topic+BatchtoolsTemplateFuture'></span><span id='topic+BatchtoolsLsfFuture'></span><span id='topic+BatchtoolsOpenLavaFuture'></span><span id='topic+BatchtoolsSGEFuture'></span><span id='topic+BatchtoolsSlurmFuture'></span><span id='topic+BatchtoolsTorqueFuture'></span><span id='topic+BatchtoolsSSHFuture'></span><span id='topic+BatchtoolsUniprocessFuture'></span><span id='topic+BatchtoolsLocalFuture'></span><span id='topic+BatchtoolsInteractiveFuture'></span>

<h3>Description</h3>

<p>A batchtools future is a future whose value will be resolved via batchtools
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BatchtoolsCustomFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsBashFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsFuture(
  expr = NULL,
  envir = parent.frame(),
  substitute = TRUE,
  globals = TRUE,
  packages = NULL,
  label = NULL,
  resources = list(),
  workers = NULL,
  finalize = getOption("future.finalize", TRUE),
  conf.file = findConfFile(),
  cluster.functions = NULL,
  registry = list(),
  ...
)

BatchtoolsMultiprocessFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsMulticoreFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsTemplateFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsLsfFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsOpenLavaFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsSGEFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsSlurmFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsTorqueFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsSSHFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  workers = availableCores(),
  ...
)

BatchtoolsUniprocessFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsLocalFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)

BatchtoolsInteractiveFuture(
  expr = NULL,
  substitute = TRUE,
  envir = parent.frame(),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BatchtoolsCustomFuture_+3A_expr">expr</code></td>
<td>
<p>The R expression to be evaluated</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_substitute">substitute</code></td>
<td>
<p>Controls whether <code>expr</code> should be
<code>substitute()</code>:d or not.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_envir">envir</code></td>
<td>
<p>The environment in which global environment
should be located.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_globals">globals</code></td>
<td>
<p>(optional) a logical, a character vector, a named list, or a
<a href="globals.html#topic+Globals">Globals</a> object.  If TRUE, globals are identified by code
inspection based on <code>expr</code> and <code>tweak</code> searching from environment
<code>envir</code>.  If FALSE, no globals are used.  If a character vector, then
globals are identified by lookup based their names <code>globals</code> searching
from environment <code>envir</code>.  If a named list or a Globals object, the
globals are used as is.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_label">label</code></td>
<td>
<p>(optional) Label of the future (where applicable, becomes the
job name for most job schedulers).</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_resources">resources</code></td>
<td>
<p>(optional) A named list passed to the <span class="pkg">batchtools</span>
template (available as variable <code>resources</code>).  See Section 'Resources'
in <code><a href="batchtools.html#topic+submitJobs">batchtools::submitJobs()</a></code> more details.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_workers">workers</code></td>
<td>
<p>(optional) The maximum number of workers the batchtools
backend may use at any time.   Interactive and &quot;local&quot; backends can only
process one future at the time (<code>workers = 1L</code>), whereas HPC backends,
where futures are resolved via separate jobs on a scheduler, can have
multiple workers.  In the latter, the default is <code>workers = NULL</code>, which
will resolve to
<code>getOption("<a href="#topic+future.batchtools.workers">future.batchtools.workers</a>")</code>.
If neither are specified, then the default is <code>100</code>.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_finalize">finalize</code></td>
<td>
<p>If TRUE, any underlying registries are
deleted when this object is garbage collected, otherwise not.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_conf.file">conf.file</code></td>
<td>
<p>(optional) A batchtools configuration file.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_cluster.functions">cluster.functions</code></td>
<td>
<p>(optional) A batchtools
<a href="batchtools.html#topic+makeClusterFunctions">ClusterFunctions</a> object.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_registry">registry</code></td>
<td>
<p>(optional) A named list of settings to control the setup
of the batchtools registry.</p>
</td></tr>
<tr><td><code id="BatchtoolsCustomFuture_+3A_...">...</code></td>
<td>
<p>Additional arguments passed to <code><a href="future.html#topic+Future-class">future::Future()</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A BatchtoolsFuture object
</p>

<hr>
<h2 id='BatchtoolsFutureError'>FutureError class for errors related to BatchtoolsFuture:s</h2><span id='topic+BatchtoolsFutureError'></span>

<h3>Description</h3>

<p>FutureError class for errors related to BatchtoolsFuture:s
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BatchtoolsFutureError(...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BatchtoolsFutureError_+3A_...">...</code></td>
<td>
<p>Arguments passed to <a href="future.html#topic+FutureCondition">FutureError</a>.</p>
</td></tr>
</table>

<hr>
<h2 id='delete.BatchtoolsFuture'>Removes a batchtools future</h2><span id='topic+delete.BatchtoolsFuture'></span>

<h3>Description</h3>

<p>Removes a batchtools future
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BatchtoolsFuture'
delete(
  future,
  onRunning = c("warning", "error", "skip"),
  onFailure = c("error", "warning", "ignore"),
  onMissing = c("ignore", "warning", "error"),
  times = 10L,
  delta = getOption("future.wait.interval", 1),
  alpha = getOption("future.wait.alpha", 1.01),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delete.BatchtoolsFuture_+3A_future">future</code></td>
<td>
<p>The future.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_onrunning">onRunning</code></td>
<td>
<p>Action if future is running or appears to run.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_onfailure">onFailure</code></td>
<td>
<p>Action if failing to delete future.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_onmissing">onMissing</code></td>
<td>
<p>Action if future does not exist.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_times">times</code></td>
<td>
<p>The number of tries before giving up.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_delta">delta</code></td>
<td>
<p>The delay interval (in seconds) between retries.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_alpha">alpha</code></td>
<td>
<p>A multiplicative penalty increasing the delay
for each failed try.</p>
</td></tr>
<tr><td><code id="delete.BatchtoolsFuture_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>(invisibly) TRUE if deleted and FALSE otherwise.
</p>

<hr>
<h2 id='future.batchtools'>future.batchtools: A Future for batchtools</h2><span id='topic+future.batchtools'></span><span id='topic+future.batchtools-package'></span>

<h3>Description</h3>

<p>The <span class="pkg">future.batchtools</span> package implements the Future API
on top of <span class="pkg">batchtools</span> such that futures can be resolved
on for instance high-performance compute (HPC) clusters via
job schedulers.
The Future API is defined by the <span class="pkg">future</span> package.
</p>


<h3>Details</h3>

<p>To use batchtools futures, load <span class="pkg">future.batchtools</span>, and
select the type of future you wish to use via
<code><a href="future.html#topic+plan">future::plan()</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(future.batchtools)

## Use local batchtools futures
plan(batchtools_local)

## A global variable
a &lt;- 1

v %&lt;-% {
  b &lt;- 3
  c &lt;- 2
  a * b * c
}

print(v)

plan(batchtools_local)
demo("mandelbrot", package = "future", ask = FALSE)


</code></pre>

<hr>
<h2 id='future.batchtools.options'>Options used for batchtools futures</h2><span id='topic+future.batchtools.options'></span><span id='topic+future.cache.path'></span><span id='topic+future.delete'></span><span id='topic+R_FUTURE_CACHE_PATH'></span><span id='topic+R_FUTURE_DELETE'></span><span id='topic+future.batchtools.expiration.tail'></span><span id='topic+future.batchtools.output'></span><span id='topic+future.batchtools.workers'></span><span id='topic+R_FUTURE_BATCHTOOLS_EXPIRATION_TAIL'></span><span id='topic+R_FUTURE_BATCHTOOLS_OUTPUT'></span><span id='topic+R_FUTURE_BATCHTOOLS_WORKERS'></span>

<h3>Description</h3>

<p>Below are the <span class="rlang"><b>R</b></span> options and environment variables that are used by the
<span class="pkg">future.batchtools</span> package.
See <a href="future.html#topic+future.options">future::future.options</a> for additional ones that apply to futures
in general.<br />
<br />
<em>WARNING: Note that the names and the default values of these options
may change in future versions of the package.  Please use with care
until further notice.</em>
</p>


<h3>Settings for batchtools futures</h3>


<dl>
<dt><span class="option">future.batchtools.workers</span>:</dt><dd><p>(a positive numeric or <code>+Inf</code>)
The default number of workers available on HPC schedulers with
job queues.  (Default: <code>100</code>)</p>
</dd>
<dt><span class="option">future.batchtools.output</span>:</dt><dd><p>(logical)
If TRUE, <span class="pkg">batchtools</span> will produce extra output.
If FALSE, such output will be disabled by setting <span class="pkg">batchtools</span>
options <span class="option">batchtools.verbose</span> and <span class="option">batchtools.progress</span>
to FALSE.
(Default: <code>getOption("future.debug", FALSE)</code>)</p>
</dd>
<dt><span class="option">future.batchtools.expiration.tail</span>:</dt><dd><p>(a positive numeric)
When a <span class="pkg">batchtools</span> job expires, the last few lines will be
relayed by batchtools futures to help troubleshooting.
This option controls how many lines are displayed.
(Default: <code>48L</code>)</p>
</dd>
<dt><span class="option">future.cache.path</span>:</dt><dd>
<p>(character string)
An absolute or relative path specifying the root folder in which
<span class="pkg">batchtools</span> registry folders are stored.
This folder needs to be accessible from all hosts (&quot;workers&quot;).
Specifically, it must <em>not</em> be a folder that is only local to the
machine such as <code style="white-space: pre;">&#8288;file.path(tempdir(), ".future"&#8288;</code> if an job scheduler
on a HPC environment is used.
(Default: <code>.future</code> in the current working directory)</p>
</dd>
<dt><span class="option">future.delete</span>:</dt><dd><p>(logical)
Controls whether or not the future's <span class="pkg">batchtools</span> registry folder
is deleted after the future result has been collected.
If TRUE, it is always deleted.
If FALSE, it is never deleted.
If not set or NULL, the it is deleted, unless running in non-interactive
mode and the batchtools job failed or expired, which helps to
troubleshoot when running in batch mode.
(Default: NULL (not set))</p>
</dd>
</dl>



<h3>Environment variables that set R options</h3>

<p>All of the above <span class="rlang"><b>R</b></span> <span class="option">future.batchtools.*</span> options can be set by
corresponding environment variable <span class="env">R_FUTURE_BATCHTOOLS_*</span> <em>when
the <span class="pkg">future.batchtools</span> package is loaded</em>.  This means that those
environment variables must be set before the <span class="pkg">future.batchtools</span>
package is loaded in order to have an effect.
For example, if <code>R_FUTURE_BATCHTOOLS_WORKERS="200"</code> is set, then option
<span class="option">future.batchtools.workers</span> is set to <code>200</code> (numeric).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Set an R option:
options(future.cache.path = "/cluster-wide/folder/.future")

</code></pre>

<hr>
<h2 id='loggedOutput'>Logged output of batchtools future</h2><span id='topic+loggedOutput'></span><span id='topic+loggedError'></span><span id='topic+loggedError.BatchtoolsFuture'></span>

<h3>Description</h3>

<p>Logged output of batchtools future
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loggedOutput(...)

## S3 method for class 'BatchtoolsFuture'
loggedError(future, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="loggedOutput_+3A_future">future</code></td>
<td>
<p>The future.</p>
</td></tr>
<tr><td><code id="loggedOutput_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector or a logical scalar.
</p>

<hr>
<h2 id='nbrOfWorkers.batchtools'>Gets the number of batchtools workers</h2><span id='topic+nbrOfWorkers.batchtools'></span>

<h3>Description</h3>

<p>Tries to infer the total number of batchtools workers.  This is
done using various ad-hoc procedures based on code inspection
of batchtools itself.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'batchtools'
nbrOfWorkers(evaluator)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nbrOfWorkers.batchtools_+3A_evaluator">evaluator</code></td>
<td>
<p>A future evaluator function.
If NULL (default), the current evaluator as returned
by <code><a href="future.html#topic+plan">plan()</a></code> is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A number in <code class="reqn">[1, Inf]</code>.
</p>

<hr>
<h2 id='print.BatchtoolsFuture'>Prints a batchtools future</h2><span id='topic+print.BatchtoolsFuture'></span>

<h3>Description</h3>

<p>Prints a batchtools future
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'BatchtoolsFuture'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="print.BatchtoolsFuture_+3A_x">x</code></td>
<td>
<p>An BatchtoolsFuture object</p>
</td></tr>
<tr><td><code id="print.BatchtoolsFuture_+3A_...">...</code></td>
<td>
<p>Not used.</p>
</td></tr>
</table>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
