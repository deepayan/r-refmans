<!DOCTYPE html><html><head><title>Help for package parfm</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {parfm}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#anova.parfm'><p>Analysis of Deviance for a parametric frailty model.</p></a></li>
<li><a href='#asthma'><p>Recurrent asthma attacks in children</p></a></li>
<li><a href='#ci.parfm'><p>Confidence Intervals for Hazard Ratios of Covariates of Parametric Frailty Models</p></a></li>
<li><a href='#culling'><p>Culling of dairy heifer cows</p></a></li>
<li><a href='#diagnosis'><p>Diagnosis of fracture healing</p></a></li>
<li><a href='#ecf'><p>East Coast Fever transmission dynamics</p></a></li>
<li><a href='#insem'><p>Time to first insemination in dairy heifer cows</p>
without time varying covariates</a></li>
<li><a href='#insemtvc'><p>Time to first insemtvcination in dairy heifer cows</p>
with time varying covariates</a></li>
<li><a href='#mastitis'><p>Correlated infection times in four cow udder quarters</p></a></li>
<li><a href='#parfm'><p>Parametric Frailty Models</p></a></li>
<li><a href='#predict.parfm'><p>Predictions of frailty values for Parametric Frailty Models</p></a></li>
<li><a href='#reconstitution'><p>Reconstitution of blood&ndash;milk barrier after reconstitution</p></a></li>
<li><a href='#select.parfm'><p>AIC and BIC values of several Parametric Frailty Models</p></a></li>
<li><a href='#tau'><p>Kendall's Tau for Parametric Frailty Models</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Parametric Frailty Models</td>
</tr>
<tr>
<td>Version:</td>
<td>2.7.7</td>
</tr>
<tr>
<td>Description:</td>
<td>Fits Parametric Frailty Models by maximum marginal likelihood.
             Possible baseline hazards:
                 exponential, Weibull, inverse Weibull (Fréchet),
                 Gompertz, lognormal, log-skew-normal, and loglogistic.
             Possible Frailty distributions:
                gamma, positive stable, inverse Gaussian and lognormal.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></td>
</tr>
<tr>
<td>LazyLoad:</td>
<td>yes</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10), survival, optimx</td>
</tr>
<tr>
<td>Imports:</td>
<td>msm, graphics, sn</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Author:</td>
<td>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Federico Rotolo &lt;federico.rotolo@sanofi.com&gt;</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-01-17 14:28:01 UTC; E0492269</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-01-17 22:40:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='anova.parfm'>Analysis of Deviance for a parametric frailty model.</h2><span id='topic+anova.parfm'></span><span id='topic+anova.parfmlist'></span>

<h3>Description</h3>

<p>Compute an analysis of deviance table for one or more parametric frailty model fits.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'parfm'
anova(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anova.parfm_+3A_object">object</code></td>
<td>
<p>An object of class <code>parfm</code></p>
</td></tr>
<tr><td><code id="anova.parfm_+3A_...">...</code></td>
<td>
<p>Further <code>parfm</code> objects</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifying a single object gives a sequential analysis of deviance
table for that fit.  That is, the reductions in the model log-likelihood
as each term of the formula is added in turn are given in as
the rows of a table, plus the log-likelihoods themselves.
</p>
<p>If more than one object is specified, the table has a row for the
degrees of freedom and loglikelihood for each model. For all
but the first model, the change in degrees of freedom and loglik
is also given. (This only make statistical sense if the models are
nested.)  It is conventional to list the models from smallest to
largest, but this is up to the user.
</p>
<p>The table contains test statistics (and P values)
comparing the reduction in loglik for each row.
</p>


<h3>Value</h3>

<p>An object of class <code>"anova"</code> inheriting from class <code>"data.frame"</code>.
</p>


<h3>Warning</h3>

<p>The comparison between two or more models by <code>anova.parfm()</code>
will only be valid if they
are fitted to the same dataset. This may be a problem if there are
missing values.</p>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parfm">parfm</a></code>, <code><a href="stats.html#topic+anova">anova</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fit &lt;- parfm(formula = Surv(time, status) ~ sex + age, cluster = "id",
             data = kidney, dist = "exponential", frailty = "gamma")
anova(fit)
fit2 &lt;- parfm(formula = Surv(time, status) ~ sex, cluster = "id",
              data = kidney, dist = "exponential", frailty = "gamma")
anova(fit2, fit)
</code></pre>

<hr>
<h2 id='asthma'>Recurrent asthma attacks in children</h2><span id='topic+asthma'></span>

<h3>Description</h3>

<p>Asthma is occurring more and more frequently in very young children
(between 6 and 24 months).
Therefore, a new application of an existing anti-allergic drug is administered
to children who are at higher risk to develop asthma in order to prevent it.
A prevention trial is set up with such children randomised to placebo or drug, 
and the asthma events that developed over time are recorded in a diary. 
Typically, a patient has more than one asthma event. 
The different events are thus clustered within a patient and are ordered 
in time. 
This ordering can be taken into account in the model.
Such data can be presented in different formats, but here, we choose to use
the calendar time representation. In the calendar time representation, 
the time at risk for a particular event is the time from the end
of the previous event (asthma attack) to the start of the next event
(start of the next asthma attack). 
In describing recurrent event data, we need a somewhat more complex 
data structure to keep track of the sequence of events within a patient.
A particular patient has different periods at risk during the total 
observation period which are separated either by an asthmatic event that 
lasts one or more days or by a period in which the patient was not 
under observation. 
The start and end of each such risk period is required, together with the 
status indicator to denote whether the end of the risk period corresponds to
an asthma attack or not.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(asthma)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 1776 observations.
</p>

<dl>
<dt>Patid:</dt><dd><p>Patient's identifyier.</p>
</dd>
<dt>Begin:</dt><dd><p>Time of end of the previous asthma attack (in days).</p>
</dd>
<dt>End:</dt><dd><p>Asthma attack or censoring time. (in days)</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Drug:</dt><dd><p>placebo (0) or drug (1).</p>
</dd>
<dt>Fevent:</dt><dd><p>First observation of the patient? 1=yes, 0=no.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Author(s)</h3>

<p>F. Rotolo and M. Munda. 
Original text and data by L. Duchateau and P. Janssen.
</p>


<h3>Source</h3>

<p>Example 1.9 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(asthma)
head(asthma)
asthma &lt;- asthma[asthma$Fevent==0,]

################################################################################
# Example 2.4: The frailty model with the Weibull baseline for the recurrent   #
# asthma data based on marginal likelihood maximisation                        #
# Duchateau and Janssen (2008, page 56)                                        #
################################################################################
# Calendar time
parfm(Surv(Begin, End, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "gamma")

# Gap time
asthma$time &lt;- asthma$End - asthma$Begin
parfm(Surv(time, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "gamma")

</code></pre>

<hr>
<h2 id='ci.parfm'>Confidence Intervals for Hazard Ratios of Covariates of Parametric Frailty Models</h2><span id='topic+ci.parfm'></span>

<h3>Description</h3>

<p>Computes confidence intervals for hazard ratios
(exp(coef)) for objects of class <code><a href="#topic+parfm">parfm</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>  ci.parfm(x, level=.05, digits=3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ci.parfm_+3A_x">x</code></td>
<td>

<p>The fitted model, object of class <code>parfm</code>, obtained as result of the <code><a href="#topic+parfm">parfm</a>()</code> function.</p>
</td></tr>
<tr><td><code id="ci.parfm_+3A_level">level</code></td>
<td>

<p>The coverage probability of the confidence interval.</p>
</td></tr>
<tr><td><code id="ci.parfm_+3A_digits">digits</code></td>
<td>

<p>The number of significant digits.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parfm">parfm</a></code>,
<code><a href="#topic+select.parfm">select.parfm</a></code>,
<code><a href="#topic+predict.parfm">predict.parfm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>  data("kidney")
  kidney$sex &lt;- kidney$sex - 1

  pfm &lt;- parfm(Surv(time,status) ~ sex + age, cluster="id", 
               data=kidney, dist="exponential", frailty="gamma")

  ci.parfm(pfm)
</code></pre>

<hr>
<h2 id='culling'>Culling of dairy heifer cows</h2><span id='topic+culling'></span>

<h3>Description</h3>

<p>The time to culling is studied in heifers as a function 
of the somatic cell count (SCC) measured between 5 and 15 days
(measurement day) after calving. 
</p>
<p>High somatic cell count (we use the logarithm of somatic cell count as covariate)
might be a surrogate marker for intramammary infections. 
Heifers which have intramammary infections or which are expected to
develop intramammary infections in the future are quite expensive to keep
due to the high costs for drugs and the loss in milk production.
</p>
<p>Cows are followed up for an entire lactation period (roughly 300&ndash;50 days) 
and, if they are still alive at the end of the lactation period,
they are censored at that time. 
Cows are further clustered within herds and this clustering needs
to be taken into account as culling policy and also SCC
in early lactation might differ substantially between the herds.  
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(culling)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 13836 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Time:</dt><dd><p>Time to culling (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Herd:</dt><dd><p>Herd identifyier.</p>
</dd>
<dt>Timeasses:</dt><dd><p>SCC measurement day.</p>
</dd>
<dt>LogSCC:</dt><dd><p>Logarithm of the somatic cell count.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.7 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(culling)
head(culling)
culling &lt;- culling[culling$Time &gt; 0,]
culling$TimeMonths &lt;- culling$Time * 12 / 365.25

coxmod &lt;- parfm(Surv(TimeMonths, Status) ~ LogSCC, data = culling,
                dist = "exponential", frailty = "none")
coxmod

pfmod &lt;- parfm(Surv(TimeMonths, Status) ~ LogSCC, data = culling,
               cluster = "Herd", dist = "exponential", frailty = "gamma")
pfmod

</code></pre>

<hr>
<h2 id='diagnosis'>Diagnosis of fracture healing</h2><span id='topic+diagnosis'></span>

<h3>Description</h3>

<p>Medical imaging has become an important tool in the veterinary hospital
to assess whether and when a fracture has healed. 
The standard technique in dogs is based on radiography (RX). 
Newer techniques based on ultrasound (US) are cheaper 
and do not require radioprotection. 
</p>
<p>To investigate the performance of US for this purpose and to compare it to RX,
Risselada et al. (2006) set up a trial in which fracture healing is evaluated 
by both US and RX. 
In total, 106 dogs, treated in the veterinary university hospital of Ghent, 
are included in the trial and evaluated for time to fracture healing 
with the two techniques. 
Only 7 dogs are censored for time to fracture healing evaluated by RX; 
no censoring occurs for time to fracture healing evaluated by US. 
The censoring is due to the fact that dog owners do not show up anymore. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(diagnosis)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 212 observations.
</p>

<dl>
<dt>Dogid:</dt><dd><p>Dog's identifyier.</p>
</dd>
<dt>Time:</dt><dd><p>Time to diagnosis (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Method:</dt><dd><p>Diagnostic technique: either
<code>RX</code>, radiography, or <code>US</code>, ultrasound.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.2 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>
<p>Risselada M, van Bree H, Kramer M, Chiers K, Duchateau L, Verleyen P (2006). 
Evaluation of nonunion fractures in dogs by use of Bmode ultrasonography, 
power Doppler ultrasonography, radiography, and histologic examination. 
<em>Am. J. Vet. Res.</em> 67, 1354&ndash;1361.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(diagnosis)
head(diagnosis)

diagnosis$TimeMonths &lt;- diagnosis$Time * 12 / 365.25

################################################################################
# Example 3.6: Shared gamma frailty models [...] for time to diagnosis         #
# of being healed                                                              #
# Duchateau and Janssen (2008, page 101)                                       #
################################################################################
WeiGam &lt;- parfm(Surv(TimeMonths, Status) ~ Method,
                cluster = "Dogid", data = diagnosis,
                dist = "weibull", frailty = "gamma")
WeiGam

curve(WeiGam["lambda", 1] * WeiGam["rho", 1] * x ^ (WeiGam["rho", 1] - 1),
      from = 0, to = 4, ylim = c(0, 25), 
      ylab = "Hazard function", xlab = "Time (months)")
curve(exp(WeiGam["Method", 1]) *
      WeiGam["lambda", 1] * WeiGam["rho", 1] * x ^ (WeiGam["rho", 1] - 1),
      add = TRUE, lty = 2)
legend("topleft", lty = 1:2, legend = c("US", "RX"))
      
################################################################################
# Example 4.8: Inverse Gaussian frailty models [...] for time to diagnosis     #
# of being healed                                                              #
# Duchateau and Janssen (2008, page 160)                                       #
################################################################################
WeiIG &lt;- parfm(Surv(TimeMonths, Status) ~ Method,
               cluster = "Dogid", data = diagnosis,
               dist = "weibull", frailty = "ingau")
WeiIG

curve(WeiIG["lambda", 1] * WeiIG["rho", 1] * x ^ (WeiIG["rho", 1] - 1),
      from = 0, to = 4, ylim = c(0, 25), 
      ylab = "Hazard function", xlab = "Time (months)")
curve(exp(WeiIG["Method", 1]) *
      WeiIG["lambda", 1] * WeiIG["rho", 1] * x ^ (WeiIG["rho", 1] - 1),
      add = TRUE, lty = 2)
legend("topleft", lty = 1:2, legend = c("US", "RX"))


################################################################################
# Example 4.11: Positive Stable frailty models [...] for time to diagnosis     #
# of being healed                                                              #
# Duchateau and Janssen (2008, page 172)                                       #
################################################################################
WeiPS &lt;- parfm(Surv(TimeMonths, Status) ~ Method,
               cluster = "Dogid", data = diagnosis,
               dist = "weibull", frailty = "possta")
WeiPS

curve(WeiPS["lambda", 1] * WeiPS["rho", 1] * x ^ (WeiPS["rho", 1] - 1),
      from = 0, to = 4, ylim = c(0, 25), 
      ylab = "Hazard function", xlab = "Time (months)")
curve(exp(WeiPS["Method", 1]) *
      WeiPS["lambda", 1] * WeiPS["rho", 1] * x ^ (WeiPS["rho", 1] - 1),
      add = TRUE, lty = 2)
legend("topleft", lty = 1:2, legend = c("US", "RX"))
</code></pre>

<hr>
<h2 id='ecf'>East Coast Fever transmission dynamics</h2><span id='topic+ecf'></span>

<h3>Description</h3>

<p><em>Theileriosis</em> or East Coast Fever (ECF) is a major cattle disease 
in East and Southern Africa. 
The disease is caused by <em>Theileria parva</em> which is transmitted by the ticks
<em>Rhipicephalus appendiculatus</em> and the closely related
<em>Rhipicephalus zambeziensis</em>.
</p>
<p>In order to study the transmission of the disease, cows were followed up 
from birth until time of first ECF contact in Nteme, 
a region in Southern Zambia. 
On weekly basis, blood is collected and tested for the presence of antibodies 
to <em>Theileria parva</em> using the Indirect Fluorescent Antibody test. 
After three consecutive positive IFA test results an animal 
is considered seroconverted.
The time to first ECF contact is defined as the timespan from birth 
to one month before the first of the three consecutive positive test results 
(i.e., we set the date of contact with <em>Theileria parva</em> one month before 
the time of the first positive test result). 
Animals are followed up until one year after birth; if they do not seroconvert 
by that time, their time of seroconversion is right-censored. 
We also consider the binary covariate breed. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ecf)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 212 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Time:</dt><dd><p>Time to ECF contact (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Breed:</dt><dd><p>The cow's breed.</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.1 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(ecf)
head(ecf)

################################################################################
#Example 3.8: Population and conditional hazard for time to ECF contact        #
#Duchateau and Janssen (2008, page 113)                                        #
################################################################################
pfm1 &lt;- parfm(Surv(Time, Status) ~ 1, cluster = "Cowid", data = ecf,
              dist = "weibull", frailty = "gamma")
pfm2 &lt;- parfm(Surv(Time, Status) ~ Breed, cluster = "Cowid", data = ecf,
              dist = "weibull", frailty = "gamma")
curve(pfm1["lambda", 1] * pfm1["rho", 1] * x ^ (pfm1["rho", 1] - 1),
      from = 0, to = 400, ylim = c(0, .15), 
      ylab = "Hazard function", xlab = "Time (days)")
curve(qgamma(.75, shape = 1 / pfm1["theta", 1],
             scale = pfm1["theta", 1]) * pfm1["lambda", 1] * pfm1["rho", 1] *
                x ^ (pfm1["rho", 1] - 1),
      add = TRUE, lty = 2)
curve(qgamma(.25, shape=1 / pfm1["theta", 1],
             scale = pfm1["theta", 1]) * pfm1["lambda", 1] * pfm1["rho", 1] *
               x ^ (pfm1["rho", 1] - 1),
      add = TRUE, lty = 3)
curve(pfm1["lambda", 1] * pfm1["rho", 1] *
        x ^ (pfm1["rho", 1] - 1) / (
            1 + pfm1["theta", 1] * pfm1["lambda", 1] * x ^ (pfm1["rho", 1])
      ),
      add = TRUE, lwd = 2)
legend("top", lwd = c(1, 1, 1, 2), lty = c(1, 2, 3, 1), ncol = 2,
       legend = c("Mean frailty", "Q75 frailty", "Q25 frailty", "Population"))
</code></pre>

<hr>
<h2 id='insem'>Time to first insemination in dairy heifer cows 
without time varying covariates</h2><span id='topic+insem'></span>

<h3>Description</h3>

<p>In a dairy farm, the calving interval (the time between two calvings) 
should be optimally between 12 and 13 months. 
One of the main factors determining the length of the calving interval 
is the time from parturition to the time of first insemination. 
</p>
<p>The objective of this study is to look for cow factors that might predict 
the time to first insemination, 
so that actions can be taken based on these predictors. 
As no inseminations take place in the first 29 days after calving, 
we subtract 29 days (and not 30 days as the first event would then have 
first insemination time zero) from the time to first insemination 
since at risk time starts only then. 
Cows which are culled without being inseminated are censored 
at their culling time. 
Furthermore, cows that are not yet inseminated 300 days after calving 
are censored at that time. 
</p>
<p>The time to first insemination is studied in dairy cows 
as a function of covariates that are fixed over time.   
An example ofsuch a covariate is the parity of the cow, 
corresponding to the number of calvings the cow has had already. 
As we observe only one lactation period for each cow in the study, 
it is indeed a constant cow characteristic 
within the time framework of the study. 
</p>
<p>We dichotomise parity into primiparous cows or heifers
(only one calving (<code>heifer=1</code>)) and multiparous cows
(more than one calving (<code>heifer=0</code>)). 
Other covariates that are used in the analysis are 
the different milk constituents such as protein and 
ureum concentration at parturition. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(insem)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 10513 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Time:</dt><dd><p>Time to first insemination (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Herd:</dt><dd><p>The herd to which the cow belongs.</p>
</dd>
<dt>Urem:</dt><dd><p>Milk urem concentration (%)
at the start of the lactation period.</p>
</dd>
<dt>Protein:</dt><dd><p>Protein concentration (%)
at the start of the lactation period.</p>
</dd>
<dt>Parity:</dt><dd><p>The number of calvings.</p>
</dd>
<dt>Heifer:</dt><dd><p>Multiparous cow (0) or primiparous cow (1).</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.8 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(insem)
head(insem)

insem$TimeMonths &lt;- insem$Time * 12 / 365.25

################################################################################
#Example 2.1: The parametric proportional hazards frailty model for the time   #
#to first insemination based on marginal likelihood maximisation               #
#Duchateau and Janssen (2008, page 50)                                         #
################################################################################
pfm &lt;- parfm(Surv(TimeMonths, Status) ~ Heifer, cluster = "Herd", data = insem,
             dist = "weibull", frailty = "gamma")
pfm

par(mfrow = c(2, 2))

### - Hazard functions - ###
# multiparous cows
curve((365.25 / 12) ^ (-pfm["rho", 1]) *
          pfm["lambda", 1] * pfm["rho", 1] * x ^ (pfm["rho", 1] - 1),
      from = 0, to = 400, ylim = c(0, .14), 
      main = "Multiparous cows",
      ylab = "Hazard function", xlab = "Time to first insemination (days)")
curve(qgamma(.95, shape = 1 / pfm["theta", 1],
             scale = pfm["theta", 1]) * (365.25 / 12) ^ (-pfm["rho", 1]) *
          pfm["lambda", 1] * pfm["rho", 1] * x ^ (pfm["rho", 1] - 1),
      add = TRUE, lty = 4)
curve(qgamma(.05, shape = 1 / pfm["theta", 1], 
             scale = pfm["theta", 1]) * (365.25 / 12) ^ (-pfm["rho", 1]) *
          pfm["lambda", 1] * pfm["rho", 1] * x ^ (pfm["rho", 1] - 1),
      add = TRUE, lty = 4)

# primiparous cows
curve(exp(pfm["Heifer", 1]) * (365.25 / 12)^(-pfm["rho", 1]) *
          pfm["lambda", 1] * pfm["rho", 1] * x^(pfm["rho", 1] - 1),
      from = 0, to = 400, ylim = c(0, .14), 
      main = "Primiparous cows", 
      ylab = "Hazard function", xlab = "Time to first insemination (days)")
curve(qgamma(.95, shape = 1 / pfm["theta", 1],
             scale = pfm["theta", 1]) * exp(pfm["Heifer", 1]) * 
          (365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1] * pfm["rho", 1] * 
          x ^ (pfm["rho", 1] - 1),
      add = TRUE, lty = 4)
curve(qgamma(.05, shape = 1 / pfm["theta", 1], 
             scale = pfm["theta", 1]) * exp(pfm["Heifer", 1]) * 
          (365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1] * pfm["rho", 1] *
          x ^ (pfm["rho", 1] - 1),
      add = TRUE, lty = 4)


### - Cumulative distribution functions - ###
# multiparous cows
curve(1 - exp(
    -(365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1] * 
        x ^ (pfm["rho", 1])),
    from = 0, to = 400, ylim = c(0, 1), 
    main = "Multiparous cows", 
    ylab = "Cumulative distribution function", 
    xlab = "Time to first insemination (days)")
curve(1 - exp(
    -qgamma(.95, shape = 1 / pfm["theta", 1],
            scale = pfm["theta", 1]) * (365.25 / 12) ^ (-pfm["rho", 1]) *
        pfm["lambda", 1] * x ^ (pfm["rho", 1])),
    add = TRUE, lty = 4)
curve(1 - exp(
    -qgamma(.05, shape = 1 / pfm["theta", 1],
            scale = pfm["theta", 1]) * (365.25 / 12) ^ (-pfm["rho", 1]) *
        pfm["lambda", 1] * x ^ (pfm["rho", 1])),
    add = TRUE, lty = 4)

# primiparous cows
curve(1 - exp(
    -exp(pfm["Heifer", 1]) *  (365.25 / 12) ^ (-pfm["rho", 1]) *
        pfm["lambda", 1] * x ^ (pfm["rho", 1])),
    from = 0, to = 400, ylim = c(0, 1), 
    main = "Primiparous cows", 
    ylab = "Cumulative distribution function", 
    xlab = "Time to first insemination (days)")
curve(1 - exp(
    -qgamma(.95, shape = 1 / pfm["theta", 1],
            scale = pfm["theta", 1]) * exp(pfm["Heifer", 1]) * 
        (365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1] * x ^ (pfm["rho", 1])),
    add = TRUE, lty = 4)
curve(1 - exp(
    -qgamma(.05, shape = 1 / pfm["theta", 1],
            scale=pfm["theta", 1]) * exp(pfm["Heifer", 1]) * 
        (365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1] * x ^ (pfm["rho", 1])),
    add = TRUE, lty = 4)


### - Density of the median time - ###
fM &lt;- function(x, heifer = 0) {
    RHO &lt;- pfm["rho", 1]
    LAMBDAd &lt;- (365.25 / 12) ^ (-pfm["rho", 1]) * pfm["lambda", 1]
    THETA &lt;- pfm["theta", 1]
    if (heifer) {
        eBETA &lt;- exp(pfm["Heifer", 1])
    } else eBETA &lt;- 1  
    
    RHO * (log(2) / (THETA * LAMBDAd * eBETA)) ^ (1 / THETA) *
        x^(-1 - RHO / THETA) *
        exp(-log(2) / (THETA * x^RHO * LAMBDAd * eBETA)) /
        gamma(1 / THETA)
}

par(mfrow=c(1, 1))
curve(fM, 0, 300, xlab = "Median time to first insemination (days)",
      ylab = "Density function of the median")
curve(fM(x, heifer = 1), add = TRUE, lty = 3)
legend("topright", legend = c("Multiparous", "Primiparous"),
       lty = c(1, 3), bty = "n")
</code></pre>

<hr>
<h2 id='insemtvc'>Time to first insemtvcination in dairy heifer cows 
with time varying covariates</h2><span id='topic+insemtvc'></span>

<h3>Description</h3>

<p>In a dairy farm, the calving interval (the time between two calvings) 
should be optimally between 12 and 13 months. 
One of the main factors determining the length of the calving interval 
is the time from parturition to the time of first insemtvcination. 
</p>
<p>The objective of this study is to look for cow factors that might predict 
the time to first insemtvcination, 
so that actions can be taken based on these predictors. 
As no insemtvcinations take place in the first 29 days after calving, 
we subtract 29 days (and not 30 days as the first event would then have 
first insemtvcination time zero) from the time to first insemtvcination 
since at risk time starts only then. 
Cows which are culled without being inseminated are censored 
at their culling time. 
Furthermore, cows that are not yet inseminated 300 days after calving 
are censored at that time. 
</p>
<p>The time to first insemtvcination is studied in dairy cows 
as a function of time-varying covariates.
Examples of such covariates are the protein and ureum concentration. 
The protein and ureum concentrations are measured, during the experiment, 
at a number of points in time. 
It might be more adequate to model the hazard at a particular time 
using the concentration at that particular point in time. 
In order to accommodate for time-varying covariates, 
the risk time for each cow is split into time intervals 
with a start and an end time and in each such interval 
a constant value for the concentration. 
We therefore have for each cow as many data lines as there are risk intervals. 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(insemtvc)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 10513 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Start:</dt><dd><p>Start time of the interval (in days).</p>
</dd>
<dt>End:</dt><dd><p>End time of the interval (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Herd:</dt><dd><p>The herd to which the cow belongs.</p>
</dd>
<dt>Urem:</dt><dd><p>Milk urem concentration (%)
at the begin time of the interval.</p>
</dd>
<dt>Protein:</dt><dd><p>Protein concentration (%)
at the begin time of the interval.</p>
</dd>
<dt>Parity:</dt><dd><p>The number of calvings.</p>
</dd>
<dt>Heifer:</dt><dd><p>Multiparous cow (0) or primiparous cow (1).</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.8 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L., Janssen P. (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>

<hr>
<h2 id='mastitis'>Correlated infection times in four cow udder quarters</h2><span id='topic+mastitis'></span>

<h3>Description</h3>

<p>Mastitis, the infection of the udder, is economically 
the most important disease in the dairy sector of the western world. 
Mastitis can be caused by many organisms, most of them bacteria, 
such as <em>Escherichia coli</em>, <em>Streptococcus uberis</em>, 
and <em>Staphylococcus aureus</em>. 
Since each udder quarter is separated from the three other quarters, 
one quarter might be infected with the other quarters free of infection. 
</p>
<p>In an extensive study, 100 cows are followed up for infections. 
The objective of this observational study is to estimate the incidence 
of the different organisms causing mastitis in the dairy cattle population 
in Flanders. 
Also the correlation between the infection times of the four udder quarters of 
a cow is an important parameter to take preventive measures against mastitis.
With high correlation, a lot of attention should be given to 
the uninfected udder quarters of a cow that has an infected quarter. 
From each quarter, a milk sample is taken monthly and is screened 
for the presence of different bacteria. 
</p>
<p>We model the time to infection with any bacteria, with the cow being
the cluster and the quarter the experimental unit within the cluster. 
Observations can be right-censored if no infection occurs before the end 
of the lactation period, which is roughly 300-350 days but different 
for every cow, or if the cow is lost to follow-up during the study, 
for example due to culling. 
Due to the periodic follow-up, udder quarters that experience an event are
interval-censored with lowerbound the time of the last milk sample
with a negative result and upperbound the time of the first milk sample
with a positive result.   
In some examples, the midpoint (average of lowerbound and upperbound 
of the interval) is used for simplicity; 
in other examples the interval-censored nature of the data
is taken into account. 
</p>
<p>In the analysis, two types of covariates are considered. 
Cow level covariates take the same value for every udder quarter of the cow
(e.g., number of calvings or parity). 
Several studies have shown that prevalence as well as incidence of 
intramammary infections increase with parity . 
Several hypotheses have been suggested to explain these findings, e.g., 
teat end condition deteriorates with increasing parity. 
Because the teat end is a physical barrier that prevents organisms from 
invading the udder, impaired teat ends make the udder more vulnerable 
for intramammary infections. 
For simplicity, parity is dichotomised into primiparous cows (<code>heifer=1</code>) 
and multiparous cows (<code>heifer=0</code>). 
Udder quarter level covariates change within the cow (e.g., position of the
udder quarter, front or rear). 
The difference in teat end condition between front and rear quarters 
has also been put forward to explain the difference in infection status.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(mastitis)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 400 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Lower:</dt><dd><p>Lower bound of time to infection (in days).</p>
</dd>
<dt>Upper:</dt><dd><p>Upper bound of time to infection (in days).</p>
</dd>
<dt>Midpoint:</dt><dd><p>Midpoint between <code>Lower</code> and <code>Upper</code> (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Heifer:</dt><dd><p>Multiparous cow (0) or primiparous cow (1).</p>
</dd>
<dt>Quarter:</dt><dd><p>Tthe udder quarter
(<code>LF</code>=Left-Front,
<code>LR</code>=Left-Rear,
<code>RF</code>=Right-Front,
<code>RR</code>=Right-Rear).</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.4 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(mastitis)
head(mastitis)

mastitis$timeto &lt;- as.numeric((mastitis$Midpoint * 4 / 365.25))


################################################################################
# Example 4.4: The gamma frailty model for the udder quarter infection data    #
# Duchateau and Janssen (2008, page 136)                                       #
################################################################################
modParfm &lt;- parfm(Surv(timeto, Status) ~ Heifer,
                  cluster = "Cowid",
                  dist = "weibull",
                  frailty = "gamma",
                  data = mastitis)
modParfm


################################################################################
# Example 4.7 The inverse Gaussian frailty model for the udder quarter         #
# infection data                                                               #
# Duchateau and Janssen (2008, page 156)                                       #
################################################################################
mastitis &lt;- data.frame(mastitis, 
                       timeto = as.numeric((mastitis$Midpoint * 4 / 365.25)))
modParfm &lt;- parfm(Surv(timeto, Status) ~ Heifer,
                  cluster = "Cowid",
                  dist = "weibull",
                  frailty = "ingau",
                  data = mastitis)
modParfm


################################################################################
# Example 4.10 The positive stable frailty model for the udder quarter         #
# infection data                                                               #
# Duchateau and Janssen (2008, page 169)                                       #
################################################################################
mastitis &lt;- data.frame(mastitis, 
                       timeto = as.numeric((mastitis$Midpoint * 4 / 365.25)))
modParfm &lt;- parfm(Surv(timeto, Status) ~ Heifer,
                  cluster = "Cowid",
                  dist = "weibull",
                  frailty = "possta",
                  data = mastitis)
modParfm
</code></pre>

<hr>
<h2 id='parfm'>Parametric Frailty Models</h2><span id='topic+parfm'></span><span id='topic+coef.parfm'></span><span id='topic+logLik.parfm'></span><span id='topic+plot.parfm'></span><span id='topic+print.parfm'></span>

<h3>Description</h3>

<p>Fits parametric Frailty Models by maximizing the marginal likelihood.</p>


<h3>Usage</h3>

<pre><code class='language-R'>parfm(formula, cluster = NULL, strata = NULL, data,
      inip = NULL, iniFpar = NULL,
      dist = c("weibull", "inweibull", "frechet", "exponential", 
               "gompertz", "loglogistic", "lognormal", "logskewnormal"),
      frailty   = c("none", "gamma", "ingau", "possta",
                    "lognormal", "loglogistic"),
      method = "nlminb", 
      maxit = 500, Fparscale = 1, showtime = FALSE, correct = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="parfm_+3A_formula">formula</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object, with the response on the left of a ~
operator,
and the terms on the right.
The response must be a survival object as returned by the <code><a href="survival.html#topic+Surv">Surv</a>()</code>
function.
The status indicator 'event' in the Surv object must be 0=alive, 1=dead.</p>
</td></tr>
<tr><td><code id="parfm_+3A_cluster">cluster</code></td>
<td>
<p>The name of a cluster variable in data.</p>
</td></tr>
<tr><td><code id="parfm_+3A_strata">strata</code></td>
<td>
<p>The name of a strata variable in data.</p>
</td></tr>
<tr><td><code id="parfm_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> in which to interpret the variables named in
the formula.</p>
</td></tr>
<tr><td><code id="parfm_+3A_inip">inip</code></td>
<td>
<p>The vector of initial values.
First components are for the baseline hazard parameters according to
the order
given in 'details';
Other components are for the regression parameters according to the
order given
in 'formula'.</p>
</td></tr>
<tr><td><code id="parfm_+3A_inifpar">iniFpar</code></td>
<td>
<p>The initial value of the frailty parameter.</p>
</td></tr>
<tr><td><code id="parfm_+3A_dist">dist</code></td>
<td>

<p>The baseline hazard distribution.
One of <code>weibull</code>, <code>inweibull</code>, <code>frechet</code>, <code>exponential</code>,
<code>gompertz</code>, <code>lognormal</code>, <code>loglogistic</code>, or <code>logskewnormal</code>.</p>
</td></tr>
<tr><td><code id="parfm_+3A_frailty">frailty</code></td>
<td>

<p>The Frailty distribution.
One of: <code>none</code>, <code>gamma</code>, <code>ingau</code>, <code>possta</code> or <code>lognormal</code>.</p>
</td></tr>
<tr><td><code id="parfm_+3A_method">method</code></td>
<td>
<p>The optimisation method from the function <code><a href="optimx.html#topic+optimx">optimx</a>()</code>.</p>
</td></tr>
<tr><td><code id="parfm_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations (see <code><a href="optimx.html#topic+optimx">optimx</a>()</code>).</p>
</td></tr>
<tr><td><code id="parfm_+3A_fparscale">Fparscale</code></td>
<td>
<p>the scaling value for the frailty parameter in <code><a href="optimx.html#topic+optimx">optimx</a>()</code>. 
Optimisation is performed on Fpar/Fparscale.</p>
</td></tr>
<tr><td><code id="parfm_+3A_showtime">showtime</code></td>
<td>
<p>Show the execution time?</p>
</td></tr>
<tr><td><code id="parfm_+3A_correct">correct</code></td>
<td>
<p>A correction factor that does not change the marginal
log-likelihood except for an additive constant given by
#clusters * correct * log(10). It may be useful in order to get finite
log-likelihood values in case of many events per cluster
with Positive Stable frailties. Note that the value of the
log-likelihood in the output is the re-adjusted value.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><strong>Baseline hazards</strong>
</p>
<p>The Weibull hazard (<code>dist="weibull"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \rho, \lambda) = \rho \lambda t^{\rho - 1}</code>
</p>

<p>with <code class="reqn">\rho, \lambda &gt; 0</code>.
</p>
<p>The inverse Weibull (or Fréchet) hazard (<code>dist="inweibull"</code> or <code>dist="frechet"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \rho, \lambda) = \frac{\rho \lambda t^{-\rho - 1}}{\exp(\lambda t^{-\rho}) - 1}</code>
</p>

<p>with <code class="reqn">\rho, \lambda &gt; 0</code>.
</p>
<p>The exponential hazard (<code>dist="exponential"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \lambda) = \lambda</code>
</p>

<p>with <code class="reqn">\lambda &gt; 0</code>.
</p>
<p>The Gompertz hazard (<code>dist="gompertz"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \gamma, \lambda) = \lambda \exp ( \gamma t )</code>
</p>

<p>with <code class="reqn">\gamma, \lambda &gt; 0</code>.
</p>
<p>The lognormal hazard (<code>dist="lognormal"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \mu, \sigma) = \frac{\phi \left( \frac{\log ( t ) - \mu}{\sigma}\right)}{\sigma t \left[ 1 - \Phi \left( \frac{\log ( t ) - \mu}{\sigma}\right)\right]}</code>
</p>

<p>with <code class="reqn">\mu \in   {R}, \sigma &gt; 0</code>, and where
<code class="reqn">\phi</code> and <code class="reqn">\Phi</code> are the density and distribution functions of a standard Normal random variable.
</p>
<p>The loglogistic hazard (<code>dist="loglogistic"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">h(t; \alpha, \kappa) = \frac{\exp ( \alpha ) \kappa t^{\kappa - 1}}{1 + \exp ( \alpha ) t^{\kappa}}</code>
</p>

<p>with <code class="reqn">\alpha \in   {R}, \kappa &gt; 0</code>.
</p>
<p>The log-skew-normal hazard (<code>dist="logskewnormal"</code>) is 
obtained as the ratio between the density and the cumulative distribution function
of a log-<a href="sn.html#topic+dsn">skew normal</a> random variable (Azzalini, 1985),
which has density
</p>
<p style="text-align: center;"><code class="reqn">f(t; \xi, \omega, \alpha) = \frac{2}{\omega t}
    \phi\left(\frac{\log(t) - \xi}{\omega}\right)
    \Phi\left(\alpha\frac{\log(t)-\xi}{\omega}\right)</code>
</p>

<p>with <code class="reqn">\xi \in {R}, \omega &gt; 0, \alpha \in {R}</code>, and where
<code class="reqn">\phi</code> and <code class="reqn">\Phi</code> are the density and distribution functions of a standard Normal random variable.
Of note, if <code class="reqn">\alpha=0</code> then the log-skew-normal boils down 
to the log-normal distribution, with <code class="reqn">\mu=\xi</code> and <code class="reqn">\sigma=\omega</code>.
</p>
<p><strong>Frailty distributions</strong>
</p>
<p>The gamma frailty distribution (<code>frailty="gamma"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f ( u ) = \frac{\theta^{-\frac{1}{\theta}} u^{\frac{1}{\theta} - 1} \exp \left( - u / \theta \right)}	{\Gamma ( 1 / \theta )}</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code> and where <code class="reqn">\Gamma ( \cdot )</code> is the gamma function.
</p>
<p>The inverse Gaussian frailty distribution (<code>frailty="ingau"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = \frac1{\sqrt{2 \pi \theta}} u^{- \frac32} \exp \left( - \frac{(u-1)^2}{2 \theta u}  \right)</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code>.
</p>
<p>The positive stable frailty distribution (<code>frailty="poosta"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = f(u) = - \frac1{\pi u} \sum_{k=1}^{\infty} \frac{\Gamma ( k (1 - \nu ) + 1 )}{k!} \left( - u^{ \nu - 1} \right)^{k} \sin ( ( 1 - \nu ) k \pi )</code>
</p>

<p>with <code class="reqn">0 &lt; \nu &lt; 1</code>.
</p>
<p>The lognormal frailty distribution (<code>frailty="lognormal"</code>) is
</p>
<p style="text-align: center;"><code class="reqn">f(u) = \frac1{\sqrt{2 \pi \theta}} u^{-1} \exp \left( - \frac{\log(u)^2}{2 \theta}  \right)</code>
</p>

<p>with <code class="reqn">\theta &gt; 0</code>.
As the Laplace tranform of the lognormal frailties does not exist in closed form,
the saddlepoint approximation is used (Goutis and Casella, 1999).
</p>


<h3>Value</h3>

<p>An object of class <code>parfm</code>.</p>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>
<p>Duchateau L, Janssen P (2008). The frailty model. Springer.
</p>
<p>Wienke A (2010).
Frailty Models in Survival Analysis. 
Chapman &amp; Hall/CRC biostatistics series. Taylor and Francis.
</p>
<p>Goutis C, Casella G (1999).
Explaining the Saddlepoint Approximation.
The American Statistician 53(3), 216-224.
DOI &lt;doi: <a href="https://doi.org/10.1080/00031305.1999.10474463">10.1080/00031305.1999.10474463</a>&gt;
</p>
<p>Azzalini A (1985).
A class of distributions which includes the normal ones.
Scandinavian Journal of Statistics, 12(2):171-178.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+select.parfm">select.parfm</a></code>,
<code><a href="#topic+ci.parfm">ci.parfm</a></code>,
<code><a href="#topic+predict.parfm">predict.parfm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#------Kidney dataset------
data(kidney) 
 # type 'help(kidney)' for a description of the data set
kidney$sex &lt;- kidney$sex - 1

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "exponential", frailty = "gamma")
      
      

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "exponential", frailty = "lognormal")

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist = "weibull", frailty = "ingau")

parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist="gompertz", frailty="possta", method="CG")


parfm(Surv(time,status) ~ sex + age, cluster = "id",
      data = kidney, dist="logskewnormal", frailty="possta", method = 'BFGS')
#--------------------------

#------Asthma dataset------
data(asthma)
head(asthma)
  # type 'help(asthma)' for a description of the data set

asthma$time &lt;- asthma$End - asthma$Begin
parfm(Surv(time, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "gamma")
      
parfm(Surv(time, Status) ~ Drug, cluster = "Patid", data = asthma,
      dist = "weibull", frailty = "lognormal")

parfm(Surv(Begin, End, Status) ~ Drug, cluster = "Patid", 
      data = asthma[asthma$Fevent == 0, ],
      dist = "weibull", frailty = "lognormal", method = "Nelder-Mead")
#--------------------------

</code></pre>

<hr>
<h2 id='predict.parfm'>Predictions of frailty values for Parametric Frailty Models</h2><span id='topic+predict.parfm'></span><span id='topic+plot.predict.parfm'></span><span id='topic+print.predict.parfm'></span>

<h3>Description</h3>

<p>The function <code>predict.parfm()</code> computes predictions of frailty values for objects of class <code><a href="#topic+parfm">parfm</a></code>.</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'parfm'
predict(object, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict.parfm_+3A_object">object</code></td>
<td>
<p>A parametric frailty model, object of class <code><a href="#topic+parfm">parfm</a></code>.</p>
</td></tr>
<tr><td><code id="predict.parfm_+3A_...">...</code></td>
<td>
<p>see <code><a href="stats.html#topic+predict">predict</a>()</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>predict.parfm</code>.</p>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Glidden D, Vittinghoff E (2004). 
Modelling Clustered Survival Data From Multicentre Clinical Trials.   
Statistics in medicine, 23(3), 369&ndash;388.
</p>
<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parfm">parfm</a></code></p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kidney)
kidney$sex &lt;- kidney$sex - 1

model &lt;- parfm(Surv(time,status) ~ sex + age, 
               cluster = "id", data = kidney,
               dist = "exponential", frailty = "gamma")
u &lt;- predict(model)
u


# Predictions from semi-parametric Gamma frailty model
# via coxph() function
model.coxph &lt;- coxph(Surv(time,status) ~ sex + age + 
                         frailty(id, frailty = "gamma", eps = 1e-11), 
                     outer.max = 15, data = kidney)
u.coxph &lt;- exp(model.coxph$frail)


# Plot of predictions from both models
par(mfrow = c(1,2))
ylim &lt;- c(0, max(c(u, u.coxph)))
plot(u, sort = "i",
     main = paste("Parametric", 
                  "Gamma frailty model",
                  "with Exponential baseline", 
                  sep = "\n"),
     ylim = ylim)

names(u.coxph) &lt;- kidney[seq(2,76, 2), "id"]
class(u.coxph) &lt;- "predict.parfm"
attr(u.coxph, "clustname") &lt;- "id"
plot(u.coxph, sort = "i",
     main = paste("Semi-parametric",
                  "Gamma frailty model", sep = "\n"),
     ylim = ylim)
</code></pre>

<hr>
<h2 id='reconstitution'>Reconstitution of blood&ndash;milk barrier after reconstitution</h2><span id='topic+reconstitution'></span>

<h3>Description</h3>

<p>When an udder quarter of a cow is infected (reconstitution), 
the blood-milk barrier is partially destroyed and particular ions 
can flow freely from blood to milk and vice versa, leading to higher 
concentrations of, for instance, the sodium concentration Na. 
</p>
<p>The objective of this study is to demonstrate that the local application 
of a drug based on corticosteroids decreases the time to reconstitution 
of the blood-milk barrier in dairy cows. 
We therefore consider as outcome the time until the Na concentration goes
below a certain threshold (a concentration below the threshold value
is considered to be normal again). 
Each udder quarter is separated from the three other quarters so that a quarter
can be used as experimental unit to which a treatment is assigned. 
The Na concentration in each of the experimental units is followed up. 
The rear udder quarters of 100 cows are experimentally infected 
with <code>Escherichia coli</code>. 
After nine hours, one of the two infected udder quarters is treated locally 
with the active compound whereas the other is treated with placebo. 
Cows are followed up for 6.5 days, and are censored at that point in time 
if the Na concentration is still above the threshold level. 
</p>
<p>We further include parity in the study as covariate. 
The parity of a cow is the number of calvings (and therefore the number
of lactation periods) that the cow has already experienced. 
Parity is often converted into a binary covariate, grouping all the cows 
with more than one calving in the group of multiparous cows (<code>heifer=0</code>)
compared to the group of primiparous cows or heifers, cows with 
only one calving (<code>heifer=1</code>). 
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(reconstitution)</code></pre>


<h3>Format</h3>

<p>A dataframe containing 200 observations.
</p>

<dl>
<dt>Cowid:</dt><dd><p>Cow's identifyier.</p>
</dd>
<dt>Time:</dt><dd><p>The time to reconstitution (in days).</p>
</dd>
<dt>Status:</dt><dd><p>Censored (0) or observed (1) event time.</p>
</dd>
<dt>Drug:</dt><dd><p>Drug or placebo application.</p>
</dd>
<dt>Heifer:</dt><dd><p>Multiparous cow (0) or primiparous cow (1).</p>
</dd>
</dl>



<h3>Note</h3>

<p>These data simulated, with exactly
the same structure as the real data used in the book,
that could not be made publicly available.    
</p>


<h3>Source</h3>

<p>Example 1.3 of Duchateau an Janssen (2008)</p>


<h3>References</h3>

<p>Duchateau L, Janssen P (2008). <em>The frailty model. Springer</em>.
New York: Springer&ndash;Verlag.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(reconstitution)
head(reconstitution)
                

################################################################################
# Example 3.1: The [...] frailty model for the time to blood-milk barrier      #
# reconstitution: the effect of treatment                                      #
# Duchateau and Janssen (2008, page 79)                                        #
################################################################################
pfmDrug &lt;- parfm(Surv(Time, Status) ~ Drug,
                 cluster = "Cowid", dist = "exponential",
                 frailty = "gamma", data = reconstitution)
ci.parfm(pfmDrug)
                

################################################################################
# Example 3.2: The [...] frailty model for the time to blood-milk barrier      #
# reconstitution: the heifer effect                                            #
# Duchateau and Janssen (2008, page 82)                                        #
################################################################################
pfmHeifer &lt;- parfm(Surv(Time, Status) ~ Heifer,
                   cluster = "Cowid", dist = "exponential",
                   frailty = "gamma", data = reconstitution)
ci.parfm(pfmHeifer)
</code></pre>

<hr>
<h2 id='select.parfm'>AIC and BIC values of several Parametric Frailty Models</h2><span id='topic+select.parfm'></span><span id='topic+plot.select.parfm'></span><span id='topic+print.select.parfm'></span>

<h3>Description</h3>

<p>The function <code>select.parfm()</code> computes the AIC and BIC values
of parametric frailty models with different baseline hazards and different frailty distributions.</p>


<h3>Usage</h3>

<pre><code class='language-R'>select.parfm(formula, cluster=NULL, strata=NULL, data, inip=NULL, iniFpar=NULL,
             dist=c("exponential", "weibull", "inweibull", "frechet", "gompertz", 
                    "loglogistic", "lognormal", "logskewnormal"),
             frailty=c("none", "gamma", "ingau", "possta", "lognormal"),
             method="BFGS", maxit=500, Fparscale=1, correct=0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="select.parfm_+3A_formula">formula</code></td>
<td>
<p>A <code><a href="stats.html#topic+formula">formula</a></code> object, with the response on the left of a ~ operator, and the terms on the right.
The response must be a survival object as returned by the <code><a href="survival.html#topic+Surv">Surv</a></code> function.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_cluster">cluster</code></td>
<td>
<p>The name of a cluster variable in data.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_strata">strata</code></td>
<td>
<p>The name of a strata variable in data.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_data">data</code></td>
<td>
<p>A <code><a href="base.html#topic+data.frame">data.frame</a></code> in which to interpret the variables named in the formula.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_inip">inip</code></td>
<td>
<p>The vector of initial values.
First components are for the baseline hazard parameters according to
the order
given in 'details';
Other components are for the regression parameters according to the
order given
in 'formula'.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_inifpar">iniFpar</code></td>
<td>
<p>The initial value of the frailty parameter.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_dist">dist</code></td>
<td>
<p>The vector of baseline hazards' names.
It can include any of <code>weibull</code>, <code>inweibull</code> (alias <code>frechet</code>),
<code>exponential</code>, <code>gompertz</code>, <code>loglogistic</code> or <code>lognormal</code>.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_frailty">frailty</code></td>
<td>
<p>The vector of  frailty distributions' names.
It can include any of: <code>none</code>, <code>gamma</code>, <code>ingau</code>, <code>possta</code> or <code>lognormal</code>.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_method">method</code></td>
<td>
<p>The optimisation method from the function <code><a href="stats.html#topic+optim">optim</a>()</code>.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_maxit">maxit</code></td>
<td>
<p>Maximum number of iterations (see <code><a href="stats.html#topic+optim">optim</a>()</code>).</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_fparscale">Fparscale</code></td>
<td>
<p>the scaling value for the frailty parameter in <code><a href="stats.html#topic+optim">optim</a>()</code>. 
Optimisation is performed on Fpar/Fparscale.</p>
</td></tr>
<tr><td><code id="select.parfm_+3A_correct">correct</code></td>
<td>
<p>A correction factor that does not change the marginal
log-likelihood except for an additive constant given by
#clusters * correct * log(10). It may be useful in order to get finite
log-likelihood values in case of many events per cluster
with Positive Stable frailties. Note that the value of the
log-likelihood in the output is the re-adjusted value.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>select.parfm</code>.</p>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Munda M, Rotolo F, Legrand C (2012).
parfm: Parametric Frailty Models in R.
Journal of Statistical Software, 51(11), 1-20. 
DOI &lt;doi: <a href="https://doi.org/10.18637/jss.v051.i11">10.18637/jss.v051.i11</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parfm">parfm</a></code>,
<code><a href="#topic+ci.parfm">ci.parfm</a></code>,
<code><a href="#topic+predict.parfm">predict.parfm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(kidney)
kidney$sex &lt;- kidney$sex - 1

models &lt;- select.parfm(Surv(time,status) ~ sex + age, 
                       dist = c("exponential", 
                                "weibull",
                                "inweibull",
                                "loglogistic", 
                                "lognormal", 
                                "logskewnormal"),
                       frailty = c("gamma", 
                                   "ingau", 
                                   "possta", 
                                   "lognormal"),
                       cluster = "id", data = kidney)
models
plot(models)

</code></pre>

<hr>
<h2 id='tau'>Kendall's Tau for Parametric Frailty Models</h2><span id='topic+tau'></span>

<h3>Description</h3>

<p>Computes Kendall's Tau for Parametric Frailty Models</p>


<h3>Usage</h3>

<pre><code class='language-R'>tau(x)</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tau_+3A_x">x</code></td>
<td>
<p>A parametric frailty model, object of class <code><a href="#topic+parfm">parfm</a></code>.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Federico Rotolo [aut, cre],
  Marco Munda [aut],
  Andrea Callegaro [ctb]
</p>


<h3>References</h3>

<p>Kendall, MG. (1938)
A new measure of rank correlation.
Biometrika 30(1/2), 81-93.
DOI: &lt;doi: <a href="https://doi.org/10.2307/2332226">10.2307/2332226</a>&gt;
</p>


<h3>See Also</h3>

<p><code><a href="#topic+parfm">parfm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(kidney) 
# type 'help(kidney)' for a description of the data set
kidney$sex &lt;- kidney$sex - 1

mod &lt;- parfm(Surv(time,status) ~ sex + age, cluster = "id",
             data = kidney, dist = "exponential", frailty = "gamma")
tau(mod)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
