<!DOCTYPE html><html><head><title>Help for package ThermalSampleR</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ThermalSampleR}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#boot_one'><p>Bootstrap sampling to calculate summary statistics of CTL values</p></a></li>
<li><a href='#boot_two'><p>Bootstrap sampling for difference in means between two groups</p></a></li>
<li><a href='#coreid_data'><p>Example critical thermal limit data for ThermalSampleN package</p></a></li>
<li><a href='#equiv_tost'><p>equiv_tost</p></a></li>
<li><a href='#plot_one_group'><p>Plot output from boot_sample</p></a></li>
<li><a href='#plot_two_groups'><p>Plot output from boot_two_groups</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Calculate Sample Sizes Required for Critical Thermal Limits
Experiments</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Clarke JM van Steenderen &lt;vsteenderen@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>We present a range of simulations to aid researchers in determining appropriate sample sizes when performing critical
    thermal limits studies (e.g. CTmin/CTmin experiments). A number of wrapper functions are provided for plotting and summarising outputs
    from these simulations. This package is presented in van Steenderen, C.J.M., Sutton, G.F., Owen, C.A., Martin, G.D., and Coetzee, J.A. Sample size assessments for thermal physiology studies: An R
    package and R Shiny application. 2023. Physiological Entomology. &lt;<a href="https://doi.org/10.1111%2Fphen.12416">doi:10.1111/phen.12416</a>&gt;. The GUI version of this package is available on the R Shiny online server at: 
    <a href="https://clarkevansteenderen.shinyapps.io/ThermalSampleR_Shiny/">https://clarkevansteenderen.shinyapps.io/ThermalSampleR_Shiny/</a> , or it is accessible via GitHub at <a href="https://github.com/clarkevansteenderen/ThermalSampleR_Shiny/">https://github.com/clarkevansteenderen/ThermalSampleR_Shiny/</a>. We would like
    to thank Grant Duffy (University of Otago, Dundedin, New Zealand) for granting us permission to use the source code for the Test of Total Equivalency function.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Imports:</td>
<td>tidyr, dplyr, purrr, rlang, MASS (&ge; 7.3), stats (&ge; 3.4.0),
graphics (&ge; 3.4.0), base (&ge; 3.4.0), magrittr, utils, ggplot2,
cowplot, EnvStats, sn, janitor, testthat</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>rmarkdown, knitr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-12 14:45:11 UTC; s1000334</td>
</tr>
<tr>
<td>Author:</td>
<td>Guy Frederick Sutton
    <a href="https://orcid.org/0000-0003-2405-0945"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut] (Wrote
    original R functions, and adapted the Duffy et. al. 2021 R function
    into this package.),
  Clarke JM van Steenderen
    <a href="https://orcid.org/0000-0002-4219-446X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut, cre]
    (Compiled the R package, and the associated R Shiny application.),
  Grant Duffy <a href="https://orcid.org/0000-0002-9031-8164"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [cph]
    (Granted permission to use the source code for the Test of Total
    Equivalency function.)</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-17 23:30:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='boot_one'>Bootstrap sampling to calculate summary statistics of CTL values</h2><span id='topic+boot_one'></span>

<h3>Description</h3>

<p>Calculate mean and CI's of CTL for a single population
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_one_+3A_data">data</code></td>
<td>
<p>Data frame contains raw data. Must contain a column with a population
identifier (e.g. population ID), and a column containing critical
thermal limit data (e.g. temperatures at which critical limits are reached).</p>
</td></tr>
<tr><td><code id="boot_one_+3A_groups_col">groups_col</code></td>
<td>
<p>Factor. Column containing name(s) of population(s) of interest</p>
</td></tr>
<tr><td><code id="boot_one_+3A_groups_which">groups_which</code></td>
<td>
<p>Character. Which population should be analysed?</p>
</td></tr>
<tr><td><code id="boot_one_+3A_n_max">n_max</code></td>
<td>
<p>Numeric. Maximum sample size to extrapolate simulations.</p>
</td></tr>
<tr><td><code id="boot_one_+3A_n_min">n_min</code></td>
<td>
<p>Numeric. Minimum sample size to extrapolate simulations. Defaults to 3.</p>
</td></tr>
<tr><td><code id="boot_one_+3A_iter">iter</code></td>
<td>
<p>Numeric. Number of bootstrap samples. Defaults to 29.</p>
</td></tr>
<tr><td><code id="boot_one_+3A_response">response</code></td>
<td>
<p>Numeric. Column containing thermal limit data for individual samples</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of CTL summary statistics from bootstrap resamples
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(coreid_data)
sims &lt;- boot_one(data = coreid_data,
                    groups_col = col,
                    groups_which = "Catorhintha schaffneri_APM",
                    response = response,
                    n_max = 49,
                    iter = 99)

</code></pre>

<hr>
<h2 id='boot_two'>Bootstrap sampling for difference in means between two groups</h2><span id='topic+boot_two'></span>

<h3>Description</h3>

<p>Calculate difference in mean CT limits between two groups.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="boot_two_+3A_data">data</code></td>
<td>
<p>Data frame contain raw data.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_groups_col">groups_col</code></td>
<td>
<p>Factor. Column containing names of two populations to compare</p>
</td></tr>
<tr><td><code id="boot_two_+3A_n_max">n_max</code></td>
<td>
<p>Numeric. Maximum sample size to extrapolate simulations.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_n_min">n_min</code></td>
<td>
<p>Numeric. Minimum sample size to extrapolate simulations. Defaults to 3.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_iter">iter</code></td>
<td>
<p>Numeric. Number of bootstrap samples. Defaults to 29.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_response">response</code></td>
<td>
<p>Numeric. Column containing thermal limit data for individual samples.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_group1">group1</code></td>
<td>
<p>String. Name of first population to compare.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_group2">group2</code></td>
<td>
<p>String. Name of second population to compare.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_colour_exp">colour_exp</code></td>
<td>
<p>Colour of the experimental data. Defaults to &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_colour_extrap">colour_extrap</code></td>
<td>
<p>Colour of the extrapolated data. Defaults to &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_legend.position">legend.position</code></td>
<td>
<p>Position of the legend. Defaults to &quot;top&quot;. Can be &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;, or &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="boot_two_+3A_ggtheme">ggtheme</code></td>
<td>
<p>The theme for the ggplot created. See ggplot2 themes for options. Default set to theme_classic().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data frame of bootstrap resamples
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(coreid_data)
sims &lt;- boot_two(data = coreid_data,
                        groups_col = col,
                        response = response,
                        group1 = "Catorhintha schaffneri_APM",
                        group2 = "Catorhintha schaffneri_NPM",
                        n_max = 49,
                        iter = 99)

</code></pre>

<hr>
<h2 id='coreid_data'>Example critical thermal limit data for ThermalSampleN package</h2><span id='topic+coreid_data'></span>

<h3>Description</h3>

<p>A dataset containing critical thermal limit (CTmin) data for the
sap-sucking bug, Catorintha schaffneri.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>coreid_data
</code></pre>


<h3>Format</h3>

<p>A data frame with 60 rows and 2 variables:
</p>

<dl>
<dt>col</dt><dd><p>insect population tested, string</p>
</dd>
<dt>response</dt><dd><p>CTmin value for individual insect, in degrees celsius</p>
</dd>
</dl>
<p>...

</p>


<h3>Source</h3>

<p>&quot;Unpublished data provided by Philippa Muskett
(Centre for Biological Control, Rhodes University, South Africa)
</p>

<hr>
<h2 id='equiv_tost'>equiv_tost</h2><span id='topic+equiv_tost'></span>

<h3>Description</h3>

<p>Perform a Test of Total Equivalence as adapted from Duffy et al. (2021) (&lt;https://doi.org/10.1111/1365-2435.13928&gt;)
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="equiv_tost_+3A_data">data</code></td>
<td>
<p>Data frame contains raw data. Must contain a column with a population identifier (e.g. population ID), and a column containing critical
thermal limit data (e.g. temperatures at which critical limits are reached).</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_groups_col">groups_col</code></td>
<td>
<p>Factor. Column containing the name of the population of interest (group ID)</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_groups_which">groups_which</code></td>
<td>
<p>Character. Which population should be analysed?</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_response">response</code></td>
<td>
<p>Numeric. Column containing thermal limit data for individual samples</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_skews">skews</code></td>
<td>
<p>Numeric. Vector containing skewness parameter(s). Defaults to 0, 1, 2, 10, 50.</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_equiv_margin">equiv_margin</code></td>
<td>
<p>Numeric. Equivalence of subsets to full population CT estimate (unit = degree Celcius). Defaults to 1.</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_pop_n">pop_n</code></td>
<td>
<p>Numeric. Size of population to sample (will test subsamples of size pop_n - x against pop_n for equivalence) Defaults to population size = 30</p>
</td></tr>
<tr><td><code id="equiv_tost_+3A_colrs">colrs</code></td>
<td>
<p>Character. Vector of colours for each skewness paramater value. E.g. if two skewness parameter values are set, choose two colours: colrs = c(&quot;blue&quot;, &quot;red&quot;).
Defaults to &quot;blue&quot;, &quot;red&quot;, &quot;orange&quot;, &quot;forestgreen&quot;, &quot;lightgrey&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots; (a) equivalence of means, and (b) equivalence of variances
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(coreid_data)
res &lt;- equiv_tost(data = coreid_data,
                    groups_col = col,
                    groups_which = "Catorhintha schaffneri_APM",
                    response = response,
                    skews = c(1,10),
                    colrs = c("lightblue", "lightpink"),
                    equiv_margin = 1,
                    pop_n = 5)

</code></pre>

<hr>
<h2 id='plot_one_group'>Plot output from boot_sample</h2><span id='topic+plot_one_group'></span>

<h3>Description</h3>

<p>Plot output from boot_one.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_one_group_+3A_x">x</code></td>
<td>
<p>Output from boot_one function.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_n_max">n_max</code></td>
<td>
<p>Numeric. Maximum sample size to extrapolate simulations.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_n_min">n_min</code></td>
<td>
<p>Numeric. Minimum sample size to extrapolate simulations.
Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_colour_exp">colour_exp</code></td>
<td>
<p>Colour of the experimental data. Defaults to &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_colour_extrap">colour_extrap</code></td>
<td>
<p>Colour of the extrapolated data. Defaults to &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_legend.position">legend.position</code></td>
<td>
<p>Position of the legend. Defaults to &quot;top&quot;. Can be &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;, or &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_alpha_val">alpha_val</code></td>
<td>
<p>Change the degree of shading of the graphs. Default is 0.2.</p>
</td></tr>
<tr><td><code id="plot_one_group_+3A_ggtheme">ggtheme</code></td>
<td>
<p>The theme for the ggplot created. See ggplot2 themes for options. Default set to theme_classic().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots; (a) precision of the CTmin estimate across experimental and extrapolated sample sizes; (b)
the sampling distribution (range of plausible CTmin values) across experimental and extrapolated sample sizes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sims &lt;- boot_one(coreid_data,
                    groups_col = col,
                    groups_which = "Catorhintha schaffneri_APM",
                    n_max = 30,
                    response = response)
plot_one_group(x = sims,
               n_min = 3,
               n_max = 15,
               colour_exp = "darkblue",
               colour_extrap = "green",
               legend.position = "right")

</code></pre>

<hr>
<h2 id='plot_two_groups'>Plot output from boot_two_groups</h2><span id='topic+plot_two_groups'></span>

<h3>Description</h3>

<p>Plot output from boot_two.
</p>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_two_groups_+3A_x">x</code></td>
<td>
<p>Output from boot_two_groups function. Defaults to 'sims'.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_n_max">n_max</code></td>
<td>
<p>Numeric. Maximum sample size to extrapolate simulations.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_n_min">n_min</code></td>
<td>
<p>Numeric. Minimum sample size to extrapolate simulations.
Defaults to 3.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_colour_exp">colour_exp</code></td>
<td>
<p>Colour of the experimental data. Defaults to &quot;blue&quot;.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_colour_extrap">colour_extrap</code></td>
<td>
<p>Colour of the extrapolated data. Defaults to &quot;red&quot;.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_legend.position">legend.position</code></td>
<td>
<p>Position of the legend. Defaults to &quot;top&quot;. Can be &quot;bottom&quot;, &quot;left&quot;, &quot;right&quot;, or &quot;none&quot;.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_alpha_val">alpha_val</code></td>
<td>
<p>Change the degree of shading of the graphs. Default is 0.2.</p>
</td></tr>
<tr><td><code id="plot_two_groups_+3A_ggtheme">ggtheme</code></td>
<td>
<p>The theme for the ggplot created. See ggplot2 themes for options. Default set to theme_classic().</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Two plots: (a) the precision of the estimates for the difference in CTmin
between the two selected groups across sample sizes; (b)
the 95
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
sims &lt;- boot_two(data = coreid_data,
                        groups_col = col,
                        response = response,
                        group1 = "Catorhintha schaffneri_APM",
                        group2 = "Catorhintha schaffneri_NPM",
                        n_max = 30,
                        iter = 99)

plots &lt;- plot_two_groups(x = sims,
                         n_min = 3,
                         n_max = 30,
                         colour_exp = "gold",
                         colour_extrap = "darkgreen",
                         legend.position = "right")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
