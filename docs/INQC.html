<!DOCTYPE html><html><head><title>Help for package INQC</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {INQC}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#climdex2ecad'><p>Converter from the ClimDex format into the ECA&amp;D format (blended version)</p></a></li>
<li><a href='#clocov'><p>QC for Cloud Cover (CC)</p></a></li>
<li><a href='#computecal'><p>Prepares a calendar frame</p></a></li>
<li><a href='#consolidator'><p>Consolidates QC files</p></a></li>
<li><a href='#cost2ecad'><p>Converter from the COST Home format into the ECA&amp;D format (blended version)</p></a></li>
<li><a href='#decimaldegrees'><p>Converter for geographical coordinates from the ECA&amp;D format into decimal degrees</p></a></li>
<li><a href='#dostats'><p>Create QC statistical summary</p></a></li>
<li><a href='#downloadator'><p>Downloads the latest version of blended data from the ECA&amp;D website</p></a></li>
<li><a href='#drywetlong'><p>Detects wet/dry long periods</p></a></li>
<li><a href='#duplas'><p>Detects duplicated dates</p></a></li>
<li><a href='#flat'><p>Flat sequences</p></a></li>
<li><a href='#flatsun'><p>Flat sequences for sunshine duration (only for &quot;non-blended&quot; ECA&amp;D data)</p></a></li>
<li><a href='#inithome'><p>Creates necessary folders (if not exist)</p></a></li>
<li><a href='#inqc'><p>Wrapper for QC'ing all variables</p></a></li>
<li><a href='#IQRoutliers'><p>Computes outliers</p></a></li>
<li><a href='#jumps2'><p>Labels interdiurnal large differences</p></a></li>
<li><a href='#listas'><p>Creates listings for stations ('non-blended' case) linking STAID and SOUID</p></a></li>
<li><a href='#lister'><p>Creates a list of blended/non-bladed files for some climate variable</p></a></li>
<li><a href='#listonator'><p>Creates a list (as 'Global' variable) of stations to be QCed.</p></a></li>
<li><a href='#newfriki'><p>Isolates values which are not continuous in the distribution</p></a></li>
<li><a href='#paretogadget'><p>Finds outliers</p></a></li>
<li><a href='#physics'><p>Isolates anomalous values</p></a></li>
<li><a href='#potpareto'><p>Peaks over threshold modelling</p></a></li>
<li><a href='#precip'><p>QC for Atmospheric Precipitation (RR)</p></a></li>
<li><a href='#putjulian'><p>Merges julian days</p></a></li>
<li><a href='#readecad'><p>Reads an ECA&amp;D data/sources/stations file</p></a></li>
<li><a href='#readheader'><p>Reads the header of an ECA&amp;D file</p></a></li>
<li><a href='#relhum'><p>QC for Relative Humidity (HU)</p></a></li>
<li><a href='#repeatedvalue'><p>Finds repeated values</p></a></li>
<li><a href='#returnpotpareto'><p>Threshold percentile for the Pareto outliers</p></a></li>
<li><a href='#rounding'><p>Detects rounded sections</p></a></li>
<li><a href='#roundprecip'><p>Rounding in precipitation data</p></a></li>
<li><a href='#selepe'><p>QC for Atmospheric Pressure (PP)</p></a></li>
<li><a href='#snowdepth'><p>QC for Snow Depth (SD)</p></a></li>
<li><a href='#sunafterdark'><p>Maximum sunshine hours (only for &quot;non-blended&quot; ECA&amp;D data)</p></a></li>
<li><a href='#sundur'><p>QC for Sunshine Duration (SS)</p></a></li>
<li><a href='#suspectacumprec'><p>Detects precipitation values above limit</p></a></li>
<li><a href='#temperature'><p>QC for Air Temperature (TX/TN/TG)</p></a></li>
<li><a href='#toomany'><p>Looks if a value is repeated too many times</p></a></li>
<li><a href='#txtn'><p>Comparison of tx an tn data (for &quot;non-blended&quot; ECA&amp;D data)</p></a></li>
<li><a href='#txtnblend'><p>Comparison of tx an tn data (for &quot;blended&quot; ECA&amp;D data)</p></a></li>
<li><a href='#weirddate'><p>Locate impossible dates</p></a></li>
<li><a href='#windspeed'><p>QC for Wind Speed (FG)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Quality Control of Climatological Daily Time Series</td>
</tr>
<tr>
<td>Version:</td>
<td>2.0.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2021-05-19</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of functions for quality control (QC) of climatological daily time series (e.g. the ECA&amp;D station data).</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/INDECIS-Project/INQC">https://github.com/INDECIS-Project/INQC</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/INDECIS-Project/INQC/issues">https://github.com/INDECIS-Project/INQC/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>evd, gdata, suncalc, stats, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>readr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2021-05-24 13:21:02 UTC; Typhoon</td>
</tr>
<tr>
<td>Author:</td>
<td>Enric Aguilar <a href="https://orcid.org/0000-0002-8384-377X"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut, cre],
  Oleg Skrynyk <a href="https://orcid.org/0000-0001-8827-0280"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Enric Aguilar &lt;enric.aguilar@urv.cat&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2021-05-24 14:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='climdex2ecad'>Converter from the ClimDex format into the ECA&amp;D format (blended version)</h2><span id='topic+climdex2ecad'></span>

<h3>Description</h3>

<p>This function will convert station and data files in ClimDex format into
corresponding station and data files in the ECA&amp;D format (blended version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climdex2ecad(
  homefolder = "./",
  stationlist = "stations.csv",
  countrycode = "DE"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climdex2ecad_+3A_homefolder">homefolder</code></td>
<td>
<p>path to the home directory which should contain the subdirectory 'raw_ClimDex' with
files in the ClimDex format</p>
</td></tr>
<tr><td><code id="climdex2ecad_+3A_stationlist">stationlist</code></td>
<td>
<p>list (as 'csv'-file) of climatological stations to be considered. Each line should be in the format:
lat (as dec. degree), lon (as dec. degree), height, staname</p>
</td></tr>
<tr><td><code id="climdex2ecad_+3A_countrycode">countrycode</code></td>
<td>
<p>two character country code</p>
</td></tr>
</table>


<h3>Value</h3>

<p>station and data files in the ECA&amp;D format stored in the subdirectory 'raw'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files in the ClimDex format have to be located
dir.create(file.path(wd, "raw_ClimDex"))
#Extract the ClimDex data and station files from the example data folder
path2stalist&lt;-system.file("extdata", "stations.csv", package = "INQC")
stalist&lt;-readr::read_lines_raw(path2stalist)
readr::write_lines(stalist,file=paste0(wd,"/raw_ClimDex/stations.csv"))
path2data1&lt;-system.file("extdata", "Deuselbach.txt", package = "INQC")
data1&lt;-readr::read_lines_raw(path2data1)
readr::write_lines(data1, file=paste0(wd,"/raw_ClimDex/Deuselbach.txt"))
path2data2&lt;-system.file("extdata", "Staname.txt", package = "INQC")
data2&lt;-readr::read_lines_raw(path2data2)
readr::write_lines(data2, file=paste0(wd,"/raw_ClimDex/Staname.txt"))
#Call the converter
climdex2ecad(homefolder = "./",stationlist = "stations.csv",countrycode = "DE")
#The results can be found in the directory:
print(wd)
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='clocov'>QC for Cloud Cover (CC)</h2><span id='topic+clocov'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. It will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>clocov(
  element = "CC",
  maxseq = 8,
  blocksizeround = 20,
  blockmanymonth = 20,
  blockmanyyear = 200,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="clocov_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (CC for cloud cover)</p>
</td></tr>
<tr><td><code id="clocov_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, FUNCTION: flat  (8,8,8 would be 3 consecutive values).</p>
</td></tr>
<tr><td><code id="clocov_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, FUNCTION: rounding</p>
</td></tr>
<tr><td><code id="clocov_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany</p>
</td></tr>
<tr><td><code id="clocov_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany</p>
</td></tr>
<tr><td><code id="clocov_+3A_inisia">inisia</code></td>
<td>
<p>a logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>QC results for CC
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2cclist&lt;-system.file("extdata", "ECA_blend_source_cc.txt", package = "INQC")
cclist&lt;-readr::read_lines_raw(path2cclist)
readr::write_lines(cclist,'ECA_blend_source_cc.txt')
path2ccdata&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_SOUID132727.txt',sep=''))
#Perform QC of Cloud Cover data
clocov(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='computecal'>Prepares a calendar frame</h2><span id='topic+computecal'></span>

<h3>Description</h3>

<p>This function prepares a calendar frame and returns it as year,month,day (i.e., the 3 first columns of the RClimdex format)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>computecal(fy, ly)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="computecal_+3A_fy">fy</code></td>
<td>
<p>first year to work with (past)</p>
</td></tr>
<tr><td><code id="computecal_+3A_ly">ly</code></td>
<td>
<p>last year to work with (present)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>3 columns containing year,month,day
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fy&lt;-1981
ly&lt;-2020
clndr&lt;-computecal(fy,ly)
</code></pre>

<hr>
<h2 id='consolidator'>Consolidates QC files</h2><span id='topic+consolidator'></span>

<h3>Description</h3>

<p>This function is not intended to be called as a stand-alone function. It is automatically called each time a file ends its QC.
It will write the quality control files. One file will be placed in a subfolder of the homefolder named QCConslidated. It will use the exact ECA&amp;D
format (date, value, QC flag). The QC flags include:
</p>
<p>0: Passed QC;
1: ERROR;
2: ALMOST CERTAIN, ERROR;
3: OUTLIER, SUSPECT;
4: COLLECTIVELY SUSPECT;
9: Missing value.
</p>
<p>A second file is placed in the subfolder QC and includes all date, value and a column for each QC test ran over this file. Values passing/not passing QC
are labelled with 0/1. A third file summarizes the number of values falling on each category (0,1,2,3,4,9) and the number of values failing each test
</p>


<h3>Usage</h3>

<pre><code class='language-R'>consolidator(filename, x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="consolidator_+3A_filename">filename</code></td>
<td>
<p>ECA&amp;D file name, expressed as VV_SOUIDXXXXXX.txt, where &quot;VV&quot; is the two-letters variable code, &quot;SOUID&quot; is literal,
XXXXXX is the ECA&amp;D SOUID code and &quot;.txt&quot; is literal</p>
</td></tr>
<tr><td><code id="consolidator_+3A_x">x</code></td>
<td>
<p>QCed series, formatted as date, value, QC flag</p>
</td></tr>
</table>


<h3>Value</h3>

<p>It does not return any value. Each time when called, it will create three files:
Summary file,  placed at ./QCSumamry/SummaryVV_SOUIDXXXXXX.txt;
QC consolidated file, placed at ./QCConsolidated/VV_SOUIDXXXXXX.txt;
Verbose QC file, placed at ./QC/qc_VV_SOUIDXXXXXX.txt.
</p>

<hr>
<h2 id='cost2ecad'>Converter from the COST Home format into the ECA&amp;D format (blended version)</h2><span id='topic+cost2ecad'></span>

<h3>Description</h3>

<p>This function will convert station and data files in COST Home format into
corresponding station and data files in the ECA&amp;D format (blended version)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cost2ecad(homefolder = "./")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cost2ecad_+3A_homefolder">homefolder</code></td>
<td>
<p>path to the home directory which should contain the subdirectory 'raw_COST' with
files in the COST Home format. Files of all variables must be stored in 'raw_COST'</p>
</td></tr>
</table>


<h3>Value</h3>

<p>station and data files in the ECA&amp;D format stored in the subdirectory 'raw'
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files in the COST format have to be located
dir.create(file.path(wd, "raw_COST"))
#TG: Extract the COST data and station files from the example data folder
path2tglist&lt;-system.file("extdata", "000001stations.txt", package = "INQC")
tglist&lt;-readr::read_lines_raw(path2tglist)
readr::write_lines(tglist,file=paste0(wd,"/raw_COST/000001stations.txt"))
path2tgdata1&lt;-system.file("extdata", "ratmd00000001d.txt", package = "INQC")
tgdata1&lt;-readr::read_lines_raw(path2tgdata1)
readr::write_lines(tgdata1, file=paste0(wd,"/raw_COST/ratmd00000001d.txt"))
path2tgdata2&lt;-system.file("extdata", "ratmd00000005d.txt", package = "INQC")
tgdata2&lt;-readr::read_lines_raw(path2tgdata2)
readr::write_lines(tgdata2, file=paste0(wd,"/raw_COST/ratmd00000005d.txt"))
#PP: Extract the COST data and station files from the example data folder
path2pplist&lt;-system.file("extdata", "000002stations.txt", package = "INQC")
pplist&lt;-readr::read_lines_raw(path2pplist)
readr::write_lines(pplist,file=paste0(wd,"/raw_COST/000002stations.txt"))
path2ppdata1&lt;-system.file("extdata", "rappd00000001d.txt", package = "INQC")
ppdata1&lt;-readr::read_lines_raw(path2ppdata1)
readr::write_lines(ppdata1, file=paste0(wd,"/raw_COST/rappd00000001d.txt"))
path2ppdata2&lt;-system.file("extdata", "rappd00000012d.txt", package = "INQC")
ppdata2&lt;-readr::read_lines_raw(path2ppdata2)
readr::write_lines(ppdata2, file=paste0(wd,"/raw_COST/rappd00000012d.txt"))
#Call the converter
cost2ecad(homefolder = "./")
#The results can be found in the directory:
print(wd)
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='decimaldegrees'>Converter for geographical coordinates from the ECA&amp;D format into decimal degrees</h2><span id='topic+decimaldegrees'></span>

<h3>Description</h3>

<p>This function takes sexagesimal degrees in the ECA&amp;D format and converts them into decimal degrees.
Initial idea was taken from: https://modtools.wordpress.com/2013/09/25/dms2dec/
</p>


<h3>Usage</h3>

<pre><code class='language-R'>decimaldegrees(dms, sep = ":")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="decimaldegrees_+3A_dms">dms</code></td>
<td>
<p>ONE ELEMENT from the LAT or LON field in ECA&amp;D listings</p>
</td></tr>
<tr><td><code id="decimaldegrees_+3A_sep">sep</code></td>
<td>
<p>the separator between elements, in ECA&amp;D &quot;:&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>geographical coordinates (latitude or longitude) in decimal degrees
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dms&lt;-'+48:03:00'
dec&lt;-decimaldegrees(dms)

dms&lt;-'-015:03:00'
dec&lt;-decimaldegrees(dms)
</code></pre>

<hr>
<h2 id='dostats'>Create QC statistical summary</h2><span id='topic+dostats'></span>

<h3>Description</h3>

<p>This function creates two report files (Mystats.txt and CasesSummary.txt) with a statistical summary
of QCs performed over the whole data set
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dostats()
</code></pre>


<h3>Value</h3>

<p>files with QC summary
</p>

<hr>
<h2 id='downloadator'>Downloads the latest version of blended data from the ECA&amp;D website</h2><span id='topic+downloadator'></span>

<h3>Description</h3>

<p>This function will use the default or specified links to download one or several files from ECA&amp;D and place them for their use
with INQC. For each variable a data file and a station file will/should be specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>downloadator(
  homefolder = "../ecad_updated",
  tx = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_tx.zip",
  tx2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_tx.txt",
  tn = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_tn.zip",
  tn2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_tn.txt",
  tg = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_tg.zip",
  tg2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_tg.txt",
  sd = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_sd.zip",
  sd2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_sd.txt",
  ss = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_ss.zip",
  ss2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_ss.txt",
  rr = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_rr.zip",
  rr2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_rr.txt",
  pp = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_pp.zip",
  pp2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_rr.txt",
  cc = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_cc.zip",
  cc2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_cc.txt",
  hu = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_hu.zip",
  hu2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_hu.txt",
  fg = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_fg.zip",
  fg2 = "http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_fg.txt"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="downloadator_+3A_homefolder">homefolder</code></td>
<td>
<p>full path to local folder in the form './homefolder'. The function will store there the station files and create ./homefolder/raw
and will store there the data</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tx">tx</code></td>
<td>
<p>link to download daily maximum temperature or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tx2">tx2</code></td>
<td>
<p>link to download daily maximum temperatures station list  or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tn">tn</code></td>
<td>
<p>link to download daily minimum temperature or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tn2">tn2</code></td>
<td>
<p>link to download daily minimum temperature station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tg">tg</code></td>
<td>
<p>link to download daily average temperature or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_tg2">tg2</code></td>
<td>
<p>link to download daily average temperature station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_sd">sd</code></td>
<td>
<p>link to download daily snow depth or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_sd2">sd2</code></td>
<td>
<p>link to download daily snow depth station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_ss">ss</code></td>
<td>
<p>link to download daily sunshine duration or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_ss2">ss2</code></td>
<td>
<p>link to download daily sunshine duration station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_rr">rr</code></td>
<td>
<p>link to download daily rainfall or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_rr2">rr2</code></td>
<td>
<p>link to download daily rainfall station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_pp">pp</code></td>
<td>
<p>link to download daily sea level pressure or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_pp2">pp2</code></td>
<td>
<p>link to download daily sea level pressure station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_cc">cc</code></td>
<td>
<p>link to download daily cloud coverage or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_cc2">cc2</code></td>
<td>
<p>link to download daily cloud coverage station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_hu">hu</code></td>
<td>
<p>link to download daily relative humidity or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_hu2">hu2</code></td>
<td>
<p>link to download daily relative humidity station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_fg">fg</code></td>
<td>
<p>link to download daily wind speed or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
<tr><td><code id="downloadator_+3A_fg2">fg2</code></td>
<td>
<p>link to download daily wind speed station list or NULL. Default set to working ECA&amp;D link, as of 22/12/2020. Provided link MUST exist.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For each valid link, the corresponding file will be downloaded. Data files will be unzipped to the ./raw folder (as requested by INQC)
and station files will be stored at the specified homefolder
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Please note, the command below might take a while and will download the ECA&amp;D data
#with a size more than 0.5GB
downloadator('./data',
             tx=NULL,
             tx2=NULL,
             tn=NULL,
             tn2=NULL,
             tg=NULL,
             tg2=NULL,
             sd=NULL,
             sd2=NULL,
             ss='http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_nonblend_ss.zip',
             ss2="http://knmi-ecad-assets-prd.s3.amazonaws.com/download/ECA_blend_source_ss.txt",
             rr=NULL,
             rr2=NULL,
             pp=NULL,
             pp2=NULL,
             cc=NULL,
             cc2=NULL,
             hu=NULL,
             hu2=NULL,
             fg=NULL,
             fg2=NULL)
#Delete the downloaded archive (the zip-file)
file.remove(paste(wd,"/data/raw/","ss.zip",sep=""))
#Return to user's working directory:
setwd(wd0)
#The downloaded files can be found in directory:
print(wd)

## End(Not run)
</code></pre>

<hr>
<h2 id='drywetlong'>Detects wet/dry long periods</h2><span id='topic+drywetlong'></span>

<h3>Description</h3>

<p>This function detects episodes of too many consecutive wet or dry days
</p>


<h3>Usage</h3>

<pre><code class='language-R'>drywetlong(x, ret = 300, sueco = 9.9, dry = TRUE, wet = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="drywetlong_+3A_x">x</code></td>
<td>
<p>vector with values</p>
</td></tr>
<tr><td><code id="drywetlong_+3A_ret">ret</code></td>
<td>
<p>pseudo-return period (pareto-based) to compute the maximum tolerable spell</p>
</td></tr>
<tr><td><code id="drywetlong_+3A_sueco">sueco</code></td>
<td>
<p>threshold for dividing dry and wet. This is useful to label other binary sequences, e.g. for 0 radiation. Now it is &lt;= and &gt;, instead of &lt; and &gt;=</p>
</td></tr>
<tr><td><code id="drywetlong_+3A_dry">dry</code></td>
<td>
<p>if set to TRUE, dry sequences are sent to result; if FALSE, omitted</p>
</td></tr>
<tr><td><code id="drywetlong_+3A_wet">wet</code></td>
<td>
<p>same as previous, for wet sequences</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions in the input data time series which do not pass QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
x&lt;-readecad(input=path2inptfl,missing= -9999)[,4:4]
#Find all suspicious positions in the precipitation time series
drywetlong(x,ret=300,sueco=9.9,dry=TRUE,wet=TRUE)

#Introduce the long wet period
x[1:600]&lt;-10
#Find all suspicious positions in the precipitation time series
drywetlong(x,ret=300,sueco=9.9,dry=TRUE,wet=TRUE)
</code></pre>

<hr>
<h2 id='duplas'>Detects duplicated dates</h2><span id='topic+duplas'></span>

<h3>Description</h3>

<p>This function detects duplicated dates in the input time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>duplas(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="duplas_+3A_x">x</code></td>
<td>
<p>vector of dates in the ECA&amp;D format (YYYYMMDD)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector with the list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
x&lt;-readecad(input=path2inptfl,missing= -9999)[,3]
#Find all duplicated dates in the time series
duplas(x)

#Introduce the duplicated dates
x[31]&lt;-'19610130'
#Find all duplicated dates in the time series
duplas(x) 
</code></pre>

<hr>
<h2 id='flat'>Flat sequences</h2><span id='topic+flat'></span>

<h3>Description</h3>

<p>This function detects consecutive equal values (e.g., 15.1, 15.1, 15.1, 15.1...) in a data time series.
Also can be used to detect consecutive equal decimal part of the values (e.g., 15.1, 12.1, 13.1, 10.1 ...)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flat(y, maxseq, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flat_+3A_y">y</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="flat_+3A_maxseq">maxseq</code></td>
<td>
<p>the maximum number of contiguous repetitions of a value (e.g., if 3, sequences of 4 will be flagged)</p>
</td></tr>
<tr><td><code id="flat_+3A_exclude">exclude</code></td>
<td>
<p>values to be excluded. This is useful for variables where a single value is expected to repeat many times, e.g. 0.0 in precipitation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>y&lt;-rnorm(100)
y[10:20]&lt;-10
flat(y,5)

#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all consecutive (with a length &gt; 5 elements) equal values in the time series
flat(y,5)

#Introduce the duplicated dates
y[6:12]&lt;-10
#Find all consecutive (with a length &gt; 5 elements) equal values in the time series
flat(y,5)
</code></pre>

<hr>
<h2 id='flatsun'>Flat sequences for sunshine duration (only for &quot;non-blended&quot; ECA&amp;D data)</h2><span id='topic+flatsun'></span>

<h3>Description</h3>

<p>This function uses flat() and modifies it with &quot;smart&quot; comparison with clouds.
If close to 8 and close to 0 clouds, allowed; if close to maxsundur and clouds near 0, allowed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>flatsun(x, maxseq, id, modonube = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="flatsun_+3A_x">x</code></td>
<td>
<p>data.frame date/value (need dates in this implementation of flat)</p>
</td></tr>
<tr><td><code id="flatsun_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of contiguous repetitions of a value (e.g., if 3, sequences of 4 will be flagged)</p>
</td></tr>
<tr><td><code id="flatsun_+3A_id">id</code></td>
<td>
<p>name of a file (&quot;SS_SOUIDxxxxxx.txt&quot;, non-blended) with sunshine data (see parameter x) to be checked</p>
</td></tr>
<tr><td><code id="flatsun_+3A_modonube">modonube</code></td>
<td>
<p>logical flag. If FALSE (the default), the &quot;sun&quot; mode of the function is used. If TRUE, the &quot;cloud&quot; mode
is used</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
#Extract the non-blended ECA&amp;D data and station files from the example data folder
path2cclist&lt;-system.file("extdata", "ECA_blend_source_cc.txt", package = "INQC")
cclist&lt;-readr::read_lines_raw(path2cclist)
readr::write_lines(cclist,'ECA_blend_source_cc.txt')
path2ccdata&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_SOUID132727.txt',sep=''))
path2sslist&lt;-system.file("extdata", "ECA_blend_source_ss.txt", package = "INQC")
sslist&lt;-readr::read_lines_raw(path2sslist)
readr::write_lines(sslist,'ECA_blend_source_ss.txt')
path2ssdata&lt;-system.file("extdata", "SS_SOUID132728.txt", package = "INQC")
ssdata&lt;-readr::read_lines_raw(path2ssdata)
readr::write_lines(ssdata, file=paste(wd,'/raw/SS_SOUID132728.txt',sep=''))
#Read the sunshine data
x&lt;-readecad(input=path2ssdata,missing= -9999)[,3:4]
options("homefolder"='./'); options("blend"=FALSE)
listonator(check=TRUE)
#Call flatsun()
flatsun(x,5,"SS_SOUID132728.txt",modonube=FALSE)
#Introduce error values in the sunshine data
x[1:10,2]&lt;-10
#Call flatsun()
flatsun(x,5,"SS_SOUID132728.txt",modonube=FALSE)
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='inithome'>Creates necessary folders (if not exist)</h2><span id='topic+inithome'></span>

<h3>Description</h3>

<p>This function will checks if all necessary folders ('QCSummary, QC and QCConsolidated) exist and if not, creates them.
Not intended as a stand-alone function. Called from other routines.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inithome()
</code></pre>


<h3>Value</h3>

<p>it does not return any values, just creates the described folders if they do not exist
</p>

<hr>
<h2 id='inqc'>Wrapper for QC'ing all variables</h2><span id='topic+inqc'></span>

<h3>Description</h3>

<p>This function calls functions which perform QC for all climate variables
</p>


<h3>Usage</h3>

<pre><code class='language-R'>inqc(homefolder = "./", blend = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="inqc_+3A_homefolder">homefolder</code></td>
<td>
<p>path to the homefolder, as string</p>
</td></tr>
<tr><td><code id="inqc_+3A_blend">blend</code></td>
<td>
<p>logical flag which means performing (if TRUE) QC on blended time series</p>
</td></tr>
</table>


<h3>Value</h3>

<p>QC results, in both formats (verbose and workable file in exact ECA&amp;D format)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
#NON-BLENDED ECA&amp;D SERIES
#Extract the non-blended ECA&amp;D data and station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) data are used in the example
path2txlist&lt;-system.file("extdata", "ECA_blend_source_tx.txt", package = "INQC")
txlist&lt;-readr::read_lines_raw(path2txlist)
readr::write_lines(txlist,'ECA_blend_source_tx.txt')
path2txdata&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,'/raw/TX_SOUID132734.txt',sep=''))
path2cclist&lt;-system.file("extdata", "ECA_blend_source_cc.txt", package = "INQC")
cclist&lt;-readr::read_lines_raw(path2cclist)
readr::write_lines(cclist,'ECA_blend_source_cc.txt')
path2ccdata&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_SOUID132727.txt',sep=''))
#This is the MAIN starting point of the INQC software calculation:
inqc(homefolder='./',blend=FALSE) #Work with non-blended ECA&amp;D data
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#The QC results can be found in the directory:
print(wd)
#BLENDED ECA&amp;D SERIES
#Extract the blended ECA&amp;D data and station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) data are used in the example
path2list&lt;-system.file("extdata", "stations.txt", package = "INQC")
list&lt;-readr::read_lines_raw(path2list)
readr::write_lines(list,file=paste(wd,'/raw/stations.txt',sep=''))
path2txdata&lt;-system.file("extdata", "TX_STAID000002.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,'/raw/TX_STAID000002.txt',sep=''))
path2ccdata&lt;-system.file("extdata", "CC_STAID000001.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_STAID000001.txt',sep=''))
#This is the MAIN starting point of the INQC software calculation:
inqc(homefolder='./',blend=TRUE) #work with blended ECA&amp;D data
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#The QC results can be found in the directory:
print(wd)
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='IQRoutliers'>Computes outliers</h2><span id='topic+IQRoutliers'></span>

<h3>Description</h3>

<p>This function computes outliers centralized around a day, using a number of days around it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>IQRoutliers(date, value, level = 3, window = 11, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="IQRoutliers_+3A_date">date</code></td>
<td>
<p>vector with dates</p>
</td></tr>
<tr><td><code id="IQRoutliers_+3A_value">value</code></td>
<td>
<p>vector with data values</p>
</td></tr>
<tr><td><code id="IQRoutliers_+3A_level">level</code></td>
<td>
<p>number of IQRs to be added to percentile 75 and subtracted to percentile 25 to
determinate the tolerance interval. Values outside this interval, will be declared as outliers.</p>
</td></tr>
<tr><td><code id="IQRoutliers_+3A_window">window</code></td>
<td>
<p>number of days to be considered (including the target)</p>
</td></tr>
<tr><td><code id="IQRoutliers_+3A_exclude">exclude</code></td>
<td>
<p>if it is not null, the code will exclude this value from the analysis (i.e., good to exclude 0 for precipitation)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>positions which do not pass this QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
date&lt;-readecad(input=path2inptfl,missing= -9999)[,3]
value&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all suspicious positions in the time series
IQRoutliers(date,value,level=3,window=11,exclude=NULL)
</code></pre>

<hr>
<h2 id='jumps2'>Labels interdiurnal large differences</h2><span id='topic+jumps2'></span>

<h3>Description</h3>

<p>This function looks for interdiurnal differences considered too large (larger than
a threshold value). The threshold can be defined by two different ways: (1) as an absolute value,
the same for all differences. It is specified directly through the parameter 'force' (see below);
(2) as a quantile in a probability distribution of the interdiurnal differences (built
for each month separately). In this case, the threshold is specified indirectly through the
parameter 'quanty' (see below). The calculated threshold quantiles can be also modified
(increased/decreased) by means of the parameter 'times' (see below).
</p>
<p>Consequently, jumps2() can be used in two different modes: 'absolute' and 'quantile'
</p>


<h3>Usage</h3>

<pre><code class='language-R'>jumps2(date, value, quanty = 0.999, times = 1, force = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="jumps2_+3A_date">date</code></td>
<td>
<p>vector of dates</p>
</td></tr>
<tr><td><code id="jumps2_+3A_value">value</code></td>
<td>
<p>vector of values</p>
</td></tr>
<tr><td><code id="jumps2_+3A_quanty">quanty</code></td>
<td>
<p>threshold quantile rank (cumulative probability) to define corresponding
quantiles in the distributions of the interdiurnal differences (for each month separately)</p>
</td></tr>
<tr><td><code id="jumps2_+3A_times">times</code></td>
<td>
<p>factor to modify (increase/decrease) the threshold quantile values</p>
</td></tr>
<tr><td><code id="jumps2_+3A_force">force</code></td>
<td>
<p>value of threshold for daily value differences to be forced</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
date&lt;-readecad(input=path2inptfl,missing= -9999)[,3]
value&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all suspicious positions in the time series (in 'quantile' mode)
jumps2(date,value,quanty=0.999,times=1)
#Find all suspicious positions in the time series (in 'absolute' mode)
jumps2(date,value,force=100)
</code></pre>

<hr>
<h2 id='listas'>Creates listings for stations ('non-blended' case) linking STAID and SOUID</h2><span id='topic+listas'></span>

<h3>Description</h3>

<p>This function takes all the elements and rbinds them into a single list to process
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listas(country = "all", name = "allstations.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listas_+3A_country">country</code></td>
<td>
<p>country for which the list is created. If 'all', no country filter.</p>
</td></tr>
<tr><td><code id="listas_+3A_name">name</code></td>
<td>
<p>output file name, do not touch, default is always good.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame and the list file containing all stations for all elements, linking STAID and SOUID
and metadata
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Extract the non-blended ECA&amp;D station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) variables are used in the example
path2txlist&lt;-system.file("extdata", "ECA_blend_source_tx.txt", package = "INQC")
txlist&lt;-readr::read_lines_raw(path2txlist)
readr::write_lines(txlist,'ECA_blend_source_tx.txt')
path2cclist&lt;-system.file("extdata", "ECA_blend_source_cc.txt", package = "INQC")
cclist&lt;-readr::read_lines_raw(path2cclist)
readr::write_lines(cclist,'ECA_blend_source_cc.txt')
options("homefolder"='./')
liston.nb&lt;-listas(country='all',name='allstations.txt')
#The created list file can be found in the directory:
print(wd)
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='lister'>Creates a list of blended/non-bladed files for some climate variable</h2><span id='topic+lister'></span>

<h3>Description</h3>

<p>This function creates a list of blended or non-bladed files containing data of a specified element
to be QCed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lister(element)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lister_+3A_element">element</code></td>
<td>
<p>climatological element (defined by means of two letters, i.e. 'TX')</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of blended or non-bladed files to be QCed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where a station file has to be located
dir.create(file.path(wd, 'raw'))
#NON-BLENDED ECA&amp;D SERIES
#Extract the non-blended ECA&amp;D data and station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) data are used in the example
path2txdata&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,'/raw/TX_SOUID132734.txt',sep=''))
path2ccdata&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_SOUID132727.txt',sep=''))
options("homefolder"='./'); options("blend"=FALSE)
list.nb&lt;-lister('TX')
#BLENDED ECA&amp;D SERIES
#Extract the blended ECA&amp;D data and station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) data are used in the example
path2txdata&lt;-system.file("extdata", "TX_STAID000002.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,'/raw/TX_STAID000002.txt',sep=''))
path2ccdata&lt;-system.file("extdata", "CC_STAID000001.txt", package = "INQC")
ccdata&lt;-readr::read_lines_raw(path2ccdata)
readr::write_lines(ccdata, file=paste(wd,'/raw/CC_STAID000001.txt',sep=''))
options("blend"=TRUE)
list.b&lt;-lister('TX')
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='listonator'>Creates a list (as 'Global' variable) of stations to be QCed.</h2><span id='topic+listonator'></span>

<h3>Description</h3>

<p>This function creates a list (and makes it 'Global' variable) of stations to be QCed.
It can be 'blended' or 'non-blended' stations. Geographical coordinates are converted into decimal degrees
</p>


<h3>Usage</h3>

<pre><code class='language-R'>listonator(check = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="listonator_+3A_check">check</code></td>
<td>
<p>logical parameter TRUE/FALSE. If check=TRUE a list of stations is created.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of stations to be QCed
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#NON-BLENDED ECA&amp;D SERIES
#Extract the non-blended ECA&amp;D station files from the example data folder
#Only TX (maximum air temperature) and CC (cloud cover) variables are used in the example
path2txlist&lt;-system.file("extdata", "ECA_blend_source_tx.txt", package = "INQC")
txlist&lt;-readr::read_lines_raw(path2txlist)
readr::write_lines(txlist,'ECA_blend_source_tx.txt')
path2cclist&lt;-system.file("extdata", "ECA_blend_source_cc.txt", package = "INQC")
cclist&lt;-readr::read_lines_raw(path2cclist)
readr::write_lines(cclist,'ECA_blend_source_cc.txt')
options("homefolder"='./'); options("blend"=FALSE)
listonator(check=TRUE)
liston.nb&lt;-getOption("liston")
#BLENDED ECA&amp;D SERIES
#Create subdirectory where a station file has to be located
dir.create(file.path(wd, 'raw'))
#Extract the blended ECA&amp;D station file from the example data folder
path2list&lt;-system.file("extdata", "stations.txt", package = "INQC")
list&lt;-readr::read_lines_raw(path2list)
readr::write_lines(list,file=paste(wd,'/raw/stations.txt',sep=''))
options("blend"=TRUE)
listonator(check=TRUE)
liston.b&lt;-getOption("liston")
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='newfriki'>Isolates values which are not continuous in the distribution</h2><span id='topic+newfriki'></span>

<h3>Description</h3>

<p>The function isolates extreme values which are not continuous in the distribution. If
the gap is larger (or smaller) than a pre-set big margin, the values above (or below) are flagged
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newfriki(date, value, margina = 0.999, times = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newfriki_+3A_date">date</code></td>
<td>
<p>vector of dates with the ECA&amp;D format yyyymmdd</p>
</td></tr>
<tr><td><code id="newfriki_+3A_value">value</code></td>
<td>
<p>vector of data values</p>
</td></tr>
<tr><td><code id="newfriki_+3A_margina">margina</code></td>
<td>
<p>tolerance margin, expressed as quantile of the differences</p>
</td></tr>
<tr><td><code id="newfriki_+3A_times">times</code></td>
<td>
<p>multiplier for the tolerance margin. Intended usage is to run this twice.
Once with times = 1 and flag values as suspect; once with times = 2 and flag as error</p>
</td></tr>
</table>


<h3>Value</h3>

<p>positions which do not pass this QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
date&lt;-readecad(input=path2inptfl,missing= -9999)[,3]
value&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all suspicious positions in the time series
newfriki(date,value,margina=0.999,times=1)
</code></pre>

<hr>
<h2 id='paretogadget'>Finds outliers</h2><span id='topic+paretogadget'></span>

<h3>Description</h3>

<p>This function finds outliers for variables which can be described/evaluated by means of
the Pareto distribution (e.g. atmospheric precipitation or wind speed)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>paretogadget(x, ret)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="paretogadget_+3A_x">x</code></td>
<td>
<p>vector of values (a series) to be analyzed</p>
</td></tr>
<tr><td><code id="paretogadget_+3A_ret">ret</code></td>
<td>
<p>pseudo-return period for the pot-pareto distribution approach</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test (which can be considered as outliers)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D precipitation data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
x&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all suspicious positions in the time series corresponding to the requested return period
paretogadget(x,25)
#Suspicious values
x[paretogadget(x,25)]
</code></pre>

<hr>
<h2 id='physics'>Isolates anomalous values</h2><span id='topic+physics'></span>

<h3>Description</h3>

<p>Given a data vector, the function will compare the values to the specified threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>physics(x, nyu = 0, compare = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="physics_+3A_x">x</code></td>
<td>
<p>data vector</p>
</td></tr>
<tr><td><code id="physics_+3A_nyu">nyu</code></td>
<td>
<p>threshold, numeric</p>
</td></tr>
<tr><td><code id="physics_+3A_compare">compare</code></td>
<td>
<p>logical operation to apply over the threshold. 1: larger; 2: larger or equal; 3: smaller; 4: smaller or equal; 5 equal</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>x&lt;-rnorm(100)
x[10]&lt;-100
physics(x,5,1)
</code></pre>

<hr>
<h2 id='potpareto'>Peaks over threshold modelling</h2><span id='topic+potpareto'></span>

<h3>Description</h3>

<p>This function fits the Generalized Pareto distribution for exeedances over a threshold
</p>


<h3>Usage</h3>

<pre><code class='language-R'>potpareto(y, thres = 0.99)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="potpareto_+3A_y">y</code></td>
<td>
<p>vector of values (a series) to be analyzed</p>
</td></tr>
<tr><td><code id="potpareto_+3A_thres">thres</code></td>
<td>
<p>threshold value of probability to define a corresponding threshold percentile</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list containing results of modelling/fitting the generalized Pareto distribution
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D precipitation data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Fit the Generalized Pareto distribution
pato&lt;-potpareto(y)
#The parameters of the fitted distribution:
location&lt;-pato$threshold
shape&lt;-pato$estimate[2]
scale&lt;-pato$estimate[1]
print(c(location,shape,scale))
</code></pre>

<hr>
<h2 id='precip'>QC for Atmospheric Precipitation (RR)</h2><span id='topic+precip'></span>

<h3>Description</h3>

<p>This function will centralize precipitation-like QC routines. It will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>precip(
  element = "RR",
  large = 5000,
  small = 0,
  ret = 500,
  retornoracha = 500,
  margin = 20,
  friki = 150,
  blocksizeround = 20,
  blockmanymonth = 15,
  blockmanyyear = 180,
  limit = 1500,
  tolerance = 8,
  maxseq = 3,
  roundmax = 10,
  level = 15,
  window = 30,
  margina = 0.999,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="precip_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (RR for precipitation)</p>
</td></tr>
<tr><td><code id="precip_+3A_large">large</code></td>
<td>
<p>value above which the observation is considered physically impossible for the region</p>
</td></tr>
<tr><td><code id="precip_+3A_small">small</code></td>
<td>
<p>value below which the observation is considered physically impossible for the region</p>
</td></tr>
<tr><td><code id="precip_+3A_ret">ret</code></td>
<td>
<p>pseudo-return period for the pareto outliers</p>
</td></tr>
<tr><td><code id="precip_+3A_retornoracha">retornoracha</code></td>
<td>
<p>return period for the calculation of the maximum dry and wet spell</p>
</td></tr>
<tr><td><code id="precip_+3A_margin">margin</code></td>
<td>
<p>frequency difference between consecutive values for repeatedvalue()</p>
</td></tr>
<tr><td><code id="precip_+3A_friki">friki</code></td>
<td>
<p>minimum value to be considered by repeatedvalue()</p>
</td></tr>
<tr><td><code id="precip_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of repeated values with the same decimal, FUNCTION: roundprecip()</p>
</td></tr>
<tr><td><code id="precip_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="precip_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="precip_+3A_limit">limit</code></td>
<td>
<p>cut threshold for FUNCTION suspectacumprec()</p>
</td></tr>
<tr><td><code id="precip_+3A_tolerance">tolerance</code></td>
<td>
<p>number of NA or 0s before allowed before the limit, FUNCTION: suspectacumprec()</p>
</td></tr>
<tr><td><code id="precip_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, FUNCTION: flat() (11.1,11.1,11.1 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="precip_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part values, FUNCTION: flat() (10.0, 11.0, 12.0 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="precip_+3A_level">level</code></td>
<td>
<p>number of IQRs, FUNCTION: IQRoutliers()</p>
</td></tr>
<tr><td><code id="precip_+3A_window">window</code></td>
<td>
<p>number of days to be considered (including the target), FUNCTION: IQRoutliers()</p>
</td></tr>
<tr><td><code id="precip_+3A_margina">margina</code></td>
<td>
<p>a tolerance margin, expressed as quantile of the differences, FUNCTION: newfriki()</p>
</td></tr>
<tr><td><code id="precip_+3A_inisia">inisia</code></td>
<td>
<p>a logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for RR
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2rrlist&lt;-system.file("extdata", "ECA_blend_source_rr.txt", package = "INQC")
rrlist&lt;-readr::read_lines_raw(path2rrlist)
readr::write_lines(rrlist,'ECA_blend_source_rr.txt')
path2rrdata&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
rrdata&lt;-readr::read_lines_raw(path2rrdata)
readr::write_lines(rrdata, file=paste(wd,'/raw/RR_SOUID132730.txt',sep=''))
#Perform QC of Atmospheric Precipitation data
precip(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='putjulian'>Merges julian days</h2><span id='topic+putjulian'></span>

<h3>Description</h3>

<p>This function merges julian days to a yyyy,mm,dd and data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>putjulian(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="putjulian_+3A_x">x</code></td>
<td>
<p>data frame with year, month, day and data columns</p>
</td></tr>
</table>


<h3>Value</h3>

<p>the same data frame with added 1 column: year, month, day, julian and data
</p>


<h3>Examples</h3>

<pre><code class='language-R'>date&lt;-c('20201230','20201231','20210101')
value&lt;-c(-10,-12,-9)
df&lt;-data.frame(date,value)
year&lt;-as.numeric(substring(date,1,4))
month&lt;-as.numeric(substring(date,5,6))
day&lt;-as.numeric(substring(date,7,8))
x&lt;-data.frame(year,month,day,date,value)
y&lt;-putjulian(x)
</code></pre>

<hr>
<h2 id='readecad'>Reads an ECA&amp;D data/sources/stations file</h2><span id='topic+readecad'></span>

<h3>Description</h3>

<p>This function reads one ECA&amp;D file and puts it in yyyy/mm/dd/value. Data is NOT divided by 10, to transform it into true units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readecad(input = "SS_STAID000143.txt", missing = -9999)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readecad_+3A_input">input</code></td>
<td>
<p>ECA&amp;D filename</p>
</td></tr>
<tr><td><code id="readecad_+3A_missing">missing</code></td>
<td>
<p>missing value code, set to the default ECA&amp;D mvc</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data frame containing data (time series) from the ECA&amp;D file. An introductory part of the ECA&amp;D file with meta data information is skipped
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
#Read the data file
df&lt;-readecad(input=path2inptfl,missing= -9999) 
</code></pre>

<hr>
<h2 id='readheader'>Reads the header of an ECA&amp;D file</h2><span id='topic+readheader'></span>

<h3>Description</h3>

<p>This function reads one ECA&amp;D file and returns the header (an introductory part of the ECA&amp;D file), so it can be written in the same way
</p>


<h3>Usage</h3>

<pre><code class='language-R'>readheader(input = "SS_STAID000143.txt")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="readheader_+3A_input">input</code></td>
<td>
<p>ECA&amp;D filename</p>
</td></tr>
</table>


<h3>Value</h3>

<p>header of an ECA&amp;D file
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "CC_SOUID132727.txt", package = "INQC")
#Read the data file
head&lt;-readheader(input=path2inptfl)
</code></pre>

<hr>
<h2 id='relhum'>QC for Relative Humidity (HU)</h2><span id='topic+relhum'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. Will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>relhum(
  element = "HU",
  maxseq = 3,
  blocksizeround = 20,
  blockmanymonth = 15,
  blockmanyyear = 180,
  roundmax = 10,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="relhum_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (HU for relative humidity)</p>
</td></tr>
<tr><td><code id="relhum_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, for flat function (11.1,11.1,11.1 would be 3 consecutive values). Passed on to flat(). See ?flat for details</p>
</td></tr>
<tr><td><code id="relhum_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, FUNCTION: rounding()</p>
</td></tr>
<tr><td><code id="relhum_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="relhum_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="relhum_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part value, for flat function (10.0, 11.0, 12.0 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="relhum_+3A_inisia">inisia</code></td>
<td>
<p>a logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for HU
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2hulist&lt;-system.file("extdata", "ECA_blend_source_hu.txt", package = "INQC")
hulist&lt;-readr::read_lines_raw(path2hulist)
readr::write_lines(hulist,'ECA_blend_source_hu.txt')
path2hudata&lt;-system.file("extdata", "HU_SOUID132735.txt", package = "INQC")
hudata&lt;-readr::read_lines_raw(path2hudata)
readr::write_lines(hudata, file=paste(wd,'/raw/HU_SOUID132735.txt',sep=''))
#Perform QC of Relative Humidity data
relhum(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='repeatedvalue'>Finds repeated values</h2><span id='topic+repeatedvalue'></span>

<h3>Description</h3>

<p>This function looks for a value which repeats too many times and, given the decaying shape of
empirical distribution of precipitation data, is considered too large to happen that many times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>repeatedvalue(x, margin = 20, friki = 150)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="repeatedvalue_+3A_x">x</code></td>
<td>
<p>precipitation time series</p>
</td></tr>
<tr><td><code id="repeatedvalue_+3A_margin">margin</code></td>
<td>
<p>threshold for differences in frequency of the nearest value</p>
</td></tr>
<tr><td><code id="repeatedvalue_+3A_friki">friki</code></td>
<td>
<p>minimum of precipitation values to be considered</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
x&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Find all suspicious positions in the time series
repeatedvalue(x,margin=10,friki=10)
</code></pre>

<hr>
<h2 id='returnpotpareto'>Threshold percentile for the Pareto outliers</h2><span id='topic+returnpotpareto'></span>

<h3>Description</h3>

<p>This function returns a value of a threshold percentile for the Pareto outliers
</p>


<h3>Usage</h3>

<pre><code class='language-R'>returnpotpareto(pato, ret, w = 1.65)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="returnpotpareto_+3A_pato">pato</code></td>
<td>
<p>list with results of modelling/fitting the generalized Pareto distribution</p>
</td></tr>
<tr><td><code id="returnpotpareto_+3A_ret">ret</code></td>
<td>
<p>pseudo-return period (in yr)</p>
</td></tr>
<tr><td><code id="returnpotpareto_+3A_w">w</code></td>
<td>
<p>average sampling frequency (in 1/yr), a parameter to equate to return period to a temporal interval
(recall the approach is not block maxima but peak over threshold. Typical value of w to equate the return
period to years is 1.65 (See Wilks, 2011. Statistical Analysis for the Atmospheric Sciences)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>for a given Pareto distribution, returns the value (the quantile) representing a requested return period
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D precipitation data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,4]
#Fit the Generalized Pareto distribution
pato&lt;-potpareto(y)
#Define the quantile corresponding to the requested return period 25 years (ret=25)
returnpotpareto(pato,25)
#Define the quantile assuming the existence of 2 precipitation peaks/extreme values 
#every year (on average)
returnpotpareto(pato,25,w=2)
</code></pre>

<hr>
<h2 id='rounding'>Detects rounded sections</h2><span id='topic+rounding'></span>

<h3>Description</h3>

<p>This function splits data by month and looks if a decimal value is repeated too many times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rounding(y, blocksize = 20)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rounding_+3A_y">y</code></td>
<td>
<p>two columns with date in the ECA&amp;D format (yyyymmdd) and data</p>
</td></tr>
<tr><td><code id="rounding_+3A_blocksize">blocksize</code></td>
<td>
<p>maximum number of repeated values with the same decimal allowed on each block (blocks = months)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Introduce the rounding errors in first 50 data values
y[1:50,2]&lt;-round((y[1:50,2])/10)*10
#Find all suspicious positions in the time series
rounding(y,blocksize=20)
</code></pre>

<hr>
<h2 id='roundprecip'>Rounding in precipitation data</h2><span id='topic+roundprecip'></span>

<h3>Description</h3>

<p>This function splits data by month and looks if a decimal value is repeated too many times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roundprecip(y, blocksize = 20, exclude = 0)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roundprecip_+3A_y">y</code></td>
<td>
<p>two columns with date and data</p>
</td></tr>
<tr><td><code id="roundprecip_+3A_blocksize">blocksize</code></td>
<td>
<p>maximum number of repeated values with the same decimal</p>
</td></tr>
<tr><td><code id="roundprecip_+3A_exclude">exclude</code></td>
<td>
<p>value to be excluded (zero for precipitation)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Find all suspicious positions in the precipitation time series
roundprecip(y,blocksize=20,exclude=0) 
</code></pre>

<hr>
<h2 id='selepe'>QC for Atmospheric Pressure (PP)</h2><span id='topic+selepe'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. It will create a file in the folder QC
with an additional 0/1 column where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>selepe(
  element = "PP",
  large = 15000,
  small = 8000,
  maxjump = 2000,
  maxseq = 3,
  margina = 0.999,
  level = 5,
  window = 30,
  roundmax = 10,
  blockmanymonth = 15,
  blockmanyyear = 180,
  blocksizeround = 20,
  qjump = 0.999,
  tjump = 1.5,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="selepe_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (PP for sea level pressure)</p>
</td></tr>
<tr><td><code id="selepe_+3A_large">large</code></td>
<td>
<p>value above which the observation is considered physically impossible for the region</p>
</td></tr>
<tr><td><code id="selepe_+3A_small">small</code></td>
<td>
<p>value below which the observation is considered physically impossible for the region</p>
</td></tr>
<tr><td><code id="selepe_+3A_maxjump">maxjump</code></td>
<td>
<p>forcing for jumps2() in absolute mode (in the same units of the variable). Passed on to jumps2(). See ?jumps2 for further details.</p>
</td></tr>
<tr><td><code id="selepe_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, for flat function (11.1,11.1,11.1 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="selepe_+3A_margina">margina</code></td>
<td>
<p>tolerance margin, expressed as quantile of the differences, FUNCTION: newfriki(). Passed on to newfriki(). See ?newfriki for details</p>
</td></tr>
<tr><td><code id="selepe_+3A_level">level</code></td>
<td>
<p>number of IQRs for IQR outliers</p>
</td></tr>
<tr><td><code id="selepe_+3A_window">window</code></td>
<td>
<p>window, in days, for IQR outliers</p>
</td></tr>
<tr><td><code id="selepe_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part value, for flat function (10.0, 11.0, 12.0 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="selepe_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="selepe_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="selepe_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, for rounding function</p>
</td></tr>
<tr><td><code id="selepe_+3A_qjump">qjump</code></td>
<td>
<p>quantile for jumps2() in quantile mode. Passed on to jumps2(). See ?jumps2 for further details</p>
</td></tr>
<tr><td><code id="selepe_+3A_tjump">tjump</code></td>
<td>
<p>factor to multiply the quantile value for jumps2(). Passed on to jumps2(). See ?jumps2 for further details</p>
</td></tr>
<tr><td><code id="selepe_+3A_inisia">inisia</code></td>
<td>
<p>a logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for PP
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2pplist&lt;-system.file("extdata", "ECA_blend_source_pp.txt", package = "INQC")
pplist&lt;-readr::read_lines_raw(path2pplist)
readr::write_lines(pplist,'ECA_blend_source_pp.txt')
path2ppdata&lt;-system.file("extdata", "PP_SOUID132729.txt", package = "INQC")
ppdata&lt;-readr::read_lines_raw(path2ppdata)
readr::write_lines(ppdata, file=paste(wd,'/raw/PP_SOUID132729.txt',sep=''))
#Perform QC of Atmospheric Pressure data
selepe(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='snowdepth'>QC for Snow Depth (SD)</h2><span id='topic+snowdepth'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. It will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>snowdepth(
  element = "SD",
  maxseq = 20,
  blocksizeround = 20,
  blockmanymonth = 20,
  blockmanyyear = 200,
  large = 5000,
  exclude = 0,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="snowdepth_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (SD for snow depth)</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, FUNCTION: flat() (11.1,11.1,11.1 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, FUNCTION: rounding()</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_large">large</code></td>
<td>
<p>value above which the observation is considered physically impossible for the region, FUNCTION: physics()</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_exclude">exclude</code></td>
<td>
<p>value to be excluded from a function (in this case, 0 for flats)</p>
</td></tr>
<tr><td><code id="snowdepth_+3A_inisia">inisia</code></td>
<td>
<p>logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for SD
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2sdlist&lt;-system.file("extdata", "ECA_blend_source_sd.txt", package = "INQC")
sdlist&lt;-readr::read_lines_raw(path2sdlist)
readr::write_lines(sdlist,'ECA_blend_source_sd.txt')
path2sddata&lt;-system.file("extdata", "SD_SOUID132731.txt", package = "INQC")
sddata&lt;-readr::read_lines_raw(path2sddata)
readr::write_lines(sddata, file=paste(wd,'/raw/SD_SOUID132731.txt',sep=''))
#Perform QC of Snow Depth data
snowdepth(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='sunafterdark'>Maximum sunshine hours (only for &quot;non-blended&quot; ECA&amp;D data)</h2><span id='topic+sunafterdark'></span>

<h3>Description</h3>

<p>This function compares sunshine data to the maximum theoretical sunshine at an ECA&amp;D station,
according the day, lat and lon. Maximum sunshine hours are computed from the &quot;suncalc&quot; package, using
&quot;night&quot; and &quot;dawn&quot; parameters. This contrasts quite a lot with other functions computing &quot;daylength&quot;.
This formulation is more conservative
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sunafterdark(y, code = "991274")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sunafterdark_+3A_y">y</code></td>
<td>
<p>ECA&amp;D style two columns with date (yyyymmdd) and  values (expressed in 0.1 hours)</p>
</td></tr>
<tr><td><code id="sunafterdark_+3A_code">code</code></td>
<td>
<p>&quot;numeric&quot; part of the ECA&amp;D SOUID, expressed as character, to avoid trouble with leading zeroes</p>
</td></tr>
</table>


<h3>Details</h3>

<p>depends on either a previous execution of listas() or on a proper execution of listas() to run properly
</p>


<h3>Value</h3>

<p>vector with the list of positions which do not pass this test. If all positions pass the test, returns NULL
</p>


<h3>See Also</h3>

<p>listas()
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Extract the non-blended ECA&amp;D data and a station file from the example data folder
path2sslist&lt;-system.file("extdata", "ECA_blend_source_ss.txt", package = "INQC")
sslist&lt;-readr::read_lines_raw(path2sslist)
readr::write_lines(sslist,'ECA_blend_source_ss.txt')
path2ssdata&lt;-system.file("extdata", "SS_SOUID132728.txt", package = "INQC")
#Read the sunshine data
y&lt;-readecad(input=path2ssdata,missing= -9999)[,3:4]
options("homefolder"='./'); options("blend"=FALSE)
listonator(check=TRUE)
#Call sunafterdark()
sunafterdark(y,code='132728')
#Introduce error values in the sunshine data
y[1:10,2]&lt;-200
#Call sunafterdark()
sunafterdark(y,code='132728')
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='sundur'>QC for Sunshine Duration (SS)</h2><span id='topic+sundur'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. Will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sundur(
  element = "SS",
  maxseq = 3,
  blocksizeround = 20,
  blockmanymonth = 15,
  blockmanyyear = 180,
  roundmax = 10,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sundur_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (SS for sunshine duration)</p>
</td></tr>
<tr><td><code id="sundur_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, for flat function (11.1,11.1,11.1 would be 3 consecutive values). Passed on to flat(). See ?flat for details</p>
</td></tr>
<tr><td><code id="sundur_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, FUNCTION: rounding()</p>
</td></tr>
<tr><td><code id="sundur_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="sundur_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="sundur_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part value, for flat() function (10.0, 11.0, 12.0 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="sundur_+3A_inisia">inisia</code></td>
<td>
<p>logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for SS
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2sslist&lt;-system.file("extdata", "ECA_blend_source_ss.txt", package = "INQC")
sslist&lt;-readr::read_lines_raw(path2sslist)
readr::write_lines(sslist,'ECA_blend_source_ss.txt')
path2ssdata&lt;-system.file("extdata", "SS_SOUID132728.txt", package = "INQC")
ssdata&lt;-readr::read_lines_raw(path2ssdata)
readr::write_lines(ssdata, file=paste(wd,'/raw/SS_SOUID132728.txt',sep=''))
#Perform QC of Sunshine Duration data
sundur(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='suspectacumprec'>Detects precipitation values above limit</h2><span id='topic+suspectacumprec'></span>

<h3>Description</h3>

<p>This function detects values above limit preceded by a number of &quot;non precipitation days&quot;, given by tolerance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>suspectacumprec(datos, limit = 2000, tolerance = 10)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="suspectacumprec_+3A_datos">datos</code></td>
<td>
<p>two columns vector, date and data, in the ECA&amp;D format</p>
</td></tr>
<tr><td><code id="suspectacumprec_+3A_limit">limit</code></td>
<td>
<p>threshold/limit value for atmospheric precipitation</p>
</td></tr>
<tr><td><code id="suspectacumprec_+3A_tolerance">tolerance</code></td>
<td>
<p>how many consecutive days with 0 or NA you need to jump</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
datos&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Find all suspicious positions in the precipitation time series
suspectacumprec(datos,limit=2000,tolerance=10)
</code></pre>

<hr>
<h2 id='temperature'>QC for Air Temperature (TX/TN/TG)</h2><span id='topic+temperature'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. It will QC files for temperature. Reads all the temperature data in the
./raw folder (TX, TN or TG) and quality controls each of them. Notice that ECA&amp;D stores temperature in 1/10th of Celsius degrees when entering new parameter values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>temperature(
  element = "TX",
  large = 500,
  small = -500,
  maxjump = 200,
  maxseq = 3,
  margina = 0.999,
  level = 4,
  window = 11,
  roundmax = 10,
  blockmanymonth = 15,
  blockmanyyear = 180,
  blocksizeround = 20,
  qjump = 0.999,
  tjump = 1.5,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="temperature_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element ('TX' for daily maximum temperature,
'TN' for daily minimum temperature, 'TG' for daily mean temperature) passed as character string</p>
</td></tr>
<tr><td><code id="temperature_+3A_large">large</code></td>
<td>
<p>value above which the observation is considered physically impossible for the region. Defaulted to 500. Passed on to physics(). See ?physics for details</p>
</td></tr>
<tr><td><code id="temperature_+3A_small">small</code></td>
<td>
<p>value below which the observation is considered physically impossible for the region. Defaulted to -500. Passed on to physics(). See ?physics for details</p>
</td></tr>
<tr><td><code id="temperature_+3A_maxjump">maxjump</code></td>
<td>
<p>forcing for jumps2() in absolute mode (in the same units of the variable). Passed on to jumps2(). See ?jumps2 for further details</p>
</td></tr>
<tr><td><code id="temperature_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, for flat function (11.1,11.1,11.1 would be 3 consecutive values). Passed on to flat(). See ?flat for details</p>
</td></tr>
<tr><td><code id="temperature_+3A_margina">margina</code></td>
<td>
<p>tolerance margin, expressed as quantile of the differences, FUNCTION: newfriki(). Passed on to newfriki(). See ?newfriki for details</p>
</td></tr>
<tr><td><code id="temperature_+3A_level">level</code></td>
<td>
<p>number of IQRs for IQRoutliers()</p>
</td></tr>
<tr><td><code id="temperature_+3A_window">window</code></td>
<td>
<p>number of days to be considered (including the target), FUNCTION: IQRoutliers()</p>
</td></tr>
<tr><td><code id="temperature_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part value, for flat function (10.0, 11.0, 12.0 would be 3 consecutive value). Passed on to flat()</p>
</td></tr>
<tr><td><code id="temperature_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="temperature_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="temperature_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>the maximum number of repeated values with the same decimal, FUNCTION: roundprecip()</p>
</td></tr>
<tr><td><code id="temperature_+3A_qjump">qjump</code></td>
<td>
<p>quantile for jumps2() in quantile mode. Passed on to jumps2(). See ?jumps2 for further details</p>
</td></tr>
<tr><td><code id="temperature_+3A_tjump">tjump</code></td>
<td>
<p>factor to multiply the quantile value for jumps2(). Passed on to jumps2(). See ?jumps2 for further details</p>
</td></tr>
<tr><td><code id="temperature_+3A_inisia">inisia</code></td>
<td>
<p>logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for TX/TN/TG
</p>


<h3>See Also</h3>

<p>consolidator(), duplas(), flat(), IQRoutliers(), jumps2(), newfriki(), physics(), toomany(), rounding(), txtn(), weirdate()
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2tnlist&lt;-system.file("extdata", "ECA_blend_source_tn.txt", package = "INQC")
tnlist&lt;-readr::read_lines_raw(path2tnlist)
readr::write_lines(tnlist,'ECA_blend_source_tn.txt')
path2tndata&lt;-system.file("extdata", "TN_SOUID132733.txt", package = "INQC")
tndata&lt;-readr::read_lines_raw(path2tndata)
readr::write_lines(tndata, file=paste(wd,'/raw/TN_SOUID132733.txt',sep=''))
#Perform QC of Air Temperature data
temperature(element='TN',inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

<hr>
<h2 id='toomany'>Looks if a value is repeated too many times</h2><span id='topic+toomany'></span>

<h3>Description</h3>

<p>This function splits data by month and looks if a value is repeated too many times
</p>


<h3>Usage</h3>

<pre><code class='language-R'>toomany(y, blockmany = 15, scope = 1, exclude = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="toomany_+3A_y">y</code></td>
<td>
<p>two columns with date and data</p>
</td></tr>
<tr><td><code id="toomany_+3A_blockmany">blockmany</code></td>
<td>
<p>maximum number of repeated values in a month, year, or season</p>
</td></tr>
<tr><td><code id="toomany_+3A_scope">scope</code></td>
<td>
<p>monthly (1), annual (2)</p>
</td></tr>
<tr><td><code id="toomany_+3A_exclude">exclude</code></td>
<td>
<p>values to exclude, e.g. if precipitation, 0 must be excluded</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file (maximum air temperature) from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Introduce the errors in first 20 data values
y[1:20,2]&lt;-30
#Find all suspicious positions in the time series
toomany(y,blockmany=15,scope=1,exclude=NULL)

#Extract the ECA&amp;D data file (atmospheric precipitation) from the example data folder
path2inptfl&lt;-system.file("extdata", "RR_SOUID132730.txt", package = "INQC")
#Read the data file
y&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Introduce the errors in first 20 data values
y[1:20,2]&lt;-10
#Find all suspicious positions in the time series
toomany(y,blockmany=15,scope=1,exclude=0)
</code></pre>

<hr>
<h2 id='txtn'>Comparison of tx an tn data (for &quot;non-blended&quot; ECA&amp;D data)</h2><span id='topic+txtn'></span>

<h3>Description</h3>

<p>This function compares tx an tn data. First it looks for the closest station and then merges both
data frames. If one value is flagged, looks at the ecdfs of tx and tn. If the target variable (e.g tx) is central
(between quantiles 0.2 and 0.8) and the other variable (e.g. tn) is outside this range, the value is not flagged,
assuming the other variable is the culprit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>txtn(y, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txtn_+3A_y">y</code></td>
<td>
<p>two columns with date and data</p>
</td></tr>
<tr><td><code id="txtn_+3A_id">id</code></td>
<td>
<p>name of a file (&quot;xx_SOUIDxxxxxx.txt&quot;, non-blended) we are working with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, "raw"))
#Extract the non-blended ECA&amp;D data and station files from the example data folder
path2txlist&lt;-system.file("extdata", "ECA_blend_source_tx.txt", package = "INQC")
txlist&lt;-readr::read_lines_raw(path2txlist)
readr::write_lines(txlist,"ECA_blend_source_tx.txt")
path2txdata&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,"/raw/TX_SOUID132734.txt",sep=""))
path2tnlist&lt;-system.file("extdata", "ECA_blend_source_tn.txt", package = "INQC")
tnlist&lt;-readr::read_lines_raw(path2tnlist)
readr::write_lines(tnlist,"ECA_blend_source_tn.txt")
path2tndata&lt;-system.file("extdata", "TN_SOUID132733.txt", package = "INQC")
tndata&lt;-readr::read_lines_raw(path2tndata)
readr::write_lines(tndata, file=paste(wd,"/raw/TN_SOUID132733.txt",sep=""))
#Read the tn data
y&lt;-readecad(input=path2tndata,missing= -9999)[,3:4]
options("homefolder"="./"); options("blend"=FALSE)
listonator(check=TRUE)
#Call txtn()
txtn(y,"TN_SOUID132733.txt")
#Introduce error values in the tn data
y[c(1,3),2]&lt;-100
#Call txtn()
txtn(y,"TN_SOUID132733.txt")
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='txtnblend'>Comparison of tx an tn data (for &quot;blended&quot; ECA&amp;D data)</h2><span id='topic+txtnblend'></span>

<h3>Description</h3>

<p>This function first looks for the closest station and then merges both data frames.
If one value is flagged, looks at the ecdfs of tx and tn. If the target variable (e.g tx) is central
(between quantiles 0.2 and 0.8) and the other variable (e.g. tn) is outside this range, the value is
not flagged, assuming the other variable is the culprit
</p>


<h3>Usage</h3>

<pre><code class='language-R'>txtnblend(y, id)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="txtnblend_+3A_y">y</code></td>
<td>
<p>two columns with date and data</p>
</td></tr>
<tr><td><code id="txtnblend_+3A_id">id</code></td>
<td>
<p>name of a file (&quot;xx_STAIDxxxxxx.txt&quot;, blended) we are working with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir(); wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, "raw"))
#Extract the blended ECA&amp;D data and station files from the example data folder
path2list&lt;-system.file("extdata", "stations.txt", package = "INQC")
list&lt;-readr::read_lines_raw(path2list)
readr::write_lines(list,file=paste(wd,"/raw/stations.txt",sep=""))
path2txdata&lt;-system.file("extdata", "TX_STAID000002.txt", package = "INQC")
txdata&lt;-readr::read_lines_raw(path2txdata)
readr::write_lines(txdata, file=paste(wd,"/raw/TX_STAID000002.txt",sep=""))
path2tndata&lt;-system.file("extdata", "TN_STAID000002.txt", package = "INQC")
tndata&lt;-readr::read_lines_raw(path2tndata)
readr::write_lines(tndata, file=paste(wd,"/raw/TN_STAID000002.txt",sep=""))
#Read the tn data
y&lt;-readecad(input=path2tndata,missing= -9999)[,3:4]
options("homefolder"="./")
#Call txtnblend()
txtnblend(y,"TN_STAID000002.txt")
#Introduce error values in the tn data
y[c(1,3),2]&lt;-100
#Call txtnblend()
txtnblend(y,"TN_STAID000002.txt")
#Return to user's working directory:
setwd(wd0)
</code></pre>

<hr>
<h2 id='weirddate'>Locate impossible dates</h2><span id='topic+weirddate'></span>

<h3>Description</h3>

<p>This function is intended to flag impossible dates (e.g., 19990230 or 29990112, etc)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weirddate(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="weirddate_+3A_x">x</code></td>
<td>
<p>two-columns dataframe. First column is date in the ECA&amp;D format (yyyymmdd), second columns is value</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list of positions which do not pass this QC test. If all positions pass the test, returns NULL
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Extract the ECA&amp;D data file from the example data folder
path2inptfl&lt;-system.file("extdata", "TX_SOUID132734.txt", package = "INQC")
#Read the data file
x&lt;-readecad(input=path2inptfl,missing= -9999)[,3:4]
#Find all suspicious positions in the time series
weirddate(x)

#Introduce the weird dates
x[31,1]&lt;-'19610132'
#Find all suspicious positions in the time series
weirddate(x) 
</code></pre>

<hr>
<h2 id='windspeed'>QC for Wind Speed (FG)</h2><span id='topic+windspeed'></span>

<h3>Description</h3>

<p>This function will centralize temperature-like QC routines. It will create a file in the folder QC
with an additional 0/1 column, where &quot;1&quot; means test failed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>windspeed(
  element = "FG",
  maxseq = 3,
  blocksizeround = 20,
  blockmanymonth = 20,
  blockmanyyear = 200,
  large = 3000,
  roundmax = 10,
  level = 5,
  window = 30,
  ret = 500,
  margina = 0.999,
  inisia = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="windspeed_+3A_element">element</code></td>
<td>
<p>two-letters ECA&amp;D code for the element (e.g., FG for wind speed)</p>
</td></tr>
<tr><td><code id="windspeed_+3A_maxseq">maxseq</code></td>
<td>
<p>maximum number of consecutive repeated values, FUNCTION: flat  (11.1,11.1,11.1 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="windspeed_+3A_blocksizeround">blocksizeround</code></td>
<td>
<p>maximum number of values in a month with the same decimal, FUNCTION: rounding()</p>
</td></tr>
<tr><td><code id="windspeed_+3A_blockmanymonth">blockmanymonth</code></td>
<td>
<p>maximum number of equal values in a month, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="windspeed_+3A_blockmanyyear">blockmanyyear</code></td>
<td>
<p>maximum number of equal values in a year, FUNCTION: toomany()</p>
</td></tr>
<tr><td><code id="windspeed_+3A_large">large</code></td>
<td>
<p>value above which the observation is considered physically impossible for the region, FUNCTION: physics()</p>
</td></tr>
<tr><td><code id="windspeed_+3A_roundmax">roundmax</code></td>
<td>
<p>maximum number of consecutive decimal part value, for flat function (10.0, 11.0, 12.0 would be 3 consecutive values)</p>
</td></tr>
<tr><td><code id="windspeed_+3A_level">level</code></td>
<td>
<p>number of IQRs for IQR outliers</p>
</td></tr>
<tr><td><code id="windspeed_+3A_window">window</code></td>
<td>
<p>window, in days, for IQR outliers</p>
</td></tr>
<tr><td><code id="windspeed_+3A_ret">ret</code></td>
<td>
<p>pseudo-return period for the Pareto outliers</p>
</td></tr>
<tr><td><code id="windspeed_+3A_margina">margina</code></td>
<td>
<p>quantile for newfriki function</p>
</td></tr>
<tr><td><code id="windspeed_+3A_inisia">inisia</code></td>
<td>
<p>a logical flag. If it is TRUE inithome() will be called</p>
</td></tr>
</table>


<h3>Value</h3>

<p>results of QC for FG
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#Set a temporal working directory:
wd &lt;- tempdir()
wd0 &lt;- setwd(wd)
#Create subdirectory where raw data files have to be located
dir.create(file.path(wd, 'raw'))
options("homefolder"='./'); options("blend"=FALSE)
#Extract the ECA&amp;D data and station files from the example data folder
path2fglist&lt;-system.file("extdata", "ECA_blend_source_fg.txt", package = "INQC")
fglist&lt;-readr::read_lines_raw(path2fglist)
readr::write_lines(fglist,'ECA_blend_source_fg.txt')
path2fgdata&lt;-system.file("extdata", "FG_SOUID132736.txt", package = "INQC")
fgdata&lt;-readr::read_lines_raw(path2fgdata)
readr::write_lines(fgdata, file=paste(wd,'/raw/FG_SOUID132736.txt',sep=''))
#Perform QC of Wind Speed data
windspeed(inisia=TRUE)
#Remove some temporary files
list = list.files(pattern = "Rfwf")
file.remove(list)
#Return to user's working directory:
setwd(wd0)
#The QC results can be found in the directory:
print(wd)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
