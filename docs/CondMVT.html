<!DOCTYPE html><html><head><title>Help for package CondMVT</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {CondMVT}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#CondMVT'><p>Conditional Location Vector, Scatter Matrix, and Degrees of Freedom of Multivariate t Distribution</p></a></li>
<li><a href='#dcmvt'><p>Conditional Multivariate t Density and Random Deviates</p></a></li>
<li><a href='#EM_msteps'><p>Data Imputation Using EM (Multiple Iterations; Degrees of Freedom Known)</p></a></li>
<li><a href='#EM_onestep'><p>Data Imputation Using EM (Single Iteration; Degrees of Freedom Known)</p></a></li>
<li><a href='#EM_Umsteps'><p>Data Imputation Using EM (Multiple Iterations, Degrees of Freedom Unknown)</p></a></li>
<li><a href='#EM_Uonestep'><p>Data Imputation Using EM (Single Iteration, Degrees of Freedom Unknown)</p></a></li>
<li><a href='#MISS'><p>Creating Missing Values at Random in Multivariate Datasets</p>
</p></a></li>
<li><a href='#pcmvt'><p>Conditional Multivariate t Distribution</p></a></li>
<li><a href='#rcmvt'><p>Conditional Multivariate t Density and Random Deviates</p></a></li>
<li><a href='#SMCEM_msteps'><p>Data Imputation Using SEM and MCEM (Multiple Iterations, Degrees of Freedom Known)</p>
</p></a></li>
<li><a href='#SMCEM_onestep'><p>Data Imputation Using SEM and MCEM (Single Iteration, Degrees of Freedom Known)</p></a></li>
<li><a href='#SMCEM_Umsteps'><p>Data Imputation Using SEM and MCEM (Multiple Iterations; Degrees of Freedom Unknown)</p>
</p></a></li>
<li><a href='#SMCEM_Uonestep'><p>Data Imputation Using SEM and MCEM (Single Iteration; Degrees of Freedom Unknown)</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Conditional Multivariate t Distribution, Expectation
Maximization Algorithm, and Its Stochastic Variants</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.0</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Paul Kinyanjui &lt;kinyanjui.access@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes conditional multivariate t probabilities, random deviates, and densities. It can also be used to create missing values at random in a dataset, resulting in a missing at random (MAR) mechanism. Inbuilt in the package are the Expectation-Maximization (EM), Monte Carlo EM, and Stochastic EM algorithms for imputation of missing values in datasets assuming the multivariate t distribution. See Kinyanjui, Tamba, Orawo, and Okenye (2020)&lt;<a href="https://doi.org/10.3233%2Fmas-200493">doi:10.3233/mas-200493</a>&gt;, and Kinyanjui, Tamba, and Okenye(2021)<a href="http://www.ceser.in/ceserp/index.php/ijamas/article/view/6726/0">http://www.ceser.in/ceserp/index.php/ijamas/article/view/6726/0</a> for more details. </td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.1.0</td>
</tr>
<tr>
<td>Imports:</td>
<td>stats, mvtnorm</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-06-26 20:52:27 UTC; Lenovo</td>
</tr>
<tr>
<td>Author:</td>
<td>Paul Kinyanjui [aut, cre],
  Cox Tamba [aut],
  Justin Okenye [aut],
  Luke Orawo [ctb]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-06-28 07:20:08 UTC</td>
</tr>
</table>
<hr>
<h2 id='CondMVT'>Conditional Location Vector, Scatter Matrix, and Degrees of Freedom of Multivariate t Distribution</h2><span id='topic+CondMVT'></span>

<h3>Description</h3>

<p>These functions provide the conditional location vector, scatter matrix, and degrees of freedom of [Y given X], where Z = (X,Y)
is the fully-joint multivariate t distribution with location vector equal to mean, scatter matrix sigma, and degrees of freedom df. For more details on the computation of the parameters and their respective formulae, see Roth (2013).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CondMVT(mean, sigma, df, dependent.ind, given.ind, X.given,
  check.sigma = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="CondMVT_+3A_mean">mean</code></td>
<td>
<p>location vector, which must be specified.</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_sigma">sigma</code></td>
<td>
<p>a symmetric, positive-definte matrix of dimension n x n, which must be specified.</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditoning variable X.</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. When both given.ind and X.given are missing, the distribution of Y becomes Z[dependent.ind]</p>
</td></tr>
<tr><td><code id="CondMVT_+3A_check.sigma">check.sigma</code></td>
<td>
<p>logical; if TRUE, the scatter matrix is checked for appropriateness (symmetry, positive-definiteness). This could be set to FALSE if the user knows it is appropriate.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns the conditional location vector (<code>condMean</code>), conditional scatter matrix (<code>condVar</code>), and the conditional degrees of freedom (<code>cond_df</code>) for the multvariate t distribution. 
</p>


<h3>References</h3>

<p>Roth, M. (2013). On the multivariate t-distribution, Tech Rep.
</p>


<h3>Examples</h3>

<pre><code class='language-R'> # 10-dimensional multivariate normal distribution
 n &lt;- 10
 df=3
 A &lt;- matrix(rt(n^2,df), n, n)
 A &lt;- tcrossprod(A,A) #A %*% t(A)
 CondMVT(mean=rep(1,n), sigma=A, df=df, dependent=c(2,3,5), given=c(1,4,7,9),X.given=c(1,1,0,-1))
 CondMVT(mean=rep(1,n), sigma=A, df=df, dep=3, given=c(1,4,7,9), X=c(1,1,0,-1))

</code></pre>

<hr>
<h2 id='dcmvt'>Conditional Multivariate t Density and Random Deviates
</h2><span id='topic+dcmvt'></span>

<h3>Description</h3>

<p>This function provides the density function for the conditional multivariate t distribution, [Y given X], where Z = (X,Y) is the fully-joint multivariate t distribution with location vector (or mode) equal to mean and covariance matrix sigma.</p>


<h3>Usage</h3>

<pre><code class='language-R'>dcmvt(x, mean, sigma,df, dependent.ind, given.ind, X.given, check.sigma=TRUE, log = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dcmvt_+3A_x">x</code></td>
<td>
<p>vector or matrix of quantiles of Y. If x is a matrix, each row is taken to be a quantile.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_mean">mean</code></td>
<td>
<p>location vector, which must be specified.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_sigma">sigma</code></td>
<td>
<p>a symmetric, positive-definte matrix of dimension n x n, which must be specified.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditoning variable X.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. When both given.ind and X.given are missing, the distribution of Y becomes Z[dependent.ind]</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_check.sigma">check.sigma</code></td>
<td>
<p>logical; if TRUE, the scatter matrix is checked for appropriateness (symmetry, positive-definiteness). This could be set to FALSE if the user knows it is appropriate.</p>
</td></tr>
<tr><td><code id="dcmvt_+3A_log">log</code></td>
<td>
<p>logical; if TRUE, densities d are given as log(d).</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>numeric</code>
</p>


<h3>References</h3>

<p>Genz, A. and Bretz, F. (2009), Computation of Multivariate Normal and t Probabilities. Lecture Notes in Statistics, Vol. 195. Springer-Verlag, Heidelberg.
</p>
<p>S. Kotz and S. Nadarajah (2004), Multivariate t Distributions and Their Applications. Cambridge University Press. Cambridge.</p>


<h3>Examples</h3>

<pre><code class='language-R'># 10-dimensional multivariate t distribution
n &lt;- 10
df=3
A &lt;- matrix(rt(n^2,df), n, n)
A &lt;- tcrossprod(A,A) #A %*% t(A)

# density of Z[c(2,5)] given Z[c(1,4,7,9)]=c(1,1,0,-1)
dcmvt(x=c(1.2,-1), mean=rep(1,n), sigma=A,dependent.ind=c(2,5),df=df, given.ind=c(1,4,7,9),
X.given=c(1,1,0,-1))

dcmvt(x=-1, mean=rep(1,n), sigma=A,df=df, dep=3, given=c(1,4,7,9,10), X=c(1,1,0,0,-1))
dcmvt(x=c(1.2,-1), mean=rep(1,n), sigma=A,df=df, dep=c(2,5))

# gives an error since `x' and `dep' are incompatibe
#dcmvt(x=-1, mean=rep(1,n), sigma=A,df=df, dep=c(2,3),
#      given=c(1,4,7,9,10), X=c(1,1,0,0,-1))

rcmvt(n=10, mean=rep(1,n), sigma=A,df=df, dep=c(2,5),
         given=c(1,4,7,9,10), X=c(1,1,0,0,-1),type="shifted",
         method="eigen")

rcmvt(n=10, mean=rep(1,n), sigma=A,df=df, dep=3,
         given=c(1,4,7,9,10), X=c(1,1,0,0,-1),type="Kshirsagar",
         method="chol")
</code></pre>

<hr>
<h2 id='EM_msteps'>Data Imputation Using EM (Multiple Iterations; Degrees of Freedom Known)
</h2><span id='topic+EM_msteps'></span>

<h3>Description</h3>

<p>The sub-package contains subroutines for imputation of missing values as well as parameter estimation (for the location vector and the scatter matrix) in multivariate t distribution using the Expectation Maximization (EM) algorithm when the degrees of freedom are known. EM algorithm iteratively imputes the missing values and computes the estimates for the multivariate t parameters in two steps (E-step and M-step) as explained in Kinyanjui et al. (2021). For a single iteration, the function <code>EM_onestep</code> is run. For multiple iterations, the function <code>EM_msteps</code> is run. The function <code>LIKE</code> (specifying the likelihood) facilitates the setting of tolerance level for convergence of the algorithm (that is <code class="reqn">L(\theta^{t+1})-L(\theta^{t})\leq{\delta}</code>, where <code class="reqn">\delta</code> is a set tolerance level and t denotes the number of iterations).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_msteps(Y,mu,Sigma,df,K,error)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_msteps_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="EM_msteps_+3A_mu">mu</code></td>
<td>
<p>the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_msteps_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_msteps_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="EM_msteps_+3A_k">K</code></td>
<td>
<p>the number of iterations, which must be specified.</p>
</td></tr>
<tr><td><code id="EM_msteps_+3A_error">error</code></td>
<td>
<p>tolerance level for convergence of the EM algorithm.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset (with imputed values), updated location vector, and scatter matrix. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P.K., Tamba, C.L., &amp; Okenye, J.O. (2021). Missing Data Imputation in a t -Distribution with Known Degrees of Freedom Via Expectation Maximization Algorithm and Its Stochastic Variants. International Journal of Applied Mathematics and Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 10
p=3
df=3
mu=c(1:3)
A &lt;- matrix(rt(p^2,df), p, p)
A &lt;- tcrossprod(A,A) #A %*% t(A)

Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (EM)
EM1=EM_onestep(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df)

#Multiple Iterations (EM)
EM=EM_msteps(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=3,K=1000,error=0.00001)

#Results for Newly Completed Dataset (EM)
EM$IMP   #Newly completed Dataset (with imputed values)
EM$mu	   #updated location vector
EM$Sigma #updated scatter matrix
EM$K1	#number of iterations the algorithm takes to converge

</code></pre>

<hr>
<h2 id='EM_onestep'>Data Imputation Using EM (Single Iteration; Degrees of Freedom Known)
</h2><span id='topic+EM_onestep'></span>

<h3>Description</h3>

<p>The sub-package contains subroutines for imputation of missing values as well as parameter estimation (for the location vector and the scatter matrix) in multivariate t distribution using the Expectation Maximization (EM) algorithm when the degrees of freedom are known. EM algorithm imputes the missing values and computes the estimates for the multivariate t parameters in two steps (E-step and M-step) as explained in Kinyanjui et al. (2021). For a single iteration, the function EM_onestep is run.Arbitrary starting values are supplied to initiate the algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_onestep(Y,mu,Sigma,df)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_onestep_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="EM_onestep_+3A_mu">mu</code></td>
<td>
<p>the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_onestep_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_onestep_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
</table>
<p>algorithm.
</p>


<h3>Value</h3>

<p>Completed dataset (with imputed values), updated location vector, and scatter matrix. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P.K., Tamba, C.L., &amp; Okenye, J.O. (2021). Missing Data Imputation in a t -Distribution with Known Degrees of Freedom Via Expectation Maximization Algorithm and Its Stochastic Variants. International Journal of Applied Mathematics and Statistics.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 10
p=3
df=3
mu=c(1:3)
A &lt;- matrix(rt(p^2,df), p, p)
A &lt;- tcrossprod(A,A) #A %*% t(A)

Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (EM)
EM1=EM_onestep(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df)

#Results for Newly Completed Dataset (EM)
EM1$Y2    #Newly completed Dataset (with imputed values)
EM1$mu	  #updated location vector
EM1$Sigma #updated scatter matrix

</code></pre>

<hr>
<h2 id='EM_Umsteps'>Data Imputation Using EM (Multiple Iterations, Degrees of Freedom Unknown)
</h2><span id='topic+EM_Umsteps'></span>

<h3>Description</h3>

<p>This sub-package constitutes the subroutines for EM algorithm (for multiple iterations). It has 2 functions namely <code>LIKE</code> and <code>EM_Umsteps</code>.  The function <code>EM_Umsteps</code> carries out missing data imputation as well as parameter estimation in multivariate t distribution in multiple iterations; assuming that the degrees of freedom are unknown. In addition to updating the location vector and the scatter matrix, therefore, the function also finds an estimate for the degrees of freedom. The bisection method is employed in the algorithm to iteratively update the degrees of freedom.The function <code>LIKE</code> (specifying the likelihood) facilitates the setting of tolerance level for convergence of the EM algorithm (that is <code class="reqn">L(\theta^{t+1})-L(\theta^{t})\leq{\delta}</code>, where <code class="reqn">\delta</code> is a set tolerance level and t denotes the number of iterations).Details of how EM works in light of unknown degrees of freedom can be found in Kinyanjui et al. (2020) and Liu and Rubin (1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_Umsteps(Y,mu,Sigma,df,K,e,error)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_Umsteps_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_sigma">Sigma</code></td>
<td>
<p>Scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_e">e</code></td>
<td>
<p>tolerance level for convergence of the bisection method for estimation of df. </p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_error">error</code></td>
<td>
<p>tolerance level for convergence of the EM algorithm. </p>
</td></tr>
<tr><td><code id="EM_Umsteps_+3A_k">K</code></td>
<td>
<p>the number of iterations, which must be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector,scatter matrix, and degrees of freedom. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P. K., Tamba, C. L., Orawo, L. A. O., &amp; Okenye, J. O. (2020). Missing data imputation in multivariate t distribution with unknown degrees of freedom using expectation maximization algorithm and its stochastic variants. Model Assisted Statistics and Applications, 15(3), 263-272.
</p>
<p>Liu, C. and Rubin, D. B. (1995). ML estimation of the t distribution using EM and its extensions, ECM and ECME. Statistica Sinica, 19-39.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# 3-dimensional multivariate t distribution
n &lt;- 25
p=3
df=3
mu=c(10,20,30)
A=matrix(c(14,10,12,10,13,9,12,9,18), 3,3)
Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)
df_stat=6

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (EM)
EMU1=EM_Uonestep (Y=Y8,mu=mu,Sigma= Sigma_stat,df= df_stat,e=0.00001)

#Multiple Iterations (EM)
EMU=EM_Umsteps(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df_stat,K=1000,e=0.00001,error=0.00001)

#Results for Newly Completed Dataset (EM)
EMU$IMP #Newly completed Dataset (with imputed values)
EMU$mu   #updated location vector
EMU$Sigma #updated scatter matrix
EMU$df	    #Updated degrees of freedom.
EMU$K1	#number of iterations the algorithm takes to converge

</code></pre>

<hr>
<h2 id='EM_Uonestep'>Data Imputation Using EM (Single Iteration, Degrees of Freedom Unknown)
</h2><span id='topic+EM_Uonestep'></span>

<h3>Description</h3>

<p>This sub-package constitutes the subroutines for EM algorithm (for a single iteration). It has 4 functions namely <code>fun1</code>, <code>dfun1</code>, <code>Bisec</code>, and <code>EM_Uonestep</code>. The function EM_Uonestep carries out missing data imputation as well as parameter estimation in multivariate t distribution in one iteration; assuming that the degrees of freedom are unknown. In addition to updating the location vector and the scatter matrix, therefore, the function also finds an estimate for the degrees of freedom. The bisection method is employed in the algorithm to iteratively update the degrees of freedom. In this respect, function <code>fun1</code> specifies the degrees of freedom equation to be solved. <code>dfun1</code> is its derivative. The two functions (<code>fun1</code> and <code>dfun1</code>) are then solved numerically using the bisection method as specified in the function <code>Bisec</code>.Details of how EM works in light of unknown degrees of freedom can be found in Kinyanjui et al. (2020) and Liu and Rubin (1995).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>EM_Uonestep(Y,mu,Sigma,df,e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="EM_Uonestep_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="EM_Uonestep_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_Uonestep_+3A_sigma">Sigma</code></td>
<td>
<p>Scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="EM_Uonestep_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="EM_Uonestep_+3A_e">e</code></td>
<td>
<p>tolerance level for convergence of the bisection method for estimation of df. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector,scatter matrix, and degrees of freedom. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P. K., Tamba, C. L., Orawo, L. A. O., &amp; Okenye, J. O. (2020). Missing data imputation in multivariate t distribution with unknown degrees of freedom using expectation maximization algorithm and its stochastic variants. Model Assisted Statistics and Applications, 15(3), 263-272.
</p>
<p>Liu, C., &amp; Rubin, D. B. (1995). ML estimation of the t distribution using EM and its extensions, ECM and ECME. Statistica Sinica, 19-39.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 25
p=3
df=3
mu=c(10,20,30)
A=matrix(c(14,10,12,10,13,9,12,9,18), 3,3)
Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)
df_stat=6

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (EM)
EMU1=EM_Uonestep (Y=Y8,mu=mu,Sigma= Sigma_stat,df= df_stat,e=0.00001)

#Results for Newly Completed Dataset (EM)
EMU1$Y2    #Newly completed Dataset (with imputed values)
EMU1$mu	   #updated location vector
EMU1$Sigma #updated scatter matrix
EMU1$df
</code></pre>

<hr>
<h2 id='MISS'>Creating Missing Values at Random in Multivariate Datasets
</h2><span id='topic+MISS'></span>

<h3>Description</h3>

<p>This function randomly creates missing values in a multivariate dataset. The resultant missing data mechanism is missing at random (MAR). The percentage of missingness has to be specified. This percentage is computed as a proportion of the sample size. In addition, the function allows for more than one missing value in any given case. It is set such that in a <code class="reqn">p</code>-variate dataset, for any <code class="reqn">i^{th}</code> case, the maximum allowable number of missing values is <code class="reqn">p-1</code>. This helps avoid a situation where a case has no observed value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>MISS (TT, Percent)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="MISS_+3A_tt">TT</code></td>
<td>
<p>n×p complete dataset.</p>
</td></tr>
<tr><td><code id="MISS_+3A_percent">Percent</code></td>
<td>
<p>the proportion of missing values, which must be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Data <code>Y</code> of size <code>n×p</code>  with missing values (<code>NA</code>) created at random. The missing values are logical in nature. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 10
p=3
df=3
mu=c(1:3)
A &lt;- matrix(rt(p^2,df), p, p)
A &lt;- tcrossprod(A,A) #A %*% t(A)

Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8  
</code></pre>

<hr>
<h2 id='pcmvt'>Conditional Multivariate t Distribution
</h2><span id='topic+pcmvt'></span>

<h3>Description</h3>

<p>Computes the distribution function of the conditional multivariate t, [Y given X], where Z = (X,Y) is the fully-joint multivariate t distribution with mean equal to location vector, df equal to degrees of freedom and scatter matrix sigma. Computations are based on algorithms by Genz and Bretz.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pcmvt(lower = -Inf, upper = Inf, mean, sigma, df, dependent.ind, given.ind, X.given,
check.sigma = TRUE, algorithm = GenzBretz(), ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pcmvt_+3A_lower">lower</code></td>
<td>

<p>the vector of lower limits of length n.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_upper">upper</code></td>
<td>

<p>the vector of upper limits of length n.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_mean">mean</code></td>
<td>

<p>the mean vector of length n.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_sigma">sigma</code></td>
<td>

<p>a symmetric, positive-definte matrix, of dimension n x n, which must be specified.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_df">df</code></td>
<td>

<p>degrees of freedom, which must be specified.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_dependent.ind">dependent.ind</code></td>
<td>

<p>a vector of integers denoting the indices of the dependent variable Y.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_given.ind">given.ind</code></td>
<td>

<p>a vector of integers denoting the indices of the conditioning variable X.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_x.given">X.given</code></td>
<td>

<p>a vector of reals denoting the conditioning value of X. When both given.ind and X.given are missing, the distribution of Y becomes Z[dependent.ind]
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_check.sigma">check.sigma</code></td>
<td>

<p>logical; if TRUE, the variance-covariance matrix is checked for appropriateness (symmetry, positive-definiteness). This could be set to FALSE if the user knows it is appropriate.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_algorithm">algorithm</code></td>
<td>

<p>an object of class GenzBretz, Miwa or TVPACK specifying both the algorithm to be used as well as the associated hyper parameters.
</p>
</td></tr>
<tr><td><code id="pcmvt_+3A_...">...</code></td>
<td>

<p>additional parameters (currently given to GenzBretz for backward compatibility issues).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This program involves the computation of multivariate t probabilities with arbitrary correlation matrices.
</p>


<h3>Value</h3>

<p>The evaluated distribution function is returned with attributes
</p>
<table>
<tr><td><code>error</code></td>
<td>
<p>estimated absolute error and</p>
</td></tr>
<tr><td><code>msg</code></td>
<td>
<p>Normal Completion</p>
</td></tr>
</table>


<h3>References</h3>

<p>Genz, A. and Bretz, F. (1999), Numerical computation of multivariate t-probabilities with application to power calculation of multiple contrasts. Journal of Statistical Computation and Simulation, 63, 361–378.
</p>
<p>Genz, A. and Bretz, F. (2002), Methods for the computation of multivariate t-probabilities. Journal of Computational and Graphical Statistics, 11, 950–971.
</p>
<p>Genz, A. (2004), Numerical computation of rectangular bivariate and trivariate normal and t-probabilities, Statistics and Computing, 14, 251–260.
</p>
<p>Genz, A. and Bretz, F. (2009), Computation of Multivariate Normal and t Probabilities. Lecture Notes in Statistics, Vol. 195. Springer-Verlag, Heidelberg.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+dcmvt">dcmvt</a>()</code>,<code><a href="#topic+rcmvt">rcmvt</a>()</code>,<code><a href="mvtnorm.html#topic+pmvt">pmvt</a>()</code>,<code><a href="mvtnorm.html#topic+GenzBretz">GenzBretz</a>()</code></p>


<h3>Examples</h3>

<pre><code class='language-R'>n &lt;- 10
df=3
A &lt;- matrix(rt(n^2,df), n, n)
A &lt;- tcrossprod(A,A) #A %*% t(A)

pcmvt(lower=-Inf, upper=1, mean=rep(1,n), sigma=A, df=df,	dependent.ind=3, 
      given.ind=c(1,4,7,9,10), X.given=c(1,1,0,0,-1))


pcmvt(lower=-Inf, upper=c(1,2), mean=rep(1,n),
      sigma=A,df=df, dep=c(2,5), given=c(1,4,7,9,10),
      X=c(1,1,0,0,-1))

pcmvt(lower=-Inf, upper=c(1,2), mean=rep(1,n), sigma=A,df=df,
      dep=c(2,5))
</code></pre>

<hr>
<h2 id='rcmvt'>Conditional Multivariate t Density and Random Deviates
</h2><span id='topic+rcmvt'></span>

<h3>Description</h3>

<p>This function provides the random number generator for the conditional multivariate t distribution, [Y given X], where Z = (X,Y) is the fully-joint multivariate t distribution with location vector equal to mean and scatter matrix sigma.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rcmvt(n, mean, sigma, df,dependent.ind, given.ind, X.given,
check.sigma = TRUE,type = c("Kshirsagar", "shifted"),
method = c("eigen", "svd", "chol"))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rcmvt_+3A_n">n</code></td>
<td>
<p>number of random deviates.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_mean">mean</code></td>
<td>
<p>location vector, which must be specified.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_sigma">sigma</code></td>
<td>
<p>a symmetric, positive-definte matrix of dimension n x n, which must be specified.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_dependent.ind">dependent.ind</code></td>
<td>
<p>a vector of integers denoting the indices of dependent variable Y.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_given.ind">given.ind</code></td>
<td>
<p>a vector of integers denoting the indices of conditoning variable X.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_x.given">X.given</code></td>
<td>
<p>a vector of reals denoting the conditioning value of X. When both given.ind and X.given are missing, the distribution of Y becomes Z[dependent.ind]</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_check.sigma">check.sigma</code></td>
<td>
<p>logical; if <code>TRUE</code>, the scatter matrix is checked for appropriateness (symmetry, positive-definiteness). This could be set to <code>FALSE</code> if the user knows it is appropriate.</p>
</td></tr>
<tr><td><code id="rcmvt_+3A_type">type</code></td>
<td>
<p>type of the noncentral multivariate t-distribution. <code>type = "Kshirsagar"</code> corresponds to formula (1.4) in Genz and Bretz (2009) (see also Chapter 5.1 in Kotz and Nadarajah (2004)).
This is the noncentral t-distribution needed for calculating the power of multiple contrast tests under a normality assumption. <code>type = "shifted"</code> corresponds to the formula right before
formula (1.4) in Genz and Bretz (2009) (see also formula (1.1) in Kotz and Nadarajah (2004)). It is a location shifted version of the central t-distribution. This noncentral 
multivariate t-distribution appears for example as the Bayesian posterior distribution for the regression coefficients in a linear regression. In the central case both types coincide.</p>
</td></tr> 
<tr><td><code id="rcmvt_+3A_method">method</code></td>
<td>
<p>string specifying the matrix decomposition used to determine the matrix root of <code>sigma</code>. Possible methods are eigenvalue decomposition (<code>"eigen"</code>, default), singular value decomposition (<code>"svd"</code>), and Cholesky decomposition (<code>"chol"</code>). The Cholesky is typically fastest, not by much though.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>'vector'</code> of length <code>n</code>, equal to the length of <code>'mean'</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 10-dimensional multivariate t distribution
n &lt;- 10
df=3
A &lt;- matrix(rt(n^2,df), n, n)
A &lt;- tcrossprod(A,A) #A %*% t(A)

# density of Z[c(2,5)] given Z[c(1,4,7,9)]=c(1,1,0,-1)
dcmvt(x=c(1.2,-1), mean=rep(1,n), sigma=A, df=df,
         dependent.ind=c(2,5), given.ind=c(1,4,7,9),
         X.given=c(1,1,0,-1))

dcmvt(x=-1, mean=rep(1,n), sigma=A,df=df, dep=3, given=c(1,4,7,9,10), X=c(1,1,0,0,-1))

dcmvt(x=c(1.2,-1), mean=rep(1,n), sigma=A,df=df, dep=c(2,5))

# gives an error since `x' and `dep' are incompatibe
#dcmvt(x=-1, mean=rep(1,n), sigma=A,df=df, dep=c(2,3),
#given=c(1,4,7,9,10), X=c(1,1,0,0,-1))

rcmvt(n=10, mean=rep(1,n), sigma=A,df=df, dep=c(2,5),
         given=c(1,4,7,9,10), X=c(1,1,0,0,-1),type="shifted",
         method="eigen")

rcmvt(n=10, mean=rep(1,n), sigma=A,df=df, dep=3,
         given=c(1,4,7,9,10), X=c(1,1,0,0,-1),type="Kshirsagar",
         method="chol")
</code></pre>

<hr>
<h2 id='SMCEM_msteps'>Data Imputation Using SEM and MCEM (Multiple Iterations, Degrees of Freedom Known)
</h2><span id='topic+SMCEM_msteps'></span>

<h3>Description</h3>

<p>This sub-package contains the subroutines for iterative imputation of missing values as well as parameter estimation (for the location vector and the scatter matrix) in multivariate t distribution using Stochastic EM (SEM) and Monte Carlo EM (MCEM). In this case, the degrees of freedom for the distribution are known or fixed a priori. SEM is implemented when the analyst specifies a single draw in the E-step. In case we have multiple draws in the E-step, the algorithm changes to MCEM. In both algorithms, the function SMCEM_onestep is run when we are only interested in the imputed values and the parameter updates in a single iteration. The function SMCEM_msteps is run when we are interested in multiple iterations (this is usually the case). Essentially, the first iterations (for instance, 10 percent of all iterations) is usually burnt-in in order to ward off the effects of initial values. Details of how SEM and MCEM operate can be found in among others Kinyanjui et al. (2021), Nielsen (2000), Levine and Casella (2001) Jank (2005) and Karimi et al. (2019).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMCEM_msteps(Y,mu,Sigma,df, nob,K)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMCEM_msteps_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="SMCEM_msteps_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_msteps_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_msteps_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="SMCEM_msteps_+3A_nob">nob</code></td>
<td>
<p>number of draws in the E-step</p>
</td></tr>
<tr><td><code id="SMCEM_msteps_+3A_k">K</code></td>
<td>
<p>the number of iterations, which must be specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector, and scatter matrix when employing the SEM and MCEM algorithms. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Karimi, B., Lavielle, M., and Moulines, É. (2019). On the Convergence Properties of the Mini-Batch EM and MCEM Algorithms.
</p>
<p>Kinyanjui, P.K., Tamba, C.L., &amp; Okenye, J.O. (2021). Missing Data Imputation in a t -Distribution with Known Degrees of Freedom Via Expectation Maximization Algorithm and Its Stochastic Variants. International Journal of Applied Mathematics and Statistics.
</p>
<p>Levine, R. A. and Casella, G. (2001). Implementations of the Monte Carlo EM algorithm. Journal of Computational and Graphical Statistics, 10(3), 422-439.
</p>
<p>Nielsen, S.F. (2000). The stochastic EM algorithm: estimation and asymptotic results. Bernoulli, 6(3), 457-489.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 10
p=3
df=3
mu=c(1:3)
A &lt;- matrix(rt(p^2,df), p, p)
A &lt;- tcrossprod(A,A) #A %*% t(A)

Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (SEM)
SEM1=SMCEM_onestep(Y=Y8,mu= mu_stat,Sigma=Sigma_stat,df=df,nob=1)

#Single Iteration (MCEM)
MCEM1=SMCEM_onestep(Y=Y8,mu= mu_stat,Sigma=Sigma_stat,df=df,nob=100)

#Multiple Iterations (SEM)
SEM=SMCEM_msteps(Y=Y8,mu= mu_stat,Sigma= Sigma_stat,df=df,nob=1,K=500)

#Results for Newly Completed Dataset (Burning in first 50 iterations in SEM)
T_mu=rep(0,3)
T_Sigma=matrix(rep(0,3*3),nrow=3)
T_Data=matrix(rep(0,3*10), nrow =10)
for (l in 51:500){
  T_mu = T_mu + SEM$muchain[l,]
  T_Sigma = T_Sigma + SEM$SigmaChain[,,l]
  T_Data= T_Data+ SEM$YChain[,,l]
}
#updated location vector
round((T_mu/450),4) 
#updated scatter matrix  
round((T_Sigma/450),4)
#complete dataset as an average of (K-50) complete datasets for the various iterations.  
T_Data1=  T_Data/450	
T_Data1

#Multiple Iterations (MCEM)
MCEM=SMCEM_msteps(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df,nob=100,
K=500)

#Results for Newly Completed Dataset (Burning in first 50 iterations in MCEM)
T_mu=rep(0,3)
T_Sigma=matrix(rep(0,3*3),nrow=3)
T_Data=matrix(rep(0,3*10), nrow =10)
for (l in 51:500){
  T_mu = T_mu + MCEM$muchain[l,]
  T_Sigma = T_Sigma + MCEM$SigmaChain[,,l]
  T_Data= T_Data+ MCEM$YChain[,,l]
}
#updated location vector
round((T_mu/450),4) 
#updated scatter matrix
round((T_Sigma/450),4) 
#complete dataset as an average of (K-50) complete datasets for the various iterations.
T_Data1= T_Data/450 
T_Data1                    

</code></pre>

<hr>
<h2 id='SMCEM_onestep'>Data Imputation Using SEM and MCEM (Single Iteration, Degrees of Freedom Known)
</h2><span id='topic+SMCEM_onestep'></span>

<h3>Description</h3>

<p>This sub-package contains the subroutines for iterative imputation of missing values as well as parameter estimation (for the location vector and the scatter matrix) in multivariate t distribution using Stochastic EM (SEM) and Monte Carlo EM (MCEM). In this case, the degrees of freedom for the distribution are known or fixed a priori. SEM is implemented when the analyst specifies a single draw in the E-step. In case we have multiple draws in the E-step, the algorithm changes to MCEM. In both algorithms, the function SMCEM_onestep is run when we are only interested in the imputed values and the parameter updates in a single iteration.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMCEM_onestep(Y,mu,Sigma,df,nob)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMCEM_onestep_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="SMCEM_onestep_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_onestep_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_onestep_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="SMCEM_onestep_+3A_nob">nob</code></td>
<td>
<p>number of draws in the E-step</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector, and scatter matrix when employing the SEM and MCEM algorithms. All outputs are numeric. 
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 10
p=3
df=3
mu=c(1:3)
A &lt;- matrix(rt(p^2,df), p, p)
A &lt;- tcrossprod(A,A) #A %*% t(A)

Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)

#Imputing Missing Values and Updating Parameter Estimates
#Single Iteration (SEM)
SEM1=SMCEM_onestep(Y=Y8,mu= mu_stat,Sigma=A,df=df,nob=1)

#Single Iteration (MCEM)
MCEM1=SMCEM_onestep(Y=Y8,mu= mu_stat,Sigma=A,df=df,nob=100)

#Results for Newly Completed Dataset (SEM)
SEM1$Y2    #Newly completed Dataset (with imputed values)
SEM1$mu	   #updated location vector
SEM1$Sigma #updated scatter matrix

#Results for Newly Completed Dataset (MCEM)
MCEM1$Y2    #Newly completed Dataset (with imputed values)
MCEM1$mu	   #updated location vector
MCEM1$Sigma #updated scatter matrix
</code></pre>

<hr>
<h2 id='SMCEM_Umsteps'>Data Imputation Using SEM and MCEM (Multiple Iterations; Degrees of Freedom Unknown)
</h2><span id='topic+SMCEM_Umsteps'></span>

<h3>Description</h3>

<p>This sub-package provides subroutines for implementation of SEM and MCEM techniques in imputing missing values as well as estimating multivariate t parameters when the degrees of freedom are unknown.The functions SMCEM_msteps constitute the SEM and MCEM algorithms for multiple-iterative data imputation and parameter estimation for multivariate t data with unknown degrees of freedom. The functions represent SEM when the number of draws in the E-step (denoted by nob) is 1 and MCEM when we have more than one draw in the E-step.More details on the implementation of SEM and MCEM techniques can be found in Kinyanjui et al. (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMCEM_Umsteps(Y,mu,Sigma,df,nob,K,e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMCEM_Umsteps_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_nob">nob</code></td>
<td>
<p>number of draws in the E-step</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_k">K</code></td>
<td>
<p>the number of iterations, which must be specified.</p>
</td></tr>
<tr><td><code id="SMCEM_Umsteps_+3A_e">e</code></td>
<td>
<p>tolerance level for convergence of the bisection method for estimation of df. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector,scatter matrix, and degrees of freedom when employing the SEM and MCEM algorithms. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P. K., Tamba, C. L., Orawo, L. A. O., &amp; Okenye, J. O. (2020). Missing data imputation in multivariate t distribution with unknown degrees of freedom using expectation maximization algorithm and its stochastic variants. Model Assisted Statistics and Applications, 15(3), 263-272.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 25
p=3
df=3
mu=c(10,20,30)
A=matrix(c(14,10,12,10,13,9,12,9,18), 3,3)
Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)
df_stat=6

#Imputing Missing Values and Updating Parameter Estimates

#Single Iteration (SEM)
SEMU1=SMCEM_Uonestep(Y=Y8,mu=mu,Sigma=Sigma_stat,df= df_stat,nob=1,e=0.0001)

#Single Iteration (MCEM)
MCEMU1=SMCEM_Uonestep(Y=Y8,mu=mu,Sigma=Sigma_stat,df= df_stat,nob=50,e=0.0001)

#Multiple Iterations (SEM)
SEMU=SMCEM_Umsteps(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df_stat,nob=1,K=100,e=0.0001)

#Results for Newly Completed Dataset (Burning in first 10 iterations in SEM)
T_mu=rep(0,3)
T_Sigma=matrix(rep(0,3*3),nrow=3)
T_Data=matrix(rep(0,3*25), nrow =25)
T_df=rep()
for (l in 11:100){
 T_mu = T_mu + SEMU$muchain[l,]
  T_Sigma = T_Sigma + SEMU$SigmaChain[,,l]
 T_Data= T_Data+ SEMU$YChain[,,l]
}
#updated location vector
round((T_mu/90),4)

#updated scatter matrix 
round((T_Sigma/90),4)

#updated degrees of freedom 
udfs=mean(SEMU$dfchain[11:100])

#complete dataset as an average of (K-10) complete datasets for the various iterations.
T_Data1=  T_Data/90	

#Multiple Iterations (MCEM)
MCEMU=SMCEM_Umsteps(Y=Y8,mu=mu_stat,Sigma=Sigma_stat,df=df_stat,nob=50,K=100,e=0.0001)

#Results for Newly Completed Dataset (Burning in first 10 iterations in MCEM)
T_mu=rep(0,3)
T_Sigma=matrix(rep(0,3*3),nrow=3)
T_Data=matrix(rep(0,3*25), nrow =25)
T_df=rep()
for (l in 11:100){
  T_mu = T_mu + MCEMU$muchain[l,]
  T_Sigma = T_Sigma + MCEMU$SigmaChain[,,l]
  T_Data= T_Data+ MCEMU$YChain[,,l]
}
#updated location vector
round((T_mu/90),4)

#updated scatter matrix 
round((T_Sigma/90),4)

#updated degrees of freedom  
udf=mean(MCEMU$dfchain[11:100])
udf

#complete dataset as an average of (K-10) complete datasets for the various iterations.  
T_Data1=  T_Data/90
T_Data1
</code></pre>

<hr>
<h2 id='SMCEM_Uonestep'>Data Imputation Using SEM and MCEM (Single Iteration; Degrees of Freedom Unknown)
</h2><span id='topic+SMCEM_Uonestep'></span>

<h3>Description</h3>

<p>This sub-package provides subroutines for implementation of SEM and MCEM techniques in imputing missing values as well as estimating multivariate t parameters when the degrees of freedom are unknown. It has 4 functions namely fun1, dfun1, Bisec, and SMCEM_Uonestep. The functions fun1 and dfun1 in the sub-package constitute the equation for the degrees of freedom and its derivative respectively. The Bisec function contains the bisection method subroutines to facilitate the iterative estimation of the degrees of freedom using fun1 and dfun1. The function SMCEM_Uonestep constitute the SEM and MCEM algorithms for single-iteration data imputation and parameter estimation for multivariate t data with unknown degrees of freedom. The functions represent SEM when the number of draws in the E-step (denoted by nob) is 1 and MCEM when we have more than one draw in the E-step.Details of how SEM and MCEM impute missing values and estimate parameters in multivariate t context (unknown degrees of freedom) are explained by Kinyanjui et al. (2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>SMCEM_Uonestep(Y,mu,Sigma,df,nob,e)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="SMCEM_Uonestep_+3A_y">Y</code></td>
<td>
<p>the multivariate t dataset</p>
</td></tr>
<tr><td><code id="SMCEM_Uonestep_+3A_mu">mu</code></td>
<td>
<p>	the location vector, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_Uonestep_+3A_sigma">Sigma</code></td>
<td>
<p>scatter matrix, which must be specified. In cases where it is unknown, starting values are provided.</p>
</td></tr>
<tr><td><code id="SMCEM_Uonestep_+3A_df">df</code></td>
<td>
<p>degrees of freedom, which must be specified.</p>
</td></tr>
<tr><td><code id="SMCEM_Uonestep_+3A_nob">nob</code></td>
<td>
<p>number of draws in the E-step</p>
</td></tr>
<tr><td><code id="SMCEM_Uonestep_+3A_e">e</code></td>
<td>
<p>tolerance level for convergence of the bisection method for estimation of df. </p>
</td></tr>
</table>


<h3>Value</h3>

<p>Completed dataset, updated location vector,scatter matrix, and degrees of freedom when employing the SEM and MCEM algorithms. All outputs are numeric. 
</p>


<h3>References</h3>

<p>Kinyanjui, P. K., Tamba, C. L., Orawo, L. A. O., &amp; Okenye, J. O. (2020). Missing data imputation in multivariate t distribution with unknown degrees of freedom using expectation maximization algorithm and its stochastic variants. Model Assisted Statistics and Applications, 15(3), 263-272.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># 3-dimensional multivariate t distribution
n &lt;- 25
p=3
df=3
mu=c(10,20,30)
A=matrix(c(14,10,12,10,13,9,12,9,18), 3,3)
Y7 &lt;-mvtnorm::rmvt(n, delta=mu, sigma=A, df=df)
Y7
TT=Y7 #Complete Dataset

#Introduce MAR Data
Y8= MISS(TT,20) #The newly created incomplete dataset.
Y8

#Initializing Values
mu_stat=c(0.5,1,2)
Sigma_stat=matrix(c(0.33,0.31,0.3,0.31,0.335,0.295,0.3,0.295,0.32),3,3)
df_stat=6

#Imputing Missing Values and Updating Parameter Estimates

#Single Iteration (SEM)
SEMU1=SMCEM_Uonestep(Y=Y8,mu=mu,Sigma=Sigma_stat,df= df_stat,nob=1,e=0.00001)

#Single Iteration (MCEM)
MCEMU1=SMCEM_Uonestep(Y=Y8,mu=mu,Sigma=Sigma_stat,df= df_stat,nob=1000,e=0.00001)

#Results for Newly Completed Dataset (SEM)
SEMU1$Y2     #Newly completed Dataset (with imputed values)
SEMU1$mu	   #updated location vector
SEMU1$Sigma  #updated scatter matrix

#Results for Newly Completed Dataset (MCEM)
MCEMU1$Y2     #Newly completed Dataset (with imputed values)
MCEMU1$mu	    #updated location vector
MCEMU1$Sigma  #updated scatter matrix
MCEMU1$df     #updated degrees of freedom
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
