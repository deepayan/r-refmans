<!DOCTYPE html><html lang="en"><head><title>Help for package remap</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {remap}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#plot.remap'><p>Plot method for remap object.</p></a></li>
<li><a href='#predict.remap'><p>Make predictions given a set of data and smooths predictions at region</p>
borders. If an observation is outside of all regions and smoothing distances,
the closest region will be used to predict.</a></li>
<li><a href='#print.remap'><p>Print method for remap object.</p></a></li>
<li><a href='#redist'><p>Get distances between data and regions.</p></a></li>
<li><a href='#remap'><p>Build separate models for mapping multiple regions.</p></a></li>
<li><a href='#summary.remap'><p>Summary method for remap object.</p></a></li>
<li><a href='#utsnow'><p>Snowpack at weather stations in Utah on April 1st, 2011.</p></a></li>
<li><a href='#utws'><p>Watershed polygons within the state of Utah.</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Regional Spatial Modeling with Continuous Borders</td>
</tr>
<tr>
<td>Version:</td>
<td>0.3.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Automatically creates separate regression models for different spatial 
    regions. The prediction surface is smoothed using a regional border smoothing 
    method. If regional models are continuous, the resulting prediction surface is 
    continuous across the spatial dimensions, even at region borders. Methodology 
    is described in Wagstaff and Bean (2023) &lt;<a href="https://doi.org/10.32614%2FRJ-2023-004">doi:10.32614/RJ-2023-004</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/jadonwagstaff/remap">https://github.com/jadonwagstaff/remap</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/jadonwagstaff/remap/issues">https://github.com/jadonwagstaff/remap/issues</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>graphics (&ge; 4.1.0), methods (&ge; 4.1.0), parallel (&ge; 4.1.0),
sf (&ge; 1.0.0), stats (&ge; 4.1.0), units (&ge; 0.6.7), utils (&ge;
4.1.0)</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>Suggests:</td>
<td>dplyr (&ge; 1.0.2), ggplot2 (&ge; 3.3.2), knitr (&ge; 1.30), maps
(&ge; 3.3.0), mgcv (&ge; 1.8.33), rmarkdown (&ge; 2.5)</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-01-09 21:38:24 UTC; jadonwagstaff</td>
</tr>
<tr>
<td>Author:</td>
<td>Jadon Wagstaff [aut, cre],
  Brennan Bean [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Jadon Wagstaff &lt;jadonw@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-01-09 23:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='plot.remap'>Plot method for remap object.</h2><span id='topic+plot.remap'></span>

<h3>Description</h3>

<p>Plots the regions used for modeling.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'remap'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.remap_+3A_x">x</code></td>
<td>
<p> S3 object output from remap.</p>
</td></tr>
<tr><td><code id="plot.remap_+3A_...">...</code></td>
<td>
<p>Arguments to pass to regions plot.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list that plots a map of the regions used for modeling.
</p>

<hr>
<h2 id='predict.remap'>Make predictions given a set of data and smooths predictions at region
borders. If an observation is outside of all regions and smoothing distances,
the closest region will be used to predict.</h2><span id='topic+predict.remap'></span>

<h3>Description</h3>

<p>Make predictions given a set of data and smooths predictions at region
borders. If an observation is outside of all regions and smoothing distances,
the closest region will be used to predict.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'remap'
predict(
  object,
  data,
  smooth,
  distances,
  cores = 1,
  progress = FALSE,
  se = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.remap_+3A_object">object</code></td>
<td>
<p> S3 object output from remap.</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_data">data</code></td>
<td>
<p>An sf dataframe with point geometry.</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_smooth">smooth</code></td>
<td>
<p>The distance in km within a region where a smooth transition
to the next region starts. If smooth = 0, no smoothing occurs between regions
unless an observation falls on the border of two or more polygons. (Can be a
named vector with different values for each unique object$region_id' in '
object$region'.)</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_distances">distances</code></td>
<td>
<p>An optional matrix of distances between 'data' and
'object$regions' generated by <code>redist()</code> function (calculated
internally if not provided).</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_cores">cores</code></td>
<td>
<p>Number of cores for parallel computing. 'cores' above
default of 1 will require more memory.</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_progress">progress</code></td>
<td>
<p>If TRUE, a text progress bar is printed to the console.
(Progress bar only appears if 'cores' = 1.)</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_se">se</code></td>
<td>
<p>If TRUE, predicted values are assumed to be standard errors and
an upper bound of combined model standard errors are calculated at each
prediction location. Should stay FALSE unless predicted values from remap are
standard error values.</p>
</td></tr>
<tr><td><code id="predict.remap_+3A_...">...</code></td>
<td>
<p>Arguments to pass to individual model prediction functions.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Predictions in the form of a numeric vector. If se is TRUE,
upper bound for combined standard errors in the form of a numeric vector.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+remap">remap</a></code> building a regional model.
</p>

<hr>
<h2 id='print.remap'>Print method for remap object.</h2><span id='topic+print.remap'></span>

<h3>Description</h3>

<p>Print method for remap object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'remap'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.remap_+3A_x">x</code></td>
<td>
<p> S3 object output from remap.</p>
</td></tr>
<tr><td><code id="print.remap_+3A_...">...</code></td>
<td>
<p>Extra arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, a description of the remap object is printed in the
console.
</p>

<hr>
<h2 id='redist'>Get distances between data and regions.</h2><span id='topic+redist'></span>

<h3>Description</h3>

<p>Finds distances in km between data provided as sf dataframe with point
geometry and regions provided as sf dataframe with polygon or multipolygon
geometry.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>redist(data, regions, region_id, max_dist, cores = 1, progress = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="redist_+3A_data">data</code></td>
<td>
<p>An sf data frame with point geometry.</p>
</td></tr>
<tr><td><code id="redist_+3A_regions">regions</code></td>
<td>
<p>An sf dataframe with polygon or multipolygon geometry.</p>
</td></tr>
<tr><td><code id="redist_+3A_region_id">region_id</code></td>
<td>
<p>Optional name of column in 'regions' that contains the id
that each region belongs to (no quotes). If null, it will be assumed that
each row is its own region.</p>
</td></tr>
<tr><td><code id="redist_+3A_max_dist">max_dist</code></td>
<td>
<p>a maximum distance that is needed for future calculations.
(Set equal to maximum 'smooth' when predicting on new observations.)</p>
</td></tr>
<tr><td><code id="redist_+3A_cores">cores</code></td>
<td>
<p>Number of cores for parallel computing. 'cores' above
default of 1 will require more memory. (Progress bar only appears if '
cores' = 1.)</p>
</td></tr>
<tr><td><code id="redist_+3A_progress">progress</code></td>
<td>
<p>If true, a text progress bar is printed to the console.
Progress set to FALSE will find distances quicker if max_dist is not
specified.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A matrix where each row corresponds one-to-one with each row in
provided 'data'. Matrix columns are either named with regions from
'region_id' column of 'regions' or the row numbers of 'regions' if
'region_id' is missing. Values are in kilometers.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+remap">remap</a></code> - uses redist for regional models.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(remap)
data(utsnow)
data(utws)

# Build a matrix of distances between objects of utsnow and utws
# We will not set max_dist, so all distances will be found
dists &lt;- redist(
  data = utsnow,
  regions = utws,
  region_id = HUC2
)

head(dists)

</code></pre>

<hr>
<h2 id='remap'>Build separate models for mapping multiple regions.</h2><span id='topic+remap'></span>

<h3>Description</h3>

<p>Separate models are built for each given region and combined into one S3
object that can be used to predict on new data using generic function
predict().
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remap(
  data,
  regions,
  region_id,
  model_function,
  buffer,
  min_n = 1,
  distances,
  cores = 1,
  progress = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="remap_+3A_data">data</code></td>
<td>
<p>An sf data frame with point geometry.</p>
</td></tr>
<tr><td><code id="remap_+3A_regions">regions</code></td>
<td>
<p>An sf dataframe with polygon or multipolygon geometry.</p>
</td></tr>
<tr><td><code id="remap_+3A_region_id">region_id</code></td>
<td>
<p>Optional name of column in 'regions' that contains the id
that each region belongs to (no quotes). If null, it will be assumed that
each row of 'regions' is its own region.</p>
</td></tr>
<tr><td><code id="remap_+3A_model_function">model_function</code></td>
<td>
<p>A function that can take a subset of 'data' and
output a model that can be used to predict new values when passed to generic
function predict().</p>
</td></tr>
<tr><td><code id="remap_+3A_buffer">buffer</code></td>
<td>
<p>The length of the buffer zone around each region in km where
observations are included in the data used to build models for each region.
(Can be a named vector with different values for each unique 'region_id' in
'region'.)</p>
</td></tr>
<tr><td><code id="remap_+3A_min_n">min_n</code></td>
<td>
<p>The minimum number of observations to use when building a model.
If there are not enough observations in the region and buffer, then the
closest min_n observations are used. <code>min_n</code> must be at least 1.</p>
</td></tr>
<tr><td><code id="remap_+3A_distances">distances</code></td>
<td>
<p>An optional matrix of distances between 'data' and 'regions'
generated by <code>redist()</code> function (calculated internally if not
provided). Note that unless you know that you have min_n within a certain
distance, no max_dist parameter should be used in <code>redist()</code>.</p>
</td></tr>
<tr><td><code id="remap_+3A_cores">cores</code></td>
<td>
<p>Number of cores for parallel computing. 'cores' above
default of 1 will require more memory.</p>
</td></tr>
<tr><td><code id="remap_+3A_progress">progress</code></td>
<td>
<p>If true, a text progress bar is printed to the console.
(Progress bar only appears if 'cores' = 1.)</p>
</td></tr>
<tr><td><code id="remap_+3A_...">...</code></td>
<td>
<p>Extra arguments to pass to 'model_function' function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>If a model fails for a region, a warning is given but the modeling
process will continue.
</p>
<p>A description of the methodology can be found in Wagstaff and Bean (2023)
&quot;remap: Regionalized Models with Spatially Smooth Predictions&quot;
&lt;doi:10.32614/RJ-2023-004&gt;.
</p>


<h3>Value</h3>

<p>A <em>remap</em> S3 object containing:
</p>

<dl>
<dt><em>models</em></dt><dd><p>A list of models containing a model output by
'model_function' for each region.</p>
</dd>
<dt><em>regions</em></dt><dd><p>'regions' object passed to the function (used for
prediction). The first column is 'region_id' or the row number of 'regions'
if 'region_id is missing. The second column is the region geometry.</p>
</dd>
<dt><em>call</em></dt><dd><p>Shows the parameters that were passed to the function.</p>
</dd>
</dl>



<h3>See Also</h3>

<p><code><a href="#topic+predict.remap">predict.remap</a></code> - used for predicting on new data.
<code><a href="#topic+redist">redist</a></code> - used for pre-computing distances.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(remap)
data(utsnow)
data(utws)

# We will keep these examples simple by only modeling non-zero values of
# snow water equivalent (WESD)

utsnz &lt;- utsnow[utsnow$WESD &gt; 0, ]

# Build a remap model with lm that has formula WESD ~ ELEVATION
# The buffer to collect data around each region is 30km
# The minimum number of observations per region is 10
remap_model &lt;- remap(
  data = utsnz,
  regions = utws,
  region_id = HUC2,
  model_function = lm,
  formula = log(WESD) ~ ELEVATION,
  buffer = 20,
  min_n = 10,
  progress = TRUE
)

# Resubstitution predictions
remap_preds &lt;- exp(predict(remap_model, utsnz, smooth = 10))
head(remap_preds)

</code></pre>

<hr>
<h2 id='summary.remap'>Summary method for remap object.</h2><span id='topic+summary.remap'></span>

<h3>Description</h3>

<p>Summary method for remap object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'remap'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.remap_+3A_object">object</code></td>
<td>
<p> S3 object output from remap.</p>
</td></tr>
<tr><td><code id="summary.remap_+3A_...">...</code></td>
<td>
<p>Extra arguments to pass to regional models.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>No return value, a brief summary of the remap object is printed in
the console. This includes the class(es) of the regional models, the
CRS of the regions, and the bounding box of the regions.
</p>

<hr>
<h2 id='utsnow'>Snowpack at weather stations in Utah on April 1st, 2011.</h2><span id='topic+utsnow'></span>

<h3>Description</h3>

<p>Water equivalent of snow density (WESD) in mm of water at various
location within and surrounding the state of Utah. WESD are
measured at weather stations within the Daily Global Historical
Climatology Network. April first measurements are used to
estimate snowpack for the state of Utah.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utsnow
</code></pre>


<h3>Format</h3>

<p>An sf points object with 394 rows and 8 variables:
</p>

<dl>
<dt>ID</dt><dd><p>Weather station identification code.</p>
</dd>
<dt>STATION_NAME</dt><dd><p>Weather station name.</p>
</dd>
<dt>LATITUDE</dt><dd><p>Latitude of weather station.</p>
</dd>
<dt>LONGITUDE</dt><dd><p>Longitude of weather station.</p>
</dd>
<dt>ELEVATION</dt><dd><p>Elevation of weather station.</p>
</dd>
<dt>HUC2</dt><dd><p>Largest watershed region containing this weather station
(see <code><a href="#topic+utws">utws</a></code> data).</p>
</dd>
<dt>WESD</dt><dd><p>Water equivalent of snow density in mm of water.</p>
</dd>
<dt>geometry</dt><dd><p>sfc points in geographic coordinates.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/">https://www1.ncdc.noaa.gov/pub/data/ghcn/daily/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# If you run into issues with loading this dataset try running:
utsnow &lt;- sf::st_read(system.file("extdata/utsnow.shp", package="remap"))
names(utsnow) &lt;- c(
  "ID", "STATION_NAME", "LATITUDE", "LONGITUDE", "ELEVATION", "HUC2",
  "WESD", "geometry"
)

</code></pre>

<hr>
<h2 id='utws'>Watershed polygons within the state of Utah.</h2><span id='topic+utws'></span>

<h3>Description</h3>

<p>Watersheds are defined by the United States Geological Survey.
Only the largest defines watersheds are used.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>utws
</code></pre>


<h3>Format</h3>

<p>An sf object with 4 rows and 2 variables:
</p>

<dl>
<dt>HUC2</dt><dd><p>Largest watershed ID's defined by the USGS.</p>
</dd>
<dt>geometry</dt><dd><p>sfc multipolygon object in geographic coordinates.</p>
</dd>
</dl>



<h3>Source</h3>

<p><a href="https://www.usgs.gov/national-hydrography/watershed-boundary-dataset">https://www.usgs.gov/national-hydrography/watershed-boundary-dataset</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# If you run into issues with loading this dataset try running:
utws &lt;- sf::st_read(system.file("extdata/utws.shp", package="remap"))

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
