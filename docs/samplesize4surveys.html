<!DOCTYPE html><html><head><title>Help for package samplesize4surveys</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {samplesize4surveys}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#b4ddm'><p>Statistical power for a hyphotesis testing on a double difference of means.</p></a></li>
<li><a href='#b4ddp'><p>Statistical power for a hyphotesis testing on a difference of proportions</p></a></li>
<li><a href='#b4dm'><p>Statistical power for a hyphotesis testing on a difference of means.</p></a></li>
<li><a href='#b4dp'><p>Statistical power for a hyphotesis testing on a difference of proportions</p></a></li>
<li><a href='#b4m'><p>Statistical power for a hyphotesis testing on a single mean</p></a></li>
<li><a href='#b4p'><p>Statistical power for a hyphotesis testing on a single proportion</p></a></li>
<li><a href='#b4S2'><p>Statistical power for a hyphotesis testing on a single variance</p></a></li>
<li><a href='#BigLucyT0T1'><p>Some Business Population Database for two periods of time</p></a></li>
<li><a href='#DEFF'><p>Estimated sample Effects of Design (DEFF)</p></a></li>
<li><a href='#e4ddm'><p>Statistical errors for the estimation of a double difference of means</p></a></li>
<li><a href='#e4ddp'><p>Statistical errors for the estimation of a double difference of proportions</p></a></li>
<li><a href='#e4dm'><p>Statistical errors for the estimation of a difference of means</p></a></li>
<li><a href='#e4dp'><p>Statistical errors for the estimation of a difference of proportions</p></a></li>
<li><a href='#e4m'><p>Statistical errors for the estimation of a single mean</p></a></li>
<li><a href='#e4p'><p>Statistical errors for the estimation of a single proportion</p></a></li>
<li><a href='#e4S2'><p>Statistical errors for the estimation of a single variance</p></a></li>
<li><a href='#ICC'><p>Intraclass Correlation Coefficient</p></a></li>
<li><a href='#ss2s4m'><p>Sample Sizes in Two-Stage sampling Designs for Estimating Signle Means</p></a></li>
<li><a href='#ss2s4p'><p>Sample Sizes in Two-Stage sampling Designs for Estimating Signle Proportions</p></a></li>
<li><a href='#ss4ddm'><p>The required sample size for estimating a double difference of means</p></a></li>
<li><a href='#ss4ddmH'><p>The required sample size for testing a null hyphotesis for a double difference of proportions</p></a></li>
<li><a href='#ss4ddp'><p>The required sample size for estimating a double difference of proportions</p></a></li>
<li><a href='#ss4ddpH'><p>The required sample size for testing a null hyphotesis for a double difference of proportions</p></a></li>
<li><a href='#ss4dm'><p>The required sample size for estimating a single difference of proportions</p></a></li>
<li><a href='#ss4dmH'><p>The required sample size for testing a null hyphotesis for a single difference of proportions</p></a></li>
<li><a href='#ss4dp'><p>The required sample size for estimating a single difference of proportions</p></a></li>
<li><a href='#ss4dpH'><p>The required sample size for testing a null hyphotesis for a single difference of proportions</p></a></li>
<li><a href='#ss4HHSm'><p>Sample Sizes for Household Surveys in Two-Stages for Estimating Single Means</p></a></li>
<li><a href='#ss4HHSp'><p>Sample Sizes for Household Surveys in Two-Stages for Estimating Single Proportions</p></a></li>
<li><a href='#ss4m'><p>The required sample size for estimating a single mean</p></a></li>
<li><a href='#ss4mH'><p>The required sample size for testing a null hyphotesis for a single mean</p></a></li>
<li><a href='#ss4p'><p>The required sample size for estimating a single proportion</p></a></li>
<li><a href='#ss4pH'><p>The required sample size for testing a null hyphotesis for a single proportion</p></a></li>
<li><a href='#ss4pLN'><p>The required sample size for estimating a single proportion based on a logaritmic transformation of the estimated proportion</p></a></li>
<li><a href='#ss4S2'><p>The required sample size for estimating a single variance</p></a></li>
<li><a href='#ss4S2H'><p>The required sample size for testing a null hyphotesis for a single variance</p></a></li>
<li><a href='#ss4stm'><p>Sample Size for Estimation of Means in Stratified Sampling</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Sample Size Calculations for Complex Surveys</td>
</tr>
<tr>
<td>Version:</td>
<td>4.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2020-01-16</td>
</tr>
<tr>
<td>Author:</td>
<td>Hugo Andres Gutierrez Rojas</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Hugo Andres Gutierrez Rojas &lt;hagutierrezro@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Computes the required sample size for estimation of totals, means
    and proportions under complex sampling designs.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.1), TeachingSampling, timeDate, dplyr, magrittr</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.0.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2020-01-17 12:14:18 UTC; psirusteam</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2020-01-17 13:20:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='b4ddm'>Statistical power for a hyphotesis testing on a double difference of means.</h2><span id='topic+b4ddm'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of double difference of means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4ddm(
  N,
  n,
  mu1,
  mu2,
  mu3,
  mu4,
  sigma1,
  sigma2,
  sigma3,
  sigma4,
  D,
  DEFF = 1,
  conf = 0.95,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4ddm_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_mu3">mu3</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_mu4">mu4</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_sigma3">sigma3</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_sigma4">sigma4</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_d">D</code></td>
<td>
<p>The value of the null effect.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="b4ddm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D - [(\mu_1 - \mu_2) - (\mu_3 - \mu_4)])}{\sqrt{\frac{1}{n}(1-\frac{n}{N})S^2}})</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">S^2 = DEFF (\sigma_1^2 + \sigma_2^2 + \sigma_3^2 + \sigma_4^2</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4ddm(N = 100000, n = 400, mu1=50, mu2=55, mu3=50, mu4=55, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D = 7)
b4ddm(N = 100000, n = 400, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D = 12, plot = TRUE)
b4ddm(N = 100000, n = 4000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D = 11, DEFF = 2, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4ddp'>Statistical power for a hyphotesis testing on a difference of proportions</h2><span id='topic+b4ddp'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of difference of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4ddp(N, n, P1, P2, P3, P4, D, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4ddp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_p3">P3</code></td>
<td>
<p>The value of the third estimated proportion.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_p4">P4</code></td>
<td>
<p>The value of the fourth estimated proportion.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_d">D</code></td>
<td>
<p>The value of the null effect.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4ddp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D - [(P_1 - P_2) - (P_3 - P_4)])}{\sqrt{\frac{DEFF}{n}(1-\frac{n}{N})(P_1Q_1+P_2Q_2+P_3Q_3+P_4Q_4)}})</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4ddp(N = 10000, n = 400, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, D = 0.03)
b4ddp(N = 10000, n = 400, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, D = 0.03, plot = TRUE)
b4ddp(N = 10000, n = 4000, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, 
D = 0.05, DEFF = 2, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4dm'>Statistical power for a hyphotesis testing on a difference of means.</h2><span id='topic+b4dm'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of difference of means
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4dm(N, n, mu1, mu2, sigma1, sigma2, D, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4dm_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_d">D</code></td>
<td>
<p>The value of the null effect.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4dm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{ (D - (\mu_1 - \mu_2))}{\sqrt{\frac{1}{n}(1-\frac{n}{N})S^2}})</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">S^2 = DEFF (\sigma_1^2 + \sigma_2^2 </code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4dm(N = 100000, n = 400, mu1 = 5, mu2 = 5, sigma1 = 10, sigma2 = 15, D = 5)
b4dm(N = 100000, n = 400, mu1 = 5, mu2 = 5, sigma1 = 10, sigma2 = 15, D = 0.03, plot = TRUE)
b4dm(N = 100000, n = 4000, mu1 = 5, mu2 = 5, sigma1 = 10, sigma2 = 15, 
D = 0.05, DEFF = 2, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4dp'>Statistical power for a hyphotesis testing on a difference of proportions</h2><span id='topic+b4dp'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of difference of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4dp(N, n, P1, P2, D, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4dp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_d">D</code></td>
<td>
<p>The value of the null effect.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4dp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D - (P_1 - P_2))}{\sqrt{\frac{DEFF}{n}(1-\frac{n}{N})(P_1Q_1+P_2Q_2)}})</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4dp(N = 100000, n = 400, P1 = 0.5, P2 = 0.5, D = 0.03)
b4dp(N = 100000, n = 400, P1 = 0.5, P2 = 0.5, D = 0.03, plot = TRUE)
b4dp(N = 100000, n = 4000, P1 = 0.5, P2 = 0.5, D = 0.05, DEFF = 2, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4m'>Statistical power for a hyphotesis testing on a single mean</h2><span id='topic+b4m'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of means.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4m(N, n, mu, sigma, D, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4m_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4m_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4m_+3A_mu">mu</code></td>
<td>
<p>The value of the estimated mean of the variable of interest.</p>
</td></tr>
<tr><td><code id="b4m_+3A_sigma">sigma</code></td>
<td>
<p>The value of the standard deviation of the variable of interest.</p>
</td></tr>
<tr><td><code id="b4m_+3A_d">D</code></td>
<td>
<p>The value of the null effect. Note that <code>D</code> must be strictly greater than <code>mu</code>.</p>
</td></tr>
<tr><td><code id="b4m_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4m_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4m_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D - \mu)}{\sqrt{\frac{1}{n}(1-\frac{n}{N})S^2}})</code>
</p>

<p>where </p>
<p style="text-align: center;"><code class="reqn">S^2 = DEFF \sigma^2</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4m(N = 100000, n = 400, mu = 3, sigma = 1, D = 3.1)
b4m(N = 100000, n = 400, mu = 5, sigma = 10, D = 7, plot = TRUE)
b4m(N = 100000, n = 400, mu = 50, sigma = 100, D = 100, DEFF = 3.4, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4p'>Statistical power for a hyphotesis testing on a single proportion</h2><span id='topic+b4p'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4p(N, n, P, D, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4p_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4p_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4p_+3A_p">P</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="b4p_+3A_d">D</code></td>
<td>
<p>The value of the null effect. Note that <code>D</code> must be strictly greater than <code>P</code>.</p>
</td></tr>
<tr><td><code id="b4p_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4p_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4p_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D-P)}{\sqrt{\frac{DEFF}{n}(1-\frac{n}{N})(P (1-P))}})</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4p(N = 100000, n = 400, P = 0.5, D = 0.55)
b4p(N = 100000, n = 400, P = 0.5, D = 0.9, plot = TRUE)
b4p(N = 100000, n = 4000, P = 0.5, D = 0.55, DEFF = 2, conf = 0.99, plot = TRUE)
</code></pre>

<hr>
<h2 id='b4S2'>Statistical power for a hyphotesis testing on a single variance</h2><span id='topic+b4S2'></span>

<h3>Description</h3>

<p>This function computes the power for a (right tail) test of variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>b4S2(N, n, S2, S20, K = 0, DEFF = 1, conf = 0.95, power = 0.8, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="b4S2_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_s2">S2</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_s20">S20</code></td>
<td>
<p>The value of the null effect. Note that <code>S2</code> must be strictly smaller than <code>S2</code>.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_k">K</code></td>
<td>
<p>The excess kurtosis of the variable in the population.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_power">power</code></td>
<td>
<p>The statistical power. By default power = 0.80.</p>
</td></tr>
<tr><td><code id="b4S2_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the power achieved for an specific sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the power is defined as: </p>
<p style="text-align: center;"><code class="reqn">1-\Phi(Z_{1-\alpha} - \frac{(D-P)}{\sqrt{\frac{DEFF}{n}(1-\frac{n}{N})(P (1-P))}})</code>
</p>



<h3>Value</h3>

<p>The power of the test.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 0, DEFF = 1)
b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 2, DEFF = 1)
b4S2(N = 100000, n = 400, S2 = 120, S20 = 100, K = 2, DEFF = 2.5, plot = TRUE)
</code></pre>

<hr>
<h2 id='BigLucyT0T1'>Some Business Population Database for two periods of time</h2><span id='topic+BigLucyT0T1'></span>

<h3>Description</h3>

<p>This data set corresponds to a random sample of BigLucy. It contains some financial variables of 85296 industrial companies of a city in a particular fiscal year.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BigLucyT0T1</code></pre>


<h3>Format</h3>


<dl>
<dt>ID</dt><dd><p>The identifier of the company. It correspond to an alphanumeric sequence (two letters and three digits)</p>
</dd>
<dt>Ubication</dt><dd><p>The address of the principal office of the company in the city</p>
</dd>
<dt>Level</dt><dd><p>The industrial companies are discrimitnated according to the Taxes declared. 
There are small, medium and big companies</p>
</dd>
<dt>Zone</dt><dd><p>The city is divided by geoghrafical zones. A company is classified in a particular zone according to its address</p>
</dd>
<dt>Income</dt><dd><p>The total ammount of a company's earnings (or profit) in the previuos fiscal year. It is calculated by taking 
revenues and adjusting for the cost of doing business</p>
</dd>
<dt>Employees</dt><dd><p>The total number of persons working for the company in the previuos fiscal year</p>
</dd>
<dt>Taxes</dt><dd><p>The total ammount of a company's income Tax</p>
</dd>
<dt>SPAM</dt><dd><p>Indicates if the company uses the Internet and WEBmail options in order to make self-propaganda.</p>
</dd>
<dt>Segments</dt><dd><p>The cartographic divisions.</p>
</dd>
<dt>Outgoing</dt><dd><p>Expenses per year.</p>
</dd>
<dt>Years</dt><dd><p>Age of the company.</p>
</dd>
<dt>ISO</dt><dd><p>Indicates whether the company is quality-certified.</p>
</dd>
<dt>ISOYears</dt><dd><p>Indicates the time company has been certified.</p>
</dd>
<dt>CountyP</dt><dd><p>Indicates wheter the county is participating in the intervention. That is if the county contains companies that have been certified by ISO</p>
</dd>
<dt>Time</dt><dd><p>Refers to the time of observation.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas <a href="mailto:hugogutierrez@usantotomas.edu.co">hugogutierrez@usantotomas.edu.co</a></p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>.
Editorial Universidad Santo Tomas.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(Lucy)
attach(Lucy)
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
# The population totals
colSums(estima)
# Some parameters of interest
table(SPAM,Level)
xtabs(Income ~ Level+SPAM)
# Correlations among characteristics of interest
cor(estima)
# Some useful histograms
hist(Income)
hist(Taxes)
hist(Employees)
# Some useful plots
boxplot(Income ~ Level)
barplot(table(Level))
pie(table(SPAM))
</code></pre>

<hr>
<h2 id='DEFF'>Estimated sample Effects of Design (DEFF)</h2><span id='topic+DEFF'></span>

<h3>Description</h3>

<p>This function returns the estimated design effects for a set of inclusion probabilities and the variables of interest.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>DEFF(y, pik)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="DEFF_+3A_y">y</code></td>
<td>
<p>Vector, matrix or data frame containing the recollected information of the variables of interest for every unit in the selected sample.</p>
</td></tr>
<tr><td><code id="DEFF_+3A_pik">pik</code></td>
<td>
<p>Vector of inclusion probabilities for each unit in the selected sample.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The design effect is somehow defined to be the ratio between the variance of a complex design and the variance of a simple design. 
When the design is stratified and the allocation is proportional, this measures reduces to
</p>
<p style="text-align: center;"><code class="reqn">DEFF_{Kish} = 1 + CV(w)</code>
</p>

<p>where w is the set of weights (defined as the inverse of the inclusion probabilities) along the sample, and CV refers 
to the classical coefficient of variation. Although this measure is #' motivated by a stratified sampling design, 
it is commonly applied to any kind of survey where sampling weight are unequal. On the other hand, the Spencer's DEFF 
is motivated by the idea that a set of weights may be efficent even when they vary, and is defined by:
</p>
<p style="text-align: center;"><code class="reqn">DEFF_{Spencer} = (1 - R^2) * DEFF_{Kish} + \frac{\hat{a}^2}{\hat{\sigma}^2_y} * (DEFF_{Kish} - 1) </code>
</p>

<p>where 
</p>
<p style="text-align: center;"><code class="reqn">\hat{\sigma}^2_y = \frac{\sum_s w_k (y_k - \bar{y}_w)^2}{\sum_s w_k}</code>
</p>

<p>and <code class="reqn">\hat{a}</code> is the estimation of the intercept in the following model
</p>
<p style="text-align: center;"><code class="reqn">y_k = a + b * p_k + e_k</code>
</p>

<p>with <code class="reqn">p_k = \pi_k / n</code> is an standardized sampling weight. Finnaly, <code class="reqn">R^2</code> is the R-squared of this model.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas.
Valliant, R, et. al. (2013), <em>Practical tools for Design and Weighting Survey Samples</em>. Springer
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

# The sample size
n &lt;- 400
res &lt;- S.piPS(n, Income)
sam &lt;- res[,1]
# The information about the units in the sample is stored in an object called data
data &lt;- BigLucy[sam,]
attach(data)
names(data)
# Pik.s is the inclusion probability of every single unit in the selected sample
pik &lt;- res[,2]
# The variables of interest are: Income, Employees and Taxes
# This information is stored in a data frame called estima
estima &lt;- data.frame(Income, Employees, Taxes)
E.piPS(estima,pik)
DEFF(estima,pik)
</code></pre>

<hr>
<h2 id='e4ddm'>Statistical errors for the estimation of a double difference of means</h2><span id='topic+e4ddm'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a double difference of means under a complex sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4ddm(
  N,
  n,
  mu1,
  mu2,
  mu3,
  mu4,
  sigma1,
  sigma2,
  sigma3,
  sigma4,
  DEFF = 1,
  conf = 0.95,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4ddm_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_mu3">mu3</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_mu4">mu4</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_sigma3">sigma3</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_sigma4">sigma4</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="e4ddm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the coefficent of variation is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var((\bar{y}_1 - \bar{y}_2)-(\bar{y}_1 - \bar{y}_2))}}{(\bar{y}_1 - \bar{y}_2)-(\bar{y}_3 - \bar{y}_4)}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var((\bar{y}_1 - \bar{y}_2)-(\bar{y}_3 - \bar{y}_4))}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4ddm(N=10000, n=400, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12)
e4ddm(N=10000, n=400, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, plot=TRUE)
e4ddm(N=10000, n=400, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4ddp'>Statistical errors for the estimation of a double difference of proportions</h2><span id='topic+e4ddp'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a double difference of proportions under a complex sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4ddp(N, n, P1, P2, P3, P4, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4ddp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_p3">P3</code></td>
<td>
<p>The value of the third estimated proportion.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_p4">P4</code></td>
<td>
<p>The value of the fouth estimated proportion.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4ddp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the margin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var((\hat{P}_1 - \hat{P}_2) - (\hat{P}_3 - \hat{P}_4) ) }}{(\hat{P}_1 - \hat{P}_2) - (\hat{P}_3 - \hat{P}_4)}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var((\hat{P}_1 - \hat{P}_2) - (\hat{P}_3 - \hat{P}_4) )}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4ddp(N=10000, n=400, P1=0.5, P2=0.6, P3=0.5, P4=0.7)
e4ddp(N=10000, n=400, P1=0.5, P2=0.6, P3=0.5, P4=0.7, plot=TRUE)
e4ddp(N=10000, n=400, P1=0.5, P2=0.6, P3=0.5, P4=0.7, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4dm'>Statistical errors for the estimation of a difference of means</h2><span id='topic+e4dm'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a difference of means under a complex sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4dm(N, n, mu1, mu2, sigma1, sigma2, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4dm_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4dm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the coefficent of variation is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var(\bar{y}_1 - \bar{y}_2)}}{\bar{y}_1 - \bar{y}_2}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var(\bar{y}_1 - \bar{y}_2)}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8)
e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8, plot=TRUE)
e4dm(N=10000, n=400, mu1 = 100, mu2 = 12, sigma1 = 10, sigma2=8, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4dp'>Statistical errors for the estimation of a difference of proportions</h2><span id='topic+e4dp'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a difference of proportions under a complex sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4dp(N, n, P1, P2, DEFF = 1, T = 0, R = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4dp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4dp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the margin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var(\hat{P}_1 - \hat{P}_2) }}{\hat{P}_1 - \hat{P}_2}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var(\hat{P}_1 - \hat{P}_2)}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4dp(N=10000, n=400, P1=0.5, P2=0.6)
e4dp(N=10000, n=400, P1=0.5, P2=0.6, plot=TRUE)
e4dp(N=10000, n=400, P1=0.5, P2=0.6, DEFF=3.45, conf=0.99, plot=TRUE)
e4dp(N=10000, n=400, P1=0.5, P2=0.6, T=0.5, R=0.5, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4m'>Statistical errors for the estimation of a single mean</h2><span id='topic+e4m'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a single mean under a complex sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4m(N, n, mu, sigma, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4m_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4m_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4m_+3A_mu">mu</code></td>
<td>
<p>The value of the estimated mean of the variable of interest.</p>
</td></tr>
<tr><td><code id="e4m_+3A_sigma">sigma</code></td>
<td>
<p>The value of the standard deviation of the variable of interest.</p>
</td></tr>
<tr><td><code id="e4m_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4m_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4m_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the coefficent of variation is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var(\bar{y}_S)}}{\bar{y}_S}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var(\bar{y}_S)}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4m(N=10000, n=400, mu = 10, sigma = 10)
e4m(N=10000, n=400, mu = 10, sigma = 10, plot=TRUE)
e4m(N=10000, n=400, mu = 10, sigma = 10, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4p'>Statistical errors for the estimation of a single proportion</h2><span id='topic+e4p'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the standard error when estimating a single proportion under a sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4p(N, n, P, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4p_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4p_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4p_+3A_p">P</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="e4p_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4p_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4p_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the coefficent of variation is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var(\hat{p})}}{\hat{p}}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var(\hat{p})}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation, the margin of error and the relative margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4p(N=10000, n=400, P=0.5)
e4p(N=10000, n=400, P=0.5, plot=TRUE)
e4p(N=10000, n=400, P=0.01, DEFF=3.45, conf=0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='e4S2'>Statistical errors for the estimation of a single variance</h2><span id='topic+e4S2'></span>

<h3>Description</h3>

<p>This function computes the cofficient of variation and the margin of error when estimating a single variance under a sample design.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>e4S2(N, n, K = 0, DEFF = 1, conf = 0.95, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="e4S2_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="e4S2_+3A_n">n</code></td>
<td>
<p>The sample size.</p>
</td></tr>
<tr><td><code id="e4S2_+3A_k">K</code></td>
<td>
<p>The excess kurtosis of the variable in the population.</p>
</td></tr>
<tr><td><code id="e4S2_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="e4S2_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="e4S2_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We note that the coefficient of variation is defined as: </p>
<p style="text-align: center;"><code class="reqn">cve = \frac{\sqrt{Var(\hat{S^2})}}{\hat{S^2}}</code>
</p>
 
<p>Also, note that the magin of error is defined as: </p>
<p style="text-align: center;"><code class="reqn">\varepsilon = z_{1-\frac{\alpha}{2}}\sqrt{Var(\hat{S^2})}</code>
</p>



<h3>Value</h3>

<p>The coefficient of variation and the margin of error for a predefined sample size.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>e4S2(N=10000, n=400, K = 0)
e4S2(N=10000, n=400, K = 1, DEFF = 2, conf = 0.99)
e4S2(N=10000, n=400, K = 2, DEFF = 2, conf = 0.99, plot=TRUE)
</code></pre>

<hr>
<h2 id='ICC'>Intraclass Correlation Coefficient</h2><span id='topic+ICC'></span>

<h3>Description</h3>

<p>This function computes the intraclass correlation coefficient.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ICC(y, cl)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ICC_+3A_y">y</code></td>
<td>
<p>The variable of interest.</p>
</td></tr>
<tr><td><code id="ICC_+3A_cl">cl</code></td>
<td>
<p>The variable indicating the membership of each element to a specific cluster.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The intraclass correlation coefficient is defined as: 
</p>
<p style="text-align: center;"><code class="reqn">\rho = 1- \frac{m}{m-1} \frac{WSS}{TSS}</code>
</p>
 
<p>Where <code class="reqn">m</code> is the average sample sie of units selected inside each sampled cluster.
</p>


<h3>Value</h3>

<p>The total sum of squares (TSS), the between sum of squqres (BSS), the within sum of squares (WSS) and the intraclass correlation coefficient.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
##########################################
# Almost same mean in each cluster       #
#                                        #
# - Heterogeneity within clusters        #
# - Homogeinity between clusters         #
##########################################

# Population size
N &lt;- 100000
# Number of clusters in the population
NI &lt;- 1000
# Number of elements per cluster
N/NI

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- rep(1:NI, length.out=N)

table(cl)
tapply(y, cl, FUN=mean)
boxplot(y~cl)
rho = ICC(y,cl)$ICC
rho


##########################################
# Very different means per cluster       #
#                                        #
# - Heterogeneity between clusters       #
# - Homogeinity within clusters          #
##########################################

# Population size
N &lt;- 100000
# Number of clusters in the population
NI &lt;- 1000
# Number of elements per cluster
N/NI

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- kronecker(c(1:NI),rep(1,N/NI))

table(cl)
tapply(y, cl, FUN=mean)
boxplot(y~cl)
rho = ICC(y,cl)$ICC
rho

############################
# Example 1 with Lucy data #
############################

data(Lucy)
attach(Lucy)
N &lt;- nrow(Lucy)
y &lt;- Income
cl &lt;- Zone
ICC(y,cl)

############################
# Example 2 with Lucy data #
############################

data(Lucy)
attach(Lucy)
N &lt;- nrow(Lucy)
y &lt;- as.double(SPAM)
cl &lt;- Zone
ICC(y,cl)
</code></pre>

<hr>
<h2 id='ss2s4m'>Sample Sizes in Two-Stage sampling Designs for Estimating Signle Means</h2><span id='topic+ss2s4m'></span>

<h3>Description</h3>

<p>This function computes a grid of possible sample sizes for estimating single means under two-stage sampling designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss2s4m(N, mu, sigma, conf = 0.95, delta = 0.03, M, to = 20, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss2s4m_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_mu">mu</code></td>
<td>
<p>The value of the estimated mean of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_sigma">sigma</code></td>
<td>
<p>The value of the estimated standard deviation of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_delta">delta</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_m">M</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_to">to</code></td>
<td>
<p>(integer) maximum number of final units to be selected per cluster. By default <code>to = 20</code>.</p>
</td></tr>
<tr><td><code id="ss2s4m_+3A_rho">rho</code></td>
<td>
<p>The Intraclass Correlation Coefficient.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In two-stage (2S) sampling, the design effect is defined by
</p>
<p style="text-align: center;"><code class="reqn">DEFF = 1 + (m-1)\rho</code>
</p>
 
<p>Where <code class="reqn">\rho</code> is defined as the intraclass correlation coefficient,  
m is the average sample size of units selected inside each cluster. 
The relationship of the full sample size of the two stage design (2S) with the 
simple random sample (SI) design is given by
</p>
<p style="text-align: center;"><code class="reqn"> n_{2S} =  n_{SI}*DEFF</code>
</p>



<h3>Value</h3>

<p>This function returns a grid of possible sample sizes. 
The first column represent the design effect,
the second column is the number of clusters to be selected, 
the third column is the number of units to be selected inside the clusters, 
and finally, the last column indicates the full sample size induced by this particular strategy.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC">ICC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, rho=0.01)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, to=40, rho=0.1)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.03, M=50, to=40, rho=0.2)
ss2s4m(N=100000, mu=10, sigma=2, conf=0.95, delta=0.05, M=50, to=40, rho=0.3)

##########################################
# Almost same mean in each cluster       #
#                                        #
# - Heterogeneity within clusters        #
# - Homogeinity between clusters         #
#                                        #
#  Decision rule:                        #
#    * Select a lot of units per cluster #
#    * Select a few of clusters          #
##########################################

# Population size
N &lt;- 1000000
# Number of clusters in the population
M &lt;- 1000
# Number of elements per cluster
N/M

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- rep(1:M, length.out=N)

rho = ICC(y,cl)$ICC
rho

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)


##########################################
# Very different means per cluster       #
#                                        #
# - Heterogeneity between clusters       #
# - Homogeinity within clusters          #
#                                        #
#  Decision rule:                        #
#    * Select a few of units per cluster #
#    * Select a lot of clusters          #
##########################################

# Population size
N &lt;- 1000000
# Number of clusters in the population
M &lt;- 1000
# Number of elements per cluster
N/M

# The variable of interest
y &lt;- c(1:N)
# The clustering factor
cl &lt;- kronecker(c(1:M),rep(1,N/M))

rho = ICC(y,cl)$ICC
rho

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)

##########################
# Example with Lucy data #
##########################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
P &lt;- prop.table(table(SPAM))[1]
y &lt;- Income
cl &lt;- Segments

rho &lt;- ICC(y,cl)$ICC
M &lt;- length(levels(Segments))

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)

##########################
# Example with Lucy data #
##########################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
P &lt;- prop.table(table(SPAM))[1]
y &lt;- Years
cl &lt;- Segments

rho &lt;- ICC(y,cl)$ICC
M &lt;- length(levels(Segments))

ss2s4m(N, mu=mean(y), sigma=sd(y), conf=0.95, delta=0.03, M=M, rho=rho)
</code></pre>

<hr>
<h2 id='ss2s4p'>Sample Sizes in Two-Stage sampling Designs for Estimating Signle Proportions</h2><span id='topic+ss2s4p'></span>

<h3>Description</h3>

<p>This function computes a grid of possible sample sizes for estimating single proportions under two-stage sampling designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss2s4p(N, P, conf = 0.95, delta = 0.03, M, to = 20, rho)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss2s4p_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_p">P</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_delta">delta</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_m">M</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_to">to</code></td>
<td>
<p>(integer) maximum number of final units to be selected per cluster. By default <code>to = 20</code>.</p>
</td></tr>
<tr><td><code id="ss2s4p_+3A_rho">rho</code></td>
<td>
<p>The Intraclass Correlation Coefficient.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In two-stage (2S) sampling, the design effect is defined by
</p>
<p style="text-align: center;"><code class="reqn">DEFF = 1 + (\bar{m}-1)\rho</code>
</p>
 
<p>Where <code class="reqn">\rho</code> is defined as the intraclass correlation coefficient,  
<code class="reqn">\bar{m}</code> is the average sample size of units selected inside each cluster. 
The relationship of the full sample size of the two stage design (2S) with the 
simple random sample (SI) design is given by
</p>
<p style="text-align: center;"><code class="reqn"> n_{2S} =  n_{SI}*DEFF</code>
</p>



<h3>Value</h3>

<p>This function returns a grid of possible sample sizes. 
The first column represent the design effect,
the second column is the number of clusters to be selected, 
the third column is the number of units to be selected inside the clusters, 
and finally, the last column indicates the full sample size induced by this particular strategy.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC">ICC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ss2s4p(N=100000, P=0.5, delta=0.05, M=50, rho=0.01)
ss2s4p(N=100000, P=0.5, delta=0.05, M=500, to=40, rho=0.1)
ss2s4p(N=100000, P=0.5, delta=0.03, M=1000, to=100, rho=0.2) 

############################
# Example 2 with Lucy data #
############################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
P &lt;- prop.table(table(SPAM))[1]
y &lt;- Domains(SPAM)[, 1]
cl &lt;- Segments

rho &lt;- ICC(y,cl)$ICC
M &lt;- length(levels(Segments))
ss2s4p(N, P, conf=0.95, delta = 0.03, M=M, to=30, rho=rho)
</code></pre>

<hr>
<h2 id='ss4ddm'>The required sample size for estimating a double difference of means</h2><span id='topic+ss4ddm'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a double difference of means subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4ddm(
  N,
  mu1,
  mu2,
  mu3,
  mu4,
  sigma1,
  sigma2,
  sigma3,
  sigma4,
  DEFF = 1,
  conf = 0.95,
  cve = 0.05,
  rme = 0.03,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4ddm_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_mu3">mu3</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_mu4">mu4</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_sigma3">sigma3</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_sigma4">sigma4</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_rme">rme</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4ddm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{alpha}{2}}S^2}{\varepsilon^2 \mu^2}</code>
</p>
<p> and 
<code class="reqn">S^2=(\sigma_1^2 + \sigma_2^2 + \sigma_3^2 + \sigma_4^2) * (1 - (T * R)) * DEFF</code>
Also note that the minimun sample size to achieve a coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{|(\bar{y}_1-\bar{y}_2) - (\bar{y}_3-\bar{y}_4) |^2 cve^2 + \frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4ddm(N=100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, cve=0.05, rme=0.03)
ss4ddm(N=100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, cve=0.05, rme=0.03, plot=TRUE)
ss4ddm(N=100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, DEFF=3.45, conf=0.99, cve=0.03, 
     rme=0.03, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucyT0T1)
attach(BigLucyT0T1)

BigLucyT0 &lt;- BigLucyT0T1[Time == 0,]
BigLucyT1 &lt;- BigLucyT0T1[Time == 1,]
N1 &lt;- table(BigLucyT0$ISO)[1]
N2 &lt;- table(BigLucyT0$ISO)[2]
N &lt;- max(N1,N2)

BigLucyT0.yes &lt;- subset(BigLucyT0, ISO == "yes")
BigLucyT0.no &lt;- subset(BigLucyT0, ISO == "no")
BigLucyT1.yes &lt;- subset(BigLucyT1, ISO == "yes")
BigLucyT1.no &lt;- subset(BigLucyT1, ISO == "no")
mu1 &lt;- mean(BigLucyT0.yes$Income)
mu2 &lt;- mean(BigLucyT0.no$Income)
mu3 &lt;- mean(BigLucyT1.yes$Income)
mu4 &lt;- mean(BigLucyT1.no$Income)
sigma1 &lt;- sd(BigLucyT0.yes$Income)
sigma2 &lt;- sd(BigLucyT0.no$Income)
sigma3 &lt;- sd(BigLucyT1.yes$Income)
sigma4 &lt;- sd(BigLucyT1.no$Income)

# The minimum sample size for simple random sampling
ss4ddm(N, mu1, mu2, mu3, mu4, sigma1, sigma2, sigma3, sigma4, 
DEFF=1, conf=0.95, cve=0.001, rme=0.001, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4ddm(N, mu1, mu2, mu3, mu4, sigma1, sigma2, sigma3, sigma4, 
DEFF=3.45, conf=0.99, cve=0.03, rme=0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4ddmH'>The required sample size for testing a null hyphotesis for a double difference of proportions</h2><span id='topic+ss4ddmH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a double difference of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4ddmH(
  N,
  mu1,
  mu2,
  mu3,
  mu4,
  sigma1,
  sigma2,
  sigma3,
  sigma4,
  D,
  DEFF = 1,
  conf = 0.95,
  power = 0.8,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4ddmH_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_mu3">mu3</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_mu4">mu4</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_sigma3">sigma3</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the third population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_sigma4">sigma4</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the fourth population.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_d">D</code></td>
<td>
<p>The minimun effect to test.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4ddmH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: (mu_1 - mu_2) - (mu_3 - mu_4) = 0 \ \ \ \ vs. \ \ \ \ H_a: (mu_1 - mu_2) - (mu_3 - mu_4) = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, 
is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>where <code class="reqn">S^2=(\sigma_1^2 + \sigma_2^2 + \sigma_3^2 + \sigma_4^2) * (1 - (T * R)) * DEFF</code>
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4pH">ss4pH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4ddmH(N = 100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D=3)
ss4ddmH(N = 100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D=1, plot=TRUE)
ss4ddmH(N = 100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D=0.5, DEFF = 2, plot=TRUE)
ss4ddmH(N = 100000, mu1=50, mu2=55, mu3=50, mu4=65, 
sigma1 = 10, sigma2 = 12, sigma3 = 10, sigma4 = 12, D=0.5, DEFF = 2, conf = 0.99, 
       power = 0.9, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucyT0T1)
attach(BigLucyT0T1)

BigLucyT0 &lt;- BigLucyT0T1[Time == 0,]
BigLucyT1 &lt;- BigLucyT0T1[Time == 1,]
N1 &lt;- table(BigLucyT0$ISO)[1]
N2 &lt;- table(BigLucyT0$ISO)[2]
N &lt;- max(N1,N2)

BigLucyT0.yes &lt;- subset(BigLucyT0, ISO == 'yes')
BigLucyT0.no &lt;- subset(BigLucyT0, ISO == 'no')
BigLucyT1.yes &lt;- subset(BigLucyT1, ISO == 'yes')
BigLucyT1.no &lt;- subset(BigLucyT1, ISO == 'no')
mu1 &lt;- mean(BigLucyT0.yes$Income)
mu2 &lt;- mean(BigLucyT0.no$Income)
mu3 &lt;- mean(BigLucyT1.yes$Income)
mu4 &lt;- mean(BigLucyT1.no$Income)
sigma1 &lt;- sd(BigLucyT0.yes$Income)
sigma2 &lt;- sd(BigLucyT0.no$Income)
sigma3 &lt;- sd(BigLucyT1.yes$Income)
sigma4 &lt;- sd(BigLucyT1.no$Income)

# The minimum sample size for testing 
# H_0: (mu_1 - mu_2) - (mu_3 - mu_4) = 0   vs.   
# H_a: (mu_1 - mu_2) - (mu_3 - mu_4) = D = 3

ss4ddmH(N, mu1, mu2, mu3, mu4, sigma1, sigma2, sigma3, sigma4,
 D = 3, conf = 0.99, power = 0.9, DEFF = 3.45, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4ddp'>The required sample size for estimating a double difference of proportions</h2><span id='topic+ss4ddp'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a double difference of proportion subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4ddp(
  N,
  P1,
  P2,
  P3,
  P4,
  DEFF = 1,
  conf = 0.95,
  cve = 0.05,
  me = 0.03,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4ddp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion at first wave.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion at first wave.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_p3">P3</code></td>
<td>
<p>The value of the first estimated proportion at second wave.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_p4">P4</code></td>
<td>
<p>The value of the second estimated proportion at second wave.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_me">me</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4ddp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size (for each group at each wave) to achieve a particular margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{\alpha}{2}}S^2}{\varepsilon^2}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">S^2 = (P1 * Q1 + P2 * Q2 + P3 * Q3 + P4 * Q4) * (1 - (T * R)) * DEFF</code>
</p>

<p>Also note that the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{(ddp)^2cve^2+\frac{S^2}{N}}</code>
</p>
 
<p>And <code class="reqn">ddp</code> is the expected estimate of the double difference of proportions.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4dp">ss4dp</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4ddp(N=100000, P1=0.05, P2=0.55, P3= 0.5, P4= 0.6, cve=0.05, me=0.03)
ss4ddp(N=100000, P1=0.05, P2=0.55, P3= 0.5, P4= 0.6, cve=0.05, me=0.03, plot=TRUE)
ss4ddp(N=100000, P1=0.05, P2=0.55, P3= 0.5, P4= 0.6, DEFF=3.45, conf=0.99, 
cve=0.03, me=0.03, plot=TRUE)
ss4ddp(N=100000, P1=0.05, P2=0.55, P3= 0.5, P4= 0.6, DEFF=3.45, conf=0.99,
 cve=0.03, me=0.03, T = 0.5, R = 0.9, plot=TRUE)

#################################
# Example with BigLucyT0T1 data #
#################################
data(BigLucyT0T1)
attach(BigLucyT0T1)

BigLucyT0 &lt;- BigLucyT0T1[Time == 0,]
BigLucyT1 &lt;- BigLucyT0T1[Time == 1,]
N1 &lt;- table(BigLucyT0$SPAM)[1]
N2 &lt;- table(BigLucyT1$SPAM)[1]
N &lt;- max(N1,N2)
P1 &lt;- prop.table(table(BigLucyT0$ISO))[1]
P2 &lt;- prop.table(table(BigLucyT1$ISO))[1]
P3 &lt;- prop.table(table(BigLucyT0$ISO))[2]
P4 &lt;- prop.table(table(BigLucyT1$ISO))[2]
# The minimum sample size for simple random sampling
ss4ddp(N, P1, P2, P3, P4, conf=0.95, cve=0.05, me=0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4ddp(N, P1, P2, P3, P4, T = 0.5, R = 0.5, conf=0.95, cve=0.05, me=0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4ddpH'>The required sample size for testing a null hyphotesis for a double difference of proportions</h2><span id='topic+ss4ddpH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a double difference of proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4ddpH(
  N,
  P1,
  P2,
  P3,
  P4,
  D,
  DEFF = 1,
  conf = 0.95,
  power = 0.8,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4ddpH_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_p3">P3</code></td>
<td>
<p>The value of the thrid estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_p4">P4</code></td>
<td>
<p>The value of the fourth estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_d">D</code></td>
<td>
<p>The minimun effect to test.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4ddpH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: (P_1 - P_2) - (P_3 - P_4) = 0 \ \ \ \ vs. \ \ \ \ H_a:  (P_1 - P_2) - (P_3 - P_4) = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>Where <code class="reqn">S^2 = (P1 * Q1 + P2 * Q2 + P3 * Q3 + P4 * Q4) * (1 - (T * R)) * DEFF</code> and <code class="reqn">Q_i=1-P_i</code> for <code class="reqn">i=1,2, 3, 4</code>.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4pH">ss4pH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4ddpH(N = 100000, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, D=0.03)
ss4ddpH(N = 100000, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, D=0.03, plot=TRUE)
ss4ddpH(N = 100000, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, D=0.03, DEFF = 2, plot=TRUE)
ss4ddpH(N = 100000, P1 = 0.5, P2 = 0.5, P3 = 0.5, P4 = 0.5, 
D=0.03, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

#################################
# Example with BigLucyT0T1 data #
#################################
data(BigLucyT0T1)
attach(BigLucyT0T1)

BigLucyT0 &lt;- BigLucyT0T1[Time == 0,]
BigLucyT1 &lt;- BigLucyT0T1[Time == 1,]
N1 &lt;- table(BigLucyT0$SPAM)[1]
N2 &lt;- table(BigLucyT1$SPAM)[1]
N &lt;- max(N1,N2)
P1 &lt;- prop.table(table(BigLucyT0$ISO))[1]
P2 &lt;- prop.table(table(BigLucyT1$ISO))[1]
P3 &lt;- prop.table(table(BigLucyT0$ISO))[2]
P4 &lt;- prop.table(table(BigLucyT1$ISO))[2]
# The minimum sample size for simple random sampling
ss4ddpH(N, P1, P2, P3, P4, D = 0.05, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4ddpH(N, P1, P2, P3, P4, D = 0.05, DEFF = 2, T = 0.5, R = 0.5, conf=0.95, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4dm'>The required sample size for estimating a single difference of proportions</h2><span id='topic+ss4dm'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single proportion subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4dm(
  N,
  mu1,
  mu2,
  sigma1,
  sigma2,
  DEFF = 1,
  conf = 0.95,
  cve = 0.05,
  rme = 0.03,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4dm_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_rme">rme</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4dm_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{alpha}{2}}S^2}{\varepsilon^2 (\mu_1 - \mu_2)^2}</code>
</p>
<p> and 
<code class="reqn">S^2=(\sigma_1^2 + \sigma_2^2) * (1 - (T * R)) * DEFF</code>
Also note that the minimun sample size to achieve a coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{|\bar{y}_1-\bar{y}_2|^2 cve^2 + \frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4dm(N=100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, cve=0.05, rme=0.03)
ss4dm(N=100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, cve=0.05, rme=0.03, plot=TRUE)
ss4dm(N=100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, DEFF=3.45, conf=0.99, cve=0.03, 
     rme=0.03, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N1 &lt;- table(SPAM)[1]
N2 &lt;- table(SPAM)[2]
N &lt;- max(N1,N2)

BigLucy.yes &lt;- subset(BigLucy, SPAM == 'yes')
BigLucy.no &lt;- subset(BigLucy, SPAM == 'no')
mu1 &lt;- mean(BigLucy.yes$Income)
mu2 &lt;- mean(BigLucy.no$Income)
sigma1 &lt;- sd(BigLucy.yes$Income)
sigma2 &lt;- sd(BigLucy.no$Income)

# The minimum sample size for simple random sampling
ss4dm(N, mu1, mu2, sigma1, sigma2, DEFF=1, conf=0.99, cve=0.03, rme=0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4dm(N, mu1, mu2, sigma1, sigma2, DEFF=3.45, conf=0.99, cve=0.03, rme=0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4dmH'>The required sample size for testing a null hyphotesis for a single difference of proportions</h2><span id='topic+ss4dmH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a single difference of proportions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4dmH(
  N,
  mu1,
  mu2,
  sigma1,
  sigma2,
  D,
  DEFF = 1,
  conf = 0.95,
  power = 0.8,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4dmH_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_mu1">mu1</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_mu2">mu2</code></td>
<td>
<p>The value of the estimated mean of the variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_sigma1">sigma1</code></td>
<td>
<p>The value of the estimated variance of the variable of interes for the first population.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_sigma2">sigma2</code></td>
<td>
<p>The value of the estimated mean of a variable of interes for the second population.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_d">D</code></td>
<td>
<p>The minimun effect to test.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4dmH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: mu_1 - mu_2 = 0 \ \ \ \ vs. \ \ \ \ H_a: mu_1 - mu_2 = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, 
is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>where <code class="reqn">S^2=(\sigma_1^2 + \sigma_2^2) * (1 - (T * R)) * DEFF</code>
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4pH">ss4pH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4dmH(N = 100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, D=3)
ss4dmH(N = 100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, D=1, plot=TRUE)
ss4dmH(N = 100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, D=0.5, DEFF = 2, plot=TRUE)
ss4dmH(N = 100000, mu1=50, mu2=55, sigma1 = 10, sigma2 = 12, D=0.5, DEFF = 2, conf = 0.99, 
       power = 0.9, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N1 &lt;- table(SPAM)[1]
N2 &lt;- table(SPAM)[2]
N &lt;- max(N1,N2)

BigLucy.yes &lt;- subset(BigLucy, SPAM == 'yes')
BigLucy.no &lt;- subset(BigLucy, SPAM == 'no')
mu1 &lt;- mean(BigLucy.yes$Income)
mu2 &lt;- mean(BigLucy.no$Income)
sigma1 &lt;- sd(BigLucy.yes$Income)
sigma2 &lt;- sd(BigLucy.no$Income)

# The minimum sample size for testing 
# H_0: mu_1 - mu_2 = 0   vs.   H_a: mu_1 - mu_2 = D = 3
D = 3
ss4dmH(N, mu1, mu2, sigma1, sigma2, D, DEFF = 2, plot=TRUE)

# The minimum sample size for testing 
# H_0: mu_1 - mu_2 = 0   vs.   H_a: mu_1 - mu_2 = D = 3
D = 3
ss4dmH(N, mu1, mu2, sigma1, sigma2, D, conf = 0.99, power = 0.9, DEFF = 3.45, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4dp'>The required sample size for estimating a single difference of proportions</h2><span id='topic+ss4dp'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single proportion subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4dp(
  N,
  P1,
  P2,
  DEFF = 1,
  conf = 0.95,
  cve = 0.05,
  me = 0.03,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4dp_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_me">me</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4dp_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a particular margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{\alpha}{2}}S^2}{\varepsilon^2}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">S^2 = (P1 * Q1 + P2 * Q2) * (1 - (T * R)) * DEFF</code>
</p>

<p>Also note that the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{p^2cve^2+\frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4dp(N=100000, P1=0.5, P2=0.55, cve=0.05, me=0.03)
ss4dp(N=100000, P1=0.5, P2=0.55, cve=0.05, me=0.03, plot=TRUE)
ss4dp(N=100000, P1=0.5, P2=0.55, DEFF=3.45, conf=0.99, cve=0.03, me=0.03, plot=TRUE)
ss4dp(N=100000, P1=0.5, P2=0.55, DEFF=3.45, T=0.5, R=0.5, conf=0.99, cve=0.03, me=0.03, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N1 &lt;- table(SPAM)[1]
N2 &lt;- table(SPAM)[2]
N &lt;- max(N1,N2)
P1 &lt;- prop.table(table(SPAM))[1]
P2 &lt;- prop.table(table(SPAM))[2]
# The minimum sample size for simple random sampling
ss4dp(N, P1, P2, DEFF=1, conf=0.99, cve=0.03, me=0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4dp(N, P1, P2, DEFF=3.45, conf=0.99, cve=0.03, me=0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4dpH'>The required sample size for testing a null hyphotesis for a single difference of proportions</h2><span id='topic+ss4dpH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a single proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4dpH(
  N,
  P1,
  P2,
  D,
  DEFF = 1,
  conf = 0.95,
  power = 0.8,
  T = 0,
  R = 1,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4dpH_+3A_n">N</code></td>
<td>
<p>The maximun population size between the groups (strata) that we want to compare.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_p1">P1</code></td>
<td>
<p>The value of the first estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_p2">P2</code></td>
<td>
<p>The value of the second estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_d">D</code></td>
<td>
<p>The minimun effect to test.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_t">T</code></td>
<td>
<p>The overlap between waves. By default <code>T = 0</code>.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_r">R</code></td>
<td>
<p>The correlation between waves. By default <code>R = 1</code>.</p>
</td></tr>
<tr><td><code id="ss4dpH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: P_1 - P_2 = 0 \ \ \ \ vs. \ \ \ \ H_a: P_1 - P_2 = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>Where <code class="reqn">S^2 = (P1 * Q1 + P2 * Q2) * (1 - (T * R)) * DEFF</code> and <code class="reqn">Q_i=1-P_i</code> for <code class="reqn">i=1,2</code>.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4pH">ss4pH</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4dpH(N = 100000, P1 = 0.5, P2 = 0.55, D=0.03)
ss4dpH(N = 100000, P1 = 0.5, P2 = 0.55, D=0.03, plot=TRUE)
ss4dpH(N = 100000, P1 = 0.5, P2 = 0.55, D=0.03, DEFF = 2, plot=TRUE)
ss4dpH(N = 100000, P1 = 0.5, P2 = 0.55, D=0.03, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N1 &lt;- table(SPAM)[1]
N2 &lt;- table(SPAM)[2]
N &lt;- max(N1,N2)
P1 &lt;- prop.table(table(SPAM))[1]
P2 &lt;- prop.table(table(SPAM))[2]

# The minimum sample size for testing 
# H_0: P_1 - P_2 = 0   vs.   H_a: P_1 - P_2 = D = 0.05
D = 0.05  
ss4dpH(N, P1, P2, D, DEFF = 2, plot=TRUE)

# The minimum sample size for testing 
# H_0: P - P_0 = 0   vs.   H_a: P - P_0 = D = 0.02
D = 0.01
ss4dpH(N, P1, P2, D, conf = 0.99, power = 0.9, DEFF = 3.45, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4HHSm'>Sample Sizes for Household Surveys in Two-Stages for Estimating Single Means</h2><span id='topic+ss4HHSm'></span>

<h3>Description</h3>

<p>This function computes a grid of possible sample sizes for estimating single means under two-stage sampling designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4HHSm(N, M, rho, mu, sigma, delta, conf, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4HHSm_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_m">M</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_rho">rho</code></td>
<td>
<p>The Intraclass Correlation Coefficient.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_mu">mu</code></td>
<td>
<p>The value of the estimated mean of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_sigma">sigma</code></td>
<td>
<p>The value of the estimated standard deviation of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_delta">delta</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4HHSm_+3A_m">m</code></td>
<td>
<p>(vector) Number of households selected within PSU.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In two-stage (2S) sampling, the design effect is defined by
</p>
<p style="text-align: center;"><code class="reqn">DEFF = 1 + (\bar{m}-1)\rho</code>
</p>
 
<p>Where <code class="reqn">\rho</code> is defined as the intraclass correlation coefficient,  
<code class="reqn">\bar{m}</code> is the average sample size of units selected inside each cluster. 
The relationship of the full sample size of the two stage design (2S) with the 
simple random sample (SI) design is given by
</p>
<p style="text-align: center;"><code class="reqn"> n_{2S} =  n_{SI}*DEFF</code>
</p>



<h3>Value</h3>

<p>This function returns a grid of possible sample sizes. 
The first column represent the design effect,
the second column is the number of clusters to be selected, 
the third column is the number of units to be selected inside the clusters, 
and finally, the last column indicates the full sample size induced by this particular strategy.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC">ICC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ss4HHSm(N = 50000000, M = 3000, rho = 0.034, 
        mu = 10, sigma = 2, delta = 0.03, conf = 0.95,
        m = c(5:15))

##################################
# Example with BigCity data      #
# Sample size for the estimation #
# of the unemployment rate       #
##################################

library(TeachingSampling)
data(BigCity)

BigCity1 &lt;- BigCity %&gt;% 
            group_by(HHID) %&gt;%
            summarise(IncomeHH = sum(Income),
                      PSU = unique(PSU))
                      
summary(BigCity1$IncomeHH)
mean(BigCity1$IncomeHH)
sd(BigCity1$IncomeHH)

N &lt;- nrow(BigCity)
M &lt;- length(unique(BigCity$PSU))
rho &lt;- ICC(BigCity1$IncomeHH, BigCity1$PSU)$ICC
mu &lt;- mean(BigCity1$IncomeHH)
sigma &lt;- sd(BigCity1$IncomeHH)
delta &lt;- 0.05
conf &lt;- 0.95
m &lt;- c(5:15)
ss4HHSm(N, M, rho, mu, sigma, delta, conf, m)
</code></pre>

<hr>
<h2 id='ss4HHSp'>Sample Sizes for Household Surveys in Two-Stages for Estimating Single Proportions</h2><span id='topic+ss4HHSp'></span>

<h3>Description</h3>

<p>This function computes a grid of possible sample sizes for estimating single proportions under two-stage sampling designs.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4HHSp(N, M, r, b, rho, P, delta, conf, m)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4HHSp_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_m">M</code></td>
<td>
<p>Number of clusters in the population.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_r">r</code></td>
<td>
<p>Percentage of people within the subpopulation of interest.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_b">b</code></td>
<td>
<p>Average household size (number of members).</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_rho">rho</code></td>
<td>
<p>The Intraclass Correlation Coefficient.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_p">P</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_delta">delta</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4HHSp_+3A_m">m</code></td>
<td>
<p>(vector) Number of households selected within PSU.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>In two-stage (2S) sampling, the design effect is defined by
</p>
<p style="text-align: center;"><code class="reqn">DEFF = 1 + (\bar{m}-1)\rho</code>
</p>
 
<p>Where <code class="reqn">\rho</code> is defined as the intraclass correlation coefficient,  
<code class="reqn">\bar{m}</code> is the average sample size of units selected inside each cluster. 
The relationship of the full sample size of the two stage design (2S) with the 
simple random sample (SI) design is given by
</p>
<p style="text-align: center;"><code class="reqn"> n_{2S} =  n_{SI}*DEFF</code>
</p>



<h3>Value</h3>

<p>This function returns a grid of possible sample sizes. 
The first column represent the design effect,
the second column is the number of clusters to be selected, 
the third column is the number of units to be selected inside the clusters, 
and finally, the last column indicates the full sample size induced by this particular strategy.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ICC">ICC</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ss4HHSp(N = 50000000, M = 3000, r = 1, b = 3.5, 
rho = 0.034, P = 0.05, delta = 0.05, conf = 0.95,
m = c(5:15))

##################################
# Example with BigCity data      #
# Sample size for the estimation #
# of the unemployment rate       #
##################################

library(TeachingSampling)
data(BigCity)

BigCity1 &lt;- BigCity[!is.na(BigCity$Employment), ]
summary(BigCity1$Employment)
BigCity1$Unemp &lt;- Domains(BigCity1$Employment)[, 1]
BigCity1$Active &lt;- Domains(BigCity1$Employment)[, 1] +
Domains(BigCity1$Employment)[, 3]

N &lt;- nrow(BigCity)
M &lt;- length(unique(BigCity$PSU))
r &lt;- sum(BigCity1$Active)/N
b &lt;- N/length(unique(BigCity$HHID))
rho &lt;- ICC(BigCity1$Unemp, BigCity1$PSU)$ICC
P &lt;- sum(BigCity1$Unemp)/sum(BigCity1$Active)
delta &lt;- 0.05
conf &lt;- 0.95
m &lt;- c(5:15)
ss4HHSp(N, M, r, b, rho, P, delta, conf, m)
</code></pre>

<hr>
<h2 id='ss4m'>The required sample size for estimating a single mean</h2><span id='topic+ss4m'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single mean subjec to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4m(
  N,
  mu,
  sigma,
  DEFF = 1,
  conf = 0.95,
  error = "cve",
  delta = 0.03,
  plot = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4m_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_mu">mu</code></td>
<td>
<p>The value of the estimated mean of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_sigma">sigma</code></td>
<td>
<p>The value of the estimated standard deviation of a variable of interest.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_error">error</code></td>
<td>
<p>The type of error you want to minimize.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_delta">delta</code></td>
<td>
<p>The magnitude of the error you want to minimize.</p>
</td></tr>
<tr><td><code id="ss4m_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{alpha}{2}}S^2}{\varepsilon^2 \mu^2}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">S^2=\sigma^2 DEFF</code>
</p>

<p>Also note that the minimun sample size to achieve a coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\bar{y}_U^2 cve^2 + \frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4m(N=10000, mu=10, sigma=2, DEFF = 2, error = "cve", delta = 0.03, plot=TRUE)
ss4m(N=10000, mu=10, sigma=2, DEFF = 2, error = "me", delta = 1, plot=TRUE)
ss4m(N=10000, mu=10, sigma=2, DEFF = 2, error = "rme", delta = 0.03, plot=TRUE)

##########################
# Example with Lucy data #
##########################

data(Lucy)
attach(Lucy)
N &lt;- nrow(Lucy)
mu &lt;- mean(Income)
sigma &lt;- sd(Income)
# The minimum sample size for simple random sampling
ss4m(N, mu, sigma, DEFF=1, conf=0.95, error = "rme", delta = 0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4m(N, mu, sigma, DEFF=1, conf=0.95, error = "me", delta = 5, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4m(N, mu, sigma, DEFF=3.45, conf=0.95, error = "rme", delta = 0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4mH'>The required sample size for testing a null hyphotesis for a single mean</h2><span id='topic+ss4mH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a single mean
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4mH(N, mu, mu0, sigma, DEFF = 1, conf = 0.95, power = 0.8, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4mH_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_mu">mu</code></td>
<td>
<p>The population mean of the variable of interest.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_mu0">mu0</code></td>
<td>
<p>The value to test for the single mean.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_sigma">sigma</code></td>
<td>
<p>The population variance of the variable of interest.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4mH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: mu - mu_0 = 0 \ \ \ \ vs. \ \ \ \ H_a: mu - mu_0 = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>Where <code class="reqn">S^2=\sigma^2 * DEFF</code> and <code class="reqn">\sigma^2</code> is the population variance of the varible of interest.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4mH(N = 10000, mu = 500, mu0 = 505, sigma = 100)
ss4mH(N = 10000, mu = 500, mu0 = 505, sigma = 100, plot=TRUE)
ss4mH(N = 10000, mu = 500, mu0 = 505, sigma = 100, DEFF = 2, plot=TRUE)
ss4mH(N = 10000, mu = 500, mu0 = 505, sigma = 100, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N &lt;- nrow(BigLucy)
mu &lt;- mean(Income)
sigma &lt;- sd(Income)

# The minimum sample size for testing 
# H_0: mu - mu_0 = 0   vs.   H_a: mu - mu_0 = D = 15
D = 15 
mu0 = mu - D 
ss4mH(N, mu, mu0, sigma, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

# The minimum sample size for testing 
# H_0: mu - mu_0 = 0   vs.   H_a: mu - mu_0 = D = 32
D = 32
mu0 = mu - D 
ss4mH(N, mu, mu0, sigma, conf = 0.99, power = 0.9, DEFF = 3.45, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4p'>The required sample size for estimating a single proportion</h2><span id='topic+ss4p'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single proportion subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4p(N, P, DEFF = 1, conf = 0.95, error = "cve", delta = 0.03, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4p_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_p">P</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_error">error</code></td>
<td>
<p>The type of error you want to minimize.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_delta">delta</code></td>
<td>
<p>The magnitude of the error you want to minimize.</p>
</td></tr>
<tr><td><code id="ss4p_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a particular margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{1+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{\alpha}{2}}S^2}{\varepsilon^2}</code>
</p>

<p>and
</p>
<p style="text-align: center;"><code class="reqn">S^2=P(1-P)DEFF</code>
</p>

<p>Also note that the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{P^2cve^2+\frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4p(N=10000, P=0.05, error = "cve", delta=0.05, DEFF = 1, conf = 0.95, plot=TRUE)
ss4p(N=10000, P=0.05, error = "me", delta=0.05, DEFF = 1, conf = 0.95, plot=TRUE)
ss4p(N=10000, P=0.5, error = "rme", delta=0.05, DEFF = 1, conf = 0.95, plot=TRUE)

##########################
# Example with Lucy data #
##########################

data(Lucy)
attach(Lucy)
N &lt;- nrow(Lucy)
P &lt;- prop.table(table(SPAM))[1]
# The minimum sample size for simple random sampling
ss4p(N, P, DEFF=3.45, conf=0.95, error = "cve", delta = 0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4p(N, P, DEFF=3.45, conf=0.95, error = "rme", delta = 0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4p(N, P, DEFF=3.45, conf=0.95, error = "me", delta = 0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4pH'>The required sample size for testing a null hyphotesis for a single proportion</h2><span id='topic+ss4pH'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a single proportion.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4pH(N, p, p0, DEFF = 1, conf = 0.95, power = 0.8, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4pH_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_p">p</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_p0">p0</code></td>
<td>
<p>The value to test for the single proportion.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4pH_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: P - P_0 = 0 \ \ \ \ vs. \ \ \ \ H_a: P - P_0 = D \neq 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}+\frac{S^2}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">S^2=p(1-p)DEFF</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4pH(N = 10000, p = 0.5, p0 = 0.55)
ss4pH(N = 10000, p = 0.5, p0 = 0.55, plot=TRUE)
ss4pH(N = 10000, p = 0.5, p0 = 0.55, DEFF = 2, plot=TRUE)
ss4pH(N = 10000, p = 0.5, p0 = 0.55, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

N &lt;- nrow(BigLucy)
p &lt;- prop.table(table(SPAM))[1]

# The minimum sample size for testing 
# H_0: P - P_0 = 0   vs.   H_a: P - P_0 = D = 0.1
D = 0.1 
p0 = p - D 
ss4pH(N, p, p0, conf = 0.99, power = 0.9, DEFF = 2, plot=TRUE)

# The minimum sample size for testing 
# H_0: P - P_0 = 0   vs.   H_a: P - P_0 = D = 0.02
D = 0.02
p0 = p - D 
ss4pH(N, p, p0, conf = 0.99, power = 0.9, DEFF = 3.45, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4pLN'>The required sample size for estimating a single proportion based on a logaritmic transformation of the estimated proportion</h2><span id='topic+ss4pLN'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single proportion subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4pLN(N, P, DEFF = 1, cve = 0.05, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4pLN_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4pLN_+3A_p">P</code></td>
<td>
<p>The value of the estimated proportion.</p>
</td></tr>
<tr><td><code id="ss4pLN_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4pLN_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4pLN_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>As for low proportions, the coefficient of variation tends to infinity, it is customary to use
a simmetrycal transformation of this measure (based on the relative standard error RSE) to report
the uncertainity of the estimation. This way, if <code class="reqn">p \leq 0.5</code>, the transformed CV will be:
</p>
<p style="text-align: center;"><code class="reqn">RSE(-ln(p))= \frac{SE(p)}{-ln(p)*p}</code>
</p>

<p>Otherwise, when <code class="reqn">p &gt; 0.5</code>, the transformed CV will be:
</p>
<p style="text-align: center;"><code class="reqn">RSE(-ln(1-p))= \frac{SE(p)}{-ln(1-p)*(1-p)}</code>
</p>

<p>Note that, when <code class="reqn">p \leq 0.5</code> the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{P^2cve^2+\frac{S^2}{N}}</code>
</p>

<p>When <code class="reqn">p &gt; 0.5</code> the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S^2}{P^2cve^2+\frac{S^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4p">ss4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4pLN(N=10000, P=0.8, cve=0.10)
ss4pLN(N=10000, P=0.2, cve=0.10)
ss4pLN(N=10000, P=0.7, cve=0.05, plot=TRUE)
ss4pLN(N=10000, P=0.3, cve=0.05, plot=TRUE)
ss4pLN(N=10000, P=0.05, DEFF=3.45, cve=0.03, plot=TRUE)
ss4pLN(N=10000, P=0.95, DEFF=3.45, cve=0.03, plot=TRUE)

##########################
# Example with Lucy data #
##########################

data(Lucy)
attach(Lucy)
N &lt;- nrow(Lucy)
P &lt;- prop.table(table(SPAM))[1]
# The minimum sample size for simple random sampling
ss4pLN(N, P, DEFF=1, cve=0.03, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4pLN(N, P, DEFF=3.45, cve=0.03, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4S2'>The required sample size for estimating a single variance</h2><span id='topic+ss4S2'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for estimating a single variance subjecto to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4S2(N, K = 0, DEFF = 1, conf = 0.95, cve = 0.05, me = 0.03, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4S2_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_k">K</code></td>
<td>
<p>The population excess kurtosis of the variable in the population.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default conf = 0.95. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_cve">cve</code></td>
<td>
<p>The maximun coeficient of variation that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_me">me</code></td>
<td>
<p>The maximun margin of error that can be allowed for the estimation.</p>
</td></tr>
<tr><td><code id="ss4S2_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the errors (cve and margin of error) against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Note that the minimun sample size to achieve a particular relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{n_0}{\frac{(N-1)^3}{N^2(N*K+2N+2)}+\frac{n_0}{N}}</code>
</p>

<p>Where </p>
<p style="text-align: center;"><code class="reqn">n_0=\frac{z^2_{1-\frac{\alpha}{2}}*DEFF}{\varepsilon^2}</code>
</p>

<p>Also note that the minimun sample size to achieve a particular coefficient of variation <code class="reqn">cve</code> is defined by:
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{N^2(N*K+2N+2)*DEFF}{cve^2*(N-1)^3+N(N*K+2N+2)*DEFF}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ss4S2(N = 10000, K = 0, cve = 0.05, me = 0.03)
ss4S2(N = 10000, K = 1, cve = 0.05, me = 0.03)
ss4S2(N = 10000, K = 1, cve = 0.05, me = 0.05, DEFF = 2)
ss4S2(N = 10000, K = 1, cve = 0.05, me = 0.03, plot = TRUE)

#############################
# Example with BigLucy data #
#############################

data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
K &lt;- kurtosis(BigLucy$Income)
# The minimum sample size for simple random sampling
ss4S2(N, K, DEFF=1, conf=0.99, cve=0.03, me=0.1, plot=TRUE)
# The minimum sample size for a complex sampling design
ss4S2(N, K, DEFF=3.45, conf=0.99, cve=0.03, me=0.1, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4S2H'>The required sample size for testing a null hyphotesis for a single variance</h2><span id='topic+ss4S2H'></span>

<h3>Description</h3>

<p>This function returns the minimum sample size required for testing a null hyphotesis regarding a single variance
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4S2H(N, S2, S20, K = 0, DEFF = 1, conf = 0.95, power = 0.8, plot = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4S2H_+3A_n">N</code></td>
<td>
<p>The population size.</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_s2">S2</code></td>
<td>
<p>The value of the estimated variance</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_s20">S20</code></td>
<td>
<p>The value to test for the single variance</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_k">K</code></td>
<td>
<p>The excess kurtosis of the variable in the population.</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_deff">DEFF</code></td>
<td>
<p>The design effect of the sample design. By default <code>DEFF = 1</code>, which corresponds to a simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_power">power</code></td>
<td>
<p>The statistical power. By default <code>power = 0.80</code>.</p>
</td></tr>
<tr><td><code id="ss4S2H_+3A_plot">plot</code></td>
<td>
<p>Optionally plot the effect against the sample size.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>We assume that it is of interest to test the following set of hyphotesis:
</p>
<p style="text-align: center;"><code class="reqn">H_0: P - P_0 = 0 \ \ \ \ vs. \ \ \ \ H_a: P - P_0 = D &gt; 0 </code>
</p>

<p>Note that the minimun sample size, restricted to the predefined power <code class="reqn">\beta</code> and confidence <code class="reqn">1-\alpha</code>, is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{S2^2}{\frac{D^2}{(z_{1-\alpha} + z_{\beta})^2}\frac{(N-1)^3}{N^2(N*K+2N+2)}+\frac{S2^2}{N}}</code>
</p>



<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+e4p">e4p</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 0)
ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 2, DEFF = 2, power = 0.9)
ss4S2H(N = 10000, S2 = 120, S20 = 110, K = 2, DEFF = 2, power = 0.8, plot = TRUE)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)
N &lt;- nrow(BigLucy)
S2 &lt;- var(BigLucy$Income)

# The minimum sample size for testing 
# H_0: S2 - S2_0 = 0   vs.   H_a: S2 - S2_0 = D = 8000
D = 8000 
S20 = S2 - D 
K &lt;- kurtosis(BigLucy$Income)
ss4S2H(N, S2, S20, K, DEFF=1, conf = 0.99, power = 0.8, plot=TRUE)
</code></pre>

<hr>
<h2 id='ss4stm'>Sample Size for Estimation of Means in Stratified Sampling</h2><span id='topic+ss4stm'></span>

<h3>Description</h3>

<p>This function computes the minimum sample size required for estimating a single mean, in a stratified sampling, subject to predefined errors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ss4stm(Nh, muh, sigmah, DEFFh = 1, conf = 0.95, rme = 0.03)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ss4stm_+3A_nh">Nh</code></td>
<td>
<p>Vector. The population size for each stratum.</p>
</td></tr>
<tr><td><code id="ss4stm_+3A_muh">muh</code></td>
<td>
<p>Vector. The means of the variable of interest in each stratum.</p>
</td></tr>
<tr><td><code id="ss4stm_+3A_sigmah">sigmah</code></td>
<td>
<p>Vector. The standard deviation of the variable of interest in each stratum.</p>
</td></tr>
<tr><td><code id="ss4stm_+3A_deffh">DEFFh</code></td>
<td>
<p>Vector. The design effect of the sample design in each stratum. By default <code>DEFFh = 1</code>, which corresponds to a stratified simple random sampling design.</p>
</td></tr>
<tr><td><code id="ss4stm_+3A_conf">conf</code></td>
<td>
<p>The statistical confidence. By default <code>conf = 0.95</code>.</p>
</td></tr>
<tr><td><code id="ss4stm_+3A_rme">rme</code></td>
<td>
<p>The maximun relative margin of error that can be allowed for the estimation.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Let assume that the population U is partitioned in H strate. 
Under a stratified sampling, the neccesary sample size to achieve a relative margin of error <code class="reqn">\varepsilon</code> is defined by: 
</p>
<p style="text-align: center;"><code class="reqn">n = \frac{(\sum_{h=1}^H w_h S_h)^2}{\frac{\varepsilon^2}{z^2_{1-\frac{\alpha}{2}}}+\frac{\sum_{h=1}^H w_h S^2_h}{N}}</code>
</p>
 
<p>Where </p>
<p style="text-align: center;"><code class="reqn">S^2_h = DEFF_h \sigma^2_h</code>
</p>

<p>Then, the required sample size in each stratum is given by:
</p>
<p style="text-align: center;"><code class="reqn">n_h = n \frac{w_h S_h}{\sum_{h=1}^H w_h S_h}</code>
</p>



<h3>Value</h3>

<p>The required sample size for the sample and the required sample size per stratum.
</p>


<h3>Author(s)</h3>

<p>Hugo Andres Gutierrez Rojas &lt;hagutierrezro at gmail.com&gt;
</p>


<h3>References</h3>

<p>Gutierrez, H. A. (2009), <em>Estrategias de muestreo: Diseno de encuestas y estimacion de parametros</em>. Editorial Universidad Santo Tomas
</p>


<h3>See Also</h3>

<p><code><a href="#topic+ss4m">ss4m</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Nh &lt;- c(15000, 10000, 5000)
muh &lt;- c(300, 200, 100)
sigmah &lt;- c(200, 100, 20)
DEFFh &lt;- c(1, 1.2, 1.5)

ss4stm(Nh, muh, sigmah, rme=0.03)
ss4stm(Nh, muh, sigmah, conf = 0.99, rme=0.03)
ss4stm(Nh, muh, sigmah, DEFFh, conf= 0.99, rme=0.03)

##########################
# Example with Lucy data #
##########################
data(Lucy)
attach(Lucy)

Strata &lt;- as.factor(paste(Zone, Level))
levels(Strata)

Nh &lt;- summary(Strata)
muh &lt;- tapply(Income, Strata, mean)
sigmah &lt;- tapply(Income, Strata, sd)

ss4stm(Nh, muh, sigmah, DEFFh=1, conf = 0.95, rme = 0.03)
ss4stm(Nh, muh, sigmah, DEFFh=1.5, conf = 0.95, rme = 0.03)

#############################
# Example with BigLucy data #
#############################
data(BigLucy)
attach(BigLucy)

Nh &lt;- summary(Zone)
muh &lt;- tapply(Income, Zone, mean)
sigmah &lt;- tapply(Income, Zone, sd)

ss4stm(Nh, muh, sigmah, DEFFh=1, conf = 0.95, rme = 0.03)
ss4stm(Nh, muh, sigmah, DEFFh=1.5, conf = 0.95, rme = 0.03)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
