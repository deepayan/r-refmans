<!DOCTYPE html><html><head><title>Help for package berryFunctions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {berryFunctions}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#berryFunctions-package'><p>Berry's functions</p></a></li>
<li><a href='#addAlpha'><p>Color transparency</p></a></li>
<li><a href='#addFade'><p>Color fade out</p></a></li>
<li><a href='#addRows'><p>Add n rows to a data.frame</p></a></li>
<li><a href='#almost.equal'><p>Vectorized testing for near-equality</p></a></li>
<li><a href='#anhang'><p>open the Appendix of Rclick</p></a></li>
<li><a href='#approx2'><p>Smart linear NA interpolation</p></a></li>
<li><a href='#around'><p>View values around an index</p></a></li>
<li><a href='#betaPlot'><p>Beta density plot</p></a></li>
<li><a href='#betaPlotComp'><p>Compare beta distributions</p></a></li>
<li><a href='#between'><p>Are values between a and b?</p></a></li>
<li><a href='#bmap'><p>title</p></a></li>
<li><a href='#catPal'><p>Categorical color palette</p></a></li>
<li><a href='#checkFile'><p>check file existence</p></a></li>
<li><a href='#ciBand'><p>polygon confidence bands</p></a></li>
<li><a href='#circle'><p>Draw circle with a given radius</p></a></li>
<li><a href='#classify'><p>Classification into groups</p></a></li>
<li><a href='#climateGraph'><p>climate graph after Walter and Lieth</p></a></li>
<li><a href='#colPoints'><p>Points colored relative to third dimension</p></a></li>
<li><a href='#colPointsHist'><p>Histogram for colPoints</p></a></li>
<li><a href='#colPointsLegend'><p>Legend for colPoints</p></a></li>
<li><a href='#combineFiles'><p>Combine Textfiles into one</p></a></li>
<li><a href='#compareDist'><p>compare distributions</p></a></li>
<li><a href='#compareFiles'><p>Compare textfiles for equality</p></a></li>
<li><a href='#convertUmlaut'><p>Convert German Umlaute to ASCII</p></a></li>
<li><a href='#createFun'><p>create function framework</p></a></li>
<li><a href='#createPres'><p>Create .Rnw presentation template</p></a></li>
<li><a href='#dataStr'><p>str of datasets</p></a></li>
<li><a href='#distance'><p>Distance between points</p></a></li>
<li><a href='#divPal'><p>Diverging color palette</p></a></li>
<li><a href='#dupes'><p>Duplicate lines in file</p></a></li>
<li><a href='#exp4p'><p>4-parametric exponential function</p></a></li>
<li><a href='#expReg'><p>Exponential regression with plotting</p></a></li>
<li><a href='#funnelPlot'><p>Funnel plots for proportional data</p></a></li>
<li><a href='#funSource'><p>Source code of a function</p></a></li>
<li><a href='#getColumn'><p>get column from data.frame</p></a></li>
<li><a href='#getName'><p>get the name of an input in nested function calls</p></a></li>
<li><a href='#gof'><p>GOF measures</p></a></li>
<li><a href='#googleLink2pdf'><p>extract pdf link from google search result</p></a></li>
<li><a href='#groupHist'><p>Histogram for classes</p></a></li>
<li><a href='#headtail'><p>head and tail</p></a></li>
<li><a href='#horizHist'><p>Horizontal histogram</p></a></li>
<li><a href='#if.error'><p>expressions/values conditional on whether tested expression returns an error.</p></a></li>
<li><a href='#insertRows'><p>insert rows to data.frame</p></a></li>
<li><a href='#is.error'><p>Check if an expression returns an error</p></a></li>
<li><a href='#l2array'><p>Convert list of arrays to array</p></a></li>
<li><a href='#l2df'><p>List to data.frame</p></a></li>
<li><a href='#learnVocab'><p>spaced learning</p></a></li>
<li><a href='#legendmt'><p>legend with multiline title</p></a></li>
<li><a href='#library2'><p>install.package and library</p></a></li>
<li><a href='#lim0'><p>axis limits with one end at zero</p></a></li>
<li><a href='#linLogHist'><p>lin-log transition histogram</p></a></li>
<li><a href='#linLogTrans'><p>Animation for transition from linear to logarithmic axis</p></a></li>
<li><a href='#linReg'><p>linear regression with plotting</p></a></li>
<li><a href='#locArrow'><p>arrow at locator point in graph</p></a></li>
<li><a href='#locatorRS'><p>locator with immediate points in Rstudio</p></a></li>
<li><a href='#locLine'><p>abline at locator point in graph</p></a></li>
<li><a href='#logAxis'><p>Label logarithmic axes</p></a></li>
<li><a href='#logHist'><p>Histogram of logarithmic values</p></a></li>
<li><a href='#logSpaced'><p>Logarithmically spaced points</p></a></li>
<li><a href='#logVals'><p>Create log-axis values and labels</p></a></li>
<li><a href='#lsc'><p>Linear storage cascade, unit hydrograph</p></a></li>
<li><a href='#lsMem'><p>Show memory size of objects in MB</p></a></li>
<li><a href='#monthAxis'><p>Label date axis</p></a></li>
<li><a href='#monthLabs'><p>Nicely spaced labels along a month</p></a></li>
<li><a href='#movAv'><p>Moving average</p></a></li>
<li><a href='#movAvLines'><p>Moving average with different window widths</p></a></li>
<li><a href='#mReg'><p>Multiple regression</p></a></li>
<li><a href='#na9'><p>Prepend spaces before na.strings</p></a></li>
<li><a href='#nameSample'><p>Nonrandom character sequence with sample</p></a></li>
<li><a href='#newFilename'><p>Create new filename if file already exists</p></a></li>
<li><a href='#normalizePathCP'><p>normalizePath Cross Platform</p></a></li>
<li><a href='#normPlot'><p>Normal density plot</p></a></li>
<li><a href='#normTest'><p>Test values for normality of distribution</p></a></li>
<li><a href='#openFile'><p>open file in default application</p></a></li>
<li><a href='#openPDF'><p>open PDF file with sumatra viewer</p></a></li>
<li><a href='#owa'><p>Overwrite argument default lists</p></a></li>
<li><a href='#packagePath'><p>Base path of package</p></a></li>
<li><a href='#panelDim'><p>Arrange panels in a multipanel plot (par mfrow)</p></a></li>
<li><a href='#par_sapply'><p>cross-platform parallel processing with progbar</p></a></li>
<li><a href='#parallelCode'><p>code chunk for parallelization</p></a></li>
<li><a href='#pdfpng'><p>Create pdf and png graph</p></a></li>
<li><a href='#popleaf'><p>create leaflet popup box info</p></a></li>
<li><a href='#pretty2'><p>Truncated pretty breakpoints</p></a></li>
<li><a href='#quantileBands'><p>Quantile bands</p></a></li>
<li><a href='#quantileMean'><p>Average of R's quantile methods</p></a></li>
<li><a href='#rainbow2'><p>Rainbow from blue to red</p></a></li>
<li><a href='#removeSpace'><p>Remove white spaces from strings</p></a></li>
<li><a href='#rescale'><p>shift and scale a vector</p></a></li>
<li><a href='#round0'><p>Round numbers with leading and trailing zeros</p></a></li>
<li><a href='#roundedRect'><p>Rectangles with rounded corners</p></a></li>
<li><a href='#runAxis'><p>Label axis with typical running times</p></a></li>
<li><a href='#runRversions'><p>Run code in several R versions</p></a></li>
<li><a href='#runTime'><p>runnning time conversion</p></a></li>
<li><a href='#seasonality'><p>Seasonality analysis</p></a></li>
<li><a href='#seqPal'><p>Sequential color palette</p></a></li>
<li><a href='#seqR'><p>seq with a range argument</p></a></li>
<li><a href='#showPal'><p>show color palettes</p></a></li>
<li><a href='#smallPlot'><p>Inset small plot within figure</p></a></li>
<li><a href='#smoothLines'><p>draw smoothed lines</p></a></li>
<li><a href='#sortDF'><p>sort dataframes by column</p></a></li>
<li><a href='#spiralDate'><p>Spiral graph of time series</p></a></li>
<li><a href='#spiralDateAnim'><p>Animated spiral graph</p></a></li>
<li><a href='#sumatraInitialize'><p>Set useful Sumatra PDF Viewer default settings</p></a></li>
<li><a href='#superPos'><p>superposition of discharge, unit hydrograph</p></a></li>
<li><a href='#tableColVal'><p>Table with values with value-dependent colored backgrounds in pdf</p></a></li>
<li><a href='#testExamples'><p>Test examples in a package</p></a></li>
<li><a href='#textField'><p>Write text to plot with halo underneath</p></a></li>
<li><a href='#TFtest'><p>Test logical expressions</p></a></li>
<li><a href='#timeAxis'><p>Label date axis</p></a></li>
<li><a href='#timer'><p>Timer alarm</p></a></li>
<li><a href='#tmessage'><p>messages with call trace</p></a></li>
<li><a href='#traceCall'><p>call stack of a function</p></a></li>
<li><a href='#truncMessage'><p>truncate message parts</p></a></li>
<li><a href='#tryStack'><p>try an expression, returning the error stack</p></a></li>
<li><a href='#unitHydrograph'><p>Unit Hydrograph</p></a></li>
<li><a href='#write.tab'><p>write table with different defaults</p></a></li>
<li><a href='#yearPlot'><p>annual plot</p></a></li>
<li><a href='#yearSample'><p>Nonrandom year with sample</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Function Collection Related to Plotting and Hydrology</td>
</tr>
<tr>
<td>Version:</td>
<td>1.22.5</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-16</td>
</tr>
<tr>
<td>Imports:</td>
<td>grDevices, graphics, stats, utils, abind</td>
</tr>
<tr>
<td>Suggests:</td>
<td>RColorBrewer, pbapply, knitr, rmarkdown, gstat, RCurl,
colorspace, vioplot, spatstat.geom, ade4, nortest, rstudioapi,
leaflet, leaflet.extras, zoo</td>
</tr>
<tr>
<td>Author:</td>
<td>Berry Boessenkool</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Berry Boessenkool &lt;berry-b@gmx.de&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Draw horizontal histograms, color scattered points by 3rd dimension,
    enhance date- and log-axis plots, zoom in X11 graphics, trace errors and warnings, 
    use the unit hydrograph in a linear storage cascade, convert lists to data.frames and arrays, 
    fit multiple functions.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/brry/berryFunctions">https://github.com/brry/berryFunctions</a></td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/brry/berryFunctions">https://github.com/brry/berryFunctions</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-16 07:30:48 UTC; berry</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-16 11:30:07 UTC</td>
</tr>
</table>
<hr>
<h2 id='berryFunctions-package'>Berry's functions</h2><span id='topic+berryFunctions'></span><span id='topic+berryFunctions-package'></span>

<h3>Description</h3>

<p>Draw horizontal histograms, color scattered points by 3rd dimension, enhance date- and log-axis plots, zoom in X11 graphics, trace errors and warnings, use the unit hydrograph in a linear storage cascade, convert lists to data.frames and arrays, fit multiple functions.
</p>


<h3>Note</h3>

<p>Collection of functions, mainly connected with graphics and hydrology.<br />
- zoom in X11 graphics<br />
- plot rainfall-runoff data and optimize parameters for the unit hydrograph in the linear storage cascade<br />
- write text to plots on top of colored fields in label size (halo-effect)<br />
- draw scatterplots colored by 3rd dimension (as in image, which only deals with grids)<br />
- draw histograms horizontally<br />
- advancedly label date axes and logarithmic axes<br />
- fit multiple functions (power, reciprocal, exponential, logarithmic, polynomial, rational) by regression<br />
- convert lists to data.frames<br />
- and more...
</p>
<p>At some places you'll find <code>## not run</code> in the examples. These code
blocks were excluded from checking while building, mainly because they are
interactive and need mouseclicks, or because they open another device/file.
Normally, you should be able to run them in an interactive session. If you
do find non-executable code, please tell me!<br />
Feel free to suggest packages in which these functions would fit well.<br />
I strongly depend on - and therefore welcome - any feedback!<br /><br />
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011-2017
</p>


<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/brry/berryFunctions">https://github.com/brry/berryFunctions</a>
</p>
</li>
<li><p> Report bugs at <a href="https://github.com/brry/berryFunctions">https://github.com/brry/berryFunctions</a>
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# see   vignette("berryFunctions")

</code></pre>

<hr>
<h2 id='addAlpha'>Color transparency</h2><span id='topic+addAlpha'></span>

<h3>Description</h3>

<p>Make existing colors semi-transparent (add alpha)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addAlpha(col, alpha = 0.3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addAlpha_+3A_col">col</code></td>
<td>
<p>Vector of color names (<code><a href="grDevices.html#topic+colors">colors</a></code>), hexadecimal or integer that can be interpreted by <code><a href="grDevices.html#topic+col2rgb">col2rgb</a></code></p>
</td></tr>
<tr><td><code id="addAlpha_+3A_alpha">alpha</code></td>
<td>
<p>Level of semi-transparency. between 0 (transparent) and 1 (intransparent). Can also be a vector. DEFAULT: 0.3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>character vector with hexadecimal color codes.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, June 2014 Based on suggestion by Mathias Seibert, Dec. 2013
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addFade">addFade</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>, <code><a href="grDevices.html#topic+colors">colors</a></code>, <code><a href="grDevices.html#topic+col2rgb">col2rgb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
addAlpha("red", c(0.1, 0.3, 0.6, 1))
addAlpha(1:3)
addAlpha(1:3, 1:3/3)
NewColors &lt;- addAlpha(c("red","blue","yellow","green", "purple"), 0:200/200)
plot(runif(1000), col=NewColors, pch=16, cex=2)

# use addFade for line segments, because of overlapping dots
set.seed(1); x &lt;- cumsum(rnorm(30))  ; y &lt;- x-2
plot(x, type="n")
segments(x0=1:29,y0=head(x,-1), x1=2:30,y1=x[-1], col=addAlpha(4, 29:0/30), lwd=10)
segments(x0=1:29,y0=head(y,-1), x1=2:30,y1=y[-1], col=addFade (4, 29:0/30), lwd=10)

</code></pre>

<hr>
<h2 id='addFade'>Color fade out</h2><span id='topic+addFade'></span>

<h3>Description</h3>

<p>Make existing colors fade away to white
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addFade(col, fade = 0.3, target = "white", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addFade_+3A_col">col</code></td>
<td>
<p>Vector of color names (<code><a href="grDevices.html#topic+colors">colors</a></code>), hexadecimal or integer that can be interpreted by <code><a href="grDevices.html#topic+col2rgb">col2rgb</a></code></p>
</td></tr>
<tr><td><code id="addFade_+3A_fade">fade</code></td>
<td>
<p>Level of fading towards target. between 0 (target) and 1 (col). Can also be a vector. DEFAULT: 0.3</p>
</td></tr>
<tr><td><code id="addFade_+3A_target">target</code></td>
<td>
<p>Target color that should be faded into. DEFAULT: &quot;white&quot;</p>
</td></tr>
<tr><td><code id="addFade_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>character matrix with hexadecimal color codes.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addAlpha">addAlpha</a></code>, <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code>, <code><a href="grDevices.html#topic+colors">colors</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(1:11, pch=16, cex=3, col=addFade(2, 10:0/10))
plot(1:11, pch=16, cex=3, col=addFade(2, 10:0/10, target="blue"))
plot(1:11, pch=16, cex=3, col=addFade(2, 10:0/10, target=3:4))
plot(1:21, pch=16, cex=3, col=addFade(2:3, 10:0/10))
plot(1:21, pch=16, cex=3, col=addFade(2:3, 10:0/10, target=4:5))
NewColors &lt;- addFade(c("red","blue","yellow","green", "purple"), 0:200/200)
plot(runif(1000), col=NewColors, pch=16, cex=2)

</code></pre>

<hr>
<h2 id='addRows'>Add n rows to a data.frame</h2><span id='topic+addRows'></span>

<h3>Description</h3>

<p>simple Helper-Function to add n rows to a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addRows(df, n, values = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addRows_+3A_df">df</code></td>
<td>
<p>Dataframe object</p>
</td></tr>
<tr><td><code id="addRows_+3A_n">n</code></td>
<td>
<p>Number of rows to add</p>
</td></tr>
<tr><td><code id="addRows_+3A_values">values</code></td>
<td>
<p>Values to be used in the new rows. DEFAULT: NA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A data.frame
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+insertRows">insertRows</a></code>, <code><a href="#topic+sortDF">sortDF</a></code>, 
<code><a href="base.html#topic+data.frame">data.frame</a></code>, <code><a href="base.html#topic+matrix">matrix</a></code>, <code><a href="base.html#topic+rbind">rbind</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
MYDF &lt;- data.frame(A=5:3, B=2:4)
addRows(MYDF, 3)

</code></pre>

<hr>
<h2 id='almost.equal'>Vectorized testing for near-equality</h2><span id='topic+almost.equal'></span>

<h3>Description</h3>

<p>Vectorized testing for near-equality with <code><a href="base.html#topic+all.equal">all.equal</a></code>.
Since elements are recycled, this will not work for environments.
You <em>can</em> use <code>almost.equal</code> directly in <code>if</code> expressions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>almost.equal(x, y, scale = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="almost.equal_+3A_x">x</code>, <code id="almost.equal_+3A_y">y</code></td>
<td>
<p>R objects to be compared with each other, recycled to max length</p>
</td></tr>
<tr><td><code id="almost.equal_+3A_scale">scale</code></td>
<td>
<p>DEFAULT scale=1 for absolute comparison for numbers. 
use scale=NULL for relative comparison (<code>all.equal</code> default).</p>
</td></tr>
<tr><td><code id="almost.equal_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+all.equal">all.equal</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical vector
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+all.equal">all.equal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# General usage:
x &lt;- c(0.4-0.1, 0.5-0.2)
x
x==0.3                    # FALSE TRUE # but mathematically, x is 0.3
all.equal(x, rep(0.3,2))  # TRUE
almost.equal(x,0.3)       # TRUE TRUE  # nice

y &lt;- c(7777, 0.3)
   all.equal(x,y) # "Mean relative difference: 25922.33"   Not what I want
almost.equal(x,y) # FALSE TRUE                             Exactly what I want


# Absolute vs relative comparison, https://stackoverflow.com/questions/57578257

   all.equal(6.2, 6.4, tolerance=0.04) # TRUE - unexpected!
almost.equal(6.2, 6.4, tolerance=0.04) # FALSE, thanks to default scale=1
almost.equal(6.2, 6.4, tolerance=0.04, scale=NULL) # as with all.equal


# Testing vectorization
almost.equal(1:6, 3)
almost.equal(1:6, NA)
almost.equal(1:6, NULL)


# Testing the function for different data types (in order of coercion):
almost.equal(c(TRUE,FALSE,NA), c(TRUE,FALSE,NA))      # logical
almost.equal(as.factor(letters), as.factor(letters))  # factor
   all.equal(1:6, 1:6)
almost.equal(1:6, 1:6)                                # integer  numeric see above
0.4+0.4i - 0.1-0.1i == 0.3+0.3i
almost.equal(0.4+0.4i - 0.1-0.1i, 0.3+0.3i)           # complex
   all.equal(letters, tolower(LETTERS))
almost.equal(letters, tolower(LETTERS))               # character
almost.equal(Sys.Date()+1:4,Sys.Date()+1:4)           # Date
x &lt;- Sys.time()+0:2
all.equal(x,x)
almost.equal(x,x)                                     # POSIXt
A &lt;- list(a=1:5, b=0.5-0.2)
B &lt;- list(a=1:5, b=0.4-0.1)
   all.equal(A,B)
almost.equal(A,B)                                     # list


</code></pre>

<hr>
<h2 id='anhang'>open the Appendix of Rclick</h2><span id='topic+anhang'></span>

<h3>Description</h3>

<p>Open the Appendix of my R handbook found online at
<a href="https://github.com/brry/rclick">https://github.com/brry/rclick</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anhang()
</code></pre>


<h3>Value</h3>

<p>None, opens pdf in default viewer using <code><a href="base.html#topic+system2">system2</a></code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jul 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+funSource">funSource</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># anhang() # excluded from cran check because of external browser opening policy

</code></pre>

<hr>
<h2 id='approx2'>Smart linear NA interpolation</h2><span id='topic+approx2'></span>

<h3>Description</h3>

<p>Smart interpolation: as <code><a href="stats.html#topic+approx">approx</a></code>, approx2 fills NAs in a vector with linear interpolation,
but unlike <code><a href="stats.html#topic+approx">approx</a></code>, it can handle NAs at the ends of a vector
(takes the first/last value available for those). Also, approx2 returns a vector only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>approx2(x, fill = NULL, n = length(x), quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="approx2_+3A_x">x</code></td>
<td>
<p>Vector with (numeric) values</p>
</td></tr>
<tr><td><code id="approx2_+3A_fill">fill</code></td>
<td>
<p>Function to fill NAs at the start or end of the vector. See Details. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="approx2_+3A_n">n</code></td>
<td>
<p>Number of points to interpolate to</p>
</td></tr>
<tr><td><code id="approx2_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress warning for no non-NA values? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="approx2_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="stats.html#topic+approx">approx</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function fill is used to fill missing values at the ends of the vector.
It could be mean or median, for example, but must be a function that accepts <code>na.rm=TRUE</code> as an argument.
The default (NULL) means to use the first (or last) observation available.
</p>


<h3>Value</h3>

<p>Vector with NAs replaced with interpolation (not a list, as in <code><a href="stats.html#topic+approx">approx</a></code>!)
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2015
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+approx">approx</a></code>, zoo::na.locf, <code><a href="#topic+ciBand">ciBand</a></code> for usage example
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
approx2(c(NA,NA))   # yields a message
approx2(c(NA,NA, 6, 4, 8, 9, 3, 2, 1)) # fills with first non-NA value
approx2(c( 2,NA, 6, 4, 8, 9, 3, 2, 1)) # interpolates linearly
approx2(c( 2, 4, 6, 4, 8, 9,NA, 2,NA)) # linear, then last non-NA at end

approx2(c(NA,NA, 6, 4, 8, 9, 3, 2, 1))
approx2(c(NA,NA, 6, 4, 8, 9, 3, 2, 1), fill=median) # first median, then linear
approx2(c(NA,NA, 6, 4, 8, 9, 3, 2, 1), fill=mean)

approx2(c( 3, 4, 6, 4, 8, 9,NA, 2,NA))
approx2(c( 3, 4, 6, 4, 8, 9,NA, 2,NA), fill=median)
approx2(c( 3, 4, 6, 4, 8, 9,NA, 2,NA), fill=mean)

approx2(c(NA,NA, 6, 4, 8, 9, 3, 2, 1), n=17)
approx2(c( 2,NA, 6, 4, 8, 9, 3, 2, 1), n=17)
approx2(c( 2, 4, 6, 4, 8, 9,NA, 2,NA), n=17)

</code></pre>

<hr>
<h2 id='around'>View values around an index</h2><span id='topic+around'></span>

<h3>Description</h3>

<p>View index rows of a data.frame with n surrounding rows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>around(x, i, n1 = 2, n2 = n1, convert = is.logical(i))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="around_+3A_x">x</code></td>
<td>
<p>Data.frame</p>
</td></tr>
<tr><td><code id="around_+3A_i">i</code></td>
<td>
<p>Index (logical or integers)</p>
</td></tr>
<tr><td><code id="around_+3A_n1">n1</code></td>
<td>
<p>Number of elements shown before each i. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="around_+3A_n2">n2</code></td>
<td>
<p>Number of elements shown after each i. DEFAULT: n1</p>
</td></tr>
<tr><td><code id="around_+3A_convert">convert</code></td>
<td>
<p>Use <code><a href="base.html#topic+which">which</a></code> to get the row numbers?
DEFAULT: TRUE if i is boolean</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing, calls <code><a href="utils.html#topic+View">View</a></code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+sortDF">sortDF</a></code>, <code><a href="utils.html#topic+View">View</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  ## View should not be used in examples
myDF &lt;- data.frame(A=1:30, B=cumsum(rnorm(30)))
myDF[c(5,7,23,29),1] &lt;- NA
around(myDF, i=is.na(myDF$A))
around(myDF, i=c(11,19), n2=0)

## End(Not run)

</code></pre>

<hr>
<h2 id='betaPlot'>Beta density plot</h2><span id='topic+betaPlot'></span>

<h3>Description</h3>

<p>Quick and nice plot of beta density distribution based on just alpha and beta
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaPlot(
  shape1 = 1.5,
  shape2 = 5,
  lines = NA,
  fill = rgb(0, 0.3, 0.8, 0.4),
  cumulative = TRUE,
  mar = c(2, 3, 3, 3),
  keeppar = FALSE,
  las = 1,
  main = paste("Beta density with\nalpha =", signif(shape1, 3), "and beta =",
    signif(shape2, 3)),
  ylim = lim0(y),
  xlim = 0:1,
  ylab = "",
  xlab = "",
  type = "l",
  lty = 1,
  col = par("fg"),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaPlot_+3A_shape1">shape1</code></td>
<td>
<p>Alpha value as in <code><a href="stats.html#topic+dbeta">dbeta</a></code>. DEFAULT: 1.5</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_shape2">shape2</code></td>
<td>
<p>Beta value. DEFAULT: 5</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_lines">lines</code></td>
<td>
<p>Quantiles at which vertical lines should be plotted. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_fill">fill</code></td>
<td>
<p>Color passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>. DEFAULT: rgb(0,0.3,0.8, 0.4)</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_cumulative">cumulative</code></td>
<td>
<p>Should cumulative density distribution be added? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_mar">mar</code></td>
<td>
<p>Margins for plot passed to <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: c(2,3,3,3)</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_keeppar">keeppar</code></td>
<td>
<p>Should margin parameters be kept instead of being restored to previous value? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_las">las</code></td>
<td>
<p>Label orientation, argument passed to <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_main">main</code></td>
<td>
<p>main as in <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: paste(&quot;Beta density with\nalpha =&quot;, shape1, &quot;and beta =&quot;, shape2)</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_ylim">ylim</code>, <code id="betaPlot_+3A_xlim">xlim</code></td>
<td>
<p>limit for the y and x axis. DEFAULT: lim0(y), 0:1</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_ylab">ylab</code>, <code id="betaPlot_+3A_xlab">xlab</code></td>
<td>
<p>labels for the axes. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_type">type</code>, <code id="betaPlot_+3A_lty">lty</code>, <code id="betaPlot_+3A_col">col</code></td>
<td>
<p>arguments passed to <code><a href="base.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+lines">lines</a></code>.</p>
</td></tr>
<tr><td><code id="betaPlot_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="base.html#topic+plot">plot</a></code> like lwd, xaxs, cex.axis, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function very quickly plots a beta distribution by just specifying alpha and beta.
</p>


<h3>Value</h3>

<p>None. Used for plotting.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaPlotComp">betaPlotComp</a></code>, <code><a href="#topic+normPlot">normPlot</a></code>, <code><a href="stats.html#topic+dbeta">dbeta</a></code>,
<a href="https://cran.r-project.org/package=denstrip">https://cran.r-project.org/package=denstrip</a>,
<a href="https://cran.r-project.org/view=Distributions">https://cran.r-project.org/view=Distributions</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
betaPlot()
betaPlot(2,1)
betaPlot(0.5, 2)

# beta distribution is often used for proportions or probabilities
# overview of parameters
# alpha = number of successes + 1.  beta = number of failures + 1
betaPlotComp()
# a bigger: HDI (Highest Density Interval) further to the right (1)
# b bigger: HDI more to the left (0)
# both bigger: narrower HDI, stronger peak

</code></pre>

<hr>
<h2 id='betaPlotComp'>Compare beta distributions</h2><span id='topic+betaPlotComp'></span>

<h3>Description</h3>

<p>Visually understand the effect of the beta distribution parameters
</p>


<h3>Usage</h3>

<pre><code class='language-R'>betaPlotComp(
  shape1 = c(0.5, 1:4, 10, 20),
  shape2 = shape1,
  cumulative = FALSE,
  cex = 0.8,
  las = 1,
  main = "",
  ylim = lim0(4),
  mar = rep(0, 4),
  oma = c(2, 2, 4.5, 2),
  mgp = c(3, 0.7, 0),
  keeppar = FALSE,
  textargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="betaPlotComp_+3A_shape1">shape1</code></td>
<td>
<p>Vector of alpha values as in <code><a href="stats.html#topic+dbeta">dbeta</a></code>. DEFAULT: c(0.5, 1:4, 10,20)</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_shape2">shape2</code></td>
<td>
<p>Beta values to be compared. DEFAULT: shape1</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_cumulative">cumulative</code></td>
<td>
<p>Should the cumulative density distribution line be added? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_cex">cex</code></td>
<td>
<p>Character EXpansion size. DEFAULT: 0.8</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_las">las</code></td>
<td>
<p>Label Axis Style passed to <code><a href="graphics.html#topic+axis">axis</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_main">main</code></td>
<td>
<p>Main as in <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_ylim">ylim</code></td>
<td>
<p>LIMit for the Y axis. DEFAULT: lim0(4)</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_mar">mar</code></td>
<td>
<p>MARgins for plot passed to <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: rep(0,4)</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_oma">oma</code></td>
<td>
<p>Outer MArgins for plot passed to <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: c(2,2,4.5,2)</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_mgp">mgp</code></td>
<td>
<p>MarGin Placement. DEFAULT: c(3,0.7,0)</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_keeppar">keeppar</code></td>
<td>
<p>Should margin parameters be kept instead of being restored to previous value? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_textargs">textargs</code></td>
<td>
<p>List of arguments passed to <code><a href="#topic+textField">textField</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="betaPlotComp_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+betaPlot">betaPlot</a></code> like lines, fill, etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Used for plotting.
</p>


<h3>Note</h3>

<p>Tries to find suitable subplot for axis labels. This works only for increasing parameter values.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaPlot">betaPlot</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
betaPlotComp()
betaPlotComp(oma=c(2,2,2,2), ylim=lim0(5.5), textargs=list(y=NA))
betaPlotComp(shape1=c(3,10,34), shape2=c(7,9,24))

</code></pre>

<hr>
<h2 id='between'>Are values between a and b?</h2><span id='topic+between'></span>

<h3>Description</h3>

<p>Are values within a certain interval?
Basically a wrapper for <code> x &gt;= a   &amp;   x &lt;= b </code> to save repeating long x names twice.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>between(x, a, b = a, incl = TRUE, aincl = incl, bincl = incl, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="between_+3A_x">x</code></td>
<td>
<p>Numerical vector</p>
</td></tr>
<tr><td><code id="between_+3A_a">a</code>, <code id="between_+3A_b">b</code></td>
<td>
<p>Numerical values/vectors specifying the borders of the interval.
<code><a href="base.html#topic+min">min</a></code> and <code>max</code> are used, so they can be a vector.</p>
</td></tr>
<tr><td><code id="between_+3A_incl">incl</code></td>
<td>
<p>Logical. Include values on the borders? For x == border, TRUE
will be returned. Specify per left and right border separately
with the arguments <code>aincl</code> and <code>bincl</code>. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="between_+3A_aincl">aincl</code>, <code id="between_+3A_bincl">bincl</code></td>
<td>
<p>Logical. Include values on left and right border, respectively?
DEFAULT: <code>incl</code></p>
</td></tr>
<tr><td><code id="between_+3A_quiet">quiet</code></td>
<td>
<p>Logical. Suppress warning if a&gt;b? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical (boolean) vector with TRUE/FALSE values
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+findInterval">findInterval</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>between(1:10, 4, 8)
between(1:10, 4:8) # range as vector
between(1:10, 8, 4) # warns about interval

data.frame( incl.T=between(1:10, 4, 8),
            incl.F=between(1:10, 4, 8,  incl=FALSE),
           aincl.F=between(1:10, 4, 8, aincl=FALSE),
           bincl.F=between(1:10, 4, 8, bincl=FALSE)  )

</code></pre>

<hr>
<h2 id='bmap'>title</h2><span id='topic+bmap'></span>

<h3>Description</h3>

<p>description
</p>


<h3>Usage</h3>

<pre><code class='language-R'>bmap(x = 13.12, y = 52.37, zm = 14, prov = NULL, collapsebg = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="bmap_+3A_x">x</code>, <code id="bmap_+3A_y">y</code>, <code id="bmap_+3A_zm">zm</code></td>
<td>
<p>passed to <code>leaflet::<a href="leaflet.html#topic+setView">setView</a></code></p>
</td></tr>
<tr><td><code id="bmap_+3A_prov">prov</code></td>
<td>
<p>named vector of providers. DEFAULT: NULL (nice selection)</p>
</td></tr>
<tr><td><code id="bmap_+3A_collapsebg">collapsebg</code></td>
<td>
<p>Collapse background (map) layer selection? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="bmap_+3A_...">...</code></td>
<td>
<p>Ignored for now</p>
</td></tr>
</table>


<h3>Value</h3>

<p>ReturnValue
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2022
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(requireNamespace("leaflet", quietly=TRUE) &amp;&amp; 
   requireNamespace("leaflet.extras", quietly=TRUE))
bmap()

</code></pre>

<hr>
<h2 id='catPal'>Categorical color palette</h2><span id='topic+catPal'></span>

<h3>Description</h3>

<p>Categorical color palette according to IwantHue as displayed on
<a href="https://rockcontent.com/blog/subtleties-of-color-different-types-of-data-require-different-color-schemes/">https://rockcontent.com/blog/subtleties-of-color-different-types-of-data-require-different-color-schemes/</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>catPal(n = 12, set = 1, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="catPal_+3A_n">n</code></td>
<td>
<p>Number of colors, max 12. DEFAULT: 12</p>
</td></tr>
<tr><td><code id="catPal_+3A_set">set</code></td>
<td>
<p>Integer for which set to use. Currently, only 1 is implemented.</p>
</td></tr>
<tr><td><code id="catPal_+3A_alpha">alpha</code></td>
<td>
<p>Transparency (0=transparent, 1=fully colored). DEFAULT: 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string vector with color names
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2019
</p>


<h3>See Also</h3>

<p><code><a href="#topic+showPal">showPal</a></code>, <code><a href="#topic+seqPal">seqPal</a></code>, <code><a href="#topic+divPal">divPal</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(rep(1,12), pch=16, cex=5, col=catPal(12), xaxt="n")
showPal()
plot(cumsum(rnorm(40)), type="l", col=catPal()[1], ylim=c(-10,10))
for(i in 2:6) lines(cumsum(rnorm(40)), col=catPal()[i])
</code></pre>

<hr>
<h2 id='checkFile'>check file existence</h2><span id='topic+checkFile'></span>

<h3>Description</h3>

<p>check whether files exist and give a useful error/warning/message
</p>


<h3>Usage</h3>

<pre><code class='language-R'>checkFile(file, warnonly = FALSE, trace = TRUE, pwd = TRUE, nprint = 2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="checkFile_+3A_file">file</code></td>
<td>
<p>Filename(s) as character string to be checked for existence.</p>
</td></tr>
<tr><td><code id="checkFile_+3A_warnonly">warnonly</code></td>
<td>
<p>Logical: Only issue a <code><a href="base.html#topic+warning">warning</a></code> instead of an
error with <code><a href="base.html#topic+stop">stop</a></code>? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="checkFile_+3A_trace">trace</code></td>
<td>
<p>Logical: Add function call stack to the message? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="checkFile_+3A_pwd">pwd</code></td>
<td>
<p>Logical: Print working directory in message? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="checkFile_+3A_nprint">nprint</code></td>
<td>
<p>Integer: number of filenames to be printed. 
The rest is abbreviated with (and n others). DEFAULT: 2</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE/FALSE, invisibly
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+file.exists">file.exists</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.error( checkFile("FileThatDoesntExist.txt")  )
checkFile("FileThatDoesntExist.txt", warnonly=TRUE)
checkFile("FileThatDoesntExist.txt", warnonly=TRUE, trace=FALSE)

checkFile("./", warnonly=TRUE)
checkFile(c("./",".//"), warnonly=TRUE)

## Not run: ## Excluded from CRAN checks because of file creation
# Vectorized:
file.create("DummyFile2.txt")
checkFile("DummyFile2.txt/")
checkFile(paste0("DummyFile",1:3,".txt"), warnonly=TRUE)
is.error(checkFile(paste0("DummyFile",1:3,".txt") ), TRUE, TRUE)
file.remove("DummyFile2.txt")

is.error(compareFiles("dummy.nonexist", "dummy2.nonexist"), TRUE, TRUE)
is.error(checkFile("dummy.nonexist"), TRUE, TRUE)

## End(Not run)

dingo &lt;- function(k="brute.nonexist", trace=TRUE)
         checkFile(k, warnonly=TRUE, trace=trace)
dingo()
dingo("dummy.nonexist")

upper &lt;- function(h, ...) dingo(c(h, "dumbo.nonexist"), ...)
upper("dumbo2.nonexist")
upper(paste0("dumbo",2:8,".nonexist"))
upper(paste0("dumbo",2:8,".nonexist"), trace=FALSE)


</code></pre>

<hr>
<h2 id='ciBand'>polygon confidence bands</h2><span id='topic+ciBand'></span>

<h3>Description</h3>

<p><code><a href="graphics.html#topic+polygon">polygon</a></code> for confidence interval bands, can handle NA's well
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ciBand(
  yu,
  yl,
  ym = NULL,
  x = 1:length(yu),
  na = "interpolate",
  nastars = TRUE,
  singlepoints = TRUE,
  args = NULL,
  add = FALSE,
  lwd = 1,
  colm = "green3",
  colb = addAlpha(colm),
  border = NA,
  las = 1,
  ylim = range(yu, yl, finite = TRUE),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="ciBand_+3A_yu">yu</code></td>
<td>
<p>y values of upper confidence region boundary</p>
</td></tr>
<tr><td><code id="ciBand_+3A_yl">yl</code></td>
<td>
<p>y values of lower confidence region boundary</p>
</td></tr>
<tr><td><code id="ciBand_+3A_ym">ym</code></td>
<td>
<p>y values of middle/median/mean line. Only added if this argument is given. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="ciBand_+3A_x">x</code></td>
<td>
<p>x values (one ascending vector). DEFAULT: 1:length(yu)</p>
</td></tr>
<tr><td><code id="ciBand_+3A_na">na</code></td>
<td>
<p>Method used at NA points. One of &quot;interpolate&quot; or &quot;remove&quot;. DEFAULT: &quot;interpolate&quot;</p>
</td></tr>
<tr><td><code id="ciBand_+3A_nastars">nastars</code></td>
<td>
<p>If na=&quot;interpolate&quot;, should stars be drawn at places that used to be NA? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="ciBand_+3A_singlepoints">singlepoints</code></td>
<td>
<p>If na=&quot;remove&quot;, add points for places surrounded by NAs?
can be a boolean (T/F) vector of length three for upper, lower, median.
Code to identify isolated points is taken from wq::plotTs. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="ciBand_+3A_args">args</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+points">points</a></code> for the previous two arguments. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="ciBand_+3A_add">add</code></td>
<td>
<p>Add to existing plot? If FALSE, plot is called before adding confidence interval. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="ciBand_+3A_lwd">lwd</code></td>
<td>
<p>Line width of middle line. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="ciBand_+3A_colm">colm</code></td>
<td>
<p>Color for median/mean line. DEFAULT: &quot;green3&quot;</p>
</td></tr>
<tr><td><code id="ciBand_+3A_colb">colb</code></td>
<td>
<p>Color of the confidence region band. DEFAULT: addAlpha(colm)</p>
</td></tr>
<tr><td><code id="ciBand_+3A_border">border</code></td>
<td>
<p><code><a href="graphics.html#topic+polygon">polygon</a></code> border. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="ciBand_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle (axis labels turned upright, see <code><a href="graphics.html#topic+par">par</a></code>). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="ciBand_+3A_ylim">ylim</code></td>
<td>
<p>limits of plot. DEFAULT: range(yu,yl, finite=TRUE)</p>
</td></tr>
<tr><td><code id="ciBand_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+plot">plot</a></code> - or maybe better polygon??</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, currently. Used for drawing.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+quantileBands">quantileBands</a></code>, <code><a href="graphics.html#topic+polygon">polygon</a></code>, <code><a href="#topic+approx2">approx2</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
y1 &lt;- c(1,3,4,2,1,4,6,8,7)
y2 &lt;- c(5,6,5,6,9,8,8,9,10)
y3 &lt;- c(4,4,5,4,4,6,7,8,9)
ciBand(yl=y1, yu=y2, ym=y3)

y1[6:7] &lt;- NA
ciBand(yl=y1, yu=y2, ym=y3) # interpolation marked with stars if nastars=TRUE
ciBand(yl=y1, yu=y2, ym=y3, na="remove")
lines(y1, col=3, type="o")
lines(y2, col=3, type="o")

y2[1] &lt;- NA
ciBand(yl=y1, yu=y2, ym=y3) # next observation carried backwards (NAs at begin)
# LOCF (last observation carried forwards if NAs at end)
# See ?approx2 for median/mean imputation in these cases
ciBand(yl=y1, yu=y2, ym=y3, na="remove")
y2[9] &lt;- NA
ciBand(yl=y1, yu=y2, ym=y3)
ciBand(yl=y1, yu=y2, ym=y3, na="remove")  # NAs at both ends
y2[1] &lt;- 5
ciBand(yl=y1, yu=y2, ym=y3)
ciBand(yl=y1, yu=y2, ym=y3, na="remove")  # NA only at end

# Actual usefull stuff:  sample size dependency of max and mean
ssdep_max &lt;- function(n) quantile(  replicate(n=200, expr=max(rnorm(n)) )  )
ssdep_mean&lt;- function(n) quantile(  replicate(n=200,expr=mean(rnorm(n)) )  )
x &lt;- 1:100
res_max &lt;- sapply(x, ssdep_max)
res_mean &lt;- sapply(x, ssdep_mean)
ciBand(yl=res_max[2,], yu=res_max[4,], ym=res_max[3,], x=x, ylim=c(-0.5, 3))
ciBand(res_mean[2,], res_mean[4,], res_mean[3,], x=x, add=TRUE, colm="purple")

</code></pre>

<hr>
<h2 id='circle'>Draw circle with a given radius</h2><span id='topic+circle'></span>

<h3>Description</h3>

<p>Draws a filled circle with a certain radius (in existing plot's units) using <code><a href="graphics.html#topic+polygon">polygon</a></code> and <code><a href="base.html#topic+sin">sin</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>circle(x, y, r, locnum = 100, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="circle_+3A_x">x</code></td>
<td>
<p>x coordinate of points, numeric value of length 1</p>
</td></tr>
<tr><td><code id="circle_+3A_y">y</code></td>
<td>
<p>y coordinate</p>
</td></tr>
<tr><td><code id="circle_+3A_r">r</code></td>
<td>
<p>radius of the circle in units of current plot.
Can have two values for an ellipse.</p>
</td></tr>
<tr><td><code id="circle_+3A_locnum">locnum</code></td>
<td>
<p>number of calculated points on the circle (more means smoother but slower). DEFAULT: 100</p>
</td></tr>
<tr><td><code id="circle_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>, like col, border, lwd</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame of coordinates, invisible
</p>


<h3>Note</h3>

<p>If circles look like ellipsis, use plot(... asp=1)
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2012
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+symbols">symbols</a></code>, <code><a href="graphics.html#topic+polygon">polygon</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(1:20, type="n", asp=1)
circle(5,5, r=3)   # 1:1 aspect shows they're really circles and not ellipses.
circle(15,10, r=4, locnum=12, col=2, border=4, lwd=3)

# can not be vectorized:
x &lt;- sample(1:20, 15) ;  y &lt;- sample(1:20, 15) ; r &lt;- runif(20)*3
circle(x,y,r, col=rgb(1,0.5,0,alpha=0.4), border=NA)
for(i in 1:15) circle(x[i],y[i],r[i], col=rgb(1,0.5,0,alpha=0.4), border=NA)

</code></pre>

<hr>
<h2 id='classify'>Classification into groups</h2><span id='topic+classify'></span>

<h3>Description</h3>

<p>classify continuous values into categories with different methods:<br />
- linearly or logarithmically spaced equal intervals,<br />
- intervals based on quantiles (equally filled bins),<br />
- intervals based on  distance from the mean in normal distributions,<br />
- user specified class borders (e.g. for legal or critical limits).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>classify(
  x,
  method = "linear",
  breaks = NULL,
  Range = range(x, finite = TRUE),
  col = NULL,
  sdlab = 1,
  logbase = 1,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="classify_+3A_x">x</code></td>
<td>
<p>Vector with numeric values</p>
</td></tr>
<tr><td><code id="classify_+3A_method">method</code></td>
<td>
<p>Character string (partial matching is performed).
Classification method (type of binning) to compute the
class breakpoints. See section Details. DEFAULT: &quot;linear&quot;</p>
</td></tr>
<tr><td><code id="classify_+3A_breaks">breaks</code></td>
<td>
<p>Specification for method, see Details.
DEFAULT: NULL (different defaults for each method)</p>
</td></tr>
<tr><td><code id="classify_+3A_range">Range</code></td>
<td>
<p>Ends of intervals. DEFAULT: range(x, finite=TRUE)</p>
</td></tr>
<tr><td><code id="classify_+3A_col">col</code></td>
<td>
<p>Function that will return a color palette, e.g. <code><a href="#topic+seqPal">seqPal</a></code>.
If given, a vector of colors is returned instead of the regular list.
DEFAULT: NULL (ignored)</p>
</td></tr>
<tr><td><code id="classify_+3A_sdlab">sdlab</code></td>
<td>
<p>Type of label and breakpoints if <code>method=standarddeviation</code>.
1 means <code>-0.5 sd, 0.5 sd</code>, 2 means <code>-1 sd, mean, 1 sd</code>,
3 means actual numbers for type 1, 4 means numbers for type 2.
DEFAULT: 1</p>
</td></tr>
<tr><td><code id="classify_+3A_logbase">logbase</code></td>
<td>
<p>base for <code><a href="#topic+logSpaced">logSpaced</a></code>. Used only if not 1 and method=&quot;log&quot;.
DEFAULT: 1</p>
</td></tr>
<tr><td><code id="classify_+3A_quiet">quiet</code></td>
<td>
<p>Suppress warnings, eg for values outside Range? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="classify_+3A_...">...</code></td>
<td>
<p>Further arguments passed to the function <code>col</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Binning methods are explained very nicely in the link in the section References.<br />
<em>nbins</em> indicates the number of classes (and thus, colors).<br /> <br />
</p>

<table>
<tr>
 <td style="text-align: left;">
<b><code>method</code></b> </td><td style="text-align: left;"> |  explanation                   </td><td style="text-align: left;"> |  meaning of <code>breaks</code>                    </td><td style="text-align: left;"> |  default </td>
</tr>
<tr>
 <td style="text-align: left;">
----------     </td><td style="text-align: left;"> |  -----------                         </td><td style="text-align: left;"> |  -----------                                 </td><td style="text-align: left;"> |  ------- </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>linear</b>  </td><td style="text-align: left;"> |  <em>nbins</em> equally spaced classes </td><td style="text-align: left;"> |  <em>nbins</em>                                </td><td style="text-align: left;"> |  100     </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>log</b>     </td><td style="text-align: left;"> |  <em>nbins</em> logarithmically spaced </td><td style="text-align: left;"> |  <em>nbins</em>                                </td><td style="text-align: left;"> |  100     </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>quantile</b></td><td style="text-align: left;"> |  classes have equal number of values </td><td style="text-align: left;"> |  the quantiles (or number of them)           </td><td style="text-align: left;"> |  0:4/4   </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>sd</b>      </td><td style="text-align: left;"> |  normal distributions                </td><td style="text-align: left;"> |  number of sd in one direction from the mean </td><td style="text-align: left;"> |  3       </td>
</tr>
<tr>
 <td style="text-align: left;">
<b>custom</b>  </td><td style="text-align: left;"> |  user-given breakpoints              </td><td style="text-align: left;"> |  breakpoint values (including ends of Range) </td><td style="text-align: left;"> |  none    </td>
</tr>
<tr>
 <td style="text-align: left;">
</td>
</tr>

</table>

<p>The default is set to equalinterval which makes sense for my original intent
of plotting lake depth (bathymetry measured at irregularly distributed points) on a linear color scale.<br />
This is the workhorse for <code><a href="#topic+colPoints">colPoints</a></code>.<br />
</p>


<h3>Value</h3>

<p>if <code>col=NULL</code>, a list with class numbers (index) and other 
elements for <code><a href="#topic+colPoints">colPoints</a></code>. If <code>col</code> is a palette function,
a vector of colors.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2014
</p>


<h3>References</h3>

<p>See this page on the effect of classification (binning) methods: <br />
<a href="http://uxblog.idvsolutions.com/2011/10/telling-truth.html">http://uxblog.idvsolutions.com/2011/10/telling-truth.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colPoints">colPoints</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
classify( c(1:10, 20), "lin", breaks=12)
classify( c(1:10, 20), "q", breaks=0:10/10)
classify( c(1:10, 20), "s", sdlab=2 )
classify( c(1:10, 20), "s", sdlab=1, breaks=2 )
classify( c(1:10, 20), "c", breaks=c(5,27) )
classify( c(1:10, 20), "log")

cols &lt;- classify( c(1:10, 20), col=seqPal) ; cols
plot(c(1:10, 20), col=cols, pch=16, cex=2)

set.seed(42); rz &lt;- rnorm(30, mean=350, sd=120)
plot(1)
classleg &lt;- function(method="linear", breaks=100, sdlab=1, logbase=1, ...)
           do.call(colPointsLegend, owa(
           classify(rz, method=method, breaks=breaks, sdlab=sdlab, logbase=logbase),
           list(z=rz, title="", ...))   )
classleg(br=3, met="s", col=divPal(5),mar=c(0,3,1,0),hor=FALSE,x1=0.1,x2=0.25)
classleg(br=3, met="s", col=divPal(6),mar=c(0,3,1,0),hor=FALSE,x1=0.25,x2=0.4, sdlab=2)
classleg(y1=0.85, y2=1)
classleg(br=20, met="log", y1=0.70, y2=0.85)
classleg(br=20, met="log", y1=0.55, y2=0.70, logbase=1.15)
classleg(br=20, met="log", y1=0.45, y2=0.60, logbase=0.90)
classleg(br= 5, met="q", y1=0.30, y2=0.45)# quantiles: each color is equally often used
classleg(met="q", y1=0.15, y2=0.30, breaks=0:15/15, at=pretty2(rz), labels=pretty2(rz) )

</code></pre>

<hr>
<h2 id='climateGraph'>climate graph after Walter and Lieth</h2><span id='topic+climateGraph'></span>

<h3>Description</h3>

<p>Draw a climate diagram by the standards of Walter and Lieth.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>climateGraph(temp, rain,
  main = "StatName\n52\U{00B0}24' N / 12\U{00B0}58' E\n42 m aSL",
  units = c("\U{00B0}C", "mm"), labs = substr(month.abb, 1, 1), 
  textprop = 0.25, ylim = range(temp, rain/2), compress = FALSE,
  ticklab = -8:30 * 10, ticklin = -15:60 * 5, box = TRUE,
  mar = c(1.5, 2.3, 4.5, 0.2), keeppar = TRUE, colrain = "blue",
  coltemp = "red", lwd = 2, arghumi = NULL, argarid = NULL,
  argcomp = NULL, arggrid = NULL, argtext = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="climateGraph_+3A_temp">temp</code></td>
<td>
<p>monthly temperature mean in degrees C</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_rain">rain</code></td>
<td>
<p>monthly rain sum in mm (12 values)</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_main">main</code></td>
<td>
<p>location info as character string. can have \n.
DEFAULT: &quot;StatName\n52d 24' N / 12d 58' E\n42 m aSL&quot;</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_units">units</code></td>
<td>
<p>units used for labeling. DEFAULT: c(&quot;d C&quot;, &quot;mm&quot;)</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_labs">labs</code></td>
<td>
<p>labels for x axis. DEFAULT: J,F,M,A,M,J,J,A,S,O,N,D</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_textprop">textprop</code></td>
<td>
<p>proportion of graphic that is used for writing the values
in a table to the right. DEFAULT: 0.25</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_ylim">ylim</code></td>
<td>
<p>limit for y axis in temp units. DEFAULT: range(temp, rain/2)</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_compress">compress</code></td>
<td>
<p>should rain&gt;100 mm be compressed with adjusted labeling?
(not recommended for casual visualization!). DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_ticklab">ticklab</code></td>
<td>
<p>positions for vertical labeling. DEFAULT: -8:30*10</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_ticklin">ticklin</code></td>
<td>
<p>positions for horizontal line drawing. DEFAULT: -15:60*5</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_box">box</code></td>
<td>
<p>draw box along outer margins of graph? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_mar">mar</code></td>
<td>
<p>plot margins. DEFAULT: c(1.5,2.3,4.5,0.2)</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_keeppar">keeppar</code></td>
<td>
<p>Keep the changed graphical parameters? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_colrain">colrain</code></td>
<td>
<p>Color for rain line and axis labels. DEFAULT: &quot;blue&quot;</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_coltemp">coltemp</code></td>
<td>
<p>color for temperature line and axis labels. DEFAULT: &quot;red&quot;</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_lwd">lwd</code></td>
<td>
<p>line width of actual temp and rain lines. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_arghumi">arghumi</code></td>
<td>
<p>List of arguments for humid <code><a href="graphics.html#topic+polygon">polygon</a></code>,
like density, angle. DEFAULT: NULL (internal x,y, col, border)</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_argarid">argarid</code></td>
<td>
<p>List of arguments for arid area. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_argcomp">argcomp</code></td>
<td>
<p>List of arguments for compressed rainfall polygon. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_arggrid">arggrid</code></td>
<td>
<p>List of arguments for background grid lines. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_argtext">argtext</code></td>
<td>
<p>List of arguments for text at right hand if textprop&gt;0. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="climateGraph_+3A_...">...</code></td>
<td>
<p>further arguments passed to plot, like col.main</p>
</td></tr>
</table>


<h3>Value</h3>

<p>None. Plots data and table.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, June 2013
</p>


<h3>References</h3>

<p>Heinrich Walter, Helmut Lieth: Klimadiagramm-Weltatlas. Gustav Fischer Verlag, Jena 1967
</p>


<h3>See Also</h3>

<p><code>diagwl</code> in package <code>climatol</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
temp &lt;- c(-9.3,-8.2,-2.8,6.3,13.4,16.8,18.4,17,11.7,5.6,-1,-5.9)#
rain &lt;- c(46,46,36,30,31,21,26,57,76,85,59,46)

climateGraph(temp, rain)
climateGraph(temp, rain, textprop=0.6)
climateGraph(temp, rain, mar=c(2,3,4,3), textprop=0) # no table written to the right
# vertical lines instead of filled polygon:
climateGraph(temp, rain, arghumi=list(density=15, angle=90))
# fill color for arid without transparency:
climateGraph(temp, rain, argarid=list(col="gold"))
# for the Americans - axes should be different, though!:
climateGraph(temp, rain, units=c("\U{00B0}F","in"))

rain2 &lt;- c(23, 11, 4, 2, 10, 53, 40, 15, 21, 25, 29, 22)
# fix ylim if you want to compare diagrams of different stations:
climateGraph(temp, rain2, ylim=c(-15, 50)) # works with two arid phases as well

op &lt;- par(mfrow=c(2,1)) # mulipanel plot
climateGraph(temp, rain, argtext=list(cex=0.7))
climateGraph(temp, rain2, argtext=list(cex=0.7))
par(op)

rain &lt;- c(54, 23, 5, 2, 5, 70, 181, 345, 265, 145, 105, 80) # with extrema
climateGraph(temp, rain) # August can be visually compared to June
climateGraph(temp, rain, compress=TRUE)
# compressing extrema enables a better view of the temperature,
# but heigths of rain cannot be visually compared anymore
climateGraph(temp, rain, compress=TRUE, ylim=c(-10, 90))
# needs ylim in linearly continued temp units
climateGraph(temp, rain, compress=TRUE, argcomp=list(density=30, col="green"))

# example with (fake) weekly relative soil moisture (RSM) added:
temp &lt;- c(-9.3,-8.2,-2.8,6.3,13.4,16.8,18.4,17,11.7,5.6,-1,-5.9)
rain &lt;- c(46,46,36,30,31,21,26,57,76,85,59,46)
set.seed(3)
soil &lt;- berryFunctions::rescale( cumsum(rnorm(52)), from=1, to=100)
xsoil &lt;- seq(1, 12, length.out=52)

climateGraph(temp, rain, ylim=c(-10, 50) ) # ylim for RSM 0:100 on second axis
lines(xsoil, soil/2, lwd=5, col="orange")

mtext(paste("Relative\nsoil moisture\n\U00D8", round(mean(soil), 1), "%"), 
      side=3, col="orange", line=1, adj=0.99)


## Not run: 
pdf("ClimateGraph.pdf")
climateGraph(temp, rain, main="Another Station\nlocated somewhere else")
dev.off()
openFile("ClimateGraph.pdf")
unlink("ClimateGraph.pdf")

# further German reading:
browseURL("https://www.klimadiagramme.de/all.html")


# Climate Graphs for the USA:
NOOAlink &lt;- "https://www1.ncdc.noaa.gov/pub/data/normals/1981-2010/"
browseURL(NOOAlink)
# Find your Station here:
browseURL(paste0(NOOAlink,"/station-inventories/allstations.txt"))

# Data from Roseburg, Oregon:
download.file(destfile="Roseburg.txt", url=paste0("https://www1.ncdc.noaa.gov/",
          "pub/data/normals/1981-2010/products/station/USC00357331.normals.txt"))
RT &lt;- read.table(file="Roseburg.txt", skip=11, nrows=1, as.is=TRUE)[1,-1]
RT &lt;- ( as.numeric(substr(RT,1,3))/10   - 32) * 5/9     # converted to degrees C
RP &lt;- read.table(file="Roseburg.txt", skip=580, nrows=1, as.is=TRUE)[1,-1]
RP &lt;-  as.numeric(substr(RP,1,nchar(RP)-1))/100*25.4
meta &lt;- read.table(file="Roseburg.txt", nrows=5, as.is=TRUE, sep=":")
meta &lt;- paste(meta[1,2], paste(meta[3:4 ,2], collapse=" /"), meta[5,2], sep="\n")
unlink("Roseburg.txt")

climateGraph(RT, RP, main=meta)
climateGraph(RT, RP, main=meta, compress=TRUE)


# Climate Graphs for Germany:
browseURL("https://github.com/brry/rdwd#rdwd")
link &lt;- rdwd::selectDWD("Potsdam", res="monthly", var="kl", per="h")
file &lt;- rdwd::dataDWD(link, dir=tempdir(), read=FALSE)
clim &lt;- rdwd::readDWD(file)
rdwd::readVars(file)
temp &lt;- tapply(clim$MO_TT, INDEX=format(clim$MESS_DATUM, "%m"), FUN=mean, na.rm=FALSE)
precsums &lt;- tapply(clim$MO_RR, INDEX=format(clim$MESS_DATUM, "%Y-%m"), FUN=sum)
eachmonth &lt;- format(strptime(paste(names(precsums),"01"), "%Y-%m %d"),"%m")
prec &lt;- tapply(precsums, eachmonth, FUN=mean, na.rm=TRUE)
meta &lt;- paste("Potsdam\n", paste(range(clim$MESS_DATUM, na.rm=TRUE), 
                                 collapse=" to "), "\n", sep="")

climateGraph(temp, prec, main=meta, ylim=c(-2, 45))
# Add Quartiles (as in boxplots): numerically sorted, 50% of the data lie inbetween
TQ &lt;- tapply(clim$MO_TT, INDEX=format(clim$MESS_DATUM, "%m"), FUN=quantile)
TQ &lt;- sapply(TQ, I)
arrows(x0=1:12, y0=TQ["25%",], y1=TQ["75%",], angle=90, code=3, col=2, len=0.1)
#
PQ &lt;- tapply(precsums, eachmonth, FUN=quantile, na.rm=TRUE)
PQ &lt;- sapply(PQ, I)
arrows(x0=1:12, y0=PQ["25%",]/2, y1=PQ["75%",]/2, angle=90, code=3, col=4, len=0, lwd=3, lend=1)
mtext("IQR shown als lines", col=8, at=6.5, line=0.7, cex=1.2, font=2)


# Comparison to diagram in climatol
# library2("climatol") # commented out to avoid dah error in dataStr testing
# data(datcli)
# diagwl(datcli,est="Example station",alt=100,per="1961-90",mlab="en")


## End(Not run)

</code></pre>

<hr>
<h2 id='colPoints'>Points colored relative to third dimension</h2><span id='topic+colPoints'></span>

<h3>Description</h3>

<p>Draw colored points for 3D-data in a 2D-plane. Color is relative to third
dimension, by different classification methods. Can take 3 vectors or, as in
<code><a href="graphics.html#topic+image">image</a></code>, 2 vectors and a matrix for z.<br />
Adding points after <code><a href="#topic+smallPlot">smallPlot</a></code> is called for the legend may be
incorrect if the original function messes with the graph margins,
see the note in <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colPoints(
  x,
  y,
  z,
  data,
  add = TRUE,
  col = seqPal(100),
  col2 = c(NA, "grey", "black"),
  Range = range(z, finite = TRUE),
  method = "linear",
  breaks = length(col),
  sdlab = 1,
  legend = TRUE,
  legargs = NULL,
  lines = FALSE,
  nint = 30,
  xlab = gsub("\"", "", deparse(substitute(x))),
  ylab = gsub("\"", "", deparse(substitute(y))),
  zlab = gsub("\"", "", deparse(substitute(z))),
  axes = TRUE,
  log = "",
  las = 1,
  bglines = NULL,
  pch = 16,
  x1 = 0.6,
  y1 = ifelse(horizontal, 0.88, 0.3),
  x2 = 0.99,
  y2 = 0.99,
  density = NULL,
  horizontal = TRUE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colPoints_+3A_x">x</code>, <code id="colPoints_+3A_y">y</code></td>
<td>
<p>Vectors with coordinates of the points to be drawn</p>
</td></tr>
<tr><td><code id="colPoints_+3A_z">z</code></td>
<td>
<p>z values belonging to coordinates.
Vector or matrix with the color-defining height values</p>
</td></tr>
<tr><td><code id="colPoints_+3A_data">data</code></td>
<td>
<p>Optional: data.frame with the column names as given by x,y and z.</p>
</td></tr>
<tr><td><code id="colPoints_+3A_add">add</code></td>
<td>
<p>Logical. Should the points be added to current (existing!) plot?
If FALSE, a new plot is started.
DEFAULT: TRUE (It's called col<b>Points</b>, after all)</p>
</td></tr>
<tr><td><code id="colPoints_+3A_col">col</code></td>
<td>
<p>Vector of colors to be used. DEFAULT: 100 colors from sequential
palette <code><a href="#topic+seqPal">seqPal</a></code> (color-blind safe, black/white-print safe)</p>
</td></tr>
<tr><td><code id="colPoints_+3A_col2">col2</code></td>
<td>
<p>Color for points where z is NA, or lower / higher than <code>Range</code>.
DEFAULT: c(NA, 1, 8)</p>
</td></tr>
<tr><td><code id="colPoints_+3A_range">Range</code></td>
<td>
<p>Ends of color bar. If NULL, it is again the DEFAULT: range(z, finite=TRUE)</p>
</td></tr>
<tr><td><code id="colPoints_+3A_method">method</code></td>
<td>
<p>Classification method (partial matching is performed),
see <code><a href="#topic+classify">classify</a></code>. DEFAULT: &quot;linear&quot;</p>
</td></tr>
<tr><td><code id="colPoints_+3A_breaks">breaks</code></td>
<td>
<p>Specification for method, see <code><a href="#topic+classify">classify</a></code>.
DEFAULT: different defaults for each method</p>
</td></tr>
<tr><td><code id="colPoints_+3A_sdlab">sdlab</code></td>
<td>
<p>Type of label and breakpoints if <code>method="sd"</code>,
see <code><a href="#topic+classify">classify</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="colPoints_+3A_legend">legend</code></td>
<td>
<p>Logical. Should a <code><a href="#topic+colPointsLegend">colPointsLegend</a></code> be drawn? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPoints_+3A_legargs">legargs</code></td>
<td>
<p>List. Arguments passed to <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>.
DEFAULT: NULL, with some defaults specified internally</p>
</td></tr>
<tr><td><code id="colPoints_+3A_lines">lines</code></td>
<td>
<p>Logical. Should lines be drawn instead of / underneath the points?
(color of each <code><a href="graphics.html#topic+segments">segments</a></code> is taken from starting point,
last point is endpoint.) If lines=TRUE and pch is not given,
pch is set to NA. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPoints_+3A_nint">nint</code></td>
<td>
<p>Numeric of length 1. Number of interpolation points between each
coordinate if <code>lines=TRUE</code>. nint=1 means no interpolation.
Values below 10 will smooth coordinates and might
miss the original points. DEFAULT: 30</p>
</td></tr>
<tr><td><code id="colPoints_+3A_xlab">xlab</code>, <code id="colPoints_+3A_ylab">ylab</code>, <code id="colPoints_+3A_zlab">zlab</code></td>
<td>
<p>X axis label, y axis label, <code><a href="#topic+colPointsLegend">colPointsLegend</a> title</code>.
DEFAULT: <code>gsub("\"", "", deparse(<a href="base.html#topic+substitute">substitute</a>(x/y/z)))</code></p>
</td></tr>
<tr><td><code id="colPoints_+3A_axes">axes</code>, <code id="colPoints_+3A_las">las</code></td>
<td>
<p>Draw axes? Label Axis Style. Only used when add=FALSE.
See <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: axes=TRUE, las=1 (all labels horizontal)</p>
</td></tr>
<tr><td><code id="colPoints_+3A_log">log</code></td>
<td>
<p>Logarithmic axes with log=&quot;y&quot;, &quot;xy&quot; or &quot;x&quot;. 
For logarithmic colorscale, see method=&quot;log&quot;.
DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="colPoints_+3A_bglines">bglines</code></td>
<td>
<p>If not NULL, passed to <code><a href="graphics.html#topic+abline">abline</a></code> to draw background
lines before adding colored points. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="colPoints_+3A_pch">pch</code></td>
<td>
<p>Point CHaracter. See <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 16</p>
</td></tr>
<tr><td><code id="colPoints_+3A_x1">x1</code>, <code id="colPoints_+3A_x2">x2</code>, <code id="colPoints_+3A_y1">y1</code>, <code id="colPoints_+3A_y2">y2</code></td>
<td>
<p>Relative coordinates [0:1] of inset plot, see <code><a href="#topic+smallPlot">smallPlot</a></code>.
Passed to <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>.
DEFAULT: x: 0.6-0.99, y: 0.88-0.98</p>
</td></tr>
<tr><td><code id="colPoints_+3A_density">density</code></td>
<td>
<p>Arguments for density line in <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>,
or FALSE to suppress drawing it. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="colPoints_+3A_horizontal">horizontal</code></td>
<td>
<p>Logical passed to <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPoints_+3A_quiet">quiet</code></td>
<td>
<p>Turn off warnings? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPoints_+3A_...">...</code></td>
<td>
<p>Further graphical arguments passed to <code><a href="base.html#topic+plot">plot</a></code>,
<code><a href="graphics.html#topic+points">points</a></code> and <code><a href="graphics.html#topic+segments">segments</a></code>,
eg cex, xlim (when add=F), mgp, main, sub, asp (when add=F), etc.
Note: col does not work, as it is already another argument</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Invisible list of values that can be passed to colPointsLegend or colPointsHist.
</p>


<h3>Note</h3>

<p>Rstudio scales graphics really badly, so don't expect the right legend width out of the box if you use Rstudio!
Exporting via <code>png("myplot.png", 600,400); colPoints(x,y,z); dev.off()</code> usually works much better
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011-2014. I'd be interested in hearing what you used the function for.
</p>


<h3>References</h3>

<p><a href="http://uxblog.idvsolutions.com/2011/10/telling-truth.html">http://uxblog.idvsolutions.com/2011/10/telling-truth.html</a>,
<a href="https://www.theusrus.de/blog/the-good-the-bad-22012/">https://www.theusrus.de/blog/the-good-the-bad-22012/</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+classify">classify</a></code>, <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>, <code><a href="#topic+colPointsHist">colPointsHist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
i &lt;- c( 22,  40,  48,  60,  80,  70,  70,  63,  55,  48,  45,  40,  30,  32)
j &lt;- c(  5,  10,  15,  20,  12,  30,  45,  40,  30,  36,  56,  33,  45,  23)
k &lt;- c(175, 168, 163, 132, 120, 117, 110, 130, 131, 160, 105, 174, 190, 183)

# basic usage:
colPoints(i,j,k, cex=1.5, pch="+", add=FALSE)

# with custom Range:
colPoints(i,j,k, cex=1.5, pch="+", add=FALSE, Range=c(150,190), density=FALSE)
# can be used to allow comparison between several plots
# points outside the range are plotted with col2

# with custom colors:
mycols &lt;- colorRampPalette(c("blue","yellow","red"))(50)
colPoints(i,j,k, cex=1.5, pch="+", add=FALSE, col=mycols)

# With legend title:
colPoints(i,j,k, cex=2, add=FALSE, zlab="Elevation [m above NN.]",
         legargs=list(density=FALSE))
?colPointsLegend # to see which arguments can be set via legargs


# colPoints with matrix:
colPoints(z=volcano, add=FALSE)
# image and contour by default transpose and reverse the matrix!
# colPoints shows what is really in the data.

# add single newly measured points to image (fictional data):
mx &lt;- c( 22,  40,  45,  30,  30,  10)
my &lt;- c(  5,  33,  56,  70,  45,  45)
mz &lt;- c(110, 184, 127, 133, 170, 114)
colPoints(mx,my,mz, cex=5, pch="*", Range=c(94, 195), col=seqPal(), col2=NA, legend=FALSE)
points(mx,my, cex=4)
text(mx,my,mz, adj=-0.5, font=2)


# with logarithmic color scale:
shp &lt;- seq(0.2,3, by=0.1)
scl &lt;- seq(0.2,3, by=0.1)
wsim &lt;- sapply(shp, function(h) sapply(scl, function(c) mean(rweibull(1e3, shape=h, scale=c))))
colPoints(shp, scl, (wsim), add=FALSE, asp=1)
colPoints(shp, scl, (wsim), add=FALSE, asp=1, method="log")


# with lines (nint to change number of linear interpolation points):
colPoints(i,j,k, cex=1.5, add=FALSE, lines=TRUE, nint=10, lwd=2)
# With NAs separating lines:
tfile &lt;- system.file("extdata/rivers.txt", package="berryFunctions")
rivers &lt;- read.table(tfile, header=TRUE, dec=",")
colPoints(x,y,n, data=rivers, add=FALSE, lines=TRUE)
colPoints(x,y,n, data=rivers, add=FALSE, lines=TRUE, pch=3, lwd=3)
colPoints(x,y,n, data=rivers, add=FALSE, lines=TRUE, pch=3, lwd=3, nint=2)
colPoints("x","y","n", data=rivers, add=FALSE)

# different classification methods:
# see ?classify

colPoints(i,j,k, add=FALSE) # use classify separately:
text(i,j+1,k, col=divPal(100,rev=TRUE)[classify(k)$index], cex=1)


# Add histogram:
cp &lt;- colPoints(i,j,k, add=FALSE)
do.call(colPointsHist, cp[c("z","at","labels","bb","nbins")])
do.call(colPointsHist, owa(cp[c("z","at","labels","bb","nbins")],
                           list(bg=5, breaks=5)))
do.call(colPointsHist, owa(cp[c("z","at","labels","bb","nbins")],
                           list(mar=c(0,0,0,0), x1=0.5, x2=1, y1=0.8,
                             y2=0.99, yaxt="n")))
# histogram in lower panel:
layout(matrix(1:2), heights=c(8,4) )
colPoints(i,j,k, add=FALSE, y1=0.8, y2=1)
colPointsHist(z=k, x1=0.05, x2=1, y1=0, y2=0.4, mar=3, outer=TRUE)
layout(1)


# Customizing the legend :
cp &lt;- colPoints(i,j,k, legend=FALSE, add=FALSE)
colPointsLegend(x1=0.2, x2=0.95, y1=0.50, y2=0.40, z=k, labelpos=5, atminmax=TRUE, bg=7)
colPointsLegend(x1=0.5, x2=0.90, y1=0.28, y2=0.18, z=k, Range=c(80, 200), nbins=12, font=3)
colPointsLegend(x1=0.1, x2=0.40, y1=0.15, y2=0.05, z=k, labelpos=5, lines=FALSE, title="")
colPointsLegend(z=k, horizontal=FALSE)
colPointsLegend(x1=0.01, y2=0.80, z=k, horizontal=FALSE, labelpos=4, cex=1.2)
colPointsLegend(x1=0.23, y2=0.95, z=k, horizontal=FALSE, labelpos=5, cex=0.8,
  dens=FALSE, title="", at=c(130,150,170), labels=c("y","rr","Be"), lines=FALSE)
# For method other than colPoints' default, it is easiest to include these
# options as a list in legargs, but you can also use the invisible output
# from colPoints for later calls to colPointsLegend
do.call(colPointsLegend, cp)
do.call(colPointsLegend, owa(cp, list(colors=divPal(100), cex=1.2)))


# santiago.begueria.es/2010/10/generating-spatially-correlated-random-fields-with-r
if(require(gstat)){
xyz &lt;- gstat(formula=z~1, locations=~x+y, dummy=TRUE, beta=1,
             model=vgm(psill=0.025,model="Exp",range=5), nmax=20)
xyz &lt;- predict(xyz, newdata=data.frame(x=runif(200, 20,40),y=runif(200, 50,70)), nsim=1)
head(xyz)
colPoints(x,y,sim1, data=xyz, add=FALSE)
}

</code></pre>

<hr>
<h2 id='colPointsHist'>Histogram for colPoints</h2><span id='topic+colPointsHist'></span>

<h3>Description</h3>

<p>Adds Histogram to plots created or enhanced with <code><a href="#topic+colPoints">colPoints</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colPointsHist(
  z,
  nbins = 40,
  colors = seqPal(nbins),
  bb = seqR(z, length.out = nbins + 1),
  at = pretty2(z),
  labels = at,
  bg = "white",
  x1 = 0,
  x2 = 0.4,
  y1 = 0,
  y2 = 0.3,
  outer = FALSE,
  mar = c(2, 2, 1, 0.5),
  mgp = c(1.8, 0.6, 0),
  sborder = NA,
  resetfocus = TRUE,
  breaks = 20,
  freq = TRUE,
  col = par("fg"),
  border = NA,
  main = "",
  ylab = "",
  xlab = "",
  las = 1,
  axes = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colPointsHist_+3A_z">z</code></td>
<td>
<p>Values of third dimension used in <code><a href="#topic+colPoints">colPoints</a></code></p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_nbins">nbins</code></td>
<td>
<p>Number of classes (thus, colors). DEFAULT: 40</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_colors">colors</code></td>
<td>
<p>Colors that are used for the background. DEFAULT: seqPal(nbins)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_bb">bb</code></td>
<td>
<p>Borders of bins for the background. DEFAULT: seqR(z, length.out=nbins+1)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_at">at</code></td>
<td>
<p>Positions of x-axis labels. DEFAULT: pretty2(z)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_labels">labels</code></td>
<td>
<p>X-axis labels themselves. DEFAULT: at</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_bg">bg</code></td>
<td>
<p>Background behind background and axis labels. DEFAULT: &quot;white&quot;</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_x1">x1</code>, <code id="colPointsHist_+3A_x2">x2</code>, <code id="colPointsHist_+3A_y1">y1</code>, <code id="colPointsHist_+3A_y2">y2</code></td>
<td>
<p>Relative coordinates [0:1] of inset plot, see <code><a href="#topic+smallPlot">smallPlot</a></code>.
DEFAULT: x: 0-0.3, y: 0-0.4</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_outer">outer</code></td>
<td>
<p>Logical: Should legend be relative to device instead of current figure?
use outer=TRUE when par(mfrow, oma) is set. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_mar">mar</code></td>
<td>
<p>Margins for <code><a href="#topic+smallPlot">smallPlot</a></code>. DEFAULT: c(2, 2, 1, 0.5)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_mgp">mgp</code></td>
<td>
<p>MarGinPlacement: distance of xlab/ylab, numbers and line from plot margin,
as in <code><a href="graphics.html#topic+par">par</a></code>, but with different defaults. DEFAULT: c(1.8, 0.6, 0)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_sborder">sborder</code></td>
<td>
<p>Border around inset subplot. DEFAULT: par(&quot;fg&quot;)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_resetfocus">resetfocus</code></td>
<td>
<p>Reset focus to original plot? Specifies where further
low level plot commands are directed to. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_breaks">breaks</code></td>
<td>
<p>Breaks as in <code><a href="graphics.html#topic+hist">hist</a></code>, but with a different default. DEFAULT: 20</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_freq">freq</code></td>
<td>
<p>Plot count data in hist? (if FALSE, plot density instead). DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_col">col</code></td>
<td>
<p>Color of histogram bars. DEFAULT: par(&quot;fg&quot;)</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_border">border</code></td>
<td>
<p>Border around each bar. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_main">main</code>, <code id="colPointsHist_+3A_ylab">ylab</code>, <code id="colPointsHist_+3A_xlab">xlab</code></td>
<td>
<p>Labels. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_axes">axes</code></td>
<td>
<p>Draw axes?. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsHist_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code>. NOT POSSIBLE: <code>x, add</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible list of par of smallPlot, adds histogram to current plot
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colPointsLegend">colPointsLegend</a></code> and <code><a href="#topic+colPoints">colPoints</a></code> for real life examples
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
z &lt;- rnorm(50)
plot(1:10)
colPointsHist(z=z)

</code></pre>

<hr>
<h2 id='colPointsLegend'>Legend for colPoints</h2><span id='topic+colPointsLegend'></span>

<h3>Description</h3>

<p>Adds legends to plots created or enhanced with <code><a href="#topic+colPoints">colPoints</a></code>. <br />
<code>sf</code> plots set par(mar=c(0,0,1.2,0)) but then reset it to the values before.
<code><a href="#topic+smallPlot">smallPlot</a></code> will hence also reset to that, so points added after
calling colpointsLegend will be wrong, unless the margins are set BEFORE sf plot.
<code>sf:::plot.sf</code> alternatively uses c(2.1, 2.1, 1.2, 0)  or  c(1, 1, 1.2, 1).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>colPointsLegend(
  z,
  Range = range(z, finite = TRUE),
  nbins = 100,
  colors = seqPal(nbins),
  bb = seqR(Range, length.out = nbins + 1),
  nlab = 5,
  at = pretty2(Range, nlab),
  labels = at,
  atgrey = NULL,
  adj = 0.5,
  x1 = 0.6,
  y1 = 0.88,
  x2 = 0.99,
  y2 = 0.99,
  outer = FALSE,
  xpd = NA,
  mar,
  mgp = c(1.8, 0.6, 0),
  bg = par("bg"),
  sborder = NA,
  resetfocus = TRUE,
  plottriangle = FALSE,
  triangle = 0.14,
  tricol = c(8, 1),
  density = NULL,
  lines = TRUE,
  atminmax = FALSE,
  horizontal = TRUE,
  labelpos = 1,
  titlepos = 3,
  title = "Legend",
  las = 1,
  x,
  y,
  index,
  above,
  below,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="colPointsLegend_+3A_z">z</code></td>
<td>
<p>Values of third dimension used in <code><a href="#topic+colPoints">colPoints</a></code>,
can be a matrix or a vector etc, but must be numeric</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_range">Range</code></td>
<td>
<p>Ends of color bar for method=equalinterval. DEFAULT: range(z, finite=TRUE)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_nbins">nbins</code></td>
<td>
<p>Number of classes (thus, colors). If <code>colors</code> is given,
<code>nbins</code> is overwritten with <code>length(colors)</code>. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_colors">colors</code></td>
<td>
<p>Color vector. DEFAULT: <code><a href="#topic+seqPal">seqPal</a></code>
from yellow (lowest) to blue (highest value in Range)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_bb">bb</code></td>
<td>
<p>Borders of bins for the legend (key). DEFAULT: seqR(Range, length.out=nbins+1)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_nlab">nlab</code>, <code id="colPointsLegend_+3A_at">at</code>, <code id="colPointsLegend_+3A_labels">labels</code></td>
<td>
<p>Number of legend labels, their positions and labels.
DEFAULT: nlab=5, labels=at=pretty2(Range,nlab)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_atgrey">atgrey</code></td>
<td>
<p>Positions for grey lines with no label, if given. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_adj">adj</code></td>
<td>
<p>label adjustment parallel to legend bar (only one number!). DEFAULT: 0.5</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_x1">x1</code>, <code id="colPointsLegend_+3A_x2">x2</code>, <code id="colPointsLegend_+3A_y1">y1</code>, <code id="colPointsLegend_+3A_y2">y2</code></td>
<td>
<p>Relative coordinates [0:1] of inset plot, see <code><a href="#topic+smallPlot">smallPlot</a></code>.
DEFAULT: x: 0.6-0.99, y: 0.88-0.99</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_outer">outer</code></td>
<td>
<p>Logical: Should legend be relative to device instead of current figure?
use outer=TRUE when par(mfrow, oma) is set. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_xpd">xpd</code></td>
<td>
<p>Logical: should text be expanded outside of plotting region?
Must be NA if outer=TRUE. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_mar">mar</code></td>
<td>
<p>Margins for <code><a href="#topic+smallPlot">smallPlot</a></code>.
DEFAULT: internal calculations based on title, labelpos and titlepos.</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_mgp">mgp</code></td>
<td>
<p>MarGinPlacement: distance of xlab/ylab, numbers and line from plot margin,
as in <code><a href="graphics.html#topic+par">par</a></code>, but with different defaults. DEFAULT: c(1.8, 0.6, 0)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_bg">bg</code></td>
<td>
<p>Background behind key, labels and title. DEFAULT: par(&quot;bg&quot;)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_sborder">sborder</code></td>
<td>
<p>Border around inset subplot. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_resetfocus">resetfocus</code></td>
<td>
<p>Reset focus to original plot?
Specifies where further low level plot commands are directed to. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_plottriangle">plottriangle</code></td>
<td>
<p>Should triangles be plotted at the end of the legend for values outside Range?
Vector of length two (for lower and upper, internally recycled).
If this argument is missing but triangle is given, this is set to TRUE. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_triangle">triangle</code></td>
<td>
<p>Percentage of bar length at lower and upper end for triangles
(can be a vector with two different values). DEFAULT: 0.14</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_tricol">tricol</code></td>
<td>
<p>Triangle colors for lower and upper end. DEFAULT: c(8,1)</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_density">density</code></td>
<td>
<p>List of arguments passed to <code>kernel <a href="stats.html#topic+density">density</a> estimation</code>.
Can also be FALSE to suppress KDE line drawing. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_lines">lines</code></td>
<td>
<p>Plot black lines in the color bar at <code>at</code>? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_atminmax">atminmax</code></td>
<td>
<p>Should the extrema of the legend be added to <code>at</code>? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_horizontal">horizontal</code></td>
<td>
<p>Horizontal bar? if FALSE, a vertical bar is drawn. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_labelpos">labelpos</code></td>
<td>
<p>Position of labels relative to the bar.
Possible: 1 (below), 2 (left), 3 (above), 4 (right), 5(on top of bar). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_titlepos">titlepos</code></td>
<td>
<p>Position of title -&quot;-. DEFAULT: 3</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_title">title</code></td>
<td>
<p>Legend title. DEFAULT: &quot;Legend&quot;</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_x">x</code>, <code id="colPointsLegend_+3A_y">y</code>, <code id="colPointsLegend_+3A_index">index</code>, <code id="colPointsLegend_+3A_above">above</code>, <code id="colPointsLegend_+3A_below">below</code></td>
<td>
<p>Ignored arguments, so that you can pass the result from
<code><a href="#topic+colPoints">colPoints</a></code> via <code>do.call(colPointsLegend, cp_result)</code></p>
</td></tr>
<tr><td><code id="colPointsLegend_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+text">text</a></code> and <code><a href="graphics.html#topic+strwidth">strwidth</a></code>,
e.g. cex, srt, font, col. But NOT adj!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible list of par of <code><a href="#topic+smallPlot">smallPlot</a></code>, adds legend bar to current plot
</p>


<h3>Note</h3>

<p><code>x1,x2,y1,y2,labelpos,titlepos,title</code> have different defaults when <code>horizontal=FALSE</code><br />
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2012-2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colPointsHist">colPointsHist</a></code>, <code><a href="#topic+colPoints">colPoints</a></code> for real life example
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
z &lt;- rnorm(50)
plot(1:10)
colPointsLegend(z=z)
colPointsLegend(z=z, titlepos=2)
colPointsLegend(z=z, horiz=FALSE) # note the different defaults
# positioning relative to plot:
colPointsLegend(z=z, x1=0.05, x2=0.3, y1=0.7,y2=0.9, title="Booh!", density=FALSE)
# Denote values outside of Range wit a triangle:
colPointsLegend(z=z, Range=c(-1,3), x1=0.2, y1=0.4, y2=0.6, triangle=0.2)
colPointsLegend(z=z, horiz=FALSE, x1=0.7, y1=0.6, plottriangle=TRUE, density=FALSE)
?colPoints # example section for actual usage

</code></pre>

<hr>
<h2 id='combineFiles'>Combine Textfiles into one</h2><span id='topic+combineFiles'></span>

<h3>Description</h3>

<p>Combine several textfiles into one, regardless of their content.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>combineFiles(
  inFiles = dir(),
  outFile = "combined_Textfiles.txt",
  overwrite = FALSE,
  sep = NULL,
  names = TRUE,
  selection = NULL,
  progbar = !quiet,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="combineFiles_+3A_infiles">inFiles</code></td>
<td>
<p>vector with names of input files, as can be read with
<code><a href="base.html#topic+scan">scan</a></code>. DEFAULT: dir()</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_outfile">outFile</code></td>
<td>
<p>Character string: name of the file to be created. Passed to
<code><a href="#topic+newFilename">newFilename</a></code>. DEFAULT: &quot;combined_Textfiles.txt&quot;</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical: overwrite outFile? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_sep">sep</code></td>
<td>
<p>Character string: Separation between content of
each file and the following. DEFAULT: NULL, with which it uses
an empty line, two lines with dashes, and another line break.</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_names">names</code></td>
<td>
<p>Should File names be included after sep? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_selection">selection</code></td>
<td>
<p>Index of rows that should be written. Can refer to each file
separately, e.g. <code>substr(inFile_i,1,1)=="#"</code>.
DEFAULT: all lines</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_progbar">progbar</code></td>
<td>
<p>Should a progress bar be drawn? Useful if you combine many
large files. DEFAULT: !quiet, i.e. TRUE</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_quiet">quiet</code></td>
<td>
<p>Suppress message about number of files combined? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="combineFiles_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="base.html#topic+scan">scan</a></code>, but not one of:
<code>file, what, blank.lines.skip, sep, quiet</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Final output file, invisibly.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2012, Dec 2014, Jul 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compareFiles">compareFiles</a></code>, and the functions used internally here, namely:
<code><a href="base.html#topic+paste">paste</a></code>, <code><a href="base.html#topic+scan">scan</a></code>, <code><a href="base.html#topic+write">write</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## These are skipped by rcmd check (writing to external places is not allowed)
## Not run: 
cat("This is Sparta.\nKicking your face.", file="BujakashaBerry1.txt")
cat("Chuck Norris will roundhousekick you.", file="BujakashaBerry2.txt")
combineFiles(inFiles=paste0("BujakashaBerry", 1:2, ".txt"),
             outFile="BujakashaBerry3.txt")
file.show("BujakashaBerry3.txt")
unlink(paste0("BujakashaBerry", 1:3, ".txt"))

## End(Not run)

</code></pre>

<hr>
<h2 id='compareDist'>compare distributions</h2><span id='topic+compareDist'></span>

<h3>Description</h3>

<p>compare multiple distributions. All based on columns in a data.frame.
Creates several plots based on the integers present in <code>plot</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareDist(
  df,
  plot = 1:4,
  bw = "SJ",
  col = catPal(ncol(df), alpha = 0.3),
  main = paste("Distributions of", deparse(substitute(df))),
  xlab = "Values",
  ylab = "Density",
  legpos1 = "topleft",
  legpos2 = NULL,
  horizontal = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareDist_+3A_df">df</code></td>
<td>
<p>Data.frame with (named) columns.</p>
</td></tr>
<tr><td><code id="compareDist_+3A_plot">plot</code></td>
<td>
<p>Integers: which graphics to plot?<br />
Plot 1: overlaid density estimates<br />
Plot 2: multipanel histogram<br />
Plot 3: boxplot<br />
Plot 4: violin plot, if package <code>vioplot</code> is available.<br />
DEFAULT: 1:4</p>
</td></tr>
<tr><td><code id="compareDist_+3A_bw">bw</code></td>
<td>
<p>Bandwidth passed to <code><a href="stats.html#topic+density">density</a></code> for plot 1. DEFAULT: &quot;SJ&quot;</p>
</td></tr>
<tr><td><code id="compareDist_+3A_col">col</code></td>
<td>
<p>Color (vector). DEFAULT: <code><a href="#topic+catPal">catPal</a>(ncol(df), alpha=0.3)</code></p>
</td></tr>
<tr><td><code id="compareDist_+3A_main">main</code></td>
<td>
<p>Title. DEFAULT: &quot;Distributions of [df name]&quot;</p>
</td></tr>
<tr><td><code id="compareDist_+3A_xlab">xlab</code>, <code id="compareDist_+3A_ylab">ylab</code></td>
<td>
<p>Axis labels for plot 1. DEFAULT: xlab=&quot;Values&quot;, ylab=&quot;Density&quot;</p>
</td></tr>
<tr><td><code id="compareDist_+3A_legpos1">legpos1</code>, <code id="compareDist_+3A_legpos2">legpos2</code></td>
<td>
<p>Legend position for plot 1. DEFAULT: &quot;topleft&quot;, NULL</p>
</td></tr>
<tr><td><code id="compareDist_+3A_horizontal">horizontal</code></td>
<td>
<p>Should boxplot and vioplot (plot 3 and 4) be horizontal? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="compareDist_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code> (plot 1), 
<code><a href="#topic+groupHist">groupHist</a></code> (plot 2)
<code><a href="graphics.html#topic+boxplot">boxplot</a></code> (plot 3) and 
<code>vioplot::<a href="vioplot.html#topic+vioplot">vioplot</a></code> (plot 4)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>df, invisible
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+groupHist">groupHist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>fakedata &lt;- data.frame(norm=rnorm(30), exp=rexp(30), unif=runif(30))
compareDist(fakedata)

</code></pre>

<hr>
<h2 id='compareFiles'>Compare textfiles for equality</h2><span id='topic+compareFiles'></span>

<h3>Description</h3>

<p>Returns the line numbers where two (text)files differ
</p>


<h3>Usage</h3>

<pre><code class='language-R'>compareFiles(
  file1,
  file2,
  nr = 20,
  startline = 1,
  endline = length(f1),
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="compareFiles_+3A_file1">file1</code>, <code id="compareFiles_+3A_file2">file2</code></td>
<td>
<p>Filenames to be read by <code><a href="base.html#topic+readLines">readLines</a></code>.</p>
</td></tr>
<tr><td><code id="compareFiles_+3A_nr">nr</code></td>
<td>
<p>number of results printed. DEFAULT: 20</p>
</td></tr>
<tr><td><code id="compareFiles_+3A_startline">startline</code>, <code id="compareFiles_+3A_endline">endline</code></td>
<td>
<p>start and end lines, e.g. to exclude section that is already compared.</p>
</td></tr>
<tr><td><code id="compareFiles_+3A_quiet">quiet</code></td>
<td>
<p>show warnings about file lengths? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="compareFiles_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="base.html#topic+readLines">readLines</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of line numbers that differ, result from <code><a href="utils.html#topic+head">head</a>(..., nr)</code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2014
</p>


<h3>See Also</h3>

<p><a href="https://text-compare.com/">https://text-compare.com/</a> which I sadly only discovered after writing this function,
<code><a href="#topic+dupes">dupes</a></code> for finding duplicate lines, <code><a href="#topic+combineFiles">combineFiles</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
filenames &lt;- system.file(paste0("extdata/versuch",1:2,".txt"), package="berryFunctions")
compareFiles(filenames[1], filenames[2], warn=FALSE)

</code></pre>

<hr>
<h2 id='convertUmlaut'>Convert German Umlaute to ASCII</h2><span id='topic+convertUmlaut'></span>

<h3>Description</h3>

<p>Convert German Umlaute (ae, oe, ue, ss) to ASCII.
Conversion happens case sensitive for the first three.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>convertUmlaut(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="convertUmlaut_+3A_x">x</code></td>
<td>
<p>Character string(s) containing German Umlaute</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character strings
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct-Nov 2016
</p>


<h3>See Also</h3>

<p><code>tools::<a href="tools.html#topic+showNonASCII">showNonASCII</a></code>, <code><a href="base.html#topic+gsub">gsub</a></code>,
<code><a href="base.html#topic+iconv">iconv</a>(x, to="ASCII//TRANSLIT")</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
link &lt;- paste0("ftp://ftp-cdc.dwd.de/pub/CDC/observations_germany/climate/",
               "monthly/kl/recent/KL_Monatswerte_Beschreibung_Stationen.txt")
weatherstations &lt;- read.fwf(link, widths=c(6,9,10,16,11,8,41,99), skip=3)
examples &lt;- trimws(weatherstations[c(153, 509, 587, 2, 651, 851),7])
examples
convertUmlaut(examples) # note how lower and upper case is kept

## End(Not run)

</code></pre>

<hr>
<h2 id='createFun'>create function framework</h2><span id='topic+createFun'></span>

<h3>Description</h3>

<p>create a file with a complete (Roxygen) framework for a new function in a package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createFun(fun, path = ".", open = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createFun_+3A_fun">fun</code></td>
<td>
<p>Character string or unquoted name. Function that will be created with identical filename.</p>
</td></tr>
<tr><td><code id="createFun_+3A_path">path</code></td>
<td>
<p>Path to package in development (including package name itself).
Is passed to <code><a href="#topic+packagePath">packagePath</a></code>. DEFAULT: &quot;.&quot;</p>
</td></tr>
<tr><td><code id="createFun_+3A_open">open</code></td>
<td>
<p>Logical: open the file? If several instances of Rstudio are open,
the last one (not necessarily the active one) will be used.
DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tries to open the file in the standard editor for .R files using <code><a href="base.html#topic+system2">system2</a></code>
</p>


<h3>Value</h3>

<p>file name as character string
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, March 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+system2">system2</a></code>, <code><a href="#topic+funSource">funSource</a></code>, Roxygen2:
<a href="https://cran.r-project.org/package=roxygen2/vignettes/rd.html">https://cran.r-project.org/package=roxygen2/vignettes/rd.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>#createFun("myNewFunction")
</code></pre>

<hr>
<h2 id='createPres'>Create .Rnw presentation template</h2><span id='topic+createPres'></span>

<h3>Description</h3>

<p>Create folder with .Rnw presentation template and fig_extern folder.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>createPres(
  presname = "pres",
  dir = "presentation",
  path = ".",
  asp = 169,
  navbullets = FALSE,
  bgblack = FALSE,
  open = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="createPres_+3A_presname">presname</code></td>
<td>
<p>Name of .Rnw file to be created. DEFAULT: &quot;pres&quot;</p>
</td></tr>
<tr><td><code id="createPres_+3A_dir">dir</code></td>
<td>
<p>Name of directory that will contain .Rnw file and
fig_extern folder. &quot;_1&quot; will be appended if already existing,
see <code><a href="#topic+newFilename">newFilename</a></code>. DEFAULT: &quot;presentation&quot;</p>
</td></tr>
<tr><td><code id="createPres_+3A_path">path</code></td>
<td>
<p>Location of <code>dir</code>. Passed to <code><a href="base.html#topic+setwd">setwd</a></code>.
DEFAULT: &quot;.&quot;</p>
</td></tr>
<tr><td><code id="createPres_+3A_asp">asp</code></td>
<td>
<p>Number to set as aspectratio. 43 for old 4:3 format. 
Possible values: 169, 1610, 149, 54, 43, 32. 
<b>note</b>: if you set this, remember to change the default <code>fig.width</code>.
DEFAULT: 169 (16:9 format)</p>
</td></tr>
<tr><td><code id="createPres_+3A_navbullets">navbullets</code></td>
<td>
<p>Logical: include navigation slide bullet points in header?
This only takes effect when there are subsections.
DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="createPres_+3A_bgblack">bgblack</code></td>
<td>
<p>Logical: set a black background instead of a white one?
Requires all R graphics fg and bg colors to be changed!
See &quot;How to avoid death By PowerPoint&quot; at 11:49 minutes 
<a href="https://youtu.be/Iwpi1Lm6dFo?t=11m49s">https://youtu.be/Iwpi1Lm6dFo?t=11m49s</a>.
Change colors manually in the Rnw files searching for 
<code>bg=</code>, <code>linkcolor=</code>, <code>urlcolor=</code>
in the preamble and <code>color</code> right after <code>begin document</code>.
DEFAULT bgblack: FALSE</p>
</td></tr>
<tr><td><code id="createPres_+3A_open">open</code></td>
<td>
<p>Logical: run <code><a href="#topic+openFile">openFile</a></code>? DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Mar 2017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+createFun">createFun</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
createPres("Berry_Conference")

## End(Not run)

</code></pre>

<hr>
<h2 id='dataStr'>str of datasets</h2><span id='topic+dataStr'></span>

<h3>Description</h3>

<p>Print the <code><a href="utils.html#topic+str">str</a></code> of each dataset returned by <code><a href="utils.html#topic+data">data</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dataStr(
  heads = FALSE,
  only = NULL,
  msg = heads,
  package = NULL,
  view = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dataStr_+3A_heads">heads</code></td>
<td>
<p>Logical: display heads of all data.frames? 
If TRUE, <code>only</code> is ignored. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="dataStr_+3A_only">only</code></td>
<td>
<p>Charstring class: give information only about objects of that class.
Can also be TRUE to sort output by nrow/ncol
DEFAULT: NULL (ignore)</p>
</td></tr>
<tr><td><code id="dataStr_+3A_msg">msg</code></td>
<td>
<p>Logical: message str info? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="dataStr_+3A_package">package</code></td>
<td>
<p>Package name. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="dataStr_+3A_view">view</code></td>
<td>
<p>Open dataframe with <code><a href="utils.html#topic+View">View</a></code> (in Rstudio, if available)? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="dataStr_+3A_...">...</code></td>
<td>
<p>Other arguments passed to <code><a href="utils.html#topic+data">data</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible data.frame. If <code>msg=TRUE</code>, prints via <code><a href="base.html#topic+message">message</a></code> in a for loop.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, November 2015, in search of good datasets for teaching
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+str">str</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  ## View should not be used in examples
dataStr() # all loaded packages on search path (package=NULL)
# dataStr(package="datasets") # only datasets in base R package datasets
dataStr(only=TRUE) # sorted by nrow / ncol
d &lt;- dataStr(only="data.frame") # data.frames only
sort(sapply(d$Object, function(dd) {sum(is.na(get(dd)))})) # datasets with NAs
head(d)
if(interactive()) View(d) # to sort in Rstudio Viewer
d[,c("Object","ncol","nrow")]

dataStr(heads=TRUE) # heads of all data.frames

# dataStr(package="hms") # no datasets in package

## End(Not run)

</code></pre>

<hr>
<h2 id='distance'>Distance between points</h2><span id='topic+distance'></span>

<h3>Description</h3>

<p>Calculate distance between points on planar surface
</p>


<h3>Usage</h3>

<pre><code class='language-R'>distance(x, y, xref, yref, along = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="distance_+3A_x">x</code></td>
<td>
<p>vector with x-coordinate(s) of point(s)</p>
</td></tr>
<tr><td><code id="distance_+3A_y">y</code></td>
<td>
<p>ditto for y</p>
</td></tr>
<tr><td><code id="distance_+3A_xref">xref</code></td>
<td>
<p>single x coordinate of reference point</p>
</td></tr>
<tr><td><code id="distance_+3A_yref">yref</code></td>
<td>
<p>ditto for y</p>
</td></tr>
<tr><td><code id="distance_+3A_along">along</code></td>
<td>
<p>Logical: Should distances be computed along vector <code>(x,y)</code>?
If TRUE, <code>(xref,yref)</code> are ignored.
If both <code>(xref,yref)</code> are not given, along is set to TRUE.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The function is quite simple: <code>sqrt((xref - x)^2 + (yref - y)^2)</code>
</p>


<h3>Value</h3>

<p>vector with the distances
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2012
</p>


<h3>See Also</h3>

<p><code><a href="spatstat.geom.html#topic+nndist">nndist</a></code> in the package <code>spatstat.geom</code> 
for distance to nearest neighbour
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
A &lt;- c(3,  9,-1)
B &lt;- c(7, -2, 4)
plot(A,B)
text(A,B, paste0("P",1:3), adj=1.1)
points(3,5, col=2, pch=16)
segments(3,5, A,B)
distance(A,B, 3,5)
text(c(3.2,6,1), c(6,1,4), round(distance(A,B, 3,5),2) )

</code></pre>

<hr>
<h2 id='divPal'>Diverging color palette</h2><span id='topic+divPal'></span>

<h3>Description</h3>

<p>Diverging color palette: brown to blue, light colors in the middle, darker
at the extremes, good for displaying values in two directions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>divPal(
  n = 100,
  reverse = FALSE,
  alpha = 1,
  rwb = FALSE,
  ryb = FALSE,
  gp = FALSE,
  br = FALSE,
  colors = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="divPal_+3A_n">n</code></td>
<td>
<p>Number of colors. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="divPal_+3A_reverse">reverse</code></td>
<td>
<p>Reverse colors? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="divPal_+3A_alpha">alpha</code></td>
<td>
<p>Transparency (0=transparent, 1=fully colored). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="divPal_+3A_rwb">rwb</code></td>
<td>
<p>Should colors be in red-white-blue instead of brown-blue? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="divPal_+3A_ryb">ryb</code></td>
<td>
<p>Use red-yellow-blue instead of the default, with &quot;khaki&quot; in the center. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="divPal_+3A_gp">gp</code></td>
<td>
<p>Use green-purple instead of the default. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="divPal_+3A_br">br</code></td>
<td>
<p>Use blue-red instead of the default. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="divPal_+3A_colors">colors</code></td>
<td>
<p>If not NULL, a color vector used in <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="divPal_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string vector with color names
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2016
</p>


<h3>References</h3>

<p>The default palette is originally in 12 shades in the IPCC Assessment Report 5
Chapter 12 Fig 12.22, <a href="https://www.ipcc.ch/report/ar5/wg1/">https://www.ipcc.ch/report/ar5/wg1/</a>.<br />
The green-purple and blue-red palettes are from NYtimes (originally with 8 shades),
<a href="https://www.nytimes.com/interactive/2017/03/21/climate/how-americans-think-about-climate-change-in-six-maps.html">https://www.nytimes.com/interactive/2017/03/21/climate/how-americans-think-about-climate-change-in-six-maps.html</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+showPal">showPal</a></code>, <code><a href="#topic+seqPal">seqPal</a></code>, <code><a href="#topic+catPal">catPal</a></code>, <code><a href="#topic+addAlpha">addAlpha</a></code>,
<code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>, package <code>RColorBrewer</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(rep(1,12), pch=16, cex=5, col=divPal(12), xaxt="n")
showPal()
</code></pre>

<hr>
<h2 id='dupes'>Duplicate lines in file</h2><span id='topic+dupes'></span>

<h3>Description</h3>

<p>Number of duplicates per line of (text) file. Per default saved to file
which can be loaded into excel / libreoffice. With conditional formatting of
the first column, colors show for each line how often it occurs in the file.
A LibreOffice file is included. Note: OpenOffice does not provide color
scales based on cell values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>dupes(
  file,
  ignore.empty = TRUE,
  ignore.space = TRUE,
  tofile = missing(n),
  n = length(d)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="dupes_+3A_file">file</code></td>
<td>
<p>File name (character string)</p>
</td></tr>
<tr><td><code id="dupes_+3A_ignore.empty">ignore.empty</code></td>
<td>
<p>Should empty lines be ignored? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="dupes_+3A_ignore.space">ignore.space</code></td>
<td>
<p>Should leading/trailing whitespace be ignored? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="dupes_+3A_tofile">tofile</code></td>
<td>
<p>Logical: should output be directed to a file?
Otherwise, a dataframe with line numbers and number of duplicates of that line
will be printed in the console. DEFAULT: missing(n)</p>
</td></tr>
<tr><td><code id="dupes_+3A_n">n</code></td>
<td>
<p>Show only the first n values if <code>tofile=FALSE</code>. DEFAULT: length(d)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Either: a data.frame with line numbers of duplicate rows and the number of duplicates<br />
Or: a file is written with the number of duplicates and the original <code>file</code> content.
</p>


<h3>Note</h3>

<p>This has not been tested all that much - feedback is heavily welcome!
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+compareFiles">compareFiles</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
file &lt;- system.file("extdata/doublelines.txt", package="berryFunctions")
dupes(file, tofile=FALSE)
dupes(file, tofile=FALSE, ignore.empty=TRUE)

## These are skipped by rcmd check (opening external places is not allowed):
## Not run: dupes(file)

# a template file (dupes.ods) for libreOffice Calc is available here:
system.file("extdata", package="berryFunctions")

## Not run: system2("nautilus", system.file("extdata/dupes.ods", package="berryFunctions"))

# To open folders with system2:
# "nautilus" on linux ubuntu
# "open" or "dolphin" on mac
# "explorer" or "start" on windows

</code></pre>

<hr>
<h2 id='exp4p'>4-parametric exponential function</h2><span id='topic+exp4p'></span>

<h3>Description</h3>

<p>Fits an exponential function of the form a*e^(b*(x+c))+d
</p>


<h3>Usage</h3>

<pre><code class='language-R'>exp4p(x, y, digits = 2, plot = FALSE, las = 1, col = 1:6, legarg = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="exp4p_+3A_x">x</code>, <code id="exp4p_+3A_y">y</code></td>
<td>
<p>x and y Data</p>
</td></tr>
<tr><td><code id="exp4p_+3A_digits">digits</code></td>
<td>
<p>significant digits for rounding R^2. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="exp4p_+3A_plot">plot</code></td>
<td>
<p>plot data and fitted functions? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="exp4p_+3A_las">las</code></td>
<td>
<p>label axis style, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="exp4p_+3A_col">col</code></td>
<td>
<p>6 colors for lines and legend texts. DEFAULT: 1:6</p>
</td></tr>
<tr><td><code id="exp4p_+3A_legarg">legarg</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+legend">legend</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="exp4p_+3A_...">...</code></td>
<td>
<p>further graphical parameters passed to <code><a href="base.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is mainly a building block for mReg
</p>


<h3>Value</h3>

<p>Data.frame with the 4 parameters for each <code><a href="stats.html#topic+optim">optim</a></code> method
</p>


<h3>Note</h3>

<p>Optim can be slow! It refers to the functions rmse and rsquare, also in this package.
L-BFGS-B needs finite values. In case it doesn't get any
with the initial parameters (as in the first example Dataset),
it tries again with the parameters optimized via Nelder Mead.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2012-2013, outsourced from mReg in July 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+mReg">mReg</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: ## Skip time consuming checks on CRAN
# exponential decline of temperature of a mug of hot chocolate
tfile &lt;- system.file("extdata/Temp.txt", package="berryFunctions")
temp &lt;- read.table(tfile, header=TRUE, dec=",")
head(temp)
plot(temp)
temp &lt;- temp[-20,] # missing value - rmse would complain about it
x &lt;- temp$Minuten
y &lt;- temp$Temp
rm(tfile, temp)

exp4p(x,y, plot=TRUE)
# y=49*e^(-0.031*(x - 0  )) + 25 correct, judged from the model:
# Temp=T0 - Te *exp(k*t) + Te     with    T0=73.76,  Tend=26.21, k=-0.031
# optmethod="Nelder-Mead"  # y=52*e^(-0.031*(x + 3.4)) + 26 wrong

## End(Not run)

</code></pre>

<hr>
<h2 id='expReg'>Exponential regression with plotting</h2><span id='topic+expReg'></span>

<h3>Description</h3>

<p>uses <code><a href="stats.html#topic+lm">lm</a></code>; plots data if add=FALSE, draws the regression line
with <code><a href="graphics.html#topic+abline">abline</a></code> and confidence interval with <code><a href="graphics.html#topic+polygon">polygon</a></code>
and writes the formula with <code><a href="graphics.html#topic+legend">legend</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>expReg(
  x,
  y = NULL,
  data = NULL,
  logy = TRUE,
  predictnew = NULL,
  interval = "confidence",
  plot = TRUE,
  digits = 2,
  inset = 0,
  xpd = par("xpd"),
  pos1 = "top",
  pos2 = NULL,
  add = FALSE,
  pch = 16,
  col = rgb(0, 0, 0, 0.5),
  modcol = 2,
  lwd = 1,
  xlab = deparse(substitute(x)),
  ylab = deparse(substitute(y)),
  main = "exponential regression",
  xlim = range(x),
  ylim = range(y),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="expReg_+3A_x">x</code></td>
<td>
<p>Numeric or formula (see examples). Vector with values of explanatory variable</p>
</td></tr>
<tr><td><code id="expReg_+3A_y">y</code></td>
<td>
<p>Numeric. Vector with values of dependent variable. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="expReg_+3A_data">data</code></td>
<td>
<p>Dataframe. If x is a formula, the according columns from data are used as x and y. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="expReg_+3A_logy">logy</code></td>
<td>
<p>Plot with a logarithmic y axis?  Calls <code><a href="#topic+logAxis">logAxis</a></code>. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="expReg_+3A_predictnew">predictnew</code></td>
<td>
<p>Vector with values to predict outcome for. Passed as <code>newdata</code> to <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="expReg_+3A_interval">interval</code></td>
<td>
<p>Interval for prediction. DEFAULT: &quot;confidence&quot;</p>
</td></tr>
<tr><td><code id="expReg_+3A_plot">plot</code></td>
<td>
<p>Plot things at all? If FALSE, predictnew will still be returned. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="expReg_+3A_digits">digits</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\ge 1</code>. Specifies number of digits a,b,r,e are rounded to
in the formula &quot;y=a*log(x)+b, R^2, RMSE=e&quot;, respectively.
If values are not specified, they are set equal to the first. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="expReg_+3A_inset">inset</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\le 2</code>. inset distance(s) from the margins
as a fraction of the plot region when formula is placed by keyword. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="expReg_+3A_xpd">xpd</code></td>
<td>
<p>Logical, specifying whether formula can be written only inside the plot region (when FALSE)
or inside the figure region including mar (when TRUE)
or in the entire device region including oma (when NA). DEFAULT: par(&quot;xpd&quot;)</p>
</td></tr>
<tr><td><code id="expReg_+3A_pos1">pos1</code></td>
<td>
<p><code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>-acceptable position of the formula. DEFAULT: &quot;top&quot;</p>
</td></tr>
<tr><td><code id="expReg_+3A_pos2">pos2</code></td>
<td>
<p>For numerical coordinates, this is the y-position. DEFAULT: NULL, as in <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="expReg_+3A_add">add</code></td>
<td>
<p>Logical. If TRUE, line and text are added to the existing graphic. DEFAULT: FALSE (plots datapoints first and then the line.)</p>
</td></tr>
<tr><td><code id="expReg_+3A_pch">pch</code></td>
<td>
<p>Point Character, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 16</p>
</td></tr>
<tr><td><code id="expReg_+3A_col">col</code></td>
<td>
<p>Color of points, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: rgb(0,0,0, 0.5)</p>
</td></tr>
<tr><td><code id="expReg_+3A_modcol">modcol</code></td>
<td>
<p>color of model line. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="expReg_+3A_lwd">lwd</code></td>
<td>
<p>Numeric. Linewidth, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="expReg_+3A_xlab">xlab</code>, <code id="expReg_+3A_ylab">ylab</code>, <code id="expReg_+3A_main">main</code></td>
<td>
<p>Character / Expression. axis label and graph title if add=FALSE. DEFAULT: internal from names</p>
</td></tr>
<tr><td><code id="expReg_+3A_xlim">xlim</code>, <code id="expReg_+3A_ylim">ylim</code></td>
<td>
<p>graphic range. DEFAULT: range(x)</p>
</td></tr>
<tr><td><code id="expReg_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+plot">plot</a></code> and <code><a href="graphics.html#topic+abline">abline</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="stats.html#topic+predict.lm">predict.lm</a></code> result.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec. 2014
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="#topic+mReg">mReg</a></code>, <code><a href="#topic+linReg">linReg</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- runif(100, 1, 10)
y &lt;- 10^(0.3*x+rnorm(100, sd=0.3)+4)
plot(x,y)
expReg(x,y)
expReg(x,y, logy=FALSE)
expReg(x,y, predictnew=6, plot=FALSE)
expReg(x,y, predictnew=3:6, interval="none", plot=FALSE)

</code></pre>

<hr>
<h2 id='funnelPlot'>Funnel plots for proportional data</h2><span id='topic+funnelPlot'></span>

<h3>Description</h3>

<p>Funnel plots for proportional data with confidence interval based on sample size. Introduced by Stephen Few, 2013
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funnelPlot(
  x,
  n,
  labels = NULL,
  method = "classic",
  add = FALSE,
  xlim = range(n, finite = TRUE),
  ylim = range(x/n * 100, finite = TRUE),
  las = 1,
  xlab = "Sample size n",
  ylab = "Success rate [%]",
  main = "Funnel plot for Proportions",
  a3 = NULL,
  a2 = NULL,
  am = NULL,
  ap = NULL,
  at = NULL,
  al = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funnelPlot_+3A_x">x</code></td>
<td>
<p>Numeric vector with number of successes (cases).</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_n">n</code></td>
<td>
<p>Numeric vector with number of trials (population).</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_labels">labels</code></td>
<td>
<p>Labels for points. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_method">method</code></td>
<td>
<p>Method to calculate Confidence interval, see &quot;note&quot; below. Can also be &quot;wilson&quot;. DEFAULT: &quot;classic&quot;</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_add">add</code></td>
<td>
<p>Add to existing plot instead of drawing new plot? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_xlim">xlim</code></td>
<td>
<p>Graphical parameters, see <code><a href="graphics.html#topic+par">par</a></code> and <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: range(n, finite=TRUE)</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_ylim">ylim</code></td>
<td>
<p>y limit in [0:1] DEFAULT: range(x/n*100, finite=TRUE)</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_las">las</code></td>
<td>
<p>DEFAULT: 1</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_xlab">xlab</code></td>
<td>
<p>DEFAULT: &quot;Sample size n&quot;</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_ylab">ylab</code></td>
<td>
<p>DEFAULT: &quot;Success rate [%]&quot;</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_main">main</code></td>
<td>
<p>DEFAULT: &quot;Funnel plot for Proportions&quot;</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_a3">a3</code></td>
<td>
<p>List with arguments for CI lines at 3*sd (eg: col, lty, lwd, lend, etc.).
Overwrites defaults that are defined within the function (if contentually possible). DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_a2">a2</code></td>
<td>
<p>Arguments for line of 2 sd. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_am">am</code></td>
<td>
<p>Arguments for mean line. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_ap">ap</code></td>
<td>
<p>Arguments for the data points (cex, etc.). DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_at">at</code></td>
<td>
<p>Arguments for text (labels of each point). DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_al">al</code></td>
<td>
<p>Arguments for <code><a href="graphics.html#topic+legend">legend</a></code> (text.col, bty, border, y.intersp, etc.). DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="funnelPlot_+3A_...">...</code></td>
<td>
<p>further arguments passed to plot only!</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Nothing - the function just plots
</p>


<h3>The basic idea</h3>

<p>Salesman A (new to the job) has had 3 customers and
sold 1 car. So his success rate is 0.33. Salesman B sold 1372 customers 632
cars, thus having a success rate of 0.46 Promoting B solely because of the
higher rate fails to take experience and opportunity (n) into account! This
dilemma is what the funnel plot with the confidence interval (ci) solves.
See Stephen Few and Katherine Rowel's PDF for details on the interpretation.
</p>


<h3>Note</h3>

<p>the default for lty is not taken from par(&quot;lty&quot;). This would yield &quot;solid&quot;.
Overwriting lty for one of the three line categories then produces
eg c(&quot;2&quot;, &quot;solid&quot;, &quot;solid&quot;), which cannot be processed by legend.<br />
<b>Wilson's Method:</b> algebraic approximation to the binomial distribution, very accurate, even for very small numbers.<br />
<a href="https://webarchive.nationalarchives.gov.uk/20170106081156/http://www.apho.org.uk/resource/item.aspx?RID=39445">https://webarchive.nationalarchives.gov.uk/20170106081156/http://www.apho.org.uk/resource/item.aspx?RID=39445</a> see &quot;contains&quot;.<br />
<b>classic = Stephen Few's Method = the way I knew it:</b> sqrt( mu*(1-mu) / n )<br />
<a href="http://www.jerrydallal.com/LHSP/psd.htm">http://www.jerrydallal.com/LHSP/psd.htm</a><br />
<a href="https://commons.wikimedia.org/wiki/File:ComparisonConfidenceIntervals.png">https://commons.wikimedia.org/wiki/File:ComparisonConfidenceIntervals.png</a><br />
The apho Wilson method first yielded wrong upper limits in my translation (it needs 0:1 instead of %). Thus I added the wikipedia formula:<br />
<a href="https://de.wikipedia.org/wiki/Konfidenzintervall_einer_unbekannten_Wahrscheinlichkeit#Wilson-Intervall">https://de.wikipedia.org/wiki/Konfidenzintervall_einer_unbekannten_Wahrscheinlichkeit#Wilson-Intervall</a><br />
<a href="https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval">https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval</a><br />
Which other methods should I include? (That's not the hard part anymore)
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct 2013
</p>


<h3>References</h3>

<p><a href="https://www.perceptualedge.com/articles/visual_business_intelligence/variation_and_its_discontents.pdf">https://www.perceptualedge.com/articles/visual_business_intelligence/variation_and_its_discontents.pdf</a><br />
Excellent explanation of bayesian take on proportions: <a href="http://varianceexplained.org/r/empirical_bayes_baseball/">http://varianceexplained.org/r/empirical_bayes_baseball/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Taken directly from Stephen Few's PDF:
funnel &lt;- read.table(header=TRUE, text="
Name SampleSize Incidents
Tony 2 2
Mike 400 224
Jan 100 54
Bob 1000 505
Sheila 2 1
Jeff 10 5
Sandy 500 236
Mitch 200 92
Mary 10 3
John 2 0")

str(funnel)
X &lt;- funnel$Incidents
N &lt;- funnel$SampleSize

barplot(X/N, names=funnel$Name, main="success rate")
# not showing n!

funnelPlot(X,N)
# arguments for subfunctions as text may be given this way:
funnelPlot(x=X, n=N, labels=funnel$Name, at=list(cex=0.7, col="red"))
# Labeling many points is not very clear...
funnelPlot(X,N)
sel &lt;- c(1,4,10) # selection
text(N[sel], (X/N*100)[sel], funnel$Name[sel], cex=0.7)
# You could also pass a vector with partly empty strings to funnelPlot
funnelPlot(x=X, n=N, labels=replace(funnel$Name, c(2,3,5:9), ""), at=list(adj=0.5))


# Even though Jan is more successfull than Mary in succes rate terms, both are
# easily within random variation. Mary may just have had a bad start.
# That Mike is doing better than average is not random, but (with 95% confidence)
# actually due to him being a very good seller.

# one more interesting option:
funnelPlot(X,N, a3=list(lty=2))

funnelPlot(X,N, a3=list(col=2, lwd=5))
# changing round line ends in legend _and_ plot is easiest with
par(lend=1)
funnelPlot(X,N, a3=list(col=2, lwd=5))

# The Wilson method yields slighty different (supposedly better) limits for small n:
funnelPlot(X,N, method="classic", al=list(title="Standard Method"))
funnelPlot(X,N, add=TRUE, method="wilson", a3=list(lty=2, col="red"),
           a2=list(lty=2, col="blue"), al=list(x="bottomright", title="Wilson Method"))

# Both Wilson method implementations yield the same result:
funnelPlot(X,N, method="wilson")
funnelPlot(X,N, add=TRUE, method="wilsonapho",
           a3=list(lty=2, col="red"), a2=list(lty=2, col="blue"))


# Note on nl used in the function, the n values for the ci lines:
plot(     seq(      10 ,       300 , len=50), rep(  1, 50) )
points(10^seq(log10(10), log10(300), len=50), rep(0.8, 50) )
abline(v=10)
# CI values change rapidly at small n, then later slowly.
# more x-resolution is needed in the first region, so it gets more of the points

</code></pre>

<hr>
<h2 id='funSource'>Source code of a function</h2><span id='topic+funSource'></span>

<h3>Description</h3>

<p>open source code of a function in a loaded or specified package on 
github.com/cran or github.com/wch/r-source
</p>


<h3>Usage</h3>

<pre><code class='language-R'>funSource(x, character.only = is.character(x), local = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="funSource_+3A_x">x</code></td>
<td>
<p>Function name, with or without quotation marks.
Trailing brackets are removed: <code>xx()</code> -&gt; <code>"xx"</code>.<br />
Can be <code>package::function</code>, which must be quoted for
non-loaded packages.</p>
</td></tr>
<tr><td><code id="funSource_+3A_character.only">character.only</code></td>
<td>
<p>If TRUE, look for <code>SomeFun</code> instead of <code>MyFun</code>
in case <code>MyFun &lt;- "SomeFun"</code>. 
DEFAULT: <code><a href="base.html#topic+is.character">is.character</a>(x)</code></p>
</td></tr>
<tr><td><code id="funSource_+3A_local">local</code></td>
<td>
<p>Open offline version of the code? Lacks comments and
original formatting of source code. DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>links that are also opened with <code><a href="utils.html#topic+browseURL">browseURL</a></code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan+Dec 2016, May 2017, April 2019
</p>


<h3>See Also</h3>

<p><a href="https://github.com/brry/rskey#rskey">https://github.com/brry/rskey#rskey</a> to add this as a keyboard shortcut
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  ## browser windows should not be opened in CRAN checks
funSource("head")
funSource(message()) # handles brackets if fun can be evaluated without input
funSource("require", local=TRUE) # usefull when offline

funSource("OSMscale::earthDist") # works even for non-installed CRAN packages

is.error(funSource("earthDist"), TRUE, TRUE) # Error for unloaded package
require(plotrix); require(scales)
funSource(rescale) # from the last loaded package

tail &lt;- function(...) stop("This is a dummy function. Type: rm(tail)")
funSource("tail")
rm(tail)

## End(Not run)

</code></pre>

<hr>
<h2 id='getColumn'>get column from data.frame</h2><span id='topic+getColumn'></span>

<h3>Description</h3>

<p>(Try to) extract a column from a data frame with USEFUL warnings/errors.<br />
Watch out not to define objects with the same name as x if you are using
getColumn in a function!
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getColumn(x, df, trace = TRUE, convnum = TRUE, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getColumn_+3A_x">x</code></td>
<td>
<p>Column name to be subsetted. The safest is to use character strings
or <code><a href="base.html#topic+substitute">substitute</a>(input)</code>.
If there is an object &quot;x&quot; in a function environment,
its value will be used as name! (see upper2 example)</p>
</td></tr>
<tr><td><code id="getColumn_+3A_df">df</code></td>
<td>
<p>dataframe object</p>
</td></tr>
<tr><td><code id="getColumn_+3A_trace">trace</code></td>
<td>
<p>Logical: Add function call stack to the message? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="getColumn_+3A_convnum">convnum</code></td>
<td>
<p>Logical: Convert numerical input (even if character) to
Column name for that number?</p>
</td></tr>
<tr><td><code id="getColumn_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress non-df warning? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with values in the specified column
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+subset">subset</a></code>, <code><a href="base.html#topic+getElement">getElement</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>head(stackloss)
getColumn(Air.Flow, stackloss)
getColumn("Air.Flow", stackloss)
getColumn(2, stackloss)
getColumn("2",  stackloss) # works too...

# useful warnings:
getColumn(1, stackloss[0,])
getColumn(1, data.frame(AA=rep(NA,10)) )

# Code returning a character works as well:
getColumn(c("Air.Flow","Acid.Conc")[1],  stackloss)

# Can be used in functions to get useful messages:
upper &lt;- function(x, select) getColumn(x, stackloss[select,])
upper(Water.Temp)
upper(2)
upper(2, select=0)

checkerr &lt;- function(x) invisible(is.error(x, force=TRUE, tell=TRUE))

# Pitfall lexical scoping: R only goes up until it finds things:
upper2 &lt;- function(xx) {xx &lt;- "Timmy!"; getColumn(xx, stackloss)} # breaks!
checkerr( upper2(Water.Temp) ) # Column "Timmy" does not exist
# If possible, use "colname" with quotation marks.
# This also avoids the CRAN check NOTE "no visible binding for global variable"
upper3 &lt;- function(char=TRUE)
{
Sepal.Length &lt;- stackloss
if(char) head(getColumn("Sepal.Length", iris), 10)
else     head(getColumn( Sepal.Length,  iris), 10)
}
checkerr( upper3(char=FALSE) )
upper3(char=TRUE) # use string "Sepal.Length" and it works fine.


# The next examples all return informative errors:
checkerr( upper(Water) ) #  partial matching not supported by design
checkerr( getColumn("dummy", stackloss)) # no NULL for nonexisting columns
checkerr( getColumn(2,  stackloss[,0]) ) # error for empty dfs
checkerr( getColumn(Acid, stackloss)   ) # no error-prone partial matching
checkerr( getColumn(2:3,  stackloss)   ) # cannot be a vector
checkerr( getColumn(c("Air.Flow","Acid.Conc"),  stackloss) )


#getColumn("a", tibble::tibble(a=1:7, b=7:1)) # works but warns with tibbles

# Pitfall numerical column names:
df &lt;- data.frame(1:5, 3:7)
colnames(df) &lt;- c("a","1") # this is a bad idea anyways
getColumn("1", df) # will actually return the first column, not column "1"
getColumn("1", df, convnum=FALSE)  # now gives second column
# as said, don't name column 2 as "1" - that will confuse people

# More on scoping and code yielding a column selection:
upp1 &lt;- function(coln, datf) {getColumn(substitute(coln), datf)[1:5]}
upp2 &lt;- function(coln, datf) {getColumn(           coln,  datf)[1:5]}
upp1(Sepal.Length, iris)
upp2(Sepal.Length, iris)
upp1("Sepal.Length", iris)
upp2("Sepal.Length", iris)
vekt &lt;- c("Sepal.Length","Dummy")
# upp1(vekt[1], iris) # won't work if called e.g. by testExamples()
upp2(vekt[1], iris)

</code></pre>

<hr>
<h2 id='getName'>get the name of an input in nested function calls</h2><span id='topic+getName'></span>

<h3>Description</h3>

<p>get the name of an input in nested function calls
</p>


<h3>Usage</h3>

<pre><code class='language-R'>getName(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="getName_+3A_x">x</code></td>
<td>
<p>input object name or character string</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string with the name
</p>


<h3>Author(s)</h3>

<p><a href="https://stackoverflow.com/users/2725969/brodieg">https://stackoverflow.com/users/2725969/brodieg</a>
Implementation Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2016
</p>


<h3>See Also</h3>

<p><a href="https://stackoverflow.com/a/26558733">https://stackoverflow.com/a/26558733</a>, <code><a href="base.html#topic+substitute">substitute</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># This does not work well:

lower &lt;- function(x) deparse(substitute(x))
upper &lt;- function(y) lower(y)
lower(pi) # returns "pi", as expected
upper(pi) # returns "y".

# That's why there is getName:

getName(pi) # returns "pi", as expected
upper &lt;- function(y) getName(y)
upper(pi) # yay!

upper("dummy")
upper(dummy) # works also for nonexistent objects
dummy &lt;- 7
upper("dummy") # still stable
upper(dummy) # still stable

upper(stackloss[1:5,])

upper2 &lt;- function(data) upper(data)
upper2("K")
upper2(K)

# getName only works correctly if x is not an evaluated object:
lower2 &lt;- function(inp, assign=FALSE) {if(assign) inp &lt;- inp; getName(inp)}
lower2(pi)       # "pi"
lower2(pi, TRUE) # "3.14159265358979"

</code></pre>

<hr>
<h2 id='gof'>GOF measures</h2><span id='topic+gof'></span><span id='topic+gofNA'></span><span id='topic+rsquare'></span><span id='topic+rmse'></span><span id='topic+nse'></span><span id='topic+kge'></span>

<h3>Description</h3>

<p>Goodness of Fit measures (GOF) for two vectors.<br />
<b>gofNA</b>: not exported, checks input for each of the functions:<br />
<b>rsquare</b>: Coefficient of determination (R2)<br />
<b>rmse</b>: Root Mean Square Error (for minimizing in <code><a href="stats.html#topic+optim">optim</a></code>)<br />
<b>nse</b>: Nash-Sutcliffe efficiency, based on RHydro::eval.NSeff<br />
<b>kge</b>: Kling-Gupta efficiency (better than NSE),
based on hydroGOF::KGE, where there are many more options
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gofNA(a, b, quiet = FALSE, fun = "")

rsquare(a, b, quiet = FALSE)

rmse(a, b, quiet = FALSE)

nse(a, b, quiet = FALSE)

kge(a, b, quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="gof_+3A_a">a</code></td>
<td>
<p>Numerical vector with observational data</p>
</td></tr>
<tr><td><code id="gof_+3A_b">b</code></td>
<td>
<p>Simulated data (to be compared to a)</p>
</td></tr>
<tr><td><code id="gof_+3A_quiet">quiet</code></td>
<td>
<p>Should NA-removal warnings be suppressed?
This may be helpful within functions. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="gof_+3A_fun">fun</code></td>
<td>
<p>Character string with function name for error and warning messages</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Single numerical value
</p>


<h3>Note</h3>

<p>NAs are omitted with warning.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2016
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+cor">cor</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>.
<a href="https://en.wikipedia.org/wiki/R-squared">https://en.wikipedia.org/wiki/R-squared</a>,
<a href="https://en.wikipedia.org/wiki/Mean_squared_error">https://en.wikipedia.org/wiki/Mean_squared_error</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># R squared and RMSE --------------------------------------------------------
set.seed(123)
x &lt;- rnorm(20)
y &lt;- 2*x + rnorm(20)
plot(x,y)
legGOF &lt;- function(a,b)
  {
  text(a,b, paste(c("      R2","RMSE","  NSE","  KGE"), collapse="\n"), adj=1.2)
  text(a,b, paste(round(c(rsquare(x,y), rmse(x,y), nse(x,y), kge(x,y)),5),
                  collapse="\n"), adj=0)
  }
legGOF(-1.5, 2) # R2 good, but does not check for bias (distance from 1:1 line)

abline(a=0,b=1) ; textField(-1.5,-1.5, "1:1")
abline(lm(y~x), col="red")
p &lt;- predict(lm(y~x))
points(x, p, pch=3, col="red")
segments(x, y, x, p, col="red")
stopifnot(all.equal(  nse(y,p) , rsquare(y,x)  ))


# Input checks
is.error(   rmse(1:6, 1:8)    ,  tell=TRUE)
nse(replace(x,3,NA), y)
kge(rep(NA,20), y)
rmse(0,0, quiet=TRUE)
rsquare(1:6, tapply(chickwts$weight, chickwts$feed, mean) )

## Not run:  # time consuming Simulation

# sample size bias
x &lt;- 1:1000
y &lt;- x+rnorm(1000)
rmse(x,y) # 0.983
ssize &lt;- rep(5:1000, 3)
sgofs &lt;- sapply(ssize, function(n){i &lt;- sample(1:1000,n); c(rsquare(x[i],y[i]),rmse(x[i],y[i]))})
plot(ssize, sgofs[2,]) # RMSE: no bias, symmetric convergence
plot(ssize, sgofs[1,]) # R2: small underestimation in small samples

if(require(pbapply)) sapply &lt;- pbsapply
r2 &lt;- sapply(1:10000, function(i){
   x &lt;- rnorm(20);  y &lt;- 2*x + rnorm(20);  c(rsquare(x,y), rmse(x,y)) })
hist(r2[1,], breaks=70, col=5,
main= "10'000 times   x &lt;- rnorm(20);  y &lt;- 2*x + rnorm(20);  rsquare(x,y)")
# For small samples, R^2 can by chance be far off the 'real' value!
hist(r2[2,], breaks=70, col=5, main= "... rsquare(x,y)")
# RMSE is more symmetric and gaussian

## End(Not run)

# NSE and KGE ---------------------------------------------------------------

y &lt;- dbeta(1:40/40, 3, 10) # simulated
x &lt;- y + rnorm(40,0,sd=0.2) # observed
plot(x)
lines(y, col="blue")
legGOF(25, 2)
rmse(x,y) ; rmse(y,x)
nse(x,y) ; nse(y,x)  # x=obs, y=sim  (second command is wrong)
kge(x,y) ; kge(y,x)


</code></pre>

<hr>
<h2 id='googleLink2pdf'>extract pdf link from google search result</h2><span id='topic+googleLink2pdf'></span>

<h3>Description</h3>

<p>restrict pdf link from a google search to actual link with text processing
</p>


<h3>Usage</h3>

<pre><code class='language-R'>googleLink2pdf(googlelink)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="googleLink2pdf_+3A_googlelink">googlelink</code></td>
<td>
<p>Character string: A search result address</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Characterstring with only the basic link
</p>


<h3>Note</h3>

<p>The function is not vectorized! If you have many links, use a loop around this function...
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2012
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+strsplit">strsplit</a></code>, <code><a href="base.html#topic+gsub">gsub</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Link &lt;- paste0("https://www.google.de/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1",
        "&amp;cad=rja&amp;sqi=2&amp;ved=0CDIQFjAA&amp;url=http%3A%2F%2Fcran.r-project.org",
        "%2Fdoc%2Fmanuals%2FR-intro.pdf&amp;ei=Nyl4UfHeOIXCswa6pIC4CA",
        "&amp;usg=AFQjCNGejDwPlor4togQZmQEQv72cK9z8A&amp;bvm=bv.45580626,d.Yms")
googleLink2pdf(Link)

Link &lt;- paste0("https://www.google.de/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1",
        "&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjLlfmClavRAhWaN1AKHcGSBjEQFgghMAA",
        "&amp;url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2Ftagged%2Fr",
        "&amp;usg=AFQjCNHYj6HjSs6Lvczn9wMWxE3slCdq1Q&amp;bvm=bv.142059868,d.ZWM")
googleLink2pdf(Link)
Link &lt;- paste0("https://www.google.de/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=2",
        "&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjLlfmClavRAhWaN1AKHcGSBjEQFggpMAE&amp;",
        "url=http%3A%2F%2Fstackoverflow.com%2Fquestions%2Ftagged%2F%3Ftagnames",
        "%3Dr%26sort%3Dactive&amp;usg=AFQjCNGkPGHq05qwKLLW4vRXdmk2Olhmig&amp;bvm=bv.142059868,d.ZWM")
googleLink2pdf(Link)

</code></pre>

<hr>
<h2 id='groupHist'>Histogram for classes</h2><span id='topic+groupHist'></span>

<h3>Description</h3>

<p>Improvement of <code>tapply(x, g, hist)</code> with x and g taken from a data.frame
</p>


<h3>Usage</h3>

<pre><code class='language-R'>groupHist(
  df,
  x,
  g,
  xlab = "",
  ylab = "",
  breaks = 20,
  las = 1,
  main = NULL,
  unit = NA,
  col = "purple",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="groupHist_+3A_df">df</code></td>
<td>
<p>data.frame object name</p>
</td></tr>
<tr><td><code id="groupHist_+3A_x">x</code></td>
<td>
<p>column name of variable of interest</p>
</td></tr>
<tr><td><code id="groupHist_+3A_g">g</code></td>
<td>
<p>column name of groups (<code>INDEX in <a href="base.html#topic+tapply">tapply</a>, f in <a href="base.html#topic+split">split</a></code>)</p>
</td></tr>
<tr><td><code id="groupHist_+3A_xlab">xlab</code>, <code id="groupHist_+3A_ylab">ylab</code></td>
<td>
<p>axis labels. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="groupHist_+3A_breaks">breaks</code></td>
<td>
<p><code><a href="graphics.html#topic+hist">hist</a> breaks</code>. DEFAULT: 20</p>
</td></tr>
<tr><td><code id="groupHist_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 1, means numbers on y-axis upright</p>
</td></tr>
<tr><td><code id="groupHist_+3A_main">main</code></td>
<td>
<p>Main title, internal default based on <code>d, x, unit</code> and <code>g</code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="groupHist_+3A_unit">unit</code></td>
<td>
<p>Unit to be written into the default title. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="groupHist_+3A_col">col</code></td>
<td>
<p>Color vector to be used, recycled.</p>
</td></tr>
<tr><td><code id="groupHist_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses <code><a href="base.html#topic+split">split</a></code> to categorize into groups.
</p>


<h3>Value</h3>

<p>NULL, used for plotting
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2015
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="base.html#topic+tapply">tapply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
groupHist(chickwts, weight, "feed", col="salmon")
groupHist(chickwts, "weight", "feed", col=2, unit="grams at age 6 weeks")
groupHist(chickwts, weight, feed, col="khaki", breaks=5, main="Hi there")
groupHist(iris, Petal.Width, Species)

</code></pre>

<hr>
<h2 id='headtail'>head and tail</h2><span id='topic+headtail'></span>

<h3>Description</h3>

<p>show head and tail of an object with one command
</p>


<h3>Usage</h3>

<pre><code class='language-R'>headtail(x, n = 1, nh = n, nt = n, na = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="headtail_+3A_x">x</code></td>
<td>
<p>Object</p>
</td></tr>
<tr><td><code id="headtail_+3A_n">n</code></td>
<td>
<p>Number of elements/rows/lines at begin and end of object to be returned. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="headtail_+3A_nh">nh</code>, <code id="headtail_+3A_nt">nt</code></td>
<td>
<p>Number for <code><a href="utils.html#topic+head">head</a></code> and <code><a href="utils.html#topic+tail">tail</a></code>, respectively. DEFAULT: n</p>
</td></tr>
<tr><td><code id="headtail_+3A_na">na</code></td>
<td>
<p>Add NA values in between to emphasize visibly that there is
something inbetween the values? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="headtail_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="utils.html#topic+head">head</a></code> and <code><a href="utils.html#topic+tail">tail</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Tries to find good methods of combining the two results according to <code>class(x)</code>.
</p>


<h3>Value</h3>

<p><code><a href="utils.html#topic+head">head</a></code> result
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Mrz 2016
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+head">head</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
head(letters, n=3)
headtail(letters)
headtail(letters, n=3)
headtail(letters, n=3, na=TRUE)

head(letters, n=-10)
headtail(letters, n=-10, na=TRUE) # doesn't make sense for headtail

head(freeny.x, n=3)               # matrix
headtail(freeny.x, n=3, na=TRUE)  # no names for head-part
headtail(women, n=3, na=TRUE)     # data.frame works fine

head(freeny.y, n=3)
headtail(freeny.y, n=3, na=TRUE)

head(library, n=3)
headtail(library, n=3, na=TRUE)
headtail(library, na=TRUE)

ftable(Titanic)
head(stats::ftable(Titanic), n=4)
headtail(stats::ftable(Titanic), n=4, na=TRUE)

head(table(sample(1:9, 30, TRUE)), n=3)
headtail(table(sample(1:9, 30, TRUE)), n=3, na=TRUE)

head(table(state.division, state.region), n=3)
headtail(table(state.division, state.region), n=3, na=TRUE)

</code></pre>

<hr>
<h2 id='horizHist'>Horizontal histogram</h2><span id='topic+horizHist'></span>

<h3>Description</h3>

<p>Draw a histogram with bars horizontally
</p>


<h3>Usage</h3>

<pre><code class='language-R'>horizHist(
  Data,
  breaks = "Sturges",
  freq = TRUE,
  plot = TRUE,
  col = par("bg"),
  border = par("fg"),
  las = 1,
  xlab = if (freq) "Frequency" else "Density",
  main = paste("Histogram of", deparse(substitute(Data))),
  ylim = range(HBreaks),
  labelat = pretty(ylim),
  labels = labelat,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="horizHist_+3A_data">Data</code></td>
<td>
<p>any data that <code><a href="graphics.html#topic+hist">hist</a></code> would take.</p>
</td></tr>
<tr><td><code id="horizHist_+3A_breaks">breaks</code></td>
<td>
<p>character or numerical as explained in <code><a href="graphics.html#topic+hist">hist</a></code>. DEFAULT: &quot;Sturges&quot;</p>
</td></tr>
<tr><td><code id="horizHist_+3A_freq">freq</code></td>
<td>
<p>logical. if TRUE, the histogram graphic is a representation of frequencies, the counts component of the result;
if FALSE, probability densities, component density, are plotted (so that the histogram has a total area of one). DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="horizHist_+3A_plot">plot</code></td>
<td>
<p>logical. Should histogram be plotted? FALSE to get just the hpos function. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="horizHist_+3A_col">col</code></td>
<td>
<p>color. DEFAULT: par(&quot;bg&quot;)</p>
</td></tr>
<tr><td><code id="horizHist_+3A_border">border</code></td>
<td>
<p>color of borders of bars. DEFAULT: par(&quot;fg&quot;)</p>
</td></tr>
<tr><td><code id="horizHist_+3A_las">las</code></td>
<td>
<p>integer. Label axis style. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="horizHist_+3A_xlab">xlab</code></td>
<td>
<p>character. Label for x-axis. DEFAULT: &quot;absolute frequency&quot;</p>
</td></tr>
<tr><td><code id="horizHist_+3A_main">main</code></td>
<td>
<p>character. Title for graphic. DEFAULT: &quot;Histogram of substitute(Data)&quot;</p>
</td></tr>
<tr><td><code id="horizHist_+3A_ylim">ylim</code></td>
<td>
<p>numerical vector of two elements. Y-axis limits. DEFAULT: range of data</p>
</td></tr>
<tr><td><code id="horizHist_+3A_labelat">labelat</code></td>
<td>
<p>numerical vector. Position of Y-Axis labels. DEFAULT: pretty(ylim)</p>
</td></tr>
<tr><td><code id="horizHist_+3A_labels">labels</code></td>
<td>
<p>numerical or character. The labels themselves. DEFAULT: labelat</p>
</td></tr>
<tr><td><code id="horizHist_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+barplot">barplot</a></code> and <code><a href="graphics.html#topic+axis">axis</a></code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>Uses barplot to draw the histogram horizontally.
</p>


<h3>Value</h3>

<p>function to address y-coordinates
</p>


<h3>Note</h3>

<p>Doesn't work with breakpoints provided as a vector with different widths of the bars.<br />
Please do not forget to use the function for vertical positioning from the <b>current</b> horizontal histogram.
If It is not working correctly, you might have the function defined from some prior horizHist result.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011-2012
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+hist">hist</a></code>, <code><a href="graphics.html#topic+barplot">barplot</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Data and basic concept
set.seed(8); ExampleData &lt;- rnorm(50,8,5)+5
hist(ExampleData)
hpos &lt;- horizHist(ExampleData)
# Caution: the labels at the y-axis are not the real coordinates!
# abline(h=2) will draw above the second bar, not at the label value 2.
# Use hpos (horizontal position), the function returned by horizHist:
abline(h=hpos(11), col=2, lwd=2)

# Further arguments
horizHist(ExampleData, xlim=c(-8,20))
horizHist(ExampleData, ylab="the ... argument worked!", col.axis=3)
hist(ExampleData, xlim=c(-10,40)) # with xlim
horizHist(ExampleData, ylim=c(-10,40), border="red") # with ylim
hpos &lt;- horizHist(ExampleData, breaks=20, col="orange")
axis(2, hpos(0:10), labels=FALSE, col=2) # another use of hpos()

</code></pre>

<hr>
<h2 id='if.error'>expressions/values conditional on whether tested expression returns an error.</h2><span id='topic+if.error'></span>

<h3>Description</h3>

<p>Does a given expression return an error? 
Return specific values/expressions for either case.
Useful for loops when you want to easily control values based on errors that arise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>if.error(expr, error_true, error_false)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="if.error_+3A_expr">expr</code></td>
<td>
<p>Expression to be tested for returning an error.</p>
</td></tr>
<tr><td><code id="if.error_+3A_error_true">error_true</code></td>
<td>
<p>Value or expression to be executed if tested expression returns an error.</p>
</td></tr>
<tr><td><code id="if.error_+3A_error_false">error_false</code></td>
<td>
<p>Value or expression to be executed if tested expression does not return an error.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns value or expression stated in <code>error_true</code> or <code>error_false</code>,
depending on whether the tested expression throws an error.
</p>


<h3>Author(s)</h3>

<p>Nick Bultman, <a href="mailto:njbultman74@gmail.com">njbultman74@gmail.com</a>, September 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+is.error">is.error</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if.error(  log(3),   "error", "no_error" )
if.error(  log(3),   "error", log(3)  )
if.error(  log(3),   log(6), "no_error" )
if.error(  log("a"), log(6), log(3) )

</code></pre>

<hr>
<h2 id='insertRows'>insert rows to data.frame</h2><span id='topic+insertRows'></span>

<h3>Description</h3>

<p>Insert (multiple) rows to a data.frame, possibly coming from another data.frame, with value and row recycling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>insertRows(df, r, new = NA, rcurrent = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="insertRows_+3A_df">df</code></td>
<td>
<p>data.frame</p>
</td></tr>
<tr><td><code id="insertRows_+3A_r">r</code></td>
<td>
<p>Row number (not name!), at which the <code>new</code> row is to be inserted.
Can be a vector.</p>
</td></tr>
<tr><td><code id="insertRows_+3A_new">new</code></td>
<td>
<p>Vector with data to be inserted, is recycled.
Alternatively, a data.frame, whose rows are put into the r locations.
If it has more rows than length(r), the excess rows are ignored.
DEFAULT: NA</p>
</td></tr>
<tr><td><code id="insertRows_+3A_rcurrent">rcurrent</code></td>
<td>
<p>Logical: should <code>r</code> specify the current rows of <code>df</code>,
after which <code>new</code> is to be appended?
If FALSE (the default for backwards compatibility), the rownumbers 
of the output (instead of the input) are <code>r</code>. I.e. <code>new</code> is 
inserted <em>at</em>, not <em>after</em> the rownumber. DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Note</h3>

<p>Has not yet been tested with RWI (really weird input), so might not be absolutely foolproof
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct 2015, based on code by Ari B. Friedmann
(I added the for loop, recycling, input controls and data.framification)
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/11561856/add-new-row-to-dataframe">https://stackoverflow.com/questions/11561856/add-new-row-to-dataframe</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+addRows">addRows</a></code>, <code><a href="#topic+sortDF">sortDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
existingDF &lt;- as.data.frame(matrix(1:20, nrow=5, ncol=4))
existingDF
insertRows(existingDF, 2) # default new=NA is recycled
insertRows(existingDF, 2, rcurrent=TRUE) # after current line, not at it
insertRows(existingDF, 2, 444:446)
insertRows(existingDF, 3, new=matrix(10:1,ncol=2)) # input warning
insertRows(existingDF, 1)
insertRows(existingDF, 5)
insertRows(existingDF, 6) # use addRows for this:
addRows(existingDF, n=1)
insertRows(existingDF, 9) # pads NA rows inbetween

# Works for multiple rows as well:
insertRows(existingDF, r=c(2,4,5), new=NA, rcurrent=TRUE)
insertRows(existingDF, r=c(2,4,5), new=NA)
insertRows(existingDF, r=c(2,4,4), new=NA)
insertRows(existingDF, r=c(2,4,4), new=NA, rcurrent=TRUE)

# Also works with a data.frame for insertion:
insertDF &lt;- as.data.frame(matrix(101:112, nrow=3, ncol=4))
insertRows(existingDF, 3, new=insertDF) # excess rows in new are ignored
insertRows(existingDF, c(2,4,5), new=insertDF)
insertRows(existingDF, c(2,4:6), new=insertDF) # rows are recycled

</code></pre>

<hr>
<h2 id='is.error'>Check if an expression returns an error</h2><span id='topic+is.error'></span>

<h3>Description</h3>

<p>Does a given expression return an error?
Useful for tests where you want to make sure your function throws an error.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is.error(expr, tell = FALSE, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is.error_+3A_expr">expr</code></td>
<td>
<p>Expression to be tested for returning an error</p>
</td></tr>
<tr><td><code id="is.error_+3A_tell">tell</code></td>
<td>
<p>Logical: Should the error message be printed via <code><a href="base.html#topic+message">message</a></code>? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="is.error_+3A_force">force</code></td>
<td>
<p>Logical: Should an error be returned if the expression is not an error? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>TRUE/FALSE
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+stop">stop</a></code>, <code><a href="base.html#topic+try">try</a></code>, <code><a href="base.html#topic+inherits">inherits</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>is.error(  log(3)              )
is.error(  log("a")            )
is.error(  log(3),   tell=TRUE )
is.error(  log("a"), tell=TRUE )
stopifnot( is.error( log("a")  )  ) # or shorter:
is.error(  log("a"), force=TRUE)
# is.error(  log(3),   force=TRUE)
stopifnot(is.error(  is.error(log(3), force=TRUE)  ))

</code></pre>

<hr>
<h2 id='l2array'>Convert list of arrays to array</h2><span id='topic+l2array'></span>

<h3>Description</h3>

<p>Convert a list of arrays to a single array, conserving names.
If dimnames do not need to be checked, you can also directly use <br />
<code>do.call(abind::abind, list(LIST, rev.along=0, use.dnns=TRUE)) </code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2array(x, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2array_+3A_x">x</code></td>
<td>
<p>List with arrays/data.frames. The dimension of the first is target dimension.</p>
</td></tr>
<tr><td><code id="l2array_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code>abind::<a href="abind.html#topic+abind">abind</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>array
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+l2df">l2df</a></code>, <code><a href="utils.html#topic+help">help</a></code>,
<a href="https://stackoverflow.com/a/4310747">https://stackoverflow.com/a/4310747</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
LISTm &lt;- lapply(list(1:6,7:12,13:18,19:24), matrix, ncol=3,
               dimnames=list(x=c("a","b"), y=c("i","j","k"))  )
l2array(LISTm)

LIST &lt;- lapply(LETTERS[1:5], function(x) array(paste0(x,1:24), dim=c(3,4,2)))
str(LIST)
LIST[[2]]
LISTa1 &lt;- l2array(LIST)
LISTa1
str(LISTa1)

# The old l2array (&lt;1.13.14, 2017-01-06) was very slow on large lists.
# I then found abind, which is much much much faster and easier on memory!
# It now replaces the internal old actual conversion code
# l2array still checks the dimnames
LISTa2 &lt;- do.call(abind::abind, list(LIST, rev.along=0, use.dnns=TRUE))
LISTa2
stopifnot(all(LISTa1==LISTa2))
rm(LIST, LISTa1, LISTa2)


# list of dataframes:
LDF &lt;- list(IR1=iris[1:5,1:2], IR2=iris[11:15,1:2], IR3=iris[21:25,1:2])
l2array(LDF)



# General intro to arrays -----

A1 &lt;- array(1:24, dim=c(4,2,3), dimnames=list(
                   my_x=paste0("row",1:4), my_y=c("A","B"), paste0("n",1:3)))
A1
which(A1==20, arr.ind=TRUE)

# Selection:
A1[,,"n2"]
A1[,,1:2]
A1["row2",,] # result rotated against expectation -&gt; transpose with t(...)
A1[,"A",]
# aggregation:
apply(A1, MARGIN=1:2, FUN=sum) # keep first two dimensions
apply(A1, MARGIN=c(1,3), FUN=sum) # aggregate over my_y -&gt; row1: 6, 22, 38
A1["row1",,]                                    # 1+5=6, 9+13=22, 17+21=38

as.vector(A1)

A &lt;- array(1:24, dim=c(3,4,2), dimnames=list(x=paste0("x",1:3),
                                             y=paste0("y",1:4),
                                             z=paste0("z",1:2)))
str(A)
rm(A)


# l2array -----

A2 &lt;- A1+2
A3 &lt;- A1+4
LIST &lt;- list(A1=A1, A2=A2, A3=A3) # list of arrays

LA &lt;- l2array(LIST)
LA
str(LA)
LA[,,,"A2"]
LA["row2", ,"n2",]
avg &lt;- apply(LA, MARGIN=1:3, mean)
stopifnot(all(avg==A2))


# names check -----

LISTN &lt;- LIST
names(dimnames(LISTN[[2]]))[3] &lt;- "intentional"
dimnames(LISTN[[3]])[3] &lt;- list(paste0("k",1:3))
LAN &lt;- l2array(LISTN)
LAN["row2", ,"k2",] # n2 is now changed to k2
LANa &lt;- do.call(abind::abind, list(LISTN, rev.along=0, use.dnns=TRUE))
all(LAN==LANa)
str(LANa)

LISTN &lt;- LIST
rownames(LISTN[[3]])[2] &lt;- "intentional_diff"
LAN &lt;- l2array(LISTN)

# data type check
is.error(   A &lt;- l2array(c(LA, 999)),  tell=TRUE, force=TRUE)


</code></pre>

<hr>
<h2 id='l2df'>List to data.frame</h2><span id='topic+l2df'></span>

<h3>Description</h3>

<p>Convert list with vectors of unequal length to dataframe, pad with NAs
</p>


<h3>Usage</h3>

<pre><code class='language-R'>l2df(list, byrow = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="l2df_+3A_list">list</code></td>
<td>
<p>List with vectors of irregular length.</p>
</td></tr>
<tr><td><code id="l2df_+3A_byrow">byrow</code></td>
<td>
<p>Transposed output? DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2014
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/5531471/combining-unequal-columns-in-r">https://stackoverflow.com/questions/5531471/combining-unequal-columns-in-r</a><br />
<a href="https://stackoverflow.com/questions/15753091/convert-mixed-length-named-list-to-data-frame">https://stackoverflow.com/questions/15753091/convert-mixed-length-named-list-to-data-frame</a><br />
<a href="https://stackoverflow.com/questions/5942760/most-efficient-list-to-data-frame-method">https://stackoverflow.com/questions/5942760/most-efficient-list-to-data-frame-method</a><br />
<a href="https://stackoverflow.com/questions/8799990/converting-given-list-into-dataframe">https://stackoverflow.com/questions/8799990/converting-given-list-into-dataframe</a><br />
<a href="https://stackoverflow.com/questions/4227223/r-list-to-data-frame">https://stackoverflow.com/questions/4227223/r-list-to-data-frame</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+l2array">l2array</a></code>, <code><a href="base.html#topic+sapply">sapply</a></code>, <code><a href="#topic+sortDF">sortDF</a></code>.
If you have a LARGE list each with the same number of values,
use the (much!) faster: <code><a href="base.html#topic+simplify2array">simplify2array</a></code> or <code>plyr::quickdf</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
eglist &lt;- list(AA=c(6,9,2,6), BB=1:8, CC=c(-3,2) )
eglist
l2df(eglist)  # names are even kept
l2df(eglist, byrow=FALSE)
class(  l2df(eglist, byrow=FALSE)  ) # data.frame (since 2016-05-24)

eglist &lt;- list(AA=c(6,9,2,6), BB="no", CC=c(-3,2) )
eglist
str(l2df(eglist))  # now everything is a character

eg2 &lt;- list(AA=c(6,9,2,6), BB=matrix(1:8, ncol=2), CC=c(-3,2) )
eg2
l2df(eg2, FALSE)
# so a matrix is internally converted to a vector and then used regularly


# Naming ----

eg3 &lt;- list(EE=c(AA=3.4),        FF=c(AA=3.5),        GG=c(AA=3.6))
eg4 &lt;- list(EE=c(AA=3.4,BB=2.4), FF=c(AA=3.5,BB=2.5), GG=c(AA=3.6,BB=2.6))
l2df(eg3)
l2df(eg4)
l2df(eg3, byrow=FALSE)
l2df(eg4, byrow=FALSE)

eg3 &lt;- list(c(AA=3.4),        c(AA=3.5),        c(AA=3.6))
eg4 &lt;- list(c(AA=3.4,BB=2.4), c(AA=3.5,BB=2.5), c(AA=3.6,BB=2.6))
l2df(eg3)
l2df(eg4)
l2df(eg3, byrow=FALSE)
l2df(eg4, byrow=FALSE)

eg3 &lt;- list(EE=c(3.4),     FF=c(3.5),     GG=c(3.6))
eg4 &lt;- list(EE=c(3.4,2.4), FF=c(3.5,2.5), GG=c(3.6,2.6))
l2df(eg3)
l2df(eg4)
l2df(eg3, byrow=FALSE)
l2df(eg4, byrow=FALSE)

eg3 &lt;- list(EE=c(3.4),     c(3.5),     c(3.6))
eg4 &lt;- list(EE=c(3.4,2.4), c(3.5,2.5), c(3.6,2.6))
l2df(eg3)
l2df(eg4)
l2df(eg3, byrow=FALSE)
l2df(eg4, byrow=FALSE)


# Lists with dfs ----

eg5 &lt;- list(AA=c(6,9,2,6), BB=data.frame(CC=1:8, DD=4:-3), EE=c(-3,2) )
eg5
is.error( l2df(eg5), tell=TRUE )# it is not possible to do this with a data.frame

# If you have a list with only data.frames, you could use the following:
eg6 &lt;- list(AA=data.frame(BB=1:8, CC=4:-3), DD=data.frame(EE=23:24, FF=c(-3,2)))
eg6
do.call(cbind, eg6) # but this recycles the values of shorter tables!
colnames(eg6$DD) &lt;- colnames(eg6$AA)
do.call(rbind, eg6)
# check some of the links above for more solutions...

</code></pre>

<hr>
<h2 id='learnVocab'>spaced learning</h2><span id='topic+learnVocab'></span>

<h3>Description</h3>

<p>spaced learning e.g. for vocabulary. Uses interactive questions.<br />
Note: this currently clears the console!<br />
Based on <a href="https://ncase.me/remember/">https://ncase.me/remember/</a> by Nicky Case.<br />
At the beginning, new vocab will be asked, skip with empty ENTER.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>learnVocab(vocfile = "C:/Dropbox/Sonstiges/Vokabeln.csv", nnew = 3)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="learnVocab_+3A_vocfile">vocfile</code></td>
<td>
<p>File with vocabulary (or whatever you want to learn).
The first line must contain the learning day, see examples.
The second line must contain LEVEL;known;new, the last two being
(short) names, e.g. languages (known will be displayed first).</p>
</td></tr>
<tr><td><code id="learnVocab_+3A_nnew">nnew</code></td>
<td>
<p>Number of new entries to be added interactively at the start.
They can still be skipped by writing nothing and pressing the ENTER key.
DEFAULT: 3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Updated vocab list, invisibly.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Excluded from checks, works only interactively! 
# initiate empty vocab list:
vocfile &lt;- tempfile("myvocab",fileext=".csv")
cat("learning_day 1\nLEVEL;DE;FR\n1;Das Haus;la maison\n", file=vocfile)

learnVocab(vocfile) # asks new vocab, then tests and changes level as needed

## End(Not run)

</code></pre>

<hr>
<h2 id='legendmt'>legend with multiline title</h2><span id='topic+legendmt'></span>

<h3>Description</h3>

<p>Draw a legend with title spanning several lines (i.e. with line breaks).
Note that this is in development and not all inputs are correctly vectorized yet.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>legendmt(
  x,
  y = NULL,
  legend,
  title,
  x.intersp = 1,
  fill = NA,
  col = par("col"),
  border = NA,
  lty = NA,
  lwd = NA,
  pch = NA,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="legendmt_+3A_x">x</code>, <code id="legendmt_+3A_y">y</code>, <code id="legendmt_+3A_legend">legend</code></td>
<td>
<p>Arguments as in <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="legendmt_+3A_title">title</code></td>
<td>
<p>Character with linebreaks or vector of charstrings.</p>
</td></tr>
<tr><td><code id="legendmt_+3A_x.intersp">x.intersp</code>, <code id="legendmt_+3A_fill">fill</code>, <code id="legendmt_+3A_col">col</code>, <code id="legendmt_+3A_border">border</code>, <code id="legendmt_+3A_lty">lty</code>, <code id="legendmt_+3A_lwd">lwd</code>, <code id="legendmt_+3A_pch">pch</code></td>
<td>
<p>Arguments as in <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="legendmt_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+legend">legend</a></code>.
If vectorized, please remember to prepend NAs or whatever.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code> output
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2017
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+legend">legend</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:10)
  legend("topleft", letters[1:4], col=1:4, pch=1, title="very long title to be split up")
legendmt("topleft", letters[1:4], col=1:4, pch=1, title="very long title\nnow splat up")

# Alternative:
plot(1:10)
legend("topleft", "very long title to be split up")
legend("topleft", letters[1:4], col=1:4, pch=1, inset=c(0,0.09) )

</code></pre>

<hr>
<h2 id='library2'>install.package and library</h2><span id='topic+library2'></span><span id='topic+require2'></span>

<h3>Description</h3>

<p>install and load a package. If a package is not available, it is installed before being loaded
</p>


<h3>Usage</h3>

<pre><code class='language-R'>library2(name, quietly = FALSE, libargs = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="library2_+3A_name">name</code></td>
<td>
<p>Name of the package(s). Can be quoted, must not.</p>
</td></tr>
<tr><td><code id="library2_+3A_quietly">quietly</code></td>
<td>
<p>passed to <code><a href="base.html#topic+library">library</a></code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="library2_+3A_libargs">libargs</code></td>
<td>
<p>List of arguments passed to <code><a href="base.html#topic+library">library</a></code> like <code>lib.loc</code>, <code>verbose</code> etc. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="library2_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="utils.html#topic+install.packages">install.packages</a></code> like <code>lib</code>, <code>repos</code> etc.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+message">message</a>s</code> help instruction.
</p>


<h3>Note</h3>

<p>Passing a vector with packages will work, but give some warnings.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2014+2020
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+install.packages">install.packages</a></code>, <code><a href="base.html#topic+library">library</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## Excluded fom CRAN checks. Package installation on server is unnecessary.
require2(ada)
library2("statmod")

## End(Not run)

</code></pre>

<hr>
<h2 id='lim0'>axis limits with one end at zero</h2><span id='topic+lim0'></span>

<h3>Description</h3>

<p>Calculates the range needed for ylim or xlim in plot, so that axis
starts at zero and is extended by 4% at the other end
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lim0(x, f = 1/27, curtail = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lim0_+3A_x">x</code></td>
<td>
<p>Numeric. Vector with values</p>
</td></tr>
<tr><td><code id="lim0_+3A_f">f</code></td>
<td>
<p>Numeric. Extension factor. DEFAULT: 0.04 as in extendrange used eg. by <code><a href="graphics.html#topic+curve">curve</a></code></p>
</td></tr>
<tr><td><code id="lim0_+3A_curtail">curtail</code></td>
<td>
<p>Logical. Should the range returned be trimmed by 4%? That way,
plotting doesn't need the default <code><a href="graphics.html#topic+par">par</a></code> xaxs or yaxs changed. DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with two values: 0 and by 4
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 6.6.2013
</p>


<h3>References</h3>

<p><code>methods(plot)</code>, <code><a href="graphics.html#topic+plot.default">plot.default</a></code>.
Actually, I found extendrange via <code>plot.function</code> in <code>curve</code>
</p>


<h3>See Also</h3>

<p>The <code><a href="grDevices.html#topic+extendrange">extendrange</a>()</code> utility in package <span class="pkg">grDevices</span>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# basic idea:
val &lt;- c(3.2, 1.8, 4.5, 2.8, 0.1, 2.9) # just some numbers
plot(val, ylim=lim0(val) ) # you don't even have to set yaxs="i" ;-)

# "normal" plot:
plot(val)
par("usr")  # -0.076  4.676

# if y-axis is not allowed to go below 0, and we're too lazy to set yaxs="i":
plot(val, ylim=lim0(val) )
round( par("usr")  , digits=5) # 0.00000 4.66296

# with 0.04 extension as claimed by help page (1/27 in source code = 0.037):
plot(val, ylim=lim0(val, f=0.04) )
round( par("usr")  , digits=5) # zero is not included on axis anymore

b &lt;- -val
plot(b)
plot(b, ylim=lim0(b) ) # works with only negative values as well

# can handle only-NA input:
lim0(c(7,NA,NA,NA)[-1])
lim0(c(NA,NA,NA))

</code></pre>

<hr>
<h2 id='linLogHist'>lin-log transition histogram</h2><span id='topic+linLogHist'></span>

<h3>Description</h3>

<p>Draw histograms that gradually transform from a linear to a logarithmic axis (animation)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linLogHist(
  x,
  steps = 100,
  breaks = 20,
  col = "blue",
  las = 1,
  xlab = deparse(substitute(x)),
  xlim = range(x, finite = TRUE),
  box = TRUE,
  parexpr,
  endexpr,
  sleep = 0,
  axisargs = NULL,
  axisargs2 = NULL,
  firstplot = TRUE,
  lastplot = TRUE,
  write_t = TRUE,
  values_t = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linLogHist_+3A_x">x</code></td>
<td>
<p>x values to be plotted in animation</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_steps">steps</code></td>
<td>
<p>Number of steps in transition. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_breaks">breaks</code></td>
<td>
<p><code><a href="graphics.html#topic+hist">hist</a></code> breaks. DEFAULT: 20</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_col">col</code></td>
<td>
<p><code><a href="graphics.html#topic+hist">hist</a></code> color. DEFAULT: &quot;blue&quot;</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_las">las</code></td>
<td>
<p><code><a href="graphics.html#topic+par">par</a></code> LabelAxisStyle (numbers upright). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_xlab">xlab</code></td>
<td>
<p>Label for the x axis. DEFAULT: deparse(substitute(x))</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_xlim">xlim</code></td>
<td>
<p>xlim range in non-log units. DEFAULT: range(x, finite=TRUE)</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_box">box</code></td>
<td>
<p>Draw box at the end to overplot <code><a href="graphics.html#topic+abline">abline</a>s</code> crossing the box? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_parexpr">parexpr</code></td>
<td>
<p>Characterized Expression to set <code><a href="graphics.html#topic+par">par</a></code>, eg. <code>parexpr='par(mar=c(2,0.5,1.5,0.5), mpg=c(1.8,1,0))'</code></p>
</td></tr>
<tr><td><code id="linLogHist_+3A_endexpr">endexpr</code></td>
<td>
<p>Characterized Expression executed at the end of the plot, eg. <code>endexpr='mtext("Probability Density", line=-1, adj=0.03, outer=T)'</code></p>
</td></tr>
<tr><td><code id="linLogHist_+3A_sleep">sleep</code></td>
<td>
<p>Pause time between frames, in seconds, passed to <code><a href="base.html#topic+Sys.sleep">Sys.sleep</a></code>. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_axisargs">axisargs</code></td>
<td>
<p>List of arguments passed to <code><a href="#topic+logVals">logVals</a></code>, like base. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_axisargs2">axisargs2</code></td>
<td>
<p>List of arguments passed to <code><a href="#topic+logAxis">logAxis</a></code> in the final plot. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_firstplot">firstplot</code></td>
<td>
<p>plot on linear scale first? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_lastplot">lastplot</code></td>
<td>
<p>plot on logarithmic scale at the end? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_write_t">write_t</code></td>
<td>
<p>write transformation value in lower right corner? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_values_t">values_t</code></td>
<td>
<p>Supply vector with values for transformation (1/t). Overrides steps.
If you have a better algorithm than I do, please let me know! DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linLogHist_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code>, like freq, main, xlim, ylab. Excluded: x, xaxt, possibly add</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returned invisibly: transformation values used. Plotted: <code>steps</code> number of images.
</p>


<h3>Note</h3>

<p>It's best to save the plots into a pdf or wrap it within<br />
<code>png("Transition%03d"); linLogHist(x); dev.off()</code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, April 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+linLogTrans">linLogTrans</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- rlnorm(700, m=3)
hist(x, col=4)
hist(log10(x), xaxt="n"); logAxis(1); hist(log10(x), col=4, add=TRUE)

op &lt;- par()
linLogHist(x, steps=8, sleep=0.01) # 0.05 might be smoother

linLogHist(x, xlab="ddd", breaks=30, steps=3, write_t=FALSE, yaxt="n", freq=FALSE,
   main="", parexpr='par(mar=c(2,0.5,1.5,0.5), mgp=c(1.8,1,0))',
   endexpr='mtext("Probability Density", line=-1.2, adj=0.03, outer=T)')
par(op)

## Not run: 
## Rcmd check --as-cran doesn't like to open external devices such as pdf,
## so this example is excluded from running in the checks.
pdf("LinLogTransitionAnimation.pdf")
linLogHist(x, main="Example Transition", steps=20, freq=FALSE)
dev.off()

# if you have FFmpeg installed, you can use the animation package like this:
library2(animation)
saveVideo(linLogHist(x, steps=50), video.name="linlog_anim.mp4", interval=0.08,
ffmpeg="C:/ffmpeg-20150424-git-cd69c0e-win64-static/bin/ffmpeg.exe")

## End(Not run)

</code></pre>

<hr>
<h2 id='linLogTrans'>Animation for transition from linear to logarithmic axis</h2><span id='topic+linLogTrans'></span>

<h3>Description</h3>

<p>draw images that gradually transform from a linear to a logarithmic axis
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linLogTrans(
  x,
  y,
  log = "x",
  steps = 100,
  base = 1,
  las = 1,
  plot = TRUE,
  xlim = range(x, finite = TRUE),
  ylim = range(y, finite = TRUE),
  box = TRUE,
  parexpr,
  endexpr,
  sleep = 0,
  firstplot = TRUE,
  lastplot = TRUE,
  write_t = TRUE,
  values_t = NULL,
  pointsarg = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linLogTrans_+3A_x">x</code></td>
<td>
<p>x values to be plotted in animation</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_y">y</code></td>
<td>
<p>Vector with corresponding y values</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_log">log</code></td>
<td>
<p>Which axis is logarithmic, &quot;x&quot; or &quot;y&quot;. DEFAULT: &quot;x&quot;</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_steps">steps</code></td>
<td>
<p>Number of steps (images) in transition (About 30% are taken out). DEFAULT: 100</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_base">base</code></td>
<td>
<p>Base passed to <code><a href="#topic+logVals">logVals</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_las">las</code></td>
<td>
<p><code><a href="graphics.html#topic+par">par</a></code> LabelAxisStyle (numbers upright). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_plot">plot</code></td>
<td>
<p>Plot animations at all? False to just get the t-vector (used in <code><a href="#topic+linLogHist">linLogHist</a></code>). DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_xlim">xlim</code></td>
<td>
<p>xlim range in non-log units. DEFAULT: range(x, finite=TRUE)</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_ylim">ylim</code></td>
<td>
<p>ylim range in non-log units. DEFAULT: range(y, finite=TRUE)</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_box">box</code></td>
<td>
<p>Draw box at the end to overplot <code><a href="graphics.html#topic+abline">abline</a>s</code> crossing the box? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_parexpr">parexpr</code></td>
<td>
<p>Characterized Expression to set <code><a href="graphics.html#topic+par">par</a></code>, eg. <code>parexpr='par(mar=c(2,0.5,1.5,0.5), mpg=c(1.8,1,0))'</code></p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_endexpr">endexpr</code></td>
<td>
<p>Characterized Expression executed at the end of the plot, eg.
<code>endexpr='mtext("Probability density", line=-1, adj=0.03, outer=T)'</code></p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_sleep">sleep</code></td>
<td>
<p>Pause time between frames, in seconds, passed to <code><a href="base.html#topic+Sys.sleep">Sys.sleep</a></code>. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_firstplot">firstplot</code></td>
<td>
<p>Plot data on linear axis as additional first image? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_lastplot">lastplot</code></td>
<td>
<p>Plot data on logarithmic axis as additional last image? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_write_t">write_t</code></td>
<td>
<p>Write transformation value in lower right corner? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_values_t">values_t</code></td>
<td>
<p>Supply vector with values for transformation (1/t). Overrides steps. If you have a better algorithm than I do, please let me know! DEFAULT: NULL for internal calculation based on size of steps.</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_pointsarg">pointsarg</code></td>
<td>
<p>List of further arguments passed to points, like pch, cex, col. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linLogTrans_+3A_...">...</code></td>
<td>
<p>Further arguments passed only to plot, like main, xlim, ylab. Excluded: x, y, las, xaxt, type</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returned invisibly: transformation values used. Plotted: <code>steps</code> number of images.
</p>


<h3>Note</h3>

<p>if(steps&gt;1000) steps &lt;- 1000. In the unlikely case you need more steps, please let me know and I'll change the code.<br />
It's best to save the plots into a pdf (see the example) or wrap it within<br />
<code>png("Transition%03d"); linLogTrans(x,y); dev.off()</code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, June 2014
</p>


<h3>References</h3>

<p>x^(1/t) is based on the first comment on <a href="https://stackoverflow.com/questions/15994442/">https://stackoverflow.com/questions/15994442/</a><br />
besides the nice graphic properties of logtransformations, check this page for the implications on rates of change: <br />
<code>https://sfew.websitetoolbox.com/post/show_single_post?pid=1282690259&amp;postcount=4</code><br />
<code>https://sfew.websitetoolbox.com/post/show_single_post?pid=1282691799&amp;postcount=5</code>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logVals">logVals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42);  x &lt;- 10^rnorm(100, 3);  y &lt;- runif(100)
linLogTrans(x,y, steps=15, sleep=0.05)
linLogTrans(x,y, steps=15, log="y", ylim=c(0.1, 0.8), base=c(1,2,5))

## Not run: 
## Rcmd check --as-cran doesn't like to open external devices such as pdf,
## so this example is excluded from running in the checks.
pdf("LinLogTransitionAnimation.pdf")
linLogTrans(x,y, main="Example Transition")
dev.off()

# if you have FFmpeg installed, you can use the animation package like this:
library2(animation)
saveVideo(linLogTrans(x,y, steps=300), video.name="linlog_anim.mp4", interval=0.01,
    ffmpeg="C:/ffmpeg-20150424-git-cd69c0e-win64-static/bin/ffmpeg.exe")


# old t values were dependent on the value of steps
findt &lt;- function(steps) {
  # t-values for x^(1/t):
  allt &lt;- 10^(seq(0,2.5,len=1e4) )
  # selection at upper half of these values;
  # Otherwise, the animation slows down too much at the end
  f &lt;- 1.4 # multiplication factor due to length loss by unique
  sel &lt;- round(seq(1, 10, len=f*steps)^4)   #0.5*seq(1, 100, len=1.3*steps)^2 + 0.5*
  sel2 &lt;- unique(round(log10(seq(1, 10, len=f*steps))*f*steps))
  sel2[1] &lt;- 1
  sel &lt;- sel[sel2]
  # final t-values for transition:
  allt &lt;- unique(round(allt[sel], 2))
  data.frame(x=seq(1,1000,len=length(allt)), t=allt)
  }

plot(findt(1000), type="l", log="y", las=1)
for(i in 5:999) lines(findt(i), col=rainbow2(1000)[i])
d &lt;- findt(300)
lines(d) # good average

plot(d$x[-1], diff(d$t), type="l", ylim=c(3e-3,10), yaxt="n", log="y", main="t value growth rate")
logAxis(2) ; lines(d$x[-1], diff(d$t))
d2 &lt;- findt(1000)
lines(d2$x[-1], diff(d2$t), col=2)
lines(2:1000, diff(linLogTrans(1,1, steps=1000, plot=F)), col=4)


d &lt;- findt(300)
cf &lt;- coef(lm(t ~  poly(x,17, raw=T), data=d)) # these are currently used in the function
x &lt;- 1:1000
y &lt;- rowSums(sapply(1:18, function(i) cf[i]*x^(i-1)), na.rm=TRUE)
lines(x, y, lwd=3)
y[1] &lt;- 1
plot(x, round(y, 3), ylim=c(1,3), xlim=c(0,500), type="l", log="")
dput(round(y, 3))

findn &lt;- function(steps) nrow(findt(steps))
plot(1:1000, sapply(1:1000, findn), type="l")
abline(b=1, a=0)


## End(Not run)

</code></pre>

<hr>
<h2 id='linReg'>linear regression with plotting</h2><span id='topic+linReg'></span>

<h3>Description</h3>

<p>uses <code><a href="stats.html#topic+lm">lm</a></code>; plots data if add=FALSE, draws the regression line
with <code><a href="graphics.html#topic+abline">abline</a></code> and writes the formula with <code><a href="graphics.html#topic+legend">legend</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>linReg(
  x,
  y = NULL,
  data = NULL,
  add = FALSE,
  digits = 2,
  quiet = FALSE,
  pch = 16,
  col = "black",
  colline = "red",
  colband = addAlpha(colline),
  level = 0.95,
  plotrange = par("usr")[1:2],
  lwd = 1,
  xlab = deparse(substitute(x)),
  ylab = deparse(substitute(y)),
  main = "linear regression",
  pos1 = "top",
  pos2 = NULL,
  inset = 0,
  legargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="linReg_+3A_x">x</code></td>
<td>
<p>Numeric or formula (see examples). Vector with values of explanatory variable</p>
</td></tr>
<tr><td><code id="linReg_+3A_y">y</code></td>
<td>
<p>Numeric. Vector with values of dependent variable. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linReg_+3A_data">data</code></td>
<td>
<p>Dataframe. If x is a formula, the according columns from data are used as x and y. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linReg_+3A_add">add</code></td>
<td>
<p>Logical. If TRUE, line and text are added to the existing graphic. DEFAULT: FALSE (plots datapoints first and then the line.)</p>
</td></tr>
<tr><td><code id="linReg_+3A_digits">digits</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\ge 1</code>. Specifies number of digits a,b,r,e are rounded to
in the formula &quot;y=a*x+b \n R^2=r \n RMSE=e&quot;, respectively.
If a value is negative, the complete respective entry is left away.
If values are not specified, they are set equal to the first. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="linReg_+3A_quiet">quiet</code></td>
<td>
<p>Silence NA-removal warnings in <code><a href="#topic+rmse">rmse</a></code>? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="linReg_+3A_pch">pch</code></td>
<td>
<p>Point Character of datapoints, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 16</p>
</td></tr>
<tr><td><code id="linReg_+3A_col">col</code></td>
<td>
<p>Color of points. DEFAULT: &quot;black&quot;</p>
</td></tr>
<tr><td><code id="linReg_+3A_colline">colline</code></td>
<td>
<p>Color of the regression line, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: &quot;red&quot;</p>
</td></tr>
<tr><td><code id="linReg_+3A_colband">colband</code></td>
<td>
<p>Color of the confidence region band. DEFAULT: addAlpha(col)</p>
</td></tr>
<tr><td><code id="linReg_+3A_level">level</code></td>
<td>
<p>Confidence level, see <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>. DEFAULT: 0.95</p>
</td></tr>
<tr><td><code id="linReg_+3A_plotrange">plotrange</code></td>
<td>
<p>x range for which regression line and uncertainty band should
be plotted. Is passed to <code><a href="#topic+seqR">seqR</a></code> and can hence be a vector.
DEFAULT: par(&quot;usr&quot;)[1:2]</p>
</td></tr>
<tr><td><code id="linReg_+3A_lwd">lwd</code></td>
<td>
<p>Numeric. Linewidth, see <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="linReg_+3A_xlab">xlab</code></td>
<td>
<p>Axis label if add=FALSE. DEFAULT: deparse(substitute(x))</p>
</td></tr>
<tr><td><code id="linReg_+3A_ylab">ylab</code></td>
<td>
<p>Axis label if add=FALSE. DEFAULT: deparse(substitute(y))</p>
</td></tr>
<tr><td><code id="linReg_+3A_main">main</code></td>
<td>
<p>Title if add=FALSE. Changed (if not specified) for x=formula with data. DEFAULT: &quot;linear regression&quot;</p>
</td></tr>
<tr><td><code id="linReg_+3A_pos1">pos1</code></td>
<td>
<p><code><a href="grDevices.html#topic+xy.coords">xy.coords</a></code>-acceptable position of the formula. DEFAULT: &quot;top&quot;</p>
</td></tr>
<tr><td><code id="linReg_+3A_pos2">pos2</code></td>
<td>
<p>For numerical coordinates, this is the y-position. DEFAULT: NULL, as in <code><a href="graphics.html#topic+legend">legend</a></code></p>
</td></tr>
<tr><td><code id="linReg_+3A_inset">inset</code></td>
<td>
<p>Numeric vector of length <code class="reqn">\le 2</code>. inset distance(s) from the margins as a fraction of the plot region when formula legend is placed by keyword. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="linReg_+3A_legargs">legargs</code></td>
<td>
<p>list of arguments passed to legend, like list(cex=0.8, xpd=TRUE, bg=&quot;white&quot;), ...
xpd specifies whether formula can be written only inside the plot region (when FALSE)
or inside the figure region including mar (when TRUE) or in the entire device region including oma (when NA). DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="linReg_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>None, used for plotting and drawing.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011-2012, 2015
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="#topic+mReg">mReg</a></code>, <code><a href="#topic+expReg">expReg</a></code>, <code><a href="graphics.html#topic+legend">legend</a></code>, <code><a href="graphics.html#topic+par">par</a></code>, <code><a href="graphics.html#topic+abline">abline</a></code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
a &lt;- 1:30
b &lt;- a/2.345+rnorm(30,0,3)

linReg(a,b)
linReg(a,b, ylab="Hallo", pch=1, colline=3, main="Regression by Berry")
linReg(a, b, pos1=15, pos2=0) # position of topleft corner of legend
linReg(a, b, pos1=NA) # to suppress legend
linReg(a, b, plotrange=5:20) # only for plotting, all data points are used!
linReg(a,b, digits=c(2,3,2,-1) ) # Do not write RMSE into legend

# Formula specification:
linReg(b~a)
linReg(Fertility~Education, data=swiss, col="blue", colline="green")
# col is for points, colline + colband for regression line + conf.int.

# For more flexibility with the datapoints, plot first, then use linReg with add=TRUE:
plot(a,b, xlim=c(-5,45))
linReg(a, b, pos1="bottomright", add=TRUE, inset=.1) # inset: distance from plot border
linReg(a, b, digits=c(7,4,3), add=TRUE, colline=3, lty=2, lwd=4, level=0.8)
linReg(a, b, pos1="topleft", inset=c(-0.1, 0.3), legargs=list(xpd=TRUE), add=TRUE)

</code></pre>

<hr>
<h2 id='locArrow'>arrow at locator point in graph</h2><span id='topic+locArrow'></span>

<h3>Description</h3>

<p>Draw arrow at positions in a graph located by clicking and return the code to recreate it
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locArrow(digits = 2, length = 0.1, code = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locArrow_+3A_digits">digits</code></td>
<td>
<p>Number of digits coordinates are rounded to with <code><a href="base.html#topic+signif">signif</a></code></p>
</td></tr>
<tr><td><code id="locArrow_+3A_length">length</code></td>
<td>
<p>Length of the edges of the arrow head (in inches). DEFAULT: 0.1</p>
</td></tr>
<tr><td><code id="locArrow_+3A_code">code</code></td>
<td>
<p>Direction of arrow head. DEFAULT: 2 (from first to last point clicked)</p>
</td></tr>
<tr><td><code id="locArrow_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+arrows">arrows</a></code>  like lwd, col etc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not tested across platforms yet...
</p>


<h3>Value</h3>

<p>Character string with code
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jun 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+locLine">locLine</a></code>, <code><a href="graphics.html#topic+locator">locator</a></code>, <code><a href="graphics.html#topic+abline">abline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(cumsum(rnorm(60)), type="l")
## locArrow() # only do this manually in interactive() mode
## locArrow(col="blue", lwd=3)

</code></pre>

<hr>
<h2 id='locatorRS'>locator with immediate points in Rstudio</h2><span id='topic+locatorRS'></span>

<h3>Description</h3>

<p>Have <code><a href="graphics.html#topic+locator">locator</a></code> add points on the graph directly after clicking, even in Rstudio Graphics devices
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locatorRS(n = 512, type = "p", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locatorRS_+3A_n">n</code></td>
<td>
<p>Maximum number of points to plot.</p>
</td></tr>
<tr><td><code id="locatorRS_+3A_type">type</code></td>
<td>
<p>As in <code><a href="graphics.html#topic+locator">locator</a></code>, but passed to <code><a href="graphics.html#topic+points">points</a></code>. 
DEFAULT: &quot;p&quot;</p>
</td></tr>
<tr><td><code id="locatorRS_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+points">points</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with x and y
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2020
</p>


<h3>See Also</h3>

<p><a href="https://stackoverflow.com/q/65147219/1587132">https://stackoverflow.com/q/65147219/1587132</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>if(interactive()){
plot(1:10, type="n")
locs &lt;- locator(n=3, type="o") # click on locations in graph. 
# If you do not set n at beginning, press ESC to finish
locs
# In Rstudio, points only appear after finishing.
locatorRS(7, col="blue", type="o") # plots after each click
}

</code></pre>

<hr>
<h2 id='locLine'>abline at locator point in graph</h2><span id='topic+locLine'></span>

<h3>Description</h3>

<p>Draw vertical and/or horizontal lines at positions in a graph located by clicking
</p>


<h3>Usage</h3>

<pre><code class='language-R'>locLine(h = TRUE, v = TRUE, n = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="locLine_+3A_h">h</code></td>
<td>
<p>Draw horizontal line at clicked location? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="locLine_+3A_v">v</code></td>
<td>
<p>Draw vertical line at clicked location? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="locLine_+3A_n">n</code></td>
<td>
<p>Number of points to be clicked. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="locLine_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+abline">abline</a></code> like lty, lwd, col, etc</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Not tested across platforms yet...
</p>


<h3>Value</h3>

<p><code><a href="graphics.html#topic+locator">locator</a></code> result
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Mar 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+locArrow">locArrow</a></code>, <code><a href="graphics.html#topic+locator">locator</a></code>, <code><a href="graphics.html#topic+abline">abline</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(cumsum(rnorm(60)), type="l")
## locLine() # only do this manually in interactive() mode
</code></pre>

<hr>
<h2 id='logAxis'>Label logarithmic axes</h2><span id='topic+logAxis'></span>

<h3>Description</h3>

<p>Shortcut to calling <code><a href="#topic+logVals">logVals</a></code>, <code><a href="graphics.html#topic+axis">axis</a></code> and <code><a href="graphics.html#topic+abline">abline</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logAxis(
  side = 1,
  log = NULL,
  lcol = "grey",
  lty = 1,
  lwd = 1,
  labels = NULL,
  allticks = FALSE,
  allargs = NULL,
  expr,
  las = 1,
  from,
  to,
  Range,
  base = NA,
  big.mark = "'",
  decimal.mark = ".",
  scientific = FALSE,
  exponent = 5,
  expobase1 = FALSE,
  allbase = 1:9,
  box = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logAxis_+3A_side">side</code></td>
<td>
<p>Which <code><a href="graphics.html#topic+axis">axis</a></code> are to be labeled? Can be a vector within <code>1:4</code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="logAxis_+3A_log">log</code></td>
<td>
<p>Is the axis logarithmic by plot(log=&quot;x&quot;)? internal DEFAULT: <code><a href="graphics.html#topic+par">par</a>("xlog")</code> or &quot;ylog&quot;. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="logAxis_+3A_lcol">lcol</code></td>
<td>
<p>Color of gridlines drawn in the graph with <code><a href="graphics.html#topic+abline">abline</a></code>, NA to suppress. DEFAULT: &quot;grey&quot;</p>
</td></tr>
<tr><td><code id="logAxis_+3A_lty">lty</code>, <code id="logAxis_+3A_lwd">lwd</code></td>
<td>
<p>Type of gridlines. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="logAxis_+3A_labels">labels</code></td>
<td>
<p>Labels passed to <code><a href="graphics.html#topic+axis">axis</a></code>. &quot;FALSE&quot; to suppress labeling. DEFAULT: NULL (internally, <code><a href="#topic+logVals">logVals</a>$labs</code></p>
</td></tr>
<tr><td><code id="logAxis_+3A_allticks">allticks</code></td>
<td>
<p>Place all intermediate ticklines at the axis (without labeling). DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="logAxis_+3A_allargs">allargs</code></td>
<td>
<p>List of arguments passed to axis for allticks=TRUE. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="logAxis_+3A_expr">expr</code></td>
<td>
<p>Expression drawing over the ablines, like (points(x,y). Can be code within curly braces.</p>
</td></tr>
<tr><td><code id="logAxis_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle for the orientation of the labels. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="logAxis_+3A_from">from</code></td>
<td>
<p>Lower exponent OR vector with data, as in <code><a href="#topic+logVals">logVals</a></code>. DEFAULT based on <code><a href="graphics.html#topic+par">par</a>("usr")</code></p>
</td></tr>
<tr><td><code id="logAxis_+3A_to">to</code></td>
<td>
<p>High end exponent. DEFAULT: internally based on par(&quot;usr&quot;)</p>
</td></tr>
<tr><td><code id="logAxis_+3A_range">Range</code></td>
<td>
<p>Override from and to as range.</p>
</td></tr>
<tr><td><code id="logAxis_+3A_base">base</code></td>
<td>
<p>Bases to be used in <code><a href="#topic+logVals">logVals</a></code>. DEFAULT: NA -&gt; c(1,2,5) or 1, depending on from and to.</p>
</td></tr>
<tr><td><code id="logAxis_+3A_big.mark">big.mark</code></td>
<td>
<p>Symbol separating thousands, eg. space, comma, dot, etc. see &quot;format&quot; and &quot;prettyNum&quot;. DEFAULT: &quot;'&quot;</p>
</td></tr>
<tr><td><code id="logAxis_+3A_decimal.mark">decimal.mark</code></td>
<td>
<p>Character separating comma values, see &quot;format&quot; and &quot;prettyNum&quot;. DEFAULT: &quot;.&quot;</p>
</td></tr>
<tr><td><code id="logAxis_+3A_scientific">scientific</code></td>
<td>
<p>See <code><a href="base.html#topic+format">format</a></code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="logAxis_+3A_exponent">exponent</code></td>
<td>
<p>Starting at which exponent should <code><a href="#topic+logVals">logVals</a></code> return an expression with exponents? DEFAULT: 5</p>
</td></tr>
<tr><td><code id="logAxis_+3A_expobase1">expobase1</code></td>
<td>
<p>Should &quot;n * &quot; be appended before 10^exp if n=1? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="logAxis_+3A_allbase">allbase</code></td>
<td>
<p>base for <code>$all</code> (for horizontal lines). DEFAULT: 1:9</p>
</td></tr>
<tr><td><code id="logAxis_+3A_box">box</code></td>
<td>
<p>Draw box at the end to overplot <code><a href="graphics.html#topic+abline">abline</a>s</code> crossing the box? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="logAxis_+3A_...">...</code></td>
<td>
<p>Further arguments passed to axis, like <code>lwd, col.ticks, hadj, lty</code>, ...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An invisible list with
</p>
<table>
<tr><td><code>vals</code></td>
<td>
<p>Values for lines and label positions</p>
</td></tr>
<tr><td><code>labs</code></td>
<td>
<p>Formatted values for labels</p>
</td></tr>
<tr><td><code>all</code></td>
<td>
<p>Values for lines</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logVals">logVals</a></code>, <code><a href="base.html#topic+log10">log10</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- 10^runif(200, -1, 2)
plot(x, yaxt="n", log="y", pch=16)
logAxis(2)
# overplot vertical lines:
logAxis(2, expr=points(x, pch=16), base=1, col.axis=4, font=2)

# plots where log="x" is not possible:
hist(log10(x), breaks=20, col.axis="grey", main="")
logAxis(side=3, expr=hist(log10(x), breaks=20, add=TRUE, col=3))
# or just use the new logHist function (Feb 2016):
logHist(x, breaks=20, col=3)

# automatic calculation of from, to and base:
plot(1:3, axes=FALSE)
logAxis(1:2) # side can be a vector - nice, huh?
plot(-1:4, axes=FALSE)
logAxis(1:2) # treshold for base 1 instead of c(1,2,5) at 4 exponents exceeded.

plot(1:3, axes=FALSE)
logAxis(1:2, allticks=TRUE, lcol=NA)

par(mar=c(3,3,1,4))
plot(8:15) ;  logAxis(4) # with exponents if they are above 5
plot(10^(1:4), ylim=10^c(4,1), type="o", log="y") # reverse axis:
plot(10^(1:5), log="y"); logAxis(4, exponent=3) # different treshold
plot(10^(1:5), log="y"); logAxis(4, expon=3, base=c(1,2,5), expobase1=TRUE)
plot(-8:5); logAxis(4, allbase=c(1,2,5)) # In case you want to mislead...

</code></pre>

<hr>
<h2 id='logHist'>Histogram of logarithmic values</h2><span id='topic+logHist'></span>

<h3>Description</h3>

<p>Draw histogram of values on a logarithmic scale with nice axis labels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logHist(
  x,
  logargs = NULL,
  main = xmain,
  xlab = xname,
  col = "tan",
  add = FALSE,
  las = 1,
  ylim = NULL,
  freq = TRUE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logHist_+3A_x">x</code></td>
<td>
<p>Vector of numerical values</p>
</td></tr>
<tr><td><code id="logHist_+3A_logargs">logargs</code></td>
<td>
<p>A list of arguments passed to <code><a href="#topic+logAxis">logAxis</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="logHist_+3A_main">main</code></td>
<td>
<p>Title of graph, internally from x. DEFAULT: internal name representation</p>
</td></tr>
<tr><td><code id="logHist_+3A_xlab">xlab</code></td>
<td>
<p>X axis label. DEFAULT: internal: name of x</p>
</td></tr>
<tr><td><code id="logHist_+3A_col">col</code></td>
<td>
<p>Color of histogram bars</p>
</td></tr>
<tr><td><code id="logHist_+3A_add">add</code></td>
<td>
<p>Logical: add to existing plot?</p>
</td></tr>
<tr><td><code id="logHist_+3A_las">las</code></td>
<td>
<p>Integer: label axis style. DEFAULT: 1 (numbers upright)</p>
</td></tr>
<tr><td><code id="logHist_+3A_ylim">ylim</code></td>
<td>
<p>2 Numbers: y-axis range. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="logHist_+3A_freq">freq</code></td>
<td>
<p>Logical: counts instead of density? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="logHist_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress warning about non-positive values? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="logHist_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code>
like breaks, xlim=c(-1,3), ..., but not xaxt</p>
</td></tr>
</table>


<h3>Value</h3>

<p>none
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logAxis">logAxis</a></code>, <code><a href="graphics.html#topic+hist">hist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
dat &lt;- rbeta(1e4, 2, 18)*100
hist(dat, col="tan", breaks=50)
logHist(dat)
logHist(dat, freq=FALSE)
logHist(dat, breaks=50)
logHist(dat,xlim=c(0,2)) # xlim in powers of ten
logHist(c(-1,0,1,2,2,3,3,4,8,10,50)) # warning for negative values

</code></pre>

<hr>
<h2 id='logSpaced'>Logarithmically spaced points</h2><span id='topic+logSpaced'></span>

<h3>Description</h3>

<p>Calculates values that are in logarithmic distance from each other
e.g. to produce logarithmic interval borders.<br />
For exact logarithmic spacing, use
<code>10^<a href="base.html#topic+seq">seq</a>(from=<a href="base.html#topic+log10">log10</a>(1), to=<a href="base.html#topic+log10">log10</a>(100), len=100)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logSpaced(
  base = 1.1708,
  n = 20,
  min = 1,
  max = n,
  plot = TRUE,
  pch = 3,
  las = 1,
  ylab = "base",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logSpaced_+3A_base">base</code></td>
<td>
<p>Base for calculations, can be a vector to compare several bases. DEFAULT: 1.1708</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_n">n</code></td>
<td>
<p>Number of values to be calculated. DEFAULT: 30</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_min">min</code>, <code id="logSpaced_+3A_max">max</code></td>
<td>
<p>Range where n values are to be distributed, single values each. DEFAULT: 1,n</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_plot">plot</code></td>
<td>
<p>Should the points be plotted on a line? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_pch">pch</code>, <code id="logSpaced_+3A_las">las</code></td>
<td>
<p>PointCharacter and Label Axis Style. DEFAULT: 3,1</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_ylab">ylab</code></td>
<td>
<p>Y axis label. DEFAULT: &quot;base&quot;</p>
</td></tr>
<tr><td><code id="logSpaced_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+plot">plot</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector or matrix, depending on base input
</p>


<h3>Note</h3>

<p>base &gt;1 concentrates points at low values, base&lt;1 at high values.
<code>base</code> does not relate to <code>base</code> in <code><a href="base.html#topic+log">log</a></code>!
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+classify">classify</a></code>, <code><a href="base.html#topic+log">log</a></code>, 
<a href="https://stackoverflow.com/a/29963530">https://stackoverflow.com/a/29963530</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
logSpaced()
logSpaced(base=c(1.1, 1.5, 2), n=6, min=5, max=10)
d &lt;- logSpaced(seq(0.8, 1.2, 0.025), main="logarithmically spaced points")

# the default base for the default n (20) will give an approximately equal
# bin width across the range on a logarithmic scale:
d &lt;- logSpaced()
plot(d, rep(1,20), log="x")

# For exactly spacing logarithmically, use
plot(10^seq(from=log10(1), to=log10(100), len=100), log="y")

</code></pre>

<hr>
<h2 id='logVals'>Create log-axis values and labels</h2><span id='topic+logVals'></span>

<h3>Description</h3>

<p>Create nice values and labels to write at logarithmic axes
</p>


<h3>Usage</h3>

<pre><code class='language-R'>logVals(
  from = -7,
  to = 7,
  Range,
  base = 1,
  big.mark = "'",
  decimal.mark = ".",
  scientific = FALSE,
  exponent = Inf,
  expobase1 = FALSE,
  allbase = 1:9,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="logVals_+3A_from">from</code></td>
<td>
<p>Lower exponent <em>OR</em> vector with data</p>
</td></tr>
<tr><td><code id="logVals_+3A_to">to</code></td>
<td>
<p>High end</p>
</td></tr>
<tr><td><code id="logVals_+3A_range">Range</code></td>
<td>
<p>Or give from and to as range</p>
</td></tr>
<tr><td><code id="logVals_+3A_base">base</code></td>
<td>
<p>Bases to be used, eg. c(1,2,5). Use base=NA to switch
between 1 and c(1,2,5) depending on range. DEFAULT 1</p>
</td></tr>
<tr><td><code id="logVals_+3A_big.mark">big.mark</code></td>
<td>
<p>Symbol separating thousands, eg. space, comma, dot, etc. see <code><a href="base.html#topic+format">format</a></code> and <code><a href="base.html#topic+prettyNum">prettyNum</a></code></p>
</td></tr>
<tr><td><code id="logVals_+3A_decimal.mark">decimal.mark</code></td>
<td>
<p>Character separating comma values, see <code><a href="base.html#topic+format">format</a></code> and <code><a href="base.html#topic+prettyNum">prettyNum</a></code></p>
</td></tr>
<tr><td><code id="logVals_+3A_scientific">scientific</code></td>
<td>
<p>See <code><a href="base.html#topic+format">format</a></code></p>
</td></tr>
<tr><td><code id="logVals_+3A_exponent">exponent</code></td>
<td>
<p>Starting at which exponent should <code>labs</code> be an expression with exponents?
Compare to <code><a href="base.html#topic+options">options</a>("scipen")</code>. This is mainly for <code><a href="#topic+logAxis">logAxis</a></code> and only for base 1. DEFAULT: Inf</p>
</td></tr>
<tr><td><code id="logVals_+3A_expobase1">expobase1</code></td>
<td>
<p>Should &quot;n * &quot; be appended before 10^exp if n=1? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="logVals_+3A_allbase">allbase</code></td>
<td>
<p>Base for <code>$all</code> (for horizontal lines). DEFAULT: 1:9</p>
</td></tr>
<tr><td><code id="logVals_+3A_...">...</code></td>
<td>
<p>Ignored arguments</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list with
</p>
<table>
<tr><td><code>vals</code></td>
<td>
<p>Values for lines and label positions</p>
</td></tr>
<tr><td><code>labs</code></td>
<td>
<p>Formatted values for labels</p>
</td></tr>
<tr><td><code>all</code></td>
<td>
<p>Values for lines</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2014
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+log10">log10</a></code>, <code><a href="#topic+logAxis">logAxis</a></code>,
<a href="https://web.archive.org/web/20190504213250/https://r.789695.n4.nabble.com/expression-exponent-labeling-td4661174.html">https://web.archive.org/web/20190504213250/https://r.789695.n4.nabble.com/expression-exponent-labeling-td4661174.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Easiest use: vector with data (logVals automatically finds range):
y &lt;- 10^runif(50, -1, 2)
plot(y, log="y") # not much control over placement and format of labels
plot(y, log="y", yaxt="n")
# now do this better, with custom bases:
lv &lt;- logVals(y, base=c(1,2,5) )
axis(2, lv$vals, lv$labs, las=1)

# Default arguments:
lv &lt;- logVals()
str(lv) # values, formatted labels, all 10^x values for lines
plot(1, ylim=c(1e-3, 1e4), log="y", yaxt="n", yaxs="i")
abline(h=lv$all, col=8 )
box("plot")
axis(2, lv$vals, lv$labs, las=1)
lines(seq(0.5, 1.5, len=50), 10^runif(50, -3, 4), col=2)

# Formatting labels:
logVals(                )$labs
logVals(scient=TRUE     )$labs
logVals(exponent=5      )$labs # expression with exponent, see logAxis
logVals(big.mark=" "    )$labs
logVals(big=".", dec=",")$labs # German style (not recommended)

</code></pre>

<hr>
<h2 id='lsc'>Linear storage cascade, unit hydrograph</h2><span id='topic+lsc'></span>

<h3>Description</h3>

<p>Optimize the parameters for unit hydrograph as in the framework of the
linear storage cascade. Plot observed &amp; simulated data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsc(
  P,
  Q,
  area = 50,
  Qbase = Q[1],
  n = 2,
  k = 3,
  x = 1:length(P),
  fit = 1:length(Q),
  plot = TRUE,
  main = "Precipitation and discharge",
  plotsim = TRUE,
  returnsim = FALSE,
  type = c("o", "l"),
  legx = "center",
  legy = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lsc_+3A_p">P</code></td>
<td>
<p>Vector with precipitation values <b>in mm in hourly spacing</b></p>
</td></tr>
<tr><td><code id="lsc_+3A_q">Q</code></td>
<td>
<p>Vector with observed discharge (runoff) <b>in m^3/s</b> with the same length as precipitation.</p>
</td></tr>
<tr><td><code id="lsc_+3A_area">area</code></td>
<td>
<p>Single numeric. Catchment area <b>in km^2</b></p>
</td></tr>
<tr><td><code id="lsc_+3A_qbase">Qbase</code></td>
<td>
<p>baseflow that is added to UH-induced simulated Q, thus cutting off baseflow in a very simple manner.</p>
</td></tr>
<tr><td><code id="lsc_+3A_n">n</code></td>
<td>
<p>Numeric. Initial number of storages in cascade. not necessarily integer. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="lsc_+3A_k">k</code></td>
<td>
<p>Numeric. Initial storage coefficient (resistance to let water run out). High damping, slowly reacting landscape, high k. DEFAULT: 3</p>
</td></tr>
<tr><td><code id="lsc_+3A_x">x</code></td>
<td>
<p>Vector for the x-axis of the plot. DEFAULT: sequence along P</p>
</td></tr>
<tr><td><code id="lsc_+3A_fit">fit</code></td>
<td>
<p>Integer vector. Indices for a subset of Q that Qsim is fitted to. DEFAULT: all of Q</p>
</td></tr>
<tr><td><code id="lsc_+3A_plot">plot</code></td>
<td>
<p>Logical. plot input data? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="lsc_+3A_main">main</code></td>
<td>
<p>Character string. DEFAULT: &quot;Precipitation and discharge&quot;</p>
</td></tr>
<tr><td><code id="lsc_+3A_plotsim">plotsim</code></td>
<td>
<p>Logical. add best fit to plot? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="lsc_+3A_returnsim">returnsim</code></td>
<td>
<p>Logical. Return simulated Q instead of parameters of UH? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="lsc_+3A_type">type</code></td>
<td>
<p>Vector with two characters: type as in <code><a href="base.html#topic+plot">plot</a></code>, repeated if only one is given. 1st for obs, 2nd for sim. DEFAULT: c(&quot;o&quot;,&quot;l&quot;)</p>
</td></tr>
<tr><td><code id="lsc_+3A_legx">legx</code></td>
<td>
<p>legend position. DEFAULT: &quot;center&quot;</p>
</td></tr>
<tr><td><code id="lsc_+3A_legy">legy</code></td>
<td>
<p>legend position. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="lsc_+3A_...">...</code></td>
<td>
<p>arguments passed to optim</p>
</td></tr>
</table>


<h3>Value</h3>

<p><em>Either</em> vector with optimized n and k and the Nash-Sutcliffe Index,
<em>or</em> simulated discharge, depending on the value of <code>returnsim</code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2013
</p>


<h3>References</h3>

<p><a href="https://ponce.sdsu.edu/onlineuhcascade.php">https://ponce.sdsu.edu/onlineuhcascade.php</a><br />
Skript 'Abflusskonzentration' zur Vorlesungsreihe Abwasserentsorgung I von Prof. Krebs an der TU Dresden<br />
<a href="https://tu-dresden.de/bu/umwelt/hydro/isi/sww/ressourcen/dateien/lehre/dateien/abwasserbehandlung/uebung_ws09_10/uebung_awe_1_abflusskonzentration.pdf">https://tu-dresden.de/bu/umwelt/hydro/isi/sww/ressourcen/dateien/lehre/dateien/abwasserbehandlung/uebung_ws09_10/uebung_awe_1_abflusskonzentration.pdf</a><br />
<a href="https://github.com/brry/misc/blob/master/HydroII-Lernzettel.pdf">https://github.com/brry/misc/blob/master/HydroII-Lernzettel.pdf</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+unitHydrograph">unitHydrograph</a></code>, <code><a href="#topic+superPos">superPos</a></code>, <code><a href="#topic+nse">nse</a></code>, <code><a href="#topic+rmse">rmse</a></code>.
<code>deconvolution.uh</code> in the package hydromad, <a href="https://hydromad.catchment.org/">https://hydromad.catchment.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
qpfile &lt;- system.file("extdata/Q_P.txt", package="berryFunctions")
qp &lt;- read.table(qpfile, sep="\t", dec=",", header=TRUE)
calib &lt;- qp[1:90,]
valid &lt;- qp[-(1:90),]

# Area can be estimated from runoff coefficient (proportion of N becoming Q):
#    k*P * A = Q * t      A = Qt / kP
# Q=0.25 m^3/s  * t=89 h   *  3600 s/h   k=psi* P =34mm = 0.034m = m^3/m^2
#                                                      / 1e6 m^2/km^2   = km^2
mean(calib$Q) * length(calib$Q) *3600  / ( 0.7 * sum(calib$P)/1000) / 1e6
# 3.368 km^2


# calibrate Unit Hydrograph:
UHcalib &lt;- lsc(calib$P, calib$Q, area=3.4)
UHcalib # n 0.41  k 244.9  NSE 0.74  psi 0.45
# Psi is lower than 0.7, as it is now calculated on direct runoff only

# Corresponding Unit Hydrograph:
UH &lt;- unitHydrograph(n=UHcalib["n"], k=UHcalib["k"], t=1:length(calib$P))
plot(UH, type="l") # That's weird anyways...
sum(UH) # 0.58 - we need to look at a longer time frame

# calibrate Unit Hydrograph on peak only:
lsc(calib$P, calib$Q, area=3.4, fit=17:40) # n 0.63  k  95.7  NSE 0.67
# for fit, use index numbers, not x-axis units (if you have specified x)

# Simulated discharge instead of parameters:
lsc(calib$P, calib$Q, area=3.4, returnsim=TRUE, plot=FALSE)


## Not run: ## Time consuming tests excluded from CRAN checks

# Apply this to the validation event
dummy &lt;- lsc(valid$P, valid$Q, area=3.4, plotsim=FALSE, type="l")
Qsim &lt;- superPos(valid$P, UH)
Qsim &lt;- Qsim + valid$Q[1] # add baseflow
lines(Qsim, lwd=2, xpd=NA)
legend("center", legend=c("Observed","Simulated from calibration"),
       lwd=c(1,2), col=c(2,1) )
nse(valid$Q, Qsim[1:nrow(valid)]) # 0.47, which is not really good.
# performs OK for the first event, but misses the peak from the second.
# this particular UH is apparently not suitable for high pre-event soil moisture.
# Along with longer events, UH properties may change!!!
dummy # in-sample NSE 0.75 is a lot better

# Now for the second peak in the validation dataset:
lsc(valid$P, valid$Q, type="l", area=3.4, fit=60:90) # overestimates first peak
# Area cannot be right - is supposedly 17 km^2.

# Different starting points for optim:
lsc(calib$P, calib$Q, area=3.4, n= 2  , k=  3, plot=FALSE) # Default
lsc(calib$P, calib$Q, area=3.4, n= 5  , k= 20, plot=FALSE) # same result
lsc(calib$P, calib$Q, area=3.4, n=10  , k= 20, plot=FALSE) # ditto
lsc(calib$P, calib$Q, area=3.4, n=10  , k=  3, plot=FALSE) # ditto
lsc(calib$P, calib$Q, area=3.4, n= 1.9, k=900, plot=FALSE) # ditto
lsc(calib$P, calib$Q, area=3.4, n=50  , k= 20) # nonsense
# the catchment is small, so n must be low.


#sensitivity against area uncertainty:
Asens &lt;- data.frame(A=seq(1,15,0.5),
    t(sapply(seq(1,15,0.5), function(A) lsc(calib$P, calib$Q, area=A, plot=FALSE))))
Asens
plot(Asens$A, Asens$NSE, type="l", ylim=c(-0.3,2), las=1, main="lsc depends on area")
abline(v=3.4, lty=2)
lines(Asens$A, Asens$n, col=2)
points(3.4, 2, col=2)
lines(Asens$A, Asens$psi, col=5)
text(rep(13,4),y=c(1.5, 0.8, 0.4,0), c("k -&gt;","&lt;- NSE","&lt;- n","&lt;- psi"), col=c(4,1,2,5))
par(new=TRUE); plot(Asens$A, Asens$k, type="l", ann=FALSE, axes=FALSE, col=4)
axis(4, col.axis=4)
points(3.4, 3, col=4)

# Autsch - that shouldn't happen!
# Still need to find out what to do with optim


lsc(calib$P, calib$Q, area=1.6) # not bad indeed

## End(Not run)

</code></pre>

<hr>
<h2 id='lsMem'>Show memory size of objects in MB</h2><span id='topic+lsMem'></span>

<h3>Description</h3>

<p>Show memory size of the biggest objects in MB. Helps you find the biggest memory killers.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lsMem(n = 6, pos = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="lsMem_+3A_n">n</code></td>
<td>
<p>Number of Objects to be shown separately. The rest is combined into &quot;sum rest&quot;. DEFAULT: 6</p>
</td></tr>
<tr><td><code id="lsMem_+3A_pos">pos</code></td>
<td>
<p>Environment where <code><a href="base.html#topic+ls">ls</a></code> looks for objects.</p>
</td></tr>
<tr><td><code id="lsMem_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+ls">ls</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Named vector with object sizes in MB (MegaBytes)
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2014
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/1358003/tricks-to-manage-the-available-memory-in-an-r-session">https://stackoverflow.com/questions/1358003/tricks-to-manage-the-available-memory-in-an-r-session</a>
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+object.size">object.size</a></code>, <code><a href="base.html#topic+ls">ls</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: 
## excluded from CRAN check  - I forgot why, but there's probably a good reason
lsMem()

## End(Not run)

</code></pre>

<hr>
<h2 id='monthAxis'>Label date axis</h2><span id='topic+monthAxis'></span>

<h3>Description</h3>

<p>Labels date axes at sensible monthly intervals in the
time domain of years to decades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthAxis(
  side = 1,
  grid = FALSE,
  time = NA,
  origin = "1970-01-01",
  mlabels = substr(month.abb, 1, 1),
  yformat = "%Y",
  nmonths = 3,
  nym_half = 3.5,
  nym_none = 5,
  mcex = 0.7,
  ycex = 1,
  mtcl = par("tcl"),
  ytcl = par("tcl") - 1.7,
  mline = -1,
  yline = 0.2,
  las = 1,
  lrange = NA,
  trunc = NA,
  mgp = c(3, 1, 0),
  mt = NULL,
  ml = NULL,
  yt = NULL,
  yl = NULL,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monthAxis_+3A_side">side</code></td>
<td>
<p>Which <code><a href="graphics.html#topic+axis">axis</a></code> is to be labeled? DEFAULT: 1</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_grid">grid</code></td>
<td>
<p>Add horizontal/vertical lines to graph? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_time">time</code></td>
<td>
<p>Logical indicating whether the axis is <code><a href="base.html#topic+POSIXct">POSIXct</a></code>,
not <code><a href="base.html#topic+Date">Date</a></code>. DEFAULT: NA, meaning axis value &gt;1e5</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_origin">origin</code></td>
<td>
<p>Origin for<code><a href="base.html#topic+as.Date">as.Date</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>.
DEFAULT: &quot;1970-01-01&quot;</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mlabels">mlabels</code></td>
<td>
<p>Labels for the months. DEFAULT: J,F,M,A,M,J,J,A,S,O,N,D</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_yformat">yformat</code></td>
<td>
<p>Format of year labels, see details in <code><a href="base.html#topic+strptime">strptime</a></code>.
Use <code>yformat=" "</code> (with space) to suppress year labeling.
DEFAULT: &quot;%Y&quot;</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_nmonths">nmonths</code></td>
<td>
<p>Minimum number of months required before a year at the
axis boundary is labeled. DEFAULT: 3</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_nym_half">nym_half</code></td>
<td>
<p>Number of years on axis above which only every second month
is labeled. DEFAULT: 3.5</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_nym_none">nym_none</code></td>
<td>
<p>Number of years on axis above which the months are
not labeled. DEFAULT: 5</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mcex">mcex</code></td>
<td>
<p><code>cex.axis</code> (letter size) for month labels. DEFAULT: 0.7</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_ycex">ycex</code></td>
<td>
<p><code>cex.axis</code> (letter size) for year labels. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mtcl">mtcl</code></td>
<td>
<p>Month tick length (negative text line height units).
0 to suppress ticks. DEFAULT: par(&quot;tcl&quot;) = -0.5</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_ytcl">ytcl</code></td>
<td>
<p>Year tick length (negative text line height units).
0 to suppress ticks. DEFAULT: par(&quot;tcl&quot;)-1.7 = -2.2</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mline">mline</code></td>
<td>
<p>Line of month labels. DEFAULT: -1</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_yline">yline</code></td>
<td>
<p>Line of year labels. DEFAULT: 0.2</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle for orientation of labels. DEFAULT: 1 (upright)</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_lrange">lrange</code></td>
<td>
<p>Label range (two <code><a href="base.html#topic+Date">Date</a></code> values).
DEFAULT: NA = internally computed from <code><a href="graphics.html#topic+par">par</a>("usr")</code></p>
</td></tr>
<tr><td><code id="monthAxis_+3A_trunc">trunc</code></td>
<td>
<p>Vector with two values: Number of days/seconds to truncate
at the left and right end of lrange. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mgp">mgp</code></td>
<td>
<p>MarGin Placement. Suggested not to change this, since
_tcl and _line defaults are chosen for the DEFAULT: c(3,1,0)</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_mt">mt</code>, <code id="monthAxis_+3A_ml">ml</code>, <code id="monthAxis_+3A_yt">yt</code>, <code id="monthAxis_+3A_yl">yl</code></td>
<td>
<p>Lists with further arguments passed to <code><a href="graphics.html#topic+axis">axis</a></code>,
like <code>lwd, col.ticks, lwd.ticks, hadj, lty</code>, separately
for month ticks, month labels, year ticks, year labels.
DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_quiet">quiet</code></td>
<td>
<p>Suppress warning about short time axis? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="monthAxis_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+axis">axis</a></code> for all 4 elements.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with locations of month and year labels and ticks, each a Date vector.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb + Dec 2015, Oct 2017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monthLabs">monthLabs</a></code> for the numbercrunching itself,
<code><a href="#topic+timeAxis">timeAxis</a></code> for shorter or longer time frames,
<code><a href="graphics.html#topic+axis.Date">axis.Date</a></code> with defaults that are less nice.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(007) # for reproducibility
timePlot &lt;- function(nydays, start="2013-08-25", ...)
   plot(as.Date(start)+sort(c(0,sample(1:nydays, 50))),
        cumsum(rnorm(51)), type="l", xaxt="n", ann=FALSE, las=1, ...)

timePlot(1100)
monthAxis()
monthAxis(1, nmonths=6, col.axis="red") # 2013 not labeled anymore
monthAxis(side=3, nym_half=2) # if axis &gt; 2 years, label only partially

timePlot(2e3)
monthAxis()   # long time series (&gt;nym_none) only have years labeled
monthAxis(side=3, font=2, grid=TRUE)
# vertical lines in graph - now add lines/points

timePlot(900)
monthAxis(side=3, mtcl=0) # no tick lines between months
monthAxis(ycex=1.4, ytcl=2, lwd.ticks=2)
monthAxis(yline=1, col.axis=4, col=4)
monthAxis(mcex=1, col.axis="red", yformat=" ") # no years labeled
timePlot(900)
monthAxis(nmonths=1) # year labeled for short period as well

timePlot(800)
monthAxis()
monthAxis(mgp=c(2,1,0)) # the same. element 2 is relevant here
monthAxis(mgp=c(3,0,0)) # requires change in mline andy yline placement

timePlot(400)
ma &lt;- monthAxis(lwd=3, yl=list(col.axis=3), mlabels=letters[1:12], mcex=1)
abline(v=ma$mtics, col=8) # use output from monthAxis for other functions

timePlot(80)
monthAxis(mlabels=month.abb, mcex=1) # short time series give a warning

timePlot(80, "2013-11-14")
monthAxis(mlabels=month.abb, mcex=1, nmonths=0, quiet=TRUE)

# Time axis instead of date axis:
plot(as.POSIXct(Sys.time()+c(0,2)*360*24*3600), 1:2, xaxt="n")
monthAxis(nmonths=2)

timePlot(800, "2015-01-01")
monthAxis()
timePlot(900, "2015-01-01", xaxs="i")
monthAxis()
timePlot(300, "2015-01-01", xaxs="i")
monthAxis() # if less than a full year is covered, the year label is centered

</code></pre>

<hr>
<h2 id='monthLabs'>Nicely spaced labels along a month</h2><span id='topic+monthLabs'></span>

<h3>Description</h3>

<p>Create dates of certain days of the month for labeling
</p>


<h3>Usage</h3>

<pre><code class='language-R'>monthLabs(startyear = 2002, stopyear = 2018, npm = 2, npy = NA)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="monthLabs_+3A_startyear">startyear</code></td>
<td>
<p>Integer. starting year. DEFAULT: 2002</p>
</td></tr>
<tr><td><code id="monthLabs_+3A_stopyear">stopyear</code></td>
<td>
<p>Integer. ending year. DEFAULT: 2018</p>
</td></tr>
<tr><td><code id="monthLabs_+3A_npm">npm</code></td>
<td>
<p>Integer, one of 1,2,3,6 or 31. Number of labels per month. DEFAULT: 2<br />
npm : days of the month<br />
1 : first day of each month within the given years<br />
2 : 1st and 15th day<br />
3 : 1, 10, 20<br />
6 : 1, 5, 10, 15, 20, 25.
31 : each day</p>
</td></tr>
<tr><td><code id="monthLabs_+3A_npy">npy</code></td>
<td>
<p>Integer, one of 1,2,3,4 or 6. Number of labels per year at equally spaced month-beginnings.
If specified, npm is not considered at all. DEFAULT: NA</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with Dates as returned by <code><a href="base.html#topic+as.Date">as.Date</a></code>.
</p>


<h3>Note</h3>

<p>Spacing of days is not equal, but set to certain days of the month!
This was originally developed for time series movie frames
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, early 2013
</p>


<h3>See Also</h3>

<p><code><a href="#topic+timeAxis">timeAxis</a></code> for nice labeling,
<code><a href="#topic+timeAxis">timeAxis</a></code> for automatic determination of npm/npy,
<code><a href="base.html#topic+as.Date">as.Date</a></code>, <code><a href="base.html#topic+paste">paste</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
monthLabs(2014,2014, 3) # 3 days per month
monthLabs(2013,2014,  npy=3) # 3 months per year, equally spaced
monthLabs(2014,2014,  npy=4) # 4 months per year

# see monthAxis for automatic plot labeling

</code></pre>

<hr>
<h2 id='movAv'>Moving average</h2><span id='topic+movAv'></span>

<h3>Description</h3>

<p>Weighted moving average (running mean) with overlapping windows
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movAv(dat, width = 7, weights = rep(1, width), quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movAv_+3A_dat">dat</code></td>
<td>
<p>Vector with regularly spaced data</p>
</td></tr>
<tr><td><code id="movAv_+3A_width">width</code></td>
<td>
<p>Odd integer specifying window width. DEFAULT: 7</p>
</td></tr>
<tr><td><code id="movAv_+3A_weights">weights</code></td>
<td>
<p>Vector with weights. Sum is normalized to 1. DEFAULT: rep(1,width)</p>
</td></tr>
<tr><td><code id="movAv_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress allNA message and even width warning? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Width has to be odd, so there is a defined middle point of each window.
Even inputs will be changed with a warning (unless quiet=TRUE).<br />
Weights doesn't have to be symmetrical, but is always mapped to the middle
of each window!<br />
If there are NAs in the window, the corresponding weight is distributed
evenly to the other weights.
</p>


<h3>Value</h3>

<p>Vector of the same length as the original input.
Padded with NAs at width/2 margin elements
</p>


<h3>Note</h3>

<p>You can specify just one of weights or width.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, ca 2012
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movAvLines">movAvLines</a></code>, 
<code><a href="stats.html#topic+filter">filter</a></code>, <code><a href="stats.html#topic+decompose">decompose</a></code>, <code><a href="stats.html#topic+smooth">smooth</a></code>,
<code><a href="stats.html#topic+loess">loess</a></code>, <code><a href="zoo.html#topic+rollapply">rollapply</a></code> (no overlapping!)
</p>


<h3>Examples</h3>

<pre><code class='language-R'># general usage -------------------------------------------------------------
set.seed(29); a &lt;- runif(40, 5,50)
data.frame(a, movAv(a))

# final and commencing NAs are kept, middle ones are filled:
a[c(1:10, 18:26, 32:40)] &lt;- NA
data.frame(a, movAv(a))

set.seed(29); a &lt;- runif(60, 5,50)
plot(a, type="o", pch=16, las=1)
lines(movAv(a), col=2, lwd=3) # shows trends, signal in the noise
lines(movAv(a,3), col=4, lwd=3)
lines(movAv(a,15), col=3, lwd=3) # degree of smoothing depends on window width

# Weights:
plot(a, type="o", pch=16, las=1)
lines(movAv(a), col=2, lwd=3) # uniform weight within running window
# Triangular weights react stronger to extrema:
lines(movAv(a, weights=c(1,2,4,6,4,2,1)), col=4, lwd=3)

plot(c(Nile), type="l")
lines(movAv(Nile,20), col=4, lwd=4)
lines(movAv(Nile,21), col=3) # even widths are changed to a higher value


# smoothing intenstiy -------------------------------------------------------
plot(1871:1970, Nile, type="l", col=8)
movAvLines(1871:1970, Nile, lwd=3)

for(i in 1:30*2-1)
  {
  plot(a, type="o", pch=16, las=1, main=paste("moving average, width =", i))
  lines(movAv(a, i), col=2, lwd=4)
  }
# How to lie with moving averages: compare width 29 with 49 - the "trend"
# appears to be in opposite direction! (OK, this is random data anyways).

b &lt;- rep(a, each=10)+runif(600, -10, 20)
plot(b, type="l")
lines(movAv(b), col=2, lwd=4)
lines(movAv(b, 35), col=4, lwd=4)
lines(movAv(b, 101), col=5, lwd=4)  # choose width according to scale!


# Deviance from running mean can identify outlier:
nile &lt;- c(Nile)
op &lt;- par(mfrow=c(3,1), mar=c(1,3,2.5,0), cex.main=1, las=1)
plot(nile, type="l", main=c("original Nile data",""), xlab="", xaxt="n")
lines(movAv(nile,5), lwd=2, col=2)
title(main=c("", "5-element running mean (moving average)"), col.main=2)
box("figure")
plot(nile-movAv(nile,5), type="o", pch=16, col=4,
      main="difference  ( original data - moving average )", xlab="", xaxt="n")
abline(h=0)
box("figure")
par(mar=c(3,3,1,0))
hist(nile-movAv(nile,5), breaks=25, xlim=c(-500,500), col=4, main="Deviances")
abline(v=0, lwd=5) # the deviances are pretty symmetric.
# If this were shifted more strongly to the left, we could say:
# movav(5) overestimates minima more than it underestimates maxima
# This would happen if low values peak away further and more shortly
par(op)

</code></pre>

<hr>
<h2 id='movAvLines'>Moving average with different window widths</h2><span id='topic+movAvLines'></span>

<h3>Description</h3>

<p>Add moving average lines with different window widths to a plot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>movAvLines(
  x = 1:length(y),
  y,
  widths = c(3, 5, 7, 9, 11, 13),
  weights,
  col = "blue",
  alpha = 0.3,
  add = TRUE,
  las = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="movAvLines_+3A_x">x</code></td>
<td>
<p>x values of data. DEFAULT: 1:length(y)</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_y">y</code></td>
<td>
<p>y values that are smoothed with several window widths</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_widths">widths</code></td>
<td>
<p>widths of <code><a href="#topic+movAv">movAv</a></code> windows. DEFAULT: 2:7*2-1</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_weights">weights</code></td>
<td>
<p>weights within each window</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_col">col</code></td>
<td>
<p>color passed to <code><a href="#topic+addAlpha">addAlpha</a></code>. DEFAULT: &quot;blue&quot;</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_alpha">alpha</code></td>
<td>
<p>transparency passed to <code><a href="#topic+addAlpha">addAlpha</a></code>. DEFAULT: 0.3</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_add">add</code></td>
<td>
<p>Logical: Add to existing plot?Set to FALSE to first create
the scatterplot. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle (only relevant if add=FALSE). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="movAvLines_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+movAv">movAv</a></code>, <code><a href="#topic+addAlpha">addAlpha</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42)
movAvLines(y=cumsum(rnorm(50)), add=FALSE, lwd=3)

</code></pre>

<hr>
<h2 id='mReg'>Multiple regression</h2><span id='topic+mReg'></span>

<h3>Description</h3>

<p>Multiple regression fitting various function types including e.g. linear, cubic, logarithmic, exponential, power, reciprocal.
Quick way to find out what function type fits the data best.
Plots data and fitted functions and adds a legend with the functions (or their types=structure) sorted by R squared.
Returns the fitted functions with their parameters and R^2 values in a data.frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mReg(
  x,
  y = NULL,
  data = NULL,
  Poly45 = FALSE,
  exp_4 = FALSE,
  xf = deparse(substitute(x)),
  yf = deparse(substitute(y)),
  ncolumns = 9,
  plot = TRUE,
  add = FALSE,
  nbest = 12,
  R2min,
  selection = NULL,
  digits = 2,
  extend = 0.4,
  xlim = extendrange(x, f = extend),
  ylim = extendrange(y, f = extend),
  xlab = xf,
  ylab = yf,
  las = 1,
  lwd = rep(1, 12),
  lty = rep(1, 12),
  col = NULL,
  pcol = par("col"),
  pch = 16,
  legend = TRUE,
  legargs = NULL,
  legendform = "nameform",
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mReg_+3A_x">x</code></td>
<td>
<p>Vector with x coordinates or formula (like y~x), the latter is passed to <code><a href="stats.html#topic+model.frame">model.frame</a></code></p>
</td></tr>
<tr><td><code id="mReg_+3A_y">y</code></td>
<td>
<p>Vector with y values. DEFAULT: NULL (to enable x to be a formula)</p>
</td></tr>
<tr><td><code id="mReg_+3A_data">data</code></td>
<td>
<p>data.frame in which formula is applied. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="mReg_+3A_poly45">Poly45</code></td>
<td>
<p>Logical. Should 4th and 5th degree polynomials also be fitted? DEFAULT: FALSE, as the formulas are very long.</p>
</td></tr>
<tr><td><code id="mReg_+3A_exp_4">exp_4</code></td>
<td>
<p>Logical. Return 4-parametric exponential distribution fits (via <code><a href="#topic+exp4p">exp4p</a></code>) in the output table? (only best fit is plotted).
exp_4par_ini has the initial values of exponential fitting with the data relocated to first quadrant.
The others are optimized with the methods of <code><a href="stats.html#topic+optim">optim</a></code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="mReg_+3A_xf">xf</code></td>
<td>
<p>Character. x name for Formula. DEFAULT: substitute(x) before replacing zeros in x and y</p>
</td></tr>
<tr><td><code id="mReg_+3A_yf">yf</code></td>
<td>
<p>Ditto for y</p>
</td></tr>
<tr><td><code id="mReg_+3A_ncolumns">ncolumns</code></td>
<td>
<p>Number of columns in output. Set lower to avoid overcrowding the console. DEFAULT: 9</p>
</td></tr>
<tr><td><code id="mReg_+3A_plot">plot</code></td>
<td>
<p>Logical. plot data and fitted functions? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="mReg_+3A_add">add</code></td>
<td>
<p>Logical. add lines to existing plot? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="mReg_+3A_nbest">nbest</code></td>
<td>
<p>Integer. Number of best fitting functions to be plotted (console output table always has all). DEFAULT: 12</p>
</td></tr>
<tr><td><code id="mReg_+3A_r2min">R2min</code></td>
<td>
<p>Numerical. Minimum Rsquared value for function type to be plotted.
Suggestion: 0.6 (2/3 of variation of y is explained by function of x). DEFAULT: empty</p>
</td></tr>
<tr><td><code id="mReg_+3A_selection">selection</code></td>
<td>
<p>Integers of functions to be plotted, assigned as in list in section &quot;note&quot;. DEFAULT: NULL, meaning all</p>
</td></tr>
<tr><td><code id="mReg_+3A_digits">digits</code></td>
<td>
<p>Integer. number of significant digits used for rounding formula parameters and R^2 displayed. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="mReg_+3A_extend">extend</code></td>
<td>
<p>Numerical. Extention of axis ranges (proportion of range). DEFAULT: 0.4</p>
</td></tr>
<tr><td><code id="mReg_+3A_xlim">xlim</code></td>
<td>
<p>Numerical vector with two values, defining the x-range of the lines to be plotted.  DEFAULT: extended range(x)</p>
</td></tr>
<tr><td><code id="mReg_+3A_ylim">ylim</code></td>
<td>
<p>Ditto for Y-axis</p>
</td></tr>
<tr><td><code id="mReg_+3A_xlab">xlab</code></td>
<td>
<p>Character. default labels for axis labeling and for formulas. DEFAULT: substitute(x) before replacing zeros in x and y</p>
</td></tr>
<tr><td><code id="mReg_+3A_ylab">ylab</code></td>
<td>
<p>Ditto for y axis.</p>
</td></tr>
<tr><td><code id="mReg_+3A_las">las</code></td>
<td>
<p>Integer in 0:4. label axis style. See <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="mReg_+3A_lwd">lwd</code></td>
<td>
<p>Numerical of length 12. line width for lines. DEFAULT: rep(1,12)</p>
</td></tr>
<tr><td><code id="mReg_+3A_lty">lty</code></td>
<td>
<p>Numerical of length 12. line type. DEFAULT: rep(1,12)</p>
</td></tr>
<tr><td><code id="mReg_+3A_col">col</code></td>
<td>
<p>Numerical of length 12. line colors. DEFAULT: NULL, means they are specified internally</p>
</td></tr>
<tr><td><code id="mReg_+3A_pcol">pcol</code></td>
<td>
<p>Color used for the data-points themselves. DEFAULT: par('col')</p>
</td></tr>
<tr><td><code id="mReg_+3A_pch">pch</code></td>
<td>
<p>Integer or single character. Point CHaracter for the data points. See <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: 16</p>
</td></tr>
<tr><td><code id="mReg_+3A_legend">legend</code></td>
<td>
<p>Logical. Add legend to plot? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="mReg_+3A_legargs">legargs</code></td>
<td>
<p>List. List of arguments passed to <code><a href="graphics.html#topic+legend">legend</a></code>. Will overwrite internal defaults. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="mReg_+3A_legendform">legendform</code></td>
<td>
<p>One of 'full', 'form', 'nameform' or 'name'. Complexity (and length) of legend in plot. See Details. DEFAULT: 'nameform'</p>
</td></tr>
<tr><td><code id="mReg_+3A_quiet">quiet</code></td>
<td>
<p>Suppress warnings about value removal (NAs, smaller 0, etc)? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="mReg_+3A_...">...</code></td>
<td>
<p>Further graphical parameters passed to plot</p>
</td></tr>
</table>


<h3>Details</h3>

<p>legendform : example<br />
full : 7.8*x + 6.31<br />
form : a*x+b<br />
nameform : linear a*x+b<br />
name : linear<br /><br />
full can be quite long, especially with Poly45=TRUE!
</p>


<h3>Value</h3>

<p>data.frame with rounded R squared, formulas, and full R^2 and parameters for further use.
Rownames are the names (types) of function. Sorted decreasingly by R^2
</p>


<h3>warning</h3>

<p>A well fitting function does NOT imply correct causation!<br />
A good fit does NOT mean that you describe the behaviour of a system adequately!<br />
Extrapolation can be DANGEROUS!<br />
Always extrapolate to see if a function fits the expected results there as well.<br />
Avoid overfitting: Poly45 will often yield good results (in terms of R^2), but can be way overfitted.
And outside the range of values, they act wildly.
</p>


<h3>Note</h3>

<p>If you're adjusting the appearance (lwd, lty, col) of single lines,
set parameters in the following order:<br />
# 1 linear a*x + b<br />
# 2 quadratic (parabola) a*x^2 + b*x + c<br />
# 3 cubic a*x^3 + b*x^2 + c*x + d<br />
# 4 Polynom 4th degree a*x^4 + b*x^3 + c*x^2 + d*x + e<br />
# 5 Polynom 5 a*x^5 + b*x^4 + c*x^3 + d*x^2 + e*x + f <br />
# 6 logarithmic a*log(x) + b <br />
# 7 exponential a*e^(b*x) <br />
# 8 power/root a*x^b <br />
# 9 reciprocal a/x + b <br />
# 10 rational 1 / (a*x + b) <br />
# 11 exponential 4 Param a*e^(b*(x+c)) + d <br />
</p>
<p>Negative values are not used for regressions containing logarithms; with warning.<br />
exp_4par was originally developed for exponential temperature decline in a cup of hot water.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2012, updated April and Aug 2013, sept 2015
</p>


<h3>References</h3>

<p>Listed here: <a href="https://rclickhandbuch.wordpress.com/rpackages/">https://rclickhandbuch.wordpress.com/rpackages/</a>
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+glm">glm</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+optim">optim</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(12)
x &lt;- c(runif(100,0,3), runif(200, 3, 25)) # random from uniform distribution
y &lt;- 12.367*log10(x)+7.603+rnorm(300)     # random from normal distribution
plot(x,y, xlim=c(0,40))
mReg(x,y) # warning comes from negative y-values (suppress with quiet=TRUE)

# Formula specification:
mReg(Volume~Height, data=trees)

# NA management
x[3:20] &lt;- NA
mReg(x,y)

# Passing arguments to legend:
mReg(x,y, pch=1, legargs=list(x="bottomright", cex=0.7), legendform="form")

mReg(x,y, col=rainbow2(11))
mReg(x,y, extend=0.2) # less empty space around data points
mReg(x,y, nbest=4) # only 4 distributions plotted
mReg(x,y, legargs=list(x=7, y=8, bty="o", cex=0.6)) # Legend position as coordinates

## Not run: # Excluded from Rcmd check (opening external devices)
View(mReg(x,y, Poly45=TRUE, exp_4=TRUE, plot=FALSE)) # exp_4: fit more distributions

## End(Not run)
# optim methods often yield different results, so be careful using this.
# I might insert a possibility to specify initial values for optim.
# 4 Parameters allow several combinations to yield similarly good results!
plot( 0:10, 3.5*exp(0.8*( 0:10 + 2      )) + 15 , type="l")
lines(0:10,  18*exp(0.8*( 0:10 - 2.5e-05)) - 5, col=2)


# okay, different dataset:
x &lt;- c(1.3, 1.6, 2.1, 2.9, 4.4, 5.7, 6.6, 8.3, 8.6, 9.5)
y &lt;- c(8.6, 7.9, 6.6, 5.6, 4.3, 3.7, 3.2, 2.5, 2.5, 2.2)
mReg(x,y, legargs=list(cex=0.7, x="topright"), main="dangers of extrapolation")
points(x,y, cex=2, lwd=2)
# Polynomial fits are good within the data range, but, in this case obviously,
# be really careful extrapolating! If you know that further data will also be low,
# add another point to test differences:
mReg(c(x,11,13,15), c(y,2,2,2), xf="myX", yf="myY", Poly45=TRUE, legendform="name")
points(x,y, cex=2, lwd=2)
# The Polynomials are still very good: they have 5 to 6 Parameters, after all!
# Poly45 is set to FALSE by default to avoid such overfitting.

mReg(x,y, pcol=8, ncol=0) # no return to console

# only plot a subset: best n fits, minimum fit quality, or user selection
mReg(x,y, pcol=8, ncol=2, nbest=4)
mReg(x,y, pcol=8, ncol=2, R2min=0.7)
mReg(x,y, pcol=8, ncol=2, selection=c(2,5,8))
# selecting the fifth degree polynomial activates Poly45 (in the output table)

# Add to axisting plot:
plot(x,y, xlim=c(0,40))
mReg(x,y, add=TRUE, lwd=12:1/2, ncol=0)
# lwd, lty can be vectors of length 12, specifying each line separately.
# Give those in fix order (see section notes), not in best-fit order of the legend.
# The order is Polynomial(1:5), log, exp, power, reciprocal, rational, exp_4_param
# color has to be a vector of 12
# opposedly, lwd and lty are repeated 12 times, if only one value is given


# One more dataset:
j &lt;- c(5,8,10,9,13,6,2) ; k &lt;- c(567,543,587,601,596,533,512)
# Inset from margin of plot region:
mReg(j,k, legargs=list(x="bottomright", inset=.05, bty="o"), legendform="name")
# Legend forms
mReg(j,k, legargs=list(x="bottomright"), legendform="name")
mReg(j,k, legargs=list(x="bottomright"), legendform="form")
mReg(j,k, legargs=list(x="bottomright"), legendform="nameform")
mReg(j,k, legargs=list(x="bottomright"), legendform="full")

## Not run: # Excluded from Rcmd check (long computing time)

# The question that got me started on this whole function...
# exponential decline of temperature of a mug of hot chocolate
tfile &lt;- system.file("extdata/Temp.txt", package="berryFunctions")
temp &lt;- read.table(tfile, header=TRUE, dec=",")
head(temp)
plot(temp)
temp &lt;- temp[-20,] # missing value - rmse would complain about it

x &lt;- temp$Minuten
y &lt;- temp$Temp
mReg(x,y, exp_4=TRUE, selection=11)
# y=49*e^(-0.031*(x - 0  )) + 25 correct, judged from the model:
# Temp=T0 - Te *exp(k*t) + Te     with    T0=73.76,  Tend=26.21, k=-0.031
# optmethod="Nelder-Mead"  # y=52*e^(-0.031*(x + 3.4)) + 26 wrong


x &lt;- seq(1, 1000, 1)
y &lt;- (x+22)/(x+123) # can't find an analytical solution so far. Want to check out nls
mReg(x, y, legargs=list(x="right"))


## End(Not run)


# Solitaire Results. According to en.wikipedia.org/wiki/Klondike_(solitaire):
# Points=700000/Time + Score
# I recorded my results as an excuse to play this game a lot.
sfile &lt;- system.file("extdata/solitaire.txt", package="berryFunctions")
solitaire &lt;- read.table(sfile, header=TRUE)
mReg(solitaire$Time, solitaire$Points) # and yes, reciprocal ranks highest! Play Fast!
mReg(solitaire$Time, solitaire$Bonus, xlim=c(50,200), extend=0, nbest=3)
sol &lt;- unique(na.omit(solitaire[c("Time","Bonus")]))
sol
sol$official &lt;- round(700000/sol$Time/5)*5
mReg(sol$Time, sol$Bonus, extend=0, selection=9, col=rep(4,10), legendform="full")
plot(sol$Time, sol$official-sol$Bonus, type="l")

# multivariate regression should be added, too:
sfile &lt;- system.file("extdata/gelman_equation_search.txt", package="berryFunctions")
mv &lt;- read.table(sfile, header=TRUE)

sfile &lt;- system.file("extdata/mRegProblem.txt", package="berryFunctions")
x &lt;- read.table(sfile, header=TRUE)$x
y &lt;- read.table(sfile, header=TRUE)$y
mReg(x,y,  digits=6) # all very equal
x2 &lt;- x-min(x)
mReg(x2,y, digits=6)          #  Formulas are wrong if digits is too low!!
#mReg(x2,y, legendform="full")

# Zero and NA testing (to be moved to unit testing someday...)
mReg(1:10, rep(0,10))
mReg(1:10, c(rep(0,9),NA))
mReg(1:10, rep(NA,10))
mReg(rep(1,10), 1:10)
mReg(rep(0,10), 1:10)
mReg(c(rep(0,9),NA), 1:10)
mReg(rep(NA,10), 1:10)

mReg(1:10, rep(0,10), quiet=TRUE)
mReg(1:10, c(rep(0,9),NA), quiet=TRUE)
mReg(1:10, rep(NA,10), quiet=TRUE)
mReg(rep(1,10), 1:10, quiet=TRUE)
mReg(rep(0,10), 1:10, quiet=TRUE)
mReg(c(rep(0,9),NA), 1:10, quiet=TRUE)
mReg(rep(NA,10), 1:10, quiet=TRUE)

</code></pre>

<hr>
<h2 id='na9'>Prepend spaces before na.strings</h2><span id='topic+na9'></span>

<h3>Description</h3>

<p>Returns a number of useful character strings with varying amount of spaces prepended.
It can be used as <code>na.strings=na9()</code> in <code><a href="utils.html#topic+read.table">read.table</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>na9(
  nspace = 5,
  base = c(-9999, -999, -9.99, -9.999),
  sep = c(",", "."),
  digits = 0:4,
  more = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="na9_+3A_nspace">nspace</code></td>
<td>
<p>number of spaces prepended. DEFAULT: 5</p>
</td></tr>
<tr><td><code id="na9_+3A_base">base</code></td>
<td>
<p>Numeric: basic na.string numbers</p>
</td></tr>
<tr><td><code id="na9_+3A_sep">sep</code></td>
<td>
<p>Separator string (comma or decimal point or both). DEFAULT: c(&quot;,&quot;,&quot;.&quot;)</p>
</td></tr>
<tr><td><code id="na9_+3A_digits">digits</code></td>
<td>
<p>Number(s) of zeros to be appended. DEFAULT: 0:4</p>
</td></tr>
<tr><td><code id="na9_+3A_more">more</code></td>
<td>
<p>More structures added to base, like &quot;NA&quot;, &quot;&ndash;&quot;. digits and sep is not added to this! DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="na9_+3A_...">...</code></td>
<td>
<p>Arguments passed to nothing currently</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character strings
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">paste</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
na9()
na9(nspace=0, sep=".")
na9(nspace=0, sep=".", more=c(NA,"-"))

</code></pre>

<hr>
<h2 id='nameSample'>Nonrandom character sequence with sample</h2><span id='topic+nameSample'></span>

<h3>Description</h3>

<p>Find the seed necessary to produce a character sequence by using sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>nameSample(name, progress = FALSE, estimatetime = nc &gt; 4, continue = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="nameSample_+3A_name">name</code></td>
<td>
<p>Character string. long strings (&gt;&gt;5) will compute a VERY long time!</p>
</td></tr>
<tr><td><code id="nameSample_+3A_progress">progress</code></td>
<td>
<p>Logical. Monitor progress by printing a dot every 10000 tries? DEFAULT: TRUE for long names (nchar(name)&gt;3).</p>
</td></tr>
<tr><td><code id="nameSample_+3A_estimatetime">estimatetime</code></td>
<td>
<p>Estimate computation time? DEFAULT: nc&gt;4</p>
</td></tr>
<tr><td><code id="nameSample_+3A_continue">continue</code></td>
<td>
<p>Continue without asking? DEFAULT:  FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code><a href="base.html#topic+cat">cat</a></code>s command into the console that can be copypasted to anyone's R script.
</p>


<h3>Note</h3>

<p>nameSample may take a lot of time, due to nchar^26 possibilities. That's why it warns about strings longer than 5 characters
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+yearSample">yearSample</a></code> to wish a happy new year, <code><a href="base.html#topic+set.seed">set.seed</a></code>, <code><a href="base.html#topic+sample">sample</a></code>, <code><a href="base.html#topic+letters">letters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run in RCMD check as they're very time consuming
## Not run: 
# nameSample("berry")  # After that, you can send the result to colleagues:
# Kind regards from
set.seed(1248272); paste(sample(letters,5,TRUE), collapse='')

# calculation time

system.time(nameSample("ber"))
system.time(nameSample("ber", FALSE))

# let &lt;- sapply(1:4, function(n) apply(replicate(n, letters[sample(15)]), 1, paste, collapse=""))
# calctime &lt;- sapply(let, function(x) system.time(nameSample(x, progress=F))[3])
# write.table(calctime, "calctime_nameSample.txt")
ctfile  &lt;- system.file("extdata/calctime_nameSample.txt",  package="berryFunctions")
ctfile2 &lt;- system.file("extdata/calctime_nameSample2.txt", package="berryFunctions")
calctime &lt;- read.table(ctfile)
# regression result in hours:
expReg(nchar(rownames(calctime))-8, calctime[,1], xlim=c(1,7), ylim=c(-3,4),
       predict=7)/3600

# For my 3 times faster computer:
calctime &lt;- read.table(ctfile2)
expReg(nchar(rownames(calctime))-8, calctime[,1], xlim=c(1,7), ylim=c(-3,4),
       predict=c(4,7))/c(1,3600)
# 4 sec for 4 letters are expected to be 10 hours for 7 letters...


## End(Not run)

</code></pre>

<hr>
<h2 id='newFilename'>Create new filename if file already exists</h2><span id='topic+newFilename'></span>

<h3>Description</h3>

<p>Check if files already exist and append <code>_1</code> or <code>_2</code>, etc to the filename if needed,
thereby giving useful messages.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>newFilename(
  filename,
  ignore = FALSE,
  overwrite = FALSE,
  tellignore = TRUE,
  pre = "",
  mid = "\n",
  end = "",
  quiet = FALSE,
  ntrunc = 3
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="newFilename_+3A_filename">filename</code></td>
<td>
<p>Char (vector): file name(s).</p>
</td></tr>
<tr><td><code id="newFilename_+3A_ignore">ignore</code></td>
<td>
<p>Logical (vector, recycled): Ignore file? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="newFilename_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical (vector, recycled): overwrite file? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="newFilename_+3A_tellignore">tellignore</code></td>
<td>
<p>Logical: Message about ignored files? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="newFilename_+3A_pre">pre</code>, <code id="newFilename_+3A_mid">mid</code>, <code id="newFilename_+3A_end">end</code></td>
<td>
<p>Char: strings to append after traceback / message / filenames.
DEFAULT: &quot;&quot;, &quot;\n  &quot;, &quot;&quot;</p>
</td></tr>
<tr><td><code id="newFilename_+3A_quiet">quiet</code></td>
<td>
<p>Logical: Suppress messages about creating file(s)? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="newFilename_+3A_ntrunc">ntrunc</code></td>
<td>
<p>Integer: Number of filenames printed in messages before they
get truncated with message &quot;(and xx more)&quot;. DEFAULT: 3</p>
</td></tr>
</table>


<h3>Value</h3>

<p>newFilename returns the input with an added &quot;_n&quot; in the filename
for each file that already existed.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Oct 2016 + Jan 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+file.exists">file.exists</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
fns &lt;- c("dummy1", "dummy2.txt", "berryFunctions.Rproj",
         "README.md", "dummy2.dummy", "DESCRIPTION", "dummy4.R", "dummy5")
newFilename(fns)
newFilename(fns, ignore=TRUE)
newFilename(fns, ignore=rep(c(TRUE,FALSE), each=4) )
newFilename(fns, ignore=rep(c(TRUE,FALSE), each=4), tellignore=FALSE)
newFilename(fns, ntrunc=2)
newFilename(fns, overwrite=TRUE, ign=c(TRUE,TRUE,rep(FALSE,6)))
newFilename("README.md")
newFilename("dummy", mid=" ") # no line break

</code></pre>

<hr>
<h2 id='normalizePathCP'>normalizePath Cross Platform</h2><span id='topic+normalizePathCP'></span>

<h3>Description</h3>

<p><code><a href="base.html#topic+normalizePath">normalizePath</a></code> Cross Platform: Returns absolute
path even for not (yet) existing files even on Linux.
On Windows, this is the default behaviour.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normalizePathCP(path, winslash = "/", mustWork = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normalizePathCP_+3A_path">path</code></td>
<td>
<p>Character vector of file paths</p>
</td></tr>
<tr><td><code id="normalizePathCP_+3A_winslash">winslash</code></td>
<td>
<p>Path separator on Windows.
DEFAULT: &quot;/&quot; (unlike <code><a href="base.html#topic+normalizePath">normalizePath</a></code>)</p>
</td></tr>
<tr><td><code id="normalizePathCP_+3A_mustwork">mustWork</code></td>
<td>
<p>Logical for <code><a href="base.html#topic+normalizePath">normalizePath</a></code>. DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>path character string(s)
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+normalizePath">normalizePath</a></code>, <code><a href="#topic+newFilename">newFilename</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normalizePath  ("doesnotexist.file", mustWork=FALSE) # on unix not full path
normalizePathCP("doesnotexist.file") # full path on all platforms

normalizePath  ("../doesnotexist.file", mustWork=FALSE)
normalizePathCP("../doesnotexist.file")
 
checknp &lt;- function(a,b=a,d=getwd())
  {
  aa &lt;- normalizePathCP(a)
  bb &lt;- if(d=="") b else paste0(d,"/",b)
  if(aa != bb) stop("'", a, "' -&gt; '", aa, "', should be '",bb, "'.")
  aa
  }

checknp("notexist.file")
checknp("../notexist.file", "notexist.file", dirname(getwd()))
checknp("notexistfolder/notexist.file")
#checknp("/home/berry/notexist.file", d="") # fails on windows
#checknp("S:/Dropbox/notexist.file",d="") # fails on linux

</code></pre>

<hr>
<h2 id='normPlot'>Normal density plot</h2><span id='topic+normPlot'></span>

<h3>Description</h3>

<p>Nice plot of normal density distribution
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normPlot(
  mean = 0,
  sd = 1,
  width = 3,
  lines = TRUE,
  quant = TRUE,
  fill = addAlpha("blue", c(2:6, 7:2)/10),
  cumulative = TRUE,
  las = 1,
  main = paste("Normal density with\nmean =", signif(mean, 2), "and sd =", signif(sd,
    2)),
  ylim = lim0(dnorm(mean, mean, sd)),
  ylab = "",
  xlab = "",
  type = "n",
  lty = 1,
  col = par("fg"),
  mar = c(2, 3, 3, 3),
  keeppar = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normPlot_+3A_mean">mean</code></td>
<td>
<p>average value as in <code><a href="stats.html#topic+dnorm">dnorm</a></code>. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="normPlot_+3A_sd">sd</code></td>
<td>
<p>standard deviation. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="normPlot_+3A_width">width</code></td>
<td>
<p>distance (in sd) from plot ends to mean. DEFAULT: 3</p>
</td></tr>
<tr><td><code id="normPlot_+3A_lines">lines</code></td>
<td>
<p>Should vertical lines be plotted at mean +- n*sd? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="normPlot_+3A_quant">quant</code></td>
<td>
<p>should quantile regions be drawn with <code>fill</code> colors? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="normPlot_+3A_fill">fill</code></td>
<td>
<p>color(s) passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>. DEFAULT: addAlpha(&quot;blue&quot;,c(2:6,7:2)/10)</p>
</td></tr>
<tr><td><code id="normPlot_+3A_cumulative">cumulative</code></td>
<td>
<p>Should cumulative density distribution be added? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="normPlot_+3A_las">las</code></td>
<td>
<p>arguments passed to <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="normPlot_+3A_main">main</code></td>
<td>
<p>main as in <code><a href="base.html#topic+plot">plot</a></code>. DEFAULT: paste(&quot;Normal density with\nmean =&quot;, mean, &quot;and sd =&quot;, sd)</p>
</td></tr>
<tr><td><code id="normPlot_+3A_ylim">ylim</code></td>
<td>
<p>limit for the y axis. DEFAULT: lim0(y)</p>
</td></tr>
<tr><td><code id="normPlot_+3A_ylab">ylab</code>, <code id="normPlot_+3A_xlab">xlab</code></td>
<td>
<p>labels for the axes. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="normPlot_+3A_type">type</code>, <code id="normPlot_+3A_lty">lty</code>, <code id="normPlot_+3A_col">col</code></td>
<td>
<p>arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code>. type=&quot;l&quot; to add pdf line</p>
</td></tr>
<tr><td><code id="normPlot_+3A_mar">mar</code></td>
<td>
<p>margins for plot passed to <code><a href="graphics.html#topic+par">par</a></code>. DEFAULT: c(2,3,3,3)</p>
</td></tr>
<tr><td><code id="normPlot_+3A_keeppar">keeppar</code></td>
<td>
<p>should margin parameters be kept instead of being restored to previous value? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="normPlot_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="base.html#topic+plot">plot</a></code> like lwd, xaxs, cex.axis, etc.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function finds some nice defaults for very quickly plotting a normal distribution by just specifying mean and sd.
</p>


<h3>Value</h3>

<p>None. Used for plotting.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+betaPlot">betaPlot</a></code>, <code><a href="stats.html#topic+dnorm">dnorm</a></code>,
<a href="https://cran.r-project.org/package=denstrip">https://cran.r-project.org/package=denstrip</a>,
<a href="https://cran.r-project.org/view=Distributions">https://cran.r-project.org/view=Distributions</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
normPlot()
normPlot(81.7, 11.45)
normPlot(180, 11, quant=FALSE, width=2)

</code></pre>

<hr>
<h2 id='normTest'>Test values for normality of distribution</h2><span id='topic+normTest'></span>

<h3>Description</h3>

<p>Normality test: histogram with corresponding normal density distribution line, 
as well as p values for various normality tests.<br />
The package <code>nortest</code> is needed for full functionality.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>normTest(
  v,
  plot = TRUE,
  main = deparse(substitute(v)),
  breaks = 15,
  col = "tan",
  legend = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="normTest_+3A_v">v</code></td>
<td>
<p>Vector of values to be tested for normality</p>
</td></tr>
<tr><td><code id="normTest_+3A_plot">plot</code></td>
<td>
<p>Plot the histogram with the corresponding 
normal density distribution? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="normTest_+3A_main">main</code></td>
<td>
<p>Graph title. DEFAULT: <code>deparse(substitute(v))</code></p>
</td></tr>
<tr><td><code id="normTest_+3A_breaks">breaks</code></td>
<td>
<p>Number of bins. Exact, unlike in <code><a href="graphics.html#topic+hist">hist</a></code>.
DEFAULT: 15</p>
</td></tr>
<tr><td><code id="normTest_+3A_col">col</code></td>
<td>
<p>Color of bars. DEFAULT: &quot;tan&quot;</p>
</td></tr>
<tr><td><code id="normTest_+3A_legend">legend</code></td>
<td>
<p>Add legend text in topright? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="normTest_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+hist">hist</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>named vector of p values
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2021
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+ks.test">ks.test</a></code>, <code><a href="stats.html#topic+shapiro.test">shapiro.test</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>normTest(rnorm(1000, mean=97, sd=8.9))
# if p &gt; 0.05: accept Nullhypothesis that data are normally distributed.
normTest(rexp(30))

if(requireNamespace("pbapply")) replicate &lt;- pbapply::pbreplicate
par(mfcol=c(7,6), mar=c(0,0.1,1,0.1), oma=c(2.5,1.5,2.5,0), las=1)
invisible(sapply(c("rnorm(10)", "rnorm(100)", 
                   "rexp(10)", "rexp(100)", 
                   "runif(10)", "runif(100)"), function(vv){
  check &lt;- replicate(1e2, normTest(v=eval(str2lang(vv)), plot=FALSE))
  for(n in rownames(check)) 
   {hist(check[n,], breaks=seq(0,1,len=20), axes=FALSE, ylab="", xlab="", main="")
   if(n=="ShapiroWilk") title(main=vv, line=1, xpd=NA)
   if(vv=="rnorm(10)") title(ylab=n, line=0, xpd=NA)
   abline(v=0.05, col="blue", lwd=1, xpd=TRUE)
   }
  axis(1, at=0:1)
  }))
title(main="P values of tests for normality with", outer=TRUE, line=1.5)

</code></pre>

<hr>
<h2 id='openFile'>open file in default application</h2><span id='topic+openFile'></span>

<h3>Description</h3>

<p>open a file using <code><a href="base.html#topic+system2">system2</a></code> with command based on operating system.
Tries to open the file with the program associated with its file extension.<br />
See <code><a href="#topic+openPDF">openPDF</a></code> to open files with sumatraPDF.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openFile(file, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="openFile_+3A_file">file</code></td>
<td>
<p>Filename to be opened, as character string.</p>
</td></tr>
<tr><td><code id="openFile_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+system2">system2</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of try(system2, ...), invisibly
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2017
</p>


<h3>References</h3>

<p><a href="https://askubuntu.com/questions/15354">https://askubuntu.com/questions/15354</a>,
<a href="https://apple.stackexchange.com/questions/212583">https://apple.stackexchange.com/questions/212583</a>
</p>


<h3>See Also</h3>

<p><code><a href="#topic+openPDF">openPDF</a></code>, <code><a href="base.html#topic+system2">system2</a></code>, <code><a href="#topic+checkFile">checkFile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # excluded from CRAN checks, file opening not wanted
openFile("README.md")
openFile("Tests.R")
openFile(c("README.md","Tests.R"))
is.error(openFile("dummydummydoesntexist.R"), TRUE, TRUE)
openFile(tempdir())

## End(Not run)
#' # To open folders (not files) with system2:
# "nautilus" on linux ubuntu
# "open" or "dolphin" on mac
# "explorer" or "start" on windows
# But open / xdg-open seems to work as well

</code></pre>

<hr>
<h2 id='openPDF'>open PDF file with sumatra viewer</h2><span id='topic+openPDF'></span>

<h3>Description</h3>

<p>open PDF file with SumatraPDF viewer, which does not lock files against being edited.
It is only available on windows, but comes bundled with Rstudio.
If the executable is not found, <code><a href="#topic+openFile">openFile</a></code> is called instead.<br />
I suggest to first change some settings with <code><a href="#topic+sumatraInitialize">sumatraInitialize</a>()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>openPDF(
  file,
  rspath = sub("rstudio.exe$", "", Sys.getenv("RSTUDIO_DESKTOP_EXE")),
  sumexe = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="openPDF_+3A_file">file</code></td>
<td>
<p>Filename to be opened, as character string.
Files not ending in &quot;.pdf&quot; are ignored with a warning.</p>
</td></tr>
<tr><td><code id="openPDF_+3A_rspath">rspath</code></td>
<td>
<p>The path to Rstudio files. 
DEFAULT: <code>sub("rstudio.exe$", "", <a href="base.html#topic+Sys.getenv">Sys.getenv</a>("RSTUDIO_DESKTOP_EXE"))</code></p>
</td></tr>
<tr><td><code id="openPDF_+3A_sumexe">sumexe</code></td>
<td>
<p>The path to SumatraPDF.exe. DEFAULT: Null: added to <code>rspath</code>, e.g. 
&quot;C:/Program Files/RStudio/resources/app/bin/sumatra/SumatraPDF.exe&quot;</p>
</td></tr>
<tr><td><code id="openPDF_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+system">system</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Result of try(system, ...), invisibly
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+openFile">openFile</a></code> for the default opening programm<br />
<code><a href="#topic+sumatraInitialize">sumatraInitialize</a></code> for nice Sumatra default settings<br />
<code><a href="#topic+pdfpng">pdfpng</a></code> to create PDFs and PNGs simultaneously.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># only desired in an interactive session, not on CRAN checks
# openPDF( system.file("extdata/Anhang.pdf", package="berryFunctions")  )
# openPDF( system.file(c("extdata/Anhang.pdf", "extdata/RainfallStationsMap.pdf"), 
#                      package="berryFunctions")  )

</code></pre>

<hr>
<h2 id='owa'>Overwrite argument default lists</h2><span id='topic+owa'></span>

<h3>Description</h3>

<p>Second ellipsis (three dots) passed to particular functions,
combining default and user-specified argument lists.<br />
<code>owa</code> can be used in functions that pass argument lists separately to several functions.
Internal defaults can be set per function (eg. one list for <code><a href="base.html#topic+plot">plot</a></code>
and one for <code><a href="graphics.html#topic+legend">legend</a></code>). <br />
You can specify which defaults can be overwritten and which should be left unchanged.
See the example section on how to implement this.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>owa(d, a, ..., quiet = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="owa_+3A_d">d</code></td>
<td>
<p>Default arguments (list or vector)</p>
</td></tr>
<tr><td><code id="owa_+3A_a">a</code></td>
<td>
<p>Arguments specified by user (list or vector).
Can also be a single TRUE, in which case d will be returned.</p>
</td></tr>
<tr><td><code id="owa_+3A_...">...</code></td>
<td>
<p>Names of unchangeable arguments (that will not be overwritten)
as character strings. Can also be a vector with characters strings.</p>
</td></tr>
<tr><td><code id="owa_+3A_quiet">quiet</code></td>
<td>
<p>Logical: Should <code><a href="base.html#topic+message">message</a></code> be suppressed if arguments are ignored?
If FALSE (the DEFAULT), this helps users debugging, as they get
notified when arguments they specified were ignored.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Always a list, disregarding list/vector mode of input
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Early 2014, Update Oct 2016
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/questions/3057341">https://stackoverflow.com/questions/3057341</a><br />
<a href="https://stackoverflow.com/questions/5890576">https://stackoverflow.com/questions/5890576</a><br />
<a href="https://stackoverflow.com/questions/4124900">https://stackoverflow.com/questions/4124900</a><br />
<a href="https://stackoverflow.com/questions/16774946">https://stackoverflow.com/questions/16774946</a><br />
</p>


<h3>Examples</h3>

<pre><code class='language-R'># The motivation behind owa:
testfun &lt;- function(...) {plot(7:11, ...) ; legend("top", "some text", ...)}
testfun()
is.error( testfun(type="o") , tell=TRUE)
# Error: legend doesn't have the argument 'type'!

# How to solve this:
testfun &lt;- function(legargs=NULL, ...) # dots passed to plot
   {
   plot(7:11, ...)
   legend_defaults &lt;- list(x="top", lty=1, col="red", legend="owa rocks!")
   # combine defaults and user specified into final argument list,
   # overwrite arguments ('owa') in the default list unless protected:
   legend_final &lt;- owa(d=legend_defaults, a=legargs, "col", "lwd")
   do.call(legend, args=legend_final)
   }

testfun()
testfun(type="l", col="blue")
testfun(type="o", legargs=list(col="blue", pch=16, lty=3) )
# color in legargs is ignored, as it is defined as unchangeable


#----------------------------------------------------------------------------

# basic tests of owa itself:
d &lt;- list(bb=1:5, lwd="was d", lty=1,   col="gray")
a &lt;- list(bb=3,   lwd=5, lty="from a", wachs="A")
owa(d,a) # all changed, wachs added
owa(d, a, "bb", "lwd") # lty is overwritten, bb and lwd are ignored
owa(d, NULL, "bb", "wachs") # NULL is a good default for argument lists
owa(d, c(HH=2, BBB=3) ) # vectors and lists are all converted to lists
owa(d, list(lwd=5, bb=3, lty="1") ) # order of arguments doesn't matter
owa(d, a, c("bb","lwd") ) # unchangeable can also be a named vector
owa(d, a, c("bb","lwd"), c("lty","dummy") ) # or several vectors


</code></pre>

<hr>
<h2 id='packagePath'>Base path of package</h2><span id='topic+packagePath'></span>

<h3>Description</h3>

<p>Base path of package (with DESCRIPTION file), per default at current getwd.
Derived from devtools::package_file
</p>


<h3>Usage</h3>

<pre><code class='language-R'>packagePath(path = ".", file = NULL, warnonly = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="packagePath_+3A_path">path</code></td>
<td>
<p>Path to (or below) package directory. DEFAULT: &quot;.&quot;</p>
</td></tr>
<tr><td><code id="packagePath_+3A_file">file</code></td>
<td>
<p>Optional file name to be added to path. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="packagePath_+3A_warnonly">warnonly</code></td>
<td>
<p>Logical: if no part of the path is a package, give a warning
and return the original input instead of stopping with an error.
DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Path character string
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+getwd">getwd</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># packagePath() # may fail on cran checks

</code></pre>

<hr>
<h2 id='panelDim'>Arrange panels in a multipanel plot (par mfrow)</h2><span id='topic+panelDim'></span>

<h3>Description</h3>

<p>Returns the optimum where deviation from ncol=nrow and number of panels left empty have a minimum sum.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>panelDim(
  n,
  weight = c(1, 1),
  maxempty = round(n/4),
  landscape = FALSE,
  all = FALSE,
  plot = FALSE,
  mfcol = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="panelDim_+3A_n">n</code></td>
<td>
<p>Number of panels to be arranged</p>
</td></tr>
<tr><td><code id="panelDim_+3A_weight">weight</code></td>
<td>
<p>Weights to avoid <em>empty panels</em> and <em>discrepancy between ncol and nrow</em>, respectively. DEFAULT: c(1,1)</p>
</td></tr>
<tr><td><code id="panelDim_+3A_maxempty">maxempty</code></td>
<td>
<p>Maximum number of panels that are allowed to be left empty.
If <code>maxempty=0</code>, no panel is left blank, so 11 plots would be beneath each other
instead of in a 4x3 grid with one panel left blank. DEFAULT: round(n/4)</p>
</td></tr>
<tr><td><code id="panelDim_+3A_landscape">landscape</code></td>
<td>
<p>Use landscape orientation instead of portrait? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="panelDim_+3A_all">all</code></td>
<td>
<p>Show all reasonable possibilities in a data.frame? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="panelDim_+3A_plot">plot</code></td>
<td>
<p>Show the panel layout result? (the 4 best options are compared if <code>all=TRUE</code>). DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="panelDim_+3A_mfcol">mfcol</code></td>
<td>
<p>use mfcol instead of mfrow. DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>There probably are other ways to find the optimal way to arrange panels, so if you find anything, please give me a hint.
</p>


<h3>Value</h3>

<p>vector with 2 values, can be passed to par(mfrow), or a data.frame if <code>all=TRUE</code>.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2014, Jan 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+groupHist">groupHist</a></code>, which is using this function
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# basic usage
op &lt;- par(mfrow=panelDim(6))
for(i in 1:6) plot(i:10, main=i)
par(op)

# Adcanced options
panelDim(7)
g &lt;- panelDim(7, all=TRUE)
panelDim(7, plot=TRUE)
panelDim(7, plot=TRUE, all=TRUE) # compares 4 best options

panelDim(26, all=TRUE)
panelDim(26, plot=TRUE, all=TRUE) # compares 4 best options
panelDim(26, plot=TRUE, all=TRUE, weight=c(3,0) ) # fewer empty panels

# effect of maxempty:
panelDim(13, plot=TRUE)             #  4 x 4
panelDim(13, maxempty=2, plot=TRUE) #  5 x 3
panelDim(13, maxempty=1, plot=TRUE) #  7 x 2
panelDim(13, maxempty=0, plot=TRUE) # 13 x 1

panelDim(45, plot=TRUE) # no empty panels
# focus on aspect ratio of each panel (make it as square as possible):
panelDim(45, weight=c(1,3), plot=TRUE) # better aspect for each panel

# Orientation of plot:
panelDim(45, plot=TRUE) # good for portrait orientation of plot
panelDim(45, landscape=TRUE, plot=TRUE) # better if plot width &gt; height

## Not run: 
## Rcmd check --as-cran doesn't like to open external devices,
## so this example is excluded from running in the checks.
# plot of several n with defaults
dev.new(record=TRUE)
for(i in 1:50)  panelDim(i, plot=TRUE)

## End(Not run)

</code></pre>

<hr>
<h2 id='par_sapply'>cross-platform parallel processing with progbar</h2><span id='topic+par_sapply'></span>

<h3>Description</h3>

<p>Call <code>pbapply::<a href="pbapply.html#topic+pbsapply">pbsapply</a></code> 
with nc default at number of cores available.
Also, this works on Windows directly.
Note this throws an error on unix systems, unlike <code>parallel::mclapply</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>par_sapply(
  X,
  FUN,
  nc = NULL,
  pb = TRUE,
  simplify = TRUE,
  export_objects = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="par_sapply_+3A_x">X</code></td>
<td>
<p>vector / list of values</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_fun">FUN</code></td>
<td>
<p>function to be executed with each element of <code>X</code>.</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_nc">nc</code></td>
<td>
<p>Integer: number of cores to be used in parallel.
DEFAULT: NULL (available cores)</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_pb">pb</code></td>
<td>
<p>Show progress bar with remaining time and at the end runtime? 
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_simplify">simplify</code></td>
<td>
<p>Simplify output to vector/matrix if possible?
Note that simplify=&quot;array&quot; is not implemented here.
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_export_objects">export_objects</code></td>
<td>
<p>For windows: Objects needed in <code>FUN</code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="par_sapply_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code>FUN</code> or 
<code>pbapply::<a href="pbapply.html#topic+pbsapply">pbsapply</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>vector/matrix, list if simplify=FALSE
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2021
</p>


<h3>See Also</h3>

<p><code>pbapply::<a href="pbapply.html#topic+pbsapply">pbsapply</a></code>, <code><a href="base.html#topic+sapply">sapply</a></code>, <code><a href="#topic+parallelCode">parallelCode</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run:  # Suppressed on CRAN checks as this is time-consuming
fun &lt;- function(x) mean(rnorm(1e7))
pbapply::pbsapply(1:20, fun)
       par_sapply(1:20, fun)
          #sapply(1:20, fun)

## End(Not run)
inp_chr_named &lt;- list(first=1, second=2, third="3", fourth=4, fifth="5")
inp_num_named &lt;- lapply(inp_chr_named, as.numeric)
inp_chr_none &lt;- unname(inp_chr_named)
inp_num_none &lt;- unname(inp_num_named)
if(FALSE){#intentional errors, don't run
par_sapply(inp_chr_named, log) # fails with name(s)
par_sapply(inp_num_named, log) # works, has names
par_sapply(inp_chr_none, log) # fails with index number (s)
par_sapply(inp_num_none, log) # no names, like in sapply
}

</code></pre>

<hr>
<h2 id='parallelCode'>code chunk for parallelization</h2><span id='topic+parallelCode'></span>

<h3>Description</h3>

<p>message a code chunk template for parallelization with progress bar on windows.
On Linux, just use <code>pblapply(X, cl=8, FUN=fun)</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>parallelCode()
</code></pre>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+par_sapply">par_sapply</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>parallelCode()

</code></pre>

<hr>
<h2 id='pdfpng'>Create pdf and png graph</h2><span id='topic+pdfpng'></span>

<h3>Description</h3>

<p>Create both a <code><a href="grDevices.html#topic+pdf">pdf</a></code> and a <code><a href="grDevices.html#topic+png">png</a></code> file with a graph,
with custom size default values.<br />
<code>pdfpng</code> tries to open the PDF file (through <code><a href="#topic+openPDF">openPDF</a></code>) 
with SumatraPDF viewer, which does not lock files against being edited. <br />
See <code><a href="#topic+sumatraInitialize">sumatraInitialize</a></code> for nice Sumatra default settings.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pdfpng(
  expr,
  file,
  pdf = TRUE,
  png = TRUE,
  overwrite = FALSE,
  open = TRUE,
  quiet = FALSE,
  tracewarnmes = !quiet,
  filargs = NULL,
  width = 7,
  height = 5,
  units = "in",
  res = 500,
  seed = runif(1, -1e+09, 1e+09),
  envlevel = 1,
  pdfargs = NULL,
  pngargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pdfpng_+3A_expr">expr</code></td>
<td>
<p>Expression creating the plot, can be included in curly braces.</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_file">file</code></td>
<td>
<p>Character: Filename without pdf/png extension.
Unless overwrite=TRUE, files will not be overwritten, but
&quot;_1&quot; will be appended instead, see <code><a href="#topic+newFilename">newFilename</a></code>.
If <code>expr</code> creates several plots, use file=&quot;fname%02d&quot;,
otherwise the png will only contain the last figure.
Note: this overwrites files as the % notation is not
captured by newFilename. You may also have to run dev.off().</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_pdf">pdf</code></td>
<td>
<p>Logical: Create pdf? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_png">png</code></td>
<td>
<p>Logical: Create png? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_overwrite">overwrite</code></td>
<td>
<p>Logical: Overwrite existing <code>file</code>? Can be a vector
for pdf and png separately.
DEFAULT: FALSE (_n appended in filename)</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_open">open</code></td>
<td>
<p>Logical: open file(s) after creation using 
<code><a href="#topic+openPDF">openPDF</a></code> and <code><a href="#topic+openFile">openFile</a></code>? 
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress file creation messages and
expr execution error tracing? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_tracewarnmes">tracewarnmes</code></td>
<td>
<p>Logical: trace warnings and messages in expr execution?
Errors are always traced. Default: !quiet</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_filargs">filargs</code></td>
<td>
<p>List of other arguments passed to <code><a href="#topic+newFilename">newFilename</a></code>.
DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_width">width</code>, <code id="pdfpng_+3A_height">height</code></td>
<td>
<p>Graph dimensions. DEFAULT: 7x5 inches</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_units">units</code>, <code id="pdfpng_+3A_res">res</code></td>
<td>
<p>Graph quality arguments passed only to <code><a href="grDevices.html#topic+png">png</a></code>.
DEFAULT: inches (&quot;in&quot;), 500 ppi</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_seed">seed</code></td>
<td>
<p>Seed passed to <code><a href="base.html#topic+set.seed">set.seed</a></code> before each call.
DEFAULT: runif(1,-1e9,1e9)</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_envlevel">envlevel</code></td>
<td>
<p>Environment level passed to <code><a href="base.html#topic+eval.parent">eval.parent</a></code>.
Never needs to be changed, as far as I can tell. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_pdfargs">pdfargs</code></td>
<td>
<p>List of arguments only passed to <code><a href="grDevices.html#topic+pdf">pdf</a></code>.</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_pngargs">pngargs</code></td>
<td>
<p>List of arguments only passed to <code><a href="grDevices.html#topic+png">png</a></code>.</p>
</td></tr>
<tr><td><code id="pdfpng_+3A_...">...</code></td>
<td>
<p>Further arguments passed to both <code><a href="grDevices.html#topic+pdf">pdf</a></code> and <code><a href="grDevices.html#topic+png">png</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>file paths, invisible
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, March 2017
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+pdf">pdf</a></code>, <code><a href="grDevices.html#topic+png">png</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run:  # excluded from CRAN checks, file opening not wanted
pdfpng(   plot(rnorm(500), type="l")   , file="dummyplot", png=FALSE)

pdfpng({par(bg=8, las=1); plot(cumsum(rnorm(500)), type="l")},
       file="dummyplot", res=100, open=FALSE)
pdfpng({par(bg=8, las=1); plot(cumsum(rnorm(500)), type="l")},
       file="dummyplot", overwrite=c(TRUE,FALSE), open=FALSE)

# Nesting of functions is possible:
a &lt;- list( cumsum(rnorm(2000)), cumsum(rnorm(20)) )
pdfpng(plot(a[[1]]), file="dummyplot", overwrite=TRUE, open=FALSE)
bfun &lt;- function(b) pdfpng(plot(b,type="l"), file="dummyplot", 
                           overwrite=TRUE, open=FALSE)
cfun &lt;- function(c) bfun(c)
bfun(a[[1]])
sapply(a, function(d) cfun(d))


pdfpng(plot(-10:100, log="y"), "dummyplot",overwr=TRUE,png=FALSE, open=FALSE)
pdfpng({plot(1); plot(dummyobject)}, "dummyplot", overwrite=TRUE, 
       png=FALSE, open=FALSE)


unlink("dummyplot.pdf") ; unlink("dummyplot.png") ; unlink("dummyplot_1.png")

## End(Not run)

</code></pre>

<hr>
<h2 id='popleaf'>create leaflet popup box info</h2><span id='topic+popleaf'></span>

<h3>Description</h3>

<p>combine data.frame columns into a leaflet popup-box compatible format
</p>


<h3>Usage</h3>

<pre><code class='language-R'>popleaf(
  df,
  sel = colnames(df),
  truncate = NULL,
  tstring = "[...]",
  exclude_geometry = TRUE,
  na.rm = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="popleaf_+3A_df">df</code></td>
<td>
<p>Data.frame</p>
</td></tr>
<tr><td><code id="popleaf_+3A_sel">sel</code></td>
<td>
<p>Columns to be selected (Names or index or TRUE/FALSE vector).
DEFAULT: colnames(df)</p>
</td></tr>
<tr><td><code id="popleaf_+3A_truncate">truncate</code></td>
<td>
<p>Numeric: number of characters beyond which to truncate columns.
DEFAULT: NULL (no truncation)</p>
</td></tr>
<tr><td><code id="popleaf_+3A_tstring">tstring</code></td>
<td>
<p>Charstring to add at the end if truncated. DEFAULT: &quot;[...]&quot;</p>
</td></tr>
<tr><td><code id="popleaf_+3A_exclude_geometry">exclude_geometry</code></td>
<td>
<p>Remove column with the name &quot;geometry&quot; 
(as in sf objects) from the display? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="popleaf_+3A_na.rm">na.rm</code></td>
<td>
<p>Exclude NA entries from the display? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with character strings
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+paste">paste</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>dat &lt;- data.frame(a=14:16, b=letters[14:16], c=LETTERS[14:16],
                 lat=c(52.58,53.45,52.4), lon=c(6.34,7.23,13.05))
popleaf(dat)
dat$display &lt;- popleaf(dat, 1:4)

## Not run:  # Excluded from CRAN checks
library(leaflet)
leaflet(dat) %&gt;% addTiles() %&gt;% addCircleMarkers(~lon, ~lat, popup=~display)

## End(Not run)

dat[1,1] &lt;- "Very long string I'd rather have truncated"
popleaf(dat, 1:3)
popleaf(dat, 1:3, truncate=16)
popleaf(dat, 1:3, truncate=16, tstring="--")

</code></pre>

<hr>
<h2 id='pretty2'>Truncated pretty breakpoints</h2><span id='topic+pretty2'></span>

<h3>Description</h3>

<p><code><a href="base.html#topic+pretty">pretty</a></code> with no values outside of x range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pretty2(x, n = 5, force = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="pretty2_+3A_x">x</code></td>
<td>
<p>object with numeric values</p>
</td></tr>
<tr><td><code id="pretty2_+3A_n">n</code></td>
<td>
<p>desired number of values in <code><a href="base.html#topic+pretty">pretty</a></code>. DEFAULT: 5</p>
</td></tr>
<tr><td><code id="pretty2_+3A_force">force</code></td>
<td>
<p>Must output length equal n exactly?  DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="pretty2_+3A_...">...</code></td>
<td>
<p>all other arguments in <code><a href="base.html#topic+pretty">pretty</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>calculates <code>pretty(x)</code>, then removes the values that do not lie within
<code><a href="base.html#topic+range">range</a>(x)</code>.<br /> If force=TRUE, range(x) is reduced step by step
in a while loop until the condition is met. This is useful if you want
exactly 2 labels on an <code><a href="graphics.html#topic+axis">axis</a></code>. In order not to get stuck, the
outer values are taken if there are more than n values within range(x).
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Aug 2014
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+pretty">pretty</a></code> , <code><a href="#topic+logVals">logVals</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
k &lt;- c(135, 155, 120, 105, 140, 130, 190, 110)
range(k)
pretty(k)
pretty2(k)

pretty(c(0.2, 0.9), n=2)
pretty2(c(0.2, 0.9), n=2)
pretty2(c(0.2, 0.9), n=2, force=TRUE)

</code></pre>

<hr>
<h2 id='quantileBands'>Quantile bands</h2><span id='topic+quantileBands'></span>

<h3>Description</h3>

<p>Quantile bands with optional smoothing, e.g. for visualizing simulations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileBands(
  mat,
  x = 1:ncol(mat),
  col = rgb(0, 0, 1, alpha = c(0.5, 0.7)),
  add = FALSE,
  main = "Quantile Bands",
  ylab = "",
  xlab = "",
  probs = 0:4/4,
  na.rm = FALSE,
  type = 7,
  smooth = NA,
  medargs = NULL,
  meanargs = NULL,
  txi,
  textargs = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileBands_+3A_mat">mat</code></td>
<td>
<p>Matrix or data.frame with columns of data</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_x">x</code></td>
<td>
<p>X-axis positions for each column. DEFAULT: 1:ncol(mat)</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_col">col</code></td>
<td>
<p>Vector of colors for each quantile group, recycled reversely if necessary. DEFAULT: rgb(0,0,1, alpha=c(0.5, 0.7))</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_add">add</code></td>
<td>
<p>Add to existing plot? Allows to add to highly customized plot. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_main">main</code>, <code id="quantileBands_+3A_xlab">xlab</code>, <code id="quantileBands_+3A_ylab">ylab</code></td>
<td>
<p>plot labels. DEFAULT: &quot;Quantile Bands&quot;, &quot;&quot;</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_probs">probs</code></td>
<td>
<p>Probabilities passed to <code><a href="stats.html#topic+quantile">quantile</a></code>. DEFAULT: 0:4/4</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove NAs before computing <code><a href="stats.html#topic+quantile">quantile</a>s</code>, <code><a href="stats.html#topic+median">median</a></code> and <code><a href="base.html#topic+mean">mean</a></code>? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_type">type</code></td>
<td>
<p>Which of the 9 <code><a href="stats.html#topic+quantile">quantile</a></code> algorithms should be used. DEFAULT: 7</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_smooth">smooth</code></td>
<td>
<p>If(!is.na), <code>width</code> passed to <code><a href="#topic+movAv">movAv</a></code> smoothing quantiles. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_medargs">medargs</code></td>
<td>
<p>List of arguments passed to lines drawing <code><a href="stats.html#topic+median">median</a></code>. Not drawn if NULL. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_meanargs">meanargs</code></td>
<td>
<p>List of arguments passed to lines drawing <code><a href="base.html#topic+mean">mean</a></code>. Not drawn if NULL. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_txi">txi</code></td>
<td>
<p>Text x position index (along columns of mat), recycled if necessary. NA to suppress. INTERNAL DEFAULT: middle of the plot for all.</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_textargs">textargs</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+text">text</a></code>, like col, adj, ... DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="quantileBands_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>, like border, lty, ...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Quantiles of each column, invisible. Smoothed if <code>smooth</code> is given!
</p>


<h3>Note</h3>

<p>This is the first version and is not tested very well yet.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2014
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>, <code><a href="#topic+quantileMean">quantileMean</a></code>, <code><a href="#topic+ciBand">ciBand</a></code>,
<code><a href="graphics.html#topic+polygon">polygon</a></code>, <a href="https://cran.r-project.org/package=fanplot">https://cran.r-project.org/package=fanplot</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
neff &lt;- t(replicate(n=30, sapply(1:400, function(nn) max(rnorm(nn)))   ))
qB &lt;- quantileBands(neff, x=1:400)
qB[,1:9]
quantileBands(neff, smooth=19, meanargs=list(col=2), txi=NA)

library(RColorBrewer)

quantileBands(neff, smooth=35, ylab="max of rnorm(n)",
  xlab="sample size (n)", probs=0:10/10, col=brewer.pal(5,"BuGn"),
  medargs=list(lwd=2), meanargs=list(col=2, lty=1), txi=c(40,50,60),
  main="Maximum is an unsaturated statistic:\n it rises with sample size")

neff2 &lt;- t(replicate(n=50, sapply(1:400, function(nn) mean(rnorm(nn)))   ))
quantileBands(neff2, x=1:400, smooth=35, ylab="mean of rnorm(n)",
  xlab="sample size (n)", probs=0:10/10, col=brewer.pal(5,"BuGn"),
  txi=c(40,50,60), textargs=list(col="yellow"), medargs=list(lwd=2),
  meanargs=list(col=2, lty=1), main="Mean converges to true population mean")

</code></pre>

<hr>
<h2 id='quantileMean'>Average of R's quantile methods</h2><span id='topic+quantileMean'></span>

<h3>Description</h3>

<p>Weighted average of R's quantile methods
</p>


<h3>Usage</h3>

<pre><code class='language-R'>quantileMean(
  x,
  probs = seq(0, 1, 0.25),
  weights = rep(1, 9),
  names = TRUE,
  truncate = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="quantileMean_+3A_x">x</code></td>
<td>
<p>Numeric vector whose sample quantiles are wanted</p>
</td></tr>
<tr><td><code id="quantileMean_+3A_probs">probs</code></td>
<td>
<p>Numeric vector of probabilities with values in [0,1]. DEFAULT: seq(0, 1, 0.25)</p>
</td></tr>
<tr><td><code id="quantileMean_+3A_weights">weights</code></td>
<td>
<p>Numeric vector of length 9 with weight for each <code><a href="stats.html#topic+quantile">quantile</a> method</code>.
Recycled if shorter. DEFAULT: unweighted mean. DEFAULT: rep(1,9)</p>
</td></tr>
<tr><td><code id="quantileMean_+3A_names">names</code></td>
<td>
<p>If TRUE, the resulting vector has a names attribute. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="quantileMean_+3A_truncate">truncate</code></td>
<td>
<p>Number between 0 and 1. Censored quantile: fit to highest values only (truncate lower proportion of x). Probabilities are adjusted accordingly. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="quantileMean_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+quantile">quantile</a></code>, except for type</p>
</td></tr>
</table>


<h3>Details</h3>

<p>weights are internally normalized to sum 1
</p>


<h3>Value</h3>

<p>numeric named vector, as returned by <code><a href="base.html#topic+apply">apply</a></code>
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2014
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+quantile">quantile</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
exDat &lt;- rnorm(30,sd=5)
quantile(exDat, probs=c(0.9, 0.99), type=1)
quantile(exDat, probs=c(0.9, 0.99), type=2)
round( sapply(1:9, function(m) quantile(exDat, probs=0.9, type=m)) , 3)
# and now the unweighted average:
quantileMean(exDat, probs=c(0.9, 0.99))
quantileMean(exDat, probs=0.9)
# say I trust type 2 and 3 especially and want to add a touch of 7:
quantileMean(exDat, probs=c(0.9, 0.99), weights=c(1,5,5,0,1,1,3,1,1))

# quantile sample size dependency simulation:
qbeta(p=0.999, 2, 9) # dist with Q99.9% = 0.62
betaPlot(2, 9, cumulative=FALSE, keeppar=TRUE)
abline(v=qbeta(p=0.999, 2, 9), col=6, lwd=3)
qm &lt;- function(size) quantileMean(rbeta(size, 2,9), probs=0.999, names=FALSE)
n30  &lt;- replicate(n=500, expr=qm(30))
n1000 &lt;- replicate(n=500, expr=qm(1000))
lines(density(n30)) 
lines(density(n1000), col=3) 
# with small sample size, high quantiles are systematically
# underestimated. for Q0.999, n must be &gt; 1000


## Not run: 
# #Excluded from CRAN Checks because of the long computing time

# Parametrical quantiles can avoid sample size dependency!
library2("extremeStat")
library2("pbapply")

dlq &lt;- distLquantile(rbeta(1000, 2,9), probs=0.999, list=TRUE, gpd=FALSE)
plotLquantile(dlq, nbest=10) # 10 distribution functions
select &lt;- c("wei","wak","pe3","gno","gev","gum","gpa","gam")

# median of 10 simulations:
nsim &lt;- 10 # set higher for less noisy image (but more computing time)
qmm &lt;- function(size, truncate=0) median(replicate(n=nsim,
       expr=quantileMean(rbeta(size, 2,9), probs=0.999, names=FALSE, 
                         truncate=truncate)                            ))

pqmm &lt;- function(size, truncate=0) median(replicate(n=nsim,
       expr=mean(distLquantile(rbeta(size, 2,9), probs=0.999, selection=select,
                 progbars=FALSE, time=FALSE, truncate=truncate, gpd=FALSE, 
                 weighted=FALSE, empirical=FALSE, ssquiet=TRUE)[1:8, 1])   ))
                 
n &lt;- round(  logSpaced(min=10, max=1000, n=15, base=1.4, plot=FALSE)  )

medians_emp &lt;- pbsapply(n, qmm)  # medians of regular quantile average
# with truncation, only top 20% used for quantile estimation (censored quant):
medians_emp_trunc &lt;- sapply(n, qmm, truncate=0.8) 
# medians of parametrical quantile estimation
medians_param       &lt;- pbsapply(n, pqmm)              # takes ~60 secs
medians_param_trunc &lt;- pbsapply(n, pqmm, truncate=0.8)

plot(n, medians_emp, type="l", ylim=c(0.45, 0.7), las=1)
abline(h=qbeta(p=0.999, 2, 9), col=6) # real value
lines(n, medians_emp_trunc, col=2) #  don't help!
# In small samples, rare high values, on average, simply do not occur 
lines(n, medians_param, col=4) # overestimated, but not dependent on n
# with truncation, only top 20% used for quantile estimation
lines(n, medians_param_trunc, col="orange", lwd=3) # much better!

## End(Not run)

</code></pre>

<hr>
<h2 id='rainbow2'>Rainbow from blue to red</h2><span id='topic+rainbow2'></span>

<h3>Description</h3>

<p>Reversed <code><a href="grDevices.html#topic+rainbow">rainbow</a></code> with different defaults, resulting in a color vector from blue (good) to red (bad)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rainbow2(n = 10, s = 1, v = 1, start = 0, end = 0.7, alpha = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rainbow2_+3A_n">n</code></td>
<td>
<p>number of colors. DEFAULT: 10</p>
</td></tr>
<tr><td><code id="rainbow2_+3A_s">s</code>, <code id="rainbow2_+3A_v">v</code></td>
<td>
<p>saturation and value as in <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="rainbow2_+3A_start">start</code></td>
<td>
<p>start color. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="rainbow2_+3A_end">end</code></td>
<td>
<p>end color. DEFAULT: 0.7</p>
</td></tr>
<tr><td><code id="rainbow2_+3A_alpha">alpha</code></td>
<td>
<p>transparency. DEFAULT: 1)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A character vector of color names.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seqPal">seqPal</a></code> for a better palette, <code><a href="grDevices.html#topic+rainbow">rainbow</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
plot(1:10, pch=16, cex=2, col=rainbow2(10))

</code></pre>

<hr>
<h2 id='removeSpace'>Remove white spaces from strings</h2><span id='topic+removeSpace'></span>

<h3>Description</h3>

<p>Remove leading and/or trailing white space from character strings
</p>


<h3>Usage</h3>

<pre><code class='language-R'>removeSpace(x, begin = TRUE, end = TRUE, all = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="removeSpace_+3A_x">x</code></td>
<td>
<p>Character string, can be a vector</p>
</td></tr>
<tr><td><code id="removeSpace_+3A_begin">begin</code></td>
<td>
<p>Logical. Remove leading spaces at the beginning of the character string? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="removeSpace_+3A_end">end</code></td>
<td>
<p>Logical. Remove trailing spaces at the end? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="removeSpace_+3A_all">all</code></td>
<td>
<p>Logical. Remove all spaces anywhere in the string? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="removeSpace_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+sub">sub</a></code> or <code><a href="base.html#topic+gsub">gsub</a></code>, like <code>ignore.case, perl, fixed, useBytes</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string (vector)
</p>


<h3>Note</h3>

<p>If all arguments are FALSE, the string is returned unchanged.<br /> Not
extensively tested yet, please mail me any problems...
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2014
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sub">sub</a></code>, <code><a href="base.html#topic+trimws">trimws</a></code> since R 3.2.0 (April 2015)
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
s &lt;- c("space at end     ", "  white at begin", "  both ", " special ^  ")
removeSpace(s)
trimws(s)

# To add space, use:
x &lt;- c("ab","abcde")
format(x)
format(x, justify="centre")
format(x, width=9)

</code></pre>

<hr>
<h2 id='rescale'>shift and scale a vector</h2><span id='topic+rescale'></span>

<h3>Description</h3>

<p>rescale a numeric vector: map values linearly onto a given range
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rescale(x, from = 0, to = 1)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="rescale_+3A_x">x</code></td>
<td>
<p>Numerical vector of values to be mapped to a given range</p>
</td></tr>
<tr><td><code id="rescale_+3A_from">from</code></td>
<td>
<p>output minimum. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="rescale_+3A_to">to</code></td>
<td>
<p>output maximum. DEFAULT: 1</p>
</td></tr>
</table>


<h3>Value</h3>

<p>numeric vector, rescaled onto output range
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2016
</p>


<h3>References</h3>

<p><a href="https://stackoverflow.com/a/18303620">https://stackoverflow.com/a/18303620</a>
</p>


<h3>See Also</h3>

<p><code>scales::rescale</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
rescale(10:15, 135, 200)
rescale(10:15, 200, 135)
rescale(10:15, to=c(1,5))

values &lt;- rbeta(1e3, shape1=4, shape2=35)
hist(rescale(values, 135, 200), breaks=25, col=3)

</code></pre>

<hr>
<h2 id='round0'>Round numbers with leading and trailing zeros</h2><span id='topic+round0'></span>

<h3>Description</h3>

<p>Round numbers and add leading + trailing zeros
</p>


<h3>Usage</h3>

<pre><code class='language-R'>round0(
  x,
  digits = 0,
  pre = 2,
  width = digits + pre + ifelse(digits == 0, 0, 1),
  flag = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="round0_+3A_x">x</code></td>
<td>
<p>Value(s)</p>
</td></tr>
<tr><td><code id="round0_+3A_digits">digits</code></td>
<td>
<p>Number of digits (after decimal separator) to keep. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="round0_+3A_pre">pre</code></td>
<td>
<p>Minimum number of characters before the decimal separator. DEFAULT: 2</p>
</td></tr>
<tr><td><code id="round0_+3A_width">width</code></td>
<td>
<p>Total width (number of characters including dot).
DEFAULT: digits+pre (+1 if needed)</p>
</td></tr>
<tr><td><code id="round0_+3A_flag">flag</code></td>
<td>
<p>Flag. Could be &quot;&quot; for spaces. DEFAULT: &quot;0&quot;</p>
</td></tr>
<tr><td><code id="round0_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+formatC">formatC</a></code>,
except for &quot;format&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string vector
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jun 2017
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+formatC">formatC</a></code>, <code><a href="base.html#topic+sprintf">sprintf</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>round0( pi*10^(-3:5), 2)
stopifnot(round0(17.3, 2) == "17.30")
round0(7.3)
round0(c(7.3,777.1234), 2)
round0(c(0.2,7.3,12.8), 2, pre=1)
round0(c(0.2,7.3,12.8), 1, pre=3, flag="") # spaces instead of zeros

</code></pre>

<hr>
<h2 id='roundedRect'>Rectangles with rounded corners</h2><span id='topic+roundedRect'></span>

<h3>Description</h3>

<p>Draw <a href="graphics.html#topic+rect">rect</a>angles with rounded corners via <code><a href="graphics.html#topic+polygon">polygon</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>roundedRect(
  xleft,
  ybottom,
  xright,
  ytop,
  rounding = 0.25,
  bothsame = TRUE,
  aspcorrect = bothsame,
  devcorrect = bothsame,
  corfactor = 1.3,
  factorpoints = FALSE,
  corners = 1:4,
  npoints = 200,
  plot = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="roundedRect_+3A_xleft">xleft</code>, <code id="roundedRect_+3A_ybottom">ybottom</code>, <code id="roundedRect_+3A_xright">xright</code>, <code id="roundedRect_+3A_ytop">ytop</code></td>
<td>
<p>Single numbers with the outer end locations
of the rectangle.</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_rounding">rounding</code></td>
<td>
<p>Proportion of the box to round. Recommended to be between
0 and 1. DEFAULT: 0.25</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_bothsame">bothsame</code></td>
<td>
<p>Set the visual amount of rounding to the same in
both x and y direction? If TRUE (the default),
the proportion relates to the shortest rectangle side.
This is visually correct only if <code>aspcorrect</code>
and <code>devcorrect</code> are both left at TRUE and 
<code>corfactor</code> is set correctly. bothsame DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_aspcorrect">aspcorrect</code></td>
<td>
<p>Correct for graph aspect ratio? DEFAULT: <code>bothsame</code></p>
</td></tr>
<tr><td><code id="roundedRect_+3A_devcorrect">devcorrect</code></td>
<td>
<p>Correct for device aspect ratio? DEFAULT: <code>bothsame</code></p>
</td></tr>
<tr><td><code id="roundedRect_+3A_corfactor">corfactor</code></td>
<td>
<p>Aspect correction factor. I found this by trial and error.
More elegant solutions are welcome!
DEFAULT 1.3, works well for 7x5 (width x height) graphs</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_factorpoints">factorpoints</code></td>
<td>
<p>Logical: plot points at inset locations to determine the
exact value for <code>corfactor</code> by measuring on screen.
DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_corners">corners</code></td>
<td>
<p>Vector with integers indicating which corners to round.
Starting bottom left, going clockwise. Zero to suppress
rounding. DEFAULT: 1:4</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_npoints">npoints</code></td>
<td>
<p>Total number of vertices for the corners. DEFAULT: 200</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_plot">plot</code></td>
<td>
<p>Logical. Plot the polygon? FALSE to only compute coordinates.
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="roundedRect_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+polygon">polygon</a></code>,
like col, border, ...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Final coordinates, invisible
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Dec 2017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+textField">textField</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:10)  ;  rect(4,2,7,8, border=8)
roundedRect(4,2,7,8, rounding=0.1)
roundedRect(4,2,7,8, rounding=0.25) # default
roundedRect(4,2,7,8, rounding=0.5)
roundedRect(4,2,7,8, rounding=-0.1, border="red")
roundedRect(4,2,7,8, rounding=1.1, border="blue")
roundedRect(2,2,8,4, rounding=0.5) # in long boxes, 0.5 is max
roundedRect(2,2,8,4, rounding=0.5, bothsame=FALSE, corfactor=1, border=3)


plot(1:10)  ;  rect(4,2,7,8, border=8)
roundedRect(4,2,7,8, corners=c(2,4))

plot(1:10, asp=1)  ;  rect(4,2,7,8, border=8)
roundedRect(4,2,7,8)
roundedRect(4,2,7,8, aspcorrect=FALSE, border="red") # results depend on asp

plot(1:10, asp=1.5)  ;  rect(4,2,7,8, border=8)
roundedRect(4,2,7,8)
roundedRect(4,2,7,8, aspcorrect=FALSE, border="red") # results depend on asp

plot(1:10, asp=1)  ;  rect(4,2,7,8, border=8)
roundedRect(4,2,7,8) # difference only visible if rect is clearly not a square:
roundedRect(4,2,7,8, bothsame=FALSE, border="red")
roundedRect(4,2,7,8, bothsame=FALSE, aspcorrect=TRUE, border="blue")

## Not run:  # aspect correction factor determination
rrtest &lt;- function(...) roundedRect(10,0.5, 35,15, border=2, factorpoints=TRUE)
pdfpng({plot(1:40                     ); rrtest();
        plot(1:40, ylim=c(0,15)       ); rrtest();
        plot(1:40, ylim=c(0,15), asp=1); rrtest();
        roundedRect(2,0, 8,15, factorpoints=TRUE);
        roundedRect(15,10, 25,16, npoints=200)}, 
       file="dummytest", png=F, overwrite=T)

## End(Not run)

</code></pre>

<hr>
<h2 id='runAxis'>Label axis with typical running times</h2><span id='topic+runAxis'></span>

<h3>Description</h3>

<p>Label a numerical axis (in minutes) with time units that are typical for running times (10 sec intervals)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runAxis(t = 3 * 60, int1 = 10, int2 = 5, side = 1, linarg = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runAxis_+3A_t">t</code></td>
<td>
<p>Maximum time in minutes</p>
</td></tr>
<tr><td><code id="runAxis_+3A_int1">int1</code></td>
<td>
<p>Primary interval (for labels)</p>
</td></tr>
<tr><td><code id="runAxis_+3A_int2">int2</code></td>
<td>
<p>Secondary interval (for lines)</p>
</td></tr>
<tr><td><code id="runAxis_+3A_side">side</code></td>
<td>
<p>Side of the plot to draw <code><a href="graphics.html#topic+axis">axis</a></code> (1,2,3,4 = bottom, left, top, right)</p>
</td></tr>
<tr><td><code id="runAxis_+3A_linarg">linarg</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+abline">abline</a></code></p>
</td></tr>
<tr><td><code id="runAxis_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+axis">axis</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>List with the positions and labels
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jun 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+logAxis">logAxis</a></code>, <code><a href="#topic+monthAxis">monthAxis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(1:200, xaxt="n")
runAxis(t=200, int1=20, int2=10)

</code></pre>

<hr>
<h2 id='runRversions'>Run code in several R versions</h2><span id='topic+runRversions'></span>

<h3>Description</h3>

<p>Run code / script in several local R versions
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runRversions(
  scpt = NULL,
  expr = NULL,
  path = "C:/Program Files/R/",
  vrns = dir(path, pattern = "R-"),
  exec = "/bin/Rscript.exe"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runRversions_+3A_scpt">scpt</code></td>
<td>
<p>File path to script. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="runRversions_+3A_expr">expr</code></td>
<td>
<p>Expression to be run. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="runRversions_+3A_path">path</code></td>
<td>
<p>Location of R versions. DEFAULT: &quot;C:/Program Files/R/&quot;</p>
</td></tr>
<tr><td><code id="runRversions_+3A_vrns">vrns</code></td>
<td>
<p>R Versions at path. DEFAULT: dir(path,pattern=&quot;R-&quot;)</p>
</td></tr>
<tr><td><code id="runRversions_+3A_exec">exec</code></td>
<td>
<p>Local path to Rscript. DEFAULT: &quot;/bin/Rscript.exe&quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Results from each run
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2022
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+help">help</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>tfile &lt;- tempfile(fileext=".R")
cat(
'trace &lt;- function() paste(sapply(sys.calls(),function(x)
                     strsplit(deparse(x),"(", fixed=TRUE)[[1]][1]), collapse=" -&gt; ")
lower &lt;- function(a) {message(trace(), " - msg with ", a+10); a}
upper &lt;- function(b) lower(b+5)
upper(3)', file=tfile)

# Don't actually run with example testing
# out &lt;- source(tfile) ; out$value # message + output 8
# runRversions(tfile)
# runRversions(expr=5+7)

</code></pre>

<hr>
<h2 id='runTime'>runnning time conversion</h2><span id='topic+runTime'></span>

<h3>Description</h3>

<p>display runnning times in useful units
</p>


<h3>Usage</h3>

<pre><code class='language-R'>runTime(d, t)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="runTime_+3A_d">d</code></td>
<td>
<p>Numerical value: distance [km]</p>
</td></tr>
<tr><td><code id="runTime_+3A_t">t</code></td>
<td>
<p>Charstring: time [&quot;MM:SS&quot;]</p>
</td></tr>
</table>


<h3>Value</h3>

<p>list with time elements
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jun 2020
</p>


<h3>See Also</h3>

<p><code><a href="#topic+runAxis">runAxis</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>runTime(d=3.6, t="15:40")
runTime(d=3.6, t="15:10")
runTime(d=3.6, t="14:50")

</code></pre>

<hr>
<h2 id='seasonality'>Seasonality analysis</h2><span id='topic+seasonality'></span>

<h3>Description</h3>

<p>Examine time series for seasonality of high (low) values
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seasonality(
  dates,
  values,
  data,
  drange = NA,
  vrange = NA,
  shift = 0,
  janline = TRUE,
  hlines = FALSE,
  nmax = 0,
  maxargs = NULL,
  plot = 1,
  add = FALSE,
  nmin = 100,
  probs = c(0, 25, 50, 75, 95, 99.9)/100,
  width = 3,
  text = TRUE,
  texti = seq(200, 20, length.out = length(probs)),
  textargs = NULL,
  months = substr(month.abb, 1, 1),
  slab = "Month",
  tlab = "Year",
  vlab = NA,
  xlim = NA,
  ylim = NA,
  xaxs = NA,
  yaxs = NA,
  main = "Seasonality",
  adj = 0.2,
  mar = c(3, 3, 4, 1),
  mgp = c(1.7, 0.7, 0),
  keeppar = TRUE,
  legend = TRUE,
  legargs = NULL,
  returnall = FALSE,
  quiet = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seasonality_+3A_dates">dates</code></td>
<td>
<p>Dates in ascending order.
Can be character strings or <code><a href="base.html#topic+strptime">strptime</a></code> results,
as accepted (and coerced) by <code><a href="base.html#topic+as.Date">as.Date</a></code></p>
</td></tr>
<tr><td><code id="seasonality_+3A_values">values</code></td>
<td>
<p>Values to be mapped in color with <code><a href="#topic+colPoints">colPoints</a></code></p>
</td></tr>
<tr><td><code id="seasonality_+3A_data">data</code></td>
<td>
<p>Optional: data.frame with the column names as given by dates and values</p>
</td></tr>
<tr><td><code id="seasonality_+3A_drange">drange</code></td>
<td>
<p>Optional date range (analogous to xlim), can be a vector like
<code>dates</code>. Can also be numerical years, in which case
&quot;-01-01&quot; is appended. DEFAULT: NA (computed from <code>dates</code> internally)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_vrange">vrange</code></td>
<td>
<p>Optional value range (analogous to ylim), can be a vector like
<code>values</code>. DEFAULT: NA (computed from <code>values</code> internally)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_shift">shift</code></td>
<td>
<p>Number of days to move the year-break to.
E.g. shift=61 for German hydrological year (Nov to Oct). DEFAULT: 0</p>
</td></tr>
<tr><td><code id="seasonality_+3A_janline">janline</code></td>
<td>
<p>Logical: Should horizontal line be plotted at
January 1st if <code>shift!=0</code>? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_hlines">hlines</code></td>
<td>
<p>Draw horizontal background lines in plot 1? Either FALSE (the default),
TRUE to draw gray background lines at each month start,
or a list of arguments passed to <code><a href="graphics.html#topic+abline">abline</a></code> with
<code><a href="#topic+owa">owa</a></code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_nmax">nmax</code></td>
<td>
<p>Number of annual maxima to be marked, plotted and returned.
Currently, only 0 and 1 are implemented. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="seasonality_+3A_maxargs">maxargs</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+lines">lines</a></code> for annual maxima,
e.g. <code>maxargs=list(type="l", col="red", lty=3)</code>.
DEFAULT: NULL (several internal defaults are used, but can be overridden)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_plot">plot</code></td>
<td>
<p>Integer specifying the type of plot.
Can be a vector to produce several plots. <br />
0: none, only return the data.frame with annual maxima. <br />
1: color coded doy (day of the year) over year (the default). <br />
2: Color coded spiral graph with <code><a href="#topic+spiralDate">spiralDate</a></code>. <br />
3: Spaghetti line plot with discharge over doy, one line per year. <br />
4: <code>probs</code> <code><a href="#topic+quantileMean">quantileMean</a></code> over doy, with optional
aggregation window (<code>width</code>) around each doy. <br />
5: Annmax over time for crude trend analysis. <br />
DEFAULT: 1</p>
</td></tr>
<tr><td><code id="seasonality_+3A_add">add</code></td>
<td>
<p>Logical. Add to existing plot? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_nmin">nmin</code></td>
<td>
<p>Minimum number of values that must be present per (hydrological)
year to be plotted in plot type 5. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="seasonality_+3A_probs">probs</code></td>
<td>
<p>Probabilities passed to <code><a href="#topic+quantileMean">quantileMean</a></code> for plot=4.
DEFAULT: c(0,25,50,75,95,99)/100</p>
</td></tr>
<tr><td><code id="seasonality_+3A_width">width</code></td>
<td>
<p>Numeric: window width for plot=4. Used as sd in gaussian weighting.
Support (number of values around a DOY passed to
quantile function at least once) is ca 4.9*width.
The value at doy itself is used 10 times.
Larger values of width require more computing time.
DEFAULT: 3</p>
</td></tr>
<tr><td><code id="seasonality_+3A_text">text</code></td>
<td>
<p>Logical. Call <code><a href="#topic+textField">textField</a></code> if plot=4? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_texti">texti</code></td>
<td>
<p>Numerical (vector): indices at which to label the lines.
DEFAULT: seq(200,20,length.out=length(probs))</p>
</td></tr>
<tr><td><code id="seasonality_+3A_textargs">textargs</code></td>
<td>
<p>List of arguments passed to <code><a href="#topic+textField">textField</a></code> for plot=4.
DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="seasonality_+3A_months">months</code></td>
<td>
<p>Labels for the months. DEFAULT: J,F,M,A,M,J,J,A,S,O,N,D</p>
</td></tr>
<tr><td><code id="seasonality_+3A_slab">slab</code>, <code id="seasonality_+3A_tlab">tlab</code>, <code id="seasonality_+3A_vlab">vlab</code></td>
<td>
<p>Labels for the <b>s</b>eason, <b>t</b>ime (year) and <b>v</b>alues
used on the axes and title of <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>.
DEFAULT: &quot;Month&quot;, &quot;Year&quot;, substitute(values)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_xlim">xlim</code>, <code id="seasonality_+3A_ylim">ylim</code></td>
<td>
<p>Limits of x and y axis. DEFAULT: NA (specified internally per plot type)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_xaxs">xaxs</code>, <code id="seasonality_+3A_yaxs">yaxs</code></td>
<td>
<p>x and y Axis style, see <code><a href="graphics.html#topic+par">par</a></code>.
Use &quot;r&quot; for regular 4% expansion, &quot;i&quot; for in range only.
DEFAULT: NA (specified internally per plot type)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_main">main</code>, <code id="seasonality_+3A_adj">adj</code></td>
<td>
<p>Graph title and offset to the left
(<code>adj</code> passed to <code><a href="graphics.html#topic+title">title</a></code>).
DEFAULT: &quot;Seasonality&quot;, 0.2</p>
</td></tr>
<tr><td><code id="seasonality_+3A_mar">mar</code>, <code id="seasonality_+3A_mgp">mgp</code></td>
<td>
<p>Parameters specifying plot margin size and labels placement.
DEFAULT: c(3,3,4,1), c(1.7,0.7,0) (Changed for plot 3:5 if not given)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_keeppar">keeppar</code></td>
<td>
<p>Logical: Keep the margin parameters? If FALSE, they are reset
to the previous values. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_legend">legend</code></td>
<td>
<p>Logical. Should a legend be drawn? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_legargs">legargs</code></td>
<td>
<p>List of arguments passed as <code>legargs</code> to <code><a href="#topic+colPoints">colPoints</a></code>.
DEFAULT: NULL (internally, plots 3 and 5 have density=F as default)</p>
</td></tr>
<tr><td><code id="seasonality_+3A_returnall">returnall</code></td>
<td>
<p>Logical: return all relevant output as a list instead of only
annmax data.frame? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress progress stuff and colPoints messages?
DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seasonality_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+colPoints">colPoints</a></code> like
pch, main, xaxs, but not Range (use <code>vrange</code>).
Passed to <code><a href="#topic+spiralDate">spiralDate</a></code> if <code>plot=2</code>,
like add, format, lines.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The output is always invisible, don't forget to assign it.
If returnall=FALSE: Data.frame with <code>year</code>, <code>n</code>umber of nonNA entries,
<code>max</code> value + <code>doy</code> of annual maxima.
Please note that the column year does not match the calendrical year
if <code>shift!=0</code>. <br />
if returnall=TRUE: a list with <code>annmax</code> (df from above) as well as: <br />
<code>data</code>: data.frame(doy, values, year) and optionally: <br />
<code>plot1, plot3, plot4, plot5</code>: outputs from <code><a href="#topic+colPoints">colPoints</a></code> <br />
<code>plot2</code>: output list from <code><a href="#topic+spiralDate">spiralDate</a></code> <br />
and other elements depending on plot type, <code>like data3, data4, probs4, width4</code>.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jul-Oct 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spiralDate">spiralDate</a></code>, <code><a href="#topic+colPoints">colPoints</a></code>,
<a href="https://waterdata.usgs.gov/nwis">https://waterdata.usgs.gov/nwis</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># browseURL("https://nrfa.ceh.ac.uk/data/station/meanflow/39072")
qfile &lt;- system.file("extdata/discharge39072.csv", package="berryFunctions")
Q &lt;- read.table(qfile, skip=19, header=TRUE, sep=",", fill=TRUE)[,1:2]
rm(qfile)
colnames(Q) &lt;- c("date","discharge")
Q$date &lt;- as.Date(Q$date)
Q$discharge[450:581] &lt;- NA
plot(Q, type="l")
seas &lt;- seasonality(date, discharge, data=Q, shift=100, main="NRFA: Thames\nRoyal Windsor Park")
head(seas)
# notice how n for nonmissing values is lower in the first hydrological year,
# which includes parts of two consecutive calendarical years.

# Be careful with your interpretation. This looks normal up to 2007, but then BAM!:
seasonality(date, discharge, data=Q[Q$date&lt;as.Date("2007-07-15"),], plot=3, shift=100, nmax=1)
seasonality(date, discharge, data=Q[Q$date&lt;as.Date("2007-08-15"),], plot=3, shift=100, nmax=1)

# Shift is important. You don't want to have this event included twice:
seasonality(date, discharge, data=Q[850:950,], plot=3, nmax=1, quiet=TRUE, shift=100)

## Not run:  # excluded from CRAN checks because it is slow
seasonality(date, discharge, data=Q, plot=2) # most floods in winter
seasonality(date, discharge, data=Q, plot=5, vlab="Dude, look at annual max Q!")
seasonality(date, discharge, data=Q, plot=5, shift=100)
s &lt;- seasonality(date, discharge, data=Q, plot=4, shift=100, width=3, returnall=TRUE)
str(s, max.lev=1)

seasonality(date, discharge, data=Q, plot=3:4, add=0:1, ylim=lim0(400), shift=117)
seasonality(date, discharge, data=Q, plot=4, add=TRUE, lwd=3, shift=117, width=3)

## End(Not run)

## Not run: 
dev.new(noRStudioGD=TRUE, record=TRUE)     # large graph on 2nd monitor
par(mfrow=c(2,2))
seasonality(date, discharge, data=Q, plot=(1:5)[-4], shift=100)
seasonality(date, discharge, data=Q, plot=(1:5)[-4], lwd=2)
seasonality(date, discharge, data=Q, plot=(1:5)[-4], nmax=1, shift=100)
seasonality(date, discharge, data=Q, plot=(1:5)[-4], col=divPal(100, ryb=TRUE))
dev.off()

## End(Not run)

</code></pre>

<hr>
<h2 id='seqPal'>Sequential color palette</h2><span id='topic+seqPal'></span>

<h3>Description</h3>

<p>Sequential color palette from yellow to blue or custom colors.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seqPal(
  n = 100,
  reverse = FALSE,
  alpha = 1,
  extr = FALSE,
  yb = FALSE,
  yr = FALSE,
  gb = FALSE,
  b = FALSE,
  colors = NULL,
  logbase = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seqPal_+3A_n">n</code></td>
<td>
<p>Number of colors. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="seqPal_+3A_reverse">reverse</code></td>
<td>
<p>Reverse colors? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_alpha">alpha</code></td>
<td>
<p>Transparency (0=transparent, 1=fully colored). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="seqPal_+3A_extr">extr</code></td>
<td>
<p>Should colors span possible range more extremely?
If TRUE, it has very light yellow and very dark blue values included,
using the result from <code>RColorBrewer::brewer.pal(9, "YlGnBu")</code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_yb">yb</code></td>
<td>
<p>Should colors be in yellow-blue instead of the internal (nice) default? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_yr">yr</code></td>
<td>
<p>Should colors be in yellow-red instead of the default? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_gb">gb</code></td>
<td>
<p>Should colors be in green-blue instead of the default? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_b">b</code></td>
<td>
<p>Should colors be in an increasingly saturated blue? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="seqPal_+3A_colors">colors</code></td>
<td>
<p>If not NULL, a color vector used in <code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="seqPal_+3A_logbase">logbase</code></td>
<td>
<p>If <code>!=1</code>, this is passed to <code><a href="#topic+classify">classify</a></code> and <code><a href="#topic+logSpaced">logSpaced</a></code>. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="seqPal_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="grDevices.html#topic+colorRamp">colorRamp</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string vector with color names
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Jan 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+showPal">showPal</a></code>, <code><a href="#topic+divPal">divPal</a></code>, <code><a href="#topic+catPal">catPal</a></code>, <code><a href="#topic+addAlpha">addAlpha</a></code>,
<code><a href="grDevices.html#topic+colorRampPalette">colorRampPalette</a></code>, package <code>RColorBrewer</code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>plot(rep(1,12),  pch=16, cex=5, col=seqPal(12), xaxt="n")
showPal()

# nonlinear color scale (use colPoints + see classify for more options):
v &lt;- rescale(volcano^30)
image(v, col=seqPal(1000), asp=1);  colPointsLegend(v, nbins=1000)
image(v, col=seqPal(1000, logbase=1.007), asp=1)
colPointsLegend(v, col=seqPal(1000, logbase=1.007))

plot(    rep(1, 1000), pch=15, cex=3, col=seqPal(1000), ylim=c(0.99, 1.01), ylab="logbase", las=1)
for(b in seq(0.99, 1.01, len=30))
    points(rep(b, 1000), pch=15, cex=1, col=seqPal(1000, logbase=b))

</code></pre>

<hr>
<h2 id='seqR'>seq with a range argument</h2><span id='topic+seqR'></span>

<h3>Description</h3>

<p>sequence given by range or vector of values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>seqR(range, from = NA, to = NA, extend = 0, warn = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="seqR_+3A_range">range</code></td>
<td>
<p>vector with 2 values (1st taken as <code>from</code>, 2nd as <code>to</code>) 
or more (the result is then always ascending).</p>
</td></tr>
<tr><td><code id="seqR_+3A_from">from</code></td>
<td>
<p>start value of sequence. DEFAULT: NA (determined from range)</p>
</td></tr>
<tr><td><code id="seqR_+3A_to">to</code></td>
<td>
<p>end value of sequence. DEFAULT: NA (determined from range)</p>
</td></tr>
<tr><td><code id="seqR_+3A_extend">extend</code></td>
<td>
<p>Factor <em>f</em> passed to <code><a href="grDevices.html#topic+extendrange">extendrange</a></code>. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="seqR_+3A_warn">warn</code></td>
<td>
<p>Logical: warn about non-numeric classes? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="seqR_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="base.html#topic+seq">seq</a></code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Numeric vector.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2014
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+seq">seq</a></code>, <code><a href="base.html#topic+range">range</a></code>,
<a href="https://web.archive.org/web/20190107005108/https://r.789695.n4.nabble.com/seq-range-argument-td4684627.html">https://web.archive.org/web/20190107005108/https://r.789695.n4.nabble.com/seq-range-argument-td4684627.html</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
seqR(range=c(12,6), by=-2)
m &lt;- c(41, 12, 38, 29, 50, 39, 22)
seqR(m, len=6)
# Takes min and max of range if the vector has more than two elements.

seqR(range=c(12,6), by=-2, extend=0.1)
# internaly calls extendrange with f=extend

</code></pre>

<hr>
<h2 id='showPal'>show color palettes</h2><span id='topic+showPal'></span>

<h3>Description</h3>

<p>Plot examples of the sequential and diverging color palettes in this package.
Do not use <code>rainbow</code>: <a href="https://eagereyes.org/basics/rainbow-color-map">https://eagereyes.org/basics/rainbow-color-map</a>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>showPal(cex = 4, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="showPal_+3A_cex">cex</code></td>
<td>
<p>Character EXpansion size (width of color bar). DEFAULT: 4</p>
</td></tr>
<tr><td><code id="showPal_+3A_...">...</code></td>
<td>
<p>Arguments passed to <code><a href="graphics.html#topic+par">par</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Apr 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seqPal">seqPal</a></code>, <code><a href="#topic+divPal">divPal</a></code>, <code><a href="#topic+catPal">catPal</a></code>, 
package <code>RColorBrewer</code>, 
<a href="https://blog.datawrapper.de/which-color-scale-to-use-in-data-vis/">https://blog.datawrapper.de/which-color-scale-to-use-in-data-vis/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>showPal()
</code></pre>

<hr>
<h2 id='smallPlot'>Inset small plot within figure</h2><span id='topic+smallPlot'></span>

<h3>Description</h3>

<p>multipanel-compatible inset plot with margins, background and border
Adding points after <code>smallPlot</code> is called may be
incorrect if the original function messes with the graph margins,
see the note in <code><a href="#topic+colPointsLegend">colPointsLegend</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smallPlot(
  expr,
  x1 = 0.05,
  x2 = 0.7,
  y1 = 0.5,
  y2 = 1,
  outer = FALSE,
  xpd = NA,
  mar = c(3, 3, 1, 1),
  mgp = c(1.8, 0.8, 0),
  bg = par("bg"),
  border = par("fg"),
  las = 1,
  resetfocus = TRUE,
  colwise = FALSE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smallPlot_+3A_expr">expr</code></td>
<td>
<p>expression creating a plot. Can be code within curly braces.</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_x1">x1</code>, <code id="smallPlot_+3A_x2">x2</code>, <code id="smallPlot_+3A_y1">y1</code>, <code id="smallPlot_+3A_y2">y2</code></td>
<td>
<p>Position of small plot, relative to current figure region [0:1].
DEFAULT: x: 0.05-0.7, y: 0.5-1</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_outer">outer</code></td>
<td>
<p>Logical. Should inset plot be placed in the device outer margin region
instead of relative to the current figure region?
Useful in multipanel plots with par(oma). <code>outer</code> here does not
have exactly the same meaning as in <code><a href="graphics.html#topic+title">title</a></code>. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_xpd">xpd</code></td>
<td>
<p>Plotting and notation clipped to plot region (if xpd=FALSE),
figure region (TRUE) or device region (xpd=NA). DEFAULT: NA</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_mar">mar</code></td>
<td>
<p>Margin vector in (approximate) number of lines. It is internally
multiplied with <code><a href="graphics.html#topic+strheight">strheight</a></code> to convert it to relative units [0:1],
thus the behaviour is a bit different from <code><a href="graphics.html#topic+par">par</a>(mar)</code>.
It's recycled, so you can use <code>mar=0</code>. DEFAULT: c(3,3,1,1)</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_mgp">mgp</code></td>
<td>
<p>MarGinPlacement: distance of xlab/ylab, numbers and line from plot margin,
as in <code><a href="graphics.html#topic+par">par</a></code>, but with different defaults. DEFAULT: c(1.8, 0.8, 0)</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_bg">bg</code></td>
<td>
<p>Background. DEFAULT: par(&quot;bg&quot;)</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_border">border</code></td>
<td>
<p>Border around inset plot. DEFAULT: par(&quot;fg&quot;)</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle. DEFAULT: 1</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_resetfocus">resetfocus</code></td>
<td>
<p>Reset focus to original plot? Specifies where further
low level plot commands are directed to. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_colwise">colwise</code></td>
<td>
<p>Logical: Continue next plot below current plot?
If you had <code>par(mfcol=...)</code>, you must use <code>colwise=TRUE</code>,
otherwise the next plot will be to the right of the current plot
(as with <code>par(mfrow=...)</code>). DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="smallPlot_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+par">par</a></code>.
This may mess things up - please tell me for which arguments!
You can do <code>par(las=1, las=2)</code> (the last will be set), so
<code>smallPlot(plot(1), new=FALSE)</code> works, but may not yield the intended result.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>parameters of small plot, invisible.
</p>


<h3>Warning</h3>

<p>setting mai etc does not work!
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2014-2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+colPointsLegend">colPointsLegend</a></code> for an example of usage.
<code>subplot</code> in the archived <a href="https://cran.r-project.org/package=TeachingDemos">TeachingDemos</a> package and <code><a href="ade4.html#topic+add.scatter">add.scatter</a></code>
for alternative solutions to this problem that do not set margins.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Basic usage:
op &lt;- par(no.readonly=TRUE) # original parameters
plot(1:10)
smallPlot(plot(5:1, ylab="Yo man!"), bg="lightgreen" )
smallPlot(plot(5:1), x1=0.5,x2=1, y1=0.3,y2=0.6, bg="yellow", yaxt="n")
# if R warns "figure margins too large", try dragging the plot viewer bigger

# select focus for further add-on's:
points(2, 2, pch="+", cex=2, col=2) # main window
smallPlot( plot(5:1), bg="lightblue", resetfocus=FALSE )
mtext("dude")
points(2, 2, pch="+", cex=2, col=2) # smallPlot window
par(op)

# More par settings:
plot(1:10)
smallPlot( plot(50:1), bg=6, mai=c(0.2, 0.3, 0.1, 0.1)) # screws up
smallPlot( plot(5:1), bg=8, ann=FALSE)
smallPlot(plot(10:50), bg="transparent") # old plot is kept

# complex graphics in code chunks:
plot(1:100)
smallPlot( {plot(5:1, ylab="Rocky label"); lines(c(2,4,3));
            legend("topright", "BerryRocks!", lwd=3)    }, bg="white")


# multiple figure situations
par(op)
par(mfcol=c(3,4))
plot(1:10)
plot(1:10)
smallPlot(plot(5:1), bg="lightblue")
plot(1:10)
smallPlot(plot(5:1), bg="bisque", colwise=TRUE) # if mfcol (not mfrow) was set
plot(1:10)

# Outer margins (e.g. to add legends to multi-panel plots)
par(op)
par(mfrow=c(3,2), oma=c(0,5,0,0), mar=c(0,0,1,0)+0.5)
for(i in 0:5*4) image(volcano+i, zlim=c(90,200), xaxt="n", yaxt="n",
                      main=paste("volcano +", i))
smallPlot(plot(1:10), x1=0,x2=0.25, y1=0.5,y2=1, bg="green", mar=1)
smallPlot(plot(1:10), x1=0,x2=0.25, y1=0.5,y2=1, bg="green", mar=1, outer=TRUE)
colPointsLegend(90:200, horizontal=FALSE, x1=0, col=heat.colors(12), outer=TRUE,
               labelpos=5, density=FALSE, title="", cex=2, lines=FALSE)


# Further testing with mfrow and mfcol
par(op)
old_plt &lt;- par("plt")
par(mfcol=c(3,4))
new_plt &lt;- par("plt")
plot(1:10)
plot(1:10)
smallPlot(plot(5:1), bg="lightblue", colwise=TRUE)
points(3, 2, pch="+", cex=2, col=2)
plot(1:10) # canot keep mfcol, only mfrow, if colwise is left FALSE.
smallPlot(plot(5:1), bg="bisque", resetfocus=FALSE )
points(3, 2, pch="+", cex=2, col=2)
plot(1:10) # in smallPlot space
par(plt=old_plt)
plot(1:10) # too large
smallPlot(plot(5:1), bg="palegreen")
points(3, 2, pch="+", cex=2, col=2, xpd=NA) # not drawn with default xpd
par(plt=new_plt)
plot(1:10) # canot keep mfcol, only mfrow, if colwise is left FALSE.
smallPlot(plot(5:1), bg="yellow")
points(3, 2, pch="+", cex=2, col=2)   # everything back to normal
par(op)

# if layout is used instead of par(mfrow), it is difficult to add graphs
# after using smallPlot
lay &lt;- matrix(c(1,1,1,1,2,2,3,3,2,2,3,3,4,4,5,5), ncol=4)
layout.show(layout(lay))
layout(lay)
plot(1:10)
plot(1:10)
smallPlot(plot(1:10), mar=c(1,3,1,0), x1=0,x2=0.2, y1=0.2,y2=0.8, bg=4, outer=TRUE)
# plot(1:10) # now in a weird location (par("mfrow") is 4x4 after layout)

</code></pre>

<hr>
<h2 id='smoothLines'>draw smoothed lines</h2><span id='topic+smoothLines'></span>

<h3>Description</h3>

<p>draw smoothed lines with an n-level partially transparent haze
</p>


<h3>Usage</h3>

<pre><code class='language-R'>smoothLines(x, y, lwd = 1, col = 1, n = 5, alpha = 0.1, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="smoothLines_+3A_x">x</code></td>
<td>
<p>numerical. x-coordinates. x can be a matrix, then the y coordinates are taken from the second column</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_y">y</code></td>
<td>
<p>numerical. y-coordinates</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_lwd">lwd</code></td>
<td>
<p>single integer. line width</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_col">col</code></td>
<td>
<p>color. DEFAULT: 1 (black)</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_n">n</code></td>
<td>
<p>single integer. number of transparent lines overlayed with sinking line widths. DEFAULT: 5</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_alpha">alpha</code></td>
<td>
<p>Transparency of color. DEFAULT: 0.1 (very transparent)</p>
</td></tr>
<tr><td><code id="smoothLines_+3A_...">...</code></td>
<td>
<p>further arguments as in <code><a href="graphics.html#topic+lines">lines</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>none, draws lines
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, 2011/2012
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+lines">lines</a></code>, <code><a href="grDevices.html#topic+col2rgb">col2rgb</a></code>, <code><a href="grDevices.html#topic+rgb">rgb</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
x &lt;- 1:5  ; y &lt;- c(0.31, 0.45, 0.84, 0.43, 0.25)
plot(x,y)
smoothLines(x,y)
#png("smoothLines.png")
par(mar=c(2,2,2,0)+.5)
plot(1:100, las=1, type="n", main="usage of smoothLines(x,y, lwd, col, n, alpha ...)")
abline(h=0:10*10, v=0:10*10, col=6); box()
for(i in 0:9) { smoothLines(x=c(0,10,25,35), y=c(i*10, i*10, i*10+12, i*10+7), lwd=i)
                text(25, i*10+5, paste("n=5,lwd=", i, sep="")) }
for(i in 0:9) { smoothLines(x=c(40,50,65,75), y=c(i*10, i*10, i*10+12, i*10+7), n=i)
                text(65, i*10+5, paste("n=",i,",lwd=1", sep="")) }
for(i in 0:9/20) { smoothLines(x=c(80,90,105), y=c(i*200, i*200+12, i*200+12), alpha=i)
                   text(90, i*200+10, paste("alpha=", i, sep=""), adj=0) }
text(5,10, "default", adj=c(0.5,-0.2)); text(45,50, "default", adj=c(0.5,-0.2))

#dev.off()

</code></pre>

<hr>
<h2 id='sortDF'>sort dataframes by column</h2><span id='topic+sortDF'></span>

<h3>Description</h3>

<p>sort a data.frame by column - basically just a wrapper for order
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sortDF(df, col, decreasing = TRUE, quiet = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sortDF_+3A_df">df</code></td>
<td>
<p>Data.frame to be sorted</p>
</td></tr>
<tr><td><code id="sortDF_+3A_col">col</code></td>
<td>
<p>Column (index or (un)quoted name) to be sorted by</p>
</td></tr>
<tr><td><code id="sortDF_+3A_decreasing">decreasing</code></td>
<td>
<p>Logical: should highest value be on top?
DEFAULT: TRUE (unlike <code><a href="base.html#topic+order">order</a></code>!)</p>
</td></tr>
<tr><td><code id="sortDF_+3A_quiet">quiet</code></td>
<td>
<p>Logical: suppress non-df warning? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="sortDF_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="base.html#topic+order">order</a></code>, 
like eg <code>na.last or method</code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>data.frame
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, June 2015
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+sort">sort</a></code>, <code><a href="base.html#topic+order">order</a></code>, 
<code><a href="#topic+insertRows">insertRows</a></code>, <code><a href="#topic+addRows">addRows</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>sortDF(USArrests[USArrests$Murder&gt;11,], Assault)
sortDF(USArrests[USArrests$Murder&gt;11,], "Assault") # safer within functions
sortDF(USArrests[USArrests$Murder&gt;11,], 3)

</code></pre>

<hr>
<h2 id='spiralDate'>Spiral graph of time series</h2><span id='topic+spiralDate'></span>

<h3>Description</h3>

<p>Plot seasonality of (daily) time series along spiral
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spiralDate(
  dates,
  values,
  data,
  drange = NA,
  vrange = NA,
  months = substr(month.abb, 1, 1),
  add = FALSE,
  shift = 0,
  prop = NA,
  zlab = substitute(values),
  format = "%Y",
  nint = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spiralDate_+3A_dates">dates</code></td>
<td>
<p>Dates in ascending order.
Can be character strings or <code><a href="base.html#topic+strptime">strptime</a></code> results,
as accepted (and coerced) by <code><a href="base.html#topic+as.Date">as.Date</a></code></p>
</td></tr>
<tr><td><code id="spiralDate_+3A_values">values</code></td>
<td>
<p>Values to be mapped in color with <code><a href="#topic+colPoints">colPoints</a></code> along seasonal spiral</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_data">data</code></td>
<td>
<p>Optional: data.frame with the column names as given by dates and values</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_drange">drange</code></td>
<td>
<p>Optional date range (analogous to xlim), can be a vector like <code>dates</code>. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_vrange">vrange</code></td>
<td>
<p>Optional value range (analogous to ylim), can be a vector like <code>values</code>. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_months">months</code></td>
<td>
<p>Labels for the months. DEFAULT: J,F,M,A,M,J,J,A,S,O,N,D</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_add">add</code></td>
<td>
<p>Add to existing plot? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_shift">shift</code></td>
<td>
<p>Number of days to move January 1st clockwise. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_prop">prop</code></td>
<td>
<p>Proportion of the data to be actually plotted, used in <code><a href="#topic+spiralDateAnim">spiralDateAnim</a></code>. DEFAULT: NA (ignored)</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_zlab">zlab</code></td>
<td>
<p>Title of <code><a href="#topic+colPointsLegend">colPointsLegend</a></code></p>
</td></tr>
<tr><td><code id="spiralDate_+3A_format">format</code></td>
<td>
<p>Format of date labels see details in <code><a href="base.html#topic+strptime">strptime</a></code>. DEFAULT: &quot;%Y&quot;</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_nint">nint</code></td>
<td>
<p>Number of interpolation segments between points,
only used if <code>lines=TRUE</code> (passed to <code><a href="#topic+colPoints">colPoints</a></code>).
DEFAULT: 1 (with long time series, the colPoints default of 30 is too high!)</p>
</td></tr>
<tr><td><code id="spiralDate_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+colPoints">colPoints</a></code>, but not Range (use <code>vrange</code>)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible data.frame with date, vals, and the plotting coordinates
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seasonality">seasonality</a></code>, <code><a href="#topic+colPoints">colPoints</a></code>, <code><a href="base.html#topic+as.Date">as.Date</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># synthetic seasonal Data
set.seed(42)
fakeData &lt;- data.frame(time = as.Date("1985-01-01")+0:5000,
                       vals = cumsum(rnorm(5001))+50          )
fakeData$vals &lt;- fakeData$vals + sin(0:5000/366*2*pi)*max(abs(fakeData$vals))

sp &lt;- spiralDate(time,vals, data=fakeData)
tail(sp)
spiralDate(time,vals, data=fakeData, drange=as.Date(c("1980-01-01", "2004-11-15")), lines=TRUE)

par(mfrow=c(1,3), mar=c(3,3,6,1), mgp=c(2,0.6,0), las=1)
colPoints(time,vals,vals, data=fakeData, col=divPal(100), add=FALSE, legend=FALSE,
          lines=TRUE, pch=NA, nint=1, lwd=2)
title(main="classical time series\nworks badly for long time series\nshows trends well")

seasonality(time, vals, fakeData, col=divPal(100), mar=c(3,3,6,1), legend=FALSE, main="", shift=61)
title(main="yearly time series\nday of year over time\nfails for cyclicity over all year")

spiralDate(time,vals, data=fakeData, col=divPal(100), legargs=list(y1=0.7,y2=0.8))
title(main="spiral graph\nshows cyclic values nicely
            trends are harder to detect\nrecent values = more visual weight")

par(mfrow=c(1,1))

# Data with missing values:
fakeData[1300:1500, 2] &lt;- NA
spiralDate(time,vals, data=fakeData, lines=TRUE) # no problem
# Missing data:
fakeData &lt;- na.omit(fakeData)
spiralDate(time,vals, data=fakeData, lines=TRUE) # problematic for lines
spiralDate(time,vals, data=fakeData, pch=3)      # but not for points

## Real data:
#library2("waterData")
#data(exampleWaterData)
#spiralDate(dates, val, data=q05054000LT, lines=TRUE, lwd=3)

</code></pre>

<hr>
<h2 id='spiralDateAnim'>Animated spiral graph</h2><span id='topic+spiralDateAnim'></span>

<h3>Description</h3>

<p>Animation of (daily) time series along spiral
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spiralDateAnim(
  dates,
  values,
  data,
  steps = 100,
  sleep = 0,
  progbar = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="spiralDateAnim_+3A_dates">dates</code>, <code id="spiralDateAnim_+3A_values">values</code>, <code id="spiralDateAnim_+3A_data">data</code></td>
<td>
<p>Input as in <code><a href="#topic+spiralDate">spiralDate</a></code></p>
</td></tr>
<tr><td><code id="spiralDateAnim_+3A_steps">steps</code></td>
<td>
<p>Number of steps (images) in animation. DEFAULT: 100</p>
</td></tr>
<tr><td><code id="spiralDateAnim_+3A_sleep">sleep</code></td>
<td>
<p>Pause time between frames, in seconds, passed to <code><a href="base.html#topic+Sys.sleep">Sys.sleep</a></code>. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="spiralDateAnim_+3A_progbar">progbar</code></td>
<td>
<p>Should a progress bar be drawn? Useful if you have a large dataset or many steps. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="spiralDateAnim_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+spiralDate">spiralDate</a></code></p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2016
</p>


<h3>See Also</h3>

<p><code><a href="#topic+spiralDate">spiralDate</a></code>, <code><a href="#topic+linLogHist">linLogHist</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(42)
x &lt;- as.Date("1985-01-01")+0:5000
y &lt;- cumsum(rnorm(5001))+50
y &lt;- y + sin(0:5000/366*2*pi)*max(abs(y))/2
plot(x,y)

spiralDateAnim(x,y, steps=10, sleep=0.01) # 0.05 might be smoother...

## Not run: 
## Rcmd check --as-cran doesn't like to open external devices such as pdf,
## so this example is excluded from running in the checks.
pdf("spiralDateAnimation.pdf")
spiralDateAnim(x,y, main="Example Transition", col=divPal(100), format=" ")
dev.off()

# if you have FFmpeg installed, you can use the animation package like this:
library2(animation)
saveVideo(spiralDateAnim(x,y, steps=300), video.name="spiral_anim.mp4", interval=0.1,
    ffmpeg="C:/Program Files/R/ffmpeg/bin/ffmpeg.exe")


## End(Not run)

</code></pre>

<hr>
<h2 id='sumatraInitialize'>Set useful Sumatra PDF Viewer default settings</h2><span id='topic+sumatraInitialize'></span>

<h3>Description</h3>

<p>Set useful Sumatra PDF Viewer default settings. This will only work on windows.
Existing files are renamed (&quot;_old_n&quot; appended), not overwritten.<br />
At the given <code>path</code> with &quot;SumatraPDF.exe&quot;, it creates &quot;sumatrapdfrestrict.ini&quot; with <code>SavePreferences = 1</code> and <code>FullscreenAccess = 1</code>.<br />
At the given <code>roampath</code>, it creates &quot;SumatraPDF-settings.txt&quot; with <code>ShowToc = false</code> and <code>DefaultDisplayMode = single page</code>.
<code>UiLanguage</code> gets filled in by Sumatra itself upon first opening.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sumatraInitialize(
  path = sub("rstudio.exe$", "resources/app/bin/sumatra",
    Sys.getenv("RSTUDIO_DESKTOP_EXE")),
  roampath = paste0(Sys.getenv("APPDATA"), "/SumatraPDF"),
  openfolder = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="sumatraInitialize_+3A_path">path</code></td>
<td>
<p>Folder (not file) that contains &quot;SumatraPDF.exe&quot;.
You need file writing permissions in the folder.
DEFAULT: equivalent of &quot;C:/Program Files/RStudio/resources/app/bin/sumatra&quot;</p>
</td></tr>
<tr><td><code id="sumatraInitialize_+3A_roampath">roampath</code></td>
<td>
<p>Folder that will contain &quot;SumatraPDF-settings.txt&quot;.
DEFAULT: equivalent of &quot;C:/Users/berry/AppData/Roaming/SumatraPDF&quot;</p>
</td></tr>
<tr><td><code id="sumatraInitialize_+3A_openfolder">openfolder</code></td>
<td>
<p>Logical: Open folders after writing the files?
Uses <code><a href="#topic+openFile">openFile</a>()</code>. DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>path, invisibly
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, May 2020, Nov 2023
</p>


<h3>See Also</h3>

<p><code><a href="#topic+openPDF">openPDF</a></code><br />
<a href="https://www.sumatrapdfreader.org/settings/settings.html">https://www.sumatrapdfreader.org/settings/settings.html</a><br />
<a href="https://github.com/sumatrapdfreader/sumatrapdf/blob/master/docs/sumatrapdfrestrict.ini">https://github.com/sumatrapdfreader/sumatrapdf/blob/master/docs/sumatrapdfrestrict.ini</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># sumatraInitialize() # only run in interactive mode

</code></pre>

<hr>
<h2 id='superPos'>superposition of discharge, unit hydrograph</h2><span id='topic+superPos'></span>

<h3>Description</h3>

<p>superposition of precipitation along unit hydrograph (to simulate Q from P)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>superPos(P, UH)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="superPos_+3A_p">P</code></td>
<td>
<p>Vector with precipitation values</p>
</td></tr>
<tr><td><code id="superPos_+3A_uh">UH</code></td>
<td>
<p>Vector with discrete values of the Unit Hydrograph. This can be any UH summing to one, not just the storage cascade model.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of streamflow values
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2013
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lsc">lsc</a></code> where superPos is used, <code><a href="#topic+unitHydrograph">unitHydrograph</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
N &lt;- c(9,5,2,14,1,3) # [mm/hour]
UH &lt;- c(0, 0.1, 0.4, 0.3, 0.1, 0.1) # [1/h]
sum(UH) # sum must be 1

superPos(N, UH)
# If catchment area = 34 km^2 and precipitation is homogenous:
superPos(N/10^3, UH) * 34*10^6 / 3600  # m^3/s  # Add baseflow and you're done...

SP &lt;- data.frame(Prec=c(N, 0,0,0,0,0),
          P1=c( UH*N[1], 0,0,0,0,0),
          P2=c(0, UH*N[2], 0,0,0,0),
          P3=c(0,0, UH*N[3], 0,0,0),
          P4=c(0,0,0, UH*N[4], 0,0),
          P5=c(0,0,0,0, UH*N[5], 0),
          P6=c(0,0,0,0,0, UH*N[6] ),
          runoff=superPos(N, UH))
SP # SuperPosition

SPcum &lt;- t( apply(SP[2:7], 1, cumsum) )

plot(N, type="h", col=2:7, lwd=3, xlim=c(1, 10), ylim=c(30,0), lend=1)
par(new=TRUE)
plot(1, type="n", ylim=c(0, 15), xlim=c(1, 10), axes=FALSE, ann=FALSE)
axis(4, las=1)
polygon(x=c(1:11, 11:1), y=c(SPcum[,1], rep(0, 11)), col=2)
for(i in 2:6) polygon(x=c(1:11, 11:1), y=c(SPcum[,i], rev(SPcum[,i-1])), col=i+1)
text(3.5, 1, "Shape of UH")
lines( superPos(N, UH), lwd=3)

plot(UH, type="o", ylim=lim0(0.4), las=1)
lines(UH, type="h" )


# Effect of distribution of Prec:
P_a &lt;- c(1,2,3,4,5,6,7,8)
P_b &lt;- c(4,4,4,4,4,4,4,4,4)
P_c &lt;- c(8,7,6,5,4,3,2,1)
sum(P_a) ; sum(P_b) ; sum(P_c)

UH_1 &lt;- unitHydrograph(n=2, k=2.3, t=1:25)
UH_2 &lt;- unitHydrograph(n=5.5, k=1.8, t=1:25)

par(mfrow=c(2,3), mar=c(2,3,2,1), las=1)
plot(P_a, type="h", col=3, lwd=3, ylim=c(0,8), main="Precipitation a")
plot(P_b, type="h", col=4, lwd=3, ylim=c(0,8), main="Precipitation b")
plot(P_c, type="h", col=5, lwd=3, ylim=c(0,8), main="Precipitation c")
#
plot(UH_1, type="l", main="unit hydrograph", ylab="",xlab="Zeit")
lines(UH_2, col=2)
text(c(7,14), c(0.12, 0.07), c("UH_1","UH_2"), col=1:2)
abline(h=0)
#
plot( superPos(P=P_a, UH=UH_1), col=3, ylim=c(0,5), type="l",
      main="Discharge", ylab="Q [m^3/s]")
lines(superPos(P=P_b, UH=UH_1), col=4)
lines(superPos(P=P_c, UH=UH_1), col=5)
legend("topright", c("P a","P b", "P c"), title="with UH_1", col=3:5, lty=1)
#
plot( superPos(P=P_a, UH=UH_2), col=3, ylim=c(0,5), type="l",
      main="Discharge", ylab="Q [m^3/s]")
lines(superPos(P=P_b, UH=UH_2), col=4)
lines(superPos(P=P_c, UH=UH_2), col=5)
legend("topright", c("P a","P b", "P c"), title="with UH_2", col=3:5, lty=1)

</code></pre>

<hr>
<h2 id='tableColVal'>Table with values with value-dependent colored backgrounds in pdf</h2><span id='topic+tableColVal'></span>

<h3>Description</h3>

<p>Table with numbers and corresponding color in the background of each cell.
(heatmap)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tableColVal(
  mat,
  main = deparse(substitute(mat)),
  nameswidth = 0.3,
  namesheight = 0.1,
  palette = seqPal(100),
  Range = range(mat, finite = TRUE),
  digits = 0,
  na.rm = TRUE,
  ...,
  roundargs = NULL,
  classargs = NULL,
  cellargs = NULL,
  colargs = NULL,
  rowargs = NULL,
  mainargs = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tableColVal_+3A_mat">mat</code></td>
<td>
<p>Matrix with values and row/column names</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_main">main</code></td>
<td>
<p>Title for topleft space. DEFAULT: name of mat object.</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_nameswidth">nameswidth</code></td>
<td>
<p>Relative width of row names at the left, as a percentage of plot.
DEFAULT: 0.3</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_namesheight">namesheight</code></td>
<td>
<p>Relative height of column names at the top. DEFAULT: 0.1</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_palette">palette</code></td>
<td>
<p>Color palette for the heatmap. DEFAULT: <code><a href="#topic+seqPal">seqPal</a>(100)</code></p>
</td></tr>
<tr><td><code id="tableColVal_+3A_range">Range</code></td>
<td>
<p>Range mapped to color palette. DEFAULT: range(mat)</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_digits">digits</code></td>
<td>
<p>Number of digits rounded to for writing. DEFAULT: 0</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_na.rm">na.rm</code></td>
<td>
<p>Remove NA from labels? New in May 2022. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_...">...</code></td>
<td>
<p>Further arguments passed to all <code><a href="graphics.html#topic+text">text</a></code> like cex, col, srt, ...</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_roundargs">roundargs</code></td>
<td>
<p>List with arguments to <code><a href="#topic+round0">round0</a></code>. 
<code>pre</code> and <code>big.mark</code> have internal defaults.</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_classargs">classargs</code></td>
<td>
<p>List of arguments specifying how to call <code><a href="#topic+classify">classify</a></code>,
e.g. method. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="tableColVal_+3A_cellargs">cellargs</code>, <code id="tableColVal_+3A_colargs">colargs</code>, <code id="tableColVal_+3A_rowargs">rowargs</code>, <code id="tableColVal_+3A_mainargs">mainargs</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+text">text</a></code>
only for the cells, column labels, row labels or title,
respectively. DEFAULTS: NULL</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Create tables with corresponding color in the background of each cell. (heatmap)
</p>


<h3>Value</h3>

<p>List of locations in plot.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2012 + Nov 2016
</p>


<h3>See Also</h3>

<p><code><a href="grDevices.html#topic+pdf">pdf</a></code>, <code><a href="stats.html#topic+heatmap">heatmap</a></code>, <code><a href="#topic+sortDF">sortDF</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Bsp &lt;- matrix(c(21,23,26,27, 18,24,25,28, 14,17,23,23, 16,19,21,25), ncol=4, byrow=TRUE)
colnames(Bsp) &lt;- paste0("Measure", LETTERS[1:4])
rownames(Bsp) &lt;- paste("prod", 8:11, sep="_")
Bsp

(  tableColVal(Bsp)   )
tableColVal(Bsp, nameswidth=0.1) # relative to plot width
tableColVal(Bsp, namesheight=0.5, srt=45)
tableColVal(Bsp, namesheight=0.5, colargs=c(srt=45))

tableColVal(Bsp, cellargs=list(cex=2), col="red")
tableColVal(Bsp, Range=c(10,40))
tableColVal(Bsp, Range=c(20,40))
tableColVal(Bsp, palette=heat.colors(12))
tableColVal(Bsp, palette=c(2,4,7), main="more\nstuff")

Bsp2 &lt;- matrix(rexp(30), ncol=6, byrow=TRUE)
(  tableColVal(Bsp2)  )
tableColVal(Bsp2, digits=4)
colPointsLegend(Bsp2, horizontal=FALSE, x1=0.05, x2=0.15, y1=0.1, y2=0.8, title="")

## Not run: 
## Rcmd check --as-cran doesn't like to open external devices such as pdf,
## so this example is excluded from running in the checks.
pdf("TableColVal.pdf", height=5);  tableColVal(Bsp);  dev.off()
openFile("TableColVal.pdf")
unlink("TableColVal.pdf")

## End(Not run)

</code></pre>

<hr>
<h2 id='testExamples'>Test examples in a package</h2><span id='topic+testExamples'></span>

<h3>Description</h3>

<p>Test all examples in a package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>testExamples(
  path = packagePath("."),
  commentDontrun = FALSE,
  selection = NULL,
  logfolder = "ExampleTestLogs",
  elogfile = "errors.txt",
  wlogfile = "warnings.txt",
  tlogfile = "times.txt",
  plotfile = "plots.pdf",
  tellcurrentfile = TRUE,
  telldocument = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="testExamples_+3A_path">path</code></td>
<td>
<p>Path to package. For internal function <code>testExample</code>, 
path to a single Rd file.
DEFAULT: <code><a href="#topic+packagePath">packagePath</a>(".")</code></p>
</td></tr>
<tr><td><code id="testExamples_+3A_commentdontrun">commentDontrun</code></td>
<td>
<p>Logical. Should \dontrun sections be excluded?
DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="testExamples_+3A_selection">selection</code></td>
<td>
<p>Optional: selection of files, e.g 1:10. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="testExamples_+3A_logfolder">logfolder</code></td>
<td>
<p>Directory where to store the logfiles. Created if not 
existing. DEFAULT: &quot;ExampleTestLogs&quot;</p>
</td></tr>
<tr><td><code id="testExamples_+3A_elogfile">elogfile</code></td>
<td>
<p>File to log errors in. (Appended to existing text). 
DEFAULT: &quot;errors.txt&quot;</p>
</td></tr>
<tr><td><code id="testExamples_+3A_wlogfile">wlogfile</code></td>
<td>
<p>File to log warnings and messages in. (Appended to existing text). 
DEFAULT: &quot;warnings.txt&quot;</p>
</td></tr>
<tr><td><code id="testExamples_+3A_tlogfile">tlogfile</code></td>
<td>
<p>File in which to write computing times. 
DEFAULT: &quot;times.txt&quot;</p>
</td></tr>
<tr><td><code id="testExamples_+3A_plotfile">plotfile</code></td>
<td>
<p>File to log warnings and messages in. (Appended to existing text). 
DEFAULT: &quot;plots.pdf&quot;</p>
</td></tr>
<tr><td><code id="testExamples_+3A_tellcurrentfile">tellcurrentfile</code></td>
<td>
<p>Logical: At the beginning of each file, message the
name and current time in the console?</p>
</td></tr>
<tr><td><code id="testExamples_+3A_telldocument">telldocument</code></td>
<td>
<p>Message reminder to run <code>devtools::document()</code>? 
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="testExamples_+3A_...">...</code></td>
<td>
<p>Further arguments passed to internal function <code>testExample</code>
and from there to <code>tools::<a href="tools.html#topic+Rd2ex">Rd2ex</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>Logical indicating successful tests
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Mar 2019
</p>


<h3>See Also</h3>

<p>The evaluate package
</p>


<h3>Examples</h3>

<pre><code class='language-R'># testExamples(selection=1:10)

</code></pre>

<hr>
<h2 id='textField'>Write text to plot with halo underneath</h2><span id='topic+textField'></span>

<h3>Description</h3>

<p>Write text to plot. A field the size of each label is drawn beneath it, so
the text can be read easily even if there are many points in the plot.
Fields can be rectangular, elliptic or rectangular with rounded edges.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>textField(
  x,
  y,
  labels = seq_along(x),
  fill = "white",
  border = NA,
  expression = NA,
  margin = 0.3,
  field = "rounded",
  nv = 500,
  rounding = 0.25,
  rrarg = NULL,
  lty = par("lty"),
  lwd = par("lwd"),
  cex = par("cex"),
  xpd = par("xpd"),
  adj = par("adj"),
  pos = NULL,
  offset = 0.5,
  quiet = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="textField_+3A_x">x</code></td>
<td>
<p>X coordinates, if necessary, they are recycled</p>
</td></tr>
<tr><td><code id="textField_+3A_y">y</code></td>
<td>
<p>Y coordinates</p>
</td></tr>
<tr><td><code id="textField_+3A_labels">labels</code></td>
<td>
<p>labels to be placed at the coordinates, as in <code><a href="graphics.html#topic+text">text</a></code>. DEFAULT: seq_along(x)</p>
</td></tr>
<tr><td><code id="textField_+3A_fill">fill</code></td>
<td>
<p>fill is recycled if necessary. With a message when quiet = FALSE. DEFAULT: &quot;white&quot;</p>
</td></tr>
<tr><td><code id="textField_+3A_border">border</code></td>
<td>
<p>ditto for border. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="textField_+3A_expression">expression</code></td>
<td>
<p>If TRUE, labels are converted to expression for better field positioning through expression bounding boxes.
If NA, it is set to TRUE for labels without line breaks (Newlines, &quot;\n&quot;).
If FALSE, no conversion happens. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="textField_+3A_margin">margin</code></td>
<td>
<p>added field space around words (multiple of em/ex). DEFAULT: 0.3</p>
</td></tr>
<tr><td><code id="textField_+3A_field">field</code></td>
<td>
<p>'rectangle', 'ellipse', or 'rounded', partial matching is performed. DEFAULT: &quot;rounded&quot;</p>
</td></tr>
<tr><td><code id="textField_+3A_nv">nv</code></td>
<td>
<p>number of vertices for field = &quot;ellipse&quot; or &quot;rounded&quot;. low: fast drawing.
high: high resolution in vector graphics as pdf possible. DEFAULT: 500</p>
</td></tr>
<tr><td><code id="textField_+3A_rounding">rounding</code></td>
<td>
<p>between 0 and 0.5: portion of height that is cut off rounded 
at edges when field = &quot;rounded&quot;. DEFAULT: 0.25</p>
</td></tr>
<tr><td><code id="textField_+3A_rrarg">rrarg</code></td>
<td>
<p>List of arguments passed to <code><a href="#topic+roundedRect">roundedRect</a></code>. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="textField_+3A_lty">lty</code></td>
<td>
<p>line type. DEFAULT: par(&quot;lty&quot;)</p>
</td></tr>
<tr><td><code id="textField_+3A_lwd">lwd</code></td>
<td>
<p>line width. DEFAULT: par(&quot;lwd&quot;)</p>
</td></tr>
<tr><td><code id="textField_+3A_cex">cex</code></td>
<td>
<p>character expansion. DEFAULT: par(&quot;cex&quot;)</p>
</td></tr>
<tr><td><code id="textField_+3A_xpd">xpd</code></td>
<td>
<p>expand text outside of plot region (&quot;figure&quot;)?. DEFAULT: par(&quot;xpd&quot;)</p>
</td></tr>
<tr><td><code id="textField_+3A_adj">adj</code></td>
<td>
<p>vector of length one or two. DEFAULT: par(&quot;adj&quot;)</p>
</td></tr>
<tr><td><code id="textField_+3A_pos">pos</code></td>
<td>
<p>in 'text', pos overrides adj values. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="textField_+3A_offset">offset</code></td>
<td>
<p>I want the field to still be drawn with adj, but have it based on pos. DEFAULT: 0.5</p>
</td></tr>
<tr><td><code id="textField_+3A_quiet">quiet</code></td>
<td>
<p>Suppress warning when Arguments are recycled? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="textField_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="graphics.html#topic+strwidth">strwidth</a></code> and
<code><a href="graphics.html#topic+text">text</a></code>, like font, vfont, family</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Specifying pos and offset will currently change the position of the text, but not of the field.<br />
srt is not supported yet.<br />
lend, ljoin and lmitre can not be specified for rect, to keep argument number low.<br />
density (crosshatch etc.) is not supported, as this would distract from the text.
# Search Engine Keywords:
R Text visible on top
R labeling with color underneath
R Creating text with a halo
R Text with shadow
</p>


<h3>Value</h3>

<p>None
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, April 2013 + March 2014
</p>


<h3>References</h3>

<p>with inspiration taken from <code>ordilabel</code> in package <code>vegan</code>
and thanks to Jari Oksanen for his comments
</p>


<h3>See Also</h3>

<p><code><a href="graphics.html#topic+text">text</a></code>, <code><a href="#topic+roundedRect">roundedRect</a></code>;
<code>shadowtext</code> in the archived <a href="https://cran.r-project.org/package=TeachingDemos">TeachingDemos</a> package, see
<a href="https://blog.revolutionanalytics.com/2009/05/make-text-stand-out-with-outlines.html">https://blog.revolutionanalytics.com/2009/05/make-text-stand-out-with-outlines.html</a>,
and <a href="https://stackoverflow.com/questions/25631216">https://stackoverflow.com/questions/25631216</a>. <br />
<code>s.label</code> in package <code>ade4</code>, which is not so versatile and
doesn't work with logarithmic axes
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# TextFields with mixed field shapes ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
set.seed(13);  plot(cumsum(rnorm(100)), type="l", main="berryFunctions::textField")
for(i in 2:7) lines(cumsum(rnorm(100)), col=i)
textField(40, 4, "default")
textField(40, 0, "some options", col=2, fill=4, margin=c(-0.4, 0.9), font=2)
# Ellipsis (looks better in vector graphics like pdf):
textField(80, 2, "field='ellipse'", field="ell", mar=c(0.5, 2.3), border=5)
# Rectangular field with edges rounded:
textField(60,-3, "field='Rounded'", field="rounded", fill="orange", cex=1.7)

# Field type can be abbreviated (partial matching), margin may need adjustment:
textField(90, 5, "short", field="ell", fill=7, border=4, mar=-0.4)

# Rounded can also vectorized:
textField(30, c(2,0,-2,-4,-6), paste("rounding =",seq(0,0.6,len=5)), field="round",
    fill=(2:6), mar=1, rounding=seq(0,0.6,len=5), border=1)
# turn off warning about recycling:
textField(80, c(-5,-6.5), c("Ja", "Nein"), field="round", fill=6:8, quiet=TRUE)


set.seed(007); plot(rnorm(1e4)) ; abline(v=0:5*2e3, col=8)
# Default settings:
textField(5000, 0, "Here's some good text")
# right-adjusted text (the field box still extends 'margin' stringwidths em):
textField(2000, -1, "Some more (smores!)", cex=1.5, adj=0, col=2)
# Field color, no extra margin beyond baseline (excluding descenders):
textField(2000, -2, "more yet", col=2, fill="blue", margin=0)
# margin can be one number for both x and y direction ... :
textField(1000, 2, "Up we go", fill=7, margin=1.4)
# ... or two (x and y different), even negative:
textField(5000, 2, "to the right", col=2, fill=4, margin=c(-0.4, 0.9))
# Fonts can be set as well:
textField(5000, 1, "And boldly down in bold font", font=2, border=3)
# Text can expand outsinde of the plot region (figure) into the margins:
textField(11000, -2, "Hi, I'm a long block of text", adj=1, fill="red")
textField(11000, -3, "You're not outside the plot!", adj=1, xpd=TRUE, fill="red")
# And most parameters can be vectorized, while x/y are recycled:
textField(3000, c(-3, -3.7), c("0", "good"), border=c("red",3), lty=1:2)


# textField even works on logarithmic axes:
mylabel &lt;- c("This","is (g)","the","ever-\n great","Sparta")
plot(10^runif(5000, -1,2), log="y", col=8)
textField(1000, c(100,20,4,2,0.5), mylabel, fill=2, mar=0, expression=FALSE)
textField(2500, c(100,20,4,2,0.5), mylabel, fill=4, mar=0, expression=TRUE)
textField(4000, c(100,20,4,2,0.5), mylabel, fill=3, mar=0)
textField(c(1,2.5,4)*1000, 0.2, paste("expression=\n", c("FALSE","TRUE","NA")))

# In most devices, vertical adjustment is slightly off when the character string
# contains no descenders. The default is for centered text:  adj = c(0.5, NA).
# For drawing the field, adj[2] is in this case set to 0.5.
# Text positioning is different for NA than for 0.5, see details of ?text
# I'm working on it through expression, which does not work with newlines yet

</code></pre>

<hr>
<h2 id='TFtest'>Test logical expressions</h2><span id='topic+TFtest'></span>

<h3>Description</h3>

<p>Check if logical expressions return what you expect with a truth table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>TFtest(..., na = TRUE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="TFtest_+3A_...">...</code></td>
<td>
<p>Expression(s) with logical operators to be evaluated,
with single letters for variables. Each expression is to be separated with a comma</p>
</td></tr>
<tr><td><code id="TFtest_+3A_na">na</code></td>
<td>
<p>Logical: should NAs be included in the truth table? DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a nice way to check operator precedence, see <code><a href="base.html#topic+Syntax">Syntax</a></code>
</p>


<h3>Value</h3>

<p>Truth table as data.frame with TRUE and FALSE (and NA) combinations
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>,  Mrz 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+logical">logical</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>TFtest(!a &amp; !b)
TFtest(!a &amp; !b, a&amp;b, !(a&amp;b))
TFtest(!a &amp; !b | c)
TFtest(!a &amp; !b | c, na=FALSE)
TFtest(!a)
TFtest(a&amp;b|c, (a&amp;b)|c, a&amp;(b|c), na=FALSE) # AND has precedence over OR
TFtest(a|b, xor(a,b), na=FALSE)

</code></pre>

<hr>
<h2 id='timeAxis'>Label date axis</h2><span id='topic+timeAxis'></span>

<h3>Description</h3>

<p>Labels date axes at sensible intervals in the time domain of weeks to decades.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timeAxis(
  side = 1,
  timeAxis = NA,
  origin = "1970-01-01",
  startyear = NULL,
  stopyear = NULL,
  n = 5,
  npm = NULL,
  npy = NA,
  format = "%d.%m.\n%Y",
  yformat = "%Y",
  labels = format.Date(d, format),
  ym = FALSE,
  mcex = 0.6,
  mmgp = c(3, 0, 0),
  midyear = FALSE,
  midmonth = FALSE,
  midargs = NULL,
  mgp = c(3, 1.5, 0),
  cex.axis = 1,
  tick = TRUE,
  tcl = par("tcl"),
  las = 1,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timeAxis_+3A_side">side</code></td>
<td>
<p>Which <code><a href="graphics.html#topic+axis">axis</a></code> are to be labeled? (can be several). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_timeaxis">timeAxis</code></td>
<td>
<p>Logical indicating whether the axis is <code><a href="base.html#topic+POSIXct">POSIXct</a></code>, not date.
DEFAULT: NA, meaning axis value &gt;1e5</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_origin">origin</code></td>
<td>
<p>Origin for<code><a href="base.html#topic+as.Date">as.Date</a></code> and <code><a href="base.html#topic+as.POSIXct">as.POSIXct</a></code>. DEFAULT: &quot;1970-01-01&quot;</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_startyear">startyear</code></td>
<td>
<p>Integer. starting year. DEFAULT: NULL = internally computed from <code><a href="graphics.html#topic+par">par</a>("usr")</code></p>
</td></tr>
<tr><td><code id="timeAxis_+3A_stopyear">stopyear</code></td>
<td>
<p>Ditto for ending year. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_n">n</code></td>
<td>
<p>Approximate number of labels that should be printed (as in <code><a href="base.html#topic+pretty">pretty</a></code>). DEFAULT: 5</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_npm">npm</code></td>
<td>
<p>Number of labels per month, overrides n. DEFAULT: NULL = internally computed.</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_npy">npy</code></td>
<td>
<p>Number of labels per year, overrides npm and n. DEFAULT: NA</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_format">format</code></td>
<td>
<p>Format of date, see details in <code><a href="base.html#topic+strptime">strptime</a></code>. DEFAULT: &quot;%d.%m.\n%Y&quot;</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_yformat">yformat</code></td>
<td>
<p>Format of year if <code>ym=TRUE</code>.
Use <code>yformat=" "</code> (with space) to suppress year labeling.
DEFAULT: &quot;%Y&quot;</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_labels">labels</code></td>
<td>
<p>labels. DEFAULT: format.Date(d, format)</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_ym">ym</code></td>
<td>
<p>Label months with first letter at the center of the month and year at center below.
Sets midyear and midmonth to TRUE. Uses <code>labels</code> and <code>format</code>
for the years, but ignores them for the months. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_mcex">mcex</code></td>
<td>
<p><code>cex.axis</code> for month labels if ym=TRUE. DEFAULT: 0.6</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_mmgp">mmgp</code></td>
<td>
<p><code>mgp</code> for month labels if ym=TRUE. DEFAULT: 3,0,0</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_midyear">midyear</code></td>
<td>
<p>Place labels in the middle of the year? if TRUE, format default is &quot;%Y&quot;. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_midmonth">midmonth</code></td>
<td>
<p>Place labels in the middle of the month? if TRUE, format default is &quot;%m\n%Y&quot;. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_midargs">midargs</code></td>
<td>
<p>List of arguments passed to <code><a href="graphics.html#topic+axis">axis</a></code> for the year-start lines without labels. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_mgp">mgp</code></td>
<td>
<p>MarGinPlacement, see <code><a href="graphics.html#topic+par">par</a></code>. The second value is for label distance to axis. DEFAULT: c(3,1.5,0)</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_cex.axis">cex.axis</code></td>
<td>
<p>Character EXpansion (letter size). DEFAULT: 1</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_tick">tick</code></td>
<td>
<p>Draw tick lines? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_tcl">tcl</code></td>
<td>
<p>Tick length (negative to go below axis) in text line height units like mgp[2]
Changed to -2.5 for year borders if ym=TRUE. DEFAULT: par(&quot;tcl&quot;)</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_las">las</code></td>
<td>
<p>LabelAxisStyle for orientation of labels. DEFAULT: 1 (upright)</p>
</td></tr>
<tr><td><code id="timeAxis_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="graphics.html#topic+axis">axis</a></code>, like <code>lwd, col.ticks, hadj, lty</code>, ...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>The dates that were labeled
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Feb 2015, update labels and midyear Dec 2015
</p>


<h3>See Also</h3>

<p><code><a href="#topic+monthLabs">monthLabs</a></code> for the numbercrunching itself, <code><a href="graphics.html#topic+axis.Date">axis.Date</a></code> with defaults that are less nice.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
set.seed(007) # for reproducibility
Date1 &lt;- as.Date("2013-09-25")+sort(sample(0:150, 30))
plot(Date1, cumsum(rnorm(30)), type="l", xaxt="n", ann=FALSE)
timeAxis(side=1)
timeAxis(1, npm=2, cex.axis=0.5, col.axis="red") # fix number of labels per month

DateYM &lt;- as.Date("2013-04-25")+0:500
plot(DateYM, cumsum(rnorm(501)), type="l", xaxt="n", ann=FALSE)

monthAxis() # see more examples there - it largely replaces timeAxis!!!

plot(Date1, cumsum(rnorm(30)), type="l", xaxt="n", ann=FALSE)
timeAxis(labels=FALSE, col.ticks=2)
timeAxis(1, format=" ")  # equivalent to axis(labels=FALSE)
timeAxis(1)
d &lt;- timeAxis(1, labels=letters[1:24], mgp=c(3,2.5,0))
d # d covers the full year, thus is longer than n=5

Date2 &lt;- as.Date("2011-07-13")+sort(sample(0:1400, 50))
plot(Date2, cumsum(rnorm(50)), type="l", xaxt="n", ann=FALSE)
timeAxis(npy=12, format=" ")  # fix number of labels per year
timeAxis(tcl=-0.8, lwd.ticks=2, format="%Y/%m", mgp=c(3,1,0))
timeAxis(format="", mgp=c(3,2,0)) # International Date format YYYY-mm-dd

plot(Date2, cumsum(rnorm(50)), type="l", xaxt="n", ann=FALSE)
timeAxis(midyear=TRUE)
abline(v=monthLabs(npm=1), col=8)

Date3 &lt;- as.Date("2011-07-13")+sort(sample(0:1200, 50))
plot(Date3, cumsum(rnorm(50)), type="l", xaxt="n", ann=FALSE)
timeAxis(1, n=4, font=2)
timeAxis(1, col.axis=3) # too many labels with default n=5

monthAxis(side=3) # again: use monthAxis, it is usually nicer!

# mid-year labels:
plot(Date3, cumsum(rnorm(50)), type="l", xaxt="n", ann=FALSE)
timeAxis(midyear=TRUE, midargs=list(tcl=-1.2))

# mid-month labels:
plot(Date1, cumsum(rnorm(30)), type="l", xaxt="n", ann=FALSE)
timeAxis(midmonth=TRUE)

# Time axis instead of date axis:
plot(as.POSIXct(Sys.time()+c(0,10)*24*3600), 1:2, xaxt="n")
timeAxis(n=3)
timeAxis()

</code></pre>

<hr>
<h2 id='timer'>Timer alarm</h2><span id='topic+timer'></span>

<h3>Description</h3>

<p>Beeps in a given interval and gives a progress bar in the console
</p>


<h3>Usage</h3>

<pre><code class='language-R'>timer(interval = 20, n = 15, write = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="timer_+3A_interval">interval</code></td>
<td>
<p><code><a href="utils.html#topic+alarm">alarm</a></code> interval in seconds. DEFAULT: 20</p>
</td></tr>
<tr><td><code id="timer_+3A_n">n</code></td>
<td>
<p>number of alarm signals to be given. DEFAULT: 15</p>
</td></tr>
<tr><td><code id="timer_+3A_write">write</code></td>
<td>
<p>Should the actual estimated time be written for overhead computing time control purposes? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Details</h3>

<p>defaults to practice useR lightning talks: 15 slides, each shown 20 secs, change automatically
</p>


<h3>Value</h3>

<p>none
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, June 2015
</p>


<h3>References</h3>

<p><a href="https://user2015.math.aau.dk/lightning_talks">https://user2015.math.aau.dk/lightning_talks</a>
</p>


<h3>See Also</h3>

<p><code><a href="utils.html#topic+alarm">alarm</a></code>, <code><a href="base.html#topic+Sys.sleep">Sys.sleep</a></code>, <code><a href="utils.html#topic+txtProgressBar">txtProgressBar</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
## Not run: ## Skip time consuming checks on CRAN
timer(interval=0.5, n=3)
timer(interval=0.2, n=8, write=TRUE) # a slight deviation occurs for a large n
# timer() # to practice lightning talks at useR! conferences

## End(Not run)

</code></pre>

<hr>
<h2 id='tmessage'>messages with call trace</h2><span id='topic+tmessage'></span><span id='topic+twarning'></span><span id='topic+tstop'></span>

<h3>Description</h3>

<p><a href="base.html#topic+message">message</a>, <a href="base.html#topic+warning">warning</a> or <a href="base.html#topic+stop">stop</a> with a call trace prepended
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tmessage(..., skip = 0)

twarning(..., skip = 0, call. = FALSE, noBreaks. = TRUE)

tstop(..., skip = 0, call. = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tmessage_+3A_...">...</code></td>
<td>
<p>Passed to <a href="base.html#topic+message">message</a>, <a href="base.html#topic+warning">warning</a> or <a href="base.html#topic+stop">stop</a></p>
</td></tr>
<tr><td><code id="tmessage_+3A_skip">skip</code></td>
<td>
<p>Number of tracing levels to exclude. Default: 0</p>
</td></tr>
<tr><td><code id="tmessage_+3A_call.">call.</code></td>
<td>
<p>include twarning/tstop call? DEFAULT: FALSE (unlike the originals)</p>
</td></tr>
<tr><td><code id="tmessage_+3A_nobreaks.">noBreaks.</code></td>
<td>
<p>reduce line breaks if <code>options(warn=1)</code>?
DEFAULT: TRUE (unlike the original)</p>
</td></tr>
</table>


<h3>Value</h3>

<p>NULL, as per <a href="base.html#topic+message">message</a>, <a href="base.html#topic+warning">warning</a> or <a href="base.html#topic+stop">stop</a>
</p>


<h3>See Also</h3>

<p><a href="#topic+traceCall">traceCall</a> for the generation of the trace
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lower &lt;- function(a, s) {tmessage("some stuff with ", a+10, skip=s); a}
upper &lt;- function(b, skip=0) lower(b+5, skip)
upper(3) # upper -&gt; lower: some stuff with 18
upper(3, skip=1) # no "lower" in trace
upper(3, skip=-1) # upper -&gt; lower -&gt; tmessage: some stuff with 18
tmessage("Some message", " to be displayed")
lower &lt;- function(a, s) {twarning("some stuff with ", a+10, skip=s); a}
upper(7)
oop &lt;- options(warn=1)
upper(7) # Warning: upper -&gt; lower: some []       no line break :)
options(oop) ; rm(oop)
lower &lt;- function(a, s) {tstop("some stuff with ", a+10, skip=s); a}
try(  upper(7)  ) # Error : try -&gt; upper -&gt; lower: some stuff with 22
</code></pre>

<hr>
<h2 id='traceCall'>call stack of a function</h2><span id='topic+traceCall'></span>

<h3>Description</h3>

<p>trace the call stack e.g. for error checking and format output for do.call levels
</p>


<h3>Usage</h3>

<pre><code class='language-R'>traceCall(
  skip = 0,
  prefix = "\nCall stack: ",
  suffix = "\n",
  vigremove = TRUE,
  shiremove = TRUE,
  mesremove = TRUE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="traceCall_+3A_skip">skip</code></td>
<td>
<p>Number of levels to skip in <code><a href="base.html#topic+sys.calls">sys.calls</a></code></p>
</td></tr>
<tr><td><code id="traceCall_+3A_prefix">prefix</code></td>
<td>
<p>Prefix prepended to the output character string. DEFAULT: &quot;\nCall stack: &quot;</p>
</td></tr>
<tr><td><code id="traceCall_+3A_suffix">suffix</code></td>
<td>
<p>Suffix appended to the end of the output. DEFAULT: &quot;\n&quot;</p>
</td></tr>
<tr><td><code id="traceCall_+3A_vigremove">vigremove</code></td>
<td>
<p>Logical: remove call created using devtools::build_vignettes()?
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="traceCall_+3A_shiremove">shiremove</code></td>
<td>
<p>Logical: remove shiny::runApp ... renderPlot? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="traceCall_+3A_mesremove">mesremove</code></td>
<td>
<p>Logical: remove call part from <code><a href="base.html#topic+.makeMessage">.makeMessage</a></code>?
DEFAULT: TRUE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string with the call stack
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2016 + March 2017
</p>


<h3>See Also</h3>

<p><code><a href="#topic+tmessage">tmessage</a></code>, <code><a href="#topic+tryStack">tryStack</a></code>, <code><a href="#topic+checkFile">checkFile</a></code> for example usage
</p>


<h3>Examples</h3>

<pre><code class='language-R'>lower &lt;- function(a, s) {warning(traceCall(s, mesremove=FALSE), "stupid berry warning: ", a+10); a}
upper &lt;- function(b, skip=0) lower(b+5, skip)
upper(3)

# Since 2022-05-04, use tmessage / twarning / tstop instead!

upper(3, skip=1) # traceCall skips last level (R3: warning, R4.1: .makeMessage, R4.2: lapply)
upper(3, skip=6) # now the stack is empty
d &lt;- tryStack(upper("four"), silent=TRUE)
inherits(d, "try-error")
cat(d)

lower &lt;- function(a,...) {warning(traceCall(1, prefix="in ", suffix=": "),
                          "How to use traceCall in functions ", call.=FALSE); a}
upper(3)

</code></pre>

<hr>
<h2 id='truncMessage'>truncate message parts</h2><span id='topic+truncMessage'></span>

<h3>Description</h3>

<p>truncate long vectors for messages
</p>


<h3>Usage</h3>

<pre><code class='language-R'>truncMessage(
  x,
  ntrunc = 3,
  prefix = "s",
  midfix = " ",
  altnix = "'",
  sep = ", "
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="truncMessage_+3A_x">x</code></td>
<td>
<p>Character vector</p>
</td></tr>
<tr><td><code id="truncMessage_+3A_ntrunc">ntrunc</code></td>
<td>
<p>Integer: number of elements printed before truncation. DEFAULT: 3</p>
</td></tr>
<tr><td><code id="truncMessage_+3A_prefix">prefix</code></td>
<td>
<p>Character: Prefix added if <code>length(x)&gt;1</code>. DEFAULT: &quot;s&quot;</p>
</td></tr>
<tr><td><code id="truncMessage_+3A_midfix">midfix</code></td>
<td>
<p>Character: string added after prefix OR before first altnix. DEFAULT: &quot; &quot;</p>
</td></tr>
<tr><td><code id="truncMessage_+3A_altnix">altnix</code></td>
<td>
<p>Character: Alternative string padded around x if <code>length(x)==1</code>.
DEFAULT: &quot;'&quot;</p>
</td></tr>
<tr><td><code id="truncMessage_+3A_sep">sep</code></td>
<td>
<p>Character: Separator between elements. DEFAULT: &quot;, &quot;</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Character string
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+message">message</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>truncMessage("hi")
message("listing name", truncMessage(       "hi"      ), ".")
message("listing name", truncMessage(paste0("hi",1:10)), ".")
truncMessage(paste0("hi",1:10), ntrunc=1)
truncMessage(paste0("hi",1:10), ntrunc=2, prefix="", midfix="")
truncMessage(paste0("hi",1:10), ntrunc=8, prefix="files _ ")

</code></pre>

<hr>
<h2 id='tryStack'>try an expression, returning the error stack</h2><span id='topic+tryStack'></span>

<h3>Description</h3>

<p>As in <code><a href="base.html#topic+try">try</a></code>, the result of an expression if it works.
If it fails, execution is not halted, but an invisible try-error class object is
returned and (unless silent=TRUE) a message <code><a href="base.html#topic+cat">cat</a>ted</code> to the console.<br />
Unlike <code><a href="base.html#topic+try">try</a></code>, <code>tryStack</code> also returns the calling stack to
trace errors and warnings and ease debugging.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>tryStack(
  expr,
  silent = FALSE,
  warn = TRUE,
  short = TRUE,
  file = "",
  removetry = TRUE,
  skip = NULL
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="tryStack_+3A_expr">expr</code></td>
<td>
<p>Expression to try, potentially wrapped in curly braces if
spanning several commands.</p>
</td></tr>
<tr><td><code id="tryStack_+3A_silent">silent</code></td>
<td>
<p>Logical: Should printing of error message + stack be suppressed?
Does not affect warnings and messages. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="tryStack_+3A_warn">warn</code></td>
<td>
<p>Logical: trace <code><a href="base.html#topic+warning">warning</a>s</code> and <code><a href="base.html#topic+message">message</a>s</code> also?
They are still handled like regular warnings / messages unless
<code>file !=""</code>, when they are catted into that file. DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="tryStack_+3A_short">short</code></td>
<td>
<p>Logical: should trace be abbreviated to upper -&gt; middle -&gt; lower?
If NA, it is set to TRUE for warnings and messages, FALSE for errors.
DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="tryStack_+3A_file">file</code></td>
<td>
<p>File name passed to <code><a href="base.html#topic+cat">cat</a></code>.
If given, Errors will be appended to the file after two empty lines.
if <code>warn=T</code> and file!=&quot;&quot;, warnings and messages will not be shown,
but also appended to the file.
This is useful in lapply simulation runs.
DEFAULT: &quot;&quot; (catted to the console)</p>
</td></tr>
<tr><td><code id="tryStack_+3A_removetry">removetry</code></td>
<td>
<p>Logical: should all stack entries matching typical tryCatch
expressions be removed? Unless the call contains customized
<code><a href="base.html#topic+tryCatch">tryCatch</a></code> code, this can be left to the DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="tryStack_+3A_skip">skip</code></td>
<td>
<p>Character string(s) to be removed from the stack.
e.g. &quot;eval(expr, p)&quot;. Use short=F to find exact matches.
DEFAULT: NULL</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Value of <code>expr</code> if evaluated successfully. If not, an invisible
object of class &quot;try-error&quot; as in <code><a href="base.html#topic+try">try</a></code> with the stack in <code>object[2]</code>.
For nested tryStack calls, <code>object[3], object[4]</code> etc. will contain &quot;&ndash; empty error stack &ndash;&quot;
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Nov 2016
</p>


<h3>See Also</h3>

<p><code><a href="base.html#topic+try">try</a></code>, <code><a href="#topic+traceCall">traceCall</a></code>,
<a href="https://web.archive.org/web/20200813031649/https://r.789695.n4.nabble.com/Stack-trace-td4021537.html">https://web.archive.org/web/20200813031649/https://r.789695.n4.nabble.com/Stack-trace-td4021537.html</a>,
<a href="https://stackoverflow.com/questions/15282471/get-stack-trace-on-trycatched-error-in-r">https://stackoverflow.com/questions/15282471/get-stack-trace-on-trycatched-error-in-r</a>,
<a href="https://stackoverflow.com/questions/1975110/printing-stack-trace-and-continuing-after-error-occurs-in-r">https://stackoverflow.com/questions/1975110/printing-stack-trace-and-continuing-after-error-occurs-in-r</a>,
<a href="https://stackoverflow.com/questions/16879821/save-traceback-on-error-using-trycatch">https://stackoverflow.com/questions/16879821/save-traceback-on-error-using-trycatch</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Functions -----

lower &lt;- function(a) {message("fake message, a = ", a); a+10}
middle &lt;- function(b) {plot(b, main=b) ; warning("fake warning, b = ", b); lower(b) }
upper &lt;- function(c) {cat("printing c:", c, "\n") ; middle(c)}
d &lt;- upper(42)
d
rm(d)


# Classical error management with try -----

is.error( d &lt;- upper("42"), TRUE, TRUE) # error, no d creation
traceback()                     # calling stack, but only in interactive mode

d &lt;- try(upper("42"), silent=TRUE)      # d created
cat(d)                                  # with error message, but no traceback
inherits(d, "try-error")                # use for coding


# way cooler with tryStack -----

d &lt;- tryStack(upper("42") ) # like try, but with traceback, even for warnings
cat(d)
d &lt;- tryStack(upper("42"), silent=TRUE, warn=0) # don't trace warnings
d &lt;- tryStack(upper("42"), short=FALSE)

tryStack(upper(42)) # returns normal output, but warnings are easier to debug
# Note: you can also set options(showWarnCalls=TRUE)

stopifnot(inherits(d, "try-error"))
stopifnot(tryStack(upper(42))==52)

## Not run:  ## file writing not wanted by CRAN checks
d &lt;- tryStack(upper("42"), silent=TRUE, file="log.txt")
openFile("log.txt")
unlink("log.txt")

## End(Not run)

op &lt;- options(warn=2)
d &lt;- try(upper("42") )
cat(d)
d &lt;- tryStack(upper("42") )
d &lt;- tryStack(upper("42"), warn=FALSE)
cat(d)
options(op) ; rm(op)

# Nested calls -----

f &lt;- function(k) tryStack(upper(k), silent=TRUE)
d &lt;- f(42)                 ; cat("-----\n", d, "\n-----\n") ; rm(d)
d &lt;- f("42")               ; cat("-----\n", d, "\n-----\n") ; rm(d)
d &lt;- tryStack(f(4) )       ; cat("-----\n", d, "\n-----\n") ; rm(d)
# warnings in nested calls are printed twice, unless warn=0
d &lt;- tryStack(f(4), warn=0) # could also be set within 'f'

d &lt;- tryStack(f("4"))      ; cat("-----\n", d, "\n-----\n")
d[1:3] ; rm(d)
# empty stack at begin - because of tryStack in f, no real error happened in f


# Other tests -----

cat( tryStack(upper("42")) )
f &lt;- function(k) tryStack(stop("oh oh"))
d &lt;- f(42) ; cat("-----\n", d, "\n-----\n") ; rm(d) # level 4 not helpful, but OK

# stuff with base::try
f &lt;- function(k) try(upper(k), silent=TRUE)
d &lt;- f(42)     ; cat("-----\n", d, "\n-----\n") ; rm(d)
d &lt;- f("42")   ; cat("-----\n", d, "\n-----\n") ; rm(d) # regular try output

f2 &lt;- function(k) tryStack(f(k), warn=0, silent=TRUE)
d &lt;- f2(42)    ; cat("-----\n", d, "\n-----\n") ; rm(d)
d &lt;- f2("42")  ; cat("-----\n", d, "\n-----\n") ; rm(d) # try -&gt; no error.
# -&gt; Use tryCatch and you can nest those calls. note that d gets longer.


</code></pre>

<hr>
<h2 id='unitHydrograph'>Unit Hydrograph</h2><span id='topic+unitHydrograph'></span>

<h3>Description</h3>

<p>Calculate continuous unit hydrograph with given n and k 
(in the framework of the linear storage cascade)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>unitHydrograph(n, k, t, force = FALSE)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="unitHydrograph_+3A_n">n</code></td>
<td>
<p>Numeric. Number of storages in cascade.</p>
</td></tr>
<tr><td><code id="unitHydrograph_+3A_k">k</code></td>
<td>
<p>Numeric. Storage coefficient [1/s] (resistance to let water run out). High damping = slowly reacting landscape = high soil water absorbtion = high k.</p>
</td></tr>
<tr><td><code id="unitHydrograph_+3A_t">t</code></td>
<td>
<p>Numeric, possibly a vector. Time [s].</p>
</td></tr>
<tr><td><code id="unitHydrograph_+3A_force">force</code></td>
<td>
<p>Logical: Force the integral of the hydrograph to be 1? DEFAULT: FALSE</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector with the unit hydrograph along t
</p>


<h3>Note</h3>

<p>The sum under the UH should always be 1 (if t is long enough). 
This needs yet to be checked...
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, July 2013
</p>


<h3>See Also</h3>

<p><code><a href="#topic+lsc">lsc</a></code> on how to estimate n and k for a given discharge dataset. 
<code>deconvolution.uh</code> in the package hydromad, <a href="https://hydromad.catchment.org/">https://hydromad.catchment.org/</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
Time &lt;- 0:100
plot(Time, unitHydrograph(n=2,  k=3, t=Time), type="l", las=1,
     main="Unit Hydrograph - linear storage cascade")
lines(Time, unitHydrograph(n=2,  k=8, t=Time), col=2)
lines(Time, unitHydrograph(n=5.5,k=8, t=Time), col=4)
text(c(12, 20, 50), c(0.1, 0.04, 0.025), c("n=2, k=3","n=2, k=8","n=5.5, k=8"),
     col=c(1,2,4), adj=0)

# try several parameters (e.g. in Monte Carlo Simulation to estimate
  # sensitivity of model towards slight differences/uncertainty in parameters):
nreps &lt;- 1e3 # 5e4 eg on faster computers
n &lt;- rnorm(nreps, mean=2, sd=0.8); n &lt;- n[n&gt;0]
k &lt;- rnorm(nreps, mean=8, sd=1.1); k &lt;- k[k&gt;0]
UH &lt;- sapply(1:nreps, function(i) unitHydrograph(n=n[i], k=k[i], t=Time))
UHquant &lt;- apply(UH, 1, quantile, probs=0:10/10, na.rm=TRUE)
if(interactive()) View(UHquant)

plot(Time, unitHydrograph(n=2, k=8, t=Time), type="l", ylim=c(0, 0.06), las=1)
# uncertainty intervals as semi-transparent bands:
for(i in 1:5)
   polygon(x=c(Time, rev(Time)), y=c(UHquant[i,], rev(UHquant[12-i,])),
           col=rgb(0,0,1, alpha=0.3), lty=0)

lines(Time, UHquant[6,], col=4)
lines(Time, unitHydrograph(n=2, k=8, t=Time))

# Label a few bands for clarity:
points(rep(24,3), UHquant[c(2,5,9),25], pch="+")
for(i in 1:3) text(25, UHquant[c(2,5,9)[i],25],
                        paste("Q", c(10,40,80)[i], sep=""), adj=-0.1, cex=0.7)
# And explain what they mean:
Explain &lt;- "Q80: 80% of the 50000 simulations are smaller than this value"
legend("topright", bty="n", legend=Explain)

# Some n and k values are cut off at the left, that explains the shift from the
# median of simulations relative to the n2k8 line.

</code></pre>

<hr>
<h2 id='write.tab'>write table with different defaults</h2><span id='topic+write.tab'></span>

<h3>Description</h3>

<p>calls write.table with (personally) useful default values for the arguments.
if <code>open=TRUE</code>, tries to open the file in the default txt viewer.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>write.tab(
  x,
  file = NULL,
  sep = "\t",
  name_rn = NULL,
  row.names = FALSE,
  col.names = !is.null(colnames(x)),
  quote = FALSE,
  fileEncoding = "UTF-8",
  open = TRUE,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="write.tab_+3A_x">x</code></td>
<td>
<p>Objekt to be written.</p>
</td></tr>
<tr><td><code id="write.tab_+3A_file">file</code></td>
<td>
<p>Filename. DEFAULT: NULL = [name of x].txt</p>
</td></tr>
<tr><td><code id="write.tab_+3A_sep">sep</code></td>
<td>
<p>Column separator. DEFAULT: &quot;\t&quot;</p>
</td></tr>
<tr><td><code id="write.tab_+3A_name_rn">name_rn</code></td>
<td>
<p>If not NULL, this will be used as the name for a prepended
column with the rownames. DEFAULT: NULL</p>
</td></tr>
<tr><td><code id="write.tab_+3A_row.names">row.names</code></td>
<td>
<p>Should rownames be written in a pre-column that will
mess up alignment with column names? 
Use <code>name_rn</code> instead. DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="write.tab_+3A_col.names">col.names</code></td>
<td>
<p>Should colnames be written? 
DEFAULT: TRUE if x has colnames</p>
</td></tr>
<tr><td><code id="write.tab_+3A_quote">quote</code></td>
<td>
<p>Write quatation marks around charstrings? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="write.tab_+3A_fileencoding">fileEncoding</code></td>
<td>
<p>Encoding of charstrings. DEFAULT: &quot;UTF-8&quot;</p>
</td></tr>
<tr><td><code id="write.tab_+3A_open">open</code></td>
<td>
<p>Try to open the output file? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="write.tab_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="utils.html#topic+write.table">write.table</a></code></p>
</td></tr>
</table>


<h3>Value</h3>

<p>full filename
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sep 2021
</p>


<h3>See Also</h3>

<p><code><a href="#topic+write.tab">write.tab</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Don't run on CRAN test machines:
## Not run: 
write.tab(iris)
write.tab(iris, "otherfile.txt")
write.tab(freeny)
write.tab(freeny, name_rn="Time")
unlink("iris.txt")
unlink("otherfile.txt")
unlink("freeny.txt")

## End(Not run)
</code></pre>

<hr>
<h2 id='yearPlot'>annual plot</h2><span id='topic+yearPlot'></span>

<h3>Description</h3>

<p>Visualize seasonality of time series
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yearPlot(
  dates,
  values,
  data,
  ylim = NULL,
  shift = 0,
  janline = TRUE,
  add = FALSE,
  months = substr(month.abb, 1, 1),
  xlab = "",
  ylab = "",
  zlab = "",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yearPlot_+3A_dates">dates</code></td>
<td>
<p>Dates, in any format coerced by <code><a href="base.html#topic+as.Date">as.Date</a></code>.</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_values">values</code></td>
<td>
<p>Values to be mapped in color with <code><a href="#topic+colPoints">colPoints</a></code></p>
</td></tr>
<tr><td><code id="yearPlot_+3A_data">data</code></td>
<td>
<p>Optional: data.frame from which to use dates and values.</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_ylim">ylim</code></td>
<td>
<p>(reverse) date range in numerical years. 
DEFAULT: NULL (computed from <code>dates</code> internally)</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_shift">shift</code></td>
<td>
<p>Number of days to move the year-break to.
E.g. shift=61 for German hydrological year (Nov to Oct). DEFAULT: 0</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_janline">janline</code></td>
<td>
<p>Logical: Should vertical line be plotted at
January 1st if <code>shift!=0</code>? DEFAULT: TRUE</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_add">add</code></td>
<td>
<p>Logical. Add to existing plot? DEFAULT: FALSE</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_months">months</code></td>
<td>
<p>Labels for the months. DEFAULT: J,F,M,A,M,J,J,A,S,O,N,D</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_xlab">xlab</code>, <code id="yearPlot_+3A_ylab">ylab</code>, <code id="yearPlot_+3A_zlab">zlab</code></td>
<td>
<p>Axis and legend labels. DEFAULT: &quot;&quot;</p>
</td></tr>
<tr><td><code id="yearPlot_+3A_...">...</code></td>
<td>
<p>Further arguments passed to <code><a href="#topic+colPoints">colPoints</a></code> like
legend, pch, main, xaxs, ...</p>
</td></tr>
</table>


<h3>Value</h3>

<p>invisible list with coordinates
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, Sept 2019
</p>


<h3>See Also</h3>

<p><code><a href="#topic+seasonality">seasonality</a></code>, <code><a href="#topic+colPoints">colPoints</a></code>,
</p>


<h3>Examples</h3>

<pre><code class='language-R'>qfile &lt;- system.file("extdata/discharge39072.csv", package="berryFunctions")
Q &lt;- read.table(qfile, skip=19, header=TRUE, sep=",", fill=TRUE)[,1:2]
Q$data &lt;- as.Date(Q$data)
yearPlot(data, last, data=Q)
yearPlot(as.Date(c("2011-06-07","2009-03-25")), 1:2, add=TRUE, pch=3, col=1, legend=FALSE)
yearPlot(data, last, data=Q, shift=61)
yearPlot(data, last, data=Q, ylim=c(2015,2001))

</code></pre>

<hr>
<h2 id='yearSample'>Nonrandom year with sample</h2><span id='topic+yearSample'></span>

<h3>Description</h3>

<p>Nerdy way to wish someone a happy new year by using sample
</p>


<h3>Usage</h3>

<pre><code class='language-R'>yearSample(year)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="yearSample_+3A_year">year</code></td>
<td>
<p>4 digit numerical year.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Nerdy way to wish someone a happy new year, eg:<br />
Have a great <br />
<code>set.seed(1244); sample(0:9,4,T)</code>
</p>


<h3>Value</h3>

<p><code><a href="base.html#topic+cat">cat</a></code>s command into the console that can be copypasted to anyone's R script.
</p>


<h3>Author(s)</h3>

<p>Berry Boessenkool, <a href="mailto:berry-b@gmx.de">berry-b@gmx.de</a>, April 2014
</p>


<h3>See Also</h3>

<p><code><a href="#topic+nameSample">nameSample</a></code> to impress with &quot;randomly&quot; finding a name,
<code><a href="base.html#topic+set.seed">set.seed</a></code>, <code><a href="base.html#topic+sample">sample</a></code>, <code><a href="base.html#topic+letters">letters</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
yearSample(2016)
# Have a nerdy
set.seed(12353); sample(0:9, 4, replace=TRUE)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
