<!DOCTYPE html><html lang="en"><head><title>Help for package gdverse</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gdverse}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#+25+26gt+3B+25'><p>Pipe operator</p></a></li>
<li><a href='#all2int'><p>convert all discretized vectors to integer</p></a></li>
<li><a href='#cpsd_disc'><p>optimal spatial data discretization based on SPADE q-statistics</p></a></li>
<li><a href='#cpsd_spade'><p>compensated power of spatial determinant(CPSD)</p></a></li>
<li><a href='#ecological_detector'><p>ecological detector</p></a></li>
<li><a href='#F_informationloss'><p>measure information loss by information entropy</p></a></li>
<li><a href='#factor_detector'><p>factor detector</p></a></li>
<li><a href='#gd'><p>native geographical detector(GD) model</p></a></li>
<li><a href='#gd_optunidisc'><p>optimal univariate discretization based on geodetector q-statistic</p></a></li>
<li><a href='#gen_permutations'><p>generate permutations</p></a></li>
<li><a href='#geodetector'><p>geographical detector</p></a></li>
<li><a href='#gozh'><p>geographically optimal zones-based heterogeneity(GOZH) model</p></a></li>
<li><a href='#gozh_detector'><p>geographically optimal zones-based heterogeneity detector</p></a></li>
<li><a href='#idsa'><p>interactive detector for spatial associations(IDSA) model</p></a></li>
<li><a href='#interaction_detector'><p>interaction detector</p></a></li>
<li><a href='#lesh'><p>locally explained stratified heterogeneity(LESH) model</p></a></li>
<li><a href='#loess_optscale'><p>determine optimal spatial data analysis scale</p></a></li>
<li><a href='#ndvi'><p>dataset of NDVI changes and its influencing factors</p></a></li>
<li><a href='#NTDs'><p>NTDs data</p></a></li>
<li><a href='#opgd'><p>optimal parameters-based geographical detector(OPGD) model</p></a></li>
<li><a href='#pid_idsa'><p>IDSA Q-saistics <code>PID</code></p></a></li>
<li><a href='#plot.ecological_detector'><p>plot ecological detector</p></a></li>
<li><a href='#plot.factor_detector'><p>plot factor detector result</p></a></li>
<li><a href='#plot.gd_result'><p>plot GD result</p></a></li>
<li><a href='#plot.gozh_result'><p>plot GOZH result</p></a></li>
<li><a href='#plot.idsa_result'><p>plot IDSA risk result</p></a></li>
<li><a href='#plot.interaction_detector'><p>plot interaction detector result</p></a></li>
<li><a href='#plot.lesh_result'><p>plot LESH model result</p></a></li>
<li><a href='#plot.opgd_result'><p>plot OPGD result</p></a></li>
<li><a href='#plot.rgd_result'><p>plot RGD result</p></a></li>
<li><a href='#plot.rid_result'><p>plot RID result</p></a></li>
<li><a href='#plot.risk_detector'><p>plot risk detector</p></a></li>
<li><a href='#plot.sesu_gozh'><p>plot gozh sesu</p></a></li>
<li><a href='#plot.sesu_opgd'><p>plot opgd sesu</p></a></li>
<li><a href='#plot.spade_result'><p>plot SPADE power of spatial and multilevel discretization determinant</p></a></li>
<li><a href='#plot.srs_ecological_detector'><p>plot spatial rough set-based ecological detector</p></a></li>
<li><a href='#plot.srs_factor_detector'><p>plot spatial rough set-based factor detector result</p></a></li>
<li><a href='#plot.srs_interaction_detector'><p>plot spatial rough set-based interaction detector result</p></a></li>
<li><a href='#plot.srsgd_result'><p>plot SRSGD result</p></a></li>
<li><a href='#print.ecological_detector'><p>print ecological detector</p></a></li>
<li><a href='#print.factor_detector'><p>print factor detector</p></a></li>
<li><a href='#print.gd_result'><p>print GD result</p></a></li>
<li><a href='#print.gozh_result'><p>print GOZH result</p></a></li>
<li><a href='#print.idsa_result'><p>print IDSA result</p></a></li>
<li><a href='#print.interaction_detector'><p>print interaction detector</p></a></li>
<li><a href='#print.lesh_result'><p>print LESH model interaction result</p></a></li>
<li><a href='#print.opgd_result'><p>print OPGD result</p></a></li>
<li><a href='#print.rgd_result'><p>print RGD result</p></a></li>
<li><a href='#print.rid_result'><p>print RID result</p></a></li>
<li><a href='#print.risk_detector'><p>print risk detector</p></a></li>
<li><a href='#print.sesu_gozh'><p>print gozh sesu</p></a></li>
<li><a href='#print.sesu_opgd'><p>print opgd sesu</p></a></li>
<li><a href='#print.spade_result'><p>print SPADE power of spatial and multilevel discretization determinant</p></a></li>
<li><a href='#print.srs_ecological_detector'><p>print spatial rough set-based ecological detector</p></a></li>
<li><a href='#print.srs_factor_detector'><p>print spatial rough set-based factor detector</p></a></li>
<li><a href='#print.srs_interaction_detector'><p>print spatial rough set-based interaction detector</p></a></li>
<li><a href='#print.srsgd_result'><p>print SRSGD result</p></a></li>
<li><a href='#psd_iev'><p>PSD of an interaction of explanatory variables (PSD-IEV)</p></a></li>
<li><a href='#psd_pseudop'><p>calculate power of spatial determinant(PSD) and the corresponding pseudo-p value</p></a></li>
<li><a href='#psd_spade'><p>power of spatial determinant(PSD)</p></a></li>
<li><a href='#psmd_pseudop'><p>power of spatial and multilevel discretization determinant(PSMD) and the corresponding pseudo-p value</p></a></li>
<li><a href='#psmd_spade'><p>power of spatial and multilevel discretization determinant(PSMD)</p></a></li>
<li><a href='#rgd'><p>robust geographical detector(RGD) model</p></a></li>
<li><a href='#rid'><p>robust interaction detector(RID) model</p></a></li>
<li><a href='#risk_detector'><p>risk detector</p></a></li>
<li><a href='#robust_disc'><p>univariate discretization based on offline change point detection</p></a></li>
<li><a href='#rpart_disc'><p>discretization of variables based on recursive partitioning</p></a></li>
<li><a href='#sesu_gozh'><p>comparison of size effects of spatial units based on GOZH</p></a></li>
<li><a href='#sesu_opgd'><p>comparison of size effects of spatial units based on OPGD</p></a></li>
<li><a href='#sim'><p>Simulation data.</p></a></li>
<li><a href='#spade'><p>spatial association detector (SPADE) model</p></a></li>
<li><a href='#spd_lesh'><p>shap power of determinants</p></a></li>
<li><a href='#srs_ecological_detector'><p>spatial rough set-based ecological detector</p></a></li>
<li><a href='#srs_factor_detector'><p>spatial rough set-based factor detector</p></a></li>
<li><a href='#srs_geodetector'><p>spatial rough set-based geographical detector</p></a></li>
<li><a href='#srs_interaction_detector'><p>spatial rough set-based interaction detector</p></a></li>
<li><a href='#srs_table'><p>example of spatial information system table</p></a></li>
<li><a href='#srs_wt'><p>example of spatial information system spatial adjacency matrix</p></a></li>
<li><a href='#srsgd'><p>spatial rough set-based geographical detector(SRSGD) model</p></a></li>
<li><a href='#weight_assign'><p>assign values by weight</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Title:</td>
<td>Analysis of Spatial Stratified Heterogeneity</td>
</tr>
<tr>
<td>Version:</td>
<td>1.3-2</td>
</tr>
<tr>
<td>Description:</td>
<td>Analyzing spatial factors and exploring spatial associations based on the concept of spatial stratified heterogeneity, while also taking into account local spatial dependencies, spatial interpretability, complex spatial interactions, and robust spatial stratification. Additionally, it supports the spatial stratified heterogeneity family established in academic literature.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.2</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://stscl.github.io/gdverse/">https://stscl.github.io/gdverse/</a>, <a href="https://github.com/stscl/gdverse">https://github.com/stscl/gdverse</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stscl/gdverse/issues">https://github.com/stscl/gdverse/issues</a></td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 4.1.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, forcats, ggplot2, magrittr, parallel, patchwork, purrr,
reticulate, rpart, scatterpie, sdsfun (&ge; 0.7.0), sf, stats,
tibble, tidyr, utils</td>
</tr>
<tr>
<td>Suggests:</td>
<td>cowplot, itmsa, knitr, Rcpp, readr, rmarkdown, terra,
testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2025-02-17 08:15:32 UTC; dell</td>
</tr>
<tr>
<td>Author:</td>
<td>Wenbo Lv <a href="https://orcid.org/0009-0002-6003-3800"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre, cph],
  Yangyang Lei <a href="https://orcid.org/0009-0002-6518-3613"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [aut],
  Fangmei Liu <a href="https://orcid.org/0009-0008-8634-7588"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Jianwu Yan <a href="https://orcid.org/0000-0001-9411-8453"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Yongze Song <a href="https://orcid.org/0000-0003-3420-9622"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut],
  Wufan Zhao <a href="https://orcid.org/0000-0002-0265-3465"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Wenbo Lv &lt;lyu.geosocial@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2025-02-17 09:00:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>See <code>magrittr::<a href="magrittr.html#topic+pipe">%&gt;%</a></code> for details.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>


<h3>Value</h3>

<p><code>NULL</code> (this is the magrittr pipe operator)
</p>

<hr>
<h2 id='all2int'>convert all discretized vectors to integer</h2><span id='topic+all2int'></span>

<h3>Description</h3>

<p>convert all discretized vectors to integer
</p>


<h3>Usage</h3>

<pre><code class='language-R'>all2int(x)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="all2int_+3A_x">x</code></td>
<td>
<p>A discretized vector.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An integer vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>all2int(factor(letters[1:3],levels = c('b','a','c')))
all2int(letters[1:3])

</code></pre>

<hr>
<h2 id='cpsd_disc'>optimal spatial data discretization based on SPADE q-statistics</h2><span id='topic+cpsd_disc'></span>

<h3>Description</h3>

<p>Function for determining the optimal spatial data discretization based on SPADE q-statistics.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpsd_disc(
  formula,
  data,
  wt,
  discnum = 3:8,
  discmethod = "quantile",
  strategy = 2L,
  increase_rate = 0.05,
  cores = 1,
  seed = 123456789,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpsd_disc_+3A_formula">formula</code></td>
<td>
<p>A formula of optimal spatial data discretization.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_discnum">discnum</code></td>
<td>
<p>(optional) A vector of number of classes for discretization. Default is <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) The discretization methods. Default all use <code>quantile</code>.
Noted that  <code>rpart</code> will use <code>rpart_disc()</code>; Others use <code>sdsfun::discretize_vector()</code>.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_strategy">strategy</code></td>
<td>
<p>(optional) Discretization strategy. When <code>strategy</code> is <code>1L</code>, choose the highest SPADE model q-statistics to
determinate optimal spatial data discretization parameters. When <code>strategy</code> is <code>2L</code>, The optimal discrete parameters of
spatial data are selected by combining LOESS model.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="cpsd_disc_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>sdsfun::discretize_vector()</code> or <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>x</code></dt><dd><p>discretization variable name</p>
</dd>
<dt><code>k</code></dt><dd><p>optimal number of spatial data discreteization</p>
</dd>
<dt><code>method</code></dt><dd><p>optimal spatial data discretization method</p>
</dd>
<dt><code>disc</code></dt><dd><p>the result of optimal spatial data discretization</p>
</dd>
</dl>



<h3>Note</h3>

<p>When the <code>discmethod</code> is configured to <code>robust</code>, it will operate at a significantly reduced speed.
Consequently, the use of robust discretization is not advised.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Yongze Song &amp; Peng Wu (2021) An interactive detector for spatial associations,
International Journal of Geographical Information Science, 35:8, 1676-1701,
DOI:10.1080/13658816.2021.1882680
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
cpsd_disc(y ~ xa + xb + xc, data = sim, wt = wt)

</code></pre>

<hr>
<h2 id='cpsd_spade'>compensated power of spatial determinant(CPSD)</h2><span id='topic+cpsd_spade'></span>

<h3>Description</h3>

<p>Function for calculate compensated power of spatial determinant <code>Q_s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpsd_spade(yobs, xobs, xdisc, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cpsd_spade_+3A_yobs">yobs</code></td>
<td>
<p>Variable Y</p>
</td></tr>
<tr><td><code id="cpsd_spade_+3A_xobs">xobs</code></td>
<td>
<p>The original undiscretized covariable X.</p>
</td></tr>
<tr><td><code id="cpsd_spade_+3A_xdisc">xdisc</code></td>
<td>
<p>The discretized covariable X.</p>
</td></tr>
<tr><td><code id="cpsd_spade_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of compensated spatial determinant formula is
</p>
<p><code class="reqn">Q_s = \frac{q_s}{q_{s_{inforkep}}}
= \frac{1 - \frac{\sum_{h=1}^L N_h \Gamma_{kdep}}{N \Gamma_{totaldep}}}{1 - \frac{\sum_{h=1}^L N_h \Gamma_{hind}}{N \Gamma_{totalind}}}</code>
</p>


<h3>Value</h3>

<p>A value of compensated power of spatial determinant <code>Q_s</code>.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
xa = sim$xa
xa_disc = sdsfun::discretize_vector(xa,5)
cpsd_spade(sim$y,xa,xa_disc,wt)

</code></pre>

<hr>
<h2 id='ecological_detector'>ecological detector</h2><span id='topic+ecological_detector'></span>

<h3>Description</h3>

<p>Compare the effects of two factors <code class="reqn">X_1</code> and <code class="reqn">X_2</code> on the spatial distribution of the attribute <code class="reqn">Y</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ecological_detector(y, x1, x2, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="ecological_detector_+3A_y">y</code></td>
<td>
<p>Dependent variable, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="ecological_detector_+3A_x1">x1</code></td>
<td>
<p>Covariate <code class="reqn">X_1</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="ecological_detector_+3A_x2">x2</code></td>
<td>
<p>Covariate <code class="reqn">X_2</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="ecological_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level of the interval,default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>F-statistic</code></dt><dd><p>the result of F statistic for ecological detector</p>
</dd>
<dt><code>P-value</code></dt><dd><p>the result of P value for ecological detector</p>
</dd>
<dt><code>Ecological</code></dt><dd><p>is there a significant difference between the two factors <code class="reqn">X_1</code> and <code class="reqn">X_2</code> on the spatial distribution of the attribute <code class="reqn">Y</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>ecological_detector(y = 1:7,
                    x1 = c('x',rep('y',3),rep('z',3)),
                    x2 = c(rep('a',2),rep('b',2),rep('c',3)))

</code></pre>

<hr>
<h2 id='F_informationloss'>measure information loss by information entropy</h2><span id='topic+F_informationloss'></span>

<h3>Description</h3>

<p>Function for measure information loss by shannon information entropy.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>F_informationloss(xvar, xdisc)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="F_informationloss_+3A_xvar">xvar</code></td>
<td>
<p>The original undiscretized vector.</p>
</td></tr>
<tr><td><code id="F_informationloss_+3A_xdisc">xdisc</code></td>
<td>
<p>The discretized vector.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The information loss measured by information entropy formula is
<code class="reqn">F = -\sum\limits_{i=1}^N p_{(i)}\log_2 p_{(i)} - \left(-\sum\limits_{h=1}^L p_{(h)}\log_2 p_{(h)}\right)</code>
</p>


<h3>Value</h3>

<p>A numeric value of information loss measured by information entropy.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>F_informationloss(1:7,c('x',rep('y',3),rep('z',3)))

</code></pre>

<hr>
<h2 id='factor_detector'>factor detector</h2><span id='topic+factor_detector'></span>

<h3>Description</h3>

<p>The factor detector q-statistic measures the spatial stratified heterogeneity of a
variable Y, or the determinant power of a covariate X of Y.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>factor_detector(y, x, confintv = FALSE, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="factor_detector_+3A_y">y</code></td>
<td>
<p>Variable Y, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="factor_detector_+3A_x">x</code></td>
<td>
<p>Covariate X, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="factor_detector_+3A_confintv">confintv</code></td>
<td>
<p>(optional) Whether to compute the confidence interval for the q statistic,
default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="factor_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level of the interval, default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>Q-statistic</code></dt><dd><p>the q statistic for factor detector</p>
</dd>
<dt><code>P-value</code></dt><dd><p>the p value for factor detector</p>
</dd>
<dt><code>CIL</code></dt><dd><p>the confidence interval lower bound</p>
</dd>
<dt><code>CIU</code></dt><dd><p>the confidence interval upper bound</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>factor_detector(y = 1:7,x = c('x',rep('y',3),rep('z',3)))

</code></pre>

<hr>
<h2 id='gd'>native geographical detector(GD) model</h2><span id='topic+gd'></span>

<h3>Description</h3>

<p>native geographical detector(GD) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gd(formula, data, type = "factor", alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gd_+3A_formula">formula</code></td>
<td>
<p>A formula of geographical detector model.</p>
</td></tr>
<tr><td><code id="gd_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="gd_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be one of <code>factor</code>(default),
<code>interaction</code>, <code>risk</code>, <code>ecological</code>. You can run one or more types at one time.</p>
</td></tr>
<tr><td><code id="gd_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of the alpha (confidence level). Default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of interaction detector</p>
</dd>
<dt><code>risk</code></dt><dd><p>the result of risk detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of ecological detector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Jin‐Feng Wang, Xin‐Hu Li, George Christakos, Yi‐Lan Liao, Tin Zhang, XueGu &amp; Xiao‐Ying Zheng (2010)
Geographical Detectors‐Based Health Risk Assessment and its Application in the Neural Tube Defects Study
of the Heshun Region, China, International Journal of Geographical Information Science, 24:1, 107-127,
DOI: 10.1080/13658810802443457
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data("NTDs")
g = gd(incidence ~ watershed + elevation + soiltype,
       data = NTDs,type = c('factor','interaction'))
g

</code></pre>

<hr>
<h2 id='gd_optunidisc'>optimal univariate discretization based on geodetector q-statistic</h2><span id='topic+gd_optunidisc'></span>

<h3>Description</h3>

<p>optimal univariate discretization based on geodetector q-statistic
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gd_optunidisc(
  formula,
  data,
  discnum = 3:8,
  discmethod = c("sd", "equal", "geometric", "quantile", "natural"),
  cores = 1,
  seed = 123456789,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gd_optunidisc_+3A_formula">formula</code></td>
<td>
<p>A formula.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_discnum">discnum</code></td>
<td>
<p>(optional) A vector of numbers of discretization. Default is <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) A vector of methods for discretization, default is using
<code>c("sd","equal","geometric","quantile","natural")</code> by invoking <code>sdsfun</code>.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="gd_optunidisc_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>sdsfun::discretize_vector()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>x</code></dt><dd><p>the name of the variable that needs to be discretized</p>
</dd>
<dt><code>k</code></dt><dd><p>optimal discretization number</p>
</dd>
<dt><code>method</code></dt><dd><p>optimal discretization method</p>
</dd>
<dt><code>qstatistic</code></dt><dd><p>optimal q-statistic</p>
</dd>
<dt><code>disc</code></dt><dd><p>optimal discretization results</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
gd_optunidisc(y ~ xa + xb + xc,
              data = sim,
              discnum = 3:6)

</code></pre>

<hr>
<h2 id='gen_permutations'>generate permutations</h2><span id='topic+gen_permutations'></span>

<h3>Description</h3>

<p>generate permutations
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gen_permutations(x, seed = 123456789)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gen_permutations_+3A_x">x</code></td>
<td>
<p>A vector.</p>
</td></tr>
<tr><td><code id="gen_permutations_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number. Default is <code>123456789</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A permutations vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>gen_permutations(1:100,42)

</code></pre>

<hr>
<h2 id='geodetector'>geographical detector</h2><span id='topic+geodetector'></span>

<h3>Description</h3>

<p>geographical detector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>geodetector(formula, data, type = "factor", alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="geodetector_+3A_formula">formula</code></td>
<td>
<p>A formula of geographical detector model.</p>
</td></tr>
<tr><td><code id="geodetector_+3A_data">data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td></tr>
<tr><td><code id="geodetector_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be one of <code>factor</code>(default),
<code>interaction</code>, <code>risk</code>, <code>ecological</code>.</p>
</td></tr>
<tr><td><code id="geodetector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of the alpha (confidence level). Default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of interaction detector</p>
</dd>
<dt><code>risk</code></dt><dd><p>the result of risk detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of ecological detector</p>
</dd>
</dl>



<h3>Note</h3>

<p>Note that only one type of geodetector is supported at a time in <code>geodetector()</code>.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>geodetector(y ~ x1 + x2,
   tibble::tibble(y = 1:7,
                  x1 = c('x',rep('y',3),rep('z',3)),
                  x2 = c(rep('a',2),rep('b',2),rep('c',3))))

geodetector(y ~ x1 + x2,
   tibble::tibble(y = 1:7,
                  x1 = c('x',rep('y',3),rep('z',3)),
                  x2 = c(rep('a',2),rep('b',2),rep('c',3))),
   type = 'interaction')

geodetector(y ~ x1 + x2,
   tibble::tibble(y = 1:7,
                  x1 = c('x',rep('y',3),rep('z',3)),
                  x2 = c(rep('a',2),rep('b',2),rep('c',3))),
   type = 'risk',alpha = 0.95)

geodetector(y ~ x1 + x2,
   tibble::tibble(y = 1:7,
                  x1 = c('x',rep('y',3),rep('z',3)),
                  x2 = c(rep('a',2),rep('b',2),rep('c',3))),
   type = 'ecological',alpha = 0.95)

</code></pre>

<hr>
<h2 id='gozh'>geographically optimal zones-based heterogeneity(GOZH) model</h2><span id='topic+gozh'></span>

<h3>Description</h3>

<p>geographically optimal zones-based heterogeneity(GOZH) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gozh(formula, data, cores = 1, type = "factor", alpha = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gozh_+3A_formula">formula</code></td>
<td>
<p>A formula of GOZH model.</p>
</td></tr>
<tr><td><code id="gozh_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="gozh_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="gozh_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be <code>factor</code>(default),
<code>interaction</code>, <code>risk</code>, <code>ecological</code>. You can run one or more types at one time.</p>
</td></tr>
<tr><td><code id="gozh_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="gozh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of interaction detector</p>
</dd>
<dt><code>risk</code></dt><dd><p>the result of risk detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of ecological detector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Luo, P., Song, Y., Huang, X., Ma, H., Liu, J., Yao, Y., &amp; Meng, L. (2022). Identifying determinants of
spatio-temporal disparities in soil moisture of the Northern Hemisphere using a geographically optimal
zones-based heterogeneity model. ISPRS Journal of Photogrammetry and Remote Sensing: Official
Publication of the International Society for Photogrammetry and Remote Sensing (ISPRS), 185, 111–128.
https://doi.org/10.1016/j.isprsjprs.2022.01.009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ndvi')
g = gozh(NDVIchange ~ ., data = ndvi)
g

</code></pre>

<hr>
<h2 id='gozh_detector'>geographically optimal zones-based heterogeneity detector</h2><span id='topic+gozh_detector'></span>

<h3>Description</h3>

<p>Function for geographically optimal zones-based heterogeneity detector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>gozh_detector(formula, data, cores = 1, type = "factor", alpha = 0.95, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="gozh_detector_+3A_formula">formula</code></td>
<td>
<p>A formula of GOZH detector.</p>
</td></tr>
<tr><td><code id="gozh_detector_+3A_data">data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td></tr>
<tr><td><code id="gozh_detector_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="gozh_detector_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector,which must be one of <code>factor</code>(default),
<code>interaction</code>, <code>risk</code>, <code>ecological</code>.</p>
</td></tr>
<tr><td><code id="gozh_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level of the interval,default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="gozh_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list of tibble with the corresponding result under different detector types.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of interaction detector</p>
</dd>
<dt><code>risk</code></dt><dd><p>the result of risk detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of ecological detector</p>
</dd>
</dl>



<h3>Note</h3>

<p>Only one type of detector is supported in a <code>gozh_detector()</code> run at a time.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Luo, P., Song, Y., Huang, X., Ma, H., Liu, J., Yao, Y., &amp; Meng, L. (2022). Identifying determinants of
spatio-temporal disparities in soil moisture of the Northern Hemisphere using a geographically optimal
zones-based heterogeneity model. ISPRS Journal of Photogrammetry and Remote Sensing: Official
Publication of the International Society for Photogrammetry and Remote Sensing (ISPRS), 185, 111–128.
https://doi.org/10.1016/j.isprsjprs.2022.01.009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ndvi')
g = gozh_detector(NDVIchange ~ ., data = ndvi)
g

</code></pre>

<hr>
<h2 id='idsa'>interactive detector for spatial associations(IDSA) model</h2><span id='topic+idsa'></span>

<h3>Description</h3>

<p>interactive detector for spatial associations(IDSA) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>idsa(
  formula,
  data,
  wt = NULL,
  discnum = 3:8,
  discmethod = "quantile",
  overlay = "and",
  strategy = 2L,
  increase_rate = 0.05,
  cores = 1,
  seed = 123456789,
  alpha = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="idsa_+3A_formula">formula</code></td>
<td>
<p>A formula of IDSA model.</p>
</td></tr>
<tr><td><code id="idsa_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="idsa_+3A_wt">wt</code></td>
<td>
<p>(optional) The spatial weight matrix. When <code>data</code> is not an <code>sf</code> object, must provide <code>wt</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_discnum">discnum</code></td>
<td>
<p>(optional) Number of multilevel discretization. Default will use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) The discretization methods. Default all use <code>quantile</code>.
Noted that  <code>rpart</code> will use <code>rpart_disc()</code>; Others use <code>sdsfun::discretize_vector()</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_overlay">overlay</code></td>
<td>
<p>(optional) Spatial overlay method. One of <code>and</code>, <code>or</code>, <code>intersection</code>.
Default is <code>and</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_strategy">strategy</code></td>
<td>
<p>(optional) Discretization strategy. When <code>strategy</code> is <code>1L</code>, choose the highest SPADE model q-statistics to
determinate optimal spatial data discretization parameters. When <code>strategy</code> is <code>2L</code>, The optimal discrete parameters of
spatial data are selected by combining LOESS model.</p>
</td></tr>
<tr><td><code id="idsa_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="idsa_+3A_seed">seed</code></td>
<td>
<p>(optional) Random number seed, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="idsa_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>cpsd_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>interaction</code></dt><dd><p>the interaction result of IDSA model</p>
</dd>
<dt><code>risk</code></dt><dd><p>whether values of the response variable between a pair of overlay zones are significantly different</p>
</dd>
<dt><code>number_individual_explanatory_variables</code></dt><dd><p>the number of individual explanatory variables used for examining the interaction effects</p>
</dd>
<dt><code>number_overlay_zones</code></dt><dd><p>the number of overlay zones</p>
</dd>
<dt><code>percentage_finely_divided_zones</code></dt><dd><p>the percentage of finely divided zones that are determined by the interaction of variables</p>
</dd>
</dl>



<h3>Note</h3>

<p><strong>Please note that all variables in the IDSA model need to be continuous data</strong>.
</p>
<p>The IDSA model requires at least <code class="reqn">2^n-1</code> calculations when has <code class="reqn">n</code> explanatory variables.
When there are more than 10 explanatory variables, carefully consider the computational burden of this model.
When there are a large number of explanatory variables, the data dimensionality reduction method can be used
to ensure the trade-off between analysis results and calculation speed.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Yongze Song &amp; Peng Wu (2021) An interactive detector for spatial associations,
International Journal of Geographical Information Science, 35:8, 1676-1701,
DOI:10.1080/13658816.2021.1882680
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
sim1 = sf::st_as_sf(sim,coords = c('lo','la'))
g = idsa(y ~ ., data = sim1)
g

</code></pre>

<hr>
<h2 id='interaction_detector'>interaction detector</h2><span id='topic+interaction_detector'></span>

<h3>Description</h3>

<p>Identify the interaction between different risk factors, that is, assess whether factors X1 and X2 together
increase or decrease the explanatory power of the dependent variable Y, or whether the effects of these factors
on Y are independent of each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>interaction_detector(y, x1, x2)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="interaction_detector_+3A_y">y</code></td>
<td>
<p>Dependent variable, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="interaction_detector_+3A_x1">x1</code></td>
<td>
<p>Covariate <code class="reqn">X_1</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="interaction_detector_+3A_x2">x2</code></td>
<td>
<p>Covariate <code class="reqn">X_2</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>Variable1 Q-statistics</code></dt><dd><p>Q-statistics for variable1</p>
</dd>
<dt><code>Variable2 Q-statistics</code></dt><dd><p>Q-statistics for variable2</p>
</dd>
<dt><code>Variable1 and Variable2 interact Q-statistics</code></dt><dd><p>Q-statistics for variable1 and variable2 interact</p>
</dd>
<dt><code>Interaction</code></dt><dd><p>the interact result type</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>interaction_detector(y = 1:7,
                     x1 = c('x',rep('y',3),rep('z',3)),
                     x2 = c(rep('a',2),rep('b',2),rep('c',3)))

</code></pre>

<hr>
<h2 id='lesh'>locally explained stratified heterogeneity(LESH) model</h2><span id='topic+lesh'></span>

<h3>Description</h3>

<p>locally explained stratified heterogeneity(LESH) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lesh(formula, data, cores = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="lesh_+3A_formula">formula</code></td>
<td>
<p>A formula of LESH model.</p>
</td></tr>
<tr><td><code id="lesh_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="lesh_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="lesh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>interaction</code></dt><dd><p>the interaction result of LESH model</p>
</dd>
<dt><code>spd_lesh</code></dt><dd><p>a tibble of the shap power of determinants</p>
</dd>
</dl>



<h3>Note</h3>

<p>The LESH model requires at least <code class="reqn">2^n-1</code> calculations when has <code class="reqn">n</code> explanatory variables.
When there are more than 10 explanatory variables, carefully consider the computational burden of this model.
When there are a large number of explanatory variables, the data dimensionality reduction method can be used
to ensure the trade-off between analysis results and calculation speed.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Li, Y., Luo, P., Song, Y., Zhang, L., Qu, Y., &amp; Hou, Z. (2023). A locally explained heterogeneity model for
examining wetland disparity. International Journal of Digital Earth, 16(2), 4533–4552.
https://doi.org/10.1080/17538947.2023.2271883
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ndvi')
g = lesh(NDVIchange ~ ., data = ndvi)
g

</code></pre>

<hr>
<h2 id='loess_optscale'>determine optimal spatial data analysis scale</h2><span id='topic+loess_optscale'></span>

<h3>Description</h3>

<p>Function for determining optimal spatial data analysis scale based on locally
estimated scatter plot smoothing (LOESS) model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>loess_optscale(qvec, spscalevec, increase_rate = 0.05)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="loess_optscale_+3A_qvec">qvec</code></td>
<td>
<p>A numeric vector of q statistics.</p>
</td></tr>
<tr><td><code id="loess_optscale_+3A_spscalevec">spscalevec</code></td>
<td>
<p>A numeric vector of spatial scales corresponding to <code>qvec</code>.</p>
</td></tr>
<tr><td><code id="loess_optscale_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric vector about optimal number of spatial scale and the critical
increase rate of q value.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code takes a long time to run:
library(tidyverse)
fvcpath = "https://github.com/SpatLyu/rdevdata/raw/main/FVC.tif"
fvc = terra::rast(paste0("/vsicurl/",fvcpath))
fvc1000 = fvc %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
fvc5000 = fvc %&gt;%
  terra::aggregate(fact = 5) %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
qv1000 = factor_detector(fvc1000$fvc,
                         sdsfun::discretize_vector(fvc1000$premax,10,'quantile'))[[1]]
qv5000 = factor_detector(fvc5000$fvc,
                         sdsfun::discretize_vector(fvc5000$premax,10,'quantile'))[[1]]
loess_optscale(c(qv1000,qv5000),c(1000,5000))

## End(Not run)
</code></pre>

<hr>
<h2 id='ndvi'>dataset of NDVI changes and its influencing factors</h2><span id='topic+ndvi'></span>

<h3>Description</h3>

<p>dataset of NDVI changes and its influencing factors, modified from <code>GD</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>ndvi
</code></pre>


<h3>Format</h3>

<p><code>ndvi</code>: A tibble with 713 rows and 7 variables
</p>


<h3>Author(s)</h3>

<p>Yongze Song <a href="mailto:yongze.song@outlook.com">yongze.song@outlook.com</a>
</p>

<hr>
<h2 id='NTDs'>NTDs data</h2><span id='topic+NTDs'></span>

<h3>Description</h3>

<p>The data were obtained by preprocessing use <code>sf</code> and <code>tidyverse</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>NTDs
</code></pre>


<h3>Format</h3>

<p><code>NTDs</code>: A tibble with 185 rows and 4 variable columns and 2 location columns, modified from <code>geodetector</code> package.
</p>

<hr>
<h2 id='opgd'>optimal parameters-based geographical detector(OPGD) model</h2><span id='topic+opgd'></span>

<h3>Description</h3>

<p>optimal parameters-based geographical detector(OPGD) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>opgd(
  formula,
  data,
  discvar = NULL,
  discnum = 3:8,
  discmethod = c("sd", "equal", "geometric", "quantile", "natural"),
  cores = 1,
  type = "factor",
  alpha = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="opgd_+3A_formula">formula</code></td>
<td>
<p>A formula of OPGD model.</p>
</td></tr>
<tr><td><code id="opgd_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="opgd_+3A_discvar">discvar</code></td>
<td>
<p>Name of continuous variable columns that need to be discretized. Noted that
when <code>formula</code> has <code>discvar</code>, <code>data</code> must have these columns. By default, all independent
variables are used as <code>discvar</code>.</p>
</td></tr>
<tr><td><code id="opgd_+3A_discnum">discnum</code></td>
<td>
<p>(optional) A vector of number of classes for discretization. Default is <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="opgd_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) A vector of methods for discretization, default is using
<code>c("sd","equal","geometric","quantile","natural")</code> by invoking <code>sdsfun</code>.</p>
</td></tr>
<tr><td><code id="opgd_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="opgd_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be <code>factor</code>(default),
<code>interaction</code>, <code>risk</code>, <code>ecological</code>. You can run one or more types at one time.</p>
</td></tr>
<tr><td><code id="opgd_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="opgd_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>gd_optunidisc()</code>. A useful parameter is <code>seed</code>,
which is used to set the random number seed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>opt_param</code></dt><dd><p>optimal discretization parameter</p>
</dd>
<dt><code>factor</code></dt><dd><p>the result of factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of interaction detector</p>
</dd>
<dt><code>risk</code></dt><dd><p>the result of risk detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of ecological detector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) An optimal parameters-based geographical detector
model enhances geographic characteristics of explanatory variables for spatial heterogeneity
analysis: Cases with different types of spatial data, GIScience &amp; Remote Sensing, 57(5), 593-610.
doi: 10.1080/15481603.2020.1760434.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
opgd(y ~ xa + xb + xc, data = sim,
     discvar = paste0('x',letters[1:3]),
     discnum = 3:6)

</code></pre>

<hr>
<h2 id='pid_idsa'>IDSA Q-saistics <code>PID</code></h2><span id='topic+pid_idsa'></span>

<h3>Description</h3>

<p>IDSA Q-saistics <code>PID</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>pid_idsa(formula, rawdata, discdata, wt, overlaymethod = "and")
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="pid_idsa_+3A_formula">formula</code></td>
<td>
<p>A formula for IDSA Q-saistics</p>
</td></tr>
<tr><td><code id="pid_idsa_+3A_rawdata">rawdata</code></td>
<td>
<p>Raw observation data</p>
</td></tr>
<tr><td><code id="pid_idsa_+3A_discdata">discdata</code></td>
<td>
<p>Observed data with discrete explanatory variables</p>
</td></tr>
<tr><td><code id="pid_idsa_+3A_wt">wt</code></td>
<td>
<p>Spatial weight matrix</p>
</td></tr>
<tr><td><code id="pid_idsa_+3A_overlaymethod">overlaymethod</code></td>
<td>
<p>(optional) Spatial overlay method. One of <code>and</code>, <code>or</code>, <code>intersection</code>.
Default is <code>and</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">Q_{IDSA} = \frac{\theta_r}{\phi}</code>
</p>


<h3>Value</h3>

<p>The value of IDSA Q-saistics <code>PID</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
sim1 = dplyr::mutate(sim,dplyr::across(xa:xc,\(.x) sdsfun::discretize_vector(.x,5)))
pid_idsa(y ~ xa + xb + xc, rawdata = sim,
         discdata = sim1, wt = wt)

</code></pre>

<hr>
<h2 id='plot.ecological_detector'>plot ecological detector</h2><span id='topic+plot.ecological_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for ecological detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ecological_detector'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.ecological_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="plot.ecological_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.factor_detector'>plot factor detector result</h2><span id='topic+plot.factor_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for factor detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'factor_detector'
plot(x, slicenum = 2, alpha = 0.95, keep = TRUE, qlabelsize = 3.88, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.factor_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="plot.factor_detector_+3A_slicenum">slicenum</code></td>
<td>
<p>(optional) The number of labels facing inward. Default is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.factor_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot.factor_detector_+3A_keep">keep</code></td>
<td>
<p>(optional) Whether to keep Q-value results for insignificant variables,
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.factor_detector_+3A_qlabelsize">qlabelsize</code></td>
<td>
<p>(optional) Set the font size of the q-value text labels in the plot.</p>
</td></tr>
<tr><td><code id="plot.factor_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.gd_result'>plot GD result</h2><span id='topic+plot.gd_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for GD model result in <code>gd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gd_result'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>gd()</code>.</p>
</td></tr>
<tr><td><code id="plot.gd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.gozh_result'>plot GOZH result</h2><span id='topic+plot.gozh_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for GOZH model result in <code>gozh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gozh_result'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.gozh_result_+3A_x">x</code></td>
<td>
<p>Return by <code>gozh()</code>.</p>
</td></tr>
<tr><td><code id="plot.gozh_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.idsa_result'>plot IDSA risk result</h2><span id='topic+plot.idsa_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for IDSA risk result in <code>idsa()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idsa_result'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.idsa_result_+3A_x">x</code></td>
<td>
<p>Return by <code>idsa()</code>.</p>
</td></tr>
<tr><td><code id="plot.idsa_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.interaction_detector'>plot interaction detector result</h2><span id='topic+plot.interaction_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for interaction detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'interaction_detector'
plot(x, alpha = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.interaction_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="plot.interaction_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Picture transparency. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.interaction_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.lesh_result'>plot LESH model result</h2><span id='topic+plot.lesh_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for LESH model interaction result in <code>lesh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lesh_result'
plot(
  x,
  pie = TRUE,
  scatter = FALSE,
  scatter_alpha = 1,
  pieradius_factor = 15,
  pielegend_x = 0.99,
  pielegend_y = 0.1,
  pielegend_num = 3,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.lesh_result_+3A_x">x</code></td>
<td>
<p>x Return by <code>lesh()</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_pie">pie</code></td>
<td>
<p>(optional) Whether to draw the interaction contributions. Default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_scatter">scatter</code></td>
<td>
<p>(optional) Whether to draw the interaction direction diagram. Default is <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_scatter_alpha">scatter_alpha</code></td>
<td>
<p>(optional) Picture transparency. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_pieradius_factor">pieradius_factor</code></td>
<td>
<p>(optional) The radius expansion factor of interaction contributions pie plot. Default is <code>15</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_pielegend_x">pielegend_x</code></td>
<td>
<p>(optional) The X-axis relative position of interaction contributions pie plot legend. Default is <code>0.99</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_pielegend_y">pielegend_y</code></td>
<td>
<p>(optional) The Y-axis relative position of interaction contributions pie plot legend. Default is <code>0.1</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_pielegend_num">pielegend_num</code></td>
<td>
<p>(optional) The number of interaction contributions pie plot legend. Default is <code>3</code>.</p>
</td></tr>
<tr><td><code id="plot.lesh_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Note</h3>

<p>When both <code>scatter</code> and <code>pie</code> are set to <code>TRUE</code> in RStudio, enlarge the drawing frame
for normal display.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.opgd_result'>plot OPGD result</h2><span id='topic+plot.opgd_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for OPGD model result in <code>opgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opgd_result'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.opgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>opgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.opgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.rgd_result'>plot RGD result</h2><span id='topic+plot.rgd_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for RGD model result in <code>rgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rgd_result'
plot(x, slicenum = 2, alpha = 0.95, keep = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>rgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.rgd_result_+3A_slicenum">slicenum</code></td>
<td>
<p>(optional) The number of labels facing inward. Default is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.rgd_result_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot.rgd_result_+3A_keep">keep</code></td>
<td>
<p>(optional) Whether to keep Q-value results for insignificant variables,
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.rgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.rid_result'>plot RID result</h2><span id='topic+plot.rid_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for RID model from <code>rid()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rid_result'
plot(x, alpha = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.rid_result_+3A_x">x</code></td>
<td>
<p>Return by <code>rid()</code>.</p>
</td></tr>
<tr><td><code id="plot.rid_result_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Picture transparency. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.rid_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.risk_detector'>plot risk detector</h2><span id='topic+plot.risk_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for risk detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'risk_detector'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.risk_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="plot.risk_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.sesu_gozh'>plot gozh sesu</h2><span id='topic+plot.sesu_gozh'></span>

<h3>Description</h3>

<p>S3 method to plot output for gozh sesu in <code>sesu_gozh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sesu_gozh'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sesu_gozh_+3A_x">x</code></td>
<td>
<p>Return by <code>sesu_gozh()</code>.</p>
</td></tr>
<tr><td><code id="plot.sesu_gozh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.sesu_opgd'>plot opgd sesu</h2><span id='topic+plot.sesu_opgd'></span>

<h3>Description</h3>

<p>S3 method to plot output for opgd sesu in <code>sesu_opgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sesu_opgd'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.sesu_opgd_+3A_x">x</code></td>
<td>
<p>Return by <code>sesu_opgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.sesu_opgd_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.spade_result'>plot SPADE power of spatial and multilevel discretization determinant</h2><span id='topic+plot.spade_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for SPADE power of spatial and multilevel discretization
determinant from <code>spade()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spade_result'
plot(x, slicenum = 2, alpha = 0.95, keep = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.spade_result_+3A_x">x</code></td>
<td>
<p>Return by <code>spade()</code>.The number of labels facing inward.</p>
</td></tr>
<tr><td><code id="plot.spade_result_+3A_slicenum">slicenum</code></td>
<td>
<p>(optional) The number of labels facing inward. Default is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.spade_result_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level.Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="plot.spade_result_+3A_keep">keep</code></td>
<td>
<p>(optional) Whether to keep Q-value results for insignificant variables,
default is <code>TRUE</code>.</p>
</td></tr>
<tr><td><code id="plot.spade_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.srs_ecological_detector'>plot spatial rough set-based ecological detector</h2><span id='topic+plot.srs_ecological_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for spatial rough set-based ecological detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_ecological_detector'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.srs_ecological_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.srs_ecological_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.srs_factor_detector'>plot spatial rough set-based factor detector result</h2><span id='topic+plot.srs_factor_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for spatial rough set-based factor detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_factor_detector'
plot(x, slicenum = 2, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.srs_factor_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.srs_factor_detector_+3A_slicenum">slicenum</code></td>
<td>
<p>(optional) The number of labels facing inward. Default is <code>2</code>.</p>
</td></tr>
<tr><td><code id="plot.srs_factor_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.srs_interaction_detector'>plot spatial rough set-based interaction detector result</h2><span id='topic+plot.srs_interaction_detector'></span>

<h3>Description</h3>

<p>S3 method to plot output for spatial rough set-based interaction detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_interaction_detector'
plot(x, alpha = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.srs_interaction_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.srs_interaction_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Picture transparency. Default is <code>1</code>.</p>
</td></tr>
<tr><td><code id="plot.srs_interaction_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>ggplot2::theme()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='plot.srsgd_result'>plot SRSGD result</h2><span id='topic+plot.srsgd_result'></span>

<h3>Description</h3>

<p>S3 method to plot output for SRSGD model result in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srsgd_result'
plot(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.srsgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="plot.srsgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A ggplot2 layer
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.ecological_detector'>print ecological detector</h2><span id='topic+print.ecological_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for ecological detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'ecological_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.ecological_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="print.ecological_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.factor_detector'>print factor detector</h2><span id='topic+print.factor_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for factor detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'factor_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.factor_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="print.factor_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.gd_result'>print GD result</h2><span id='topic+print.gd_result'></span>

<h3>Description</h3>

<p>S3 method to format output for GD model from <code>gd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gd_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>gd()</code>.</p>
</td></tr>
<tr><td><code id="print.gd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.gozh_result'>print GOZH result</h2><span id='topic+print.gozh_result'></span>

<h3>Description</h3>

<p>S3 method to format output for GOZH model from <code>gozh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'gozh_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.gozh_result_+3A_x">x</code></td>
<td>
<p>Return by <code>gozh()</code>.</p>
</td></tr>
<tr><td><code id="print.gozh_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.idsa_result'>print IDSA result</h2><span id='topic+print.idsa_result'></span>

<h3>Description</h3>

<p>S3 method to format output for IDSA model from <code>idsa()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'idsa_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.idsa_result_+3A_x">x</code></td>
<td>
<p>Return by <code>idsa()</code>.</p>
</td></tr>
<tr><td><code id="print.idsa_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.interaction_detector'>print interaction detector</h2><span id='topic+print.interaction_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for interaction detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'interaction_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.interaction_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="print.interaction_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.lesh_result'>print LESH model interaction result</h2><span id='topic+print.lesh_result'></span>

<h3>Description</h3>

<p>S3 method to format output for LESH model interaction result in <code>lesh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'lesh_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.lesh_result_+3A_x">x</code></td>
<td>
<p>Return by <code>lesh()</code>.</p>
</td></tr>
<tr><td><code id="print.lesh_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.opgd_result'>print OPGD result</h2><span id='topic+print.opgd_result'></span>

<h3>Description</h3>

<p>S3 method to format output for OPGD model from <code>opgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'opgd_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.opgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>opgd()</code>.</p>
</td></tr>
<tr><td><code id="print.opgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.rgd_result'>print RGD result</h2><span id='topic+print.rgd_result'></span>

<h3>Description</h3>

<p>S3 method to format output for RGD model from <code>rgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rgd_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>rgd()</code>.</p>
</td></tr>
<tr><td><code id="print.rgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.rid_result'>print RID result</h2><span id='topic+print.rid_result'></span>

<h3>Description</h3>

<p>S3 method to format output for RID model from <code>rid()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'rid_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.rid_result_+3A_x">x</code></td>
<td>
<p>Return by <code>rid()</code>.</p>
</td></tr>
<tr><td><code id="print.rid_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.risk_detector'>print risk detector</h2><span id='topic+print.risk_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for risk detector in <code>geodetector()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'risk_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.risk_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>geodetector()</code>.</p>
</td></tr>
<tr><td><code id="print.risk_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.sesu_gozh'>print gozh sesu</h2><span id='topic+print.sesu_gozh'></span>

<h3>Description</h3>

<p>S3 method to format output for gozh sesu from <code>sesu_gozh()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sesu_gozh'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.sesu_gozh_+3A_x">x</code></td>
<td>
<p>Return by <code>sesu_gozh()</code>.</p>
</td></tr>
<tr><td><code id="print.sesu_gozh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.sesu_opgd'>print opgd sesu</h2><span id='topic+print.sesu_opgd'></span>

<h3>Description</h3>

<p>S3 method to format output for opgd sesu from <code>sesu_opgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'sesu_opgd'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.sesu_opgd_+3A_x">x</code></td>
<td>
<p>Return by <code>sesu_opgd()</code>.</p>
</td></tr>
<tr><td><code id="print.sesu_opgd_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.spade_result'>print SPADE power of spatial and multilevel discretization determinant</h2><span id='topic+print.spade_result'></span>

<h3>Description</h3>

<p>S3 method to format output for SPADE power of spatial and multilevel discretization
determinant from <code>spade()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'spade_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.spade_result_+3A_x">x</code></td>
<td>
<p>Return by <code>spade()</code>.</p>
</td></tr>
<tr><td><code id="print.spade_result_+3A_...">...</code></td>
<td>
<p>Other arguments.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.srs_ecological_detector'>print spatial rough set-based ecological detector</h2><span id='topic+print.srs_ecological_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for spatial rough set-based ecological detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_ecological_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.srs_ecological_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="print.srs_ecological_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.srs_factor_detector'>print spatial rough set-based factor detector</h2><span id='topic+print.srs_factor_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for spatial rough set-based factor detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_factor_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.srs_factor_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="print.srs_factor_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.srs_interaction_detector'>print spatial rough set-based interaction detector</h2><span id='topic+print.srs_interaction_detector'></span>

<h3>Description</h3>

<p>S3 method to format output for spatial rough set-based interaction detector in <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srs_interaction_detector'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.srs_interaction_detector_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="print.srs_interaction_detector_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='print.srsgd_result'>print SRSGD result</h2><span id='topic+print.srsgd_result'></span>

<h3>Description</h3>

<p>S3 method to format output for SRSGD model from <code>srsgd()</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'srsgd_result'
print(x, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.srsgd_result_+3A_x">x</code></td>
<td>
<p>Return by <code>srsgd()</code>.</p>
</td></tr>
<tr><td><code id="print.srsgd_result_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>knitr::kable()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Formatted string output
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>

<hr>
<h2 id='psd_iev'>PSD of an interaction of explanatory variables (PSD-IEV)</h2><span id='topic+psd_iev'></span>

<h3>Description</h3>

<p>PSD of an interaction of explanatory variables (PSD-IEV)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psd_iev(discdata, spzone, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psd_iev_+3A_discdata">discdata</code></td>
<td>
<p>Observed data with discrete explanatory variables. A <code>tibble</code> or <code>data.frame</code> .</p>
</td></tr>
<tr><td><code id="psd_iev_+3A_spzone">spzone</code></td>
<td>
<p>Fuzzy overlay spatial zones. Returned from <code>st_fuzzyoverlay()</code>.</p>
</td></tr>
<tr><td><code id="psd_iev_+3A_wt">wt</code></td>
<td>
<p>Spatial weight matrix</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code class="reqn">\phi = 1 - \frac{\sum_{i=1}^m \sum_{k=1}^{n_i}N_{i,k}\tau_{i,k}}{\sum_{i=1}^m N_i \tau_i}</code>
</p>


<h3>Value</h3>

<p>The Value of <code>PSD-IEV</code>
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Yongze Song &amp; Peng Wu (2021) An interactive detector for spatial associations,
International Journal of Geographical Information Science, 35:8, 1676-1701,
DOI:10.1080/13658816.2021.1882680
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
sim1 = dplyr::mutate(sim,dplyr::across(xa:xc,\(.x) sdsfun::discretize_vector(.x,5)))
sz = sdsfun::fuzzyoverlay(y ~ xa + xb + xc, data = sim1)
psd_iev(dplyr::select(sim1,xa:xc),sz,wt)

</code></pre>

<hr>
<h2 id='psd_pseudop'>calculate power of spatial determinant(PSD) and the corresponding pseudo-p value</h2><span id='topic+psd_pseudop'></span>

<h3>Description</h3>

<p>Function for calculate power of spatial determinant <code class="reqn">q_s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psd_pseudop(y, x, wt, cores = 1, seed = 123456789, permutations = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psd_pseudop_+3A_y">y</code></td>
<td>
<p>Variable Y, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="psd_pseudop_+3A_x">x</code></td>
<td>
<p>Covariable X, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="psd_pseudop_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
<tr><td><code id="psd_pseudop_+3A_cores">cores</code></td>
<td>
<p>(optional) A positive integer(default is 1). If cores &gt; 1, use parallel computation.</p>
</td></tr>
<tr><td><code id="psd_pseudop_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="psd_pseudop_+3A_permutations">permutations</code></td>
<td>
<p>(optional) The number of permutations for the PSD computation. Default is <code>0</code>,
which means no pseudo-p values are calculated.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of spatial determinant formula is
<code class="reqn">q_s = 1 - \frac{\sum_{h=1}^L N_h \Gamma_h}{N \Gamma}</code>
</p>


<h3>Value</h3>

<p>A tibble of power of spatial determinant and the corresponding pseudo-p value.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')),
                                  power = 2)
psd_pseudop(sim$y,sdsfun::discretize_vector(sim$xa,5),wt)

</code></pre>

<hr>
<h2 id='psd_spade'>power of spatial determinant(PSD)</h2><span id='topic+psd_spade'></span>

<h3>Description</h3>

<p>Function for calculate power of spatial determinant <code>q_s</code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psd_spade(y, x, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psd_spade_+3A_y">y</code></td>
<td>
<p>Variable Y, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="psd_spade_+3A_x">x</code></td>
<td>
<p>Covariable X, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="psd_spade_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of spatial determinant formula is
</p>
<p><code class="reqn">q_s = 1 - \frac{\sum_{h=1}^L N_h \Gamma_h}{N \Gamma}</code>
</p>


<h3>Value</h3>

<p>A value of power of spatial determinant <code>q_s</code>.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')),
                                  power = 2)
psd_spade(sim$y,sdsfun::discretize_vector(sim$xa,5),wt)

</code></pre>

<hr>
<h2 id='psmd_pseudop'>power of spatial and multilevel discretization determinant(PSMD) and the corresponding pseudo-p value</h2><span id='topic+psmd_pseudop'></span>

<h3>Description</h3>

<p>Function for calculate power of spatial and multilevel discretization determinant and the corresponding pseudo-p value.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psmd_pseudop(
  yobs,
  xobs,
  wt,
  discnum = 3:8,
  discmethod = "quantile",
  cores = 1,
  seed = 123456789,
  permutations = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psmd_pseudop_+3A_yobs">yobs</code></td>
<td>
<p>Variable Y</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_xobs">xobs</code></td>
<td>
<p>The original undiscretized covariable X.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_discnum">discnum</code></td>
<td>
<p>(optional) Number of multilevel discretization. Default will use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) The discretization methods. Default will use <code>quantile</code>.
If <code>discmethod</code> is set to <code>robust</code>, the function <code>robust_disc()</code> will be used. Conversely,
if <code>discmethod</code> is set to <code>rpart</code>, the <code>rpart_disc()</code> function will be used. Others use
<code>sdsfun::discretize_vector()</code>. Currently, only one <code>discmethod</code> can be used at a time.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_cores">cores</code></td>
<td>
<p>(optional) A positive integer(default is 1). If cores &gt; 1, use parallel computation.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_permutations">permutations</code></td>
<td>
<p>(optional) The number of permutations for the PSD computation. Default is <code>0</code>,
which means no pseudo-p values are calculated.</p>
</td></tr>
<tr><td><code id="psmd_pseudop_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>sdsfun::discretize_vector()</code>,<code>robust_disc()</code> or <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of spatial and multilevel discretization determinant formula is
<code class="reqn">PSMDQ_s = MEAN(Q_s)</code>
</p>


<h3>Value</h3>

<p>A tibble of power of spatial and multilevel discretization determinant and the corresponding pseudo-p value.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
psmd_pseudop(sim$y,sim$xa,wt)

</code></pre>

<hr>
<h2 id='psmd_spade'>power of spatial and multilevel discretization determinant(PSMD)</h2><span id='topic+psmd_spade'></span>

<h3>Description</h3>

<p>Function for calculate power of spatial and multilevel discretization determinant <code>PSMDQ_s</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>psmd_spade(
  yobs,
  xobs,
  wt,
  discnum = 3:8,
  discmethod = "quantile",
  cores = 1,
  seed = 123456789,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="psmd_spade_+3A_yobs">yobs</code></td>
<td>
<p>Variable Y</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_xobs">xobs</code></td>
<td>
<p>The original continuous covariable X.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_wt">wt</code></td>
<td>
<p>The spatial weight matrix.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_discnum">discnum</code></td>
<td>
<p>(optional) Number of multilevel discretizations. Default will use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) The discretize methods. Default will use <code>quantile</code>.
If <code>discmethod</code> is set to <code>robust</code>, the function <code>robust_disc()</code> will be used. Conversely,
if <code>discmethod</code> is set to <code>rpart</code>, the <code>rpart_disc()</code> function will be used. Others use
<code>sdsfun::discretize_vector()</code>. Currently, only one <code>discmethod</code> can be used at a time.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_cores">cores</code></td>
<td>
<p>(optional) A positive integer(default is 1). If cores &gt; 1, use parallel computation.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_seed">seed</code></td>
<td>
<p>(optional) Random seed number, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="psmd_spade_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>sdsfun::discretize_vector()</code>,<code>robust_disc()</code> or
<code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of spatial and multilevel discretization determinant formula is
<code class="reqn">PSMDQ_s = MEAN(Q_s)</code>
</p>


<h3>Value</h3>

<p>A value of power of spatial and multilevel discretization determinant <code>PSMDQ_s</code>.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
wt = sdsfun::inverse_distance_swm(sf::st_as_sf(sim,coords = c('lo','la')))
psmd_spade(sim$y,sim$xa,wt)

</code></pre>

<hr>
<h2 id='rgd'>robust geographical detector(RGD) model</h2><span id='topic+rgd'></span>

<h3>Description</h3>

<p>robust geographical detector(RGD) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rgd(
  formula,
  data,
  discvar = NULL,
  discnum = 3:8,
  minsize = 1,
  strategy = 2L,
  increase_rate = 0.05,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rgd_+3A_formula">formula</code></td>
<td>
<p>A formula of RGD model.</p>
</td></tr>
<tr><td><code id="rgd_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="rgd_+3A_discvar">discvar</code></td>
<td>
<p>Name of continuous variable columns that need to be discretized. Noted that
when <code>formula</code> has <code>discvar</code>, <code>data</code> must have these columns. By default, all independent
variables are used as <code>discvar</code>.</p>
</td></tr>
<tr><td><code id="rgd_+3A_discnum">discnum</code></td>
<td>
<p>A numeric vector of discretized classes of columns that need to be discretized.
Default all <code>discvar</code> use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="rgd_+3A_minsize">minsize</code></td>
<td>
<p>(optional) The min size of each discretization group. Default all use <code>1</code>.</p>
</td></tr>
<tr><td><code id="rgd_+3A_strategy">strategy</code></td>
<td>
<p>(optional) Optimal discretization strategy. When <code>strategy</code> is <code>1L</code>, choose the highest
q-statistics to determinate optimal spatial data discretization parameters. When <code>strategy</code> is <code>2L</code>,
The optimal discrete parameters of spatial data are selected by combining LOESS model.</p>
</td></tr>
<tr><td><code id="rgd_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization. Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="rgd_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>robust power of determinant</p>
</dd>
<dt><code>opt_disc</code></dt><dd><p>optimal robust discrete results</p>
</dd>
<dt><code>allfactor</code></dt><dd><p>factor detection results corresponding to different number of robust discreteizations</p>
</dd>
<dt><code>alldisc</code></dt><dd><p>all robust discrete results</p>
</dd>
</dl>



<h3>Note</h3>

<p>Please set up python dependence and configure <code>GDVERSE_PYTHON</code> environment variable if you want to run <code>rgd()</code>.
See <code>vignette('rgdrid',package = 'gdverse')</code> for more details.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhang, Z., Song, Y.*, &amp; Wu, P., 2022. Robust geographical detector. International Journal of Applied Earth Observation and Geoinformation. 109, 102782.
DOI: 10.1016/j.jag.2022.102782.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code needs to configure the Python environment to run:
data('sim')
g = rgd(y ~ .,
        data = dplyr::select(sim,-dplyr::any_of(c('lo','la'))),
        discnum = 3:6, cores = 1)
g

## End(Not run)
</code></pre>

<hr>
<h2 id='rid'>robust interaction detector(RID) model</h2><span id='topic+rid'></span>

<h3>Description</h3>

<p>robust interaction detector(RID) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rid(
  formula,
  data,
  discvar = NULL,
  discnum = 3:8,
  minsize = 1,
  strategy = 2L,
  increase_rate = 0.05,
  cores = 1
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rid_+3A_formula">formula</code></td>
<td>
<p>A formula of RGD model.</p>
</td></tr>
<tr><td><code id="rid_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="rid_+3A_discvar">discvar</code></td>
<td>
<p>Name of continuous variable columns that need to be discretized. Noted that
when <code>formula</code> has <code>discvar</code>, <code>data</code> must have these columns. By default, all independent
variables are used as <code>discvar</code>.</p>
</td></tr>
<tr><td><code id="rid_+3A_discnum">discnum</code></td>
<td>
<p>A numeric vector of discretized classes of columns that need to be discretized.
Default all <code>discvar</code> use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="rid_+3A_minsize">minsize</code></td>
<td>
<p>(optional) The min size of each discretization group. Default all use <code>1</code>.</p>
</td></tr>
<tr><td><code id="rid_+3A_strategy">strategy</code></td>
<td>
<p>(optional) Optimal discretization strategy. When <code>strategy</code> is <code>1L</code>, choose the highest
q-statistics to determinate optimal spatial data discretization parameters. When <code>strategy</code> is <code>2L</code>,
The optimal discrete parameters of spatial data are selected by combining LOESS model.</p>
</td></tr>
<tr><td><code id="rid_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization. Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="rid_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>interaction</code></dt><dd><p>the result of RID model</p>
</dd>
</dl>



<h3>Note</h3>

<p>Please set up python dependence and configure <code>GDVERSE_PYTHON</code> environment variable if you want to run <code>rid()</code>.
See <code>vignette('rgdrid',package = 'gdverse')</code> for more details.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Zhang, Z., Song, Y., Karunaratne, L., &amp; Wu, P. (2024). Robust interaction detector:
A case of road life expectancy analysis. Spatial Statistics, 59(100814), 100814.
https://doi.org/10.1016/j.spasta.2024.100814
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code needs to configure the Python environment to run:
data('sim')
g = rid(y ~ .,
        data = dplyr::select(sim,-dplyr::any_of(c('lo','la'))),
        discnum = 3:6, cores = 1)
g

## End(Not run)
</code></pre>

<hr>
<h2 id='risk_detector'>risk detector</h2><span id='topic+risk_detector'></span>

<h3>Description</h3>

<p>Determine whether there is a significant difference between the attribute means of two sub regions.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>risk_detector(y, x, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="risk_detector_+3A_y">y</code></td>
<td>
<p>Variable Y, continuous numeric vector.</p>
</td></tr>
<tr><td><code id="risk_detector_+3A_x">x</code></td>
<td>
<p>Covariate X, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="risk_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level of the interval, default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>risk_detector(y = 1:7,
              x = c('x',rep('y',3),rep('z',3)))

</code></pre>

<hr>
<h2 id='robust_disc'>univariate discretization based on offline change point detection</h2><span id='topic+robust_disc'></span>

<h3>Description</h3>

<p>Determines discretization interval breaks using an optimization algorithm for variance-based
change point detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>robust_disc(formula, data, discnum, minsize = 1, cores = 1)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="robust_disc_+3A_formula">formula</code></td>
<td>
<p>A formula of univariate discretization.</p>
</td></tr>
<tr><td><code id="robust_disc_+3A_data">data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td></tr>
<tr><td><code id="robust_disc_+3A_discnum">discnum</code></td>
<td>
<p>A numeric vector of discretized classes of columns that need to be discretized.</p>
</td></tr>
<tr><td><code id="robust_disc_+3A_minsize">minsize</code></td>
<td>
<p>(optional) The min size of each discretization group. Default all use <code>1</code>.</p>
</td></tr>
<tr><td><code id="robust_disc_+3A_cores">cores</code></td>
<td>
<p>(optional) A positive integer(default is 1). If cores &gt; 1, use <code>python</code> <code>joblib</code> package to
parallel computation.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A <code>tibble</code>.
</p>


<h3>Note</h3>

<p>Please set up python dependence and configure <code>GDVERSE_PYTHON</code> environment variable if you want to run <code>robust_disc()</code>.
See <code>vignette('rgdrid',package = 'gdverse')</code> for more details.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code needs to configure the Python environment to run:
data('sim')
robust_disc(y ~ xa, data = sim, discnum = 5)
robust_disc(y ~ .,
            data = dplyr::select(sim,-dplyr::any_of(c('lo','la'))),
            discnum = 5, cores = 3)

## End(Not run)
</code></pre>

<hr>
<h2 id='rpart_disc'>discretization of variables based on recursive partitioning</h2><span id='topic+rpart_disc'></span>

<h3>Description</h3>

<p>discretization of variables based on recursive partitioning
</p>


<h3>Usage</h3>

<pre><code class='language-R'>rpart_disc(formula, data, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="rpart_disc_+3A_formula">formula</code></td>
<td>
<p>A formula.</p>
</td></tr>
<tr><td><code id="rpart_disc_+3A_data">data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td></tr>
<tr><td><code id="rpart_disc_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart::rpart()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector that being discretized.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Luo, P., Song, Y., Huang, X., Ma, H., Liu, J., Yao, Y., &amp; Meng, L. (2022). Identifying determinants of
spatio-temporal disparities in soil moisture of the Northern Hemisphere using a geographically optimal
zones-based heterogeneity model. ISPRS Journal of Photogrammetry and Remote Sensing: Official
Publication of the International Society for Photogrammetry and Remote Sensing (ISPRS), 185, 111–128.
https://doi.org/10.1016/j.isprsjprs.2022.01.009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ndvi')
rpart_disc(NDVIchange ~ ., data = ndvi)

</code></pre>

<hr>
<h2 id='sesu_gozh'>comparison of size effects of spatial units based on GOZH</h2><span id='topic+sesu_gozh'></span>

<h3>Description</h3>

<p>comparison of size effects of spatial units based on GOZH
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesu_gozh(
  formula,
  datalist,
  su,
  cores = 1,
  strategy = 2L,
  increase_rate = 0.05,
  alpha = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sesu_gozh_+3A_formula">formula</code></td>
<td>
<p>A formula of comparison of size effects of spatial units.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_datalist">datalist</code></td>
<td>
<p>A list of <code>data.frame</code> or <code>tibble</code>.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_su">su</code></td>
<td>
<p>A vector of sizes of spatial units.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_strategy">strategy</code></td>
<td>
<p>(optional) Calculation strategies of Q statistics at different scales. Default
is <code>2L</code>, see <code>details</code> for more contents.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="sesu_gozh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>strategy</code> is <code>1</code>, use the same process as <code>sesu_opgd()</code>.If not, all explanatory
variables are used to generate a unique Q statistic corresponding to the data in the
datalist based on <code>rpart_disc()</code> and <code>gd()</code>, and then <code>loess_optscale()</code>is used to
determine the optimal analysis scale.
</p>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>sesu</code></dt><dd><p>a tibble representing size effects of spatial units</p>
</dd>
<dt><code>optsu</code></dt><dd><p>optimal spatial unit</p>
</dd>
<dt><code>strategy</code></dt><dd><p>the optimal analytical scale selection strategy</p>
</dd>
<dt><code>increase_rate</code></dt><dd><p>the critical increase rate of q value</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) An optimal parameters-based geographical detector
model enhances geographic characteristics of explanatory variables for spatial heterogeneity
analysis: Cases with different types of spatial data, GIScience &amp; Remote Sensing, 57(5), 593-610.
doi: 10.1080/15481603.2020.1760434.
</p>
<p>Luo, P., Song, Y., Huang, X., Ma, H., Liu, J., Yao, Y., &amp; Meng, L. (2022). Identifying determinants of
spatio-temporal disparities in soil moisture of the Northern Hemisphere using a geographically optimal
zones-based heterogeneity model. ISPRS Journal of Photogrammetry and Remote Sensing:
Official Publication of the International Society for Photogrammetry and Remote Sensing (ISPRS), 185, 111–128.
https://doi.org/10.1016/j.isprsjprs.2022.01.009
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code takes a long time to run:
library(tidyverse)
fvcpath = "https://github.com/SpatLyu/rdevdata/raw/main/FVC.tif"
fvc = terra::rast(paste0("/vsicurl/",fvcpath))
fvc1000 = fvc %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
fvc5000 = fvc %&gt;%
  terra::aggregate(fact = 5) %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
sesu_gozh(fvc ~ .,
          datalist = list(fvc1000,fvc5000),
          su = c(1000,5000),
          cores = 6)

## End(Not run)
</code></pre>

<hr>
<h2 id='sesu_opgd'>comparison of size effects of spatial units based on OPGD</h2><span id='topic+sesu_opgd'></span>

<h3>Description</h3>

<p>comparison of size effects of spatial units based on OPGD
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sesu_opgd(
  formula,
  datalist,
  su,
  discvar,
  discnum = 3:8,
  discmethod = c("sd", "equal", "geometric", "quantile", "natural"),
  cores = 1,
  increase_rate = 0.05,
  alpha = 0.95,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="sesu_opgd_+3A_formula">formula</code></td>
<td>
<p>A formula of comparison of size effects of spatial units.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_datalist">datalist</code></td>
<td>
<p>A list of <code>data.frame</code> or <code>tibble</code>.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_su">su</code></td>
<td>
<p>A vector of sizes of spatial units.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_discvar">discvar</code></td>
<td>
<p>Name of continuous variable columns that need to be discretized.Noted that
when <code>formula</code> has <code>discvar</code>, <code>data</code> must have these columns.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_discnum">discnum</code></td>
<td>
<p>(optional) A vector of number of classes for discretization. Default is <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) A vector of methods for discretization, default is using
<code>c("sd","equal","geometric","quantile","natural")</code> by invoking <code>sdsfun</code>.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_increase_rate">increase_rate</code></td>
<td>
<p>(optional) The critical increase rate of the number of discretization.
Default is <code style="white-space: pre;">&#8288;5%&#8288;</code>.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of confidence level. Default is <code>0.95</code>.</p>
</td></tr>
<tr><td><code id="sesu_opgd_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>gd_bestunidisc()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Firstly, the <code>OPGD</code> model is executed for each data in the datalist (all <code>significant</code>
Q statistic of each data are averaged to represent the spatial association strength under
this spatial unit), and then the <code>loess_optscale</code> function is used to select the optimal
spatial analysis scale.
</p>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>sesu</code></dt><dd><p>a tibble representing size effects of spatial units</p>
</dd>
<dt><code>optsu</code></dt><dd><p>optimal spatial unit</p>
</dd>
<dt><code>increase_rate</code></dt><dd><p>the critical increase rate of q value</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Song, Y., Wang, J., Ge, Y. &amp; Xu, C. (2020) An optimal parameters-based geographical detector
model enhances geographic characteristics of explanatory variables for spatial heterogeneity
analysis: Cases with different types of spatial data, GIScience &amp; Remote Sensing, 57(5), 593-610.
doi: 10.1080/15481603.2020.1760434.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>## Not run: 
## The following code takes a long time to run:
library(tidyverse)
fvcpath = "https://github.com/SpatLyu/rdevdata/raw/main/FVC.tif"
fvc = terra::rast(paste0("/vsicurl/",fvcpath))
fvc1000 = fvc %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
fvc5000 = fvc %&gt;%
  terra::aggregate(fact = 5) %&gt;%
  terra::as.data.frame(na.rm = T) %&gt;%
  as_tibble()
sesu_opgd(fvc ~ .,
          datalist = list(fvc1000,fvc5000),
          su = c(1000,5000),
          discvar = names(select(fvc5000,-c(fvc,lulc))),
          cores = 6)

## End(Not run)
</code></pre>

<hr>
<h2 id='sim'>Simulation data.</h2><span id='topic+sim'></span>

<h3>Description</h3>

<p>Simulation data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>sim
</code></pre>


<h3>Format</h3>

<p><code>sim</code>: A tibble with 80 rows and 6 variables, modified from <code>IDSA</code> package.
</p>


<h3>Author(s)</h3>

<p>Yongze Song <a href="mailto:yongze.song@outlook.com">yongze.song@outlook.com</a>
</p>

<hr>
<h2 id='spade'>spatial association detector (SPADE) model</h2><span id='topic+spade'></span>

<h3>Description</h3>

<p>spatial association detector (SPADE) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spade(
  formula,
  data,
  wt = NULL,
  discvar = NULL,
  discnum = 3:8,
  discmethod = "quantile",
  cores = 1,
  seed = 123456789,
  permutations = 0,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spade_+3A_formula">formula</code></td>
<td>
<p>A formula of spatial association detector (SPADE) model.</p>
</td></tr>
<tr><td><code id="spade_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="spade_+3A_wt">wt</code></td>
<td>
<p>(optional) The spatial weight matrix. When <code>data</code> is not an <code>sf</code> object, must provide <code>wt</code>.</p>
</td></tr>
<tr><td><code id="spade_+3A_discvar">discvar</code></td>
<td>
<p>(optional) Name of continuous variable columns that need to be discretized. Noted that
when <code>formula</code> has <code>discvar</code>, <code>data</code> must have these columns. By default, all independent variables are
used as <code>discvar</code>.</p>
</td></tr>
<tr><td><code id="spade_+3A_discnum">discnum</code></td>
<td>
<p>(optional) Number of multilevel discretization. Default will use <code>3:8</code>.</p>
</td></tr>
<tr><td><code id="spade_+3A_discmethod">discmethod</code></td>
<td>
<p>(optional) The discretization methods. Default all use <code>quantile</code>. Note
that when using different <code>discmethod</code> for <code>discvar</code>, please ensure that the lengths of
both are consistent. Noted that <code>robust</code> will use <code>robust_disc()</code>; <code>rpart</code> will use
<code>rpart_disc()</code>; Others use <code>sdsfun::discretize_vector()</code>.</p>
</td></tr>
<tr><td><code id="spade_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="spade_+3A_seed">seed</code></td>
<td>
<p>(optional) Random number seed, default is <code>123456789</code>.</p>
</td></tr>
<tr><td><code id="spade_+3A_permutations">permutations</code></td>
<td>
<p>(optional) The number of permutations for the PSD computation. Default is <code>0</code>,
which means no pseudo-p values are calculated.</p>
</td></tr>
<tr><td><code id="spade_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>sdsfun::discretize_vector()</code>,<code>robust_disc()</code> or
<code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of SPADE model</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Xuezhi Cang &amp; Wei Luo (2018) Spatial association detector (SPADE),International
Journal of Geographical Information Science, 32:10, 2055-2075, DOI:  10.1080/13658816.2018.1476693
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('sim')
sim1 = sf::st_as_sf(sim,coords = c('lo','la'))
g = spade(y ~ ., data = sim1)
g

</code></pre>

<hr>
<h2 id='spd_lesh'>shap power of determinants</h2><span id='topic+spd_lesh'></span>

<h3>Description</h3>

<p>Function for calculate shap power of determinants <code class="reqn">SPD</code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>spd_lesh(formula, data, cores = 1, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="spd_lesh_+3A_formula">formula</code></td>
<td>
<p>A formula of calculate shap power of determinants.</p>
</td></tr>
<tr><td><code id="spd_lesh_+3A_data">data</code></td>
<td>
<p>A data.frame or tibble of observation data.</p>
</td></tr>
<tr><td><code id="spd_lesh_+3A_cores">cores</code></td>
<td>
<p>(optional) Positive integer (default is 1). When cores are greater than 1, use
multi-core parallel computing.</p>
</td></tr>
<tr><td><code id="spd_lesh_+3A_...">...</code></td>
<td>
<p>(optional) Other arguments passed to <code>rpart_disc()</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The power of shap power of determinants formula is
</p>
<p><code class="reqn">\theta_{x_j} \left( S \right) = \sum\limits_{s \in M \setminus \{x_j\}} \frac{|S|! \left(|M| - |S| - 1\right)!}{|M|!}\left(v \left(S \cup \left\{x_j\right\} \right) - v\left(S\right)\right)</code>.
</p>
<p>shap power of determinants (SPD) is the contribution of variable <code class="reqn">x_j</code> to the power of determinants.
</p>


<h3>Value</h3>

<p>A tibble with variable and its corresponding <code class="reqn">SPD</code> value.
</p>


<h3>Note</h3>

<p>The shap power of determinants (SPD) requires at least <code class="reqn">2^n-1</code> calculations when has <code class="reqn">n</code> explanatory variables.
When there are more than 10 explanatory variables, carefully consider the computational burden of this model.
When there are a large number of explanatory variables, the data dimensionality reduction method can be used
to ensure the trade-off between analysis results and calculation speed.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Li, Y., Luo, P., Song, Y., Zhang, L., Qu, Y., &amp; Hou, Z. (2023). A locally explained heterogeneity model for
examining wetland disparity. International Journal of Digital Earth, 16(2), 4533–4552.
https://doi.org/10.1080/17538947.2023.2271883
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('ndvi')
g = spd_lesh(NDVIchange ~ ., data = ndvi)
g

</code></pre>

<hr>
<h2 id='srs_ecological_detector'>spatial rough set-based ecological detector</h2><span id='topic+srs_ecological_detector'></span>

<h3>Description</h3>

<p>spatial rough set-based ecological detector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_ecological_detector(y, x1, x2, wt, alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs_ecological_detector_+3A_y">y</code></td>
<td>
<p>Dependent variable, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_ecological_detector_+3A_x1">x1</code></td>
<td>
<p>Covariate <code class="reqn">X_1</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_ecological_detector_+3A_x2">x2</code></td>
<td>
<p>Covariate <code class="reqn">X_2</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_ecological_detector_+3A_wt">wt</code></td>
<td>
<p>Spatial adjacency matrix.</p>
</td></tr>
<tr><td><code id="srs_ecological_detector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Confidence level of the interval,default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>T-statistic</code></dt><dd><p>the result of T statistic for spatial rough set-based ecological detector</p>
</dd>
<dt><code>P-value</code></dt><dd><p>the result of P value for spatial rough set-based ecological detector</p>
</dd>
<dt><code>Ecological</code></dt><dd><p>does one spatial feature <code class="reqn">X_1</code> play a more important role than <code class="reqn">X_2</code></p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Bai, H., Li, D., Ge, Y., Wang, J., &amp; Cao, F. (2022). Spatial rough set-based
geographical detectors for nominal target variables. Information Sciences, 586, 525–539.
https://doi.org/10.1016/j.ins.2021.12.019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('srs_table')
data('srs_wt')
srs_ecological_detector(srs_table$d,srs_table$a1,srs_table$a2,srs_wt)

</code></pre>

<hr>
<h2 id='srs_factor_detector'>spatial rough set-based factor detector</h2><span id='topic+srs_factor_detector'></span>

<h3>Description</h3>

<p>spatial rough set-based factor detector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_factor_detector(y, x, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs_factor_detector_+3A_y">y</code></td>
<td>
<p>Variable Y, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_factor_detector_+3A_x">x</code></td>
<td>
<p>Covariate X, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_factor_detector_+3A_wt">wt</code></td>
<td>
<p>Spatial adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>PD</code></dt><dd><p>the average local explanatory power</p>
</dd>
<dt><code>SE_PD</code></dt><dd><p>the degree of spatial heterogeneity of the local explanatory power</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Bai, H., Li, D., Ge, Y., Wang, J., &amp; Cao, F. (2022). Spatial rough set-based
geographical detectors for nominal target variables. Information Sciences, 586, 525–539.
https://doi.org/10.1016/j.ins.2021.12.019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('srs_table')
data('srs_wt')
srs_factor_detector(srs_table$d,srs_table$a1,srs_wt)

</code></pre>

<hr>
<h2 id='srs_geodetector'>spatial rough set-based geographical detector</h2><span id='topic+srs_geodetector'></span>

<h3>Description</h3>

<p>spatial rough set-based geographical detector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_geodetector(formula, data, wt = NULL, type = "factor", alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs_geodetector_+3A_formula">formula</code></td>
<td>
<p>A formula of spatial rough set-based geographical detector model.</p>
</td></tr>
<tr><td><code id="srs_geodetector_+3A_data">data</code></td>
<td>
<p>A data.frame, tibble or sf object of observation data.</p>
</td></tr>
<tr><td><code id="srs_geodetector_+3A_wt">wt</code></td>
<td>
<p>Spatial adjacency matrix. If <code>data</code> is a <code>sf</code> polygon object, the queen
adjacency matrix is used when no <code>wt</code> object is provided. In other cases, you must
provide a <code>wt</code> object.</p>
</td></tr>
<tr><td><code id="srs_geodetector_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be one of
<code>factor</code>(default), <code>interaction</code> and <code>ecological</code>.</p>
</td></tr>
<tr><td><code id="srs_geodetector_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of the alpha (confidence level). Default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of spatial rough set-based factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of spatial rough set-based interaction detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of spatial rough set-based ecological detector</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('srs_table')
data('srs_wt')
srs_geodetector(d ~ a1 + a2 + a3, data = srs_table, wt = srs_wt)
srs_geodetector(d ~ a1 + a2 + a3, data = srs_table,
                wt = srs_wt, type = 'interaction')
srs_geodetector(d ~ a1 + a2 + a3, data = srs_table,
                wt = srs_wt, type = 'ecological')

</code></pre>

<hr>
<h2 id='srs_interaction_detector'>spatial rough set-based interaction detector</h2><span id='topic+srs_interaction_detector'></span>

<h3>Description</h3>

<p>spatial rough set-based interaction detector
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_interaction_detector(y, x1, x2, wt)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srs_interaction_detector_+3A_y">y</code></td>
<td>
<p>Dependent variable, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_interaction_detector_+3A_x1">x1</code></td>
<td>
<p>Covariate <code class="reqn">X_1</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_interaction_detector_+3A_x2">x2</code></td>
<td>
<p>Covariate <code class="reqn">X_2</code>, <code>factor</code>, <code>character</code> or <code>discrete numeric</code>.</p>
</td></tr>
<tr><td><code id="srs_interaction_detector_+3A_wt">wt</code></td>
<td>
<p>Spatial adjacency matrix.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>Variable1 PD</code></dt><dd><p>the average local explanatory power for variable1</p>
</dd>
<dt><code>Variable2 PD</code></dt><dd><p>the average local explanatory power for variable2</p>
</dd>
<dt><code>Variable1 and Variable2 interact PD</code></dt><dd><p>the average local explanatory power for variable1 and variable2 interact</p>
</dd>
<dt><code>Variable1 SE_PD</code></dt><dd><p>the degree of spatial heterogeneity of the local explanatory power for variable1</p>
</dd>
<dt><code>Variable2 SE_PD</code></dt><dd><p>the degree of spatial heterogeneity of the local explanatory power for variable2</p>
</dd>
<dt><code>Variable1 and Variable2 SE_PD</code></dt><dd><p>the degree of spatial heterogeneity of the local explanatory power for variable1 and variable2 interact</p>
</dd>
<dt><code>Interaction</code></dt><dd><p>the interact result type</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Bai, H., Li, D., Ge, Y., Wang, J., &amp; Cao, F. (2022). Spatial rough set-based
geographical detectors for nominal target variables. Information Sciences, 586, 525–539.
https://doi.org/10.1016/j.ins.2021.12.019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('srs_table')
data('srs_wt')
srs_interaction_detector(srs_table$d,srs_table$a1,srs_table$a2,srs_wt)

</code></pre>

<hr>
<h2 id='srs_table'>example of spatial information system table</h2><span id='topic+srs_table'></span>

<h3>Description</h3>

<p>example of spatial information system table
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_table
</code></pre>


<h3>Format</h3>

<p><code>srs_table</code>: A tibble with 11 rows and 5 variables(one <code>ID</code> column).
</p>

<hr>
<h2 id='srs_wt'>example of spatial information system spatial adjacency matrix</h2><span id='topic+srs_wt'></span>

<h3>Description</h3>

<p>example of spatial information system spatial adjacency matrix
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srs_wt
</code></pre>


<h3>Format</h3>

<p><code>srs_wt</code>: A matrix with 11rows and 11cols.
</p>

<hr>
<h2 id='srsgd'>spatial rough set-based geographical detector(SRSGD) model</h2><span id='topic+srsgd'></span>

<h3>Description</h3>

<p>spatial rough set-based geographical detector(SRSGD) model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>srsgd(formula, data, wt = NULL, type = "factor", alpha = 0.95)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="srsgd_+3A_formula">formula</code></td>
<td>
<p>A formula of spatial rough set-based geographical detector model.</p>
</td></tr>
<tr><td><code id="srsgd_+3A_data">data</code></td>
<td>
<p>A <code>data.frame</code>, <code>tibble</code> or <code>sf</code> object of observation data.</p>
</td></tr>
<tr><td><code id="srsgd_+3A_wt">wt</code></td>
<td>
<p>Spatial adjacency matrix. If <code>data</code> is a <code>sf</code> polygon object, the queen
adjacency matrix is used when no <code>wt</code> object is provided. In other cases, you must
provide a <code>wt</code> object.</p>
</td></tr>
<tr><td><code id="srsgd_+3A_type">type</code></td>
<td>
<p>(optional) The type of geographical detector, which must be one of
<code>factor</code>(default), <code>interaction</code> and <code>ecological</code>.</p>
</td></tr>
<tr><td><code id="srsgd_+3A_alpha">alpha</code></td>
<td>
<p>(optional) Specifies the size of the alpha (confidence level). Default is <code>0.95</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list.
</p>

<dl>
<dt><code>factor</code></dt><dd><p>the result of spatial rough set-based factor detector</p>
</dd>
<dt><code>interaction</code></dt><dd><p>the result of spatial rough set-based interaction detector</p>
</dd>
<dt><code>ecological</code></dt><dd><p>the result of spatial rough set-based ecological detector</p>
</dd>
</dl>



<h3>Note</h3>

<p>The Spatial Rough Set-based Geographical Detector Model (SRSGD) conducts spatial
hierarchical heterogeneity analysis utilizing a geographical detector for data
where <em>the dependent variable</em> is <em>discrete</em>. Given the complementary relationship
between SRSGD and the native version of geographical detector, I strive to maintain
consistency with <code>gd()</code> function when establishing <code>srsgd()</code> function. This implies
that all input variable data in srsgd must <em>be discretized prior to use</em>.
</p>


<h3>Author(s)</h3>

<p>Wenbo Lv <a href="mailto:lyu.geosocial@gmail.com">lyu.geosocial@gmail.com</a>
</p>


<h3>References</h3>

<p>Bai, H., Li, D., Ge, Y., Wang, J., &amp; Cao, F. (2022). Spatial rough set-based
geographical detectors for nominal target variables. Information Sciences, 586, 525–539.
https://doi.org/10.1016/j.ins.2021.12.019
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data('srs_table')
data('srs_wt')
srsgd(d ~ a1 + a2 + a3, data = srs_table, wt = srs_wt,
      type = c('factor','interaction','ecological'))

</code></pre>

<hr>
<h2 id='weight_assign'>assign values by weight</h2><span id='topic+weight_assign'></span>

<h3>Description</h3>

<p>assign values by weight
</p>


<h3>Usage</h3>

<pre><code class='language-R'>weight_assign(x, w, list = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="weight_assign_+3A_x">x</code></td>
<td>
<p>A numeric value</p>
</td></tr>
<tr><td><code id="weight_assign_+3A_w">w</code></td>
<td>
<p>A weight vector</p>
</td></tr>
<tr><td><code id="weight_assign_+3A_list">list</code></td>
<td>
<p>(optional) Return list or not. if <code>list</code> is <code>TRUE</code>, return a list,
otherwise return a vector. Default is <code>FALSE</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A numeric Vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>weight_assign(0.875,1:3)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
