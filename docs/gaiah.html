<!DOCTYPE html><html><head><title>Help for package gaiah</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {gaiah}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#%&gt;%'><p>Pipe operator</p></a></li>
<li><a href='#breeding_wiwa_genetic_posteriors'><p>Posterior probs of genetic region origin from Leave-one-out cross validation for breeding WIWAs</p></a></li>
<li><a href='#breeding_wiwa_isotopes'><p>Isotope values, latitude, longitude and more data from 357 breeding Wilson's warblers</p></a></li>
<li><a href='#comboize'><p>combine genetics, isotopes, and habitat raster with exponents as given</p></a></li>
<li><a href='#comboize_and_fortify'><p>prepare fortified output for multipanel plot</p></a></li>
<li><a href='#example_isotope_posteriors'><p>Output of <code>isotope_posterior_probs</code> for two migrant birds.</p></a></li>
<li><a href='#extract_isopredictions'><p>Add the isomap prediction and sd in columns attached to the feather isotope data frame</p></a></li>
<li><a href='#gaiah'><p>gaiah: Genetic and Isotopic Assignment Accounting for Habitat Suitability</p></a></li>
<li><a href='#genetic_posteriors2rasters'><p>Convert posteriors to particular genetic reporting groups into raster</p></a></li>
<li><a href='#genetic_regions'><p>RasterStack showing the 6 genetic regions that Wilson's warblers may be assigned to</p></a></li>
<li><a href='#get_wrld_simpl'><p>return the wrld_simpl data set from maptools</p></a></li>
<li><a href='#great_circle_raster'><p>return a raster of great circle distances (in km)</p></a></li>
<li><a href='#group_birds_by_location'><p>Group bird isotope data by locations</p></a></li>
<li><a href='#hpd_cumul'><p>finds the cumulative posterior probability of each cell for HPD calculation</p></a></li>
<li><a href='#isomap_job54152_prediction'><p>Predicted isotope values from ISOMAP</p></a></li>
<li><a href='#isomap2raster'><p>convert columns of an ISOMAP isoscape to a raster object</p></a></li>
<li><a href='#isotope_posterior_probs'><p>compute posterior probabilities of origin given isotope values</p></a></li>
<li><a href='#migrant_wiwa_genetic_posteriors'><p>Posterior probs of genetic region of origin for 926 WIWAs sampled during migration</p></a></li>
<li><a href='#migrant_wiwa_isotopes'><p>Isotope values and meta data for 688 migrating Wilson's Warblers</p></a></li>
<li><a href='#min_hpd_inc_area_df'><p>compute the minimum hpd inclusion area for all the birds in a rasterStack</p></a></li>
<li><a href='#min_hpd_inclusion_area'><p>compute the smallest area of an HPD credible set that includes the true bird location</p></a></li>
<li><a href='#private_rescale'><p>internal function for isotope machinations</p></a></li>
<li><a href='#vza_assign'><p>assign posterior probability of origin for a bird in each cell in the raster</p></a></li>
<li><a href='#vza_mean_and_var_rasters'><p>calculate a raster of mean and variance of expected tissue isotopes from precip data and resampled regressions</p></a></li>
<li><a href='#vza_rescale'><p>Parametric bootstrap for rescaling a la the vander zanden appendix</p></a></li>
<li><a href='#wiwa_breed'><p>a raster of the breeding range of Wilson's warbler</p></a></li>
<li><a href='#wiwa_habitat_unclipped'><p>RasterLayer showing the MaxEnt habitat suitability model unclipped by the known breeding range</p></a></li>
<li><a href='#wrld_simpl'><p>Simple map of the world</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Genetic and Isotopic Assignment Accounting for Habitat
Suitability</td>
</tr>
<tr>
<td>Description:</td>
<td>Tools for using genetic markers, stable isotope data, and habitat
    suitability data to calculate posterior probabilities of breeding origin of
    migrating birds.</td>
</tr>
<tr>
<td>Version:</td>
<td>0.0.5</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Eric C. Anderson &lt;eric.anderson@noaa.gov&gt;</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0)</td>
</tr>
<tr>
<td>Imports:</td>
<td>dplyr, geosphere, magrittr, raster, rlang, sp</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ggplot2</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>TRUE</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-04-27 16:20:55 UTC; eriq</td>
</tr>
<tr>
<td>Author:</td>
<td>Eric C. Anderson [cre, aut]</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-04-27 19:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='+25+26gt+3B+25'>Pipe operator</h2><span id='topic++25+3E+25'></span>

<h3>Description</h3>

<p>Pipe operator
</p>


<h3>Usage</h3>

<pre><code class='language-R'>lhs %&gt;% rhs
</code></pre>

<hr>
<h2 id='breeding_wiwa_genetic_posteriors'>Posterior probs of genetic region origin from Leave-one-out cross validation for breeding WIWAs</h2><span id='topic+breeding_wiwa_genetic_posteriors'></span>

<h3>Description</h3>

<p>A data frame of the same birds (roughly) that appear in <code><a href="#topic+breeding_wiwa_isotopes">breeding_wiwa_isotopes</a></code>.  A long
format data frame with 2,358 rows and 5 columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breeding_wiwa_genetic_posteriors
</code></pre>


<h3>Format</h3>

<p>A tibble with 2,358 rows and 5 variables. The variables are:
</p>

<dl>
<dt>ID</dt><dd><p>unique identifier for each bird</p>
</dd>
<dt>Short_Name</dt><dd><p>another id for the bird</p>
</dd>
<dt>NumberOfLoci</dt><dd><p>Number of loci successfully typed</p>
</dd>
<dt>region</dt><dd><p>one of the genetic regions</p>
</dd>
<dt>posterior</dt><dd><p>the posterior prob of originating from that region</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kristen Ruegg, Eric Anderson, Thomas Smith
</p>

<hr>
<h2 id='breeding_wiwa_isotopes'>Isotope values, latitude, longitude and more data from 357 breeding Wilson's warblers</h2><span id='topic+breeding_wiwa_isotopes'></span>

<h3>Description</h3>

<p>A data frame containing hydrogen isotope values, lat, long, and IDs and some other
columns of data for birds sampled on the breeding grounds. Notice that the latitude
column is named &quot;lat&quot; and the longitude column is named &quot;long&quot;.  Those names are both
all lowercase.  That is the way we roll here.  Make sure that you use &quot;lat&quot; and &quot;long&quot; instead
of &quot;Lat&quot; and &quot;Long&quot;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>breeding_wiwa_isotopes
</code></pre>


<h3>Format</h3>

<p>A tibble with 357 rows and 15 variables. The relevant variables for
analyses here are:
</p>

<dl>
<dt>ID</dt><dd><p>unique identifier for each bird</p>
</dd>
<dt>Isotope.Value</dt><dd><p>hydrogen isotope ratios measured in the bird's feather</p>
</dd>
<dt>lat</dt><dd><p>latitude of the bird's breeding/sampling location</p>
</dd>
<dt>long</dt><dd><p>latitude of the bird's breeding/sampling location</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kristen Ruegg, Jeff Kelly, Thomas Smith
</p>

<hr>
<h2 id='comboize'>combine genetics, isotopes, and habitat raster with exponents as given</h2><span id='topic+comboize'></span>

<h3>Description</h3>

<p>This just multiplies the rasters together, each raised to the appropriate
exponent, normalizes and returns the result
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comboize(Mgen, Miso, Mhab, beta_gen, beta_iso, beta_hab)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comboize_+3A_mgen">Mgen</code></td>
<td>
<p>the genetic posteriors rasterStack.  Must be a rasterStack</p>
</td></tr>
<tr><td><code id="comboize_+3A_miso">Miso</code></td>
<td>
<p>the isotope posteriors rasterStack.</p>
</td></tr>
<tr><td><code id="comboize_+3A_mhab">Mhab</code></td>
<td>
<p>a single layer raster with the habitat suitabiilty measure as a normalized
probability surface.</p>
</td></tr>
<tr><td><code id="comboize_+3A_beta_gen">beta_gen</code></td>
<td>
<p>the exponent to raise the habitat raster to</p>
</td></tr>
<tr><td><code id="comboize_+3A_beta_iso">beta_iso</code></td>
<td>
<p>the exponent to raise the isotope raster to</p>
</td></tr>
<tr><td><code id="comboize_+3A_beta_hab">beta_hab</code></td>
<td>
<p>the exponent to raise the genetic raster to</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># first, run through the example for isotope_posterior_probs() to get
# the rasters for two migrant birds. This gives us the list "birds2"
example(isotope_posterior_probs)

# extract the posterior probs rasters from  that output into a raster stack
miso &lt;- lapply(birds2$regular, function(x) x$posterior_probs) %&gt;%
  raster::stack()

# see the names of the birds we are dealing with:
names(miso)

# get the genetic posteriors for those two birds
mig_gen2 &lt;- migrant_wiwa_genetic_posteriors %&gt;%
  dplyr::filter(ID %in% c(names(miso)))

# make genetic posterior rasters for those two birds, make sure they are
# sorted in the same order as miso, and make a raster stack of it
mgen &lt;- genetic_posteriors2rasters(G = mig_gen2, R = genetic_regions)[names(miso)] %&gt;%
  raster::stack()

# make a normalized prior from habitat quality that is zeros everywhere
# outside of the "known" range.
tmp &lt;- wiwa_habitat_unclipped * wiwa_breed
mhab &lt;- tmp / raster::cellStats(tmp, sum)

# combine genetics, isotopes and habitat with exponents of 1 on each
mcombo &lt;- comboize(mgen, miso, mhab, 1, 1, 1)
</code></pre>

<hr>
<h2 id='comboize_and_fortify'>prepare fortified output for multipanel plot</h2><span id='topic+comboize_and_fortify'></span>

<h3>Description</h3>

<p>This takes Mgen, Miso, and Mhab for a single bird
and, if available, the true breeding location.  Then it
computes the combo-ized raster at all the requested levels
of the exponents, and creates a fortified data frame of the
results suitable for plotting in ggplot
</p>


<h3>Usage</h3>

<pre><code class='language-R'>comboize_and_fortify(
  mgen,
  miso,
  mhab,
  gen_beta_levels = 1,
  iso_beta_levels = c(1),
  hab_beta_levels = c(1)
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="comboize_and_fortify_+3A_mgen">mgen</code></td>
<td>
<p>genetics posterior raster</p>
</td></tr>
<tr><td><code id="comboize_and_fortify_+3A_miso">miso</code></td>
<td>
<p>isotope posterior raster</p>
</td></tr>
<tr><td><code id="comboize_and_fortify_+3A_mhab">mhab</code></td>
<td>
<p>habitat suitability raster</p>
</td></tr>
<tr><td><code id="comboize_and_fortify_+3A_gen_beta_levels">gen_beta_levels</code></td>
<td>
<p>vector of the desired values of gen_beta</p>
</td></tr>
<tr><td><code id="comboize_and_fortify_+3A_iso_beta_levels">iso_beta_levels</code></td>
<td>
<p>vector of the desired values of iso_beta</p>
</td></tr>
<tr><td><code id="comboize_and_fortify_+3A_hab_beta_levels">hab_beta_levels</code></td>
<td>
<p>vector of the desired values of hab_beta</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># run through the example for comboize to get the variables
# mgen, miso, and mhab that we will use.
example(comboize)

# then run that on the first bird to get a data frame
# that you can use with ggplot
ff &lt;- comboize_and_fortify(mgen[[1]], miso[[1]], mhab)

# this can be plotted with ggplot2
## Not run: 
library(ggplot2)
wmap &lt;- get_wrld_simpl()
ggplot(mapping = aes(x=long, y = lat)) +
  coord_fixed(1.3, xlim = c(-170, -50), ylim = c(33, 70)) +
  geom_polygon(data = wmap, aes(group = group), fill = NA, color = "black", size = .05) +
  geom_raster(data = ff, mapping = aes(fill = prob), interpolate = TRUE) +
  scale_fill_gradientn(colours = c("#EBEBEB", rainbow(7)), na.value = NA) +
  theme_bw() +
  facet_wrap( ~ beta_vals, ncol = 2) +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())

## End(Not run)

</code></pre>

<hr>
<h2 id='example_isotope_posteriors'>Output of <code><a href="#topic+isotope_posterior_probs">isotope_posterior_probs</a></code> for two migrant birds.</h2><span id='topic+example_isotope_posteriors'></span>

<h3>Description</h3>

<p>Because it takes too long to generate this output for future examples, we
just store it as a data object to use in examples.  See the example in
<code><a href="#topic+isotope_posterior_probs">isotope_posterior_probs</a></code> to see what this is.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>example_isotope_posteriors
</code></pre>


<h3>Format</h3>

<p>An object of class <code>list</code> of length 2.
</p>


<h3>Source</h3>

<p>Ruegg et al 2014
</p>

<hr>
<h2 id='extract_isopredictions'>Add the isomap prediction and sd in columns attached to the feather isotope data frame</h2><span id='topic+extract_isopredictions'></span>

<h3>Description</h3>

<p>Rasterizes the isomap predictions and standard deviation (using isomap2raster) and then extracts
the values associated with each location from the raster and returns the full data frame
with those values joined on in columns named iso_pred and iso_sd.  It overwrites
those columns with a warning if either of those columns already exists in the data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>extract_isopredictions(isoscape, birds, pred = "predkrig", sd = "stdkrig")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="extract_isopredictions_+3A_isoscape">isoscape</code></td>
<td>
<p>the data frame of prediction.txt from ISOMAP.  The latitude column must be named
&quot;lat&quot; and the longitude column must be named &quot;long&quot;.</p>
</td></tr>
<tr><td><code id="extract_isopredictions_+3A_birds">birds</code></td>
<td>
<p>data frame of the individual isotope values for the birds/feathers.  Should be
something like <code><a href="#topic+breeding_wiwa_isotopes">breeding_wiwa_isotopes</a></code>.</p>
</td></tr>
<tr><td><code id="extract_isopredictions_+3A_pred">pred</code></td>
<td>
<p>name of the column holding the prediction (like &quot;predkrig&quot;) in the
isoscape data frame</p>
</td></tr>
<tr><td><code id="extract_isopredictions_+3A_sd">sd</code></td>
<td>
<p>name of the column holding the standard deviation (like &quot;stdkrig&quot;) in the
isoscape data frame</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># Using the provided data from breeding Wilson's warblers and the provided
# predictions from isomap_job54152:
x &lt;- extract_isopredictions(isoscape = isomap_job54152_prediction,
                       birds = breeding_wiwa_isotopes,
                       pred = "predkrig",
                       sd = "stdkrig")
</code></pre>

<hr>
<h2 id='gaiah'>gaiah: Genetic and Isotopic Assignment Accounting for Habitat Suitability</h2><span id='topic+gaiah'></span>

<h3>Description</h3>

<p>Tools for using genetic markers, stable isotope data, and habitat
suitability data to calculate posterior probabilities of breeding origin of
migrating birds.
</p>


<h3>Details</h3>

<p>There is not a tutorial within the package, currently.  The best place to find an
example of how to use the functions in this package is at the GitHub repository:
<a href="https://github.com/eriqande/gaiah-wiwa">https://github.com/eriqande/gaiah-wiwa</a>. Go ahead and read the README there.
It should provide you with everything you need to get up and running with
the gaiah package.
</p>
<p>Finally, note that the development version of gaiah is available at
<a href="https://github.com/eriqande/gaiah">https://github.com/eriqande/gaiah</a>.
</p>

<hr>
<h2 id='genetic_posteriors2rasters'>Convert posteriors to particular genetic reporting groups into raster</h2><span id='topic+genetic_posteriors2rasters'></span>

<h3>Description</h3>

<p>When birds have been assigned to breeding groups or &quot;general areas&quot; as in Ruegg et al. 2014
then the posterior probabilty with which the birds were assigned to the groups needs to be
&quot;smeared out&quot; in a raster over the spatial extent of the groups.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genetic_posteriors2rasters(G, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="genetic_posteriors2rasters_+3A_g">G</code></td>
<td>
<p>long format data frame like breeding_wiwa_genetic_posteriors.  Has to have columns of ID, region, and posterior</p>
</td></tr>
<tr><td><code id="genetic_posteriors2rasters_+3A_r">R</code></td>
<td>
<p>a RasterStack like &quot;genetic_regions&quot;.  The sum of these should be the total known range.
The names of the regions in R must be the same as the entries in the &quot;region&quot; column in G.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This returns a list of rasters for each bird in G.  The entries in the raster
are the posterior probability of being from that cell.  This assumes that birds are equally likely
to come from any cell within the group's region.  It doesn't return a rasterStack because you
can't subset rasterStacks to change orders, etc., and it mangles names.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>library(raster)  # needed to deal with "genetic_regions" variable
# get a small subset of individuals so it doesn't take too long
data(breeding_wiwa_genetic_posteriors)
data(genetic_regions)
BW &lt;- breeding_wiwa_genetic_posteriors %&gt;%
  dplyr::filter(Short_Name %in% c("eNBFR01", "wABCA05", "wORHA21"))

# run the function on those
GPRs &lt;-  genetic_posteriors2rasters(BW, genetic_regions)
</code></pre>

<hr>
<h2 id='genetic_regions'>RasterStack showing the 6 genetic regions that Wilson's warblers may be assigned to</h2><span id='topic+genetic_regions'></span>

<h3>Description</h3>

<p>The sum over layers gives the same as <code><a href="#topic+wiwa_breed">wiwa_breed</a></code>
</p>


<h3>Usage</h3>

<pre><code class='language-R'>genetic_regions
</code></pre>


<h3>Format</h3>

<p>RasterStack with 6 layers. Each contains 1's in the genetic region and 0's elsewhere.
The sum of these layers is the raster <code><a href="#topic+wiwa_breed">wiwa_breed</a></code>.
</p>

<dl>
<dt>class</dt><dd><p> RasterStack </p>
</dd>
<dt>dimensions</dt><dd><p> 80, 228, 18240, 6  (nrow, ncol, ncell, nlayers)</p>
</dd>
<dt>resolution</dt><dd><p> 0.5, 0.5  (x, y)</p>
</dd>
<dt>extent</dt><dd><p> -168.1, -54.1, 31.2, 71.2  (xmin, xmax, ymin, ymax)</p>
</dd>
<dt>coord. ref.</dt><dd><p> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0 </p>
</dd>
<dt>data source</dt><dd><p>in memory</p>
</dd>
<dt>names</dt><dd><p> CalSierra, Basin.Rockies, Eastern, AK.EastBC.AB, Wa.To.NorCalCoast, CentCalCoast </p>
</dd>
</dl>



<h3>Source</h3>

<p>Ruegg et al 2014
</p>

<hr>
<h2 id='get_wrld_simpl'>return the wrld_simpl data set from maptools</h2><span id='topic+get_wrld_simpl'></span>

<h3>Description</h3>

<p>I define this as a function so that we don't have to attach
maptools, but we can just have it in the imports. Couldn't figure
out how to do it otherwise.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>get_wrld_simpl()
</code></pre>


<h3>Examples</h3>

<pre><code class='language-R'>ws &lt;- get_wrld_simpl()
head(ws)
## Not run: plot(ws)
</code></pre>

<hr>
<h2 id='great_circle_raster'>return a raster of great circle distances (in km)</h2><span id='topic+great_circle_raster'></span>

<h3>Description</h3>

<p>Given an input raster R, this returns a raster of the same dimension where
every cell is the great circle distance between lat, and long, and the
center of every cell in R.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>great_circle_raster(R, lat, long)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="great_circle_raster_+3A_r">R</code></td>
<td>
<p>a raster</p>
</td></tr>
<tr><td><code id="great_circle_raster_+3A_lat">lat</code></td>
<td>
<p>a latitude value (must be of length 1)</p>
</td></tr>
<tr><td><code id="great_circle_raster_+3A_long">long</code></td>
<td>
<p>a longitude value (must be of length 1)</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># We compute the great circle distance between the lat/long of my office in
# California, to every cell in the raster denoting the breeding habitat
# of Wilson's warbler:
gcr &lt;- great_circle_raster(wiwa_breed, lat = 36.951564, long = -122.065116)

# plot that if you want
## Not run: 
plot(gcr)
lines(get_wrld_simpl())

## End(Not run)
</code></pre>

<hr>
<h2 id='group_birds_by_location'>Group bird isotope data by locations</h2><span id='topic+group_birds_by_location'></span>

<h3>Description</h3>

<p>This takes as input a data frame of feather isotope data that also has the
isoscape predictions attached to it, just like the data frame returned by
<code><a href="#topic+extract_isopredictions">extract_isopredictions</a></code>.  The data frame must have a column
that gives the general location by which you will group birds for the
rescaling function.  The isoscape predictions by default should be in columns named
<code>iso_pred</code> for the actual prediction, and <code>iso_sd</code> for the standard deviation,
as produced by <code><a href="#topic+extract_isopredictions">extract_isopredictions</a></code>, but those are user configurable,
as well.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>group_birds_by_location(
  D,
  feather_isotope_col,
  location_col,
  iso_pred_col = "iso_pred",
  iso_sd_col = "iso_sd"
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="group_birds_by_location_+3A_d">D</code></td>
<td>
<p>the data frame of feather isotope data with the isoscape predictions
extracted for each location, as well, and a column giving general grouping
locations for the birds.</p>
</td></tr>
<tr><td><code id="group_birds_by_location_+3A_feather_isotope_col">feather_isotope_col</code></td>
<td>
<p>the string name of the column holding the feather isotope
data.</p>
</td></tr>
<tr><td><code id="group_birds_by_location_+3A_location_col">location_col</code></td>
<td>
<p>the string name of the column holding the locations to be
used for grouping.</p>
</td></tr>
<tr><td><code id="group_birds_by_location_+3A_iso_pred_col">iso_pred_col</code></td>
<td>
<p>name of the column holding the predicted values from the isoscape. Default
is <code>iso_pred</code>.</p>
</td></tr>
<tr><td><code id="group_birds_by_location_+3A_iso_sd_col">iso_sd_col</code></td>
<td>
<p>name of the column holding the standard deviations of the predicted values
from the isoscape. Default is <code>iso_sd_col</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This function returns a data frame with columns for the mean and SD of feather/bird values,
(<code>meanH</code> and <code>sdH</code>) and the mean predicted isotope value and the mean sd of the predicted
isotope values (<code>meaniso</code> and <code>sdiso</code>) for all the samples within each location.  It
also returns the Location column itself and a column <code>cnt</code> that gives the number of bird/tissue
samples from each location.
</p>
<p>This function
throws an error if any of the locations has only 1 sample.  If that is the case, you may consider
merging that sample with another location (or dropping it?).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># first run the example for extract_isopredictions to get the variable "x"
example("extract_isopredictions")

# If this were run it gives an error because there is only 1 bird at the
# location "Charlevoix"
## Not run: 
group_birds_by_location(x, feather_isotope_col = "Isotope.Value", location_col = "Location")

## End(Not run)


# remove that one bird at Charlevoix and re-run
y &lt;- x %&gt;%
  dplyr::filter(Location != "Charlevoix")

# then group birds by location
gbl &lt;- group_birds_by_location(D = y,
                               feather_isotope_col = "Isotope.Value",
                               location_col = "Location")
</code></pre>

<hr>
<h2 id='hpd_cumul'>finds the cumulative posterior probability of each cell for HPD calculation</h2><span id='topic+hpd_cumul'></span>

<h3>Description</h3>

<p>This function is not exported currently, but is used in min_hpd_inclusion_area
</p>


<h3>Usage</h3>

<pre><code class='language-R'>hpd_cumul(B)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="hpd_cumul_+3A_b">B</code></td>
<td>
<p>a raster of posterior probs</p>
</td></tr>
</table>

<hr>
<h2 id='isomap_job54152_prediction'>Predicted isotope values from ISOMAP</h2><span id='topic+isomap_job54152_prediction'></span>

<h3>Description</h3>

<p>A data frame containing predicted hydrogen isotope values, lat, long, and IDs and some other
columns of data prections made by ISOMAP
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isomap_job54152_prediction
</code></pre>


<h3>Format</h3>

<p>A tibble with 10,786 rows and 12 variables. The relevant variables for
analyses here are:
</p>

<dl>
<dt>lat</dt><dd><p>latitude of the predicted location</p>
</dd>
<dt>long</dt><dd><p>longitude of the predicted location</p>
</dd>
<dt>predreg</dt><dd><p>Fill in</p>
</dd>
<dt>stdreg</dt><dd><p>Fill in</p>
</dd>
<dt>predkrig</dt><dd><p>Fill in</p>
</dd>
<dt>stdkrig</dt><dd><p>Fill in</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kristina Paxton and ISOMAP (http://isomap.rcac.purdue.edu:8080/gridsphere/gridsphere)
</p>

<hr>
<h2 id='isomap2raster'>convert columns of an ISOMAP isoscape to a raster object</h2><span id='topic+isomap2raster'></span>

<h3>Description</h3>

<p>Just simple conversion, but nice to have this in a brief function
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isomap2raster(isoscape, column, Proj = raster::projection(get_wrld_simpl()))
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isomap2raster_+3A_isoscape">isoscape</code></td>
<td>
<p>the data frame of prediction.txt from ISOMAP.  The latitude column must be named
&quot;lat&quot; and the longitude column must be named &quot;long&quot;.</p>
</td></tr>
<tr><td><code id="isomap2raster_+3A_column">column</code></td>
<td>
<p>the name of the column to turn into a raster object.  This should be
a quoted string, like &quot;predkrig&quot;.</p>
</td></tr>
<tr><td><code id="isomap2raster_+3A_proj">Proj</code></td>
<td>
<p>the desired projection.
By default it is raster::projection(get_wrld_simpl()), i.e. the same projection as the wrld_simpl map.</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>isorast &lt;- isomap2raster(isomap_job54152_prediction, "predreg")
isorast
</code></pre>

<hr>
<h2 id='isotope_posterior_probs'>compute posterior probabilities of origin given isotope values</h2><span id='topic+isotope_posterior_probs'></span>

<h3>Description</h3>

<p>This function automates the whole process described in the appendix of
Vander Zanden et al. (2014) for computing the posterior probability of
origin of an individual (or group of individuals) given its stable isotope
values, and those of a set of reference individuals, and an ISOMAP prediction
of isotope values across a landscape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>isotope_posterior_probs(
  isoscape,
  ref_birds,
  assign_birds = NULL,
  isoscape_pred_column = "predkrig",
  isoscape_sd_column = "stdkrig",
  self_assign = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="isotope_posterior_probs_+3A_isoscape">isoscape</code></td>
<td>
<p>the data frame read in from &quot;prediction.txt&quot; from ISOMAP. The
latitude column must be named &quot;lat&quot; and the longitude column must be named &quot;long&quot;.  You have to choose
which columns to use with the parameters <code>isoscape_pred_column</code> and <code>isoscape_sd_column</code>.</p>
</td></tr>
<tr><td><code id="isotope_posterior_probs_+3A_ref_birds">ref_birds</code></td>
<td>
<p>a data frame of reference birds. This should have (at least) columns of &quot;ID&quot;
(for unique identifiers for each bird), &quot;lat&quot;, &quot;long&quot;,
&quot;Isotope.Value&quot; and &quot;Location&quot;.  The &quot;Location&quot; column will be used to group samples for
the Vander Zanden Rescaling.</p>
</td></tr>
<tr><td><code id="isotope_posterior_probs_+3A_assign_birds">assign_birds</code></td>
<td>
<p>A data frame of birds whose breeding origins are to be inferred.  These must have
at a minimum the column &quot;ID&quot; (for uniqe identifiers for the birds) and the column &quot;Isotope.Value&quot;. This can
be left NULL if there are no birds of unknown origin to assign (for example if you are performing cross-validation
on the ref_birds).</p>
</td></tr>
<tr><td><code id="isotope_posterior_probs_+3A_isoscape_pred_column">isoscape_pred_column</code></td>
<td>
<p>the name of the column in <code>isoscape</code> to be used as the prediction (default
is &quot;predkrig&quot;).</p>
</td></tr>
<tr><td><code id="isotope_posterior_probs_+3A_isoscape_sd_column">isoscape_sd_column</code></td>
<td>
<p>the name of the column in <code>isoscape</code> to be used as the standard deviation (default
is &quot;stdkrig&quot;).</p>
</td></tr>
<tr><td><code id="isotope_posterior_probs_+3A_self_assign">self_assign</code></td>
<td>
<p>if TRUE, then the birds in <code>ref_birds</code> will each have posterior surfaces computed for
them using a leave one out procedure (i.e. each bird in turn is left out while rescaling the precip isomap to
a tissue isomap).  Should not be TRUE if assign_birds is non NULL.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>For details see:
</p>
<p>Vander Zanden HB, Wunder MB, Hobson KA, Van Wilgenburg SL, Wassenaar LI, Welker JM, Bowen GJ (2014)
Contrasting assignment of migratory organisms to geographic origins using long-term versus year-specific
precipitation isotope maps. Methods in Ecology and Evolution, 5, 891-900.
</p>
<p>And the re-explanation of that method in Ruegg et al. (2017).
</p>


<h3>Examples</h3>

<pre><code class='language-R'># obtain posterior probability rasters for the first 2 birds in the migrant_wiwa_isotopes
# data set.  This takes about 15 seconds on my laptop (most of that time is preparatory---once
# that is done, each bird goes much faster). So we don't run it here.
## Not run: 
birds2 &lt;- isotope_posterior_probs(isoscape = isomap_job54152_prediction,
                        ref_birds = breeding_wiwa_isotopes,
                        assign_birds = migrant_wiwa_isotopes[1:2,]
                        )

## End(Not run)

# However, you can load the results as a saved data object to see what they look like:
birds2 &lt;- example_isotope_posteriors


# Since the ref_birds above were separate from the migrant birds, no leave-one-out was
# performed.  Hence birds2$loo_results is NULL, and all the results are in
# birds2$regular.

# Look at the names of the resulting output for the first bird:
names(birds2$regular[[1]])

names(birds2$regular[[1]]$assignment_parameters)



# If you want to do self-assignment for a whole bunch of reference birds, it takes much longer.
# It looks like this:
## Not run: 
self_ass &lt;- isotope_posterior_probs(isoscape = isomap_job54152_prediction,
                                    ref_birds = breeding_wiwa_isotopes,
                                    self_assign = TRUE)

## End(Not run)
</code></pre>

<hr>
<h2 id='migrant_wiwa_genetic_posteriors'>Posterior probs of genetic region of origin for 926 WIWAs sampled during migration</h2><span id='topic+migrant_wiwa_genetic_posteriors'></span>

<h3>Description</h3>

<p>A long
format data frame with 5,556 rows and 6 columns
</p>


<h3>Usage</h3>

<pre><code class='language-R'>migrant_wiwa_genetic_posteriors
</code></pre>


<h3>Format</h3>

<p>A tibble with 5,556 rows and 6 columns. The relevant variables for
analyses here are:
</p>

<dl>
<dt>ID</dt><dd><p>unique identifier for each bird</p>
</dd>
<dt>Short_Name</dt><dd><p>same id for the bird</p>
</dd>
<dt>Collection_Date</dt><dd><p>The date the bird was sampled.</p>
</dd>
<dt>NumberOfLoci</dt><dd><p>Number of loci successfully typed</p>
</dd>
<dt>region</dt><dd><p>one of the genetic regions</p>
</dd>
<dt>posterior</dt><dd><p>the posterior prob of originating from that region</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kristina Paxton, Kristen Ruegg, Eric Anderson, Thomas Smith
</p>

<hr>
<h2 id='migrant_wiwa_isotopes'>Isotope values and meta data for 688 migrating Wilson's Warblers</h2><span id='topic+migrant_wiwa_isotopes'></span>

<h3>Description</h3>

<p>A data frame containing hydrogen isotope values, lat, long, and IDs and some other
columns of data for birds sampled during migration from Arizona.  604 of the individuals
in this data set also have values in <code><a href="#topic+migrant_wiwa_genetic_posteriors">migrant_wiwa_genetic_posteriors</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>migrant_wiwa_isotopes
</code></pre>


<h3>Format</h3>

<p>A tibble with 688 rows and 14 variables. The relevant variables for
analyses here are:
</p>

<dl>
<dt>ID</dt><dd><p>unique identifier for each bird</p>
</dd>
<dt>Isotope.Value</dt><dd><p>hydrogen isotope ratios measured in the bird's feather</p>
</dd>
</dl>



<h3>Source</h3>

<p>Kristina Paxton
</p>

<hr>
<h2 id='min_hpd_inc_area_df'>compute the minimum hpd inclusion area for all the birds in a rasterStack</h2><span id='topic+min_hpd_inc_area_df'></span>

<h3>Description</h3>

<p>This is a convenient wrapper that lets you pass in a data frame of bird
names with lats and longs and a rasterStack or rasterBrick and it returns
the min hpd inclusion area for each bird in a tbl_df-ed data frame.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_hpd_inc_area_df(birds, R)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min_hpd_inc_area_df_+3A_birds">birds</code></td>
<td>
<p>a data frame that minimally has columns <code>Short_Name</code>, <code>lat</code>, and
<code>long</code>.</p>
</td></tr>
<tr><td><code id="min_hpd_inc_area_df_+3A_r">R</code></td>
<td>
<p>a rasterStack or rasterBrick of posteriors that each bird originated from
each of the cells.  The names of the layers must correspond to the ID column in
kbirds.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>This returns a list with three components:
</p>

<ul>
<li><p>area the minimum hpd inclusion area as a data frame with columns &quot;Short_Name&quot; and &quot;min_hpd_area&quot;
</p>
</li>
<li><p>missingFromRastercharacter vector of the names of birds found in birds$Short_Name but not found in
the names of R
</p>
</li>
<li><p>missingFromDF character vector of names in R that are not found in birds$Short_Name.
</p>
</li></ul>


<hr>
<h2 id='min_hpd_inclusion_area'>compute the smallest area of an HPD credible set that includes the true bird location</h2><span id='topic+min_hpd_inclusion_area'></span>

<h3>Description</h3>

<p>This function computes the area of the HPD credible set that is as small as possible
but just barely includes the cell with the true location (or, if the true location is not
actually inluded in the range map, we use the closest cell on the range map to the true
location).  This operates on a single rasterLayer.  To operate on a rasterBrick of posteriors
and a data frame of lat-longs, use 'min_hpd_inc_area_df()'.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>min_hpd_inclusion_area(M, lat, long)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="min_hpd_inclusion_area_+3A_m">M</code></td>
<td>
<p>the posterior surface matrix</p>
</td></tr>
<tr><td><code id="min_hpd_inclusion_area_+3A_lat">lat</code></td>
<td>
<p>the true latitude</p>
</td></tr>
<tr><td><code id="min_hpd_inclusion_area_+3A_long">long</code></td>
<td>
<p>the true longitude</p>
</td></tr>
</table>

<hr>
<h2 id='private_rescale'>internal function for isotope machinations</h2><span id='topic+private_rescale'></span>

<h3>Description</h3>

<p>does these things:
1. removes birds in Locations that have only 1 bird in them (printing a warning message while it does so)
2. does the vza rescaling process and returns the output that is needed for the vza_assign
function.  (basically the ouput of the mean and var rasters). Should return a-bar and b-bar
too &mdash; all of that in a big list.
Then with that output I can pump it all into vza_assign for a particular (left-out) ref_bird or for
an assign bird.  I should return the fitted model for each one.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>private_rescale(birds, pred, std)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="private_rescale_+3A_birds">birds</code></td>
<td>
<p>a data frame like &quot;ref_birds&quot; in <code>isotope_posterior_probs</code> after the isopredictions
have been attached to it.</p>
</td></tr>
<tr><td><code id="private_rescale_+3A_pred">pred</code></td>
<td>
<p>The raster of isoscape predictions</p>
</td></tr>
<tr><td><code id="private_rescale_+3A_std">std</code></td>
<td>
<p>The raster of isoscape standard deviations</p>
</td></tr>
</table>

<hr>
<h2 id='vza_assign'>assign posterior probability of origin for a bird in each cell in the raster</h2><span id='topic+vza_assign'></span>

<h3>Description</h3>

<p>This is a rewrite of the function <code>assignment</code> from the Vander
Zanden appendix code.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vza_assign(rescale_mean, rescale_var, precip_sd, sd_indiv, bird_iso)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vza_assign_+3A_rescale_mean">rescale_mean</code></td>
<td>
<p>the tissue specific mean raster, such as the mean.raster
component of the output of <code>vza_mean_and_var_rasters</code>.</p>
</td></tr>
<tr><td><code id="vza_assign_+3A_rescale_var">rescale_var</code></td>
<td>
<p>tissue specific raster of standard deviations, such as the var.raster
component of the output of <code>vza_mean_and_var_rasters</code>.</p>
</td></tr>
<tr><td><code id="vza_assign_+3A_precip_sd">precip_sd</code></td>
<td>
<p>SD raster associated with the IsoMAP output.
This is the precip component of the variance term.</p>
</td></tr>
<tr><td><code id="vza_assign_+3A_sd_indiv">sd_indiv</code></td>
<td>
<p>the individual component of the variance term.
This is a value to be determined by the user.  The standard approach is to
use the mean of the SDs observed among individuals at all of the calibration sites.</p>
</td></tr>
<tr><td><code id="vza_assign_+3A_bird_iso">bird_iso</code></td>
<td>
<p>a single value giving the isotope ratio found in the individual's feather.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is a fairly low-level function.  It returns a raster of posterior probs (they are
scaled to sum to one over all cells).
</p>

<hr>
<h2 id='vza_mean_and_var_rasters'>calculate a raster of mean and variance of expected tissue isotopes from precip data and resampled regressions</h2><span id='topic+vza_mean_and_var_rasters'></span>

<h3>Description</h3>

<p>This is a rewrite of the function <code>raster.conversion</code> from the Vander Zanden
appendix.  They expressed things in terms of the standard deviations, but they need to
be turned into variances, anyway, so that is what we've done here.  Following the notation
of the paper on Wilson's warbler, this function computes $tildeT^(mu)$ (returned as
list component <code>mean.raster</code>) and $R^(sigma^2)$ (returned as list component
<code>var.raster</code>)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vza_mean_and_var_rasters(iso_raster, si)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vza_mean_and_var_rasters_+3A_iso_raster">iso_raster</code></td>
<td>
<p>the raster of isotope precipitation values, for example, like that
produced by <code><a href="#topic+isomap2raster">isomap2raster</a></code>.</p>
</td></tr>
<tr><td><code id="vza_mean_and_var_rasters_+3A_si">si</code></td>
<td>
<p>slopes and intercepts from the resampled regressions.  This is a data frame
with columns named &quot;slopes&quot; and &quot;intercepts&quot; like that returned by <code><a href="#topic+vza_rescale">vza_rescale</a></code></p>
</td></tr>
</table>

<hr>
<h2 id='vza_rescale'>Parametric bootstrap for rescaling a la the vander zanden appendix</h2><span id='topic+vza_rescale'></span>

<h3>Description</h3>

<p>This is a vectorized and <strong>much</strong> more efficient implementation
of the original <code>rescale</code> function from the Vander Zanden appendix.
It takes the output of <code><a href="#topic+group_birds_by_location">group_birds_by_location</a></code> directly
and does the parametric bootstrapping for vza_rescale_reps samples.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>vza_rescale(SBL, vza_rescale_reps = 1000)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="vza_rescale_+3A_sbl">SBL</code></td>
<td>
<p>the data frame that summarizes the isotope feather data and
isoscape predictions at each location. This must have columns of <code>cnt</code>,
<code>meanH</code>, <code>sdH</code>, <code>meaniso</code>, <code>sdiso</code></p>
</td></tr>
<tr><td><code id="vza_rescale_+3A_vza_rescale_reps">vza_rescale_reps</code></td>
<td>
<p>Number of simulated regressions to do.  Default is 1000.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Returns a matrix with vza_rescale_reps rows.  Column 1 is &quot;intercepts&quot; and column
two is &quot;slopes&quot;
</p>

<hr>
<h2 id='wiwa_breed'>a raster of the breeding range of Wilson's warbler</h2><span id='topic+wiwa_breed'></span>

<h3>Description</h3>

<p>a raster of the breeding range of Wilson's warbler
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wiwa_breed
</code></pre>


<h3>Format</h3>

<p>This a rasterized version of the breeding range of Wilson's warbler
It contains 1's in the breeding range and 0's elsewhere.
</p>

<dl>
<dt>class</dt><dd><p>RasterLayer</p>
</dd>
<dt>dimensions</dt><dd><p>80, 228, 18240  (nrow, ncol, ncell)</p>
</dd>
<dt>resolution</dt><dd><p>0.5, 0.5  (x, y)</p>
</dd>
<dt>extent</dt><dd><p>-168.1, -54.1, 31.2, 71.2  (xmin, xmax, ymin, ymax)</p>
</dd>
<dt>coord. ref.</dt><dd><p>+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0</p>
</dd>
<dt>data source</dt><dd><p>in memory</p>
</dd>
<dt>names</dt><dd><p>layer</p>
</dd>
<dt>values</dt><dd><p>0, 1  (min, max)</p>
</dd>
</dl>



<h3>Source</h3>

<p>The rasters were generated from shapefiles provided to us by
BirdLife International. (BirdLife International and NatureServe (2012)
Bird species distribution maps of the world. BirdLife International, Cambridge,
UK and NatureServe, Arlington, USA). Persons interested in the range map
should contact BirdLife International http://www.birdlife.org/ or
NatureServe http://www.natureserve.org/ directly.
</p>

<hr>
<h2 id='wiwa_habitat_unclipped'>RasterLayer showing the MaxEnt habitat suitability model unclipped by the known breeding range</h2><span id='topic+wiwa_habitat_unclipped'></span>

<h3>Description</h3>


<dl>
<dt>class</dt><dd><p> RasterLayer </p>
</dd>
<dt>dimensions</dt><dd><p> 80, 228, 18240, 6  (nrow, ncol, ncell, nlayers)</p>
</dd>
<dt>resolution</dt><dd><p> 0.5, 0.5  (x, y)</p>
</dd>
<dt>extent</dt><dd><p> -168.1, -54.1, 31.2, 71.2  (xmin, xmax, ymin, ymax)</p>
</dd>
<dt>coord. ref.</dt><dd><p> +proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs +towgs84=0,0,0 </p>
</dd>
<dt>data source</dt><dd><p>in memory</p>
</dd>
<dt>values</dt><dd><p>0, 0.001093349  (min, max)</p>
</dd>
</dl>



<h3>Usage</h3>

<pre><code class='language-R'>wiwa_habitat_unclipped
</code></pre>


<h3>Format</h3>

<p>An object of class <code>RasterLayer</code> of dimension 80 x 228 x 1.
</p>


<h3>Source</h3>

<p>Ryan Harrigan
</p>

<hr>
<h2 id='wrld_simpl'>Simple map of the world</h2><span id='topic+wrld_simpl'></span>

<h3>Description</h3>

<p>This is wrld_simpl from the maptools package.  It was all that I used from
the maptools package which is going to be archived at the end of 2023.  So,
I just saved wrld_simpl as a data object in this package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>wrld_simpl
</code></pre>


<h3>Format</h3>

<p>a SpatialPolygonsDataFrame
</p>


<h3>Source</h3>

<p>Got this from the old maptools package.  See ?maptools::wrld_simpl
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
