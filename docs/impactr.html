<!DOCTYPE html><html><head><title>Help for package impactr</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {impactr}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#define_region'><p>Define region of interest</p></a></li>
<li><a href='#delete_nonwear'><p>Delete accelerometer non-wear time</p></a></li>
<li><a href='#detect_nonwear'><p>Detection of accelerometer non-wear time</p></a></li>
<li><a href='#filter_acc'><p>Filter the acceleration signal</p></a></li>
<li><a href='#find_peaks'><p>Find peaks in a signal</p></a></li>
<li><a href='#impactr_example'><p>Get path to example data</p></a></li>
<li><a href='#import_dataset'><p>Import datasets from accdata package</p></a></li>
<li><a href='#install_accdata'><p>Install accdata package</p></a></li>
<li><a href='#is_impactr'><p>Test if the object is from the impactr package</p></a></li>
<li><a href='#mark_nonwear'><p>Mark accelerometer non-wear time</p></a></li>
<li><a href='#new_impactr_data'><p>Constructor for impactr_data object</p></a></li>
<li><a href='#new_impactr_peaks'><p>Constructor for impactr_peaks object</p></a></li>
<li><a href='#plot_nonwear'><p>Plot the non-wear time detection</p></a></li>
<li><a href='#predict_loading'><p>Predict mechanical loading</p></a></li>
<li><a href='#read_acc'><p>Read raw accelerometer data</p></a></li>
<li><a href='#remove_nonwear'><p>Detect and remove accelerometer non-wear time</p></a></li>
<li><a href='#specify_parameters'><p>Specify prediction model parameters</p></a></li>
<li><a href='#summarise_loading'><p>Summarise mechanical loading variables</p></a></li>
<li><a href='#summarise_nonwear'><p>Summarise accelerometer non-wear time</p></a></li>
<li><a href='#use_resultant'><p>Use resultant vector</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Mechanical Loading Prediction Through Accelerometer Data</td>
</tr>
<tr>
<td>Version:</td>
<td>0.4.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions to read, process and analyse accelerometer
    data related to mechanical loading variables. This package is
    developed and tested for use with raw accelerometer data from
    triaxial 'ActiGraph' <a href="https://theactigraph.com">https://theactigraph.com</a> accelerometers.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file LICENSE</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://lveras.com/impactr/">https://lveras.com/impactr/</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/verasls/impactr/issues/">https://github.com/verasls/impactr/issues/</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>Imports:</td>
<td>glue, lubridate, lvmisc, pillar, pracma, purrr, Rcpp, rlang
(&ge; 0.4.6), signal, stringr, tibble, toOrdinal, utils, vroom</td>
</tr>
<tr>
<td>Suggests:</td>
<td>accdata, covr, knitr, rmarkdown, testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Language:</td>
<td>en-GB</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 2.10)</td>
</tr>
<tr>
<td>Additional_repositories:</td>
<td><a href="https://lveras.com/drat/">https://lveras.com/drat/</a></td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-02-26 19:51:03 UTC; lucasveras</td>
</tr>
<tr>
<td>Author:</td>
<td>Lucas Veras <a href="https://orcid.org/0000-0003-0562-5803"><img alt="ORCID iD"src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a> [aut,
    cre]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Lucas Veras &lt;lucasdsveras@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-02-26 23:50:22 UTC</td>
</tr>
</table>
<hr>
<h2 id='define_region'>Define region of interest</h2><span id='topic+define_region'></span>

<h3>Description</h3>

<p>Define the region of interest for data analysis based on the accelerometer
data timestamp.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>define_region(data, start_time, end_time)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="define_region_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="define_region_+3A_start_time">start_time</code>, <code id="define_region_+3A_end_time">end_time</code></td>
<td>
<p>A character string with the start and end times
of the region of interest in the &quot;YYYY-MM-DD HH:MM:SS&quot; format.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
define_region(
  data, start_time = "2021-04-06 15:45:00", end_time = "2021-04-06 15:46:00"
)
</code></pre>

<hr>
<h2 id='delete_nonwear'>Delete accelerometer non-wear time</h2><span id='topic+delete_nonwear'></span>

<h3>Description</h3>

<p>Deletes all periods marked as non-wear.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>delete_nonwear(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="delete_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object with the <code>wear</code> column, as
obtained with <a href="#topic+mark_nonwear">mark_nonwear()</a>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function, designed to be used inside the wrapper
function <a href="#topic+remove_nonwear">remove_nonwear()</a> that integrates all
steps of detection, removal and inspection of accelerometer non-wear time.
</p>


<h3>Value</h3>

<p>The <code>impactr_data</code> object provided by <code>data</code> without the
<code>wear</code> column and with the non-wear time removed.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_nonwear">detect_nonwear()</a></code>,
<code><a href="#topic+plot_nonwear">plot_nonwear()</a></code>,
<code><a href="#topic+mark_nonwear">mark_nonwear()</a></code>,
<code><a href="#topic+summarise_nonwear">summarise_nonwear()</a></code>
</p>

<hr>
<h2 id='detect_nonwear'>Detection of accelerometer non-wear time</h2><span id='topic+detect_nonwear'></span>

<h3>Description</h3>

<p>Implementation of the van Hees algorithm of non-wear detection.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>detect_nonwear(data, window1, window2, threshold)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="detect_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="detect_nonwear_+3A_window1">window1</code>, <code id="detect_nonwear_+3A_window2">window2</code></td>
<td>
<p>Windows size, in minutes, for the non-wear
detection algorithm. <code>window2</code> must be smaller than <code>window1</code>,
and <code>window1</code> must be a multiple of <code>window2</code>.</p>
</td></tr>
<tr><td><code id="detect_nonwear_+3A_threshold">threshold</code></td>
<td>
<p>Number of axes that need to meet the non-wear criteria.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function, designed to be used inside the wrapper
function <a href="#topic+remove_nonwear">remove_nonwear()</a> that integrates all
steps of detection, removal and inspection of accelerometer non-wear time.
</p>


<h3>Value</h3>

<p>A named list of length 2 (stage1 and stage2) containing the binary
non-wear classification (0 is wear and 1 is non-wear) of each algorithm's
stage per <code>window2</code> blocks.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plot_nonwear">plot_nonwear()</a></code>,
<code><a href="#topic+mark_nonwear">mark_nonwear()</a></code>,
<code><a href="#topic+summarise_nonwear">summarise_nonwear()</a></code>,
<code><a href="#topic+delete_nonwear">delete_nonwear()</a></code>
</p>

<hr>
<h2 id='filter_acc'>Filter the acceleration signal</h2><span id='topic+filter_acc'></span>

<h3>Description</h3>

<p>Filter the acceleration signal using a butterworth digital filter.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>filter_acc(data, order = 4, cutoff = 20, type = "lowpass")
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="filter_acc_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="filter_acc_+3A_order">order</code></td>
<td>
<p>The order of the filter. Defaults to 4.</p>
</td></tr>
<tr><td><code id="filter_acc_+3A_cutoff">cutoff</code></td>
<td>
<p>The filter cut-off frequency in Hz. Defaults to 20. For
low- and high-pass filters, must be a scalar. For band-pass and band-
stop, a vector of length two.</p>
</td></tr>
<tr><td><code id="filter_acc_+3A_type">type</code></td>
<td>
<p>The type of filter. Defaults to &quot;lowpass&quot;. Can be &quot;lowpass&quot;,
&quot;highpass&quot;, &quot;bandpass&quot; or &quot;bandstop&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default values of the filter parameters are matching the filter
used in the paper by Veras et al. that developed the mechanical loading
prediction equations (see References).
</p>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code>.
</p>


<h3>References</h3>


<ul>
<li><p> Veras L, Diniz-Sousa F, Boppre G, Devezas V, Santos-Sousa H, Preto J,
Machado L, Vilas- Boas JP, Oliveira J, Fonseca H. Accelerometer-based
prediction of skeletal mechanical loading during walking in normal weight
to severely obese subjects. Osteoporosis International. 2020. 31(7):1239-
1250. <a href="https://doi.org/10.1007/s00198-020-05295-2">doi:10.1007/s00198-020-05295-2</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
filter_acc(data)
</code></pre>

<hr>
<h2 id='find_peaks'>Find peaks in a signal</h2><span id='topic+find_peaks'></span>

<h3>Description</h3>

<p>Find peaks in the acceleration signal.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_peaks(data, vector, min_height = 1.3, min_dist = 0.4)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="find_peaks_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="find_peaks_+3A_vector">vector</code></td>
<td>
<p>A character string indicating in which acceleration vector to
find the peaks. Can be &quot;resultant&quot;, &quot;vertical&quot; or &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="find_peaks_+3A_min_height">min_height</code></td>
<td>
<p>The minimum height of the peaks (in <em>g</em>).</p>
</td></tr>
<tr><td><code id="find_peaks_+3A_min_dist">min_dist</code></td>
<td>
<p>The minimum horizontal distance between peaks (in seconds).</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The default values of the filter parameters are matching the filter
used in the paper by Veras et al. that developed the mechanical loading
prediction equations (see References).
When the <code>vector</code> parameter is set to &quot;all&quot;, there may contain
<code>NA</code> values in the <code>resultant_peak_acc</code> and/or
<code>vertical_peak_acc</code> at the timestamps in which a peak value for that
vector could not be identified.
</p>
<p>The default values of <code>min_height</code> and <code>min_dist</code> are
matching the criteria used in the paper by Veras et al. that developed the
mechanical loading prediction equations (see References)
</p>


<h3>Value</h3>

<p>An object of class <code>impactr_peaks</code> with the peaks magnitude
stored in the columns.
</p>


<h3>References</h3>


<ul>
<li><p> Veras L, Diniz-Sousa F, Boppre G, Devezas V, Santos-Sousa H, Preto J,
Machado L, Vilas- Boas JP, Oliveira J, Fonseca H. Accelerometer-based
prediction of skeletal mechanical loading during walking in normal weight
to severely obese subjects. Osteoporosis International. 2020. 31(7):1239-
1250. <a href="https://doi.org/10.1007/s00198-020-05295-2">doi:10.1007/s00198-020-05295-2</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
data &lt;- use_resultant(data)
find_peaks(data, vector = "resultant")
</code></pre>

<hr>
<h2 id='impactr_example'>Get path to example data</h2><span id='topic+impactr_example'></span>

<h3>Description</h3>

<p><code>impactr</code> comes with some example ActiGraph accelerometer raw data
files in its <code>inst/extdata</code> directory. This function make them easy to
access.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>impactr_example(file = NULL)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="impactr_example_+3A_file">file</code></td>
<td>
<p>A character string with the file name. If <code>NULL</code>, the
example files will be listed.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>If <code>file = NULL</code>, it returns the file names of the example
data files, else it returns the path to the example data.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>impactr_example()
impactr_example("hip-raw.csv")
</code></pre>

<hr>
<h2 id='import_dataset'>Import datasets from accdata package</h2><span id='topic+import_dataset'></span>

<h3>Description</h3>

<p>A helper function to import datasets from the <code>accdata</code> package.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>import_dataset(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="import_dataset_+3A_data">data</code></td>
<td>
<p>A character string indicating which data to load. The currently
available datasets are &quot;daily_acc_3d&quot; and &quot;daily_acc_7d&quot;.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>To import these datasets you need to install the <code>accdata</code>
package. It can be installed by running <code>install_accdata()</code>. The
datasets documentation can be accessed by <code>?accdata::`dataset_name`</code>
(e.g., <code>?accdata::daily_acc_3d</code>.
</p>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Ensure that {accdata} package is available before running the example.
# If it is not, run install_accdata() to install the required package.
if (requireNamespace("accdata", quietly = TRUE)) {
  data &lt;- import_dataset("daily_acc_3d")
  data
}

</code></pre>

<hr>
<h2 id='install_accdata'>Install accdata package</h2><span id='topic+install_accdata'></span>

<h3>Description</h3>

<p>A helper function to install the <code>accdata</code> package from a
<a href="https://lveras.com/drat/"><code>drat</code></a> repository. The <code>accdata</code>
package contains datasets that can be used to test the functionalities
from <code>impactr</code>. Note that <code>accdata</code> is a large package
(approximately 80 MB) and could take a while to download and install.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>install_accdata()
</code></pre>

<hr>
<h2 id='is_impactr'>Test if the object is from the impactr package</h2><span id='topic+is_impactr'></span><span id='topic+is_impactr_data'></span><span id='topic+is_impactr_peaks'></span>

<h3>Description</h3>

<p>Test if the object is from the impactr package
</p>


<h3>Usage</h3>

<pre><code class='language-R'>is_impactr_data(x)

is_impactr_peaks(x)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="is_impactr_+3A_x">x</code></td>
<td>
<p>An object.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>TRUE</code> if the object inherits the class being evaluated.
</p>

<hr>
<h2 id='mark_nonwear'>Mark accelerometer non-wear time</h2><span id='topic+mark_nonwear'></span>

<h3>Description</h3>

<p>Creates a new column, named <code>wear</code>, in the <code>impactr_data</code> object
provided by <code>data</code> indicating its classification of wear or non-wear
time.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>mark_nonwear(data, nonwear_stage1, nonwear_stage2, window2)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="mark_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="mark_nonwear_+3A_nonwear_stage1">nonwear_stage1</code>, <code id="mark_nonwear_+3A_nonwear_stage2">nonwear_stage2</code></td>
<td>
<p>A numeric vector containing the
binary non-wear classification (0 is wear and 1 is non-wear) of each
algorithm's stage per <code>window2</code> blocks as obtained with the
<code>detect_nonwear()</code> function.</p>
</td></tr>
<tr><td><code id="mark_nonwear_+3A_window2">window2</code></td>
<td>
<p>Window 2 size, in minutes, for the non-wear
detection algorithm. Must be the same value as used by the
<code>detect_nonwear()</code> function.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function, designed to be used inside the wrapper
function <a href="#topic+remove_nonwear">remove_nonwear()</a> that integrates all
steps of detection, removal and inspection of accelerometer non-wear time.
</p>


<h3>Value</h3>

<p>The <code>impactr_data</code> object provided by <code>data</code> with a new
column named <code>wear</code> with the binary wear classification (0 is non-wear and
1 is wear) per sample. Notice that this binary classification is regarding
the wear time NOT non-wear.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_nonwear">detect_nonwear()</a></code>,
<code><a href="#topic+plot_nonwear">plot_nonwear()</a></code>,
<code><a href="#topic+summarise_nonwear">summarise_nonwear()</a></code>,
<code><a href="#topic+delete_nonwear">delete_nonwear()</a></code>
</p>

<hr>
<h2 id='new_impactr_data'>Constructor for impactr_data object</h2><span id='topic+new_impactr_data'></span>

<h3>Description</h3>

<p>Constructor for impactr_data object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_impactr_data(
  x,
  filename,
  start_date_time,
  samp_freq,
  acc_placement,
  subj_body_mass,
  filter_type
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_impactr_data_+3A_x">x</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_filename">filename</code></td>
<td>
<p>A character string containing the file name.</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_start_date_time">start_date_time</code></td>
<td>
<p>A scalar of class <code>POSIXct</code>.</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_samp_freq">samp_freq</code></td>
<td>
<p>A numerical scalar</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_acc_placement">acc_placement</code></td>
<td>
<p>A character scalar</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_subj_body_mass">subj_body_mass</code></td>
<td>
<p>A numerical scalar</p>
</td></tr>
<tr><td><code id="new_impactr_data_+3A_filter_type">filter_type</code></td>
<td>
<p>A character scalar</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the <code>impactr_data</code> class.
</p>

<hr>
<h2 id='new_impactr_peaks'>Constructor for impactr_peaks object</h2><span id='topic+new_impactr_peaks'></span>

<h3>Description</h3>

<p>Constructor for impactr_peaks object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>new_impactr_peaks(
  x,
  filename,
  start_date_time,
  samp_freq,
  acc_placement,
  subj_body_mass,
  filter_type,
  peaks_idx,
  curve_start,
  acc_signal
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="new_impactr_peaks_+3A_x">x</code></td>
<td>
<p>A data frame.</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_filename">filename</code></td>
<td>
<p>A character string containing the file name.</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_start_date_time">start_date_time</code></td>
<td>
<p>A scalar of class <code>POSIXct</code>.</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_samp_freq">samp_freq</code></td>
<td>
<p>A numerical scalar</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_acc_placement">acc_placement</code></td>
<td>
<p>A character scalar</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_subj_body_mass">subj_body_mass</code></td>
<td>
<p>A numerical scalar</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_filter_type">filter_type</code></td>
<td>
<p>A character scalar</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_peaks_idx">peaks_idx</code></td>
<td>
<p>A numerical vector</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_curve_start">curve_start</code></td>
<td>
<p>A numerical vector</p>
</td></tr>
<tr><td><code id="new_impactr_peaks_+3A_acc_signal">acc_signal</code></td>
<td>
<p>A numeric vector</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of the <code>impactr_peaks</code> class.
</p>

<hr>
<h2 id='plot_nonwear'>Plot the non-wear time detection</h2><span id='topic+plot_nonwear'></span>

<h3>Description</h3>

<p>Draws a plot of the resultant acceleration in epochs of <code>window2</code> size
marking the non-wear time detected by each stage of the non-wear detection
algorithm.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plot_nonwear(data, window2, nonwear_stage1, nonwear_stage2, save_plot)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plot_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="plot_nonwear_+3A_window2">window2</code></td>
<td>
<p>Window 2 size, in minutes, for the non-wear
detection algorithm. Must be the same value as used by the
<code>detect_nonwear()</code> function.</p>
</td></tr>
<tr><td><code id="plot_nonwear_+3A_nonwear_stage1">nonwear_stage1</code>, <code id="plot_nonwear_+3A_nonwear_stage2">nonwear_stage2</code></td>
<td>
<p>A numeric vector containing the
binary non-wear classification (0 is wear and 1 is non-wear) of each
algorithm's stage per <code>window2</code> blocks as obtained with the
<a href="#topic+detect_nonwear">detect_nonwear()</a> function.</p>
</td></tr>
<tr><td><code id="plot_nonwear_+3A_save_plot">save_plot</code></td>
<td>
<p>Indicates whether of not to save the plot to visualize the
detected non-wear periods to a pdf file. Provide a valid path to a file
ending with the &quot;.pdf&quot; extension as a character string if you want the
plot to be saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function, designed to be used inside the wrapper
function <a href="#topic+remove_nonwear">remove_nonwear()</a> that integrates all
steps of detection, removal and inspection of accelerometer non-wear time.
</p>


<h3>Value</h3>

<p>If <code>save_plot = FALSE</code> it returns the plot, otherwise it
saves it.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_nonwear">detect_nonwear()</a></code>,
<code><a href="#topic+mark_nonwear">mark_nonwear()</a></code>,
<code><a href="#topic+summarise_nonwear">summarise_nonwear()</a></code>,
<code><a href="#topic+delete_nonwear">delete_nonwear()</a></code>
</p>

<hr>
<h2 id='predict_loading'>Predict mechanical loading</h2><span id='topic+predict_loading'></span>

<h3>Description</h3>

<p>Predict either ground reaction force or loading rate, or both, based on
accelerometer data.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>predict_loading(data, outcome, vector, model)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="predict_loading_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="predict_loading_+3A_outcome">outcome</code></td>
<td>
<p>A character string. Can be either &quot;grf&quot; (for ground reaction
force), or &quot;lr&quot; (for loading rate) or &quot;all&quot; (for both mechanical loading
variables).</p>
</td></tr>
<tr><td><code id="predict_loading_+3A_vector">vector</code></td>
<td>
<p>A character string indicating in which acceleration vector to
find the peaks. Can be &quot;resultant&quot;, &quot;vertical&quot; or &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="predict_loading_+3A_model">model</code></td>
<td>
<p>A character string indicating which model to use to make
the predictions. The values currently supported are &quot;walking&quot;,
&quot;walking/running&quot; and &quot;jumping&quot;.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_peaks</code> with the ground reaction
force and/or loading rate peaks magnitude stored in the columns.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
data &lt;- specify_parameters(data, acc_placement = "hip", subj_body_mass = 78)
data &lt;- find_peaks(data, vector = "vertical")
predict_loading(
  data,
  outcome = "grf",
  vector = "vertical",
  model = "walking/running"
)
</code></pre>

<hr>
<h2 id='read_acc'>Read raw accelerometer data</h2><span id='topic+read_acc'></span>

<h3>Description</h3>

<p>Reads raw accelerometer data files into an <code>impactr_data</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>read_acc(file)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="read_acc_+3A_file">file</code></td>
<td>
<p>Path to a raw accelerometer data file.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code>.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>read_acc(impactr_example("hip-raw.csv"))
</code></pre>

<hr>
<h2 id='remove_nonwear'>Detect and remove accelerometer non-wear time</h2><span id='topic+remove_nonwear'></span>

<h3>Description</h3>

<p>Detects the accelerometer non-wear time based on an algorithm developed
by van Hees (see Details) and remove these periods from the raw data. This
function can also draw a plot to better visualize the detected non-wear
periods and generate a wear time daily summary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>remove_nonwear(
  data,
  window1 = 60,
  window2 = 15,
  threshold = 2,
  min_hour_crit = 0,
  min_day_crit = 0,
  plot = FALSE,
  save_plot = FALSE,
  save_summary = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="remove_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_window1">window1</code>, <code id="remove_nonwear_+3A_window2">window2</code></td>
<td>
<p>Windows size, in minutes, for the non-wear
detection algorithm. Defaults to 60 and 15 minutes, respectively.
Also, <code>window2</code> must be smaller than <code>window1</code>, and
<code>window1</code> must be a multiple of <code>window2</code>.</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_threshold">threshold</code></td>
<td>
<p>Number of axes that need to meet the non-wear criteria.
Defaults to 2.</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_min_hour_crit">min_hour_crit</code></td>
<td>
<p>The minimum number of hours marked as wear time
in a day for it to be considered valid (see Data validation).
Defaults to 0, meaning that every day is considered valid.</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_min_day_crit">min_day_crit</code></td>
<td>
<p>The minimum number of valid days for the data of
a given subject to be considered valid (see Data validation).
Defaults to 0, meaning that all data is valid.</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_plot">plot</code></td>
<td>
<p>A logical value indicating whether or not to display the
plot to visualize the detected non-wear periods. Defaults to <code>FALSE</code>.
Notice that the plot will only be displayed in your R session if you do
not provide a path to save the plot (see the argument <code>save_plot</code>).</p>
</td></tr>
<tr><td><code id="remove_nonwear_+3A_save_plot">save_plot</code>, <code id="remove_nonwear_+3A_save_summary">save_summary</code></td>
<td>
<p>Indicates whether of not to save the plot to
visualize the detected non-wear periods to a pdf file and the wear time
daily summary to a csv file, respectively. Defaults to <code>FALSE</code>.
Provide a valid path to a file, ending with the &quot;.pdf&quot; extension for the
plot or with the &quot;.csv&quot; extension to the summary, as a character string
if you want the outputs to be saved.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code> and a plot if
<code>plot = TRUE</code> and <code>save_plot = FALSE</code>.
</p>


<h3>The non-wear detection algorithm</h3>

<p>The current version of this algorithm is described in a paper by van Hees
et al (see References) and also in this
<a href="https://CRAN.R-project.org/package=GGIR/vignettes/GGIR.html#53_Non-wear_detection">vignette</a> from package GGIR.
Briefly, in a first stage it identifies non-wear time based on threshold
values of standard deviation (0.013<em>g</em>) and range (0.050<em>g</em>) of
raw acceleration from each axis. The classification is done per blocks of
<code>window2</code> size (default 15 minutes) based on the characteristics of
a larger <code>window1</code> (default 60 minutes) centred at the
<code>window2</code>. In the second stage of the algorithm, the plausibility of
wear periods in between non-wear periods is tested based on the duration
and proportion of the duration relative to the surrounding non-wear
periods.
</p>


<h3>Data validation</h3>

<p>After the detection of non-wear periods through the algorithm, a data
validation step is applied. For each measurement day to be considered
valid, it has to present a minimum number of wear time hours determined
by the <code>min_hour_crit</code> argument. If the number of wear time hours of
a given day falls below the threshold, the whole day is considered invalid
and is then removed from the subsequent analyses. The whole measurement
is also classified as valid or invalid based on the number of valid days
and a threshold given by <code>min_day_crit</code>. If the number of valid days
is less than the value determined by the <code>min_day_crit</code> argument,
the whole data is deleted and the <code>remove_nonwear()</code> function
signals an error, stopping its execution. Nevertheless, this error does
not prevent the plot to be displayed or saved, or the wear time daily
summary to be saved, if the arguments are set to do so.
</p>


<h3>References</h3>


<ul>
<li><p> van Hees VT, Gorzelniak L, Dean León EC, Eder M, Pias M, Taherian S,
Ekelund U, Renström F, Franks PW, Horsch A, Brage S. Separating movement
and gravity components in an acceleration signal and implications for the
assessment of human daily physical activity. PLoS One. 2013. Apr 23.
<a href="https://doi.org/10.1371/journal.pone.0061691">doi:10.1371/journal.pone.0061691</a>.
</p>
</li></ul>



<h3>Examples</h3>

<pre><code class='language-R'>
# Ensure that {accdata} package is available before running the example.
# If it is not, run install_accdata() to install the required package.
if (requireNamespace("accdata", quietly = TRUE)) {
  data &lt;- import_dataset("daily_acc_3d")
  remove_nonwear(data)
}

</code></pre>

<hr>
<h2 id='specify_parameters'>Specify prediction model parameters</h2><span id='topic+specify_parameters'></span>

<h3>Description</h3>

<p>Specify the accelerometer placement used and the subject body mass. These
data is needed in order to use the mechanical loading prediction models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>specify_parameters(data, acc_placement, subj_body_mass)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="specify_parameters_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with
<a href="#topic+read_acc">read_acc()</a>.</p>
</td></tr>
<tr><td><code id="specify_parameters_+3A_acc_placement">acc_placement</code></td>
<td>
<p>A character string indicating the accelerometer
placement. Can be either &quot;ankle&quot;, &quot;back&quot;, or &quot;hip&quot;.</p>
</td></tr>
<tr><td><code id="specify_parameters_+3A_subj_body_mass">subj_body_mass</code></td>
<td>
<p>A double scalar indicating the subject body mass
in kilograms.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code> with the specified parameters
as attributes.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
specify_parameters(data, acc_placement = "hip", subj_body_mass = 79.2)
</code></pre>

<hr>
<h2 id='summarise_loading'>Summarise mechanical loading variables</h2><span id='topic+summarise_loading'></span>

<h3>Description</h3>

<p>Creates a summary table of the selected mechanical loading variables
including the number of peaks, the minimum, maximum, mean and standard
deviation values of these peaks and also the number of peaks inside a
given magnitude range. The summaries can be displayed by day or as a
daily average.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_loading(
  data,
  variable,
  vector,
  daily_average = TRUE,
  ranges_acc = NULL,
  ranges_grf = NULL,
  ranges_lr = NULL,
  save_summary = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise_loading_+3A_data">data</code></td>
<td>
<p>An <code>impactr_peaks</code> object, as obtained with
<a href="#topic+find_peaks">find_peaks()</a> and/or
<a href="#topic+predict_loading">predict_loading()</a>.</p>
</td></tr>
<tr><td><code id="summarise_loading_+3A_variable">variable</code></td>
<td>
<p>A character vector indicating the variable to summarise.
Can be either &quot;acc&quot; (for the acceleration peaks), &quot;grf&quot; (for the ground
reaction force peaks), &quot;lr&quot; (for the loading rate peaks) or &quot;all&quot; (for
all variables).</p>
</td></tr>
<tr><td><code id="summarise_loading_+3A_vector">vector</code></td>
<td>
<p>A character string indicating which vector to use to create
the summaries. Can be &quot;resultant&quot;, &quot;vertical&quot; or &quot;all&quot;.</p>
</td></tr>
<tr><td><code id="summarise_loading_+3A_daily_average">daily_average</code></td>
<td>
<p>Create a daily average summary? Can be <code>TRUE</code>
(default) or <code>FALSE</code>.</p>
</td></tr>
<tr><td><code id="summarise_loading_+3A_ranges_acc">ranges_acc</code>, <code id="summarise_loading_+3A_ranges_grf">ranges_grf</code>, <code id="summarise_loading_+3A_ranges_lr">ranges_lr</code></td>
<td>
<p>A numeric vector to specify ranges in
which to count the peaks. <em>E.g.</em>, If <code>ranges_acc = c(1, 2, 3)</code>,
it will summarise the number of acceleration peaks from 1 to 2<em>g</em>,
from 2 to 3<em>g</em> and above 3<em>g</em>. Set to <code>NULL</code> (default) if
no summary by range will be provided.</p>
</td></tr>
<tr><td><code id="summarise_loading_+3A_save_summary">save_summary</code></td>
<td>
<p>Indicates whether or not to save the summary to a csv
file(s). Defaults to <code>FALSE</code>. Provide a valid path to a directory
as a character string to save all generated summaries.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A tibble (or a list of tibbles) with the requested summaries.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
# Ensure that {accdata} package is available before running the example.
# If it is not, run install_accdata() to install the required package.
if (requireNamespace("accdata", quietly = TRUE)) {
  data &lt;- import_dataset("daily_acc_3d")
  data &lt;- remove_nonwear(data)
  data &lt;- filter_acc(data)
  data &lt;- find_peaks(data, vector = "vertical")
  summarise_loading(
    data,
    variable = "acc", vector = "vertical",
    ranges_acc = 1:5
  )
}

</code></pre>

<hr>
<h2 id='summarise_nonwear'>Summarise accelerometer non-wear time</h2><span id='topic+summarise_nonwear'></span>

<h3>Description</h3>

<p>Validates each measurement day based on the minimum number of wear hours
and validates the entire observation based on the minimum number of valid
days. It updates the values of the <code>wear</code> column (created by
<a href="#topic+mark_nonwear">mark_nonwear()</a>) of the <code>impactr_data</code> object
provided by <code>data</code>, marking as non-wear time the days considered to
be invalid. It also creates a wear time daily summary that can be saved in
a csv file.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>summarise_nonwear(data, min_hour_crit, min_day_crit, save_summary)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="summarise_nonwear_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object with the <code>wear</code> column, as
obtained with <a href="#topic+mark_nonwear">mark_nonwear()</a>.</p>
</td></tr>
<tr><td><code id="summarise_nonwear_+3A_min_hour_crit">min_hour_crit</code></td>
<td>
<p>The minimum number of hours marked as wear time
in a day for it to be considered valid.</p>
</td></tr>
<tr><td><code id="summarise_nonwear_+3A_min_day_crit">min_day_crit</code></td>
<td>
<p>The minimum number of valid days for the data of
a given subject to be considered valid.</p>
</td></tr>
<tr><td><code id="summarise_nonwear_+3A_save_summary">save_summary</code></td>
<td>
<p>Indicates whether of not to save the wear time
daily summary to a csv file. Provide a valid path to a file ending
with the &quot;.csv&quot; extension as a character string if you want the
summary to be saved.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>This is an internal function, designed to be used inside the wrapper
function <a href="#topic+remove_nonwear">remove_nonwear()</a> that integrates all
steps of detection, removal and inspection of accelerometer non-wear time.
</p>


<h3>Value</h3>

<p>The <code>impactr_data</code> object provided by <code>data</code> with the
<code>wear</code> column values updated based on the validations. If no data are
classified as valid, it returns <code>NULL</code>. Also saves the summary
in a csv file if <code>save_summary</code> is a path.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+detect_nonwear">detect_nonwear()</a></code>,
<code><a href="#topic+plot_nonwear">plot_nonwear()</a></code>,
<code><a href="#topic+mark_nonwear">mark_nonwear()</a></code>,
<code><a href="#topic+delete_nonwear">delete_nonwear()</a></code>
</p>

<hr>
<h2 id='use_resultant'>Use resultant vector</h2><span id='topic+use_resultant'></span>

<h3>Description</h3>

<p>Computes the acceleration resultant vector.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>use_resultant(data)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="use_resultant_+3A_data">data</code></td>
<td>
<p>An <code>impactr_data</code> object, as obtained with</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class <code>impactr_data</code> with the <code>acc_R</code> column
containing the acceleration resultant vector.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data &lt;- read_acc(impactr_example("hip-raw.csv"))
use_resultant(data)
</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
