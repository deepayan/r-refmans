<!DOCTYPE html><html lang="en"><head><title>Help for package plasso</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {plasso}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#add_intercept'><p>Adds an intercept to a matrix</p></a></li>
<li><a href='#coef.cv.plasso'><p>Extract coefficients from a <code>cv.plasso</code> object</p></a></li>
<li><a href='#coef.plasso'><p>Extract coefficients from a <code>plasso</code> object</p></a></li>
<li><a href='#CV_core'><p>Core part for (Post-) Lasso cross-validation</p></a></li>
<li><a href='#cv.plasso'><p>Cross-Validated Lasso and Post-Lasso</p></a></li>
<li><a href='#find_Xse_ind'><p>Helper function to find the position for prespecified SE rules</p></a></li>
<li><a href='#fit_betas'><p>plasso fitting</p></a></li>
<li><a href='#fitted_values_cv'><p>Fitted values for a subset of active variables</p></a></li>
<li><a href='#handle_weights'><p>Sanitizes potential sample weights</p></a></li>
<li><a href='#norm_w_to_n'><p>Normalization of sample weights for potential sample weights</p></a></li>
<li><a href='#plasso'><p>Lasso and Post-Lasso</p></a></li>
<li><a href='#plot.cv.plasso'><p>Plot of cross-validation curves</p></a></li>
<li><a href='#plot.plasso'><p>Plot coefficient paths</p></a></li>
<li><a href='#predict.cv.plasso'><p>Predict after cross-validated (Post-) Lasso</p></a></li>
<li><a href='#predict.plasso'><p>Predict for (Post-) Lasso models</p></a></li>
<li><a href='#print.cv.plasso'><p>Print cross-validated (Post-) Lasso model</p></a></li>
<li><a href='#print.plasso'><p>Print (Post-) Lasso model</p></a></li>
<li><a href='#print.summary.cv.plasso'><p>Print summary of (Post-) Lasso model</p></a></li>
<li><a href='#summary.cv.plasso'><p>Summary of cross-validated (Post-) Lasso model</p></a></li>
<li><a href='#summary.plasso'><p>Summary of (Post-) Lasso model</p></a></li>
<li><a href='#toeplitz'><p>Simulated 'Toeplitz' Data</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Cross-Validated (Post-) Lasso</td>
</tr>
<tr>
<td>Version:</td>
<td>0.1.2</td>
</tr>
<tr>
<td>Description:</td>
<td>Built on top of the 'glmnet' library by Friedman, Hastie and Tibshirani (2010) &lt;<a href="https://doi.org/10.18637%2Fjss.v033.i01">doi:10.18637/jss.v033.i01</a>&gt;, the 'plasso' package follows Knaus (2022) &lt;<a href="https://doi.org/10.1093%2Fectj%2Futac015">doi:10.1093/ectj/utac015</a>&gt; and comes up with two functions that estimate least squares Lasso and Post-Lasso models.
  The plasso() function adds coefficient paths for a Post-Lasso model to the standard 'glmnet' output.
  On top of that cv.plasso() cross-validates the coefficient paths for both the Lasso and Post-Lasso model and provides optimal hyperparameter values for the penalty term lambda.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/stefan-1997/plasso">https://github.com/stefan-1997/plasso</a></td>
</tr>
<tr>
<td>BugReports:</td>
<td><a href="https://github.com/stefan-1997/plasso/issues">https://github.com/stefan-1997/plasso/issues</a></td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>Imports:</td>
<td>glmnet, Matrix, methods, parallel, doParallel, foreach,
iterators</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.3</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0), knitr, rmarkdown, xfun</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2023-12-03 14:51:20 UTC; stefan</td>
</tr>
<tr>
<td>Author:</td>
<td>Glaisner Stefan [aut, cre],
  Knaus Michael C. <a href="https://orcid.org/0000-0002-7328-1363"><img alt="ORCID iD"  src="https://cloud.R-project.org/web/orcid.svg" style="width:16px; height:16px; margin-left:4px; margin-right:4px; vertical-align:middle" /></a>
    [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Glaisner Stefan &lt;stefan.glaisner@student.uni-tuebingen.de&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2023-12-03 15:10:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='add_intercept'>Adds an intercept to a matrix</h2><span id='topic+add_intercept'></span>

<h3>Description</h3>

<p><code><a href="#topic+add_intercept">add_intercept</a></code> adds an intercept to a matrix.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>add_intercept(mat)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="add_intercept_+3A_mat">mat</code></td>
<td>
<p>Any matrix (with column names).</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Matrix with intercept.
</p>

<hr>
<h2 id='coef.cv.plasso'>Extract coefficients from a <code><a href="#topic+cv.plasso">cv.plasso</a></code> object</h2><span id='topic+coef.cv.plasso'></span>

<h3>Description</h3>

<p>Extract coefficients for both Lasso and Post-Lasso from a <code><a href="#topic+cv.plasso">cv.plasso</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.plasso'
coef(object, ..., s = c("optimal", "all"), se_rule = 0)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.cv.plasso_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+cv.plasso">cv.plasso</a></code> object</p>
</td></tr>
<tr><td><code id="coef.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="stats.html#topic+coef">coef</a></code> options</p>
</td></tr>
<tr><td><code id="coef.cv.plasso_+3A_s">s</code></td>
<td>
<p>Determines whether coefficients are extracted for all values of lambda (&quot;all&quot;) or only for the optimal lambda (&quot;optimal&quot;) according to the specified standard error-rule.</p>
</td></tr>
<tr><td><code id="coef.cv.plasso_+3A_se_rule">se_rule</code></td>
<td>
<p>If equal to 0, predictions from cross-validated MSE minimum (default). Negative values go in the direction of smaller
models, positive values go in the direction of larger models (e.g. <code>se_rule=-1</code> creates the standard 1SE rule).
This argument is not used for <code>s="all"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing coefficients for both the Lasso and Post-Lasso
models respectively.
</p>
<table role = "presentation">
<tr><td><code>lasso</code></td>
<td>
<p>Sparse <code><a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix</a></code> with Lasso coefficients</p>
</td></tr>
<tr><td><code>plasso</code></td>
<td>
<p>Sparse <code><a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix</a></code> with Post-Lasso coefficients</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)
# get estimated coefficients along whole lambda sequence
coefs = coef(p.cv, s="all")
head(coefs$plasso)
# get estimated coefficients for optimal lambda value according to 1-standard-error rule
coef(p.cv, s="optimal", se_rule=-1)

</code></pre>

<hr>
<h2 id='coef.plasso'>Extract coefficients from a <code><a href="#topic+plasso">plasso</a></code> object</h2><span id='topic+coef.plasso'></span>

<h3>Description</h3>

<p>Extract coefficients for both Lasso and Post-Lasso from a <code><a href="#topic+plasso">plasso</a></code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plasso'
coef(object, ..., s = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="coef.plasso_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+plasso">plasso</a></code> object</p>
</td></tr>
<tr><td><code id="coef.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="stats.html#topic+coef">coef</a></code> options</p>
</td></tr>
<tr><td><code id="coef.plasso_+3A_s">s</code></td>
<td>
<p>If Null, coefficients are returned for all lambda values. If a value is provided, the closest lambda value of the <code><a href="#topic+plasso">plasso</a></code> object is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing coefficients that are associated with either
all values along the lambda input sequence or for one specifically given
lambda value for both the Lasso and Post-Lasso models respectively.
</p>
<table role = "presentation">
<tr><td><code>lasso</code></td>
<td>
<p>Sparse <code><a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix-class</a></code> object with Lasso coefficients</p>
</td></tr>
<tr><td><code>plasso</code></td>
<td>
<p>Sparse <code><a href="Matrix.html#topic+dgCMatrix-class">dgCMatrix-class</a></code> object with Post-Lasso coefficients</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit plasso to the data
p = plasso::plasso(X,y)
# get estimated coefficients along whole lambda sequence 
coefs = coef(p)
head(coefs$plasso)
# get estimated coefficients for specific lambda approximation
coef(p, s=0.05)

</code></pre>

<hr>
<h2 id='CV_core'>Core part for (Post-) Lasso cross-validation</h2><span id='topic+CV_core'></span>

<h3>Description</h3>

<p><code><a href="#topic+CV_core">CV_core</a></code> contains the core parts of the cross-validation for Lasso and Post-Lasso.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>CV_core(x, y, w, cvgroup, list, i, lambda, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="CV_core_+3A_x">x</code></td>
<td>
<p>Covariate matrix to be used in cross-validation</p>
</td></tr>
<tr><td><code id="CV_core_+3A_y">y</code></td>
<td>
<p>Vector of outcomes</p>
</td></tr>
<tr><td><code id="CV_core_+3A_w">w</code></td>
<td>
<p>Vector of weight</p>
</td></tr>
<tr><td><code id="CV_core_+3A_cvgroup">cvgroup</code></td>
<td>
<p>Categorical with k groups to identify folds</p>
</td></tr>
<tr><td><code id="CV_core_+3A_list">list</code></td>
<td>
<p>List 1:k</p>
</td></tr>
<tr><td><code id="CV_core_+3A_i">i</code></td>
<td>
<p>Number of fold that is used for prediction</p>
</td></tr>
<tr><td><code id="CV_core_+3A_lambda">lambda</code></td>
<td>
<p>Series of lambdas used</p>
</td></tr>
<tr><td><code id="CV_core_+3A_...">...</code></td>
<td>
<p>Pass <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>MSE_lasso / MSE_plasso: means squared errors for each lambda.
</p>

<hr>
<h2 id='cv.plasso'>Cross-Validated Lasso and Post-Lasso</h2><span id='topic+cv.plasso'></span>

<h3>Description</h3>

<p><code><a href="#topic+cv.plasso">cv.plasso</a></code> uses the <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> package to estimate the coefficient paths and cross-validates least squares Lasso AND Post-Lasso.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cv.plasso(x, y, w = NULL, kf = 10, parallel = FALSE, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="cv.plasso_+3A_x">x</code></td>
<td>
<p>Matrix of covariates (number of observations times number of covariates matrix)</p>
</td></tr>
<tr><td><code id="cv.plasso_+3A_y">y</code></td>
<td>
<p>Vector of outcomes</p>
</td></tr>
<tr><td><code id="cv.plasso_+3A_w">w</code></td>
<td>
<p>Vector of weights</p>
</td></tr>
<tr><td><code id="cv.plasso_+3A_kf">kf</code></td>
<td>
<p>Number of folds in k-fold cross-validation</p>
</td></tr>
<tr><td><code id="cv.plasso_+3A_parallel">parallel</code></td>
<td>
<p>Set as TRUE for parallelized cross-validation. Default is FALSE.</p>
</td></tr>
<tr><td><code id="cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>cv.plasso object (using a list structure) including the base <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> object and cross-validation results (incl. optimal Lambda values) for both Lasso and Post-Lasso model.
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the call that produced this</p>
</td></tr>
<tr><td><code>lasso_full</code></td>
<td>
<p>base <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> object</p>
</td></tr>
<tr><td><code>kf</code></td>
<td>
<p>number of folds in k-fold cross-validation</p>
</td></tr>
<tr><td><code>cv_MSE_lasso</code></td>
<td>
<p>cross-validated MSEs of Lasso model (for every iteration of k-fold cross-validation)</p>
</td></tr>
<tr><td><code>cv_MSE_plasso</code></td>
<td>
<p>cross-validated MSEs of Post-Lasso model (for every iteration of k-fold cross-validation)</p>
</td></tr>
<tr><td><code>mean_MSE_lasso</code></td>
<td>
<p>averaged cross-validated MSEs of Lasso model</p>
</td></tr>
<tr><td><code>mean_MSE_plasso</code></td>
<td>
<p>averaged cross-validated MSEs of Post-Lasso model</p>
</td></tr>
<tr><td><code>ind_min_l</code></td>
<td>
<p>index of MSE optimal lambda value for Lasso model</p>
</td></tr>
<tr><td><code>ind_min_pl</code></td>
<td>
<p>index of MSE optimal lambda value for Post-Lasso model</p>
</td></tr>
<tr><td><code>lambda_min_l</code></td>
<td>
<p>MSE optimal lambda value for Lasso model</p>
</td></tr>
<tr><td><code>lambda_min_pl</code></td>
<td>
<p>MSE optimal lambda value for Post-Lasso model</p>
</td></tr>
<tr><td><code>names_l</code></td>
<td>
<p>Names of active variables for MSE optimal Lasso model</p>
</td></tr>
<tr><td><code>names_pl</code></td>
<td>
<p>Names of active variables for MSE optimal Post-Lasso model</p>
</td></tr>
<tr><td><code>coef_min_l</code></td>
<td>
<p>Coefficients for MSE optimal Lasso model</p>
</td></tr>
<tr><td><code>coef_min_pl</code></td>
<td>
<p>Coefficients for MSE optimal Post-Lasso model</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Input matrix of covariates</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Matrix of outcomes</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Matrix of weights</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)
# get basic summary statistics
print(summary(p.cv, default=FALSE))
# plot cross-validated MSE curves and number of active coefficients
plot(p.cv, legend_pos="bottomleft")
# get coefficients at MSE optimal lambda value for both Lasso and Post-Lasso model
coef(p.cv)
# get coefficients at MSE optimal lambda value according to 1-standard-error rule
coef(p.cv, se_rule=-1)
# predict fitted values along whole lambda sequence 
pred = predict(p.cv, s="all")
head(pred$plasso)

</code></pre>

<hr>
<h2 id='find_Xse_ind'>Helper function to find the position for prespecified SE rules</h2><span id='topic+find_Xse_ind'></span>

<h3>Description</h3>

<p><code><a href="#topic+find_Xse_ind">find_Xse_ind</a></code> is a helper function that finds the position for prespecified SE rules.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>find_Xse_ind(CV, ind_min, oneSE, factor)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="find_Xse_ind_+3A_cv">CV</code></td>
<td>
<p>Vector of cross-validated criterion</p>
</td></tr>
<tr><td><code id="find_Xse_ind_+3A_ind_min">ind_min</code></td>
<td>
<p>Index of cross-validated minimum</p>
</td></tr>
<tr><td><code id="find_Xse_ind_+3A_onese">oneSE</code></td>
<td>
<p>Vector that contains the standard errors of the cross-validated criterion for the whole grid</p>
</td></tr>
<tr><td><code id="find_Xse_ind_+3A_factor">factor</code></td>
<td>
<p>Factor in which direction to go: Negative values favor smaller models, positive values favor larger models</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Index on the Lambda grid.
</p>

<hr>
<h2 id='fit_betas'>plasso fitting</h2><span id='topic+fit_betas'></span>

<h3>Description</h3>

<p><code><a href="#topic+fit_betas">fit_betas</a></code> estimates OLS model only for active coefficients (from lasso)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fit_betas(x, y, w, nm_act, coef_lasso)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fit_betas_+3A_x">x</code></td>
<td>
<p>Matrix of covariates (number of observations times number of covariates matrix)</p>
</td></tr>
<tr><td><code id="fit_betas_+3A_y">y</code></td>
<td>
<p>Vector of outcomes</p>
</td></tr>
<tr><td><code id="fit_betas_+3A_w">w</code></td>
<td>
<p>Vector of weights</p>
</td></tr>
<tr><td><code id="fit_betas_+3A_nm_act">nm_act</code></td>
<td>
<p>Vector of active variables</p>
</td></tr>
<tr><td><code id="fit_betas_+3A_coef_lasso">coef_lasso</code></td>
<td>
<p>Vector of lasso coefficients</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Beta estimates.
</p>

<hr>
<h2 id='fitted_values_cv'>Fitted values for a subset of active variables</h2><span id='topic+fitted_values_cv'></span>

<h3>Description</h3>

<p><code><a href="#topic+fitted_values_cv">fitted_values_cv</a></code> extracts the active set from <code class="reqn">X^TX</code> and
<code class="reqn">X^Ty</code> to get out-of-sample predictions
for a matrix already containing only the active variables.
The function is only relevant for cases where at least one variable is selected.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>fitted_values_cv(XtX_all, Xty_all, x_pred, nm_act)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="fitted_values_cv_+3A_xtx_all">XtX_all</code></td>
<td>
<p>Cross product of all covariates</p>
</td></tr>
<tr><td><code id="fitted_values_cv_+3A_xty_all">Xty_all</code></td>
<td>
<p>Cross product of covariates and outcome</p>
</td></tr>
<tr><td><code id="fitted_values_cv_+3A_x_pred">x_pred</code></td>
<td>
<p>Covariates matrix of the prediction sample</p>
</td></tr>
<tr><td><code id="fitted_values_cv_+3A_nm_act">nm_act</code></td>
<td>
<p>Names of active variables</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Fitted values in the prediction sample.
</p>

<hr>
<h2 id='handle_weights'>Sanitizes potential sample weights</h2><span id='topic+handle_weights'></span>

<h3>Description</h3>

<p><code><a href="#topic+handle_weights">handle_weights</a></code> cleans potential sample weights or codes them as ones if they are not specified.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>handle_weights(w, n)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="handle_weights_+3A_w">w</code></td>
<td>
<p>Vector or n x 1 matrix of weights or null if no weights provided</p>
</td></tr>
<tr><td><code id="handle_weights_+3A_n">n</code></td>
<td>
<p>Number of observations</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Vector of weights.
</p>

<hr>
<h2 id='norm_w_to_n'>Normalization of sample weights for potential sample weights</h2><span id='topic+norm_w_to_n'></span>

<h3>Description</h3>

<p><code><a href="#topic+norm_w_to_n">norm_w_to_n</a></code> normalizes weights either to N or to N in treated and controls separately.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>norm_w_to_n(w, d = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="norm_w_to_n_+3A_w">w</code></td>
<td>
<p>Vector or n x 1 matrix of weights that should be normalized</p>
</td></tr>
<tr><td><code id="norm_w_to_n_+3A_d">d</code></td>
<td>
<p>Vector of treatment indicators</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Normalized weights.
</p>

<hr>
<h2 id='plasso'>Lasso and Post-Lasso</h2><span id='topic+plasso'></span>

<h3>Description</h3>

<p><code><a href="#topic+plasso">plasso</a></code> implicitly estimates a Lasso model using the <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> package
and additionally estimates coefficient paths for a subsequent Post-Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plasso(x, y, w = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plasso_+3A_x">x</code></td>
<td>
<p>Matrix of covariates (number of observations times number of covariates matrix)</p>
</td></tr>
<tr><td><code id="plasso_+3A_y">y</code></td>
<td>
<p>Vector of outcomes</p>
</td></tr>
<tr><td><code id="plasso_+3A_w">w</code></td>
<td>
<p>Vector of weights</p>
</td></tr>
<tr><td><code id="plasso_+3A_...">...</code></td>
<td>
<p>Pass <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List including base <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> (i.e. Lasso) object and Post-Lasso coefficients.
</p>
<table role = "presentation">
<tr><td><code>call</code></td>
<td>
<p>the call that produced this</p>
</td></tr>
<tr><td><code>lasso_full</code></td>
<td>
<p>base <code><a href="glmnet.html#topic+glmnet">glmnet</a></code> object</p>
</td></tr>
<tr><td><code>beta_plasso</code></td>
<td>
<p>matrix of coefficients for Post-Lasso model stored in sparse column format</p>
</td></tr>
<tr><td><code>x</code></td>
<td>
<p>Input matrix of covariates</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>Matrix of outcomes</p>
</td></tr>
<tr><td><code>w</code></td>
<td>
<p>Matrix of weights</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit plasso to the data
p = plasso::plasso(X,y)
# plot coefficient paths for Post-Lasso model
plot(p, lasso=FALSE, xvar="lambda")
# plot coefficient paths for Lasso model
plot(p, lasso=TRUE, xvar="lambda")
# get coefficients for specific lambda approximation
coef(p, s=0.05)
# predict fitted values along whole lambda sequence 
pred = predict(p)
head(pred$plasso)

</code></pre>

<hr>
<h2 id='plot.cv.plasso'>Plot of cross-validation curves</h2><span id='topic+plot.cv.plasso'></span>

<h3>Description</h3>

<p>Plot of cross-validation curves.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.plasso'
plot(
  x,
  ...,
  legend_pos = c("bottomright", "bottom", "bottomleft", "left", "topleft", "top",
    "topright", "right", "center"),
  legend_size = 0.5,
  lasso = FALSE
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.cv.plasso_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+cv.plasso">cv.plasso</a></code> object</p>
</td></tr>
<tr><td><code id="plot.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+plot">plot</a></code> options</p>
</td></tr>
<tr><td><code id="plot.cv.plasso_+3A_legend_pos">legend_pos</code></td>
<td>
<p>Legend position. Only considered for joint plot (lass=FALSE).</p>
</td></tr>
<tr><td><code id="plot.cv.plasso_+3A_legend_size">legend_size</code></td>
<td>
<p>Font size of legend</p>
</td></tr>
<tr><td><code id="plot.cv.plasso_+3A_lasso">lasso</code></td>
<td>
<p>If set as True, only the cross-validation curve for the Lasso model is plotted. Default is False.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Plots the cross-validation curves for both Lasso and Post-Lasso models (incl. upper and lower standard deviation curves)
for a fitted <code><a href="#topic+cv.plasso">cv.plasso</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)
# plot cross-validated MSE curves and number of active coefficients
plot(p.cv, legend_pos="bottomleft")

</code></pre>

<hr>
<h2 id='plot.plasso'>Plot coefficient paths</h2><span id='topic+plot.plasso'></span>

<h3>Description</h3>

<p>Plot coefficient paths of (Post-) Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plasso'
plot(x, ..., lasso = FALSE, xvar = c("norm", "lambda", "dev"), label = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.plasso_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+plasso">plasso</a></code> object</p>
</td></tr>
<tr><td><code id="plot.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+plot">plot</a></code> options</p>
</td></tr>
<tr><td><code id="plot.plasso_+3A_lasso">lasso</code></td>
<td>
<p>If set as True, coefficient paths for Lasso instead of Post-Lasso is plotted. Default is False.</p>
</td></tr>
<tr><td><code id="plot.plasso_+3A_xvar">xvar</code></td>
<td>
<p>X-axis variable:
<code>norm</code> plots against the L1-norm of the coefficients,
<code>lambda</code> against the log-lambda sequence,
and <code>dev</code> against the percent deviance explained.</p>
</td></tr>
<tr><td><code id="plot.plasso_+3A_label">label</code></td>
<td>
<p>If TRUE, label the curves with variable sequence numbers</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Produces a coefficient profile plot of the coefficient paths for a fitted <code><a href="#topic+plasso">plasso</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit plasso to the data
p = plasso::plasso(X,y)
# plot coefficient paths for Post-Lasso model
plot(p, lasso=FALSE, xvar="lambda")
# plot coefficient paths for Lasso model
plot(p, lasso=TRUE, xvar="lambda")

</code></pre>

<hr>
<h2 id='predict.cv.plasso'>Predict after cross-validated (Post-) Lasso</h2><span id='topic+predict.cv.plasso'></span>

<h3>Description</h3>

<p>Prediction for cross-validated (Post-) Lasso.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.plasso'
predict(
  object,
  ...,
  newx = NULL,
  type = c("response", "coefficients"),
  s = c("optimal", "all"),
  se_rule = 0
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.cv.plasso_+3A_object">object</code></td>
<td>
<p>Fitted <code><a href="#topic+cv.plasso">cv.plasso</a></code> model object</p>
</td></tr>
<tr><td><code id="predict.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="stats.html#topic+predict">predict</a></code> options</p>
</td></tr>
<tr><td><code id="predict.cv.plasso_+3A_newx">newx</code></td>
<td>
<p>Matrix of new values for x at which predictions are to be made. If no value is supplied, x from fitting procedure is used. This argument is not used for <code>type="coefficients"</code>.</p>
</td></tr>
<tr><td><code id="predict.cv.plasso_+3A_type">type</code></td>
<td>
<p>Type of prediction required. <code>"response"</code> returns fitted values, <code>"coefficients"</code> returns beta estimates.</p>
</td></tr>
<tr><td><code id="predict.cv.plasso_+3A_s">s</code></td>
<td>
<p>Determines whether prediction is done for all values of lambda (<code>"all"</code>) or only for the optimal lambda (<code>"optimal"</code>) according to the standard error-rule.</p>
</td></tr>
<tr><td><code id="predict.cv.plasso_+3A_se_rule">se_rule</code></td>
<td>
<p>If equal to 0, predictions from cross-validated MSE minimum (default). Negative values go in the direction of smaller
models, positive values go in the direction of larger models (e.g. <code>se_rule=-1</code> creates the standard 1SE rule).
This argument is not used for <code>s="all"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing either fitted values or coefficients for both
the Lasso and Post-Lasso models respectively.
</p>
<table role = "presentation">
<tr><td><code>lasso</code></td>
<td>
<p>Matrix with Lasso predictions or coefficients</p>
</td></tr>
<tr><td><code>plasso</code></td>
<td>
<p>Matrix with Post-Lasso predictions or coefficients</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)
# predict fitted values along whole lambda sequence 
pred = predict(p.cv, s="all")
head(pred$plasso)
# predict fitted values for optimal lambda value (according to cross-validation) 
pred_optimal = predict(p.cv, s="optimal")
head(pred_optimal$plasso)
# predict fitted values for new feature set X
X_new = head(X, 10)
pred_new = predict(p.cv, newx=X_new, s="optimal")
pred_new$plasso
# get estimated coefficients along whole lambda sequence
coefs = predict(p.cv, type="coefficients", s="all")
head(coefs$plasso)
# get estimated coefficients for optimal lambda value according to 1-standard-error rule
predict(p.cv, type="coefficients", s="optimal", se_rule=-1)

</code></pre>

<hr>
<h2 id='predict.plasso'>Predict for (Post-) Lasso models</h2><span id='topic+predict.plasso'></span>

<h3>Description</h3>

<p>Prediction for (Post-) Lasso models.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plasso'
predict(
  object,
  ...,
  newx = NULL,
  type = c("response", "coefficients"),
  s = NULL
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.plasso_+3A_object">object</code></td>
<td>
<p>Fitted <code><a href="#topic+plasso">plasso</a></code> model object</p>
</td></tr>
<tr><td><code id="predict.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="stats.html#topic+predict">predict</a></code> options</p>
</td></tr>
<tr><td><code id="predict.plasso_+3A_newx">newx</code></td>
<td>
<p>Matrix of new values for x at which predictions are to be made. If no value is supplied, x from fitting procedure is used. This argument is not used for type=&quot;coefficients&quot;.</p>
</td></tr>
<tr><td><code id="predict.plasso_+3A_type">type</code></td>
<td>
<p>Type of prediction required. &quot;response&quot; returns fitted values, &quot;coefficients&quot; returns beta estimates.</p>
</td></tr>
<tr><td><code id="predict.plasso_+3A_s">s</code></td>
<td>
<p>If Null, prediction is done for all lambda values. If a value is provided, the closest lambda value of the <code><a href="#topic+plasso">plasso</a></code> object is used.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>List object containing either fitted values or coefficients for both
the Lasso and Post-Lasso models associated with all values along the lambda
input sequence or for one specifically given lambda value.
</p>
<table role = "presentation">
<tr><td><code>lasso</code></td>
<td>
<p>Matrix with Lasso predictions or coefficients</p>
</td></tr>
<tr><td><code>plasso</code></td>
<td>
<p>Matrix with Post-Lasso predictions or coefficients</p>
</td></tr>
</table>


<h3>Examples</h3>

<pre><code class='language-R'>
# load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit plasso to the data
p = plasso::plasso(X,y)
# predict fitted values along whole lambda sequence 
pred = predict(p)
head(pred$plasso)
# get estimated coefficients for specific lambda approximation
predict(p, type="coefficients", s=0.05)

</code></pre>

<hr>
<h2 id='print.cv.plasso'>Print cross-validated (Post-) Lasso model</h2><span id='topic+print.cv.plasso'></span>

<h3>Description</h3>

<p>Printing main insights from cross-validated (Post-) Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.plasso'
print(x, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.cv.plasso_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+cv.plasso">cv.plasso</a></code> object</p>
</td></tr>
<tr><td><code id="print.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+print">print</a></code> options</p>
</td></tr>
<tr><td><code id="print.cv.plasso_+3A_digits">digits</code></td>
<td>
<p>Integer, used for number formatting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints basic statistics for different lambda values of a fitted <code><a href="#topic+plasso">plasso</a></code> object,
i.e. cross-validated MSEs for both Lasso and Post-Lasso model as well as the number of active variables.
</p>

<hr>
<h2 id='print.plasso'>Print (Post-) Lasso model</h2><span id='topic+print.plasso'></span>

<h3>Description</h3>

<p>Printing main insights from (Post-) Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plasso'
print(x, ..., digits = max(3, getOption("digits") - 3))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.plasso_+3A_x">x</code></td>
<td>
<p><code><a href="#topic+plasso">plasso</a></code> object</p>
</td></tr>
<tr><td><code id="print.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+print">print</a></code> options</p>
</td></tr>
<tr><td><code id="print.plasso_+3A_digits">digits</code></td>
<td>
<p>Integer, used for number formatting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>-like output.
</p>

<hr>
<h2 id='print.summary.cv.plasso'>Print summary of (Post-) Lasso model</h2><span id='topic+print.summary.cv.plasso'></span>

<h3>Description</h3>

<p>Prints summary information of <code><a href="#topic+cv.plasso">cv.plasso</a></code> object
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'summary.cv.plasso'
print(x, ..., digits = max(3L, getOption("digits") - 3L))
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="print.summary.cv.plasso_+3A_x">x</code></td>
<td>
<p>Summary of plasso object (either of class <code><a href="#topic+summary.cv.plasso">summary.cv.plasso</a></code> or <code><a href="base.html#topic+summary">summary</a></code>)</p>
</td></tr>
<tr><td><code id="print.summary.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic R <code><a href="base.html#topic+print">print</a></code> options</p>
</td></tr>
<tr><td><code id="print.summary.cv.plasso_+3A_digits">digits</code></td>
<td>
<p>Integer, used for number formatting</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Prints information from <code><a href="#topic+summary.cv.plasso">summary.cv.plasso</a></code> object into console.
</p>

<hr>
<h2 id='summary.cv.plasso'>Summary of cross-validated (Post-) Lasso model</h2><span id='topic+summary.cv.plasso'></span>

<h3>Description</h3>

<p>Summary of cross-validated (Post-) Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'cv.plasso'
summary(object, ..., default = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.cv.plasso_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+cv.plasso">cv.plasso</a></code> object</p>
</td></tr>
<tr><td><code id="summary.cv.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+summary">summary</a></code> summary options</p>
</td></tr>
<tr><td><code id="summary.cv.plasso_+3A_default">default</code></td>
<td>
<p>TRUE for <code><a href="glmnet.html#topic+glmnet">glmnet</a></code>-like summary output, FALSE for more specific summary information</p>
</td></tr>
</table>


<h3>Value</h3>

<p>For specific summary information: summary.cv.plasso object (using list structure) containing optimal
lambda values and associated MSEs for both cross-validated Lasso and Post-Lasso model.
For default: <code><a href="base.html#topic+summary">summaryDefault</a></code> object.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)
# get informative summary statistics
print(summary(p.cv, default=FALSE))
# set default=TRUE for standard summary statistics
print(summary(p.cv, default=TRUE))

</code></pre>

<hr>
<h2 id='summary.plasso'>Summary of (Post-) Lasso model</h2><span id='topic+summary.plasso'></span>

<h3>Description</h3>

<p>Summary of (Post-) Lasso model.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'plasso'
summary(object, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="summary.plasso_+3A_object">object</code></td>
<td>
<p><code><a href="#topic+plasso">plasso</a></code> object</p>
</td></tr>
<tr><td><code id="summary.plasso_+3A_...">...</code></td>
<td>
<p>Pass generic <code><a href="base.html#topic+summary">summary</a></code> summary options</p>
</td></tr>
</table>


<h3>Value</h3>

<p>Default <code><a href="base.html#topic+summary">summary</a></code> object
</p>

<hr>
<h2 id='toeplitz'>Simulated 'Toeplitz' Data</h2><span id='topic+toeplitz'></span>

<h3>Description</h3>

<p>Simulated data from a DGP with an underlying causal relationship between
covariates X and the target y.
The covariates matrix X consists of 10 variables whose effect size on target
y is defined by the vector
<code>c(1, -0.83, 0.67, -0.5, 0.33, -0.17, 0, ..., 0)</code>
with the first six effect sizes decreasing in absolute terms continuously
from 1 to 0 and alternating in their sign.
The true causal effect of all other covariates is 0.
The variables in X follow a normal distribution with mean zero while the
covariance matrix follows a Toeplitz matrix.
The target y is then a linear transformation of X plus a vector of standard
normal random variables (i.e. error term).
(See vignette for more details.)
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(toeplitz)
</code></pre>


<h3>Format</h3>

<p>An object of class <code>standardGeneric</code> of length 1.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># load toeplitz data
data(toeplitz)
# extract target and features from data
y = as.matrix(toeplitz[,1])
X = toeplitz[,-1]
# fit cv.plasso to the data
p.cv = plasso::cv.plasso(X,y)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
