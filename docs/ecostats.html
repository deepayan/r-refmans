<!DOCTYPE html><html><head><title>Help for package ecostats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {ecostats}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#addSmooth'><p>addSmooth Add a smoother to a plot, with pointwise confidence band</p></a></li>
<li><a href='#anovaPB'><p>Parametric bootstrap testing to compare two models by analysis of variance (deviance)</p></a></li>
<li><a href='#aphids'><p>Aphid data</p></a></li>
<li><a href='#aphidsBACI'><p>Aphid data as a BACI design</p></a></li>
<li><a href='#BlockBootID'><p>Construct a moving block bootstrap resampling scheme</p></a></li>
<li><a href='#cpredict'><p>Conditional Predictions for Multivariate Linear Model Fits</p></a></li>
<li><a href='#cresiduals'><p>Extract Conditional Residuals from Multivariate Linear Model Fits</p></a></li>
<li><a href='#ecostats-package'><p>ecostats: Code and Data Accompanying the Eco-Stats Text (Warton 2022)</p></a></li>
<li><a href='#estuaries'><p>Effect of pollution on marine microinvertebrates in estuaries</p></a></li>
<li><a href='#estuaryZone'><p>Effect of pollution on marine microinvertebrates in estuaries in different zones</p></a></li>
<li><a href='#globalPlants'><p>Global Plants data</p></a></li>
<li><a href='#guineapig'><p>Guineapig data</p></a></li>
<li><a href='#headbobLizards'><p>Headbob displays of <em>Anolis</em> lizards</p></a></li>
<li><a href='#maunaloa'><p>Atmospheric carbon dioxide concentration from the Mauna Loa Observatory</p></a></li>
<li><a href='#Myrtaceae'><p>Species richness of <em>Myrtaceae</em> plants</p></a></li>
<li><a href='#plotenvelope'><p>Diagnostic Plots for a Fitted Object with Simulation Envelopes</p></a></li>
<li><a href='#qqenvelope'><p>Normal Quantile-Quantile Plots with Global Simulation Envelopes</p></a></li>
<li><a href='#ravens'><p>Ravens data</p></a></li>
<li><a href='#reveg'><p>Invertebrate abundances in a revegetation study</p></a></li>
<li><a href='#seaweed'><p>Habitat Configuration data from seaweed experiment</p></a></li>
<li><a href='#seedsTemp'><p>Germination rates of <em>Abutilon angulatum</em> at different temperatures</p></a></li>
<li><a href='#simulate.manyglm'><p>Simulate from manyglm objects</p></a></li>
<li><a href='#simulate.mlm'><p>Simulate Responses from a Multivariate Linear Model</p></a></li>
<li><a href='#snowmelt'><p>How flowering time relates to snowmelt date</p></a></li>
<li><a href='#waterQuality'><p>Water Quality data</p></a></li>
<li><a href='#windFarms'><p>Data from wind farm study</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Title:</td>
<td>Code and Data Accompanying the Eco-Stats Text (Warton 2022)</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.11</td>
</tr>
<tr>
<td>Date:</td>
<td>2022-08-23</td>
</tr>
<tr>
<td>Description:</td>
<td>Functions and data supporting the Eco-Stats text (Warton, 2022, Springer), and solutions to exercises. Functions include tools for using simulation envelopes in diagnostic plots, and a function for diagnostic plots of multivariate linear models. Datasets mentioned in the package are included here (where not available elsewhere) and there is a vignette for each chapter of the text with solutions to exercises.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/LGPL-2.1">LGPL-2.1</a> | <a href="https://www.r-project.org/Licenses/LGPL-3">LGPL-3</a> [expanded from: LGPL (&ge; 2.1)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>ecoCopula, GET, graphics, grDevices, MASS, mgcv, mvtnorm,
stats</td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>LazyData:</td>
<td>true</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.2.1</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.5.0), mvabund (&ge; 4.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>knitr, rmarkdown, ade4, caper, car, corrplot, DAAG, DHARMa,
dplyr, gclus, GGally, ggplot2, ggthemes, glmnet, gllvm,
glmmTMB, GPArotation, grplasso, lattice, leaps, lme4, MCMCglmm,
multcomp, nlme, ordinal, permute, pgirmess, phylobase,
phylosignal, psych, reshape2, smatr, testthat, vegan, VGAM,
covr</td>
</tr>
<tr>
<td>VignetteBuilder:</td>
<td>knitr</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>no</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2022-08-24 02:14:32 UTC; z3103495</td>
</tr>
<tr>
<td>Author:</td>
<td>David Warton [aut, cre],
  Christopher Chung [ctb],
  Mark Donoghoe [ctb],
  Eve Slavich [ctb]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>David Warton &lt;david.warton@unsw.edu.au&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2022-08-24 06:50:02 UTC</td>
</tr>
</table>
<hr>
<h2 id='addSmooth'>addSmooth Add a smoother to a plot, with pointwise confidence band</h2><span id='topic+addSmooth'></span>

<h3>Description</h3>

<p>Adds a smoother to a plot of <code>y</code> against <code>x</code>, and a confidence band around the smoother with pointwise coverage
(<b>not</b> global, unlike <code><a href="#topic+plotenvelope">plotenvelope</a></code>). The smoother is constructed using <code><a href="mgcv.html#topic+gam">gam</a></code>
and confidence bands use Wald intervals, extracting the standard error from <code><a href="mgcv.html#topic+predict.gam">predict.gam</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>addSmooth(
  x,
  y,
  conf.level = 0.05,
  line.col = "slateblue4",
  envelope.col = adjustcolor(line.col, alpha.f = 0.1),
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="addSmooth_+3A_x">x</code></td>
<td>
<p>is the <code>x</code> co-ordinates for the plot, <em>e.g.</em> the fitted values in a plot of residuals vs fitted values.</p>
</td></tr>
<tr><td><code id="addSmooth_+3A_y">y</code></td>
<td>
<p>is the <code>y</code> co-ordinates for the plot</p>
</td></tr>
<tr><td><code id="addSmooth_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level to use in constructing the confidence band around the smoother.</p>
</td></tr>
<tr><td><code id="addSmooth_+3A_line.col">line.col</code></td>
<td>
<p>color of smoother. Defaults to &quot;slateblue4&quot;.</p>
</td></tr>
<tr><td><code id="addSmooth_+3A_envelope.col">envelope.col</code></td>
<td>
<p>color of the global envelope around the expected trend. All data points should always stay within this envelope
(and will for a proportion <code>conf.level</code> of datasets satisfying model assumptions). If a smoother has been used on
the residual vs fits or scale-location plot, the envelope is constructed around the smoother, that is, the smoother should always stay
within the envelope.</p>
</td></tr>
<tr><td><code id="addSmooth_+3A_...">...</code></td>
<td>
<p>further arguments sent through to <code>lines</code> and <code>polygon</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A challenge when interpreting diagnostic plots is understanding the extent to which
deviations from the expected pattern could be due to random noise (sampling variation)
rather than actual assumption violations. This function is intended to assess this, 
by simulating multiple realizations of residuals (and fitted values) in situations where 
assumptions are satisfied, and plotting a global simulation envelope around these at level <code>conf.level</code>.
</p>
<p>This function adds a smoother to a plot of <code>y</code> against <code>x</code> using <code><a href="mgcv.html#topic+gam">gam</a></code>, and a confidence band 
around the smoother with pointwise coverage (<b>not</b> global, unlike <code><a href="#topic+plotenvelope">plotenvelope</a></code>) using Wald intervals
that take the standard error of predicted values from <code><a href="mgcv.html#topic+predict.gam">predict.gam</a></code>.
</p>
<p>When constructing a plot to diagnose model fit, <code><a href="#topic+plotenvelope">plotenvelope</a></code> is preferred, because this constructs
simulation envelopes globally, simplifying interpretation, and tends to give more accurate envelopes, via simulation.
This function is intended to fit trends to data for descriptive purposes, but it could be used (with caution) 
to diagnose model fit in residual plots in situations where <code><a href="#topic+plotenvelope">plotenvelope</a></code> is unavailable.
</p>


<h3>Value</h3>

<p>A smoother is added to the existing plot, with confidence band. In addition, a data frame is invisibly
returned with the following components:</p>

<dl>
<dt><code>X</code></dt><dd><p>The values of <code>x</code> at which the smoother is evaluated.</p>
</dd>
<dt><code>Yhat</code></dt><dd><p>Values of the smoother used to predict <code>y</code>, for each value of <code>x</code>.</p>
</dd>
<dt><code>Yhi</code></dt><dd><p>The upper bound on the confidence band, for each value of <code>x</code>.</p>
</dd>
<dt><code>Ylo</code></dt><dd><p>The lower bound on the global envelope, for each value of <code>x</code>.</p>
</dd>
</dl>



<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="#topic+plotenvelope">plotenvelope</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(globalPlants)
plot(log(height)~lat,data=globalPlants)
with(globalPlants, addSmooth(lat,log(height)) )

</code></pre>

<hr>
<h2 id='anovaPB'>Parametric bootstrap testing to compare two models by analysis of variance (deviance)</h2><span id='topic+anovaPB'></span>

<h3>Description</h3>

<p>Compute analysis of variance (or deviance) tables for two fitted model objects,
with the <em>P</em>-value estimated using a parametric bootstrap &ndash; by repeatedly
simulating new responses from the fitted model under the null hypothesis.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>anovaPB(
  objectNull,
  object,
  n.sim = 999,
  colRef = switch(class(object)[1], lm = 5, lmerMod = 6, 4),
  rowRef = 2,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="anovaPB_+3A_objectnull">objectNull</code></td>
<td>
<p>is the fitted model under the null hypothesis. This can be
<em>any</em> object that responds to <code>simulate</code>, <code>update</code> and <code>anova</code>.</p>
</td></tr>
<tr><td><code id="anovaPB_+3A_object">object</code></td>
<td>
<p>is the fitted model under the alternative hypothesis. This can be
<em>any</em> object that responds to <code>update</code>, <code>anova</code> and <code>model.frame</code>.
It must be larger than <code>objectNull</code> and its model frame should contain
all the terms required to fit <code>objectNull</code>.</p>
</td></tr>
<tr><td><code id="anovaPB_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulated datasets to generate for parametric
bootstrap testing. Defaults to 999.</p>
</td></tr>
<tr><td><code id="anovaPB_+3A_colref">colRef</code></td>
<td>
<p>the column number where the test statistic of interest can be found
in the standard <code>anova</code> output when calling <code>anova(objectNull,object)</code>.
Default choices have been set for common models (<code>colRef=5</code> for <code>lm</code> objects,
<code>colRef=6</code> for <code>lmer</code> objects and <code>colRef=4</code> otherwise, which is correct 
for <code>glm</code> and <code>gam</code> objects).</p>
</td></tr>
<tr><td><code id="anovaPB_+3A_rowref">rowRef</code></td>
<td>
<p>the row number where the test statistic of interest can be found
in the standard <code>anova</code> output when calling <code>anova(objectNull,object)</code>.
Defaults to <code>2</code>, because it is on the second row for most common models.</p>
</td></tr>
<tr><td><code id="anovaPB_+3A_...">...</code></td>
<td>
<p>further arguments sent through to <code>anova</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>The <code>anova</code> function typically relies on classical asymptotic results
which sometimes don't apply well, e.g. when using penalised likelihood to fit a
generalised additive model, or when testing whether a random effect should be
included in a mixed model. In such cases we can get a more accurate test by
using simulation to estimate the <em>P</em>-value &ndash; repeatedly simulating 
new sets of simulated responses, refitting the null and alternative models, and 
recomputing the test statistic. This process allows us to estimate the 
distribution of the test statistic when the null hypothesis is true, hence 
draw a conclusion about whether the observed test statistic is large relative
to what would be expected under the null hypothesis. The process is often
referred to as a <em>parametric bootstrap</em> (Davison &amp; Hinkley 1997), which
the <em>PB</em> in the function name (<code>anovaPB</code>) is referring to.
</p>
<p>This function will take any pair of fitted models, a null (<code>objectNull</code>)
and an alternative (<code>object</code>), and use simulation to estimate the 
<em>P</em>-value of the test of whether there is evidence against the model in
<code>objectNull</code> in favour of the model in <code>object</code>. This function works
by repeatedly performing an <code>anova</code> to compare <code>objectNull</code>  to
<code>object</code>, where the responses in the <code>model.frame</code> have been replaced
with values simulated by applying <code>simulate</code> to <code>objectNull</code>. Hence
for this function to work, the objects being compared need to respond 
to the <code>anova</code>, <code>simulate</code> and <code>model.frame</code> functions.
</p>
<p>This function needs to be able to find the test statistic in the <code>anova</code>
output, but it is stored in different places for different types of objects.
It is assumed that <code>anova(objectNull,object)</code> returns a matrix and that the
test statistic is stored in the <code>(rowRef,colRef)</code>th element, where both
<code>rowRef</code> and <code>colRef</code> have been chosen to be correct for common
model types (<code>glm</code>, <code>gam</code>, <code>lmer</code>).
</p>


<h3>Value</h3>

<p>A matrix which has the appearance and behaviour of an object returned by 
<code>anova(objectNull,object)</code>, except that the <em>P</em>-value has been computed
by parametric bootstrap, and the matrix now inherits class <code>anovaPB</code>.
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Davison A.C. &amp; Hinkley D. V. (1997) Bootstrap methods and their application, Cambridge University Press.
Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+anova">anova</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Poisson regression to random data:
y = rpois(50,lambda=1)
x = 1:50
rpois_glm = glm(y~x,family=poisson())
rpois_int = glm(y~1,family=poisson())
anovaPB(rpois_int,rpois_glm,n.sim=99)

</code></pre>

<hr>
<h2 id='aphids'>Aphid data</h2><span id='topic+aphids'></span>

<h3>Description</h3>

<p>A study of the effects of bird exclusion on biological control of aphids in oat and wheat fields in 
Germany (Grass <em>et al.</em> 2017). Many thanks to Ingo for providing the raw data.
In each of two fields (one of oats, one of wheat) there were eight plots, four with plastic netting 
to exclude birds, and four without. Aphid abundance was counted on seven different occasions over 
the first 38 weeks following netting. The expectation was that aphid numbers would decrease on bird 
exclusion, because an important food source to tree sparrows is aphid predators, hoverflies and 
ladybird beetles, so presence of birds may be limit the effectiveness of a biological control of aphids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aphids)
</code></pre>


<h3>Format</h3>

<p>A list containing two dataframes, <code>oat</code> and <code>wheat</code>, depending on the crop. Each
dataframe contains:</p>

<dl>
<dt>Plot</dt><dd><p>The plot ID, a factor with eight levels</p>
</dd>
<dt>Treatment</dt><dd><p>A factor indicating whether birds were excluded, <code>excluded</code> or <code>present</code>.</p>
</dd>
<dt>Time</dt><dd><p>The number of days since netting was applied.</p>
</dd>
<dt>counts</dt><dd><p>Aphid abundance (counts)</p>
</dd>
<dt>logcount</dt><dd><p>log(y+1)-transformed aphid abundance</p>
</dd>
</dl>



<h3>References</h3>

<p>Grass <em>et al.</em> (2017) Insectivorous birds disrupt biological control of cereal aphids.
Ecology, <b>98</b> 1583-90.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aphids)
cols=c(rgb(1,0,0,alpha=0.5),rgb(0,0,1,alpha=0.5)) #transparent colours
with(aphids$oat, interaction.plot(Time,Plot,logcount,legend=FALSE,
                               col=cols[Treatment], lty=1, ylab="Counts [log(y+1) scale]",
                               xlab="Time (days since treatment)") )
                               legend("bottomleft",c("Excluded","Present"),col=cols,lty=1)
</code></pre>

<hr>
<h2 id='aphidsBACI'>Aphid data as a BACI design</h2><span id='topic+aphidsBACI'></span>

<h3>Description</h3>

<p>A subset from a study of the effects of bird exclusion on biological control of aphids in a German oat
field (Grass <em>et al.</em> 2017). Many thanks to Ingo for providing the raw data. The full data are
in <code><a href="#topic+aphids">aphids</a></code>, here we provide just two sampling times, 3 days and 30 days after netting.
OK, this is not quite a BACI design, 3 days after netting is not quite &quot;before&quot; but effects at this 
point should be negligible...
</p>
<p>There were eight plots, four with plastic netting to exclude birds, and four without. Aphid abundance 
was counted on 5 shoots per plot. The expectation was that aphid numbers would decrease on bird 
exclusion, because an important food source to tree sparrows is aphid predators, hoverflies and 
ladybird beetles, so presence of birds may be limit the effectiveness of a biological control of aphids.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(aphidsBACI)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>Plot</dt><dd><p>The plot ID, a factor with eight levels</p>
</dd>
<dt>Treatment</dt><dd><p>A factor indicating whether birds were excluded, <code>excluded</code> or <code>present</code>.</p>
</dd>
<dt>Time</dt><dd><p>The data of sampling (June 18th or July 15th, 3 and 30 days after netting, respectively)</p>
</dd>
<dt>counts</dt><dd><p>Aphid abundance (counts)</p>
</dd>
<dt>logcount</dt><dd><p>log(y+1)-transformed aphid abundance</p>
</dd>
</dl>



<h3>References</h3>

<p>Grass <em>et al.</em> (2017) Insectivorous birds disrupt biological control of cereal aphids.
Ecology, <b>98</b> 1583-90.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(aphidsBACI)
plot(logcount~interaction(Treatment,Time),data=aphidsBACI,col=c("lightgreen","pink"))
</code></pre>

<hr>
<h2 id='BlockBootID'>Construct a moving block bootstrap resampling scheme</h2><span id='topic+BlockBootID'></span>

<h3>Description</h3>

<p>A spatial moving block bootstrap resampling scheme is constructed, that can then
be used in resampling-based inference (e.g. using <code><a href="mvabund.html#topic+anova.manyglm">anova.manyglm</a></code>).
Blocks are constructed as discs or tiles of observations of a user-specified size and shape.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>BlockBootID(
  x,
  y,
  block_L,
  nBoot = 499,
  Grid_space,
  lookuptables.folderpath = NA,
  shape = "disc",
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="BlockBootID_+3A_x">x</code></td>
<td>
<p>the easting of spatial coordinate for the site.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_y">y</code></td>
<td>
<p>the northing of the spatial coordinate for the site.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_block_l">block_L</code></td>
<td>
<p>the size of the spatial blocks to be resampled.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_nboot">nBoot</code></td>
<td>
<p>the number of resamples required (defaults to 499).</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_grid_space">Grid_space</code></td>
<td>
<p>the resolution of the lattice used to sample centres of spatial blocks.
Defaults to a third of the resolution of <code>block_Ls</code>.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_lookuptables.folderpath">lookuptables.folderpath</code></td>
<td>
<p>(optional) path to a directory where lookup tables can be found
that assign observations to spatial blocks. Such tables would considerably speed up the process.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_shape">shape</code></td>
<td>
<p>shape of the spatial blocks to resample. Default is <code>disc</code>, but <code>square</code> 
tiles can also be specified.</p>
</td></tr>
<tr><td><code id="BlockBootID_+3A_...">...</code></td>
<td>
<p>additional arguments passed to <code>resample_blocks_by_area</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A spatial moving block bootstrap resampling scheme is constructed, that can then
be used in resampling-based inference. A matrix of IDs is returned, with different resamples 
in different rows of the matrix, which can be used as input to functions designed for 
resampling-based inference (such as <code><a href="mvabund.html#topic+anova.manyglm">anova.manyglm</a></code>).
</p>
<p>Blocks are constructed as discs or tiles of observations, whose size is controlled by <code>blockl_L</code>,
these blocks are kept together in resampling. The centre of each block is chosen 
at random along a lattice specified via <code>Grid_space</code>. 
</p>
<p>The most computationally intensive part of this process is working out which observations 
belong in which blocks. If repeated analyses are to be undertaken in the same spatial domain 
using the same sites, it is best to run this process only once and save the result as a set of
lookup tables.
Then the path to the directory containing these tables is specified via <code>lookuptables.folderpath</code>
and the whole thing runs heaps faster.
</p>


<h3>Value</h3>

<p>A matrix of IDs for each moving block bootstrap resample, with different
resamples in rows and observations in columns.
</p>


<h3>Author(s)</h3>

<p>Eve Slavich &lt;eve.slavich@unsw.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="mvabund.html#topic+anova.manyglm">anova.manyglm</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>
data(Myrtaceae)
# fit a lm:
library(mvabund)
Myrtaceae$logrich=log(Myrtaceae$richness+1)
mft_richAdd = manylm(logrich~soil+poly(TMP_MAX,degree=2)+
                     poly(TMP_MIN,degree=2)+poly(RAIN_ANN,degree=2),
                                        data=Myrtaceae)
                                        
# construct a boot ID matrix: 
BootID = BlockBootID(x = Myrtaceae$X, y = Myrtaceae$Y, block_L = 20,
            nBoot = 199, Grid_space = 5)
anova(mft_richAdd,resamp="case",bootID=BootID)


</code></pre>

<hr>
<h2 id='cpredict'>Conditional Predictions for Multivariate Linear Model Fits</h2><span id='topic+cpredict'></span>

<h3>Description</h3>

<p>Predicted values using full conditional models derived from a multivariate 
linear model (<code>mlm</code>) object. The full conditionals model each response as a
linear model with all other responses used as predictors in addition to the
regressors specified in the formula of the <code>mlm</code> object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cpredict(object, standardize = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cpredict_+3A_object">object</code></td>
<td>
<p>a <code>mlm</code> object, typically the result of calling <code>lm</code> with a matrix response.</p>
</td></tr>
<tr><td><code id="cpredict_+3A_standardize">standardize</code></td>
<td>
<p>logical defaults to <code>TRUE</code>, standardising responses so they
are comparable across responses.</p>
</td></tr>
<tr><td><code id="cpredict_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>, in particular, <code>newdata</code>.
However, this function was not written to accept non-default values for <code>se.fit</code>, 
<code>interval</code> or <code>terms</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Predictions using an <code>mlm</code> object but based on the full conditional model,
that is, from a linear model for each response as  a function of all responses 
as well as predictors. This can be used in plots to diagnose the multivariate 
normality assumption.
</p>
<p>By default predictions are standardised to facilitate overlay plots of multiple
responses, as in <code><a href="#topic+plotenvelope">plotenvelope</a></code>.
</p>
<p>This function behaves much like <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>, but currently, standard 
errors and confidence intervals around predictions are not available.
</p>


<h3>Value</h3>

<p>A matrix of predicted values from full conditional models.
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cresiduals">cresiduals</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="#topic+plotenvelope">plotenvelope</a></code>, <code><a href="stats.html#topic+predict.lm">predict.lm</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
# fit a mlm:
iris.mlm=lm(cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width)~Species,data=iris)
# predict each response conditionally on the values of all other responses:
cpredict(iris.mlm)

</code></pre>

<hr>
<h2 id='cresiduals'>Extract Conditional Residuals from Multivariate Linear Model Fits</h2><span id='topic+cresiduals'></span>

<h3>Description</h3>

<p>Residuals from full conditionals of a Multivariate 
Linear Model (<code>mlm</code>) object. The full conditional for each response is a
linear model with all other responses used as predictors in addition to the
regressors specified in the formula of the <code>mlm</code> object. This is used to 
diagnose the multivariate normality assumption in <code><a href="#topic+plotenvelope">plotenvelope</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>cresiduals(object, standardize = TRUE, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="cresiduals_+3A_object">object</code></td>
<td>
<p>a <code>mlm</code> object, typically the result of calling <code>lm</code> with a matrix response.</p>
</td></tr>
<tr><td><code id="cresiduals_+3A_standardize">standardize</code></td>
<td>
<p>logical defaults to <code>TRUE</code>, to return studentized residuals
using <code><a href="stats.html#topic+rstandard">rstandard</a></code> so they are comparable across responses.</p>
</td></tr>
<tr><td><code id="cresiduals_+3A_...">...</code></td>
<td>
<p>further arguments passed to <code><a href="stats.html#topic+residuals.lm">residuals.lm</a></code> or <code><a href="stats.html#topic+rstandard">rstandard</a></code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>residuals</code> function for <code>mlm</code> objects, which returns residuals from a full 
conditional model, that is, a linear model of each response against all responses
as well as predictors, which can be used to diagnose the multivariate normality assumption.
These can be standardized (<code>standardize=TRUE</code>) to facilitate overlay plots of multiple
responses, as in <code><a href="#topic+plotenvelope">plotenvelope</a></code>.
</p>


<h3>Value</h3>

<p>A matrix of residuals
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cpredict">cpredict</a></code>, <code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="#topic+plotenvelope">plotenvelope</a></code>, <code><a href="stats.html#topic+residuals">residuals</a></code>, <code><a href="stats.html#topic+rstandard">rstandard</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(iris)
# fit a mlm:
iris.mlm=lm(cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width)~Species,data=iris)
# construct full conditional residuals:
cresiduals(iris.mlm)

</code></pre>

<hr>
<h2 id='ecostats-package'>ecostats: Code and Data Accompanying the Eco-Stats Text (Warton 2022)</h2><span id='topic+ecostats'></span><span id='topic+ecostats-package'></span>

<h3>Description</h3>

<p>Functions and data supporting the Eco-Stats text (Warton, 2022, Springer), and solutions to exercises. Functions include tools for using simulation envelopes in diagnostic plots, and a function for diagnostic plots of multivariate linear models. Datasets mentioned in the package are included here (where not available elsewhere) and there is a vignette for each chapter of the text with solutions to exercises.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: David Warton <a href="mailto:david.warton@unsw.edu.au">david.warton@unsw.edu.au</a>
</p>
<p>Other contributors:
</p>

<ul>
<li><p> Christopher Chung [contributor]
</p>
</li>
<li><p> Mark Donoghoe [contributor]
</p>
</li>
<li><p> Eve Slavich [contributor]
</p>
</li></ul>


<hr>
<h2 id='estuaries'>Effect of pollution on marine microinvertebrates in estuaries</h2><span id='topic+estuaries'></span>

<h3>Description</h3>

<p>Data from an observational study of whether there is a different in microinvertebrate
communities between estuaries that have been heavily modified by human activity and those
that have not, across seven estuaries along the coast of New South Wales, Australia (Clark et al. 2015).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(estuaries)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing (amongst other things):</p>

<dl>
<dt>Mod</dt><dd><p>A factor describing whether the sample was taken from a 'Modified' or 'Pristine' estuary.</p>
</dd>
<dt>Zone</dt><dd><p>Whether the sample was taken from Inner (upstream) or Outer (downstream) zone of the estuary.</p>
</dd>
<dt>Estuary</dt><dd><p>A factor with seven levels identifying which estuary the sample was taken from.</p>
</dd>
<dt>Total</dt><dd><p>Total abundance of all invertebrates in the sample</p>
</dd> 
<dt>Richness</dt><dd><p>Richness of taxa in the sample &ndash; the number of responses (of those in columns 8-94) taking a non-zero value</p>
</dd> 
</dl>

<p>Other variables in the dataset give invertebrate counts separately for different taxa.
</p>


<h3>References</h3>

<p>Clark, G. F., Kelaher, B. P., Dafforn, K. A., Coleman, M. A., Knott, N. A., 
Marzinelli, E. M., &amp; Johnston, E. L. (2015). What does impacted look like? high diversity and
abundance of epibiota in modified estuaries. Environmental Pollution 196, 12-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(estuaries)
plot(Total~Estuary,data=estuaries,col=c(4,2,2,4,2,4,2))
</code></pre>

<hr>
<h2 id='estuaryZone'>Effect of pollution on marine microinvertebrates in estuaries in different zones</h2><span id='topic+estuaryZone'></span>

<h3>Description</h3>

<p>Data from an observational study of whether there is a different in microinvertebrate
communities between estuaries that have been heavily modified by human activity and those
that have not, across seven estuaries along the coast of New South Wales, Australia (Clark et al. 2015).
Sampling was undertaken in both Inner and Outer zones of the estuary.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(estuaryZone)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing (amongst other things):</p>

<dl>
<dt>Mod</dt><dd><p>A factor describing whether the sample was taken from a 'Modified' or 'Pristine' estuary.</p>
</dd>
<dt>Zone</dt><dd><p>Whether the sample was taken from Inner (upstream) or Outer (downstream) zone of the estuary.</p>
</dd>
<dt>Estuary</dt><dd><p>A factor with seven levels identifying which estuary the sample was taken from.</p>
</dd>
<dt>Total</dt><dd><p>Total abundance of all invertebrates in the sample</p>
</dd> 
<dt>Richness</dt><dd><p>Richness of taxa in the sample &ndash; the number of responses (of those in columns 8-94) taking a non-zero value</p>
</dd> 
</dl>

<p>Other variables in the dataset give invertebrate counts separately for different taxa.
</p>


<h3>References</h3>

<p>Clark, G. F., Kelaher, B. P., Dafforn, K. A., Coleman, M. A., Knott, N. A., 
Marzinelli, E. M., &amp; Johnston, E. L. (2015). What does impacted look like? high diversity and
abundance of epibiota in modified estuaries. Environmental Pollution <b>196</b>, 12-20.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(estuaryZone)
cols=c("blue","red","lightblue","pink")
plot(Total~interaction(Estuary,Zone),data=estuaryZone,col=cols[c(1,2,2,1,2,1,2,3,4,4,3,4,3,4)])
</code></pre>

<hr>
<h2 id='globalPlants'>Global Plants data</h2><span id='topic+globalPlants'></span>

<h3>Description</h3>

<p>Data inspired by a worldwide study of plant height and its association with climate and latitude (Moles <em>et al.</em> 2009).
Height is recorded for one dominant plant at each of 178 sites, along with dozens of climatic variables extracted from BIOCLIM.
Sites, climate data and species lists come from Moles <em>et al.</em> (2009) but height data are not actually field measurements,
due to data unavailability. Instead height has been taken from species descriptions available on Google, accessed 7/1/21.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(globalPlants)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing a whole bunch of stuff, the main things being:</p>

<dl>
<dt>height</dt><dd><p>Maximum plant height, in metres, taken from species descriptions on Google (where available)</p>
</dd>
<dt>lat</dt><dd><p>latitude of the site this plant was found at</p>
</dd>
<dt>temp</dt><dd><p>average daily maximum temperature</p>
</dd>
<dt>rain</dt><dd><p>total annual precipitation</p>
</dd>
<dt>rain.wetm</dt><dd><p>Rainfall in the wettest month</p>
</dd>
</dl>



<h3>References</h3>

<p>Moles <em>et al.</em> (2009) Global patterns in plant height.
Journal of Ecology <b>97</b>, 923-932.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(globalPlants)
plot(height~lat,data=globalPlants)



</code></pre>

<hr>
<h2 id='guineapig'>Guineapig data</h2><span id='topic+guineapig'></span>

<h3>Description</h3>

<p>Data derived from a study of the effects of nicotine on the development of guineapig offspring (Johns et al 1993).
Ten pregnant guineapigs were injected with nicotine hydrogen tartite solution, and
ten control guinea pigs were injected with saline solution as a control. Learning capabilities
of offspring were then measured as the number of errors made when trying to remember
where to find food in a simple maze. Data presented  are not from the original paper- they have been generated to match the summary statistics reported in Johns et al (1993).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(guineapig)
</code></pre>


<h3>Format</h3>

<p>A list containing two dataframes, <code>oat</code> and <code>wheat</code>, depending on the crop. Each
dataframe contains:</p>

<dl>
<dt>errors</dt><dd><p>Number of errors made</p>
</dd>
<dt>treatment</dt><dd><p>N=Nicotine, C=Control</p>
</dd>
</dl>



<h3>References</h3>

<p>Johns <em>et al.</em> (1993) The effects of chronic prenatal exposure to nicotine on the behavior of guinea pigs (<em>Cavia porcellus</em>). The Journal of
General Psychology <b>120</b>, 49-63.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(guineapig)
plot(errors~treatment,data=guineapig)
</code></pre>

<hr>
<h2 id='headbobLizards'>Headbob displays of <em>Anolis</em> lizards</h2><span id='topic+headbobLizards'></span>

<h3>Description</h3>

<p>Displays of 14 male <em>Anolis</em> lizards were recorded in Puerto Rican forest (Ord <em>et al. 2016</em>),
along with key environmental characteristics. These lizards bob their head up
and down (and do push-ups) in attempts to attract the attention of females, and
advertise territory ownership to other males.
How fast a lizard bobs its head was recorded, and it was of interest to understand
which environmental features (out of temperature, light and noisiness) were 
related to head bobbing speed.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(headbobLizards)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>LizardID</dt><dd><p>A factor indicating Which lizard we are talking about. There is one observation per lizard (but more were originally collected).</p>
</dd>
<dt>TemperatureC</dt><dd><p>Temperature, in degrees Celsius, at the location where lizard was first observed.</p>
</dd>
<dt>AmbientLight</dt><dd><p>Ambient light recorded using a handheld sensor pointed towards the bobbing is happening.</p>
</dd>
<dt>Bg_noise_max</dt><dd><p>Visual background noise measured using video analysis.</p>
</dd>
<dt>Hbspd_max</dt><dd><p>Maximum head-bobbing speed.</p>
</dd>
<dt>time</dt><dd><p>Date and time of observation.</p>
</dd>
</dl>



<h3>References</h3>

<p>Ord, T. J., Charles, G. K., Palmer, M. &amp; Stamps, J. A. (2016). Plasticity in
social communication and its implications for the colonization of novel
habitats. Behavioral Ecology <b>27</b>, 341-351
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(headbobLizards)
plot(Hbspd_max~Bg_noise_max, data=headbobLizards)
</code></pre>

<hr>
<h2 id='maunaloa'>Atmospheric carbon dioxide concentration from the Mauna Loa Observatory</h2><span id='topic+maunaloa'></span>

<h3>Description</h3>

<p>Monthly average measurements of carbon dioxide concentration from the Mauna Loa Observatory in Hawaii,
from March 1958 to February 2021. Data available courtesy of the Global Monitoring Laboratory at
the National Oceanic and Atmospheric Administration (NOAA) in the United States
(https://www.esrl.noaa.gov/gmd/ccgg/trends/data.html).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(maunaloa)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>Date</dt><dd><p>The data of the measurement in date format. One measurement is available for each month, the first day of the month is assumed here.</p>
</dd>
<dt>year</dt><dd><p>The year of the measurement.</p>
</dd>
<dt>month</dt><dd><p>The month of the measurement.</p>
</dd>
<dt>DateNum</dt><dd><p>The date in numerical format, as <code>year+month/12</code>.</p>
</dd>
<dt>co2</dt><dd><p>Carbon dioxide measurement in parts per million. Calculated as the average of all daily measurements for the month.</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(maunaloa)
plot(co2~Date, type="l", data=maunaloa)
</code></pre>

<hr>
<h2 id='Myrtaceae'>Species richness of <em>Myrtaceae</em> plants</h2><span id='topic+Myrtaceae'></span>

<h3>Description</h3>

<p>Data derived from NSW National Parks and Wildlife Service resources on species
richness for members of the  <em>Myrtaceae</em> family (eucalypts and relates species)
in 1000 monitoring transects west of Sydney in the Greater Blue Mountains World
Heritage Area. Also included is soil type classified into 9 categories, and a few
climate variables derived from Worldclim.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(Myrtaceae)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing (amongst other things):</p>

<dl>
<dt>X</dt><dd><p>Easting of the site (in km).</p>
</dd>
<dt>Y</dt><dd><p>Nothing of the site (in km).</p>
</dd>
<dt>richness</dt><dd><p>Total number of <em>Mrtaceae</em> species observed at this site.</p>
</dd>
<dt>TMP_MAX</dt><dd><p>Annual average of daily maximum temperature (degrees Celsius).</p>
</dd> 
<dt>TMP_MIN</dt><dd><p>Annual average of daily minimum temperature (degrees Celsius).</p>
</dd> 
<dt>RAIN_ANN</dt><dd><p>Annual precipitation (in millimetres).</p>
</dd> 
<dt>soil</dt><dd><p>Soil type, classified into nine categories.</p>
</dd> 
<dt>aspect</dt><dd><p>Aspect of the site (in degrees, 0=360=due North).</p>
</dd> 
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(Myrtaceae)
library(ggplot2)
ggplot(Myrtaceae, aes(x=X, y=Y))+geom_point(aes(color=richness))+
  theme_classic()+xlab("West&lt;--&gt;East (km)")+ylab("South&lt;--&gt;North (km)")+
  scale_color_gradient(low="lightgreen",high="black")+
  labs(color="Species richness [log(y+1)-scale]")+theme(legend.position="top")+
  guides(color = guide_colorbar(title.position = "top",ticks=FALSE,
                               barwidth=15,barheight=0.5))+coord_fixed()
                               
</code></pre>

<hr>
<h2 id='plotenvelope'>Diagnostic Plots for a Fitted Object with Simulation Envelopes</h2><span id='topic+plotenvelope'></span>

<h3>Description</h3>

<p>Produces diagnostic plots of a fitted model <code>y</code>, and
adds global envelopes constructed by simulating new residuals, to see how
departures from expected trends compare to what might be expected if the 
fitted model were correct. Global envelopes are constructed using the
<code>GET</code> package (Myllymäki et al 2017) for simultaneous control of error rates over the
whole plot, by simulating new responses from the fitted model then recomputing residuals
(which can be computationally intensive), or alternatively, by simulating residuals directly from the (multivariate) normal distribution
(faster, but not always a smart move). Options for diagnostic plots to construct are a residual vs fits,
a normal quantile plot, or scale-location plot, along the lines of <code><a href="stats.html#topic+plot.lm">plot.lm</a></code>.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>plotenvelope(
  y,
  which = 1:2,
  sim.method = "refit",
  n.sim = 199,
  conf.level = 0.95,
  type = "st",
  overlay = TRUE,
  transform = NULL,
  main = c("Residuals vs Fitted Values", "Normal Quantile Plot", "Scale-Location Plot"),
  xlab = c("Fitted values", "Theoretical Quantiles", "Fitted Values"),
  ylab = c("Residuals", "Residuals", expression(sqrt("|Residuals|"))),
  col = NULL,
  line.col = if (add.smooth) c("slateblue4", "olivedrab", "slateblue4") else
    rep("olivedrab", 3),
  envelope.col = adjustcolor(line.col, 0.1),
  add.smooth = TRUE,
  plot.it = TRUE,
  resFunction = NULL,
  predFunction = NULL,
  fitMin = if (inherits(y, "glm") | inherits(y, "manyglm")) -6 else -Inf,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="plotenvelope_+3A_y">y</code></td>
<td>
<p>is <em>any</em> object that responds to <code>residuals</code>, <code>predict</code> and 
(if <code>sim.method="refit"</code>) <code>simulate</code> and <code>update</code>.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_which">which</code></td>
<td>
<p>a vector specifying the diagnostic plots to construct: </p>

<ol>
<li><p>residual vs fits, with a smoother
</p>
</li>
<li><p>normal quantile plot
</p>
</li>
<li><p>scale-location plot, with smoother
</p>
</li></ol>

<p>These are the first three options in <code><a href="stats.html#topic+plot.lm">plot.lm</a></code> and a little is borrowed 
from that code. A global envelope is included with each plot around where we expect to see
the data (or the smoother, if requested, for plots 1 and 3) when model assumptions are satisfied.
If not fully captured by the global envelope, there is some evidence that the model assumptions are not satisfied.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_sim.method">sim.method</code></td>
<td>
<p>How should residuals be simulated? The default for most objects is <code>"refit"</code>, which constructs new responses (via <code><a href="stats.html#topic+simulate">simulate</a></code>),
refits the model (via <code><a href="stats.html#topic+update">update</a></code>), then recomputes residuals, often known as a <em>parametric bootstrap</em>.
This is computationally intensive but gives a robust answer. This is the only suitable option if
residuals are not expected to be normal when assumptions are satisfied (like when using <code><a href="stats.html#topic+glm">glm</a></code> with a non-Gaussian family). 
Alternatively, <code>"norm"</code> simulates from a normal distribution, matches means and variances (and covariances for multivariate responses) to the observed residuals.
The <code>"stand.norm"</code> option sets means to zero and variances to one, which is appropriate when residuals
should be standard normal when assumptions are satisfied (as for any object fitted using the <code>mvabund</code>
package, for example). These options are faster but more approximate than <code>"refit"</code>, in fact <code>"stand.norm"</code> is 
used as the default for <code><a href="mvabund.html#topic+manyglm">manyglm</a></code> objects, for computational reasons.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulated sets of residuals to be generated, to which
the observed residuals will be compared. The default is 199 datasets.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level to use in constructing the envelope.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_type">type</code></td>
<td>
<p>the type of global envelope to construct, see 
<code><a href="GET.html#topic+global_envelope_test">global_envelope_test</a></code> for details. Default <code>"st"</code> uses 
studentized envelope tests to protect for unequal variance, which has performed well
in simulations in this context.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_overlay">overlay</code></td>
<td>
<p>logical. For multivariate data, determines whether residuals from 
different responses are overlaid on a single plot (default), or plotted separately.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_transform">transform</code></td>
<td>
<p>a character vector pointing to a function that should be applied to both
axes of the normal quantile plot. The most common use is to set <code>transform="pnorm"</code>
for a PP-plot.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_main">main</code></td>
<td>
<p>the plot title (if a plot is produced). A vector of three titles, one for each plot.
If only one value is given that will be used for all plots.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_xlab">xlab</code></td>
<td>
<p><code>x</code> axis label (if a plot is produced). A vector of three labels, one for each plot.
If only one value is given that will be used for all plots.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_ylab">ylab</code></td>
<td>
<p><code>y</code> axis label (if a plot is produced). A vector of three labels, one for each plot.
If only one value is given that will be used for all plots.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_col">col</code></td>
<td>
<p>color of points</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_line.col">line.col</code></td>
<td>
<p>a vector of length three containing the colors of the lines on the three diagnostic plots.
Defaults to &quot;slateblue4&quot; for smoothers and to &quot;olivedrab&quot; otherwise. Because it's cool.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_envelope.col">envelope.col</code></td>
<td>
<p>color of the global envelope around the expected trend. All data points should always stay within this envelope
(and will for a proportion <code>conf.level</code> of datasets satisfying model assumptions). If a smoother has been used on
the residual vs fits or scale-location plot, the envelope is constructed around the smoother, that is, the smoother should always stay
within the envelope.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_add.smooth">add.smooth</code></td>
<td>
<p>logical defaults to <code>TRUE</code>, which adds a smoother to residual vs fits and
scale-location plots, and computes a global envelope around the <em>smoother</em> rather than the data (<code>add.smooth=FALSE</code>). No smoother is added to the normal quantile plot.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_plot.it">plot.it</code></td>
<td>
<p>logical. Should the result be plotted? If not, a list of analysis outputs is returned, see <em>Value</em>.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_resfunction">resFunction</code></td>
<td>
<p>the function used to compute residuals for all diagnostic plots. Defaults
to <code><a href="#topic+cresiduals">cresiduals</a></code> for multivariate linear models, <code><a href="stats.html#topic+rstandard">rstandard</a></code> for linear
models, or <code><a href="stats.html#topic+residuals">residuals</a></code> in other cases.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_predfunction">predFunction</code></td>
<td>
<p>the function used to compute predicted values in residual vs fits or
scale-location plots. Defaults to <code><a href="#topic+cpredict">cpredict</a></code> for multivariate linear models
and to <code><a href="#topic+cpredict">cpredict</a></code> otherwise.</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_fitmin">fitMin</code></td>
<td>
<p>the minimum fitted value to use in plots, any fitted value less than this will be truncated to
<code>fitMin</code>. This is useful for generalised linear models, where small fitted values correspond to
predictions that are numerically zero. The default is to set <code>fitMin</code> to <code>-6</code> for GLMs, otherwise no truncation (<code>-Inf</code>).</p>
</td></tr>
<tr><td><code id="plotenvelope_+3A_...">...</code></td>
<td>
<p>further arguments sent through to <code>plot</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A challenge when interpreting diagnostic plots is understanding the extent to which
deviations from the expected pattern could be due to random noise (sampling variation)
rather than actual assumption violations. This function is intended to assess this, 
by simulating multiple realizations of residuals (and fitted values) in situations where 
assumptions are satisfied, and plotting a global simulation envelope around these at level <code>conf.level</code>.
</p>
<p>This function can take any fitted model, and construct any of three diagnostic plots, as determined by <code>which</code>:
</p>

<ol>
<li><p> Residual vs fits plot (optionally, with a smoother)
</p>
</li>
<li><p> Normal quantile plot
</p>
</li>
<li><p> Scale-Location plot (optionally, with smoother)
</p>
</li></ol>

<p>and see if the trend is behaving as expected if the model were true. As long as 
the fitted model responds to <code><a href="stats.html#topic+residuals">residuals</a></code> and <code><a href="stats.html#topic+predict">predict</a></code> 
(and when <code>sim.method="refit"</code>, <code><a href="stats.html#topic+simulate">simulate</a></code> and <code><a href="stats.html#topic+update">update</a></code>) then a simulation envelope
will be constructed for each plot.
</p>
<p>Simulation envelopes are global, constructed using the <code><a href="GET.html#topic+GET-package">GET-package</a></code>, meaning that
(for example) a 95% global envelope on a quantile plot should contain <em>all</em> residuals for 95% of datasets
that satisfy model assumptions. So if <em>any</em> data points lie outside the
quantile plot's envelope we have evidence that assumptions of the fitted model are not satisfied. 
The <code><a href="GET.html#topic+GET-package">GET-package</a></code> was originally constructed to place envelopes around functions, motivated by
the problem of diagnostic testing of spatial processes (Myllymäki et al 2017), but it can equally
well be applied here, by treating the set of residuals (ordered according to the x-axis) as point-wise evaluations of a function.
For residual vs fits and scale-location plots, if <code>do.smooth=TRUE</code>, global envelopes are constructed for
the <em>smoother</em>, not for the data, hence we are looking to see if the smoother
is wholly contained within the envelope. The smoother is constructed using <code><a href="mgcv.html#topic+gam">gam</a></code> from the <code>mgcv</code> 
package with maximum likelihood estimation (<code>method="ML"</code>).
</p>
<p>Note that the global envelopes only tell you if there is evidence of violation of model
assumptions &ndash; they do not tell you whether the violations are large enough to worry about. For example, in linear models,
violations of normality are usually much less important than violations of linearity or equal variance. And in all cases,
modest violations tend to only have modest effects on the validity of inferences, so you need to think about how big
observed violations are rather than just thinking about whether or not anything is outside its simulation envelope.
</p>
<p>The method used to simulate data for the global envelopes is controlled by <code>sim.method</code>.
The default method (<code>sim.method="refit"</code>) uses a <em>parametric bootstrap</em> approach: simulate 
new responses from the fitted model, refit the model and recompute residuals and fitted values. 
This directly assesses whether trends in observed trends depart from what would be expected if the fitted model
were correct, without any further assumptions. For complex models or large datasets this would however be super-slow.
A fast, more approximate alternative (<code>sim.method="norm"</code>) is to simulate new (multivariate) normal residuals 
repeatedly and use these to assess whether trends in the observed data depart from what would be expected
for independent (multivariate) normal residuals. If residuals are expected to be standard
normal, a more refined check is to simulate from the standard normal using (<code>sim.method="stand.norm"</code>).
This might for example be useful when diagnosing a model fitted using the <code>mvabund</code> package (Wang et al. 2012),
since this calculates Dunn-Smyth residuals (Dunn &amp; Smyth 1996), which are approximately standard normal when assumptions are satisfied.  
If <code>y</code> is a <code>glm</code> with non-Gaussian family then residuals will not be normal and <code>"refit"</code> is the
only appropriate option, hence other choices will be overridden with a warning reporting that this
has been done. 
</p>
<p>Note that for Multivariate Linear Models (<code>mlm</code>), <code><a href="#topic+cresiduals">cresiduals</a></code> and <code><a href="#topic+cpredict">cpredict</a></code> 
are used to construct residuals and fitted values (respectively) from the <em>full conditional models</em>
(that is, models constructed by regressing each response against all other responses
together with predictors). This is done because full conditionals are diagnostic of joint 
distributions, so <em>any</em> violation of multivariate normality is expressed as a violation of 
linear model assumptions on full conditionals. Results for all responses are overlaid on a single plot,
future versions of this function may have an overlay option to separately plot each response.
</p>
<p>The simulated data and subsequent analysis are also used to obtain a <em>P</em>-value 
for the test that model assumptions are correct, for each plot. This tests if sample residuals or their smoothers
are unusually far from the values expected of them if model assumptions were satisfied. For details see
<code><a href="GET.html#topic+global_envelope_test">global_envelope_test</a></code>.
</p>


<h3>Value</h3>

<p>Up to three diagnostic plots with simulation envelopes are returned, and additionally a list of 
three objects used in plotting, for plots 1-3 respectively. Each is a list with five components:</p>

<dl>
<dt><code>x</code></dt><dd><p><em>X</em>-values used for the envelope. In plots 1 and 3 this is the fitted values, or if <code>add.smooth=TRUE</code>, this is 500 equally spaced points covering
the range of fitted values. For plot 2, this is sorted normal quantiles corresponding to observed data.</p>
</dd>
<dt><code>y</code></dt><dd><p>The <em>Y</em>-values used for the envelope. In plots 1 and 3 this is the residuals, or with <code>add.smooth=TRUE</code>, this is the values of the smoother corresponding to <code>x</code>. For plot 2,
this is the sorted residuals.</p>
</dd>
<dt><code>lo</code></dt><dd><p>The lower bound on the global envelope, for each value of <code>x</code>.</p>
</dd>
<dt><code>hi</code></dt><dd><p>The upper bound on the global envelope, for each value of <code>x</code>.</p>
</dd>
<dt><code>p.value</code></dt><dd><p>A <em>P</em>-value for the test that observed smoother or data are consistent with what
would be expected if the fitted model were correct, computed in <code><a href="GET.html#topic+global_envelope_test">global_envelope_test</a></code>.</p>
</dd> 
</dl>



<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Dunn, P. K., &amp; Smyth, G. K. (1996), Randomized quantile residuals. J. Comp. Graphical Stat. 5, 236-244. doi:10.1080/10618600.1996.10474708
</p>
<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017), Global envelope tests for spatial processes. J. R. Stat. Soc. B, 79: 381-404. doi:10.1111/rssb.12172
</p>
<p>Wang, Y. I., Naumann, U., Wright, S. T., &amp; Warton, D. I. (2012), <code>mvabund</code> - an <code>R</code> package for model-based analysis of multivariate abundance data. Methods in Ecology and Evolution, 3, 471-474. doi:10.1111/j.2041-210X.2012.00190.x
</p>
<p>Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="#topic+cpredict">cpredict</a></code>, <code><a href="#topic+cresiduals">cresiduals</a></code>, <code><a href="#topic+qqenvelope">qqenvelope</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a Poisson regression to random data:
y = rpois(50,lambda=1)
x = 1:50
rpois_glm = glm(y~x,family=poisson())
plotenvelope(rpois_glm,n.sim=59)

# Fit a multivariate linear model to the iris dataset:
data(iris)
Y = with(iris, cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width))
iris_mlm=lm(Y~Species,data=iris)
# check normality assumption:
plotenvelope(iris_mlm,n.sim=59,which=2)

# A few more plots, with envelopes around data not smoothers:
plotenvelope(iris_mlm, which=1:3, add.smooth=FALSE)
# Note minor violation on the scale/location plot.

# Repeat but with smoothers and with separate plots for each response and 
# a multiple testing adjustment to sim envelopes:
plotenvelope(iris_mlm, which=1:3, overlay=FALSE, conf.level=1-0.05/4)

</code></pre>

<hr>
<h2 id='qqenvelope'>Normal Quantile-Quantile Plots with Global Simulation Envelopes</h2><span id='topic+qqenvelope'></span>

<h3>Description</h3>

<p>Produces a normal QQ plot of data, or of residuals from a fitted model <code>y</code>, with a user-specified 
line to compare to &quot;theoretical&quot; quantiles, and global envelopes constructed
by simulating new residuals. Global envelopes are constructed using the
<code>GET</code> package for simultaneous control of error rates over the whole curve.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qqenvelope(y, n.sim = 199, conf.level = 0.95, ylab = "Sample Quantiles", ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="qqenvelope_+3A_y">y</code></td>
<td>
<p>can be a set of values for which we wish to check (multivariate) normality, 
or it can be <em>any</em> object that responds to the <code>residuals</code>, <code>simulate</code> and <code>update</code>
functions.</p>
</td></tr>
<tr><td><code id="qqenvelope_+3A_n.sim">n.sim</code></td>
<td>
<p>the number of simulated sets of residuals to be generated, to which
the observed residuals will be compared. The default is 199 datasets.</p>
</td></tr>
<tr><td><code id="qqenvelope_+3A_conf.level">conf.level</code></td>
<td>
<p>the confidence level to use in constructing the envelope.</p>
</td></tr>
<tr><td><code id="qqenvelope_+3A_ylab">ylab</code></td>
<td>
<p><code>y</code> axis label (if a plot is produced).</p>
</td></tr>
<tr><td><code id="qqenvelope_+3A_...">...</code></td>
<td>
<p>further arguments sent through to <code>plotenvelope</code></p>
</td></tr>
</table>


<h3>Details</h3>

<p>A challenge when interpreting a <code>qqplot</code> is understanding the extent to which
deviations from expected values could be due to random noise (sampling variation)
rather than actual assumption violations. This function is intended to assess this, 
by simulating multiple realizations of residuals in situations where assumptions 
are satisfied, and plotting a global (or &quot;simultaneous&quot;) simulation envelope around these at level <code>conf.level</code>.
All data points should lie if assumptions are satisfied, and will do so for a proportion <code>conf.level</code> of
datasets which satisfy their assumptions.
</p>
<p>This function can take data (univariate or multivariate) and check for (multivariate)
normality, or it can take a fitted model and use qq plots to interrogate residuals and
see if they are behaving as we would expect them to if the model were true.
</p>
<p>The envelope is global, constructed using the <code><a href="GET.html#topic+GET-package">GET-package</a></code>. So if <em>any</em> data points lie outside the
envelope we have evidence that assumptions are not satisfied. 
The <code><a href="GET.html#topic+GET-package">GET-package</a></code> was originally constructed to place envelopes around functions, motivated by
the problem of diagnostic testing of spatial processes (Myllymäki et al 2017), but it can equally
well be applied here, by treating sorted residuals as point-wise evaluations of a function.
</p>
<p>For further details refer to <code><a href="#topic+plotenvelope">plotenvelope</a></code>, which is called to construct the plot.
</p>


<h3>Value</h3>

<p>a qqplot with simulation envelope is returned, and additionally:
</p>
<table>
<tr><td><code>x</code></td>
<td>
<p>a vector of theoretical quantiles from the standard normal sorted from
smallest to largest</p>
</td></tr>
<tr><td><code>y</code></td>
<td>
<p>a vector of observed residuals sorted from smallest to largest</p>
</td></tr>
<tr><td><code>lo</code></td>
<td>
<p>lower bounds on the global simulation envelope for residuals</p>
</td></tr>
<tr><td><code>hi</code></td>
<td>
<p>upper bounds on the global simulation envelope for residuals</p>
</td></tr>
<tr><td><code>p.value</code></td>
<td>
<p>A <em>P</em>-value for the test that model assumptions are correct,
using a 'parametric bootstrap' test, based on how far sample residuals depart from
the values expected of them if model assumptions were satisfied.</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>References</h3>

<p>Myllymäki, M., Mrkvička, T., Grabarnik, P., Seijo, H. and Hahn, U. (2017), Global envelope tests for spatial processes. J. R. Stat. Soc. B, 79: 381-404. doi:10.1111/rssb.12172
Warton DI (2022) Eco-Stats - Data Analysis in Ecology, from <em>t</em>-tests to multivariate abundances. Springer, ISBN 978-3-030-88442-0
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+qqnorm">qqnorm</a></code>, <code><a href="stats.html#topic+qqline">qqline</a></code>, <code><a href="#topic+plotenvelope">plotenvelope</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># simulate some data and fit a qq plot:
y=rnorm(20)
qqenvelope(y)

# fit a multivariate linear model to the iris dataset:
data(iris)
Y = with(iris, cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width))
iris.mlm=lm(Y~Species,data=iris)
# check normality assumption:
qqenvelope(iris.mlm,n.sim=79)

</code></pre>

<hr>
<h2 id='ravens'>Ravens data</h2><span id='topic+ravens'></span>

<h3>Description</h3>

<p>Data from a study of whether ravens fly towards the sound of gunshots (White 2005). Many thanks to Crow White for providing the raw data. There were twelve locations, at which four treatments were applied (1=gunshot, 2-air horn, 3=whistle, 4=no sound).
Ravens within a 100 metre radius of the author were counted ten minutes before and ten minutes after each treatment was applied.
Primary interest was in assessing if there was an effect of gunshot on raven numbers. Posthoc analyses
suggested that ravens were attracted to gunshots in forested areas only.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(ravens)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>Before</dt><dd><p>The number of ravens before the treatment was applied</p>
</dd>
<dt>After</dt><dd><p>The number of ravens after the treatment was applied</p>
</dd>
<dt>delta</dt><dd><p><code>After-Before</code> count</p>
</dd>
<dt>site</dt><dd><p>Location, one of twelve in Jackson Hole, Wyoming's ungulate hunting zone</p>
</dd>
<dt>treatment</dt><dd><p>1=gunshot, 2=air horn, 3=whistle, 4=no sound</p>
</dd>
<dt>trees</dt><dd><p>1=forested habitat (&gt;300 trees within 100 metres of observer), 0=open</p>
</dd>
</dl>



<h3>References</h3>

<p>Crow White (2005) Hunters ring dinner bell for ravens: experimental evidence of a unique foraging strategy.
Ecology, <b>86</b> 1057-60.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(ravens)
ravens1 = ravens[ravens$treatment==1,]
t.test(ravens1$Before,ravens1$After,paired=TRUE,alternative="less")
boxplot(ravens1$delta,ylab="After-Before counts")
abline(h=0,col="red",lty=3)
</code></pre>

<hr>
<h2 id='reveg'>Invertebrate abundances in a revegetation study</h2><span id='topic+reveg'></span>

<h3>Description</h3>

<p>Data from a study looking at the effect of revegetation on invertebrate communities 
(data from Anthony Pik, Macquarie University). Invertebrates were sampled in 4-5 pitfall
traps at eight sites that had undergone revegetation, and two sites that hadn't, and it
was of interest to see what the effect of revegetation was on the invertebrate community.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(reveg)
</code></pre>


<h3>Format</h3>

<p>A list containing three objects:</p>

<dl>
<dt>abund</dt><dd><p>A data frame with abundances of 24 Orders of invertebrate.</p>
</dd>
<dt>pitfalls</dt><dd><p>A vector specifying the number of pitfall traps that were collected at each site.</p>
</dd>
<dt>treatment</dt><dd><p>Whether the site was a 'Control' or a site that had undergone revegetation ('Impact').</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>data(reveg)
worms = reveg$abund$Haplotaxida
plot(worms~treatment, data=reveg, horizontal=TRUE,
  las=1, xlab="",ylab="Worm abundance")

</code></pre>

<hr>
<h2 id='seaweed'>Habitat Configuration data from seaweed experiment</h2><span id='topic+seaweed'></span>

<h3>Description</h3>

<p>Data from a study of habitat configuration, specifically, does density of invertebrate epifauna on seaweed
vary across sites with different levels of isolation from each other.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(seaweed)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>Size</dt><dd><p>A character vector describing size of experimental plots as &quot;SMALL&quot; or &quot;LARGE&quot;</p>
</dd>
<dt>Dist</dt><dd><p>Distance of isolation &ndash; 0, 2 or 10 metres from other algal beds</p>
</dd>
<dt>Time</dt><dd><p>Sampling time - either 5 or 10 weeks from the start of the experiment.</p>
</dd>
<dt>Rep</dt><dd><p>The replicate number (1 to 5).</p>
</dd>
<dt>Wmass</dt><dd><p>Wet mass of the algal bed for that plot.</p>
</dd>
<dt>Total</dt><dd><p>Total invertebrate density in the plot, calculated as nuber of individuals divided by <code>Wmass</code>.</p>
</dd>
</dl>

<p>Other variables in the dataset give invertebrate counts separately for different taxa.
</p>


<h3>References</h3>

<p>Roberts, D. A. &amp; Poore, A. G. (2006). Habitat configuration affects colonisation of
epifauna in a marine algal bed. Biological Conservation <b>127</b>, 18-26.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(seaweed)
boxplot(Total~Dist, data=seaweed)
</code></pre>

<hr>
<h2 id='seedsTemp'>Germination rates of <em>Abutilon angulatum</em> at different temperatures</h2><span id='topic+seedsTemp'></span>

<h3>Description</h3>

<p>Germination rates of <em>Abutilon angulatum</em> from 29 different studies, undertaken
at different ambient temperatures. We would like to know how germination rate
varies with temperature, in particular, the range of temperatures at which <em>Abutilon angulatum</em> 
will germinate. These data come from a larger study across species and environments
to look for a latitudinal signal in tolerance to changing temperature (Sentinella et al 2020).
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(seedsTemp)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>NumSown</dt><dd><p>The number of seeds sown.</p>
</dd>
<dt>NumGerm</dt><dd><p>The number of seeds that germinated.</p>
</dd>
<dt>Test.Temp</dt><dd><p>The ambient temperature (in degrees Celsius) of the location at which seeds were sown.</p>
</dd>
</dl>



<h3>References</h3>

<p>Sentinella, AT, Warton, DI, Sherwin, WB, Offord, CA, Moles, AT. (2020) Tropical plants do not have narrower temperature tolerances, but are more at risk from warming because they are close to their upper thermal limits. Global Ecol Biogeogr. <b>29</b>, 1387-1398.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(seedsTemp)
seedsTemp$propGerm = seedsTemp$NumGerm / seedsTemp$NumSown
plot(propGerm/(1-propGerm)~Test.Temp,data=seedsTemp,log="y",
 ylab="Germination rate [logit scale]", xlab="Temperature (Celsius)")
</code></pre>

<hr>
<h2 id='simulate.manyglm'>Simulate from manyglm objects</h2><span id='topic+simulate.manyglm'></span>

<h3>Description</h3>

<p>Simulates new responses for a manyglm object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'manyglm'
simulate(object, nsim = 1, seed = NULL, newdata = object$data, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.manyglm_+3A_object">object</code></td>
<td>
<p>a <code>manyglm</code> object from the <code>mvabund</code> package.</p>
</td></tr>
<tr><td><code id="simulate.manyglm_+3A_nsim">nsim</code></td>
<td>
<p>number of simulated datasets to generate.</p>
</td></tr>
<tr><td><code id="simulate.manyglm_+3A_seed">seed</code></td>
<td>
<p>a seed for random number generation (defaults to NULL)</p>
</td></tr>
<tr><td><code id="simulate.manyglm_+3A_newdata">newdata</code></td>
<td>
<p>a new dataset with predictors to simulate new values for. Defaults to data model was fitted to.</p>
</td></tr>
<tr><td><code id="simulate.manyglm_+3A_...">...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Returns a data frame containing the response and predictors. This function just calls <code>simulate.cord</code> 
from the <code>ecoCopula</code> package, on a <code>cord</code> object constructed under default settings &ndash; that is, 
it fits a copula latent variable model with two latent variables, then uses this to simulate new data.
</p>


<h3>Value</h3>

<p>Simulates a data frame of new values for responses. If multiple datasets are requested, these are
stacked one under the other (see <code>example(simulate.cord)</code>.
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="mvabund.html#topic+manyglm">manyglm</a></code>, <code><a href="ecoCopula.html#topic+cord">cord</a></code>, <code><a href="ecoCopula.html#topic+simulate.cord">simulate.cord</a></code>
</p>

<hr>
<h2 id='simulate.mlm'>Simulate Responses from a Multivariate Linear Model</h2><span id='topic+simulate.mlm'></span>

<h3>Description</h3>

<p>Simulate one or more sets of responses from a Multivariate Linear Model (<code>mlm</code>) object.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'mlm'
simulate(object, nsim = 1, seed = NULL, ...)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="simulate.mlm_+3A_object">object</code></td>
<td>
<p>a <code>mlm</code> object, typically the result of calling <code>lm</code> 
where the response is a matrix.</p>
</td></tr>
<tr><td><code id="simulate.mlm_+3A_nsim">nsim</code></td>
<td>
<p>number of replicate datasets to simulate. If <code>nsim</code> is greater than 1,
the output is arranged in a 3D array.</p>
</td></tr>
<tr><td><code id="simulate.mlm_+3A_seed">seed</code></td>
<td>
<p>an object specifying if and how the random number generator should be 
initialized (‘seeded’). Either NULL or an integer that will be used in a call to set.seed
before simulating the response vectors. If set, the value is saved as the &quot;seed&quot; attribute 
of the returned value. The default, NULL will not change the random generator state, and 
return .Random.seed as the &quot;seed&quot; attribute, see ‘Value’</p>
</td></tr>
<tr><td><code id="simulate.mlm_+3A_...">...</code></td>
<td>
<p>additional optional arguments.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>A <code>simulate</code> function for <code>mlm</code> objects, which simulates one or more 
sets of responses from a Multivariate Linear Model (<code>mlm</code>) object.
If multiple sets of responses are requested, they are returned in a 3D array,
with simulation number along the third dimension.
</p>
<p>The weights argument is currently ignored &ndash; a constant 
variance-covariance matrix assumed for <code>mlm</code>.
</p>


<h3>Value</h3>

<p>A matrix of simulated values for the response (or an array, for <code>nsim</code> greater than 1)
</p>


<h3>Author(s)</h3>

<p>David Warton &lt;david.warton@unsw.edu.au&gt;
</p>


<h3>See Also</h3>

<p><code><a href="stats.html#topic+lm">lm</a></code>, <code><a href="stats.html#topic+simulate">simulate</a></code>
</p>


<h3>Examples</h3>

<pre><code class='language-R'># fit a mlm to iris data:
data(iris)
iris.mlm=lm(cbind(Sepal.Length,Sepal.Width,Petal.Length,Petal.Width)~Species,data=iris)
# simulate new responses:
simulate(iris.mlm)

</code></pre>

<hr>
<h2 id='snowmelt'>How flowering time relates to snowmelt date</h2><span id='topic+snowmelt'></span>

<h3>Description</h3>

<p>Data from a study of how time from snowmelt to flowering relates to snowmelt date and elevation
(Wheeler et al 2016) in <em>Salix herbacea</em>, based on about 120 plots on each of three mountains in the Swiss Alps.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(snowmelt)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>id</dt><dd><p>Plot patch ID</p>
</dd>
<dt>flow</dt><dd><p>Number of days from snowmelt day to flowering</p>
</dd>
<dt>snow</dt><dd><p>Snowmelt day of year</p>
</dd>
<dt>sex</dt><dd><p>Sex of patch, corrected across years, NA - no flowering, 0 - male, 1 - female</p>
</dd>
<dt>elev</dt><dd><p>Elevation (from dGPS)</p>
</dd>
</dl>



<h3>References</h3>

<p>Wheeler, J. A., Cortés, A. J., Sedlacek, J., Karrenberg, S., van Kleunen, M.,
Wipf, S., Hoch G., Bossdorf, O. &amp; Rixen C. (2016) The snow and the willows: earlier
spring snowmelt reduces performance in the low-lying alpine shrub <em>Salix herbacea</em>.
Journal of Ecology <b>104</b>, 1041-50.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(snowmelt)
plot(flow~snow,data=snowmelt, log="y")
</code></pre>

<hr>
<h2 id='waterQuality'>Water Quality data</h2><span id='topic+waterQuality'></span>

<h3>Description</h3>

<p>Data from a study of the association between water quality and catchment area. Fish composition were used to construct an
index of biotic integrity (IBI) and relate it to catchment are in the Seine river basin in France.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(waterQuality)
</code></pre>


<h3>Format</h3>

<p>A dataframe containing:</p>

<dl>
<dt>catchment</dt><dd><p>The catchment area in square kilometres</p>
</dd>
<dt>quality</dt><dd><p>Index of Biotic Integrity (IBI)</p>
</dd>
<dt>logCatchment</dt><dd><p>log base 10 of catchment area</p>
</dd>
</dl>



<h3>References</h3>

<p>Oberdorff, T. &amp; Hughes, R. M. (1992). Modification of an index of biotic integrity based
on fish assemblages to characterize rivers of the Seine Basin, France&quot;. Hydrobiologia, <b>228</b>, 117-130.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(waterQuality)
plot(quality~logCatchment, data=waterQuality)
</code></pre>

<hr>
<h2 id='windFarms'>Data from wind farm study</h2><span id='topic+windFarms'></span>

<h3>Description</h3>

<p>Data from a study of the effect of offshore wind farms on fish communities 
(Bergström et al. 2013), with measurements before (2003) and after (2010) wind 
farm installation at 36 different sites in three zones &ndash; two affected by wind farms,
and two control zones. Abundances have been recorded for 16 different taxa.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>data(windFarms)
</code></pre>


<h3>Format</h3>

<p>A list containing three objects:</p>

<dl>
<dt>X</dt><dd><p>A data frame with descriptors of location and time of sampling. These include:
'Year', a factor giving year of sampling, only 2003 and 2010 measurements are available here;
'Zone', a factor giving zone of sampling, <code>WF</code> for wind farm, <code>N</code> for Northern zone,
<code>S</code> for Southern zone;
'Station', a factor indicating station ID;
'Impact', a factor indicating whether sampling is 'Before' or 'After' wind farm construction.
</p>
</dd>
<dt>abund</dt><dd><p>A data frame containing abundances of 16 different fish taxa.</p>
</dd>
<dt>totalAbund</dt><dd><p>The total abundance of fish at each site.</p>
</dd>
</dl>



<h3>References</h3>

<p>Bergström, L., Sundqvist, F., &amp; Bergström, U. (2013). Effects of 
an offshore wind farm on temporal and spatial patterns in the demersal fish community. 
Marine Ecology Progress Series 485, 199-210.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(windFarms)
eels =windFarms$abund[,14] 
plot(eels~interaction(Impact,Zone), data=windFarms$X, horizontal=TRUE,
  las=1, xlab="",ylab="Eel abundance")

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
