<!DOCTYPE html><html lang="en"><head><title>Help for package qris</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav class="package" aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {qris}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#qris-package'><p>qris: Quantile Regression Model for Residual Lifetime Using an Induced Smoothing Approach</p></a></li>
<li><a href='#export_Surv'><p><code>Surv</code> function imported from <code>survival</code></p></a></li>
<li><a href='#plot.qris'><p>Draw 95% confidence interval by a quantile regression estimator of residual lifetime from survival data</p></a></li>
<li><a href='#predict.qris'><p>Prediction for Quantile Regression Model Fitted on Residual life</p></a></li>
<li><a href='#qris'><p>Estimate a quantile regression estimator of residual lifetime from survival data</p></a></li>
<li><a href='#qris.control'><p>Auxiliary for Controlling qris</p></a></li>
<li><a href='#qris.extend'><p>Extend a &quot;<code>qris</code>&quot; object to a specified range of <code class="reqn">tau</code> or <code class="reqn">t_0</code> values.</p></a></li>
<li><a href='#residuals.qris'><p>Residuals for Quantile Regression Model Fitted on Residual life</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table role='presentation'>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Quantile Regression Model for Residual Lifetime Using an Induced
Smoothing Approach</td>
</tr>
<tr>
<td>Version:</td>
<td>1.1.1</td>
</tr>
<tr>
<td>Date:</td>
<td>2024-02-27</td>
</tr>
<tr>
<td>Description:</td>
<td>A collection of functions is provided by this package to fit quantiles regression models for censored residual lifetimes. It provides various options for regression parameters estimation: the induced smoothing approach (smooth), and L1-minimization (non-smooth).  It also implements the estimation methods for standard errors of the regression parameters estimates based on an efficient partial multiplier bootstrap method and robust sandwich estimator. Furthermore, a simultaneous procedure of estimating regression parameters and their standard errors via an iterative updating procedure is implemented (iterative). For more details, see Kim, K. H., Caplan, D. J., &amp; Kang, S. (2022), "Smoothed quantile regression for censored residual life", Computational Statistics, 1-22 &lt;<a href="https://doi.org/10.1007%2Fs00180-022-01262-z">doi:10.1007/s00180-022-01262-z</a>&gt;.</td>
</tr>
<tr>
<td>Depends:</td>
<td>R (&ge; 3.6.0)</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-3">GPL (&ge; 3)</a></td>
</tr>
<tr>
<td>URL:</td>
<td><a href="https://github.com/Kyuhyun07/qris">https://github.com/Kyuhyun07/qris</a></td>
</tr>
<tr>
<td>Encoding:</td>
<td>UTF-8</td>
</tr>
<tr>
<td>RoxygenNote:</td>
<td>7.3.1</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Imports:</td>
<td>nleqslv, quantreg, stringr, survival, ggplot2, Rcpp</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>Suggests:</td>
<td>testthat (&ge; 3.0.0)</td>
</tr>
<tr>
<td>Config/testthat/edition:</td>
<td>3</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2024-03-05 13:32:07 UTC; user</td>
</tr>
<tr>
<td>Author:</td>
<td>Kyu Hyun Kim [aut, cre],
  Sangwook Kang [aut],
  Sy Han Chiou [aut]</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kyu Hyun Kim &lt;kyuhyunkim07@gmail.com&gt;</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2024-03-05 14:40:03 UTC</td>
</tr>
</table>
<hr>
<h2 id='qris-package'>qris: Quantile Regression Model for Residual Lifetime Using an Induced Smoothing Approach</h2><span id='topic+qris-package'></span><span id='topic+qris-packages'></span>

<h3>Description</h3>

<p>This package offers a collection of functions to fit quantiles regression models for censored residual lifetimes. It provides various options for regression parameters estimation: the induced smoothing approach (smooth), and L1-minimization (non-smooth).  It also implements the estimation methods for standard errors of the regression parameters estimates based on an efficient partial multiplier bootstrap method and robust sandwich estimator. Furthermore, a simultaneous procedure of estimating regression parameters and their standard errors via an iterative updating procedure is implemented (iterative). See Kim, K. (2022) &quot;Smoothed quantile regression for censored residual life&quot;, &lt;arXiv:2205.00413&gt;.
</p>


<h3>Author(s)</h3>

<p><strong>Maintainer</strong>: Kyu Hyun Kim <a href="mailto:kyuhyunkim07@yonsei.ac.kr">kyuhyunkim07@yonsei.ac.kr</a>
</p>
<p>Authors:
</p>

<ul>
<li><p> Sangwook Kang
</p>
</li>
<li><p> Sy Han Chiou
</p>
</li></ul>



<h3>See Also</h3>

<p>Useful links:
</p>

<ul>
<li> <p><a href="https://github.com/Kyuhyun07/qris">https://github.com/Kyuhyun07/qris</a>
</p>
</li></ul>


<hr>
<h2 id='export_Surv'><code>Surv</code> function imported from <code>survival</code></h2><span id='topic+export_Surv'></span><span id='topic+Surv'></span>

<h3>Description</h3>

<p>This function is imported from the <code>survival</code> package. See
<code><a href="survival.html#topic+Surv">Surv</a></code>.
</p>


<h3>Value</h3>

<p>An object of class <code>Surv</code>.  There are methods for <code>print</code>, <code>is.na</code>, and subscripting survival objects. 
<code>Surv</code> objects are implemented as a matrix of 2 or 3 columns that has further attributes. 
These include the type (left censored, right censored, counting process, etc.) and labels for the states for multi-state objects.
Any attributes of the input arguments are also preserved in <code>inputAttributes</code>.  
This may be useful for other packages that have attached further information to data items such as labels;
none of the routines in the survival package make use of these values, however. 
In the case of <code>is.Surv</code>, a logical value <code>TRUE</code> if <code>x</code> inherits from class <code>"Surv"</code>, otherwise an <code>FALSE</code>.
</p>

<hr>
<h2 id='plot.qris'>Draw 95% confidence interval by a quantile regression estimator of residual lifetime from survival data</h2><span id='topic+plot.qris'></span>

<h3>Description</h3>

<p>Draw 95% confidence interval by a quantile regression estimator of residual lifetime from survival data
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qris'
plot(
  x,
  t0s = NULL,
  Qs = NULL,
  nB = NULL,
  vari = NULL,
  byQs = FALSE,
  ggextra = NULL,
  ...
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="plot.qris_+3A_x">x</code></td>
<td>
<p>is an &quot;<code>qris</code>&quot; object or a data.frame returned by <code>plot.qris</code>.</p>
</td></tr>
<tr><td><code id="plot.qris_+3A_t0s">t0s</code></td>
<td>
<p>is a vector of range of <code>t0</code> to plot;
when not specified, the default value is from 0 to presently defined <code class="reqn">t_0</code></p>
</td></tr>
<tr><td><code id="plot.qris_+3A_qs">Qs</code></td>
<td>
<p>is a vector of range of <code>Q</code> to plot;
when not specified, the default value is from 5% to presently defined <code class="reqn">Q</code></p>
</td></tr>
<tr><td><code id="plot.qris_+3A_nb">nB</code></td>
<td>
<p>is the number of multiplier bootstrapping for standard error estimation.</p>
</td></tr>
<tr><td><code id="plot.qris_+3A_vari">vari</code></td>
<td>
<p>is a character string to choose variables to draw the regression coefficient.</p>
</td></tr>
<tr><td><code id="plot.qris_+3A_byqs">byQs</code></td>
<td>
<p>put <code>Q</code>'s on x-axis; only used when both <code>t0</code>'s and <code>Q</code>'s are specified.</p>
</td></tr>
<tr><td><code id="plot.qris_+3A_ggextra">ggextra</code></td>
<td>
<p>is a list that contains additional components to apply to the <code>ggplot</code> output.
The <code>ggplot2</code> library must be loaded in order to utilize this feature.</p>
</td></tr>
<tr><td><code id="plot.qris_+3A_...">...</code></td>
<td>
<p>for future extension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list contains <code>ggplot</code> object and the information to generate it.
</p>


<h3>Examples</h3>

<pre><code class='language-R'>data(cancer, package = "survival")
lung2 &lt;- subset(lung, select = c(time, status, age, sex))
## tidy up the data
lung2$status &lt;- lung2$status - 1
lung2$sex &lt;- lung2$sex - 1

library(qris)
fm &lt;- Surv(time, status) ~ age + sex
fit &lt;- qris(fm, data = lung2, t0 = 30, Q = 0.5, nB = 50, "nonsmooth", "fmb")

## Plot with default values; Qs &lt;- 1:9 / 10 and t0s = fit2$para$t0 (in this case 30)
plot(fit)

## Plot with without 95% CI is much faster
plot(fit, nB = 0)

## Plot feature can update qris calls 
fit &lt;- plot(fit, Qs = 3:6 / 10, t0s = 1:6 * 10)

## Faster after updating the qris call
plot(fit, byQs = FALSE)
plot(fit, byQs = TRUE)

plot(fit, byQs = FALSE, vari = c("sex", "age"))
plot(fit, byQs = TRUE, vari = c("sex", "age"))

## Extra ggplot components
library(ggplot2)
plot(fit, byQs = FALSE, vari = c("sex", "age"), ggextra = theme(legend.position = "none"))
</code></pre>

<hr>
<h2 id='predict.qris'>Prediction for Quantile Regression Model Fitted on Residual life</h2><span id='topic+predict.qris'></span>

<h3>Description</h3>

<p>Prediction based on fitted quantile regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qris'
predict(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="predict.qris_+3A_object">object</code></td>
<td>
<p>is a qris object</p>
</td></tr>
<tr><td><code id="predict.qris_+3A_newdata">newdata</code></td>
<td>
<p>is a data frame for an optional new data to do predictions.
If omitted, the fitted values based on the original data and fit will be returned.</p>
</td></tr>
<tr><td><code id="predict.qris_+3A_...">...</code></td>
<td>
<p>for future extension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of prediction
</p>

<hr>
<h2 id='qris'>Estimate a quantile regression estimator of residual lifetime from survival data</h2><span id='topic+qris'></span>

<h3>Description</h3>

<p>Using three estimation methods
(1) L1-minimization(non-smooth estimating equation
(2) Induced smoothing approach (smooth estimating equation
(3) Iterative procedure with induced smoothing approach (smooth estimating equation
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qris(
  formula,
  data,
  t0 = 0,
  Q = 0.5,
  nB = 100,
  method = c("smooth", "iterative", "nonsmooth"),
  se = c("fmb", "pmb"),
  init = c("rq", "noeffect"),
  verbose = FALSE,
  control = qris.control()
)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qris_+3A_formula">formula</code></td>
<td>
<p>is a formula expression, of the form <code>response ~ predictors</code>.
The <code>response</code> is a <code>Surv</code> object with right censoring.</p>
</td></tr>
<tr><td><code id="qris_+3A_data">data</code></td>
<td>
<p>is an optional <code>data.frame</code> in which to interpret the variables occurring in the <code>formula</code>.</p>
</td></tr>
<tr><td><code id="qris_+3A_t0">t0</code></td>
<td>
<p>is the follow-up time (or basetime of analysis). The default followup time is set to 0.</p>
</td></tr>
<tr><td><code id="qris_+3A_q">Q</code></td>
<td>
<p>is the quantile. The default quantile is set to 0.5.</p>
</td></tr>
<tr><td><code id="qris_+3A_nb">nB</code></td>
<td>
<p>is number of multiplier bootstrapping for V matrix estimation. The default number of bootstrapping is set to 100.</p>
</td></tr>
<tr><td><code id="qris_+3A_method">method</code></td>
<td>
<p>is an option for specifying the methods of parameters estimation;
<code>smooth</code> is the default in which parameters estimates and their standard errors are obtained via induced smoothed estimating equations.
<code>nonsmooth</code> uses a L1-minimization method for non-smooth object functions in coefficient estimation.
<code>iterative</code> simultaneously estimates parameters and their standard errors based on the iterative updates for the parameter estimates.</p>
</td></tr>
<tr><td><code id="qris_+3A_se">se</code></td>
<td>
<p>is an option for specifying the methods of standard errors estimation;
The available options are <code>pmb</code> and <code>fmb</code>.
The <code>pmb</code> is the default option.
It estimates the standard errors via partial multiplier bootstrapping and is only available
when <code>method = "smooth"</code> or <code>method = "iterative"</code>.
The <code>fmb</code> uses a full multiplier bootstrapping in standard errors estimation.</p>
</td></tr>
<tr><td><code id="qris_+3A_init">init</code></td>
<td>
<p>is an option for specifying the initial values of the parameters estimates.
Available options are <code>rq</code> and <code>noeffect</code>.
These options correspond to the estimates from the <code>quantreg::rq()</code> and a zero vector, respectively.
Alternatively, user defined numerical vector is also allowed.</p>
</td></tr>
<tr><td><code id="qris_+3A_verbose">verbose</code></td>
<td>
<p>Shows computation status.</p>
</td></tr>
<tr><td><code id="qris_+3A_control">control</code></td>
<td>
<p>controls maximum number of iteration, tolerance of convergence and whether to display output for each iteration when
<code>method = "iterative"</code>.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>An object of class &quot;<code>qris</code>&quot; contains model fitting results.
The &quot;<code>qris</code>&quot; object is a list containing at least the following components:
</p>

<dl>
<dt>coefficient</dt><dd><p>a vector of point estimates</p>
</dd>
<dt>stderr</dt><dd><p>a vector of standard error of point estimates</p>
</dd>
<dt>vcov</dt><dd><p>a matrix of the estimated variance-covariance matrix</p>
</dd>
<dt>maxiter</dt><dd><p>a number of iteration until convergence (only for iterative procedure)</p>
</dd>
</dl>



<h3>Examples</h3>

<pre><code class='language-R'>## ######################################### 
## Simulated data
## #########################################
data.gen &lt;- function(n) {
  r0 &lt;- .2 * sqrt(log(2))
  r1 &lt;- .1 * sqrt(log(2))
  dat &lt;- data.frame(censoring = runif(n, 0, 24.35),
                    Time0 = sqrt(-log(1 - runif(n))),
                    X = rbinom(n, 1, .5))
  dat$Time0 &lt;- ifelse(dat$X &gt; 0, dat$Time0 / r1, dat$Time0 / r0)
  dat$Time &lt;- pmin(dat$Time0, dat$censoring)
  dat$status &lt;- 1 * (dat$Time0 &lt; dat$censoring)
  subset(dat, select = c(Time, status, X))
}

set.seed(1)
dat &lt;- data.gen(200)
fm &lt;- Surv(Time, status) ~ X
fit1 &lt;- qris(fm, data = dat, t0 = 1, Q = 0.5, nB = 100, "smooth", "pmb", c(1,1))
fit2 &lt;- qris(fm, data = dat, t0 = 1, Q = 0.5, nB = 100, "nonsmooth", "fmb", "rq")
fit3 &lt;- qris(fm, data = dat, t0 = 1, Q = 0.5, nB = 100, "iterative", "fmb", "rq",
             control = qris.control(maxit = 20, tol = 1e-3, trace = TRUE))

summary(fit1)
summary(fit2)
summary(fit3)

## #########################################
## Real data application
## #########################################
data(cancer, package = "survival")
lung2 &lt;- subset(lung, select = c(time, status, age, sex))
## tidy up the data
lung2$status &lt;- lung2$status - 1
lung2$sex &lt;- lung2$sex - 1

fm &lt;- Surv(time, status) ~ age + sex
fit1 &lt;- qris(fm, data = lung2, t0 = 0, Q = 0.5, nB = 100, "iterative", "pmb", "rq")
fit2 &lt;- qris(fm, data = lung2, t0 = 30, Q = 0.5, nB = 100, "nonsmooth", "fmb", c(1, 0, 1))
fit3 &lt;- qris(fm, data = lung2, t0 = 100, Q = 0.5, nB = 100,"smooth", "pmb", "rq")

summary(fit1)
summary(fit2)
summary(fit3)

plot(fit2, Qs = 4:6 / 10)

</code></pre>

<hr>
<h2 id='qris.control'>Auxiliary for Controlling qris</h2><span id='topic+qris.control'></span>

<h3>Description</h3>

<p>Auxiliary function as user interface for <code>qris</code> fitting.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qris.control(maxiter = 10, tol = 0.001, trace = FALSE)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qris.control_+3A_maxiter">maxiter</code></td>
<td>
<p>max number of iteration.</p>
</td></tr>
<tr><td><code id="qris.control_+3A_tol">tol</code></td>
<td>
<p>tolerance of convergence</p>
</td></tr>
<tr><td><code id="qris.control_+3A_trace">trace</code></td>
<td>
<p>a binary variable, determine whether to save output for each iteration.</p>
</td></tr>
</table>


<h3>Details</h3>

<p>When <code>trace</code> is TRUE, output for each iteration is printed to the screen.
</p>


<h3>Value</h3>

<p>A list with the arguments as components.
</p>


<h3>See Also</h3>

<p><code><a href="#topic+qris">qris</a></code>
</p>

<hr>
<h2 id='qris.extend'>Extend a &quot;<code>qris</code>&quot; object to a specified range of <code class="reqn">tau</code> or <code class="reqn">t_0</code> values.</h2><span id='topic+qris.extend'></span>

<h3>Description</h3>

<p>Extend a &quot;<code>qris</code>&quot; object to a specified range of <code class="reqn">tau</code> or <code class="reqn">t_0</code> values.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>qris.extend(x, t0s = NULL, Qs = NULL, nB = NULL, vari = NULL)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="qris.extend_+3A_x">x</code></td>
<td>
<p>is an qris object or a data.frame returned by plot.qris</p>
</td></tr>
<tr><td><code id="qris.extend_+3A_t0s">t0s</code></td>
<td>
<p>is a vector of range of t0 to plot; when not specified, the default value is from 0 to presently defined <code class="reqn">t_0</code></p>
</td></tr>
<tr><td><code id="qris.extend_+3A_qs">Qs</code></td>
<td>
<p>is a vector of range of Q to plot; when not specified, the default value is from 5% to presently defined <code class="reqn">Q</code></p>
</td></tr>
<tr><td><code id="qris.extend_+3A_nb">nB</code></td>
<td>
<p>is the number of multiplier bootstrapping for standard error estimation.</p>
</td></tr>
<tr><td><code id="qris.extend_+3A_vari">vari</code></td>
<td>
<p>is a character string to choose variables to draw the regression coefficient.</p>
</td></tr>
</table>

<hr>
<h2 id='residuals.qris'>Residuals for Quantile Regression Model Fitted on Residual life</h2><span id='topic+residuals.qris'></span>

<h3>Description</h3>

<p>Residual based on fitted quantile regression model
</p>


<h3>Usage</h3>

<pre><code class='language-R'>## S3 method for class 'qris'
residuals(object, newdata, ...)
</code></pre>


<h3>Arguments</h3>

<table role = "presentation">
<tr><td><code id="residuals.qris_+3A_object">object</code></td>
<td>
<p>is a qris object</p>
</td></tr>
<tr><td><code id="residuals.qris_+3A_newdata">newdata</code></td>
<td>
<p>is a data frame for an optional new data to do predictions.
If omitted, the fitted values based on the original data and fit will be returned.</p>
</td></tr>
<tr><td><code id="residuals.qris_+3A_...">...</code></td>
<td>
<p>for future extension</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A vector of residual
</p>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
