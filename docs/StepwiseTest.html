<!DOCTYPE html><html><head><title>Help for package StepwiseTest</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script type="text/javascript">
const macros = { "\\R": "\\textsf{R}", "\\code": "\\texttt"};
function processMathHTML() {
    var l = document.getElementsByClassName('reqn');
    for (let e of l) { katex.render(e.textContent, e, { throwOnError: false, macros }); }
    return;
}</script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"
    onload="processMathHTML();"></script>
<link rel="stylesheet" type="text/css" href="R-nav.css" />
</head><body><div class="container"><nav aria-label="Topic Navigation">
<div class="dropdown-menu">
<h1>Package {StepwiseTest}</h1>
<h2>Contents</h2>
<ul class="menu">
<li><a href='#StepwiseTest-package'>
<p>Multiple Testing Method to Control Generalized Family-Wise Error Rate and False Discovery Proportion</p></a></li>
</ul>
</div>
<hr>
</nav>
<main>
<table>
<tr>
<td>Type:</td>
<td>Package</td>
</tr>
<tr>
<td>Title:</td>
<td>Multiple Testing Method to Control Generalized Family-Wise Error
Rate and False Discovery Proportion</td>
</tr>
<tr>
<td>Version:</td>
<td>1.0</td>
</tr>
<tr>
<td>Date:</td>
<td>2016-09-13</td>
</tr>
<tr>
<td>Author:</td>
<td>Yu-Chin Hsu and Kendro Vincent</td>
</tr>
<tr>
<td>Maintainer:</td>
<td>Kendro Vincent &lt;vincent.kendro@gmail.com&gt;</td>
</tr>
<tr>
<td>Description:</td>
<td>Collection of stepwise procedures to conduct multiple hypotheses testing. The details of the stepwise algorithm can be found in Romano and Wolf (2007) &lt;<a href="https://doi.org/10.1214%2F009053606000001622">doi:10.1214/009053606000001622</a>&gt; and Hsu, Kuan, and Yen (2014) &lt;<a href="https://doi.org/10.1093%2Fjjfinec%2Fnbu014">doi:10.1093/jjfinec/nbu014</a>&gt;.</td>
</tr>
<tr>
<td>License:</td>
<td><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a> | <a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a> [expanded from: GPL (&ge; 2)]</td>
</tr>
<tr>
<td>Imports:</td>
<td>Rcpp (&ge; 0.12.2)</td>
</tr>
<tr>
<td>Suggests:</td>
<td>foreach, tseries</td>
</tr>
<tr>
<td>LinkingTo:</td>
<td>Rcpp, RcppArmadillo</td>
</tr>
<tr>
<td>NeedsCompilation:</td>
<td>yes</td>
</tr>
<tr>
<td>Packaged:</td>
<td>2016-09-14 01:56:25 UTC; KVincent</td>
</tr>
<tr>
<td>Repository:</td>
<td>CRAN</td>
</tr>
<tr>
<td>Date/Publication:</td>
<td>2016-09-14 18:50:51</td>
</tr>
</table>
<hr>
<h2 id='StepwiseTest-package'>
Multiple Testing Method to Control Generalized Family-Wise Error Rate and False Discovery Proportion
</h2><span id='topic+StepwiseTest-package'></span><span id='topic+StepwiseTest'></span><span id='topic+FWERkControl'></span><span id='topic+FDPControl'></span>

<h3>Description</h3>

<p>Collection of stepwise procedures to conduct multiple hypotheses testing. The details of the stepwise algorithm can be found in Romano and Wolf (2007) &lt;DOI:10.1214/009053606000001622&gt; and Hsu, Kuan, and Yen (2014) &lt;DOI:10.1093/jjfinec/nbu014&gt;.
</p>


<h3>Usage</h3>

<pre><code class='language-R'>FWERkControl(test_stat, boot_stat, k, alpha)
FDPControl(test_stat, boot_stat, gamma, alpha)
</code></pre>


<h3>Arguments</h3>

<table>
<tr><td><code id="StepwiseTest-package_+3A_test_stat">test_stat</code></td>
<td>
<p>m x 1 column vector of test statistics</p>
</td></tr>
<tr><td><code id="StepwiseTest-package_+3A_boot_stat">boot_stat</code></td>
<td>
<p>m x B matrix of bootstrap statistics</p>
</td></tr>
<tr><td><code id="StepwiseTest-package_+3A_k">k</code></td>
<td>
<p>Number of false rejections</p>
</td></tr>
<tr><td><code id="StepwiseTest-package_+3A_gamma">gamma</code></td>
<td>
<p>False discovery proportion</p>
</td></tr>
<tr><td><code id="StepwiseTest-package_+3A_alpha">alpha</code></td>
<td>
<p>The desired FWER(k) or FDP level</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>Reject</code>: A 0/1 numeric vector where the element <code>j</code> equals 1 indicates the model <code>j</code> is significant.
</p>
<p><code>CV</code>: The critical value.
</p>


<h3>Author(s)</h3>

<p>Yu-Chin Hsu and Kendro Vincent
</p>
<p>Maintainer: Kendro Vincent &lt;vincent.kendro@gmail.com&gt;
</p>


<h3>References</h3>

<p>Romano, J. P. and Wolf, M. (2005). &ldquo;Stepwise multiple testing as formalized data snooping.&rdquo; Econometrica, 73, 1237-1282.
</p>
<p>Romano, J. P. and Wolf, M. (2007). &ldquo;Control of generalized error rates in multiple testing.&rdquo; Annals of Statistics, 35, 1378-1408.
</p>
<p>Hsu, P.-H., Hsu, Y.-C., and Kuan, C.-M. (2010). &ldquo;Testing the predictive ability of technical analysis using a new stepwise test without data-snooping bias.&rdquo; Journal of Empirical Finance, 17, 471-484.
</p>
<p>Hsu, Y.-C., Kuan, C.-M., and Yen, M.-F. (2014). &ldquo;A generalized stepwise procedure with improved power for multiple inequalities testing.&rdquo; Journal of Financial Econometrics, 12, 730-755.
</p>


<h3>Examples</h3>

<pre><code class='language-R'># Specify the model parameters
m_null = 3
m_alt  = 7
m = m_null + m_alt
mu = c( rep(0, m_null), rep(0.5,m_alt) )
rho = 0.25
omega= (1-rho)*diag(1,m) + rho*matrix(1,m,m)
v=t(chol(omega))

# generate the data
n = 100
y = mu%*%matrix(1,1,n)+ v %*% matrix(rnorm(m*n),m,n)

# calculate the test statistics and bootstrap statistics
library(foreach)
library(tseries)
B = 100
y_mean = apply(y,1,mean)
y_sig = apply(y,1,sd)
t_stat = as.matrix(sqrt(n)*y_mean/y_sig)
s = tsbootstrap(1:n,B,b=2,type="stationary")
b_stat = foreach(i=1:B,.combine=cbind) %do% {
  y_boot = y[, s[,i]]
  y_mean_boot = apply(y_boot,1,mean)
  sqrt(n)*(y_mean_boot - y_mean)/y_sig
}

# Multiple test that controls FWER(1) at 5% significance level
FWERkControl(t_stat,b_stat,1,0.05)

# Multiple test that controls FWER(3) at 5% significance level
FWERkControl(t_stat,b_stat,1,0.05)

# Multiple test that controls FDP(0.1) at 5% significance level
FDPControl(t_stat,b_stat,0.1,0.05)

</code></pre>

</main>

</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-r.min.js"></script>
</body></html>
